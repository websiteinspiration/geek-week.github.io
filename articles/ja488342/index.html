<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ŒğŸ¿ ğŸ™‡ğŸ¼ ğŸ¬ ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã€ä¸»æˆåˆ†åˆ†æã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©åŒ–ï¼šPythonã§ã®åˆ†é¡å•é¡Œã®è§£æ±ºä¾‹ ğŸ’ ğŸª ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãŠã‚ˆã³åˆ†æã®å°‚é–€å®¶ã«ã¯ã€åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®å¤šãã®ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®æœ€ã‚‚ä¸€èˆ¬çš„ã§ä¿¡é ¼æ€§ã®é«˜ã„æ–¹æ³•ã®1ã¤ã¯ã€ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆï¼ˆRFï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚RFã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã€ä¸»æˆåˆ†åˆ†æã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©åŒ–ï¼šPythonã§ã®åˆ†é¡å•é¡Œã®è§£æ±ºä¾‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/488342/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãŠã‚ˆã³åˆ†æã®å°‚é–€å®¶ã«ã¯ã€åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®å¤šãã®ãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®æœ€ã‚‚ä¸€èˆ¬çš„ã§ä¿¡é ¼æ€§ã®é«˜ã„æ–¹æ³•ã®1ã¤ã¯ã€ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆï¼ˆRFï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«ã€ãƒ¢ãƒ‡ãƒ«</font><font style="vertical-align: inherit;">ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©åŒ–ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼ˆãƒã‚¤ãƒ‘ãƒ¼</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€HTï¼‰ã€‚</font><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€ãƒ‡ãƒ¼ã‚¿ãŒãƒ¢ãƒ‡ãƒ«ã«è»¢é€ã•ã‚Œã‚‹å‰ã«ã€</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ä¸»æˆåˆ†åˆ†æ</font></a><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—ã¦å‡¦ç†ã•ã‚Œã‚‹ã¨ã„ã†åºƒç¯„å›²ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/tt/m5/h7/ttm5h7jbbx2u2wuc1var1azxwew.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€PCAï¼‰ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ä½¿ç”¨ã™ã‚‹ä¾¡å€¤ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">åˆ†æè€…ãŒç‰¹æ€§ã®é‡è¦æ€§ã‚’è§£é‡ˆã™ã‚‹ã®ã«å½¹ç«‹ã¤RFã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸»ãªç›®çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¯ã„ã€PCAã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€RFãƒ¢ãƒ‡ãƒ«ã®ã€Œæ©Ÿèƒ½ã®é‡è¦æ€§ã€ã®åˆ†æã«ãŠã„ã¦ã€å„ã€Œæ©Ÿèƒ½ã€ã®è§£é‡ˆãŒå°‘ã—è¤‡é›‘ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€PCAã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ç‰¹å¾´ç©ºé–“ã®æ¬¡å…ƒã‚’å‰Šæ¸›ã™ã‚‹ãŸã‚ã€RFãƒ¢ãƒ‡ãƒ«ã§å‡¦ç†ã™ã‚‹å¿…è¦ã®ã‚ã‚‹ç‰¹å¾´ã®æ•°ãŒæ¸›å°‘ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚è¨ˆç®—é‡ã¯ã€ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸»ãªæ¬ ç‚¹ã®1ã¤ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼ˆã¤ã¾ã‚Šã€ãƒ¢ãƒ‡ãƒ«ã®å®Œäº†ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰ã€‚ PCAã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®é©ç”¨ã¯ã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®éå¸¸ã«é‡è¦ãªéƒ¨åˆ†ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç‰¹ã«ã€æ•°ç™¾ã¾ãŸã¯æ•°åƒã®æ©Ÿèƒ½ã§æ©Ÿèƒ½ã™ã‚‹å ´åˆã¯ãã†ã§ã™ã€‚ãã®çµæœã€æœ€ã‚‚é‡è¦ãªã“ã¨ã¯ã€å˜ã«æœ€ã‚‚åŠ¹æœçš„ãªãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã‚ã‚Šã€åŒæ™‚ã«å±æ€§ã®é‡è¦æ€§ã‚’æ±ºå®šã™ã‚‹éš›ã®ç²¾åº¦ã‚’çŠ ç‰²ã«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹å ´åˆã€PCAã¯è©¦ã—ã¦ã¿ã‚‹ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã¦ãƒã‚¤ãƒ³ãƒˆã«ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹³ãŒã‚“ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ-Scikit-learnã®ã€Œä¹³ãŒã‚“ã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ä½œæ¥­ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€ãã‚Œã‚‰ã®æœ‰åŠ¹æ€§ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å…·ä½“çš„ã«ã¯ã€æ¬¡ã®ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦è©±ã—ã¾ã™ã€‚</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ãåŸºæœ¬ãƒ¢ãƒ‡ãƒ«ï¼ˆã“ã®RFãƒ¢ãƒ‡ãƒ«ã¯çœç•¥ã—ã¾ã™ï¼‰ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1ã¨åŒã˜ãƒ¢ãƒ‡ãƒ«ã§ã™ãŒã€ä¸»æˆåˆ†ç©ºé–“æ³•ï¼ˆRF + PCAï¼‰ã‚’ä½¿ç”¨ã—ã¦ç‰¹å¾´ç©ºé–“ã®æ¬¡å…ƒã®ç¸®å°ãŒé©ç”¨ã•ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 2ã¨åŒã˜ãƒ¢ãƒ‡ãƒ«ã§ã™ãŒã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼æœ€é©åŒ–ï¼ˆRF + PCA + HTï¼‰ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></li>
</ol><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¯ã˜ã‚ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€Pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">Scikit-learnã‹ã‚‰äº‹å‰ã«ã‚¯ãƒªã‚¢ã•ã‚ŒãŸã€ŒãŠã‚‚ã¡ã‚ƒã€ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãã®å¾Œã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ãã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã§ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆ</font></font><code>df</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã«</font><font style="vertical-align: inherit;">é©ç”¨ã•ã‚Œã‚‹æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã®äºˆå‚™åˆ†æã‚’è¡Œã†ã“ã¨ã‹ã‚‰å¸¸ã«ä½œæ¥­ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<ul>
<li><code>df.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¦‹ã¦ã€æœŸå¾…ã©ãŠã‚Šã«è¦‹ãˆã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font></li>
<li><code>df.info()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ãƒ‡ãƒ¼ã‚¿å‹ã¨åˆ—ã®å†…å®¹ã®ç‰¹å¾´ã‚’è¦‹ã¤ã‘ã‚‹ã€‚</font><font style="vertical-align: inherit;">ç¶šè¡Œã™ã‚‹å‰ã«ãƒ‡ãƒ¼ã‚¿å‹å¤‰æ›ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font></font></li>
<li><code>df.isna()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ãƒ‡ãƒ¼ã‚¿ã«å€¤ãŒãªã„ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</font></font><code>NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¯¾å¿œã™ã‚‹å€¤ãŒã‚ã‚‹å ´åˆã¯ã€ä½•ã‚‰ã‹ã®æ–¹æ³•ã§å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã¯ã€å¿…è¦ã«å¿œã˜ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰è¡Œå…¨ä½“ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font></font></li>
<li><code>df.describe()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -åˆ—ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®æœ€å°å€¤ã€æœ€å¤§å€¤ã€å¹³å‡å€¤ã‚’è¦‹ã¤ã‘ã€åˆ—ã®å¹³å‡äºŒä¹—ã¨äºˆæƒ³ã•ã‚Œã‚‹åå·®ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯ã€åˆ—</font></font><code>cancer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆç™Œï¼‰ã¯ã€ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦äºˆæ¸¬ã™ã‚‹å€¤ã‚’æŒã¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå¤‰æ•°ã§ã™ã€‚</font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œç—…æ°—ãªã—ã€ã‚’æ„å‘³ã—ã¾ã™ã€‚</font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ã€Œç—…æ°—ã®å­˜åœ¨ã€</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<font></font>
columns = [<span class="hljs-string">'mean radius'</span>, <span class="hljs-string">'mean texture'</span>, <span class="hljs-string">'mean perimeter'</span>, <span class="hljs-string">'mean area'</span>, <span class="hljs-string">'mean smoothness'</span>, <span class="hljs-string">'mean compactness'</span>, <span class="hljs-string">'mean concavity'</span>, <span class="hljs-string">'mean concave points'</span>, <span class="hljs-string">'mean symmetry'</span>, <span class="hljs-string">'mean fractal dimension'</span>, <span class="hljs-string">'radius error'</span>, <span class="hljs-string">'texture error'</span>, <span class="hljs-string">'perimeter error'</span>, <span class="hljs-string">'area error'</span>, <span class="hljs-string">'smoothness error'</span>, <span class="hljs-string">'compactness error'</span>, <span class="hljs-string">'concavity error'</span>, <span class="hljs-string">'concave points error'</span>, <span class="hljs-string">'symmetry error'</span>, <span class="hljs-string">'fractal dimension error'</span>, <span class="hljs-string">'worst radius'</span>, <span class="hljs-string">'worst texture'</span>, <span class="hljs-string">'worst perimeter'</span>, <span class="hljs-string">'worst area'</span>, <span class="hljs-string">'worst smoothness'</span>, <span class="hljs-string">'worst compactness'</span>, <span class="hljs-string">'worst concavity'</span>, <span class="hljs-string">'worst concave points'</span>, <span class="hljs-string">'worst symmetry'</span>, <span class="hljs-string">'worst fractal dimension'</span>]<font></font>
dataset = load_breast_cancer()<font></font>
data = pd.DataFrame(dataset[<span class="hljs-string">'data'</span>], columns=columns)<font></font>
data[<span class="hljs-string">'cancer'</span>] = dataset[<span class="hljs-string">'target'</span>]<font></font>
display(data.head())<font></font>
display(data.info())<font></font>
display(data.isna().sum())<font></font>
display(data.describe())</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bce/fb8/b60/bcefb8b60462b7658b40e1e56f7744ab.png"></div><br>
<i><font color="#999999">      .       .  , cancer,   ,    . 0  Â« Â». 1 â€” Â« Â»</font></i><br>
 <br>
<h2><font color="#3AC1EF">2.        </font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€Scikit-learné–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†å‰²ã—ã¾ã™</font></font><code>train_test_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ãƒ¢ãƒ‡ãƒ«ã«ã§ãã‚‹ã ã‘å¤šãã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ä¸ãˆãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€è‡ªç”±ã«ä½¿ãˆã‚‹ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™ã€‚ä¸€èˆ¬ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®è¡Œæ•°ãŒå¢—ãˆã‚‹ã¨ã€æ•™è‚²ã¨è¦‹ãªã™ã“ã¨ãŒã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã®é‡ã‚‚å¢—ãˆã‚‹ã¨è¨€ãˆã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã¨ãˆã°ã€æ•°ç™¾ä¸‡è¡Œã‚ã‚‹å ´åˆã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®è¡Œã®90ï¼…ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®è¡Œã®10ï¼…ã‚’å¼·èª¿è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ã€ã‚»ãƒƒãƒˆã‚’åˆ†å‰²ã§ãã¾ã™ã€‚ãŸã ã—ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯569è¡Œã—ã‹å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãã—ã¦ã€ã“ã‚Œã¯ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã¨ãƒ†ã‚¹ãƒˆã«ã¯ãã‚Œã»ã©å¤šãã‚ã‚Šã¾ã›ã‚“ã€‚çµæœã¨ã—ã¦ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã¨æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦å…¬å¹³ã«ã™ã‚‹ãŸã‚ã«ã€ã‚»ãƒƒãƒˆã‚’2ã¤ã®ç­‰ã—ã„éƒ¨åˆ†ã«åˆ†å‰²ã—ã¾ã™-50ï¼…-ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¨50ï¼…-æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ã€‚è¨­ç½®</font></font><code>stratify=y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸¡æ–¹ãŒã€å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨åŒã˜æ¯”ç‡0ã¨1ã‚’æŒã¤ã‚ˆã†ã«ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X = data.drop(<span class="hljs-string">'cancer'</span>, axis=<span class="hljs-number">1</span>)&nbsp;&nbsp;<font></font>
y = data[<span class="hljs-string">'cancer'</span>]&nbsp;<font></font>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.50</span>, random_state = <span class="hljs-number">2020</span>, stratify=y)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.ãƒ‡ãƒ¼ã‚¿ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«é€²ã‚€å‰ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ã¦</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œä¸­å¤®æƒãˆã€ãŠã‚ˆã³ã€Œæ¨™æº–åŒ–ã€ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¯ã€ç•°ãªã‚‹é‡ãŒç•°ãªã‚‹å˜ä½ã§è¡¨ã•ã‚Œã‚‹ãŸã‚ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®æ‰‹é †ã«ã‚ˆã‚Šã€æ¨™è­˜ã®é‡è¦æ€§ã‚’åˆ¤æ–­ã™ã‚‹éš›ã«ã€æ¨™è­˜é–“ã®ã€Œå…¬æ­£ãªæˆ¦ã„ã€ã‚’çµ„ç¹”ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã•ã‚‰ã«ã€</font><font style="vertical-align: inherit;">å¾Œã§ãƒ¢ãƒ‡ãƒ«ãŒå¯¾å¿œã™ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§æ©Ÿèƒ½ã§ãã‚‹ã‚ˆã†ã«</font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Pandasãƒ‡ãƒ¼ã‚¿å‹</font></font><code>Series</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‹ã‚‰NumPyé…åˆ—</font><font style="vertical-align: inherit;">ã«å¤‰æ›</font><font style="vertical-align: inherit;">ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
ss = StandardScaler()<font></font>
X_train_scaled = ss.fit_transform(X_train)<font></font>
X_test_scaled = ss.transform(X_test)<font></font>
y_train = np.array(y_train)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.åŸºæœ¬ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆãƒ¢ãƒ‡ãƒ«No. 1ã€RFï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ç•ªå·1ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®ä¸­ã§ã€ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã¿ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨ã—ã¦æ§‹æˆã•ã‚Œã¾ã™ï¼ˆã“ã‚Œã‚‰ã®è¨­å®šã®è©³ç´°ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sklearn.ensemble.RandomForestClassifier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®å¾Œã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦å½¼å¥³ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã¯ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã§æ¸¬å®šã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> recall_score<font></font>
rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled, y_train)<font></font>
display(rfc.score(X_train_scaled, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹³ãŒã‚“ã®äºˆæ¸¬ã«ãŠã‘ã‚‹RFãƒ¢ãƒ‡ãƒ«ã«ã¨ã£ã¦æœ€ã‚‚é‡è¦ãªç‰¹æ€§ã‚’çŸ¥ã‚‹ã“ã¨ã«é–¢å¿ƒãŒã‚ã‚‹å ´åˆã¯ã€å±æ€§ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã§ã€ç‰¹æ€§ã®é‡ç—‡åº¦ã®æŒ‡æ¨™ã‚’è¦–è¦šåŒ–ã—ã¦å®šé‡åŒ–ã§ãã¾ã™</font></font><code>feature_importances_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">feats = {}
<span class="hljs-keyword">for</span> feature, importance <span class="hljs-keyword">in</span> zip(data.columns, rfc_1.feature_importances_):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;feats[feature] = importance<font></font>
importances = pd.DataFrame.from_dict(feats, orient=<span class="hljs-string">'index'</span>).rename(columns={<span class="hljs-number">0</span>: <span class="hljs-string">'Gini-Importance'</span>})<font></font>
importances = importances.sort_values(by=<span class="hljs-string">'Gini-Importance'</span>, ascending=<span class="hljs-literal">False</span>)<font></font>
importances = importances.reset_index()<font></font>
importances = importances.rename(columns={<span class="hljs-string">'index'</span>: <span class="hljs-string">'Features'</span>})<font></font>
sns.set(font_scale = <span class="hljs-number">5</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">1.7</span>)<font></font>
fig, ax = plt.subplots()<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">15</span>)<font></font>
sns.barplot(x=importances[<span class="hljs-string">'Gini-Importance'</span>], y=importances[<span class="hljs-string">'Features'</span>], data=importances, color=<span class="hljs-string">'skyblue'</span>)<font></font>
plt.xlabel(<span class="hljs-string">'Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Features'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
plt.title(<span class="hljs-string">'Feature Importance'</span>, fontsize=<span class="hljs-number">25</span>, weight = <span class="hljs-string">'bold'</span>)<font></font>
display(plt.show())<font></font>
display(importances)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a02/a8f/cd2/a02a8fcd28f87af338f364a70faeca3e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¨™è­˜ã®ã€Œé‡è¦æ€§ã€ã®è¦–è¦šåŒ–</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/830/176/e1f/830176e1fc9ce63bfedf2d727619253b.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰æ„æ€§æŒ‡æ¨™</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.ä¸»æˆåˆ†ã®æ–¹æ³•</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€åŸºæœ¬çš„ãªRFãƒ¢ãƒ‡ãƒ«ã‚’ã©ã®ã‚ˆã†ã«æ”¹å–„ã§ãã‚‹ã‹ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚ç‰¹å¾´ç©ºé–“ã®æ¬¡å…ƒã‚’å‰Šæ¸›ã™ã‚‹æ‰‹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚ˆã‚Šå°‘ãªã„å¤‰æ•°ã§åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æç¤ºã—ã€åŒæ™‚ã«ãƒ¢ãƒ‡ãƒ«ã®æ“ä½œã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã«å¿…è¦ãªè¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ã®é‡ã‚’å‰Šæ¸›ã§ãã¾ã™ã€‚ PCAã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã“ã‚Œã‚‰ã®ç‰¹å¾´ã®ç´¯ç©ã‚µãƒ³ãƒ—ãƒ«åˆ†æ•£ã‚’èª¿ã¹ã¦ã€ã©ã®ç‰¹å¾´ãŒãƒ‡ãƒ¼ã‚¿ã®åˆ†æ•£ã®ã»ã¨ã‚“ã©ã‚’èª¬æ˜ã™ã‚‹ã‹ã‚’ç†è§£ã§ãã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PCAï¼ˆ</font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã—ã¦ã€</font><font style="vertical-align: inherit;">è€ƒæ…®ã™ã‚‹å¿…è¦ã®ã‚ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæ©Ÿèƒ½ï¼‰ã®æ•°ã‚’ç¤ºã—</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ•°ã‚’æ±ºå®šã™ã‚‹å‰ã«ã€ç”Ÿæˆã•ã‚ŒãŸã™ã¹ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®èª¬æ˜ã•ã‚ŒãŸåˆ†æ•£ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ã“ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’30ã«è¨­å®šã—ã¾ã™ã€‚æ¬¡ã«ã€</font></font><code>pca_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«</font><font style="vertical-align: inherit;">è»¢é€ã—</font><font style="vertical-align: inherit;">ã¾ã™</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—</font></font><code>pca_test.fit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®å¾Œã€ãƒ‡ãƒ¼ã‚¿ã‚’è¦–è¦šåŒ–ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA<font></font>
pca_test = PCA(n_components=<span class="hljs-number">30</span>)<font></font>
pca_test.fit(X_train_scaled)<font></font>
sns.set(style=<span class="hljs-string">'whitegrid'</span>)<font></font>
plt.plot(np.cumsum(pca_test.explained_variance_ratio_))<font></font>
plt.xlabel(<span class="hljs-string">'number of components'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'cumulative explained variance'</span>)<font></font>
plt.axvline(linewidth=<span class="hljs-number">4</span>, color=<span class="hljs-string">'r'</span>, linestyle = <span class="hljs-string">'--'</span>, x=<span class="hljs-number">10</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">1</span>)<font></font>
display(plt.show())<font></font>
evr = pca_test.explained_variance_ratio_<font></font>
cvr = np.cumsum(pca_test.explained_variance_ratio_)<font></font>
pca_df = pd.DataFrame()<font></font>
pca_df[<span class="hljs-string">'Cumulative Variance Ratio'</span>] = cvr<font></font>
pca_df[<span class="hljs-string">'Explained Variance Ratio'</span>] = evr<font></font>
display(pca_df.head(<span class="hljs-number">10</span>))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6eb/65f/acc/6eb65facc6c8b05f1e910d3b2b676d5e.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ•°ãŒ10ã‚’è¶…ãˆãŸå¾Œã€ãã‚Œã‚‰ã®æ•°ã®å¢—åŠ ã¯ã€èª¬æ˜ã•ã‚ŒãŸåˆ†æ•£ã‚’å¤§å¹…ã«å¢—åŠ ã—ã¾ã›ã‚“</font></font></font></i><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f12/e3c/915/f12e3c915d761e1d4623051dac74cd8d.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã¯ã€ç´¯ç©åˆ†æ•£æ¯”ï¼ˆãƒ‡ãƒ¼ã‚¿ã®èª¬æ˜ã•ã‚ŒãŸåˆ†æ•£ã®ç´¯ç©ã‚µã‚¤ã‚ºï¼‰ã‚„èª¬æ˜ã•ã‚ŒãŸåˆ†æ•£æ¯”ï¼ˆèª¬æ˜ã•ã‚ŒãŸåˆ†æ•£ã®ç·é‡ã«å¯¾ã™ã‚‹å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¯„ä¸ï¼‰ãªã©ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒå«ã¾ã‚Œ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã¾ã™ã€‚ä¸Šè¨˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¦‹ã‚‹ã¨ã€PCAã‚’ä½¿ç”¨ã—ã¦30å¤‰æ•°ã‹ã‚‰10å¤‰æ•°ã«ç§»å‹•ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ•£ã®95ï¼…ã‚’èª¬æ˜ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»–ã®20å€‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€åˆ†æ•£ã®5ï¼…æœªæº€ã‚’å ã‚ã¾ã™ã€‚ã¤ã¾ã‚Šã€ãã‚Œã‚‰ã‚’æ‹’å¦ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ãƒ­ã‚¸ãƒƒã‚¯ã«ç¶šã„ã¦ã€æˆ‘ã€…ã¯ã®ãŸã‚ã«10ã«30ã‹ã‚‰éƒ¨å“ç‚¹æ•°ã‚’å‰Šæ¸›ã™ã‚‹PCAã‚’ä½¿ç”¨</font></font><code>X_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ã¦</font></font><code>X_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ã“ã‚Œã‚‰ã®äººå·¥çš„ã«ä½œæˆã•ã‚ŒãŸã€Œç¸®å°æ¬¡å…ƒã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’</font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã«</font><font style="vertical-align: inherit;">æ›¸ãè¾¼ã¿ã¾ã™</font></font><code>X_test_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">pca = PCA(n_components=<span class="hljs-number">10</span>)<font></font>
pca.fit(X_train_scaled)<font></font>
X_train_scaled_pca = pca.transform(X_train_scaled)<font></font>
X_test_scaled_pca = pca.transform(X_test_scaled)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€ã‚½ãƒ¼ã‚¹å¤‰æ•°ã¨å¯¾å¿œã™ã‚‹ã€Œé‡ã¿ã€ã®ç·šå½¢çµåˆã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã“ã‚Œã‚‰ã®ã€Œé‡ã¿ã€ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">pca_dims = []
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(pca_df)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pca_dims.append(<span class="hljs-string">'PCA Component {}'</span>.format(x))<font></font>
pca_test_df = pd.DataFrame(pca_test.components_, columns=columns, index=pca_dims)<font></font>
pca_test_df.head(<span class="hljs-number">10</span>).T</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/086/a28/ae4/086a28ae45e9048811cf813d4868902e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæƒ…å ±ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ </font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.ãƒ‡ãƒ¼ã‚¿ã«ä¸»æˆåˆ†åˆ†ææ³•ã‚’é©ç”¨ã—ãŸå¾Œã®åŸºæœ¬çš„ãªRFãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆãƒ¢ãƒ‡ãƒ«No. 2ã€RF + PCAï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€åˆ¥ã®åŸºæœ¬çš„ãªRFãƒ¢ãƒ‡ãƒ«ãƒ‡ãƒ¼ã‚¿</font></font><code>X_train_scaled_pca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">æ¸¡ã™ã“ã¨ãŒã§ã</font></font><code>y_train</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ç™ºè¡Œã•ã‚ŒãŸäºˆæ¸¬ã®ç²¾åº¦ãŒå‘ä¸Šã—ãŸã‹ã©ã†ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">rfc = RandomForestClassifier()<font></font>
rfc.fit(X_train_scaled_pca, y_train)<font></font>
display(rfc.score(X_train_scaled_pca, y_train))<font></font>
<span class="hljs-comment"># 1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã‚’ä»¥ä¸‹ã§æ¯”è¼ƒã—ã¾ã™ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©åŒ–ã€‚</font><font style="vertical-align: inherit;">ãƒ©ã‚¦ãƒ³ãƒ‰1ï¼šRandomizedSearchCV</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸»æˆåˆ†åˆ†ææ³•ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ãŸå¾Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼</font></a><font style="vertical-align: inherit;">ã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">æœ€é©åŒ–</font></a><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨</font><font style="vertical-align: inherit;">ã—ã¦ã€RFãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹äºˆæ¸¬ã®å“è³ªã‚’å‘ä¸Šã•ã›ã‚‹</font><font style="vertical-align: inherit;">ã“ã¨ãŒã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®ã€Œè¨­å®šã€ã®ã‚ˆã†ãªã‚‚ã®ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«æœ€é©ãªè¨­å®šã¯åˆ¥ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ãã‚Œã‚‰ã‚’æœ€é©åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RandomizedSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åºƒç¯„å›²ã®å€¤ã‚’ã‹ãªã‚Šå¤§ã¾ã‹ã«èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ RFãƒ¢ãƒ‡ãƒ«ã®ã™ã¹ã¦ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã«ã‚ã‚Šã¾ã™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œæ¥­ã®éç¨‹ã§</font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€å„ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã”ã¨ã«ã€ãƒ†ã‚¹ãƒˆã™ã‚‹å¿…è¦ã®ã‚ã‚‹å€¤ã®ç¯„å›²ã‚’å«ã‚€</font><font style="vertical-align: inherit;">ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç”Ÿæˆ</font><font style="vertical-align: inherit;">ã—ã¾ã™ã€‚æ¬¡ã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚</font></font><code>rs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°ã‚’ä½¿ç”¨ã—</font></font><code>RandomizedSearchCV()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦ã€RFãƒ¢ãƒ‡ãƒ«</font></font><code>param_dist</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€åå¾©æ•°ã€ãŠã‚ˆã³</font><font style="vertical-align: inherit;">å®Ÿè¡Œã™ã‚‹å¿…è¦</font><font style="vertical-align: inherit;">ãŒã‚ã‚‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº¤å·®æ¤œè¨¼ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°ã‚’</font><font style="vertical-align: inherit;">æ¸¡ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’</font></font><code>verbose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã®æ“ä½œä¸­ã«ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦è¡¨ç¤ºã•ã‚Œã‚‹æƒ…å ±ã®é‡ã‚’åˆ¶å¾¡ã§ãã¾ã™ï¼ˆãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã®æƒ…å ±ã®å‡ºåŠ›ãªã©ï¼‰ã€‚</font><font style="vertical-align: inherit;">ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã®å‹•ä½œã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚³ã‚¢ã®æ•°ã‚’æŒ‡å®šã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œ</font></font><code>n_jobs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’å€¤ã«</font><font style="vertical-align: inherit;">è¨­å®šã™ã‚‹</font><font style="vertical-align: inherit;">ã¨ã€</font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚³ã‚¢ãŒä½¿ç”¨ã•ã‚Œã‚‹ãŸã‚ã€ãƒ¢ãƒ‡ãƒ«ã®å‹•ä½œãŒé€Ÿããªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é¸æŠã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ã€Œãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã€å†…ã®ã€Œãƒ„ãƒªãƒ¼ã€ã®æ•°ã€‚</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -åˆ†å‰²ã‚’é¸æŠã™ã‚‹æ©Ÿèƒ½ã®æ•°ã€‚</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æœ¨ã®æœ€å¤§æ·±åº¦ã€‚</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ãƒ„ãƒªãƒ¼ãƒãƒ¼ãƒ‰ã‚’åˆ†å‰²ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ€å°æ•°ã€‚</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -è‘‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ€å°æ•°ã€‚</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -returnã‚’ä½¿ç”¨ã—ã¦ã‚µãƒ–ã‚µãƒ³ãƒ—ãƒ«ãƒ„ãƒªãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚</font></font></li>
</ul><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> RandomizedSearchCV<font></font>
n_estimators = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">100</span>, stop = <span class="hljs-number">1000</span>, num = <span class="hljs-number">10</span>)]<font></font>
max_features = [<span class="hljs-string">'log2'</span>, <span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">1</span>, stop = <span class="hljs-number">15</span>, num = <span class="hljs-number">15</span>)]<font></font>
min_samples_split = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
min_samples_leaf = [int(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> np.linspace(start = <span class="hljs-number">2</span>, stop = <span class="hljs-number">50</span>, num = <span class="hljs-number">10</span>)]<font></font>
bootstrap = [<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]<font></font>
param_dist = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
rs = RandomizedSearchCV(rfc_2,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param_dist,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_iter = <span class="hljs-number">100</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv = <span class="hljs-number">3</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verbose = <span class="hljs-number">1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n_jobs=<span class="hljs-number">-1</span>,&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random_state=<span class="hljs-number">0</span>)<font></font>
rs.fit(X_train_scaled_pca, y_train)<font></font>
rs.best_params_<font></font>
<span class="hljs-comment"># {'n_estimators': 700,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'min_samples_leaf': 2,</span>
<span class="hljs-comment"># 'max_features': 'log2',</span>
<span class="hljs-comment"># 'max_depth': 11,</span>
<span class="hljs-comment"># 'bootstrap': True}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</font></font><code>n_iter = 100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><code>cv = 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ä½¿ç”¨</font><font style="vertical-align: inherit;">ã—ã¦</font><font style="vertical-align: inherit;">ã€300å€‹ã®RFãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€ä¸Šè¨˜ã®ãƒã‚¤ãƒ‘ãƒ¼</font><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®</font><font style="vertical-align: inherit;">çµ„ã¿åˆã‚ã›ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã—ã¾ã—ãŸã€‚</font></font><code>best_params_ </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€é«˜ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ä¸€é€£ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«ã¤ã„ã¦ã¯</font><font style="vertical-align: inherit;">ã€å±æ€§</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å‚ç…§ã—ã¦ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ã“ã®æ®µéšã§ã¯ã€æ¬¡ã®ãƒ©ã‚¦ãƒ³ãƒ‰ã®æœ€é©åŒ–ã§èª¿æŸ»ã™ã‚‹ä¾¡å€¤ã®ã‚ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ç¯„å›²ã«é–¢ã™ã‚‹æœ€ã‚‚èˆˆå‘³æ·±ã„ãƒ‡ãƒ¼ã‚¿ãŒå¾—ã‚‰ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¤œç´¢ã‚’ç¶šã‘ã‚‹ä¾¡å€¤ãŒã‚ã‚‹å€¤ã®ç¯„å›²ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã€RandomizedSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®çµæœã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ç°¡å˜ã«å–å¾—ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">rs_df = pd.DataFrame(rs.cv_results_).sort_values(<span class="hljs-string">'rank_test_score'</span>).reset_index(drop=<span class="hljs-literal">True</span>)<font></font>
rs_df = rs_df.drop([<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_fit_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'mean_score_time'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_score_time'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'params'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split0_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split1_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'split2_test_score'</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'std_test_score'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axis=<span class="hljs-number">1</span>)<font></font>
rs_df.head(<span class="hljs-number">10</span>)</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/617/b8c/20b/617b8c20b787acc3c76c23d9235b4b5a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RandomizedSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®çµæœ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ¬¡ã«ã€Xè»¸ãŒãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼å€¤ã§ã‚ã‚Šã€Yè»¸ãŒãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ç¤ºã•ã‚Œã‚‹å¹³å‡å€¤ã§ã‚ã‚‹æ£’ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã«ã‚ˆã‚Šã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ã©ã®å€¤ãŒå¹³å‡ã—ã¦æœ€é«˜ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç¤ºã™ã‹ã‚’ç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">fig, axs = plt.subplots(ncols=<span class="hljs-number">3</span>, nrows=<span class="hljs-number">2</span>)<font></font>
sns.set(style=<span class="hljs-string">"whitegrid"</span>, color_codes=<span class="hljs-literal">True</span>, font_scale = <span class="hljs-number">2</span>)<font></font>
fig.set_size_inches(<span class="hljs-number">30</span>,<span class="hljs-number">25</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_n_estimators'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'lightgrey'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.83</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'n_estimators'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_split'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'coral'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.85</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'min_samples_split'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_min_samples_leaf'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'lightgreen'</span>)<font></font>
axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'min_samples_leaf'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_features'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>], color=<span class="hljs-string">'wheat'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>].set_title(label = <span class="hljs-string">'max_features'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_max_depth'</span>, y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], color=<span class="hljs-string">'lightpink'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_ylim([<span class="hljs-number">.80</span>,<span class="hljs-number">.93</span>])axs[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>].set_title(label = <span class="hljs-string">'max_depth'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
sns.barplot(x=<span class="hljs-string">'param_bootstrap'</span>,y=<span class="hljs-string">'mean_test_score'</span>, data=rs_df, ax=axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], color=<span class="hljs-string">'skyblue'</span>)<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_ylim([<span class="hljs-number">.88</span>,<span class="hljs-number">.92</span>])<font></font>
axs[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>].set_title(label = <span class="hljs-string">'bootstrap'</span>, size=<span class="hljs-number">30</span>, weight=<span class="hljs-string">'bold'</span>)<font></font>
plt.show()</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/418/311/ba6/418311ba6c38bfcebbf152af810d6b58.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚¤ãƒ‘ãƒ¼</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼</font><i><font color="#999999"><font style="vertical-align: inherit;">ã®å€¤ã®</font></font></i><font style="vertical-align: inherit;">åˆ†æä¸Šè¨˜ã®ã‚°ãƒ©ãƒ•ã‚’åˆ†æã™ã‚‹ã¨ã€</font><i><font color="#999999"><font style="vertical-align: inherit;">ãƒã‚¤ãƒ‘ãƒ¼</font></font></i><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å„å€¤ãŒå¹³å‡ã—ã¦ãƒ¢ãƒ‡ãƒ«ã«ã©ã®ã‚ˆã†ã«å½±éŸ¿ã™ã‚‹ã‹ã‚’èª¬æ˜ã™ã‚‹èˆˆå‘³æ·±ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><code>n_estimators</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š300ã€500ã€700ã®å€¤ã¯ã€æ˜ã‚‰ã‹ã«æœ€è‰¯ã®å¹³å‡çµæœã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font></li>
<li><code>min_samples_split</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š2ã‚„7ã®ã‚ˆã†ãªå°ã•ãªå€¤ãŒæœ€è‰¯ã®çµæœã‚’ç¤ºã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</font><font style="vertical-align: inherit;">å€¤23ã‚‚è¦‹æ „ãˆãŒè‰¯ã„ã§ã™ã€‚ã“ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®2ã‚’è¶…ãˆã‚‹å€¤ã¨ã€ç´„23ã®å€¤ã‚’èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></li>
<li><code>min_samples_leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šã“ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€¤ãŒå°ã•ã„ã¨ã€ã‚ˆã‚Šè‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã¨ã„ã†æ„Ÿã˜ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€2ã¨7ã®é–“ã®å€¤ã‚’ä½“é¨“ã§ãã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚</font></font></li>
<li><code>max_features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šã‚ªãƒ—ã‚·ãƒ§ãƒ³</font></font><code>sqrt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯æœ€é«˜ã®å¹³å‡çµæœã‚’ä¸ãˆ</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font></li>
<li><code>max_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€¤ã¨ãƒ¢ãƒ‡ãƒ«ã®çµæœã®é–“ã«æ˜ç¢ºãªé–¢ä¿‚ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€å€¤2ã€3ã€7ã€11ã€15ã¯è¦‹æ „ãˆãŒè‰¯ã„ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚</font></font></li>
<li><code>bootstrap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šå€¤</font></font><code>False</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯æœ€è‰¯ã®å¹³å‡çµæœã‚’ç¤ºã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã€ã“ã‚Œã‚‰ã®èª¿æŸ»çµæœã‚’ä½¿ç”¨ã—ã¦ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®2ç•ªç›®ã®ãƒ©ã‚¦ãƒ³ãƒ‰ã®æœ€é©åŒ–ã«é€²ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã«ã‚ˆã‚Šã€é–¢å¿ƒã®ã‚ã‚‹å€¤ã®ç¯„å›²ãŒç‹­ã¾ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©åŒ–ã€‚</font><font style="vertical-align: inherit;">ãƒ©ã‚¦ãƒ³ãƒ‰2ï¼šGridSearchCVï¼ˆãƒ¢ãƒ‡ãƒ«No. 3ã€RF + PCA + HTã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€çµ‚æº–å‚™ï¼‰</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RandomizedSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é©ç”¨ã—ãŸå¾Œã€GridSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æœ€é©ãªçµ„ã¿åˆã‚ã›ã‚’ã‚ˆã‚Šæ­£ç¢ºã«æ¤œç´¢ã—ã¾ã™ã€‚ã“ã“ã§ã¯åŒã˜ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æŸ»ã—ã¾ã™ãŒã€ç¾åœ¨ã¯ã€ãã‚Œã‚‰ã®æœ€è‰¯ã®çµ„ã¿åˆã‚ã›ã«å¯¾ã—ã¦ã‚ˆã‚Šã€Œå¾¹åº•çš„ãªã€æ¤œç´¢ã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚ GridSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å„çµ„ã¿åˆã‚ã›ã‚’èª¿ã¹ã¾ã™ã€‚ã“ã‚Œã«ã¯ã€æ¤œç´¢ã®åå¾©å›æ•°ã‚’å€‹åˆ¥ã«è¨­å®šã™ã‚‹å ´åˆã€RandomizedSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«å¤šãã®è¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ãŒå¿…è¦ã§ã™ã€‚ãŸã¨ãˆã°ã€3ã¤ã®ãƒ–ãƒ­ãƒƒã‚¯ã§äº¤å·®æ¤œè¨¼ã‚’è¡Œã†6ã¤ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ãã‚Œãã‚Œã«ã¤ã„ã¦10å€‹ã®å€¤ã‚’èª¿æŸ»ã™ã‚‹ã«ã¯ã€10â¶x 3ã€ã¤ã¾ã‚Š3,000,000å€‹ã®ãƒ¢ãƒ‡ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãã®ãŸã‚ã€RandomizedSearchCVã‚’é©ç”¨ã—ãŸå¾Œã€èª¿æŸ»ã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€¤ã®ç¯„å›²ã‚’ç‹­ã‚ãŸå¾Œã€GridSearchCVã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€RandomizedSearchCVã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦è¦‹ã¤ã‘ãŸã‚‚ã®ã‚’ä½¿ç”¨ã—ã¦ã€æœ€ã‚‚ã‚ˆãè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€¤ã‚’èª¿ã¹ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV<font></font>
n_estimators = [<span class="hljs-number">300</span>,<span class="hljs-number">500</span>,<span class="hljs-number">700</span>]<font></font>
max_features = [<span class="hljs-string">'sqrt'</span>]<font></font>
max_depth = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>]<font></font>
min_samples_split = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>]<font></font>
min_samples_leaf = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>]<font></font>
bootstrap = [<span class="hljs-literal">False</span>]<font></font>
param_grid = {<span class="hljs-string">'n_estimators'</span>: n_estimators,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_features'</span>: max_features,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'max_depth'</span>: max_depth,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_split'</span>: min_samples_split,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'min_samples_leaf'</span>: min_samples_leaf,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'bootstrap'</span>: bootstrap}<font></font>
gs = GridSearchCV(rfc_2, param_grid, cv = <span class="hljs-number">3</span>, verbose = <span class="hljs-number">1</span>, n_jobs=<span class="hljs-number">-1</span>)<font></font>
gs.fit(X_train_scaled_pca, y_train)<font></font>
rfc_3 = gs.best_estimator_<font></font>
gs.best_params_<font></font>
<span class="hljs-comment"># {'bootstrap': False,</span>
<span class="hljs-comment"># 'max_depth': 7,</span>
<span class="hljs-comment"># 'max_features': 'sqrt',</span>
<span class="hljs-comment"># 'min_samples_leaf': 3,</span>
<span class="hljs-comment"># 'min_samples_split': 2,</span>
<span class="hljs-comment"># 'n_estimators': 500}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€3ã¤ã®ãƒ–ãƒ­ãƒƒã‚¯ã§540ï¼ˆ3 x 1 x 5 x 6 x 6 x 1ï¼‰ãƒ¢ãƒ‡ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®äº¤å·®æ¤œå®šã‚’é©ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€1620ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæä¾›ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ä»Šã€RandomizedSearchCVã¨GridSearchCVã‚’ä½¿ç”¨ã—ãŸå¾Œã€å±æ€§ã«</font></font><code>best_params_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§»å‹•ã—ã¦ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ã©ã®å€¤ãŒãƒ¢ãƒ‡ãƒ«ãŒèª¿æŸ»ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§æœ€é©ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™ï¼ˆã“ã‚Œã‚‰ã®å€¤ã¯ã€å‰ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ä¸‹éƒ¨ã§ç¢ºèªã§ãã¾ã™ï¼‰ ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ã€ãƒ¢ãƒ‡ãƒ«ç•ªå·3ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ã§ã®ãƒ¢ãƒ‡ãƒ«ã®å“è³ªã®è©•ä¾¡</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ä½œæˆã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¤ã¾ã‚Šã€è³‡æ–™ã®å†’é ­ã§èª¬æ˜ã—ãŸ3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦è©±ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š</font></font><br>
<br>
<pre><code class="python hljs">y_pred = rfc.predict(X_test_scaled)<font></font>
y_pred_pca = rfc.predict(X_test_scaled_pca)<font></font>
y_pred_gs = gs.best_estimator_.predict(X_test_scaled_pca)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã®èª¤å·®è¡Œåˆ—ã‚’ä½œæˆã—ã€å„ãƒ¢ãƒ‡ãƒ«ãŒä¹³ãŒã‚“ã‚’ã©ã‚Œã ã‘ã†ã¾ãäºˆæ¸¬ã§ãã‚‹ã‹ã‚’èª¿ã¹ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix<font></font>
conf_matrix_baseline = pd.DataFrame(confusion_matrix(y_test, y_pred), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_baseline_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_pca), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
conf_matrix_tuned_pca = pd.DataFrame(confusion_matrix(y_test, y_pred_gs), index = [<span class="hljs-string">'actual 0'</span>, <span class="hljs-string">'actual 1'</span>], columns = [<span class="hljs-string">'predicted 0'</span>, <span class="hljs-string">'predicted 1'</span>])<font></font>
display(conf_matrix_baseline)<font></font>
display(<span class="hljs-string">'Baseline Random Forest recall score'</span>, recall_score(y_test, y_pred))<font></font>
display(conf_matrix_baseline_pca)<font></font>
display(<span class="hljs-string">'Baseline Random Forest With PCA recall score'</span>, recall_score(y_test, y_pred_pca))<font></font>
display(conf_matrix_tuned_pca)<font></font>
display(<span class="hljs-string">'Hyperparameter Tuned Random Forest With PCA Reduced Dimensionality recall score'</span>, recall_score(y_test, y_pred_gs))</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f48/a9e/92f/f48a9e92fd5fdca613d6073e00bae2c6.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã®ä½œæ¥­çµæœ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã“ã“ã§ã¯ã€ãƒ¡ãƒˆãƒªãƒƒã‚¯ã®ã€Œå®Œå…¨æ€§ã€ï¼ˆå†ç¾ï¼‰ãŒè©•ä¾¡ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">äº‹å®Ÿã€ç§ãŸã¡ã¯ãŒã‚“ã®è¨ºæ–­ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ç™ºè¡Œã•ã‚ŒãŸå½é™°æ€§ã®äºˆæ¸¬ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã“ã¨ã«éå¸¸ã«é–¢å¿ƒãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã“ã¨ã‹ã‚‰ã€åŸºæœ¬çš„ãªRFãƒ¢ãƒ‡ãƒ«ãŒæœ€è‰¯ã®çµæœã‚’ã‚‚ãŸã‚‰ã—ãŸã¨çµè«–ä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®å®Œæˆç‡ã¯94.97ï¼…ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€ãŒã‚“ã®æ‚£è€…179äººã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã¯ãã‚Œã‚‰ã®170ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¦‚è¦</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ç ”ç©¶ã¯é‡è¦ãªè¦³å¯Ÿã‚’æä¾›ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä¸»æˆåˆ†åˆ†ææ³•ã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å¤§è¦æ¨¡æœ€é©åŒ–ã‚’ä½¿ç”¨ã™ã‚‹RFãƒ¢ãƒ‡ãƒ«ã¯ã€æ¨™æº–è¨­å®šã®æœ€ã‚‚ä¸€èˆ¬çš„ãªãƒ¢ãƒ‡ãƒ«ã¨åŒã˜ã‚ˆã†ã«æ©Ÿèƒ½ã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ã“ã‚Œã¯ã‚ãªãŸè‡ªèº«ã‚’æœ€ã‚‚å˜ç´”ãªãƒ¢ãƒ‡ãƒ«ã ã‘ã«é™å®šã™ã‚‹ç†ç”±ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">åˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã‚’è©¦ã•ãªã‘ã‚Œã°ã€ã©ã¡ã‚‰ãŒæœ€è‰¯ã®çµæœã‚’ç¤ºã™ã‹ã‚’è¨€ã†ã“ã¨ã¯ä¸å¯èƒ½ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€æ‚£è€…ã®ãŒã‚“ã®å­˜åœ¨ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«ã®å ´åˆã€ãƒ¢ãƒ‡ãƒ«ãŒå„ªã‚Œã¦ã„ã‚‹ã»ã©ã€ã‚ˆã‚Šå¤šãã®å‘½ã‚’æ•‘ã†ã“ã¨ãŒã§ãã‚‹ã¨è¨€ãˆã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èª­è€…ã®çš†æ§˜ï¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ©Ÿæ¢°å­¦ç¿’æ‰‹æ³•ã‚’ä½¿ç”¨ã—ã¦ã©ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ã‚’è§£æ±ºã—ã¾ã™ã‹ï¼Ÿ</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488330/index.html">ã‚¸ãƒ§ãƒ¼ã‚¸ãƒ»ã‚«ãƒ¼ãƒªãƒ³ã¨ã®è‹±èªï¼šè¡¨ç¾å­¦çš„å˜ä½ã«ã¤ã„ã¦ã®ç‹¬å‰µçš„ãªã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚’åˆ†æã—ã¾ã™</a></li>
<li><a href="../ja488332/index.html">ã‚¼ãƒ­ã€1ã€2ã€ãƒ•ãƒ¬ãƒ‡ã‚£ãŒã‚ãªãŸã‚’è¿ãˆã¾ã™</a></li>
<li><a href="../ja488336/index.html">æ³¢å‹•é–¢æ•°æŠ˜ã‚ŠãŸãŸã¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ãƒ’ãƒ³ãƒˆ</a></li>
<li><a href="../ja488338/index.html">Googleã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚·ãƒƒãƒ—ï¼šãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ’ã€ãƒ­ãƒ³ãƒ‰ãƒ³ã€ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼</a></li>
<li><a href="../ja488340/index.html">è·æ¥­ï¼šãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…</a></li>
<li><a href="../ja488346/index.html">Linuxã®Python 3.7ä»®æƒ³ç’°å¢ƒã§ã®SCIPãŠã‚ˆã³GLPKã‚’ä½¿ç”¨ã—ãŸor-toolsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
<li><a href="../ja488348/index.html">ã‚¦ã‚§ãƒ“ãƒŠãƒ¼ã€Œ10ã®ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã¨1æ™‚é–“ã§ãã‚Œã‚‰ã‚’å…‹æœã™ã‚‹æ–¹æ³•ã€2æœˆ17æ—¥20:00ãƒ¢ã‚¹ã‚¯ãƒ¯æ™‚é–“</a></li>
<li><a href="../ja488352/index.html">VDIã‚³ã‚¹ãƒˆã®æ¯”è¼ƒï¼šã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã¨ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¯ãƒ©ã‚¦ãƒ‰</a></li>
<li><a href="../ja488356/index.html">ã‚µãƒ³ã‚¯ãƒˆãƒšãƒ†ãƒ«ãƒ–ãƒ«ã‚°å›½ç«‹æµ·æ´‹å·¥ç§‘å¤§å­¦ã§ã®ãƒ€ãƒƒã‚½ãƒ¼ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã‚ºè£½å“ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</a></li>
<li><a href="../ja488360/index.html">ãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿ã®ç¥è©±ã¨ãƒ‡ã‚¸ã‚¿ãƒ«æ–‡åŒ–</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>