<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏻 🤸🏾 👨‍👨‍👧 Erkennen Sie COVID-19 in Röntgenstrahlen mit Keras, TensorFlow und Deep Learning ⚠️ ◽️ 👩🏻‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mithilfe dieses Handbuchs lernen wir mithilfe von Keras, TensorFlow und Deep Training, wie COVID-19 automatisch aus einem manuell zusammengestellten D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erkennen Sie COVID-19 in Röntgenstrahlen mit Keras, TensorFlow und Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mithilfe dieses Handbuchs lernen wir mithilfe von Keras, TensorFlow und Deep Training, wie COVID-19 automatisch aus einem manuell zusammengestellten Datensatz aus Röntgenbildern bestimmt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie so viele andere mache ich mir aufrichtige Sorgen um COVID-19. </font><font style="vertical-align: inherit;">Mir ist aufgefallen, dass ich ständig meinen Zustand analysiere und mich frage, ob und wann ich die Krankheit bekommen werde. </font><font style="vertical-align: inherit;">Und je mehr ich mir darüber Sorgen mache, desto mehr wird es zu einem schmerzhaften Spiel des Geistes, bei dem Symptomatik mit Hypochondrien kombiniert wird:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich wachte am Morgen auf und fühlte Schmerzen und Schwäche.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als ich aus dem Bett krabbelte, fand ich eine laufende Nase (obwohl </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bereits bekannt ist,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass eine laufende Nase </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kein</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Symptom für COVID-19 ist).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als ich ins Badezimmer kam, um einen Papierschal zu holen, hustete ich bereits.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anfangs habe ich nicht viel darauf geachtet - ich bin allergisch gegen Pollen und aufgrund des warmen Wetters an der Ostküste der USA war dieser Frühling ein früher Frühling. </font><font style="vertical-align: inherit;">Dies sind höchstwahrscheinlich allergische Symptome. </font><font style="vertical-align: inherit;">Aber tagsüber besserte sich mein Zustand nicht. </font><font style="vertical-align: inherit;">Ich sitze und schreibe dieses Handbuch mit einem Thermometer im Mund. </font><font style="vertical-align: inherit;">Ich schaue nach unten und sehe 37,4 ° C. </font><font style="vertical-align: inherit;">Meine normale Körpertemperatur ist mit 36,3 ° C etwas niedriger als bei anderen. </font><font style="vertical-align: inherit;">Alles über 37,2 ° C ist für mich schon etwas Hitze. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Husten und leichtes Fieber? </font><font style="vertical-align: inherit;">Es könnte COVID-19 sein ... oder nur meine Allergie. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist unmöglich, es ohne Tests herauszufinden, und genau diese „Unwissenheit“ macht die Situation auf menschlicher Ebene so einschüchternd.</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UFO Care Minute</font></font></h3><br>
     COVID-19 —     ,   SARS-CoV-2 (2019-nCoV).        —    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz meiner Befürchtungen versuche ich rational zu denken. Ich bin etwas über 30, in guter Verfassung und meine Immunität ist stark. Ich werde mich in Quarantäne stellen (nur für den Fall), mich ausruhen und mich um alles kümmern. COVID-19 macht mir aus Sicht der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persönlichen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gesundheit </font><font style="vertical-align: inherit;">keine Angst </font><font style="vertical-align: inherit;">(zumindest werde ich es für mich selbst aushalten). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mache mir also Sorgen um meine älteren Verwandten, einschließlich all derer, bei denen die Krankheit bereits diagnostiziert wurde, sowie derer, die sich in Pflegeheimen und Krankenhäusern befinden. Diese Menschen sind verletzlich und es wird schrecklich sein, wenn sie an COVID-19 sterben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstatt nichts zu tun und mich von meiner Krankheit zu Hause halten zu lassen (sei es Allergie, COVID-19 oder meine Ängste), beschloss ich zu tun, was ich kann:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich werde den Code schreiben, Experimente durchführen und anhand praktischer Beispiele anderen den Umgang mit Computer Vision und Deep Learning beibringen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich muss sofort sagen, dass dies </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht der</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wissenschaftlichste Artikel ist, den ich geschrieben habe. </font><font style="vertical-align: inherit;">Sie ist überhaupt nicht wissenschaftlich. </font><font style="vertical-align: inherit;">Die verwendeten Methoden und Datensätze sind </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Veröffentlichung wert. </font><font style="vertical-align: inherit;">Aber sie dienen als Ausgangspunkt für diejenigen, die zumindest </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etwas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> helfen wollen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mache mir Sorgen um dich und diese Gemeinschaft. </font><font style="vertical-align: inherit;">Ich möchte helfen, was ich kann: Dieser Artikel ist mein Weg, um schwierige Zeiten mental zu bewältigen und gleichzeitig anderen in einer ähnlichen Situation zu helfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Handbuch lernen Sie:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sammeln eines OpenSource-Datensatzes von Röntgenbildern von Patienten mit nachgewiesenem COVID-19.</font></font></li>
<li>   «» (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ich habe dies bereits angedeutet, aber jetzt werde ich direkt sagen. </font><font style="vertical-align: inherit;">Die hier beschriebenen Techniken dienen nur zu Bildungszwecken. </font><font style="vertical-align: inherit;">Dies ist </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keine</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strenge wissenschaftliche Studie, sie wird nicht in Fachzeitschriften veröffentlicht. </font><font style="vertical-align: inherit;">Dieser Artikel richtet sich an Leser, die sich für Computer Vision und Deep Learning interessieren, in der Praxis lernen möchten, sowie an diejenigen, die sich von aktuellen Ereignissen inspirieren lassen. </font><font style="vertical-align: inherit;">Ich bitte Sie, dies alles zu berücksichtigen. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im ersten Teil des Handbuchs werden wir diskutieren, wie COVID-19 in Lungenröntgenstrahlen nachgewiesen werden kann. </font><font style="vertical-align: inherit;">Dann diskutieren wir den Datensatz selbst. </font><font style="vertical-align: inherit;">Und dann werde ich zeigen, wie das Modell mit Keras und TensorFlow trainiert wird, um COVID-19 in unseren Bildern vorherzusagen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erläuterung</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Artikel zur automatischen Erkennung von COVID-19 wurde nur zu Bildungszwecken verfasst. Es </font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist nicht</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beschreibt ein zuverlässiges und genaues Diagnosesystem COVID-19, hat weder von einem professionellen noch aus wissenschaftlicher Sicht getestet.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mein Ziel ist es, Sie zu inspirieren und zu zeigen, wie das Studium von Computer Vision und Deep Learning mit der anschließenden Anwendung dieses Wissens im medizinischen Bereich einen großen Einfluss auf die Welt haben kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie sich</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vor: </font><strong><font style="vertical-align: inherit;">Sie brauchen keine medizinische Ausbildung, um die Medizin zu beeinflussen</font></strong><font style="vertical-align: inherit;"> . Deep Training-Praktiker arbeiten heute eng mit Ärzten und anderen Ärzten zusammen, um komplexe Probleme zu lösen, Leben zu retten und die Welt zu einem besseren Ort zu machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, meine Führung inspiriert Sie dazu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Anbetracht all dessen sind Forscher, Kuratoren von Magazinen und das Überprüfungssystem bereits mit Arbeiten überladen, die COVID-19-Prognosemodelle von zweifelhafter Qualität beschreiben. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitte senden Sie den Code und das Modell dieses Artikels nicht an eine Zeitschrift oder eine wissenschaftliche Veröffentlichung - Sie werden nur das Chaos erhöhen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie auf der Grundlage dieses Artikels (oder einer anderen Veröffentlichung zu COVID-19) Nachforschungen anstellen möchten, halten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie sich zur Beschreibung von Vorhersagemodellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">TRIPOD-Leitfaden.</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wie Sie verstehen, kann der Einsatz künstlicher Intelligenz im medizinischen Bereich sehr schwerwiegende Folgen haben. Veröffentlichen und verwenden Sie solche Modelle nur, wenn Sie ein Facharzt sind oder von diesen Fachleuten ausführlich beraten wurden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie kann COVID-19 in Röntgenstrahlen nachgewiesen werden?</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 1:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beispiel einer Röntgenaufnahme eines mit COVID-19 diagnostizierten Patienten. </font><font style="vertical-align: inherit;">In diesen Bildern können Sie den Klassifikator mithilfe von Keras und TensorFlow unterrichten, um COVID-19 zu bestimmen. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Testen auf COVID-19 ist jetzt schwierig - es gibt</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht genügend Tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber es ist unmöglich, sie schnell zu erstellen, was nur die Panik erhöht. </font><font style="vertical-align: inherit;">Und in Panik gibt es Schurken, die versuchen, von anderen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu profitieren und gefälschte Tests für COVID-19 zu verkaufen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wobei sie in sozialen Netzwerken und Instant Messenger ahnungslose Opfer finden. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angesichts der begrenzten Anzahl von Tests müssen wir uns auf andere Diagnosemethoden verlassen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich entschied mich für die Untersuchung von Röntgenstrahlen, da Ärzte diese häufig verwenden und Computertomographieergebnisse zur Diagnose von Lungenentzündung, Lungenentzündung, Abszessen und vergrößerten Lymphknoten verwenden. Da das Virus die Epithelzellen angreift, die die Atemwege auskleiden, können wir mithilfe von Röntgenstrahlen den Zustand der menschlichen Lunge untersuchen. Und da Röntgengeräte fast überall sind, können Sie mit den Bildern COVID-19 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Testkits erkennen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu den Nachteilen des Verfahrens zählen der Bedarf an Radiologen sowie eine erhebliche Verarbeitungszeit. Und Zeit ist besonders teuer, wenn Menschen auf der ganzen Welt krank sind. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und um Ärzten Zeit zu sparen, müssen Sie ein automatisches Analysesystem erstellen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis:</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 2:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Links Bilder von Menschen mit positivem Ergebnis (infiziert), rechts Bilder mit negativem Ergebnis. </font><font style="vertical-align: inherit;">In diesen Bildern werden wir das Modell unter Verwendung von TensorFlow und Keras lehren, um das Vorhandensein von COVID-19 (dh einer durch Coronavirus verursachten Krankheit) automatisch vorherzusagen. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Datensatz der hier verwendeten Patientenbilder mit COVID-19 wurde unter der Aufsicht von</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , einem Doktoranden an der Universität von Montreal, zusammengestellt. </font><font style="vertical-align: inherit;">Vor einigen Tagen begann Cohen, Röntgenbilder von Patienten mit COVID-19 zu sammeln und</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in das GitHub-Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hochzuladen</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"> . </font></a><font style="vertical-align: inherit;">Dort finden Sie Beispiele nicht nur für diese Krankheit, sondern auch für MERS, SARS und ARDS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So erstellen Sie einen Datensatz I:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysieren Sie die Datei metadata.csv aus dem Repository.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle Zeilen ausgewählt:</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insgesamt wurden </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 Aufnahmen mit positiven Ergebnissen auf COVID-19 erhalten</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">links</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie nun die Bilder von gesunden Menschen.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dazu habe ich einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaggle-Lungenröntgendatensatz (Lungenentzündung) genommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 Bilder von gesunden Menschen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausgewählt </font><font style="vertical-align: inherit;">( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rechts</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Dieser Datensatz weist eine Reihe von Nachteilen auf, einschließlich schlecht oder falsch ausgefüllter Etiketten, eignet sich jedoch als Ausgangspunkt für die Prüfung der Hypothese des COVID-19-Detektors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis bekam ich </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 Schüsse:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25 Patienten mit COVID-19 und 25 gesunde. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können den Datensatz über den </font></font></strong><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong><font style="vertical-align: inherit;">Link</font></strong></a><strong><font style="vertical-align: inherit;"> herunterladen</font></strong></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong><font style="vertical-align: inherit;"></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Außerdem habe ich Python-Skripte hinzugefügt, mit denen ich das Dataset generiert habe, aber in diesem Artikel habe ich sie nicht berücksichtigt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projektstruktur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie den Code und die Daten herunter. </font><font style="vertical-align: inherit;">Ziehen Sie die Dateien von dort heraus, und Sie erhalten die folgende Verzeichnisstruktur:</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [<span class="hljs-number">25</span> entries]<font></font>
│   └── normal [<span class="hljs-number">25</span> entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Drei Verzeichnisse, fünf Dateien. </font><font style="vertical-align: inherit;">Der Datensatz befindet sich im Datensatz / Verzeichnis und ist in zwei Klassen unterteilt - covid / und normal /. </font><font style="vertical-align: inherit;">Unten sehen wir uns das Skript train_covid19.py an, das unseren COVID-19-Detektor trainiert.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung des Schulungsskripts</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren wir mit der Feinabstimmung des neuronalen Faltungsnetzwerks fort, das COVID-19 mithilfe von Keras, TensorFlow und Deep Learning automatisch diagnostiziert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Öffnen Sie die Datei train_covid19.py und fügen Sie den folgenden Code ein:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Skript nutzt die Bibliotheken TensorFlow 2.0 und Keras, indem es die Importe von tensorflow.keras auswählt. </font><font style="vertical-align: inherit;">Auch wir verwenden:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dies ist eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De-facto-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python-Bibliothek für maschinelles Lernen.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Charting,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Hochladen und Vorverarbeiten von Bildern in einem Datensatz.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Informationen zur Installation von TensorFlow 2.0 (einschließlich Scikit-Learn, OpenCV und Matplotlib) finden Sie in meinen Tutorials für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MacOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt analysieren wir die Argumente für die Befehlszeile und initialisieren die Hyperparameter:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere drei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehlszeilenargumente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 24-31</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) umfassen:</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Pfad zum Eingabedatensatz.</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Optionaler Pfad zum Exit-Zeitplan der Lernhistorie. </font><font style="vertical-align: inherit;">Standardmäßig heißt das Diagramm plot.png, sofern in der Befehlszeile kein anderer Name angegeben ist.</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Optionaler Pfad zu unserem Ausgabe-COVID-19-Definitionsmodell. </font><font style="vertical-align: inherit;">Standardmäßig heißt es covid19.model.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt initialisieren wir die anfängliche Lernfrequenz, die Anzahl der Trainingsperioden und die Hyperparameter der Paketgröße ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 35-37</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie anschließend die Röntgenbilder herunter und verarbeiten Sie sie vor:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Daten zu laden, nehmen wir alle Pfade zu den Bildern im Verzeichnis --dataset ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeile 42</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) und dann für jeden imagePath:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir extrahieren aus dem Pfad ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeile 49</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) die Klassenbezeichnung (covid oder normal).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir laden das Bild, konvertieren es in RGB-Kanäle und reduzieren es auf eine Größe von 224 x 224 Pixel, um ein Faltungsnetzwerk zu speisen ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 53-55</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktualisieren von Listen mit Daten und Beschriftungen ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 58 und 59</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann skalieren wir die Pixelintensität in einen Bereich </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und konvertieren die Daten und Beschriftungen in das NumPy-Array-Format ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 63 und 64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Nächstes führen wir eine One-Hot-Codierung unserer Etiketten durch und teilen den Datensatz in Trainings- und Testsätze auf:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die einheitliche Etikettencodierung erfolgt in den </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 67-69</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Die Daten werden in diesem Format dargestellt:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jedes auf diese Weise codierte Label besteht aus einem Array mit zwei Elementen, in dem eines der Elemente "hot" (1) und das zweite "no" (0) ist. In den </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 73 und 74 ist der</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datensatz in zwei Teile unterteilt: 80% für das Training, 20% für das Testen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Modell zu verallgemeinern, führen wir eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenerweiterung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Datenerweiterung) durch, indem </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">eine zufällige Bilddrehung um 15 Grad im Uhrzeigersinn einstellen oder dem entgegenwirken. Das Erweiterungsgenerierungsobjekt wird in den </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 77-79</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initialisiert </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialisieren Sie nun das VGGNet-Modell und bereiten Sie es für die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feinabstimmung vor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 83 und 84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird eine Instanz des neuronalen Netzwerks VGG16 mit den Gewichten erstellt, die im Voraus auf ImageNet ohne vollständig verbundene Schicht erhalten wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes erstellen wir eine vollständig verbundene Schicht, die aus POOL =&gt; FC = SOFTMAX-Schichten ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) besteht, und platzieren sie auf VGG16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeile 97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Frieren Sie nun die CONV-Gewichte ein, sodass </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur eine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vollständig verbundene Schicht </font><font style="vertical-align: inherit;">trainiert wird </font><font style="vertical-align: inherit;">( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 101-102</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Damit ist die Abstimmung abgeschlossen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt sind wir bereit, unser Deep-Learning-Modell zu kompilieren und zu trainieren:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 106-108 wurde</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Training</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Optimierer der </font><font style="vertical-align: inherit;">Netzwerkdämpfungsgeschwindigkeit </font><font style="vertical-align: inherit;">Adam zusammengestellt. Da es sich um eine Klassifizierungsaufgabe mit zwei Klassen handelt, verwenden wir die Verlustfunktion der binären Kreuzentropie (binary_crossentropy) und nicht der kategorialen Kreuzentropie (kategoriale Kreuzentropie). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Training zu beginnen, rufen wir die Keras-Methode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fit_generator auf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und geben ihm unsere Röntgenstrahlen durch eine Datenobjekterweiterung ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 112-117</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns nun das Modell bewerten:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dazu führen wir zunächst Prognosen basierend auf der Testsuite durch und erhalten Prognoseindizes ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 121-125</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Anschließend erstellen wir den Klassifizierungsbericht ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 128 und 129</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">mit dem Dienstprogramm scikit-learn und zeigen ihn an </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berechnen wir nun die Verwirrungsmatrix für die zukünftige statistische Schätzung:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sind hier:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Matrix von Ungenauigkeiten erzeugen ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeile 133</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir verwenden diese Matrix, um die Genauigkeit, Empfindlichkeit und Spezifität zu bestimmen ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 135-137</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), und leiten dann alle diese Metriken ab ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen 141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die nachfolgende Analyse zeigen wir dann in Form eines Diagramms in einer Datei den Verlauf der Genauigkeits- und Verluständerungen an:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und schließlich serialisieren wir das tf.keras-Klassifikatormodell auf die Festplatte:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir trainieren unseren Detektor mit Keras und TensorFlow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Implementierung des Skripts train_covid19.py können wir den automatischen Detektor trainieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie den Quellcode, den Datensatz und das vorgefertigte Modell herunter. </font><font style="vertical-align: inherit;">Öffnen Sie ein Terminal und führen Sie den Befehl zum Trainieren des Detektors aus:</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatische Röntgendiagnose</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In diesem Teil "lösen" wir das Problem der Bestimmung von COVID-19 nicht. Es ist im Kontext der aktuellen Situation und nur zu Bildungszwecken geschrieben. Dies ist ein Beispiel für die praktische Anwendung von Computer Vision und Deep Learning, damit Sie sich mit verschiedenen Metriken vertraut machen können, einschließlich der üblichen Genauigkeit, Sensitivität und Spezifität (und Kompromisse, die bei der Arbeit mit medizinischen Daten berücksichtigt werden müssen). Ich wiederhole, wir </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lösen das</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Problem der Bestimmung von COVID-19 nicht.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Unser automatischer Detektor zeigte also eine Genauigkeit von</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ~ 90-92% </font></font></strong><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bei Proben von</font><font style="vertical-align: inherit;">Röntgenbildern. Für das Training des Modells wurden keine weiteren Informationen verwendet, einschließlich geografischer Lage, Bevölkerungsdichte usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben auch erhalten</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensitivität von 100%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spezifität von 80%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , was bedeutet:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von den Patienten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (echte positive Fälle) konnten </font><strong><font style="vertical-align: inherit;">wir</font></strong><font style="vertical-align: inherit;"> anhand des Modells </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in 100% der Fälle genau als „COVID-19-positiv“ identifizieren.</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von den Patienten, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die kein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 hatten (echte negative Fälle), konnten </font><strong><font style="vertical-align: inherit;">wir</font></strong><font style="vertical-align: inherit;"> anhand des Modells </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur in 80% der Fälle genau als „COVID-19-negativ“ identifizieren.</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie die Grafik zur Trainingshistorie zeigt, wird das neuronale Netzwerk trotz der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehr geringen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Größe der Trainingsdaten </font><font style="vertical-align: inherit;">nicht umgeschult </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 3:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dieses Diagramm der Genauigkeit und des Verlusts zeigt, dass unser Modell nicht umgeschult wird.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es ist großartig, dass wir bei der Erkennung von COVID-19 eine Genauigkeit von 100% erreicht haben. Die Situation mit wirklich negativen Fällen ist jedoch peinlich:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir möchten nicht diejenigen, die tatsächlich „COVID-19-positiv“ sind, „COVID-19-negativ“ zuschreiben.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir wollen am wenigsten kranke Patienten nach Hause gehen lassen, zu Familien und Freunden, um zur weiteren Ausbreitung der Krankheit beizutragen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen auch</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sehr vorsichtig</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem Anteil falsch positiver Fälle sein:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir möchten nicht fälschlicherweise jemanden als krank betrachten und ihn mit anderen Patienten unter Quarantäne stellen, damit er von ihnen infiziert wird</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Gleichgewicht zwischen Sensitivität und Spezifität finden -</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine äußerst schwierige</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufgabe, insbesondere in Bezug auf die Medizin und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insbesondere</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Bezug auf die rasche Ausbreitung von Infektionskrankheiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie über medizinisches Computer-Sehen und tiefes Lernen sprechen, sollten Sie immer daran denken, dass die Arbeit unserer Vorhersagemodelle sehr schwerwiegende Folgen haben kann: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerhafte Diagnosen können Leben kosten</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wiederhole, die Ergebnisse in diesem Artikel werden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur zu Bildungszwecken</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> präsentiert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist keine Zeitschriftenveröffentlichung. Diese Daten erfüllen nicht die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">TRIPOD-</font></a><font style="vertical-align: inherit;"> Kriterien </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für die Veröffentlichung von Prognosemodellen.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einschränkungen, Verbesserungen und weitere Arbeiten</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 4:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Heutzutage fehlt es KI- und Deep-Learning-Fachleuten an hochwertigen COVID-19-Daten, um automatische Bilderkennungssysteme effektiv zu trainieren.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eine der Haupteinschränkungen der in diesem Handbuch beschriebenen Methode sind Daten.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir haben nicht genügend (zuverlässige) Daten, um COVID-19-Detektoren zu trainieren.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Krankenhäuser haben bereits viele Fallbeispiele mit diesem Virus, aber angesichts der Privatsphäre und der Menschenrechte wird es noch schwieriger, schnell einen hochwertigen Datensatz aus medizinischen Bildern zusammenzustellen. Ich glaube, dass wir in den nächsten 12 bis 18 Monaten mehr Qualitätsdaten haben werden. Aber jetzt müssen Sie verwenden, was Sie haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe (unter Berücksichtigung meiner körperlichen und geistigen Verfassung) unter den Bedingungen begrenzter Zeit und Ressourcen versucht, diesen Leitfaden für diejenigen zu schreiben, die sich für die Verwendung von Computer Vision und Deep Learning interessieren. Aber </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ich</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> möchte Sie daran erinnern, dass </font><strong><font style="vertical-align: inherit;">ich kein professioneller Mediziner bin</font></strong><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den COVID-19-Detektor im wirklichen Leben einsetzen zu können, muss er </font><font style="vertical-align: inherit;">von echten Ärzten, die Hand in Hand mit Deep-Learning-Spezialisten arbeiten </font><font style="vertical-align: inherit;">, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">streng</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> getestet werden. Die von mir beschriebene Methode ist dafür nicht geeignet. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Außerdem muss man vorsichtig sein, was genau das Modell „lernt“.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wie ich im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grad-CAM-Handbuch geschrieben habe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist wahrscheinlich, dass das Modell Muster lernt, die für COVID-19 nicht relevant sind, aber nur zwischen zwei Datenproben unterscheiden können (d. h. positive und negative Diagnosen). Die Ergebnisse unseres Detektors müssen von Ärzten streng getestet und überprüft werden. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und schließlich werden zukünftige (und fortschrittlichere) Detektoren multimodal sein.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jetzt verwenden wir nur visuelle Daten (Röntgenstrahlen). Bessere Detektoren sollten andere Daten verwenden: Vitalindikatoren für Patienten, Bevölkerungsdichte, geografische Lage usw. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visuelle Daten allein reichen für solche Aufgaben normalerweise nicht aus</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aus diesen Gründen möchte ich noch einmal betonen: Dieser Leitfaden spielt nur die Rolle von Schulungsmaterial - er kann nicht als zuverlässiger COVID-19-Detektor angesehen werden. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie glauben, dass Sie oder jemand in der Nähe von COVID-19 sind, befolgen Sie die Empfehlungen Ihres Gesundheitssystems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieser Leitfaden hat Ihnen geholfen. </font><font style="vertical-align: inherit;">Ich hoffe auch, dass es für jemanden ein Ausgangspunkt bei der Suche nach Methoden zur Verwendung von Computer Vision und Deep Learning sein wird, um COVID-19 automatisch zu bestimmen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Handbuch haben Sie gelernt, wie Sie mit Keras, TensorFlow und Deep Learning einen automatischen COVID-19-Detektor für einen Datensatz aus Röntgenbildern erstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heute (noch) gibt es keine qualitativ hochwertigen und verifizierten Bilddatensätze für diese Krankheit, daher müssen Sie mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dem Joseph Cohen-Repository arbeiten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben 25 Bilder aus seinem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datensatz aufgenommen </font><strong><font style="vertical-align: inherit;">und</font></strong><font style="vertical-align: inherit;"> uns auf die anteroposteriore Projektion positiv diagnostizierter Fälle beschränkt.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dann </font></font></strong><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">machten </font></a><strong><font style="vertical-align: inherit;">wir 25 Bilder von gesunden Menschen</font></strong><font style="vertical-align: inherit;"> aus dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datensatz Kaggle Chest X-Ray Images (Pneumonia).</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann haben wir mit Hilfe von Keras und TensorFlow den COVID-19-Detektor trainiert, der eine </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Genauigkeit von 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bei unserer Testprobe mit einer Sensitivität von 100% und einer Spezifität von 80% (bei unserem kleinen Datensatz) zeigte. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Denken Sie daran, dass der hier beschriebene Detektor nur zu Bildungszwecken dient (siehe Hinweis im Text). </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich wollte andere Menschen dazu inspirieren, tiefes Lernen zu nutzen, um zu zeigen, dass es in Kombination mit Computer Vision einen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">großen Einfluss</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf unser Leben haben kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dass es Ihnen gefallen hat.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493596/index.html">Der Mann, der es nicht eilig hatte</a></li>
<li><a href="../de493598/index.html">Verstecke einen Teil der Telefonnummer</a></li>
<li><a href="../de493604/index.html">Digitale Veranstaltungen in Moskau vom 23. bis 29. März</a></li>
<li><a href="../de493606/index.html">Die Geschichte der Erstellung eines Cloud-Dienstes mit Cyberpunk</a></li>
<li><a href="../de493610/index.html">Programmieren einer Videoebene in einem Raspberry Pi mithilfe der DispmanX-API</a></li>
<li><a href="../de493616/index.html">Bilder wie Kisten - was ist drin? Bericht in Yandex</a></li>
<li><a href="../de493618/index.html">(Nicht) offensichtliche OSINT auf Twitter</a></li>
<li><a href="../de493620/index.html">Logistische Kurve. Wann endet die Epidemie?</a></li>
<li><a href="../de493622/index.html">Schreiben einer Retrowave in Angular</a></li>
<li><a href="../de493626/index.html">Selenoid - Hunderte von parallelen UI-Tests einfach und schnell. Pavel Senin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>