<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👷 👨🏿‍🎓 🧙🏿 Erweitertes TypeScript 🛌🏼 🤳🏼 🏤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Freitauchen - Tauchen ohne Tauchen. Der Taucher spürt das Gesetz von Archimedes: Er verdrängt eine bestimmte Menge Wasser, die ihn zurückdrückt. Daher...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erweitertes TypeScript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/499634/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freitauchen - Tauchen ohne Tauchen. </font><font style="vertical-align: inherit;">Der Taucher spürt das Gesetz von Archimedes: Er verdrängt eine bestimmte Menge Wasser, die ihn zurückdrückt. </font><font style="vertical-align: inherit;">Daher sind die ersten Meter am härtesten, aber dann hilft die Druckkraft der Wassersäule über Ihnen, sich tiefer zu bewegen. </font><font style="vertical-align: inherit;">Dieser Prozess erinnert an das Lernen und Eintauchen in TypeScript-Systeme - er wird beim Tauchen etwas einfacher. </font><font style="vertical-align: inherit;">Aber wir dürfen nicht vergessen, rechtzeitig aufzutauchen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/eb/y9/sheby96u0qt6o3usirdpsc78hpg.jpeg"><br>
<font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem Ozean ein Atemzug</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></i></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Bashurov</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saitonakamura</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) - Senior Frontend Engineer bei WiseBits, ein TypeScript-Fan und Amateur-Freitaucher. </font><font style="vertical-align: inherit;">Die Analogien von TypeScript lernen und tief tauchen sind nicht zufällig. </font><font style="vertical-align: inherit;">Michael wird Ihnen sagen, was diskriminierte Gewerkschaften sind, wie man Typinferenz verwendet, warum Sie nominelle Kompatibilität und Branding benötigen. </font><font style="vertical-align: inherit;">Halten Sie den Atem an und tauchen Sie.</font></font><a name="habracut"></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/m0uRxCCno00" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Präsentation und Links zu GitHub mit Beispielcode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art von Arbeit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Arten von Summen klingen algebraisch - versuchen wir herauszufinden, was es ist. </font><font style="vertical-align: inherit;">Sie werden in ReasonML als Variante, in Haskell als Union und in F # und TypeScript als Union bezeichnet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wikipedia gibt die folgende Definition: "Die Art des Betrags ist die Summe der Arten von Werken." </font></font><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Danke Kapitän! </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Definition ist absolut korrekt, aber nutzlos, also lasst uns verstehen. </font><font style="vertical-align: inherit;">Gehen wir von privat aus und beginnen mit der Art der Arbeit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir haben einen Typ </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es hat zwei Felder: </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wer hat es erstellt.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Art von Arbeit ist Kreuzung oder </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kreuzung</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies bedeutet, dass wir den gleichen Code wie jedes Feld einzeln schreiben können.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">id</span>: number } &amp; { <span class="hljs-attr">whoCreated</span>: number }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Algebra der Sätze wird dies als logische Multiplikation bezeichnet: Dies ist die Operation „UND“ oder „UND“. </font><font style="vertical-align: inherit;">Die Art des Produkts ist das logische Produkt dieser beiden Elemente.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Objekt mit einer Reihe von Feldern kann durch ein logisches Produkt ausgedrückt werden.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Art der Arbeit ist nicht auf Felder beschränkt. </font><font style="vertical-align: inherit;">Stellen Sie sich vor, wir lieben Prototype und haben festgestellt, dass wir vermisst werden </font></font><code>leftPad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type RichString = string &amp; { <span class="hljs-attr">leftPad</span>: <span class="hljs-function">(<span class="hljs-params">toLength: number</span>) =&gt;</span> string }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie es hinzu </font></font><code>String.prototype</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um in Typen auszudrücken, verwenden wir einen String und eine Funktion, die die erforderlichen Werte annimmt. </font><font style="vertical-align: inherit;">Die Methode und die Zeichenfolge sind der Schnittpunkt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einen Verband</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vereinigung - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vereinigung</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist beispielsweise nützlich, um den Typ einer Variablen darzustellen, die die Breite eines Elements in CSS festlegt: eine Zeichenfolge mit 10 Pixeln oder einen absoluten Wert. </font><font style="vertical-align: inherit;">Die CSS-Spezifikation ist tatsächlich viel komplizierter, aber der Einfachheit halber lassen wir es so.</font></font><br>
<br>
<pre><code class="javascript hljs">type Width = string | number</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel ist komplizierter. </font><font style="vertical-align: inherit;">Angenommen, wir haben eine Aufgabe. </font><font style="vertical-align: inherit;">Es kann in drei Zuständen vorliegen: gerade erstellt, in die Arbeit aufgenommen und abgeschlossen.</font></font><br>
<br>
<pre><code class="javascript hljs">type InitialTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }<font></font>
type InWorkTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number }<font></font>
type FinishTask = { <span class="hljs-attr">id</span>: number, <span class="hljs-attr">whoCreated</span>: number, <span class="hljs-attr">finishDate</span>: <span class="hljs-built_in">Date</span> }<font></font>
<font></font>
type Task = InitialTask | InWorkTask | FinishedTask</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im ersten und zweiten Status hat die Aufgabe </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wer hat sie erstellt, und im dritten Status wird das Abschlussdatum angezeigt. </font><font style="vertical-align: inherit;">Hier erscheint die Vereinigung - entweder dies oder das. </font></font><br>
<br>
<strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></em></strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Stattdessen können </font></font></em><code>type</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie verwenden </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aber es gibt Nuancen. </font><font style="vertical-align: inherit;">Das Ergebnis von Vereinigung und Schnittmenge ist immer ein Typ. </font><font style="vertical-align: inherit;">Sie können Schnittmenge durch ausdrücken </font></font></em><code>extends</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Vereinigung durch </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jedoch nicht. </font><font style="vertical-align: inherit;">Es ist </font></font></em><code>type</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur kürzer. </font></font><br>
<br>
</em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hilft nur beim Zusammenführen von Deklarationen. </font><font style="vertical-align: inherit;">Bibliothekstypen müssen immer durch ausgedrückt werden </font></font></em><code>interface</code><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, da dies anderen Entwicklern ermöglicht, sie mit ihren Feldern zu erweitern. </font><font style="vertical-align: inherit;">So typisiert zum Beispiel jQuery-Plugins.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typkompatibilität</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt jedoch ein Problem - in TypeScript </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompatibilität mit strukturellen Typen</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies bedeutet, dass wenn der erste und der zweite Typ denselben Satz von Feldern haben, dies zwei vom gleichen Typ sind. Zum Beispiel haben wir 10 Typen mit unterschiedlichen Namen, aber mit identischer Struktur (mit denselben Feldern). Wenn wir einen der 10 Typen für eine Funktion bereitstellen, die einen von ihnen akzeptiert, hat TypeScript nichts dagegen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Java oder C # dagegen ein </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nominales Kompatibilitätssystem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir werden die gleichen 10 Klassen mit identischen Feldern und einer Funktion schreiben, die eine davon übernimmt. Eine Funktion akzeptiert keine anderen Klassen, wenn sie keine direkten Nachkommen des Typs sind, für den die Funktion bestimmt ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem der strukturellen Kompatibilität wird behoben, indem dem Feld der Status hinzugefügt wird: </font></font><code>enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder</font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Summentypen sind jedoch eine Möglichkeit, Code semantischer auszudrücken als in der Datenbank gespeichert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Beispiel werden wir uns an ReasonML wenden. So sieht dieser Typ dort aus.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task =<font></font>
| Initial({ <span class="hljs-attr">id</span>: int, <span class="hljs-attr">whoCreated</span>: int })<font></font>
| InWork({ <span class="hljs-attr">id</span>: int, <span class="hljs-attr">whoCreated</span>: int })<font></font>
| Finished({<font></font>
        <span class="hljs-attr">id</span>: int,
        <span class="hljs-attr">whoCreated</span>: int,
        <span class="hljs-attr">finshDate</span>: <span class="hljs-built_in">Date</span>
    })</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die gleichen Felder, außer dass </font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stattdessen </font></font><code>number</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn Sie genau hinschauen, stellen wir fest </font></font><code>Initial</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>InWork</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>Finished</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sie befinden sich nicht links im Typnamen, sondern rechts in der Definition. Dies ist nicht nur eine Zeile im Titel, sondern Teil eines separaten Typs, sodass wir die erste von der zweiten unterscheiden können. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Life Hack</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Erstellen Sie für generische Typen (wie Ihre Domänenentitäten) eine Datei </font></font><code>global.d.ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und fügen Sie alle Typen hinzu. Sie werden automatisch in der gesamten TypeScript-Codebasis angezeigt, ohne dass ein expliziter Import erforderlich ist. Dies ist praktisch für die Migration, da Sie sich keine Gedanken darüber machen müssen, wo Typen platziert werden sollen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns am Beispiel des primitiven Redux-Codes sehen, wie das geht.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state, action) = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">erro</span>: action.payload }<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schreiben Sie den Code in TypeScript neu. Beginnen wir mit dem Umbenennen der Datei - von </font></font><code>.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bis </font></font><code>.ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aktivieren Sie alle Statusoptionen und die Option noImplicitAny. Diese Option findet Funktionen, in denen der Parametertyp nicht angegeben ist, und ist in der Migrationsphase nützlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typisierbaren </font></font><code>State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: add Feld </font></font><code>isFetching</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(das kann nicht sein) und </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type Task = { <span class="hljs-attr">title</span>: string }<font></font>
<font></font>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">"*.jpg"</span> {
    <span class="hljs-keyword">const</span> url: string
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> url<font></font>
}<font></font>
<font></font>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">"*.png"</span> {
    <span class="hljs-keyword">const</span> url: string
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> url<font></font>
}</code></pre><br>
<em><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lifehack guckte in Basarat Ali Syeds </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeScript Deep Dive</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es ist etwas veraltet, aber dennoch nützlich für diejenigen, die in TypeScript eintauchen möchten. Lesen Sie im </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blog von</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Marius Schulz </font></font></em><font style="vertical-align: inherit;"><em><font style="vertical-align: inherit;">über den aktuellen Stand von TypeScript </font></em><em><font style="vertical-align: inherit;">. Er schreibt über neue Funktionen und Tricks. Studieren Sie auch </font></em></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Änderungsprotokolle</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt nicht nur Informationen zu Updates, sondern auch deren Verwendung.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Verbleibende Aktionen. Wir werden jeden von ihnen eingeben und deklarieren.</font></font><br>
<br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span><font></font>
}<font></font>
<font></font>
type SuccessAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>,
    <span class="hljs-attr">payload</span>: Task<font></font>
<font></font>
type FailAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>,
    <span class="hljs-attr">payload</span>: <span class="hljs-built_in">Error</span><font></font>
}<font></font>
<font></font>
type Actions = FetchAction | SuccessAction | FailAction</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Feld </font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für alle Typen ist unterschiedlich. Es ist nicht nur eine Zeichenfolge, sondern eine bestimmte Zeichenfolge - ein </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeichenfolgenliteral</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist der </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diskriminator</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - das Etikett, anhand dessen wir alle Fälle unterscheiden. </font><font style="vertical-align: inherit;">Wir haben eine diskriminierte Gewerkschaft und können zum Beispiel verstehen, was in der Nutzlast steckt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aktualisieren Sie den ursprünglichen Redux-Code:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier besteht Gefahr, wenn wir schreiben </font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: string<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... dann wird alles kaputt gehen, weil es kein Diskriminator mehr ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Aktion kann type eine beliebige Zeichenfolge sein und kein bestimmter Diskriminator. </font><font style="vertical-align: inherit;">Danach kann TypeScript eine Aktion nicht mehr von einer anderen unterscheiden und Fehler finden. </font><font style="vertical-align: inherit;">Daher sollte es genau ein String-Literal geben. </font><font style="vertical-align: inherit;">Darüber hinaus können wir dieses Design hinzufügen : </font></font><code>type ActionType = Actions["type"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Drei unserer Optionen werden in den Eingabeaufforderungen angezeigt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uf/gm/si/ufgmsit8lx5zzmmd9tvot5ibg5u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie schreiben ...</font></font><br>
<pre><code class="javascript hljs">type FetchAction = {
    <span class="hljs-attr">type</span>: string<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... dann sind die Eingabeaufforderungen einfach </font></font><code>string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, da alle anderen Zeilen nicht mehr wichtig sind. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z1/g1/qe/z1g1qecermtbhjq62vju5ujmwv0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben alle getippt und die Art des Betrags erhalten.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umfassende Prüfung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich eine hypothetische Situation vor, in der dem Code keine Fehlerbehandlung hinzugefügt wird.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-comment">//case "TASK_FAIL":</span>
            <span class="hljs-comment">//return { isFetching: false, error: action.payload }</span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier hilft uns </font><font style="vertical-align: inherit;">eine </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umfassende Überprüfung</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine weitere nützliche Eigenschaft wie die Summe </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist eine Gelegenheit zu überprüfen, ob wir alle möglichen Fälle bearbeitet haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie nach der switch-Anweisung eine Variable hinzu : </font></font><code>const exhaustiveCheck: never = action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nie ist ein interessanter Typ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn es das Ergebnis einer Funktionsrückgabe ist, wird die Funktion nie korrekt beendet (z. B. wird immer ein Fehler ausgegeben oder endlos ausgeführt).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn es sich um einen Typ handelt, kann dieser Typ nicht ohne zusätzlichen Aufwand erstellt werden.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt zeigt der Compiler den Fehler "Typ 'FailAction' kann nicht dem Typ 'nie' zugewiesen werden". </font><font style="vertical-align: inherit;">Wir haben drei mögliche Arten von Aktionen, die wir nicht verarbeitet haben </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- das ist </font></font><code>FailAction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aber niemals ist es nicht „zuweisbar“. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen wir die Verarbeitung hinzu </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und es werden keine Fehler mehr auftreten. </font><font style="vertical-align: inherit;">Verarbeitet </font></font><code>"TASK_FETCH"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- zurückgegeben, verarbeitet </font></font><code>"TASK_SUCCESS"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- zurückgegeben, verarbeitet </font></font><code>"TASK_FAIL"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Was könnte die Aktion sein, wenn wir alle drei Funktionen verarbeitet haben? </font><font style="vertical-align: inherit;">Nichts - </font></font><code>never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie eine weitere Aktion hinzufügen, teilt Ihnen der Compiler mit, welche nicht verarbeitet werden. </font><font style="vertical-align: inherit;">Dies ist hilfreich, wenn Sie auf alle Aktionen reagieren möchten und wenn nur selektiv, dann nein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erster Tipp</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstrengen.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuerst wird es schwierig sein zu tauchen: Lesen Sie über die Art der Summe, dann über Produkte, algebraische Datentypen und so weiter in der Kette. </font><font style="vertical-align: inherit;">Muss sich anstrengen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir tiefer tauchen, steigt der Druck der Wassersäule über uns. </font><font style="vertical-align: inherit;">In einer bestimmten Tiefe sind die Auftriebskraft und der Wasserdruck über uns ausgeglichen. </font><font style="vertical-align: inherit;">Dies ist eine Zone des "neutralen Auftriebs", in der wir uns in einem Zustand der Schwerelosigkeit befinden. </font><font style="vertical-align: inherit;">In diesem Zustand können wir uns anderen Typsystemen oder Sprachen zuwenden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nominal Type System</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im alten Rom hatten die Einwohner drei Bestandteile des Namens: Nachname, Name und "Spitzname". </font><font style="vertical-align: inherit;">Der Name selbst ist "Nomen". </font><font style="vertical-align: inherit;">Daraus ergibt sich das nominelle Typensystem - "nominal". </font><font style="vertical-align: inherit;">Es ist manchmal nützlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel haben wir einen solchen Funktionscode.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> githubUrl = process.env.GITHUB_URL <span class="hljs-keyword">as</span> string
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> string<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fetchStarredRepos = (<font></font>
    nodeEnv: string,<font></font>
    <span class="hljs-attr">githubUrl</span>: string<font></font>
): <span class="hljs-built_in">Promise</span>&lt;GithubRepo[ ]&gt; =&gt; {
    <span class="hljs-keyword">if</span> (nodeEnv = <span class="hljs-string">"production"</span>) {
        <span class="hljs-comment">// log call</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// prettier-ignore</span>
    <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">'$githubUrl}/users/saitonakamura/starred'</span>)<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.json());<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Konfiguration erfolgt über die API : </font></font><code>GITHUB_URL=https://api.github.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die </font></font><code>githubUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API- </font><font style="vertical-align: inherit;">Methode </font><font style="vertical-align: inherit;">zieht die Repositorys heraus, auf die wir ein Sternchen setzen. </font><font style="vertical-align: inherit;">Und wenn </font></font><code>nodeEnv = "production"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dann protokolliert es diesen Aufruf, zum Beispiel für Metriken. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Funktion wollen wir entwickeln (UI).</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span><font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> StarredRepos = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> [starredRepos, setStarredRepos] = useState&lt;GithubRepo[ ] | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!starredRepos) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading…<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            {starredRepos.map(repo =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{repo.name}</span>&gt;</span>repo.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><font></font>
    )<font></font>
}<font></font>
<font></font>
type GithubRepo = {<font></font>
    <span class="hljs-attr">name</span>: string<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion weiß bereits, wie Daten angezeigt werden, und wenn es keine gibt, dann einen Lader. </font><font style="vertical-align: inherit;">Es bleibt noch ein API-Aufruf hinzuzufügen und die Daten zu füllen.</font></font><br>
<br>
<pre><code class="javascript hljs">useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    fetchStarredRepos(githubUrl, nodeEnv).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> setStarredRepos(data))<font></font>
}, [ ])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wenn wir diesen Code ausführen, wird alles fallen. </font><font style="vertical-align: inherit;">Im Entwicklerfenster stellen wir fest, dass es </font></font><code>fetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf die Adresse zugreift </font></font><code>'/users/saitonakamura/starred'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- githubUrl ist irgendwo verschwunden. </font><font style="vertical-align: inherit;">Es stellt sich heraus, dass alles wegen des seltsamen Designs an </font></font><code>nodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erster Stelle steht. </font><font style="vertical-align: inherit;">Natürlich kann es verlockend sein, alles zu ändern, aber die Funktion kann an anderen Stellen in der Codebasis verwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was aber, wenn der Compiler dies im Voraus anfordert? </font><font style="vertical-align: inherit;">Dann müssen Sie nicht den gesamten Startzyklus durchlaufen, einen Fehler erkennen und nach den Gründen suchen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Branding</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript hat einen Hack dafür - Markentypen. </font><font style="vertical-align: inherit;">Erstellen </font></font><code>Brand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(string), </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und zwei Typen. </font><font style="vertical-align: inherit;">Wir werden den gleichen Typ für erstellen </font></font><code>NodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type Brand&lt;T, B extends string&gt; = T &amp; { readonly _brand: B }<font></font>
<font></font>
type GithubUrl = Brand&lt;string, <span class="hljs-string">"githubUrl"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> githubUrl = process.env.GITHUB_URL <span class="hljs-keyword">as</span> GithubUrl<font></font>
<font></font>
type NodeEnv = Brand&lt;string, <span class="hljs-string">"nodeEnv"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> NodeEnv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wir bekommen einen Fehler. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qi/_e/j-/qi_ej-yne7xhcj4qmozvbw6r7qc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist </font></font><code>githubUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es </font></font><code>nodeEnv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unmöglich, sich gegenseitig zuzuweisen, da es sich um nominelle Typen handelt. </font><font style="vertical-align: inherit;">Unauffällig, aber nominal. </font><font style="vertical-align: inherit;">Jetzt können wir sie hier nicht mehr austauschen - wir ändern sie in einem anderen Teil des Codes.</font></font><br>
<br>
<pre><code class="javascript hljs">useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    fetchStarresRepos(nodeEnv, githubUrl).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> setStarredRepos(data))<font></font>
}, [ ])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist alles in Ordnung - sie haben </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Markenprimitive</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Branding ist nützlich, wenn mehrere Argumente (Zeichenfolgen, Zahlen) auftreten. Sie haben eine bestimmte Semantik (x-, y-Koordinaten) und sollten nicht verwechselt werden. Es ist praktisch, wenn der Compiler Ihnen mitteilt, dass sie verwirrt sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt jedoch zwei Probleme. Erstens hat TypeScript keine nativen Nominaltypen. Es besteht jedoch die Hoffnung, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Problem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> behoben wird. Eine </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Diskussion dieses Problems wird</font></a><font style="vertical-align: inherit;"> im Sprachrepository fortgesetzt </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das zweite Problem ist "as", es gibt keine Garantie dafür, dass die </font></font><code>GITHUB_URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbindung nicht unterbrochen wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sowie mit </font></font><code>NODE_ENV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Höchstwahrscheinlich wollen wir nicht nur einen String, sondern </font></font><code>"production"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>"development"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">type NodeEnv = Brand&lt;<span class="hljs-string">"production"</span> | <span class="hljs-string">"development"</span> | <span class="hljs-string">"nodeEnv"</span>&gt;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> nodeEnv = process.env.NODE_ENV <span class="hljs-keyword">as</span> NodeEnv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All dies muss überprüft werden. </font><font style="vertical-align: inherit;">Ich verweise Sie auf intelligente Designer und den Bericht von Sergey Cherepanov, " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwerfen einer Domain mit TypeScript in einem funktionalen Stil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zweiter und dritter Tipp</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sei vorsichtig.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halten Sie manchmal an und schauen Sie sich um: in anderen Sprachen, Frameworks, Typsystemen. </font><font style="vertical-align: inherit;">Lerne neue Prinzipien und lerne Lektionen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir den Punkt des "neutralen Auftriebs" passieren, drückt das Wasser stärker und zieht uns nach unten.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entspannen.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tauchen Sie tiefer und lassen Sie TypeScript seinen Job machen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was TypeScript kann?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript kann </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typen drucken</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span><font></font>
})<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createSuccess = <span class="hljs-function">(<span class="hljs-params">task: Task</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>
    <span class="hljs-attr">payload</span>: Task<font></font>
})<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFail = <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span></span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>
    <span class="hljs-attr">payload</span>: error<font></font>
})<font></font>
<font></font>
type FetchAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>,<font></font>
<font></font>
type SuccessAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>,
    <span class="hljs-attr">payload</span>: Task<font></font>
<font></font>
type FailAction = {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>,
    <span class="hljs-attr">payload</span>: <span class="hljs-built_in">Error</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dafür gibt es TypeScript </font></font><code>ReturnType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- es gibt den Rückgabewert von der Funktion ab:</font></font><pre><code class="javascript hljs">type FetchAction = ReturnType&lt;<span class="hljs-keyword">typeof</span> createFetch&gt;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Darin übergeben wir die Art der Funktion. </font><font style="vertical-align: inherit;">Wir können einfach keine Funktion schreiben: Um einen Typ aus einer Funktion oder Variablen zu nehmen, müssen wir schreiben </font></font><code>typeof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen in den Tipps </font></font><code>type: string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6w/n0/tq/6wn0tq3zjhnnoqvjrk0saubafak.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist schlecht - der Diskriminator wird brechen, weil es ein Objektliteral gibt.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir ein Objekt in JavaScript erstellen, ist es standardmäßig veränderbar. </font><font style="vertical-align: inherit;">Dies bedeutet, dass wir in einem Objekt mit einem Feld und einer Zeichenfolge die Zeichenfolge später in eine andere ändern können. </font><font style="vertical-align: inherit;">Daher erweitert TypeScript eine bestimmte Zeichenfolge auf eine beliebige Zeichenfolge für veränderbare Objekte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir müssen TypeScript irgendwie helfen. </font><font style="vertical-align: inherit;">Dafür gibt es als const.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add - String verschwindet sofort in den Eingabeaufforderungen. </font><font style="vertical-align: inherit;">Wir können dies nicht nur über die Linie schreiben, sondern im Allgemeinen das gesamte Literal.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann wird der Typ (und alle Felder) schreibgeschützt.</font></font><br>
<br>
<pre><code class="javascript hljs">type FetchAction = {<font></font>
    readonly type: <span class="hljs-string">"TASK_FETCH"</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist nützlich, da es unwahrscheinlich ist, dass Sie die Veränderlichkeit Ihrer Aktion ändern. </font><font style="vertical-align: inherit;">Deshalb fügen wir überall als const hinzu.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFetch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FETCH"</span>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createSuccess = <span class="hljs-function">(<span class="hljs-params">task: Task</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_SUCCESS"</span>
    <span class="hljs-attr">payload</span>: Task<font></font>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createFail = <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span></span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TASK_FAIL"</span>
    <span class="hljs-attr">payload</span>: error<font></font>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)<font></font>
<font></font>
type Actions =<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createFetch&gt;<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createSuccess&gt;<font></font>
    | ReturnType&lt;<span class="hljs-keyword">typeof</span> createFail&gt;<font></font>
<font></font>
type State =<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>; task: Task }<font></font>
    | { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>; error: <span class="hljs-built_in">Error</span> }<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = (state: State, <span class="hljs-attr">action</span>: Actions): State = &gt; {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
  <span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
  <span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Aktionen, die Code eingeben, wurden reduziert und als const hinzugefügt. </font><font style="vertical-align: inherit;">TypeScript verstand alles andere. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TypeScript kann </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">State ausgeben</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es wird durch die Vereinigung im obigen Code mit drei möglichen Zuständen von isFetching dargestellt: true, false oder Task. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie den Typ State = ReturnType. </font><font style="vertical-align: inherit;">TypeScript-Eingabeaufforderungen zeigen an, dass eine zirkuläre Abhängigkeit besteht. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/jk/vu/vejkvuzbnzraxku1y7yfm5qefhu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verkürzen.</font></font><br>
<br>
<pre><code class="javascript hljs">type State = ReturnType&lt;<span class="hljs-keyword">typeof</span> taskReducer&gt;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = <span class="hljs-function">(<span class="hljs-params">state, action: Actions</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
<span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br>
<code>State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hörte auf zu fluchen, aber jetzt ist er es </font></font><code>any</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, weil wir eine zyklische Abhängigkeit haben. </font><font style="vertical-align: inherit;">Wir geben das Argument ein.</font></font><br>
<br>
<pre><code class="javascript hljs">type State = ReturnType&lt;<span class="hljs-keyword">typeof</span> taskReducer&gt;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> taskReducer = <span class="hljs-function">(<span class="hljs-params">state: { isFetching: <span class="hljs-literal">true</span> }, action: Actions</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FETCH"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span> }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_SUCCESS"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">task</span>: action.payload }
        <span class="hljs-keyword">case</span> <span class="hljs-string">"TASK_FAIL"</span>:
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: action.payload }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> _exhaustiveCheck: never = action<font></font>
<font></font>
<span class="hljs-keyword">return</span> state<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Abschluss ist fertig. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i-/7f/mt/i-7fmtcvakp9l6ldfo98cqxfbwy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Schlussfolgerung ist , </font><font style="vertical-align: inherit;">ähnlich dem , </font><font style="vertical-align: inherit;">was wir hatten ursprünglich: </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es gibt hier Müllfelder </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber mit dem Typ </font></font><code>undefined</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- das Feld scheint da zu sein, aber es scheint nicht.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vierter Tipp</font></font></h2><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überarbeiten Sie nicht.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie sich entspannen und zu tief tauchen, ist möglicherweise nicht genügend Sauerstoff vorhanden, um zurückzukehren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Training auch: Wenn Sie zu sehr in die Technologie vertieft sind und sich dafür entscheiden, sie überall anzuwenden, werden Sie höchstwahrscheinlich auf Fehler stoßen, deren Gründe Sie nicht kennen. </font><font style="vertical-align: inherit;">Dies führt zur Ablehnung und möchte keine statischen Typen mehr verwenden. </font><font style="vertical-align: inherit;">Versuchen Sie, Ihre Stärke zu bewerten.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie TypeScript die Entwicklung verlangsamt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird einige Zeit dauern, bis die Eingabe unterstützt wird. </font><font style="vertical-align: inherit;">Es hat nicht die beste UX - manchmal gibt es völlig unverständliche Fehler, wie bei jedem anderen Typsystem, wie in Flow oder Haskell.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ausdrucksvoller das System ist, desto schwieriger ist der Fehler.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Wert des Typsystems besteht darin, dass es eine schnelle Rückmeldung gibt, wenn Fehler auftreten. Das System zeigt Fehler an und benötigt weniger Zeit, um sie zu finden und zu korrigieren. Wenn Sie weniger Zeit mit der Korrektur von Fehlern verbringen, erhalten mehr Architekturlösungen mehr Aufmerksamkeit. Typen verlangsamen die Entwicklung nicht, wenn Sie lernen, mit ihnen zu arbeiten.</font></font><br>
<br>
<blockquote>              <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">++</a>.  -  ,   ,        (25  26 )  -      (27  — 10 ). <br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a>   (5900  ),  ++            IT-,    . <br>
<br>
    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AvitoTech</a>  FrontendConf 2019    .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">youtube-</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>  telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@FrontendConfChannel</a>,       . </blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499624/index.html">Ansible Tools Übersicht</a></li>
<li><a href="../de499626/index.html">SOA auf Laravel und JSON-RPC 2.0</a></li>
<li><a href="../de499628/index.html">Entwicklungsinterviews: Freunde auswählen</a></li>
<li><a href="../de499630/index.html">Flattern. Frühjahrsupdate 2020</a></li>
<li><a href="../de499632/index.html">Verbessern der Audioqualität von Google Duo mit WaveNetEQ</a></li>
<li><a href="../de499636/index.html">Reagiere Native für die Kleinen. Mobile Entwicklungserfahrung</a></li>
<li><a href="../de499642/index.html">Pixockets: Wie wir unsere eigene Netzwerkbibliothek für den Spieleserver geschrieben haben</a></li>
<li><a href="../de499644/index.html">Robotererstellung (RPA) mit AutoTest-Tools</a></li>
<li><a href="../de499646/index.html">5 Regeln für die Integration von UX in Agile und Scrum</a></li>
<li><a href="../de499648/index.html">„Ein Spieledesigner ist immer ein Spieler“: Was macht ein Spezialist, welche Fähigkeiten sind wichtig?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>