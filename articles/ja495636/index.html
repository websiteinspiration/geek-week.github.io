<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕 🤴🏽 💆 SIPを使用してC / C ++ライブラリのPythonバインディングを作成します。パート2 🥜 🤶🏾 🏒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最初の部分品、我々はCやC ++で書かれたライブラリ用のPythonバインディングを作成するために設計されたSIPユーティリティでの作業の基本を検討しました。SIPを使用するために作成する必要がある基本的なファイルを調べ、ディレクティブとアノテーションの調査を始めました。ここまでは、Cで記述された単...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SIPを使用してC / C ++ライブラリのPythonバインディングを作成します。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495636/"><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">品、我々はCやC ++で書かれたライブラリ用のPythonバインディングを作成するために設計されたSIPユーティリティでの作業の基本を検討しました。</font><font style="vertical-align: inherit;">SIPを使用するために作成する必要がある基本的なファイルを調べ、ディレクティブとアノテーションの調査を始めました。</font><font style="vertical-align: inherit;">ここまでは、Cで記述された単純なライブラリのバインディングを行いました。このパートでは、クラスを含むC ++ライブラリのバインディングを行う方法を理解します。</font><font style="vertical-align: inherit;">このライブラリの例を使用して、オブジェクト指向ライブラリを操作するときにどのようなテクニックが役立つかを確認すると同時に、新しいディレクティブとアノテーションを扱います。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事のすべての例は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">//github.com/Jenyay/sip-examplesの</font></a><font style="vertical-align: inherit;"> githubリポジトリで入手でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++でライブラリのバインディングを作成する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検討する次の例は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーにあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、バインディングを行うライブラリを作成します。</font><font style="vertical-align: inherit;">ライブラリは引き続き</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに</font><font style="vertical-align: inherit;">あり、1つのクラス</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が含まれてい</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このクラスの宣言を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含む</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダーファイル</font><i><font style="vertical-align: inherit;">foo.h</font></i><font style="vertical-align: inherit;">は次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-keyword">char</span>* _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val);
        <span class="hljs-keyword">virtual</span> ~Foo();<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型の値を設定して返す2つのゲッターとセッターを持つ単純なクラス</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">クラスの実装は次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val): _int_val(int_val) {<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
    set_string_val(string_val);<font></font>
}<font></font>
<font></font>
Foo::~Foo(){<font></font>
    <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span> </span>{
    <span class="hljs-keyword">if</span> (_string_val != <span class="hljs-literal">nullptr</span>) {
        <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">auto</span> count = <span class="hljs-built_in">strlen</span>(val) + <span class="hljs-number">1</span>;<font></font>
    _string_val = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[count];
    <span class="hljs-built_in">strcpy</span>(_string_val, val);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリの機能をテストするために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーに</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;">クラスを使用した</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルも含まれて</font><i><font style="vertical-align: inherit;">い</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ライブラリを構築するには</font><font style="vertical-align: inherit;">、次の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefileを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=g++<font></font>
CFLAGS=-c -fPIC<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
    $(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.cpp<font></font>
    $(CC) $(CFLAGS) main.cpp -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.cpp<font></font>
    $(CC) $(CFLAGS) foo.cpp -o $(DIR_OUT)/foo.o<font></font>
    ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
    mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
    rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前の例の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
との違いは、</font><font style="vertical-align: inherit;">コンパイラを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に変更することに加えて</font><font style="vertical-align: inherit;">、別のオプション</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-fPIC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がコンパイル用に追加されたこと</font><font style="vertical-align: inherit;">により、コンパイラに特定の方法でライブラリにコードを配置するように指示することです（いわゆる「位置独立コード」）。この記事はコンパイラーに関するものではないので、このパラメーターが何をするのか、そしてなぜそれが必要なのかについては詳しく説明しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このライブラリを結び始めましょう。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルは</font><font style="vertical-align: inherit;">、前の例から</font><i><font style="vertical-align: inherit;">ほとんど変更さ</font></i><font style="vertical-align: inherit;">れてい</font><i><font style="vertical-align: inherit;">ません</font></i><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルは次のように</font><i><font style="vertical-align: inherit;">なり</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoocpp"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoocpp]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、C ++で記述された例は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pythonパッケージにパッケージ化されます</font><font style="vertical-align: inherit;">。これはおそらく、このファイルの唯一の顕著な変更です。</font><i><font style="vertical-align: inherit;">project.py</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">pyfoo_c_04の</font></i><font style="vertical-align: inherit;">例と同じまま</font><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ここ</font><font style="vertical-align: inherit;">では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><i><font style="vertical-align: inherit;">を</font></i><font style="vertical-align: inherit;">より詳細に検討し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。このファイルは将来のPythonモジュールのインターフェースを記述していることを思い出させてください。何を含める必要があるか、クラスインターフェースはどのように見えるかなどです。ライブラリヘッダーファイルを繰り返すために.sipファイルは必要ありませんが、それらには多くの共通点があります。このクラス内には、元のクラスにはなかった新しいメソッドが追加される場合があります。それら。 .sipファイルに記述されているインターフェースは、必要に応じて、Pythonで受け入れられる原則に合わせてライブラリクラスを調整できます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">に新しいディレクティブが表示され</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、このファイルの内容を見てみましょう。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の行は、前の例からすでに明確になっているはずです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブで、</font><font style="vertical-align: inherit;">作成するPythonモジュールの名前を指定します（つまり、このモジュールを使用するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">import foocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from foocpp import ...コマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。同じディレクティブで、言語が- C ++ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ディレクティブDefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セットにPython文字列に変換するために使用される符号化</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONSTチャー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャー*</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及び</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONSTチャー*</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次いで、インターフェース宣言</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のFoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスは、以下の</font><font style="vertical-align: inherit;">直後の宣言の後。</font><i><font style="vertical-align: inherit;">フー・</font></i><font style="vertical-align: inherit;">クラス</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">％End</font></i><font style="vertical-align: inherit;">ディレクティブで終了</font><font style="vertical-align: inherit;">する</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブはまだ使用されていません</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">％のTypeHeaderCodeディレクティブは、</font></i><font style="vertical-align: inherit;">ラッパーが作成されているC ++クラスのインタフェースを宣言するコードが含まれている必要があります。原則として、このディレクティブでは、ヘッダーファイルをクラス宣言に含めるだけで十分です。</font><font style="vertical-align: inherit;">
その後</font><font style="vertical-align: inherit;">、Python言語の</font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;">クラスのメソッドに変換されるクラスメソッドがリストされ</font><font style="vertical-align: inherit;">ます。この時点では</font><font style="vertical-align: inherit;">、Python </font><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;">クラスからアクセスできるパブリックメソッドのみを宣言していることに注意することが重要</font><font style="vertical-align: inherit;">です（Pythonにはプライベートおよび保護されたメンバーがないため）。最初に</font><i><font style="vertical-align: inherit;">％DefaultEncoding</font></i><font style="vertical-align: inherit;">ディレクティブを使用したため、</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、型</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数を取るメソッドで</font><font style="vertical-align: inherit;">は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーション</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">これらのパラメーターをPython文字列に、またはその逆に変換するためのエンコーディングを指定する</font><font style="vertical-align: inherit;">ことはできません</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">あと</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pythonパッケージをコンパイルして</font><font style="vertical-align: inherit;">テストするだけです。</font><font style="vertical-align: inherit;">しかし、本格的なホイールパッケージをアセンブルする前に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-buildコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">SIPが後でコンパイルするために作成するソースファイルを確認し、それらの中でPythonコードで作成されるクラスに似たものを見つけてみましょう。</font><font style="vertical-align: inherit;">これを行うには、上記の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-buildコマンドを</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーで</font><i><font style="vertical-align: inherit;">呼び出す</font></i><font style="vertical-align: inherit;">必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、</font><i><font style="vertical-align: inherit;">ビルド</font></i><font style="vertical-align: inherit;">フォルダーが作成されます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 次の内容で：</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建てる</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└──foocpp</font></font><font></font>
    ├── apiversions.c<font></font>
    ├── array.c<font></font>
    ├── array.h<font></font>
    ├── bool.cpp<font></font>
    ├── build<font></font>
    │&nbsp;&nbsp; └── temp.linux-x86_64-3.8<font></font>
    │&nbsp;&nbsp;     ├── apiversions.o<font></font>
    │&nbsp;&nbsp;     ├── array.o<font></font>
    │&nbsp;&nbsp;     ├── bool.o<font></font>
    │&nbsp;&nbsp;     ├── descriptors.o<font></font>
    │&nbsp;&nbsp;     ├── int_convertors.o<font></font>
    │&nbsp;&nbsp;     ├── objmap.o<font></font>
    │&nbsp;&nbsp;     ├── qtlib.o<font></font>
    │&nbsp;&nbsp;     ├── sipfoocppcmodule.o<font></font>
    │&nbsp;&nbsp;     ├── sipfoocppFoo.o<font></font>
    │&nbsp;&nbsp;     ├── siplib.o<font></font>
    │&nbsp;&nbsp;     ├── threads.o<font></font>
    │&nbsp;&nbsp;     └── voidptr.o<font></font>
    ├── descriptors.c<font></font>
    ├── foocpp.cpython-38-x86_64-linux-gnu.so<font></font>
    ├── int_convertors.c<font></font>
    ├── objmap.c<font></font>
    ├── qtlib.c<font></font>
    ├── sipAPIfoocpp.h<font></font>
    ├── sipfoocppcmodule.cpp<font></font>
    ├── sipfoocppFoo.cpp<font></font>
    ├── sip.h<font></font>
    ├── sipint.h<font></font>
    ├── siplib.c<font></font>
    ├── threads.c<font></font>
    └── voidptr.c<font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加のタスクとして、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocppFoo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを慎重に検討して</font><i><font style="vertical-align: inherit;">ください</font></i><font style="vertical-align: inherit;">（この記事では詳しく説明しません）。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*
 * Interface wrapper code.
 *
 * Generated by SIP 5.1.1
 */</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"sipAPIfoocpp.h"</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 6 <span class="hljs-meta-string">"/home/jenyay/temp/2/pyfoocpp.sip"</span></span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 12 <span class="hljs-meta-string">"/home/jenyay/temp/2/build/foocpp/sipfoocppFoo.cpp"</span></span><font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_int_val, <span class="hljs-string">"set_int_val(self, int)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"Bi"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_int_val(a0);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_int_val, doc_Foo_set_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_int_val, <span class="hljs-string">"get_int_val(self) -&gt; int"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">int</span> sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_int_val();<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_int_val, doc_Foo_get_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_string_val, <span class="hljs-string">"set_string_val(self, str)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a0;<font></font>
        PyObject *a0Keep;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"BA8"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0Keep, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_string_val(a0);<font></font>
            Py_DECREF(a0Keep);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_string_val, doc_Foo_set_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_string_val, <span class="hljs-string">"get_string_val(self) -&gt; str"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">char</span>*sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_string_val();<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (sipRes == SIP_NULLPTR)<font></font>
            {<font></font>
                Py_INCREF(Py_None);<font></font>
                <span class="hljs-keyword">return</span> Py_None;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyUnicode_FromString(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_string_val, doc_Foo_get_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Call the instance's destructor. */</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *, <span class="hljs-keyword">int</span>)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sipCppV, <span class="hljs-keyword">int</span>)</span>
</span>{
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">reinterpret_cast</span>&lt; ::Foo *&gt;(sipCppV);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *sipSelf)</span>
</span>{
    <span class="hljs-keyword">if</span> (sipIsOwnedByPython(sipSelf))<font></font>
    {<font></font>
        release_Foo(sipGetAddress(sipSelf), <span class="hljs-number">0</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *, 
                 PyObject *, PyObject **, PyObject **, PyObject **)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *sipArgs, PyObject *sipKwds,
                                   PyObject **sipUnused, PyObject **, PyObject **sipParseErr)</span>
</span>{<font></font>
     ::Foo *sipCpp = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a1;<font></font>
        PyObject *a1Keep;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"iA8"</span>, &amp;a0, &amp;a1Keep, &amp;a1))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(a0,a1);<font></font>
            Py_DECREF(a1Keep);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span>  ::Foo* a0;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"J9"</span>, sipType_Foo, &amp;a0))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(*a0);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">static</span> PyMethodDef methods_Foo[] = {<font></font>
    {sipName_get_int_val, meth_Foo_get_int_val, METH_VARARGS, doc_Foo_get_int_val},<font></font>
    {sipName_get_string_val, meth_Foo_get_string_val, METH_VARARGS, doc_Foo_get_string_val},<font></font>
    {sipName_set_int_val, meth_Foo_set_int_val, METH_VARARGS, doc_Foo_set_int_val},<font></font>
    {sipName_set_string_val, meth_Foo_set_string_val, METH_VARARGS, doc_Foo_set_string_val}<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo, <span class="hljs-string">"\1Foo(int, str)\n"</span>
<span class="hljs-string">"Foo(Foo)"</span>);<font></font>
<font></font>
sipClassTypeDef sipTypeDef_foocpp_Foo = {<font></font>
    {<font></font>
        <span class="hljs-number">-1</span>,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_TYPE_CLASS,<font></font>
        sipNameNr_Foo,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    },<font></font>
    {<font></font>
        sipNameNr_Foo,<font></font>
        {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>},
        <span class="hljs-number">4</span>, methods_Foo,
        <span class="hljs-number">0</span>, SIP_NULLPTR,
        <span class="hljs-number">0</span>, SIP_NULLPTR,<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
         SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    },<font></font>
    doc_Foo,<font></font>
    <span class="hljs-number">-1</span>,
    <span class="hljs-number">-1</span>,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    init_type_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    dealloc_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    release_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを使用してパッケージをビルドします</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このコマンドを実行した後、問題がなければ、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whlファイル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または同様の名前の</font><i><font style="vertical-align: inherit;">ファイル</font></i><font style="vertical-align: inherit;">が作成され</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pip install --user pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whlコマンド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してインストールし</font><font style="vertical-align: inherit;">、Pythonインタープリターを実行して確認します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_int_val(<span class="hljs-number">50</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_string_val(<span class="hljs-string">''</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動作します！</font><font style="vertical-align: inherit;">したがって、C ++でクラスのバインディングを持つPythonモジュールを作成しました。</font><font style="vertical-align: inherit;">さらに、このクラスに美しさをもたらし、さまざまなアメニティを追加します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティを追加</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIPを使用して作成されたクラスは、C ++クラスインターフェイスを正確に繰り返す必要はありません。たとえば、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">には2つのゲッターと2つのセッターがあり、これらを明確にプロパティに組み合わせて、クラスをより「Python」にすることができます。 sipを使用してプロパティを追加するのは簡単で、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーの例に</font><i><font style="vertical-align: inherit;">示さ</font></i><font style="vertical-align: inherit;">れて</font><i><font style="vertical-align: inherit;">い</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例は前の例と似ていますが、主な違いは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">にあり、次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、すべてが非常に単純です。プロパティを追加するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％プロパティ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを</font><font style="vertical-align: inherit;">使用します。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">％</font></a><font style="vertical-align: inherit;">ディレクティブには</font><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">プロパティの</font></a></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名前</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を指定するnameと、</font><font style="vertical-align: inherit;">値（getter）を返すメソッドを指定する</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つの必須パラメーターがあります</font><font style="vertical-align: inherit;">。セッターがない場合もありますが、プロパティにも値を割り当てる必要がある場合は、セッターメソッドを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターの値として指定します</font><font style="vertical-align: inherit;">。この例では、ゲッターとセッターとして機能する関数がすでにあるので、プロパティはかなり単純な方法で作成されます。</font><i><font style="vertical-align: inherit;">sip-wheel</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンドを使用してパッケージを収集し</font><font style="vertical-align: inherit;">、インストールするだけです。その後、pythonインタープリターコマンドモードでプロパティの動作を確認します。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val = <span class="hljs-number">50</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
クラスの使用例からわかるよう</font><font style="vertical-align: inherit;">に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int_val </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">string_valプロパティ</font></i><font style="vertical-align: inherit;">は、読み取りと書き込みの両方で</font><i><font style="vertical-align: inherit;">機能します</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント行を追加する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今後も</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスを改善していき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次の例は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーにあり</font><i><font style="vertical-align: inherit;">、</font></i><font style="vertical-align: inherit;">ドキュメント行（docstring）をクラスのさまざまな要素に追加する方法を示しています。</font><font style="vertical-align: inherit;">この例は前の例に基づいており、その主な変更は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルに関係して</font><i><font style="vertical-align: inherit;">い</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その内容は次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
%Docstring<font></font>
Class example from C++ library<font></font>
%End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに理解したように、クラスの任意の要素にドキュメント行を追加するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Docstring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを使用する必要があります</font><font style="vertical-align: inherit;">。この例は、このディレクティブを使用するいくつかの方法を示しています。この例をよりよく理解するために</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">sip-wheel</font></i><font style="vertical-align: inherit;">コマンドを使用し</font><font style="vertical-align: inherit;">て</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">すぐにコンパイルして</font><font style="vertical-align: inherit;">インストールし、Pythonコマンドモードで生成されるドキュメント行を考慮して、このディレクティブのどのパラメーターが何に影響を与えるかを順次</font><i><font style="vertical-align: inherit;">理解</font></i><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">ます。ドキュメンテーション行は、</font><font style="vertical-align: inherit;">これらの行が属する</font><i><font style="vertical-align: inherit;">__doc__</font></i><font style="vertical-align: inherit;">オブジェクトの</font><font style="vertical-align: inherit;">メンバーとして保存されることを思い出してください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
ドキュメントの最初の行は</font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;">クラス用です。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ご覧のとおり、すべてのドキュメント行は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブの間にあり</font><font style="vertical-align: inherit;">ます。この例の5〜7行目では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブの追加パラメーターを使用していない</font><font style="vertical-align: inherit;">ため、ドキュメント行はそのまま</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスに書き込まれ</font><font style="vertical-align: inherit;">ます。そのため、5行目から7行目にはインデントがありません。そうでなければ、ドキュメント行の前のインデントもFoo .__ doc__に分類されます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">に、導入したドキュメントの行が本当に含まれて</font><font style="vertical-align: inherit;">いることを確認し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.__doc__
<span class="hljs-string">'Class example from C++ library'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17-19行目にある</font><font style="vertical-align: inherit;">
次の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブは</font><font style="vertical-align: inherit;">、2つのパラメーターを同時に使用します。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">は、「raw」または「deindented」の2つの値のいずれかを取り</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。最初のケースでは、記述されたとおりにドキュメント行が保存され、2番目のケースでは、最初のスペース文字（タブは除く）が削除されます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターが</font><font style="vertical-align: inherit;">指定されていない</font><font style="vertical-align: inherit;">場合のデフォルト値は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultDocstringFormat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを使用して設定できます</font><font style="vertical-align: inherit;">（後で検討します）。指定されていない場合は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "raw"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と見なされ</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指定されたドキュメンテーション行に加えて、SIPはそのシグネチャの説明（入力で予期される変数のタイプと関数が返すタイプ）を関数のドキュメンテーションの行に追加します。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">などの署名を置く指定：文書の指定された行（前に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「先頭に追加」署名=</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（それの後、）</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名=「追加」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名を追加）しないか（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名は=「破棄しました」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々の例では、設定</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名=「付加」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">のため</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set_int_val機能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ならびに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名を=「添付」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set_string_val機能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ドキュメント行の先頭にあるスペースを削除するために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータも追加されまし</font><font style="vertical-align: inherit;">た。これらのパラメーターがPythonでどのように機能するかを確認してみましょう。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_int_val.__doc__
<span class="hljs-string">'get_int_val(self) -&gt; int\nReturn integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_int_val.__doc__
<span class="hljs-string">'set_int_val(self, int)\nSet integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_string_val.__doc__
<span class="hljs-string">'Return string value\nget_string_val(self) -&gt; str'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_string_val.__doc__
<span class="hljs-string">'Set string value\nset_string_val(self, str)'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">％Docstring</font></i><font style="vertical-align: inherit;">ディレクティブの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用する</font><font style="vertical-align: inherit;">と、ドキュメントの行で関数の署名の説明の位置を変更できます。</font><font style="vertical-align: inherit;">
次に、プロパティ行にドキュメント行を追加することを検討してください。この場合、</font><i><font style="vertical-align: inherit;">％Docstring</font></i><font style="vertical-align: inherit;"> ... </font><i><font style="vertical-align: inherit;">％End</font></i><font style="vertical-align: inherit;">ディレクティブは、％Propertyディレクティブの後に中括弧で囲まれ</font><font style="vertical-align: inherit;">ていることに注意してください</font><font style="vertical-align: inherit;">。この記録形式は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">％Property</font></a><font style="vertical-align: inherit;">ディレクティブのドキュメントで説明されています</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">％Docstring</font></i><font style="vertical-align: inherit;"> 
ディレクティブパラメータの指定方法にも注意してください</font><font style="vertical-align: inherit;">。ディレクティブの最初のパラメーター（この場合、</font><i><font style="vertical-align: inherit;">フォーマット</font></i><font style="vertical-align: inherit;">パラメーター</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">したがって、この例では、ディレクティブを使用する3つの方法が同時に使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロパティのドキュメント行が設定されていることを確認します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; Foo.int_val.__doc__<font></font>
'The property for integer value'<font></font>
<font></font>
&gt;&gt;&gt; Foo.string_val.__doc__<font></font>
'The property for string value'<font></font>
<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
Help on class Foo in module foocpp:<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      Return string value<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      Set string value<font></font>
 |      set_string_val(self, str)<font></font>
...<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">％DefaultDocstringFormat</font></a><font style="vertical-align: inherit;">および</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">％DefaultDocstringSignatureディレクティブ</font></a><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">
、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォーマット</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターのデフォルト値を設定することにより、この例を簡略化しましょう</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらのディレクティブの使用は、</font><i><font style="vertical-align: inherit;">pyfoo_cpp_04</font></i><font style="vertical-align: inherit;">フォルダーの例に示されています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この例</font><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">pyfoocpp.sip</font></i><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">には、次のコードが含まれています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルの先頭に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultDocstringFormat "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">％DefaultDocstringSignature "prepended"</font></i><font style="vertical-align: inherit;">という行</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が追加さ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブからのすべてのパラメーター</font><font style="vertical-align: inherit;">が削除されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例を組み立ててインストールすると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスの説明が今のように</font><font style="vertical-align: inherit;">表示され、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">help（Foo）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドで次のように表示されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Foo<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      set_string_val(self, str)<font></font>
 |      Set string value<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがすっきりとしていて、同じタイプです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスとメソッドの名前を変更する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、Pythonバインディングによって提供されるインターフェースは、C / C ++ライブラリが提供するインターフェースと一致する必要はありません。上記のクラスにプロパティを追加しました。次に、関数名がPythonキーワードと一致する場合など、クラス名または関数の競合が発生した場合に役立つもう1つのテクニックを見ていきます。これを行うには、クラス、関数、例外、およびその他のエンティティの名前を変更できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンティティの名前を変更するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションを</font><i><font style="vertical-align: inherit;">使用します</font></i><font style="vertical-align: inherit;">。その値には新しいエンティティ名を割り当てる必要があります。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションを使用した作業</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーの例に示されています</font><font style="vertical-align: inherit;">。この例は、前の例に基づいています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_04で</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルが</font><i><font style="vertical-align: inherit;">異なり</font></i><font style="vertical-align: inherit;">ます。ファイル</font><font style="vertical-align: inherit;">の内容は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> /<span class="hljs-title">PyName</span>=<span class="hljs-title">Bar</span>/ {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> /PyName</span>=set_integer_value/;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span> /PyName</span>=get_integer_value/;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_integer_value, <span class="hljs-built_in">set</span>=set_integer_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span> /PyName</span>=set_string_value/;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span> /PyName</span>=get_string_value/;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_value, <span class="hljs-built_in">set</span>=set_string_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">の名前を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">に変更し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アノテーションを使用してすべてのメソッドに他の名前を割り当てました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここでのすべては非常にシンプルで明確であると思います。注意する価値があるのはプロパティの作成だけです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブで</font><font style="vertical-align: inherit;">は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターで</font><font style="vertical-align: inherit;">メソッドの名前を指定する必要があります。メソッドはPythonクラスで呼び出されるため、C ++コードで最初に呼び出された名前ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サンプルをコンパイルしてインストールし、このクラスがPythonでどのように表示されるかを確認します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Bar<font></font>
&gt;&gt;&gt; help(Bar)<font></font>
<font></font>
Help on class Bar in module foocpp:<font></font>
<font></font>
class Bar(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Bar<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_integer_value(...)<font></font>
 |      get_integer_value(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_value(...)<font></font>
 |      get_string_value(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_integer_value(...)<font></font>
 |      set_integer_value(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_value(...)<font></font>
 |      set_string_value(self, str)<font></font>
 |      Set string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
 |  Data descriptors defined here:<font></font>
 |  <font></font>
 |  __weakref__<font></font>
 |      list of weak references to the object (if defined)<font></font>
 |  <font></font>
 |  int_val<font></font>
 |      The property for integer value<font></font>
 |  <font></font>
 |  string_val<font></font>
 |      The property for string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動いた！</font><font style="vertical-align: inherit;">クラス自体とそのメソッドの名前を変更することができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリは、すべてのクラスの名前が接頭辞で始まるという合意を使用する場合があります。たとえば、Qtでは「Q」、wxWidgetsでは「wx」という文字で始まります。</font><font style="vertical-align: inherit;">Pythonバインディングですべてのクラスの名前を変更してそのようなプレフィックスを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">削除</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する場合は、各クラスに</font><i><font style="vertical-align: inherit;">PyName</font></i><font style="vertical-align: inherit;">アノテーションを設定しないようにするために</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％AutoPyName</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを使用できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この記事ではこのディレクティブについては考慮しません。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％AutoPyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ内に配置</font><font style="vertical-align: inherit;">し、ドキュメントの例に限定</font><font style="vertical-align: inherit;">する必要がある</font><font style="vertical-align: inherit;">ことだけを述べ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module PyQt5.QtCore<font></font>
{<font></font>
    %AutoPyName(remove_leading="Q")<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型変換を追加する</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstringクラスの使用例</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ような単純な型で機能する関数とクラスについて見てきました</font><font style="vertical-align: inherit;">。これらのタイプの場合、SIPはPythonクラスとの間のコンバーターを自動的に作成しました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーにある次の例では</font><font style="vertical-align: inherit;">、クラスメソッドがより複雑なオブジェクト（STLの文字列など）を受け入れて返す場合を検討し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。この例を単純化し、バイトからUnicodeへの変換およびその逆の変換を複雑にしないために、この例では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列</font><i><font style="vertical-align: inherit;">クラス</font></i><font style="vertical-align: inherit;">を使用し</font><font style="vertical-align: inherit;">ます。この例の考え方は、C ++クラスとPythonクラスの間の変換ルールを手動で設定する方法を示すことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;">ライブラリから</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスを変更し</font><font style="vertical-align: inherit;">ます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これで、クラス定義は次のようになります（ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-built_in">wstring</span> _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">foo.cpp</font></i><font style="vertical-align: inherit;">ファイル内</font><font style="vertical-align: inherit;">
の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスの実装</font><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val):<font></font>
    _int_val(int_val), _string_val(string_val) {}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span> </span>{<font></font>
    _string_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、</font><font style="vertical-align: inherit;">ライブラリの機能をチェックするため</font><font style="vertical-align: inherit;">の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">L"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">L"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、以前と同様、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーにあります</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とライブラリのビルドプロセスは変更されていません。</font><font style="vertical-align: inherit;">また、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルに大きな変更はありません</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">著しく複雑になってい</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
<font></font>
%MappedType <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span><font></font>
{<font></font>
%TypeHeaderCode<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
%End<font></font>
<font></font>
%ConvertFromTypeCode<font></font>
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
<font></font>
%ConvertToTypeCode<font></font>
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために、pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">ドキュメント行を追加</font><i><font style="vertical-align: inherit;">しませ</font></i><font style="vertical-align: inherit;">ん。</font><font style="vertical-align: inherit;">後続の</font><i><font style="vertical-align: inherit;">％MappedType</font></i><font style="vertical-align: inherit;">ディレクティブなしで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスの宣言のみ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">残した</font><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、ビルドプロセス中に次のエラーが発生します。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">$ sip-wheel<font></font>
<font></font>
These bindings will be built: pyfoocpp.<font></font>
Generating the pyfoocpp bindings...<font></font>
sip-wheel: std::wstring is undefined<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
型のオブジェクトがどのように</font><font style="vertical-align: inherit;">Pythonオブジェクトに変換されるか</font><font style="vertical-align: inherit;">を明示的に</font><font style="vertical-align: inherit;">説明し、逆変換も説明する必要があります。変換を説明するには、C言語でかなり低いレベルで作業し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python / C API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する必要があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。 Python / C APIは大きなトピックであり、別の記事でも本に値するので、このセクションでは、例で使用されている関数のみを考察します。詳細についてはあまり詳しく説明しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C ++オブジェクトからPython（またはその逆）への変換を宣言するために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％MappedType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">意図されて</font></a><font style="vertical-align: inherit;">おり、その中に他の3つのディレクティブが存在する場合があります：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％TypeHeaderCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertFromTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">式の後に、</font><font style="vertical-align: inherit;">コンバーターが作成されるタイプを指定する必要があります。</font><font style="vertical-align: inherit;">この例では、ディレクティブは式</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％MappedType std :: wstringで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始まります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">「</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">C ++でライブラリのバインディングを作成する」</font></a><font style="vertical-align: inherit;">のセクションで、</font><i><font style="vertical-align: inherit;">％TypeHeaderCode</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ディレクティブ</font><font style="vertical-align: inherit;">にすでに対応してい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このディレクティブは、使用される型を宣言すること、またはそれらが宣言されているヘッダーファイルを含めることを目的としていることを思い出してください。</font><font style="vertical-align: inherit;">この例</font><font style="vertical-align: inherit;">では</font><font style="vertical-align: inherit;">、クラス</font><i><font style="vertical-align: inherit;">std ::文字列が</font></i><font style="vertical-align: inherit;">宣言</font><font style="vertical-align: inherit;">さ</font><font style="vertical-align: inherit;">れて</font><font style="vertical-align: inherit;">いるヘッダーファイル</font><i><font style="vertical-align: inherit;">文字</font></i><i><font style="vertical-align: inherit;">列は</font></i><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">％TypeHeaderCode</font></i><font style="vertical-align: inherit;">ディレクティブ内</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">接続さ</font><font style="vertical-align: inherit;">れてい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">
次に、変換について説明する必要があります</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertFromTypeCode。</font><font style="vertical-align: inherit;">C ++オブジェクトをPythonに変換する</font></font></h3><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
オブジェクトを</font><font style="vertical-align: inherit;">Python </font><font style="vertical-align: inherit;">クラス</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変換することから始め</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。この例の変換は次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertFromTypeCode
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このディレクティブの内部には、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数（</font><font style="vertical-align: inherit;">C ++コードからのオブジェクトへのポインター）があります。これにより、Pythonオブジェクトを作成し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returnステートメント</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してディレクティブから作成したオブジェクトを返す必要があります</font><font style="vertical-align: inherit;">。この場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">です。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスを作成するには</font><font style="vertical-align: inherit;">、Python / C APIの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用し</font><font style="vertical-align: inherit;">ます。この関数は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const wchar_t * w</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型の配列（ポインター）を最初のパラメーターとして受け入れ、</font><font style="vertical-align: inherit;">この配列のサイズを2番目のパラメーターとして</font><font style="vertical-align: inherit;">受け入れ</font><font style="vertical-align: inherit;">ます。 2番目のパラメータとして値-1を渡すと、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">自体が関数を使用して長さを計算します</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wcslen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">wchar_t *</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
配列を取得するに</font><font style="vertical-align: inherit;">は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">std :: wstring</font></a><font style="vertical-align: inherit;">クラスの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">data</font></a><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">PyUnicode_FromWideCharの</font></i><font style="vertical-align: inherit;"> 
機能は</font><font style="vertical-align: inherit;">へのポインタを返す</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">PyObject</font></a><font style="vertical-align: inherit;">または</font><i><font style="vertical-align: inherit;">NULL</font></i><font style="vertical-align: inherit;">エラーの場合。</font><i><font style="vertical-align: inherit;">PyObject</font></i><font style="vertical-align: inherit;">は任意のPythonオブジェクトで、この場合は</font><i><font style="vertical-align: inherit;">str</font></i><font style="vertical-align: inherit;">クラスになり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Python / C APIでは、通常、オブジェクトの操作は</font><i><font style="vertical-align: inherit;">PyObject *</font></i><font style="vertical-align: inherit;">ポインタを介して行われる</font><font style="vertical-align: inherit;">ため、この場合、</font><i><font style="vertical-align: inherit;">％ConvertFromTypeCode</font></i><font style="vertical-align: inherit;">ディレクティブから</font><i><font style="vertical-align: inherit;">PyObject *</font></i><font style="vertical-align: inherit;">ポインタを返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode。</font><font style="vertical-align: inherit;">PythonオブジェクトをC ++に変換する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonオブジェクト（基本的には</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">への逆変換</font><font style="vertical-align: inherit;">については、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブで説明してい</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font><i><font style="vertical-align: inherit;">では、</font></i><font style="vertical-align: inherit;">変換は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertToTypeCode
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ディレクティブのコードは、</font><font style="vertical-align: inherit;">変換プロセス中にさまざまな目的で数回呼び出されるため、より複雑に見えます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ内で、</font><font style="vertical-align: inherit;">SIPは使用できる（または使用すべき）いくつかの変数を作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの変数の1つである</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject * sipPy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、この場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスのインスタンスを作成するために必要なPythonオブジェクトです</font><font style="vertical-align: inherit;">。結果は別の変数に書き込む必要があります</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は作成されたオブジェクトへのダブルポインターです。この例では、この変数は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring **</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型になります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディレクティブ内で作成された別の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int * sipIsErr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。この変数の値が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULLの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">は、型変換が可能かどうかを確認するためにのみ呼び出されます。この場合、私たちは変換を実行する義務はありませんが、それが原則的に可能であるかどうかを確認する必要があるだけです。可能であれば、ディレクティブはゼロ以外の値を返す必要があります。それ以外の場合、変換が不可能な場合は、0を返す必要があり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このポインターが</font><i><font style="vertical-align: inherit;">NULL</font></i><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">ない場合は</font><font style="vertical-align: inherit;">、変換を実行する必要があります。変換中にエラーが発生した場合、整数エラーコードを保存できます。この変数に（この変数が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">へのポインタである場合</font><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例で</font><font style="vertical-align: inherit;">は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipPy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がユニコード文字列（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス</font><font style="vertical-align: inherit;">）である</font><font style="vertical-align: inherit;">ことを確認するため</font><font style="vertical-align: inherit;">に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_Check</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マクロが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">使用されます</font></a><font style="vertical-align: inherit;">。これは</font><font style="vertical-align: inherit;">、渡された引数がユニコード文字列またはそれから派生したクラスである場合、</font><font style="vertical-align: inherit;">タイプ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数を取り</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C ++オブジェクトへの変換は、文字列</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* sipCppPtr = new std :: wstring（PyUnicode_AS_UNICODE（sipPy））;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して実行され</font><i><font style="vertical-align: inherit;">ます。</font></i><font style="vertical-align: inherit;">。これは、</font><font style="vertical-align: inherit;">Python / C APIから</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マクロ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">ます。これは、タイプ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Py_UNICODE *の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列を返します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wchar_t *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同等</font><font style="vertical-align: inherit;">です。この配列は</font><i><font style="vertical-align: inherit;">std :: wstring</font></i><font style="vertical-align: inherit;">クラスのコンストラクターに渡されます</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">上記のように、結果は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数に格納されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブは</font><font style="vertical-align: inherit;">廃止されており、他のマクロを使用することをお勧めしますが、このマクロは例を簡略化するために使用されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変換が成功した場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">はゼロ以外の値（この場合は1）を返し、エラーの場合は0を返します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 小切手 </font></font></h3><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
型</font><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型への変換について説明しました</font><font style="vertical-align: inherit;">が、パッケージが正常にビルドされ、バインディングが正しく機能することを確認できます。</font><font style="vertical-align: inherit;">ビルドするには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheelを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">、次にpipを使用してパッケージをインストールし、Pythonコマンドモードでの操作性を確認します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、すべてが機能し、ロシア語にも問題はありません。</font><font style="vertical-align: inherit;">Unicode文字列変換が正しく実行されました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、CおよびC ++で作成されたライブラリーのPythonバインディングを作成するためのSIPの基本について説明しました。</font><font style="vertical-align: inherit;">最初に（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、Cで単純なライブラリを作成し、SIPで動作するように作成する必要があるファイルを見つけました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルに</font><font style="vertical-align: inherit;">は、パッケージに関する情報（名前、バージョン番号、ライセンス、およびヘッダーファイルとオブジェクトファイルへのパス）が含まれています。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを使用すると</font><font style="vertical-align: inherit;">、Pythonパッケージのビルドプロセスに影響を与えることができ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">たとえば、C / C ++ライブラリのビルドを開始したり、ユーザーがライブラリのヘッダーファイルやオブジェクトファイルの場所を指定できるようにしたりできます。</font><i><font style="vertical-align: inherit;">* .sip</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイル</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールに含まれる関数とクラスをリストするPythonモジュールのインターフェースについて説明します。</font><font style="vertical-align: inherit;">ディレクティブとアノテーションは</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">sip</font></i><font style="vertical-align: inherit;">ファイルでインターフェースを記述する</font><font style="vertical-align: inherit;">ために使用さ</font><font style="vertical-align: inherit;">れます</font><font style="vertical-align: inherit;">。 Pythonクラスインターフェイスは、C ++クラスインターフェイスと一致する必要はありません。たとえば、あなたが使用してクラスにプロパティを追加することができます</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％のプロパティの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを</font><font style="vertical-align: inherit;">使用して、名前の変更、エンティティ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ PyName /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注釈を</font><font style="vertical-align: inherit;">し、使用してドキュメントの行を追加します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ドキュメンテーション文字列の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブを</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">int</font></i><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">char</font></i><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">char *</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
などの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等SIPは自動的に類似のPythonクラスに変換しますが、より複雑な変換を実行する必要がある場合は</font><font style="vertical-align: inherit;">、Python / C APIを使用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクティブ内で自分でプログラムする必要があり</font><font style="vertical-align: inherit;">ます。 PythonクラスからC ++への変換は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネストディレクティブで行う必要があります</font><font style="vertical-align: inherit;">。 C ++型からPythonクラスへの変換は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％ConvertFromTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネストディレクティブで行う必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下のようないくつかのディレクティブ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultDocstringFormat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％DefaultDocstringSignatureは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">補助であり、いくつかの注釈パラメータが明示的に設定されていないときは、ケースのデフォルト値を設定することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、基本的で最も単純なディレクティブとアノテーションのみを調べましたが、それらの多くは無視されました。</font><font style="vertical-align: inherit;">たとえば、GILを管理するためのディレクティブ、新しいPython例外を作成するため、メモリとガベージコレクターを手動で管理するため、さまざまなオペレーティングシステムのクラスを調整するためのディレクティブなど、複雑なC / C ++ライブラリバインディングを作成するときに役立つディレクティブが多数あります。</font><font style="vertical-align: inherit;">また、さまざまなオペレーティングシステム用のパッケージのビルドの問題を回避し、gcc / g ++コンパイラを使用したLinuxでのビルドに限定しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事の最初の部分</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事の例</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIPホームページ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIPのドキュメント</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python / C APIドキュメント</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495618/index.html">検疫は損失につながります。検疫なしで生活する方法は？</a></li>
<li><a href="../ja495620/index.html">Jabra Panacastでビデオ会議ハーベスターを組み立て、オフィスと家庭用のプラスとマイナス</a></li>
<li><a href="../ja495622/index.html">デジタルツイン空調システム（SLE）航空機</a></li>
<li><a href="../ja495624/index.html">XboxシリーズXが2020年の主な購入になる理由</a></li>
<li><a href="../ja495634/index.html">誰もがそれを行う：なぜ従業員が企業の情報セキュリティに対する主な脅威であり、それに対処する方法</a></li>
<li><a href="../ja495638/index.html">英語のコンマ：5つのルールと上位3つのエラー</a></li>
<li><a href="../ja495642/index.html">コピー機能でエラーの収集を開始する</a></li>
<li><a href="../ja495644/index.html">TSトータルサイト。イベント収集、インシデント分析、脅威対応自動化ツール</a></li>
<li><a href="../ja495646/index.html">週末に聞くべきストレスのないポッドキャスト</a></li>
<li><a href="../ja495658/index.html">機械学習用のオーディオを入手する場所：クリエイティブ・コモンズでライセンスされている一連のオープンライブラリ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>