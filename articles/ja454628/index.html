<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎡 🙍🏽 🙎🏼 自動メッセージ管理システムの構築 ✨ 🍓 🚺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="自動モデレートシステムは、多数のユーザーメッセージを処理する必要があるWebサービスおよびアプリケーションに実装されます。このようなシステムでは、手動によるモデレートのコストを削減し、スピードを上げて、すべてのユーザーメッセージをリアルタイムで処理できます。この記事では、機械学習アルゴリズムを使用し...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>自動メッセージ管理システムの構築</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454628/"><img src="https://habrastorage.org/webt/xu/yp/u9/xuypu9acrj8o6qbkrhu53ue4kni.png" alt="画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動モデレートシステムは、多数のユーザーメッセージを処理する必要があるWebサービスおよびアプリケーションに実装されます。</font><font style="vertical-align: inherit;">このようなシステムでは、手動によるモデレートのコストを削減し、スピードを上げて、すべてのユーザーメッセージをリアルタイムで処理できます。</font><font style="vertical-align: inherit;">この記事では、機械学習アルゴリズムを使用して英語を処理するための自動モデレートシステムの構築について説明します。</font><font style="vertical-align: inherit;">研究タスクからのパイプライン全体と、MLアルゴリズムの選択から本番環境への展開までについて説明します。</font><font style="vertical-align: inherit;">既製のデータセットを探す場所と、タスクのデータを自分で収集する方法を見てみましょう。</font></font><br>
<a name="habracut"></a><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ira Stepanyukと共同で準備（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">id_step</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、Poteha Labsのデータサイエンティスト</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクの説明</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはマルチユーザーのアクティブチャットを使用しており、数十人のユーザーからの短いメッセージが毎分1つのチャットで届くことがあります。</font><font style="vertical-align: inherit;">そのようなチャットのダイアログで、有毒なメッセージやわいせつなメッセージを強調することがタスクです。</font><font style="vertical-align: inherit;">機械学習の観点から見ると、これはバイナリ分類タスクであり、各メッセージをクラスの1つに割り当てる必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するには、まず有毒なメッセージとは何か、正確には何が有毒なのかを理解する必要がありました。</font><font style="vertical-align: inherit;">これを行うために、インターネット上の多数の一般的なユーザーメッセージを調べました。</font><font style="vertical-align: inherit;">ここでは、すでに有毒なメッセージと通常のメッセージに分けたいくつかの例を示します。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">毒性</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正常</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたはいまいましいfag * ot</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この本はとてもダミーです</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたの子供はとても醜いです（1）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勝者は勝ち、敗者は言い訳をする</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">白人は黒の所有者です（2）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の魂のような黒（2）</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有毒なメッセージにはわいせつな言葉が含まれていることがよくありますが、これは必須条件ではありません。</font><font style="vertical-align: inherit;">メッセージには不適切な単語は含まれていませんが、誰かに不快感を与える可能性があります（例（1））。</font><font style="vertical-align: inherit;">さらに、有毒なメッセージと通常のメッセージに、攻撃的であるかどうかにかかわらず、異なるコンテキストで使用される同じ単語が含まれている場合があります（例（2））。</font><font style="vertical-align: inherit;">このようなメッセージも区別できる必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまなメッセージを調査した結果、私たちのモデレーションシステムでは</font><font style="vertical-align: inherit;">、わいせつ、侮辱的な表現、または誰かへの憎悪を伴う発言を含むメッセージを</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有毒</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼びました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font></font></h2><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンデータ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も有名なモデレーションデータセットの1つは、Kaggle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toxic Comment Classification Challengeの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセット</font><font style="vertical-align: inherit;">です。データセット内のマークアップの一部が正しくありません。たとえば、わいせつな単語を含むメッセージには通常のマークを付けることができます。このため、カーネルの競争に参加して、適切に機能する分類アルゴリズムを取得することはできません。データをさらに処理し、どの例が不十分かを確認し、そのような例を使用してデータを追加する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテストに加えて、適切なデータセット（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）ただし、すべてが商用プロジェクトで使用できるわけではありません。</font><font style="vertical-align: inherit;">ほとんどの場合、これらのデータセットには、ソーシャルネットワークのTwitterからのメッセージが含まれています。</font><font style="vertical-align: inherit;">さらに、特定のハッシュタグを使用して有毒なユーザーメッセージを検索およびマークアップできるため、Twitterからデータが収集されます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手動データ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オープンソースからデータセットを収集して基本モデルでトレーニングした後、オープンデータでは不十分であることが明らかになりました。モデルの品質は満足のいくものではありません。</font><font style="vertical-align: inherit;">問題を解決するためのオープンデータに加えて、多数の有毒なメッセージを含むゲームメッセンジャーからの未割り当てのメッセージを利用できました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eh/sp/5o/ehsp5oivhvjnfgxrnjqc7wszf9u.gif" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このデータをタスクに使用するには、何らかの方法でラベルを付ける必要がありました。</font><font style="vertical-align: inherit;">その時、すでに訓練されたベースライン分類器があり、それを半自動マーキングに使用することにしました。</font><font style="vertical-align: inherit;">すべてのメッセージをモデルに通して、各メッセージの毒性確率を取得し、降順で並べ替えました。</font><font style="vertical-align: inherit;">このリストの最上位にあるメッセージは、わいせつで不快な言葉で収集されました。</font><font style="vertical-align: inherit;">最後に、逆に、通常のユーザーメッセージです。</font><font style="vertical-align: inherit;">したがって、ほとんどのデータ（非常に大きい確率値と非常に小さい確率値）はマークアウトできませんでしたが、すぐに特定のクラスに割り当てられました。</font><font style="vertical-align: inherit;">リストの真ん中にあるメッセージをマークするために残っています、それは手動で行われました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ増強</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、データセットでは、分類子が誤っており、人がその意味を正しく理解している変更されたメッセージを見ることができます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、ユーザーがモデレートシステムを調整して不正行為をすることを学習し、アルゴリズムが有毒なメッセージで間違いを犯し、その意味がユーザーに明確に残るためです。</font><font style="vertical-align: inherit;">ユーザーが現在行っていること：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプミスは生成し</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><i><font style="vertical-align: inherit;">あなたは愚かなろくでなし、あなたを騙します</font></i><font style="vertical-align: inherit;">、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">英字を説明と同様の数字に置き換えます：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n1gga、b0ll0cks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">余分なスペースを挿入する：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">馬鹿</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単語間のスペースを削除します：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieyoustupid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような置換に耐性のある分類子をトレーニングするには、ユーザーが行うことを行う必要があります。メッセージに同じ変更を生成し、それらをメインデータのトレーニングセットに追加します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、この闘争は避けられません。ユーザーは常に脆弱性とハッキングを見つけようとし、モデレーターは新しいアルゴリズムを実装します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブタスクの説明</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの異なるモードでメッセージを分析するためのサブタスクに直面しました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> オンラインモード-メッセージのリアルタイム分析、最大応答速度。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> オフラインモード-メッセージログの分析と有毒なダイアログの割り当て。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オンラインモードでは、各ユーザーメッセージを処理し、モデル全体で実行します。</font><font style="vertical-align: inherit;">メッセージが有毒な場合は、チャットインターフェースで非表示にし、正常な場合は表示します。</font><font style="vertical-align: inherit;">このモードでは、すべてのメッセージを非常に迅速に処理する必要があります。モデルは、ユーザー間の対話の構造を乱さないように迅速に応答する必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オフラインモードでは作業の時間制限がないため、最高品質のモデルを実装したいと考えました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインモード。</font><font style="vertical-align: inherit;">辞書検索</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次にどのモデルが選択されるかに関係なく、わいせつな言葉でメッセージを見つけてフィルタリングする必要があります。</font><font style="vertical-align: inherit;">この副問題を解決するには、スキップできない無効な単語と表現の辞書をコンパイルし、各メッセージでそのような単語を検索するのが最も簡単です。</font><font style="vertical-align: inherit;">検索は高速でなければならないため、その時間の単純な部分文字列検索アルゴリズムは適合しません。</font><font style="vertical-align: inherit;">文字列内の単語のセットを見つけるための適切なアルゴリズムは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Aho-Korasikアルゴリズム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">このアプローチにより、有毒な例をすばやく特定し、メインアルゴリズムに送信する前にメッセージをブロックすることができます。</font><font style="vertical-align: inherit;">MLアルゴリズムを使用すると、メッセージの「意味を理解」し、分類の品質を向上させることができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインモード。</font><font style="vertical-align: inherit;">基本的な機械学習モデル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベースモデルについては、テキスト分類に標準的なアプローチを使用することにしました。TF-IDF+古典的な分類アルゴリズムです。速度とパフォーマンスの理由から。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TF-IDFは、各ドキュメントの単語の頻度と特定の単語を含むドキュメントの数（詳細は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">2つのパラメーターを使用して、本文のテキストの最も重要な単語を特定できる統計的指標です</font><font style="vertical-align: inherit;">。 TF-IDFメッセージの各単語について計算すると、このメッセージのベクトル表現が得られます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TF-IDFは、テキスト内の単語だけでなく、nグラムの単語や文字についても計算できます。このような拡張機能は、トレーニングセットに含まれていない（語彙外の）頻繁に発生するフレーズや単語を処理できるため、より適切に機能します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> TfidfVectorizer
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> sparse<font></font>
vect_word = TfidfVectorizer(max_features=<span class="hljs-number">10000</span>, lowercase=<span class="hljs-literal">True</span>, <font></font>
  analyzer=<span class="hljs-string">'word'</span>, min_df=<span class="hljs-number">8</span>, stop_words=stop_words, ngram_range=(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>))<font></font>
vect_char = TfidfVectorizer(max_features=<span class="hljs-number">30000</span>, lowercase=<span class="hljs-literal">True</span>,<font></font>
   analyzer=<span class="hljs-string">'char'</span>, min_df=<span class="hljs-number">8</span>, ngram_range=(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>))<font></font>
<font></font>
x_vec_word = vect_word.fit_transform(x_train)<font></font>
x_vec_char = vect_char.fit_transform(x_train)<font></font>
x_vec = sparse.hstack([x_vec_word, x_vec_char])</code></pre><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単語と記号のnグラムでTF-IDFを使用する例</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メッセージをベクトルに変換した後、古典的な分類方法を使用できます：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロジスティック回帰、SVM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムフォレスト、ブースティング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモデルでは、他の従来のML分類子と比較して速度が向上し、クラス確率を予測するため、ロジスティック回帰を使用することにしました。これにより、本番環境で分類しきい値を柔軟に選択できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TF-IDFとロジスティック回帰を使用して取得したアルゴリズムはすぐに機能し、わいせつな言葉や表現でメッセージを適切に定義しますが、必ずしも意味を理解しているわけではありません。たとえば、「</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">黒</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」および「および」</font><font style="vertical-align: inherit;">という単語を含むメッセージがよくある</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェミニズム</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は毒性クラスに落ちた。</font><font style="vertical-align: inherit;">この問題を修正し、次のバージョンの分類子を使用してメッセージの意味をよりよく理解することを学びました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オフラインモード</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージの意味をよりよく理解するために、ニューラルネットワークアルゴリズムを使用できます。</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 埋め込み（Word2Vec、FastText）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ニューラルネットワーク（CNN、RNN、LSTM）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 新しい事前トレーニング済みモデル（ELMo、ULMFiT、BERT）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのアルゴリズムのいくつかと、それらの使用方法について詳しく説明します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Word2VecおよびFastText</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
埋め込みモデルを使用すると、テキストから単語のベクトル表現を取得できます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Word2Vecには、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキップグラムとCBOW（単語の連続バッグ）の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2種類</font></a><font style="vertical-align: inherit;">があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">スキップグラムでは、単語によってコンテキストが予測されますが、CBOWではその逆です。単語はコンテキストによって予測されます。</font></font><br>
<img src="https://habrastorage.org/webt/rc/kb/iv/rckbivfc1dvmna3bvccy6xoai_g.png" alt="画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなモデルは、大量のテキストでトレーニングされ、トレーニングされたニューラルネットワークの非表示レイヤーから単語のベクトル表現を取得できます。このアーキテクチャの欠点は、コーパスに含まれる限られた単語セットからモデルが学習することです。つまり、トレーニング段階でテキストの本文になかったすべての単語については、埋め込みはありません。そして、この状況は、事前訓練されたモデルがタスクに使用されている場合によく発生します。一部の単語には埋め込みがないため、大量の有用な情報が失われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
辞書にない単語（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">OOV</font></a><font style="vertical-align: inherit;">、語彙外）の問題を解決するために、改善された埋め込みモデル</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-FastTextがあります。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">単一の単語を使用してニューラルネットワークをトレーニングする代わりに、FastTextは単語をNグラム（サブワード）に分割し、それらから学習します。</font><font style="vertical-align: inherit;">単語のベクトル表現を取得するには、この単語のn-gramのベクトル表現を取得して追加する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、事前トレーニング済みのWord2VecおよびFastTextモデルを使用して、メッセージから特徴ベクトルを取得できます。</font><font style="vertical-align: inherit;">得られた特性は、古典的なML分類器または完全に接続されたニューラルネットワークを使用して分類できます。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/jb/bp/ma/jbbpma-miqfsht7roadxuk2bap4.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事前</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">トレーニング済みのFastText</font></a><font style="vertical-align: inherit;">を使用するという意味での「最も近い」という単語の出力の例</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CNN分類子</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ニューラルネットワークアルゴリズムからのテキストの処理と分類には、シーケンスでうまく機能するため、リカレントネットワーク（LSTM、GRU）がよりよく使用されます。畳み込みネットワーク（CNN）は、画像処理に最もよく使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れますが、テキスト分類タスクで</font><font style="vertical-align: inherit;">も</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">使用でき</font></a><font style="vertical-align: inherit;">ます。これを行う方法を検討してください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各メッセージは、トークン（単語）の各行にベクトル表現が記述された行列です。たたみ込みはこのようなマトリックスに特定の方法で適用されます。たたみ込みフィルターはマトリックスの行全体（単語ベクトル）を「滑走」しますが、一度に複数の単語（通常2〜5単語）をキャプチャするため、隣接する単語のコンテキストで単語を処理します。これがどのように起こるかの詳細は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写真</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で見ることができます</font><font style="vertical-align: inherit;">。</font></font><br>
<img src="https://habrastorage.org/webt/hx/yd/vf/hxydvfho2bzzmgyjedkkt9lz9gc.png" alt="画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
反復を使用できるのに、ワードプロセッシングに畳み込みネットワークを使用するのはなぜですか？</font><font style="vertical-align: inherit;">実際、畳み込みははるかに速く機能します。</font><font style="vertical-align: inherit;">メッセージを分類するタスクにそれらを使用すると、トレーニングの時間を大幅に節約できます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ELMo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ELMo（言語モデルからの埋め込み）は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近導入さ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れた言語モデルに基づく埋め込みモデルです</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">新しい埋め込みモデルは、Word2VecおよびFastTextモデルとは異なります。</font><font style="vertical-align: inherit;">ELMoワードベクトルには特定の利点があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各単語の表示は、それが使用されるコンテキスト全体に依存します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表現はシンボルに基づいており、OOV（語彙外）単語の信頼できる表現を形成できます。</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ELMoは、NLPのさまざまなタスクに使用できます。</font><font style="vertical-align: inherit;">たとえば、私たちのタスクでは、ELMoを使用して受信したメッセージベクトルを従来のML分類器に送信するか、畳み込みまたは完全に接続されたネットワークを使用できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ELMoの事前トレーニング済み埋め込みは、タスクで使用するのが非常に簡単</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用例は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここにあります</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装機能</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flask API</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロトタイプAPIは使いやすいため、Flaskで記述されています。 </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つのDockerイメージ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デプロイには、2つのDockerイメージを使用しました。すべての依存関係がインストールされているベースイメージと、アプリケーションを起動するメインイメージです。</font><font style="vertical-align: inherit;">これにより、最初のイメージが再構築されることはほとんどないため、アセンブリ時間を大幅に節約でき、展開中の時間を節約できます。</font><font style="vertical-align: inherit;">機械学習ライブラリの構築とダウンロードにはかなりの時間が費やされますが、これはすべてのコミットで必要なわけではありません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト中</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
かなり多数の機械学習アルゴリズムの実装の特徴は、検証データセットのメトリックが高くても、本番環境でのアルゴリズムの実際の品質が低くなる可能性があることです。</font><font style="vertical-align: inherit;">したがって、アルゴリズムの動作をテストするために、チーム全体がSlackのボットを使用しました。</font><font style="vertical-align: inherit;">これは非常に便利です。チームのどのメンバーも、特定のメッセージに対してアルゴリズムが与える応答を確認できるからです。</font><font style="vertical-align: inherit;">このテスト方法では、ライブデータでアルゴリズムがどのように機能するかをすぐに確認できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex TolokaやAWS Mechanical Turkなどのパブリックサイトでソリューションを起動することをお勧めします。</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動メッセージ管理の問題を解決するためのいくつかのアプローチを検討し、実装の機能について説明しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業中に得られた主な観察：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TF-IDFとロジスティック回帰に基づく辞書検索と機械学習アルゴリズムにより、メッセージを迅速に分類できましたが、常に正しくなるとは限りませんでした。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ニューラルネットワークアルゴリズムと事前トレーニング済みの埋め込みモデルは、このタスクにうまく対応し、メッセージの意味の範囲内で毒性を特定できます。 </font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、オープンな</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poteha Toxic Comment Detection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デモを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Facebook</font></a><font style="vertical-align: inherit;">ボット</font><font style="vertical-align: inherit;">に投稿しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ボットの改善にご協力ください！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コメント欄で質問にお答えします。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454616/index.html">メンタルワーカーの効率を高めるためのAIの使用</a></li>
<li><a href="../ja454618/index.html">生産性ピット：Slackがワークフローに与える影響</a></li>
<li><a href="../ja454620/index.html">#NoDeployFriday：役立つか害を及ぼすか？</a></li>
<li><a href="../ja454622/index.html">Kreisel EVEX 910e：歴史モデル-新生活</a></li>
<li><a href="../ja454626/index.html">昨日と今日のDevOops</a></li>
<li><a href="../ja454634/index.html">セキュリティウィーク23：メモ帳の脆弱性、パッチが適用されていないRDPを使用する100万のシステム</a></li>
<li><a href="../ja454640/index.html">VPNでのSSHによる4ターンのリモートマイクロサービスデバッグ</a></li>
<li><a href="../ja454642/index.html">「「人のためのアプリケーションを作成する」-これはひざまずいてはいけません」：CFTでのモバイル開発について</a></li>
<li><a href="../ja454644/index.html">Cisco 200-125 CCNA v3.0のトレーニング。8日目。スイッチの設定</a></li>
<li><a href="../ja454646/index.html">@Pythonetcコンパイル、2019年5月</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>