<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗞️ 👩🏿‍🚒 🈯️ Cylance vs Sality 👩🏻‍🏭 👄 🕺🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. In anticipation of the start of the course “Reverse Engineering 2.0” , another interesting translation was prepared.
 
 
 
 Sality has...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cylance vs Sality</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/499328/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone. </font><font style="vertical-align: inherit;">In anticipation of the start of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Reverse Engineering 2.0”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , another interesting translation was prepared.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/c7/sl/d7/c7sld7rzstmdhisdtiphk1jxkai.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sality has been terrorizing computer users since 2003, when personal digital assistants (PDAs or PDAs) made headlines for technical publications and office PCs were running Windows XP. Over the years, users managed to exchange their PDAs for smartphones, and desktop computers switched to new operating systems and digital solutions for workstations. Sality, however, has survived the frantic pace of technological innovation and continues to threaten organizations to this day.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sality virus infects local executables, removable media, and remotely used drives. </font><font style="vertical-align: inherit;">It creates a peer-to-peer (P2P) botnet that facilitates the download and execution of other malware. </font><font style="vertical-align: inherit;">Sality can perform malicious code injection and modify its entry point to force code execution. </font><font style="vertical-align: inherit;">This malware remains viable, adopting successful strategies of other threats, including methods such as rootkit / backdoor, keylogging and worm-like distribution.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attack chain analysis</font></font></h3><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/CkF1nECnoDs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sality Analysis</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our analysis begins with a screenshot of a Windows Defender service file infected with malicious code. Note the malicious code embedded in the last section of this file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 1)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-9/tg/qz/-9tgqzdy6_dojkdd4ocuvwhureo.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 1: The last line shows the read / write executable file</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sality creates three copies of itself. The first copy is saved in the folder </font></font><code>%AppData%\local\temp\</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 2)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and embedded in the explorer process </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 3)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tt/d8/6z/ttd86zjvv--fsblodeb_y-isrja.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2: The first copy of Sality is saved in the folder </font></font><code>%temp%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the name </font></font><code>xelag.exe</code></i><br>
<br>
<img src="https://habrastorage.org/webt/o5/wn/ff/o5wnffkyw5o9z5p2yjikzqetrxk.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 3: The malicious process is embedded in the explorer process ( </font></font><code>xelag.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The second copy of this malware is saved in the folder </font></font><code>%AppData%\local\temp\%random_folder_name%\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with name </font></font><code>WinDefender.exe</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(figure 4)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mi/u9/lt/miu9lteqe8zbbskgc8kw63cika4.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 4. The second copy of Sality with the name</font></font><code>WinDefender.exe</code></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The third copy of Sality is stored in the virtual memory of the remote process in the folder </font></font><code>%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\Download_Manager.exe</code><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 5)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mj/5k/bw/mj5kbwbocnvtezd7dv0hpqnjfsy.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 5: The third copy of Sality saved with the name </font></font><code>Download_Manager.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
To ensure sustainability, Sality modifies the registry </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 6)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k_/as/uh/k_asuhnmmnt8svejqaev8n1mv0u.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 6: Sality is written to the registry.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Then the virus tries to establish a P2P connection to download additional malware </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 7)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k5/6q/fv/k56qfvt--mbmxh8iei5bcvwn7ei.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 7: Sality turns to suspicious IP to get more malware.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
When the victim restarts the computer, all three copies of the malware are embedded in </font></font><code>explorer.exe</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Figure 8)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/zi/bu/ptzibuukftvhou896_baxgym_ek.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 8: All three copies of Sality are embedded in the explorer process.</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is Sality important and why should I be bothered?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sality made its debut the same year that Apple opened the iTunes store, and cinemas put together a box office at King's Return. </font><font style="vertical-align: inherit;">He remains a threat today. </font><font style="vertical-align: inherit;">Only one longevity of the Sality virus is evidence of its effectiveness, adaptability and adaptability. </font><font style="vertical-align: inherit;">Any malware that is still viable a decade and a half after its initial detection should not be out of sight of users and security professionals. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compared to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nemucod</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Sality is a more complete and mature malware example. It has a long history of changes that point to a diverse set of use cases with the ability to deploy Sality depending on the objectives and complexity of the attack. Comparing Sality's capabilities with the categories of MITER ATT &amp; CK tactics, this malware is able to play a role at every internal stage of the attack chain after execution, which means that Sality needs a delivery method on the environment before it can get to work.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If necessary, Sality can act as the main operational agent, providing the attacker with a basic set of functions for performing various actions on the goal, aimed at maintaining and expanding access. It also has the ability to modular download additional features as needed by an attacker. The flexibility offered by this basic feature set makes Sality suitable for a wide range of offensive campaigns.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The flexibility afforded by common malware such as Sality offers more sophisticated attackers the ability to hide the activity and intent of a targeted attack under the guise of a broad, indiscriminate campaign. </font><font style="vertical-align: inherit;">An attacker can use the capabilities of Sality in the first wave of a targeted attack, establishing a foothold in the environment. </font><font style="vertical-align: inherit;">Thanks to this access, an attacker can open up more sophisticated or destructive malware after he estimates the operational risk based on the defensive position of the target.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cylance Stops Sality</font></font></h3><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CylancePROTECT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
users </font><font style="vertical-align: inherit;">will be happy to know that we detect and prevent Sality before it launches. </font><font style="vertical-align: inherit;">By preventing the launch of Sality, we protect our customers from this masticative malware and many other threats that it seeks to deploy. </font><font style="vertical-align: inherit;">Sality may or may not be long-lived, but it will not survive on machines protected by CylancePROTECT.</font></font><br>
 <br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Get a discount on the course.</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en499316/index.html">Efficient, reliable microservices</a></li>
<li><a href="../en499320/index.html">What is the geometry of the universe?</a></li>
<li><a href="../en499322/index.html">Windows Server or Linux distributions? Choosing a server OS</a></li>
<li><a href="../en499324/index.html">Install and configure the SDK for building LibreOffice extension</a></li>
<li><a href="../en499326/index.html">Sweet bitterness of the product: in what metrics to work?</a></li>
<li><a href="../en499330/index.html">Moving Online: The Experience of Online Strategic Planning</a></li>
<li><a href="../en499334/index.html">What is the result of email marketing: how to make a forecast</a></li>
<li><a href="../en499338/index.html">All interviews and hiring of employees are now deleted.</a></li>
<li><a href="../en499340/index.html">3 free tools to make prototyping games even easier</a></li>
<li><a href="../en499344/index.html">ExtremeSwitching V300 - a new line of port extenders for enterprise networks with loose access</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>