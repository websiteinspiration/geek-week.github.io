<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçª üë®üèø‚Äç‚öïÔ∏è üçó Introducci√≥n a la explotaci√≥n y la reversi√≥n utilizando IDA FREE y otras herramientas gratuitas. Capitulo 2 üëáüèΩ üôÄ üè≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En la primera parte, instalamos varias herramientas que nos ser√°n √∫tiles para tomar este curso. Su caracter√≠stica es que todos son gratuitos. No utili...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Introducci√≥n a la explotaci√≥n y la reversi√≥n utilizando IDA FREE y otras herramientas gratuitas. Capitulo 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496672/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la primera parte, instalamos varias herramientas que nos ser√°n √∫tiles para tomar este curso. </font><font style="vertical-align: inherit;">Su caracter√≠stica es que todos son gratuitos. </font><font style="vertical-align: inherit;">No utilizaremos ninguna herramienta paga, y de aquellos que tienen una versi√≥n paga, como IDA o PYCHARM, utilizaremos la versi√≥n GRATUITA o COMUNITARIA.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos algunos conceptos antes de comenzar con los ejercicios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© es una BOLSA? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BAG es el resultado de una falla o falta en el proceso de creaci√≥n de programas de computadora (software) o una computadora. La falla especificada puede ocurrir en cualquier etapa del ciclo de vida del software, aunque la falla m√°s obvia ocurre en la etapa de desarrollo y programaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como siempre digo, un programador puede cometer errores, y estos errores pueden causar bloqueos o errores del programa. Hasta ahora, no he dicho nada nuevo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pregunta es saber la diferencia entre BOLSA y VULNERABILIDAD, as√≠ que veamos qu√© es la VULNERABILIDAD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© es la VULNERABILIDAD?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La VULNERABILIDAD es un cierto tipo de error en un programa que permite usarlo para violar la seguridad de un sistema inform√°tico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, las vulnerabilidades le permiten realizar acciones para las cuales el programa no fue dise√±ado y abusar de ellas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En otras palabras, la vulnerabilidad es un cierto tipo de error, un subconjunto entre ellos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ve/xv/dz/vexvdzddt1ik8nomu0jbz2yxjyi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, hay muchos tipos de vulnerabilidades. </font><font style="vertical-align: inherit;">Nos centraremos en el estudio y la explotaci√≥n de vulnerabilidades en WINDOWS.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es EXPLOIT?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EXPLOIT es un programa inform√°tico que intenta aprovechar alguna vulnerabilidad de otro programa. El objetivo final de un exploit puede ser malicioso, por ejemplo, como destruir o apagar un sistema atacado, aunque generalmente es una violaci√≥n de las medidas de seguridad para obtener acceso a la informaci√≥n de una manera no autorizada y usarla en sus propios intereses o como fuente de otros ataques contra terceros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El abuso de la vulnerabilidad puede conducir a la falla de la aplicaci√≥n o del sistema en s√≠, la ejecuci√≥n de c√≥digo nativo en m√°quinas locales o remotas. Su funcionamiento y complejidad dependen de la vulnerabilidad en s√≠, del entorno y de las medidas que tenga el objetivo durante la operaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primer tipo de vulnerabilidades que examinaremos ser√°n los desbordamientos del b√∫fer. </font><font style="vertical-align: inherit;">Comenzaremos con los ejemplos m√°s simples, y luego aumentaremos gradualmente la complejidad. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, las funciones de seguridad del sistema no se activar√°n, pero gradualmente las activaremos para descubrir c√≥mo podemos tratarlas y en qu√© situaciones.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es un BUFFER?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BUFFER es un espacio de memoria de cierto tama√±o reservado para el almacenamiento y la gesti√≥n de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un ejemplo b√°sico es un frasco de 20 litros, que tengo para almacenar contenidos. </font><font style="vertical-align: inherit;">Puede ser menor o igual a 20 litros, que es el tama√±o m√°ximo. </font><font style="vertical-align: inherit;">Si desea almacenar m√°s en un tanque, debe encontrar una manera de aumentar el tama√±o del b√∫fer, de lo contrario, cuando intente ahorrar, por ejemplo, 40 litros en una lata de 20 litros, se desbordar√°.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es un SOBRECARGO DE BUFFER?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EL DESBORDAMIENTO DEL BUFFER ocurre cuando un programa de computadora excede la cantidad de memoria reservada para √©l al escribir datos en un bloque de memoria contiguo. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.welivesecurity.com/la-es/tag/buffer-overflow-la-es</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En verdad, se produce un desbordamiento de b√∫fer en una aplicaci√≥n cuando no tiene las comprobaciones de seguridad necesarias en su c√≥digo de programa, como medir la cantidad de datos que se copiar√° en el b√∫fer y que no exceder√° el tama√±o del b√∫fer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los tipos m√°s comunes de desbordamientos de b√∫fer son los desbordamientos de b√∫fer de pila y los desbordamientos de b√∫fer de pila.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ vemos la definici√≥n de desbordamiento del b√∫fer, y en nuestro ejemplo anterior, si trato de verter 40 litros en un tanque de 20 litros, se desbordar√°, tal como lo entendemos. </font><font style="vertical-align: inherit;">Este es un desbordamiento que causa un desbordamiento del b√∫fer, es decir. </font><font style="vertical-align: inherit;">desbordamiento de mi tanque cuando se excede su capacidad m√°xima. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora explique la diferencia entre la pila y el mont√≥n.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es una pila?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
STACK se usa para almacenar variables de funciones locales que son necesarias solo mientras se ejecuta la funci√≥n. </font><font style="vertical-align: inherit;">En la mayor√≠a de los lenguajes de programaci√≥n, es importante que sepamos en tiempo de compilaci√≥n qu√© tan grande es una variable si queremos mantenerla en la pila.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es un lote?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heap se usa para reservar memoria din√°mica, cuya vida √∫til no se conoce de antemano, pero se espera que dure alg√∫n tiempo. Si no conocemos su tama√±o o si se determina en tiempo de ejecuci√≥n, el tama√±o debe calcularse y reservarse en el mont√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El mont√≥n tambi√©n se usa para objetos que var√≠an en tama√±o porque no sabemos en tiempo de compilaci√≥n cu√°nto tiempo se usar√°n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
He estado trabajando en nuestra empresa durante m√°s de 13 a√±os como autor de exploits, y lo primero que hacemos con todas las personas contratadas que incluso me hicieron cuando me un√≠ fue tratar de desentra√±ar las pilas y montones del famoso GERARDO RICHART. Es uno de los fundadores de CORE SECURITY y un gur√∫ de an√°lisis de exploits.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comenzaremos lentamente con las pilas m√°s simples. Por supuesto, como dije, se compilan en este momento con una protecci√≥n m√≠nima y son de 32 bits para facilitar la operaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos el c√≥digo fuente de la tarea STACK1. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://drive.google.com/open?id=16btJAetpa1V5yHDZE2bnnFWTQNpsUR4H</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vemos una carpeta con ejercicios, y dentro est√° el c√≥digo fuente STACK1 llamado STACK1_VS_2017.CPP.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#define _CRT_SECURE_NO_WARNINGS</span>
<span class="hljs-comment">#define _CRT_SECURE_NO_DEPRECATE</span><font></font>
<font></font>
<span class="hljs-comment">#include &lt;stdlib.h&gt;</span>
<span class="hljs-comment">#include  &lt;stdio.h&gt; </span>
<span class="hljs-comment">#include "Windows.h"</span><font></font>
<font></font>
<font></font>
int main(int argc, char **argv) <font></font>
{<font></font>
<font></font>
<font></font>
	MessageBoxA((HWND)<span class="hljs-number">-0</span>, (LPCSTR) <span class="hljs-string">"Imprimir You win..\n"</span>, (LPCSTR)<span class="hljs-string">"Vamosss"</span>, (UINT)<span class="hljs-number">0</span>);<font></font>
<font></font>
	int cookie;<font></font>
	char buf[<span class="hljs-number">80</span>];<font></font>
<font></font>
	printf(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);<font></font>
	gets(buf);<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (cookie == <span class="hljs-number">0x41424344</span>) printf(<span class="hljs-string">"you win!\n"</span>);<font></font>
<font></font>
}<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intentaremos comprender este c√≥digo y ver d√≥nde puede ocurrir el desbordamiento del b√∫fer, y si ser√° un desbordamiento del b√∫fer en la pila o en el mont√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La llamada de funci√≥n MessageBoxA se agreg√≥ al c√≥digo fuente STACK1 para mostrarnos un peque√±o mensaje que nos solicita que lo resolvamos. Esta es solo una adici√≥n que no afecta nada. Esta es una llamada est√°ndar a la funci√≥n WINDOWS especificada, que no analizaremos aqu√≠. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qui√©n necesita informaci√≥n sobre esta funci√≥n, puede obtenerla aqu√≠.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sabemos que dentro de la funci√≥n, si hay variables locales, debe reservar un lugar para ellas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces nos queda este c√≥digo fuente creado por GERARDO RICHART.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> 
</span>{<font></font>
<font></font>
	<span class="hljs-keyword">int</span> cookie;
	<span class="hljs-keyword">char</span> buf[<span class="hljs-number">80</span>];<font></font>
<font></font>
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);<font></font>
	gets(buf);<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (cookie == <span class="hljs-number">0x41424344</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"you win!\n"</span>);<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos en rojo la primera parte del programa, donde se reserva espacio para variables locales. En este caso, hay dos variables locales, COOKIE y BUF. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede ver los tipos de datos en la tabla</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Otros tipos de variables tambi√©n se encuentran all√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo se compilar√° en 32 bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que la variable COOKIE ser√° de tipo INT, por lo que se reservar√°n 4 bytes de memoria para esta variable. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1x/xh/qr/1xxhqrcrft6amjldaqun6yvffro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso de la variable BUF, vemos que es una matriz o una cadena de caracteres (tama√±o de caracteres = 1 byte). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/0f/py/5j0fpyugggmbrkvzktqjibwstuk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aquellos. ser√° una matriz de 80 caracteres, es decir su longitud ser√° 80x1 = 80 bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cualquiera que no sepa qu√© puede leer una matriz aqu√≠: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.programiz.com/c-programming/c-arrays</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, una matriz puede almacenar muchos valores del mismo tipo de datos. </font><font style="vertical-align: inherit;">Solo tiene que decirle qu√© tipo de datos ser√°n y cu√°nto habr√°. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e8/do/ab/e8doabufhyuyqjdwz95qlikvcim.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el primer ejemplo, esta es una matriz de enteros, es decir </font><font style="vertical-align: inherit;">ser√° de 100 bytes, y dado que cada n√∫mero entero toma 4 bytes, la longitud de la matriz ser√° de 100 x 4 = 400 bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el segundo ejemplo, FLOAT toma 4 bytes, por lo que ser√° una matriz de 5 FLOAT, por lo que su longitud ser√° 5 x 4 = 20 bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando analizamos la matriz a un nivel bajo, veremos que es un espacio de memoria o b√∫fer reservado. </font><font style="vertical-align: inherit;">Esta no es la √∫nica forma de reservar espacio en la memoria. </font><font style="vertical-align: inherit;">Existen otros tipos de datos variables que tambi√©n requieren espacio de reserva en la memoria que ser√°n almacenamientos intermedios para almacenar sus contenidos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Volviendo a nuestro ejercicio: </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">char</span> buf[<span class="hljs-number">80</span>];</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es una matriz de caracteres de 80 x 1 = 80 bytes de longitud, es decir se parece a nuestra jarra de 20 litros. Si intentamos almacenar m√°s de 80 bytes, el banco se desbordar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora veamos d√≥nde se usa el b√∫fer BUF. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kp/ac/nt/kpacnt_0dfwci5pzs4ubozc4tou.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que el b√∫fer se usa en dos lugares marcados con flechas rojas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera instrucci√≥n tiene una funci√≥n PRINTF, que se utiliza para mostrar un mensaje en la consola, que ser√° una cadena entre comillas.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-string">"buf: %08x cookie: %08x\n"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero la funci√≥n PRINTF no solo imprime la cadena entre comillas, sino que tambi√©n imprime la cadena en el formato especificado. Los porcentajes en el interior nos dicen que se crear√° una l√≠nea de salida. Vemos que la cadena es solo el primer argumento de la funci√≥n. El formato de salida y otros argumentos pueden ser varios (habr√° uno para cada argumento% en el formato). En nuestro caso, hay dos de ellos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hq/j5/ol/hqj5ollvpzgitrc29p3ywimufvm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, tenemos dos formatos% X, as√≠ que si me refiero a la tabla de formatos PRINTF: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/bt/b7/vnbtb7zfdmzy19wtmyd6mzxkit4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vemos que la funci√≥n tomar√° estos enteros (INT) y los insertar√° en la l√≠nea de salida con la base del sistema de n√∫meros 16, es decir. en formato hexadecimal 08 indica que si el n√∫mero contiene menos de 8 d√≠gitos, la funci√≥n lo llenar√° con espacios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La salida para "buf:% 31x", &amp; buf ser√° as√≠</font></font><br>
<br>
<pre><code class="cpp hljs">buf:             <span class="hljs-number">19F</span>ED4 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que en este ejemplo est√°n llenos de espacios antes del n√∫mero. Hay varios modificadores para mostrar la salida. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los casos posibles se enumeran aqu√≠: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.cplusplus.com/reference/cstdio/printf/</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nuestro caso es este: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/pa/g_/tfpag_nbzmhvrzf1gzsqczecfw4.png"><br>
<br>
<img src="https://habrastorage.org/webt/ja/yq/wo/jayqwocmor7ctp0y1tnykptorle.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vemos que el resultado no se trunca, se llena con espacios solo si la longitud del argumento para insertar es menor que el valor antes de X. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, sabemos que la funci√≥n imprime dos n√∫meros hexadecimales, que se obtienen de dos argumentos.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sabemos que una variable tiene una direcci√≥n de memoria y un valor que puede almacenarse. </font><font style="vertical-align: inherit;">Se parece a nuestra jarra de 20 litros. </font><font style="vertical-align: inherit;">Tiene su contenido o significado, es decir </font><font style="vertical-align: inherit;">litros almacenados en el interior, pero tambi√©n si tengo un garaje lleno de latas similares necesito alguna forma de determinar d√≥nde est√° la lata que quiero entre todas las que tengo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El s√≠mbolo &amp; indica esto. </font><font style="vertical-align: inherit;">Devuelve la direcci√≥n o ubicaci√≥n del jar, no su contenido o valor.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definici√≥n de AMPERSAND</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMPERSAND se usa para indicar la direcci√≥n de memoria de la variable en la que se almacenar√°n los datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, si ejecuto el archivo ejecutable en la consola, ver√©, por ejemplo, que cuando ejecuta la funci√≥n PRINTF, imprimir√°: las </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ry/bs/g6/rybsg6crsldpimnhgfopd2-oddq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
direcciones pueden cambiar en su PC, pero dado que la direcci√≥n inferior de ambas direcciones coincide con la direcci√≥n BUF, vemos que se encuentran de esta manera: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/-j/yc/xf-jycqtfpqcdyu_5tfsuv19uae.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La direcci√≥n BUF es menor que la direcci√≥n COOKIE, por lo que aumentar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øY qu√© nos dicen estas direcciones variables? (En mi caso, &amp; BUF = 0x19FED4 y &amp; COOKIE = 0x19FF24) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6s/xy/8a/6sxy8am2y6d2skgyu7pmsz-wd7i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ambos est√°n en formato hexadecimal. ¬øRecuerdas que este era el formato% X? As√≠ que pongo 0x adelante para distinguir los n√∫meros decimales que representaremos sin ninguna adici√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si hago una resta en la consola PYTHON o en PYCHARM: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rd/-u/hw/rd-uhwhszxlontfjic1tl7cqmvo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
obtenemos un resultado de 80 bytes, ya que la variable COOKIE supuestamente comienza exactamente donde termina el b√∫fer BUF, por lo que la diferencia nos da el tama√±o del b√∫fer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A menudo, cuando hacemos este tipo de variable en funci√≥n del c√≥digo fuente, puede suceder que el compilador nos proporcione un tama√±o mayor que el que est√° reservado en el c√≥digo fuente. El compilador garantiza que reservar√° al menos 80 bytes, es decir √©l puede reservar m√°s, no menos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El hecho es que ya sabemos algo sobre el c√≥digo, el tama√±o de las variables y su ubicaci√≥n debido al hecho de que tiene la funci√≥n PRINTF.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora veamos otro lugar donde se usa el b√∫fer BUF, porque ahora el programa solo imprime su direcci√≥n, pero no la usa para almacenar datos en ella.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> 
</span>{<font></font>
<font></font>
	<span class="hljs-keyword">int</span> cookie;
	<span class="hljs-keyword">char</span> buf[<span class="hljs-number">80</span>];<font></font>
<font></font>
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);<font></font>
	gets(buf);<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (cookie == <span class="hljs-number">0x41424344</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"you win!\n"</span>);<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠, en la l√≠nea roja, GET es una funci√≥n para ingresar datos desde el teclado. Los datos se ingresar√°n hasta que presione Enter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El programa no puede limitar la cantidad de datos ingresados ‚Äã‚Äãpor el usuario, y tampoco hay forma de verificar estos datos. Todo lo que se ingresa antes de presionar la tecla ENTER se copia al b√∫fer BUF. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este es el problema. Dijimos que BUF solo puede almacenar 80 bytes como m√°ximo, por lo que si ingresamos m√°s, crearemos un desbordamiento de b√∫fer, y aqu√≠ est√°n todas las condiciones para esto, porque si el usuario escribe m√°s de 80 bytes, entonces nuestro tanque se desbordar√° y el l√≠quido gotear√° . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pr/tv/0e/prtv0eh97rud78cpbrvpqmn7vd4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El hecho es que debajo de BUF est√° la variable COOKIE, por lo que el desbordamiento se sobrescribir√° y rellenar√° con un valor que puede controlar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, si alguien que imprime escribe 80 * A y 4 * B, 80 * A completar√° BUF y 4 * B completar√° COOKIE, y como sabemos, cuando alguien imprima un personaje en la consola, el valor seguir√° siendo bajo. ASCII </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bx/ff/lh/bxfflhk6qfthec5v64o3kr90ey8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que la cookie se llenar√° con cuatro letras B, que son equivalentes al valor 0x42, podemos garantizar que el valor de la cookie ser√° 0x42424242, es decir. en mi computadora, la direcci√≥n de cookie 0x19FF24 tendr√° 0x42424242 como contenido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0x19FF24 =&gt; 42424242 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mn/zl/zb/mnzlzbrka2otg0rszogmqu3xwmo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El hecho es que ya hemos visto c√≥mo desbordar y controlar el valor de COOKIE.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> 
</span>{<font></font>
<font></font>
	<span class="hljs-keyword">int</span> cookie;
	<span class="hljs-keyword">char</span> buf[<span class="hljs-number">80</span>];<font></font>
<font></font>
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);<font></font>
	gets(buf);<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (cookie == <span class="hljs-number">0x41424344</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"you win!\n"</span>);<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debe imprimir "usted gana" para completar el ejercicio. Para esto, la COOKIE debe ser igual al valor 0x41424344, y si no hubiera desbordamiento, esto ser√≠a imposible, ya que el valor de la COOKIE nunca ha cambiado desde el comienzo del programa. No podremos imprimir "usted gana", y para esto usamos un desbordamiento de b√∫fer, que dice que esto puede hacer que el programa realice alguna acci√≥n diferente a la programada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, nunca puede escribir "usted gana", solo el desbordamiento le permitir√° hacer esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AAAAAAAA </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En otras palabras, en lugar de pasar, por ejemplo, 80 * A y 4 * B, para imprimir "usted gana", debe pasar 80 * A y luego las letras DCBA, ya que esto har√° que los valores se almacenen en la COOKIE ASCII </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
44434241</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.arumeinformatica.es/blog/los-formatos-big-endian-y-little-endian/</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El formato en el que se almacenan los datos es LITTLE ENDIAN. En otras palabras, los datos en la memoria se almacenan en orden inverso, por decirlo simplemente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/91/jh/wo/91jhwoo4rj058xjbp9jdp089vw4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y si se guarda la secuencia 0x41424344, el sistema la guardar√° en la memoria como: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
44 43 42 41 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por esta raz√≥n, al copiar en la memoria, la copia se producir√° a medida que escribimos, por lo que debemos escribir el valor en el orden inverso para que al leer de la memoria Estaba en la forma correcta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos ejecutar el ejecutable en la consola. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/sn/yo/wnsnyolnlocppvkl573pmu-luva.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y el cursor parpadear√°, ya que la funci√≥n GET me pide que ingrese la entrada. Escriba cuidadosamente 80 caracteres A y luego DCBA.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la consola PYTHON o PYCHARM, puedo imprimir la l√≠nea, copiarla sin comillas y pegarla en la consola para no imprimirla como una locura, y luego presionar la tecla ENTER para ingresarla. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/9n/bh/um9nbhsmtv_w2cko2d1lwvelqwq.png"><br>
<br>
<img src="https://habrastorage.org/webt/rm/nr/be/rmnrbe4pvbxovetmml_n85dwc4q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que tenemos "t√∫ ganas". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos ver esto en el depurador. Para esto usaremos X64DBG. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/el/2x/db/el2xdbqsgxwi5rh22txd_hqnnx0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Elijo la versi√≥n de 32 bits. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/ep/e2/lyepe2znpbsedu8edqur13iocau.png"><br>
<br>
<img src="https://habrastorage.org/webt/ux/4u/pt/ux4upt903tftde_hfpteze3irho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nos detenemos en la biblioteca NTDLL.DLL, presionamos RUN nuevamente con F9. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que el depurador se detiene en la primera instrucci√≥n del m√≥dulo STACK1, que se llama ENTRY POINT o la primera instrucci√≥n ejecutada por el m√≥dulo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/va/y-/qf/vay-qf4tqfkxmlik0892lukku7g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente esto no es como nuestro c√≥digo fuente. Debe comprender que el compilador agrega mucho c√≥digo para que el ejecutable funcione y se ejecute correctamente. Intentaremos encontrar nuestra funci√≥n principal. Podemos orientarnos mirando las l√≠neas del programa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pg/hv/c9/pghvc9kf8f8xjzdpk4yigw5w5vy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seleccionamos solo buscar en la regi√≥n actual. Sabemos que las l√≠neas estar√°n en la misma secci√≥n. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a3/fj/qc/a3fjqcvl8iqrupyr4oz2trl0viw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ vemos que hay l√≠neas de programa y otras que agreg√≥ el compilador. Hacemos doble clic en una de nuestras l√≠neas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ua/fc/b6/uafcb61zxgu6jbg2yraawefum50.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora puedes ver mucho m√°s. Vemos una llamada a la funci√≥n MessageBoxA, PRINTF, GETS y una comparaci√≥n con el valor 0x41424344.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, estamos agregando un complemento para descompilar SNOWMAN. Podemos intentar ver c√≥mo descompila el c√≥digo, es decir c√≥mo est√° tratando de obtener el c√≥digo fuente o algo lo m√°s similar posible del archivo compilado. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/hs/-w/r0hs-w2cpoquwejdry_pogmxlpu.png"><br>
<br>
<img src="https://habrastorage.org/webt/8h/ib/j_/8hibj_rzmyn_5gwvlg-bqhg4upk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que esto no es perfecto, pero es mejor de lo que era. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voy a poner BP al comienzo de la funci√≥n y presionar F9 hasta que se detenga el depurador. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/wz/em/9jwzemcr76ij1vfdvy9pcdx9gaa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aquellos que no saben qu√© es un argumento de funci√≥n. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rt/su/31/rtsu317d7gmqo_u7parcbcxfagg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, la funci√≥n principal tiene argumentos, pero no se usan dentro de la funci√≥n.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> 
</span>{<font></font>
<font></font>
	<span class="hljs-keyword">int</span> cookie;
	<span class="hljs-keyword">char</span> buf[<span class="hljs-number">80</span>];<font></font>
<font></font>
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf: %08x cookie: %08x\n"</span>, &amp;buf, &amp;cookie);<font></font>
	gets(buf);<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (cookie == <span class="hljs-number">0x41424344</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"you win!\n"</span>);<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ vemos que hay dos argumentos, y se pasan a trav√©s de la pila cuando el ejecutable se compila en 32 bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Justo antes de la llamada a la funci√≥n, los argumentos se almacenar√°n en la pila. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando nos detenemos al comienzo de la funci√≥n, el primer valor en la pila ser√° DIRECCI√ìN DE RETORNO, es decir, d√≥nde volver√° la funci√≥n despu√©s de que se complete la funci√≥n, y debajo de este valor estar√°n los argumentos de esta funci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si hago clic con el bot√≥n derecho en DIRECCI√ìN DE RETORNO y selecciono SEGUIR DWORD EN DESMONTAJE, ver√© d√≥nde debe regresar el depurador una vez que se complete la funci√≥n. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9o/jb/1s/9ojb1skptq9fvde0hlbque803qs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El regresar√° aqu√≠. Esto significa que se llam√≥ a la funci√≥n principal desde una llamada que es m√°s alta. Puedo poner BP aqu√≠, reiniciar el ejercicio y asegurarme de que sea as√≠.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8w/8c/sc/8w8cscopqchym1ubcx2zuazrohq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pondr√© BP un ‚Äã‚Äãpoco antes y reiniciar√© el programa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w8/hc/te/w8hctep2w06vcaqzx_ouz4zguws.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El depurador se detendr√° aqu√≠. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/mk/3h/hymk3hx1u-myzmmlnygmmeadmww.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Guardar√° los argumentos en la funci√≥n principal utilizando estas instrucciones PUSH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n hay un enlace para aquellos que quieran saber m√°s sobre los argumentos de la funci√≥n: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://publications.gbdirect.co.uk/c_book/chapter10/arguments_to_main.html</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Esto no es muy dif√≠cil. El primer argumento para ARGC es INT, que indica el n√∫mero de par√°metros de consola utilizados para ejecutar el programa, incluida la ruta al ejecutable, y ARGV es una matriz de punteros a cadenas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que si cambio la l√≠nea de comando, pasar√© m√°s argumentos y volver√© a cargar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_a/1o/jc/_a1ojcg0g9lie1le3ouoyuyrtxo.png"><br>
<br>
<img src="https://habrastorage.org/webt/9f/pb/uy/9fpbuygn9gtz4osszzcffsurz9m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ el depurador se detiene cuando est√° a punto de guardar argumentos utilizando la instrucci√≥n PUSH. El primer argumento que se almacena es el m√°s alejado, y el √∫ltimo que guarde ser√° el primer argumento de la funci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trazo y cada instrucci√≥n PUSH guarda los argumentos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1u/yj/rp/1uyjrps22gzfc0re25uhcu-p8a8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ puedo ver los argumentos de la funci√≥n. Arriba est√° el primer argumento para ARGC. Es 3, ya que marca el n√∫mero de argumentos que se pasan a la consola. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vk/il/0i/vkil0istebtffechadwuwyqt2u8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay 3 argumentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora presionamos F7 para hacer STEP INTO e ingresar a la funci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ vemos que al ingresar la LLAMADA, el depurador guarda la DIRECCI√ìN DE RETORNO en la pila.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gp/xc/fw/gpxcfwbg8jr538d3c45oyrqke6e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, como ya dijimos al ingresar la funci√≥n, lo primero que se guardar√° en la pila es DIRECCI√ìN DE DEVOLUCI√ìN (en la compilaci√≥n de 32 bits), y a continuaci√≥n est√°n los argumentos de la funci√≥n, primero el primer argumento y luego el resto secuencialmente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qk/s4/bi/qks4bikctvy6i3oxg7sy2ipop_o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo argumento, como vimos, es una serie de punteros. Aqu√≠ vemos en la memoria que hay tres punteros a tres l√≠neas que se pasan como argumentos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c5/f3/kn/c5f3knt9kreq8r5kmfzqgvnv2zw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ nos detuvimos al comienzo de la funci√≥n, un poco m√°s abajo tenemos DIRECCIONES DE VUELTA y ARGUMENTOS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aclaramos que el archivo se compila en 32 bits, porque en la versi√≥n de 64 bits, los argumentos se pasan de una manera diferente. Lo veremos luego. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces la funci√≥n comienza a ejecutarse. Lo primero es el llamado PROLOGUE, que almacena el valor EBP de la funci√≥n que llam√≥ el nuestro.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ka/ss/9k/kass9k6zty8_-nxgxomh2zb6iui.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto mantendr√° el valor de EBP justo por encima de la direcci√≥n de retorno. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uo/da/gi/uodagirflnltomk1uqlo9dawbjo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si sigo las instrucciones con F7. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veo que el valor EBP GUARDADO est√° en la pila sobre la direcci√≥n de retorno. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/ml/wi/gwmlwilzarr_u67xp_-6dg5-m0w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La siguiente instrucci√≥n en PROLOGUE: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MOV EBP, ESP </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Establece el valor de EBP para la funci√≥n actual que se guard√≥ y fue la funci√≥n principal que llama a la nuestra (en este caso, mi funci√≥n principal es la funci√≥n basada en EBP, en otros casos puede ser diferente, y nosotros verlos m√°s tarde) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al colocar el valor ESP actual en EBP, nos aseguramos de crear un marco para nuestra funci√≥n actual.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bw/d0/8u/bwd08ut1gamkdw-5m9y58cqmdrw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, dado que esta funci√≥n se basa en EBP o EBP BASED, el valor de EBP se almacenar√° dentro de la funci√≥n y se aceptar√° como referencia, y el ESP cambiar√°. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/31/fm/rm/31fmrm3jsa9gz0dwzonyf4lh4wa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este valor de EBP se toma como base. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las funciones basadas en EBP, las variables y los argumentos se pueden nombrar por su distancia desde esta direcci√≥n, que se almacenar√° en el valor de EBP hasta su ep√≠logo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos ver varias variables en la lista a las que se hace referencia como EBP-4 o EBP-54, en referencia al valor de EBP que est√° aceptando actualmente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos decir que tan pronto como el EBP tome su valor despu√©s del PROLOGO, se ver√° como un drenaje, por lo que los argumentos siempre ir√°n en esa direcci√≥n, por lo tanto, EBP + XXX se refiere a los argumentos (el EBP almacenado y la DIRECCI√ìN DE RETORNO tambi√©n son m√°s bajos, pero no tendr√°n enlaces en el c√≥digo), mientras que las variables, como veremos, estar√°n por encima de esta direcci√≥n, por lo que el enlace a EBP-XXX se refiere a alguna variable local. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, en funciones basadas en EBP: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EBP + XXXX = argumentos pasados ‚Äã‚Äãa la funci√≥n </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EBP - XXXX = variables de funci√≥n local</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de PROLOGUE habr√° alguna forma de reservar espacio para variables. En nuestro caso, esto se hace moviendo el ESP hacia arriba para que el espacio restante a continuaci√≥n se reserve para la suma de todas las longitudes variables y, a veces, un poco m√°s por si acaso, que depende del compilador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
00401043 | 83EC 54 | SUB ESP, 54 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que el ESP se encuentra por encima del EBP, que seguir√° siendo el enlace, y que 0x54 convertido a decimal es 84, que es la suma de las longitudes BUF y COOKIE. Recuerda que eran 80 y 4 respectivamente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hx/h8/sz/hxh8sz1xa-15otyztxyu8dl6g34.png"><br>
<br>
<img src="https://habrastorage.org/webt/1a/84/bv/1a84bvou8z1bdrr0rkcjyqvqvg8.png"><br>
<br>
<img src="https://habrastorage.org/webt/yv/sh/tv/yvshtvouwajuyoqcvfptuhfa7oa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la ejecuci√≥n, se crea un espacio para las variables BUF y COOKIE de 84 bytes de tama√±o. Puede hacer clic en la primera columna en direcci√≥n horizontal y mirar el valor de EBP y encontrar ese valor en la pila. Obviamente, ahora ser√° m√°s bajo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w1/eg/vc/w1egvc6xx-pgpprzf6pfvcuicn0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hago doble clic aqu√≠. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gl/1s/i2/gl1si2koeosh8u7seukoagohri4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, tendremos valores con respecto a EBP tambi√©n en la pila. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, EBP-4 coincide con el listado, -4 se muestra en la primera columna de la pila y, en la explicaci√≥n, tambi√©n se muestra como EBP-4. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pw/_w/2l/pw_w2lyzbza2xlwmthujrqsdado.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si trazo, vemos que desde el lugar donde se ubic√≥ el ESP para reservar las variables, siempre se mover√° hacia arriba, porque debe tener en cuenta el espacio asignado para las variables. Al realizar 4 PUSHs para MessageBoxA, el depurador coloca las variables por encima del espacio reservado y aumenta el ESP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ny/sm/cn/nysmcnqbcdrmrl-q4nbtfi85r_8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si miro la pila, veo 4 argumentos verdes que agrego sobre el espacio reservado marcado en rojo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dg/-t/ty/dg-ttymvnjmjq3u-68oeoixwcgw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando ingresa la funci√≥n MessageBoxA, la DIRECCI√ìN DE DEVOLUCI√ìN de esta funci√≥n se almacena en la pila.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/gb/kg/acgbkgp58eatqpqgducvgxoqzca.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ est√° la direcci√≥n de retorno de MessageBoxA. Cuando llego al RET de esta funci√≥n rastreando con F8, y ejecuto MessageBoxA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/nb/qm/vvnbqmlpj06asy7qqwuwipvvzjq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que el depurador volver√° justo debajo de la llamada MessageBoxA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/ct/do/fmctdoieugal4uiig_pzcvvwfr8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y los valores PUSH que pas√≥ para la funci√≥n MessageBoxA y la DIRECCI√ìN DE RETORNO para esta funci√≥n ya se han utilizado, y el ESP est√° nuevamente por encima del √°rea reservada, como antes de que se llamara a cualquier funci√≥n. Lo mismo suceder√° al llamar a la funci√≥n PRINTF. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de pasar la funci√≥n PRINTF, se imprimir√°n las direcciones BUF y COOKIE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qo/tj/8z/qotj8zivsh5xnhiglbkibu53dh4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La direcci√≥n BUF en mi m√°quina ser√° 0x19FED4, y la direcci√≥n COOKIE ser√° 0x19FF24. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠, el programa lee la direcci√≥n BUF para pasarla a la funci√≥n GETS y llenar la BUF. Podemos verificar si la direcci√≥n coincide con lo que muestra la consola 0x19FED4.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6b/kg/-l/6bkg-lgioczisxsz0s9mlp1omz0.png"><br>
<br>
<img src="https://habrastorage.org/webt/sg/qp/e1/sgqpe1ypgqar2o_5plt8tjlcb0o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ vemos que es EBP-54. Si hago doble clic en la pila donde muestra -54, mostrar√° que la direcci√≥n es BUF = 0x19FED4 en mi m√°quina. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/d2/ff/wh/d2ffwhnayhtqxh8h1vgknmubaji.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, cuando guarde los datos ingresados ‚Äã‚Äãen esta direcci√≥n, puedo ponerlos en un volcado para ver c√≥mo se almacenan los bytes all√≠. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fu/mz/9h/fumz9hojfwk_mzv4fwhx9rjzfjw.png"><br>
<br>
<img src="https://habrastorage.org/webt/r6/hx/lm/r6hxlmsrelhvlr-tjfdss11mulm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ est√°n. Adem√°s, no se muestra nada a continuaci√≥n, ya que no hay datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando llamo a la funci√≥n GETS usando F8, tendr√© que ir a la consola, escribir y presionar ENTER para llenar el buffer BUF y reescribir la COOKIE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z2/ye/e6/z2yee6bmvi02vjrqpz5-dscio0a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que la variable COOKIE estaba en 19FF24 en mi m√°quina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠, el programa compara la cookie con 0x41424344. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/am/p4/ja/amp4ja-l9lkyf8trocairpbj3e0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que EBP-4 dice que es una COOKIE, adem√°s de la direcci√≥n, si establecemos el HORIZONTE en el valor EBP, como antes.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p4/uo/0u/p4uo0ufah0vdsro_ngyrym3txxm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hago doble clic aqu√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que EBP-4 es una COOKIE, ya que la variable est√° en el nivel de pila -4, poniendo a cero el HORIZONTE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x2/gu/kx/x2gukxgn7arw1lk9_w9fj3y3qbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Vemos que el programa no saltar√° y nos mostrar√° que ganas! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0e/qv/cl/0eqvclf1uxc7dg8hmgp22ka_3sm.png"><br>
<br>
<img src="https://habrastorage.org/webt/5b/fs/mj/5bfsmjqijpcan7zdmidh-pqj6eg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°As√≠ que logramos manualmente el objetivo que ganas! Dice. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analizamos din√°micamente STACK1 usando X64DBG, que es un depurador y no nos permite analizar el programa sin iniciarlo. Para hacer esto, debemos usar otras herramientas, como IDA PRO, GHIDRA o RADARE. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puedo hacer un modelo de script para operar el ejercicio desde PYTHON.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> Popen, PIPE<font></font>
<font></font>
payload = <span class="hljs-string">b"A"</span> * <span class="hljs-number">80</span> + <span class="hljs-string">b"\x44\x43\x42\x41"</span><font></font>
<font></font>
p1 = Popen(<span class="hljs-string">r"C:\Users\ricardo\Desktop\abos y stack nuevos\STACK1_VS_2017.exe"</span>, stdin=PIPE)
<span class="hljs-keyword">print</span> (<span class="hljs-string">"PID: %s"</span> % hex(p1.pid))
<span class="hljs-keyword">print</span> (<span class="hljs-string">"Enter para continuar"</span>)<font></font>
p1.communicate(payload)<font></font>
p1.wait()<font></font>
input()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso de PYTHON 3, tengo que poner par√©ntesis en la funci√≥n IMPRIMIR y tener cuidado al agregar l√≠neas que deber√≠an ser bytes (poner b delante de las l√≠neas en PYTHON 2). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compruebo que la ruta es correcta y cuando ejecuto el archivo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5b/fs/mj/5bfsmjqijpcan7zdmidh-pqj6eg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno. Ya tenemos un modelo de script para PYTHON 3 para operar STACK1. En la siguiente parte, continuaremos el an√°lisis est√°tico en IDA, RADARE y GHIDRA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/65/w_/xg65w_m85xv1anv5a7uhbuvatuc.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que, adem√°s de la tarea STACK1, tambi√©n hay versiones 2, 3 y 4. Puede intentar resolverlos. Son muy simples y similares a STACK1, as√≠ que no te aburras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la siguiente parte veremos IDA FREE, RADARE y GHIDRA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos vemos en la pr√≥xima parte 3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ricardo Narvaha </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
25/10/2019 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS # 1</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede descargar un hermoso PDF en mi p√°gina de inicio: yasha.su </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS # 2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pronto escribir√© una continuaci√≥n del art√≠culo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://habr.com/en/post/464117/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre c√≥mo obtuve ayuda para el Padre Chris Kaspersky y qu√© hay de esto sucedi√≥ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No te aburras.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es496652/index.html">C√≥mo agregar notificaciones en tiempo real a Laravel usando Pusher</a></li>
<li><a href="../es496654/index.html">Problema n.o 35: capacitaci√≥n en TI: problemas y desaf√≠os actuales de empresas l√≠deres</a></li>
<li><a href="../es496664/index.html">Diferentes trabajos, negro, blanco, rojo.</a></li>
<li><a href="../es496666/index.html">Estudiamos el motor VoIP Mediastreamer2. Parte 8</a></li>
<li><a href="../es496670/index.html">¬øCambiar√° la sociedad despu√©s de una pandemia?</a></li>
<li><a href="../es496674/index.html">¬øC√≥mo generamos estados financieros consolidados?</a></li>
<li><a href="../es496680/index.html">Industria 4.1: Propiedad de robots, redes neuronales y monetizaci√≥n de c√≥digo abierto</a></li>
<li><a href="../es496682/index.html">C√≥mo mantenerse profesional en demanda</a></li>
<li><a href="../es496686/index.html">C√≥mo los sistemas de an√°lisis de tr√°fico detectan t√°cticas de piratas inform√°ticos por MITER ATT & CK, Parte 4</a></li>
<li><a href="../es496690/index.html">Tecnolog√≠as de control de coronavirus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>