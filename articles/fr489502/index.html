<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✍🏼 🌴 💴 Sélénium + AutoIT. Windows Test Automation Windows 🙍🏾 🤦🏿 💜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'appelle Ivan Sidorenko, je suis ingénieur d'essais chez Digital Design. 
 
 Ma tâche consistait à développer des auto-tests pour l'un de nos proj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sélénium + AutoIT. Windows Test Automation Windows</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/489502/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je m'appelle Ivan Sidorenko, je suis ingénieur d'essais chez Digital Design. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ma tâche consistait à développer des auto-tests pour l'un de nos projets à l'aide de l'outil Selenium WebDriver en Java. Vous pouvez en savoir plus à ce sujet dans mon dernier </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selenium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un outil pour automatiser les applications Web dans différents navigateurs. Lors du développement des tests automatiques, je suis tombé sur un scénario dans lequel vous devez interagir avec la fenêtre Windows pour télécharger des fichiers. Malheureusement, Selenium ne peut pas fonctionner avec les fenêtres Windows, une solution alternative a donc dû être trouvée.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cd/zl/d4/cdzld4whe4et6m2j_xhh47dl-6g.png"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la recherche, le choix s'est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">porté</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">AutoIT</font></a><font style="vertical-align: inherit;"> . Cet outil est conçu pour automatiser les tâches dans Microsoft Windows, ce qui était nécessaire. Dans cet article, je décrirai comment travailler avec AutoIT pour résoudre une tâche. Il est supposé que vous disposez déjà d'un environnement de développement avec Selenium WebDriver connecté. À titre d'exemple, une fenêtre de téléchargement de photos vers l'un des sites de retouche photo sera utilisée. Alors, commençons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Téléchargez</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et installez AutoIT </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Accédez à l'un des services de téléchargement de photos, par exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ici, vous devez cliquer sur le bouton "Télécharger les photos" pour obtenir une telle fenêtre Windows </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8d/td/ff/8dtdff77nmvci12qingkdozlmuq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Maintenant, allez dans le dossier AutoIT3 et sélectionnez Au3Info.exe</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xw/zt/a8/xwzta8im-wldwys3d4kukksyfx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Au3Info est un outil qui vous permet d'obtenir des informations sur la fenêtre requise pour l'automatisation. Pour obtenir des informations sur un élément spécifique, faites simplement glisser le bloc du Finder Tool sur l'élément window. Nous obtiendrons les valeurs des attributs du champ de saisie de l'élément "File Name". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9p/rr/yl/9prryludo95c5_qeehpmqehltac.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour une utilisation dans le script AutoIT, nous avons besoin des attributs Title = 'Open' et Class = 'Edit' </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Allez dans le dossier AutoIt3 \ SciTE et sélectionnez SciTE, ici nous écrirons un script si simple </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ce/a_/e-/cea_e-yqn5uroh9gfadffplsnxe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlFocus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une méthode , qui met l'accent sur l'élément de fenêtre «File Name» </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Le premier paramètre est la valeur Title de la fenêtre souhaitée, dans notre cas, il est «Open» </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Le deuxième paramètre est facultatif</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Le troisième paramètre est la combinaison des valeurs de l'attribut Classe et Instance, c'est-à-dire </font><font style="vertical-align: inherit;">il s'avère Edit1 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/db/bn/hpdbbnufdzq_j0h9w2uhsyuc3xq.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlSetText</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une méthode par laquelle le texte est entré dans l'entrée de l'élément "File Name"</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le premier paramètre est la valeur de Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le deuxième paramètre est facultatif</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le troisième paramètre est la combinaison des valeurs de l'attribut Class et Instance, c'est-à-dire </font><font style="vertical-align: inherit;">il s'avère que Edit1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le quatrième paramètre est le texte qui sera saisi en entrée, ici on écrit le chemin du fichier que l'on va attacher</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlClick</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - clique sur le bouton "Ouvrir"</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le premier paramètre est la valeur de Title</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le deuxième paramètre est facultatif</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le troisième paramètre est la combinaison des valeurs de l'attribut Class et Instance, c'est-à-dire </font><font style="vertical-align: inherit;">il tourne Button1</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/mh/ky/n9/mhkyn9hzowkdemfo0-mxtayc-qu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Enregistrez le script sous Autoit </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/k-/yf/bek-yfclqoutktdksfwsmbn66bq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. Maintenant, pour exécuter le script, vous devez le compiler. Pour compiler un script, il existe deux options - soit pour un système 64 bits, soit pour 86. Choisissez celle qui convient à votre système d'exploitation. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nk/ce/7z/nkce7zytnqeugrvb2zdd4-wcceq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. Nous avons obtenu un fichier AutoItScript.exe compilé. Nous allons vérifier ses performances - allez sur le </font><font style="vertical-align: inherit;">service de retouche photo </font><font style="vertical-align: inherit;">&lt; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.iloveimg.com/en/photo-editor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "&gt; et cliquez sur" Sélectionner une image. Exécutez maintenant AutoItScript.exe </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/nw/ef/eanwefram2fb9xsmiqrlmfrjl94.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9. Maintenant, vous pouvez ajouter ce script dans Selenium, par exemple, pour Java, un tel ajout ressemblerait à ceci:</font></font><br>
<br>
<pre><code class="plaintext hljs">Runtime.getRuntime().exec(":\\auto\\AutoItScript.exe");</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette solution est très stable. </font><font style="vertical-align: inherit;">De plus, étant donné que nous nous retrouvons avec un fichier exécutable, cette solution peut être utilisée avec différents langages de programmation. </font><font style="vertical-align: inherit;">L'inconvénient est qu'un tel script ne peut pas être utilisé en mode sans tête - un mode dans lequel le navigateur ne démarre pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que cet article vous aidera à tester l'automatisation!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489490/index.html">Tic Tac Toe (PixiJS)</a></li>
<li><a href="../fr489492/index.html">Yandex.Disk a interdit l'utilisation de l'utilitaire open source rclone. UPD - fonctionne à nouveau</a></li>
<li><a href="../fr489494/index.html">Structures de données les plus populaires</a></li>
<li><a href="../fr489496/index.html">Recherche d'employés et recherche d'emploi: ma vision de l'intérieur et de l'extérieur</a></li>
<li><a href="../fr489500/index.html">Évaluation des tâches aux points d'histoire</a></li>
<li><a href="../fr489504/index.html">Comment commencer à créer une carte dans UE4</a></li>
<li><a href="../fr489510/index.html">Essayer de résoudre le problème du choix des billets avant les vacances # 2</a></li>
<li><a href="../fr489512/index.html">Battement. BlOC, fournisseur, async - Shelf Architecture</a></li>
<li><a href="../fr489514/index.html">Téléchargez et stockez gratuitement des fichiers de toute taille sur Google Drive. Bug ou fonctionnalité?</a></li>
<li><a href="../fr489516/index.html">Friends React Native et Fastlane</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>