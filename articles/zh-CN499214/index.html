<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📪 👩‍👩‍👦 🗓️ 在AWS上部署Hyperledger Fabric 1.4 ✌🏻 🛸 🛳️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabric是Linux Foundation提供的开源区块链平台。借助它，您可以创建区块链应用程序并控制区块链中数据的访问和权限。如果您要创建私有区块链网络或对双方可以看到的交易设置限制，则应使用Hyperledger Fabric。
 
 在Hyperledger Fab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>在AWS上部署Hyperledger Fabric 1.4</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabric是Linux Foundation提供的开源区块链平台。借助它，您可以创建区块链应用程序并控制区块链中数据的访问和权限。如果您要创建私有区块链网络或对双方可以看到的交易设置限制，则应使用Hyperledger Fabric。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Hyperledger Fabric的文档中，使用Docker在一台机器上创建区块链网络是经过精心计划的，其中每个网络成员都是一个单独的容器。但是没有描述在多个物理或虚拟机上建立网络的过程。这将在本文中讨论。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的区块链应用程序是用于存储学校和学龄前儿童的一些医疗数据的服务。</font><font style="vertical-align: inherit;">数据必须保持不变。</font><font style="vertical-align: inherit;">它们将以有关疫苗接种以及患者与特定医生的协议信息的形式呈现。</font><font style="vertical-align: inherit;">该网络将包括父母（代表父母利益的组织），医院（父母可以与儿科医生签署一项照顾子女的协议的医院）和幼儿园（可以要求健康报告和疫苗接种的幼儿园）的成员。或医院的另一个孩子）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">亚马逊管理的区块链</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS提供了Amazon Managed Blockchain服务。</font><font style="vertical-align: inherit;">它允许您使用AWS控制台用户界面部署区块链网络。</font><font style="vertical-align: inherit;">但是，在积累了使用Amazon Managed Blockchain的经验之后，我们不得不放弃在商业项目中使用该服务的想法。</font><font style="vertical-align: inherit;">有几个原因。</font><font style="vertical-align: inherit;">主要的是：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Managed Blockchain中仅提供Hyperledger Fabric 1.2版本，在撰写本文时，版本1.4用于构建企业区块链网络。</font><font style="vertical-align: inherit;">它还不允许使用现代版本的Node.js SDK工具；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Managed Blockchain不支持CouchDB数据库，这使得创建索引已存储数据的应用程序变得困难。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们认为最好使用虚拟或物理服务器通过Hyperledger Fabric框架来构建网络。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于应用程式频道</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabric具有“通道”的概念。</font><font style="vertical-align: inherit;">通道是进行敏感交易的子网。</font><font style="vertical-align: inherit;">我们的应用程序中将有两个渠道。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“家长医院”。</font><font style="vertical-align: inherit;">它旨在用于父母与医院组织成员之间的交易：创建和修改病历，与儿科医生达成协议以及签署儿科医生协议。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“家长学校幼儿园”。</font><font style="vertical-align: inherit;">在此渠道中，家长和医院成员将与幼儿园成员互动。</font><font style="vertical-align: inherit;">此外，将基于医疗记录中的数据生成报告。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作环境</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将使用Docker Swarm部署我们的区块链网络-这是用于部署主机集群的本地Docker系统。如果您从未使用过Docker（尤其是Docker Swarm），那么请首先查看此产品以及如何使用Docker Swarm编排容器。该</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很好地描述了使用这些工具的基础。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的整个网络将位于AWS EC2服务器上。</font><font style="vertical-align: inherit;">区块链网络中的信息将存储在CouchDB中。</font><font style="vertical-align: inherit;">Hyperledger Fabric还支持LevelDB数据库，但与后者不同，CouchDB使得可以按文档集中的任何条件进行搜索。</font><font style="vertical-align: inherit;">我们还将使用Fabric证书颁发机构，这是用于管理所有组织及其用户的网络标识符的模块化组件。</font><font style="vertical-align: inherit;">它提供网络参与者的注册和证书的颁发。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将有四台EC2服务器：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">订购者，MySQL DB（用于存储不适用于病历的应用程序信息）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家长组织（Peer0，Peer1），CouchDB，Fabric-CA，CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医院组织（Peer0，Peer1），CouchDB，Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼儿园组织（Peer0，Peer1），CouchDB，Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在AWS上创建EC2服务器</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要t2.medium服务才能工作。</font><font style="vertical-align: inherit;">这种EC2服务器具有足够的计算能力，可以安装所有必需的软件并与Hyperledger Fabric工具一起使用。</font><font style="vertical-align: inherit;">在“配置安全组”中，设置“所有流量”，然后设置“源”-0.0.0.0/0，:: / 0。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。1。</font><font style="vertical-align: inherit;">在AWS面板中配置安全组。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们有四台EC2服务器：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您自然会拥有通往EC2服务器的路径。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图2。</font><font style="vertical-align: inherit;">为操作EC2服务器做准备。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在EC2服务器上安装必备软件</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，在每台EC2服务器上，我们需要安装Docker和Git。</font><font style="vertical-align: inherit;">为了方便起见，请在终端中打开四个选项卡。</font><font style="vertical-align: inherit;">让我们通过SSH进入每个EC2服务：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
终端1：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2号航站楼：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第三航站楼：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4号客运大楼：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在每个终端中，执行以下命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们已经安装了Docker和Git。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要从存储库中克隆网络的元素。</font><font style="vertical-align: inherit;">为此，请在每个终端中执行命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们还需要从存储库中克隆智能合约，以管理网络参与者之间的关系。</font><font style="vertical-align: inherit;">智能合约以Golang语言编写。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们在四个服务器的每一个上执行以下步骤：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第一个终端中，我们需要生成通道配置文件和证书以将组织连接到网络：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，将channel-artifacts和crypto-config文件夹复制到网络父目录的poc-network文件夹中的其他三台主机。</font><font style="vertical-align: inherit;">请注意：将组织复制到EC2服务器时，您需要从crypto-config / peerOrganizations文件夹中删除与其他组织的工作有关的第三方证书。</font><font style="vertical-align: inherit;">例如，当复制到“家长”主机时，我们需要将Parents.poc-network.com文件夹保留在该文件夹中，但要删除hospital.poc-network.com和幼儿园.poc-network.com。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个Docker Swarm堆栈</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了使属于不同组织且位于不同EC2服务器上的容器能够相互访问，我们需要将它们组合成一个堆栈。</font><font style="vertical-align: inherit;">让我们看一下我们的文件网络/ poc-network / docker-compose-general.yaml。</font><font style="vertical-align: inherit;">它包含服务的配置，指示将特定服务（密钥</font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">部署到哪些主机，并指示</font><font style="vertical-align: inherit;">别名（密钥</font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要在第一个终端中初始化swarm：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
令牌将显示为将另一个EC2服务器附加到堆栈。</font><font style="vertical-align: inherit;">类似于：</font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们可以在其余终端中执行：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一条消息出现在控制台中：</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将所有三台主机都连接到Swarm之后，我们可以通过运行以下命令在第一台主机的终端中看到它们：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图3。</font><font style="vertical-align: inherit;">Docker Swarm中的服务器列表。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在network / poc-network文件夹中，有一个.env.template文件，您需要在其中为每个主机指定一个主机名：</font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要生成.env文件，您需要运行./3_env_gen.sh文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在使用驱动程序创建一个网络</font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
运行Swarm以基于docker-compose-general.yaml文件创建堆栈：</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此命令，我们还设置了环境变量，这些变量在.env文件中进行了描述，并且对于网络正常工作是必需的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以</font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在第一个终端中</font><font style="vertical-align: inherit;">执行命令</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您将看到在我们所有EC2实例上运行的所有服务的列表。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图4。</font><font style="vertical-align: inherit;">所有EC2服务器上运行的所有服务的列表。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您在终端中看到的与屏幕截图相同，则一切正常。</font><font style="vertical-align: inherit;">现在运行我们的网络。</font><font style="vertical-align: inherit;">在第二个终端中，您必须输入CLI容器（毕竟，此容器已部署在第二个主机上）：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以通过在终端中执行命令来查看容器名称</font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在容器中，我们执行4_create_channels.sh文件中的所有命令，并将它们一个接一个地复制到终端。</font><font style="vertical-align: inherit;">在bin文件夹中，我们具有用于创建网络的二进制文件：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对等渠道创建-创建渠道；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对等频道加入-将对等加入频道；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对等频道更新-更新配置；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对等chaincode安装-安装代码</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对等链码实例化-在网络上部署指定的链码。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，您可以通过运行命令离开容器</font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">父母回申请</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二台主机上安装应用程序：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们还需要安装NodeJS和gcc-c ++（编译器）：</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们也可以通过adminer与以下授权的数据进入我们的数据库：</font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（其中</font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是在其上存储数据库中的第EC2服务器的地址），</font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也有必要对我们的API的应用程序连接到数据库：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为键分配正确的值</font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我们的反向应用程序已准备好迁移和种子。</font><font style="vertical-align: inherit;">您需要运行它们：</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表应该出现在数据库中。</font><font style="vertical-align: inherit;">在组织表格中，我们将在组织中看到三行-父母，医院，幼儿园。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从一开始生成证书时，我们就收到了用于连接第一台主机上每个组织的网络的文件。</font><font style="vertical-align: inherit;">将connection-parents.json文件从第一台主机复制到第二台主机。</font><font style="vertical-align: inherit;">为此，请从我们所在的文件夹中打开另一个终端，</font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后执行以下命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修复</font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（当前主机的值）：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二个终端中运行我们的应用程序：</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在userGenerator.sh文件中，将</font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确的值</font><font style="vertical-align: inherit;">分配给变量</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，您需要运行将创建上级组织用户的脚本：</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
运行脚本以生成医疗记录：</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将在区块链中创建两张卡，这些卡也将写入卡表中的SQL数据库中。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医院背部申请</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与以前的后台应用程序类似，我们需要将文件放置在第三台主机上以连接到网络。</font><font style="vertical-align: inherit;">为此，在第五个终端中，执行：</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将应用程序克隆到第三台主机：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装NodeJS和gcc-c ++（编译器）：</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修复</font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（当前主机的值）：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第三个终端中运行我们的应用程序：</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在userGenerator.sh文件中，将</font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确的值</font><font style="vertical-align: inherit;">分配给变量</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们需要运行一个脚本，该脚本将创建Hospital组织的用户：</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，数据库的“用户”表中还有第二个用户。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼儿园回申请</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与以前的后台应用程序类似，我们需要将文件放置在第三台主机上以连接到网络。</font><font style="vertical-align: inherit;">为此，在第五个终端中，执行：</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将应用程序克隆到第三台主机：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装NodeJS和Gcc-c ++（编译器）：</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修复</font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（当前主机的值）：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第三个终端中运行我们的应用程序：</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在userGenerator.sh文件中，将</font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确的值</font><font style="vertical-align: inherit;">分配给变量</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们需要运行一个脚本，该脚本将创建Hospital组织的用户：</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，数据库的“用户”表中有第三个用户。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在第二，第三和第四台EC2服务器上安装wkhtmltopdf</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
后台应用程序使用wkhtmltopdf库生成有关孩子健康状况的PDF报告。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要安装libpng-用于处理PNG格式的光栅图形的官方库。</font><font style="vertical-align: inherit;">该库是独立于平台的，并且包含用C语言编写的函数。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一小组将安装wkhtmltox-开放源代码LGPLv3库，用于使用QtWebKit渲染引擎将HTML渲染为PDF和各种图像格式：</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二个命令块将下载并部署libpng15库：</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装编译器需要第三条命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您仍然需要安装LibTIFF：</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们可以测试：</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，您可以生成和查看PDF文档。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于Node SDK的一些知识</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用于Hyperledger Fabric网络的NodeJS工具以“ fabric-ca-client -v 1.4.0”和“ fabric-network” v 1.4.0”的形式提供。</font><font style="vertical-align: inherit;">使用Node SDK与网络交互的后端应用程序的所有服务都位于项目根目录下的Services文件夹中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">官方文档中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解这些工具及其方法</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用业务流程</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们将讨论网络成员如何在此应用程序中彼此交互。</font><font style="vertical-align: inherit;">所有过程都在UML图中描述。</font><font style="vertical-align: inherit;">让我们更详细地考虑它们。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图5。应用程序中业务流程的图形描述。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
因此，网络上有几个组织：父母，医院和幼儿园。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
父母的一个成员为其两个孩子创建电子健康记录。这些数据将存储（并补充）在区块链网络中。接下来，父母发送请求与儿科医生达成协议，儿科医生将观察他的孩子，直到他们成年为止（在图中- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求与医生达成协议</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
医院组织的成员签署协议（在图中- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医生签署协议</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，父母向幼儿园发送请求，并要求其注册孩子（在图中- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求幼儿园接收孩子的请求</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图6。</font><font style="vertical-align: inherit;">家长帐户中包含可用教育机构列表的页面。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幼儿园在新请求列表中看到该请求：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图7。</font><font style="vertical-align: inherit;">一个页面，其中包含入学机构个人帐户的申请列表。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幼儿园在决定接纳孩子之前，必须确保其健康状况令人满意。</font><font style="vertical-align: inherit;">为此，幼儿园将请求发送到观察该孩子的诊所（在图中- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">儿童健康报告请求</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">将入园的请求移至“已接受”选项卡后，会自动执行对儿科医生的请求。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图8。</font><font style="vertical-align: inherit;">一个页面，其中列出了允许进入教育机构个人帐户的已批准申请。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
儿科医生会看到该请求并生成一个报告，其中包含有关儿童健康的数据（在图表中- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">儿童健康报告create</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图9。</font><font style="vertical-align: inherit;">带有应用列表的页面，用于通过医院的个人帐户创建有关儿童健康状况的报告。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
家长看到儿科医生已经生成了报告：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图10。</font><font style="vertical-align: inherit;">父母个人帐户中的页面，其中显示有关孩子健康状况的报告状态。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...并决定授予学龄前教育机构查看和下载报告的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在图中- </font><i><font style="vertical-align: inherit;">授予查看报告的权限</font></i><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图11。</font><font style="vertical-align: inherit;">一个弹出窗口，用于选择可以查看生成的医疗报告的教育机构。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
父级点击“确认”：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图12。</font><font style="vertical-align: inherit;">关于所选教育机构已获准查看医疗报告的通知。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在教育机构的应用程序的报告列表中，显示该报告已生成并且可以以PDF格式查看和下载的信息。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图13 </font><font style="vertical-align: inherit;">链接以下载与批准的申请一致的PDF格式的报告。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是一份报告，您将在计算机的新选项卡中看到该报告：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图14。</font><font style="vertical-align: inherit;">医院员工生成的健康报告。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与儿科医生创建病历和协议，签署协议</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于该应用程序的设计目的是为了演示网络在不同EC2服务器上的部署，因此我们将从准备好的脚本中执行一些命令。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一台EC2服务器：</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们先前已连接到数据库。</font><font style="vertical-align: inherit;">执行命令后，您将在Cards表中看到两个条目。</font><font style="vertical-align: inherit;">此外，有关这两个孩子的医疗数据的信息也记录在区块链上。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要从此EC2服务器与将观察儿童的儿科医生达成协议：</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，此协议必须由我们为医院组织创建的用户签署。</font><font style="vertical-align: inherit;">我们从第二个主机执行命令：</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的协议已由医生签署，我们可以继续进行申请。</font><font style="vertical-align: inherit;">接下来，我们需要在第二，第三和第四台EC2服务器上安装前端应用程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS：您可以在〜/ back / generators文件夹中找到用于生成用户，卡，协议和签名协议的所有命令。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家长前端申请</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二台主机（“家长”组织所在的主机）上运行：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们创建.env文件并指定前端应用程序所在的主机名：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有必要建立依赖关系：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还必须构建应用程序并在端口8080上运行它：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的应用程序将在以下</font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位置</font><font style="vertical-align: inherit;">提供：</font><font style="vertical-align: inherit;">哪里</font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font><font style="vertical-align: inherit;">我们的应用程序</font><font style="vertical-align: inherit;">所在</font><font style="vertical-align: inherit;">的第二台EC2服务器的地址。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登录名：</font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是前端的外观。</font><font style="vertical-align: inherit;">在这里，您将看到有关我们从终端创建的医疗卡的信息：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图15。</font><font style="vertical-align: inherit;">父母个人帐户中有关孩子病历的信息。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医院前端应用</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二台主机（医院组织所在的主机）上运行：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们创建.env文件并指定前端应用程序所在的主机名：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有必要建立依赖关系：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还必须构建应用程序并在端口8080上运行它：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的应用程序将在以下</font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位置</font><font style="vertical-align: inherit;">提供：</font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三台EC2服务器的地址</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">哪里</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登录名：</font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼儿园前端应用</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二台主机（幼儿园组织所在的主机）上运行：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们创建.env文件并指定前端应用程序所在的主机名：</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有必要建立依赖关系：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还必须构建应用程序并在端口8080上运行它：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的应用程序将在以下</font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位置</font><font style="vertical-align: inherit;">提供：</font><font style="vertical-align: inherit;">哪里</font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是第四台EC2服务器的地址。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
登录名：</font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们研究了如何在多个虚拟或物理服务器上部署区块链应用程序网络。</font><font style="vertical-align: inherit;">本文旨在使您熟悉区块链技术的基础知识，了解什么是智能合约，并且至少初步了解Hyperledger Fabric框架及其标准Fabric-samples应用程序。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN499202/index.html">Opium.Fill-通过程序员的眼光对颜色方案进行标准化</a></li>
<li><a href="../zh-CN499206/index.html">虚拟助手。无需编程即可创建聊天机器人</a></li>
<li><a href="../zh-CN499208/index.html">4月27日至5月3日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN499210/index.html">4月27日至5月3日在圣彼得堡举行的数字活动</a></li>
<li><a href="../zh-CN499212/index.html">IBM每周研讨会-2020年4月</a></li>
<li><a href="../zh-CN499216/index.html">在系统级别进行设计。第2部分。详细架构</a></li>
<li><a href="../zh-CN499220/index.html">由于冠状病毒将开发人员转移到远程站点，从而提高了Google和Microsoft的生产率</a></li>
<li><a href="../zh-CN499224/index.html">是时候开始正确学习了</a></li>
<li><a href="../zh-CN499226/index.html">没有大流行：如何以1000美元的价格制作一部关于加密货币的电影并进入美国顶级电影发行市场</a></li>
<li><a href="../zh-CN499230/index.html">如何养成健康的蠕虫：解析1910年手册</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>