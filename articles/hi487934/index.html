<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЩМЁЯП╛ ЁЯПБ ЁЯТ▓ рд╣рдордиреЗ GO рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ DNS рд╕рд░реНрд╡рд░ рдХреЛ рдХреИрд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ ЁЯжА ЁЯзд ЁЯСЖЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкрд╛рдареНрдпрдХреНрд░рдо рдкрд░ рдПрдХ рдирдИ рдзрд╛рд░рд╛ рдХреА рд╢реБрд░реБрдЖрдд рдХреА рдкреНрд░рддреНрдпрд╛рд╢рд╛ рдореЗрдВ "рдбреЗрд╡рд▓рдкрд░ рдЧреЛрд▓рдВрдЧ" рдиреЗ рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрдиреБрд╡рд╛рдж рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ред
 
 
 
 рд╣рдорд╛рд░реЗ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ DNS рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдЬ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рд╣рдордиреЗ GO рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ DNS рд╕рд░реНрд╡рд░ рдХреЛ рдХреИрд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/487934/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдареНрдпрдХреНрд░рдо рдкрд░ рдПрдХ рдирдИ рдзрд╛рд░рд╛ рдХреА рд╢реБрд░реБрдЖрдд рдХреА рдкреНрд░рддреНрдпрд╛рд╢рд╛ рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдбреЗрд╡рд▓рдкрд░ рдЧреЛрд▓рдВрдЧ"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдиреЗ рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрдиреБрд╡рд╛рдж рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ред</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_m/nk/zf/_mnkzfy1x9apnfm5u3hikc54-7w.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ DNS рд╕рд░реНрд╡рд░ рдХрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рд╣рдЬрд╛рд░реЛрдВ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рджрд╕рд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдкреНрд░рддрд┐рджрд┐рди рд▓рд╛рдЦреЛрдВ рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдЬрдХрд▓, рдбреАрдПрдирдПрд╕ рд╣рдорд▓реЗ рдЕрдзрд┐рдХ рд╕реЗ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реЛрддреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рдбреАрдПрдирдПрд╕ рд╣рдорд╛рд░реЗ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдФрд░ рд╣рдореЗрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдЙрдЪреНрдЪ рднрд╛рд░ рдХреЗ рддрд╣рдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnsflood</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдЯреВрд▓ рд╣реИ рдЬреЛ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ udp рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдЬреЗрдирд░реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="go hljs"># timeout <span class="hljs-number">20</span>s ./dnsflood example.com <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> -p <span class="hljs-number">2053</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд┐рд╕реНрдЯрдо рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рд╕реЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛ рдХрд╛ рдореЗрдореЛрд░реА рдЙрдкрдпреЛрдЧ рдЗрддрдиреА рддреЗрдЬреА рд╕реЗ рдмрдврд╝рд╛ рдХрд┐ рд╣рдореЗрдВ рдЗрд╕реЗ рд░реЛрдХрдирд╛ рдкрдбрд╝рд╛, рдЕрдиреНрдпрдерд╛ рд╣рдо OOM рддреНрд░реБрдЯрд┐рдпреЛрдВ рдореЗрдВ рднрд╛рдЧ рдЬрд╛рддреЗред </font><font style="vertical-align: inherit;">рдпрд╣ рдореЗрдореЛрд░реА рд▓реАрдХ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреА рддрд░рд╣ рдерд╛; </font><font style="vertical-align: inherit;">"рд╕рдорд╛рди" рдФрд░ "рд╡рд╛рд╕реНрддрд╡рд┐рдХ" рдореЗрдореЛрд░реА рд▓реАрдХ рд╣реЛрдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░рдг рд╣реИрдВ:</font></font><a name="habracut"></a><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рдЯрдХреЗ рд╣реБрдП рдЧреЛрд░реЛрдЪрди</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдлрд░ рдФрд░ рдлрд╛рдЗрдирд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдмрд╕реНрдЯреНрд░рд┐рдВрдЧ рдФрд░ рд╕рдм-рдХрдЯреНрд╕</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рд░реНрд╡рддреНрд░рд┐рдХ рдЪрд░</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдкреЛрд╕реНрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рднрд┐рдиреНрди рд▓реАрдХ рдХрд╛ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд┐рд╕реА рднреА рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЛ рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдЗрдП рдкрд╣рд▓реЗ рдПрдХ рдкреНрд░реЛрдлрд╛рдЗрд▓рд┐рдВрдЧ рдХрд░реЗрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Godebug</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рднрд┐рдиреНрди рдбрд┐рдмрдЧрд┐рдВрдЧ рдЯреВрд▓ рдХреЛ рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>GODEBUG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рдХрд┐ рдЬреЛрдбрд╝реЛрдВ рдХреЗ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо рд╕реЗ рдЕрд▓рдЧ рдХреА рдЧрдИ рд╕реВрдЪреА рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВ </font></font><code>name=value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕ рдкреНрд▓рд╛рдирд░</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдиреБрд╕реВрдЪрдХ рдЯреНрд░реЗрд╕ рд░рдирдЯрд╛рдЗрдо рдкрд░ рдЧреЛрд░реЛрдЗрди рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╢реЗрдбреНрдпреВрд▓рд░ рдЯреНрд░реЗрд╕ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдЪрд▓рд╛рдПрдВ </font></font><code>GODEBUG=schedtrace=100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдорд╛рди ms рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдЕрд╡рдзрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред</font></font><br>
 <br>
<pre><code class="go hljs">$ GODEBUG=schedtrace=<span class="hljs-number">100</span> ./redins -c config.json<font></font>
SCHED <span class="hljs-number">2952</span>ms: ... runqueue=<span class="hljs-number">3</span> [<span class="hljs-number">26</span> <span class="hljs-number">11</span> <span class="hljs-number">7</span> <span class="hljs-number">18</span> <span class="hljs-number">13</span> <span class="hljs-number">30</span> <span class="hljs-number">6</span> <span class="hljs-number">3</span> <span class="hljs-number">24</span> <span class="hljs-number">25</span> <span class="hljs-number">11</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3053</span>ms: ... runqueue=<span class="hljs-number">3</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">21</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3154</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">0</span> <span class="hljs-number">6</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">30</span> <span class="hljs-number">0</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">11</span> <span class="hljs-number">2</span> <span class="hljs-number">5</span>]<font></font>
SCHED <span class="hljs-number">3255</span>ms: ... runqueue=<span class="hljs-number">1</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3355</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3456</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3557</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">13</span> <span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">33</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">10</span> <span class="hljs-number">8</span> <span class="hljs-number">10</span> <span class="hljs-number">14</span>]<font></font>
SCHED <span class="hljs-number">3657</span>ms: ...runqueue=<span class="hljs-number">3</span> [<span class="hljs-number">14</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">5</span> <span class="hljs-number">19</span> <span class="hljs-number">54</span> <span class="hljs-number">9</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">29</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3758</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">67</span> <span class="hljs-number">1</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">87</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">3859</span>ms: ... runqueue=<span class="hljs-number">6</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">2</span> <span class="hljs-number">19</span>]<font></font>
SCHED <span class="hljs-number">3960</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">4060</span>ms: ... runqueue=<span class="hljs-number">5</span> [<span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">4161</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">4262</span>ms: ... runqueue=<span class="hljs-number">4</span> [<span class="hljs-number">0</span> <span class="hljs-number">128</span> <span class="hljs-number">21</span> <span class="hljs-number">172</span> <span class="hljs-number">1</span> <span class="hljs-number">19</span> <span class="hljs-number">8</span> <span class="hljs-number">2</span> <span class="hljs-number">43</span> <span class="hljs-number">5</span> <span class="hljs-number">139</span> <span class="hljs-number">37</span>]<font></font>
SCHED <span class="hljs-number">4362</span>ms: ... runqueue=<span class="hljs-number">0</span> [<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">4463</span>ms: ... runqueue=<span class="hljs-number">6</span> [<span class="hljs-number">0</span> <span class="hljs-number">28</span> <span class="hljs-number">23</span> <span class="hljs-number">39</span> <span class="hljs-number">4</span> <span class="hljs-number">11</span> <span class="hljs-number">4</span> <span class="hljs-number">11</span> <span class="hljs-number">25</span> <span class="hljs-number">0</span> <span class="hljs-number">25</span> <span class="hljs-number">0</span>]<font></font>
SCHED <span class="hljs-number">4564</span>ms: ... runqueue=<span class="hljs-number">354</span> [<span class="hljs-number">51</span> <span class="hljs-number">45</span> <span class="hljs-number">33</span> <span class="hljs-number">32</span> <span class="hljs-number">15</span> <span class="hljs-number">20</span> <span class="hljs-number">8</span> <span class="hljs-number">7</span> <span class="hljs-number">5</span> <span class="hljs-number">42</span> <span class="hljs-number">6</span> <span class="hljs-number">0</span>]</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">runqueue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреЛрд░реЛрдирд╛рдЗрдЯреНрд╕ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реИрд╢реНрд╡рд┐рдХ рдХрддрд╛рд░ рдХреА рд▓рдВрдмрд╛рдИ рд╣реИред </font><font style="vertical-align: inherit;">рдХреЛрд╖реНрдардХ рдореЗрдВ рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдХреА рд▓рдВрдмрд╛рдИ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрджрд░реНрд╢ рд╕реНрдерд┐рддрд┐ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдЧреЛрд░реЛрдЗрдЯрд┐рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╡реНрдпрд╕реНрдд рд╣реЛрддреА рд╣реИрдВ, рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХрддрд╛рд░ рдХреА рдордзреНрдпрдо рд▓рдВрдмрд╛рдИ рд╕рдорд╛рди рд░реВрдк рд╕реЗ рд╕рднреА рдХреЗ рд▓рд┐рдП рд╡рд┐рддрд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="go hljs">SCHED <span class="hljs-number">2449</span>ms: gomaxprocs=<span class="hljs-number">12</span> idleprocs=<span class="hljs-number">0</span> threads=<span class="hljs-number">40</span> spinningthreads=<span class="hljs-number">1</span> idlethreads=<span class="hljs-number">1</span> runqueue=<span class="hljs-number">20</span> [<span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span> <span class="hljs-number">20</span>]</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреБрд╕реВрдЪреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ </font><i><font style="vertical-align: inherit;">рджреЗрдЦрддреЗ рд╣реБрдП</font></i><font style="vertical-align: inherit;"> , рд╣рдо рд╕рдордп рдХреА рдЕрд╡рдзрд┐ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд▓рдЧрднрдЧ рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдмреЗрдХрд╛рд░ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рдкреВрд░реА рдХреНрд╖рдорддрд╛ рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдЪрд░рд╛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЯреНрд░реЗрд╕</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣рдг (GC) рдЯреНрд░реЗрд╕рд┐рдВрдЧ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдПрдВ </font></font><code>GODEBUG=gctrace=1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
 <br>
<pre><code class="go hljs">GODEBUG=gctrace=<span class="hljs-number">1</span> ./redins -c config1.json<font></font>
.<font></font>
.<font></font>
.<font></font>
gc <span class="hljs-number">30</span> @<span class="hljs-number">3.727</span>s <span class="hljs-number">1</span>%: <span class="hljs-number">0.066</span>+<span class="hljs-number">21</span>+<span class="hljs-number">0.093</span> ms clock, <span class="hljs-number">0.79</span>+<span class="hljs-number">128</span>/<span class="hljs-number">59</span>/<span class="hljs-number">0</span>+<span class="hljs-number">1.1</span> ms cpu, <span class="hljs-number">67</span>-&gt;<span class="hljs-number">71</span>-&gt;<span class="hljs-number">45</span> MB, <span class="hljs-number">76</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">31</span> @<span class="hljs-number">3.784</span>s <span class="hljs-number">2</span>%: <span class="hljs-number">0.030</span>+<span class="hljs-number">27</span>+<span class="hljs-number">0.053</span> ms clock, <span class="hljs-number">0.36</span>+<span class="hljs-number">177</span>/<span class="hljs-number">81</span>/<span class="hljs-number">7.8</span>+<span class="hljs-number">0.63</span> ms cpu, <span class="hljs-number">79</span>-&gt;<span class="hljs-number">84</span>-&gt;<span class="hljs-number">55</span> MB, <span class="hljs-number">90</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">32</span> @<span class="hljs-number">3.858</span>s <span class="hljs-number">3</span>%: <span class="hljs-number">0.026</span>+<span class="hljs-number">34</span>+<span class="hljs-number">0.024</span> ms clock, <span class="hljs-number">0.32</span>+<span class="hljs-number">234</span>/<span class="hljs-number">104</span>/<span class="hljs-number">0</span>+<span class="hljs-number">0.29</span> ms cpu, <span class="hljs-number">96</span>-&gt;<span class="hljs-number">100</span>-&gt;<span class="hljs-number">65</span> MB, <span class="hljs-number">110</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">33</span> @<span class="hljs-number">3.954</span>s <span class="hljs-number">3</span>%: <span class="hljs-number">0.026</span>+<span class="hljs-number">44</span>+<span class="hljs-number">0.13</span> ms clock, <span class="hljs-number">0.32</span>+<span class="hljs-number">191</span>/<span class="hljs-number">131</span>/<span class="hljs-number">57</span>+<span class="hljs-number">1.6</span> ms cpu, <span class="hljs-number">117</span>-&gt;<span class="hljs-number">123</span>-&gt;<span class="hljs-number">79</span> MB, <span class="hljs-number">131</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">34</span> @<span class="hljs-number">4.077</span>s <span class="hljs-number">4</span>%: <span class="hljs-number">0.010</span>+<span class="hljs-number">53</span>+<span class="hljs-number">0.024</span> ms clock, <span class="hljs-number">0.12</span>+<span class="hljs-number">241</span>/<span class="hljs-number">159</span>/<span class="hljs-number">69</span>+<span class="hljs-number">0.29</span> ms cpu, <span class="hljs-number">142</span>-&gt;<span class="hljs-number">147</span>-&gt;<span class="hljs-number">91</span> MB, <span class="hljs-number">158</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">35</span> @<span class="hljs-number">4.228</span>s <span class="hljs-number">5</span>%: <span class="hljs-number">0.017</span>+<span class="hljs-number">61</span>+<span class="hljs-number">0.12</span> ms clock, <span class="hljs-number">0.20</span>+<span class="hljs-number">296</span>/<span class="hljs-number">179</span>/<span class="hljs-number">94</span>+<span class="hljs-number">1.5</span> ms cpu, <span class="hljs-number">166</span>-&gt;<span class="hljs-number">174</span>-&gt;<span class="hljs-number">105</span> MB, <span class="hljs-number">182</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">36</span> @<span class="hljs-number">4.391</span>s <span class="hljs-number">6</span>%: <span class="hljs-number">0.017</span>+<span class="hljs-number">73</span>+<span class="hljs-number">0.086</span> ms clock, <span class="hljs-number">0.21</span>+<span class="hljs-number">492</span>/<span class="hljs-number">216</span>/<span class="hljs-number">4.0</span>+<span class="hljs-number">1.0</span> ms cpu, <span class="hljs-number">191</span>-&gt;<span class="hljs-number">198</span>-&gt;<span class="hljs-number">122</span> MB, <span class="hljs-number">210</span> MB goal, <span class="hljs-number">12</span> P<font></font>
gc <span class="hljs-number">37</span> @<span class="hljs-number">4.590</span>s <span class="hljs-number">7</span>%: <span class="hljs-number">0.049</span>+<span class="hljs-number">85</span>+<span class="hljs-number">0.095</span> ms clock, <span class="hljs-number">0.59</span>+<span class="hljs-number">618</span>/<span class="hljs-number">253</span>/<span class="hljs-number">0</span>+<span class="hljs-number">1.1</span> ms cpu, <span class="hljs-number">222</span>-&gt;<span class="hljs-number">230</span>-&gt;<span class="hljs-number">140</span> MB, <span class="hljs-number">244</span> MB goal, <span class="hljs-number">12</span> P<font></font>
.<font></font>
.<font></font>
.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдпрд╣рд╛рдВ рджреЗрдЦрддреЗ рд╣реИрдВ, рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реНрдореГрддрд┐ рдХреА рдорд╛рддреНрд░рд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ, рдФрд░ рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреАрд╕реА рдХреА рдорд╛рддреНрд░рд╛ рднреА рдмрдврд╝ рдЬрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдЬрд┐рддрдирд╛ рд╕рдВрднрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЙрд╕рд╕реЗ рдЕрдзрд┐рдХ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ</font></a></font><code>GODEBUG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреБрдЫ рдФрд░ рдЧреЛрд▓рд╛рдВрдЧ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рдЪрд░ рдХреЗ </font><font style="vertical-align: inherit;">рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ </font><font style="vertical-align: inherit;">рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реЛрдлрд╛рдЗрд▓рд░ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛</font></font></h4><br>
<code>go tool pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдбреЗрдЯрд╛ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рд░реВрдкрд░реЗрдЦрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдгред </font><font style="vertical-align: inherit;">рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ </font></font><code>pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: рдпрд╛ рддреЛ </font></font><code>runtime/pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЗ рдХреЛрдб рдореЗрдВ </font><font style="vertical-align: inherit;">рд╕реАрдзреЗ рдлрд╝рдВрдХреНрд╢рди </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП </font></font><code>pprof.StartCPUProfile()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдпрд╛ рдПрдХ </font></font><code>net/http/pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http рд╕реВрдЪреА </font><font style="vertical-align: inherit;">рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдЬреЛ рд╣рдордиреЗ рдХрд┐рдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреА </font></font><code>pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╣реБрдд рдХрдо рд╕рдВрд╕рд╛рдзрди рдЦрдкрдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░реЛрдлрд╛рдЗрд▓ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреВрд╕рд░реЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдХреЗрд╡рд▓ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдиреЗрдЯ / http / pprof" рдкреИрдХреЗрдЬ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдпрд╛рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ </font><font style="vertical-align: inherit;">:</font></font><br>
 <br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> (<font></font>
  _ <span class="hljs-string">"net/http/pprof"</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░ рдПрдХ http рд╕реВрдЪреА рдЬреЛрдбрд╝реЗрдВ:</font></font><br>
 <br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {<font></font>
  log.Println(http.ListenAndServe(<span class="hljs-string">"localhost:6060"</span>, <span class="hljs-literal">nil</span>))<font></font>
}()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pprof рдореЗрдВ рдХрдИ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╣реИрдВ:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allocs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рд╕рднреА рдкрд┐рдЫрд▓реЗ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреНрд▓реЙрдХ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рд╕реНрдЯреИрдХ рдЯреНрд░реЗрд╕ рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдкреНрд░рд╛рдЗрдореЗрдЯреАрдЬ рдЕрд╡рд░реБрджреНрдз рд╣реЛ рдЧрдпрд╛</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЛрд░реЛрдЗрди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рд╕рднреА рдореМрдЬреВрджрд╛ рдЧреЛрд░реЛрдЗрдиреНрдЯреНрд╕ рдХрд╛ рд╕реНрдЯреИрдХ рдЯреНрд░реЗрд╕</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдвреЗрд░</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдЬреАрд╡рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕реНрдореГрддрд┐ рдЖрд╡рдВрдЯрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореНрдпреВрдЯреЗрдХреНрд╕</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдкрд░рд╕реНрдкрд░ рд╡рд┐рд░реЛрдзреА рдореНрдпреВрдЯреЗрдХреНрд╕ рдзрд╛рд░рдХреЛрдВ рдХрд╛ рдвреЗрд░</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реЛрдлрд╛рдЗрд▓</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓ред</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдереНрд░реЗрдбрдХреНрд░реИрдЯ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдПрдХ рд╕реНрдЯреИрдХ рдЯреНрд░реЗрд╕, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдУрдПрд╕ рдореЗрдВ рдирдП рдереНрд░реЗрдбреНрд╕ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╣реБрдЖ</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рд╡рд░реНрддрдорд╛рди рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗред</font></font></li>
</ul><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЛрдЯ: рдЕрдиреНрдп рд╕рднреА рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд рдЯреНрд░реЗрд╕ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ, рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╣реИ </font><font style="vertical-align: inherit;">, рди рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдЬреА рддреМрд░ рдкрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЖрдк рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдЧреЛ рдЯреВрд▓ рдЯреНрд░реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>go tool pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЬрдм рд╕рдм рдХреБрдЫ рддреИрдпрд╛рд░ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдЙрдкрд▓рдмреНрдз рд╕рд╛рдзрдиреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░</font></font></h4><br>
<pre><code class="go hljs">тАНтАНтАНтАНтАНтАНтАНтАНтАНтАНтАНтАНтАНтАНтАН$ <span class="hljs-keyword">go</span> tool pprof http:<span class="hljs-comment">//localhost:6060/debug/pprof/profile?seconds=10</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░ 30 рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ (рд╣рдо рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ рдЗрд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>seconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдФрд░ рдкреНрд░рддреНрдпреЗрдХ 100 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдХреЗ рдирдореВрдиреЗ рдПрдХрддреНрд░ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдпрд╣ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдореЛрдб рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдЖрдо рдЖрджреЗрд╢реЛрдВ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ </font></font><code>top</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>web</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдкрд╛рда рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рдмрд╕реЗ рдЧрд░реНрдо рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font></font><code>top n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>-cum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдЪрдпреА рдХреНрд░рдо рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рдЫрд╛рдВрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рджреЛ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ </font><font style="vertical-align: inherit;">рдФрд░ </font></font><code>-flat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) top <span class="hljs-number">10</span> -cum<font></font>
Showing nodes accounting <span class="hljs-keyword">for</span> <span class="hljs-number">1.50</span>s, <span class="hljs-number">6.19</span>% of <span class="hljs-number">24.23</span>s total<font></font>
Dropped <span class="hljs-number">347</span> nodes (cum &lt;= <span class="hljs-number">0.12</span>s)<font></font>
Showing top <span class="hljs-number">10</span> nodes out of <span class="hljs-number">186</span><font></font>
flat  flat%   sum%  cum   cum%<font></font>
<span class="hljs-number">0.03</span>s <span class="hljs-number">0.12</span>% <span class="hljs-number">0.12</span>% <span class="hljs-number">16.7</span>s <span class="hljs-number">69.13</span>% (*Server).serveUDPPacket
<span class="hljs-number">0.05</span>s <span class="hljs-number">0.21</span>% <span class="hljs-number">0.33</span>% <span class="hljs-number">15.6</span>s <span class="hljs-number">64.51</span>% (*Server).serveDNS
<span class="hljs-number">0</span>     <span class="hljs-number">0</span>%    <span class="hljs-number">0.33</span>% <span class="hljs-number">14.3</span>s <span class="hljs-number">59.10</span>% (*ServeMux).ServeDNS
<span class="hljs-number">0</span>     <span class="hljs-number">0</span>%    <span class="hljs-number">0.33</span>% <span class="hljs-number">14.2</span>s <span class="hljs-number">58.73</span>% HandlerFunc.ServeDNS
<span class="hljs-number">0.01</span>s <span class="hljs-number">0.04</span>% <span class="hljs-number">0.37</span>% <span class="hljs-number">14.2</span>s <span class="hljs-number">58.73</span>% main.handleRequest
<span class="hljs-number">0.07</span>s <span class="hljs-number">0.29</span>% <span class="hljs-number">0.66</span>% <span class="hljs-number">13.5</span>s <span class="hljs-number">56.00</span>% (*DnsRequestHandler).HandleRequest
<span class="hljs-number">0.99</span>s <span class="hljs-number">4.09</span>% <span class="hljs-number">4.75</span>% <span class="hljs-number">7.56</span>s <span class="hljs-number">31.20</span>% runtime.gentraceback
<span class="hljs-number">0.02</span>s <span class="hljs-number">0.08</span>% <span class="hljs-number">4.83</span>% <span class="hljs-number">7.02</span>s <span class="hljs-number">28.97</span>% runtime.systemstack
<span class="hljs-number">0.31</span>s <span class="hljs-number">1.28</span>% <span class="hljs-number">6.11</span>% <span class="hljs-number">6.62</span>s <span class="hljs-number">27.32</span>% runtime.mallocgc
<span class="hljs-number">0.02</span>s <span class="hljs-number">0.08</span>% <span class="hljs-number">6.19</span>% <span class="hljs-number">6.35</span>s <span class="hljs-number">26.21</span>% (*DnsRequestHandler).FindANAME<font></font>
(pprof)</code></pre><br><font style="vertical-align: inherit;"></font><code>list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">
рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рдХрд░реЗрдВред</font></font><br>
<br>
<pre><code class="go hljs">(pprof) list handleRequest<font></font>
Total: <span class="hljs-number">24.23</span>s<font></font>
ROUTINE ======================== main.handleRequest in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/redins.<span class="hljs-keyword">go</span>
     <span class="hljs-number">10</span>ms     <span class="hljs-number">14.23</span>s (flat, cum) <span class="hljs-number">58.73</span>% of Total<font></font>
        .          .     <span class="hljs-number">35</span>: l          *handler.RateLimiter<font></font>
        .          .     <span class="hljs-number">36</span>: configFile <span class="hljs-keyword">string</span>
        .          .     <span class="hljs-number">37</span>:)<font></font>
        .          .     <span class="hljs-number">38</span>:<font></font>
        .          .     <span class="hljs-number">39</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handleRequest</span><span class="hljs-params">(w dns.ResponseWriter, r *dns.Msg)</span></span> {
     <span class="hljs-number">10</span>ms      <span class="hljs-number">610</span>ms     <span class="hljs-number">40</span>: context := handler.NewRequestContext(w, r)<font></font>
        .       <span class="hljs-number">50</span>ms     <span class="hljs-number">41</span>: logger.Default.Debugf(<span class="hljs-string">"handle request: [%d] %s %s"</span>, r.Id, context.RawName(), context.Type())<font></font>
        .          .     <span class="hljs-number">42</span>:<font></font>
        .          .     <span class="hljs-number">43</span>: <span class="hljs-keyword">if</span> l.CanHandle(context.IP()) {<font></font>
        .     <span class="hljs-number">13.57</span>s     <span class="hljs-number">44</span>:  h.HandleRequest(context)<font></font>
        .          .     <span class="hljs-number">45</span>: } <span class="hljs-keyword">else</span> {<font></font>
        .          .     <span class="hljs-number">46</span>:  context.Response(dns.RcodeRefused)<font></font>
        .          .     <span class="hljs-number">47</span>: }<font></font>
        .          .     <span class="hljs-number">48</span>:}<font></font>
        .          .     <span class="hljs-number">49</span>:<font></font>
(pprof)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЯреАрдо </font></font><code>web</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рдПрдХ рдПрд╕рд╡реАрдЬреА-рдЧреНрд░рд╛рдл рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ рдФрд░ рдЗрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЦреЛрд▓рддреА рд╣реИред </font></font><br>
<br>
<code>(pprof)web handleReques</code><br>
<br>
<img src="https://habrastorage.org/webt/bt/hi/di/bthidimalsguoeg_obuzzmzy7ro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреАрд╕реА рдлрд╝рдВрдХреНрд╢рдВрд╕ рдореЗрдВ рд╕рдордп рдХреА рдПрдХ рдмрдбрд╝реА рд░рд╛рд╢рд┐ рдЦрд░реНрдЪ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ </font></font><code>runtime.mallocgc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдХреНрд╕рд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдХрдЪрд░рд╛ рдХрд▓реЗрдХреНрдЯрд░ рдХреЛ рд▓реЛрдб рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд┐рд▓рдВрдмрддрд╛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдореИрдХреЗрдирд┐рдЬреНрдо рдкрд░ рдЦрд░реНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдордп рдХреА рдПрдХ рдмрдбрд╝реА рд░рд╛рд╢рд┐, рдЬреИрд╕реЗ рдХрд┐ </font></font><code>runtime.chansend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛ </font></font><code>runtime.lock</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╕рдВрдШрд░реНрд╖ рдХрд╛ рд╕рдВрдХреЗрдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдордп рдХреА рдПрдХ рдмрдбрд╝реА рд░рд╛рд╢рд┐ рдЦрд░реНрдЪ </font></font><code>syscall.Read/Write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдИ / рдУ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдЕрддреНрдпрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд╛ рдорддрд▓рдм рд╣реИред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдореЛрд░реА рдкреНрд░реЛрдлрд╛рдЗрд▓рд░</font></font></h4><br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool pprof http:<span class="hljs-comment">//localhost:6060/debug/pprof/allocs</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдЖрдмрдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдХреЗ рдЬреАрд╡рдирдХрд╛рд▓ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо </font></font><code>-alloc_objects</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рд╡рд┐рдХрд▓реНрдкреЛрдВ </font><font style="vertical-align: inherit;">рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрдпрдирд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">: </font></font><code>-iuse_objects</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font><i><font style="vertical-align: inherit;">рд▓рд╛рдЗрд╡</font></i><font style="vertical-align: inherit;"> рдореЗрдореЛрд░реА рдХреА </font></font><code>-inuse_space</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">
рдЖрдорддреМрд░ рдкрд░, рдпрджрд┐ рдЖрдк рдореЗрдореЛрд░реА рдХреА рдЦрдкрдд рдХрдо рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рд╡рд┐рд▓рдВрдмрддрд╛ рдХреЛ рдХрдо рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ </font><font style="vertical-align: inherit;">рдкрд░реНрдпрд╛рдкреНрдд рд░рди рдпрд╛ рд▓реЛрдб рд╕рдордп рдХреЗ рдмрд╛рдж рджреЗрдЦреЗрдВред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>-inuse_space</code><font style="vertical-align: inherit;"></font><code>-alloc_objects</code><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдбрд╝рдЪрди рдХреА рдкрд╣рдЪрд╛рди</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╣рд▓реЗ рдЕрдбрд╝рдЪрди рдХреЗ рдкреНрд░рдХрд╛рд░ (рдкреНрд░реЛрд╕реЗрд╕рд░, рдЖрдИ / рдУ, рдореЗрдореЛрд░реА) рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдЬреЛ рд╣рдо рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкреНрд░реЛрдлрд╛рдЗрд▓рд░реНрд╕ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рдФрд░ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЯреВрд▓ рд╣реИред </font></font><br>
<br>
<code>go tool trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд┐рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧреЛрд░реЛрдЗрдЯрд┐рди рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдХреНрдпрд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдПрдХ рдЯреНрд░реЗрд╕ рдЙрджрд╛рд╣рд░рдг рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЯреНрд░реЗрд╕ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдкрд░ рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="go hljs">$ curl http:<span class="hljs-comment">//localhost:6060/debug/pprof/trace?seconds=5 --output trace.out</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЯреНрд░реЗрд╕ рдХрд┐рдП рдЧрдП рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрдиреНрди рдлрд╝рд╛рдЗрд▓ рджреЗрдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:</font></font><br>
 <br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool trace trace.out
<span class="hljs-number">2019</span>/<span class="hljs-number">12</span>/<span class="hljs-number">25</span> <span class="hljs-number">15</span>:<span class="hljs-number">30</span>:<span class="hljs-number">50</span> Parsing trace...
<span class="hljs-number">2019</span>/<span class="hljs-number">12</span>/<span class="hljs-number">25</span> <span class="hljs-number">15</span>:<span class="hljs-number">30</span>:<span class="hljs-number">59</span> Splitting trace...
<span class="hljs-number">2019</span>/<span class="hljs-number">12</span>/<span class="hljs-number">25</span> <span class="hljs-number">15</span>:<span class="hljs-number">31</span>:<span class="hljs-number">10</span> Opening browser. Trace viewer is listening on http:<span class="hljs-comment">//127.0.0.1:42703</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Go рдЯреВрд▓ рдЯреНрд░реЗрд╕ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬреЛ Chrome DevTools рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ Chrome рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИред рдореБрдЦреНрдп рдкреГрд╖реНрда рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </font></font><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕ рджреЗрдЦреЗрдВ (0s-409.575266ms) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (411.075559ms-747.252311ms) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (747.252311ms-1.234962645s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (1.234968945s-1.774245108s) - 1.776/424 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрдЦреЗрдВред </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕ </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрдЦреЗрдВ (2.111339514s-2.674030898s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (2.674031362s-3.044145798s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (3.044145798s-3.458795252s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (3.43953778s-4.075080634s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рдЯреНрд░реЗрд╕ (4.07508109898) 4.4278s -4.814869651s) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕ рджреЗрдЦреЗрдВ (4.814869651s-5.253597835s) </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЛрд░реЛрдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдЯрд╡рд░реНрдХ рдЕрд╡рд░реБрджреНрдз рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ ()</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдмреНрд▓реЙрдХрд┐рдВрдЧ рдкреНрд░реЛрдлрд╛рдЗрд▓ () </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syscall рдЕрд╡рд░реБрджреНрдз рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ () </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реЗрдбреНрдпреВрд▓рд░ рд╡рд┐рд▓рдВрдмрддрд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ () </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд╛рд░реНрдп </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреНрд╖реЗрддреНрд░ </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреНрдпреВрдирддрдо рдЙрддреНрдкрд░рд┐рд╡рд░реНрддреА рдЙрдкрдпреЛрдЧ</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдЯреНрд░реЗрд╕рд┐рдВрдЧ рдЯреНрд░реЗрд╕ рд╕рдордп рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдкрдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рд╕рдВрднрд╛рд▓ рд╕рдХреЗред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/xa/pf/xxxapfdolkivu1jce6axclwsmqg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рд╣реИ, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рд▓рдЧрднрдЧ рдЕрдкрдардиреАрдп рдмрдирд╛рддрд╛ рд╣реИ рдпрджрд┐ред рд╣рдо рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ рд╣рдо рдХреНрдпрд╛ рджреЗрдЦ рд░рд╣реЗ рд╣реИрдВред рдЪрд▓реЛ рдЕрдм рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЫреЛрдбрд╝ рджреЗрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореБрдЦреНрдп рдкреГрд╖реНрда рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд┐рдВрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдЧреЛрд░реЛрдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг" рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ </font><font style="vertical-align: inherit;">рдЯреНрд░реЗрд╕ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдХрд╛рд░реНрдпрдХреНрд░рдо рдореЗрдВ </font><font style="vertical-align: inherit;">рд╡рд┐рднрд┐рдиреНрди </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рдХрд╛рд░ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЧреЛрд░реЛрдЗрдЯрд┐рди рджрд┐рдЦрд╛рддрд╛ рд╣реИ:</font></font><br>
 <br>
<pre><code class="go hljs">Goroutines:<font></font>
github.com/miekg/dns.(*Server).serveUDPPacket N=<span class="hljs-number">441703</span>
runtime.gcBgMarkWorker N=<span class="hljs-number">12</span>
github.com/karlseguin/ccache.(*Cache).worker N=<span class="hljs-number">2</span>
main.Start.func1 N=<span class="hljs-number">1</span>
runtime.bgsweep N=<span class="hljs-number">1</span>
arvancloud/redins/handler.NewHandler.func2 N=<span class="hljs-number">1</span>
runtime/trace.Start.func1 N=<span class="hljs-number">1</span>
net/http.(*conn).serve N=<span class="hljs-number">1</span>
runtime.timerproc N=<span class="hljs-number">3</span>
net/http.(*connReader).backgroundRead N=<span class="hljs-number">1</span>
N=<span class="hljs-number">40</span></code></pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрди = 441703 рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕рд╛рде рдкрд╣рд▓реЗ рддрддреНрд╡ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">, рдпрд╣ рд╡рд╣реА рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдорд┐рд▓рддрд╛ рд╣реИ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dh/lt/qy/dhltqyepbyyuk_i7tcadrdyx_gs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЛрд░реЛрдЯрд┐рди рд╡рд┐рд╢реНрд▓реЗрд╖рдг</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдпрд╣ рдмрд╣реБрдд рджрд┐рд▓рдЪрд╕реНрдк рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХрд╛рдВрд╢ рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдореЗрдВ рд▓рдЧрднрдЧ рдХреЛрдИ рд╕рдордп рдирд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ, рдФрд░ рдЬреНрдпрд╛рджрд╛рддрд░ рд╕рдордп рд╕рд┐рдВрдХ рдмреНрд▓реЙрдХ рдореЗрдВ рдЦрд░реНрдЪ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдкрд░ рдХрд░реАрдм рд╕реЗ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tu/bs/vt/tubsvt8trkqhgjrfpjijolibof4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЛрд░реЛрдЗрди рдЯреНрд░реЗрд╕ рдкреИрдЯрд░реНрди</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рдЧрднрдЧ рд╣рдореЗрд╢рд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рд╕реЗ рд╣рдо рд╕реАрдзреЗ рд▓реЙрдХ рдЯреВрд▓ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ; </font><font style="vertical-align: inherit;">рд▓реЙрдХ рдкреНрд░реЛрдлрд╛рдЗрд▓рд┐рдВрдЧ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИ, рд╣рдореЗрдВ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╣рдорд╛рд░реЗ рдХреЛрдб рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛:</font></font><br>
<br>
<pre><code class="go hljs">runtime.SetBlockProfileRate(<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рддрд╛рд▓реЗ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
 <br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool pprof http:<span class="hljs-comment">//localhost:6060/debug/pprof/block</span><font></font>
(pprof) top<font></font>
Showing nodes accounting <span class="hljs-keyword">for</span> <span class="hljs-number">16.03</span>wks, <span class="hljs-number">99.75</span>% of <span class="hljs-number">16.07</span>wks total<font></font>
Dropped <span class="hljs-number">87</span> nodes (cum &lt;= <span class="hljs-number">0.08</span>wks)<font></font>
Showing top <span class="hljs-number">10</span> nodes out of <span class="hljs-number">27</span><font></font>
     flat  flat%   sum%        cum   cum%<font></font>
 <span class="hljs-number">10.78</span>wks <span class="hljs-number">67.08</span>% <span class="hljs-number">67.08</span>%   <span class="hljs-number">10.78</span>wks <span class="hljs-number">67.08</span>%  internal/poll.(*fdMutex).rwlock
  <span class="hljs-number">5.25</span>wks <span class="hljs-number">32.67</span>% <span class="hljs-number">99.75</span>%    <span class="hljs-number">5.25</span>wks <span class="hljs-number">32.67</span>%  sync.(*Mutex).Lock
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%    <span class="hljs-number">5.25</span>wks <span class="hljs-number">32.67</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Filter
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%    <span class="hljs-number">5.25</span>wks <span class="hljs-number">32.68</span>%  arvancloud/redins/handler.(*DnsRequestHandler).FindANAME
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%   <span class="hljs-number">16.04</span>wks <span class="hljs-number">99.81</span>%  arvancloud/redins/handler.(*DnsRequestHandler).HandleRequest
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%   <span class="hljs-number">10.78</span>wks <span class="hljs-number">67.08</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Response
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%   <span class="hljs-number">10.78</span>wks <span class="hljs-number">67.08</span>%  arvancloud/redins/handler.(*RequestContext).Response
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%    <span class="hljs-number">5.25</span>wks <span class="hljs-number">32.67</span>%  arvancloud/redins/handler.ChooseIp
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%   <span class="hljs-number">16.04</span>wks <span class="hljs-number">99.81</span>%  github.com/miekg/dns.(*ServeMux).ServeDNS
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">99.75</span>%   <span class="hljs-number">16.04</span>wks <span class="hljs-number">99.81</span>%  github.com/miekg/dns.(*Server).serveDNS<font></font>
(pprof)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд╛рд▓реЗ рд╣реИрдВ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЛрд▓.рдлреАрдбрдореНрдпреВрдЯреЗрдХреНрд╕ рдФрд░ рд╕рд┐рдВрдХ.рдореНрдпреВрдЯреЗрдХреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), рд▓рдЧрднрдЧ 100% рддрд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ред </font><font style="vertical-align: inherit;">рдпрд╣ рд▓реЙрдХ рд╕рдВрдШрд░реНрд╖ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣рдорд╛рд░реА рдзрд╛рд░рдгрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ, рдЕрдм рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдРрд╕рд╛ рдХрд╣рд╛рдВ рд╣реЛрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="go hljs">(pprof) svg lock</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХрдорд╛рдВрдб рдмреНрд▓реЙрдХрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдкрд░ рдЬреЛрд░ рджреЗрдиреЗ рдХреЗ рд╕рд╛рде рд╕рднреА рд╕рдВрдШрд░реНрд╖ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдиреЛрдбреНрд╕ рдХрд╛ рдПрдХ рд╡реЗрдХреНрдЯрд░ рдЧреНрд░рд╛рдл рдмрдирд╛рддрд╛ рд╣реИ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/in/m4/zu/inm4zuykw5uum0vydotfudr48d0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреНрд▓реЙрдХрд┐рдВрдЧ рдПрдВрдбрдкреЙрдЗрдВрдЯ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдХреЗ svg- </font><i><font style="vertical-align: inherit;">рдЧреНрд░рд╛рдл</font></i><font style="vertical-align: inherit;"> рд╣рдо рдЧреЛрд░реЛрдЗрди рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╕реЗ рд╕рдорд╛рди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool pprof http:<span class="hljs-comment">//localhost:6060/debug/pprof/goroutine</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдлрд┐рд░:</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) top<font></font>
Showing nodes accounting <span class="hljs-keyword">for</span> <span class="hljs-number">294412</span>, <span class="hljs-number">100</span>% of <span class="hljs-number">294424</span> total<font></font>
Dropped <span class="hljs-number">84</span> nodes (cum &lt;= <span class="hljs-number">1472</span>)<font></font>
Showing top <span class="hljs-number">10</span> nodes out of <span class="hljs-number">32</span><font></font>
     flat  flat%   sum%        cum   cum%<font></font>
   <span class="hljs-number">294404</span>   <span class="hljs-number">100</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">294404</span>   <span class="hljs-number">100</span>%  runtime.gopark
        <span class="hljs-number">8</span> <span class="hljs-number">0.0027</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">294405</span>   <span class="hljs-number">100</span>%  github.com/miekg/dns.(*Server).serveUDPPacket
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%      <span class="hljs-number">58257</span> <span class="hljs-number">19.79</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Filter
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%      <span class="hljs-number">58259</span> <span class="hljs-number">19.79</span>%  arvancloud/redins/handler.(*DnsRequestHandler).FindANAME
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">293852</span> <span class="hljs-number">99.81</span>%  arvancloud/redins/handler.(*DnsRequestHandler).HandleRequest
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">235406</span> <span class="hljs-number">79.95</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Response
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">235406</span> <span class="hljs-number">79.95</span>%  arvancloud/redins/handler.(*RequestContext).Response
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%      <span class="hljs-number">58140</span> <span class="hljs-number">19.75</span>%  arvancloud/redins/handler.ChooseIp
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">293852</span> <span class="hljs-number">99.81</span>%  github.com/miekg/dns.(*ServeMux).ServeDNS
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%   <span class="hljs-number">100</span>%     <span class="hljs-number">293900</span> <span class="hljs-number">99.82</span>%  github.com/miekg/dns.(*Server).serveDNS<font></font>
(pprof)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ рд▓рдЧрднрдЧ рд╕рднреА рдХрд╛рд░реНрдпрдХреНрд░рдо рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИрдВред рдЧреЛрдкрд╛рд░реНрдХ, рдпрд╣ рдПрдХ рдЧреЛ рд╢реЗрдбреНрдпреВрд▓рд░ рд╣реИ рдЬреЛ рдЧреЛрд░реЛрдЗрдЯрд┐рди рд╕реЛрддрд╛ рд╣реИ; </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░рдг рдПрдХ рддрд╛рд▓рд╛ рд╕рдВрдШрд░реНрд╖ рд╣реИ</font></font><br>
<br>
<pre><code class="go hljs">(pprof) svg gopark</code></pre><br>
<img src="https://habrastorage.org/webt/-r/r6/pe/-rr6peofee7fshmvot6rb3usrjs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдЧреЛрд░реЛрдЗрди рдХреЗ svg- рдЧреНрд░рд╛рдл</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдпрд╣рд╛рдБ рд╣рдо рд╕рдВрдШрд░реНрд╖ рдХреЗ рджреЛ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UDPConn.WriteMsg ()</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рдЙрддреНрддрд░ рдПрдХ рд╣реА рдПрдлрдбреА (рдЗрд╕рд▓рд┐рдП рд▓реЙрдХ) рдХреЛ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рд╕реЗ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рд╕рднреА рдПрдХ рд╣реА рд╕реНрд░реЛрдд рдХрд╛ рдкрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдордиреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛, рдФрд░ рдЕрдВрдд рдореЗрдВ рд╣рдордиреЗ рд▓реЛрдб рдХреЛ рд╕рдВрддреБрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╢реНрд░реЛрддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдУрдПрд╕ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рдмреАрдЪ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдВрддреБрд▓рд┐рдд рдХрд░рдиреЗ рдФрд░ рд╕рдВрдШрд░реНрд╖реЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░реИрдВрдб ()</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣рд╛рдБ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЧрдгрд┐рдд / рд░реИрдВрдб рдХрд╛рд░реНрдп (рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдореЗрдВ рдПрдХ рддрд╛рд▓рд╛ рд╣реИ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ред </font><font style="vertical-align: inherit;">рдпрд╣ </font></font><code>Rand.New()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдЬрдирд░реЗрдЯрд░ </font><font style="vertical-align: inherit;">рдХреА рдорджрдж рд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рддрдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ </font><font style="vertical-align: inherit;">рд╣реИ рдЬреЛ рдПрдХ рдЧреИрд░-рдЕрд╡рд░реЛрдзрдХ рдЖрд╡рд░рдг рдмрдирд╛рддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="go hljs">rg := rand.New(rand.NewSource(<span class="hljs-keyword">int64</span>(time.Now().Nanosecond())))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдереЛрдбрд╝рд╛ рдмреЗрд╣рддрд░ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рд░ рдмрд╛рд░ рдПрдХ рдирдпрд╛ рд╕реНрд░реЛрдд рдмрдирд╛рдирд╛ рдорд╣рдВрдЧрд╛ рд╣реИред рдХреНрдпрд╛ рдпрд╣ рдмреЗрд╣рддрд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ? рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рд╣рдореЗрдВ рд▓реЛрдб рдХреЛ рд╕рдВрддреБрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдорд╛рди рд╡рд┐рддрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ </font></font><code>Time.Nanoseconds()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЬрдм рд╣рдордиреЗ рд╕рднреА рдЕрдирд╛рд╡рд╢реНрдпрдХ рддрд╛рд▓реЗ рд╣рдЯрд╛ рджрд┐рдП рд╣реИрдВ, рддреЛ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рджреЗрдЦреЗрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/aw/76/oqaw76gy7k0jxwro9moeo8e374s.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЛрд░реЛрдиреЗрдЯрд┐рди рд╡рд┐рд╢реНрд▓реЗрд╖рдг</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдмреЗрд╣рддрд░ рджрд┐рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА, рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд▓реЙрдХ рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рдЖрдЗрдП рдЯреНрд░реЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рдореБрдЦреНрдп рдкреГрд╖реНрда рд╕реЗ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд▓реЙрдХ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k4/1y/ky/k41yky-okraevi6-huriop7-g2i.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рд▓реЙрдХ рдЯрд╛рдЗрдорд▓рд╛рдЗрди</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдЪрд▓реЛ </font></font><code>ccache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЙрдХ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╕реЗ </font><font style="vertical-align: inherit;">рдмреВрд╕реНрдЯ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ </font></font><code>pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) list promote<font></font>
ROUTINE ======================== github.com/karlseguin/ccache.(*Cache).promote in ...<font></font>
        <span class="hljs-number">0</span>   <span class="hljs-number">9.66</span>days (flat, cum) <span class="hljs-number">99.70</span>% of Total<font></font>
        .          .    <span class="hljs-number">155</span>: h.Write([]<span class="hljs-keyword">byte</span>(key))<font></font>
        .          .    <span class="hljs-number">156</span>: <span class="hljs-keyword">return</span> c.buckets[h.Sum32()&amp;c.bucketMask]<font></font>
        .          .    <span class="hljs-number">157</span>:}<font></font>
        .          .    <span class="hljs-number">158</span>:<font></font>
        .          .    <span class="hljs-number">159</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Cache)</span> <span class="hljs-title">promote</span><span class="hljs-params">(item *Item)</span></span> {<font></font>
        .   <span class="hljs-number">9.66</span>days    <span class="hljs-number">160</span>: c.promotables &lt;- item<font></font>
        .          .    <span class="hljs-number">161</span>:}<font></font>
        .          .    <span class="hljs-number">162</span>:<font></font>
        .          .    <span class="hljs-number">163</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Cache)</span> <span class="hljs-title">worker</span><span class="hljs-params">()</span></span> {<font></font>
        .          .    <span class="hljs-number">164</span>: <span class="hljs-keyword">defer</span> <span class="hljs-built_in">close</span>(c.donec)<font></font>
        .          .    <span class="hljs-number">165</span>:</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рднреА рдХреЙрд▓ </font></font><code>ccache.Get()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЪреИрдирд▓ рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИрдВ </font></font><code>c.promotables</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдХреИрд╢рд┐рдВрдЧ рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рд╣рдореЗрдВ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдкреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП; рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dgraph</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд▓реЗрдЦ рд╣реИ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреИрд╢ рд░рд╛рдЬреНрдп! рдЬрд╛рдУ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рд╡реЗ рднреА рдЙрддреНрдХреГрд╖реНрдЯ рдХреИрд╢рд┐рдВрдЧ рдореЙрдбреНрдпреВрд▓ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ristretto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд░рд┐рд╕реНрдЯреНрд░реЗрдЯреЛ рдЕрднреА рддрдХ рдЯреАрдЯреАрдПрд▓-рдЖрдзрд╛рд░рд┐рдд рд░рд┐рд▓реАрдЬрд╝ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд╣рдо рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд▓рдЧрднрдЧ рдПрдХ рдмрд╣реБрдд рдмрдбрд╝реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font></font><code>MaxCost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЕрдкрдиреА рдХреИрд╢ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдЯрд╛рдЗрдордЖрдЙрдЯ рдореВрд▓реНрдп рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">(рд╣рдо рдХреИрд╢ рдореЗрдВ рдкреБрд░рд╛рдирд╛ рдбреЗрдЯрд╛ рд░рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ)ред рдЖрдЗрдП </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/k2/ay/hok2ay6emv_agqfuv-y65sxkius.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рд╕реНрдЯреНрд░реЗрдЯреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдкрд░рд┐рдгрд╛рдо рджреЗрдЦреЗрдВ: </font><i><font style="vertical-align: inherit;">рдЧреЛрд░рдЖрдЙрдЯ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдЧреНрд░реЗрдЯ!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо gorutin рдХреЗ рдЕрдзрд┐рдХрддрдо рд░рдирдЯрд╛рдЗрдо рдХреЛ 5000 ms рд╕реЗ рдШрдЯрд╛рдХрд░ 22 ms рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐, рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдордп "рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд▓реЙрдХ" рдФрд░ "рд╢реЗрдбреНрдпреВрд▓рд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛" рдХреЗ рдмреАрдЪ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣рдо рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/s3/8u/qh/s38uqh-knc7gmandd1erhgelmrs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рд▓реЙрдХ рдЯрд╛рдЗрдорд▓рд╛рдЗрди</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╣рдо рдЗрд╕рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>fdMutex.rwlock</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЕрдм рд╣рдо рджреВрд╕рд░реЗ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: gcMarkDone, рдЬреЛ рдмреНрд▓реЙрдХ рд╕рдордп рдХреЗ 53% рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЦрдВрдб рдореЗрдВ рдЙрдирдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдЕрдХреНрд╕рд░ рдПрдХ рд╕рдВрдХреЗрдд рд╣реИ рдХрд┐ рд╣рдо рдЬреАрд╕реА рдХреЛ рдУрд╡рд░рд▓реЛрдб рдХрд░ рд░рд╣реЗ рд╣реИрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡рдВрдЯрди рдЕрдиреБрдХреВрд▓рди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдпрд╣ рджреЗрдЦрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ; </font><font style="vertical-align: inherit;">рдЧреЛ, рдорд╛рд░реНрдХ-рдПрдВрдб-рд╕реНрд╡реАрдк рдкрд┐рдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрди рд╕рднреА рдЪреАрдЬрд╝реЛрдВ рдкрд░ рдирдЬрд╝рд░ рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рдЪрдпрдирд┐рдд рд╣реИрдВ, рдФрд░ рдЬреИрд╕реЗ рд╣реА рдпрд╣ рдЖрдХрд╛рд░ рд╕реЗ рджреЛрдЧреБрдирд╛ (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдореВрд▓реНрдп рдЬреЛ GOGC рдкрд░ рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ) рдкрд┐рдЫрд▓реЗ рдЖрдХрд╛рд░ рдХреЗ рдЖрдХрд╛рд░ рддрдХ рдкрд╣реБрдВрдЪ рдЬрд╛рддрд╛ рд╣реИ, GC рд╕рдлрд╛рдИ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдореВрд▓реНрдпрд╛рдВрдХрди рддреАрди рдЪрд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рд░реНрдХрд░ рд╕реЗрдЯрд┐рдВрдЧ (STW)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдХрди (рд╕рдорд╛рдирд╛рдВрддрд░)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдмрд▓рд┐рдВрдЧ рдПрдВрдб (STW)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдЯреЙрдк рдж рд╡рд░реНрд▓реНрдб (STW) рдЪрд░рдг рдкреВрд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡реЗ рдЖрдорддреМрд░ рдкрд░ рдмрд╣реБрдд рдХрдо рд╣реЛрддреЗ рд╣реИрдВ, рдирд┐рд░рдВрддрд░ рдЪрдХреНрд░ рдЕрд╡рдзрд┐ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рд╡рд░реНрддрдорд╛рди рдореЗрдВ (v1.13 рдкрд░ рдЬрд╛рдПрдВ) рдЧреЛрд░реЛрдЗрдВрдЯрд┐рди рдХреЛ рдХреЗрд╡рд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рдмрд┐рдВрджреБрдУрдВ рдкрд░ рджрдмрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╕рддрдд рдЪрдХреНрд░ рдХреЗ рд▓рд┐рдП, рдПрдХ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рд▓рдВрдмрд╛ рдард╣рд░рд╛рд╡ рд╕рдордп рд╕рдВрднрд╡ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬреАрд╕реА рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЧреЛрд░реЛрдЗрдиреНрдЯреНрд╕ рдХреА рдЙрдореНрдореАрдж рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдХрди рдХреЗ рджреМрд░рд╛рди, рдЬреАрд╕реА рд▓рдЧрднрдЧ 25% рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font></font><code>GOMAXPROCS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЬрдмрд░рди рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рд░реНрдХ рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд▓рд┐рдП</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдпрд╣ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рддреЗрдЬреА рд╕реЗ рдмрдврд╝рддреЗ рдЧреЛрд░реЛрдЗрди рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдорд╛рд░реНрдХрд░ рдХреЛ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдЬреАрд╕реА рдХреЗ рдХрд╛рд░рдг рджреЗрд░реА рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, рд╣рдореЗрдВ рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдХрдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рджреЛ рдмрд╛рддреЗрдВ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡рдВрдЯрди рдХреА рд╕рдВрдЦреНрдпрд╛ рдЖрдХрд╛рд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 20-рдмрд╛рдЗрдЯ рд╕рдВрд░рдЪрдирд╛ рд╕реЗ 1000 рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди 20,000 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдПрдХрд▓ рдЖрд╡рдВрдЯрди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдвреЗрд░ рдкрд░ рдЕрдзрд┐рдХ рднрд╛рд░ рдкреИрджрд╛ рдХрд░рддреЗ рд╣реИрдВ);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА / рд╕реА ++ рдЬреИрд╕реА рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕рднреА рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдвреЗрд░ рдкрд░ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЧреЛ рдХрдВрдкрд╛рдЗрд▓рд░ рдпрд╣ рддрдп рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡реЗрд░рд┐рдПрдмрд▓ рд╣реАрдк рдореЗрдВ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рд╕реНрдЯреИрдХ рдлреНрд░реЗрдо рдХреЗ рдЕрдВрджрд░ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдвреЗрд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдЪрд░ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдвреЗрд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдЪрд░ рдЬреАрд╕реА рд▓реЛрдб рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЧреЛ рдореЗрдореЛрд░реА рдореЙрдбрд▓ рдФрд░ рдЬреАрд╕реА рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдЗрд╕ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд╕реНрддреБрддрд┐ рдХреЛ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрдЦреЗрдВ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдореГрддрд┐ рдЖрд╡рдВрдЯрди рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЯреВрд▓рдХрд┐рдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрд░реНрдо рд╡рд┐рддрд░рдг рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреНрд░реИрдХрд┐рдВрдЧ рдЖрд╡рдВрдЯрди рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдкреНрд░реЛрдлрд╛рдЗрд▓рд░;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреИрдЯрд░реНрди рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЗрдЦрдХ; </font><font style="vertical-align: inherit;">рдЬреАрд╕реА</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡рдВрдЯрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рдмрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░реЛрд╕реЗрд╕рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
 <br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool pprof http:<span class="hljs-comment">//localhost:6060/debug/pprof/profile?seconds=20</span>
(pprof) top <span class="hljs-number">20</span> -cum<font></font>
Showing nodes accounting <span class="hljs-keyword">for</span> <span class="hljs-number">7.27</span>s, <span class="hljs-number">29.10</span>% of <span class="hljs-number">24.98</span>s total<font></font>
Dropped <span class="hljs-number">315</span> nodes (cum &lt;= <span class="hljs-number">0.12</span>s)<font></font>
Showing top <span class="hljs-number">20</span> nodes out of <span class="hljs-number">201</span><font></font>
     flat  flat%   sum%        cum   cum%<font></font>
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>%     <span class="hljs-number">0</span>%     <span class="hljs-number">16.42</span>s <span class="hljs-number">65.73</span>%  github.com/miekg/dns.(*Server).serveUDPPacket
    <span class="hljs-number">0.02</span>s  <span class="hljs-number">0.08</span>%  <span class="hljs-number">0.08</span>%     <span class="hljs-number">16.02</span>s <span class="hljs-number">64.13</span>%  github.com/miekg/dns.(*Server).serveDNS
    <span class="hljs-number">0.02</span>s  <span class="hljs-number">0.08</span>%  <span class="hljs-number">0.16</span>%     <span class="hljs-number">13.69</span>s <span class="hljs-number">54.80</span>%  github.com/miekg/dns.(*ServeMux).ServeDNS
    <span class="hljs-number">0.01</span>s  <span class="hljs-number">0.04</span>%   <span class="hljs-number">0.2</span>%     <span class="hljs-number">13.48</span>s <span class="hljs-number">53.96</span>%  github.com/miekg/dns.HandlerFunc.ServeDNS
    <span class="hljs-number">0.02</span>s  <span class="hljs-number">0.08</span>%  <span class="hljs-number">0.28</span>%     <span class="hljs-number">13.47</span>s <span class="hljs-number">53.92</span>%  main.handleRequest
    <span class="hljs-number">0.24</span>s  <span class="hljs-number">0.96</span>%  <span class="hljs-number">1.24</span>%     <span class="hljs-number">12.50</span>s <span class="hljs-number">50.04</span>%  arvancloud/redins/handler.(*DnsRequestHandler).HandleRequest
    <span class="hljs-number">0.81</span>s  <span class="hljs-number">3.24</span>%  <span class="hljs-number">4.48</span>%      <span class="hljs-number">6.91</span>s <span class="hljs-number">27.66</span>%  runtime.gentraceback
    <span class="hljs-number">3.82</span>s <span class="hljs-number">15.29</span>% <span class="hljs-number">19.78</span>%      <span class="hljs-number">5.48</span>s <span class="hljs-number">21.94</span>%  syscall.Syscall
    <span class="hljs-number">0.02</span>s  <span class="hljs-number">0.08</span>% <span class="hljs-number">19.86</span>%      <span class="hljs-number">5.44</span>s <span class="hljs-number">21.78</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Response
    <span class="hljs-number">0.06</span>s  <span class="hljs-number">0.24</span>% <span class="hljs-number">20.10</span>%      <span class="hljs-number">5.25</span>s <span class="hljs-number">21.02</span>%  arvancloud/redins/handler.(*RequestContext).Response
    <span class="hljs-number">0.03</span>s  <span class="hljs-number">0.12</span>% <span class="hljs-number">20.22</span>%      <span class="hljs-number">4.97</span>s <span class="hljs-number">19.90</span>%  arvancloud/redins/handler.(*DnsRequestHandler).FindANAME
    <span class="hljs-number">0.56</span>s  <span class="hljs-number">2.24</span>% <span class="hljs-number">22.46</span>%      <span class="hljs-number">4.92</span>s <span class="hljs-number">19.70</span>%  runtime.mallocgc
    <span class="hljs-number">0.07</span>s  <span class="hljs-number">0.28</span>% <span class="hljs-number">22.74</span>%      <span class="hljs-number">4.90</span>s <span class="hljs-number">19.62</span>%  github.com/miekg/dns.(*response).WriteMsg
    <span class="hljs-number">0.04</span>s  <span class="hljs-number">0.16</span>% <span class="hljs-number">22.90</span>%      <span class="hljs-number">4.40</span>s <span class="hljs-number">17.61</span>%  github.com/miekg/dns.(*response).Write
    <span class="hljs-number">0.01</span>s  <span class="hljs-number">0.04</span>% <span class="hljs-number">22.94</span>%      <span class="hljs-number">4.36</span>s <span class="hljs-number">17.45</span>%  github.com/miekg/dns.WriteToSessionUDP
    <span class="hljs-number">1.43</span>s  <span class="hljs-number">5.72</span>% <span class="hljs-number">28.66</span>%      <span class="hljs-number">4.30</span>s <span class="hljs-number">17.21</span>%  runtime.pcvalue
    <span class="hljs-number">0.01</span>s  <span class="hljs-number">0.04</span>% <span class="hljs-number">28.70</span>%      <span class="hljs-number">4.15</span>s <span class="hljs-number">16.61</span>%  runtime.newstack
    <span class="hljs-number">0.06</span>s  <span class="hljs-number">0.24</span>% <span class="hljs-number">28.94</span>%      <span class="hljs-number">4.09</span>s <span class="hljs-number">16.37</span>%  runtime.copystack
    <span class="hljs-number">0.01</span>s  <span class="hljs-number">0.04</span>% <span class="hljs-number">28.98</span>%      <span class="hljs-number">4.05</span>s <span class="hljs-number">16.21</span>%  net.(*UDPConn).WriteMsgUDP
    <span class="hljs-number">0.03</span>s  <span class="hljs-number">0.12</span>% <span class="hljs-number">29.10</span>%      <span class="hljs-number">4.04</span>s <span class="hljs-number">16.17</span>%  net.(*UDPConn).writeMsg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, </font></font><code>mallocgc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╡рд╣ рдЬрдЧрд╣ рд╣реИ рдЬрд╣рд╛рдВ рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдорджрдж рдорд┐рд▓рддреА рд╣реИ</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) svg mallocgc</code></pre><br>
<img src="https://habrastorage.org/webt/kz/yw/mb/kzywmb1pzaiw3x2h4aprdtzvl9c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рддрд░рдг рдХреЛ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>alloc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╡рд┐рдХрд▓реНрдк рдХрд╛ </font></font><code>alloc_object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд░реНрде рд╣реИ рдЖрд╡рдВрдЯрди рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛, рд╕реНрдореГрддрд┐ рдФрд░ рдЖрд╡рдВрдЯрди рд╕реНрдерд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдк рд╣реИрдВред</font></font><br>
 <br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> tool pprof -alloc_objects http:<span class="hljs-comment">//localhost:6060/debug/pprof/allocs</span><font></font>
(pprof) top -cum<font></font>
Active filters:<font></font>
  show=handler<font></font>
Showing nodes accounting <span class="hljs-keyword">for</span> <span class="hljs-number">58464353</span>, <span class="hljs-number">59.78</span>% of <span class="hljs-number">97803168</span> total<font></font>
Dropped <span class="hljs-number">1</span> node (cum &lt;= <span class="hljs-number">489015</span>)<font></font>
Showing top <span class="hljs-number">10</span> nodes out of <span class="hljs-number">19</span><font></font>
     flat  flat%   sum%        cum   cum%<font></font>
 <span class="hljs-number">15401215</span> <span class="hljs-number">15.75</span>% <span class="hljs-number">15.75</span>%   <span class="hljs-number">70279955</span> <span class="hljs-number">71.86</span>%  arvancloud/redins/handler.(*DnsRequestHandler).HandleRequest
  <span class="hljs-number">2392100</span>  <span class="hljs-number">2.45</span>% <span class="hljs-number">18.19</span>%   <span class="hljs-number">27198697</span> <span class="hljs-number">27.81</span>%  arvancloud/redins/handler.(*DnsRequestHandler).FindANAME
   <span class="hljs-number">711174</span>  <span class="hljs-number">0.73</span>% <span class="hljs-number">18.92</span>%   <span class="hljs-number">14936976</span> <span class="hljs-number">15.27</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Filter
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">18.92</span>%   <span class="hljs-number">14161410</span> <span class="hljs-number">14.48</span>%  arvancloud/redins/handler.(*DnsRequestHandler).Response
 <span class="hljs-number">14161410</span> <span class="hljs-number">14.48</span>% <span class="hljs-number">33.40</span>%   <span class="hljs-number">14161410</span> <span class="hljs-number">14.48</span>%  arvancloud/redins/handler.(*RequestContext).Response
  <span class="hljs-number">7284487</span>  <span class="hljs-number">7.45</span>% <span class="hljs-number">40.85</span>%   <span class="hljs-number">11118401</span> <span class="hljs-number">11.37</span>%  arvancloud/redins/handler.NewRequestContext
 <span class="hljs-number">10439697</span> <span class="hljs-number">10.67</span>% <span class="hljs-number">51.52</span>%   <span class="hljs-number">10439697</span> <span class="hljs-number">10.67</span>%  arvancloud/redins/handler.reverseZone
        <span class="hljs-number">0</span>     <span class="hljs-number">0</span>% <span class="hljs-number">51.52</span>%   <span class="hljs-number">10371430</span> <span class="hljs-number">10.60</span>%  arvancloud/redins/handler.(*DnsRequestHandler).FindZone
  <span class="hljs-number">2680723</span>  <span class="hljs-number">2.74</span>% <span class="hljs-number">54.26</span>%    <span class="hljs-number">8022046</span>  <span class="hljs-number">8.20</span>%  arvancloud/redins/handler.(*GeoIp).GetSameCountry
  <span class="hljs-number">5393547</span>  <span class="hljs-number">5.51</span>% <span class="hljs-number">59.78</span>%    <span class="hljs-number">5393547</span>  <span class="hljs-number">5.51</span>%  arvancloud/redins/handler.(*DnsRequestHandler).LoadLocation</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕реЗ, рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╣рдо рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЛ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЪреЗрдХ рдХрд░реЗрдВ: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд┐рдВрдЯрдл-рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди</font></font></b><br>
<br>
<pre><code class="go hljs">(pprof) list handleRequest<font></font>
Total: <span class="hljs-number">97803168</span>
ROUTINE ======================== main.handleRequest in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/redins.<span class="hljs-keyword">go</span>
  <span class="hljs-number">2555943</span>   <span class="hljs-number">83954299</span> (flat, cum) <span class="hljs-number">85.84</span>% of Total<font></font>
        .          .     <span class="hljs-number">35</span>: l          *handler.RateLimiter<font></font>
        .          .     <span class="hljs-number">36</span>: configFile <span class="hljs-keyword">string</span>
        .          .     <span class="hljs-number">37</span>:)<font></font>
        .          .     <span class="hljs-number">38</span>:<font></font>
        .          .     <span class="hljs-number">39</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handleRequest</span><span class="hljs-params">(w dns.ResponseWriter, r *dns.Msg)</span></span> {<font></font>
        .   <span class="hljs-number">11118401</span>     <span class="hljs-number">40</span>: context := handler.NewRequestContext(w, r)
  <span class="hljs-number">2555943</span>    <span class="hljs-number">2555943</span>     <span class="hljs-number">41</span>: logger.Default.Debugf(<span class="hljs-string">"handle request: [%d] %s %s"</span>, r.Id, context.RawName(), context.Type())<font></font>
        .          .     <span class="hljs-number">42</span>:<font></font>
        .          .     <span class="hljs-number">43</span>: <span class="hljs-keyword">if</span> l.CanHandle(context.IP()) {<font></font>
        .   <span class="hljs-number">70279955</span>     <span class="hljs-number">44</span>:  h.HandleRequest(context)<font></font>
        .          .     <span class="hljs-number">45</span>: } <span class="hljs-keyword">else</span> {<font></font>
        .          .     <span class="hljs-number">46</span>:  context.Response(dns.RcodeRefused)<font></font>
        .          .     <span class="hljs-number">47</span>: }<font></font>
        .          .     <span class="hljs-number">48</span>:}<font></font>
        .          .     <span class="hljs-number">49</span>:</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓рд╛рдЗрди 41 рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЬрдм рдбрд┐рдмрдЧрд┐рдВрдЧ рдмрдВрдж рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддрдм рднреА рдореЗрдореЛрд░реА рдХреЛ рд╡рд╣рд╛рдВ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рдЗрд╕реЗ рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд╕реНрдХреЗрдк рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЧреЛ рдПрд╕реНрдХреЗрдк рдПрдирд╛рд▓рд┐рд╕рд┐рд╕ рдЯреВрд▓ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХрдВрдкрд╛рдЗрд▓рд░ рдлреНрд▓реИрдЧ рд╣реИ</font></font><br>
<br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> build -gcflags <span class="hljs-string">'-m'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЖрдк рдПрдХ рдФрд░ рдореА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> build -gcflags <span class="hljs-string">'-m '</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреГрд╢реНрдп-рдПрдиреЛрдЯреЗрдЯ-рдлрд╝рд╛рдЗрд▓ рдХрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="go hljs">$ <span class="hljs-keyword">go</span> build -gcflags <span class="hljs-string">'-m'</span><font></font>
.<font></font>
.<font></font>
.<font></font>
../redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">39</span>:<span class="hljs-number">20</span>: leaking param: w<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">39</span>:<span class="hljs-number">42</span>: leaking param: r<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">41</span>:<span class="hljs-number">55</span>: r.MsgHdr.Id escapes to heap<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">41</span>:<span class="hljs-number">75</span>: context.RawName() escapes to heap<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">41</span>:<span class="hljs-number">91</span>: context.Request.Type() escapes to heap<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">41</span>:<span class="hljs-number">23</span>: handleRequest []<span class="hljs-keyword">interface</span> {} literal does not escape<font></font>
./redins.<span class="hljs-keyword">go</span>:<span class="hljs-number">219</span>:<span class="hljs-number">17</span>: leaking param: path<font></font>
.<font></font>
.<font></font>
.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ </font></font><code>Debugf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдвреЗрд░ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЗ рдХрд╛рд░рдг рд╣реИ </font></font><code>Debugf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(l *EventLogger)</span> <span class="hljs-title">Debugf</span><span class="hljs-params">(format <span class="hljs-keyword">string</span>, args ...<span class="hljs-keyword">interface</span>{})</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рднреА рдорд╛рдкрджрдВрдбреЛрдВ </font></font><code>args</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рдПрдХ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд </font><font style="vertical-align: inherit;">рдХрд░ </font><font style="vertical-align: inherit;">рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рд╣рдореЗрд╢рд╛ рдвреЗрд░ рдкрд░ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдпрд╛ рддреЛ рдбреАрдмрдЧ рд▓реЙрдЧ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рд╢реВрдиреНрдп рд╡рд┐рддрд░рдг рдХреЗ рд╕рд╛рде рд▓реЙрдЧ рдХреЗ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝реАрд░реЛрд▓реЙрдЧ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рднрд╛рдЧрдиреЗ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдЧреЛрд▓рдВрдЧ рдореЗрдВ рдЖрд╡рдВрдЯрди рдХрд╛ рдЖрд╡рдВрдЯрди"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрдЦреЗрдВ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ</font></font></b><br>
<br>
<pre><code class="go hljs">(pprof) list reverseZone<font></font>
Total: <span class="hljs-number">100817064</span>
ROUTINE ======================== arvancloud/redins/handler.reverseZone in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/handler/handler.<span class="hljs-keyword">go</span>
  <span class="hljs-number">6127746</span>   <span class="hljs-number">10379086</span> (flat, cum) <span class="hljs-number">10.29</span>% of Total<font></font>
        .          .    <span class="hljs-number">396</span>:  logger.Default.Warning(<span class="hljs-string">"log queue is full"</span>)<font></font>
        .          .    <span class="hljs-number">397</span>: }<font></font>
        .          .    <span class="hljs-number">398</span>:}<font></font>
        .          .    <span class="hljs-number">399</span>:<font></font>
        .          .    <span class="hljs-number">400</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseZone</span><span class="hljs-params">(zone <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">string</span></span> {<font></font>
        .    <span class="hljs-number">4251340</span>    <span class="hljs-number">401</span>: x := strings.Split(zone, <span class="hljs-string">"."</span>)<font></font>
        .          .    <span class="hljs-number">402</span>: <span class="hljs-keyword">var</span> y <span class="hljs-keyword">string</span>
        .          .    <span class="hljs-number">403</span>: <span class="hljs-keyword">for</span> i := <span class="hljs-built_in">len</span>(x) - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i-- {
  <span class="hljs-number">6127746</span>    <span class="hljs-number">6127746</span>    <span class="hljs-number">404</span>:  y += x[i] + <span class="hljs-string">"."</span>
        .          .    <span class="hljs-number">405</span>: }<font></font>
        .          .    <span class="hljs-number">406</span>: <span class="hljs-keyword">return</span> y<font></font>
        .          .    <span class="hljs-number">407</span>:}<font></font>
        .          .    <span class="hljs-number">408</span>:<font></font>
        .          .    <span class="hljs-number">409</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(h *DnsRequestHandler)</span> <span class="hljs-title">LoadZones</span><span class="hljs-params">()</span></span> {<font></font>
(pprof)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ рдЧреЛ рдореЗрдВ рдПрдХ рдкрдВрдХреНрддрд┐ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдп рд╣реИ, рдПрдХ рдЕрд╕реНрдерд╛рдпреА рд░реЗрдЦрд╛ рдмрдирд╛рдиреЗ рд╕реЗ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">Go 1.10 рд╕реЗ рд╢реБрд░реВ рдХрд░рдХреЗ, рдЖрдк рдЗрд╕реЗ </font></font><code>strings.Builder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) list reverseZone<font></font>
Total: <span class="hljs-number">93437002</span>
ROUTINE ======================== arvancloud/redins/handler.reverseZone in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/handler/handler.<span class="hljs-keyword">go</span>
        <span class="hljs-number">0</span>    <span class="hljs-number">7580611</span> (flat, cum)  <span class="hljs-number">8.11</span>% of Total<font></font>
        .          .    <span class="hljs-number">396</span>:  logger.Default.Warning(<span class="hljs-string">"log queue is full"</span>)<font></font>
        .          .    <span class="hljs-number">397</span>: }<font></font>
        .          .    <span class="hljs-number">398</span>:}<font></font>
        .          .    <span class="hljs-number">399</span>:<font></font>
        .          .    <span class="hljs-number">400</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseZone</span><span class="hljs-params">(zone <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">string</span></span> {<font></font>
        .    <span class="hljs-number">3681140</span>    <span class="hljs-number">401</span>: x := strings.Split(zone, <span class="hljs-string">"."</span>)<font></font>
        .          .    <span class="hljs-number">402</span>: <span class="hljs-keyword">var</span> sb strings.Builder<font></font>
        .    <span class="hljs-number">3899471</span>    <span class="hljs-number">403</span>: sb.Grow(<span class="hljs-built_in">len</span>(zone)+<span class="hljs-number">1</span>)<font></font>
        .          .    <span class="hljs-number">404</span>: <span class="hljs-keyword">for</span> i := <span class="hljs-built_in">len</span>(x) - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i-- {<font></font>
        .          .    <span class="hljs-number">405</span>:  sb.WriteString(x[i])<font></font>
        .          .    <span class="hljs-number">406</span>:  sb.WriteByte(<span class="hljs-string">'.'</span>)<font></font>
        .          .    <span class="hljs-number">407</span>: }<font></font>
        .          .    <span class="hljs-number">408</span>: <span class="hljs-keyword">return</span> sb.String()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдБрдХрд┐ рд╣рдо рдЙрд▓реНрдЯреЗ рд▓рд╛рдЗрди рдХреЗ рдореВрд▓реНрдп рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо </font></font><code>Split()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рдкреВрд░реА рд▓рд╛рдЗрди рдХреЛ рдлрд╝реНрд▓рд┐рдк рдХрд░рдХреЗ </font><font style="vertical-align: inherit;">рд╕рдорд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
 <br>
<pre><code class="go hljs">(pprof) list reverseZone<font></font>
Total: <span class="hljs-number">89094296</span>
ROUTINE ======================== arvancloud/redins/handler.reverseZone in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/handler/handler.<span class="hljs-keyword">go</span>
  <span class="hljs-number">3801168</span>    <span class="hljs-number">3801168</span> (flat, cum)  <span class="hljs-number">4.27</span>% of Total<font></font>
        .          .    <span class="hljs-number">400</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">reverseZone</span><span class="hljs-params">(zone <span class="hljs-keyword">string</span>)</span> []<span class="hljs-title">byte</span></span> {<font></font>
        .          .    <span class="hljs-number">401</span>: runes := []<span class="hljs-keyword">rune</span>(<span class="hljs-string">"."</span> + zone)<font></font>
        .          .    <span class="hljs-number">402</span>: <span class="hljs-keyword">for</span> i, j := <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(runes)<span class="hljs-number">-1</span>; i &lt; j; i, j = i+<span class="hljs-number">1</span>, j<span class="hljs-number">-1</span> {<font></font>
        .          .    <span class="hljs-number">403</span>:  runes[i], runes[j] = runes[j], runes[i]<font></font>
        .          .    <span class="hljs-number">404</span>: }
  <span class="hljs-number">3801168</span>    <span class="hljs-number">3801168</span>    <span class="hljs-number">405</span>: <span class="hljs-keyword">return</span> []<span class="hljs-keyword">byte</span>(<span class="hljs-keyword">string</span>(runes))<font></font>
        .          .    <span class="hljs-number">406</span>:}<font></font>
        .          .    <span class="hljs-number">407</span>:<font></font>
        .          .    <span class="hljs-number">408</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(h *DnsRequestHandler)</span> <span class="hljs-title">LoadZones</span><span class="hljs-params">()</span></span> {<font></font>
        .          .    <span class="hljs-number">409</span>: h.LastZoneUpdate = time.Now()<font></font>
        .          .    <span class="hljs-number">410</span>: zones, err := h.Redis.SMembers(<span class="hljs-string">"redins:zones"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрд╛рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sync.Pool</font></font></h3><br>
<pre><code class="go hljs">(pprof) list GetASN<font></font>
Total: <span class="hljs-number">69005282</span>
ROUTINE ======================== arvancloud/redins/handler.(*GeoIp).GetASN in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/handler/geoip.<span class="hljs-keyword">go</span>
  <span class="hljs-number">1146897</span>    <span class="hljs-number">1146897</span> (flat, cum)  <span class="hljs-number">1.66</span>% of Total<font></font>
        .          .    <span class="hljs-number">231</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GeoIp)</span> <span class="hljs-title">GetASN</span><span class="hljs-params">(ip net.IP)</span> <span class="hljs-params">(<span class="hljs-keyword">uint</span>, error)</span></span> {
  <span class="hljs-number">1146897</span>    <span class="hljs-number">1146897</span>    <span class="hljs-number">232</span>: <span class="hljs-keyword">var</span> record <span class="hljs-keyword">struct</span> {<font></font>
        .          .    <span class="hljs-number">233</span>:  AutonomousSystemNumber <span class="hljs-keyword">uint</span> <span class="hljs-string">`maxminddb:"autonomous_system_number"`</span>
        .          .    <span class="hljs-number">234</span>: }<font></font>
        .          .    <span class="hljs-number">235</span>: err := g.ASNDB.Lookup(ip, &amp;record)<font></font>
        .          .    <span class="hljs-number">236</span>: <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        .          .    <span class="hljs-number">237</span>:  logger.Default.Errorf(<span class="hljs-string">"lookup failed : %s"</span>, err)<font></font>
(pprof) list GetGeoLocation<font></font>
Total: <span class="hljs-number">69005282</span>
ROUTINE ======================== arvancloud/redins/handler.(*GeoIp).GetGeoLocation in /home/arash/<span class="hljs-keyword">go</span>/src/arvancloud/redins/handler/geoip.<span class="hljs-keyword">go</span>
  <span class="hljs-number">1376298</span>    <span class="hljs-number">3604572</span> (flat, cum)  <span class="hljs-number">5.22</span>% of Total<font></font>
        .          .    <span class="hljs-number">207</span>:<font></font>
        .          .    <span class="hljs-number">208</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GeoIp)</span> <span class="hljs-title">GetGeoLocation</span><span class="hljs-params">(ip net.IP)</span> <span class="hljs-params">(latitude <span class="hljs-keyword">float64</span>, longitude <span class="hljs-keyword">float64</span>, country <span class="hljs-keyword">string</span>, err error)</span></span> {<font></font>
        .          .    <span class="hljs-number">209</span>: <span class="hljs-keyword">if</span> !g.Enable || g.CountryDB == <span class="hljs-literal">nil</span> {<font></font>
        .          .    <span class="hljs-number">210</span>:  <span class="hljs-keyword">return</span>
        .          .    <span class="hljs-number">211</span>: }
  <span class="hljs-number">1376298</span>    <span class="hljs-number">1376298</span>    <span class="hljs-number">212</span>: <span class="hljs-keyword">var</span> record <span class="hljs-keyword">struct</span> {<font></font>
        .          .    <span class="hljs-number">213</span>:  Location <span class="hljs-keyword">struct</span> {<font></font>
        .          .    <span class="hljs-number">214</span>:   Latitude        <span class="hljs-keyword">float64</span> <span class="hljs-string">`maxminddb:"latitude"`</span>
        .          .    <span class="hljs-number">215</span>:   LongitudeOffset <span class="hljs-keyword">uintptr</span> <span class="hljs-string">`maxminddb:"longitude"`</span>
        .          .    <span class="hljs-number">216</span>:  } <span class="hljs-string">`maxminddb:"location"`</span>
        .          .    <span class="hljs-number">217</span>:  Country <span class="hljs-keyword">struct</span> {<font></font>
        .          .    <span class="hljs-number">218</span>:   ISOCode <span class="hljs-keyword">string</span> <span class="hljs-string">`maxminddb:"iso_code"`</span>
        .          .    <span class="hljs-number">219</span>:  } <span class="hljs-string">`maxminddb:"country"`</span>
        .          .    <span class="hljs-number">220</span>: }<font></font>
        .          .    <span class="hljs-number">221</span>: <span class="hljs-comment">// logger.Default.Debugf("ip : %s", ip)</span>
        .          .    <span class="hljs-number">222</span>: <span class="hljs-keyword">if</span> err := g.CountryDB.Lookup(ip, &amp;record); err != <span class="hljs-literal">nil</span> {<font></font>
        .          .    <span class="hljs-number">223</span>:  logger.Default.Errorf(<span class="hljs-string">"lookup failed : %s"</span>, err)<font></font>
        .          .    <span class="hljs-number">224</span>:  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err<font></font>
        .          .    <span class="hljs-number">225</span>: }<font></font>
        .    <span class="hljs-number">2228274</span>    <span class="hljs-number">226</span>: _ = g.CountryDB.Decode(record.Location.LongitudeOffset, &amp;longitude)<font></font>
        .          .    <span class="hljs-number">227</span>: <span class="hljs-comment">// logger.Default.Debug("lat = ", record.Location.Latitude, " lang = ", longitude, " country = ", record.Country.ISOCode)</span>
        .          .    <span class="hljs-number">228</span>: <span class="hljs-keyword">return</span> record.Location.Latitude, longitude, record.Country.ISOCode, <span class="hljs-literal">nil</span>
        .          .    <span class="hljs-number">229</span>:}<font></font>
        .          .    <span class="hljs-number">230</span>:<font></font>
        .          .    <span class="hljs-number">231</span>:<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GeoIp)</span> <span class="hljs-title">GetASN</span><span class="hljs-params">(ip net.IP)</span> <span class="hljs-params">(<span class="hljs-keyword">uint</span>, error)</span></span> {</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдпреЛрд▓реЛрдХреЗрд╢рди рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">
рд╣рдо </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдХреНрд╕рдорд┐рдбрдм</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рдВрд╕ </font><font style="vertical-align: inherit;">рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрди рдХрд╛рд░реНрдпреЛрдВ </font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк </font><font style="vertical-align: inherit;">рдореЗрдВ рд▓рд┐рдпрд╛ </font><font style="vertical-align: inherit;">рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛ рдерд╛, рдвреЗрд░ рд╢реВрдЯ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо </font></font><code>sync.Pool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рдж рдореЗрдВ рдкреБрди: </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдЪрдпрдирд┐рдд рд▓реЗрдХрд┐рди рдЕрдкреНрд░рдпреБрдХреНрдд рддрддреНрд╡реЛрдВ рдХреЗ рдХреИрд╢рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
 <br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> MMDBGeoLocation <span class="hljs-keyword">struct</span> {<font></font>
  Coordinations <span class="hljs-keyword">struct</span> {<font></font>
     Latitude        <span class="hljs-keyword">float64</span> <span class="hljs-string">`maxminddb:"latitude"`</span>
     Longitude       <span class="hljs-keyword">float64</span>
     LongitudeOffset <span class="hljs-keyword">uintptr</span> <span class="hljs-string">`maxminddb:"longitude"`</span>
  } <span class="hljs-string">`maxminddb:"location"`</span>
  Country <span class="hljs-keyword">struct</span> {<font></font>
     ISOCode <span class="hljs-keyword">string</span> <span class="hljs-string">`maxminddb:"iso_code"`</span>
  } <span class="hljs-string">`maxminddb:"country"`</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">type</span> MMDBASN <span class="hljs-keyword">struct</span> {<font></font>
  AutonomousSystemNumber <span class="hljs-keyword">uint</span> <span class="hljs-string">`maxminddb:"autonomous_system_number"`</span><font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GeoIp)</span> <span class="hljs-title">GetGeoLocation</span><span class="hljs-params">(ip net.IP)</span> <span class="hljs-params">(*MMDBGeoLocation, error)</span></span> {
  <span class="hljs-keyword">if</span> !g.Enable || g.CountryDB == <span class="hljs-literal">nil</span> {
     <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, EMMDBNotAvailable<font></font>
  }<font></font>
  <span class="hljs-keyword">var</span> record *MMDBGeoLocation = g.LocationPool.Get().(*MMDBGeoLocation)<font></font>
  logger.Default.Debugf(<span class="hljs-string">"ip : %s"</span>, ip)
  <span class="hljs-keyword">if</span> err := g.CountryDB.Lookup(ip, &amp;record); err != <span class="hljs-literal">nil</span> {<font></font>
     logger.Default.Errorf(<span class="hljs-string">"lookup failed : %s"</span>, err)
     <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<font></font>
  }<font></font>
  _ = g.CountryDB.Decode(record.Coordinations.LongitudeOffset, &amp;record.Coordinations.Longitude)<font></font>
  logger.Default.Debug(<span class="hljs-string">"lat = "</span>, record.Coordinations.Latitude, <span class="hljs-string">" lang = "</span>, record.Coordinations.Longitude, <span class="hljs-string">" country = "</span>, record.Country.ISOCode)
  <span class="hljs-keyword">return</span> record, <span class="hljs-literal">nil</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(g *GeoIp)</span> <span class="hljs-title">GetASN</span><span class="hljs-params">(ip net.IP)</span> <span class="hljs-params">(<span class="hljs-keyword">uint</span>, error)</span></span> {
  <span class="hljs-keyword">var</span> record *MMDBASN = g.AsnPool.Get().(*MMDBASN)<font></font>
  err := g.ASNDB.Lookup(ip, record)<font></font>
  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
     logger.Default.Errorf(<span class="hljs-string">"lookup failed : %s"</span>, err)
     <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, err<font></font>
  }<font></font>
  logger.Default.Debug(<span class="hljs-string">"asn = "</span>, record.AutonomousSystemNumber)
  <span class="hljs-keyword">return</span> record.AutonomousSystemNumber, <span class="hljs-literal">nil</span>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕рд┐рдВрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрдИ рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рдЕрдиреБрдХреВрд▓рди рд╣реИрдВ, рд▓реЗрдХрд┐рди рдлрд┐рд▓рд╣рд╛рд▓, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдкрд╣рд▓реЗ рд╣реА рдкрд░реНрдпрд╛рдкреНрдд рдХрд░ рдЪреБрдХреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдореЗрдореЛрд░реА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝реЗрд╢рди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдЖрдк </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдЪреНрдЪ-рдкреНрд░рджрд░реНрд╢рди рдЧреЛ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рдЖрд╡рдВрдЯрди рджрдХреНрд╖рддрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдо</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрдореЛрд░реА рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо </font></font><code>go tool trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"рдорд┐рдирд┐рдордо рдореНрдпреВрдЯреЗрдЯрд░ рдпреВрдЯрд┐рд▓рд╛рдЗрдЬреЗрд╢рди" рд╢реАрд░реНрд╖рдХ </font><font style="vertical-align: inherit;">рдореЗрдВ рдПрдХ рдЖрд░реЗрдЦ рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рдореНрдпреВрдЯреЗрдЯрд░ рдХрд╛ рдорддрд▓рдм рдЬреАрд╕реА рдирд╣реАрдВ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдиреБрдХреВрд▓рди рд╕реЗ рдкрд╣рд▓реЗ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k5/og/yd/k5ogydpov-6tpkxmulro0f8tkic.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреБрд╢рд▓ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд┐рдирд╛ рд▓рдЧрднрдЧ 500 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдХреА рдПрдХ рдЦрд┐рдбрд╝рдХреА рд╣реИ (рдЬреАрд╕реА рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рддрд╛ рд╣реИ), рдФрд░ рд╣рдореЗрдВ рд▓рдВрдмреЗ рд╕рдордп рдореЗрдВ 80% рдкреНрд░рднрд╛рд╡реА рдЙрдкрдпреЛрдЧ рдХрднреА рдирд╣реАрдВ рдорд┐рд▓реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рд╢реВрдиреНрдп рдкреНрд░рднрд╛рд╡реА рдЙрдкрдпреЛрдЧ рдХреА рд╡рд┐рдВрдбреЛ рдпрдерд╛рд╕рдВрднрд╡ рдЫреЛрдЯреА рд╣реЛ, рдФрд░ 100% рдЙрдкрдпреЛрдЧ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ, рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реЛ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6e/bt/5k/6ebt5k70pm7ufao23uln7b5dcgq.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд╖реНрдХрд░реНрд╖</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЧреЛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдмреЗрд╣рддрд░ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд╕реЗрд╡рд╛ рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рд╣рдорд╛рд░реЗ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдПрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреИрд░-рдЕрдиреБрдХреВрд▓рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИ рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдПрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдиреБрдХреВрд▓рд┐рдд рдПрдХ рд╣реИред</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдЙрдкрдпреЛрдЧреА рднреА рд╣реЛрдЧрд╛</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рдлрд╝реЙрд░реНрдо рдХрд░реЗрдВ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рднрд╛рд╡реА рдЬрд╛рдУ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЛ рдЖрдк рдЬрд▓реНрджреА рдЬрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдЪреНрдЪ рдкреНрд░рджрд░реНрд╢рди рд▓рд┐рдЦрдирд╛</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╕ рдЗрддрдирд╛ рд╣реАред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрд░реНрд╕</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдорд┐рд▓рддреЗ рд╣реИрдВ</font></a><font style="vertical-align: inherit;"> !</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi487922/index.html">рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдХреЛ рддреИрдирд╛рдд рдХрд░рдирд╛ рд╕реАрдЦрдирд╛ред рднрд╛рдЧ 1. рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдФрд░ рдбреЙрдХрд░</a></li>
<li><a href="../hi487924/index.html">рдХрд┐рдо рдбреЙрдЯрдХреЙрдо: рдкрдХрдбрд╝рд╛ рдЧрдпрд╛, рдСрдирд▓рд╛рдЗрди рд╕рдмрд╕реЗ рд╡рд╛рдВрдЫрд┐рдд рд╡реНрдпрдХреНрддрд┐ред рднрд╛рдЧ рей</a></li>
<li><a href="../hi487926/index.html">рд╢рд╛рд░реАрд░рд┐рдХ рд╢рд┐рдХреНрд╖рд╛ рдХреА рдЦреЛрдЬ рдореЗрдВ</a></li>
<li><a href="../hi487930/index.html">рд╡реНрдпрд╛рдЦреНрдпрд╛рди рд░рд╛рдд рдореИрдВ gamedev рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi487932/index.html">рдПрдХрддрд╛ (рдФрд░ рдЕрдиреНрдп рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ) рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╕рд╛рдорд╛рдиреНрдп рдирдХреНрд╢реЗ</a></li>
<li><a href="../hi487938/index.html">рдЙрджрд╛рд╣рд░рдг рдХрд╛рд░реНрдп рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рднрд╛рд╡рдХрд╛рд░-рдбреЛрдо рдХрд╛ рдкрд░рд┐рдЪрдп</a></li>
<li><a href="../hi487940/index.html">рдЖрд░ рдореЗрдВ рд░рд┐рдкреНрд░реЛрдбреНрдпреВрд╕рд┐рдпрд▓ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧред рдХреЛрдб рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдЕрд▓рдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ?</a></li>
<li><a href="../hi487944/index.html">рдКрд░реНрдЬрд╛ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдорд╢реАрди рд╕реАрдЦрдиреЗ, рдпрд╛ рди рдХреЗрд╡рд▓ рд╣рд░ рдХреЛрдИ рдХрд▓ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ</a></li>
<li><a href="../id486176/index.html">Memo Korespondensi Email Perusahaan</a></li>
<li><a href="../id486178/index.html">Berita FOSS No. 1 - ulasan berita sumber terbuka dan gratis untuk 27 Januari - 2 Februari 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>