<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•ºğŸ½ ğŸ£ ğŸŒ«ï¸ ä½¿ç”¨OffscreenCanvasåŠ é€Ÿå›¾è¡¨ ğŸ¥˜ ğŸ“— ğŸ¤¶ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å›¾è¡¨æ¸²æŸ“ä¼šä¸¥é‡å½±å“æµè§ˆå™¨ã€‚å°¤å…¶æ˜¯åœ¨å¤æ‚åº”ç”¨ç¨‹åºçš„ç•Œé¢ä¸­è¾“å‡ºä»£è¡¨å›¾è¡¨çš„å¤§é‡å…ƒç´ æ—¶ã€‚æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ç•Œé¢æ¥æ”¹å–„è¿™ç§æƒ…å†µï¼Œè¯¥ç•Œé¢å¯¹æµè§ˆå™¨OffscreenCanvasçš„æ”¯æŒç¨‹åº¦æ­£åœ¨é€æ¸æé«˜ã€‚å®ƒå…è®¸ä½¿ç”¨ç½‘ç»œå·¥ä½œäººå‘˜å°†å½¢æˆå¯è§å›¾åƒä¸­æ˜¾ç¤ºçš„å›¾åƒçš„ä»»åŠ¡ç§»äº¤ç»™å®ƒ<canvas>ã€‚ è¿™ç¯‡æ–‡ç« ï¼ˆæˆ‘ä»¬ä»Šå¤©å°†è¦ç¿»è¯‘çš„è¯‘æœ¬ï¼‰è‡´...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨OffscreenCanvasåŠ é€Ÿå›¾è¡¨</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/496960/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾è¡¨æ¸²æŸ“ä¼šä¸¥é‡å½±å“æµè§ˆå™¨ã€‚</font><font style="vertical-align: inherit;">å°¤å…¶æ˜¯åœ¨å¤æ‚åº”ç”¨ç¨‹åºçš„ç•Œé¢ä¸­è¾“å‡ºä»£è¡¨å›¾è¡¨çš„å¤§é‡å…ƒç´ æ—¶ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ç•Œé¢æ¥æ”¹å–„è¿™ç§æƒ…å†µï¼Œè¯¥ç•Œé¢</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">å¯¹</font></a><font style="vertical-align: inherit;">æµè§ˆå™¨</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”¯æŒç¨‹åº¦</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­£åœ¨é€æ¸æé«˜ã€‚</font><font style="vertical-align: inherit;">å®ƒå…è®¸ä½¿ç”¨ç½‘ç»œå·¥ä½œäººå‘˜å°†å½¢æˆå¯è§å›¾åƒä¸­æ˜¾ç¤ºçš„å›¾åƒçš„ä»»åŠ¡ç§»äº¤ç»™å®ƒ</font></font><code>&lt;canvas&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">
è¿™ç¯‡æ–‡ç« ï¼ˆæˆ‘ä»¬ä»Šå¤©å°†è¦ç¿»è¯‘çš„è¯‘æœ¬ï¼‰è‡´åŠ›äºä½¿ç”¨æ¥å£</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸ºä»€ä¹ˆéœ€è¦æ­¤æ¥å£ï¼Œä½¿ç”¨è¯¥æ¥å£çš„å®é™…æœŸæœ›ä»¥åŠä½¿ç”¨è¯¥æ¥å£å¯èƒ½é‡åˆ°çš„å›°éš¾ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/mi/x3/fs/mix3fsxq_7zuda10gqvxuhwmw1u.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆè¦æ³¨æ„OffscreenCanvasï¼Ÿ</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»˜åˆ¶å›¾æ—¶æ¶‰åŠçš„ä»£ç æœ¬èº«å¯èƒ½å…·æœ‰è¶³å¤Ÿé«˜çš„è®¡ç®—å¤æ‚åº¦ã€‚åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¸å¤šåœ°æ–¹ï¼Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯ä»¥æ‰¾åˆ°æœ‰å…³å¦‚ä½•æ˜¾ç¤ºå¹³æ»‘åŠ¨ç”»ä»¥åŠå¦‚ä½•ç¡®ä¿ç”¨æˆ·ä¸é¡µé¢è¿›è¡Œæ–¹ä¾¿äº¤äº’çš„è¯¦ç»†æ•…äº‹ï¼Œä¸€å¸§çš„æ¸²æŸ“å¿…é¡»åœ¨å¤§çº¦10æ¯«ç§’å†…é€‚åº”ï¼Œè¿™æ ·æ‚¨æ‰èƒ½è¾¾åˆ°æ¯ç§’60å¸§ã€‚å¦‚æœè¾“å‡ºä¸€å¸§æ‰€éœ€çš„è®¡ç®—èŠ±è´¹10æ¯«ç§’ä»¥ä¸Šï¼Œè¿™å°†å¯¼è‡´é¡µé¢çš„æ˜æ˜¾â€œå‡é€Ÿâ€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œåœ¨æ˜¾ç¤ºå›¾æ—¶ï¼Œä»¥ä¸‹æƒ…å†µä¼šåŠ å‰§è¿™ç§æƒ…å†µï¼š</font></font><br>
<br>
<ul>
<li>        â€”   - (SVG, canvas, WebGL)      ,     ,       .</li>
<li>     , ,        ,  ,  10 .          ( â€”   )     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™äº›é—®é¢˜æ˜¯ç§°ä¸ºåˆ†è€Œæ²»ä¹‹çš„ç»å…¸ä¼˜åŒ–æ–¹æ³•çš„ç†æƒ³é€‰æ‹©ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨è®¨è®ºè·¨å¤šä¸ªçº¿ç¨‹çš„è®¡ç®—è´Ÿè½½åˆ†é…ã€‚ä½†æ˜¯ï¼Œåœ¨ç•Œé¢å‡ºç°ä¹‹å‰ï¼Œ</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰æ¸²æŸ“ä»£ç éƒ½éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œã€‚æ­¤ä»£ç å¯ä»¥ä½¿ç”¨æ‰€éœ€APIçš„å”¯ä¸€æ–¹æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»æŠ€æœ¯è§’åº¦æ¥çœ‹ï¼Œâ€œç¹é‡çš„â€è®¡ç®—å¯ä»¥æ›´æ—©åœ°è¾“å‡ºåˆ°Web Workerçº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œç”±äºå¿…é¡»ä»ä¸»æµè¿›è¡Œè´Ÿè´£æ¸²æŸ“çš„è°ƒç”¨ï¼Œå› æ­¤éœ€è¦åœ¨å›¾è¡¨è¾“å‡ºä»£ç ä¸­çš„å·¥ä½œæµå’Œä¸»æµä¹‹é—´ä½¿ç”¨å¤æ‚çš„æ¶ˆæ¯äº¤æ¢æ–¹æ¡ˆã€‚è€Œä¸”ï¼Œè¿™ç§æ–¹æ³•é€šå¸¸åªä¼šå¸¦æ¥è½»å¾®çš„æ€§èƒ½æå‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§„æ ¼</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§</font></font><code>&lt;canvas&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨Web Workerä¸­å°†</font><font style="vertical-align: inherit;">è¡¨é¢æ§åˆ¶è½¬ç§»åˆ°æ˜¾ç¤ºå…ƒç´ å›¾å½¢çš„æœºåˆ¶</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">Chromeå’ŒEdgeæµè§ˆå™¨å½“å‰æ”¯æŒè¯¥è§„èŒƒï¼ˆå°†Edgeè¿ç§»åˆ°Chromiumä¹‹åï¼‰ã€‚</font><font style="vertical-align: inherit;">é¢„è®¡</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†åœ¨å…­ä¸ªæœˆå†…å‡ºç°</font><font style="vertical-align: inherit;">å¯¹Firefoxçš„æ”¯æŒ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬è°ˆè®ºçš„æ˜¯Safariï¼Œåˆ™å°šä¸æ¸…æ¥šæ˜¯å¦è®¡åˆ’åœ¨æ­¤æµè§ˆå™¨ä¸­æ”¯æŒè¯¥æŠ€æœ¯ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨OffscreenCanvasè¾“å‡ºå›¾è¡¨</font></font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e83/fe3/cf3/e83fe3cf3d366175052d1b6e66a65f93.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¾ç¤º100,000ä¸ªå½©è‰²ç‚¹çš„å›¾è¡¨ç¤ºä¾‹</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ä¸ºäº†æ›´å¥½åœ°è¯„ä¼°æ½œåœ¨çš„ä¼˜ç¼ºç‚¹</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­æ˜¾ç¤ºçš„â€œé‡â€å›¾çš„è¾“å‡ºç¤ºä¾‹ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> offscreenCanvas = canvasContainer<font></font>
&nbsp;&nbsp;.querySelector(<span class="hljs-string">'canvas'</span>)<font></font>
&nbsp;&nbsp;.transferControlToOffscreen();<font></font>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">'worker.js'</span>);<font></font>
worker.postMessage({ offscreenCanvas }, [offscreenCanvas]);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬</font><font style="vertical-align: inherit;">ä½¿ç”¨newæ–¹æ³•</font><font style="vertical-align: inherit;">æŸ¥è¯¢</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…ƒç´ </font><font style="vertical-align: inherit;">ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼Œæ‰§è¡Œæ­¤æ“ä½œä»¥å°†åŒ…å«æŒ‡å‘çš„é“¾æ¥çš„æ¶ˆæ¯å‘é€ç»™å·¥ä½œç¨‹åº</font><font style="vertical-align: inherit;">ã€‚åœ¨è¿™é‡Œï¼Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‚¨éœ€è¦ä½¿ç”¨éå¸¸é‡è¦</font><font style="vertical-align: inherit;">ã€‚è¿™ä½¿æ‚¨å¯ä»¥ä½¿è¯¥å¯¹è±¡å·¥ä½œè€…æˆä¸ºæ‰€æœ‰è€…ï¼Œè¿™å°†ä½¿ä»–å¯ä»¥å•ç‹¬è¿›è¡Œç®¡ç†</font><font style="vertical-align: inherit;">ã€‚</font></font><code>canvas</code><font style="vertical-align: inherit;"></font><code>transferControlToOffscreen()</code><font style="vertical-align: inherit;"></font><code>worker.postMessage({ canvas: offscreenCanvas }, [offscreenCanvas])</code><font style="vertical-align: inherit;"></font><code>offscreenCanvas</code><font style="vertical-align: inherit;"></font><code>[offscreenCanvas]</code><font style="vertical-align: inherit;"></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="javascript hljs">canvasContainer.addEventListener(<span class="hljs-string">'measure'</span>, ({ detail }) =&gt; {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> { width, height } = detail;<font></font>
&nbsp;&nbsp;worker.postMessage({ width, height });<font></font>
});<font></font>
canvasContainer.requestRedraw();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è€ƒè™‘åˆ°å¤§å°</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åˆæ˜¯ä»å±æ€§</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…ƒç´ </font><font style="vertical-align: inherit;">ç»§æ‰¿çš„</font></font><code>canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå› æ­¤æ›´æ”¹å…ƒç´ çš„å°ºå¯¸æ—¶ä½¿è¿™äº›å€¼ä¿æŒæœ€æ–°æ˜¯æˆ‘ä»¬çš„è´£ä»»</font></font><code>canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨</font></font><code>measure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥è‡ª</font><font style="vertical-align: inherit;">çš„äº‹ä»¶</font></font><code>d3fc-canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¿™å°†ä½¿æˆ‘ä»¬æœ‰æœºä¼šä¸</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·¥ä½œäººå‘˜äº¤æµæœ‰å…³å…ƒç´ çš„æ–°å°ºå¯¸çš„ä¿¡æ¯</font></font><code>canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d3fc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“ä¸­çš„ç»„ä»¶</font><font style="vertical-align: inherit;">ã€‚è¿™æ˜¯ä¸€ç»„è¾…åŠ©ç»„ä»¶ï¼Œå®ƒä»¬å¯ä»¥é›†åˆd3ç»„ä»¶æˆ–è¡¥å……å…¶åŠŸèƒ½ã€‚æ‚¨</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥</font><font style="vertical-align: inherit;">ä½¿ç”¨</font><font style="vertical-align: inherit;">ä¸å¸¦d3fcç»„ä»¶çš„äº§å“ã€‚å¯ä»¥ä½¿ç”¨ä¸“æœ‰çš„æ ‡å‡†JavaScriptåŠŸèƒ½å®Œæˆæ‰€æœ‰è®¨è®ºã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è½¬åˆ°æ–‡ä»¶ä¸­çš„ä»£ç </font></font><code>worker.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä¸ºäº†å®é™…æ¸²æŸ“æ€§èƒ½ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨WebGLã€‚</font></font><br>
<br>
<pre><code class="javascript hljs">addEventListener(<span class="hljs-string">'message'</span>, ({ <span class="hljs-attr">data</span>: { offscreenCanvas, width, height } }) =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (offscreenCanvas != <span class="hljs-literal">null</span>) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> gl = offscreenCanvas.getContext(<span class="hljs-string">'webgl'</span>);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;series.context(gl);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;series(data);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (width != <span class="hljs-literal">null</span> &amp;&amp; height != <span class="hljs-literal">null</span>) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> gl = series.context();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gl.canvas.width = width;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gl.canvas.height = height;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gl.viewport(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gl.canvas.width, gl.canvas.height);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æˆ‘ä»¬æ”¶åˆ°åŒ…å«propertyçš„æ¶ˆæ¯æ—¶</font></font><code>canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬å‡å®šè¯¥æ¶ˆæ¯æ¥è‡ªä¸»çº¿ç¨‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»å…ƒç´ è·å–</font></font><code>canvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šä¸‹æ–‡</font></font><code>webgl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å°†å…¶ä¼ é€’ç»™component </font></font><code>series</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ç„¶åï¼Œæˆ‘ä»¬è°ƒç”¨è¯¥ç»„ä»¶</font></font><code>series</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">å¹¶å‘å…¶</font><font style="vertical-align: inherit;">ä¼ é€’</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ä½¿ç”¨å®ƒå‘ˆç°</font><font style="vertical-align: inherit;">çš„æ•°æ®ï¼ˆ</font><font style="vertical-align: inherit;">ï¼‰ï¼ˆä¸‹é¢å°†è®¨è®ºç›¸åº”å˜é‡çš„</font><font style="vertical-align: inherit;">æ¥æº</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦å¤–ï¼Œæˆ‘ä»¬æ£€æŸ¥æ¶ˆæ¯ä¸­çš„å±æ€§</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥è®¾ç½®</font><font style="vertical-align: inherit;">WebGL </font><font style="vertical-align: inherit;">çš„å°ºå¯¸</font></font><code>offscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸ¥çœ‹åŒºåŸŸ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚é“¾æ¥</font></font><code>offscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ç›´æ¥ä½¿ç”¨ã€‚äº‹å®æ˜¯è¯¥æ¶ˆæ¯åŒ…å«ä¸€ä¸ª</font></font><code>offscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ–å¤šä¸ªå±æ€§</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¶ä½™çš„å·¥ä½œç¨‹åºä»£ç è´Ÿè´£è®¾ç½®æˆ‘ä»¬è¦è¾“å‡ºçš„å†…å®¹çš„å‘ˆç°ã€‚</font><font style="vertical-align: inherit;">è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨ç†Ÿæ‚‰æ‰€æœ‰è¿™äº›å†…å®¹ï¼Œåˆ™å¯ä»¥ç«‹å³è¿›å…¥ä¸‹ä¸€èŠ‚è®¨è®ºæ€§èƒ½çš„éƒ¨åˆ†ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> randomNormal = d3.randomNormal(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
<span class="hljs-keyword">const</span> randomLogNormal = d3.randomLogNormal();<font></font>
<font></font>
<span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1e5</span> }, () =&gt; ({
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">x</span>: randomNormal(),
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">y</span>: randomNormal(),
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">size</span>: randomLogNormal() * <span class="hljs-number">10</span><font></font>
}));<font></font>
<font></font>
<span class="hljs-keyword">const</span> xScale = d3.scaleLinear().domain([<span class="hljs-number">-5</span>, <span class="hljs-number">5</span>]);<font></font>
<font></font>
<span class="hljs-keyword">const</span> yScale = d3.scaleLinear().domain([<span class="hljs-number">-5</span>, <span class="hljs-number">5</span>]);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«å›´ç»•åŸç‚¹x / yéšæœºåˆ†å¸ƒçš„ç‚¹çš„åæ ‡ï¼Œå¹¶è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä¸ä½¿ç”¨è¯¥æ–¹æ³•è®¾ç½®xå’Œyå€¼çš„èŒƒå›´</font></font><code>range</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå› ä¸ºWebGLç³»åˆ—</font></font><code>canvas</code> <code>(-1 -&gt; +1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è®¾å¤‡çš„æ ‡å‡†åŒ–åæ ‡ä¸­ä»¥</font><font style="vertical-align: inherit;">å…ƒç´ çš„å®Œæ•´å°ºå¯¸æ˜¾ç¤º</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> series = fc<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.seriesWebglPoint()<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.xScale(xScale)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.yScale(yScale)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.crossValue(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> d.x)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.mainValue(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> d.y)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.size(<span class="hljs-function"><span class="hljs-params">d</span> =&gt;</span> d.size)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.equals(<span class="hljs-function">(<span class="hljs-params">previousData, data</span>) =&gt;</span> previousData.length &gt; <span class="hljs-number">0</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨</font></font><code>xScale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font><font style="vertical-align: inherit;">è®¾ç½®ä¸€ç³»åˆ—ç‚¹</font></font><code>yScale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œæˆ‘ä»¬é…ç½®å…è®¸æ‚¨è¯»å–æ•°æ®çš„é€‚å½“è®¿é—®æ–¹å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œæˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„ç›¸ç­‰æ€§æ£€æŸ¥åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½æ—¨åœ¨ç¡®ä¿ç»„ä»¶</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶</font><font style="vertical-align: inherit;">éƒ½ä¸ä¼šä¼ è¾“</font><font style="vertical-align: inherit;">GPUã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¿…é¡»æ˜ç¡®è¡¨ç¤ºè¿™ä¸€ç‚¹ï¼Œå› ä¸ºå³ä½¿æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬ä¸ä¼šä¿®æ”¹æ­¤æ•°æ®ï¼Œè¯¥ç»„ä»¶ä¹Ÿæ— æ³•åœ¨ä¸æ‰§è¡Œèµ„æºå¯†é›†å‹â€œè„â€æ£€æŸ¥çš„æƒ…å†µä¸‹çŸ¥é“å®ƒã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> colorScale = d3.scaleOrdinal(d3.schemeAccent);<font></font>
<font></font>
<span class="hljs-keyword">const</span> webglColor = <span class="hljs-function"><span class="hljs-params">color</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> { r, g, b, opacity } = d3.color(color).rgb();
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> [r / <span class="hljs-number">255</span>, g / <span class="hljs-number">255</span>, b / <span class="hljs-number">255</span>, opacity];<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">const</span> fillColor = fc<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.webglFillColor()<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.value(<span class="hljs-function">(<span class="hljs-params">d, i</span>) =&gt;</span> webglColor(colorScale(i)))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;.data(data);<font></font>
<font></font>
series.decorate(<span class="hljs-function"><span class="hljs-params">program</span> =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fillColor(program);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤ä»£ç ä½¿æ‚¨å¯ä»¥ä¸ºå›¾è¡¨ç€è‰²ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†ä¸­çš„ç‚¹çš„ç´¢å¼•ä»ä¸­é€‰æ‹©åˆé€‚çš„é¢œè‰²</font></font><code>colorScale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºæ‰€éœ€çš„æ ¼å¼ï¼Œå¹¶ç”¨å®ƒæ¥è£…é¥°è¾“å‡ºç‚¹ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> ease = <span class="hljs-number">5</span> * (<span class="hljs-number">0.51</span> + <span class="hljs-number">0.49</span> * <span class="hljs-built_in">Math</span>.sin(<span class="hljs-built_in">Date</span>.now() / <span class="hljs-number">1e3</span>));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;xScale.domain([-ease, ease]);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;yScale.domain([-ease, ease]);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;series(data);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;requestAnimationFrame(render);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œç‚¹å·²ç€è‰²ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸ºå›¾è¡¨åˆ¶ä½œåŠ¨ç”»äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ªå¸¸é‡æ–¹æ³•è°ƒç”¨</font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æ­¤å¤–ï¼Œè¿™è¿˜ä¼šç»™ç³»ç»Ÿé€ æˆä¸€å®šçš„è´Ÿæ‹…ã€‚æˆ‘ä»¬ä½¿ç”¨</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿®æ”¹å±æ€§</font></font><code>xScale.domain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>yScale.domain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯ä¸€å¸§</font><font style="vertical-align: inherit;">æ¥</font><font style="vertical-align: inherit;">æ¨¡æ‹Ÿå›¾è¡¨çš„å¢åŠ å’Œå‡å°‘</font><font style="vertical-align: inherit;">ã€‚åœ¨æ­¤åº”ç”¨å’Œè®¡ç®—ä¸æ—¶é—´æœ‰å…³çš„å€¼ï¼Œä»¥ä¾¿å›¾è¡¨çš„æ¯”ä¾‹å¹³æ»‘å˜åŒ–ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†æ¶ˆæ¯å¤´ï¼Œä»¥ä¾¿è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ä»¥å¼€å§‹å‘ˆç°å‘¨æœŸ</font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»è€Œä¸å¿…ç›´æ¥è°ƒç”¨</font></font><code>series(data)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs">importScripts(
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-array/dist/d3-array.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-collection/dist/d3-collection.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-color/dist/d3-color.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-interpolate/dist/d3-interpolate.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-scale-chromatic/dist/d3-scale-chromatic.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-random/dist/d3-random.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-scale/dist/d3-scale.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3-shape/dist/d3-shape.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3fc-extent/build/d3fc-extent.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3fc-random-data/build/d3fc-random-data.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3fc-rebind/build/d3fc-rebind.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3fc-series/build/d3fc-series.js'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">'./node_modules/d3fc-webgl/build/d3fc-webgl.js'</span><font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ä½¿è¯¥ç¤ºä¾‹æ­£å¸¸å·¥ä½œï¼Œä»…éœ€å°†å¿…éœ€çš„åº“å¯¼å…¥å·¥ä½œå™¨ä¸­ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä¸ºæ­¤ä½¿ç”¨</font></font><code>importScripts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä¸”ä¸ºäº†ä¸ä½¿ç”¨æ„å»ºé¡¹ç›®çš„å·¥å…·ï¼Œæˆ‘ä»¬ä½¿ç”¨æ‰‹åŠ¨ç¼–è¯‘çš„ä¾èµ–é¡¹åˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ä»…ä¸‹è½½å®Œæ•´çš„d3 / d3fcæ„å»ºï¼Œå› ä¸ºå®ƒä»¬æ˜¯DOMä¾èµ–çš„ï¼Œå¹¶ä¸”æ— æ³•æ»¡è¶³å·¥ä½œç¨‹åºä¸­çš„éœ€æ±‚ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â†’æ­¤ç¤ºä¾‹çš„å®Œæ•´ä»£ç å¯ä»¥åœ¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">GitHub</font></a><font style="vertical-align: inherit;">ä¸Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°</font></font></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±å¹•å¤–ç”»å¸ƒå’Œæ€§èƒ½</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é¡¹ç›®ä¸­çš„åŠ¨ç”»ä½œå“å¾—ç›Šäº</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·¥äºº</font><font style="vertical-align: inherit;">çš„ä½¿ç”¨</font><font style="vertical-align: inherit;">ã€‚å³ä½¿ä¸»çº¿ç¨‹å¿™äºå…¶ä»–äº‹æƒ…ï¼Œè¿™ä¹Ÿå…è®¸å·¥ä½œäººå‘˜å‘ˆç°é¡µé¢ã€‚å¦‚æœæ‚¨æŸ¥çœ‹ä¸Š</font><font style="vertical-align: inherit;">ä¸€éƒ¨åˆ†ä¸­æè¿°</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">é¡µé¢</font></a><font style="vertical-align: inherit;">å¹¶å•å‡»æŒ‰é’®</font></font><code>Stop main thread</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä»¥ä¸‹äº‹å®ï¼šå½“æ˜¾ç¤ºæ¶ˆæ¯æ¡†æ—¶ï¼Œæ—¶é—´æˆ³ä¿¡æ¯çš„æ›´æ–°å°†åœæ­¢ã€‚ä¸»çº¿ç¨‹è¢«é˜»æ­¢ï¼Œä½†å›¾è¡¨åŠ¨ç”»ä¸ä¼šåœæ­¢ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f1a/3ce/c20/f1a3cec2086024dcbe24cedddf1a90e7.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®çª—å£</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»ä¸»æµæ¥æ”¶æ¶ˆæ¯æ¥ç»„ç»‡æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ä¸å›¾è¡¨äº¤äº’æˆ–é€šè¿‡ç½‘ç»œæ¥æ”¶æ–°æ•°æ®æ—¶ï¼Œå¯ä»¥å‘é€æ­¤ç±»äº‹ä»¶ã€‚ä½†æ˜¯ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå¦‚æœä¸»çº¿ç¨‹å¿™äºå¤„ç†æŸäº›äº‹æƒ…ï¼Œè€Œåœ¨å·¥ä½œè¿›ç¨‹ä¸­æœªæ”¶åˆ°ä»»ä½•æ¶ˆæ¯ï¼Œåˆ™æ¸²æŸ“å°†åœæ­¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿçš„æƒ…å†µä¸‹è¿ç»­æ¸²æŸ“å›¾è¡¨æ˜¯ç”¨å—¡å—¡ä½œå“çš„é£æ‰‡å’Œä½ç”µé‡ä½¿ç”¨æˆ·çƒ¦æ¼çš„å¥½æ–¹æ³•ã€‚ç»“æœæ˜¯ï¼Œåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œå¦‚ä½•åœ¨ä¸»çº¿ç¨‹å’Œå·¥ä½œçº¿ç¨‹ä¹‹é—´åˆ’åˆ†è´£ä»»çš„å†³å®šå–å†³äºå·¥ä½œäººå‘˜åœ¨æœªä»ä¸»çº¿ç¨‹æ¥æ”¶åˆ°æœ‰å…³æƒ…å†µå˜åŒ–çš„æ¶ˆæ¯æ—¶æ˜¯å¦å¯ä»¥æä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæˆ‘ä»¬è°ˆè®ºçº¿ç¨‹ä¹‹é—´çš„æ¶ˆæ¯ä¼ è¾“ï¼Œåˆ™åº”æ³¨æ„ï¼Œæ­¤å¤„æˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§éå¸¸ç®€å•çš„æ–¹æ³•ã€‚è€å®è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨çº¿ç¨‹ä¹‹é—´ä¼ è¾“å¾ˆå°‘çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥æˆ‘å®æ„¿ç§°æˆ‘ä»¬çš„æ–¹æ³•æ˜¯å®ç”¨ä¸»ä¹‰è€Œä¸æ˜¯æ‡’æƒ°çš„ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è°ˆè®ºçš„æ˜¯å®é™…åº”ç”¨ï¼Œåˆ™å¯ä»¥æ³¨æ„åˆ°ï¼Œå¦‚æœç”¨æˆ·ä¸å›¾è¡¨çš„äº¤äº’ä»¥åŠå¯è§†åŒ–æ•°æ®çš„æ›´æ–°å°†å–å†³äºå®ƒä»¬ï¼Œåˆ™æµä¹‹é—´çš„æ¶ˆæ¯ä¼ è¾“æ–¹æ¡ˆå°†å˜å¾—æ›´åŠ å¤æ‚ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥ä½¿ç”¨æ ‡å‡†</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">MessageChannel</font></a><font style="vertical-align: inherit;">æ¥å£åœ¨ä¸»çº¿ç¨‹å’Œå·¥ä½œ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">çº¿ç¨‹</font></a><font style="vertical-align: inherit;">ä¹‹é—´åˆ›å»ºå•ç‹¬çš„æ¶ˆæ¯é€šé“</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¿™äº›é€šé“ä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯ç”¨äºç‰¹å®šç±»åˆ«çš„æ¶ˆæ¯ï¼Œè¿™ä½¿å¾—å¤„ç†æ¶ˆæ¯æ›´åŠ å®¹æ˜“ã€‚ä½œä¸ºæ ‡å‡†æœºåˆ¶çš„æ›¿ä»£ï¼Œåƒ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comlink</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ ·çš„ç¬¬ä¸‰æ–¹åº“ä¹Ÿå¯ä»¥èµ·ä½œç”¨</font><font style="vertical-align: inherit;">ã€‚è¯¥åº“ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç†å¯¹è±¡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†é«˜çº§ç»†èŠ‚éšè—åœ¨é«˜çº§æ¥å£åé¢</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬çš„ç¤ºä¾‹çš„å¦ä¸€ä¸ªæœ‰è¶£ç‰¹å¾ï¼ˆå›é¡¾èµ·æ¥å¾ˆæ˜æ˜¾ï¼‰æ˜¯è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³å®ƒè€ƒè™‘åˆ°GPUèµ„æºï¼ˆä¸å…¶ä»–ç³»ç»Ÿèµ„æºä¸€æ ·ï¼‰å¹¶éæ— å°½çš„äº‹å®ã€‚å°†æ¸²æŸ“è½¬æ¢ä¸ºå·¥ä½œç¨‹åºå¯ä»¥ä½¿ä¸»çº¿ç¨‹è§£å†³å…¶ä»–é—®é¢˜ã€‚ä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œæµè§ˆå™¨éƒ½éœ€è¦ä½¿ç”¨GPUæ¥æ¸²æŸ“DOMä»¥åŠé€šè¿‡å¤šç§æ–¹å¼ç”Ÿæˆçš„å†…å®¹</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœå·¥ä½œäººå‘˜æ¶ˆè€—äº†æ‰€æœ‰GPUèµ„æºï¼Œåˆ™æ— è®ºåœ¨ä½•å¤„è¿›è¡Œæ¸²æŸ“ï¼Œä¸»åº”ç”¨ç¨‹åºçª—å£éƒ½å°†é‡åˆ°æ€§èƒ½é—®é¢˜ã€‚æ³¨æ„ç¤ºä¾‹ä¸­æ—¶é—´æˆ³æ›´æ–°é€Ÿåº¦éšç€æ˜¾ç¤ºç‚¹æ•°çš„å¢åŠ è€Œé™ä½ã€‚å¦‚æœæ‚¨æœ‰åŠŸèƒ½å¼ºå¤§çš„å›¾å½¢å¡ï¼Œåˆ™å¯èƒ½å¿…é¡»å¢åŠ æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ä¼ è¾“åˆ°é¡µé¢çš„ç‚¹æ•°ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¶…è¿‡æœ€å¤§å€¼100000çš„å€¼ï¼Œè¯¥å€¼æ˜¯é€šè¿‡ç¤ºä¾‹é¡µé¢ä¸Šçš„é“¾æ¥ä¹‹ä¸€æŒ‡å®šçš„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº”å½“æŒ‡å‡ºï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æ¢ç´¢</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ä¸Šä¸‹æ–‡å±æ€§</font></a><font style="vertical-align: inherit;">çš„ç§˜å¯†ä¸–ç•Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™æ ·çš„ç ”ç©¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜è§£å†³æ–¹æ¡ˆçš„ç”Ÿäº§ç‡ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œç”±äºå¯¹è¿™äº›å±æ€§çš„æ”¯æŒæ°´å¹³è¾ƒä½ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰è¿™æ ·åšã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæˆ‘ä»¬è®¨è®ºä½¿ç”¨æ¸²æŸ“</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™è¯¥å±æ€§åœ¨è¿™é‡Œçœ‹èµ·æ¥æœ€æœ‰è¶£</font></font><code>desynchronized</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨å—æ”¯æŒçš„åœ°æ–¹ï¼Œå¹¶ä¸”è€ƒè™‘åˆ°ä¸€äº›é™åˆ¶ï¼Œå®ƒä½¿æ‚¨å¯ä»¥æ‘†è„±äº‹ä»¶å¾ªç¯å’Œåœ¨å·¥ä½œç¨‹åºä¸­æ‰§è¡Œçš„å‘ˆç°å¾ªç¯ä¹‹é—´çš„åŒæ­¥ã€‚</font><font style="vertical-align: inherit;">è¿™æ ·å¯ä»¥æœ€å°åŒ–æ›´æ–°å›¾åƒçš„å»¶è¿Ÿã€‚</font><font style="vertical-align: inherit;">æœ‰å…³æ­¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‘˜è¦</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥ç•Œé¢</font></font><code>OffscreenCanvas</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ”¹å–„å›¾è¡¨å‘ˆç°æ€§èƒ½çš„æœºä¼šï¼Œä½†æ˜¯ä½¿ç”¨å®ƒéœ€è¦å‘¨åˆ°çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨å®ƒï¼Œæ‚¨éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</font></font><br>
<br>
<ul>
<li>     (,  ,     )  -        .<br>
<br>
<ul>
<li>  ,         .  ,   ,         ,    postMessage.</li>
</ul></li>
<li>,       (,  SVG/HTML-   <code>&lt;canvas&gt;</code>), ,   ,  .<br>
<br>
<ul>
<li>,  ,   ,      ,       ,   ,  ,  ,     .</li>
</ul></li>
<li>,     GPU,    <code>OffscreenCanvas</code>       .<br>
<br>
<ul>
<li>      OffscreenCanvas,        GPU-,     ,     .    ,    ,      .</li>
</ul></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¤ºä¾‹ä»£ç ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å…¶å·¥ä½œç‰ˆæœ¬ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº²çˆ±çš„è¯»è€…ä»¬ï¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨æ˜¯å¦ä½¿ç”¨OffscreenCanvasæ¥åŠ å¿«ç½‘é¡µä¸Šå›¾å½¢çš„æ˜¾ç¤ºï¼Ÿ</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496950/index.html">è®¾è®¡æ˜¯è®¾è®¡ï¼Œè€Œä¸æ˜¯å›¾ç‰‡çš„ç¾ã€‚</a></li>
<li><a href="../zh-CN496952/index.html">é«˜é€šQCC3020-ä¸­å›½TWSè€³æœºçš„å´›èµ·</a></li>
<li><a href="../zh-CN496954/index.html">Wargamingçš„å¼€å‘-ä¸å¹³å°è´Ÿè´£äººMaxim Baryshnikovä¼šæ™¤ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN496956/index.html">ä¸ºä»€ä¹ˆä¼šå‡ºç°å¼‚æ­¥WebæœåŠ¡å™¨ï¼Ÿ</a></li>
<li><a href="../zh-CN496958/index.html">æœ‰è¶£çš„CSSåœ¨æ–°çš„Facebookè®¾è®¡ä¸­å‘ç°</a></li>
<li><a href="../zh-CN496962/index.html">å¦‚ä½•æ•´ç†è¿‡è½½çš„æœåŠ¡å™¨ï¼Ÿ</a></li>
<li><a href="../zh-CN496964/index.html">IBMæ¯å‘¨ç ”è®¨ä¼š-2020å¹´4æœˆ</a></li>
<li><a href="../zh-CN496966/index.html">CSS LCHé¢œè‰²</a></li>
<li><a href="../zh-CN496968/index.html">é¢†å¯¼è€…åœ¨COVID-19æœŸé—´æ— æ³•åŸè°…çš„4ä¸ªåŠ¨ä½œ</a></li>
<li><a href="../zh-CN496972/index.html">2020å¹´é£Ÿå“å®‰å…¨è¶‹åŠ¿ã€‚å…è´¹åœ¨çº¿Mitap 4æœˆ21æ—¥</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>