<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèΩ üë©‚Äçüëß‚Äçüë¶ üì∏ Golang + Phaser3 = MMORPG - Wir bilden die Basis f√ºr die endlose Generation der Welt üßëüèΩ‚Äçü§ù‚Äçüßëüèª üß£ ‚òëÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es ist schwierig, die richtigen Informationen zu russischsprachigen Ressourcen zu finden. Vielleicht k√∂nnen Sie mit diesem Material einige der Grundla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Golang + Phaser3 = MMORPG - Wir bilden die Basis f√ºr die endlose Generation der Welt</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488752/"><img src="https://habrastorage.org/webt/op/4h/rr/op4hrrqfwq-r_zzrzymmna7sjau.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist schwierig, die richtigen Informationen zu russischsprachigen Ressourcen zu finden. Vielleicht k√∂nnen Sie mit diesem Material einige der Grundlagen f√ºr die Erstellung von Multiplayer-Spielen und mehr verstehen. </font><font style="vertical-align: inherit;">Ich plane, eine Reihe von Artikeln √ºber die Erstellung von 2.5D-MMORPG zu verfassen, dh in der Isometrie wird unsere Welt in prozedural erzeugte Abschnitte unterteilt, die aus Titeln bestehen. </font><font style="vertical-align: inherit;">Der Server wird in der Sprache Golang geschrieben, was mir perfekt geeignet erscheint. Der Client-Teil wird in JavaScript unter Verwendung des Frameworks - Phaser.js - ausgef√ºhrt</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erschaffe eine Weltgeneration</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und so werden wir in diesem Artikel einen Chunk-Generator f√ºr IMO auf dem Golang schreiben, wir werden Phaser vorerst nicht ber√ºcksichtigen. </font><font style="vertical-align: inherit;">F√ºr die prozedurale Generierung ben√∂tigen wir eine Rauschfunktion. Wir verwenden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlin Noise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ich empfehle, dass Sie diesen Artikel lesen und den Code f√ºr Go neu schreiben oder meine Version √ºbernehmen.</font></font><br>
<a name="habracut"></a> <br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlin.go</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-keyword">package</span> PerlinNoise<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"math"</span>
	<span class="hljs-string">"math/rand"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Noise</span><span class="hljs-params">(x, y <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {
	<span class="hljs-comment">//Coordinate left and top vertex square</span>
	left := <span class="hljs-keyword">float32</span>(math.Floor(<span class="hljs-keyword">float64</span>(x)))<font></font>
	top := <span class="hljs-keyword">float32</span>(math.Floor(<span class="hljs-keyword">float64</span>(y)))<font></font>
<font></font>
	<span class="hljs-comment">//Local coordinate</span><font></font>
	localPoinX := x - left<font></font>
	localPoiny := y - top<font></font>
<font></font>
	topLeft := getRandomVector(left, top)<font></font>
	topRight := getRandomVector(left+<span class="hljs-number">1</span>, top)<font></font>
	bottomLeft := getRandomVector(left, top+<span class="hljs-number">1</span>)<font></font>
	bottomRight := getRandomVector(left+<span class="hljs-number">1</span>, top+<span class="hljs-number">1</span>)
	<span class="hljs-comment">//      </span>
	DtopLeft := []<span class="hljs-keyword">float32</span>{localPoinX, localPoiny}<font></font>
	DtopRight := []<span class="hljs-keyword">float32</span>{localPoinX - <span class="hljs-number">1</span>, localPoiny}<font></font>
	DbottomLeft := []<span class="hljs-keyword">float32</span>{localPoinX, localPoiny - <span class="hljs-number">1</span>}<font></font>
	DbottomRight := []<span class="hljs-keyword">float32</span>{localPoinX - <span class="hljs-number">1</span>, localPoiny - <span class="hljs-number">1</span>}<font></font>
<font></font>
	<span class="hljs-comment">// </span><font></font>
	tx1 := dot(DtopLeft, topLeft)<font></font>
	tx2 := dot(DtopRight, topRight)<font></font>
	bx1 := dot(DbottomLeft, bottomLeft)<font></font>
	bx2 := dot(DbottomRight, bottomRight)<font></font>
<font></font>
	<span class="hljs-comment">//  </span><font></font>
	pointX := curve(localPoinX)<font></font>
	pointY := curve(localPoiny)<font></font>
<font></font>
	<span class="hljs-comment">//</span><font></font>
<font></font>
	tx := lerp(tx1, tx2, pointX)<font></font>
	bx := lerp(bx1, bx2, pointX)<font></font>
	tb := lerp(tx, bx, pointY)<font></font>
	<span class="hljs-keyword">return</span> tb<font></font>
<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getRandomVector</span><span class="hljs-params">(x, y <span class="hljs-keyword">float32</span>)</span> []<span class="hljs-title">float32</span></span> {<font></font>
	rand.Seed(<span class="hljs-keyword">int64</span>(x * y))<font></font>
	v := rand.Intn(<span class="hljs-number">3</span>)<font></font>
<font></font>
	<span class="hljs-keyword">switch</span> v {<font></font>
<font></font>
	<span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>}
	<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}
	<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">0</span>, <span class="hljs-number">1</span>}
	<span class="hljs-keyword">default</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>}<font></font>
<font></font>
	}<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dot</span><span class="hljs-params">(a []<span class="hljs-keyword">float32</span>, b []<span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> (a[<span class="hljs-number">0</span>]*b[<span class="hljs-number">0</span>] + b[<span class="hljs-number">1</span>]*a[<span class="hljs-number">1</span>])<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">lerp</span><span class="hljs-params">(a, b, c <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> a*(<span class="hljs-number">1</span>-c) + b*c<font></font>
<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">curve</span><span class="hljs-params">(t <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> (t * t * t * (t*(t*<span class="hljs-number">6</span><span class="hljs-number">-15</span>) + <span class="hljs-number">10</span>))<font></font>
<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns ein kleines Projekt erstellen, in dem wir die Funktionalit√§t unserer Funktion testen. Hier ist die Struktur meines Projekts: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/549/995/07f/54999507fc8c0e3c82b0ef6f20f24842.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºgen Sie der Datei main.go Folgendes hinzu:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-keyword">var</span> a, b <span class="hljs-keyword">float32</span>= <span class="hljs-number">1330</span>, <span class="hljs-number">2500</span>
	v:= PerlinNoise.Noise(a/<span class="hljs-number">2500</span>, b/<span class="hljs-number">2500</span>)<font></font>
	fmt.Println(v)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seien Sie vorsichtig mit den Arten von Zahlen, geben Sie die Typen immer explizit an, dies erspart Ihnen in Zukunft Probleme, die Ausgabe der Funktion: </font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">-0.23416707</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und so haben wir eine Rauschfunktion, um unsere Welten zu erzeugen. </font><font style="vertical-align: inherit;">Beginnen wir mit der Erstellung von Chunks. </font><font style="vertical-align: inherit;">Erstellen Sie das Chunk-Verzeichnis und die darin enthaltene Chunk.go-Datei und definieren Sie sofort die Hauptkonstanten:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">var</span> TILE_SIZE = <span class="hljs-number">16</span>
<span class="hljs-keyword">var</span> CHUNK_SIZE = TILE_SIZE * TILE_SIZE
<span class="hljs-keyword">var</span> PERLIN_SEED <span class="hljs-keyword">float32</span> = <span class="hljs-number">150</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TILE_SIZE ist die Aufl√∂sung unserer zuk√ºnftigen Chunks in Pixel. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CHUNK_SIZE ist die Gr√∂√üe des </font><font style="vertical-align: inherit;">Chunks </font><font style="vertical-align: inherit;">, in diesem Fall 16 * 16 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PERLIN_SEED. Hier k√∂nnen Sie eine beliebige Zahl eingeben. Je h√∂her diese ist, desto gleichm√§√üiger ist das Rauschen, d. H. </font><font style="vertical-align: inherit;">Wenn Sie kleine Inseln wollen, geben Sie die Zahl weniger ein, wenn die riesigen Kontinente h√∂her sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie als N√§chstes einen Datentyp f√ºr die Koordinaten:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Coordinate <span class="hljs-keyword">struct</span> {<font></font>
	X <span class="hljs-keyword">int</span> 
	Y <span class="hljs-keyword">int</span> 
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Typ wird f√ºr uns in Zukunft sehr n√ºtzlich sein, und jetzt werden wir eine weitere wichtige Funktion erstellen, um die eindeutigen Koordinaten unseres Chunks in Zukunft zu bestimmen. Wir werden ihre ID nennen:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetChunkID</span><span class="hljs-params">(x, y <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">Coordinate</span></span> {<font></font>
	tileX := <span class="hljs-keyword">float64</span>(<span class="hljs-keyword">float64</span>(x) / <span class="hljs-keyword">float64</span>(TILE_SIZE))<font></font>
	tileY := <span class="hljs-keyword">float64</span>(<span class="hljs-keyword">float64</span>(y) / <span class="hljs-keyword">float64</span>(TILE_SIZE))<font></font>
<font></font>
	<span class="hljs-keyword">var</span> ChunkID Coordinate
	<span class="hljs-keyword">if</span> tileX &lt; <span class="hljs-number">0</span> {<font></font>
		ChunkID.X = <span class="hljs-keyword">int</span>(math.Floor(tileX / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	} <span class="hljs-keyword">else</span> {<font></font>
		ChunkID.X = <span class="hljs-keyword">int</span>(math.Ceil(tileX / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileY &lt; <span class="hljs-number">0</span> {<font></font>
		ChunkID.Y = <span class="hljs-keyword">int</span>(math.Floor(tileY / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	} <span class="hljs-keyword">else</span> {<font></font>
		ChunkID.Y = <span class="hljs-keyword">int</span>(math.Ceil(tileY / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileX == <span class="hljs-number">0</span> {<font></font>
		ChunkID.X = <span class="hljs-number">1</span><font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileY == <span class="hljs-number">0</span> {<font></font>
		ChunkID.Y = <span class="hljs-number">1</span><font></font>
	}<font></font>
	<span class="hljs-keyword">return</span> ChunkID<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion zum Bestimmen der ID des Blocks ist recht einfach. Wir teilen einfach die Position auf der Karte durch die Gr√∂√üe der Kachel und dann das Ergebnis erneut durch die Gr√∂√üe der Kachel mit Auf- oder Abrunden, abh√§ngig von der ID des Blocks seitdem </font><font style="vertical-align: inherit;">Unsere Welt wird endlos in jede Richtung erzeugt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºgen Sie als N√§chstes unseren Baustein hinzu, um den Block zu erstellen. Dies ist die Kachel und der Block selbst:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Chunk <span class="hljs-keyword">struct</span> {<font></font>
	ChunkID [<span class="hljs-number">2</span>]<span class="hljs-keyword">int</span>
	Map     <span class="hljs-keyword">map</span>[Coordinate]Tile<font></font>
}<font></font>
<span class="hljs-keyword">type</span> Tile <span class="hljs-keyword">struct</span> {<font></font>
	Key <span class="hljs-keyword">string</span>
	X   <span class="hljs-keyword">int</span>
	Y   <span class="hljs-keyword">int</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Block enth√§lt eine Kachelkarte. </font><font style="vertical-align: inherit;">Kacheln speichern ihre Koordinaten und Schl√ºssel (der Schl√ºssel ist die Art Ihres Titels: Land, Wasser, Berge usw.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kommen wir nun zu den wichtigsten Funktionen zum Erstellen unseres Blocks. Ich habe meine Arbeitsfunktion aus dem Projekt √ºbernommen und sie f√ºr diesen Artikel ein wenig √ºberarbeitet:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">func NewChunk ()</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewChunk</span><span class="hljs-params">(idChunk Coordinate)</span> <span class="hljs-title">Chunk</span></span> {
	<span class="hljs-comment">//    </span>
	chunk := Chunk{ChunkID: [<span class="hljs-number">2</span>]<span class="hljs-keyword">int</span>{idChunk.X, idChunk.Y}}
	<span class="hljs-comment">//   </span>
	<span class="hljs-keyword">var</span> chunkXMax, chunkYMax <span class="hljs-keyword">int</span>
	<span class="hljs-comment">//    </span>
	<span class="hljs-keyword">var</span> chunkMap <span class="hljs-keyword">map</span>[Coordinate]Tile<font></font>
	chunkMap = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[Coordinate]Tile)
	<span class="hljs-comment">//     </span><font></font>
	chunkXMax = idChunk.X * CHUNK_SIZE<font></font>
	chunkYMax = idChunk.Y * CHUNK_SIZE<font></font>
	<span class="hljs-keyword">switch</span> {
	<span class="hljs-comment">//      </span>
	<span class="hljs-keyword">case</span> chunkXMax &lt; <span class="hljs-number">0</span> &amp;&amp; chunkYMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax + CHUNK_SIZE; x &gt; chunkXMax; x -= TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax + CHUNK_SIZE; y &gt; chunkYMax; y -= TILE_SIZE {
					<span class="hljs-comment">//     </span>
					posX := <span class="hljs-keyword">float32</span>(x - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.01</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span> <span class="hljs-comment">//</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.01</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span> <span class="hljs-comment">//</span><font></font>
<font></font>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span> <span class="hljs-comment">// </span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//  X </span>
	<span class="hljs-keyword">case</span> chunkXMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax + CHUNK_SIZE; x &gt; chunkXMax; x -= TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax - CHUNK_SIZE; y &lt; chunkYMax; y += TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
<font></font>
					tile := Tile{}<font></font>
<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span><font></font>
<font></font>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//  Y </span>
	<span class="hljs-keyword">case</span> chunkYMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax - CHUNK_SIZE; x &lt; chunkXMax; x += TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax + CHUNK_SIZE; y &gt; chunkYMax; y -= TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//   </span>
	<span class="hljs-keyword">default</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax - CHUNK_SIZE; x &lt; chunkXMax; x += TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax - CHUNK_SIZE; y &lt; chunkYMax; y += TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
<font></font>
	}<font></font>
<font></font>
	chunk.Map = chunkMap<font></font>
	<span class="hljs-keyword">return</span> chunk<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und so bestimmen wir in dieser Funktion oder besser gesagt im Konstruktor unseres Blocks die maximalen Koordinaten des Blocks, zu denen wir uns nacheinander bewegen und die Kacheln mit den erforderlichen Informationen f√ºllen. </font><font style="vertical-align: inherit;">ChunkMax wird auch ganz einfach bestimmt. Dazu multiplizieren wir die Chunk-ID mit ihrer Gr√∂√üe (CHUNK_SIZE), dh mit der ID {1; 1} sind unsere Koordinaten chunkXMax und chunkYMax 256. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In posX / posY bestimmen wir die Koordinaten zum Einf√ºgen unserer Grafiken:</font></font><br>
<br>
<pre><code class="go hljs">					posX := <span class="hljs-keyword">float32</span>(x + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Wir verwenden den Schalter, um die Logik abh√§ngig vom Wert der ID unseres Blocks auszuw√§hlen (es kann positive und negative Werte geben). </font><font style="vertical-align: inherit;">Der Schl√ºssel der Kachel bestimmt das Rauschen von Perlin. Wenn beispielsweise das Rauschen von Perlin unter 0 liegt, ist es Wasser, dar√ºber Land. </font><font style="vertical-align: inherit;">Wir machen das:</font></font><br>
<br>
<pre><code class="go hljs">					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span> <span class="hljs-comment">// </span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span> <span class="hljs-comment">// </span>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span> <span class="hljs-comment">// </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, wie unsere Funktion funktioniert, ersetzen Sie den Code in main durch den folgenden Inhalt:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	coord := Chunk.Coordinate{Y: <span class="hljs-number">1</span>, X: <span class="hljs-number">1</span>}<font></font>
	chunk := Chunk.NewChunk(coord)<font></font>
	m := chunk.Map<font></font>
	out := os.Stdout<font></font>
	<span class="hljs-keyword">for</span> y := <span class="hljs-number">8</span>; y &lt; <span class="hljs-number">16</span>*<span class="hljs-number">16</span>; y += <span class="hljs-number">16</span> {
		<span class="hljs-keyword">for</span> x := <span class="hljs-number">8</span>; x &lt; <span class="hljs-number">16</span>*<span class="hljs-number">16</span>; x += <span class="hljs-number">16</span> {<font></font>
			c := Chunk.Coordinate{X: x, Y: y}<font></font>
			out.Write([]<span class="hljs-keyword">byte</span>(m[c].Key))<font></font>
<font></font>
		}<font></font>
		out.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"\n"</span>))<font></font>
	}<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fazit:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">11</span>~~~<span class="hljs-number">11111111111</span>
<span class="hljs-number">11</span>~~~<span class="hljs-number">11111111111</span>
<span class="hljs-number">11</span>~~~~<span class="hljs-number">1111111111</span>
<span class="hljs-number">11</span>~~~~<span class="hljs-number">1111111111</span>
<span class="hljs-number">11</span>~~~~~<span class="hljs-number">111111111</span>
<span class="hljs-number">11</span>~~~~~~<span class="hljs-number">1111111</span>~
<span class="hljs-number">11</span>~~~~~~~~~<span class="hljs-number">11</span>~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~~~~~
<span class="hljs-number">11</span>~~~~~~~~~~<span class="hljs-number">1111</span>
<span class="hljs-number">11</span>~~~~~~~~~<span class="hljs-number">11111</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sieht gut aus, Sie k√∂nnen die Ausgabefunktion √§ndern und mit den Parametern spielen:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">111111111111111111111111111111</span>~~~~~~~<span class="hljs-number">11111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">111111111111111111111111111111</span>~~~~~~~<span class="hljs-number">11111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">111111111111111111111111111111</span>~~~~~~~<span class="hljs-number">11111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">111111111111111111111111111111</span>~~~~~~~~<span class="hljs-number">1111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">11111111111111111111111111111</span>~~~~~~~~~<span class="hljs-number">1111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~<span class="hljs-number">11111111111111111111111111111</span>~~~~~~~~~<span class="hljs-number">1111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~<span class="hljs-number">111111111111111111111111111</span>~~~~~~~~~~~<span class="hljs-number">111111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~<span class="hljs-number">111111111111111111111111111</span>~~~~~~~~~~~~<span class="hljs-number">11111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~<span class="hljs-number">1111111111111111111111111</span>~~~~~~~~~~~~~<span class="hljs-number">11111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~<span class="hljs-number">11111111111111111111111</span>~~~~~~~~~~~~~~~<span class="hljs-number">1111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~<span class="hljs-number">1111111111111111111111</span>~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111</span>~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111</span>~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111</span>~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111</span>~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1</span>
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111</span>~~~~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111</span>~~~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111</span>~~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111</span>~~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111</span>~~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111</span>~~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111</span>~~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111</span>~~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111</span>~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111</span>~~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111111</span>~~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111</span>~~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111</span>~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111</span>~~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111111111</span>~~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111111</span>~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111111</span>~~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~~
<span class="hljs-number">11111</span>~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111111</span>~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111111</span>~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111111111</span>~~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111111</span>~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111111111</span>~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">11111111111111111111111111111111111</span>~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111</span>~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">1111111111111111111111111111111111</span>~~
<span class="hljs-number">1111</span>~~~~~~~~~~~~~~~~~~~~~~~~~<span class="hljs-number">111111111111111111111111111111111</span>~~
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Code:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chunk.go</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-keyword">package</span> Chunk<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"PerlinNoise"</span>
	<span class="hljs-string">"math"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">var</span> TILE_SIZE = <span class="hljs-number">16</span>
<span class="hljs-keyword">var</span> CHUNK_SIZE = <span class="hljs-number">32</span> * <span class="hljs-number">32</span>
<span class="hljs-keyword">var</span> PERLIN_SEED <span class="hljs-keyword">float32</span> = <span class="hljs-number">600</span><font></font>
<font></font>
<span class="hljs-keyword">type</span> Coordinate <span class="hljs-keyword">struct</span> {<font></font>
	X <span class="hljs-keyword">int</span> <span class="hljs-string">`json:"x"`</span>
	Y <span class="hljs-keyword">int</span> <span class="hljs-string">`json:"y"`</span><font></font>
}<font></font>
<span class="hljs-keyword">type</span> Chunk <span class="hljs-keyword">struct</span> {<font></font>
	ChunkID [<span class="hljs-number">2</span>]<span class="hljs-keyword">int</span>
	Map     <span class="hljs-keyword">map</span>[Coordinate]Tile<font></font>
}<font></font>
<span class="hljs-keyword">type</span> Tile <span class="hljs-keyword">struct</span> {<font></font>
	Key <span class="hljs-keyword">string</span>
	X   <span class="hljs-keyword">int</span>
	Y   <span class="hljs-keyword">int</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetChunkID</span><span class="hljs-params">(x, y <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">Coordinate</span></span> {<font></font>
	tileX := <span class="hljs-keyword">float64</span>(x)<font></font>
	tileY := <span class="hljs-keyword">float64</span>(y)<font></font>
<font></font>
	<span class="hljs-keyword">var</span> ChunkID Coordinate
	<span class="hljs-keyword">if</span> tileX &lt; <span class="hljs-number">0</span> {<font></font>
		ChunkID.X = <span class="hljs-keyword">int</span>(math.Floor(tileX / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	} <span class="hljs-keyword">else</span> {<font></font>
		ChunkID.X = <span class="hljs-keyword">int</span>(math.Ceil(tileX / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileY &lt; <span class="hljs-number">0</span> {<font></font>
		ChunkID.Y = <span class="hljs-keyword">int</span>(math.Floor(tileY / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	} <span class="hljs-keyword">else</span> {<font></font>
		ChunkID.Y = <span class="hljs-keyword">int</span>(math.Ceil(tileY / <span class="hljs-keyword">float64</span>(TILE_SIZE)))<font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileX == <span class="hljs-number">0</span> {<font></font>
		ChunkID.X = <span class="hljs-number">1</span><font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> tileY == <span class="hljs-number">0</span> {<font></font>
		ChunkID.Y = <span class="hljs-number">1</span><font></font>
	}<font></font>
	<span class="hljs-keyword">return</span> ChunkID<font></font>
<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewChunk</span><span class="hljs-params">(idChunk Coordinate)</span> <span class="hljs-title">Chunk</span></span> {
	<span class="hljs-comment">//    </span>
	chunk := Chunk{ChunkID: [<span class="hljs-number">2</span>]<span class="hljs-keyword">int</span>{idChunk.X, idChunk.Y}}
	<span class="hljs-comment">//   </span>
	<span class="hljs-keyword">var</span> chunkXMax, chunkYMax <span class="hljs-keyword">int</span>
	<span class="hljs-comment">//    </span>
	<span class="hljs-keyword">var</span> chunkMap <span class="hljs-keyword">map</span>[Coordinate]Tile<font></font>
	chunkMap = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[Coordinate]Tile)
	<span class="hljs-comment">//     </span><font></font>
	chunkXMax = idChunk.X * CHUNK_SIZE<font></font>
	chunkYMax = idChunk.Y * CHUNK_SIZE<font></font>
	<span class="hljs-keyword">switch</span> {
	<span class="hljs-comment">//      </span>
	<span class="hljs-keyword">case</span> chunkXMax &lt; <span class="hljs-number">0</span> &amp;&amp; chunkYMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax + CHUNK_SIZE; x &gt; chunkXMax; x -= TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax + CHUNK_SIZE; y &gt; chunkYMax; y -= TILE_SIZE {
					<span class="hljs-comment">//     </span>
					posX := <span class="hljs-keyword">float32</span>(x - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.01</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span> <span class="hljs-comment">//</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.01</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span> <span class="hljs-comment">//</span><font></font>
<font></font>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span> <span class="hljs-comment">// </span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//  X </span>
	<span class="hljs-keyword">case</span> chunkXMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax + CHUNK_SIZE; x &gt; chunkXMax; x -= TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax - CHUNK_SIZE; y &lt; chunkYMax; y += TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
<font></font>
					tile := Tile{}<font></font>
<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span><font></font>
<font></font>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//  Y </span>
	<span class="hljs-keyword">case</span> chunkYMax &lt; <span class="hljs-number">0</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax - CHUNK_SIZE; x &lt; chunkXMax; x += TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax + CHUNK_SIZE; y &gt; chunkYMax; y -= TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y - (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-comment">//   </span>
	<span class="hljs-keyword">default</span>:<font></font>
		{<font></font>
			<span class="hljs-keyword">for</span> x := chunkXMax - CHUNK_SIZE; x &lt; chunkXMax; x += TILE_SIZE {
				<span class="hljs-keyword">for</span> y := chunkYMax - CHUNK_SIZE; y &lt; chunkYMax; y += TILE_SIZE {<font></font>
					posX := <span class="hljs-keyword">float32</span>(x + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					posY := <span class="hljs-keyword">float32</span>(y + (TILE_SIZE / <span class="hljs-number">2</span>))<font></font>
					tile := Tile{}<font></font>
					tile.X = <span class="hljs-keyword">int</span>(posX)<font></font>
					tile.Y = <span class="hljs-keyword">int</span>(posY)<font></font>
					perlinValue := PerlinNoise.Noise(posX/PERLIN_SEED, posY/PERLIN_SEED)<font></font>
					<span class="hljs-keyword">switch</span> {
					<span class="hljs-keyword">case</span> perlinValue &lt; <span class="hljs-number">-0.12</span>:<font></font>
						tile.Key = <span class="hljs-string">"~"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt;= <span class="hljs-number">-0.12</span> &amp;&amp; perlinValue &lt;= <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"1"</span>
					<span class="hljs-keyword">case</span> perlinValue &gt; <span class="hljs-number">0.5</span>:<font></font>
						tile.Key = <span class="hljs-string">"^"</span><font></font>
					}<font></font>
					chunkMap[Coordinate{X: tile.X, Y: tile.Y}] = tile<font></font>
<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
<font></font>
	}<font></font>
<font></font>
	chunk.Map = chunkMap<font></font>
	<span class="hljs-keyword">return</span> chunk<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlin.go</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-keyword">package</span> PerlinNoise<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"math"</span>
	<span class="hljs-string">"math/rand"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Noise</span><span class="hljs-params">(x, y <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {
	<span class="hljs-comment">//Coordinate left and top vertex square</span>
	left := <span class="hljs-keyword">float32</span>(math.Floor(<span class="hljs-keyword">float64</span>(x)))<font></font>
	top := <span class="hljs-keyword">float32</span>(math.Floor(<span class="hljs-keyword">float64</span>(y)))<font></font>
<font></font>
	<span class="hljs-comment">//Local coordinate</span><font></font>
	localPoinX := x - left<font></font>
	localPoiny := y - top<font></font>
<font></font>
	topLeft := getRandomVector(left, top)<font></font>
	topRight := getRandomVector(left+<span class="hljs-number">1</span>, top)<font></font>
	bottomLeft := getRandomVector(left, top+<span class="hljs-number">1</span>)<font></font>
	bottomRight := getRandomVector(left+<span class="hljs-number">1</span>, top+<span class="hljs-number">1</span>)
	<span class="hljs-comment">//      </span>
	DtopLeft := []<span class="hljs-keyword">float32</span>{localPoinX, localPoiny}<font></font>
	DtopRight := []<span class="hljs-keyword">float32</span>{localPoinX - <span class="hljs-number">1</span>, localPoiny}<font></font>
	DbottomLeft := []<span class="hljs-keyword">float32</span>{localPoinX, localPoiny - <span class="hljs-number">1</span>}<font></font>
	DbottomRight := []<span class="hljs-keyword">float32</span>{localPoinX - <span class="hljs-number">1</span>, localPoiny - <span class="hljs-number">1</span>}<font></font>
<font></font>
	<span class="hljs-comment">// </span><font></font>
	tx1 := dot(DtopLeft, topLeft)<font></font>
	tx2 := dot(DtopRight, topRight)<font></font>
	bx1 := dot(DbottomLeft, bottomLeft)<font></font>
	bx2 := dot(DbottomRight, bottomRight)<font></font>
<font></font>
	<span class="hljs-comment">//  </span><font></font>
	pointX := curve(localPoinX)<font></font>
	pointY := curve(localPoiny)<font></font>
<font></font>
	<span class="hljs-comment">//</span><font></font>
<font></font>
	tx := lerp(tx1, tx2, pointX)<font></font>
	bx := lerp(bx1, bx2, pointX)<font></font>
	tb := lerp(tx, bx, pointY)<font></font>
	<span class="hljs-keyword">return</span> tb<font></font>
<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getRandomVector</span><span class="hljs-params">(x, y <span class="hljs-keyword">float32</span>)</span> []<span class="hljs-title">float32</span></span> {<font></font>
	rand.Seed(<span class="hljs-keyword">int64</span>(x * y))<font></font>
	v := rand.Intn(<span class="hljs-number">3</span>)<font></font>
<font></font>
	<span class="hljs-keyword">switch</span> v {<font></font>
<font></font>
	<span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>}
	<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}
	<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">0</span>, <span class="hljs-number">1</span>}
	<span class="hljs-keyword">default</span>:
		<span class="hljs-keyword">return</span> []<span class="hljs-keyword">float32</span>{<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>}<font></font>
<font></font>
	}<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dot</span><span class="hljs-params">(a []<span class="hljs-keyword">float32</span>, b []<span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> (a[<span class="hljs-number">0</span>]*b[<span class="hljs-number">0</span>] + b[<span class="hljs-number">1</span>]*a[<span class="hljs-number">1</span>])<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">lerp</span><span class="hljs-params">(a, b, c <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> a*(<span class="hljs-number">1</span>-c) + b*c<font></font>
<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">curve</span><span class="hljs-params">(t <span class="hljs-keyword">float32</span>)</span> <span class="hljs-title">float32</span></span> {<font></font>
<font></font>
	<span class="hljs-keyword">return</span> (t * t * t * (t*(t*<span class="hljs-number">6</span><span class="hljs-number">-15</span>) + <span class="hljs-number">10</span>))<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.go</font></font></b><div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"habr/Chunk"</span>
	<span class="hljs-string">"os"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	coord:= Chunk.GetChunkID(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<font></font>
	fmt.Println(coord)<font></font>
	chunk := Chunk.NewChunk(coord)<font></font>
	m := chunk.Map<font></font>
	out := os.Stdout<font></font>
	<span class="hljs-keyword">for</span> y := <span class="hljs-number">8</span>; y &lt; <span class="hljs-number">32</span>*<span class="hljs-number">32</span>; y += <span class="hljs-number">16</span> {
		<span class="hljs-keyword">for</span> x := <span class="hljs-number">8</span>; x &lt; <span class="hljs-number">32</span>*<span class="hljs-number">32</span>; x += <span class="hljs-number">16</span> {<font></font>
			c := Chunk.Coordinate{X: x, Y: y}<font></font>
			out.Write([]<span class="hljs-keyword">byte</span>(m[c].Key))<font></font>
<font></font>
		}<font></font>
		out.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"\n"</span>))<font></font>
	}<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im n√§chsten Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden wir √ºberlegen, mit HTTP zu arbeiten, und wenn wir dies beeinflussen, dann die WS-Verbindung. </font><font style="vertical-align: inherit;">Lassen Sie uns eine Art Spielkarte erstellen, die wir im JSON-Format f√ºr das Rendern auf dem Client serialisieren und im Allgemeinen sehen, wie wir mit dem Client interagieren.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488740/index.html">Benutzerdefiniertes HTML-Tag-Handbuch f√ºr Google Tag Manager von Simo Ahava</a></li>
<li><a href="../de488742/index.html">Sehen Sie die Architektur? Und ich sehe nicht, aber sie ist</a></li>
<li><a href="../de488744/index.html">Anleitung zum Arbeiten mit OpenAL in C ++. Teil 1: Ton abspielen</a></li>
<li><a href="../de488748/index.html">Erstellen Sie eine Todo-Anwendung mit Django. Teil 1</a></li>
<li><a href="../de488750/index.html">Dinosaur Walk: Zwei gro√üe Computer des 20. Jahrhunderts</a></li>
<li><a href="../de488754/index.html">Alles auf einmal: automatische √úberpr√ºfung der B√ºndelgr√∂√üe</a></li>
<li><a href="../de488756/index.html">So arbeiten Sie mit der Google Sheets-API (Google Sheets API v4) in R mithilfe des neuen googlesheets4-Pakets</a></li>
<li><a href="../de488758/index.html">DEFCON-Konferenz 27. Internet-Betrugserkennung</a></li>
<li><a href="../de488762/index.html">Elegante asynchrone Programmierung mit Versprechen</a></li>
<li><a href="../de488766/index.html">Kunst und Technologie: Universit√§t von Massachusetts in Lowell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>