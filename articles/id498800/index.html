<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛃 👐🏽 🤘🏽 Bagaimana saya mengajar komputer saya untuk bermain Dobble dengan OpenCV dan Deep Learning 🚈 🍫 💪🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pelanggan yang terhormat! Anda mungkin sudah tahu bahwa kami telah meluncurkan kursus baru, "Computer Vision," yang akan memulai kelas dalam beberapa ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana saya mengajar komputer saya untuk bermain Dobble dengan OpenCV dan Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/498800/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelanggan yang terhormat! </font><font style="vertical-align: inherit;">Anda mungkin sudah tahu bahwa kami telah meluncurkan kursus baru, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Computer Vision,"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang akan memulai kelas dalam beberapa hari mendatang. </font><font style="vertical-align: inherit;">Untuk mengantisipasi dimulainya kelas, kami menyiapkan terjemahan lain yang menarik untuk dibenamkan di dunia CV.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/q9/rm/5j/q9rm5jisb3ecqro7lnwivk2wwqc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hobi saya bermain papan permainan, dan karena saya sedikit terbiasa dengan jaringan saraf convolutional, saya memutuskan untuk membuat aplikasi yang dapat mengalahkan seseorang dalam permainan kartu. </font><font style="vertical-align: inherit;">Saya ingin membangun model dari awal menggunakan dataset saya sendiri dan melihat seberapa baik kerjanya dengan dataset kecil. </font><font style="vertical-align: inherit;">Saya memutuskan untuk memulai dengan permainan Dobble yang sederhana (juga dikenal sebagai Spot it!).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tidak tahu apa itu Dobble, saya akan secara singkat mengingat aturan permainan: Dobble adalah permainan pengenalan pola sederhana di mana para pemain mencoba menemukan gambar yang digambarkan secara bersamaan pada dua kartu. </font><font style="vertical-align: inherit;">Setiap kartu dalam permainan Dobble asli berisi delapan karakter yang berbeda, dan pada kartu yang berbeda ukurannya berbeda. </font><font style="vertical-align: inherit;">Dua kartu hanya memiliki satu simbol yang sama. </font><font style="vertical-align: inherit;">Jika Anda menemukan simbolnya lebih dulu, ambil kartu. </font><font style="vertical-align: inherit;">Ketika setumpuk 55 kartu berakhir, kartu dengan kartu terbanyak menang. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/b7/sw/qtb7swvb0bghekmkzqswukrkwoy.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cobalah sendiri: Simbol apa yang umum untuk kedua kartu ini?</font></font></i><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di mana untuk memulai?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah pertama dalam menyelesaikan tugas analisis data adalah mengumpulkan data. </font><font style="vertical-align: inherit;">Saya mengambil enam foto dari masing-masing kartu di telepon. </font><font style="vertical-align: inherit;">Total 330 foto ternyata. </font><font style="vertical-align: inherit;">Empat di antaranya Anda lihat di bawah. </font><font style="vertical-align: inherit;">Anda mungkin bertanya, apakah ini cukup untuk membuat jaringan saraf convolutional yang bagus? </font><font style="vertical-align: inherit;">Kami akan kembali ke sini!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cf/8s/c5/cf8sc5csfihv8q9ngt4r5wipzom.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengolahan citra</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OKE, data yang kita miliki, selanjutnya apa? </font><font style="vertical-align: inherit;">Mungkin bagian terpenting di jalan menuju sukses: pemrosesan gambar. </font><font style="vertical-align: inherit;">Kita perlu mendapatkan karakter dari setiap gambar. </font><font style="vertical-align: inherit;">Beberapa kesulitan menunggu kita di sini. </font><font style="vertical-align: inherit;">Dalam foto di atas, terlihat bahwa beberapa karakter lebih sulit untuk dibedakan daripada yang lain: manusia salju dan hantu (di foto ketiga) dan jarum (di keempat) warna terang, dan noda (di foto kedua) dan tanda seru (di foto keempat) terdiri dari beberapa bagian . </font><font style="vertical-align: inherit;">Untuk memproses karakter ringan, kami akan menambahkan kontras. </font><font style="vertical-align: inherit;">Setelah itu kami akan mengubah ukuran dan menyimpan gambar.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan kontras</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menambahkan kontras, kami menggunakan ruang warna </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lab. </font><font style="vertical-align: inherit;">L</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah cahaya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah komponen berwarna dalam rentang dari hijau ke magenta, dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah komponen berwarna dalam kisaran dari biru ke kuning. </font><font style="vertical-align: inherit;">Kita dapat dengan mudah mengekstrak komponen ini menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">import cv2<font></font>
import imutils<font></font>
imgname = 'picture1'<font></font>
image = cv2.imread(f’{imgname}.jpg’)<font></font>
lab = cv2.cvtColor(image, cv2.COLOR_BGR2LAB)<font></font>
l, a, b = cv2.split(lab)</code></pre><br>
<img src="https://habrastorage.org/webt/2u/rf/xs/2urfxs4kcjdhokrytfnpggg_l3s.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari kiri ke kanan: gambar asli, komponen lightness, komponen a, dan komponen b</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang kita menambahkan kontras pada komponen lightness, sekali lagi gabungkan semua komponen menjadi satu dan ubah menjadi gambar normal:</font></font><br>
<br>
<pre><code class="plaintext hljs">clahe = cv2.createCLAHE(clipLimit=3.0, tileGridSize=(8,8))<font></font>
cl = clahe.apply(l)<font></font>
limg = cv2.merge((cl,a,b))<font></font>
final = cv2.cvtColor(limg, cv2.COLOR_LAB2BGR)</code></pre><br>
<img src="https://habrastorage.org/webt/6i/fc/wy/6ifcwytem84rmka2rwsn8e2iicu.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari kiri ke kanan: gambar asli, komponen terang, gambar dengan kontras tinggi dan gambar dikonversi kembali ke RGB</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubah ukuran</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang ubah ukuran dan simpan gambar:</font></font><br>
<br>
<pre><code class="plaintext hljs">resized = cv2.resize(final, (800, 800))<font></font>
# save the image<font></font>
cv2.imwrite(f'{imgname}processed.jpg', blurred)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selesai!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengenalan kartu dan karakter</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang setelah gambar diproses, kami dapat mendeteksi kartu dalam gambar. </font><font style="vertical-align: inherit;">Menggunakan OpenCV kami mencari kontur eksternal. </font><font style="vertical-align: inherit;">Lalu kami mengonversi gambar menjadi halftones, pilih nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ambang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dalam kasus kami, 190) untuk membuat gambar hitam-putih dan mencari jalur. </font><font style="vertical-align: inherit;">Kode:</font></font><br>
<br>
<pre><code class="plaintext hljs">image = cv2.imread(f’{imgname}processed.jpg’)<font></font>
gray = cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)<font></font>
thresh = cv2.threshold(gray, 190, 255, cv2.THRESH_BINARY)[1]<font></font>
# find contours<font></font>
cnts = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)<font></font>
cnts = imutils.grab_contours(cnts)<font></font>
output = image.copy()<font></font>
# draw contours on image<font></font>
for c in cnts:<font></font>
    cv2.drawContours(output, [c], -1, (255, 0, 0), 3)</code></pre><br>
<img src="https://habrastorage.org/webt/bh/y6/24/bhy624atzopnzxchn5gz0navg0e.jpeg"><br>
 <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar yang diproses dikonversi menjadi halftone menggunakan ambang batas dan memilih kontur eksternal</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jika kita mengurutkan kontur eksternal berdasarkan area, kita akan menemukan kontur dengan area terbesar - ini akan menjadi kartu kita. </font><font style="vertical-align: inherit;">Untuk mengekstrak karakter kita dapat membuat latar belakang putih.</font></font><br>
<br>
<pre><code class="plaintext hljs"># sort by area, grab the biggest one<font></font>
cnts = sorted(cnts, key=cv2.contourArea, reverse=True)[0]<font></font>
# create mask with the biggest contour<font></font>
mask = np.zeros(gray.shape,np.uint8)<font></font>
mask = cv2.drawContours(mask, [cnts], -1, 255, cv2.FILLED)<font></font>
# card in foreground<font></font>
fg_masked = cv2.bitwise_and(image, image, mask=mask)<font></font>
# white background (use inverted mask)<font></font>
mask = cv2.bitwise_not(mask)<font></font>
bk = np.full(image.shape, 255, dtype=np.uint8)<font></font>
bk_masked = cv2.bitwise_and(bk, bk, mask=mask)<font></font>
# combine back- and foreground<font></font>
final = cv2.bitwise_or(fg_masked, bk_masked)</code></pre><br>
<img src="https://habrastorage.org/webt/j3/lh/dn/j3lhdnzj07y84s5uqiiuphysety.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Topeng, latar belakang, gambar latar depan, gambar akhir</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang saatnya untuk pengenalan karakter! </font><font style="vertical-align: inherit;">Kita dapat menggunakan gambar yang dihasilkan untuk mendeteksi kontur eksternal lagi, kontur ini akan menjadi simbol. </font><font style="vertical-align: inherit;">Jika kita membuat kotak di sekitar setiap simbol, kita dapat mengekstrak area ini. </font><font style="vertical-align: inherit;">Di sini kodenya sedikit lebih lama:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># just like before (with detecting the card)</span><font></font>
gray = cv2.cvtColor(final, cv2.COLOR_RGB2GRAY)<font></font>
thresh = cv2.threshold(gray, <span class="hljs-number">195</span>, <span class="hljs-number">255</span>, cv2.THRESH_BINARY)[<span class="hljs-number">1</span>]<font></font>
thresh = cv2.bitwise_not(thresh)<font></font>
cnts = cv2.findContours(thresh.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)<font></font>
cnts = imutils.grab_contours(cnts)<font></font>
cnts = sorted(cnts, key=cv2.contourArea, reverse=<span class="hljs-literal">True</span>)[:<span class="hljs-number">10</span>]
<span class="hljs-comment"># handle each contour</span>
i = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cnts:
    <span class="hljs-keyword">if</span> cv2.contourArea(c) &gt; <span class="hljs-number">1000</span>:
        <span class="hljs-comment"># draw mask, keep contour</span><font></font>
        mask = np.zeros(gray.shape, np.uint8)<font></font>
        mask = cv2.drawContours(mask, [c], <span class="hljs-number">-1</span>, <span class="hljs-number">255</span>, cv2.FILLED)
        <span class="hljs-comment"># white background</span><font></font>
        fg_masked = cv2.bitwise_and(image, image, mask=mask)<font></font>
        mask = cv2.bitwise_not(mask)<font></font>
        bk = np.full(image.shape, <span class="hljs-number">255</span>, dtype=np.uint8)<font></font>
        bk_masked = cv2.bitwise_and(bk, bk, mask=mask)<font></font>
        finalcont = cv2.bitwise_or(fg_masked, bk_masked)<font></font>
        <span class="hljs-comment"># bounding rectangle around contour</span><font></font>
        output = finalcont.copy()<font></font>
        x,y,w,h = cv2.boundingRect(c)<font></font>
        <span class="hljs-comment"># squares io rectangles</span>
        <span class="hljs-keyword">if</span> w &lt; h:<font></font>
            x += int((w-h)/<span class="hljs-number">2</span>)<font></font>
            w = h<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            y += int((h-w)/<span class="hljs-number">2</span>)<font></font>
            h = w<font></font>
        <span class="hljs-comment"># take out the square with the symbol</span><font></font>
        roi = finalcont[y:y+h, x:x+w]<font></font>
        roi = cv2.resize(roi, (<span class="hljs-number">400</span>,<span class="hljs-number">400</span>))
        <span class="hljs-comment"># save the symbol</span>
        cv2.imwrite(<span class="hljs-string">f"<span class="hljs-subst">{imgname}</span>_icon<span class="hljs-subst">{i}</span>.jpg"</span>, roi)<font></font>
        i += <span class="hljs-number">1</span></code></pre><br>
<img src="https://habrastorage.org/webt/qf/pf/vk/qfpfvkmhh5u674jgxpbiecjcovg.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar hitam dan putih (ambang batas), garis besar yang terdeteksi, simbol hantu dan simbol jantung (karakter diekstraksi dengan topeng)</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sortir karakter</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang yang paling membosankan! </font><font style="vertical-align: inherit;">Anda perlu mengurutkan karakter. </font><font style="vertical-align: inherit;">Anda memerlukan direktori kereta, tes, dan validasi, masing-masing 57 direktori (kami memiliki total 57 karakter yang berbeda). </font><font style="vertical-align: inherit;">Struktur folder adalah sebagai berikut:</font></font><br>
<br>
<pre><code class="python hljs">symbols<font></font>
 ├── test<font></font>
 │   ├── anchor<font></font>
 │   ├── apple<font></font>
 │   │   ...<font></font>
 │   └── zebra<font></font>
 ├── train<font></font>
 │   ├── anchor<font></font>
 │   ├── apple<font></font>
 │   │   ...<font></font>
 │   └── zebra<font></font>
 └── validation<font></font>
     ├── anchor<font></font>
     ├── apple<font></font>
     │   ...<font></font>
     └── zebra</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diperlukan waktu untuk meletakkan karakter yang diekstraksi (lebih dari 2500 lembar) di direktori yang diperlukan! </font><font style="vertical-align: inherit;">Saya memiliki kode untuk membuat subfolder, test suite, dan kit validasi di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mungkin lain kali lebih baik melakukan pengurutan berdasarkan algoritma pengelompokan ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelatihan jaringan saraf convolutional</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah bagian yang membosankan, kesenangan datang lagi! </font><font style="vertical-align: inherit;">Sudah waktunya untuk membuat dan melatih jaringan saraf convolutional. </font><font style="vertical-align: inherit;">Anda dapat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menemukan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> informasi tentang jaringan saraf convolutional di </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">sini</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur model</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memiliki tugas klasifikasi multi-kelas dengan satu label. </font><font style="vertical-align: inherit;">Untuk setiap karakter kita membutuhkan satu label. </font><font style="vertical-align: inherit;">Itu sebabnya kita memerlukan fungsi untuk mengaktifkan lapisan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">softmax</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> output </font><font style="vertical-align: inherit;">dengan 57 node dan entropi lintas kategori sebagai fungsi kerugian. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arsitektur model akhir adalah sebagai berikut:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># imports</span>
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> layers
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> models
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> optimizers
<span class="hljs-keyword">from</span> keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-comment"># layers, activation layer with 57 nodes (one for every symbol)</span><font></font>
model = models.Sequential()<font></font>
model.add(layers.Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">3</span>)))<font></font>
model.add(layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))  <font></font>
model.add(layers.Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<font></font>
model.add(layers.Conv2D(<span class="hljs-number">128</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<font></font>
model.add(layers.Conv2D(<span class="hljs-number">256</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<font></font>
model.add(layers.Conv2D(<span class="hljs-number">256</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<font></font>
model.add(layers.Conv2D(<span class="hljs-number">128</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.Flatten())<font></font>
model.add(layers.Dropout(<span class="hljs-number">0.5</span>)) <font></font>
model.add(layers.Dense(<span class="hljs-number">512</span>, activation=<span class="hljs-string">'relu'</span>))<font></font>
model.add(layers.Dense(<span class="hljs-number">57</span>, activation=<span class="hljs-string">'softmax'</span>))<font></font>
model.compile(loss=<span class="hljs-string">'categorical_crossentropy'</span>,       optimizer=optimizers.RMSprop(lr=<span class="hljs-number">1e-4</span>), metrics=[<span class="hljs-string">'acc'</span>])</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Augmentasi Data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meningkatkan kinerja, saya menggunakan augmentasi data. </font><font style="vertical-align: inherit;">Augmentasi data adalah proses peningkatan volume dan ragam input data. </font><font style="vertical-align: inherit;">Ini dapat dilakukan dengan memutar, menggeser, mengubah skala, memotong dan membalik gambar yang ada. </font><font style="vertical-align: inherit;">Keras dapat dengan mudah menambah data:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># specify the directories</span>
train_dir = <span class="hljs-string">'symbols/train'</span>
validation_dir = <span class="hljs-string">'symbols/validation'</span>
test_dir = <span class="hljs-string">'symbols/test'</span>
<span class="hljs-comment"># data augmentation with ImageDataGenerator from Keras (only train)</span>
train_datagen = ImageDataGenerator(rescale=<span class="hljs-number">1.</span>/<span class="hljs-number">255</span>, rotation_range=<span class="hljs-number">40</span>, width_shift_range=<span class="hljs-number">0.1</span>, height_shift_range=<span class="hljs-number">0.1</span>, shear_range=<span class="hljs-number">0.1</span>, zoom_range=<span class="hljs-number">0.1</span>, horizontal_flip=<span class="hljs-literal">True</span>, vertical_flip=<span class="hljs-literal">True</span>)<font></font>
test_datagen = ImageDataGenerator(rescale=<span class="hljs-number">1.</span>/<span class="hljs-number">255</span>)<font></font>
train_generator = train_datagen.flow_from_directory(train_dir, target_size=(<span class="hljs-number">400</span>,<span class="hljs-number">400</span>), batch_size=<span class="hljs-number">20</span>, class_mode=<span class="hljs-string">'categorical'</span>)<font></font>
validation_generator = test_datagen.flow_from_directory(validation_dir, target_size=(<span class="hljs-number">400</span>,<span class="hljs-number">400</span>), batch_size=<span class="hljs-number">20</span>, class_mode=<span class="hljs-string">'categorical'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tertarik, hantu yang diperbesar terlihat seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/wq/_c/hjwq_ckmzjkvmyr9xu9fr5pyq0w.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar asli hantu di sebelah kiri, hantu yang diperbesar di semua gambar lainnya</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelatihan model</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita latih modelnya, simpan untuk digunakan untuk prediksi, dan periksa hasilnya.</font></font><br>
<br>
<pre><code class="python hljs">history = model.fit_generator(train_generator, steps_per_epoch=<span class="hljs-number">100</span>, epochs=<span class="hljs-number">100</span>, validation_data=validation_generator, validation_steps=<span class="hljs-number">50</span>)
<span class="hljs-comment"># don't forget to save your model!</span>
model.save(<span class="hljs-string">'models/model.h5'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/uz/c2/qm/uzc2qml9v4-zezvickpgjezm8ly.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prediksi sempurna!</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasil</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Model dasar yang saya latih tanpa augmentasi data, putus sekolah dan dengan lebih sedikit lapisan. </font><font style="vertical-align: inherit;">Model ini memberikan hasil sebagai berikut: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/tg/u3/lctgu3nfsj3felc31tuhtg68neg.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil model dasar</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dengan mata telanjang, jelas bahwa model ini dilatih ulang. </font><font style="vertical-align: inherit;">Hasil versi final dari model (kodenya disajikan pada bagian sebelumnya) jauh lebih baik. </font><font style="vertical-align: inherit;">Pada grafik di bawah ini Anda dapat melihat keakuratan dan kerugian selama pelatihan dan pada set validasi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bw/tn/s2/bwtns2xrfdgnlzuxmwppzdqhyom.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil dari model terakhir</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pada set tes, model ini hanya membuat satu kesalahan, ia mengakui bom sebagai drop. </font><font style="vertical-align: inherit;">Saya memutuskan untuk tetap menggunakan model ini, akurasi pada set tes adalah 0,995.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan simbol umum pada dua kartu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda dapat mulai mencari simbol umum pada dua kartu. </font><font style="vertical-align: inherit;">Kami menggunakan dua foto, kami akan membuat prediksi untuk setiap gambar secara terpisah dan menggunakan persimpangan set untuk mengetahui simbol mana yang ada di kedua kartu. </font><font style="vertical-align: inherit;">Kami memiliki 3 opsi kerja:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terjadi kesalahan selama prediksi: tidak ada karakter yang ditemukan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada satu simbol di persimpangan (prediksi bisa benar atau salah).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada lebih dari satu karakter di persimpangan. </font><font style="vertical-align: inherit;">Dalam hal ini, saya memilih simbol dengan probabilitas tertinggi (rata-rata dari kedua prediksi).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode untuk memprediksi semua kombinasi pada dua gambar dalam katalog kebohongan dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 's </font></font><code>main.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan inilah hasilnya:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/6h/em/kz6hemmqhp7bhdq25ywzipipdou.gif"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Bukankah itu model yang sempurna? Sayangnya tidak ada. Ketika saya mengambil foto baru kartu-kartu itu dan memberi mereka model untuk prediksi, ada beberapa masalah dengan manusia salju itu. Terkadang dia mengenali mata atau zebra sebagai manusia salju! Akibatnya, terkadang hasilnya aneh: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b0/y4/e8/b0y4e8nw6kq7juigw_oekx2jjtk.jpeg"> <br>
 <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ya, di mana manusia salju di sini?</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Apakah model ini lebih baik daripada manusia? Bergantung pada apa yang kita butuhkan: orang-orang mengenali dengan sempurna, tetapi model melakukannya dengan lebih cepat! Saya perhatikan waktu di mana komputer mengatasi: Saya memberi setumpuk 55 kartu dan saya harus mendapatkan simbol umum untuk setiap kombinasi dua kartu. Secara total, ini adalah 1485 kombinasi. Komputer melakukannya dalam waktu kurang dari 140 detik. Dia membuat beberapa kesalahan, tapi dia pasti akan mengalahkan siapa pun ketika datang ke kecepatan!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t2/pn/ce/t2pncemklqifymf39ixawz9ejsg.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Saya tidak berpikir bahwa membuat model 100% yang berfungsi itu sulit. </font><font style="vertical-align: inherit;">Ini dapat dicapai melalui pelatihan transfer. </font><font style="vertical-align: inherit;">Untuk memahami apa yang dilakukan model, kita dapat memvisualisasikan layer untuk gambar uji. </font><font style="vertical-align: inherit;">Anda bisa melakukannya lain kali!</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari lebih lanjut tentang kursus dan lulus ujian masuk</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498768/index.html">Penggunaan detektor asap di kendaraan</a></li>
<li><a href="../id498782/index.html">Battle Experimenters - Sand and Stick Science - Inokulasi Pemikiran Ilmiah ke dalam Pikiran Publik</a></li>
<li><a href="../id498788/index.html">Belajar Mini Stepper Motor</a></li>
<li><a href="../id498796/index.html">Kebijakan Keamanan Konten di Magento 2</a></li>
<li><a href="../id498798/index.html">Terus belajar dan belajar dengan JetBrains</a></li>
<li><a href="../id498808/index.html">Vim dengan Dukungan YAML untuk Kubernetes</a></li>
<li><a href="../id498814/index.html">Anda gagal satu pertanyaan teoritis tentang Jaminan Sosial, dan mereka mengakhiri Anda. Ini normal? // Kita Ditakdirkan # 3</a></li>
<li><a href="../id498816/index.html">Kebenaran pertama-tama, atau mengapa sistem perlu dirancang berdasarkan pada perangkat basis data</a></li>
<li><a href="../id498820/index.html">Beberapa pertanyaan rumit tentang .NET dan C #</a></li>
<li><a href="../id498822/index.html">Pengembangan dan pembuatan dari awal mesin arcade untuk empat pemain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>