<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ò üë®üèª‚Äçüé§ üí∏ 5 SQL Questions Frequently Asked by Data Scientists for Job Interviews üåô üö∂ ‚úåüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Although compiling SQL queries is not the most interesting thing for Data Scientists, a good understanding of SQL is extremely important for anyone wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>5 SQL Questions Frequently Asked by Data Scientists for Job Interviews</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487878/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although compiling SQL queries is not the most interesting thing for Data Scientists, a good understanding of SQL is extremely important for anyone who wants to succeed in any activity related to data processing. </font><font style="vertical-align: inherit;">The point here is that SQL is not only </font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The more SQL constructions a specialist knows, the easier it will be for him to create requests for obtaining from the databases everything that he may need. </font><font style="vertical-align: inherit;">
The author of the article, the translation of which we are publishing today, says that it is aimed at solving two problems:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/0z/vs/bn/0zvsbnwvpvqk_l_-semjqdqw5fu.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exploring mechanisms that go beyond basic SQL knowledge.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consideration of several practical tasks for working with SQL.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article covers 5 SQL questions from Leetcode. </font><font style="vertical-align: inherit;">They represent practical tasks that are often encountered in interviews.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question No. 1: second place in terms of salary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write an SQL query to obtain from the table with employee salary information ( </font></font><code>Employee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) an entry containing the second highest salary. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, such a query executed for the table below should return </font></font><code>200</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If the table does not have a value lower than the highest salary, the request should return </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">----+--------+</span><font></font>
| Id | Salary |<font></font>
+<span class="hljs-comment">----+--------+</span><font></font>
| 1&nbsp; | 100&nbsp; &nbsp; |<font></font>
| 2&nbsp; | 200&nbsp; &nbsp; |<font></font>
| 3&nbsp; | 300&nbsp; &nbsp; |<font></font>
+<span class="hljs-comment">----+--------+</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Decision A: use </font></font><code>IFNULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>OFFSET</code></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are the main mechanisms that will be used in this solution to the problem:</font></font><br>
<br>
<ul>
<li><code>IFNULL(expression, alt)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: this function returns its argument </font></font><code>expression</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if it is not equal </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Otherwise, the argument is returned </font></font><code>alt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We will use this function to return </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if the table does not contain the desired value.</font></font></li>
<li><code>OFFSET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: This operator is used with an expression </font></font><code>ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to discard the first </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines. </font><font style="vertical-align: inherit;">This is useful to us for the reason that we are interested in the second row of the result (that is, the second largest salary, the data on which is in the table).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a ready-made request:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">IFNULL</span>(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> Salary
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">FROM</span> Employee
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Salary <span class="hljs-keyword">DESC</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), <span class="hljs-literal">null</span>) <span class="hljs-keyword">as</span> SecondHighestSalary
<span class="hljs-keyword">FROM</span> Employee
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Solution B: use </font></font><code>MAX</code></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The query below uses the function </font></font><code>MAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Here, the highest salary value is selected, not equal to the maximum salary received throughout the table. </font><font style="vertical-align: inherit;">As a result, we get what we need - the second largest salary.</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(salary) <span class="hljs-keyword">AS</span> SecondHighestSalary
<span class="hljs-keyword">FROM</span> Employee
<span class="hljs-keyword">WHERE</span> salary != (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(salary) <span class="hljs-keyword">FROM</span> Employee)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question # 2: duplicate email addresses</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write an SQL query that detects </font></font><code>Person</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all duplicate email addresses </font><font style="vertical-align: inherit;">in the table </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">----+---------+</span><font></font>
| Id | Email &nbsp; |<font></font>
+<span class="hljs-comment">----+---------+</span><font></font>
| 1&nbsp; | a@b.com |<font></font>
| 2&nbsp; | c@d.com |<font></font>
| 3&nbsp; | a@b.com |<font></font>
+<span class="hljs-comment">----+---------+</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Decision A: </font></font><code>COUNT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the subquery</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, we create a subquery in which the frequency of occurrence of each address in the table is determined. </font><font style="vertical-align: inherit;">Then the result returned by the subquery is filtered using the instruction </font></font><code>WHERE count &gt; 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The query will return information about addresses found in the source table more than once.</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> Email
<span class="hljs-keyword">FROM</span> (
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">SELECT</span> Email, <span class="hljs-keyword">count</span>(Email) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">count</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">FROM</span> Person
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Email<font></font>
) <span class="hljs-keyword">as</span> email_count
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">count</span> &gt; <span class="hljs-number">1</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Solution B: expression </font></font><code>HAVING</code></font></h3><br>
<ul>
<li><code>HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: This is an expression that allows you to use an instruction </font></font><code>WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with an expression </font></font><code>GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> Email
<span class="hljs-keyword">FROM</span> Person
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Email
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">count</span>(Email) &gt; <span class="hljs-number">1</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question No. 3: rising temperature</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write an SQL query that finds in the table </font></font><code>Weather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all dates (date identifiers) when the temperature would be higher than the temperature on the dates preceding it. </font><font style="vertical-align: inherit;">That is, we are interested in dates on which the ‚Äútoday's‚Äù temperature is higher than the ‚Äúyesterday's‚Äù.</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">---------+------------------+------------------+</span><font></font>
| Id(INT) | RecordDate(DATE) | Temperature(INT) |<font></font>
+<span class="hljs-comment">---------+------------------+------------------+</span><font></font>
| &nbsp; &nbsp; &nbsp; 1 |     &nbsp; 2015-01-01 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10 |<font></font>
| &nbsp; &nbsp; &nbsp; 2 |     &nbsp; 2015-01-02 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 25 |<font></font>
| &nbsp; &nbsp; &nbsp; 3 |     &nbsp; 2015-01-03 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 20 |<font></font>
| &nbsp; &nbsp; &nbsp; 4 |     &nbsp; 2015-01-04 | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 30 |<font></font>
+<span class="hljs-comment">---------+------------------+------------------+</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçSolution: </font></font><code>DATEDIFF</code></font></h3><br>
<ul>
<li><code>DATEDIFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: This function calculates the difference between two dates. </font><font style="vertical-align: inherit;">It is used to provide a comparison of precisely ‚Äútoday's‚Äù and ‚Äúyesterday's‚Äù temperatures.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we formulate the following query in ordinary language, it turns out that it expresses the following idea: we need to choose identifiers such that the temperature corresponding to the dates they represent is greater than the temperature for the ‚Äúyesterday's‚Äù dates with respect to them.</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> a.Id
<span class="hljs-keyword">FROM</span> Weather a, Weather b
<span class="hljs-keyword">WHERE</span> a.Temperature &gt; b.Temperature
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">DATEDIFF</span>(a.Recorddate, b.Recorddate) = <span class="hljs-number">1</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question number 4: the highest salary in the unit</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The table </font></font><code>Employee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stores information about company employees. </font><font style="vertical-align: inherit;">Each record in this table contains information about the identifier ( </font></font><code>Id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) of the employee, his name ( </font></font><code>Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), salary ( </font></font><code>Salary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), and the division of the company where he works ( </font></font><code>Department</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">----+-------+--------+--------------+</span><font></font>
| Id | Name&nbsp; | Salary | DepartmentId |<font></font>
+<span class="hljs-comment">----+-------+--------+--------------+</span><font></font>
| 1&nbsp; | Joe &nbsp; | 70000  | 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<font></font>
| 2&nbsp; | Jim &nbsp; | 90000  | 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<font></font>
| 3&nbsp; | Henry | 80000&nbsp; | 2            |<font></font>
| 4&nbsp; | Sam &nbsp; | 60000  | 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<font></font>
| 5&nbsp; | Max &nbsp; | 90000  | 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<font></font>
+<span class="hljs-comment">----+-------+--------+--------------+</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The table </font></font><code>Department</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contains information about the divisions of the company.</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">----+----------+</span><font></font>
| Id | Name &nbsp; &nbsp; |<font></font>
+<span class="hljs-comment">----+----------+</span><font></font>
| 1&nbsp; | IT &nbsp; &nbsp; &nbsp; |<font></font>
| 2&nbsp; | Sales&nbsp; &nbsp; |<font></font>
+<span class="hljs-comment">----+----------+</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write an SQL query that finds in each of the departments of employees with the maximum salary. </font><font style="vertical-align: inherit;">For example, for the above tables, a similar query should return the results represented by the following table (the order of the rows in the table does not matter):</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">------------+----------+--------+</span><font></font>
| Department | Employee | Salary |<font></font>
+<span class="hljs-comment">------------+----------+--------+</span><font></font>
| IT &nbsp; &nbsp; &nbsp; &nbsp; | Max      | 90000&nbsp; |<font></font>
| IT &nbsp; &nbsp; &nbsp; &nbsp; | Jim      | 90000&nbsp; |<font></font>
| Sales&nbsp; &nbsp; &nbsp; | Henry    | 80000&nbsp; |<font></font>
+<span class="hljs-comment">------------+----------+--------+</span></code></pre><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçSolution: team </font></font><code>IN</code></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>IN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to set </font></font><code>WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conditions </font><font style="vertical-align: inherit;">in the instruction </font><font style="vertical-align: inherit;">that correspond to the use of several commands </font></font><code>OR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">For example, the two following constructs are identical:</font></font><br>
<br>
<pre><code class="sql hljs">WHERE country = ‚ÄòCanada‚Äô OR country = ‚ÄòUSA‚Äô<font></font>
WHERE country IN (‚ÄòCanada‚Äô, ‚ÄôUSA‚Äô).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we want to get a table containing the name of the department ( </font></font><code>Department</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), the name of the employee ( </font></font><code>Employee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and his salary ( </font></font><code>Salary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">To do this, we create a table that contains information about the unit identifier ( </font></font><code>DepartmentID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and the maximum salary for this unit. </font><font style="vertical-align: inherit;">Then we combine the two on a condition table according to which entry in the resulting table fall only if </font></font><code>DepartmentID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>Salary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">have previously formed in the table.</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
&nbsp;&nbsp;&nbsp;&nbsp;Department.name <span class="hljs-keyword">AS</span> <span class="hljs-string">'Department'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;Employee.name <span class="hljs-keyword">AS</span> <span class="hljs-string">'Employee'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;Salary<font></font>
<span class="hljs-keyword">FROM</span> Employee
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> Department <span class="hljs-keyword">ON</span> Employee.DepartmentId = Department.Id
<span class="hljs-keyword">WHERE</span> (DepartmentId , Salary)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">IN</span>
&nbsp;&nbsp;&nbsp;&nbsp;( &nbsp; <span class="hljs-keyword">SELECT</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DepartmentId, <span class="hljs-keyword">MAX</span>(Salary)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">FROM</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Employee<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DepartmentId<font></font>
&nbsp;)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question No. 5: transplanting students</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mary is a high school teacher. </font><font style="vertical-align: inherit;">She has a table </font></font><code>seat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that stores the names of students and information about their places in the classroom. </font><font style="vertical-align: inherit;">The value </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in this table is constantly increasing. </font><font style="vertical-align: inherit;">Mary wants to swap neighboring students. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a table of students' initial placement:</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">---------+---------+</span><font></font>
|&nbsp; &nbsp; id   | student |<font></font>
+<span class="hljs-comment">---------+---------+</span><font></font>
|&nbsp; &nbsp; 1    | Abbot &nbsp; |<font></font>
|&nbsp; &nbsp; 2    | Doris &nbsp; |<font></font>
|&nbsp; &nbsp; 3    | Emerson |<font></font>
|&nbsp; &nbsp; 4    | Green &nbsp; |<font></font>
|&nbsp; &nbsp; 5    | Jeames&nbsp; |<font></font>
+<span class="hljs-comment">---------+---------+</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what should happen after transplanting neighboring students:</font></font><br>
<br>
<pre><code class="sql hljs">+<span class="hljs-comment">---------+---------+</span><font></font>
|&nbsp; &nbsp; id   | student |<font></font>
+<span class="hljs-comment">---------+---------+</span><font></font>
|&nbsp; &nbsp; 1    | Doris &nbsp; |<font></font>
|&nbsp; &nbsp; 2    | Abbot &nbsp; |<font></font>
|&nbsp; &nbsp; 3    | Green &nbsp; |<font></font>
|&nbsp; &nbsp; 4    | Emerson |<font></font>
|&nbsp; &nbsp; 5    | Jeames&nbsp; |<font></font>
+<span class="hljs-comment">---------+---------+</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write a request that will allow the teacher to solve the above problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that if the number of students is odd, you don‚Äôt need to transfer the last student anywhere.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçSolution: using an operator </font></font><code>WHEN</code></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An SQL construct </font></font><code>CASE WHEN THEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be considered an operator </font></font><code>if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in programming. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, the first operator is </font></font><code>WHEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used to check whether the odd identifier is assigned to the last row in the table. </font><font style="vertical-align: inherit;">If so, the line is not subject to change. </font><font style="vertical-align: inherit;">The second operator </font></font><code>WHEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is responsible for adding 1 to each odd identifier (for example, 1, 3, 5 turns into 2, 4, 6) and for subtracting 1 from each even identifier (2, 4, 6 turn into 1, 3, 5).</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">CASE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">WHEN</span>((<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(<span class="hljs-keyword">id</span>) <span class="hljs-keyword">FROM</span> seat)%<span class="hljs-number">2</span> = <span class="hljs-number">1</span>) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">id</span> = (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(<span class="hljs-keyword">id</span>) <span class="hljs-keyword">FROM</span> seat) <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">id</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">id</span>%<span class="hljs-number">2</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">id</span> + <span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">ELSE</span> <span class="hljs-keyword">id</span> - <span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">id</span>, student
<span class="hljs-keyword">FROM</span> seat
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">id</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We examined several SQL tasks, discussing along the way some advanced tools that can be used to compile SQL queries. </font><font style="vertical-align: inherit;">We hope that what you learned today will come in handy for you during interviews in SQL and will prove useful in everyday work. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marketplace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> there is a Docker image with SQL Server Express, which is installed in one click. </font><font style="vertical-align: inherit;">You can check the operation of containers on VPS. </font><font style="vertical-align: inherit;">All new customers are given 3 days free of charge for testing. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What can you advise to those who want to master the art of creating SQL queries?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487864/index.html">Electronic passports: join the world practice or get the risk of personal data leakage?</a></li>
<li><a href="../en487868/index.html">Document scanning and text recognition with VisionKit and Vision Framework on iOS</a></li>
<li><a href="../en487872/index.html">Molding molds from liquid silicone at home</a></li>
<li><a href="../en487874/index.html">Intel NUC Chaco Canyon - Works Where You Need It</a></li>
<li><a href="../en487876/index.html">What is Windows PowerShell and what does it eat? Part 1: Key Features</a></li>
<li><a href="../en487882/index.html">Chrome will automatically block annoying video ads</a></li>
<li><a href="../en487884/index.html">5 things I would like to know before developing the exchange</a></li>
<li><a href="../en487888/index.html">CSRF at Umbraco CMS</a></li>
<li><a href="../en487890/index.html">Translate speech to text on iOS using the Speech framework</a></li>
<li><a href="../en487894/index.html">BarsUP.AM: how we developed a tool for protecting information of web applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>