<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸŒ¾ ğŸ§• â– æœ¬ã€ŒPythonã§ã®æ·±å±¤å¼·åŒ–å­¦ç¿’ã€‚OpenAIã‚¸ãƒ ã¨TensorFlow for ProsÂ» â˜£ï¸ ğŸ–‹ï¸ ğŸ™ŒğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã‚“ã«ã¡ã¯ã€habrozhiteliï¼å¼·åŒ–å­¦ç¿’ã¯ã€äººå·¥çŸ¥èƒ½ã®æœ€ã‚‚äººæ°—ãŒã‚ã‚Šæœ‰æœ›ãªåˆ†é‡ã§ã™ã€‚Pythonã§ã®å®Ÿç”¨çš„ãªå­¦ç¿’RLã¯ã€åŸºæœ¬çš„ãªã ã‘ã§ãªãã€å¼·åŒ–ã•ã‚ŒãŸé«˜åº¦ãªæ·±å±¤å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç¿’å¾—ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚ã“ã®æœ¬ã¯ã€äººå·¥çŸ¥èƒ½ã«èˆˆå‘³ãŒã‚ã‚Šã€å¼·åŒ–å­¦ç¿’æ³•ã‚’å­¦ã³ãŸã„MOé–‹ç™ºè€…ã¨ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°æ„›å¥½å®¶ã‚’å¯¾è±¡ã¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>æœ¬ã€ŒPythonã§ã®æ·±å±¤å¼·åŒ–å­¦ç¿’ã€‚OpenAIã‚¸ãƒ ã¨TensorFlow for ProsÂ»</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/465605/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/hf/sc/yz/hfscyzhjnopaerkvbdvf89gflfc.jpeg" align="left" alt="ç”»åƒ"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚“ã«ã¡ã¯ã€habrozhiteliï¼</font><font style="vertical-align: inherit;">å¼·åŒ–å­¦ç¿’ã¯ã€äººå·¥çŸ¥èƒ½ã®æœ€ã‚‚äººæ°—ãŒã‚ã‚Šæœ‰æœ›ãªåˆ†é‡ã§ã™ã€‚</font><font style="vertical-align: inherit;">Pythonã§ã®å®Ÿç”¨çš„ãªå­¦ç¿’RLã¯ã€åŸºæœ¬çš„ãªã ã‘ã§ãªãã€å¼·åŒ–ã•ã‚ŒãŸé«˜åº¦ãªæ·±å±¤å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç¿’å¾—ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®æœ¬ã¯ã€äººå·¥çŸ¥èƒ½ã«èˆˆå‘³ãŒã‚ã‚Šã€å¼·åŒ–å­¦ç¿’æ³•ã‚’å­¦ã³ãŸã„MOé–‹ç™ºè€…ã¨ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°æ„›å¥½å®¶ã‚’å¯¾è±¡ã¨ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®æœ¬ã‚’èª­ã‚“ã§ã€ä»•äº‹ä¸­ã¾ãŸã¯ä»•äº‹å¤–ã§ã®å®Ÿè·µçš„ãªä¾‹ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å¼·åŒ–å­¦ç¿’ã®å°‚é–€å®¶ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç·šå½¢ä»£æ•°ã€æ•°å­¦çš„åˆ†æã€ãŠã‚ˆã³Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®çŸ¥è­˜ã¯ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç†è§£ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠœç²‹ã€‚</font><font style="vertical-align: inherit;">LSTM RNNã‚’ä½¿ç”¨ã—ãŸæ­Œè©ã®ç”Ÿæˆ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LSTMã‚’ä½¿ç”¨ã—ã¦Zayn Malikæ­Œè©ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">Zaneã®æ­Œè©æ­Œè©ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpsï¼š//github.com/sudharsan13296/Hands-On-Reinforcement-Learning-With-Python/blob/master/07.%20Deep%20Learning%20Fundamentals/data/ZaynLyrics.txtã‹ã‚‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ã</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œæ¥­ã¯ã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€æ­Œè©ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">"Zayn_Lyrics.txt"</span>,<span class="hljs-string">"r"</span>) <span class="hljs-keyword">as</span> f: <font></font>
    data=f.read() <font></font>
    data=data.replace(<span class="hljs-string">'\n'</span>,<span class="hljs-string">''</span>) <font></font>
    data = data.lower()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">data[:<span class="hljs-number">50</span>]
<span class="hljs-string">"now i'm on the edge can't find my way it's inside "</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ã™ã¹ã¦ã®æ–‡å­—ãŒall_charså¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">all_chars=list(set(data))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€æ„ã®æ–‡å­—ã®æ•°ã¯ã€unique_charsã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">unique_chars = len(all_chars)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€æ–‡å­—ã®ç·æ•°ã¯å¤‰æ•°total_charsã«æ ¼ç´ã•ã‚Œã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="python hljs">total_chars =len(data)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€å„æ–‡å­—ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚</font><font style="vertical-align: inherit;">char_to_ixã«ã¯æ–‡å­—ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãŒå«ã¾ã‚Œã€ix_to_charã«ã¯æ–‡å­—ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãŒå«ã¾ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">char_to_ix = { ch:i <span class="hljs-keyword">for</span> i,ch <span class="hljs-keyword">in</span> enumerate(all_chars) }<font></font>
ix_to_char = { i:ch <span class="hljs-keyword">for</span> i,ch <span class="hljs-keyword">in</span> enumerate(all_chars) }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ï¼š</font></font><br>
<br>
<pre><code class="python hljs">char_to_ix[<span class="hljs-string">'e'</span>]
<span class="hljs-number">9</span><font></font>
<font></font>
ix_to_char[<span class="hljs-number">9</span>]<font></font>
e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€å…¥åŠ›å€¤ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’ç”Ÿæˆã™ã‚‹generate_batché–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã¯ã€å…¥åŠ›å€¤ã®ã‚·ãƒ•ãƒˆã¨iã®ç©ã«ç­‰ã—ããªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã¨ãˆã°ã€shift = 1ã®input = [12,13,24]ã®å ´åˆã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã¯[13,24]ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_batch</span>(<span class="hljs-params">seq_length,i</span>):</span>
    inputs = [char_to_ix[ch] <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> data[i:i+seq_length]]<font></font>
    targets = [char_to_ix[ch] <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> data[i+<span class="hljs-number">1</span>:i+seq_length+<span class="hljs-number">1</span>]]<font></font>
    inputs=np.array(inputs).reshape(seq_length,<span class="hljs-number">1</span>)<font></font>
    targets=np.array(targets).reshape(seq_length,<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> inputs,targets</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®é•·ã•ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®é€Ÿåº¦ã€ãŠã‚ˆã³ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã®æ•°ã¨ç­‰ã—ã„ãƒãƒ¼ãƒ‰ã®æ•°ã‚’æ±ºå®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">seq_length = <span class="hljs-number">25</span>
learning_rate = <span class="hljs-number">0.1</span>
num_nodes = <span class="hljs-number">300</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LSTM RNNã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">TensorFlowã¯ã€LSTMã‚»ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®BasicLSTMCellï¼ˆï¼‰é–¢æ•°ã‚’æä¾›ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">LSTMã‚»ãƒ«ã®ãƒ¦ãƒ‹ãƒƒãƒˆæ•°ã¨ã€ä½¿ç”¨ã™ã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–æ©Ÿèƒ½ã®ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€LSTMã‚»ãƒ«ã‚’ä½œæˆã—ã€tf.nn.dynamic_rnnï¼ˆï¼‰é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã“ã®ã‚»ãƒ«ã§RNNãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å‡ºåŠ›ã¨çŠ¶æ…‹å€¤ãŒè¿”ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_rnn</span>(<span class="hljs-params">x</span>):</span><font></font>
        cell= tf.contrib.rnn.BasicLSTMCell(num_units=num_nodes,<font></font>
activation=tf.nn.relu)<font></font>
        outputs, states = tf.nn.dynamic_rnn(cell, x, dtype=tf.float32)<font></font>
        <span class="hljs-keyword">return</span> outputs,states</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€å…¥åŠ›Xã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆYã®ä»£ã‚ã‚Šã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">X=tf.placeholder(tf.float32,[<span class="hljs-literal">None</span>,<span class="hljs-number">1</span>])<font></font>
Y=tf.placeholder(tf.float32,[<span class="hljs-literal">None</span>,<span class="hljs-number">1</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xã¨Yã‚’intã«å¤‰æ›ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">X=tf.cast(X,tf.int32)<font></font>
Y=tf.cast(Y,tf.int32)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xã¨Yã®ãƒ¯ãƒ³ãƒ›ãƒƒãƒˆãƒ“ãƒ¥ãƒ¼ã‚‚ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">X_onehot=tf.one_hot(X,unique_chars)<font></font>
Y_onehot=tf.one_hot(Y,unique_chars)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
build_rnné–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã€RNNã‹ã‚‰å‡ºåŠ›ã¨çŠ¶æ…‹ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">outputs,states=build_rnn(X_onehot)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡ºåŠ›ã‚’è»¢ç½®ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">outputs=tf.transpose(outputs,perm=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡ã¿ã¨ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">W=tf.Variable(tf.random_normal((num_nodes,unique_chars),stddev=<span class="hljs-number">0.001</span>))<font></font>
B=tf.Variable(tf.zeros((<span class="hljs-number">1</span>,unique_chars)))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡ºåŠ›ã«é‡ã¿ã‚’ä¹—ç®—ã—ã€ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€å‡ºåŠ›ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">Ys=tf.matmul(outputs[<span class="hljs-number">0</span>],W)+B</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€softmaxã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€ç¢ºç‡ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">prediction = tf.nn.softmax(Ys)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cross_entropyã®æå¤±ã¯æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">cross_entropy=tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels<font></font>
=Y_onehot,logits=Ys))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã®ç›®æ¨™ã¯æå¤±ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã“ã¨ãªã®ã§ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é€†ä¼æ’­ã‚’å®Ÿè¡Œã—ã€å‹¾é…é™ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">optimiser =<font></font>
tf.train.GradientDescentOptimizer(learning_rate=learning_rate).minimize(cro<font></font>
ss_entropy)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€RNNãƒ¢ãƒ‡ãƒ«ã«å¾“ã£ã¦æ¬¡ã®äºˆæ¸¬ã•ã‚ŒãŸã‚·ãƒ³ãƒœãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä¸ãˆã‚‹è£œåŠ©é–¢æ•°ã®äºˆæ¸¬ãŒå®šç¾©ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span>(<span class="hljs-params">seed,i</span>):</span>
    x=np.zeros((<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<font></font>
    x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]= seed<font></font>
    indices=[]<font></font>
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(i):<font></font>
        p=sess.run(prediction,{X:x})<font></font>
        index = np.random.choice(range(unique_chars), p=p.ravel())<font></font>
        x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=index<font></font>
        indices.append(index)<font></font>
    <span class="hljs-keyword">return</span> indices</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€batch_sizeãƒ‘ã‚±ãƒƒãƒˆã‚µã‚¤ã‚ºã€ãƒ‘ã‚±ãƒƒãƒˆæ•°ã€ã‚¨ãƒãƒƒã‚¯æ•°ã€ãŠã‚ˆã³ãƒ‘ã‚±ãƒƒãƒˆã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®ã‚·ãƒ•ãƒˆå€¤ã‚’è¨­å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">batch_size=<span class="hljs-number">100</span><font></font>
total_batch=int(total_chars//batch_size)<font></font>
epochs=<span class="hljs-number">1000</span>
shift=<span class="hljs-number">0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«ã€TensorFlowã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">init=tf.global_variables_initializer()<font></font>
<font></font>
<span class="hljs-keyword">with</span> tf.Session() <span class="hljs-keyword">as</span> sess:<font></font>
    sess.run(init)<font></font>
    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> range(epoch):<font></font>
        print(<span class="hljs-string">"Epoch {}:"</span>.format(epoch))
        <span class="hljs-keyword">if</span> shift + batch_size+<span class="hljs-number">1</span> &gt;= len(data):<font></font>
            shift =<span class="hljs-number">0</span>
        <span class="hljs-comment">#        </span>
        <span class="hljs-comment"># generate_batch,      shift,</span>
        <span class="hljs-comment">#   </span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(total_batch):<font></font>
            inputs,targets=generate_batch(batch_size,shift)<font></font>
            shift += batch_size<font></font>
            <span class="hljs-comment"># calculate loss</span>
            <span class="hljs-keyword">if</span>(i%<span class="hljs-number">100</span>==<span class="hljs-number">0</span>):<font></font>
                loss=sess.run(cross_entropy,feed_dict={X:inputs,<font></font>
Y:targets})<font></font>
                <span class="hljs-comment">#     </span>
                <span class="hljs-comment">#    predict</span>
index =predict(inputs[<span class="hljs-number">0</span>],<span class="hljs-number">200</span>)
                <span class="hljs-comment">#     ix_to_char</span>
                <span class="hljs-comment">#   </span>
                txt = <span class="hljs-string">''</span>.join(ix_to_char[ix] <span class="hljs-keyword">for</span> ix <span class="hljs-keyword">in</span> index)<font></font>
                print(<span class="hljs-string">'Iteration %i: '</span>%(i))
                <span class="hljs-keyword">print</span> (<span class="hljs-string">'\n %s \n'</span> % (txt, ))<font></font>
            sess.run(optimiser,feed_dict={X:inputs,Y:targets})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çµæœã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€åˆæœŸã®æ™‚ä»£ã§ã¯ã€å‡ºåŠ›ã¯ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ãŒã€å­¦ç¿’ã™ã‚‹ã«ã¤ã‚Œã¦ã€çµæœã¯å‘ä¸Šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">Epoch <span class="hljs-number">0</span>:<font></font>
Iteration <span class="hljs-number">0</span>:<font></font>
<font></font>
 wsadrpud,kpswkypeqawnlfyweudkgt,khdi nmgo<span class="hljs-string">f' u vnvlmbis .
snsblp,podwjqehb,e;g-
'</span>fyqjsyeg,byjgyotsrdf;;u,h.a;ik<span class="hljs-string">'sfc;dvtauofd.,q.;npsw'</span>wjy-quw<span class="hljs-string">'quspfqw-
.
.
.
Epoch 113:
Iteration 0:
i wanna see you, yes, and she said yes!</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‘—è€…ã«ã¤ã„ã¦</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudharsan Ravichandiran</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã¨åˆ†æã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã‚ã‚Šã€äººå·¥çŸ¥èƒ½ã¨ãƒ“ãƒ‡ã‚ªãƒ–ãƒ­ã‚¬ãƒ¼ã®ç†±çƒˆãªãƒ•ã‚¡ãƒ³ã§ã™ã€‚</font><font style="vertical-align: inherit;">å½¼ã¯ã‚¢ãƒ³å¤§å­¦ã§ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®å­¦å£«å·ã‚’å–å¾—ã—ã€è‡ªç„¶è¨€èªå‡¦ç†ã‚„ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãƒ“ã‚¸ãƒ§ãƒ³ãªã©ã®ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã‚„å¼·åŒ–å­¦ç¿’ã®å®Ÿç”¨çš„ãªå®Ÿè£…ã«é–¢ã™ã‚‹ç ”ç©¶ã«å¾“äº‹ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»¥å‰ã¯ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã®Webãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãŠã‚ˆã³é–‹ç™ºè€…ã¨ã—ã¦åƒãã€æ•°ã€…ã®å—è³æ­´ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã®ä½œæˆã«å‚åŠ ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ç¾åœ¨ã€ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‚åŠ ã—ã¦ãŠã‚Šã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack Overflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«é–¢ã™ã‚‹è³ªå•ã«ã‚ˆãå›ç­”ã—ã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§‘å­¦ç·¨é›†è€…ã«ã¤ã„ã¦</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sujit Pal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ãƒªãƒ¼ãƒ‰ã‚¨ãƒ«ã‚¼ãƒ“ã‚¢ã‚°ãƒ«ãƒ¼ãƒ—ã®æœ€æ–°ã®æŠ€è¡“é–‹ç™ºãƒãƒ¼ãƒ ã§ã‚ã‚‹Elsevier Labsã®ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ãƒªã‚µãƒ¼ãƒãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ã™ã€‚å½¼ã¯ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚µãƒ¼ãƒã€è‡ªç„¶è¨€èªå‡¦ç†ã€æ©Ÿæ¢°ã€ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®åˆ†é‡ã®ç ”ç©¶ã«å¾“äº‹ã—ã¦ã„ã¾ã™ã€‚ã‚¨ãƒ«ã‚¼ãƒ“ã‚¢ã§ã¯ã€æ¤œç´¢å“è³ªã®è©•ä¾¡ã¨æ”¹å–„ã€ç”»åƒã®åˆ†é¡ã¨é‡è¤‡ã®è­˜åˆ¥ã€æ³¨é‡ˆã€åŒ»å­¦ã¨ç§‘å­¦ã®ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¢ãƒ³ã‚½ãƒ­ã‚¸ãƒ¼ã®é–‹ç™ºãªã©ã€ã„ãã¤ã‹ã®ã‚¤ãƒ‹ã‚·ã‚¢ãƒãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å–ã‚Šçµ„ã¿ã¾ã—ãŸã€‚å½¼ã¯Antonio Gulliã¨ä¸€ç·’ã«ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®æœ¬ã‚’æ›¸ãã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salmon Run</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ–ãƒ­ã‚°ã§ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã«ã¤ã„ã¦æ›¸ã„ã¦ã„</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒªãƒ¤ãƒ‡ã‚£ãƒ‘ãƒ³ãƒ»ãƒ©ãƒãƒ ãƒ«ãƒ†ã‚£</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-äººå·¥çŸ¥èƒ½ã®ç ”ç©¶è€…ã§ã‚ã‚Šã€ãƒãƒ³ãƒ‡ã‚£ã‚·ã‚§ãƒªï¼ˆã‚¤ãƒ³ãƒ‰ï¼‰ã®AIç ”ç©¶è€…å…¼ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€‚å½¼ã®ä½œå“ã®ä¸»ãªãƒ†ãƒ¼ãƒã¯ã€è‡ªç„¶è¨€èªã®ç†è§£ã¨æ¨è«–ã®å½¢æˆã§ã™ã€‚å½¼ã¯ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ–ãƒ­ã‚°ã§åºƒç¯„å›²ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚ SAAMA Technologiesã§ã¯ã€é«˜åº¦ãªãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¦ç”Ÿç‰©åŒ»å­¦ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆ†æã—ã¦ã„ã¾ã™ã€‚ãƒ•ãƒªãƒ¼ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç†±å¿ƒãªã‚µãƒãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ã€å½¼ã¯FSFTNã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã®é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç©æ¥µçš„ã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ãƒ†ã‚£ãƒ–ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ã®è¦–è¦šåŒ–ã€ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ã‚‚èˆˆå‘³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Â»æœ¬ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ºç‰ˆç¤¾ã®Webã‚µã‚¤ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Â» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®æ¬¡</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Â» </font><font style="vertical-align: inherit;">
ãŠã„ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠœç²‹</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25ï¼…å‰²å¼•ã‚¯ãƒ¼ãƒãƒ³</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Python</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬ã®ç´™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ”¯æ‰•ã„æ™‚ã«ã€é›»å­æœ¬ã¯é›»å­ãƒ¡ãƒ¼ãƒ«ã§é€ã‚‰ã‚Œã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja465595/index.html">5GãŒç™»å ´ã—ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja465597/index.html">STM8Sã‚¹ãƒ­ãƒ¼ã‚¹ã‚¿ãƒ¼ãƒˆã®å­¦ç¿’ã€‚ãƒ‘ãƒ¼ãƒˆ0</a></li>
<li><a href="../ja465599/index.html">ç—›ã¿ã®ãªã„IPFSï¼ˆãŸã ã—ã€æ­£ç¢ºã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰</a></li>
<li><a href="../ja465601/index.html">DevOpsãŒå¿…è¦ãªç†ç”±ã¨DevOpsã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ</a></li>
<li><a href="../ja465603/index.html">ã‚³ãƒ¼ã‚¹å¯¾ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚·ãƒƒãƒ—ã€‚SimbirSoftã§ãƒŸãƒƒãƒ‰ãƒ™ãƒ«ã‚’æ•™ãˆã‚‹ã«ã¯</a></li>
<li><a href="../ja465609/index.html">2019å¹´12æœˆ1æ—¥ã®1C-BitrixãŒã‚«ãƒœãƒãƒ£ã«å¤‰ã‚ã‚‹ç†ç”±</a></li>
<li><a href="../ja465611/index.html">ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã®ãŸã‚ã®éŸ³æ¥½</a></li>
<li><a href="../ja465613/index.html">Golangé…åˆ—ã¨ã‚¹ãƒ©ã‚¤ã‚¹ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰</a></li>
<li><a href="../ja465615/index.html">ã‚¹ãƒãƒ¼ãƒˆãƒ­ãƒƒã‚¯ï¼šãã‚Œã‚‰ãŒä½•ã§ã‚ã‚‹ã‹ã€ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ï¼ˆãã—ã¦èª°ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‹ï¼‰</a></li>
<li><a href="../ja465617/index.html">Got Juno Meetup-9æœˆ12æ—¥ã€ãƒŸãƒ³ã‚¹ã‚¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>