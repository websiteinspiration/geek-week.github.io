<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ป โ๏ธ โซ๏ธ ุชุญุทู ุงููุตุต ูุน Patroni ุ ุฃู ููููุฉ ุฅุณูุงุท ูุฌููุนุฉ PostgreSQL ๐ฉ๐ฟโ๐คโ๐ฉ๐ผ ๐ผ ๐จ๐ปโโ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PostgreSQL ููุณ ูุฏูู ุชูุงูุฑ ุนุงูู ุฎุงุฑุฌ ุงูุตูุฏูู. ูุชุญููู HA ุ ุชุญุชุงุฌ ุฅูู ูุถุน ุดูุก ูุง ุ ูุฅุนุฏุงุฏ - ุจุฐู ุฌูุฏ. ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงูุชู ูููู ุฃู ุชุณุงุนุฏ ูู ุฒูุงุฏุฉ ุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุชุญุทู ุงููุตุต ูุน Patroni ุ ุฃู ููููุฉ ุฅุณูุงุท ูุฌููุนุฉ PostgreSQL</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/489206/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL ููุณ ูุฏูู ุชูุงูุฑ ุนุงูู ุฎุงุฑุฌ ุงูุตูุฏูู. ูุชุญููู HA ุ ุชุญุชุงุฌ ุฅูู ูุถุน ุดูุก ูุง ุ ูุฅุนุฏุงุฏ - ุจุฐู ุฌูุฏ. ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงูุชู ูููู ุฃู ุชุณุงุนุฏ ูู ุฒูุงุฏุฉ ุชูุงูุฑ PostgreSQL ุ ูุฃุญุฏูุง ูู Patroni. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุฉ ุงูุฃููู ุ ุจูุถุน Patroni ูู ุจูุฆุฉ ุงุฎุชุจุงุฑ ุ ููููู ุฃู ุชุฑู ูุง ูู ุงูุฃุฏุงุฉ ุงูุฑุงุฆุนุฉ ูููู ุชุชุนุงูู ุจุณูููุฉ ูุน ูุญุงููุงุชูุง ูุชูููู ุงููุชูุฉ. ูููู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ุ ูุง ูุญุฏุซ ูู ุดูุก ุฏุงุฆููุง ุจุดูู ุฌููู ูุฃููู. ุจุฏุฃุช Data Egret ูู ุงุณุชุฎุฏุงู Patroni ูู ููุงูุฉ ุนุงู 2018 ูุงูุชุณุจุช ุจุนุถ ุงูุฎุจุฑุฉ: ููููุฉ ุชุดุฎูุตูุง ูุชูููููุง ููุชู ูุง ุชุนุชูุฏ ุนูู ุจุฑูุงูุฌ ุงูุชุณุฌูู ุงูุชููุงุฆู ุนูู ุงูุฅุทูุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู HighLoad ++ ุ ูุตู ุฃูููุณู ููุณููุณูู ุจุงูุชูุตูู ุ ุจุงุณุชุฎุฏุงู ุงูุฃูุซูุฉ ูุชุญููู ุงูุณุฌูุงุช ุ ูุงููุดููุงุช ุงููููุฐุฌูุฉ ุงูุชู ุชูุดุฃ ุนูุฏ ุงูุนูู ูุน Patroni ุ ูุฃูุถู ุงูููุงุฑุณุงุช ููุชุบูุจ ุนูููุง.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lqh1eJwVPtk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ุงูููุงูุฉ ูุง: ุชุนูููุงุช ุงูุชุซุจูุช ุจุงุชุฑูููู ูุฃูุซูุฉ ุงูุชูููู ุ </font><font style="vertical-align: inherit;">ูุดุงูู ุฎุงุฑุฌ Patroni ู PostgreSQL ุ </font><font style="vertical-align: inherit;">ูุตุต ุชุณุชูุฏ ุฅูู ุชุฌุงุฑุจ ุงูุขุฎุฑูู ุ ูููู ููุท ุชูู ุงููุดุงูู ุงูุชู ุงูุชุดูุชูุง Data Egret ูุฃููุณูู.</font></font><br>
<a name="habracut"></a><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูู ุงููุชุญุฏุซ:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃูููุณู ููุณููุณูู (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณููุณูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ููุฏูุฑ ูุธุงู (ูุณุคูู ูุธุงู Linux) ุ ูุนูู ูู ุชุทููุฑ ุงูููุจ (ูุณุคูู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL). </font><font style="vertical-align: inherit;">ุชุนูู ููุฐ ุนุงู 2014 ูู Data Egret. </font><font style="vertical-align: inherit;">ุชุนูู Data Egret ูู ูุฌุงู ุงูุงุณุชุดุงุฑุงุช ูู ูุฌุงู PostgreSQL ุ ูุชุณุงุนุฏ ุงูุนุฏูุฏ ูุงูุนุฏูุฏ ูู ุงูุดุฑูุงุช ุนูู ุงุณุชุฎุฏุงู PostgreSQL ุจุดูู ุตุญูุญ ุ ูุจุงูุทุจุน ุ ุงูุชุณุจุช ุฎุจุฑุฉ ูุงุณุนุฉ ูู ุชุดุบูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุฑูุฑ ุงูุฐู ุชุณุชูุฏ ุฅููู ูุฐู ุงูููุงูุฉ ูุณูู "ูุตุต ูุดู Patroni ุฃู ููููุฉ ุชุนุทู ูุฌููุนุฉ PostgreSQL" ุ ููุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุงุจุท ููุนุฑุถ ุงูุชูุฏููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ุงู ุชุจุฏุง</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูู ุฃุฐูุฑู ูุง ูู Patroni ุ ููุง ูู ุงูููุตูุฏ ุจู ููุง ูููู ุฃู ููุนูู. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patroni ูู ูุงูุจ ูุจูุงุก HA ุฎุงุฑุฌ ุงูุตูุฏูู.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฐุง ููู ููุชูุจ ูู ุงููุซุงุฆู ููู ูุฌูุฉ ูุธุฑู - ูุฐุง ุชูุถูุญ ุตุญูุญ ููุบุงูุฉ. ุฃู ุฃู Patroni ููุณ ุฑุตุงุตุฉ ูุถูุฉ ุญุฏุฏูุง ูุณูุญู ุฌููุน ุงููุดุงูู. ูู ุงูุถุฑูุฑู ุจุฐู ุงูุฌููุฏ ุญุชู ุชุจุฏุฃ ูู ุงูุนูู ูุฌูุจ ุงูููุงุฆุฏ. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patroni - ุฎุฏูุฉ ุงููููู.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุชุซุจูุชู ุนูู ูู ุฎุงุฏู ุจูุงุนุฏุฉ ุจูุงูุงุช ููู ููุน ูู ูุธุงู ุงูุชููุฆุฉ ูู PostgreSQL: ููู ูุจุฏุฃ ุ ููููู ุ ููุนูุฏ ุงูุชุดุบูู ุ ููุบูุฑ ุงูุชูููู ูุงูุทุจูููุฌูุง ูููุชูุฉ. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุฒู Patroni "ุญุงูุฉ ุงููุชูุฉ" ูู DCS.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฎุฒูู ุญุงูุฉ ุงููุชูุฉ ุ ุทุฑููุฉ ุงูุนุฑุถ ุงูุญุงููุฉ ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฎุฒูู. </font><font style="vertical-align: inherit;">ูุฎุฒู Patroni ุงูุฏููุฉ ูู ูุธุงู ุฎุงุฑุฌู - ูุณุชูุฏุน ุงูุชูููู ุงูููุฒุน. </font><font style="vertical-align: inherit;">ูููู ุฃู ูููู ูุฐุง ุฃุญุฏ ุงูุฎูุงุฑุงุช: Etcd ุฃู Consul ุฃู ZooKeeper ุฃู Etcd Kubernetes. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชูููู ููู Patroni AutoFile ุจุดูู ุงูุชุฑุงุถู. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุตู ุนูู ุจุฑูุงูุฌ ุชุณุฌูู ุชููุงุฆู ูู ุงูุนูุจุฉ ุ ููุฑ ุชุซุจูุช Patroni. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุงูุฃุฎุฑู ุ ูุซู: ุฎุฏูุฉ ุงูุชููููุงุช ูุฅูุดุงุก ูุณุฎ ูุชูุงุซูุฉ ุฌุฏูุฏุฉ ูุงููุณุฎ ุงูุงุญุชูุงุทู ููุง ุฅูู ุฐูู. </font><font style="vertical-align: inherit;">ูููู ูุฐู ุงููุฑุฉ ุณุชุจูู ุฎุงุฑุฌ ูุทุงู ุงูุชูุฑูุฑ.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฏู ุงูุฑุฆูุณู ูู Patroni ูู ุชูููุฑ ููู ุชููุงุฆู ููุซูู ุจู.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุชุนูู ุนูู Patroni ูุฑุงูุจุฉ ุงููุนุฏุงุช ุ ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุ ูุงูููุงู ุจุฃุดูุงุก ูุนูุฏุฉ ุญูู ุงูููุงูุฉ ูู ุงูุญูุงุฏุซ ุงููุญุชููุฉ ุ ุฅูุฎ. </font><font style="vertical-align: inherit;">ูุทููุจ ุฃู ุชุธู ุงููุฌููุนุฉ ููุฏ ุงูุชุดุบูู ููููู ุฃู ูุณุชูุฑ ุงูุชุทุจูู ูู ุงูุนูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุจุบุถ ุงููุธุฑ ุนู ุฃู ุชุบููุฑุงุช ูู ุทูุจูููุฌูุง ุงููุชูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุนูุฏูุง ูุจุฏุฃ ูู ุงุณุชุฎุฏุงู Patroni ูุน PostgreSQL ุ ูุตุจุญ ูุธุงููุง ุฃูุซุฑ ุชุนููุฏูุง. </font><font style="vertical-align: inherit;">ุงูุขู ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุณูุง ุ ุนูุฏูุง ููุดู ุงูุฑุฆูุณู ุฃู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูุฏ ูููุงุฑ Patroni ููุณู ุ ุงูุชุฎุฒูู ุงูููุฒุน ูุญุงูุงุช ุงููุชูุฉ ุ ุฃู ุงูุดุจูุฉ. </font><font style="vertical-align: inherit;">ุถุน ูู ุงุนุชุจุงุฑู ุฌููุน ุงูุฎูุงุฑุงุช ูุฃููุง ุชุตุจุญ ุฃูุซุฑ ุชุนููุฏูุง ูู ุญูุซ ูุฏู ุตุนูุจุฉ ููู ุฃุณุจุงุจูุง.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุดููุฉ 1. DBMS ู DCS ุนูู ููุณ ุงููุชูุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุธุฑ ูู ุฃุจุณุท ุงูุญุงูุงุช: ุฃุฎุฐูุง ูุฌููุนุฉ ูุงุนุฏุฉ ุจูุงูุงุช ููุดุฑูุง DCS ุนูู ููุณ ุงููุฌููุนุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ุงูุฎุทุฃ ุงูุดุงุฆุน ูุง ูุฑุชุจุท ููุท ุจุฃุฎุทุงุก ูุดุฑ PostgreSQL ู Patroni. </font><font style="vertical-align: inherit;">ูุฐุง ุฎุทุฃ ูู ุงูุจูุงุก ุงูุนุงู ูููุนูุงุฑูุงุช - ูุฌูุน ุจูู ุงูุนุฏูุฏ ูู ุงูููููุงุช ุงููุฎุชููุฉ ูู ููุงู ูุงุญุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุ ูุงู ููุงู ูุดู. </font><font style="vertical-align: inherit;">ูุจุฏุฃ ูู ููู ูุง ุญุฏุซ. </font><font style="vertical-align: inherit;">ููุง ูุญู ููุชููู ุจููุช ุญุฏูุซ ุงูุนุงุดู ุ ุฃู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุทุฉ ุงูุฒูููุฉ ุงูุชู ุชุบูุฑุช ูููุง ุญุงูุฉ ุงูุนูููุฏ.</font></font></strong><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุญุฏุซ ุงููุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูุญุฏุซ faylover ุฏุงุฆููุง ุนูู ุงูููุฑ ุ ููุฏ ูุณุชุบุฑู ููุชูุง ุทูููุงู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฏูู ููุช ุงูุจุฏุก ูููุช ุงูุงูุชูุงุก. </font><font style="vertical-align: inherit;">ุชููุณู ุฌููุน ุงูุฃุญุฏุงุซ ุฅูู "ูุจู" ู "ุฃุซูุงุก" ู "ุจุนุฏ" ุงูุนุงุดู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุนูุฏูุง ุญุฏุซ ุงูุนุงุดู ุ ูุญู ูุจุญุซ ุนู ุงูุณุจุจ.</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni: INFO: promoted self to leader by acquiring session lock<font></font>
pgdb-2 patroni: WARNING: Loop time exceeded, rescheduling immediately.<font></font>
pgdb-2 patroni: INFO: Lock owner: pgdb-2; I am pgdb-2<font></font>
pgdb-2 patroni: INFO: updated leader lock during promote<font></font>
pgdb-2 patroni: server promoting<font></font>
pgdb-2 patroni: INFO: cleared rewind state after becoming the leader<font></font>
pgdb-2 patroni: INFO: Lock owner: pgdb-2; I am pgdb-2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุนูุงู ูู ุณุฌูุงุช Patroni ุงูููุงุณูุฉ ุ ุญูุซ ุฃุจูุบ ุนู ุชุบูุฑ ุฏูุฑ ุงูุฎุงุฏู ูุงูุชูู ุฏูุฑ ุงููุนุงูุฌ ูู ุขุฎุฑ ุฅูู ูุฐู ุงูุนูุฏุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ุญุฏุซ ุงููุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ููู ุงูุฃุญุฏุงุซ ุงูุชู ุฌุนูุช ุฏูุฑ ุงููุนูู ููุชูู ูู ุนูุฏุฉ ุฅูู ุฃุฎุฑู ุ ููุง ุญุฏุซ ููุณูุฏ ุงููุฏูู.</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni: patroni.utils.RetryFailedError: 'Exceeded retry deadline'<font></font>
pgdb-2 patroni: ERROR: Error communicating with DCS<font></font>
pgdb-2 patroni: INFO: demoted self because DCS is not accessible and i was a leader<font></font>
pgdb-2 patroni: WARNING: Loop time exceeded, rescheduling immediately.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุดูุก ุจุณูุท: </font></font><code>Error communicating with DCS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุฎุทุฃ ูู ุงูุชูุงุนู ูุน ูุธุงู ุชุฎุฒูู ุงูุชูููู. </font><font style="vertical-align: inherit;">ุฃุฏุฑู ุงูุณูุฏ ุฃูู ูุง ูุณุชุทูุน ุงูุนูู ูุน DCS ุ ููุงู ุฅูู ูู ูุนุฏ ุจุฅููุงูู ุฃู ูููู ุณูุฏูุง ูุงุณุชูุงู. </font></font><code>demoted self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญุฏุซ ุนู ูุฐุง.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุณุจู ุงูุนุงุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุธุฑุช ุฅูู ุงูุฃุญุฏุงุซ ุงูุชู ุณุจูุช feylover ุ ููููู ุฑุคูุฉ ุงูุฃุณุจุงุจ ุงูุชู ุฃุตุจุญุช ูุดููุฉ ูู ุงุณุชูุฑุงุฑ ุงููุนุงูุฌ:</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni: ERROR: touch_member<font></font>
                ... python trace <font></font>
pgdb-2 patroni: socket.timeout: timed out <font></font>
pgdb-2 patroni: During handling of the above exception, another exception occurred:<font></font>
                ... python trace <font></font>
pgdb-2 patroni:   raise ReadTimeoutError(self, url, "Read timed out. (read timeout=%s)" % timeout_value) <font></font>
pgdb-2 patroni: urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='127.0.0.1', port=8500): Read timed out. (read timeout=3.3333333333333335) <font></font>
pgdb-2 patroni: During handling of the above exception, another exception occurred:<font></font>
                ... python trace <font></font>
pgdb-2 patroni:     raise MaxRetryError(_pool, url, error or ResponseError(cause)) <font></font>
pgdb-2 patroni: urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=8500): Max retries exceeded with url: /v1/kv/service/pgdb/members/pgdb-2?acquire=19598b72-c0d5-f066-5d24-09c1a9ad61ee&amp;dc=maindb (Caused by ReadTimeoutError("HTTPConnectionPool(host='127.0.0.1', port=8500): Read timed out. (read timeout=3.3333333333333335)",)) <font></font>
pgdb-2 patroni: INFO: no action.  i am the leader with the lock <font></font>
pgdb-2 patroni: WARNING: Loop time exceeded, rescheduling immediately.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุธูุฑ ุณุฌูุงุช Patroni ุงููุซูุฑ ูู ุฃุฎุทุงุก ุงููููุฉ ุงููุฎุชููุฉ. </font><font style="vertical-align: inherit;">ุชุนุฐุฑ ุนูู ูููู Patroni ุงูุนูู ูุน DCS (ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุงูููุตู ุ ุงููููุฐ = 8500). </font><font style="vertical-align: inherit;">ุชู ุชุดุบูู Patroni ููุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู ููุณ ุงููุถูู ุ ููุงูุช ุฎูุงุฏู ุงูููุตู ุชุนูู ุนูู ููุณ ุงููุถูู. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฅูุดุงุก ุงูุญูู ุนูู ุงูุฎุงุฏู ุ ุฃูุดุฃูุง ุฃูุถูุง ูุดุงูู ูุฎุงุฏู ุงูููุตู ุ ุญูุซ ูู ูุชููููุง ูู ุงูุชูุงุตู ุจุดูู ุทุจูุนู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุดูุก ุนุงุฏ ููุง ูุงู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ูุชุฑุฉ ุ ุนูุฏูุง ุฎู ุงูุญูู ุ ุชููู Patroni ูู ุงูุชูุงุตู ูุฑุฉ ุฃุฎุฑู ูุน ุงููููุงุก ุ ูุงุณุชุฃูู ูู ุดูุก:</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni: INFO: promoted self to leader by acquiring session lock<font></font>
pgdb-2 patroni: WARNING: Loop time exceeded, rescheduling immediately.<font></font>
pgdb-2 patroni: INFO: Lock owner: pgdb-2; I am pgdb-2<font></font>
pgdb-2 patroni: INFO: updated leader lock during promote<font></font>
pgdb-2 patroni: server promoting<font></font>
pgdb-2 patroni: INFO: cleared rewind state after becoming the leader<font></font>
pgdb-2 patroni: INFO: Lock owner: pgdb-2; I am pgdb-2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุตุจุญ ุฎุงุฏู pgdb-2 ูุฑุฉ ุฃุฎุฑู ุณูุฏูุง. </font><font style="vertical-align: inherit;">ูุงู ููุงู "ููุจ" ุตุบูุฑ - ูู ููุช ูุตูุฑ ูุณุจููุง ุงุณุชูุงู ูู ููุณู ุจุงุนุชุจุงุฑู ุณูุฏูุง ุ ุซู ุฃุฎุฐูุง ูุฑุฉ ุฃุฎุฑู ุนูู ููุณู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงุนุชุจุงุฑ ูุฐุง ุฅูุง ุฅูุฌุงุจููุง ูุงุฐุจูุง ุ ุฃู ุญูููุฉ ุฃู Patroni ูุนู ูู ุดูุก ุจุดูู ุตุญูุญ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุฑูุง ูุฃููุณูุง ุฃู ุงููุดููุฉ ุชููู ูู ุฃู ุฎูุงุฏู ุงูููุตู ุนูู ููุณ ุงูุฃุฌูุฒุฉ ูุซู ููุงุนุฏ ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ููููุง ูุฐูู ุ ูุฅู ุฃู ุญูู ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูุงูุฃูุฑุงุต (ุทูุจ ุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ูุซูู ุ ูููุงุช ูุคูุชุฉ ุ ุงููุฑุงุบุงุช ุงูุชููุงุฆูุฉ ุ ุงูุชุฑุญูู ุ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุ ุฅูุฎ) ูุคุซุฑ ุฃูุถูุง ุนูู ุงูุชูุงุนู ูุน ูุฌููุนุฉ ุงูููุตู. </font><font style="vertical-align: inherit;">ูุฑุฑูุง ุฃู ูุฐุง ูุง ููุจุบู ุฃู ูุนูุด ุนูู ููุณ ุงููุนุฏุงุช ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุฎุตุตูุง ูุฌููุนุฉ ูููุตูุฉ ููููุตู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏูุงู ูู ุฐูู ุ ููููู ุชุฏููุฑ ุงููุนููุงุช </font></font><code>ttl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>loop_wait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>retry_timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุญุงูู ุจุณุจุจ ุฒูุงุฏุชูุง ูู ุฃุฌู ุชุญูู ุฃุญูุงู ุงูุฐุฑูุฉ ูุตูุฑุฉ ุงููุฏู. </font><font style="vertical-align: inherit;">ูููู ุฅุฐุง ูุงู ุงูุญูู ุทููููุง ุ ูุณูู ูุชุฌุงูุฒ ูุฐู ุงููุนููุงุช ุ ููู ุชุนูู ุงูุทุฑููุฉ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดููุฉ 2. ุงููุทุงุน</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุดููุฉ ุงูุซุงููุฉ ุชุดุจู ุงููุดููุฉ ุงูุฃููู ุญูุซ ูุฏููุง ูุฑุฉ ุฃุฎุฑู ูุดุงูู ูู ุงูุชูุงุนู ูุน ูุธุงู DCS:</font></font><br>
<br>
<pre><code class="xml hljs">maindb-1 patroni: ERROR: get_cluster <font></font>
maindb-1 patroni: Traceback (most recent call last):<font></font>
                ... python trace <font></font>
maindb-1 patroni: RetryFailedError: 'Exceeded retry deadline' <font></font>
maindb-1 patroni: ERROR: Error communicating with DCS <font></font>
maindb-1 patroni: INFO: closed patroni connection to the postgresql cluster <font></font>
maindb-1 patroni: INFO: postmaster pid=214121 <font></font>
... <font></font>
... <font></font>
maindb-1 patroni: INFO: demoted self because DCS is not accessible and i was a leader <font></font>
maindb-1 patroni: WARNING: Loop time exceeded, rescheduling immediately.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู Patroni ูุฑุฉ ุฃุฎุฑู ุฃูู ูุง ููููู ุงูุชูุงุนู ูุน DCS ุ ูุฐูู ูุชููู ุงููุนูู ุงูุญุงูู ุนู ูููู ุณูุฏูุง ููุฏุฎู ูู ูุถุน ุงููุณุฎ ุงููุชูุงุซูุฉ. </font><font style="vertical-align: inherit;">ูุตุจุญ ุงูุณูุฏ ุงููุฏูู ูุณุฎุฉ ุทุจู ุงูุฃุตู:</font></font><br>
<br>
<pre><code class="xml hljs">maindb-1 patroni: INFO: Lock owner: maindb-2; I am maindb-1 <font></font>
maindb-1 patroni: INFO: does not have lock <font></font>
maindb-1 patroni: INFO: running pg_rewind from maindb-2 <font></font>
maindb-1 patroni: INFO: running pg_rewind from user=postgres host=192.168.11.18 port=5432 ... <font></font>
maindb-1 patroni: servers diverged at WAL location 1FA/A38FF4F8 on timeline 6 <font></font>
maindb-1 patroni: rewinding from last common checkpoint at 1FA/A38FF450 on timeline 6 <font></font>
maindb-1 patroni: INFO: Lock owner: maindb-2; I am maindb-1 <font></font>
maindb-1 patroni: INFO: running pg_rewind from maindb-2 in progress <font></font>
maindb-1 patroni: Done!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ูุนูู Patroni ููุง ููุจุบู - ูุชู ุฅุทูุงูู </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฑุฌูุน ุณุฌู ุงููุนุงููุงุช ุ ุซู ุงูุงุชุตุงู ุจุงูุณูุฏ ุงูุฌุฏูุฏ ูุงููุญุงู ุจุงููุนู ุจุงูุณูุฏ ุงูุฌุฏูุฏ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุณุจู ุงูุนุงุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฌุฏ ุฃูู ุดูุก ูุณุจู feylover - ุงูุฃุฎุทุงุก ุงูุชู ุชุณุจุจุช ููู. </font><font style="vertical-align: inherit;">ุชุนุชุจุฑ ุณุฌูุงุช Patroni ููุงุฆูุฉ ูู ูุฐุง ุงูุตุฏุฏ: ููุชุจ ููุณ ุงูุฑุณุงุฆู ุจูุงุตู ุฒููู ูุนูู. </font><font style="vertical-align: inherit;">ููููู ุชูุฑูุฑูุง ุจุณุฑุนุฉ ููุนุฑูุฉ ูุชู ุชุบูุฑุช ุงูุณุฌูุงุช. </font><font style="vertical-align: inherit;">ุนูุฏ ูุฐู ุงูููุทุฉ ุ ุจุฏุฃุช ุจุนุถ ุงููุดุงูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุถุน ุงูุนุงุฏู ุ ุชุจุฏู ุณุฌูุงุช Patroni ุนูู ุงููุญู ุงูุชุงูู:</font></font><br>
<br>
<pre><code class="xml hljs">maindb-1 patroni: INFO: Lock owner: maindb-1; I am maindb-1<font></font>
maindb-1 patroni: INFO: no action. i am the leader with the lock<font></font>
maindb-1 patroni: INFO: Lock owner: maindb-1; I am maindb-1<font></font>
maindb-1 patroni: INFO: no action. i am the leader with the lock</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ูุญุต ูุงูู ุงูููู ุ ุฅุฐุง ุชุบูุฑ ุ ููุฏ ุชุญุฏุซ ุฃุญุฏุงุซ ูุฌุจ ุนูู Patroni ุงูุงุณุชุฌุงุจุฉ ููุง. ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุดูุก ูู ูุญูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุงูุชูุฑูุฑ ุฅูู ุงูููุงู ุงูุฐู ุจุฏุฃุช ููู ุงูุฃุฎุทุงุก ูู ุงูุธููุฑ ุ ูุฑู ุญุฏูุซ ููู ุชุณุฌูู ุชููุงุฆู. ูุธุฑูุง ูุฃู ุงูุฃุฎุทุงุก ูุงูุช ูุฑุชุจุทุฉ ุจุงูุชูุงุนู ูุน DCS ุ ูุฅููุง ููุธุฑ ุฃูุถูุง ุฅูู ุณุฌูุงุช ุงูููุตู - ูุง ุญุฏุซ ููุงู. ุนูุฏ ููุงุฑูุฉ ููุช faylover ุชูุฑูุจูุง ูุงูููุช ูู ุณุฌูุงุช ุงูููุตู ุ ูุฑู ุฃู ุงูุฌูุฑุงู ูู ูุฌููุนุฉ ุงูููุตู ุจุฏุฃูุง ูุดููู ูู ูุฌูุฏ ูุดุงุฑููู ุขุฎุฑูู:</font></font><br>
<br>
<pre><code class="xml hljs">maindb-2 consul[11581]: serf: EventMemberFailed: maindb-1 192.168.11.19<font></font>
maindb-2 consul[11581]: [INFO] serf: EventMemberFailed: maindb-1 192.168.11.19<font></font>
maindb-2 consul[11581]: memberlist: Suspect maindb-1 has failed, no acks received<font></font>
maindb-2 consul[11581]: [INFO] memberlist: Suspect maindb-1 has failed, no acks received</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุธุฑุช ุฅูู ุณุฌูุงุช ูููุงุก ุงูููุตู ุงูุขุฎุฑูู ุ ูุฅูู ููุถุญ ุฃูุถูุง ุฃู ููุงู ุงูููุงุฑูุง ูู ุงูุดุจูุฉ: ูุดู ุฌููุน ุฃุนุถุงุก ูุฌููุนุฉ ุงูููุตู ูู ุจุนุถูู ุงูุจุนุถ. </font><font style="vertical-align: inherit;">ูุงู ูุฐุง ูู ุงูุฏุงูุน ู feylover. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุธุฑูุง ุฅูู ุงูุฅุฏุฎุงูุงุช ุงูุณุงุจูุฉ ุ ูุณูู ูุฑู ุฃู ูุธุงู ุงูููุตู ุงูุฎุงุต ุจูููู PostgreSQL ููุงุฌู ุตุนูุจุงุช ูู ุงูุงุชุตุงู ( </font></font><code>deadline reached</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>RPC failed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="xml hljs">maindb-1 consul: memberlist: Suspect lbs-4 has failed, no acks received<font></font>
maindb-1 consul: [ERR] yamux: keepalive failed: i/o deadline reached<font></font>
maindb-1 consul: yamux: keepalive failed: i/o deadline reached<font></font>
maindb-1 consul: [ERR] consul: "KVS.List" RPC failed to server 192.168.11.115:8300: rpc error making call: EOF<font></font>
maindb-1 consul: [ERR] http: Request GET /v1/kv/service/sam_prod/?recurse=1, error: rpc error making call: EOF from=192.168.11.19<font></font>
maindb-1 consul: [ERR] consul: "KVS.List" RPC failed to server 192.168.11.115:8300: rpc error making call: EOF<font></font>
maindb-1 consul: [ERR] agent: Coordinate update error: rpc error making call: EOF<font></font>
maindb-1 consul: [ERR] http: Request GET /v1/kv/service/sam_prod/?recurse=1, error: rpc error making call: EOF from=192.168.11.19</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุจุณุท ุฅุฌุงุจุฉ ูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุตูุงุญ ุงูุดุจูุฉ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูู ุงูุณูู ุชูุฏูู ุงููุดูุฑุฉ ุ ููู ุงูุธุฑูู ูููู ุฃู ุชููู ูุฎุชููุฉ ุ ููุฐุง ููุณ ูููููุง ุฏุงุฆููุง. </font><font style="vertical-align: inherit;">ูููู ุฃู ูุนูุด ุงููุธุงู ูู ูุฑูุฒ ุจูุงูุงุช ุ ุญูุซ ูุง ูููููุง ุงูุชุฃุซูุฑ ุนูู ุงููุนุฏุงุช. </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฅูู ุฎูุงุฑุงุช ุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุฎูุงุฑุงุช ุญู ุฏูู ุงูุนูู ูุน ุดุจูุฉ:</font></font><br>
<br>
<ul>
<li><strong> Consul-</strong> โ <code>checks: []</code>.<br>
   ,     .    ,    Consul-    .           .</li>
<li><strong></strong> <code>raft_multiplier</code>.<br>
   Consul-,     5 (      staging-).         Consul-.  -   .</li>
<li><strong></strong> <code>renice -n -10 consul</code>.<br>
        .  renice   .          Consul-,             .</li>
<li><strong>   consul?</strong><br>
Consul-         . Patroni   Consul-    ,     :    - ,  Patroni      .   etcd,     ,    etcd   . Patroni      etcd-.    -  ,     ,   ,     Consul.</li>
<li><strong>  </strong> <code>ttl, loop_wait, retry_timeout</code>.<br>
     ,         .     Patroni       .</li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุดููุฉ 3. ููุฏุงู ุงูุนูุฏุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ููุช ุชุณุชุฎุฏู Patroni ุ ูุฃูุช ุนูู ุฏุฑุงูุฉ ุจุฃูุฑ ูุงุฆูุฉ patronictl ุ ูุงูุฐู ููุถุญ ุงูุญุงูุฉ ุงูุญุงููุฉ ูููุชูุฉ:</font></font><br>
<br>
<pre><code class="xml hljs">$ patronictl list<font></font>
<font></font>
+-----------------+-------------------------+--------------+--------+---------+-----------+<font></font>
|     Cluster     |          Member         |     Host     |  Role  |  State  | Lag in MB |<font></font>
+-----------------+-------------------------+--------------+--------+---------+-----------+<font></font>
| patroni_cluster | pg01.dev.zirconus.local | 10.202.1.101 |        | running |    0.0    |<font></font>
| patroni_cluster | pg03.dev.zirconus.local | 10.202.1.103 | Leader | running |    0.0    |<font></font>
+-----------------+-------------------------+--------------+--------+---------+-----------+<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุฉ ุงูุฃููู ุ ูุฏ ูุจุฏู ูุฐุง ุงูุงุณุชูุชุงุฌ ุทุจูุนููุง - ููุงู ูุณุฎุฉ ุทุจู ุงูุฃุตู ุ ูููู ูุง ููุฌุฏ ุชุฃุฎุฑ ูู ุงููุณุฎ ุงููุชูุงุซู. </font><font style="vertical-align: inherit;">ููู ูุฐู ุงูุตูุฑุฉ ุทุจูุนูุฉ ุชูุงููุง ุญุชู ูุนุฑู ุฃูู ูู ูุฐู ุงููุฌููุนุฉ ูุฌุจ ุฃู ูููู ููุงู 3 ุนูุฏ ุ ูููุณ 2.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ุญุฏุซ ุงููุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ูุชููู ุฃูู ุญุฏุซ ุจุฑูุงูุฌ ุชุณุฌูู ุชููุงุฆู ูุจุนุฏ ุฐูู ุงุฎุชูุช ูุณุฎุฉ ุทุจู ุงูุฃุตู. </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุณุจุจ ุงุฎุชูุงุฆูุง ูุฅุนุงุฏุชูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏุฑุณ ุงูุณุฌูุงุช ูุฑุฉ ุฃุฎุฑู ูููู ุณุจุจ ุญุฏูุซ ุจุฑูุงูุฌ ุงูุชุณุฌูู ุงูุชููุงุฆู:</font></font><br>
<br>
<pre><code class="xml hljs">pg02 patroni[1425]: ERROR: failed to update leader lock<font></font>
pg02 patroni[1425]: INFO: demoted self because failed to update leader lock in DCS<font></font>
pg02 patroni[1425]: WARNING: Loop time exceeded, rescheduling immediately.<font></font>
pg02 patroni[1425]: INFO: Lock owner: None; I am pg02.dev.zirconus.local<font></font>
pg02 patroni[1425]: INFO: not healthy enough for leader race<font></font>
pg02 patroni[1425]: INFO: starting after demotion in progress</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุนุฐุฑ ุนูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ pg02 ุชุญุฏูุซ ุงูููุชุงุญ ุงูุฑุฆูุณู </font></font><code>ERROR: failed to update leader lock</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ุฃุตุจุญุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูุซุงููุฉ ูู db03 ุงูุฑุฆูุณูุฉ ุ ูู ุดูุก ููุง ุจุงูุชุฑุชูุจ:</font></font><br>
<br>
<pre><code class="xml hljs">pg03 patroni[9648]: INFO: promoted self to leader by acquiring session lock<font></font>
pg03 patroni[9648]: server promoting<font></font>
pg03 patroni[9648]: INFO: cleared rewind state after becoming the leader</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ุนู ุงูุณูุฏ ุงููุฏููุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุฃ pg02 ุ ุงูุฐู ูุฑุฑ ุฃู ูุตุจุญ ูุณุฎุฉ ุทุจู ุงูุฃุตู ุ ุจุฅุนุงุฏุฉ ูู ุณุฌู ุงููุนุงููุงุช. </font><font style="vertical-align: inherit;">ููุง ูุญุชุงุฌ ุฅูู ุฅููุงุก ูุธุฑุฉ ุนูู ุณุฌูุงุช ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ุงูุชู ููุณุช ูู ุงููุชูุฉ. </font><font style="vertical-align: inherit;">ุงูุชุญ ุณุฌูุงุช Patroni ูุดุงูุฏ ุฃูู ุฃุซูุงุก ุนูููุฉ ุงูุงุชุตุงู ุจุงููุฌููุนุฉ ุ ุธูุฑุช ูุดููุฉ ูู ุงููุฑุญูุฉ </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="xml hljs">pg02 patroni[1425]: INFO: running pg_rewind from pg03<font></font>
pg02 patroni[1425]: INFO: running pg_rewind from user=postgres host=10.202.1.103 port=5432 ...<font></font>
pg02 patroni[1425]: servers diverged at WAL location 33F/68E6AD10 on timeline 28<font></font>
pg02 patroni[1425]: could not open file "/data/pgdb/11/pg_wal/0000001C0000033F00000059": No such file or directory<font></font>
pg02 patroni[1425]: could not find previous WAL record at 33F/59FFE368 pg02 patroni[1425]: Failure, exiting<font></font>
pg02 patroni[1425]: ERROR: Failed to rewind from healty master: pg03<font></font>
pg02 patroni[1425]: WARNING: Postgresql is not running.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุชุตุงู ุจุงููุฌููุนุฉ ุ ูุฌุจ ุฃู ุชุทูุจ ุงูุนูุฏุฉ ุณุฌู ุงููุนุงููุงุช ูู ุงููุนุงูุฌ ูุงูุชูุงุท ุงููุนุงูุฌ ููู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ููุฌุฏ ุณุฌู ุงููุนุงููุงุช ( </font></font><code>No such file or directory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ุ ููุง ูููู ุจุฏุก ุงููุณุฎุฉ ุงููุชูุงุซูุฉ. </font><font style="vertical-align: inherit;">ููููุง ูุฐูู ุ ูุชููู PostgreSQL ูุน ูุฌูุฏ ุฎุทุฃ. </font><font style="vertical-align: inherit;">ุนููู ุฃู ุชููู ุณุจุจ ุนุฏู ูุฌูุฏ ุณุฌู ุงููุนุงููุงุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ูุง ูุฏู ุงูุณูุฏ ุงูุฌุฏูุฏ ูู WAL:</font></font><br>
<br>
<pre><code class="xml hljs">LOG: checkpoint complete:<font></font>
wrote 62928 buffers (16.0%); 0 WAL file(s) added, 0 removed, 23 recycled;<font></font>
write=12.872 s, sync=0.020 s, total=13.001 s;<font></font>
sync files=16, longest=0.009 s, average=0.001 s;<font></font>
distance=520220 kB, estimate=520220 kB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุชุถุญ ุฃูู ุฃุซูุงุก ุชุดุบููู </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุญุฏุซุช ููุทุฉ ุชูุชูุด ุ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ุจุนุถ ุณุฌูุงุช ุงููุนุงููุงุช ุงููุฏููุฉ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุนูุฏูุง ุญุงูู ุงูุณูุฏ ุงููุฏูู ุงูุงุชุตุงู ุจุงูุณูุฏ ุงูุฌุฏูุฏ ูุทูุจ ูุฐู ุงูุณุฌูุงุช ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุชูุง ุจุงููุนู ุ ููู ุชูู ููุฌูุฏุฉ ุจุจุณุงุทุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุง ููุทุงุจุน ุงูุฒููู ุ ูุจูุบ ุงูููุช ุจูู ูุฐู ุงูุฃุญุฏุงุซ ุญุฑููุง 150 ูููู ุซุงููุฉ.</font></font><br>
<br>
<pre><code class="xml hljs">2019-08-26 00:06:11,369 LOG: checkpoint complete<font></font>
2019-08-26 00:06:11,517 INFO: running pg_rewind</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูุฐุง ูุงู ูุงูููุง ูุฌุนู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุบูุฑ ูุงุฏุฑุฉ ุนูู ุงูุงุชุตุงู ูุงููุณุจ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุจุฏุงูุฉ ุ ุงุณุชุฎุฏููุง ูุชุญุงุช ุงููุณุฎ ุงููุชูุงุซู. ุจุฏุง ูุฐุง ุงูุญู ุฌูุฏูุง ุจุงููุณุจุฉ ููุง ุ ุนูู ุงูุฑุบู ูู ุฃููุง ูููุง ูู ุงููุฑุญูุฉ ุงูุฃููู ูู ุงูุชุดุบูู ุจุฅุบูุงู ุงููุชุญุงุช. ููุง ูุธู ุฃูู ุฅุฐุง ูุงูุช ุงููุชุญุงุช ุณุชุฑุงูู ุงูุนุฏูุฏ ูู ุดุฑุงุฆุญ ุงููุดู ุ ูููู ููุณูุฏ ุฃู ูุณูุท. ุจุนุฏ ุฃู ุนุงููุช ูุจุนุถ ุงูููุช ุฏูู ูุชุญุงุช ุ ุฃุฏุฑููุง ุฃููุง ุจุญุงุฌุฉ ุฅูููุง ูุฃุนุงุฏูุงูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ุงููุดููุฉ ูู ุฃูู ุนูุฏูุง ูุฏุฎู ุงููุนุงูุฌ ูู ุญุงูุฉ ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูููู ุงููุนุงูุฌ ุจุญุฐู ุงููุชุญุงุช ูุฃุฌุฒุงุก wal ูุนูู. ูุชุณููุฉ ูุฐู ุงููุดููุฉ ุ ูููุง ุจุฒูุงุฏุฉ ุงููุนููุฉ </font></font><code>wal_keep_segments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุจุดูู ุงูุชุฑุงุถู ุ ูุณุงูู 8 ุฃุฌุฒุงุก ุ ูููุง </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฑูุนูุง </font></font><code>wal_keep_segments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู 1000</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ููุฏ ุฎุตุตูุง 16 ุบูุบุงุจุงูุช </font></font><code>wal_keep_segments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงูุขู ุนูุฏ ุงูุชุจุฏูู ุ ูุฏููุง ุฏุงุฆููุง 16 ุบูุบุงุจุงูุช ูู ุณุฌูุงุช ุงููุนุงููุงุช ุนูู ุฌููุน ุงูุนูุฏ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุทุจู ูุฐุง ุฃูุถูุง ุนูู ููุงู ุงูุตูุงูุฉ ุทูููุฉ ุงููุฏู. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุฃููุง ุจุญุงุฌุฉ ุฅูู ุชุญุฏูุซ ุฅุญุฏู ุงููุณุฎ ุงููุชูุงุซูุฉ (ุงูุจุฑุงูุฌ ุ ููุธุงู ุงูุชุดุบูู ุ ูุดูุก ุขุฎุฑ) ุ ููุฑูุฏ ุฅููุงู ุชุดุบููู. </font><font style="vertical-align: inherit;">ุนูุฏ ุฅููุงู ุชุดุบูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูุชู ุญุฐู ุงููุชุญุฉ ุฃูุถูุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุณุชุฎุฏู ูููุฉ ูุนููุฉ ุตุบูุฑุฉ </font></font><code>wal_keep_segments</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุจุงููุณุจุฉ ูุบูุงุจ ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ููุชุฑุฉ ุทูููุฉ ุ ูุณุชุทูุจ ุณุฌูุงุช ุงููุนุงููุงุช ุงูุชู ูุฏ ูุง ุชุธูุฑ ุญุชู ูู ุงููุนุงูุฌ - ููู ุชุชููู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ูู ุงูุงุชุตุงู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุญุงูุธ ุนูู ูููุฉ ูุจูุฑุฉ ูู ุงููุฌูุงุช.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุดููุฉ 4. ููุฏุงู ุงูุจูุงูุงุช</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู ููุงู ูุดู ูู ูุงุนุฏุฉ ุงูุฅูุชุงุฌ. </font><font style="vertical-align: inherit;">ููุฏ ุฑุงุฌุนูุง ุงููุฌููุนุฉ: ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ูุฌููุน ุงููุณุฎ ุงููุชูุงุซูุฉ ูู ููุงููุง ุงูุตุญูุญ ุ ููุง ููุฌุฏ ุชุฃุฎุฑ ูู ุงููุณุฎ ุงููุชูุงุซู ุ ููุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุณุฌูุงุช ุฃูุถูุง. </font><font style="vertical-align: inherit;">ููู ูุฑูู ุงูููุชุฌ ูุดูุฑ ุฅูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฏู ูุฌูุฏ ุจูุงูุงุช ูุงููุฉ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font><strong><font style="vertical-align: inherit;">ูุงุนุฏุฉ ุงูุจูุงูุงุช</font></strong><font style="vertical-align: inherit;"> - ููู ููุฌูุฏุฉ ูู ูุตุฏุฑ ูุงุญุฏ ุ ูููู ููุณ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฅูู ููู ูุง ุญุฏุซ ููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุฏุฑููุง ุนูู ุงูููุฑ ุฃู ูุฐุง ูู </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุจููู ุ ููููุง ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุงูุณุจุจ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุญุฏุซ ุงููุดูุ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุง ุฏุงุฆููุง ุฃู ูุฌุฏ ูู ุงูุณุฌูุงุช ููุช ุญุฏูุซ ุงูุนุงุดู ุ ุงูุฐู ุฃุตุจุญ ุงูุณูุฏ ุงูุฌุฏูุฏ ุ ุงูุฐู ูุงู ุงูุณูุฏ ูู ูุจู ูุนูุฏูุง ุฃุฑุงุฏ ุฃู ูุตุจุญ ูุณุฎุฉ ุทุจู ุงูุฃุตู.</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-1 patroni[17836]: INFO: promoted self to leader by acquiring session lock<font></font>
pgdb-1 patroni[17836]: server promoting<font></font>
pgdb-1 patroni[17836]: INFO: cleared rewind state after becoming the leader<font></font>
pgdb-1 patroni[17836]: INFO: Lock owner: pgdb-1; I am pgdb-1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุณุฌูุงุช ุ ูููููุง ุชุญุฏูุฏ ููุฏุงุฑ ุณุฌูุงุช ุงููุนุงููุงุช ุงูุชู ุชู ููุฏูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู ุงูุฃูุฑ ุนูู ูุฐุง ุงููุญู: ุชู ุฅุนุงุฏุฉ ุชุดุบูู ุงููุนุงูุฌ ุงููุฏูู ุ ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบููู ุจูุงุณุทุฉ ุงูุชุดุบูู ุงูุชููุงุฆู ุ ุชู ุฅุทูุงู Patroni ุ ูุงูุฐู ุฃุทูู ุจุนุฏ ุฐูู PostgreSQL. </font><font style="vertical-align: inherit;">ูุฑุฑุช PostgreSQL ุฃู ุชุตุจุญ ุนุถููุง ูู ูุฌููุนุฉ Patroni ูุฃุทููุช ุนูููุฉ </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุจุฏูุฑูุง ุ ูุงูุช ุจูุณุญ ุฌุฒุก ูู ุณุฌูุงุช ุงููุนุงููุงุช ุ ูุชูุฒูู ุณุฌูุงุช ุฌุฏูุฏุฉ ูุฑุจุทูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู Patroni ุชูุงููุง ููุง ูู ููุตูุฏ. </font><font style="vertical-align: inherit;">ุชุนุงูู ุงููุชูุฉ: ูุงู ููุงู 3 ุนูุฏ ุ ุจุนุฏ 3 ุนูุฏ feylover ูุงููุณุงุฑ. </font><font style="vertical-align: inherit;">ูููู ุฌุฒุกูุง ูู ุงูุจูุงูุงุช ูุชู ููุฏู ุ ูุชุญุชุงุฌ ุฅูู ููู ุฃู ุฌุฒุก ููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุจุญุซ ูู ุณุฌูุงุช ุงููุนูู ุงููุฏูู ุนู ุงููุญุธุฉ ุงูุชู ุญุฏุซ ูููุง </font></font><code>pg_rewind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni[4149]: INFO: running pg_rewind from pgdb-1<font></font>
pgdb-2 patroni[4149]: Lock owner: pgdb-1; I am pgdb-2<font></font>
pgdb-2 patroni[4149]: Deregister service pgdb/pgdb-2<font></font>
pgdb-2 patroni[4149]: running pg_rewind from pgdb-1 in progress<font></font>
pgdb-2 patroni[4149]: running pg_rewind from user=replica host=10.10.1.31 port=5432 ...<font></font>
pgdb-2 patroni[4149]: servers diverged at WAL location 0/5AD1BFD8 on timeline 66<font></font>
pgdb-2 patroni[4149]: rewinding from last common checkpoint at 0/59DD1070 on timeline 66<font></font>
pgdb-2 patroni[4149]: Done!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญุชุงุฌ ุฅูู ุงูุนุซูุฑ ุนูู ุงููุฑูุฒ ูู ุณุฌู ุงููุนุงููุงุช ุ ุงูุฐู ุฃููู ุงูุฑุฆูุณู ุงููุฏูู.</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-2 patroni[4149]: INFO: Local timeline=66 lsn=0/5BDA8EB8<font></font>
pgdb-2 patroni[4149]: INFO: master_timeline=67<font></font>
...<font></font>
pgdb-2 patroni[4149]: servers diverged at WAL location 0/5AD1BFD8 on timeline 66<font></font>
postgres=# select pg_wal_lsn_diff('0/5BDA8EB8','0/5AD1BFD8');<font></font>
pg_wal_lsn_diff<font></font>
----------------<font></font>
17354464</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูุญุงูุฉ ุ ุชููู ุงูุนูุงูุฉ 0 / 5BDA8EB8. </font><font style="vertical-align: inherit;">ุงูุนูุงูุฉ ุงูุซุงููุฉ - 0 / 5AD1BFD8 - ูุทููุจุฉ ูุฅูุฌุงุฏ ุงููุณุงูุฉ ุงูุชู ูุฎุชูู ุจูุง ุงููุนูู ุงููุฏูู ุนู ุงููุนูู ุงูุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ุงููุธููุฉ </font></font><code>pg_wal_lsn_diff </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููุงุฑู ุจูู ูุงุชูู ุงูุนูุงูุชูู ุ ูุญุตู ุนูู 17 ููุบุงุจุงูุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฑุฑ ูุง ุฅุฐุง ูุงู ููุงู ููุฏุงู ูุจูุฑ ููุจูุงูุงุช ุจููุฏุงุฑ 17 ููุบุงุจุงูุช. </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ููุจุนุถ ุ ูุฐุง ุบูุฑ ููู ุ ูููู ุจุงููุณุจุฉ ูุดุฎุต ูุง ููู ุฃูุฑ ุบูุฑ ููุจูู ูุซูุฑูุง. </font><font style="vertical-align: inherit;">ูู ูููุณู ูุญุฏุฏ ุจุดูู ูุฑุฏู ูููุง ูุงุญุชูุงุฌุงุช ุงูุนูู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุฏุฆ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐู ุจุฏุก</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ </font><strong><font style="vertical-align: inherit;">ูุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ุฏุงุฆููุง ุฅูู ุชุดุบูู Patroni ุงูุชููุงุฆู ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงููุธุงู</font></strong><font style="vertical-align: inherit;"> . ูู ูุนุธู ุงูุฃุญูุงู ุ ูุฌุจ ุฃู ูุฐูุจ ุฅูู ุงููุนูู ุงููุฏูู ุ ููุฑู ูุฏู ุงุฎุชูุงูู ุนู ุงูุญุงูุฉ ุงูุญุงููุฉ ุ ูุฑุจูุง ูุญุต ุฃุฌุฒุงุก ุณุฌู ุงููุนุงููุงุช. ุชุญุชุงุฌ ุฅูู ููู ูุง ุฅุฐุง ูุงู ูููู ููุฏุงู ูุฐู ุงูุจูุงูุงุช ุ ุฃู ุชุญุชุงุฌ ุฅูู ุชุดุบูู ุงููุนุงูุฌ ุงููุฏูู ูู ุงููุถุน ุงููุณุชูู ูุณุญุจ ุงูุจูุงูุงุช. ููุท ุจุนุฏ ุฐูู ุงุชุฎุฐ ูุฑุงุฑูุง ุจุดุฃู ูุง ูุฌุจ ูุนูู ุจุงูุจูุงูุงุช ูุฑุจุท ูุฐู ุงูุนูุฏุฉ ููุณุฎุฉ ุทุจู ุงูุฃุตู ุฅูู ูุฌููุนุชูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ูุนููุฉ</font></font><code>maximum_lag_on_failover</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููุชู ุจุดูู ุงูุชุฑุงุถู 1 ููุบุง ุจุงูุช. ูุนูู ูุซู ูุฐุง: ุฅุฐุง ูุงูุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ 1 ููุฌุงุจุงูุช ุฎูู ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ุ ูุฅู ูุฐู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ูุง ุชุดุงุฑู ูู ุงูุงูุชุฎุงุจุงุช. ุฅุฐุง ุญุฏุซ ูุฌุฃุฉ ูุดู ุ ูุจุญุซ Patroni ุนู ุงููุณุฎ ุงููุชูุงุซูุฉ ุงูุชู ุชุชุฎูู ุนู ุงูุฑูุจ ุ ูุชูู ุงูุชู ุชุชุฎูู ุนู ุนุฏุฏ ูุจูุฑ ูู ุณุฌูุงุช ุงููุนุงููุงุช ูุง ูููู ุฃู ุชุตุจุญ ุฑุฆูุณูุฉ. ูุฐู ููุฒุฉ ุฃูุงู ุฌูุฏุฉ ุชููุนู ูู ููุฏุงู ุงููุซูุฑ ูู ุงูุจูุงูุงุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุงู ูุดููุฉ: ูุชู ุชุญุฏูุซ ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ุนูู ูุงุตู ุฒููู ูุนูู ุ ูุงููููุฉ </font></font><code>ttl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุชุฑุงุถูุฉ ูู 30 ุซุงููุฉ. ูู ุงููููู ุฃู ุชููู ูููุฉ ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ูููุณุฎ ุงููุชูุงุซูุฉ ูู DCS ูุงุญุฏุฉ ุ ูููููุง ูู ุงููุงูุน ูุฎุชููุฉ ุชูุงููุง ุฃู ูุง ููุฌุฏ ุชุฃุฎูุฑ ุนูู ุงูุฅุทูุงู. ูุฐู ููุณุช ูููุฉ ูู ุงูููุช ุงูุญูููู ุ ููู ูุง ุชุนูุณ ุฏุงุฆููุง ุงูุตูุฑุฉ ุงูุญููููุฉ ููุง ุชุณุชุญู ุฑุจุท ุงูููุทู ุงููุนูุฏ ุจูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุฎุทุฑ "ุงูุฎุณุงุฆุฑ" ุฏุงุฆููุง:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฃุณูุฃ ุงูุญุงูุงุช: </font></font><code>maximum_lag_on_failover + ttl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุชูุณุท ุงููุถูุฉ: </font></font><code>maximum_lag_on_failover + (loop_wait / 2)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏูุง ุชุฎุทุท ูุชุทุจูู Patroni ูุชูููู ููุฏุงุฑ ุงูุจูุงูุงุช ุงูุชู ูููู ุฃู ุชููุฏูุง ุ ููุฑ ูู ูุฐู ุงูุตูุบ ูุชูุซูู ุงูุฎุณุงุฆุฑ ุงููุญุชููุฉ ุชูุฑูุจูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฎุจุฑ ุงูุณุงุฑ ูู ุฃูู ูุฏ ูููู ููุงู WAL ูู ุงูุนูููุงุช ุงูุฎูููุฉ ูู "ุงูุฎุณุงุฆุฑ". </font><font style="vertical-align: inherit;">ูููู ุชุฌุงูู ูุฐู ุงูุจูุงูุงุช ูููุฏุงููุง ุจุณูููุฉ ุ ููุง ุชูุฌุฏ ูุดููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ูู ุดูู ุงูุณุฌูุงุช ุฅุฐุง ุชู ุชุนููููุง </font></font><code>maximum_lag_on_failover</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุญุฏุซ feylover ูุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ูุนุงูุฌ ุฌุฏูุฏ:</font></font><br>
<br>
<pre><code class="xml hljs">pgdb-1 patroni[6202]: INFO: Lock owner: None; I am pgdb-1<font></font>
pgdb-1 patroni[6202]: INFO: not healthy enough for leader race<font></font>
pgdb-1 patroni[6202]: INFO: changing primary_conninfo and restarting in progress<font></font>
...<font></font>
pgdb-1 patroni[6202]: INFO: following a different leader because i am not the healthiest node<font></font>
pgdb-1 patroni[6202]: INFO: following a different leader because i am not the healthiest node</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฑู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุจุจุณุงุทุฉ ุฃููุง </font></font><code>not healthy enough for leader race</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฑูุถ ุงููุดุงุฑูุฉ ูู ุณุจุงู ุงูููุงุฏุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ููุชุธุฑ ุจุจุณุงุทุฉ ุชุญุฏูุฏ ูุนุงูุฌ ุฌุฏูุฏ ููุงุชุตุงู ุจู. </font><font style="vertical-align: inherit;">ูุฐุง ุฅุฌุฑุงุก ุฅุถุงูู ุถุฏ ููุฏุงู ุงูุจูุงูุงุช.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุดููุฉ 5. ูุญุฑูุงุช ุงูุฃูุฑุงุต</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุจ ูุฑูู ุงูููุชุฌ ุฃู ุงูุชุทุจูู ููุงุฌู ูุดุงูู ูู ุงูุนูู ูุน PostgreSQL. </font><font style="vertical-align: inherit;">ูู ุงูููุช ููุณู ุ ูุง ููููู ุฅุฏุฎุงู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุ ูุฃููุง ุบูุฑ ูุชุงุญุฉ ุนุจุฑ SSH ุ ูููู ูุง ูุญุฏุซ ุงููุตูุฑ ุงูุชููุงุฆู ุฃูุถูุง. </font><font style="vertical-align: inherit;">ุซู ุชู ุฅุนุงุฏุฉ ุชุดุบูู ุงููุถูู ุจุงูููุฉ ูุจุงูุชุงูู ุฃุทูู ุงููุตูุฑ ุงูุชููุงุฆู. </font><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูุงู ูู ุงููููู ุนูู feylover ูุฏูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ูุฐูุจ ููุฑู ูุง ุญุฏุซ ููุณูุฏ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_1/2u/rj/_12urj0aobgqg0pp2gkkuolhjog.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนุฑููุง ููุฏูุง ุนู ูุดุงูู ุงูุฃูุฑุงุต ุ ูู ุฎูุงู ุงููุฑุงูุจุฉ ุนุฑููุง ุฃูู ูุญูุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุณุฌูุงุช PostgreSQL ุ ูุฑู ูุง ููู:</font></font><br>
<br>
<pre><code class="xml hljs">[COMMIT] LOG: duration: 1138.868 ms statement: COMMIT<font></font>
...<font></font>
[] WARNING: autovacuum worker started without a worker entry<font></font>
...<font></font>
[SELECT] LOG: temporary file: path "base/pgsql_tmp/pgsql_tmp11247.983", size 532996096<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุงููุฌู ุฌููุน ูุคุดุฑุงุช ูุดุงูู ุงูุฃูุฑุงุต: ุนูููุงุช ุชุณุชูุฑ ูุซุงููุฉ ูุงุญุฏุฉ ุ ูุนูู ุงููุฑุงุบ ุงูุชููุงุฆู ุทููููุง ูุบุฑูุจูุง ุ ููููุงุช ูุคูุชุฉ ุนูู ุงููุฑุต. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูู ูุธุงู dmesg - ุณุฌู ุฑุณุงุฆู kernel ุ ูุดุงูุฏูุง ูุดููุฉ ูู ุฃุญุฏ ุงูุฃูุฑุงุต:</font></font><br>
<br>
<pre><code class="xml hljs">md/raid10:md2: sde3: rescheduling sector 351273392<font></font>
blk_update_request: I/O error, dev sde, sector 64404728<font></font>
md/raid10:md2: sde3: rescheduling sector 63161592<font></font>
blk_update_request: I/O error, dev sde, sector 64404760<font></font>
...<font></font>
md2 : active raid10 sda3[0] sdc3[2] sdd3[3] sdb3[1] sdh3[7] sdf3[5] sdg3[6]<font></font>
      15623340032 blocks super 1.2 512K chunks 2 near-copies [8/7] [UUUUUUU_]<font></font>
      bitmap: 58/59 pages [232KB], 131072KB chunk</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู ุงููุธุงู ุงููุฑุนู ูููุฑุต ุงูููุฌูุฏ ุนูู ุงูุฎุงุฏู ุนุจุงุฑุฉ ุนู ุจุฑูุงูุฌ ุฑุงุฆุฏ ูู 8 ุฃูุฑุงุต ุ ูููู ุฃุญุฏ ุงูุฃูุฑุงุต ููููุฏ. </font><font style="vertical-align: inherit;">ุงูุฎุท </font></font><code>sda3[0] sdc3[2] sdd3[3] sdb3[1] sdh3[7] sdf3[5] sdg3[6]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฏ </font></font><code>sde[4]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุณุจููุง ุ ุณูุท ูุฑุต ูุงุญุฏ ุ ุชุณุจุจ ูุฐุง ูู ูุดุงูู ูู ุงููุฑุต ุ ููุงู ููุชุทุจูู ูุดุงูู ูู ุงูุนูู ูุน ูุฌููุนุฉ PostgreSQL.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุงุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูุชููู Patroni ูู ุงููุณุงุนุฏุฉ ุ ูุฃู Patroni ููุณ ูุฏูู ูููุฉ ููุฑุงูุจุฉ ุญุงูุฉ ุงูุฎุงุฏู ูุงูุฃูุฑุงุต. </font><font style="vertical-align: inherit;">ุฎูุงู ุงููุดุงูู ุ ุงุณุชูุฑ Patroni ูู ุงูุชูุงุนู ูุน ูุฌููุนุฉ DCS ููู ูุฑ ุฃู ุตุนูุจุงุช. </font><font style="vertical-align: inherit;">ูู ูุซู ูุฐู ุงูุญุงูุงุช ุ ููุงู ุญุงุฌุฉ ููุฑุตุฏ ุงูุฎุงุฑุฌู.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดููุฉ 6. ูุญุงูุงุฉ ุงููุชูุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ูุงุญุฏุฉ ูู ุฃุบุฑุจ ุงููุดุงูู. </font><font style="vertical-align: inherit;">ููุฏ ุฏุฑุณุชูุง ููุชุฑุฉ ุทูููุฉ ุฌุฏูุง ุ ูุฃุนุฏุช ูุฑุงุกุฉ ุงููุซูุฑ ูู ุงูุณุฌูุงุช ูุฃุทูู ุนูููุง "ูุญุงูู ุงููุชูุฉ". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ุงููุดููุฉ ุฃู ุงูุณูุฏ ุงููุฏูู ูุง ูููู ุฃู ูุตุจุญ ุฌุฏููุฉ ุนุงุฏูุฉ. </font><font style="vertical-align: inherit;">ูุงูุช Patroni ุจุชุดุบูููุง ุ ูุฃุธูุฑุช ุฃู ูุฐู ุงูุนูุฏุฉ ููุฌูุฏุฉ ููุณุฎุฉ ูุชูุงุซูุฉ ุ ูููู ูู ููุณ ุงูููุช ูู ุชูู ูุณุฎุฉ ูุชูุงุซูุฉ ุนุงุฏูุฉ ุ ูุงูุขู ุณุชุฑู ุงูุณุจุจ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุฃ ูู ุดูุก ุ ููุง ูู ุงูุญุงูุฉ ุงูุณุงุจูุฉ ุ ุจูุดุงูู ุงููุฑุต:</font></font><br>
<br>
<pre><code class="xml hljs">14:48:55.601 [COMMIT] LOG: duration: 1478.118 ms statement: COMMIT<font></font>
14:48:56.287 [COMMIT] LOG: duration: 1290.203 ms statement: COMMIT<font></font>
14:48:56.287 [COMMIT] LOG: duration: 1778.465 ms statement: COMMIT<font></font>
14:48:56.287 [COMMIT] LOG: duration: 1778.449 ms statement: COMMIT</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ููุงู ุงุชุตุงูุงุช ููุทูุนุฉ:</font></font><br>
<br>
<pre><code class="xml hljs">14:48:58.078 [idle in transaction] LOG: could not send data to client: Broken pipe<font></font>
14:48:58.078 [idle] LOG: could not send data to client: Broken pipe<font></font>
14:48:58.078 [idle] FATAL: connection to client lost<font></font>
14:48:58.107 [idle in transaction] FATAL: connection to client lost</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ููุงู ุชููุนุงุช ุทูููุฉ ููุงุณุชุฌุงุจุฉ ูุญุฌุจ ุดุฏุฉ ูุชูุงูุชุฉ:</font></font><br>
<br>
<pre><code class="xml hljs">14:49:26.929 [UPDATE waiting] LOG: process 4298 acquired ExclusiveLock on tuple (2,10) of relation 52082 of database 50587 after 52487.463 ms<font></font>
14:49:26.929 [UPDATE waiting] STATEMENT: UPDATE sessions SET lastaccess='1565005714' WHERE sessionid=...<font></font>
14:49:27.929 [UPDATE waiting] LOG: process 4298 still waiting for ShareLock on transaction 364118337 after 1000.088 ms<font></font>
14:49:27.929 [UPDATE waiting] DETAIL: Process holding the lock: 4294. Wait queue: 4298.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุดูู ุนุงู ุ ููุงู ูุดุงูู ูุงุถุญุฉ ูุน ุงูุฃูุฑุงุต ุ ุจูุง ูู ุฐูู ุงููููุงุช ุงููุคูุชุฉ ูุฑุฉ ุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงูุฃูุซุฑ ุบููุถุง ุจุงููุณุจุฉ ูู - ุทุงุฑ ูู </font></font><code>immediate shutdown request</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="xml hljs">14:49:34.102 MSK 5335 @ from [] LOG: received immediate shutdown request<font></font>
14:49:34.689 [authentication] WARNING: terminating connection because of crash of another server process<font></font>
14:49:34.689 [authentication] DETAIL: The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชูู PostgreSQL ุนูู ุซูุงุซุฉ ุฃูุถุงุน ูุฅููุงู ุงูุชุดุบูู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุดููุฉ ุนูุฏูุง ููุชุธุฑ ูุทุน ุงุชุตุงู ุฌููุน ุงูุนููุงุก ุจุฃููุณูู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฑูุน ุ ุนูุฏูุง ูุทูุจ ูู ุงูุนููุงุก ูุทุน ุงูุงุชุตุงู ุ ูุฃููุง ุณูุบูู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑู ุ ูุงูุฐู ูุง ูุฎุจุฑ ุงูุนููุงุก ุฃูู ูู ุงูุถุฑูุฑู ูุทุน ุงูุงุชุตุงู ุ ููููู ุจุจุณุงุทุฉ ูููู ุจุฅููุงู ุชุดุบููู ููุฑุณู ุฑุณุงูุฉ RST ุฅูู ูุงูุฉ ุงูุนููุงุก (ุฅุดุงุฑุฉ TCP ุฅูู ุงููุทุงุน ุงูุงุชุตุงู).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ุชุฑุณู ุนูููุงุช ุงูุฎูููุฉ ูู PostgreSQL ุฅุดุงุฑุงุช ุทูุจ ุฅููุงู ุงูุชุดุบูู ุงูููุฑู ุฅูู ุจุนุถูุง ุงูุจุนุถ ุ ูููููุง ุชุณุชุฌูุจ ููุง ููุท. </font><font style="vertical-align: inherit;">ูุฐู ุฅุนุงุฏุฉ ุชุดุบูู ุทุงุฑุฆุฉ ุ ููู ุงูุฐู ุฃุฑุณููุง ุบูุฑ ูุงุถุญ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู </font></font><code>kill -9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุณุฃุฑุงู ูู ุงูุณุฌูุงุช ุ ููููู ูู ููู ููุฌูุฏูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฒูุฏ ูู ุงูููู ุ ุฑุฃูุช ุฃู Patroni ูู ููุชุจ ุฅูู ุงูุณุฌู ูุจุนุถ ุงูููุช - ุจุจุณุงุทุฉ ูู ุชูู ููุงู ุฑุณุงุฆู ููุฏุฉ 54 ุซุงููุฉ. </font><font style="vertical-align: inherit;">ุฎูุงู ูุฐุง ุงูููุช ุ ูุงูุช ุฅุญุฏู ุงููุณุฎ ุงููุชูุงุซูุฉ ุจุนูู "ุชุฑููุฌ" ูุญุฏุซ ููู ุชููุงุฆู:</font></font><br>
<br>
<pre><code class="xml hljs">pgsql03 patroni: 14:48:25,000 INFO: Lock owner: pgsql03; I am pgsql03 <font></font>
pgsql03 patroni: 14:48:25,013 INFO: no action.  i am the leader with the lock <font></font>
pgsql03 patroni: 14:48:37,159 INFO: Lock owner: pgsql03; I am pgsql03 <font></font>
pgsql03 patroni: 14:49:31,155 WARNING: Exception hened during processing of request from 10.1.0.12 <font></font>
pgsql03 patroni: 14:49:31,297 WARNING: Exception hened during processing of request from 10.1.0.11 <font></font>
pgsql03 patroni: 14:49:31,298 WARNING: Exception hened during processing of request from 10.1.0.11</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู Patroni ุชูุงููุง ูุฑุฉ ุฃุฎุฑู ููุง ุ ููู ููู ุงูุณูุฏ ุงููุฏูู ูุชุงุญูุง ุ ูุฐูู ุจุฏุฃ ุงูุชุฎุงุจ ุณูุฏ ุฌุฏูุฏ.</font></font><br>
<br>
<pre><code class="xml hljs">pgsql01 patroni: 14:48:57,136 INFO: promoted self to leader by acquiring session lock<font></font>
pgsql01 patroni: server promoting<font></font>
pgsql01 patroni: 14:48:57,214 INFO: cleared rewind state after becoming the leader<font></font>
pgsql01 patroni: 14:49:05,013 INFO: Lock owner: pgsql01; I am pgsql01<font></font>
pgsql01 patroni: 14:49:05,023 INFO: updated leader lock during promote</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุตุจุญ pgsql01 ุงูุฒุนูู ุงูุฌุฏูุฏ ุ ููุงูุช ููุงู ูุดุงูู ููุท ูุน ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูุซุงููุฉ. </font><font style="vertical-align: inherit;">ุญุงููุช ุจุตุฏู ุฅุนุงุฏุฉ ุชูููู:</font></font><br>
<br>
<pre><code class="xml hljs">pgsql02 patroni: 14:48:57,124 INFO: Could not take out TTL lock <font></font>
pgsql02 patroni: 14:48:57,137 INFO: following new leader after trying and failing to obtain lock <font></font>
pgsql02 patroni: 14:49:05,014 INFO: Lock owner: pgsql01; I am pgsql02 <font></font>
pgsql02 patroni: 14:49:05,025 INFO: changing primary_conninfo and restarting in progress <font></font>
pgsql02 patroni: 14:49:15,011 INFO: Lock owner: pgsql01; I am pgsql02<font></font>
pgsql02 patroni: 14:49:15,014 INFO: changing primary_conninfo and restarting in progress <font></font>
pgsql02 patroni: 14:49:25,011 INFO: Lock owner: pgsql01; I am pgsql02 <font></font>
pgsql02 patroni: 14:49:25,014 INFO: changing primary_conninfo and restarting in progress <font></font>
pgsql02 patroni: 14:49:35,011 INFO: Lock owner: pgsql01; I am pgsql02 <font></font>
pgsql02 patroni: 14:49:35,014 INFO: changing primary_conninfo and restarting in progress</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุงููุช ุชุบููุฑ recovery.conf ุ ูุฃุนุฏ ุชุดุบูู PostgreSQL ุ ูุงุชุตู ุจุงููุนุงูุฌ ุงูุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ูู 10 ุซูุงู ุชูุฌุฏ ุฑุณุงุฆู ุชุญุงูู ุชุฌุฑุจุชูุง ุ ููููุง ูุง ุชุณุชุทูุน ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูููุช ููุณู ุ ุทุงุฑุช ููุณ ุฅุดุงุฑุฉ ุงูุฅุบูุงู ุงูููุฑู ุฅูู ุงููุนูู ุงููุฏูู. </font><font style="vertical-align: inherit;">ุจุฏุฃ ุงููุนุงูุฌ ูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุทูุงุฑุฆ ุ ููุง ูุชููู ุงูุงุณุชุฑุฏุงุฏ. </font><font style="vertical-align: inherit;">ูุง ูููู ุงูุงุชุตุงู ุจุงููุณุฎุฉ ุงููุชูุงุซูุฉ ูุฃููุง ูู ูุถุน ุฅููุงู ุงูุชุดุบูู.</font></font><br>
<br>
<pre><code class="xml hljs">14:49:34.293 [idle] LOG:  received replication command: IDENTIFY_SYSTEM <font></font>
WARNING:  terminating connection because of crash of another server process <font></font>
DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory. <font></font>
14:49:35.232 FATAL:  could not receive data from WAL stream: server closed the connection unexpectedly             <font></font>
        This probably means the server terminated abnormally <font></font>
        before or while processing the request. <font></font>
14:49:35.232 LOG:  record with incorrect prev-link 142D46/315602C at 14CF/CF38C160 <font></font>
14:49:35.305 FATAL: could not connect to the primary server: FATAL: the database system is shutting down <font></font>
14:49:40.241 FATAL: could not connect to the primary server: FATAL: the database system is shutting down</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฑุญูุฉ ูุง ุ ุนููุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูููู ูู ูุจุฏุฃ ุงููุณุฎ ุงููุชูุงุซู.</font></font><br>
<br>
<pre><code class="xml hljs">14:50:14.024 [] LOG:  record with incorrect prev-link 142D46/315602C at 14CF/CF38C160 <font></font>
14:50:14.028 [] LOG:  fetching timeline history file for timeline 72 from primary server <font></font>
14:50:14.104 [] FATAL:  could not start WAL streaming: ERROR:  requested starting point 14CF/CF000000 on timeline 71 is not in this server's history        <font></font>
DETAIL:  This server's history forked from timeline 71 at 14CF/CEC32E40. <font></font>
14:50:14.104 [] LOG:  new timeline 72 forked off current database system timeline 71 before current recovery point 14CF/CF38C160</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏู ูุฑุถูุฉ ูุงุญุฏุฉ: ูู Recovery.conf ูุงู ุนููุงู ุงูุณูุฏ ุงููุฏูู. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุธูุฑ ุณูุฏ ุฌุฏูุฏ ุจุงููุนู ุ ุญุงููุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูุซุงููุฉ ุงูุงุชุตุงู ุจุงูุณูุฏ ุงููุฏูู. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุจุฏุฃุช Patroni ูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูุซุงููุฉ ุ ุจุฏุฃุช ุงูุนูุฏุฉ ุ ููููุง ูู ุชุชููู ูู ุงูุงุชุตุงู ุนุจุฑ ุงููุณุฎ ุงููุชูุงุซู. </font><font style="vertical-align: inherit;">ุชู ุชุดููู ุชุฃุฎุฑ ูู ุงูุชูุฑุงุฑ ูุดุจู ุดูุฆูุง ููุฐุง:</font></font><br>
<br>
<pre><code class="xml hljs">+-----------------+----------+--------------+--------+---------+-----------+<font></font>
|     Cluster     |  Member  |     Host     |  Role  |  State  | Lag in MB |<font></font>
+-----------------+----------+--------------+--------+---------+-----------+<font></font>
| patroni_cluster |  pgsql01 | 10.2.200.151 | Leader | running |       0.0 |<font></font>
| patroni_cluster |  pgsql02 | 10.2.200.152 |        | running |    9153.0 |<font></font>
| patroni_cluster |  pgsql03 | 10.2.200.153 |        | running |       0.0 |<font></font>
+-----------------+----------+--------------+--------+---------+-----------+</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃู ุฃู ุงูุนูุฏ ุงูุซูุงุซ ูุงูุช ูู ููุงููุง ุ ูููู ุงูุนูุฏุฉ ุงูุซุงููุฉ ูุงูุช ูู ุงูุฎูู. </font><font style="vertical-align: inherit;">ุชุนุฐุฑ ุจุฏุก ุงููุณุฎ ุงููุชูุงุซู ูุฃู ุณุฌูุงุช ุงููุนุงููุงุช ูุงูุช ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ุณุฌูุงุช ุงููุนุงููุงุช ุงูุชู ููุฏููุง ุงููุนุงูุฌ ุ ุงููุดุงุฑ ุฅูููุง ูู recovery.conf ุ ุจุจุณุงุทุฉ ูุง ุชุชูุงุณุจ ูุน ุงูุนูุฏุฉ ุงูุญุงููุฉ. </font><font style="vertical-align: inherit;">ุฃุจูุบุช PostgreSQL ุนู ุฎุทุฃ ูู 5 ุซูุงูู</font></font><br>
<br>
<pre><code class="xml hljs">14:50:44.143 FATAL:  could not start WAL streaming: ERROR:  requested starting point 14CF/CF000000 on timeline 71 is not in this server's history        <font></font>
         DETAIL:  This server's history forked from timeline 71 at 14CF/CEC32E40. <font></font>
14:50:44.143 LOG:  new timeline 72 forked off current database system timeline 71 before current recovery point 14CF/ CF38C160</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุงุฑุชูุจุช ููุง ุฎุทุฃ ููู ุฃุฎุชุจุฑ ูุฑุถูุชู ุจุฃููุง ูุชุตู ุจุงูุณูุฏ ุงูุฎุทุฃ. </font><font style="vertical-align: inherit;">ููุฏ ููุช ุจุฅุนุงุฏุฉ ุชุดุบูู Patroni ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ. </font><font style="vertical-align: inherit;">ุจุตุฑุงุญุฉ ุ ููุฏ ููุช ุจุงููุนู ุจูุถุน ุญุฏ ููุง ูุงุนุชูุฏุช ุฃููู ุณุฃุถุทุฑ ุฅูู ุฅุนุงุฏุฉ ุฐูู ุ ููููู ูุง ุฒูุช ูุฑุฑุช ุฅุนุงุฏุฉ ุชุดุบููู.</font></font><br>
<br>
<pre><code class="xml hljs">15:14:13.511 LOG: consistent recovery state reached at 14CF/A3F657B0<font></font>
15:14:13.511 LOG: database system is ready to accept read only connections</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุฃ ุงูุงุณุชุฑุฏุงุฏ ุ ูุญุชู ูุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุงูุช ุฌุงูุฒุฉ ููุจูู ุงูุงุชุตุงู ุ ูุจุฏุฃ ุงููุณุฎ ุงููุชูุงุซู:</font></font><br>
<br>
<pre><code class="xml hljs">15:14:17.072 LOG: record with incorrect prev-link 142D46/315602C at 14CF/CF38C160<font></font>
15:14:17.077 LOG: started streaming WAL from primary at 14CF/CF000000 on timeline 72<font></font>
15:14:17.536 LOG: invalid record length at 14CF/CF38C160: wanted 24, got 1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุนุฏ ุฏูููุฉ ูุงุญุฏุฉ ุ ููุนุช ูู ุฎุทุฃ </font></font><code>terminating walreceiver process due to administrator command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุงูุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุฃู ุณุฌูุงุช ุงููุนุงููุงุช ูู ุชูู ููุงุณุจุฉ ููุง.</font></font><br>
<br>
<pre><code class="xml hljs">15:15:27.823 FATAL: terminating walreceiver process due to administrator command<font></font>
15:15:27.895 LOG: invalid record length at 14CF/CF38C160: wanted 24, got 1<font></font>
15:15:27.895 LOG: invalid record length at 14CF/CF38C160: wanted 24, got 1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุฃุนุฏ ุชุดุบูู PostgreSQL ุ ูููู ุชู ุฅุนุงุฏุฉ ุชุดุบูู Patroni ุนูู ุฃูู ุฃู ูุชู ุชุดุบูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุทุฑููุฉ ุณุญุฑูุฉ. </font><font style="vertical-align: inherit;">ุจุฏุฃ ุงููุณุฎ ุงููุชูุงุซู ูุฑุฉ ุฃุฎุฑู ุ ูููู ุชู ูุชุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุณ ุงูููุงู:</font></font><br>
<br>
<pre><code class="xml hljs">15:17:33.553 LOG: consistent recovery state reached at 14CF/A3F657B0<font></font>
15:17:33.554 LOG: database system is ready to accept read only connections</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ุงูุนูุงูุงุช ูู ุณุฌู ุงููุนุงููุงุช ูุฎุชููุฉ ุ ููุงูุช ูุฎุชููุฉ ุนูุง ูุงูุช ุนููู ูู ูุญุงููุฉ ุงูุฅุทูุงู ุงูุณุงุจูุฉ - ููุงู ููุถุน ุณุฌู ุงููุนุงููุงุช ุณุงุจููุง:</font></font><br>
<br>
<pre><code class="xml hljs">15:17:37.299 LOG: invalid contrecord length 5913 at 14CF/CEFFF7B0<font></font>
15:17:37.304 LOG: started streaming WAL from primary at 14CF/CE000000 on timeline 72</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ุงููุณุฎ ุงููุชูุงุซู ูุฑุฉ ุฃุฎุฑู ุ ููุงูุช ุฑุณุงูุฉ ุงูุฎุทุฃ ูุฎุชููุฉ ููุฑุฉ โโุฃุฎุฑู ููุณุช ูููุฏุฉ ููุบุงูุฉ:</font></font><br>
<br>
<pre><code class="xml hljs">15:18:12.208 FATAL: terminating walreceiver process due to administrator command<font></font>
15:18:12.240 LOG: record with incorrect prev-link 60995000/589DF000 at 14CF/CEFFF7B0<font></font>
15:18:12.240 LOG: record with incorrect prev-link 60995000/589DF000 at 14CF/CEFFF7B0</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุฌุฑุจุฉ ุ ุฃุนูุฏ ุชุดุบูููุง ูุฑุฉ ุฃุฎุฑู ุ ุชู ูุชุญ ุงููุงุนุฏุฉ ูู ููุณ ุงูููุงู:</font></font><br>
<br>
<pre><code class="xml hljs">15:21:25.135 LOG: consistent recovery state reached at 14CF/A3F657B0<font></font>
15:21:25.135 LOG: database system is ready to accept read only connections</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ุฌุงุกุชูู ุงูููุฑุฉ: ุฅุฐุง ููุช ุจุฅุนุงุฏุฉ ุชุดุบูู PostgreSQL ุ ูู ูุฐู ุงููุฑุญูุฉ ุนูู ุงููุนุงูุฌ ุงูุญุงูู ุ ุณุฃููู ุจููุทุฉ ุชูุชูุด ูููู ุงูููุทุฉ ูู ุณุฌู ุงููุนุงููุงุช ุฅูู ุงูุฃูุงู ููููุงู ูุจุฏุฃ ุงูุงุณุชุฑุฏุงุฏ ูู ูุญุธุฉ ุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุทููุช Patroni ุ ุฌุนูุช ุจุถุน ููุงุท ุชูุชูุด ุนูู ุงูุฑุฆูุณู ุ ุจุถุน ููุงุท ุฅุนุงุฏุฉ ุชุดุบูู ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุนูุฏ ูุชุญูุง:</font></font><br>
<br>
<pre><code class="xml hljs">15:22:43.727 LOG: invalid record length at 14D1/BCF3610: wanted 24, got 0<font></font>
15:22:43.731 LOG: started streaming WAL from primary at 14D1/B000000 on timeline 72</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุญุช - ุจุฏุฃ ุงููุณุฎ ุงููุชูุงุซู ูู ููุงู ูุฎุชูู ููู ูุนุฏ ูููุณุฑ. </font><font style="vertical-align: inherit;">ููู ุจุงููุณุจุฉ ูู ุ ูุฐู ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงููุดุงูู ุงูุบุงูุถุฉ ุงูุชู ูุง ุฒูุช ุฃุนุงูู ูููุง. </font><font style="vertical-align: inherit;">ุฎุตูุตุง ุฃู ุทูุจ ุฅุบูุงู ููุฑู ุบุฑูุจ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ูููููุง ุฃู ูุณุชูุชุฌ: ูููู ูู Patroni ุฃู ูุนูู ููุง ูู ูุฎุทุท ูุจุฏูู ุฃุฎุทุงุก ุ ูููู ูุฐุง ููุณ ุถูุงููุง ูุทูููุง ุจุฃู ูู ุดูุก ูู ุงููุงูุน ููุธู. </font><font style="vertical-align: inherit;">ุจุนุฏ faylover ุ ูุฌุจ ุนููู ุฏุงุฆููุง ุงูุชุญูู ุฌูุฏูุง ูู ุฃู ูู ุดูุก ุนูู ูุง ูุฑุงู ูุน ุงููุฌููุนุฉ: ุงูุนุฏุฏ ุงูุตุญูุญ ูู ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ููุง ููุฌุฏ ุชุฃุฎุฑ ูู ุงููุณุฎ ุงููุชูุงุซู.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฎุต</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจูุงุกู ุนูู ูุฐู ุงููุดุงูู ูุบูุฑูุง ูู ุงููุดููุงุช ุงูููุงุซูุฉ ุ ููุช ุจุตูุงุบุฉ ุชูุตูุงุช ุนุงูุฉ ุฃูุตุญู ุจุฃู ุชุถุนูุง ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุชุดุบูู Patroni.</font></font><br>
<br>
<blockquote><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุงุณุชุฎุฏุงูู Patroni ุ ูุฌุจ ุฃู ูููู ูุฏูู ูุฑุงูุจุฉ. </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฏุงุฆููุง ุฅูู ูุนุฑูุฉ ููุช ุญุฏูุซ ููู ุชููุงุฆู ุ ูุฃูู ุฅุฐุง ููุช ูุง ุชุนุฑู ุฃู ูุฏูู ููููุง ุชููุงุฆููุง ุ ููุง ููููู ุงูุชุญูู ูู ุงููุชูุฉ.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ุจุนุฏ ูู feylover ุชุญูู ุฏุงุฆููุง ูู ุงููุชูุฉ. </font><font style="vertical-align: inherit;">ูุฌุจ ุงูุชุฃูุฏ ูู ุฃู: ุงููุณุฎ ุงููุชูุงุซูุฉ ูู ุฏุงุฆููุง ุงูุฑูู ุงูุญุงูู ุ </font><font style="vertical-align: inherit;">ูุง ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ุ </font><font style="vertical-align: inherit;">ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุณุฌูุงุช ุงููุชุนููุฉ ุจุชูุฑุงุฑ ุงูุฏูู ุ ูุน Patroni ุ ูุน ูุธุงู DCS.</font></font></li>
</ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Patroni ูู ุฃุฏุงุฉ ุฌูุฏุฉ ููุบุงูุฉ ุ ูููู ุจุบุถ ุงููุธุฑ ุนู ููููุฉ ูููู ุฃููุง ููุณุช ุฑุตุงุตุฉ ูุถูุฉ. </font><font style="vertical-align: inherit;">ูููู ุฃู ุชุนูู ุงูุฃุชูุชุฉ ุจูุฌุงุญ ุ ูููู ูู ููุณ ุงูููุช ุ ูููู ุฃู ุชููู ูุงุฆูุงุช ุงูุฃุชูุชุฉ ูู ุญุงูุฉ ูุตู ุงูุนูู. </font><font style="vertical-align: inherit;">ุนูู ุฃู ุญุงู ุ ุฃูุช ุจุญุงุฌุฉ ุฅูู ููุฑุฉ ุนู ููููุฉ ุนูู PostgreSQL ูุงููุณุฎ ุงููุชูุงุซู ุ ูููู ูุฏูุฑ Patroni PostgreSQL ุ ูููู ูุชู ุถูุงู ุงูุชูุงุนู ุจูู ุงูุนูุฏ. </font><font style="vertical-align: inherit;">ูุนุฏ ุฐูู ุถุฑูุฑููุง ุญุชู ุชุชููู ูู ุฅุตูุงุญ ุงููุดุงูู ุงูุชู ุชูุดุฃ ุจูุฏูู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุทูุงุช ุงูุชุดุฎูุต</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุฏุซ ุฐูู ุฃููุง ูุนูู ูุน ุนููุงุก ูุฎุชูููู ุ ููุนุธููู ููุณ ูุฏููู ููุฏุณ ELK ุ ูุนููู ูุฑุฒ ุงูุณุฌูุงุช ุนู ุทุฑูู ูุชุญ ุนูุงูุชู ุชุจููุจ ู 6 ูุญุฏุงุช ุชุญูู: ูู ุนูุงูุฉ ุชุจููุจ Patroni ููู ุนูุฏุฉ ุ ูู ุงูุฃุฎุฑู - ุณุฌูุงุช ุงูููุตู ุฃู PostgreSQL. </font><font style="vertical-align: inherit;">ูู ุงูุตุนุจ ุชุดุฎูุต ูู ูุฐุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุทูุฑุช ุงูููุฌ ุงูุชุงูู. </font><font style="vertical-align: inherit;">ุฃูุง ุฏุงุฆูุง ุฃุดุงูุฏ ููุช ุญุฏูุซ ุงููุดู. </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ูู ุฅูู ููุน ูู ูุณุชุฌูุนุงุช ุงูููุงู. </font><font style="vertical-align: inherit;">ุฃูุธุฑ ุฅูู ูุง ุญุฏุซ ูุจู ูุฃุซูุงุก ูุจุนุฏ ุงูุนุงุดู. </font><font style="vertical-align: inherit;">ุงููุดู ูู ุทุงุจุนุชุงู ุฒูููุชุงู - ุงูุจุฏุงูุฉ ูุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ูู ุงูุณุฌูุงุช ุ ุฃูุธุฑ ุฅูู ูุง ุณุจู ุงูุนุงุดู ุ ุฃู ุฃููู ุฃุจุญุซ ุนู ุฃุณุจุงุจ. </font><font style="vertical-align: inherit;">ููุฐุง ูุนุทู ููููุง ููุง ุญุฏุซ ููุง ูููู ุงูููุงู ุจู ูู ุงููุณุชูุจู ุญุชู ูุง ูุญุฏุซ ุงูุนุงุดู ูู ููุณ ุงูุธุฑูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฐุง ุ ุฃูุธุฑ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณุฌูุงุช Patroni.</font></font></li>
<li>  PostgreSQL   DCS    ,     Patroni.</li>
<li>  โ     ,    .</li>
</ul><br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุงูุนุฏูุฏ ูู ุงูููุชุฌุงุช ุงูุฃุฎุฑู ููููู ุงูุชููุงุฆู: stolon ุ repmgr ุ pg_auto_failover ุ PAF. ููุฏ ุฌุฑุจุช ุฌููุน ุงูุฃุฏูุงุช ุงูุฃุฑุจุนุฉ ููู ุฑุฃูู ุฃู Patroni ูู ุงูุฃูุถู ูู ุงูุณูู ุงูููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃูุตู ุจุงุชุฑูููุ ุจุงูุชุฃููุฏ ุ ูุนู ุ ูุฃููู ุฃุญุจ Patroni ุ ุฃุนุชูุฏ ุฃููู ุชุนููุช ููููุฉ ุทูููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ููุช ููุชููุง ุจุงููุธุฑ ูู ุงููุดููุงุช ุงูุฃุฎุฑู ุงูุชู ุชูุงุฌู Patroni ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูู ุงูููุถุญุฉ ูู ุงูููุงูุฉ ุ ูููููู ุฏุงุฆููุง ุงูุงูุชูุงู ุฅูู ุงูุตูุญุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/zalando/patroni/issues</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ููุงู ุงูุนุฏูุฏ ูู ุงููุตุต ุงููุฎุชููุฉ. ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ูุตููู ูู ุงููุณุชุฎุฏููู ุงูุฃูููู ุงูุฐูู ูุทุฑุญูู ุฃุณุฆูุฉ ุบุจูุฉ ุฏูู ุฃู ูููููุง ุฃููุณูู ุนูุงุก ุงูุจุญุซ ุงูุจุณูุท ุ ุฅูุง ุฃูู ูุชู ุฃูุถูุง ููุงูุดุฉ ุงููุดููุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ููุงู ุ ููุชูุฌุฉ ููููุงูุดุงุช ุ ูุชู ูุชุญ ููุงู ุฅุตูุงุญ ุงูุฃุฎุทุงุก ุฅุฐุง ูุฒู ุงูุฃูุฑ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจูุถู Zalando ูุชุทููุฑ ูุฐุง ุงููุดุฑูุน ุ ููุฐูู ุฅูู ุงูุดุฎุตูู ุงูุฐูู ุจุฏุฃูุง ุงูุนูู ุนูู ูุฐุง ุงูููุชุฌ: Alexander Kukushkin ู Alexey Klyukin. ุดูุฑุง ุฌุฒููุง ูุฌููุน ุงููุณุงูููู ูู Patroni. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ูุฐุง ุงูุชูุฑูุฑ ุ ุณุฌููุง ููุงุจูุฉ ูุตูุฑุฉ ุญุงูู ูููุง ุฃูููุณ ุชุถููู ุชูุฑูุฑู ูู ูุฌูุณ ูุงุญุฏ ูุฃุฎุจุฑูุง ุนู ุณุจุจ ุงููุดุงุฑูุฉ ูุงูุชุญุฏุซ ูู ุงููุคุชูุฑุงุช. ุงุญูู ุงูุณูุงุญ ูุชุนุงู ููุชุญูู ูู ููุฌ Saint HighLoad ++.</font></font></i><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lnw02pCpgRw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<blockquote> HighLoad++   6-7 .      ,    .          ,        ( ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a>).      -  <strong></strong>     ,  ,     ,     .<br>
<br>
    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Saint HighLoad++</a>!    ,  ,      PostgreSQL:   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>,     PostgreSQL    JSON    ;   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>   PostgreSQL 13,  ;   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>     .</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar489194/index.html">ููู ูููู OpenShift ุจุชุบููุฑ ุงููููู ุงูุชูุธููู ููุคุณุณุฉ ุชูููููุฌูุง ุงููุนูููุงุช. ุชุทูุฑ ุงูููุงุฐุฌ ุงูุชูุธูููุฉ ุนูุฏ ุงูุงูุชูุงู ุฅูู PaaS</a></li>
<li><a href="../ar489196/index.html">ุงูุฏุฎุงู ุงูุณุญุฑู: ูุญุฏุงุช ุงูุชุญูู ุงูุฏูููุฉ ููุงุจู ุงูููุธููู ุงูุฎุทููู</a></li>
<li><a href="../ar489198/index.html">ููู ูุง ุชุทูู ุงููุงุฑ ุนูู ูุฏูู ุจุงุณุชุฎุฏุงู Liquibase</a></li>
<li><a href="../ar489200/index.html">ูุง ุชุจุญุซ ุนูู ุงูุดุฑูุงุช ุงููุงุดุฆุฉ ูู Y Combinator ูู ุนุงู 2020</a></li>
<li><a href="../ar489204/index.html">ูุธุฑุฉ ุฏุงุฎููุฉ ุนูู ููุซูููุฉ ุฎุฏูุงุช Facebook</a></li>
<li><a href="../ar489210/index.html">ุงุฎุชุจุงุฑ ุฃุฏุงุก ููุฏ ููููุณ ูุน ุฃูุซูุฉ</a></li>
<li><a href="../ar489212/index.html">1C-Bitrix ูููุน ุฅูุบุงุก ุงูุงุดุชุฑุงู ูู ุงููุดุฑุฉ ุงูุฅุฎุจุงุฑูุฉ ูู ุฎูุงู ุดุฑุท ุชูุฏูู ุจูุงูุงุชูู ุงูุดุฎุตูุฉ</a></li>
<li><a href="../ar489214/index.html">ุงูููุฌ ุงูุญุฏูุซ ูุงุฎุชุจุงุฑ ุงูุชูุทูู ุนูู iOS</a></li>
<li><a href="../ar489218/index.html">ุฅููุง ุณุงุฐุฌุฉ. ุณูุจุฑ: ููุฏ ูุจููุฉ ูุนุจุฉ ุจุณูุทุฉ</a></li>
<li><a href="../ar489226/index.html">ุทุฑู ุชุญุณูู ุงุณุชุนูุงูุงุช LINQ ูู C # .NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>