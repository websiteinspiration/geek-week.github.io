<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕣 😏 🏇🏻 「怠惰な」手で「豊かな」人のためのスマートなランプ、それは「シンプル」で便利です 🆑 ⛱️ ✳️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 彼は、arduinoによって制御されるLEDストリップ（ランプ1と呼ぶ）に基づいて、シンク、ストーブ、カッティングテーブル用の「モダン」な照明をキッチンに作りました。このデザインは、「脳」のパワー部分が劣化するまで2年間機能しました。これは、「即興のゴミ」から再びホイールを再発明する絶好の...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>「怠惰な」手で「豊かな」人のためのスマートなランプ、それは「シンプル」で便利です</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488480/"><img src="https://habrastorage.org/webt/os/hi/gl/oshiglmjknpmabuu6ivivauqzdw.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼は、arduinoによって制御されるLEDストリップ（ランプ1と呼ぶ）に基づいて、シンク、ストーブ、カッティングテーブル用の「モダン」な照明をキッチンに作りました。</font><font style="vertical-align: inherit;">このデザインは、「脳」のパワー部分が劣化するまで2年間機能しました。</font><font style="vertical-align: inherit;">これは、「即興のゴミ」から再びホイールを再発明する絶好の機会です（ランプ2）。</font><font style="vertical-align: inherit;">確かに、今回の「ゴミ」は高価で、Z-waveスマートホームと互換性があります。</font><font style="vertical-align: inherit;">以下は、ArduinoをZUNo（Z-waveデバイスを作成するためのarduino互換モジュール）に置き換えて、コードを最大限に節約し、必要な変更を説明するストーリーです。</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私がそこに現れる前に何が起こったのか</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
むかしむかし、皿洗いや料理をするために、流しの上のランプをつける必要がありました。</font><font style="vertical-align: inherit;">それはやり直した電気スタンドでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
濡れた手で小さなスイッチを押すのは好きではありませんでした。それは白熱灯に220ボルトを切り替えたからです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/yz/dq/tlyzdqgfcsedxxsswsqlekygins.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ランプの光は主に流し台に当たるのですが、調理台やコンロを明るく照らしたいと思いました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目的：</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> キッチンのオン/オフライトを非接触にします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> シンク、調理台、ストーブを均等に照らします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 白熱電球をLEDに置き換えることでエネルギーを節約します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼はランプ1を組み立てました。これは、RGBテープ用のディフューザーと制御ユニットを備えた2メートルのアルミニウムボックスで構成されていました。店でボックスとディフューザーを既製で購入し、テープがあり、コントロールユニットは長い間隅にあり、翼の中で待っていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ケースは工業用（防塵、防水）でした。テープは12ボルトなので、220 V〜12 Vの電源ユニットがユニット内にあり、TLP250（オプトカプラー）に基づくテープを制御するためのガルバニック絶縁ボードも、コンパクトな設計でこのすべてのarduinoを制御しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 古いプロジェクトからガルバニック絶縁を取得しました。ナイトスタンドでミニバーのバックライトを作ってみました。ドアが開かれたとき、タッチパッドは容量の変化を記録し、柔らかくきらめく光をオンにしました。つまり、ボードは現在のプロジェクトに非常に適していて、残っているのは不要なものをすべてカットすることだけでした。ボードには5ボルトのリニアコンバーターがあり、ZUNoから電力が供給されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
超音波距離計にハンドトレイをつけてランプをつける予定でした。彼はそれを蓋に取り付け、他のすべての部品は箱に入った。すべてが「確実に」ホットメルト接着剤で固定されています。テスト時には、外部設置用のライトスイッチからコントロールユニットへの電源の横にボタンを作成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/dn/tj/r2dntjzjoijyn-g7vk4vdkg-d5y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライトをオンにすると、より便利で安全になります。</font><font style="vertical-align: inherit;">キッチンキャビネットの底に逆さまに取り付けられており、濡れた手から内側から水が入りにくくなっています。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のコントロールユニットからの結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のLEDストリップの不自然な演色により、キッチンの作業エリアの照明がより均一で快適になり、一部の製品の色が変化しました。</font><font style="vertical-align: inherit;">例：ニンジンは明るい色のため、はるかに食欲をそそるように見えました。</font><font style="vertical-align: inherit;">しかし、それはそれほど干渉しませんでした、そして私はそれがあまり害を及ぼさないことを望みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非接触型オン/オフで、すべてがさらに悪いことが判明しました。</font><font style="vertical-align: inherit;">動いた。</font><font style="vertical-align: inherit;">しかし、オフ状態で5分後、LEDストリップで点滅が始まりました。</font><font style="vertical-align: inherit;">オプトカプラーで回路をやり直さず、すべてそのままにしました。</font><font style="vertical-align: inherit;">オンとオフを切り替えるだけで、新しいスイッチが使用され始めました。</font><font style="vertical-align: inherit;">誰もがその場所と形が好きでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2年間以上使用すると、調理中に分泌された脂肪やその他の化合物が体内や体内に蓄積されます。</font><font style="vertical-align: inherit;">このプラークは、ワイヤーが入るための穴から部分的にハウジングに浸透しました。</font><font style="vertical-align: inherit;">しかし、体の光沢のある表面により、この物質は凝縮してゼラチン状の塊になります。</font><font style="vertical-align: inherit;">触って心地よく、無臭で…（味わいませんでした）。</font><font style="vertical-align: inherit;">私はその場所をドラゴン胚の形で何枚か写真を撮りました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/fr/ys/jzfrystsmthfk7fy5j_o70kkcfm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ot/br/mg/otbrmglxan7uooc1a1e4n88z9iq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
壁では、この物質はひどい襲撃に変わり、それは単なる洗濯ではありません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何になった</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビンの中でうろついていると、ZUNoの未完成の拡張モジュールを見つけました。</font><font style="vertical-align: inherit;">ZUNoは、Z-Waveスマートホームと互換性のある独自のデバイスを設計するためのarduinoのようなボードです。</font><font style="vertical-align: inherit;">arduinoの環境からプログラミングされています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メーカー仕様：</font></font></b><div class="spoiler_text"><ul>
<li>28 kB Flash memory for your sketches</li>
<li>2 kB RAM available</li>
<li>Z-Wave RF transmitter at 9.6/40/100 kbps</li>
<li>26 GPIO (overlaps with special hardware controllers)</li>
<li>4 ADC</li>
<li>5 PWM</li>
<li>2 UART</li>
<li>1 USB (serial port)</li>
<li>16 kB EEPROM</li>
<li>1 SPI (master or slave)</li>
<li>4 IR controllers, 1 IR learn capability</li>
<li>1 TRIAC/ZEROX to control dimmer</li>
<li>3 Interrupts</li>
<li>1 Timer 4 MHz</li>
<li>I2C (software)</li>
<li>1-Wire (software)</li>
<li>8x6 Keypad Scanner (software)</li>
<li>2 service LED, 1 service button</li>
<li>1 user test LED</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拡張モジュールにより、ZUNoは本格的なデバッグボードになり、プロトタイプをデバッグした後、完全なデバイスとして使用できます。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メーカーからの情報：</font></font></b><div class="spoiler_text"><ul>
<li>One 0-10 V analog output — control industrial dimmers</li>
<li>Up to four PWM or switch outputs (up to 5 A per channel) — control contactors, switches, halogen bulbs or LED strips</li>
<li>Up to eight digital 0/3 V inputs or outputs — connect various low voltage digital senors and actors</li>
<li>Up to four digital 0/3, 0/5 or 0/12 V digital or analog inputs — connect industrial 10 V sensors or any Arduino-compatible sensor</li>
<li>RS485 or UART — for industial meters</li>
<li>OneWire — for DS18B20 or other sensors</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のプロジェクトでは、12ボルトをLEDストリップに切り替えるための3つの強力なトランジスタと、ZUNoに電力を供給する12ボルトから5ボルトへのコンバーターが必要です。</font><font style="vertical-align: inherit;">拡張モジュール周辺の残りの部分は、はんだ付けまたはテストされていません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4j/kr/tt/4jkrtt63ocqqrkugav0nrtfvtn8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回路のこの部分には、「極性反転」に対する保護のための電源用の十分なダイオードがなく、パワー電界効果トランジスタのゲートの抵抗は、制限抵抗の前ではなく、ゲートに接続する必要がありました。</font><font style="vertical-align: inherit;">これについては、結論で詳しく説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この拡張モジュールは、Gaintaのハウジングで提供されます。</font><font style="vertical-align: inherit;">以前のコントロールユニットもこの会社のケースでしたが、サイズが異なりました。</font><font style="vertical-align: inherit;">残念ながら、モジュールの留め具は古いケースに適合せず、新しいものを開けたくなかったので、古いケースをそのままにしておきました。</font><font style="vertical-align: inherit;">ボードはホットメルト接着剤に「植え付けられました」。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wm/ls/ah/wmlsahydh07_hxmpqaryl1atchs.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArduinoとZUNoのプログラミングについて</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Z-waveデバイスには、特定の数のクラスが必要です。クラスは、デバイスの機能と対話インターフェイスを記述します。たとえば、私のランプは3色（赤、緑、青）で構成されるLEDストリップを制御します。これらの機能は、Switchマルチレベルクラスによって実行されます。これをスケッチに追加すると、リモートでいずれかの色の明るさを変更できます。 3つの色を制御するには、このクラスの3つのインスタンスを作成する必要があります。これについてはこれ以上詳しく説明しません。なぜなら、ルーチンのクラス操作は、「チャネル」の概念によってZUNoユーザーに対して隠されているためです。たとえば、Switchマルチレベルの3つのクラスが必要なので、コードにはSwitchマルチレベルの3つのチャネルと、無線制御用のいくつかのコールバック関数が表示されます。これを行う方法？また、Switch基本クラスを追加する必要があります。（ネットワークコントローラーインターフェイスから）ボタンを押すだけでランプのオン/オフを切り替え、毎回3チャネルを構成しない。</font></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_MULTILEVELの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
例が配置されている開発者のWebサイトにアクセスする必要があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ZUNoがサポートする各クラスには、説明と例があります。</font><font style="vertical-align: inherit;">次に、提案された関数をコピーしてスケッチに貼り付けます。</font><font style="vertical-align: inherit;">これでスケッチには、無線のコマンドに応答するための3つのスイッチマルチレベルチャネルと6つのコールバック関数があります。</font><font style="vertical-align: inherit;">Z-Waveクラスはあまり洗練されていないので、以前のLEDストリップデバイスはこのクラスセットで動作しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チャネルは次のように宣言されました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スポイラーの見出し</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(<font></font>
      ZUNO_SWITCH_MULTILEVEL(getRed, setRed),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getGreen, setGreen),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getBlue, setBlue),<font></font>
      ZUNO_SWITCH_BINARY(switch_getter, switch_setter)<font></font>
);</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、ネットワークに追加した後、コントローラーに次のウィジェットが生成されまし</font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/-y/if/to-yif5eaf9xkuxdk4t2oxp6ph4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
た。色を調整するには、コントローラーメニューで各色を個別に開いて構成する必要がありました。</font><font style="vertical-align: inherit;">不便で遅いです。</font><font style="vertical-align: inherit;">しかし、私は幸運でした。</font><font style="vertical-align: inherit;">私は一人じゃないことがわかった。</font><font style="vertical-align: inherit;">彼らは私たちのことを考えて、チャネルを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_COLORにしました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これで、スケッチには1つのチャネルと2つのコールバック関数しかありません。</font><font style="vertical-align: inherit;">コントローラのメニューでは、カラー設定は、パレットから選択することにより、各色に対して個別に、または一度に実行されます。</font></font><br>
<br>
<pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コントローラメニューでは</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m3/zn/qk/m3znqkbwue228cttqmqmhggvwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようになります。次の関数は、無線を介して要求に応答します。</font><font style="vertical-align: inherit;">いずれかのカラーチャネルのステータスを読み取る要求が来る場合があります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、コントローラーインターフェースから色を設定する機能です。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
arduinoのスケッチをZUNoのスケッチに変換するために追加する必要があるコードはこれだけです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み立てと設置の後、宣言されたすべてのタスクが完了しました。</font><font style="vertical-align: inherit;">ただし、スイッチでライトをオンにする習慣は残っていました（非常に便利であることがわかりました）。</font><font style="vertical-align: inherit;">非接触挿入オプションも機能します。</font><font style="vertical-align: inherit;">欠点としては、コントロールユニットに電源を投入してからLEDランプが1秒間点滅することに注意したい。</font><font style="vertical-align: inherit;">これは、ZUNoペリフェラルの初期化が長いためです。</font><font style="vertical-align: inherit;">この時点では、脚は予測できません。</font><font style="vertical-align: inherit;">トランジスタのゲートのプルアップ抵抗は、制限抵抗の後に置くと状況を修正すると思います。</font><font style="vertical-align: inherit;">初期化コードがレッグを出力に合わせて調整し、論理レベルを意図的に変更する場合、短いパルスを通過させないRCフィルターを試すことができます。</font><font style="vertical-align: inherit;">まだやっていないし、たぶんやらない！</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ZUNoとその拡張モジュールは、「家の技術的な創造性」を大幅に簡素化します。ただし、これらの製品は非常に高価であると私は考えています。他の場所で働いていて、Z-Wave機器が周りになかったら、ESP8266ですべてを行います。開発中に、電源からのワイヤにマーキングするための新しい「標準」を学びました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sx/c4/4h/sxc44hipyu2ml_agdxtaqthtvrs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
地球は黒い縞模様でマークされているだけでなく、私の場合は「プラス」のワイヤーのようになっています。拡張モジュールにとって、これは重要であることがわかりました。 5ボルトのLM2594コンバーターは故障しています（チップとディップの価格は約200ルーブルです）。拡張モジュールの次のバージョンで、「極性反転」に対する保護ダイオードが存在することを願っています。そして、電源線の極性を確認します。別の欠点は体に関連しています。ケースは良さそうですが、ピンセットなしで端子台に配線できませんでした。他の端子台を備えたバージョンがあることを願っています（上から、または斜めにワイヤを接続するため）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
写真をクラウドサービスに保存したくないし、バックアップを作成することもよくあります。したがって、設計プロセスとランプ1に関連する写真のほとんどは、回復不能なほど破損しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/wz/ov/zzwzovgton7f2yxvy-2bd4zhucu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが、アセンブリおよびデバッグプロセスの残りの部分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、少し曲げるとバックライトが作動したようです。</font><font style="vertical-align: inherit;">まっすぐにすると、ボックスとスイッチが見えなくなります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ya/qj/hn/yaqjhnpkhd7ge2ohejbp9ywkqpq.jpeg"> <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZUNoのスケッチ。</font><font style="vertical-align: inherit;">私は、すべてが初級であることを確認するためだけに添付します</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPROM.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPR.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">int</span> readPin = <span class="hljs-number">9</span>;
<span class="hljs-keyword">int</span> triggerPin = <span class="hljs-number">10</span>;<font></font>
byte controlState = <span class="hljs-number">0</span>;<font></font>
word lastValue;<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REDPIN   PWM1     <span class="hljs-comment">// pin connection R </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREENPIN PWM2     <span class="hljs-comment">// pin connection G</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BLUEPIN  PWM3     <span class="hljs-comment">// pin connection B</span></span><font></font>
<font></font>
ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> OFF 0</span>
<span class="hljs-keyword">uint8_t</span> switch_=OFF;<font></font>
<font></font>
<span class="hljs-keyword">uint8_t</span> pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmB=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmB=<span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-keyword">enum</span><font></font>
{<font></font>
  DEF_R = <span class="hljs-number">255</span>,<font></font>
  DEF_G = <span class="hljs-number">255</span>,<font></font>
  DEF_B = <span class="hljs-number">255</span><font></font>
};<font></font>
<span class="hljs-keyword">uint8_t</span> radio_action = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> 
</span>{ <font></font>
  init_EEPROM();<font></font>
  Serial.begin();<font></font>
  pinMode(readPin, INPUT);<font></font>
  pinMode(triggerPin, OUTPUT);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  pinMode(REDPIN, OUTPUT);<font></font>
  pinMode(GREENPIN, OUTPUT);<font></font>
  pinMode(BLUEPIN, OUTPUT);<font></font>
  analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
  <font></font>
} <font></font>
<span class="hljs-keyword">int</span> act=<span class="hljs-number">1</span>;
<span class="hljs-keyword">int</span> actf = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> cnt=<span class="hljs-number">57</span>; <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> tmp;
  <span class="hljs-comment">// trigger measurement</span><font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, HIGH);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  <span class="hljs-comment">// read pulse width</span>
  tmp = pulseIn(readPin, HIGH, <span class="hljs-number">100000</span>);<font></font>
  lastValue = tmp / <span class="hljs-number">58</span>;<font></font>
  Serial.print(<span class="hljs-string">" cm= "</span>);<font></font>
  Serial.println(lastValue);<font></font>
  <span class="hljs-keyword">if</span> (lastValue &lt; <span class="hljs-number">30</span>)<font></font>
  {<font></font>
    cnt++;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    cnt--;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">55</span>)<font></font>
  { <font></font>
    act=<span class="hljs-number">1</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">60</span>)<font></font>
    cnt= <span class="hljs-number">60</span>;
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">50</span>)<font></font>
  {<font></font>
    act=<span class="hljs-number">0</span>;<font></font>
    actf=<span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">45</span> )<font></font>
    cnt = <span class="hljs-number">45</span>;<font></font>
  <font></font>
  <span class="hljs-keyword">if</span> ((act == <span class="hljs-number">1</span>) &amp;&amp; (actf == <span class="hljs-number">0</span>))<font></font>
  {  <font></font>
    actf = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (switch_ == OFF)<font></font>
    {<font></font>
      switch_=ON;<font></font>
      b_pwmG = pwmG;<font></font>
      b_pwmB = pwmB;<font></font>
      b_pwmR = pwmR;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      switch_=OFF;<font></font>
      b_pwmR=<span class="hljs-number">0</span>;<font></font>
      b_pwmG=<span class="hljs-number">0</span>;<font></font>
      b_pwmB=<span class="hljs-number">0</span>;<font></font>
    }<font></font>
    analogWrite(REDPIN, b_pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, b_pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, b_pwmB &amp; <span class="hljs-number">0xff</span>); <font></font>
  } <font></font>
  <font></font>
  Serial.print(<span class="hljs-string">"cnt = "</span>);    <font></font>
  Serial.print(cnt);  <font></font>
  Serial.print(<span class="hljs-string">" || "</span>);    <font></font>
  Serial.print(pwmR);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);      <font></font>
  Serial.print(pwmG);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.print(pwmB);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.println(<span class="hljs-string">""</span>);
 <span class="hljs-comment">// delay(10);</span><font></font>
<font></font>
 <span class="hljs-keyword">if</span>(radio_action)<font></font>
 {<font></font>
    radio_action = <span class="hljs-number">0</span>;<font></font>
    eepr_save_col();<font></font>
    analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
 }<font></font>
}<font></font>
<font></font>
<span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488470/index.html">キム・ドットコム：キャッチ、オンラインで最も欲しい人。パート4</a></li>
<li><a href="../ja488472/index.html">週末の読書：ソビエトのカーラジオからノイズキャンセリングプラグまで、オーディオガジェットに関する10の資料</a></li>
<li><a href="../ja488474/index.html">色、音、そして「群衆探検」について別の美しいものとして</a></li>
<li><a href="../ja488476/index.html">テスラチューブコイル</a></li>
<li><a href="../ja488478/index.html">すべてのMS SQL Serverデータベースを別のマシンに転送する</a></li>
<li><a href="../ja488482/index.html">人々のためのアピウムはいくらですか</a></li>
<li><a href="../ja488484/index.html">SQL Launch-Microsoft SQL Server 2019イベント</a></li>
<li><a href="../ja488488/index.html">OpenBSDの場合。少しの喜び</a></li>
<li><a href="../ja488490/index.html">呼吸器のLikbez。人工呼吸器はウイルス感染に役立ちますか？11マスクの概要</a></li>
<li><a href="../ja488492/index.html">テスラは20億ドルで新株を発行する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>