<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ½â€ğŸš’ â™£ï¸ âš½ï¸ å±é™ºãªå‘¨è¾ºæ©Ÿå™¨ï¼šThunderspyã‚’ç†è§£ã™ã‚‹ ğŸ¤´ğŸ¿ ğŸ†‘ â™¿ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¹´ã€…ã€æŠ€è¡“ã®é€²æ­©ã‚’ç›®ã®å½“ãŸã‚Šã«ã—ã¦ã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®å‡¦ç†èƒ½åŠ›ãŒå‘ä¸Šã—ã€ãƒ‡ãƒ¼ã‚¿è»¢é€é€Ÿåº¦ãŒå‘ä¸Šã—ã€æ–°ã—ã„æ¨™æº–ãŒç™»å ´ã—ã¦ã„ã¾ã™...ã—ã‹ã—ã€ã‚ã‚‹æœ‰åãªæ˜ ç”»ã§è¨€ã‚ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€å¤§ããªè²¬ä»»ã«ã¯å¤§ããªåŠ›ãŒä¼´ã„ã¾ã™ã€‚æ–°ã—ã„æ¨™æº–ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‹ã‚‰ï¼ˆé«˜é€Ÿã«åŠ ãˆã¦ï¼‰ä½•ãŒå¾—ã‚‰ã‚Œã¾ã™ã‹ï¼ŸThunderboltã¨U...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>å±é™ºãªå‘¨è¾ºæ©Ÿå™¨ï¼šThunderspyã‚’ç†è§£ã™ã‚‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ntc-vulkan/blog/504884/"><p><img src="https://habrastorage.org/webt/bp/so/rw/bpsorwpshloikmzyrf6dalzwzfa.png" alt="ç”»åƒ"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹´ã€…ã€æŠ€è¡“ã®é€²æ­©ã‚’ç›®ã®å½“ãŸã‚Šã«ã—ã¦ã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®å‡¦ç†èƒ½åŠ›ãŒå‘ä¸Šã—ã€ãƒ‡ãƒ¼ã‚¿è»¢é€é€Ÿåº¦ãŒå‘ä¸Šã—ã€æ–°ã—ã„æ¨™æº–ãŒç™»å ´ã—ã¦ã„ã¾ã™...ã—ã‹ã—ã€ã‚ã‚‹æœ‰åãªæ˜ ç”»ã§è¨€ã‚ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€å¤§ããªè²¬ä»»ã«ã¯å¤§ããªåŠ›ãŒä¼´ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ–°ã—ã„æ¨™æº–ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‹ã‚‰ï¼ˆé«˜é€Ÿã«åŠ ãˆã¦ï¼‰ä½•ãŒå¾—ã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">Thunderboltã¨USB4ã«ã¯ã©ã®ã‚ˆã†ãªè„…å¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">å½¼ã‚‰ãŒãã‚Œã‚’èª¬æ˜ã™ã‚‹ã®ã§ã€Thunderspyã¯å±é™ºã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ãã‚Œã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ï¼</font></font></p><a name="habracut"></a><br>
<h1 id="periferiya-nachalo">: </h1><br>
<p>   Â«Â»       :    .      ,  ,  ,    .       :   ,     -  ,   Â«Â»    ,   .     :</p><br>
<p><img src="https://habrastorage.org/webt/rz/th/qm/rzthqmf8bshluwpqej7d2ijmsmk.png" alt="ç”»åƒ"></p><br>
<p>  ,  Intel 8086,           ,      - (Input/Output, I/O).     I/O,         Â«IO/MÂ»,         .          0x0000  0xFFFF: </p><br>
<p><img src="https://habrastorage.org/webt/7m/ko/ep/7mkoepcbflsume2lrwhqqis0xxk.png" alt="ç”»åƒ"></p><br>
<p> I/O-            x86  x86-64.   ,    I/O-     in  out: </p><br>
<p><img src="https://habrastorage.org/webt/dn/jy/3q/dnjy3qwh00okgeod4qaywkazwgy.png" alt="ç”»åƒ"></p><br>
<p>   I/O-     , : </p><br>
<ul>
<li>   PS/2; </li>
<li>RTC â€“    ; </li>
<li>COM-  LPT-; </li>
<li>IDE-  . </li>
</ul><br>
<h1 id="periferiya-dma">: DMA</h1><br>
<p> ,    -   :    I/O-     -,      in    32  .            .   !<br>
           (Direct Memory Access, DMA).        ,     ,      : </p><br>
<p><img src="https://habrastorage.org/webt/fh/6k/39/fh6k39vx4guidefctkwseq3i-zs.png" alt="ç”»åƒ"></p><br>
<p>            ,       (USB, SATA, NVMe, Wi-Fi): </p><br>
<p><img src="https://habrastorage.org/webt/7j/4-/jy/7j4-jyvlzbhscowytj3fgddrvrk.png" alt="ç”»åƒ"></p><br>
<h1 id="dma-ataki">DMA-</h1><br>
<p> ,     ,    .  ,     ,    ,       .       ,        â€“  ,  ,  PCI Leech: </p><br>
<p><img src="https://habrastorage.org/webt/qk/ak/is/qkakisms5phicjdzbuik7ija7wo.png" alt="ç”»åƒ"></p><br>
<p>   DMA-    .   PCI  PCI Express,    DMA,   ,           .      DMA-  IEEE 1394 (FireWire),        : </p><br>
<p><img src="https://habrastorage.org/webt/v0/si/iu/v0siiuvdsqgdkqqoycwtljkr0x4.png" alt="ç”»åƒ"></p><br>
<h1 id="thunderbolt">Thunderbolt</h1><br>
<p>   Thunderbolt.   Thunderbolt-     PCI Express:    PCI Express           .<br>
-       : </p><br>
<p><img src="https://habrastorage.org/webt/ps/fo/wf/psfowfufybuq4lca5gbkefjai2m.png" alt="ç”»åƒ"></p><br>
<p>â€¦     PCI Express: </p><br>
<p><img src="https://habrastorage.org/webt/ih/gs/dt/ihgsdtmwskvhh1f-1duhksqahgg.png" alt="ç”»åƒ"> </p><br>
<p> ,     ,  Thunderbolt-,     !      .</p><br>
<p>       Thunderbolt      .         ,    .     ,   BIOS,  : </p><br>
<ul>
<li>    (SL0); </li>
<li>    (SL1, SL2); </li>
<li>    (SL3). </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/bw/sb/ib/bwsbibcvxaja9_vswfjtj2wvlpw.png" alt="ç”»åƒ"></p><br>
<p>         User Authorization (SL1),       Windows     : </p><br>
<p><img src="https://habrastorage.org/webt/hf/zl/y4/hfzly49ipeqhyk_odldz4_h4tqe.jpeg" alt="ç”»åƒ"></p><br>
<p>        ,          . </p><br>
<h1 id="io-mmu">I/O MMU</h1><br>
<p>   ,    â€“         Â« â€“ Â»?      Apple,   Thunderbolt.  Thunderbolt-  MacBook  iMac       ,    . </p><br>
<p><img src="https://habrastorage.org/webt/we/ev/x7/weevx7akw8menlqlcavvwlc4ugy.png" alt="ç”»åƒ"></p><br>
<p>   I/O MMU (Input/Output Memory Management Unit),     .</p><br>
<p>          ,    â€“   DMA-.      PCI Express     ,    I/O MMU   Â«Â»         ,   .   I/O MMU           . </p><br>
<p><img src="https://habrastorage.org/webt/o7/iq/a-/o7iqa-iz4asxnga0ckc8dyr5qcu.png" alt="ç”»åƒ"></p><br>
<p>  Apple Microsoft    .     2019     Â« DMA Â»,      Thunderbolt-          BIOS. </p><br>
<h1 id="thunderspy--po-punktam">Thunderspy â€“  !</h1><br>
<p>   ,     Thunderbolt    Thunderspy.       Thunderbolt -     .    ,    . </p><br>
<h3 id="1-otsutstvie-proverki-celostnosti-proshivki">1.    </h3><br>
<p> -  Thunderbolt 3       ,     USB Type C Power Delivery (PD): </p><br>
<p><img src="https://habrastorage.org/webt/9j/jg/5b/9jjg5btnlgq6so_dfqe2s-x2yeg.png" alt="ç”»åƒ"></p><br>
<p> ,          !  ,    Thunderbolt     No Security,            . </p><br>
<p>          Thunderbolt Controller Firmware Patcher,     <u>  </u>.           . </p><br>
<p>,        .     â€“      ,      PCI Express ,    . </p><br>
<h3 id="2-slabaya-autentifikaciya-ustroystv">2.   </h3><br>
<p>    Â«Â»     ,       .   Secure Connect   UUID      SL2    (  ). </p><br>
<p><img src="https://habrastorage.org/webt/06/lb/xj/06lbxjylu_aodbcqbl8m5cd2iws.png" alt="ç”»åƒ"></p><br>
<p>  ,     Thunderbolt-  .    Thunderbolt 3 UUID        .       Thunderbolt 3  128- UUID: </p><br>
<p><img src="https://habrastorage.org/webt/d6/cz/8z/d6cz8zhlnpbnu1kxn-2r9vhgfjw.png" alt="ç”»åƒ"></p><br>
<p>   64- UUID     Thunderbolt 2    UUID  DROM,  128-     :  DROM     . </p><br>
<h3 id="3-metadannye-ustroystva-mozhno-izmenyat">3.    </h3><br>
<p>  Thunderbolt- (, , )     DROM,   : </p><br>
<p><img src="https://habrastorage.org/webt/4_/vv/sy/4_vvsyi79jwlshakbeee9-3rhum.png" alt="ç”»åƒ"></p><br>
<p>      Â«Â» Thunderbolt-,   ,    .</p><br>
<p>    ,    Thunderbolt, â€“ Thunderclap.   ,   Apple MacOS  Â« Â»  Thunderbolt-       .   ,     (Apple    ID    Thunderbolt-?        ?). </p><br>
<p>          PCI-Express-.   DROM     ,       ,      .</p><br>
<h3 id="4-obratnaya-sovmestimost-s-thunderbolt-1-i-2">4.    Thunderbolt 1  2</h3><br>
<p>    â„– 2,      Thunderbolt 3 (    UUID)    Thunderbolt 2.        UUID   ,    ,      ,    .</p><br>
<p>,      .</p><br>
<h3 id="5-nekorrektnaya-obratnaya-svyaz-konfiguracii-thunderbolt">5.     Thunderbolt</h3><br>
<p>   Thunderbolt-   UEFI: </p><br>
<p><img src="https://habrastorage.org/webt/1y/wg/76/1ywg76awm7lugutvwxe6ftcgrwy.jpeg" alt="ç”»åƒ"></p><br>
<p>  UEFI       ,     BIOS .      ,   BIOS    .</p><br>
<p>   Windows,    Linux  ,       :</p><br>
<p><img src="https://habrastorage.org/webt/_1/jl/q1/_1jlq1w_xoywnexjokpptlsm9ek.png" alt="ç”»åƒ"></p><br>
<h3 id="6-vozmozhnost-zablokirovat-zapis-po-spi">6.     SPI</h3><br>
<p> , ,   ,       SPI--  (       ,     ),         /    .</p><br>
<p>UEFI        ,    .  ,   ,       !   Linux        ,    . ,    ,     ,       .</p><br>
<h3 id="7-otsutstvie-zaschity-thunderbolt-v-boot-camp">7.   Thunderbolt  Boot Camp</h3><br>
<p>   , Apple     Thunderbolt     I/O MMU. ,       MacBook          I/O MMU,     .    Apple :</p><br>
<blockquote>Some of the hardware security features you outlined are only available when users run macOS. If users are concerned about any of the issues in your paper, we recommend that they use macOS.</blockquote><p>        Thunderbolt,     C Windows    Apple.   MacBook   I/O MMU   BIOS   ,    DMA  Windows   . </p><br>
<p>   Windows    DMA    .</p><br>
<h1 id="thunderspy-vyvody">Thunderspy: </h1><br>
<p>  ,       Thunderbolt  - ,         PCI-Express-.</p><br>
<p>              ,      ,       ,    Â«Â» PCI-Express       PCI Leech.</p><br>
<p>      :   Bitlocker  TrueCrypt           .</p><br>
<h1 id="thunderbolt-4usb4">Thunderbolt 4/USB4</h1><br>
<p>                ,   ,    .<br>
   Intel    Ice Lake    Thunderbolt 3        (     BIOS ,    Intel ME).         I/O MMU      DMA-   Thunderbolt.</p><br>
<p>   USB4 â€“       PCI Express,      .         I/O MMU,     USB4. Microsoft   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  Windows      DMA-</a>     Thunderspy. </p><br>
<h1 id="podvodim-itogi"> </h1><br>
<p>    .            ,   .     (DMA   ),       (I/O MMU).</p><br>
<p>      Â«  ThunderboltÂ»?  ,  .      Thunderspy ,   DisplayPort &amp; USB Only      No Security   Thunderbolt .     (    )       Thunderbolt.<br>
           USB4 â€“  ,     !</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/6d/ts/lv/6dtslv2uikkshhl7tmsi7fgjp0y.png"></a></div><p></p><br>
<p>Raccoon Security â€“     Â«Â»     , , ,       .</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja504864/index.html">å±¥æ­´æ›¸ã‚’æ›¸ã„ã¦é€ä¿¡ã™ã‚‹æ–¹æ³•ã€‚åˆå¿ƒè€…å‘ã‘ã®æ‰‹é †</a></li>
<li><a href="../ja504866/index.html">é‡ç”Ÿã®æƒ…å ±ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®èª¿æŸ»ï¼šäºˆæœŸã—ãªã„æƒ…å ±æº</a></li>
<li><a href="../ja504868/index.html">ãƒ›ãƒ¼ãƒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€‚Ubuntu Server 20.04 LTSã§ã®6ãƒãƒ¼ãƒˆãƒŸãƒ‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a></li>
<li><a href="../ja504878/index.html">ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®109ã®ç„¡æ–™ã‚³ãƒ¼ã‚¹</a></li>
<li><a href="../ja504880/index.html">Unityã§ã®Synthetyã‚²ãƒ¼ãƒ ã®é–‹ç™ºã€æœ€é©åŒ–ã€ãƒªãƒªãƒ¼ã‚¹</a></li>
<li><a href="../ja504886/index.html">é–‹ç™ºè€…ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã®Selenium WebDriver</a></li>
<li><a href="../ja504888/index.html">ã€Œè½ã¡ç€ã„ã¦ã€ãŸã è½ã¡ç€ã„ã¦ï¼ã€ä»¥ä¸‹ã®å¿ƒé…</a></li>
<li><a href="../ja504890/index.html">powershell invoke-commandã‹ã‚‰SQL-Serverã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®æˆ»ã‚Šå€¤</a></li>
<li><a href="../ja504894/index.html">ãƒ­ã‚·ã‚¢èªã®GUIã€ã¾ãŸã¯VKSç«¯æœ«ã§è‡ªåˆ†ã§è¡Œã†</a></li>
<li><a href="../ja504902/index.html">2020å¹´ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆã®ãƒˆãƒƒãƒ—9ãƒˆãƒ¬ãƒ³ãƒ‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>