<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â° ğŸ‘‚ğŸ» ğŸ‘©â€ğŸ‘©â€ğŸ‘§ Kinerja Raspberry Pi: tambahkan ZRAM dan ubah parameter kernel ğŸ‘´ğŸ½ â¡ï¸ ğŸ§—ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beberapa minggu yang lalu, saya menerbitkan ulasan tentang Pinebook Pro . Karena Raspberry Pi 4 juga didasarkan pada ARM, beberapa optimasi yang diseb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kinerja Raspberry Pi: tambahkan ZRAM dan ubah parameter kernel</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504468/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa minggu yang lalu, saya menerbitkan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ulasan tentang Pinebook Pro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Karena Raspberry Pi 4 juga didasarkan pada ARM, beberapa optimasi yang disebutkan dalam artikel sebelumnya cukup cocok untuk itu. </font><font style="vertical-align: inherit;">Saya ingin berbagi trik ini dan mencari tahu apakah Anda memiliki peningkatan kinerja yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menginstal Raspberry Pi di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ruang server rumah</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> saya perhatikan bahwa pada saat kekurangan RAM, itu menjadi sangat tidak responsif dan bahkan digantung. </font><font style="vertical-align: inherit;">Untuk mengatasi masalah ini, saya menambahkan ZRAM dan membuat beberapa perubahan pada parameter kernel.</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivasi ZRAM pada Raspberry Pi</font></font></h1><br>
<img src="https://habrastorage.org/getpro/habr/post_images/032/270/fb0/032270fb0277cc21b3946def04336dfa.png"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZRAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> membuat penyimpanan blok dalam RAM dengan nama / dev / zram0 (atau 1, 2, 3, dll.). </font><font style="vertical-align: inherit;">Halaman yang direkam di sana dikompres dan disimpan dalam memori. </font><font style="vertical-align: inherit;">Ini memungkinkan untuk I / O yang sangat cepat, dan juga membebaskan memori karena kompresi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Raspberry Pi 4 hadir dengan 1, 2, 4, atau 8 GB RAM. </font><font style="vertical-align: inherit;">Saya akan menggunakan model 1 GB, jadi sesuaikan instruksi tergantung pada model Anda. </font><font style="vertical-align: inherit;">Dengan 1 GB ZRAM, file swap default (lambat!) Akan lebih jarang digunakan. </font><font style="vertical-align: inherit;">Saya menggunakan skrip </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zram-swap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk instalasi dan konfigurasi otomatis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instruksi disediakan di repositori di tautan di atas. </font><font style="vertical-align: inherit;">Instalasi:</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/foundObjects/zram-swap.git
<span class="hljs-built_in">cd</span> zram-swap &amp;&amp; sudo ./install.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda ingin mengedit konfigurasi:</font></font><br>
<br>
<pre><code class="bash hljs">vi /etc/default/zram-swap</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, Anda dapat mengaktifkan ZRAM dengan menginstal </font></font><code>zram-tools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda menggunakan metode ini, pastikan untuk mengedit konfigurasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam file </font></font><code>/etc/default/zramswap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan instal sekitar 1 GB ZRAM:</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install zram-tools</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah instalasi, Anda dapat melihat statistik repositori ZRAM dengan perintah berikut:</font></font><br>
<br>
<pre><code class="bash hljs">sudo cat /proc/swaps<font></font>
Filename				Type		Size	Used	Priority<font></font>
/var/swap                               file		102396	0	-2<font></font>
/dev/zram0                              partition	1185368	265472	5<font></font>
pi@raspberrypi:~ $</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan parameter kernel untuk penggunaan ZRAM yang lebih baik</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang perbaiki perilaku sistem ketika Raspberry Pi beralih untuk bertukar pada saat terakhir, yang sering menyebabkan macet. </font><font style="vertical-align: inherit;">Tambahkan beberapa baris ke file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/sysctl.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan reboot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris-baris ini 1) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunda kehabisan memori yang tak terhindarkan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , meningkatkan tekanan pada cache kernel, dan 2) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebelumnya mulai bersiap-siap untuk kehabisan memori</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , memulai swap terlebih dahulu. </font><font style="vertical-align: inherit;">Tetapi itu akan menjadi pertukaran memori terkompresi yang jauh lebih efisien melalui ZRAM! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah baris-baris yang harus ditambahkan di akhir file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/sysctl.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">vm.vfs_cache_pressure=500<font></font>
vm.swappiness=100<font></font>
vm.dirty_background_ratio=1<font></font>
vm.dirty_ratio=50</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kita reboot sistem atau mengaktifkan suntingan dengan perintah berikut:</font></font><br>
<br>
<pre><code class="bash hljs">sudo sysctl --system</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vm.vfs_cache_pressure = 500</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meningkatkan tekanan pada cache, yang meningkatkan kecenderungan kernel untuk merebut kembali memori yang digunakan untuk cache objek direktori dan indeks. Anda akan menggunakan lebih sedikit memori untuk periode waktu yang lebih lama. Penurunan tajam dalam produktivitas dibatalkan oleh pertukaran sebelumnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vm.swappiness = 100</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meningkatkan parameter seberapa agresif kernel akan bertukar halaman memori, karena kami menggunakan ZRAM terlebih dahulu. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vm.dirty_background_ratio = 1 &amp; vm.dirty_ratio = 50</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - proses latar belakang akan mulai merekam segera setelah mencapai batas 1%, tetapi sistem tidak akan memaksakan I / O sinkron hingga mencapai dirty_ratio 50%.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keempat baris ini (ketika digunakan dengan ZRAM) akan membantu meningkatkan kinerja jika Anda </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pasti</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kehabisan RAM dan mulai beralih untuk bertukar, seperti milik saya. Mengetahui fakta ini, serta memperhitungkan kompresi memori akun di ZRAM, tiga kali lebih baik untuk memulai swap ini terlebih dahulu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tekanan pada cache membantu karena kami benar-benar memberi tahu kernel: "Hei, dengar, saya tidak punya memori tambahan untuk digunakan untuk cache, jadi tolong singkirkan secepatnya dan simpan hanya data yang paling sering digunakan / penting."</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan dengan pengurangan caching, jika seiring waktu sebagian besar memori yang dipasang ditempati, kernel akan memulai swap oportunistik jauh lebih awal, sehingga prosesor (kompresi) dan swap I / O tidak akan menarik ke yang terakhir dan menggunakan semua sumber daya sekaligus, ketika sudah terlambat. </font><font style="vertical-align: inherit;">ZRAM menggunakan sedikit CPU untuk kompresi, tetapi pada kebanyakan sistem dengan jumlah memori yang kecil, ini mempengaruhi kinerja jauh lebih sedikit daripada swap tanpa ZRAM.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat hasilnya lagi:</font></font><br>
<br>
<pre><code class="plaintext hljs">pi@raspberrypi:~ $ free -h<font></font>
total used free shared buff/cache available<font></font>
Mem: 926Mi 471Mi 68Mi 168Mi 385Mi 232Mi<font></font>
Swap: 1.2Gi 258Mi 999Mi<font></font>
<font></font>
pi@raspberrypi:~ $ sudo cat /proc/swaps <font></font>
Filename Type Size Used Priority<font></font>
/var/swap file 102396 0 -2<font></font>
/dev/zram0 partition 1185368 264448 5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
264448 di ZRAM hampir satu gigabyte data yang tidak terkompresi. </font><font style="vertical-align: inherit;">Semuanya berjalan ke ZRAM dan tidak ada yang masuk ke file swap yang jauh lebih lambat. </font><font style="vertical-align: inherit;">Coba pengaturan ini sendiri, mereka bekerja pada semua model Raspberry Pi. </font><font style="vertical-align: inherit;">Sistem pembekuan saya yang tidak sesuai telah berubah menjadi sistem yang bisa diterapkan dan stabil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam waktu dekat, saya berharap untuk melanjutkan dan memperbarui artikel ini dengan beberapa hasil pengujian sistem sebelum dan sesudah menginstal ZRAM. </font><font style="vertical-align: inherit;">Sekarang saya tidak punya waktu untuk ini. </font><font style="vertical-align: inherit;">Sementara itu, jangan ragu untuk menjalankan tes Anda sendiri dan beri tahu kami di komentar. </font><font style="vertical-align: inherit;">Raspberry Pi 4 hanyalah binatang buas dengan pengaturan seperti itu. </font><font style="vertical-align: inherit;">Bersenang senang lah!</font></font><br>
<br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada topik ini:</font></font></b><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kinerja Linux: mengapa Anda hampir selalu perlu menambah ruang swap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2017)</font></font><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kinerja Linux: hampir selalu meningkatkan ruang swap. </font><font style="vertical-align: inherit;">Bagian 2: ZRAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2020)</font></font></li>
</ul></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id504454/index.html">Repositori GitHub terbaik untuk pengembang web</a></li>
<li><a href="../id504456/index.html">Pisahkan lingkungan pengembangan dengan wadah LXD</a></li>
<li><a href="../id504458/index.html">Menginstal OpenCV-Python di lingkungan virtual untuk ketel-super</a></li>
<li><a href="../id504460/index.html">Tentang Buku Periklanan David Ogilvy Ogilvy</a></li>
<li><a href="../id504464/index.html">Bagaimana kami menemukan TableAdapter dan menyederhanakan pekerjaan dengan UITableView</a></li>
<li><a href="../id504472/index.html">Alat Pengembang Gratis Teratas Saya</a></li>
<li><a href="../id504480/index.html">Bagaimana cara menemukan seorang pemasar yang akan menguntungkan untuk bekerja?</a></li>
<li><a href="../id504482/index.html">Tanyakan kepada kami: DIT akan menjawab pertanyaan</a></li>
<li><a href="../id504484/index.html">IPSec Mahakuasa</a></li>
<li><a href="../id504486/index.html">Proses: Membuat Vue 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>