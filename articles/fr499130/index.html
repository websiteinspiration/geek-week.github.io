<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíé üë®üèº‚Äçü§ù‚Äçüë®üèª üç© BlockAdBlock Advertising Anti-Blocking Reverse Engineering üë©üèΩ‚Äçü§ù‚Äçüë©üèª üíÉüèª ü§∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous utilisez des bloqueurs de publicit√©s, vous pourriez rencontrer BlockAdBlock . Ce script d√©tecte votre bloqueur et ne l'autorise pas sur le sit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BlockAdBlock Advertising Anti-Blocking Reverse Engineering</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499130/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous utilisez des bloqueurs de publicit√©s, vous pourriez rencontrer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce script d√©tecte votre bloqueur et ne l'autorise pas sur le site tant que vous ne le d√©sactivez pas. </font><font style="vertical-align: inherit;">Mais je me demandais comment √ßa fonctionnait. </font><font style="vertical-align: inherit;">Comment l'anti-bloquant d√©tecte-t-il les bloqueurs? </font><font style="vertical-align: inherit;">Et comment les bloqueurs r√©agissent-ils √† cela et comment bloquent-ils les anti-bloquants?</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Histoire de l'ing√©nierie inverse</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re chose que j'ai faite a √©t√© de regarder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leur site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">BlockAdBlock propose un configurateur avec des param√®tres: l'intervalle d'attente et l'apparence de l'avertissement, g√©n√©rant diff√©rentes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versions du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela m'a fait penser aux versions. </font><font style="vertical-align: inherit;">Et s'il ne pouvait pas voir une seule version, et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d'un coup? </font><font style="vertical-align: inherit;">Alors je l'ai fait. </font><font style="vertical-align: inherit;">Je suis remont√© dans le temps en utilisant la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wayback Machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Apr√®s cela, j'ai t√©l√©charg√© toutes les versions de BlockAdBlock et les ai hach√©es.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste de toutes les versions de BlockAdBlock, avec sha1sum</font></font></h4><br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6d5eafab2ca816ccd049ad8f796358c0a7a43cf3 20151007203811.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
065b4aa813b219abbce76ad20a3216b3481b11bb 20151113115955.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d5dec97a775b2e563f3e4359e4f8f1c3645ba0e5 20160121132336.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160318193101.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160319042810.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160331051645.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160406061855.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8add06cbb79bc25114bd7a2083067ceea9fbb354 20160408025028.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
555637904dc9e4bfc6f08bdcae92f0ba0f443ebf 20160415083215.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20161120215354.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170525201720.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170606090847.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170703211338.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170707211652.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170813090718.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20170915094808.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171005180631.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171019162109.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171109101135.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171127113945.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171211042454.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20171227031408.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180202000800.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180412213253.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180419060636.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180530223228.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20180815042610.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181029233809.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181122190948.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20181122205748.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190324081812.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190420155244.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190424200651.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20190903121933.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d8986247cad3bbc2dd92c3a2a06ac1540da6b286 20200112084838.js</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seules </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">six</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versions diff√®rent les unes des autres, et la derni√®re d'entre elles se r√©f√®re √† 2016, bien que certains sites utilisent toujours BlockAdBlock. </font><font style="vertical-align: inherit;">C'est g√©nial, car il nous suffira de r√©troconcevoir la seule version, puis d'inverser les diff√©rences. </font><font style="vertical-align: inherit;">Spoiler: nous verrons le d√©veloppement d'id√©es et m√™me les restes de code de d√©bogage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">post√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toutes les versions </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sur GitHub</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous voulez regarder les diff√©rences, alors dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce d√©p√¥t</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chaque commit est une nouvelle version.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©ballage</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code du script n'est pas minifi√©, mais emball√© par un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JS-packer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Dean Edwards avec des changements cosm√©tiques et sans aucune modification de la logique </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup></a><a name="1_1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">eval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p, a, c, k, e, d</span>) </span>{<font></font>
    e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>{
        <span class="hljs-keyword">return</span> (c &lt; a ? <span class="hljs-string">''</span> : e(<span class="hljs-built_in">parseInt</span>(c / a))) + ((c = c % a) &gt; <span class="hljs-number">35</span> ? <span class="hljs-built_in">String</span>.fromCharCode(c + <span class="hljs-number">29</span>) : c.toString(<span class="hljs-number">36</span>))<font></font>
    };<font></font>
    <span class="hljs-keyword">if</span> (!<span class="hljs-string">''</span>.replace(<span class="hljs-regexp">/^/</span>, <span class="hljs-built_in">String</span>)) {
        <span class="hljs-keyword">while</span> (c--) {<font></font>
            d[e(c)] = k[c] || e(c)<font></font>
        }<font></font>
        k = [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">return</span> d[e]<font></font>
        }];<font></font>
        e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-string">'\\w+'</span><font></font>
        };<font></font>
        c = <span class="hljs-number">1</span><font></font>
    };<font></font>
    <span class="hljs-keyword">while</span> (c--) {
        <span class="hljs-keyword">if</span> (k[c]) {<font></font>
            p = p.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'\\b'</span> + e(c) + <span class="hljs-string">'\\b'</span>, <span class="hljs-string">'g'</span>), k[c])<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> p<font></font>
}(<span class="hljs-string">'0.1("2 3 4 5 6 7 8\'d. 9, h? a b c d e f g");i j=\'a\'+\'k\'+\'e\'+\'l\'+\'n\'+\'m\'+\'e\';'</span>,<span class="hljs-number">24</span>,<span class="hljs-number">24</span>,
<span class="hljs-string">'console|log|This|code|will|get|unpacked|then|eval|Cool||||||||huh|let|you|w|s||o'</span>.split(<span class="hljs-string">'|'</span>),<span class="hljs-number">0</span>,{}))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, ce n'est pas un probl√®me pour nous. </font><font style="vertical-align: inherit;">La faiblesse du packer est que tout le code lors du d√©ballage est transmis √† </font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si nous rempla√ßons </font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par quelque chose comme </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors nous obtenons soudainement tout le code source, et le packer est vaincu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup></a><a name="2_2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir fait cela pour chaque version, nous pouvons examiner chacune d'entre elles et voir quelles fonctions y ont √©t√© ajout√©es au fil du temps.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1 :? </font><font style="vertical-align: inherit;">- novembre 2015: sc√©nario initial</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code source</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Commen√ßons par une √©tude </font></font><code>20151007203811.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publi√©e vers novembre 2015 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup></a><a name="3_3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bien que cette premi√®re version ne bloque pas tr√®s bien les bloqueurs, elle vous permet d'√©valuer l'architecture BlockAdBlock sans les ordures qui se sont accumul√©es au fil des ans.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En trois phrases:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock est une fermeture qui renvoie un objet avec trois fonctions:</font></font><br>
<ul>
<li><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©tablit l'app√¢t et appelle un ch√®que </font></font><code>check</code> <br>
</li>
<li><code>check()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√©rifie si le bloqueur a bloqu√© l'app√¢t, provoquant </font></font><code>arm</code><br>
</li>
<li><code>arm()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recouvrir</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le point d'entr√©e </font></font><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©marre ensuite apr√®s un laps de temps sp√©cifi√©.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trois fonctions sont g√©n√©r√©es avec des arguments d√©finis dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le configurateur BlockAdBlock</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code est construit autour d'une fermeture affect√©e √† un objet global avec un nom al√©atoire.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> randomID = <span class="hljs-string">''</span>,<font></font>
    e = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) randomID += <font></font>
    e.charAt(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * e.length));
<span class="hljs-keyword">var</span> setTimeoutDelay = <span class="hljs-number">7</span>; <span class="hljs-comment">// Delay after which to call BlockAdBlock</span>
<span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>] = ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'auteur a pr√©vu une randomisation approfondie pour √©viter le blocage statique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puis retourne un objet avec trois fonctions: </font></font><code>bab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>] = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> eid = ...<font></font>
    return {<font></font>
        <span class="hljs-attr">bab</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">check, passed_eid</span>) </span>{},
        <span class="hljs-attr">check</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{},
        <span class="hljs-attr">arm</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}<font></font>
    }<font></font>
})();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sont mes propres noms. </font><font style="vertical-align: inherit;">Toutes les variables sont minifi√©es et certaines sont sp√©cialement obscurcies. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le point d'entr√©e est </font></font><code>bab()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appel√© </font></font><code>setTimeout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">setTimeout(<span class="hljs-string">'window[\'\' + randomID + \'\'] \
.bab(window[\'\' + randomID + \'\'].check, \
     window[\'\' + randomID + \'\'].bab_elementid)'</span>, setTimeoutDelay * <span class="hljs-number">1000</span>)</code></pre><br>
<code>bab_elementid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">non utilis√© dans aucune version du code. </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass√© sous forme de cha√Æne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fermeture a des variables externes. </font><font style="vertical-align: inherit;">Deux d'entre eux sont utilis√©s pour enregistrer l'√©tat dans un script:</font></font><br>
<br>
<ul>
<li><code>adblockDetected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©gal √† 1 si un bloqueur de publicit√©s est d√©tect√©.</font></font><br>
</li>
<li><code>nagMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Il s'agit d'une option de configuration. </font><font style="vertical-align: inherit;">S'il est install√©, le script ne bloque pas l'acc√®s √† la page, mais ne vous active qu'une seule fois.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'autres variables pour contr√¥ler l'apparence et le comportement sont d√©finies dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configurateur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> eid = <span class="hljs-string">' ad_box'</span>, <span class="hljs-comment">// Name of the bait.</span>
    __u1 = <span class="hljs-number">1</span>, <span class="hljs-comment">// Unused.</span><font></font>
<font></font>
    <span class="hljs-comment">// Colors for the blockadblock prompt.</span>
    overlayColor = <span class="hljs-string">'#EEEEEE'</span>,<font></font>
    textColor = <span class="hljs-string">'#777777'</span>,<font></font>
    buttonBackgroundColor = <span class="hljs-string">'#adb8ff'</span>,<font></font>
    buttonColor = <span class="hljs-string">'#FFFFFF'</span>,<font></font>
<font></font>
    __u2 = <span class="hljs-string">''</span>, <span class="hljs-comment">// Unused.</span><font></font>
<font></font>
    <span class="hljs-comment">// Text to display when the blockadblock prompt is shown.</span>
    welcomeText = <span class="hljs-string">'Sorry for the interruption...'</span>,<font></font>
    primaryText = <span class="hljs-string">'It looks like you\'re using an ad blocker. That\'s okay.  Who doesn\'t?'</span>,<font></font>
    subtextText = <span class="hljs-string">'But without advertising-income, we can\'t keep making this site awesome.'</span>,<font></font>
    buttonText = <span class="hljs-string">'I understand, I have disabled my ad blocker.  Let me in!'</span>,<font></font>
<font></font>
    <span class="hljs-comment">// If 1, adblock was detected.</span>
    adblockDetected = <span class="hljs-number">0</span>,
    <span class="hljs-comment">// If 1, BlockAdBlock will only nag the visitor once, rather than block access.</span>
    nagMode = <span class="hljs-number">0</span>,<font></font>
<font></font>
    <span class="hljs-comment">// The blockadblock domain, reversed.</span>
    bab_domain = <span class="hljs-string">'moc.kcolbdakcolb'</span>;</code></pre><br>
<code>bab_domain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©fini ici pour tenter de brouiller le domaine BlockAdBlock.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bab: cr√©er une banni√®re leurre</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principale m√©thode de travail avec BlockAdBlock consiste √† cr√©er des ¬´app√¢ts¬ª ou des ¬´app√¢ts¬ª √† partir d'√©l√©ments publicitaires qui ressemblent √† de vraies banni√®res. </font><font style="vertical-align: inherit;">Il v√©rifie ensuite si leur bloqueur s'est bloqu√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela cr√©e un leurre: un faux div qui pr√©tend √™tre une annonce mais est cach√© √† la vue.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">check, passed_eid</span>) </span>{
    <span class="hljs-comment">// Wait for the document to be ready.</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.body == <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">return</span><font></font>
    };<font></font>
<font></font>
    <span class="hljs-keyword">var</span> delay = <span class="hljs-string">'0.1'</span>, <font></font>
        passed_eid = eid ? eid : <span class="hljs-string">'banner_ad'</span>,<font></font>
        bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
        <font></font>
    bait.id = passed_eid;<font></font>
    bait.style.position = <span class="hljs-string">'absolute'</span>;<font></font>
    bait.style.left = <span class="hljs-string">'-999px'</span>;<font></font>
    bait.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">' '</span>));
    <span class="hljs-built_in">document</span>.body.appendChild(bait);<font></font>
    ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apparemment, il est </font></font><code>passed_eid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destin√© √† configurer l'identifiant de l'app√¢t, mais il n'est pas utilis√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, il est v√©rifi√© si l'app√¢t a √©t√© supprim√© par le bloc d'annonces.</font></font><br>
<br>
<pre><code class="javascript hljs">    ...<font></font>
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (bait) {<font></font>
            check((bait.clientHeight == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.clientWidth == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.display == <span class="hljs-string">'hidden'</span>), delay);<font></font>
            check((bait.visibility == <span class="hljs-string">'none'</span>), delay);<font></font>
            check((bait.opacity == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.left &lt; <span class="hljs-number">1000</span>), delay);<font></font>
            check((bait.top &lt; <span class="hljs-number">1000</span>), delay)<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            check(<span class="hljs-literal">true</span>, delay)<font></font>
        }<font></font>
    }, <span class="hljs-number">125</span>)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'app√¢t n'existe plus, l'√©l√©ment est supprim√© (et nous commen√ßons la superposition). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionnera si elle </font></font><code>Predicate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retourne une valeur </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et d√©marre </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs">check: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{
    <span class="hljs-keyword">if</span> ((checkPredicate) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {<font></font>
        adblockDetected = <span class="hljs-number">1</span>;
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
    } <span class="hljs-keyword">else</span> {}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le test est </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©clench√© plusieurs fois, comme indiqu√© ci-dessus, il est </font></font><code>adblockDetected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©gl√© sur le premier test correct afin d'√©viter des d√©clenchements r√©p√©t√©s </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode grognement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script a une fonction appel√©e ¬´mode nag¬ª: dans ce mode, BlockAdBlock ne dira qu'une seule fois pour d√©sactiver le bloqueur de publicit√©s, mais ne vous bloquera pas √† chaque fois que vous visiterez. </font><font style="vertical-align: inherit;">Cela se fait en d√©finissant l'√©l√©ment </font></font><code>localStorage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de la premi√®re visite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous pouvions installer cet √©l√©ment nous-m√™mes, pourrions-nous d√©sactiver le verrouillage pour toujours? </font><font style="vertical-align: inherit;">Malheureusement, BlockAdBlock v√©rifie √† l'avance si le script a √©t√© configur√© pour le mode nag, donc cette m√©thode ne fonctionnera pas lorsqu'elle fonctionne en mode par d√©faut, c'est-√†-dire avec un verrouillage d'acc√®s.</font></font><br>
<br>
<pre><code class="javascript hljs">arm: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (nagMode == <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">var</span> babNag = sessionStorage.getItem(<span class="hljs-string">'babn'</span>);
        <span class="hljs-keyword">if</span> (babNag &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// Stop the script.</span>
        } <span class="hljs-keyword">else</span> {<font></font>
            sessionStorage.setItem(<span class="hljs-string">'babn'</span>, (<span class="hljs-built_in">Math</span>.random() + <span class="hljs-number">1</span>) * <span class="hljs-number">1000</span>)<font></font>
        }<font></font>
    };<font></font>
    ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, il est </font></font><code>nagMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install√© dans le configurateur, et par d√©faut, il est √©gal </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock version 1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bloqueurs de publicit√©s utilisent des filtres dits: des lignes de code qui peuvent bloquer les demandes du r√©seau et masquer des √©l√©ments sur la page. En cr√©ant des √©l√©ments d'app√¢t, BlockAdBlock lance sp√©cifiquement ces filtres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette d√©fense simple, BlockAdBlock est efficace contre tous les principaux bloqueurs de publicit√©s tels que uBlock Origin, AdBlock Plus et Ghostery. Pour contrer cela, nous devons √©crire notre propre filtre, qui n'est activ√© que sur les sites qui ex√©cutent BlockAdBlock. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcrire des filtres pour un bloqueur est un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peu compliqu√©. Nous avons besoin d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un filtre de contenu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui bloque les √©l√©ments de la page g√©n√©r√©s apr√®s le chargement. Puisque l'app√¢t a un identifiant </font></font><code>banner_ad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous cr√©ons une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exception pour masquer les √©l√©ments</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marqu√© </font></font><code>#@#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour tous les √©l√©ments </font></font><code>#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un identifiant </font></font><code>banner_ad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le mettre dans la liste des filtres utilisateur de notre bloqueur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©sultat est le suivant:</font></font><br>
<br>
<pre><code class="javascript hljs">localhost#@# #banner_ad</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai localhost ici pour d√©monstration, vous pouvez le remplacer par votre URL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela d√©sactive avec succ√®s BlockAdBlock. </font><font style="vertical-align: inherit;">La solution peut sembler simple, mais elle fonctionne depuis longtemps avec succ√®s dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la liste de filtres Anti-AdBlock-Killer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 2 (novembre 2015 - janvier 2016): plusieurs am√©liorations</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diff√©rence de </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">code source </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1 / v2</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'app√¢ts: moins de bugs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une erreur subtile dans la premi√®re version de la cr√©ation de l'app√¢t: le div cr√©√© n'a pas de contenu, donc un div est g√©n√©r√© avec une hauteur de 0 et une largeur de 0. Plus tard, le code v√©rifie si le div est supprim√© en v√©rifiant sa hauteur et sa largeur. </font><font style="vertical-align: inherit;">Mais comme sa hauteur √©tait nulle, BlockAdBlock fonctionnait toujours </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup></a><a name="4_4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'erreur d'une div vide est corrig√©e.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...</span>) </span>{<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
    ...<font></font>
    bait.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-string">'√Ç '</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un div enfant est cr√©√© avec du contenu.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©tection de bloqueurs √† travers de fausses banni√®res graphiques</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette m√©thode, nous cr√©ons une fausse image avec un nom al√©atoire </font></font><code>doubleclick.net</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Les bloqueurs de publicit√©s bloqueront l'image, pensant qu'il s'agit d'une banni√®re publicitaire. </font><font style="vertical-align: inherit;">Mais cela ne n√©cessite aucune modification de notre filtre.</font></font><br>
<br>
<pre><code class="javascript hljs">bab: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...</span>) </span>{<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);<font></font>
    bait.innerHTML = <span class="hljs-string">'&lt;img src="http://doubleclick.net/'</span> + randomStr() + <span class="hljs-string">'.jpg"&gt;'</span>;<font></font>
    ...</code></pre><br>
<code>randomStr()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g√©n√®re une cha√Æne de longueur arbitraire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre diff√©rence notable √©tait l'utilisation d'une minuterie </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au lieu d'une simple v√©rification unique pour voir si un d√©clencheur est install√©. </font><font style="vertical-align: inherit;">Il rev√©rifie si la banni√®re graphique est affich√©e et si son attribut n'est pas modifi√© </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, v√©rifiant le contenu de l'app√¢t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nouveau </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et v√©rifiez la disponibilit√© des images:</font></font><br>
<br>
<pre><code class="javascript hljs">    ...<font></font>
    checkCallback = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (bait) {<font></font>
            check((bait.clientHeight == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.clientWidth == <span class="hljs-number">0</span>), delay);<font></font>
            check((bait.display == <span class="hljs-string">'hidden'</span>), delay);<font></font>
            check((bait.visibility == <span class="hljs-string">'none'</span>), delay);<font></font>
            check((bait.opacity == <span class="hljs-number">0</span>), delay);
            <span class="hljs-keyword">try</span> {<font></font>
                check((<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'banner_ad'</span>).innerHTML.indexOf(<span class="hljs-string">'click'</span>) == <span class="hljs-number">-1</span>), delay)<font></font>
            } <span class="hljs-keyword">catch</span> (e) {}<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            check(<span class="hljs-literal">true</span>, delay)<font></font>
        }<font></font>
    }, <span class="hljs-number">1000</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi </font></font><code>indexof ('click')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Parce que la source de l'image </font></font><code>src="doubleclick.net/abcdefg.jpg"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et nous v√©rifions si le fragment de la cha√Æne est conserv√© </font></font><code>click</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 3 (novembre 2015 - mars 2016): app√¢t g√©n√©ralis√©</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diff√©rence de </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">code source </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v2 / v3</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'app√¢ts: identificateurs al√©atoires</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le seul changement dans cette version, bien que significatif, est l'apparition d'identificateurs al√©atoires pour l'app√¢t. </font><font style="vertical-align: inherit;">Le nouvel identifiant est extrait de la liste des identifiants lors du chargement de la page et est utilis√© pour l'app√¢t, qui est maintenant plac√© au milieu de la page. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une longue liste d'identifiants al√©atoires d√©montre une bonne connaissance du sujet.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> baitIDs = [
  <span class="hljs-string">"ad-left"</span>,
  <span class="hljs-string">"adBannerWrap"</span>,
  <span class="hljs-string">"ad-frame"</span>,
  <span class="hljs-string">"ad-header"</span>,
  <span class="hljs-string">"ad-img"</span>,
  <span class="hljs-string">"ad-inner"</span>,
  <span class="hljs-string">"ad-label"</span>,
  <span class="hljs-string">"ad-lb"</span>,
  <span class="hljs-string">"ad-footer"</span>,
  <span class="hljs-string">"ad-container"</span>,
  <span class="hljs-string">"ad-container-1"</span>,
  <span class="hljs-string">"ad-container-2"</span>,
  <span class="hljs-string">"Ad300x145"</span>,
  <span class="hljs-string">"Ad300x250"</span>,
  <span class="hljs-string">"Ad728x90"</span>,
  <span class="hljs-string">"AdArea"</span>,
  <span class="hljs-string">"AdFrame1"</span>,
  <span class="hljs-string">"AdFrame2"</span>,
  <span class="hljs-string">"AdFrame3"</span>,
  <span class="hljs-string">"AdFrame4"</span>,
  <span class="hljs-string">"AdLayer1"</span>,
  <span class="hljs-string">"AdLayer2"</span>,
  <span class="hljs-string">"Ads_google_01"</span>,
  <span class="hljs-string">"Ads_google_02"</span>,
  <span class="hljs-string">"Ads_google_03"</span>,
  <span class="hljs-string">"Ads_google_04"</span>,
  <span class="hljs-string">"DivAd"</span>,
  <span class="hljs-string">"DivAd1"</span>,
  <span class="hljs-string">"DivAd2"</span>,
  <span class="hljs-string">"DivAd3"</span>,
  <span class="hljs-string">"DivAdA"</span>,
  <span class="hljs-string">"DivAdB"</span>,
  <span class="hljs-string">"DivAdC"</span>,
  <span class="hljs-string">"AdImage"</span>,
  <span class="hljs-string">"AdDiv"</span>,
  <span class="hljs-string">"AdBox160"</span>,
  <span class="hljs-string">"AdContainer"</span>,
  <span class="hljs-string">"glinkswrapper"</span>,
  <span class="hljs-string">"adTeaser"</span>,
  <span class="hljs-string">"banner_ad"</span>,
  <span class="hljs-string">"adBanner"</span>,
  <span class="hljs-string">"adbanner"</span>,
  <span class="hljs-string">"adAd"</span>,
  <span class="hljs-string">"bannerad"</span>,
  <span class="hljs-string">" ad_box"</span>,
  <span class="hljs-string">" ad_channel"</span>,
  <span class="hljs-string">" adserver"</span>,
  <span class="hljs-string">" bannerid"</span>,
  <span class="hljs-string">"adslot"</span>,
  <span class="hljs-string">"popupad"</span>,
  <span class="hljs-string">"adsense"</span>,
  <span class="hljs-string">"google_ad"</span>,
  <span class="hljs-string">"outbrain-paid"</span>,
  <span class="hljs-string">"sponsored_link"</span>
];</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©ration d'ID al√©atoire</font></font></h4><br>
<pre><code class="javascript hljs">    randomBaitID = baitIDs[ <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * baitIDs.length) ],<font></font>
    ...<font></font>
    var passed_eid = randomBaitID;<font></font>
    bait = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'DIV'</span>);    <font></font>
    bait.id = passed_eid;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme cela fonctionne √† chaque d√©marrage, l'identifiant sera diff√©rent √† chaque fois.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlockAdBlock, troisi√®me √† derni√®re version</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BlockAdBlock exploite l'angle mort des bloqueurs de publicit√©s: si un filtre ignore tous les identifiants ci-dessus, il ignorera √©galement les vraies publicit√©s. Ainsi, BlockAdBlock </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">force le bloqueur de publicit√©s √† se rendre inutile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les bloqueurs, nous pouvons ex√©cuter des scripts arbitraires avant de charger la page. Vous pouvez essayer de supprimer l'objet BlockAdBlock √† l'avance. Mais pour cela, nous avons besoin du nom de l'objet BlockAdBlock, qui est randomis√© √† chaque d√©marrage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
uBlock Origin a adopt√© une approche diff√©rente. Puisque le code est ex√©cut√© par une fonction </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous pouvons d√©finir notre propre fonction </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui bloquera l'ex√©cution si nous trouvons BlockAdBlock. Dans JS, un objet est capable de cela </font></font><code>Proxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: vous pouvez remplacer n'importe quelle propri√©t√© et m√©thode dans n'importe quel objet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela peut √™tre contourn√© en ne passant pas la charge utile BlockAdBlock initiale </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais en l'utilisant directement, nous utilisons donc √©galement le proxy comme point d'entr√©e: l'appel </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Puisqu'il est </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass√© par une cha√Æne, pas une fonction, nous v√©rifions cette cha√Æne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Impl√©mentation dans uBlock Origin ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> signatures = [<font></font>
    [ <span class="hljs-string">'blockadblock'</span> ],<font></font>
    [ <span class="hljs-string">'babasbm'</span> ],<font></font>
    [ <span class="hljs-regexp">/getItem\('babn'\)/</span> ],<font></font>
    [<font></font>
        <span class="hljs-string">'getElementById'</span>,
        <span class="hljs-string">'String.fromCharCode'</span>,
        <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>,
        <span class="hljs-string">'charAt'</span>,
        <span class="hljs-string">'DOMContentLoaded'</span>,
        <span class="hljs-string">'AdBlock'</span>,
        <span class="hljs-string">'addEventListener'</span>,
        <span class="hljs-string">'doScroll'</span>,
        <span class="hljs-string">'fromCharCode'</span>,
        <span class="hljs-string">'&lt;&lt;2|r&gt;&gt;4'</span>,
        <span class="hljs-string">'sessionStorage'</span>,
        <span class="hljs-string">'clientWidth'</span>,
        <span class="hljs-string">'localStorage'</span>,
        <span class="hljs-string">'Math'</span>,
        <span class="hljs-string">'random'</span><font></font>
    ],<font></font>
];<font></font>
<span class="hljs-keyword">const</span> check = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) </span>{
    <span class="hljs-comment">// check for signature </span>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liste des signatures: d√©finition des mod√®les de code. </font><font style="vertical-align: inherit;">La fonction </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√©rifie la cha√Æne apr√®s </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour la conformit√© avec ces mod√®les. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy les</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctions </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>.eval = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-built_in">window</span>.eval, {
    <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisArg, args</span>) </span>{
        <span class="hljs-keyword">const</span> a = args[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> a !== <span class="hljs-string">'string'</span> || !check(a) ) {
            <span class="hljs-keyword">return</span> target.apply(thisArg, args);<font></font>
        } <font></font>
        <span class="hljs-comment">// BAB detected: clean up.</span>
        <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">document</span>.body ) {
            <span class="hljs-built_in">document</span>.body.style.removeProperty(<span class="hljs-string">'visibility'</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">let</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'babasbmsgx'</span>);
        <span class="hljs-keyword">if</span> ( el ) {<font></font>
            el.parentNode.removeChild(el);<font></font>
        }<font></font>
    }<font></font>
});<font></font>
<span class="hljs-built_in">window</span>.setTimeout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-built_in">window</span>.setTimeout, {
    <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisArg, args</span>) </span>{
        <span class="hljs-keyword">const</span> a = args[<span class="hljs-number">0</span>];
        <span class="hljs-comment">// Check that the passed string is not the BAB entrypoint.</span>
        <span class="hljs-keyword">if</span> (
            <span class="hljs-keyword">typeof</span> a !== <span class="hljs-string">'string'</span> ||
            <span class="hljs-regexp">/\.bab_elementid.$/</span>.test(a) === <span class="hljs-literal">false</span><font></font>
        ) {<font></font>
            <span class="hljs-keyword">return</span> target.apply(thisArg, args);<font></font>
        }<font></font>
    }<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque nous utilisons maintenant un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scriptlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un fragment de code personnalis√© sp√©cial ex√©cut√© par le bloqueur, le filtre change un peu:</font></font><br>
<br>
<pre><code class="javascript hljs">localhost## +js(nobab)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne d√©marre pas par d√©faut sur tous les sites pour des raisons de performances, vous devez donc l'attribuer √† chaque site √† l'aide d'un script.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 4 (janvier 2016 - avril 2016): fonctions exp√©rimentales</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diff√©rence de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">code source </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">v3 / v4</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La m√©thode d√©crite pour bloquer les anti-bloquants a √©t√© d√©velopp√©e en janvier 2016, selon l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">histoire des commits d'uBlock Origin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et n'a pas chang√© conceptuellement depuis sa cr√©ation. </font><font style="vertical-align: inherit;">BlockAdBlock n'a jamais essay√© de contourner ce filtre en modifiant son architecture. </font><font style="vertical-align: inherit;">Au lieu de cela, il a continu√© √† d√©velopper de nouvelles fonctionnalit√©s. </font><font style="vertical-align: inherit;">Et quand nous allons √† la page BlockAdBlock, nous voyons un onglet int√©ressant: "Avez-vous besoin de plus de puissance anti-blocage?" </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/0m/ea/rs0meawjau7ljt0-m6viiwoo4cq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que ces m√©thodes de protection ne soient disponibles que via un onglet sp√©cial, elles sont incluses dans tous les scripts et sont ex√©cut√©es via des variables portant les noms correspondants. </font><font style="vertical-align: inherit;">La quatri√®me version impl√©mente deux m√©thodes:</font></font><br>
<br>
<ul>
<li><code>aDefOne</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ¬´Protection sp√©cifique pour les sites AdSense¬ª</font></font><br>
</li>
<li><code>aDefTwo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ¬´Fonction sp√©ciale de s√©curit√©¬ª</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaires de d√©bogage al√©atoire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de vous dire au revoir, je dois mentionner encore une chose. </font><font style="vertical-align: inherit;">Dans le processus de reverse engineering, une fonction a retenu mon attention: le </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d√©bogage </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directement dans le code!</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consolelog</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-comment">// "Dev mode" check: developpers of BAB must set window.consolelog to 1.</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.consolelog == <span class="hljs-number">1</span>) {
        <span class="hljs-built_in">console</span>.log(e)<font></font>
    }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela n'est possible que si global </font></font><code>consolelog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple, est d√©fini </font></font><code>window.consolelog = 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les commentaires de d√©bogage ne sont disponibles que dans cette version. </font><font style="vertical-align: inherit;">Si je n'avais pas invers√© toutes les versions, je ne les aurais jamais remarqu√©es. </font><font style="vertical-align: inherit;">Ils fournissent des informations pr√©cieuses sur le fonctionnement du code.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© avanc√©e: AdSense</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes ces m√©thodes de protection sp√©ciales sont encod√©es dans </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et non dans </font></font><code>arm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, comme le sugg√®re l'architecture. </font><font style="vertical-align: inherit;">Peut-√™tre qu'un nouveau d√©veloppeur qui ne conna√Æt pas la base de code a commenc√© √† travailler sur le produit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si AdSense est actif sur la page, nous v√©rifions les annonces. </font><font style="vertical-align: inherit;">S'ils ont disparu √† cause d'un bloqueur, BlockAdBlock est activ√©.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"></span>) </span>{<font></font>
    ...<font></font>
    var q = <span class="hljs-string">'ins.adsbygoogle'</span>,
        <span class="hljs-comment">// Selects all Google ads in the document.</span>
        adsbygoogleQuery = <span class="hljs-built_in">document</span>.querySelector(q);<font></font>
<font></font>
    <span class="hljs-keyword">if</span> ((adsbygoogleQuery) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
        <span class="hljs-comment">// Ads are not blocked, since the bait ad is still there,</span>
        <span class="hljs-comment">// and adblockDetected hasn't been set</span>
        <span class="hljs-keyword">if</span> (aDefOne == <span class="hljs-string">'yes'</span>) {<font></font>
            consolelog(<span class="hljs-string">'case2: standard bait says ads are NOT blocked.'</span>);
            <span class="hljs-keyword">var</span> adsbygoogle = <span class="hljs-string">'//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'</span>;
            <span class="hljs-keyword">if</span> (scriptExists(adsbygoogle)) {<font></font>
                consolelog(<span class="hljs-string">'case2: And Adsense pre-exists.'</span>);
                <span class="hljs-keyword">if</span> (adsbygoogleQuery.innerHTML.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">''</span>).length == <span class="hljs-number">0</span>) {
                    <span class="hljs-comment">// The ad's content was cleared, so...</span>
                    consolelog(<span class="hljs-string">'case2: Ads are blocked.'</span>);
                    <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
                }<font></font>
            }<font></font>
        };<font></font>
        adblockDetected = <span class="hljs-number">1</span><font></font>
    }<font></font>
    ...</code></pre><br>
<code>scriptExists</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√©rifie la totalit√© de la page pour un script avec une URL donn√©e. </font><font style="vertical-align: inherit;">Dans ce cas, le script AdSense </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></sup></a><a name="5_5"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'URL du script est compar√©e √† tous les scripts de la page. </font><font style="vertical-align: inherit;">Pour une raison quelconque, l'URL est tronqu√©e √† 15 caract√®res.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scriptExists</span>(<span class="hljs-params">href</span>) </span>{
    <span class="hljs-keyword">if</span> (href) href = href.substr(href.length - <span class="hljs-number">15</span>);
    <span class="hljs-keyword">var</span> scripts = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'script'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = scripts.length; i--;) {
        <span class="hljs-keyword">var</span> src = <span class="hljs-built_in">String</span>(scripts[i].src);
        <span class="hljs-keyword">if</span> (src) src = src.substr(src.length - <span class="hljs-number">15</span>);
        <span class="hljs-keyword">if</span> (src === href) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
    };<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
};</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection avanc√©e: √©l√©ment sp√©cial</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement √† la premi√®re, cette m√©thode est accompagn√©e d'une clause de non-responsabilit√©: "Veuillez tester apr√®s l'installation pour garantir la compatibilit√© avec votre site." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette protection sp√©ciale ne fonctionne que si aucun bloqueur n'est trouv√© et qu'il n'y a pas de script AdSense sur la page. </font><font style="vertical-align: inherit;">Voici l'extrait de code correspondant </font></font><code>check</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs">check: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">checkPredicate, unused</span>) </span>{
    <span class="hljs-keyword">if</span> ((checkPredicate) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
        <span class="hljs-comment">// Adblocker detected, arm</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> q = <span class="hljs-string">'ins.adsbygoogle'</span>,<font></font>
            adsbygoogleQuery = <span class="hljs-built_in">document</span>.querySelector(q);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> ((adsbygoogleQuery) &amp;&amp; (adblockDetected == <span class="hljs-number">0</span>)) {
            <span class="hljs-keyword">if</span> (aDefOne == <span class="hljs-string">'yes'</span>) {
                <span class="hljs-comment">// Special defense one: AdSense defense (see above)</span><font></font>
            };<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (adblockDetected == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
                    <span class="hljs-comment">// Special defense two: Special element defense</span><font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode suppose que les propri√©taires de sites utilisent uniquement AdSense: si un script AdSense n'existe pas, alors quelque chose ne va pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi y a-t-il eu un avertissement? </font><font style="vertical-align: inherit;">Cette m√©thode tente d'activer le script AdSense. </font><font style="vertical-align: inherit;">S'il ne se charge pas, le bloqueur a probablement bloqu√© la demande r√©seau, donc BlockAdBlock est d√©clench√©. </font><font style="vertical-align: inherit;">Mais cela peut ruiner certains sites, d'o√π l'avertissement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si AdSense n'a pas √©t√© charg√©, la superposition d√©marre.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
    <span class="hljs-comment">/* Add Google ad code to head.
        If it errors, the adblocker must have blocked the connection. */</span>
    <span class="hljs-keyword">var</span> googleAdCode = <span class="hljs-string">'//static.doubleclick.net/instream/ad_status.js'</span>;<font></font>
    consolelog(<span class="hljs-string">'case3: standard bait says ads are NOT blocked. Maybe ???\
      No Adsense is found. Attempting to add Google ad code to head...'</span>);
    <span class="hljs-keyword">var</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>);<font></font>
    script.setAttribute(<span class="hljs-string">'type'</span>, <span class="hljs-string">'text/javascript'</span>);<font></font>
    script.setAttribute(<span class="hljs-string">'src'</span>, googleAdCode);<font></font>
    script.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
    };<font></font>
    adblockDetected = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (!scriptExists(googleAdCode)) {
        <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>].appendChild(script)<font></font>
    };<font></font>
    adsbygoogleQuery = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].check = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un √©chec se produit au niveau du r√©seau, cela fonctionne </font></font><code>onerror</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme si un bloqueur de publicit√©s fonctionnait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En effet, la plupart des bloqueurs de publicit√©s y r√©pondent et bloquent la demande. </font><font style="vertical-align: inherit;">Mais il y a un bloqueur que je n'ai pas encore mentionn√©. </font><font style="vertical-align: inherit;">Parlez du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navigateur Brave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©ponse de Brave Browser</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'√† pr√©sent, nous avons √©tudi√© comment l'anti-blocage est d√©tect√© dans uBlock Origin. </font><font style="vertical-align: inherit;">Et cela fonctionne, seul un filtre sp√©cifique est requis pour chaque site o√π BlockAdBlock est install√©. </font><font style="vertical-align: inherit;">Le navigateur Brave est impressionnant en ce qu'il d√©tecte et contourne BlockAdBlock de toutes les versions sans aucune action n√©cessaire de la part de l'utilisateur. </font><font style="vertical-align: inherit;">Pour ce faire, il simule la requ√™te directement au niveau de la couche r√©seau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></sup></a><a name="6_6"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de bloquer la demande, </font></font><code>ad_status.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il l'ignore, mais </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">charge de fausses annonces Google de 0 octet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cette astuce astucieuse trompe BlockAdBlock, car elle </font></font><code>onerror</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne fonctionne que si la demande r√©seau √©choue.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2e/45/s7/2e45s7wv2nv9licuzwesiao2tkm.png"></div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 5 (mars 2016 - novembre 2016)</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Diff√©rence de </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">code source </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v4 / v5</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection avanc√©e: favicons de spam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le seul changement dans cette version est que la deuxi√®me protection √©tendue a √©t√© r√©√©crite, bien qu'elle adh√®re toujours au m√™me principe de base: v√©rifier les requ√™tes r√©seau qui seront bloqu√©es par le bloqueur. </font><font style="vertical-align: inherit;">Mais maintenant, les favicons se chargent √† la place d'AdSense. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Brave √©lude cette attaque de la m√™me mani√®re. </font><font style="vertical-align: inherit;">Il ne bloque pas les demandes, mais cr√©e de fausses images 1 √ó 1.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {
    <span class="hljs-keyword">if</span> (! <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].ranAlready) {/
        <span class="hljs-keyword">var</span> favicons = [
            <span class="hljs-string">"//www.google.com/adsense/start/images/favicon.ico"</span>,
            <span class="hljs-string">"//www.gstatic.com/adx/doubleclick.ico"</span>,
            <span class="hljs-string">"//advertising.yahoo.com/favicon.ico"</span>,
            <span class="hljs-string">"//ads.twitter.com/favicon.ico"</span>,
            <span class="hljs-string">"//www.doubleclickbygoogle.com/favicon.ico"</span><font></font>
            ],<font></font>
            len = favicons.length,<font></font>
            img = favicons[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * len)],<font></font>
        ...<font></font>
        baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>); <span class="hljs-comment">// creates bait images</span>
        <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();<font></font>
        m.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>);<font></font>
            c.src = imgCopy;<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>)<font></font>
        };<font></font>
        c.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
            adblockDetected = <span class="hljs-number">1</span>;<font></font>
            baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
            <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
        };<font></font>
        m.src = img;<font></font>
        baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
        <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].ranAlready = <span class="hljs-literal">true</span><font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction </font></font><code>baitImages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut √™tre appel√©e fr√©quemment, avec un nombre al√©atoire d'images, pour contourner les bloqueurs statiques.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version 6 (avril 2016 - novembre 2016): Brave lock</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diff√©rence de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">code source </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Les</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
m√©thodes BlockAdBlock </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">v5 / v6</font></a><font style="vertical-align: inherit;"> , bien que simples √† premi√®re vue, sont progressivement devenues plus complexes et plus efficaces. </font><font style="vertical-align: inherit;">Mais le dernier ennemi invaincu est rest√©: le navigateur Brave.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection avanc√©e: d√©finition d'un faux favicon</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi BlockAdBlock a-t-il cess√© d'essayer de charger un script pour charger des images (favicons)? </font><font style="vertical-align: inherit;">La r√©ponse se trouve dans le code qui s'ajoute √† la protection via des favicons anti-spam, et qui est activ√© contre la protection de Brave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V√©rification de la r√©ponse pour une fausse image:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (aDefTwo == <span class="hljs-string">'yes'</span>) {<font></font>
    baitImages(<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);
    <span class="hljs-comment">// earlier favicon code...</span>
    <span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> Image();
    <span class="hljs-keyword">if</span> ((aDefThree % <span class="hljs-number">3</span>) == <span class="hljs-number">0</span>) {<font></font>
        m.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> ((m.width &lt; <span class="hljs-number">8</span>) &amp;&amp; (m.width &gt; <span class="hljs-number">0</span>)) {
                <span class="hljs-built_in">window</span>[<span class="hljs-string">''</span> + randomID + <span class="hljs-string">''</span>].arm()<font></font>
            }<font></font>
        }<font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la taille du favicon est inf√©rieure √† 8 √ó 8, il s'agit probablement d'un faux du navigateur Brave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette astuce, BlockAdBlock contourne le d√©guisement de Brave et des autres bloqueurs qui ex√©cutent ce code (la plupart, comme uBlock Origin, le bloquent en premier). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cette mise √† jour, vers la fin de novembre 2016, BlockAdBlock a disparu d'Internet. </font><font style="vertical-align: inherit;">Bien que leurs ¬´m√©thodes de s√©curit√© avanc√©es¬ª fonctionnent, elles n'ont jamais √©t√© activ√©es pour la plupart des utilisateurs. </font><font style="vertical-align: inherit;">C'√©tait la derni√®re mise √† jour. </font><font style="vertical-align: inherit;">Le dernier post sur Twitter et sur le site a √©t√© publi√© fin 2017. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, l'h√©ritage de BlockAdBlock perdure. </font><font style="vertical-align: inherit;">Bien qu'il soit trivial de le bloquer de nos jours, ce script est toujours utilis√© par certains sites modernes.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qui va gagner la course aux armements entre les bloqueurs de publicit√© et les anti-bloquants qui bloquent les bloqueurs de publicit√©? Seul le temps nous le dira. √Ä mesure que la course aux armements se d√©veloppe, les anti-bloquants devront utiliser des m√©thodes plus sophistiqu√©es et un code sp√©cial, comme le montre l'√©volution de BlockAdBlock. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'autre part, les bloqueurs ont l'avantage de syst√®mes stables et de puissants outils de filtrage via des listes de filtres, ainsi que l'acc√®s √† JavaScript. Avec un tel syst√®me, il suffit qu'une personne comprenne comment vaincre l'ennemi - et mette √† jour la liste des filtres avec de nouveaux sites. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En analysant l'√©volution de BlockAdBlock, ainsi que les diff√©rentes r√©ponses des bloqueurs de publicit√©s, nous avons pu brosser un tableau d'une petite guerre entre BlockAdBlock et les bloqueurs. Ce faisant, nous avons appris quelles m√©thodes sont utilis√©es dans les hostilit√©s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon code de reverse engineering est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publi√© sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Merci pour la lecture.</font></font><br>
<br>
<hr><br>
<a name="1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Si vous voulez avoir une id√©e de comment cela fonctionne, essayez de coller l'exemple ci-dessous dans la console JS, puis examinez le code. </font><font style="vertical-align: inherit;">Si vous √™tes int√©ress√© par son fonctionnement interne, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voici le code source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ô∏é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[retour]</font></font></a><br>
<br>
<a name="2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Ne croyez pas? </font><font style="vertical-align: inherit;">Essayez de passer </font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la premi√®re ligne. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[rendre]</font></font></a><br>
<br>
<a name="3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. L'horodatage indique </font></font><code>201510</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors peut-√™tre octobre. </font><font style="vertical-align: inherit;">Mais nous ne savons pas quand le script a chang√©. </font><font style="vertical-align: inherit;">Tout ce que nous savons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015-10, une version a √©t√© enregistr√©e: </font></font><code>20151007203811.js</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015-11 il y a une nouvelle version: </font></font><code>20151113115955.js</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä notre connaissance, le script pourrait √™tre modifi√© la veille du deuxi√®me horodatage. </font><font style="vertical-align: inherit;">Ainsi, j'aborde prudemment la datation. </font><font style="vertical-align: inherit;">Ô∏é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[retour]</font></font></a><br>
<br>
<a name="4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Pendant la correction de cette erreur, des tests ont √©t√© d√©velopp√©s pour v1. </font><font style="vertical-align: inherit;">Ô∏é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[retour]</font></font></a><br>
<br>
<a name="5"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Merci √† McStroyer sur Reddit, qui a attir√© l'attention sur ce point. </font><font style="vertical-align: inherit;">Ô∏é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[retour]</font></font></a><br>
<br>
<a name="6"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Le composant Brave ad blocker est ouvert, nous pouvons donc regarder le code source pour avoir une id√©e de son fonctionnement.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La m√©thode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ResourceTypeToString</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©value quelle ressource est intercept√©e.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le bloqueur de publicit√©s Brave dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShouldStartRequest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√©rifie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si la ressource captur√©e correspond √† la r√®gle de blocage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le cas √©ch√©ant, il renvoie une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fausse ressource</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bas√©e sur un type de ressource ant√©rieur et signale une demande ¬´r√©ussie¬ª.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fran√ßois Marie d'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avoir signal√© le code source de Brave. </font><font style="vertical-align: inherit;">Ô∏é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[retour]</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr499118/index.html">Comment cr√©er une vid√©o virale</a></li>
<li><a href="../fr499120/index.html">[Signet] CSS: Utilisation de l'indentation et de l'indentation</a></li>
<li><a href="../fr499122/index.html">Comment organiser son travail dans des conditions en constante √©volution: les cours gratuits anti-crise d'Aktion</a></li>
<li><a href="../fr499126/index.html">D√©veloppeur Heart: Sony PlayStation 1 Devkits</a></li>
<li><a href="../fr499128/index.html">Pr√©sentation de la derni√®re version d'aper√ßu de Windows Terminal - 0.11</a></li>
<li><a href="../fr499134/index.html">4 √©tapes pour augmenter le produit LTV gr√¢ce √† la communication avec les utilisateurs</a></li>
<li><a href="../fr499136/index.html">#BeeFree, ou ... Beeline - vous n'avez pas pu r√©sister?</a></li>
<li><a href="../fr499138/index.html">Tri topologique</a></li>
<li><a href="../fr499140/index.html">G√©n√©ration sous contr√¥le: comment freiner les mod√®les de langage puissants</a></li>
<li><a href="../fr499146/index.html">Un moyen simple de prot√©ger votre Mikrotik des attaques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>