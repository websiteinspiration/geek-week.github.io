<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👜 🤷🏻 🚿 早く行かなきゃ IMAPメールコンテンツリクエストの最適化 🙍🏻 🙈 👴🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは！前回の記事では、ローカルキャッシュのボックスの内容をすばやく同期する方法について説明しました。ここでは、レターのコンテンツをリクエストする機能と、トラフィックの大量消費を恐れずにコンテンツをリクエストする最善の方法についてお話します。
 
 
 
 前の記事で学んだことをすぐに...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>早く行かなきゃ IMAPメールコンテンツリクエストの最適化</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495956/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みなさん、こんにちは！</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前回の記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ローカルキャッシュのボックスの内容をすばやく同期する方法について説明しました。</font><font style="vertical-align: inherit;">ここでは、レターのコンテンツをリクエストする機能と、トラフィックの大量消費を恐れずにコンテンツをリクエストする最善の方法についてお話します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/4w/8a/kk4w8ac2scl3dawogln5zyvg7fg.jpeg" alt="画像"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の記事で学んだことをすぐに思い出してみましょう。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IMAPはステートフルプロトコルです</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信ボックスの内容を表示するには、まずSELECTコマンドで受信ボックスを選択する必要があります</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在のボックスをすばやく同期するには、NOOPコマンドを使用できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーがプロトコル拡張データをサポートしている場合、ローカルストレージからのメッセージをソートして、すでに残したメールボックスを更新しないようにするには、CONDSTOREおよびQRESYNCを使用できます。</font></font></li>
</ul><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">足りる！</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手紙の本文を要求するコマンドを思い出させてください：</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH number (BODY[])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、レターの本文全体とすべての添付ファイルを取得するリクエストが作成されます。</font><font style="vertical-align: inherit;">Lorem Ipsumの42段落と2メガバイトの画像でメッセージを取得するのにかかる時間を確認してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、サーバー上のメッセージのサイズを確認します。</font><font style="vertical-align: inherit;">これは次のコマンドで行います：</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH 18871 (RFC822.SIZE)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RFC822.SIZEは、メッセージのサイズをバイト単位で返します。</font></font><br>
<br>
<pre><code class="bash hljs">* 18871 FETCH (RFC822.SIZE 3937793)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、結果として、メッセージは4メガバイト近くを占めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでも、それでも、レターの本文全体のリクエストを使用して、時間を見てみましょう。</font></font><br>
<br>
<pre><code class="bash hljs">1 OK Fetch completed (0.007 + 3.265 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.3秒！</font><font style="vertical-align: inherit;">そして、これは添付ファイル付きの1つのメッセージにすぎず、それらがボックス全体になると想像してください。</font><font style="vertical-align: inherit;">その後、少なくとも最初の21個をダウンロードするのに1分以上かかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2020年に1分以内にメールを同期できないクライアントのビジネスは悪いことを認めなければなりません。</font><font style="vertical-align: inherit;">しかし、何をすべきか？</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一度噛んでください</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたがいる場合</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC3501をさらさら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">句で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.5.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FETCHコマンドの可能なパラメータを説明し、あなたは面白い要求に気づくでしょう。</font></font><br>
<br>
<pre><code class="bash hljs">BODY[&lt;section&gt;]&lt;&lt;partial&gt;&gt;
</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクション-手紙のどの部分を取得するか</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分的-この部分のサイズ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どのように部分的に構築されますか？</font><font style="vertical-align: inherit;">そして、それはとても簡単です。</font><font style="vertical-align: inherit;">最初に、読み取りを開始する必要があるバイトがポイントを介して書き込まれ、次に一般的に読み取られるバイト数が示されます。</font></font><br>
<br>
<pre><code class="bash hljs">BODY[&lt;section&gt;]&lt;&lt;0.1024&gt;&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、0バイトから1024までの文字の部分を要求します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、セクションとは何ですか？</font><font style="vertical-align: inherit;">最初に、FETCHクエリのこのような便利なパラメーターについて、BODYSTRUCTUREとして説明します。</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH 18871 (BODYSTRUCTURE)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパラメータは、おそらく署名から理解できるように、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIME-IMBで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されている形式で文字の構造を返します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="bash hljs">* 18871 FETCH (BODYSTRUCTURE (((<span class="hljs-string">"text"</span> <span class="hljs-string">"plain"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 25604 337 NIL NIL NIL NIL)(<span class="hljs-string">"text"</span> <span class="hljs-string">"html"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 29593 390 NIL NIL NIL NIL) <span class="hljs-string">"alternative"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_763_774309787.1586268692"</span>) NIL NIL NIL)(<span class="hljs-string">"image"</span> <span class="hljs-string">"jpeg"</span> (<span class="hljs-string">"name"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>) NIL NIL <span class="hljs-string">"base64"</span> 3880726 NIL (<span class="hljs-string">"attachment"</span> (<span class="hljs-string">"filename"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>)) NIL NIL) <span class="hljs-string">"mixed"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_210_297656922.1586268692"</span>) NIL NIL NIL))
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この構造を見て、あなたの頭は回転していますか？</font><font style="vertical-align: inherit;">恐れる必要はありません。今から理解します。</font><font style="vertical-align: inherit;">開始ブラケットと終了ブラケットを比較します。</font></font><br>
<br>
<pre><code class="bash hljs">(<font></font>
BODYSTRUCTURE&nbsp;<font></font>
(<font></font>
[1] (<font></font>
[1.1] (<span class="hljs-string">"text"</span> <span class="hljs-string">"plain"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 25604 337 NIL NIL NIL NIL)<font></font>
[1.2] (<span class="hljs-string">"text"</span> <span class="hljs-string">"html"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 29593 390 NIL NIL NIL NIL) <span class="hljs-string">"alternative"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_763_774309787.1586268692"</span>) NIL NIL NIL<font></font>
)<font></font>
[2] (<span class="hljs-string">"image"</span> <span class="hljs-string">"jpeg"</span> (<span class="hljs-string">"name"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>) NIL NIL <span class="hljs-string">"base64"</span> 3880726 NIL (<span class="hljs-string">"attachment"</span> (<span class="hljs-string">"filename"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>)) NIL NIL) <span class="hljs-string">"mixed"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_210_297656922.1586268692"</span>) NIL NIL NIL<font></font>
)<font></font>
)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
角括弧の近くに数字を置いていることに気付くでしょう。</font><font style="vertical-align: inherit;">これはセクションです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらを計算する方法？</font><font style="vertical-align: inherit;">最初の角かっこは、要求への回答が含まれているだけなので、スキップする必要があります。次に、ドキュメントの見出しに番号が付けられるので、各左角かっこに規則に従って番号を付ける必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のセクションを考慮して、各開始ブラケットに番号を付けます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションがネストされている場合、ポイントを通る現在のセクションが前の番号に追加されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションがネストされていない場合は、セクションの数を1つ増やします</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、この場合、「代替」で終わる最初の部分（つまり、これはマルチパート/代替文字の一部であり、ユーザーに表示する部分を自由に選択できます）には、ドットで番号付けされた2つのセクションがあります。</font><font style="vertical-align: inherit;">3レベルのネスト（つまり、[1.1.1]、[1.1.2]など）の可能性があるサーバーに出会いました。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MIME-IMB</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ドキュメントのこのすべての構造を見て、パート[1.1]を分析してみましょう</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それから判断すると、Content-Typeヘッダーが最初です。</font><font style="vertical-align: inherit;">以下が含まれます：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIMEタイプ、ここはテキスト/プレーンです</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンコーディング（charset = utf8）</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、NILとして書き込まれる2つのパラメーターです。</font><font style="vertical-align: inherit;">正直なところ、わかりませんでしたが、今のところ必要ないので見逃してしまいます。</font><font style="vertical-align: inherit;">私は、このような軽薄謝罪。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次にコンテンツ転送符号化ヘッダであり、それはその中に含まれている、符号化機構が記載され、ここでは、印刷可能な引用されます。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の2つの数値は、可能であれば、パーツのサイズをバイト数と行数で表しています。</font><font style="vertical-align: inherit;">彼らの助けを借りて、特定の行数を表示するのに必要なバイト数を計算できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この部分にはない次の行：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レターのインラインで使用されるContent-Id</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content-Description、この部分が何であるかを説明する行</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の2つのパラメーターについては、明確な答えは見つかりませんでしたが、これらのパラメーターの1つにMD5パーツが含まれていることがあります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[2]の部分は、画像、名前の付いた添付ファイル、base64エンコードであることを除いて、すべて同じです。ここで何が起こっているのかが完全に明確でない場合は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このサイトでは、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションの計算方法を正確に示しています。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは何を与えるのですか？そして、レターを表示する段階では、ユーザーがメッセージを入力して「ダウンロード」ボタンをクリックするまで、コンテンツの上部のみをリクエストでき、添付ファイルをダウンロードできません。添付ファイルを表示するためのすべての情報はBODYSCTRUCTUREで取得されるため、添付ファイル自体をロードせずに名前、フォーマット、サイズを表示できます。&nbsp;</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
練習に移りましょう。</font><font style="vertical-align: inherit;">添付ファイルなしで1キロバイトのメッセージコンテンツを要求します。メッセージの内容を知るためです。</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (body[1.1]&lt;0.1024&gt;)<font></font>
* 18871 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consecte=<font></font>
tur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. Praesent et enim te=<font></font>
llus. Nunc vestibulum diam tortor, id posuere turpis tempor luctus. Vivam=<font></font>
us molestie non nunc nec placerat. Cras finibus ut erat et tristique. Cur=<font></font>
abitur vitae commodo risus. Etiam sed scelerisque erat. Quisque cursus bl=<font></font>
andit finibus. Nullam ac lectus accumsan, molestie quam non, mollis urna.=<font></font>
&nbsp;Nulla at arcu <span class="hljs-keyword">in</span> libero condimentum mollis ut non velit. Vestibulum sed =<font></font>
risus et magna congue iaculis. Vestibulum nec interdum elit, ut commodo m=<font></font>
auris. Nulla ipsum leo, vestibulum nec ligula non, elementum ullamcorper =<font></font>
risus. Nunc et malesuada sem, id venenatis massa. Integer dolor ante, max=<font></font>
imus <span class="hljs-keyword">in</span> eleifend nec, ultricies ut risus. Mauris posuere eget tortor at p=<font></font>
orttitor.=0AIn porta elementum ornare. Suspendisse aliquam, tortor sed al=<font></font>
iquam bibendum, nulla ante rhoncus elit, placerat accumsan augue nibh non=<font></font>
&nbsp;est. Duis finibus vel tortor finibu)<font></font>
1 OK Fetch completed (0.073 + 0.000 + 0.072 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約100ミリ秒で、手紙の内容の一部がすでに表示されています。</font><font style="vertical-align: inherit;">以前は1文字のコンテンツをダウンロードするのに約4秒かかっていたので、これは優れた結果です。</font><font style="vertical-align: inherit;">次に、文字のコンテンツ全体をバックグラウンドストリームに読み込むだけで、外側から文字が瞬時に読み込まれるように見えます。</font><font style="vertical-align: inherit;">必要なのは、手紙の構造を見て、すばやく表示するために必要なものだけをダウンロードすることでした。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一瞬だけ。</font><font style="vertical-align: inherit;">このリクエストにより、サーバー上のメッセージが既読として表示されます。</font><font style="vertical-align: inherit;">しかし、ボディリクエストにPEEKのみを追加することでこれを修正できます</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (BODY.PEEK[1.1]&lt;0.1024&gt;)<font></font>
* 18871 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consecte=<font></font>
tur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. Praesent et enim te=<font></font>
llus. Nunc vestibulum diam tortor, id posuere turpis tempor luctus. Vivam=<font></font>
us molestie non nunc nec placerat. Cras finibus ut erat et tristique. Cur=<font></font>
abitur vitae commodo risus. Etiam sed scelerisque erat. Quisque cursus bl=<font></font>
andit finibus. Nullam ac lectus accumsan, molestie quam non, mollis urna.=<font></font>
&nbsp;Nulla at arcu <span class="hljs-keyword">in</span> libero condimentum mollis ut non velit. Vestibulum sed =<font></font>
risus et magna congue iaculis. Vestibulum nec interdum elit, ut commodo m=<font></font>
auris. Nulla ipsum leo, vestibulum nec ligula non, elementum ullamcorper =<font></font>
risus. Nunc et malesuada sem, id venenatis massa. Integer dolor ante, max=<font></font>
imus <span class="hljs-keyword">in</span> eleifend nec, ultricies ut risus. Mauris posuere eget tortor at p=<font></font>
orttitor.=0AIn porta elementum ornare. Suspendisse aliquam, tortor sed al=<font></font>
iquam bibendum, nulla ante rhoncus elit, placerat accumsan augue nibh non=<font></font>
&nbsp;est. Duis finibus vel tortor finibu)<font></font>
1 OK Fetch completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして出来上がり！</font><font style="vertical-align: inherit;">手紙は未読のままであり、私たちが受け取った内容の一部です。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">PREVIEW</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
リクエスト機能がサーバーに実装されている場合、すべてがさらに簡単になります。&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (PREVIEW)<font></font>
* 18871 FETCH (PREVIEW (FUZZY <span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consectetur enim in nisi venenatis, id varius tellus viverra. Praesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis t"</span>))<font></font>
1 OK Fetch completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、構造のクエリにまったく時間を費やさず、メッセージのプレビューを即座に取得します。</font><font style="vertical-align: inherit;">ただし、クエリ構造がアタッチメントを定義してアイドルに読み込まれないようにするのに役立つことを忘れないでください。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">待つ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが今すぐ新しい手紙を受け取りたい場合、ほとんどすべてのメールクライアントは「更新」ボタンを実装します。</font><font style="vertical-align: inherit;">しかし、どういうわけか、これは私たちの時代にはクールではありません。デバイスとブラウザの両方に通知があります。</font><font style="vertical-align: inherit;">IMAPはこれについて何と言っていますか？</font><font style="vertical-align: inherit;">そして、彼は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDLE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と言い</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この操作は、フォルダーへの接続を保持し、フォルダーへの変更を通知します。</font><font style="vertical-align: inherit;">メールボックスではなく、フォルダに注意してください。</font><font style="vertical-align: inherit;">これを行うには、サーバーにIDLE機能を実装する必要があります。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、サーバーがアラートを送信するフォルダーを選択してから、IDLEを有効にします</font></font><br>
<br>
<pre><code class="bash hljs">1 SELECT Inbox<font></font>
* FLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span>)<font></font>
* OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span> \*)] Flags permitted.<font></font>
* 18872 EXISTS<font></font>
* 0 RECENT<font></font>
* OK [UNSEEN 18685] First unseen.<font></font>
* OK [UIDVALIDITY 1532079879] UIDs valid<font></font>
* OK [UIDNEXT 20155] Predicted next UID<font></font>
* OK [HIGHESTMODSEQ 26338] Highest<font></font>
1 OK [READ-WRITE] Select completed (0.002 + 0.000 + 0.001 secs).<font></font>
1 IDLE<font></font>
+ idling</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「+アイドリング」という回答は、フォルダにアイドルが含まれていることを通知します。</font><font style="vertical-align: inherit;">新しい手紙が届いたらどうなりますか？</font></font><br>
<br>
<pre><code class="bash hljs">* 18873 EXISTS<font></font>
* 1 RECENT</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じ手紙を自分に送ったところ、18873通の手紙を要求する必要があること、フォルダに18873通の手紙があり、1通の手紙が到着したことをアイドルから通知されました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、別の接続でこの手紙を要求します。「EXISTS」という回答のある手紙に興味があります。</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18873 (BODY.PEEK[1.1]&lt;0.1024&gt;)<font></font>
* 18873 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
---- Original Message ---- Tue, Apr 7, 2020, 17:11=0ASubject=<font></font>
: Lorem Ipsum=0A&nbsp; Lorem ipsum dolor sit amet, consectetur adipiscing elit=<font></font>
. Vivamus consectetur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. P=<font></font>
raesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis te=<font></font>
mpor luctus. Vivamus molestie non nunc nec placerat. Cras finibus ut erat=<font></font>
…</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理解することは非常に重要です。</font><font style="vertical-align: inherit;">IDLEは別の接続を必要とするため、同じセッションで変更を受け取ったりメッセージを要求したりすることはできません</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。IDLEは他に何ができますか？</font><font style="vertical-align: inherit;">彼は削除された手紙と旗が変わった手紙について通知することができます。</font><font style="vertical-align: inherit;">例として文字を見て、「/見た」フラグを付けて、文字を削除します。</font></font><br>
<br>
<pre><code class="bash hljs">* 18873 FETCH (FLAGS (\Seen \Recent))<font></font>
* OK Still here<font></font>
* OK Still here<font></font>
* 18873 EXPUNGE<font></font>
* 18871 EXPUNGE<font></font>
* 0 RECENT</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は会話を削除し（18873、18871）、別の手紙（FETCH応答）を見ました。</font><font style="vertical-align: inherit;">なぜこの手紙は1 8871年になったのですか？</font><font style="vertical-align: inherit;">何かが変更された場合、IMAPは文字番号を再集計するためです。</font><font style="vertical-align: inherit;">一番上になったのでその数も変わった。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDLEを使用すると、ボックスの状態をすばやく同期できますが、別の接続が必要になるのは不愉快です。</font><font style="vertical-align: inherit;">それはもっと良いのでしょうか？</font><font style="vertical-align: inherit;">それが私がここにいる理由です。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大声で叫ぶ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じ接続でサーバーからの通知を受信できる機能があり、メールボックス用に特別に構成されている機能、および複数の機能があると言ったらどうでしょう。</font><font style="vertical-align: inherit;">おとぎ話のように聞こえますが、夢中にならないでください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは本当の機能です</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NOTIFY</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たとえば、彼はよく知っています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通知を期待する特定のフォルダーを構成する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーのステータスの変更（既読、新着）を聞く</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通知形式、つまりフォルダを変更したときに表示するものを設定します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダ名の変更を聞く</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダのメタデータの変更を聞く</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォルダステータスの変更をリッスンする方法の例を見てみましょう</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (inboxes (MessageNew FlagChange MessageExpunge))<font></font>
1 OK NOTIFY completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、サーバーからフォルダーステータスの通知が送信されます。たとえば、いくつかのメッセージを別のフォルダーに追加します</font></font><br>
<br>
<pre><code class="bash hljs">* STATUS INBOX/Ozon (MESSAGES 312 UIDNEXT 321 UNSEEN 48)<font></font>
* STATUS <span class="hljs-string">"INBOX/Company News"</span> (MESSAGES 178 UIDNEXT 179 UNSEEN 1)<font></font>
* STATUS <span class="hljs-string">"INBOX/Company News"</span> (MESSAGES 177 UIDNEXT 179 UNSEEN 0)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドを分析します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、NOTIFY SETコマンドがあります。</font><font style="vertical-align: inherit;">次に、括弧内で、リッスンするフォルダーを選択します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信トレイ-選択できるすべてのフォルダ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個人-ユーザーの名前空間にあるフォルダー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">購読済み-ユーザーが購読しているフォルダ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブツリー-指定するフォルダーのサブツリー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールボックス-ここでは、リッスンするフォルダをリストできます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択済み-選択したフォルダに対してのみアラート</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アラートフィルターを担当するパラメーター：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MessageNew-新しいメッセージが到着した場合</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlagChange-フラグが変更された場合</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MessageExpunge-メッセージが削除または移動された場合</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、そのようなコマンドでは、新規、変更、または削除されたメッセージのパラメーターを受け取ることができません。</font><font style="vertical-align: inherit;">これを行うには、[選択済み]パラメーターを選択し、正確に何を返すかを指定します。</font><font style="vertical-align: inherit;">前のアラートを削除せずに別のアラートを追加できます。</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> status (selected (MessageNew (uid preview) MessageExpunge))
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでMessageNew内で、通知が返すパラメータを指定します。</font><font style="vertical-align: inherit;">Inboxを選択し、再びlorem ipsumを使用します。</font></font><br>
<br>
<pre><code class="bash hljs">* 18868 FETCH (UID 20157 PREVIEW (FUZZY <span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consectetur enim in nisi venenatis, id varius tellus viverra. Praesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis t"</span>))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いかがですか？</font><font style="vertical-align: inherit;">アイドルの場合、2つの接続を維持する必要があります。そのうちの1つは、アイドルが返したメッセージも要求します。</font><font style="vertical-align: inherit;">すぐにすべてが銀の大皿に運ばれます。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、私たちはフォルダ名の変更を聞くことができます</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (inboxes (MailboxName))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のフォルダの名前を変更して、結果を確認します。</font></font><br>
<br>
<pre><code class="bash hljs">* LIST () <span class="hljs-string">"/"</span> 1111 (<span class="hljs-string">"OLDNAME"</span> (aaaa))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、フォルダー「aaaa」があり、「1111」になったことがわかりました。これで、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグの変更とメッセージの削除を聞くことができます。</font><font style="vertical-align: inherit;">これを行うには、FlagChangeパラメータを使用します</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (selected (MessageNew (uid) FlagChange MessageExpunge))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージフラグを変更して削除すると、</font></font><br>
<br>
<pre><code class="bash hljs">* 18865 EXPUNGE<font></font>
* 18864 FETCH (FLAGS ())<font></font>
* 18864 FETCH (FLAGS (\Answered))</code></pre><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次は何ですか</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの機能はすべて、メールクライアントがユーザーにとって可能な限り迅速かつ便利に機能するのに役立ちます。</font><font style="vertical-align: inherit;">IDLEおよびNOTIFYは、フォルダーの変更をユーザーに通知し、レターの一部を要求すると、そのロードを高速化します。&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の記事では、IMAPの検索メカニズムと、それを高速化してネットワークの負荷を軽減する方法について説明します。</font><font style="vertical-align: inherit;">最後までお読みいただきありがとうございます。&nbsp;</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495942/index.html">時間、神経、工数を節約</a></li>
<li><a href="../ja495944/index.html">更新されたTOP50（CISスーパーコンピューターの評価）：ダイナミクスとトレンド</a></li>
<li><a href="../ja495946/index.html">ノーベルト・ウィーナー：サイバネティックスの気が散る父</a></li>
<li><a href="../ja495948/index.html">Rust Embedded。STM32F103C8T6（Black Pill）デバッグボードを使用したCortex-M3プロセッサの開発</a></li>
<li><a href="../ja495954/index.html">シスコは、リモートアクセスモードで不在の境界で20年間どのように動作していますか？</a></li>
<li><a href="../ja495960/index.html">AH-ny Wi-Fiのみ。または、教育機関でWi-Fi 6（AX）ネットワークを構築した方法</a></li>
<li><a href="../ja495962/index.html">ウダレンカ：X5でリモートフォーマットの作業に切り替える計画</a></li>
<li><a href="../ja495966/index.html">不条理なコードまたは「書き方」</a></li>
<li><a href="../ja495970/index.html">リモートチーム作業用のツール：時間追跡からファイナンスまで</a></li>
<li><a href="../ja495974/index.html">流星の写真観察、Perseids 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>