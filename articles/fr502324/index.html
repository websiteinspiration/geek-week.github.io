<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📧 🎯 🧝🏽 Plongez dans Delta Lake: application et évolution 👂🏽 🅱️ 🎉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous présente la traduction de l'article «Diving Into Delta Lake: Schema Enforcement & Evolution» de Burak Yavuz, Brenner Heintz et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Plongez dans Delta Lake: application et évolution</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/502324/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font><font style="vertical-align: inherit;">Je vous présente la traduction de l'article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Diving Into Delta Lake: Schema Enforcement &amp; Evolution»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Burak Yavuz, Brenner Heintz et Denny Lee, qui a été préparé avant le début du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cours Data Engineer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d'OTUS.</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/ay/i_/du/ayi_duoudcu7utibiotdubtoegm.png"><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les données, comme notre expérience, s'accumulent et se développent constamment. Pour suivre, nos modèles mentaux du monde doivent s'adapter à de nouvelles données, dont certaines contiennent de nouvelles dimensions - de nouvelles façons d'observer des choses dont nous n'avions aucune idée auparavant. Ces modèles mentaux ne sont pas très différents des schémas de table qui déterminent la façon dont nous classons et traitons les nouvelles informations.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela nous amène à la question de la gestion des circuits. </font><font style="vertical-align: inherit;">À mesure que les tâches et les exigences métier évoluent avec le temps, la structure de vos données change. </font><font style="vertical-align: inherit;">Delta Lake facilite l'implémentation de nouvelles mesures lorsque les données changent. </font><font style="vertical-align: inherit;">Les utilisateurs ont accès à une sémantique simple pour gérer les dispositions de leurs tables. </font><font style="vertical-align: inherit;">Ces outils incluent Schema Enforcement, qui protège les utilisateurs contre le colmatage par inadvertance de leurs tables avec des erreurs ou des données inutiles, ainsi que Schema Evolution, qui ajoute automatiquement de nouvelles colonnes contenant des données précieuses aux endroits appropriés. </font><font style="vertical-align: inherit;">Dans cet article, nous approfondirons l'utilisation de ces outils.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprendre les schémas de table</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque DataFrame dans Apache Spark contient un schéma qui définit un formulaire de données, tel que les types de données, les colonnes et les métadonnées. </font><font style="vertical-align: inherit;">À l'aide de Delta Lake, le schéma de table est enregistré au format JSON dans le journal des transactions.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que le schéma d'application?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application de schéma, également connue sous le nom de validation de schéma, est un mécanisme de défense dans Delta Lake qui garantit la qualité des données en rejetant les enregistrements qui ne correspondent pas au schéma de table. </font><font style="vertical-align: inherit;">Comme l'hôtesse à la réception dans un restaurant populaire, qui n'accepte que sur réservation préalable, il vérifie si chaque colonne de données saisie dans le tableau se trouve dans la liste correspondante des colonnes attendues (en d'autres termes, y a-t-il une «réservation» pour chacune d'entre elles), et rejette toutes les entrées dont les colonnes ne figurent pas dans la liste.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment fonctionne l'application d'un circuit?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delta Lake utilise une vérification de schéma lors de l'écriture, ce qui signifie que la compatibilité de tous les nouveaux enregistrements de la table avec le schéma de la table cible lors de l'enregistrement est vérifiée. </font><font style="vertical-align: inherit;">Si le schéma est incompatible, Delta Lake annule complètement la transaction (les données ne sont pas écrites) et lève une exception pour informer l'utilisateur de l'écart. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour déterminer la compatibilité des enregistrements avec une table, Delta Lake utilise les règles suivantes. </font><font style="vertical-align: inherit;">DataFrame inscriptible:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne peut pas contenir de colonnes supplémentaires qui ne figurent pas dans le schéma de la table cible. </font><font style="vertical-align: inherit;">Et vice versa, tout est en ordre si les données d'entrée ne contiennent pas absolument toutes les colonnes de la table - ces colonnes se verront simplement attribuer des valeurs nulles.</font></font></li>
<li>     ,         .       StringType,     DataFrame   IntegerType,          .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne peut pas contenir de noms de colonnes qui ne diffèrent qu'en cas. </font><font style="vertical-align: inherit;">Cela signifie que vous ne pouvez pas avoir de colonnes avec les noms «Foo» et «foo» définis dans la même table. </font><font style="vertical-align: inherit;">Bien que Spark puisse être utilisé en respectant la casse ou insensible à la casse (par défaut), Delta Lake est sensible à la casse, mais insensible à la casse. </font><font style="vertical-align: inherit;">Parquet est sensible à la casse lors du stockage et du renvoi des informations de colonne. </font><font style="vertical-align: inherit;">Afin d'éviter d'éventuelles erreurs, corruption de données ou perte de données (que nous avons personnellement rencontrées dans les Databricks), nous avons décidé d'ajouter cette restriction.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour illustrer cela, examinons ce qui se passe dans le code ci-dessous lorsque vous essayez d'ajouter des colonnes récemment générées à une table Delta Lake qui n'est pas encore configurée pour les accepter.</font></font><br>
<br>
<pre><code class="apache hljs"><span class="hljs-comment">#  DataFrame ,       Delta Lake</span>
<span class="hljs-attribute">loans</span> = sql(<span class="hljs-string">""</span><span class="hljs-string">"
            SELECT addr_state, CAST(rand(10)*count as bigint) AS count,
            CAST(rand(10) * 10000 * count AS double) AS amount
            FROM loan_by_state_delta
            "</span><span class="hljs-string">""</span>)<font></font>
<font></font>
<span class="hljs-comment">#    DataFrame</span>
<span class="hljs-attribute">original_loans</span>.printSchema()<font></font>
<font></font>
<span class="hljs-attribute">root</span>
  |-- <span class="hljs-attribute">addr_state</span>: string (nullable = true)<font></font>
  |-- <span class="hljs-attribute">count</span>: integer (nullable = true)<font></font>
 <font></font>
<span class="hljs-comment">#    DataFrame</span>
<span class="hljs-attribute">loans</span>.printSchema()<font></font>
 <font></font>
<span class="hljs-attribute">root</span>
  |-- <span class="hljs-attribute">addr_state</span>: string (nullable = true)<font></font>
  |-- <span class="hljs-attribute">count</span>: integer (nullable = true)<font></font>
  |-- <span class="hljs-attribute">amount</span>: double (nullable = true) # new column<font></font>
 <font></font>
<span class="hljs-comment">#    DataFrame (  )   </span>
<span class="hljs-attribute">loans</span>.write.format(<span class="hljs-string">"delta"</span>) \<font></font>
           .<span class="hljs-attribute">mode</span>(<span class="hljs-string">"append"</span>) \<font></font>
           .<span class="hljs-attribute">save</span>(DELTALAKE_PATH)<font></font>
<font></font>
<span class="hljs-attribute">Returns</span>:<font></font>
<font></font>
<span class="hljs-attribute">A</span> schema mismatch detected when writing to the Delta table.<font></font>
 <font></font>
<span class="hljs-attribute">To</span> enable schema migration, please set:<font></font>
'.<span class="hljs-attribute">option</span>(<span class="hljs-string">"mergeSchema"</span>, <span class="hljs-string">"true"</span>)\'<font></font>
 <font></font>
<span class="hljs-attribute">Table</span> schema:
<span class="hljs-attribute">root</span>
-- <span class="hljs-attribute">addr_state</span>: string (nullable = true)<font></font>
-- <span class="hljs-attribute">count</span>: long (nullable = true)<font></font>
 <font></font>
<span class="hljs-attribute">Data</span> schema:
<span class="hljs-attribute">root</span>
-- <span class="hljs-attribute">addr_state</span>: string (nullable = true)<font></font>
-- <span class="hljs-attribute">count</span>: long (nullable = true)<font></font>
-- <span class="hljs-attribute">amount</span>: double (nullable = true)<font></font>
 <font></font>
<span class="hljs-attribute">If</span> Table ACLs are enabled, these options will be ignored. Please use the ALTER TABLE command for changing the schema.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu d'ajouter automatiquement de nouvelles colonnes, Delta Lake impose un graphique et arrête l'enregistrement. </font><font style="vertical-align: inherit;">Pour aider à déterminer quelle colonne (ou plusieurs d'entre elles) est à l'origine de la non-concordance, Spark extrait les deux schémas de la pile de pile pour comparaison.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle est l'utilité d'appliquer un programme?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que l'application d'un schéma est un test assez rigoureux, c'est un excellent outil pour utiliser un ensemble de données propre et entièrement transformé qui est prêt pour la production ou la consommation en tant que contrôleur d'accès. </font><font style="vertical-align: inherit;">En règle générale, il est appliqué aux tables qui fournissent directement des données:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithmes d'apprentissage automatique</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableaux de bord BI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outils d'analyse et de visualisation des données</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout système de production qui nécessite des schémas sémantiques strictement structurés et fortement typés.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour préparer leurs données à cette dernière barrière, de nombreux utilisateurs utilisent une architecture simple «multi-sauts», qui structure progressivement leurs tables. </font><font style="vertical-align: inherit;">Pour en savoir plus à ce sujet, vous pouvez consulter l'article d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apprentissage automatique au niveau machine de Delta Lake. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, vous pouvez utiliser l'application forcée du schéma n'importe où dans votre pipeline, mais rappelez-vous que le streaming vers une table dans ce cas peut être frustrant, car, par exemple, vous avez oublié que vous avez ajouté une autre colonne aux données d'entrée.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prévention de l'amincissement des données</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À ce stade, vous vous demandez peut-être pourquoi une telle agitation? Après tout, parfois une erreur inattendue de «discordance de schéma» peut vous placer sur le train en marche de votre flux de travail, surtout si vous êtes nouveau sur Delta Lake. Pourquoi ne pas simplement laisser le schéma changer au besoin pour que je puisse écrire mon DataFrame, quoi qu'il arrive?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le dit le vieil adage, "une once de prévention vaut mieux que guérir". À un moment donné, si vous ne prenez pas soin d'appliquer votre schéma, les problèmes de compatibilité des types de données soulèveront vos têtes dégoûtantes - à première vue, les sources homogènes de données brutes peuvent contenir des cas limites, des colonnes endommagées, des mappages malformés ou d'autres choses effrayantes qui rêvent dans les cauchemars. La meilleure approche consiste à arrêter ces ennemis aux portes - en appliquant le schéma - et à les traiter à la lumière, pas plus tard, lorsqu'ils commencent à parcourir les profondeurs sombres de votre code de travail.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application d'un schéma vous donne l'assurance que le schéma de votre table ne changera pas, sauf si vous confirmez vous-même l'option de modification. </font><font style="vertical-align: inherit;">Cela évite la dilution des données qui peut se produire lorsque de nouvelles colonnes sont ajoutées si souvent que les tables compressées précédemment valables perdent leur valeur et leur utilité en raison des flux de données. </font><font style="vertical-align: inherit;">En vous encourageant à être intentionnel, à fixer des normes élevées et à vous attendre à une qualité élevée, l'application du programme fait exactement ce qu'il était censé vous aider à rester honnête et à garder vos tables propres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si, après un examen plus approfondi, vous décidez que vous </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devez</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vraiment </font><font style="vertical-align: inherit;">ajouter une nouvelle colonne - pas de problème, voici un correctif sur une seule ligne. </font><font style="vertical-align: inherit;">La solution est l'évolution du circuit!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que l'évolution du circuit?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'évolution du schéma est une fonctionnalité qui permet aux utilisateurs de modifier facilement le schéma de table actuel en fonction des données qui évoluent dans le temps. </font><font style="vertical-align: inherit;">Le plus souvent, il est utilisé lors d'une opération d'ajout ou de remplacement pour adapter automatiquement la mise en page pour inclure une ou plusieurs nouvelles colonnes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment fonctionne l'évolution des circuits?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En suivant l'exemple de la section précédente, les développeurs peuvent facilement utiliser l'évolution du schéma pour ajouter de nouvelles colonnes qui ont été précédemment rejetées en raison de l'inadéquation du schéma. </font><font style="vertical-align: inherit;">L'évolution du schéma est activée en ajoutant </font></font><code>.option('mergeSchema', 'true')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à votre équipe Spark.</font></font><code>.write  .writeStream.</code><br>
<br>
<pre><code class="apache hljs"><span class="hljs-comment">#   mergeSchema</span>
<span class="hljs-attribute">loans</span>.write.format(<span class="hljs-string">"delta"</span>) \<font></font>
           .<span class="hljs-attribute">option</span>(<span class="hljs-string">"mergeSchema"</span>, <span class="hljs-string">"true"</span>) \<font></font>
           .<span class="hljs-attribute">mode</span>(<span class="hljs-string">"append"</span>) \<font></font>
           .<span class="hljs-attribute">save</span>(DELTALAKE_SILVER_PATH)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour afficher le graphique, exécutez la requête Spark SQL suivante</font></font><br>
<br>
<pre><code class="apache hljs"><span class="hljs-comment">#     ,  ,    </span>
%<span class="hljs-attribute">sql</span>
<span class="hljs-attribute">SELECT</span> addr_state, sum(`amount`) AS amount
<span class="hljs-attribute">FROM</span> loan_by_state_delta
<span class="hljs-attribute">GROUP</span> BY addr_state
<span class="hljs-attribute"><span class="hljs-nomarkup">ORDER</span></span> BY sum(`amount`)
<span class="hljs-attribute">DESC</span> LIMIT <span class="hljs-number">10</span></code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/5e8/599/d11/5e8599d1121f80df2f74f80f68bcb372.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez également définir cette option pour toute la session Spark en ajoutant </font></font><code>spark.databricks.delta.schema.autoMerge = True</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spark à la configuration. Mais utilisez-le avec prudence, car l'application d'un schéma ne vous avertira plus des incohérences involontaires avec le schéma. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En incluant un paramètre dans la requête </font></font><code>mergeSchema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, toutes les colonnes qui sont présentes dans le DataFrame mais qui ne sont pas dans la table cible sont automatiquement ajoutées à la fin du schéma dans le cadre de la transaction d'écriture. Les champs imbriqués peuvent également être ajoutés et ils seront également ajoutés à la fin des colonnes de structure correspondantes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les ingénieurs de date et les scientifiques peuvent utiliser cette option pour ajouter de nouvelles colonnes (peut-être une mesure récemment suivie ou une colonne de mesures de vente ce mois-ci) à leurs tables de production d'apprentissage automatique existantes sans casser les modèles existants basés sur d'anciennes colonnes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les types de modifications de schéma suivants sont autorisés dans le cadre de l'évolution du schéma lors de l'ajout ou de la réécriture d'une table:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout de nouvelles colonnes (c'est le scénario le plus courant)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifier les types de données de NullType -&gt; tout autre type ou augmenter de ByteType -&gt; ShortType -&gt; IntegerType</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'autres modifications inacceptables dans le cadre de l'évolution d'un schéma nécessitent que le schéma et les données soient écrasés par l'ajout </font></font><code>.option("overwriteSchema", "true")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Par exemple, dans le cas où la colonne "Foo" était à l'origine un entier et que le nouveau schéma serait un type de données de chaîne, tous les fichiers Parquet (données) devraient être réécrits. </font><font style="vertical-align: inherit;">Ces changements comprennent:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supprimer la colonne</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">changer le type de données d'une colonne existante (en place)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renommer des colonnes qui ne sont sensibles qu'à la casse (par exemple, "Foo" et "foo")</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, avec la prochaine version de Spark 3.0, le DDL explicite (en utilisant ALTER TABLE) sera entièrement pris en charge, ce qui permettra aux utilisateurs d'effectuer les actions suivantes sur les schémas de table:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajout de colonnes</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modifier les commentaires de colonne</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">définir des propriétés de table qui déterminent le comportement de la table, par exemple, définir la durée de stockage du journal des transactions.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle est l'utilité de l'évolution des circuits?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez toujours utiliser l'évolution du schéma lorsque vous avez l' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intention de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modifier le schéma de votre table (par opposition aux cas où vous avez accidentellement ajouté à votre DataFrame des colonnes qui ne devraient pas y être). </font><font style="vertical-align: inherit;">C'est le moyen le plus simple de migrer votre schéma car il ajoute automatiquement les noms de colonne et les types de données corrects sans qu'il soit nécessaire de les déclarer explicitement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Forcer un schéma rejette toutes les nouvelles colonnes ou autres modifications de schéma qui ne sont pas compatibles avec votre table. En fixant et en maintenant ces normes élevées, les analystes et les ingénieurs peuvent compter sur le fait que leurs données ont le plus haut niveau d'intégrité, en raisonnant clairement et clairement, ce qui leur permet de prendre des décisions commerciales plus efficaces. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'autre part, l'évolution du circuit complète l'application, simplifiant les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prétendues</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modifications automatiques du circuit. Au final, il ne devrait pas être difficile d'ajouter une colonne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application forcée du circuit est le yang, où l'évolution du circuit est le yin. Lorsqu'elles sont utilisées ensemble, ces fonctionnalités rendent la réduction du bruit et le réglage du signal plus faciles que jamais.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous tenons également à remercier Mukul Murti et Pranava Ananda pour leurs contributions à cet article. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autres articles de la série: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plongez dans Delta Lake: décompresser un journal de transactions</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/tjb10n5wVs8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Articles Liés</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apprentissage automatique au niveau de la production de Delta Lake </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'un lac de données?</font></font></a><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En savoir plus sur le cours</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502308/index.html">Qu'est-ce qui empêche le marché boursier d'une chute à grande échelle et qu'est-ce que l'entreprise technologique a à voir avec cela?</a></li>
<li><a href="../fr502312/index.html">Règles de vol à vue et aux instruments</a></li>
<li><a href="../fr502316/index.html">FCC ouvre la bande 6 GHz pour les réseaux sans fil - pourquoi tout le monde ne pense pas que c'est une bonne idée</a></li>
<li><a href="../fr502318/index.html">Paillettes intelligentes</a></li>
<li><a href="../fr502322/index.html">Инструкция по переносу своего сознания на цифровой носитель</a></li>
<li><a href="../fr502326/index.html">Comment payer les programmeurs</a></li>
<li><a href="../fr502328/index.html">Le meilleur moment pour publier un projet pour animaux de compagnie</a></li>
<li><a href="../fr502330/index.html">Le problème du choix: comment j'ai essayé d'acheter un téléviseur et de ne pas devenir fou</a></li>
<li><a href="../fr502332/index.html">Codes étape par étape: Code aztèque</a></li>
<li><a href="../fr502336/index.html">Lecture le week-end: sons qui nous manquent, comment échapper à la crise et quoi lire sur les gadgets audio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>