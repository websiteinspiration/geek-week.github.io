<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¨ üë©üèæ‚Äçüöí üßÄ Protokollierung und Abfrageverfolgung sind bew√§hrte Methoden. Yandex-Bericht ‚ÜóÔ∏è üë®üèª‚Äçüîß üê¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yandex.Market verf√ºgt √ºber eine gro√üe Microservice-Architektur. Die Browseranforderung auf der Hauptseite des Marktes f√ºhrt zu Dutzenden eingebetteter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Protokollierung und Abfrageverfolgung sind bew√§hrte Methoden. Yandex-Bericht</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/489048/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Market verf√ºgt √ºber eine gro√üe Microservice-Architektur. </font><font style="vertical-align: inherit;">Die Browseranforderung auf der Hauptseite des Marktes f√ºhrt zu Dutzenden eingebetteter Anforderungen in verschiedenen Diensten (Backends), die von verschiedenen Personen entwickelt werden. </font><font style="vertical-align: inherit;">In einem solchen System kann es schwierig sein zu verstehen, aus welchem ‚Äã‚ÄãGrund die Anfrage gefallen ist oder die Bearbeitung lange gedauert hat.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_l1qP0DyBcA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anatoly Ostrovsky </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Megatolya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erkl√§rt, wie sein Team dieses Problem gel√∂st hat und teilt marktspezifische Praktiken mit, die jedoch f√ºr jeden gro√üartigen Service allgemein relevant sind. Sein Bericht basiert auf seinen eigenen Erfahrungen mit der Bereitstellung eines neuen Marktplatzes in relativ kurzer Zeit. Tolya leitete mehrere Jahre das Interface-Entwicklungsteam auf dem Markt und ist nun in Richtung unbemannter Fahrzeuge gewechselt.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Alle unsere Marktpl√§tze sind nach allgemeinen Grunds√§tzen gebaut. Dies ist ein gro√ües einzelnes System. Wenn wir jedoch √ºber das Frontend sprechen, sind die Anwendungen aus Sicht des Benutzers v√∂llig unterschiedlich. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/cx/bk/xfcxbk6d4xsoxdb3l7clfzw5yza.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig gehen unsere Frontends an viele Backends. Manchmal sind diese Backends einander √§hnlich (verschiedene Instanzen derselben Anwendung). Und manchmal sind sie f√ºr den Service einzigartig (spezielle Abrechnung). Die Struktur eines solchen Systems kann als klassische Mikroservice-Architektur betrachtet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei einem gro√üen Dienst gibt es immer ein Problem - es ist schwer zu verstehen, was genau darin passiert. Oder zum Beispiel, was in dem Moment passiert, in dem ein Zahlungsfehler beim Benutzer auftritt. Angenommen, es ist gestern bei ihm passiert, und heute m√ºssen wir verstehen, was passiert ist.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b3/nz/p2/b3nzp2buowpixe2wnv1-r-ymj7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Backend 2 kann entweder f√ºr ein bestimmtes Produkt oder zu einem bestimmten Zeitpunkt oder f√ºr bestimmte Benutzer "brennen". Wir m√ºssen in der Lage sein, auf jede Situation zu reagieren. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pv/wu/-w/pvwu-wguspmalhce4hxtbvhqznu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben viele Backends, und wie gesagt, sie k√∂nnen alleine laufen. Wenn dies in Form eines Diagramms dargestellt wird, wird es ziemlich verwirrend. Im wirklichen Leben kann es Hunderte von Mikrodiensten geben. Stellen Sie sich vor, wie viele Verbindungen zwischen ihnen bestehen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt viele Schritte, um in dieses Thema einzutauchen. Ich werde kurz √ºber jeden von ihnen sprechen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/nf/hq/qunfhq8cdqgbtqtmikv0maf1tpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vereinbaren Sie zun√§chst mit Kollegen aus dem Backend ein gemeinsames Anforderungskennzeichnungssystem - es ist sp√§ter einfacher, sie zu finden. </font><font style="vertical-align: inherit;">Als n√§chstes m√ºssen Sie in der Lage sein, das Problem schnell zu reproduzieren. </font><font style="vertical-align: inherit;">Angenommen, ein Zahlungsfehler ist aufgetreten. Versuchen Sie schnell zu verstehen, wie es passiert ist und in welchem ‚Äã‚ÄãBackend. </font><font style="vertical-align: inherit;">Speichern Sie Protokolle nicht nur in Dateien, sondern auch in der Datenbank, damit Aggregationen durchgef√ºhrt werden k√∂nnen. </font><font style="vertical-align: inherit;">Ein wichtiger Teil des Prozesses sind nat√ºrlich Grafiken und √úberwachung. </font><font style="vertical-align: inherit;">Als n√§chstes in der richtigen Reihenfolge.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einheitliches Anforderungsidentifikationssystem</font></font></h2><br>
<img src="https://habrastorage.org/webt/1z/lc/cl/1zlccllwyct_nesu28sa4kh0za0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eines der einfachsten Tools, um zu verstehen, was mit dem Service geschieht. Stimmen Sie mit Kollegen √ºberein, dass Ihr Frontend beispielsweise eine Art ID-Anfrage (die requestId-Variable im Bild) generiert und diese dann in alle Endpunkte der Backends wirft. Und das Backend selbst erfindet nichts neu. Er nimmt die eingetroffene requestId und leitet sie in Anfragen an seine Backends weiter. Gleichzeitig kann er sein Pr√§fix angeben, damit unter der identischen requestId dieses bestimmte Backend gefunden werden kann. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/qo/sk/ohqoskth2c-8o9h2btju58-tg04.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie also Ihre Protokolle verschlingen und sicherstellen, dass in Ihren Protokollen beispielsweise angegeben ist, dass das Backend f√ºnfhundert ist, gibt es m√∂glicherweise zwei Optionen. Sie geben diese Anforderungs-ID entweder an Ihre Kollegen weiter und sie sehen sie sich in ihren Protokollen an, oder Sie sehen es selbst.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/cf/1m/pqcf1m-t3srhcoorgfwnnpohbqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle unsere Protokolle sind mit einer solchen ID gekennzeichnet, um nicht nur zu verstehen, was zu welchem ‚Äã‚ÄãZeitpunkt passiert ist, sondern auch um den Kontext dieser Anfrage beizubehalten. </font><font style="vertical-align: inherit;">Es ist asynchron und kann sp√§ter etwas zum Protokoll hinzuf√ºgen. </font><font style="vertical-align: inherit;">Und wenn Sie auf Anfrage bei√üen, wird nichts Gutes daraus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cURL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Problem zu reproduzieren, verwenden wir das Dienstprogramm cURL. Dies ist ein Konsolendienstprogramm, das Netzwerkanforderungen stellt - http und https. cURL unterst√ºtzt viel mehr verschiedene Protokolle. Bei der Webentwicklung ist es jedoch einfacher anzunehmen, dass dies ein Tool f√ºr die Arbeit mit http (s) -Anfragen ist. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/mr/uh/75mruhc0hnm0q7qtllafjtnz8ak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um sich mit dem cURL-Team vertraut zu machen, k√∂nnen Sie zu einer beliebigen Site gehen, dann zu Network gehen und jede Anfrage in Form von cURL kopieren. Das Ergebnis ist eine so gro√üe Linie: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jl/mn/fx/jlmnfxdobmhcqctl-uviygpzij8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie versuchen, es herauszufinden, gibt es nichts, wor√ºber Sie sich Sorgen machen m√ºssen. Versuchen wir es auseinander zu nehmen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j5/88/xz/j588xz0r-jh48xp1rphfqoljlvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist eine Anfrage an market.yandex.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gv/6v/_d/gv6v_dz188tviqfjs5siyf9lt8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier wurde ein User-Agent hinzugef√ºgt, der viel Platz beansprucht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1j/a_/sd/1ja_sdx_in4dcwudr64xjdezf98.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Tat ist der Rest Cookies. Es gibt ziemlich viele davon im Yandex-Code. In serialisierter Form sehen sie sehr beeindruckend aus. In der Tat gibt es nichts anderes als sie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wof√ºr ist cURL also n√ºtzlich? Wenn Sie es in sich selbst kopiert und ausgef√ºhrt haben, haben Sie dieselbe Seite market.yandex.ru wie ich gesehen - nur der Computer, auf dem es ausgef√ºhrt wurde, w√§re anders. Nat√ºrlich k√∂nnen einige Nebenwirkungen zu Unterschieden bei den IP-Adressen f√ºhren, aber im Allgemeinen handelt es sich um dieselben Anforderungen. Wir w√ºrden das gleiche Szenario reproduzieren. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/gd/sg/lhgdsguqkolxs1vrjusxnshjnmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um solche cURL-Abfragen nicht jedes Mal zu erfinden, k√∂nnen Sie das Format-Curl des npm-Pakets verwenden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/in/fk/yjinfkjpv0bgzbhfmi8shr7qyno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es werden alle Anforderungsparameter ber√ºcksichtigt, die die Funktion normalerweise verwendet - in diesem Fall nur Header und URL. </font><font style="vertical-align: inherit;">Er wei√ü aber auch, wie man abfragt, textiert usw. Und die Ausgabe ist nur eine Zeichenfolge mit einer cURL-Anforderung. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/4l/h8/xx4lh8tvvwmvzw1-aflbg7ophvq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher enthalten alle unsere Protokolle in der Entwicklungsumgebung auch cURL-Anforderungen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/iq/f6/wuiqf6p5bzxdgiom430q364yuw4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben sogar Backend-cURL-Anfragen direkt im Browser protokolliert, um sofort zu sehen, wie wir zu unseren Backends gelangen, ohne auf die Browserkonsole zu schauen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0o/l3/ay/0ol3ay03w7toau9tyabduyiu1-m.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitte beachten Sie, dass cURL-Anfragen die √úbertragung von Sitzungscookies beinhalten - dies ist schlecht. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Ihre cURL-Anfrage an market.yandex.ru an mich gerichtet haben, kann ich Ihren Market und jeden anderen Yandex-Service unter Ihrem Login eingeben. </font><font style="vertical-align: inherit;">Daher speichern wir solche Anforderungen nirgendwo und protokollieren sie nur in Pr√ºfst√§nden f√ºr uns selbst - solche Daten k√∂nnen nicht verloren gehen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clickhouse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes werde ich √ºber strukturierte Protokolle sprechen. Hier werde ich die spezifische ClickHouse-Datenbank ber√ºcksichtigen, aber Sie k√∂nnen jede ausw√§hlen. ClickHouse ist ein s√§ulenf√∂rmiges DBMS. Es ist bequemer, aus einer gro√üen Datenmenge auszuw√§hlen und gro√üe Datenmengen aufzunehmen. Es ist insofern gut, als Sie einen gro√üen Teil des Protokolls darin speichern und dann beispielsweise eine Art Aggregation von einer Milliarde Datens√§tzen erstellen k√∂nnen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/yq/hx/rxyqhxvdpvjetfh9jmkw4hfkwvu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall ist das ClickHouse-Auswahlbeispiel einfaches SQL. Hier zeigen wir die Anzahl der Anfragen nach Statuscodes f√ºr heute. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/5v/je/oi5vje-sgh204x5-w1fjywdjyk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen werden wir 180.000 zweihundertsiebenhundert haben, und die verbleibenden Statuscodes zum Beispiel sind f√ºr uns nicht interessant. Aber wie k√∂nnen wir das interessant nutzen?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/r6/gp/edr6gpqetfffuhjo6uc2hwznb4s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir k√∂nnen sagen, dass das Verh√§ltnis von zweihundert zum Verh√§ltnis der Gesamtzahl der Antworten der Service Level Indicator ist, der die Frage beantwortet, wie gut unsere Anwendung in Bezug auf Statuscodes funktioniert. Obwohl einfach, spricht er bereits √ºber etwas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/vr/vq/y3vrvqez5ghx9umed2htpzgeurm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basierend auf unserem Indikator k√∂nnen wir den ersten SLI erstellen, dh zum Beispiel, dass 99% unserer Anfragen in Ordnung sein sollten. Und hier k√∂nnen wir vergleichen, dass wir unseren SLI durchgef√ºhrt haben. Wenn sie nicht erf√ºllt worden w√§ren, h√§tten wir versuchen k√∂nnen, entweder einige letzte Anfragen zu erkennen, die f√ºnfhundert gewesen w√§ren, oder einfach nur kritische Dinge. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hf/0i/vf/hf0ivf6posnoebmrwayqz4wni5c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel sind Zahlungsfehler f√ºr uns kritisch, aber in diesem Fall geben sie Null zur√ºck - es ist ein Gl√ºck :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5c/0i/yh/5c0iyhrkfdxbgd0psywb7jvv8si.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie stellen Sie sicher, dass Ihre Protokolle in dieser praktischen Form vorliegen und √ºber SQL erstellt werden k√∂nnen?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7b/7m/hx/7b7mhxhtlyos6qbomnnm2p6xcko.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein Thema f√ºr einen separaten gro√üen Bericht, und alles h√§ngt von Ihrer Infrastruktur ab. </font><font style="vertical-align: inherit;">Es scheint jedoch zwei M√∂glichkeiten zu geben. </font><font style="vertical-align: inherit;">Erstens: Senden Sie Metadaten direkt an die Laufzeit, direkt an die Datenbank. </font><font style="vertical-align: inherit;">Wir machen es auf die zweite Weise anders: Wir folgen der Protokolldatei und senden Chunks entweder in der Datenbank oder an einer Zwischenstelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies funktioniert f√ºr uns eher vielschichtig - wir senden Protokolle von einer bestimmten Instanz an einen Remotespeicherserver solcher Protokolle.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trace anfordern</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt kein Konzept f√ºr die "Abfrageverfolgung". Dieser Begriff wurde von Google gepr√§gt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/mc/cf/aumccfspkkp7eieqgesgk8awnn4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie im Internet nach "Abfrageverfolgung" suchen, wird der Befehl traceroute angezeigt. M√∂glicherweise √§hnelt dies der Abfrageverfolgung. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w0/no/pv/w0nopvgiuihtlc2x8b7fdist7lm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt sogar ein Konsolenprogramm, und hier habe ich es f√ºr die Website bringly.ru ausgef√ºhrt (ein Dienst, den wir im letzten Fr√ºhjahr entwickelt haben). Es ist hilfreich zu verstehen, welche Art von Maschinen und Servern die Anforderung durchl√§uft, bevor sie an den Balancer gelangt, der entweder mit dem Layout oder mit etwas anderem antwortet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9g/n9/ax/9gn9axljm2rabdxvowa3p8gsjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist unser Balancer. Mit Abfrageverfolgung meinen wir nicht dies, sondern alles, was in unserem Balancer passiert - wie die Anforderung weiter in unserer Anwendung node.js lebt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/rh/rr/fhrhrr6j0ujdnvdivmn0dwobnlc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen dies in Form einer Zeitleiste, in der die horizontale Zeit und die vertikale Reihenfolge der Anforderungen angezeigt werden. In diesem Fall haben wir eine Anfrage an die Produktkarte, wobei ersichtlich ist, dass dies eine Anfrage an das Backend unserer Autorisierung ist. Nach seiner Entscheidung gingen drei lange Schlangen - dies ist eine Anfrage an unser Haupt-Backend nach einem Warenkorb, einer Produktkarte und √§hnlichen Produkten. Wir haben also eine Spur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m8/sl/4a/m8sl4atplnknyq_5wefl8b2wgw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen Sie den gleichen Antrag auf Autorisierung, und dann ging das Backend. In diesem Fall verh√§lt sich das Backend nicht sehr optimal, da es viele aufeinanderfolgende Abfragen in seiner Datenbank hat. Wahrscheinlich k√∂nnte eine solche Abfrage optimiert werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ru/ah/bz/ruahbzfg8qzvgzi1s2gbexvm0og.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und hier ist ein Beispiel f√ºr eine Ablaufverfolgung, bei der wir kein Backend aufgerufen haben, sondern sofort den Status 500 angegeben haben. Wie ist eine solche Ablaufverfolgung f√ºr uns n√ºtzlich? </font><font style="vertical-align: inherit;">Wir m√ºssen Kollegen nicht st√∂ren. </font><font style="vertical-align: inherit;">Wir haben die ID dieser Anfrage, sodass wir selbst in den Protokollen nachsehen und herausfinden k√∂nnen, was passiert. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/nm/0g/wqnm0gw9rgznoe7rswqshty_u1a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die gegenteilige Situation. </font><font style="vertical-align: inherit;">Backend sagte, dass etwas nicht stimmte und schrieb gleichzeitig in die Meta-Informationen, was genau passiert ist - eine Art Stack-Trace erschien. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/lb/ck/uclbck5ju2ri2l2qyhjxkwnvxpk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie mache ich das gleiche Werkzeug? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Wichtigste hier ist die Datenbank. </font><font style="vertical-align: inherit;">Wenn Sie das einfachste "INSERT INTO" in der Datenbank einiger Aktionen mit dem Dienst haben, k√∂nnen Sie sp√§ter zumindest SQL verwenden, um die erforderlichen Ereignisse zu finden. </font><font style="vertical-align: inherit;">Und wenn n√∂tig, k√∂nnen Sie eine Schnittstelle dazu erstellen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafiken</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein sehr interessantes Thema, auf das ich heute nat√ºrlich nicht n√§her eingehen werde :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mo/tc/5p/motc5p8irltrzn7aqlsffemkdza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns √ºber die Protokollierung sprechen. </font><font style="vertical-align: inherit;">Wir haben viele Grafiken, wir schauen sie uns an, wenn wir etwas ausrollen - und in den Timings gibt es so ein Rauschen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/vn/ku/lovnkuij1s2d39nszmdwvwsde78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagramme helfen visuell zu erkennen, dass etwas nicht stimmt. </font><font style="vertical-align: inherit;">Und dann m√ºssen Sie sich noch die Protokolle ansehen und verstehen, was mit ihnen nicht stimmt. </font><font style="vertical-align: inherit;">In diesem Fall bedeutet der Anstieg unmittelbar nach der Freigabe zumindest, dass eine solche Freigabe sofort zur√ºckgesetzt werden muss.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberwachung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein noch wichtigerer Teil und ein st√§rkeres Eintauchen in dieses Thema ist die √úberwachung. Unter √úberwachung verstehe ich zum einen die automatische √úberwachung von Diagrammen und zum anderen alle automatisierten Regeln f√ºr die √úberwachung von Objekten. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/1f/r9/wn1fr9r0fnzl-r4kbkgbj3pwz6w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir √ºberwachen das Verh√§ltnis von f√ºnfhundert zur Gesamtzahl der Antworten pro Minute. Wir √ºberwachen auch vierhundert, das Vorhandensein einer Last auf dem Dienst, √ºberpr√ºfen den Integrit√§tspr√ºfungsknopf, der den Ping-Knopf jedes der Backends zieht, usw.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/be/ts/j0betsujurv192dkwhrvk_cvegk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√ºber hinaus verf√ºgen wir √ºber √úberwachungs-Dashboards, die wir auf Bildschirmen in der N√§he von Workstations einf√ºgen. </font><font style="vertical-align: inherit;">So sehen wir sofort, welche der √úberwachung "err√∂ten". </font><font style="vertical-align: inherit;">Zum Beispiel ist es hier eines der wichtigsten, bei denen das Frontend und unser Haupt-Backend sichtbar sind. </font><font style="vertical-align: inherit;">Hier k√∂nnen Sie sehen, dass einige √úberwachung im Backend aufleuchtet. </font><font style="vertical-align: inherit;">Dies bedeutet, dass die f√ºr diesen Dienst verantwortliche Person in diesem Moment eine Nachricht per Telegramm erh√§lt oder sie sogar anruft - dies h√§ngt von den √úberwachungseinstellungen ab.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit einer einzigen requestId k√∂nnen Sie Probleme in einem Dienst, der aus mehreren Anwendungen besteht, leichter finden. </font><font style="vertical-align: inherit;">Mit der richtigen cURL k√∂nnen Sie die Probleme genauer reproduzieren und sehen, wie Sie beispielsweise selbst Daten an das Backend senden. </font><font style="vertical-align: inherit;">Mit strukturierten Protokollen k√∂nnen Sie SLI erstellen, und sie sind bequemer zu verwenden als normale Textprotokolle. </font><font style="vertical-align: inherit;">Und vergessen Sie nicht, den Tabellen zu folgen und die √úberwachung durchzuf√ºhren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich empfehle, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Buch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Site Reliability Engineering von Google zu </font><font style="vertical-align: inherit;">lesen, </font><font style="vertical-align: inherit;">wenn Sie an Infrastruktur interessiert sind.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de489038/index.html">Das Buch "Java Concurrency in Practice"</a></li>
<li><a href="../de489040/index.html">Contact Center AI: Dritte im Gespr√§ch sind in Ordnung</a></li>
<li><a href="../de489042/index.html">Gro√üe Wiederer√∂ffnung des Stores: Laden von Daten mit Coroutine in Android</a></li>
<li><a href="../de489044/index.html">Physik des Textes. Teil 1. Symbole</a></li>
<li><a href="../de489046/index.html">Selbstfahrender GAZ66 Monster Truck 1/16</a></li>
<li><a href="../de489050/index.html">Windows gegen Sysmon</a></li>
<li><a href="../de489058/index.html">Ensembles neuronaler Netze mit PyTorch und Sklearn</a></li>
<li><a href="../de489060/index.html">Analyse: Was ist der Unterschied zwischen risikoreichen und risikoarmen Anlagen?</a></li>
<li><a href="../de489062/index.html">Unglaubliche parallele Apache Parquet I / O-Leistung in Python</a></li>
<li><a href="../de489068/index.html">Digitale Unsterblichkeit - Ein technischer Ansatz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>