<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∂ ‚úåüèæ üë©üèΩ‚Äç‚úàÔ∏è Implemente Hyperledger Fabric 1.4 en AWS üññüèΩ üí´ üëßüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabric es una plataforma blockchain de c√≥digo abierto de la Fundaci√≥n Linux. Con √©l, puede crear aplicaciones blockchain y controlar el ac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Implemente Hyperledger Fabric 1.4 en AWS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabric es una plataforma blockchain de c√≥digo abierto de la Fundaci√≥n Linux. Con √©l, puede crear aplicaciones blockchain y controlar el acceso y los permisos para los datos en blockchain. Se debe usar Hyperledger Fabric si desea crear una red privada de blockchain o establecer restricciones sobre qu√© transacciones puede ver cada lado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la documentaci√≥n de Hyperledger Fabric, la creaci√≥n de una red blockchain en una m√°quina con Docker est√° bien planificada, donde cada miembro de la red es un contenedor separado. Pero no se describe el proceso de configuraci√≥n de una red en varias m√°quinas f√≠sicas o virtuales. Esto se discutir√° en este art√≠culo.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra aplicaci√≥n blockchain es un servicio para almacenar algunos datos m√©dicos de ni√±os en edad escolar y preescolar. </font><font style="vertical-align: inherit;">Los datos deben estar sin cambios. </font><font style="vertical-align: inherit;">Se presentar√°n en forma de informaci√≥n sobre la vacunaci√≥n y el acuerdo del paciente con un m√©dico en particular. </font><font style="vertical-align: inherit;">La red incluir√° miembros de Parents (una organizaci√≥n que representa los intereses de los padres), Hospital (un hospital con cuyos pediatras los padres pueden llegar a un acuerdo para cuidar a sus hijos) y Kindergarten (un jard√≠n de infantes que puede solicitar informes de salud y vacunas para u otro ni√±o en el hospital).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blockchain administrado por Amazon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS tiene un servicio Amazon Managed Blockchain. </font><font style="vertical-align: inherit;">Le permite implementar redes blockchain usando las interfaces de usuario de la consola de AWS. </font><font style="vertical-align: inherit;">Pero, despu√©s de ganar algo de experiencia trabajando con Amazon Managed Blockchain, tuvimos que abandonar la idea de usar el servicio en proyectos comerciales. </font><font style="vertical-align: inherit;">Hubieron varias razones para esto. </font><font style="vertical-align: inherit;">Los principales son:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solo la versi√≥n de Hyperledger Fabric 1.2 estaba disponible en Amazon Managed Blockchain, y en el momento de escribir este art√≠culo, la versi√≥n 1.4 se usa para construir redes de blockchain empresariales. </font><font style="vertical-align: inherit;">Tampoco permite el uso de versiones modernas de las herramientas Node.js SDK;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Managed Blockchain no es compatible con la base de datos CouchDB, lo que dificulta la creaci√≥n de aplicaciones que indexen los datos almacenados.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, nuestra opini√≥n es que es mejor usar servidores virtuales o f√≠sicos para construir redes utilizando el marco Hyperledger Fabric.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acerca de los canales de aplicaciones</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabric tiene el concepto de "canal". </font><font style="vertical-align: inherit;">Un canal es una subred para realizar transacciones confidenciales. </font><font style="vertical-align: inherit;">Habr√° dos canales en nuestra aplicaci√≥n.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospital". </font><font style="vertical-align: inherit;">Est√° destinado a transacciones entre miembros de organizaciones de padres y hospitales: crear y modificar registros m√©dicos, crear un acuerdo con un pediatra y firmar un acuerdo de pediatra.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospitalkindergarten". </font><font style="vertical-align: inherit;">Dentro de este canal, los miembros de Parents and Hospital interactuar√°n con los miembros de Kindergarten. </font><font style="vertical-align: inherit;">Adem√°s, se generar√°n informes basados ‚Äã‚Äãen datos de registros m√©dicos.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ambiente de trabajo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementaremos nuestra red blockchain usando Docker Swarm: este es el sistema nativo de Docker para implementar un cl√∫ster de host. Si nunca ha trabajado con Docker (y especialmente con Docker Swarm), primero consulte este producto y c√≥mo orquestar los contenedores con Docker Swarm. La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentaci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> describe bien los conceptos b√°sicos para trabajar con estas herramientas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toda nuestra red estar√° ubicada en servidores AWS EC2. </font><font style="vertical-align: inherit;">La informaci√≥n dentro de la red blockchain se almacenar√° en CouchDB. </font><font style="vertical-align: inherit;">Hyperledger Fabric tambi√©n es compatible con la base de datos LevelDB, pero CouchDB, a diferencia de esta √∫ltima, permite buscar por cualquier criterio en una colecci√≥n de documentos. </font><font style="vertical-align: inherit;">Tambi√©n usaremos Fabric Certificate Authority: este es un componente modular para administrar identificadores de red de todas las organizaciones y sus usuarios. </font><font style="vertical-align: inherit;">Proporciona el registro de los participantes de la red y la emisi√≥n de certificados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendremos cuatro servidores EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orderer, MySQL DB (para almacenar informaci√≥n de la aplicaci√≥n que no se aplica a los registros m√©dicos)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organizaci√≥n de padres (Peer0, Peer1), CouchDB, Fabric-CA, CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organizaci√≥n del hospital (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organizaci√≥n de jard√≠n de infantes (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creaci√≥n de servidores EC2 en AWS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos los servicios de t2.medium para trabajar. </font><font style="vertical-align: inherit;">Este tipo de servidor EC2 tiene suficiente potencia inform√°tica para instalar todo el software necesario y trabajar con la herramienta Hyperledger Fabric. </font><font style="vertical-align: inherit;">En Configurar grupo de seguridad, configure Todo el tr√°fico y Origen - 0.0.0.0/0, :: / 0. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 1. </font><font style="vertical-align: inherit;">Configure el grupo de seguridad en el panel de AWS. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenemos cuatro servidores EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, tendr√° sus propias rutas a los servidores EC2. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2. </font><font style="vertical-align: inherit;">Preparado para la operaci√≥n de servidores EC2.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalaci√≥n de software de requisitos previos en servidores EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora en cada servidor EC2 necesitamos instalar Docker y Git. </font><font style="vertical-align: inherit;">Para mayor comodidad, abra cuatro pesta√±as en la terminal. </font><font style="vertical-align: inherit;">Vayamos a cada servicio EC2 a trav√©s de SSH: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 1:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 2:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 3:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 4:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cada terminal, ejecute los siguientes comandos:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora tenemos instalado Docker y Git.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos clonar elementos de nuestra red desde el repositorio. </font><font style="vertical-align: inherit;">Para hacer esto, ejecute el comando en cada terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n necesitamos clonar contratos inteligentes desde el repositorio que regular√° las relaciones entre los participantes de la red. </font><font style="vertical-align: inherit;">Los contratos inteligentes est√°n escritos en el idioma Golang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Realizamos estos pasos en cada uno de los cuatro servidores:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el primer terminal, necesitamos generar archivos de configuraci√≥n de canales y certificados para conectar organizaciones a la red:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora copie los artefactos de canal y las carpetas de configuraci√≥n de cifrado a los otros tres hosts en la carpeta de red de poc del directorio principal de la red. </font><font style="vertical-align: inherit;">Tenga en cuenta: al copiar organizaciones al servidor EC2, debe eliminar los certificados de terceros de la carpeta crypto-config / peerOrganizations que se relacionan con el trabajo de otras organizaciones. </font><font style="vertical-align: inherit;">Por ejemplo, al copiar en el host Parents, debemos dejar la carpeta parents.poc-network.com en esta carpeta, pero eliminar hospital.poc-network.com y kindergarten.poc-network.com.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear una pila de enjambre Docker</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que los contenedores que pertenecen a diferentes organizaciones y est√©n ubicados en diferentes servidores EC2 puedan acceder entre s√≠, debemos combinarlos en una pila. </font><font style="vertical-align: inherit;">Echemos un vistazo a nuestra red de archivos / poc-network / docker-compose-general.yaml. </font><font style="vertical-align: inherit;">Contiene la configuraci√≥n de servicios, indica en qu√© hosts se implementar√° un servicio (clave </font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) en </font><font style="vertical-align: inherit;">particular, se indican los </font><font style="vertical-align: inherit;">alias (clave </font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos inicializar enjambre en la primera terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparecer√° un token para conectar otro servidor EC2 a la pila. </font><font style="vertical-align: inherit;">Algo as√≠ como: </font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora podemos ejecutar en los terminales restantes:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparece un mensaje en la consola:</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de que los tres hosts est√©n conectados a Swarm, podemos verlos en la terminal del primer host ejecutando el comando:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3. </font><font style="vertical-align: inherit;">Lista de servidores en Docker Swarm. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la carpeta network / poc-network hay un archivo .env.template en el que debe especificar un nombre de host para cada uno de los hosts: </font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para generar un archivo .env, debe ejecutar el archivo ./3_env_gen.sh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora cree una red con un controlador </font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute Swarm para crear una pila basada en el archivo docker-compose-general.yaml:</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con este comando, tambi√©n establecemos variables de entorno, que se describen en el archivo .env y que son necesarias para que la red funcione correctamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede ejecutar el comando </font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la primera terminal. </font><font style="vertical-align: inherit;">Ver√° una lista de todos los servicios que se ejecutan en todas nuestras instancias EC2.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.4. </font><font style="vertical-align: inherit;">Lista de todos los servicios que se estaban ejecutando en todos los servidores EC2. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si ve lo mismo en su terminal que en la captura de pantalla, entonces todo est√° bien. </font><font style="vertical-align: inherit;">Ahora ejecuta nuestra red. </font><font style="vertical-align: inherit;">En la segunda terminal, debe ingresar el contenedor CLI (despu√©s de todo, este contenedor se implementa en el segundo host):</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El nombre del contenedor se puede ver ejecutando el comando en la terminal </font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el contenedor, ejecutamos todos nuestros comandos desde el archivo 4_create_channels.sh, copi√°ndolos uno por uno en el terminal. </font><font style="vertical-align: inherit;">En la carpeta bin, tenemos los binarios para crear la red:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canal de pares crear - crear canales;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uni√≥n de canal de igual: unir un igual a un canal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actualizaci√≥n de canal par: configuraciones de actualizaci√≥n;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instalaci√≥n de chaincode por pares: instale el c√≥digo de c√≥digo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instancia de chaincode de igual: despliega el c√≥digo de cadena especificado en la red.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora puede salir del contenedor ejecutando el comando </font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitud de Padres</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale la aplicaci√≥n en el segundo host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n necesitamos instalar NodeJS y gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n podemos ingresar a nuestra base de datos a trav√©s del administrador con los siguientes datos de autorizaci√≥n: </font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(donde </font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° la direcci√≥n del primer servidor EC2 en el que se almacena la base de datos) </font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n es necesario conectar nuestra aplicaci√≥n API a la base de datos:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Asigne el valor correcto a la clave </font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nuestra aplicaci√≥n posterior ha preparado migraciones y semillas. </font><font style="vertical-align: inherit;">Necesitas ejecutarlos:</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las tablas deben aparecer en la base de datos. </font><font style="vertical-align: inherit;">Y en la tabla de organizaciones veremos tres filas con nuestras organizaciones: padres, hospital, jard√≠n de infantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al generar certificados desde el principio, recibimos archivos para conectarnos a la red para cada organizaci√≥n en el primer host. </font><font style="vertical-align: inherit;">Copie el archivo connection-parents.json del primer host al segundo. </font><font style="vertical-align: inherit;">Para hacer esto, abra otra terminal desde la carpeta donde </font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se encuentra la </font><font style="vertical-align: inherit;">nuestra </font><font style="vertical-align: inherit;">y ejecute los comandos:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arreglo </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en constants.js (valor para el host actual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute nuestra aplicaci√≥n en la segunda terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el archivo userGenerator.sh, asigne el </font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correcto a la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debe ejecutar el script que crear√° los usuarios de la organizaci√≥n Parents:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute el script para generar registros m√©dicos:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se crear√°n dos tarjetas en la cadena de bloques, que tambi√©n se escribir√°n en la base de datos SQL en la tabla de tarjetas.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitud de espalda hospitalaria</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por analog√≠a con la aplicaci√≥n anterior, necesitamos colocar el archivo para conectarnos a la red en el tercer host. </font><font style="vertical-align: inherit;">Para hacer esto, en la quinta terminal, ejecute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos a clonar nuestra aplicaci√≥n al tercer host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale NodeJS y gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arreglo </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en constants.js (valor para el host actual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute nuestra aplicaci√≥n en el tercer terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el archivo userGenerator.sh, asigne el </font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correcto a la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, necesitamos ejecutar un script que crear√° usuarios de la organizaci√≥n del Hospital:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora tenemos un segundo usuario en la tabla Usuarios en la base de datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitud de espalda para kinder</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por analog√≠a con la aplicaci√≥n anterior, necesitamos colocar el archivo para conectarnos a la red en el tercer host. </font><font style="vertical-align: inherit;">Para hacer esto, en la quinta terminal, ejecute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos a clonar nuestra aplicaci√≥n al tercer host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale NodeJS y Gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arreglo </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en constants.js (valor para el host actual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute nuestra aplicaci√≥n en el tercer terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el archivo userGenerator.sh, asigne el </font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correcto a la </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, necesitamos ejecutar un script que crear√° usuarios de la organizaci√≥n del Hospital:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora tenemos un tercer usuario en la tabla Usuarios en la base de datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instale wkhtmltopdf en el segundo, tercer y cuarto servidor EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La aplicaci√≥n posterior utiliza la biblioteca wkhtmltopdf para generar un informe en PDF sobre el estado de salud del ni√±o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos instalar libpng, la biblioteca oficial para trabajar con gr√°ficos r√°ster en formato PNG. </font><font style="vertical-align: inherit;">La biblioteca es independiente de la plataforma y consta de funciones escritas en lenguaje C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primer equipo instalar√° wkhtmltox, la biblioteca LGPLv3 de c√≥digo abierto para renderizar HTML a PDF y varios formatos de imagen utilizando el motor de renderizaci√≥n QtWebKit:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo bloque de comandos descargar√° e implementar√° la biblioteca libpng15:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se necesita el tercer bloque de comandos para instalar el compilador:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A√∫n necesita instalar LibTIFF:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos probar:</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora puede generar y ver documentos PDF.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un poco sobre Node SDK</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las herramientas NodeJS para trabajar con la red Hyperledger Fabric se presentan en forma de paquetes "fabric-ca-client -v 1.4.0" y "fabric-network" v 1.4.0 ". </font><font style="vertical-align: inherit;">Todos los servicios de la aplicaci√≥n de fondo que interact√∫an con la red utilizando el SDK de nodo se encuentran en la carpeta Servicios, en la ra√≠z del proyecto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede leer sobre estas herramientas y sus m√©todos en la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentaci√≥n oficial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procesos empresariales de aplicaci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora hablaremos sobre c√≥mo los miembros de la red interact√∫an entre s√≠ en esta aplicaci√≥n. </font><font style="vertical-align: inherit;">Todos los procesos se describen en un diagrama UML. </font><font style="vertical-align: inherit;">Consideremos cada uno de ellos con m√°s detalle.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.5. Una descripci√≥n gr√°fica de los procesos de negocio en la aplicaci√≥n.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Por lo tanto, hay varias organizaciones en la red: padres, hospital y jard√≠n de infantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un miembro de Parents crea registros de salud electr√≥nicos para dos de sus hijos. Estos datos se almacenar√°n (y complementar√°n) en la red blockchain. Luego, el padre env√≠a una solicitud de acuerdo con el pediatra, quien observar√° a sus hijos hasta que lleguen a la edad adulta (en el diagrama, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicite un acuerdo con un m√©dico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un miembro de la organizaci√≥n del hospital firma un acuerdo (en el diagrama, el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©dico firma un acuerdo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, el padre env√≠a una solicitud al jard√≠n de infantes con una solicitud para inscribir a su hijo (en el diagrama: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicitud de que el jard√≠n de infantes reciba un hijo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.6. </font><font style="vertical-align: inherit;">Una p√°gina con una lista de instituciones educativas disponibles en la cuenta de los padres. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kindergarten ve la solicitud en la lista de solicitudes nuevas:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.7. </font><font style="vertical-align: inherit;">Una p√°gina con una lista de solicitudes de admisi√≥n a la cuenta personal de la instituci√≥n educativa. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kindergarten antes de decidir sobre la admisi√≥n del ni√±o debe asegurarse de que su estado de salud sea satisfactorio. </font><font style="vertical-align: inherit;">Para hacer esto, el jard√≠n de infantes env√≠a una solicitud a la cl√≠nica en la que se observa a este ni√±o (en el diagrama: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicitud de informe de salud infantil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">La solicitud al pediatra se ejecuta autom√°ticamente despu√©s de que la solicitud de admisi√≥n al jard√≠n se mueve a la pesta√±a "Aceptada".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.8. </font><font style="vertical-align: inherit;">Una p√°gina con una lista de solicitudes aprobadas para la admisi√≥n a la cuenta personal de la instituci√≥n educativa. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El pediatra ve la solicitud y genera un informe que contiene datos sobre la salud del ni√±o (en el diagrama: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crear informe de salud infantil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.9. </font><font style="vertical-align: inherit;">Una p√°gina con una lista de aplicaciones para crear un informe sobre el estado de salud del ni√±o en la cuenta personal del hospital. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El padre ve que el pediatra ha generado un informe:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.10. </font><font style="vertical-align: inherit;">Una p√°gina en la cuenta personal del padre, que muestra el estado de los informes sobre el estado de salud del ni√±o. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... y toma la decisi√≥n de otorgar acceso a la instituci√≥n educativa preescolar para ver y descargar el informe (en el diagrama, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otorgue permiso para ver el informe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.11. </font><font style="vertical-align: inherit;">Una ventana emergente para elegir una instituci√≥n educativa que pueda ver el informe m√©dico generado. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los padres hacen clic en "Confirmar":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 12. </font><font style="vertical-align: inherit;">Notificaci√≥n de que la instituci√≥n educativa seleccionada ha recibido permiso para ver el informe m√©dico. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la lista de informes en la solicitud de la instituci√≥n educativa, aparece informaci√≥n de que el informe se ha generado y est√° disponible para verlo y descargarlo en formato PDF.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.13. </font><font style="vertical-align: inherit;">Enlace para descargar el informe en formato PDF en la l√≠nea con la solicitud aprobada. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay un informe que ver√° en una nueva pesta√±a en su computadora:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.14. </font><font style="vertical-align: inherit;">Un informe de salud generado por un empleado del hospital.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear registros m√©dicos y acuerdos con un pediatra, firmar un acuerdo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que la aplicaci√≥n est√° dise√±ada m√°s para demostrar el despliegue de la red en servidores EC2 separados, ejecutaremos algunos comandos de los scripts preparados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primer servidor EC2:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos hemos conectado previamente a la base de datos. </font><font style="vertical-align: inherit;">Despu√©s de ejecutar el comando, ver√° dos entradas en la tabla Tarjetas. </font><font style="vertical-align: inherit;">Adem√°s, la informaci√≥n sobre los datos m√©dicos de estos dos ni√±os se registr√≥ en la cadena de bloques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde este servidor EC2 necesitamos crear un acuerdo con un pediatra que observar√° a los ni√±os:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora este acuerdo debe ser firmado por el usuario que creamos para la organizaci√≥n Hospital. </font><font style="vertical-align: inherit;">Ejecutamos el comando desde el segundo host:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestro acuerdo est√° firmado por el m√©dico y podemos seguir trabajando en nuestra solicitud. </font><font style="vertical-align: inherit;">Luego, necesitamos instalar la aplicaci√≥n frontend en los servidores EC2 segundo, tercero y cuarto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PD: Puede encontrar todos los comandos para generar usuarios, tarjetas, acuerdos y acuerdos de firma en la carpeta ~ / back / generators.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitud Frontend de Padres</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute en el segundo host (donde se encuentra la organizaci√≥n de Padres):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creamos el archivo .env y especificamos el nombre de host en el que se ubicar√° nuestra aplicaci√≥n de interfaz:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es necesario establecer las dependencias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debe compilar la aplicaci√≥n y ejecutarla en el puerto 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra aplicaci√≥n estar√° disponible en: </font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√≥nde </font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° la direcci√≥n del segundo servidor EC2 en el que se encuentra nuestra aplicaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usuario: </font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrase√±a: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As√≠ es como se ver√° la interfaz. </font><font style="vertical-align: inherit;">Aqu√≠ ver√° informaci√≥n sobre las tarjetas m√©dicas que creamos desde la terminal:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.15. </font><font style="vertical-align: inherit;">Informaci√≥n sobre los registros m√©dicos de los ni√±os en la cuenta personal de los padres.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitud de hospital frontend</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute en el segundo host (donde se encuentra la organizaci√≥n del Hospital):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creamos el archivo .env y especificamos el nombre de host en el que se ubicar√° nuestra aplicaci√≥n de interfaz:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es necesario establecer las dependencias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debe compilar la aplicaci√≥n y ejecutarla en el puerto 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra aplicaci√≥n estar√° disponible en: </font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√≥nde </font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° la direcci√≥n del tercer servidor EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usuario: </font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrase√±a: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicaci√≥n de interfaz de jard√≠n de infantes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecutar en el segundo host (donde se encuentra la organizaci√≥n de Kindergarten):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creamos el archivo .env y especificamos el nombre de host en el que se ubicar√° nuestra aplicaci√≥n de interfaz:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es necesario establecer las dependencias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debe compilar la aplicaci√≥n y ejecutarla en el puerto 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra aplicaci√≥n estar√° disponible en: </font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde </font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° la direcci√≥n del cuarto servidor EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usuario: </font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrase√±a: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinamos c√≥mo implementar una red de aplicaciones blockchain en varios servidores virtuales o f√≠sicos. </font><font style="vertical-align: inherit;">El art√≠culo est√° dise√±ado para familiarizarlo con los conceptos b√°sicos de la tecnolog√≠a blockchain, saber qu√© son los contratos inteligentes y, al menos, familiarizarse superficialmente con el marco Hyperledger Fabric y su aplicaci√≥n est√°ndar de muestras de tela.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499202/index.html">Opium.Fill: estandarizaci√≥n del esquema de color a trav√©s de los ojos del programador.</a></li>
<li><a href="../es499206/index.html">Asistentes virtuales. Crear chatbots sin programar</a></li>
<li><a href="../es499208/index.html">Eventos digitales en Mosc√∫ del 27 de abril al 3 de mayo</a></li>
<li><a href="../es499210/index.html">Eventos digitales en San Petersburgo del 27 de abril al 3 de mayo</a></li>
<li><a href="../es499212/index.html">Seminarios semanales de IBM - abril de 2020</a></li>
<li><a href="../es499216/index.html">Dise√±o a nivel de sistema. Parte 2. Arquitectura detallada</a></li>
<li><a href="../es499220/index.html">La transferencia de desarrolladores a un sitio remoto debido al coronavirus aument√≥ la productividad en Google y Microsoft</a></li>
<li><a href="../es499224/index.html">Es hora de comenzar a aprender bien</a></li>
<li><a href="../es499226/index.html">Sin pandemia: c√≥mo hacer una pel√≠cula sobre criptomonedas por $ 1000 y entrar en la distribuci√≥n de pel√≠culas m√°s importante de EE. UU.</a></li>
<li><a href="../es499230/index.html">C√≥mo criar un gusano sano y contento: analizando el manual de 1910</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>