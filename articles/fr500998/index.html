<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà∑Ô∏è üöÜ üåü R√©seau de neurones convolutifs et son int√©gration dans iOS (partie 1) üèïÔ∏è üòó üë©‚Äçüë©‚Äçüëß‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Moyens de mise en ≈ìuvre.
 
 Divers algorithmes d'apprentissage automatique sont int√©gr√©s dans de nombreux langages de programmation de haut niveau. Le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>R√©seau de neurones convolutifs et son int√©gration dans iOS (partie 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500998/"><img src="https://habrastorage.org/webt/ob/i9/sq/obi9sqkryjcwn5txcjgdvc0fcoi.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moyens de mise en ≈ìuvre.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Divers algorithmes d'apprentissage automatique sont int√©gr√©s dans de nombreux langages de programmation de haut niveau. Le plus populaire et le plus rapide d'entre eux est Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow est une biblioth√®que logicielle ouverte pour l'apprentissage automatique d√©velopp√©e par Google pour r√©soudre les probl√®mes de construction et de formation d'un r√©seau de neurones afin de trouver et classer automatiquement des images, atteignant la qualit√© de la perception humaine. L'API principale pour travailler avec la biblioth√®que est impl√©ment√©e pour Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keras est une biblioth√®que de r√©seau de neurones ouverte. Il s'agit d'un module compl√©mentaire pour les frameworks TensorFlow et Theano. Il vise un travail op√©rationnel avec des r√©seaux d'apprentissage en profondeur, tout en √©tant con√ßu pour √™tre compact, modulaire et extensible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La derni√®re version de Python 3.7.2 est s√©lectionn√©e comme interpr√®te. L'environnement de d√©veloppement est PyCharm Community. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©paration des donn√©es.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dans le monde moderne, pour la plupart des t√¢ches d'IA, il n'est pas n√©cessaire de collecter l'ensemble de donn√©es manuellement, il existe de nombreuses ressources o√π, apr√®s l'enregistrement, il est possible de t√©l√©charger des ensembles de donn√©es pr√™ts √† l'emploi. Un ensemble de donn√©es √† dix chiffres en langue des signes a √©t√© s√©lectionn√© (Fig. 1). </font></font><br>
<img src="https://habrastorage.org/webt/_-/wd/e7/_-wde7b_bdaeuj-ge5tk6fkymxi.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig. 1. - Num√©ros en langue des signes.</font></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'algorithme devra d√©tecter la pr√©sence d'un geste sur la photo et la classer avec un nombre de 0 √† 9. Avant de construire l'architecture du r√©seau neuronal, vous devez pr√©parer des donn√©es pour sa formation. Tout d'abord, les donn√©es du jeu de donn√©es des chiffres en langue des signes sont t√©l√©charg√©es. Le premier fichier contient 2063 images en noir et blanc avec des nombres en langue des signes. Les images ont une taille de 64x64 pixels. Le deuxi√®me fichier contient une √©tiquette (vecteur) correspondant √† l'image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les valeurs des pixels dans les images sont normalis√©es et sont dans l'intervalle (0,1). Vous pouvez les utiliser imm√©diatement pour entrer dans le r√©seau neuronal, mais le r√©sultat le plus optimal sera atteint si vous suivez la proc√©dure de normalisation. Apr√®s son ex√©cution, les r√®gles seront satisfaites pour chaque matrice de pixels: La </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
valeur moyenne dans la matrice est nulle </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 La dispersion dans la matrice est l'unit√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les photos sont standardis√©es et ajout√©es √† un nouveau tableau pour leur combinaison ult√©rieure avec les donn√©es pr√©c√©dentes ( </font></font><br>
<img src="https://habrastorage.org/webt/ad/m6/wd/adm6wdbpvyip5kyp_4glxau1j50.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig.2 </font><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Fig.2. - La proc√©dure de chargement et de traitement des images. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture de r√©seau neuronal.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Network_sign_lang.py - le fichier de projet principal dans lequel le r√©seau neuronal est d√©crit. Au d√©but du script, plusieurs variables globales du r√©seau neuronal sont d√©crites (Fig. 3). </font></font><br>
<img src="https://habrastorage.org/webt/ug/wo/ll/ugwollmtjdgakxjrkjaycuq7bog.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig.3. - Options globales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Batch_size - le nombre d'images introduites dans le r√©seau neuronal pour chaque it√©ration. Num_classes - le nombre de classes que le mod√®le pr√©dira. Img_size - la taille des images fournies √† la couche d'entr√©e.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction train_test_split () de la biblioth√®que Sklearn est import√©e dans le projet, elle divise les tableaux X et y dans le rapport 80:20 en √©chantillons d'apprentissage et de test, et m√©lange √©galement de mani√®re al√©atoire les donn√©es afin qu'elles ne soient pas tri√©es par classe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le mod√®le est initialis√© (Fig. 4), la premi√®re couche de Conv2D est ajout√©e. Les images de la matrice Xtrain sont entr√©es, la dimension de l'espace de sortie est indiqu√©e - 64, le noyau de convolution - 4x4, l'√©tape de convolution et la fonction d'activation de la couche ReLU. </font></font><br>
<img src="https://habrastorage.org/webt/7z/3p/jw/7z3pjw8oimjgvt7n4nde4jgivao.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig.4. - R√©seau neuronal</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que les r√©seaux de neurones utilisent g√©n√©ralement un nombre beaucoup plus grand de donn√©es d'entra√Ænement, le mod√®le construit est susceptible de se recycler. Pour √©viter cela, une m√©thode de r√©gularisation efficace, telle que Dropout, est utilis√©e. Cette couche exclura le pourcentage indiqu√© de neurones al√©atoires afin qu'il n'y ait pas de surabondance entre les couches. Le nombre 0,5 signifie que sur chaque lot, l'algorithme exclura la moiti√© des neurones al√©atoires. La deuxi√®me couche principale est √©galement similaire √† la premi√®re - convolutionnelle. (Conv2D) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La suivante est la couche de mise en commun (MaxPooling2D). Il sert de filtre suppl√©mentaire pour la sortie du mod√®le. √âtant donn√© que lors de l'affichage horizontal ou vertical des nombres, la signification de l'image ne change pas, le r√©seau de neurones doit les classer √©galement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La couche aplatie sert de lien entre les donn√©es obtenues par l'algorithme et le vecteur de sortie avec la pr√©diction. La derni√®re couche du r√©seau est la couche dense avec fonction d'activation sofmax. Cette fonction vous permet d'obtenir un vecteur de probabilit√©s normalis√© pour chaque classe, o√π la somme des probabilit√©s sera √©gale √† un.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez compiler le mod√®le cr√©√© en sp√©cifiant les param√®tres suivants: m√©trique, fonction de perte et optimiseur. En tant que m√©trique, la pr√©cision est choisie - le pourcentage d'exemples correctement class√©s. La fonction de perte est categorical_crossentropy. Algorithme d'optimisation - Adam. Avant de commencer la formation, plusieurs rappels sont ajout√©s. EarlyStopping - arr√™te l'apprentissage du r√©seau neuronal lorsque sa pr√©cision cesse d'augmenter avec les √©poques d'apprentissage. ModelCheckpoint - enregistre les meilleurs poids de mod√®le dans un fichier pour une utilisation ult√©rieure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La formation du r√©seau neuronal commence par la sauvegarde des donn√©es sur son processus dans la variable historique. Validation_split - Utilise dix pour cent des donn√©es de formation pour la validation, ce qui est une autre fa√ßon de r√©gulariser.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La taille de l'√©chantillon de formation est de 1965 exemples, l'√©chantillon de test est de 547 et l'√©chantillon de validation est de 219. Apr√®s l'ach√®vement du processus de formation, un graphique de la d√©pendance de la pr√©cision obtenue sur les donn√©es de formation et de test est construit (figure 5). </font></font><br>
<img src="https://habrastorage.org/webt/ip/fj/0t/ipfj0t4yibt6ogcdlddvuuqbksu.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig.5. - L'horaire d'entra√Ænement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le graphique montre que le mod√®le a √©t√© enregistr√© √† la 15e √©poque (avec la plus grande pr√©cision et le plus petit √©cart entre Xtrain et Xtest). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©tape suivante consiste √† charger les r√©seaux de neurones r√©sultants dans un autre script pour v√©rifier leur fonctionnement. Les valeurs des m√©triques sur les donn√©es de test sont affich√©es (Fig. 6). </font></font><br>
<img src="https://habrastorage.org/webt/yy/gk/pw/yygkpwatefnnhsps263xk54futk.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig.6. - V√©rification des performances du mod√®le.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base des r√©sultats des m√©triques, nous pouvons conclure que les mod√®les ne diff√®rent pas beaucoup. </font><font style="vertical-align: inherit;">Plus l'indice de fonction de perte est faible, plus les pr√©dictions de l'algorithme sont fiables. </font><font style="vertical-align: inherit;">La pr√©cision ou la fid√©lit√© du mod√®le montre le pourcentage de photos correctement class√©es, ce qui signifie que plus il est √©lev√©, meilleur est le r√©seau neuronal. </font><font style="vertical-align: inherit;">Par cons√©quent, il est plus logique d'utiliser le premier mod√®le obtenu √† la suite d'un arr√™t pr√©coce de l'√©ducation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous parlerons du pr√©traitement des donn√©es et de l'int√©gration d'un r√©seau neuronal d'un certain format dans une application iOS dans la prochaine partie.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500984/index.html">Bad Apple ou Happy Radio Day, geeks</a></li>
<li><a href="../fr500986/index.html">Surveillance dans le centre de donn√©es: comment nous avons chang√© l'ancien BMS en un nouveau. 3e partie</a></li>
<li><a href="../fr500992/index.html">Comment est la gestion de la performance dans les meilleures entreprises informatiques</a></li>
<li><a href="../fr500994/index.html">Ex√©cutez la fourmi. Courir</a></li>
<li><a href="../fr500996/index.html">Comment devenir ing√©nieur DevOps en six mois ou plus vite. Partie 1. Introduction</a></li>
<li><a href="../fr501000/index.html">G√©n√©ration de code dans Go par l'exemple de la cr√©ation d'un client pour la base de donn√©es</a></li>
<li><a href="../fr501002/index.html">Umka: nouveau langage de script typ√© statiquement</a></li>
<li><a href="../fr501004/index.html">Fais le. Travail</a></li>
<li><a href="../fr501006/index.html">Nous sommes amis STM32 avec √©cran LCD 1604 sur bus I2C (biblioth√®que HAL)</a></li>
<li><a href="../fr501008/index.html">Pavage Dominos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>