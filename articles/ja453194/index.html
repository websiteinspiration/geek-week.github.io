<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎍 🚶🏿 🧒🏼 PHDays 9でBest Reverser問題を解決します 🐠 💬 🍐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは！
 
 私の名前はマラットガヤノフです。このケースのkeygenの作り方を示すために、ベストリバースコンテストの問題に対する私の解決策を皆さんと共有したいと思います。
 
 
 説明
 このコンテストでは、参加者にはSega Mega Drive（best_reverser_phd9_r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PHDays 9でBest Reverser問題を解決します</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453194/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の名前はマラットガヤノフです</font><font style="vertical-align: inherit;">。このケースのkeygenの作り方を示すために</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベストリバースコンテストの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題に対する私の解決策を皆さんと共有したいと思います</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rp/ja/bo/rpjabo27x0oemehl_380bdoiyto.png" alt="画像"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコンテストでは、参加者にはSega Mega Drive（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">best_reverser_phd9_rom_v4.bin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">ROMゲームが提供され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスク：参加者のメールアドレスと一緒に有効であると認識されるようなキーを取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だからソリューション...</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツール</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDA Pro 6.8 </font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Smd_ida_toolsプラグイン</font></font></a></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーの長さの確認</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムはすべてのキーを受け入れるわけではありません。フィールド全体に入力する必要があります。これらは16文字です。</font><font style="vertical-align: inherit;">キーが短い場合は、次のようなメッセージが表示されます。</font><font style="vertical-align: inherit;">再試行 ... "。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムでこの行を見つけてみましょう。バイナリ検索（Alt-B）を使用します。</font><font style="vertical-align: inherit;">何を見つけますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これだけでなく、近くの他のサービスラインも見つかります。</font><font style="vertical-align: inherit;">もう一度お試しください...「そして「あなたは最高のリバーサーです！」</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/-b/ru/fb/-brufb6jqqrejxctfwwvrp8l0xu.png" alt="画像"></div><br>
<div style="text-align:center;"><img src="https://hsto.org/webt/6y/6m/jb/6y6mjbg8kod7ys087rlbngrshky.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ショートカット</font></font><code>WRONG_LENGTH_MSG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>YOU_ARE_THE_BEST_MSG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>WRONG_KEY_MSG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">便利に設定しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アドレスを読むための休憩を設定します</font></font><code>0x0000FDFA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-「間違った長さ！</font><font style="vertical-align: inherit;">再試行 ... "。</font><font style="vertical-align: inherit;">デバッガーを実行します（キーを入力する前に数回停止します。停止するたびにF9キーを押すだけです）。</font><font style="vertical-align: inherit;">メールアドレスを入力してください</font></font><code>ABCD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバッガーの結果は</font></font><code>0x00006FF0 tst.b (a1)+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のとおりです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jq/h5/mf/jqh5mfieh1st-s6fktdghtomemy.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブロック自体には何も興味深いものはありません。</font><font style="vertical-align: inherit;">ここで誰がコントロールを移すかは、はるかに興味深いです。</font><font style="vertical-align: inherit;">コールスタックを確認します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/w4/sa/1p/w4sa1p9_t4czdofd4jjj-tdtg4q.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリックしてここにアクセス-指示に従って</font></font><code>0x00001D2A jsr (sub_6FC0).l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/1d/bp/xy/1dbpxyojlaks20xlmgivzm0rpdw.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考えられるすべてのメッセージが1か所で見つかったことがわかります。</font><font style="vertical-align: inherit;">しかし、制御がブロックからどこに転送されるかを調べてみましょう</font></font><code>WRONG_KEY_LEN_CASE_1D1C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ブレークを設定するのではなく、ブロックに移動する矢印の上にカーソルを移動します。</font><font style="vertical-align: inherit;">発信者は次のアドレスにあります</font></font><code>0x000017DE loc_17DE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（名前をに変更します</font></font><code>CHECK_KEY_LEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/bo/c1/tc/boc1tck7dpjuq46sppgq93wghfu.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アドレスにブレークを入れ</font></font><code>0x000017EC cmpi.b 0x20 (a0, d0.l)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（このコンテキストの命令は、キー文字の配列の最後に空の文字があるかどうかを確認します）、再起動し、メールとキーを再入力します</font></font><code>ABCD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">デバッガーが停止し、アドレス</font></font><code>0x00FF01C7</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（その時点でレジスターに格納されている</font></font><code>a0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に入力</font><font style="vertical-align: inherit;">され</font><font style="vertical-align: inherit;">たキーが表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/qs/l9/k4/qsl9k4apyhz2orh5lz9vphf-gdo.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは良い発見です。それを通して、私たちはすべてを手に入れます。</font><font style="vertical-align: inherit;">ただし、最初に、便宜上、キーのバイトをマークアップします。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/on/kw/c8/onkwc8dvpch6ckyjbcl0a-9zx4q.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場所から上にスクロールすると、メールがキーの横に保存されていることがわかります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/at/_t/_j/at_t_jhxaruncxgntbn-i5t396o.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはどんどん深く潜っていきます。そして、鍵の正しさの基準を見つける時が来ました。</font><font style="vertical-align: inherit;">むしろ、鍵の前半。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鍵の前半の正しさの基準</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予備計算</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長さをチェックした直後に、キーを使用した他の操作が続くと想定するのは論理的です。</font><font style="vertical-align: inherit;">チェック直後のブロックについて考えてみましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/g4/oy/w6/g4oyw6inctcnokzxmo1r5kbfl9c.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このブロックは準備作業中です。関数</font></font><code>get_hash_2b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（元はでした</font></font><code>sub_1526</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）が2回呼び出されています。最初に、キーの最初のバイトのアドレス（レジスタ</font></font><code>a0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にはアドレスが含まれています</font></font><code>KEY_BYTE_0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">がキーに送信さ</font><font style="vertical-align: inherit;">れます</font><font style="vertical-align: inherit;">。2回目は5回目（</font></font><code>KEY_BYTE_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2バイトのハッシュのようなものを考慮しているため、このような名前を関数に付けました。これは私が選んだ最もわかりやすい名前です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数自体は考慮しませんが、すぐにPythonで記述します。彼女は簡単なことをしますが、スクリーンショット付きの彼女の説明は多くのスペースを占めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それについて言う最も重要なこと：入力アドレスは入力に供給され、作業はこのアドレスから4バイトで行われます。</font><font style="vertical-align: inherit;">つまり、キーの最初のバイトを入力に送信し、関数は1、2、3、4番目で機能します。</font><font style="vertical-align: inherit;">5番目に提出された関数は、5、6、7、8で機能します。</font><font style="vertical-align: inherit;">つまり、このブロックでは、キーの前半で計算が行われます。</font><font style="vertical-align: inherit;">結果はレジスタに書き込まれ</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、関数</font></font><code>get_hash_2b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># key_4s -   </span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_hash_2b</span>(<span class="hljs-params">key_4s</span>):</span>
	<span class="hljs-comment">#   </span>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span>(<span class="hljs-params">b</span>):</span><font></font>
<font></font>
		<span class="hljs-comment"># numbers -.</span>
		<span class="hljs-keyword">if</span> b &lt;= <span class="hljs-number">0x39</span>:<font></font>
			r = b - <span class="hljs-number">0x30</span>
		<span class="hljs-comment"># Letter case and @</span>
		<span class="hljs-keyword">else</span>:
			<span class="hljs-comment"># @ABCDEF</span>
			<span class="hljs-keyword">if</span> b &lt;= <span class="hljs-number">0x46</span>:<font></font>
				r = b - <span class="hljs-number">0x37</span>
			<span class="hljs-keyword">else</span>:
				<span class="hljs-comment"># WXYZ</span>
				<span class="hljs-keyword">if</span> b &gt;= <span class="hljs-number">0x57</span>:<font></font>
					r = b - <span class="hljs-number">0x57</span>
				<span class="hljs-comment"># GHIJKLMNOPQRSTUV</span>
				<span class="hljs-keyword">else</span>:<font></font>
					r = <span class="hljs-number">0xff</span> - (<span class="hljs-number">0x57</span> - b) + <span class="hljs-number">1</span>  <span class="hljs-comment"># a9+b</span><font></font>
<font></font>
		<span class="hljs-keyword">return</span> r<font></font>
<font></font>
	<span class="hljs-comment">#   </span>
	key_4b = bytearray(key_4s, encoding=<span class="hljs-string">"ascii"</span>)<font></font>
<font></font>
	<span class="hljs-comment">#    </span>
	codes = [transform(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> key_4b]<font></font>
<font></font>
	<span class="hljs-comment">#     </span>
	part0 = (codes[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xff</span>) &lt;&lt; <span class="hljs-number">0xc</span>
	part1 = (codes[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">0x8</span>) &amp; <span class="hljs-number">0xf00</span>
	part2 = (codes[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">0x4</span>) &amp; <span class="hljs-number">0xf0</span>
	hash_2b = (part0 | part1) &amp; <span class="hljs-number">0xffff</span>
	hash_2b = (hash_2b | part2) &amp; <span class="hljs-number">0xffff</span>
	hash_2b = (hash_2b | (codes[<span class="hljs-number">3</span>] &amp; <span class="hljs-number">0xf</span>))<font></font>
<font></font>
	<span class="hljs-keyword">return</span> hash_2b</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッシュデコード関数をすぐに記述します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    4- </span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode_hash_4s</span>(<span class="hljs-params">hash_2b</span>):</span><font></font>
<font></font>
	<span class="hljs-comment">#   </span>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span>(<span class="hljs-params">b</span>):</span>
		<span class="hljs-keyword">if</span> b &lt;= <span class="hljs-number">0x9</span>:
			<span class="hljs-keyword">return</span> b + <span class="hljs-number">0x30</span>
		<span class="hljs-keyword">if</span> b &lt;= <span class="hljs-number">0xF</span>:
			<span class="hljs-keyword">return</span> b + <span class="hljs-number">0x37</span>
		<span class="hljs-keyword">if</span> b &gt;= <span class="hljs-number">0x0</span>:
			<span class="hljs-keyword">return</span> b + <span class="hljs-number">0x57</span>
		<span class="hljs-keyword">return</span> b - <span class="hljs-number">0xa9</span><font></font>
<font></font>
	<span class="hljs-comment">#        </span>
	b0 = transform(hash_2b &gt;&gt; <span class="hljs-number">12</span>)<font></font>
	b1 = transform((hash_2b &amp; <span class="hljs-number">0xfff</span>) &gt;&gt; <span class="hljs-number">8</span>)<font></font>
	b2 = transform((hash_2b &amp; <span class="hljs-number">0xff</span>) &gt;&gt; <span class="hljs-number">4</span>)<font></font>
	b3 = transform(hash_2b &amp; <span class="hljs-number">0xf</span>)<font></font>
<font></font>
	<span class="hljs-comment"># </span><font></font>
	key_4s = [chr(b0), chr(b1), chr(b2), chr(b3)]<font></font>
	key_4s = <span class="hljs-string">""</span>.join(key_4s)<font></font>
<font></font>
	<span class="hljs-keyword">return</span> key_4s</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より優れたデコード機能は思いつきませんでしたが、完全に正しくはありません。</font><font style="vertical-align: inherit;">したがって、私はそれを次のようにチェックします（現在ではなく、かなり後で）。</font></font><br>
<br>
<pre><code class="python hljs">key_4s == decode_hash_4s(get_hash_2b(key_4s))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕事を確認してください</font></font><code>get_hash_2b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数が実行さ</font><font style="vertical-align: inherit;">れた</font><font style="vertical-align: inherit;">後の</font><font style="vertical-align: inherit;">レジスタの状態に興味があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">上の休憩を入れ</font></font><code>0x000017FE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>0x00001808</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーが入ります</font></font><code>ABCDEFGHIJKLMNOP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/x-/tu/mv/x-tumvz-5akeokp44a-wlclamuu.png" alt="画像"></div><br>
<div style="text-align:center;"><img src="https://hsto.org/webt/ft/gy/ke/ftgykerggzjdpvpseel8vm7vaji.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レジスタ</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、値</font></font><code>0xABCD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を入力しました</font></font><code>0xEF01</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、何を与えるの</font></font><code>get_hash_2b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でしょ</font><font style="vertical-align: inherit;">う</font><font style="vertical-align: inherit;">か？</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>first_hash = get_hash_2b(<span class="hljs-string">"ABCD"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>hex(first_hash)
<span class="hljs-number">0xabcd</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>second_hash = get_hash_2b(<span class="hljs-string">"EFGH"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>hex(second_hash)
<span class="hljs-number">0xef01</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検証に合格しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、それが行われ</font></font><code>xor eor.w d0, d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、結果が次の場所に記録され</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0xabcd</span> ^ <span class="hljs-number">0xef01</span>)
<span class="hljs-number">0x44cc</span></code></pre><br>
<div style="text-align:center;"><img src="https://hsto.org/webt/fa/6l/a0/fa6la0nx5iia9ldl24wgxibdwhy.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなハッシュの受信</font></font><code>0x44CC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、予備的な計算で構成されています。</font><font style="vertical-align: inherit;">さらに、すべてがより複雑になるだけです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュはどこへ行くのか</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムがハッシュをどのように処理するかがわからなければ、先に進むことはできません。</font><font style="vertical-align: inherit;">確かにそれは</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリ</font><font style="vertical-align: inherit;">から移動</font><font style="vertical-align: inherit;">します、なぜなら </font><font style="vertical-align: inherit;">レジスターはどこかで重宝します。</font><font style="vertical-align: inherit;">このようなイベントはトレース（watching </font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を介して見つけることができますが、</font><font style="vertical-align: inherit;">手動ではなく自動です。</font><font style="vertical-align: inherit;">次のスクリプトが役立ちます。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;idc.idc&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
	<span class="hljs-keyword">auto</span> d5_val;
	<span class="hljs-keyword">auto</span> i;
	<span class="hljs-keyword">for</span>(;;)<font></font>
	{<font></font>
		StepOver();<font></font>
		GetDebuggerEvent(WFNE_SUSP, <span class="hljs-number">-1</span>);<font></font>
		d5_val = GetRegValue(<span class="hljs-string">"d5"</span>);
		<span class="hljs-comment">//    d5</span>
		<span class="hljs-keyword">if</span> (d5_val != <span class="hljs-number">0xFFFF44CC</span>){
			<span class="hljs-keyword">break</span>;<font></font>
		}<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、最後の休憩</font></font><code>0x00001808 eor.w d0, d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">スクリプト（</font></font><code>Shift-F2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を貼り付け</font><font style="vertical-align: inherit;">、クリックします。</font></font><code>Run</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトは指示</font></font><code>0x00001C94 move.b (a0, a1.l), d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">停止し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">が、今で</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はすでに消去されています。</font><font style="vertical-align: inherit;">ただし、fromの値</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は命令によって移動される</font><font style="vertical-align: inherit;">ことがわかり</font><font style="vertical-align: inherit;">ます</font></font><code>0x00001C56 move.w d5,a6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、メモリのアドレス</font></font><code>0x00FF0D46</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（2バイト）に</font><font style="vertical-align: inherit;">書き込まれます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：ハッシュはに保存され</font></font><code>0x00FF0D46</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></b><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/wr/ya/gj/wryagjtwp8fvk35qfeyukg9meae.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読み取った指示をキャッチします</font></font><code>0x00FF0D46-0x00FF0D47</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">読み取りを</font><font style="vertical-align: inherit;">中断します）。</font><font style="vertical-align: inherit;">4つのブロックがありました：</font></font><br>
<br>
<img src="https://hsto.org/webt/m6/8g/ym/m68gymzx3mold0wdl1g0xnab-sw.png" alt="画像"><img src="https://hsto.org/webt/id/rr/k_/idrrk_tmum_fu409yn21tqygisk.png" alt="画像"><img src="https://hsto.org/webt/e0/nl/z_/e0nlz_whuvgznlt-efdiuecujqa.png" alt="画像"><img src="https://hsto.org/webt/i8/tn/kv/i8tnkvhk6mc5nirtlb9hlwj-bui.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらから正しい/正しい選択方法は？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に戻る：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/1d/bp/xy/1dbpxyojlaks20xlmgivzm0rpdw.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このブロックは、プログラムがに移動するか、</font></font><code>LOSER_CASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはに</font><font style="vertical-align: inherit;">移動する</font><font style="vertical-align: inherit;">かを</font><font style="vertical-align: inherit;">決定</font><font style="vertical-align: inherit;">し</font></font><code>WINNER_CASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/0l/ry/p70lrykx4qd6lof_e5kcnmcjbbk.png" alt="画像"></div><br><font style="vertical-align: inherit;"></font><code>d1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勝利の記録</font><font style="vertical-align: inherit;">
には</font><font style="vertical-align: inherit;">ゼロ</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">なければならないことが</font><font style="vertical-align: inherit;">わかり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゼロセットはどこですか？</font><font style="vertical-align: inherit;">上にスクロールするだけです：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_4/u0/tv/_4u0tvhvply85bhmwhjki65l0vu.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブロックで</font></font><code>loc_1EEC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件が満たさ</font><font style="vertical-align: inherit;">れた場合</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cpp hljs">*(a6 + <span class="hljs-number">0x24</span>) == *(a6 + <span class="hljs-number">0x22</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、ゼロになります</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
命令</font></font><code>0x00001F16 beq.w loc_20EA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">ブレークを入れる</font><font style="vertical-align: inherit;">と、</font></font><code>a6 + 0x24 = 0x00FF0D6A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値もそこに格納され</font><font style="vertical-align: inherit;">ていることがわかり</font><font style="vertical-align: inherit;">ます</font></font><code>0x4840</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、</font></font><code>a6 + 0x22 = 0x00FF0D68</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保管されてい</font></font><code>0xCB4C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のキーを入力すると、メールが表示され</font></font><code>0xCB4C - </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーの前半も受け入れられ</font></font><code>0x00FF0D6A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font><code>0xCB4C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、キーの前半の正しさの基準です。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どのブロックが書き込まれているかを確認し</font></font><code>0x00FF0D6A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。レコードに休憩を入れて、もう一度メールとキーを入力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ここ</font></font><code>loc_EAC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">このブロック</font><font style="vertical-align: inherit;">があり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">（実際には3つありますが、最初の2つは単にリセットされます</font></font><code>0x00FF0D6A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/pc/um/u1/pcumu10pkuhgdcfehysc-hzlbk4.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このブロックは関数に属しています</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コールを通して、私たちは、関数があることを知るスタック</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロックで呼び出され</font></font><code>loc_1F94</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>loc_203E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8p/mt/uh/8pmtuh7u7gigntcmbx7wugc6q5e.png" alt="画像"><img src="https://hsto.org/webt/lg/_-/2k/lg_-2kw8yl2_klsq5azj1mebnzs.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは4ブロック先に見つけ、覚えていますか？</font></font><code>loc_1F94</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちはそこで見ました-これは主要なキー処理アルゴリズムの始まりです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の重要なループはloc_1F94です</font></font></h2><br><font style="vertical-align: inherit;"></font><code>loc_1F94</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ループ</font><font style="vertical-align: inherit;">
と</font><font style="vertical-align: inherit;">はコードから確認できます。ループは</font></font><code>d4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1回</font><font style="vertical-align: inherit;">実行さ</font><font style="vertical-align: inherit;">れます（手順を参照</font></font><code>0x00001FBA d4,loc_1F94</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8p/mt/uh/8pmtuh7u7gigntcmbx7wugc6q5e.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何を探すか：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能あります</font></font><code>sub_5EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令0x00001FB4 jsr（a0）はsub_E3E関数を呼び出します（これは簡単なトレースで確認できます）。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が起きてる：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font></font><code>sub_5EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、その実行結果をレジスターに書き込みます</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これについては、別のセクションで説明しています）。</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>d1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイトは</font><font style="vertical-align: inherit;">レジスター</font><font style="vertical-align: inherit;">のアドレスに格納さ</font><font style="vertical-align: inherit;">れ</font></font><code>sp+0x33</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>0x00FFFF79</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッガーから通知</font><font style="vertical-align: inherit;">さ</font><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">ます）、これはキーハッシュアドレスの2番目のバイト（</font></font><code>0x00FF0D47</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">と同じ</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">これは、そのアドレスのレコードに休憩を入れた場合、簡単に証明できます</font></font><code>0x00FFFF79</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、指示どおりに機能します</font></font><code>0x00001F94 move.b 1(a2), 0x2F(sp)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その</font></font><code>a2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時点で、アドレス</font></font><code>0x00FF0D46</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">レジスターに格納されます</font><font style="vertical-align: inherit;">—ハッシュアドレス、つまり、ハッシュ</font></font><code>0x1(a2) = 0x00FF0D46 + 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の2番目のバイトのアドレス。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レジスターに</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き込ま</font><font style="vertical-align: inherit;">れます</font></font><code>d0^d1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果のxor'aの結果は、</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その動作が以前の計算に依存</font><font style="vertical-align: inherit;">する関数に与えられ</font><font style="vertical-align: inherit;">ます（以下を参照）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返す。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサイクルは何回実行されますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを調べてください。</font><font style="vertical-align: inherit;">次のスクリプトを実行します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;idc.idc&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
	<span class="hljs-keyword">auto</span> pc_val, d4_val, counter=<span class="hljs-number">0</span>;
	<span class="hljs-keyword">while</span>(pc_val != <span class="hljs-number">0x00001F16</span>)<font></font>
	{<font></font>
		StepOver();<font></font>
		GetDebuggerEvent(WFNE_SUSP, <span class="hljs-number">-1</span>);<font></font>
		pc_val = GetRegValue(<span class="hljs-string">"pc"</span>);
		<span class="hljs-keyword">if</span> (pc_val == <span class="hljs-number">0x00001F92</span>){<font></font>
			counter++;<font></font>
			d4_val = GetRegValue(<span class="hljs-string">"d4"</span>);<font></font>
			print(d4_val);<font></font>
		}<font></font>
	}<font></font>
	print(counter);<font></font>
}</code></pre><br>
<code>0x00001F92 subq.l 0x1,d4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ここでは</font></font><code>d4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、サイクルの直前に</font><font style="vertical-align: inherit;">何が入るかが決定され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xt/p9/ac/xtp9acx13gq3qrtvnisseyt8lfw.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sub_5EC関数を扱います。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_5EC</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なコード：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/fd/uv/xk/fduvxkbfaxne_7eratvlhuqdt8w.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どこ</font></font><code>0x2c(a2)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常に</font></font><code>0x00FF1D74</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この部分は、擬似コードで次のように書き換えることができます。</font></font><br>
<br>
<pre><code class="cpp hljs">d0 = a2 + <span class="hljs-number">0x2C</span>
*(a2+<span class="hljs-number">0x2C</span>) = *(a2+<span class="hljs-number">0x2C</span>) + <span class="hljs-number">1</span> #*(<span class="hljs-number">0x00FF1D74</span>) = *(<span class="hljs-number">0x00FF1D74</span>) + <span class="hljs-number">1</span>
result = *(d0) &amp; <span class="hljs-number">0xFF</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、4バイトは</font></font><code>0x00FF1D74</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドレスです。</font><font style="vertical-align: inherit;">それらはポインタのように扱われます。</font><font style="vertical-align: inherit;">Pythonで</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数を書き換える方法は</font></font><code>sub_5EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または、メモリダンプを作成して操作します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または、すべての戻り値を書き留めます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の方法の方が好きですが、承認データが異なり、返される値が異なる場合はどうなりますか？</font><font style="vertical-align: inherit;">これをチェックしてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトはこれに役立ちます：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;idc.idc&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> pc_val=<span class="hljs-number">0</span>, d0_val;
    <span class="hljs-keyword">while</span>(pc_val != <span class="hljs-number">0x00001F16</span>){<font></font>
        <font></font>
        pc_val = GetRegValue(<span class="hljs-string">"pc"</span>);<font></font>
        <font></font>
        <span class="hljs-keyword">if</span> (pc_val == <span class="hljs-number">0x00001F9C</span>)<font></font>
            StepInto();<font></font>
        <span class="hljs-keyword">else</span><font></font>
            StepOver();<font></font>
            <font></font>
        GetDebuggerEvent(WFNE_SUSP, <span class="hljs-number">-1</span>);<font></font>
    <font></font>
        <span class="hljs-keyword">if</span> (pc_val == <span class="hljs-number">0x00000674</span>){<font></font>
            d0_val = GetRegValue(<span class="hljs-string">"d0"</span>) &amp; <span class="hljs-number">0xFF</span>;<font></font>
            print(d0_val);<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出力をコンソールと異なるキー、メールで比較したところです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なるキーを使用してスクリプトを数回実行すると、関数は</font></font><code>sub_5EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常に配列から次の値を返す</font><font style="vertical-align: inherit;">ことがわかり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sub_5EC_gen</span>():</span>
	dump = [<span class="hljs-number">0x92</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xE4</span>,
	        <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xDE</span>,
	        <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x27</span>,
	        <span class="hljs-number">0xED</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xFA</span>,
	        <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xE7</span>,
	        <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xB5</span>,
	        <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x09</span>,
	        <span class="hljs-number">0x20</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xC6</span>,
	        <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x68</span>,
	        <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xB7</span>,
	        <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x3D</span>,
	        <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x7D</span>,
	        <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xA3</span>,
	        <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x8F</span>]<font></font>
<font></font>
	l = len(dump)<font></font>
	offset = <span class="hljs-number">0</span><font></font>
<font></font>
	<span class="hljs-keyword">while</span> offset &lt; l:
		<span class="hljs-keyword">yield</span> dump[offset]<font></font>
		offset += <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで関数の</font></font><code>sub_5EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準備が整いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の行</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_E3E</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なコード：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/pc/um/u1/pcumu10pkuhgdcfehysc-hzlbk4.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
復号化：</font></font><br>
<br>
<pre><code class="cpp hljs">   ,   d2,     .<font></font>
<font></font>
 a2   <span class="hljs-number">0xFF0D46</span>, a2 + <span class="hljs-number">0x34</span> = <span class="hljs-number">0xFF0D7A</span>
d0 = *(a2 + <span class="hljs-number">0x34</span>)<font></font>
*(a2 + <span class="hljs-number">0x34</span>) = *(a2 + <span class="hljs-number">0x34</span>) + <span class="hljs-number">1</span><font></font>
<font></font>
  ,   a0   <font></font>
a0 = d0<font></font>
*(a0) = d2<font></font>
<font></font>
   offset,     d2.<font></font>
<font></font>
 a2   <span class="hljs-number">0xFF0D46</span>, a2 + <span class="hljs-number">0x24</span> = <span class="hljs-number">0xFF0D6A</span> -  ,  <font></font>
  (. )  <span class="hljs-number">0x00000000</span>,    <font></font>
d0 = *(a2 + <span class="hljs-number">0x24</span>)<font></font>
d2 = d0 ^ d2<font></font>
d2 = d2 &amp; <span class="hljs-number">0xFF</span><font></font>
d2 = d2 + d2<font></font>
<font></font>
 - <span class="hljs-number">2</span>    <span class="hljs-number">0x00011FC0</span> + d2,   ROM, <font></font>
 <span class="hljs-number">0x00011FC0</span> + d2 <font></font>
a0 = <span class="hljs-number">0x00011FC0</span><font></font>
d2 = *(a0 + d2)<font></font>
<font></font>
      <span class="hljs-number">8</span> <font></font>
d0 = d0 &gt;&gt; <span class="hljs-number">8</span><font></font>
<font></font>
<font></font>
d2 = d0 ^ d2<font></font>
<font></font>
   <font></font>
*(a2 + <span class="hljs-number">0x24</span>) = d2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この機能</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、次のステップに分類されます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力引数を配列に保存します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オフセットオフセットを計算します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2バイトをアドレス</font></font><code>0x00011FC0 + offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ROM）に</font><font style="vertical-align: inherit;">プルします</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果= </font></font><code>(  &gt;&gt; 8) ^ (2  0x00011FC0 + offset)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ol><br><font style="vertical-align: inherit;"></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式</font><font style="vertical-align: inherit;">
の関数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">想像してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sub_E3E</span>(<span class="hljs-params">prev_sub_E3E_result, d2, d2_storage</span>):</span><font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calc_offset</span>():</span>
		<span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * ((prev_sub_E3E_result ^ d2) &amp; <span class="hljs-number">0xff</span>)<font></font>
<font></font>
	d2_storage.append(d2)<font></font>
<font></font>
	offset = calc_offset()<font></font>
<font></font>
	<span class="hljs-keyword">with</span> open(<span class="hljs-string">"dump_00011FC0"</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
		dump_00011FC0_4096b = f.read()<font></font>
<font></font>
	some = dump_00011FC0_4096b[offset:offset + <span class="hljs-number">2</span>]<font></font>
	some = int.from_bytes(some, byteorder=<span class="hljs-string">"big"</span>)<font></font>
<font></font>
	prev_sub_E3E_result = prev_sub_E3E_result &gt;&gt; <span class="hljs-number">8</span><font></font>
<font></font>
	<span class="hljs-keyword">return</span> prev_sub_E3E_result ^ some</code></pre><br>
<code>dump_00011FC0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から4096バイトを保存したファイルです</font></font><code>[0x00011FC0:00011FC0+4096]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1FC4あたりのアクティビティ</font></font></h2><br><font style="vertical-align: inherit;"></font><code>0x00001FC4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まだ</font><font style="vertical-align: inherit;">
アドレス</font><font style="vertical-align: inherit;">を確認していませんが、ブロックは最初のサイクルのほぼ直後に移動するため、簡単に見つけることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/rq/qu/4d/rqqu4dswxqemcgszszulcrrc8mc.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このブロックはアドレス</font></font><code>0x00FF0D46</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（register </font></font><code>a2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">によって内容を変更し</font><font style="vertical-align: inherit;">、キーのハッシュが格納されているため、このブロックを調査しています。</font><font style="vertical-align: inherit;">ここで何が起こるか見てみましょう。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択した左または右のブランチを決定する条件は次のとおり</font></font><code>(   ) &amp; 0b1 != 0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">つまり、ハッシュの最初のビットがチェックされます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">両方のブランチを見ると、次のことがわかります。</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どちらの場合も、1ビット右にシフトします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左側のブランチのハッシュに対して操作が実行され</font></font><code> 0x8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どちらの場合も、</font></font><code>0x00FF0D46</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">処理されたハッシュ値は</font><font style="vertical-align: inherit;">アドレス</font><font style="vertical-align: inherit;">に書き込ま</font><font style="vertical-align: inherit;">れます</font><font style="vertical-align: inherit;">。つまり、ハッシュは新しい値に置き換えられます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おおまかに言って、書き込み操作がないため、これ以上の計算は重要ではありません</font></font><code>(a2)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（2番目のオペランドがになる命令はありません</font></font><code> (a2)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
</li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなブロックを想像してください：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span>(<span class="hljs-params">hash_2b</span>):</span>
	new = hash_2b &gt;&gt; <span class="hljs-number">1</span><font></font>
<font></font>
	<span class="hljs-keyword">if</span> hash_2b &amp; <span class="hljs-number">0b1</span> != <span class="hljs-number">0</span>:<font></font>
		new = new | <span class="hljs-number">0x8000</span><font></font>
<font></font>
	<span class="hljs-keyword">return</span> new</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目の重要なループはloc_203Eです</font></font></h2><br>
<code>loc_203E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-サイクル、なぜなら </font></font><code>0x0000206C bne.s loc_203E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/lg/_-/2k/lg_-2kw8yl2_klsq5azj1mebnzs.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサイクルは、ハッシュを計算し、ここではその主な機能です：</font></font><code>jsr (a0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-関数呼び出しである</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは、すでに検討していること-それは、自身の作品の前の結果に依存しており、いくつかの入力引数に（それは上記レジスタを通過させ</font></font><code>d2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ここを通じて</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レジスターを介して彼女に渡されるものを調べてみましょう</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはすでに構築に会いました</font></font><code>0x34(a2) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-関数</font></font><code>sub_E3E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は渡された引数を保存します。つまり、以前に渡された引数がこのループで使用されます。すべてではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コード部分を復号化します。</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">2</span>    a2+<span class="hljs-number">0x1C</span>
move.w <span class="hljs-number">0x1C</span>(a2), d0<font></font>
<font></font>
<font></font>
neg.l d0<font></font>
<font></font>
  a0       sub_E3E<font></font>
movea.l <span class="hljs-number">0x34</span>(a2), a0<font></font>
<font></font>
,  d0  <span class="hljs-number">2</span>    a0-d0(   d0 )<font></font>
move.b (a0, d0.l), d0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一番下の行は単純なアクションです。各反復で、</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格納された引数を配列の最後から</font><font style="vertical-align: inherit;">取得し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">つまり、</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4が格納されている</font><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、最後から4番目の要素を取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もしそうなら、具体的な意味は</font></font><code>d0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何ですか？</font><font style="vertical-align: inherit;">ここではスクリプトなしで行いましたが、単にそれらを書き出して、このブロックの最初に休憩を入れました。</font><font style="vertical-align: inherit;">ここにあります：</font></font><code>0x04, 0x04, 0x04, 0x1C, 0x1A, 0x1A, 0x06, 0x42, 0x02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、完全なキーハッシュ計算関数を作成するためのすべてが揃いました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全ハッシュ計算機能</font></font></h2><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">finish_hash</span>(<span class="hljs-params">hash_2b</span>):</span><font></font>
<font></font>
	<span class="hljs-comment">#   </span>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span>(<span class="hljs-params">hash_2b</span>):</span>
		new = hash_2b &gt;&gt; <span class="hljs-number">1</span><font></font>
<font></font>
		<span class="hljs-keyword">if</span> hash_2b &amp; <span class="hljs-number">0b1</span> != <span class="hljs-number">0</span>:<font></font>
			new = new | <span class="hljs-number">0x8000</span><font></font>
<font></font>
		<span class="hljs-keyword">return</span> new<font></font>
<font></font>
	main_cycle_counter = [<span class="hljs-number">17</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">38</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>, <span class="hljs-number">4</span>]<font></font>
	second_cycle_counter = [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">28</span>]<font></font>
	counters = list(zip(main_cycle_counter, second_cycle_counter))<font></font>
<font></font>
	d2_storage = []<font></font>
	storage_offsets = [<span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x02</span>]<font></font>
<font></font>
	prev_sub_E3E_result = <span class="hljs-number">0x0000</span><font></font>
<font></font>
	sub_5EC = sub_5EC_gen()<font></font>
<font></font>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">9</span>):<font></font>
<font></font>
		c = counters[i]<font></font>
<font></font>
		<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(c[<span class="hljs-number">0</span>]):<font></font>
			d0 = next(sub_5EC)<font></font>
<font></font>
			d1 = hash_2b &amp; <span class="hljs-number">0xff</span><font></font>
			d2 = d0 ^ d1<font></font>
<font></font>
			curr_sub_E3E_result = sub_E3E(prev_sub_E3E_result, d2, d2_storage)<font></font>
			prev_sub_E3E_result = curr_sub_E3E_result<font></font>
<font></font>
		storage_offset = storage_offsets.pop(<span class="hljs-number">0</span>)<font></font>
<font></font>
		<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(c[<span class="hljs-number">1</span>]):<font></font>
<font></font>
			d2 = d2_storage[-storage_offset]<font></font>
<font></font>
			curr_sub_E3E_result = sub_E3E(prev_sub_E3E_result, d2, d2_storage)<font></font>
			prev_sub_E3E_result = curr_sub_E3E_result<font></font>
<font></font>
		hash_2b = transform(hash_2b)<font></font>
<font></font>
	<span class="hljs-keyword">return</span> curr_sub_E3E_result</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康診断</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッガーで</font></font><code>0x0000180A move.l 0x1000,(sp)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ハッシュを計算した直後に）</font><font style="vertical-align: inherit;">アドレスにブレークを入れます</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドレスにブレークします</font></font><code>0x00001F16 beq.w loc_20EA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（定数との最終ハッシュの比較</font></font><code>0xCB4C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムでキーを入力し</font></font><code>ABCDEFGHIJKLMNOP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、をクリックします</font></font><code>Enter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッガーはで停止し</font></font><code>0x0000180A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>d5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値がレジスター</font></font><code>0xFFFF44CC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>0x44CC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のハッシュ）に</font><font style="vertical-align: inherit;">書き込まれ</font><font style="vertical-align: inherit;">た</font><font style="vertical-align: inherit;">ことが</font><font style="vertical-align: inherit;">わかり</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらにデバッガを起動します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たち</font><font style="vertical-align: inherit;">は立ち止まり</font></font><code>0x00001F16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アドレスにあるものを確認します</font><font style="vertical-align: inherit;">-最終ハッシュ</font></font><code>0x00FF0D6A</code><font style="vertical-align: inherit;"></font><code>0x4840</code><font style="vertical-align: inherit;"></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lb/zp/bo/lbzpbohzrioqfs-3h_jj7q5v4sy.png" alt="画像"></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、finish_hash（hash_2b）関数を確認します。</font></font><br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>r = finish_hash(<span class="hljs-number">0x44CC</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>print(hex(r))
<span class="hljs-number">0x4840</span></code></pre></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは正しい鍵を探しています1</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正しいキーはこのキーであり、その最終ハッシュは同じです</font></font><code>0xCB4C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（上記で確認）。</font><font style="vertical-align: inherit;">したがって、質問：ファイナルになるための最初のハッシュはどうあるべき</font></font><code>0xCB4C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今では簡単に見つけることができます：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_CB4C</span>():</span><font></font>
<font></font>
	result = []<font></font>
<font></font>
	<span class="hljs-keyword">for</span> hash_2b <span class="hljs-keyword">in</span> range(<span class="hljs-number">0xFFFF</span>+<span class="hljs-number">1</span>):<font></font>
		final_hash = finish_hash(hash_2b)<font></font>
		<span class="hljs-keyword">if</span> final_hash == <span class="hljs-number">0xCB4C</span>:<font></font>
			result.append(hash_2b)<font></font>
<font></font>
	<span class="hljs-keyword">return</span> result<font></font>
	<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>r = find_CB4C()
<span class="hljs-meta">&gt;&gt;&gt; </span>print(r)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムの出力は、オプションが1つしかないことを示しています</font></font><code>0xFEDC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最初のハッシュはでなければなりません</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のハッシュが必要な文字は何</font></font><code>0xFEDC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以来</font></font><code>0xFEDC = __4_ ^ __4_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あなただけの</font></font><code>__4_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため</font><font style="vertical-align: inherit;">に見つける必要があります</font></font><code>__4_ = __4_ ^ 0xFEDC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、両方のハッシュをデコードします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムは次のとおりです。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_first_half</span>():</span><font></font>
<font></font>
	<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque
	<span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pairs</span>():</span><font></font>
<font></font>
		pairs = []<font></font>
<font></font>
		<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0xFFFF</span> + <span class="hljs-number">1</span>):<font></font>
			pair = (i, i ^ <span class="hljs-number">0xFEDC</span>)<font></font>
			pairs.append(pair)<font></font>
<font></font>
		pairs = deque(pairs)<font></font>
		pairs.rotate(randint(<span class="hljs-number">0</span>, <span class="hljs-number">0xFFFF</span>))<font></font>
<font></font>
		<span class="hljs-keyword">return</span> list(pairs)<font></font>
<font></font>
	pairs = get_pairs()<font></font>
<font></font>
	<span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> pairs:<font></font>
<font></font>
		key_4s_0 = decode_hash_4s(pair[<span class="hljs-number">0</span>])<font></font>
		key_4s_1 = decode_hash_4s(pair[<span class="hljs-number">1</span>])<font></font>
<font></font>
		hash_2b_0 = get_hash_2b(key_4s_0)<font></font>
		hash_2b_1 = get_hash_2b(key_4s_1)<font></font>
<font></font>
		<span class="hljs-keyword">if</span> hash_2b_0 == pair[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> hash_2b_1 == pair[<span class="hljs-number">1</span>]:
			<span class="hljs-keyword">return</span> key_4s_0, key_4s_1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たくさんのオプションがあります。どれかを選択してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正しい鍵を探しています2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーの前半は準備ができていますが、後半はどうですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが最も簡単な部分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
責任のあるコード部分はにあり</font></font><code>0x00FF2012</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アドレス</font></font><code>0x00001F16 beg.w loc_20EA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（キーの前半の検証</font><font style="vertical-align: inherit;">）から始まる手動トレースでアクセスできました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">レジスターに</font></font><code>a0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はメールアドレスがあり、それ</font></font><code>loc_FF2012</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はサイクルです。</font></font><code>bne.s loc_FF2012</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code>*(a0+d0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（別のバイトのメール）</font><font style="vertical-align: inherit;">がある限り実行され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、命令</font></font><code>jsr (a3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はすでにおなじみの関数を呼び出し</font></font><code>get_hash_2b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これは、キーの後半で機能します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://hsto.org/webt/wl/ln/5i/wlln5if5bzqcukbxnvpc_osl5lw.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードをより明確にしましょう：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">while</span>(d1 != <span class="hljs-number">0x20</span>){<font></font>
	  <font></font>
	d2++<font></font>
	d1 = d1 &amp; <span class="hljs-number">0xFF</span><font></font>
	<font></font>
	   <font></font>
	d3 = d3 + d1<font></font>
	d0 = <span class="hljs-number">0</span><font></font>
	d0 = d2<font></font>
	<font></font>
	  <font></font>
	d1 = *(a0+d0)<font></font>
}<font></font>
<font></font>
d0 = get_hash_2b(key_byte_8)<font></font>
d3 = d0^d3<font></font>
<font></font>
d0 = get_hash_2b(key_byte_12)<font></font>
d2 = d2 - <span class="hljs-number">1</span>
d2 = d2 &lt;&lt; <span class="hljs-number">8</span><font></font>
d2 = d0^d2<font></font>
<font></font>
<span class="hljs-keyword">if</span> (d2 == d3)<font></font>
	success_branch</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レジスター</font></font><code>d2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>( -1) &lt;&lt; 8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">B </font></font><code>d3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、メール文字のバイトの合計です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正確さの基準は次のようにして得られます</font></font><code>__ ^ d2 == ___2 ^ d3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーの後半の選択関数を記述します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_second_half</span>(<span class="hljs-params">email</span>):</span><font></font>
<font></font>
	<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque
	<span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_koeff</span>():</span>
		k1 = sum([ord(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> email])<font></font>
		k2 = (len(email) - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">8</span><font></font>
<font></font>
		<span class="hljs-keyword">return</span> k1, k2<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pairs</span>(<span class="hljs-params">k1, k2</span>):</span><font></font>
		pairs = []<font></font>
<font></font>
		<span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> range(<span class="hljs-number">0xFFFF</span> + <span class="hljs-number">1</span>):<font></font>
			pair = (a, (a ^ k1) ^ k2)<font></font>
			pairs.append(pair)<font></font>
<font></font>
		pairs = deque(pairs)<font></font>
		pairs.rotate(randint(<span class="hljs-number">0</span>, <span class="hljs-number">0xFFFF</span>))<font></font>
<font></font>
		<span class="hljs-keyword">return</span> list(pairs)<font></font>
<font></font>
	k1, k2 = get_koeff()<font></font>
<font></font>
	pairs = get_pairs(k1, k2)<font></font>
<font></font>
	<span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> pairs:<font></font>
<font></font>
		key_4s_0 = decode_hash_4s(pair[<span class="hljs-number">0</span>])<font></font>
		key_4s_1 = decode_hash_4s(pair[<span class="hljs-number">1</span>])<font></font>
<font></font>
		hash_2b_0 = get_hash_2b(key_4s_0)<font></font>
		hash_2b_1 = get_hash_2b(key_4s_1)<font></font>
<font></font>
		<span class="hljs-keyword">if</span> hash_2b_0 == pair[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> hash_2b_1 == pair[<span class="hljs-number">1</span>]:
			<span class="hljs-keyword">return</span> key_4s_0, key_4s_1</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keygen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メールはカプセルでなければなりません。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">keygen</span>(<span class="hljs-params">email</span>):</span><font></font>
<font></font>
	first_half = get_first_half()<font></font>
	second_half = get_second_half(email)<font></font>
<font></font>
	<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>.join(first_half) + <span class="hljs-string">""</span>.join(second_half)<font></font>
<font></font>
	<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>email = <span class="hljs-string">"M.GAYANOV@GMAIL.COM"</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>print(keygen(email))
<span class="hljs-number">2</span>A4FD493BA32AD75</code></pre><br>
<div style="text-align:center;"><img src="https://hsto.org/webt/rp/ja/bo/rpjabo27x0oemehl_380bdoiyto.png" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご清聴ありがとうございました！</font><font style="vertical-align: inherit;">すべてのコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入手でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453174/index.html">新しいYandex.Kassi APIに切り替える8つの理由</a></li>
<li><a href="../ja453178/index.html">コードを改善する開発者の主なスキル</a></li>
<li><a href="../ja453182/index.html">あなたのポケットの中の全世界、または数日でモバイルカードを作る方法</a></li>
<li><a href="../ja453188/index.html">非IT管理者にフォールトトレラントITインフラストラクチャを構築する原則を説明する方法</a></li>
<li><a href="../ja453192/index.html">プロセスの同期と非同期</a></li>
<li><a href="../ja453196/index.html">Forrester Research：トップ10のソフトウェア構成分析ベンダーの比較</a></li>
<li><a href="../ja453200/index.html">ディスカッション：OpenROADプロジェクトは、プロセッサの設計を自動化するタスクを解決することを目的としています</a></li>
<li><a href="../ja453204/index.html">コンテナー、マイクロサービス、サービスメッシュ</a></li>
<li><a href="../ja453206/index.html">Kelsey Moodyへのインタビュー：会社の構築方法と年齢関連の病状の終焉</a></li>
<li><a href="../ja453212/index.html">消費者レポート：テスラの最新のオートパイロットは完璧とはほど遠い</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>