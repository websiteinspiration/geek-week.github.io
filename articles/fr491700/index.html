<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏽‍🤝‍🧑🏻 😒 🙅🏿 EOF n'est pas un symbole 🏚️ 🆖 👋🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Récemment, j'ai lu le livre «Systèmes informatiques: architecture et programmation. Le look du programmeur. " Là, dans le chapitre sur le système d'E ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>EOF n'est pas un symbole</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/491700/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récemment, j'ai lu le livre «Systèmes informatiques: architecture et programmation. </font><font style="vertical-align: inherit;">Le look du programmeur. " </font><font style="vertical-align: inherit;">Là, dans le chapitre sur le système d'E / S Unix, les auteurs ont mentionné qu'il n'y avait pas de caractère spécial à la fin du fichier </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Si vous avez lu des informations sur le système d'E / S Unix / Linux, ou si vous l'avez expérimenté, si vous avez écrit des programmes C qui lisent des données à partir de fichiers, cette déclaration vous semblera probablement complètement évidente. </font><font style="vertical-align: inherit;">Mais regardons de plus près les deux déclarations suivantes liées à ce que j'ai trouvé dans le livre:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/uo/yj/ku/uoyjkuavqfscbvevz6xcbx7gbe8.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce n'est pas un symbole.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de caractère spécial à la fin des fichiers.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce que c'est </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EOF n'est pas un symbole</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi est-ce que quelqu'un dit ou pense que </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est un symbole? </font><font style="vertical-align: inherit;">Je suppose que cela peut être le cas parce que dans certains programmes C, vous pouvez trouver du code qui utilise une vérification explicite pour l' </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisation des fonctions </font></font><code>getchar()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>getc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela pourrait ressembler à ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;...<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">while</span> ((c = getchar()) != EOF)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">putchar</span>(c);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou alors:</font></font><br>
<br>
<pre><code class="cpp hljs">&nbsp;&nbsp;&nbsp;&nbsp;FILE *fp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">int</span> c;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;...<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">while</span> ((c = getc(fp)) != EOF)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putc(c, <span class="hljs-built_in">stdout</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous consultez l'aide de </font></font><code>getchar()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>getc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez découvrir que les deux fonctions lisent le caractère suivant du flux d'entrée. </font><font style="vertical-align: inherit;">Probablement - c'est précisément ce qui provoque la conception erronée de la nature </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais ce ne sont que mes hypothèses. </font><font style="vertical-align: inherit;">Revenons à l'idée que </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ce n'est pas un symbole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et qu'est-ce qu'un symbole en général? </font><font style="vertical-align: inherit;">Un symbole est la plus petite composante de texte. </font><font style="vertical-align: inherit;">«A», «a», «B», «b» - tous ces symboles sont différents. </font><font style="vertical-align: inherit;">Un caractère a un code numérique qui, dans la norme Unicode, est appelé un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point de code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par exemple, la lettre latine «A» a, en décimal, le code 65. Cela peut être vérifié rapidement en utilisant la ligne de commande de l'interpréteur Python:</font></font><br>
<br>
<pre><code class="python hljs">$python
<span class="hljs-meta">&gt;&gt;&gt; </span>ord(<span class="hljs-string">'A'</span>)
<span class="hljs-number">65</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>chr(<span class="hljs-number">65</span>)
<span class="hljs-string">'A'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou vous pouvez jeter un œil à la table ASCII sur Unix / Linux:</font></font><br>
<br>
<pre><code class="cpp hljs">$ man ascii
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4b/149/001/f4b1490012bcde2558172ea7ed91f934.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons découvrir à quel code correspond </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en écrivant un petit programme en C. En ANSI C, une constante est </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">définie dans </font></font><code>stdio.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, elle fait partie de la bibliothèque standard. </font><font style="vertical-align: inherit;">Habituellement écrit à cette constante </font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez enregistrer le code suivant dans un fichier </font></font><code>printeof.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le compiler et l'exécuter:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span>
</span>{
&nbsp;&nbsp;<span class="hljs-built_in">printf</span>(<span class="hljs-string">"EOF value on my system: %d\n"</span>, EOF);
&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilez et lancer le programme:</font></font><br>
<br>
<pre><code class="cpp hljs">$ gcc -o printeof printeof.c<font></font>
<font></font>
$ ./printeof<font></font>
EOF value on my system: <span class="hljs-number">-1</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai ce programme, testé sur Mac OS et sur Ubuntu, des rapports qui sont </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">égaux </font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Y a-t-il un caractère avec ce code? </font><font style="vertical-align: inherit;">Ici, encore une fois, vous pouvez vérifier les codes de caractères dans la table ASCII, vous pouvez regarder la table Unicode et découvrir dans quelle plage les codes de caractères peuvent être. </font><font style="vertical-align: inherit;">Nous agirons différemment: nous lancerons l'interpréteur Python et utiliserons la fonction standard </font></font><code>chr()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour nous donner le symbole correspondant au code </font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs">$ python
<span class="hljs-meta">&gt;&gt;&gt; </span>chr(<span class="hljs-number">-1</span>)<font></font>
Traceback (most recent call last):<font></font>
&nbsp;&nbsp;File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
ValueError: chr() arg <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> range(<span class="hljs-number">0x110000</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme prévu, le caractère avec le code </font></font><code>-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'existe pas. </font><font style="vertical-align: inherit;">Donc, à la fin, </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et la vérité n'est pas un symbole. </font><font style="vertical-align: inherit;">Nous passons maintenant à la deuxième déclaration à l'examen.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de caractère spécial à la fin des fichiers.</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">être </font><font style="vertical-align: inherit;">- c'est un caractère spécial qui se trouve à la fin du fichier? </font><font style="vertical-align: inherit;">Je suppose que vous connaissez déjà la réponse. </font><font style="vertical-align: inherit;">Mais vérifions soigneusement notre hypothèse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenez un fichier texte simple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">helloworld.txt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et affichez son contenu en représentation hexadécimale. </font><font style="vertical-align: inherit;">Pour ce faire, vous pouvez utiliser la commande </font></font><code>xxd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs">$ cat helloworld.txt<font></font>
Hello world!<font></font>
<font></font>
$ xxd helloworld.txt<font></font>
<span class="hljs-number">00000000</span>: <span class="hljs-number">4865</span> <span class="hljs-number">6</span>c6c <span class="hljs-number">6f</span>20 <span class="hljs-number">776f</span> <span class="hljs-number">726</span>c <span class="hljs-number">6421</span> <span class="hljs-number">0</span>a &nbsp; &nbsp; &nbsp; &nbsp; Hello world!.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, le dernier caractère du fichier a un code </font></font><code>0a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans le tableau ASCII, vous pouvez découvrir que ce code correspond à un caractère </font></font><code>nl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-à-dire à un caractère de nouvelle ligne. </font><font style="vertical-align: inherit;">Vous pouvez le découvrir en utilisant Python:</font></font><br>
<br>
<pre><code class="python hljs">$ python
<span class="hljs-meta">&gt;&gt;&gt; </span>chr(<span class="hljs-number">0x0a</span>)
<span class="hljs-string">'\n'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc. </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Ce n'est pas un symbole, et à la fin des fichiers il n'y a pas de symbole spécial. </font><font style="vertical-align: inherit;">Qu'est-ce que c'est </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'un EOF?</font></font></font></h2><br>
<code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(fin de fichier) est un état qui peut être détecté par l'application dans une situation où l'opération de lecture de fichier arrive à son terme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons comment il est possible de détecter l'état </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans différents langages de programmation lors de la lecture d'un fichier texte à l'aide des outils d'entrée-sortie de haut niveau fournis par ces langages. </font><font style="vertical-align: inherit;">Pour ce faire, nous écrirons une version très simple </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui sera appelée </font></font><code>mcat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il lit l'octet de texte ASCII (caractère) et recherche explicitement </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nous écrirons le programme dans les langues suivantes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANSI C</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python 3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aller</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript (Node.js)</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> référentiel avec un exemple de code. </font><font style="vertical-align: inherit;">Nous procédons à leur analyse.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANSI C</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons par le vénérable C. Le programme présenté ici est une version modifiée </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du livre "C Programming Language".</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* mcat.c */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span>
</span>{<font></font>
&nbsp;&nbsp;FILE *fp;<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">int</span> c;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">if</span> ((fp = fopen(*++argv, <span class="hljs-string">"r"</span>)) == <span class="hljs-literal">NULL</span>) {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">printf</span>(<span class="hljs-string">"mcat: can't open %s\n"</span>, *argv);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">while</span> ((c = getc(fp)) != EOF)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;putc(c, <span class="hljs-built_in">stdout</span>);<font></font>
<font></font>
&nbsp;&nbsp;fclose(fp);<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilation:</font></font><br>
<br>
<pre><code class="cpp hljs">$ gcc -o mcat mcat.c
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lancement:</font></font><br>
<br>
<pre><code class="cpp hljs">$ ./mcat helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quelques explications concernant le code ci-dessus:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le programme ouvre le fichier qui lui est transmis en tant qu'argument de ligne de commande.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La boucle </font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copie les données du fichier vers le flux de sortie standard. </font><font style="vertical-align: inherit;">Les données sont copiées octet par octet, cela se produit jusqu'à la fin du fichier.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque le programme atteint </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il ferme le fichier et se ferme.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python 3</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En Python, il n'y a pas de mécanisme de vérification explicite </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, similaire à celui disponible dans ANSI C. Mais si vous lisez le fichier caractère par caractère, vous pouvez révéler l'état </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si la variable contenant le caractère suivant lu est vide:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"># mcat.py</span>
<span class="hljs-function"><span class="hljs-keyword">import</span> sys

with <span class="hljs-title">open</span><span class="hljs-params">(sys.argv[<span class="hljs-number">1</span>])</span> as fin:
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">while</span> True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span>= fin.read(<span class="hljs-number">1</span>) #   <span class="hljs-number">1</span> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> c == <span class="hljs-string">'': &nbsp; &nbsp; # EOF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(c, end='</span><span class="hljs-string">')
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez le programme et examinez les résultats qui lui sont renvoyés:</font></font><br>
<br>
<pre><code class="python hljs">$ python mcat.py helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une version plus courte du même exemple écrit en Python 3.8+. </font><font style="vertical-align: inherit;">Ici l'opérateur est utilisé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: =</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (il est appelé "opérateur morse" ou "opérateur morse"):</font></font><br>
<br>
<pre><code class="cpp hljs"># mcat38.<span class="hljs-function">py
<span class="hljs-keyword">import</span> sys

with <span class="hljs-title">open</span><span class="hljs-params">(sys.argv[<span class="hljs-number">1</span>])</span> as fin:
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-title">while</span> <span class="hljs-params">(c := fin.read(<span class="hljs-number">1</span>))</span> !</span>= <span class="hljs-string">'':&nbsp; #   1    EOF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(c, end='</span><span class="hljs-string">')
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez ce code:</font></font><br>
<br>
<pre><code class="python hljs">$ python3<span class="hljs-number">.8</span> mcat38.py helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aller</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Go, vous pouvez vérifier explicitement l'erreur renvoyée par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Read ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour voir si cela indique que nous sommes arrivés à la fin du fichier:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// mcat.go</span>
<span class="hljs-function">package main

<span class="hljs-title">import</span> <span class="hljs-params">(
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"fmt"</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"os"</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"io"</span>
)</span>

func <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;file, err := os.Open(os.Args[<span class="hljs-number">1</span>])
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> err != nil {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Fprintf(os.Stderr, <span class="hljs-string">"mcat: %v\n"</span>, err)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.Exit(<span class="hljs-number">1</span>)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;buffer := make([]byte, <span class="hljs-number">1</span>)&nbsp; <span class="hljs-comment">// 1-byte buffer</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytesread, err := file.Read(buffer)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> err == io.EOF {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">break</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(<span class="hljs-built_in">string</span>(buffer[:bytesread]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;file.Close()<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez le programme:</font></font><br>
<br>
<pre><code class="cpp hljs">$ go run mcat.go helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript (Node.js)</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Node.js n'a pas de mécanisme de vérification explicite </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais, lorsque, en atteignant la fin du fichier, une tentative est faite pour lire autre chose, l'événement de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fin de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> flux est déclenché </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* mcat.js */</span>
<span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> process = require(<span class="hljs-string">'process'</span>);<font></font>
<font></font>
<span class="hljs-keyword">const</span> fileName = process.argv[<span class="hljs-number">2</span>];<font></font>
<font></font>
var readable = fs.createReadStream(fileName, {<font></font>
&nbsp;&nbsp;encoding: <span class="hljs-string">'utf8'</span>,<font></font>
&nbsp;&nbsp;fd: null,<font></font>
});<font></font>
<font></font>
readable.on(<span class="hljs-string">'readable'</span>, function() {<font></font>
&nbsp;&nbsp;var chunk;<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">while</span> ((chunk = readable.read(<span class="hljs-number">1</span>)) !== null) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;process.<span class="hljs-built_in">stdout</span>.write(chunk); <span class="hljs-comment">/* chunk is one byte */</span><font></font>
&nbsp;&nbsp;}<font></font>
});<font></font>
<font></font>
readable.on(<span class="hljs-string">'end'</span>, () =&gt; {<font></font>
&nbsp;&nbsp;console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'\nEOF: There will be no more data.'</span>);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez le programme:</font></font><br>
<br>
<pre><code class="cpp hljs">$ node mcat.js helloworld.txt<font></font>
Hello world!<font></font>
<font></font>
EOF: There will be no more data.<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mécanismes du système de bas niveau</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment les mécanismes d'E / S de haut niveau utilisés dans les exemples ci-dessus déterminent-ils la fin du fichier? Sous Linux, ces mécanismes utilisent directement ou indirectement l'appel système </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">read ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fourni par le noyau. Une fonction (ou macro) </font></font><code>getc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de C, par exemple, utilise un appel système </font></font><code>read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et retourne </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si elle </font></font><code>read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique l'état d'atteindre la fin du fichier. Dans ce cas, </font></font><code>read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoie </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si vous décrivez tout cela sous la forme d'un diagramme, vous obtenez ce qui suit:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/660/9f3/5de/6609f35de47731aea676b6a3ad435b59.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'avère que la fonction est </font></font><code>getc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basée sur </font></font><code>read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons écrire une version </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nommée en </font></font><code>syscat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisant uniquement les appels système Unix. </font><font style="vertical-align: inherit;">Nous le ferons non seulement par intérêt, mais aussi parce que cela pourrait très bien nous apporter des avantages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ce programme écrit en C:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* syscat.c */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/stat.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span>
</span>{
&nbsp;&nbsp;<span class="hljs-keyword">int</span> fd;
&nbsp;&nbsp;<span class="hljs-keyword">char</span> c;<font></font>
<font></font>
&nbsp;&nbsp;fd = open(argv[<span class="hljs-number">1</span>], O_RDONLY, <span class="hljs-number">0</span>);<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">while</span> (read(fd, &amp;c, <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;write(STDOUT_FILENO, &amp;c, <span class="hljs-number">1</span>);<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécuter:</font></font><br>
<br>
<pre><code class="cpp hljs">$ gcc -o syscat syscat.c<font></font>
<font></font>
$ ./syscat helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce code utilise le fait que la fonction </font></font><code>read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, indiquant que la fin du fichier est atteinte, retourne </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici le même programme écrit en Python 3:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"># syscat.py</span>
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> os<font></font>
<font></font>
fd = os.open(sys.argv[<span class="hljs-number">1</span>], os.O_RDONLY)<font></font>
<font></font>
<span class="hljs-keyword">while</span> True:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;c = os.read(fd, <span class="hljs-number">1</span>)
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> c:&nbsp; # EOF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">break</span>
&nbsp;&nbsp;&nbsp;&nbsp;os.write(sys.<span class="hljs-built_in">stdout</span>.fileno(), c)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécuter:</font></font><br>
<br>
<pre><code class="python hljs">$ python syscat.py helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la même chose écrite en Python 3.8+:</font></font><br>
<br>
<pre><code class="cpp hljs"># syscat38.py
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> os<font></font>
<font></font>
fd = os.open(sys.argv[<span class="hljs-number">1</span>], os.O_RDONLY)<font></font>
<font></font>
<span class="hljs-keyword">while</span> c := os.read(fd, <span class="hljs-number">1</span>):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;os.write(sys.<span class="hljs-built_in">stdout</span>.fileno(), c)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez également ce code:</font></font><br>
<br>
<pre><code class="python hljs">$ python3<span class="hljs-number">.8</span> syscat38.py helloworld.txt<font></font>
Hello world!<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br>
<ul>
<li><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce n'est pas un symbole.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de caractère spécial à la fin des fichiers.</font></font></li>
<li><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - c'est l'état signalé par le noyau et qui peut être détecté par l'application dans le cas où l'opération de lecture des données atteint la fin du fichier.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ANSI C </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce n'est encore pas un caractère. </font><font style="vertical-align: inherit;">Il s'agit de la constante définie </font></font><code>stdio.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans laquelle la valeur -1 est généralement écrite.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un «caractère» </font></font><code>EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est introuvable dans une table ASCII ou en Unicode.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connaissez-vous des idées fausses plus ou moins répandues dans le monde des ordinateurs?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr491690/index.html">Protéger la confidentialité des données - le défi du siècle</a></li>
<li><a href="../fr491692/index.html">Déboguer les schémas angulaires avec le code Visual Studio</a></li>
<li><a href="../fr491694/index.html">Marques d'ordinateurs des années 90</a></li>
<li><a href="../fr491696/index.html">Attrape-moi si tu peux: des ondes radio, une cascade de particules et de glace pour capturer les neutrinos</a></li>
<li><a href="../fr491698/index.html">[Prévision] Transport du futur: horizon à moyen terme</a></li>
<li><a href="../fr491702/index.html">CSS pur: 4 méthodes pour animer les couleurs des liens</a></li>
<li><a href="../fr491704/index.html">Que doivent savoir les développeurs front-end sur le backend?</a></li>
<li><a href="../fr491708/index.html">Framework JS peu connus mais populaires pour le frontend</a></li>
<li><a href="../fr491710/index.html">Ancrer une application basée sur React, Express et MongoDB</a></li>
<li><a href="../fr491712/index.html">Une vraie programmation pour les sciences humaines à partir de zéro ... 3DS Max</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>