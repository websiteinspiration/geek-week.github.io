<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßó üçå üëàüèæ Kulhacker. Start üóÇÔ∏è üôåüèª üñáÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A short story about how to quickly join the information security. An old story, a long start, but perhaps I‚Äôll start ...
 
 Episode 1. Introduction, c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kulhacker. Start</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493086/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/0l/cz/90/0lcz90jurwg6j-swtqvrxyzvogy.jpeg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A short story about how to quickly join the information security. </font><font style="vertical-align: inherit;">An old story, a long start, but perhaps I‚Äôll start ...</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Episode 1. Introduction, captcha, cutting out bots</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I have one Internet project of a personal nature, so to speak, with the beginning back in 2006. The project is very personal, so I do not publish the link, but I can give those who wish the link in PM. At the moment, the project is slowly dying, it has already gone through the growth and prosperity stage, it seems like it needs to be buried, but we still won‚Äôt decide on this step. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Move in 2006 was bought, it‚Äôs no secret - DLE, and in about a year it was heavily dopped on its own, dopped so much that we stopped updating since 2007. Saytets, where people hang out, write, comment, communicate in PM on various burning topics. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distinctive features of the project were its own improvements, but so simple that sometimes I was very surprised at why others had not thought of it before. One of these improvements is related to captcha.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When all such projects introduced captcha to protect against bots, a friend and I decided to introduce captcha, but quickly realized that we were stupidly losing our audience, and there were more and more bots and they continued to spam. As a result, the captcha remained, but only as a roulette, displaying the dropped out number, which does not affect the ability to leave a comment - in other words, we completely cut out the captcha verification mechanism, but left the generation and display. And after a fairly short period of time, it became a chip - the people in the comments were measured by the numbers of captcha, who is more beautiful, etc. ‚ÄúWhatever the child may amuse, if only not with his hands,‚Äù we thought.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if you recall the history of captcha, then it is intended to protect against bots, from those that are massively spammed on the Internet, and we drank this protection mechanism because it did not work. </font><font style="vertical-align: inherit;">Nevertheless, we were able to analyze the behavior of bots and cut all without a trace. </font><font style="vertical-align: inherit;">There is a site, there is the possibility of simple, consider easy, commenting, without SMS and registration, no captcha, no bots. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This was a worthy application of POST and GET requests to site scripts from my side.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Episode 2. Engine updates, getting to know the kulhacker</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because The site‚Äôs engine was not updated, periodically some vulnerabilities surfaced, and some other episodes of applying specific vulnerabilities to our site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It‚Äôs good if we found out about this vulnerability on 0day resources before this vulnerability was applied to our site, or in the form of technical support for our engine, again until the moment when this vulnerability was applied to our site. But it also happened that we learned about the vulnerability from the analysis of POST and GET requests for site scripts, either in fact, for example, a deface, or other manipulations with the site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then came the day when the version of the site engine became so old that messages about this engine and this version simply stopped appearing on 0day resources, not to mention that on the TP forum over the past 5 years there are simply no new posts about our version of the engine appeared. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then he appears - a kulhacker. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will not talk about who it is, I will tell you about the fun that we received. It all started with the fact that the owner of the site received a message that the site was hacked, chase the hats, otherwise all the khan. In the first letter, the amount of 100K rubles in bitcoins was announced.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These are the times, we thought, and got down to analytics. First, it was necessary to find the result of hacking. A script was quickly found that was not related to the site engine, but disguised as a typical script for our engine, and also modified site scripts were found - the site was malfunctioned. Work level - kulhacker, it was not possible to get to the server.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Through simple manipulations, the entire POST and GET requests to the site were analyzed for the name of a new script, and of course, the passed parameters were found in the POST request to the site, as a result of which a vulnerability was found, an attack vector was determined, and a weak one was found to the front a variable, and of course, the vulnerability was closed, and a ‚Äúrollback to safe‚Äù state was made for the site engine. </font><font style="vertical-align: inherit;">An additional observation was established for the kulhacker - suddenly he still knows what we don‚Äôt know, and in the public there is practically no unknown information, and our case was clearly not described anywhere.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Episode 3. Kulhacker strikes back, bargaining</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After some time, the letter again, this time saying that we are bad people, that he will not forgive us for this, that if we do not pay the caps, then we will not be greeted again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These are the two, we thought, and again ignored the letter. After a couple of days, we received a website deface with the requirement to pay caps. We again analyzed POST and GET requests, again found the attack vector, discovered a new weak variable to the front end, closed the vulnerability again, and again made a ‚Äúrollback to a safe‚Äù state.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We already understood that the kulhacker should begin to suspect us that we are using his knowledge in our own interests, and that we are not running towards him with a bag of money, so it was decided to write a letter to our ‚Äúclient‚Äù from a certain ‚Äúsecretary‚Äù, who does not understand what is at stake, and what she needs to do, and even more so she does not understand what bitcoins are. We hoped that this should, in a sense, fuel the interest of our kulhacker, which would make him demonstrate the vulnerabilities of our engine a couple more times, if he had any left over.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also analyzed the first and second attack vectors, determined the general weakness of the site engine, and then analyzed all the scripts for suitable variables that were found to be vulnerable to the weaknesses. </font><font style="vertical-align: inherit;">Quickly closed a few more bottlenecks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The response of the kulhacker was not long in coming, again there was a threat that we would feel bad, the site was defaced again, but now the sum of requirements has decreased by 10 times, which gave us the assumption that our ward‚Äôs ideas were over, which means next time he will not come to us. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standard manipulations with the analysis of requests to the site, a new attack vector, a new set of variables, closing vulnerabilities, "rollback to a safe" state.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Episode 4. Farewell</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As expected, there were no new cases of hacking, but there was a new letter from our client stating that we were radishes, that we behaved extremely unprofessionally, and that we could pay caps at least for showing us the vulnerabilities of our engine . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We exchanged contacts, found several closed communities with 0day information, where vulnerabilities unknown to this time for our engine were published - they were pleasantly surprised. </font><font style="vertical-align: inherit;">They said thanks to Kulkhatsker and threw money on a phone whose number he didn‚Äôt tell us;)</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Episode 5. Working Moments</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
New company, new tasks. Out of my ear I hear the conversation of IT engineers about the fact that the main site of the company has been hacked for the umpteenth time, that the company that developed the site several years ago wants money for updating the engine and closing vulnerabilities, what should I do, but soon they will start tearing at the flags. I wedge myself into a conversation, I offer help. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The classic is, nevertheless, to the point of madness is simple, all kulhackers begin with this. To begin, I propose to enable the analysis of POST requests, as in GET logs it is empty that is logical. After a couple of hours, I get an answer that the hoster said that it is impossible, that they do not keep such logs, that if you want to collect POST, then collect it yourself. The guys are upset.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These are the three, I thought, and told how to force the collection of POST requests from all site scripts. </font><font style="vertical-align: inherit;">The next day, an attack vector was discovered, the vulnerability was promptly closed, and IT engineers gained invaluable experience in analyzing the situation, which they probably still use today. </font><font style="vertical-align: inherit;">There was no IS in the company.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to learn the basics of information security, start with kulhacking. </font><font style="vertical-align: inherit;">If the direction becomes interesting - step to the next step. </font><font style="vertical-align: inherit;">The more you know about hacking methods, the more you can counter attackers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And yes, when you get to the selection of access to the person, then you can begin to draw up competent IS regulations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúWhat about bots?‚Äù </font><font style="vertical-align: inherit;">- You ask. </font><font style="vertical-align: inherit;">And I will answer you: ‚ÄúAnalyze the behavior, find the attack vector, patterns and general points - you can deal with them!‚Äù </font><font style="vertical-align: inherit;">- very similar to the general approach to ensuring security in fact. </font><font style="vertical-align: inherit;">Preventive measures are only based on experience.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493074/index.html">How to find 14 IT employees in 1 month on your own</a></li>
<li><a href="../en493076/index.html">How to quickly transfer a company to remote work: a free online conference of Netology and TalentTech</a></li>
<li><a href="../en493078/index.html">Top 5 Books to Read by a Manager</a></li>
<li><a href="../en493082/index.html">How Traffic Analysis Systems Detect MITER ATT & CK Hacker Tactics Using PT Network Attack Discovery</a></li>
<li><a href="../en493084/index.html">Writing a business process in Bitrix24 with a deposit for the future</a></li>
<li><a href="../en493088/index.html">Parsing a movie theater site on Golang</a></li>
<li><a href="../en493090/index.html">Meet NestJS</a></li>
<li><a href="../en493094/index.html">Amazon warehouse workers sound alarm over coronavirus spread</a></li>
<li><a href="../en493096/index.html">Add a dark theme in iOS</a></li>
<li><a href="../en493098/index.html">Deploy ASA VPN Load-Balancing Cluster</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>