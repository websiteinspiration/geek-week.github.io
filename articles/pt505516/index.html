<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçü üõ¥ üíáüèΩ Aprendizado de m√°quina: por onde come√ßar ou como construir o primeiro modelo üë©üèæ‚Äç‚öñÔ∏è üï∫üèæ ‚ôÇÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como primeira tarefa do aprendizado de m√°quina, tomamos algo claro e simples, por exemplo, uma previs√£o do custo da moradia. O conjunto de dados pront...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Aprendizado de m√°quina: por onde come√ßar ou como construir o primeiro modelo</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505516/"><img src="https://habrastorage.org/webt/cn/mg/fr/cnmgfrvs-ej5ldlqz9cmmdjdcrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como primeira tarefa do aprendizado de m√°quina, tomamos algo claro e simples, por exemplo, uma previs√£o do custo da moradia. O conjunto de dados pronto pode ser encontrado no site da kaggle. Nas primeiras etapas do treinamento, voc√™ n√£o deve usar conjuntos de dados com um grande n√∫mero de vari√°veis, por exemplo, "Pre√ßos da habita√ß√£o: t√©cnicas avan√ßadas de regress√£o" consiste em 80 vari√°veis ‚Äã‚Äãe regress√£o avan√ßada; pararemos em "Vendas da casa em King County, EUA" com 21 par√¢metros. Fa√ßa o download dos dados e analise a descri√ß√£o fornecida. Data dispon√≠vel, pre√ßo, n√∫mero de quartos, banheiros, √°rea total e de estar, n√∫mero de andares, avalia√ß√£o da vista, vista para o mar, avalia√ß√£o do estado geral, grau (avalia√ß√£o da constru√ß√£o e projeto), √°rea acima e abaixo do n√≠vel do solo, ano da constru√ß√£o, ano da √∫ltima reparo, c√≥digo de √°rea, coordenadas (longitude e latitude), dados sobre a √°rea de casas de 15 vizinhos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por isso, escolhemos uma tarefa e estamos prontos para come√ßar a resolv√™-la. A solu√ß√£o incluir√° dois est√°gios: an√°lise de dados e constru√ß√£o de modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Trabalhe com dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos discordar e anotar separadamente a import√¢ncia da an√°lise de dados. Atualmente, todos os algoritmos mais ou menos populares j√° est√£o escritos na forma de bibliotecas e a constru√ß√£o direta do modelo √© reduzida a v√°rias linhas de c√≥digo, por exemplo, k-vizinhos mais pr√≥ximos do sklearn em python:</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn .neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<font></font>
clf_KNN = KNeighborsClassifier()       <span class="hljs-comment"># </span>
clf_KNN.fit(X_train, Y_train)          <span class="hljs-comment"># </span>
Y_KNN = clf_KNN.predict(X_test)        <span class="hljs-comment">#    </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apenas quatro linhas de c√≥digo para obter o resultado. Ent√£o, qual √© a dificuldade? A dificuldade est√° em obter o pr√≥prio X_train - os dados que s√£o alimentados na entrada do modelo. O conhecido princ√≠pio ‚Äúgarbage in‚Äù = ‚Äúgarbage in‚Äù (ingl√™s Garbage in - garbage out (GIGO)) na modelagem funciona por mais de 100% e a qualidade da solu√ß√£o obtida para o problema de aprendizado de m√°quina depender√° em grande parte do trabalho com dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E agora - para a batalha! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para an√°lise dos dados, usaremos os pandas, para entender e avaliar "a olho", usamos gr√°ficos simples do mar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importamos as bibliotecas, lemos os dados, derivamos v√°rios registros da matriz de dados, examinamos os tipos de dados e omiss√µes neles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C√≥digo e Sa√≠da</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<font></font>
df = pd.read_csv(<span class="hljs-string">'‚Ä¶/train.csv'</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/1q/cy/og/1qcyogx0fmdgtibrhx1l2b5mdty.png"><br>
<br>
<pre><code class="python hljs">df.info()</code></pre><br>
<pre><code class="plaintext hljs">RangeIndex: 21613 entries, 0 to 21612<font></font>
Data columns (total 21 columns):<font></font>
id 21613 non-null int64<font></font>
date 21613 non-null object<font></font>
price 21613 non-null float64<font></font>
bedrooms 21613 non-null int64<font></font>
bathrooms 21613 non-null float64<font></font>
sqft_living 21613 non-null int64<font></font>
sqft_lot 21613 non-null int64<font></font>
floors 21613 non-null float64<font></font>
waterfront 21613 non-null int64<font></font>
view 21613 non-null int64<font></font>
condition 21613 non-null int64<font></font>
grade 21613 non-null int64<font></font>
sqft_above 21613 non-null int64<font></font>
sqft_basement 21613 non-null int64<font></font>
yr_built 21613 non-null int64<font></font>
yr_renovated 21613 non-null int64<font></font>
zipcode 21613 non-null int64<font></font>
lat 21613 non-null float64<font></font>
long 21613 non-null float64<font></font>
sqft_living15 21613 non-null int64<font></font>
sqft_lot15 21613 non-null int64<font></font>
dtypes: float64(5), int64(15), object(1)<font></font>
memory usage: 3.5+ MB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A matriz de dados consiste em 21613 registros sem lacunas nos dados e cont√©m apenas 1 data do campo de texto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trabalharemos com cada sinal com mais detalhes e come√ßaremos com o mais simples - descartar o ID (n√£o cont√©m informa√ß√µes √∫teis), o CEP (o c√≥digo da √°rea onde a casa est√° localizada) e as coordenadas (lat e long), j√° que nos familiarizamos apenas com o aprendizado de m√°quina e a convers√£o correta de dados geogr√°ficos. Os dados s√£o muito espec√≠ficos para um especialista iniciante.</font></font><br>
<br>
<pre><code class="python hljs">df=df.drop([<span class="hljs-string">'id'</span>,<span class="hljs-string">'zipcode'</span>,<span class="hljs-string">'lat'</span>,<span class="hljs-string">'long'</span>], axis=<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos ver a data do an√∫ncio. O formato da data √© definido como AAAAMMDDTT000000, em geral, tamb√©m pode ser removido do conjunto de dados, mas temos os campos do ano de constru√ß√£o (yr_built) e do ano do √∫ltimo reparo (yr_renovated), que s√£o especificados no formato do ano (AAAA), o que n√£o √© muito informativo. Usando a data do an√∫ncio, voc√™ pode converter o ano em idade por subtra√ß√£o (ano do an√∫ncio - ano da constru√ß√£o / ano do reparo). Observamos que o ano de reparo √© 0 para algumas casas e, assumindo que isso significa que n√£o h√° reparo no edif√≠cio, substitu√≠mos os zeros no ano de reparo pelo ano de constru√ß√£o, primeiro certificando-nos de que os dados n√£o contenham registros incorretos onde o ano de reparo √© menor que o ano de constru√ß√£o:</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">'yr_renovated'</span>]&lt;df[<span class="hljs-string">'yr_built'</span>])&amp;df[<span class="hljs-string">'yr_renovated'</span>]!=<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/l7/wo/ii/l7woii1rk3buxzexbab2i4uokmq.png"><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'yr_renovated'</span>]==<span class="hljs-number">0</span>, [<span class="hljs-string">'yr_renovated'</span>]]=df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_built'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_renovated'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_renovated'</span>]<font></font>
df=df.drop(<span class="hljs-string">'date'</span>, axis=<span class="hljs-number">1</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4z/za/uw/4zzauwyidq18e0lq_8x5-up5e88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analisaremos o pre√ßo com o pr√≥ximo par√¢metro e usaremos o "Box plot" para isso. Uma caixa de bigode √© um gr√°fico simples e conveniente, mostrando uma distribui√ß√£o de probabilidade unidimensional ou, mais simplesmente, a concentra√ß√£o de dados. Desenha a mediana (a linha no centro), os quartis superior e inferior (lados da caixa), as bordas da amostra estatisticamente significativa ("bigode") e os valores extremos (pontos atr√°s do "bigode"). √â f√°cil entender a partir da figura na distribui√ß√£o normal (direita). O gr√°fico permite avaliar rapidamente onde a maioria dos dados est√° localizada (50% est√° dentro da caixa), sua simetria (desvio m√©dio para um lado da caixa e / ou o comprimento do "bigode") e o grau de dispers√£o - varia√ß√£o (tamanho da caixa, tamanho do bigode e n√∫mero de pontos - emiss√µes).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/bh/uw/bibhuwyeeexpszcl7sahfpdo8le.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â poss√≠vel construir uma distribui√ß√£o apenas dessa caracter√≠stica em toda a matriz, mas ser√° mais informativo usar 2 eixos - por exemplo, o pre√ßo e o n√∫mero de quartos, que por sua vez tamb√©m mostrar√£o a presen√ßa de uma conex√£o entre os sinais:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'price'</span>, data=df)			<span class="hljs-comment"># price</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)	<span class="hljs-comment">#price &amp; bedrooms</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fora pre√ßo e quartos: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/oh/ta/zaohtajsfsedoz8lagkzjto-oa0.png"><br>
<br>
<img src="https://habrastorage.org/webt/fn/em/4g/fnem4gwwbubwzkrhi25i4ly3j4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O gr√°fico mostra imediatamente a presen√ßa de valores extremos de pre√ßo e quartos (imagine uma casa com 33 quartos! J). A presen√ßa de tais valores (tamb√©m chamados de outliers) no pre√ßo do atributo-alvo geralmente leva √† reciclagem do modelo, pois eles geram um grande erro, que os algoritmos tentam minimizar. Pode ser visto no gr√°fico que a maioria (se calculada - 93,22%) est√° na faixa de 0-1mn e acima de 2mln - apenas 198 valores (0,92%). Como voc√™ pode se livrar de 1% do conjunto de dados de maneira quase indolor, portanto, ap√≥s acessar uma visualiza√ß√£o simples de 217 registros e classific√°-los anteriormente por pre√ßo, veremos a marca de pre√ßo desejada de 1 965 000 e excluiremos tudo acima desse pre√ßo.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values (by=<span class="hljs-string">'price'</span>, ascending=<span class="hljs-literal">False</span>).head(<span class="hljs-number">217</span>) <font></font>
df=df[df[<span class="hljs-string">'price'</span>]&lt;=<span class="hljs-number">1965000</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos pensar um pouco sobre o sinal dos quartos. </font><font style="vertical-align: inherit;">Vemos 13 casas com quartos = 0, bem como um registro estranho de uma casa com 33 quartos. </font><font style="vertical-align: inherit;">Faremos o mesmo que com o pre√ßo, removendo zeros dos quartos (e banheiros ao mesmo tempo):</font></font><br>
<br>
<pre><code class="python hljs">df=df[(df[<span class="hljs-string">'bedrooms'</span>]!=<span class="hljs-number">0</span>)&amp;(df[<span class="hljs-string">'bathrooms'</span>]!=<span class="hljs-number">0</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em rela√ß√£o √† casa com 33 quartos - considerando o pre√ßo, podemos assumir que este √© um erro de digita√ß√£o e os quartos s√£o realmente 3. Vamos comparar a √°rea habitacional desta casa (1620) com a √°rea habit√°vel m√©dia das casas com 3 quartos (1798,2), que provavelmente √© nosso palpite, portanto, basta alterar esse valor para 3 e criar o gr√°fico de caixa anterior novamente:</font></font><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'bedrooms'</span>]==<span class="hljs-number">33</span>,[<span class="hljs-string">'bedrooms'</span>]]=<span class="hljs-number">3</span> 
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/qi/wd/fs/qiwdfscthapolbucfyjqy-uoggc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, muito melhor. </font><font style="vertical-align: inherit;">Da mesma forma, os quartos olham para os banheiros. </font><font style="vertical-align: inherit;">Exclu√≠mos zero valores, n√£o h√° outros valores extremos no campo:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'bathrooms'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos campos sqft_living, floor, waterfront, view, condition, grade, sqft_living15 tamb√©m todos os valores s√£o mais ou menos reais, n√£o os tocaremos:</font></font><br>
<br>
<pre><code class="python hljs">plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">2</span>,<span class="hljs-number">3</span> 			<span class="hljs-comment"># </span>
sns.boxplot(y=<span class="hljs-string">'sqft_living'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'floors'</span>,color=<span class="hljs-string">'#2ecc71'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'sqft_living15'</span>,color=<span class="hljs-string">'#9b59b6'</span>, data=df) <font></font>
plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">4</span>,<span class="hljs-number">4</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'waterfront'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'view'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'condition'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'grade'</span> , data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/uw/h8/oquwh8x-cln4tbaz9xrzqyk9szs.png"><br>
<br>
<img src="https://habrastorage.org/webt/yl/ns/bz/ylnsbzq_kx2dtvrvjy8iytxudve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas com sqft_lot e sqft_lot15, voc√™ precisa criar algo e, devido aos grandes valores, o logaritmo √© bastante adequado:</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sqft_lot'</span>]=np.log(df[<span class="hljs-string">'sqft_lot'</span>])<font></font>
df[<span class="hljs-string">'sqft_lot15'</span>]=np.log(df[<span class="hljs-string">'sqft_lot15'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_lot antes e depois: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/up/g2/yrupg24jwmfsptci9hf8uaq6wmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_above e sqft_basement s√£o os componentes do sqft_living, por isso n√£o vamos toc√°-los tamb√©m. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com isso, terminaremos com uma an√°lise preliminar e examinaremos o mapa de calor das correla√ß√µes:</font></font><br>
<br>
<pre><code class="python hljs">sns.heatmap(df.corr(),  cmap = <span class="hljs-string">'viridis'</span>,annot = <span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/ny/yi/uq/nyyiuqa9zbilc9l6gqzljfe35xu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de examinar o mapa de correla√ß√£o, vemos que algumas vezes os atributos est√£o fortemente correlacionados entre si, portanto, exclu√≠mos alguns dos atributos com alta correla√ß√£o - sqft_lot15 (deixe sqft_lot), yr_built (deixe yr_renovated), sqft_above (sqft_living). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso conclui o trabalho com os dados e prossegue com a cria√ß√£o do modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Modelagem </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta parte, construiremos 2 modelos: regress√£o linear e √°rvore de decis√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os modelos que precisamos est√£o contidos na biblioteca sklearn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, separamos a vari√°vel de destino do restante dos dados para treinamento e tamb√©m dividimos as amostras em treinamento (70%) e teste (30%, no qual verificaremos como o modelo funciona):</font></font><br>
<br>
<pre><code class="python hljs">Y=df[<span class="hljs-string">'price'</span>]<font></font>
X=df.drop (<span class="hljs-string">'price'</span>,axis=<span class="hljs-number">1</span>) 
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X_train, X_test, Y_train, Y_test  = train_test_split(X, Y, test_size = <span class="hljs-number">0.3</span>, shuffle = <span class="hljs-literal">True</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, no sklearn, para avaliar o modelo, enviamos tr√™s m√©tricas - mean_absolute_error (erro absoluto m√©dio), mean_squared_error (desvio padr√£o), r2_score (coeficiente de determina√ß√£o):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar com a regress√£o linear:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression<font></font>
LR = LinearRegression() 				<span class="hljs-comment"># </span>
LR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_LR = LR.predict(X_test)				<span class="hljs-comment">#       </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_LR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_LR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_LR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 124477.452 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 175205.645 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.627 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Årvore de </font><font style="vertical-align: inherit;">decis√£o </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor<font></font>
TR = DecisionTreeRegressor()				<span class="hljs-comment"># </span>
TR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_TR=TR.predict(X_test)  				<span class="hljs-comment">#   </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_TR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_TR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 151734.906 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 220856.721 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.407 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base nas m√©tricas, podemos concluir que a regress√£o linear mostrou o melhor resultado, por isso √© mais l√≥gico escolher. No entanto, n√£o perguntamos em que consiste o erro do modelo, se o modelo √© treinado novamente etc. √â bem prov√°vel que tenha sido o treinamento que levou √† deteriora√ß√£o do resultado do DecisionTreeRegressor, pois nem sequer limitamos a profundidade da √°rvore nos par√¢metros do modelo. Podemos verificar isso facilmente, classificando a profundidade das √°rvores em um curto ciclo:</font></font><br>
<br>
<pre><code class="python hljs">dep,score=[],[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>,<span class="hljs-number">16</span>):<font></font>
    TR = DecisionTreeRegressor(max_depth=i)<font></font>
    TR.fit(X_train, Y_train)<font></font>
    Y_TR=TR.predict(X_test)<font></font>
    dep.append(i)<font></font>
    score.append(mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))	<span class="hljs-comment">#  ‚àöMSE</span>
		plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">6</span>,<span class="hljs-number">3</span>
		plt.plot(dep, score)</code></pre><br>
<img src="https://habrastorage.org/webt/ar/fn/yt/arfnytm068lhpknk_ifnpshupgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, o melhor indicador em max_depth = 7 e observando as m√©tricas (MAE: 124861.441, ‚àöMSE 175322.737, R2_score: 0.626), fica claro que um modelo com essa restri√ß√£o √© semelhante a uma regress√£o linear na qualidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m podemos tentar avaliar quais atributos eram mais importantes para o modelo de previs√£o de custo: com </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/qx/qw/x1qxqwlhqbfotpp45hhyr4nz0uc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
base no gr√°fico, fica claro que a nota afeta o custo mais - uma avalia√ß√£o subjetiva geral da casa por uma empresa imobili√°ria (que, a prop√≥sito, indica a compet√™ncia da avalia√ß√£o :-))), em segundo lugar √© a √°rea da casa, e em terceiro - o ano do √∫ltimo reparo. Os indicadores consideraram o n√∫mero de quartos, banheiros, pisos, o modelo considerado insignificante para a previs√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender melhor os resultados, calculamos o erro m√©dio em% - de acordo com a regress√£o linear, o erro m√©dio √© de 27,5%, ou seja, o modelo comete um pouco mais de erro que um quarto ao prever o custo de uma casa, o que √© bastante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os resultados podem ser melhorados? </font><font style="vertical-align: inherit;">Sim, √© claro, no est√°gio atual, recebemos apenas uma solu√ß√£o b√°sica - algum ponto de partida para compara√ß√£o ser√° modelos melhores ou piores que podemos criar usando m√©todos mais sofisticados ou processamento de dados mais complexo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apenas tocamos um pouco a quest√£o da reciclagem e n√£o tocamos em nada sobre o que consiste o erro do modelo e muitos outros aspectos da cria√ß√£o do modelo. </font><font style="vertical-align: inherit;">Como regra, v√°rios m√©todos de valida√ß√£o de modelo s√£o usados ‚Äã‚Äãpara responder a essas perguntas e encontrar a solu√ß√£o ideal, mas escreveremos sobre isso nos artigos a seguir.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt505498/index.html">Como resolvemos o problema de mem√≥ria de pilha n√£o inicializada no Windows</a></li>
<li><a href="../pt505502/index.html">Omnichannel no atendimento ao cliente: o que procurar e como fazer tudo certo?</a></li>
<li><a href="../pt505506/index.html">Ele n√£o morde: como tornar os rob√¥s industriais seguros para os trabalhadores</a></li>
<li><a href="../pt505508/index.html">N√£o apenas tecnologia n√£o tripulada: o futuro da ind√∫stria automotiva</a></li>
<li><a href="../pt505510/index.html">Simplificando a API do Check Point com o Python SDK</a></li>
<li><a href="../pt505522/index.html">Monetiza√ß√£o em jogos online: como usar a experi√™ncia de outra pessoa para suas pr√≥prias necessidades</a></li>
<li><a href="../pt505528/index.html">A coisa mais importante no Wi-Fi 6. N√£o, s√©rio</a></li>
<li><a href="../pt505530/index.html">Google faz seu processador e AMD est√° se preparando para destruir a Qualcomm</a></li>
<li><a href="../pt505532/index.html">Canais de telegrama sobre desenvolvimento de jogos: parte 2</a></li>
<li><a href="../pt505536/index.html">Como cozinhar o rastreamento de chamadas: experi√™ncia ciana</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>