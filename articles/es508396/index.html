<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéôÔ∏è üî∑ üë©üèº‚Äçüåæ Transferencia de din√°mica molecular a CUDA. Parte I: Lo B√°sico üé¶ üòπ üìá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El prop√≥sito de este art√≠culo es plantear los problemas de paralelizar el c√≥digo de un programa para el modelado num√©rico utilizando el m√©todo de din√°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Transferencia de din√°mica molecular a CUDA. Parte I: Lo B√°sico</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/508396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El prop√≥sito de este art√≠culo es plantear los problemas de paralelizar el c√≥digo de un programa para el modelado num√©rico utilizando el m√©todo de din√°mica molecular (MD) utilizando la tecnolog√≠a CUDA. ¬øPor qu√© es esto necesario, ya que los paquetes de software MD ya existen, incluidos los que funcionan en CUDA? El hecho es que estoy desarrollando mi propio concepto de un "campo de fuerza no constante", que no est√° implementado en los programas MD existentes. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rehacer el c√≥digo de otra persona para estas necesidades es una tarea bastante ingrata, por lo que decid√≠ transferir mi c√≥digo secuencial ya escrito y, al mismo tiempo, compartir algunas ideas. Adem√°s, esta es una respuesta al comentario que a menudo parpadea aqu√≠ en art√≠culos de CUDA como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, ¬øqu√© es la din√°mica molecular? </font><font style="vertical-align: inherit;">En Habr√© ya hay varias publicaciones sobre este tema, por ejemplo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Brevemente, MD es un m√©todo que le permite simular el movimiento de muchas part√≠culas (incluidos √°tomos, iones, mol√©culas) y calcular las propiedades colectivas del sistema, dependiendo de este movimiento. </font><font style="vertical-align: inherit;">¬øC√≥mo funciona? </font><font style="vertical-align: inherit;">Suponga que para un conjunto de N part√≠culas se dan algunas coordenadas iniciales, velocidades, masas y (¬°lo m√°s importante!) Leyes de interacci√≥n entre ellas. </font><font style="vertical-align: inherit;">Cambiamos las coordenadas seg√∫n las velocidades. </font><font style="vertical-align: inherit;">En base a las leyes de interacci√≥n, calculamos las fuerzas que act√∫an entre las part√≠culas. </font><font style="vertical-align: inherit;">Como conocemos la fuerza y ‚Äã‚Äãla masa, conocemos la aceleraci√≥n. </font><font style="vertical-align: inherit;">Ajustamos la velocidad teniendo en cuenta la aceleraci√≥n. </font><font style="vertical-align: inherit;">Y nuevamente, pasamos a cambiar las coordenadas. </font><font style="vertical-align: inherit;">Y as√≠ repetimos mil veces hasta </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que te canses</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No obtendremos suficientes estad√≠sticas.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/getpro/habr/post_images/d14/4f3/4f0/d144f34f09888282c2118202bc8d201a.jpg" alt="imagen">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En aplicaciones reales, la secuencia de c√°lculos de la "coordenada - velocidad - fuerza" es algo m√°s complicada, basada en la expansi√≥n en una serie de funciones de la coordenada de part√≠culas. El m√°s com√∫n es el algoritmo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocity Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . El pseudoc√≥digo del programa MD basado en el integrador Verlet es el siguiente:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">init_md;
<span class="hljs-keyword">int</span> iStep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (iStep &lt; nStep)<font></font>
{<font></font>
    reset_quantities;<font></font>
    clear_cell_list;<font></font>
    verlet_1stage;<font></font>
    forces_calculation;<font></font>
    verlet_2stage;<font></font>
    temp_scale;<font></font>
    termostat;<font></font>
    some_output;<font></font>
    iStep++;<font></font>
}<font></font>
final_md; <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bucle principal del programa ejecuta un n√∫mero de veces especificado por el usuario ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nStep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Una iteraci√≥n de este ciclo se llama un paso de tiempo, o simplemente un paso de tiempo. </font><font style="vertical-align: inherit;">No se considerar√°n las </font><font style="vertical-align: inherit;">funciones </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INIT_MD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some_output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , leen informaci√≥n de entrada, valores a cero, emite los datos, asignan y liberan memoria, etc. Desde el punto de vista de la salida de informaci√≥n, la din√°mica molecular es ideal para los c√°lculos en una tarjeta de video: la mayor√≠a de los c√°lculos no necesitan ser descargados. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funciones </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_2stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se relacionan con el integrador de ecuaciones de movimiento y temperatura. </font><font style="vertical-align: inherit;">La funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">force_calculation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcula las fuerzas que act√∫an entre las part√≠culas, y la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clear_cell_list se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> refiere a la t√©cnica de acelerar los c√°lculos (m√°s sobre esto m√°s adelante). </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere todos estos grupos de funciones.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Integraci√≥n de ecuaciones de movimiento</font></font></h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La esencia de la primera etapa del algoritmo Verlet se puede expresar mediante las siguientes f√≥rmulas:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.568ex" height="5.134ex" viewBox="0 -1455.1 9716.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-58" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2B" x="3261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-56" x="4262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-64" x="5031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-74" x="5555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2B" x="6138" y="0"></use><g transform="translate(6917,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-64" x="8377" y="0"></use><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-32" x="511" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X = X + Vdt + \frac{F}{m}dt^2</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2E" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">V = V + \frac{F}{m}\frac{dt}{2}. </script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segundo:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2C" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">V = V + \frac{F}{m}\frac{dt}{2},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donde X es la coordenada de la part√≠cula, V es su velocidad, F es la fuerza que act√∫a sobre ella, m es su masa y dt es el paso del tiempo. </font><font style="vertical-align: inherit;">Todo esto se aplica a todas las part√≠culas y, naturalmente, ocurre en 3 dimensiones, por lo tanto:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_1stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i, t
  <span class="hljs-keyword">float</span> charge;
  <span class="hljs-keyword">float</span> engElecField = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//     </span>
  __shared__ <span class="hljs-keyword">float</span> shEngElField;	<span class="hljs-comment">// shared   </span><font></font>
<font></font>
  <span class="hljs-comment">//    shared </span>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shEngElField = <span class="hljs-number">0</span>;<font></font>
    __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//   ,     </span>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
<font></font>
     t = md-&gt;types[i];<font></font>
     charge = md-&gt;specs[t].charge;<font></font>
<font></font>
     <span class="hljs-comment">//  v = v + f/m * 0.5 dt</span><font></font>
     md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
     md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
     md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
     <span class="hljs-comment">// x = x + v * dt</span><font></font>
     md-&gt;xyz[i].x += md-&gt;vls[i].x * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].y += md-&gt;vls[i].y * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].z += md-&gt;vls[i].z * md-&gt;tSt;<font></font>
<font></font>
     put_periodic(&amp;md-&gt;xyz[i], md-&gt;vls[i], md-&gt;masses[i], md-&gt;types[i], md);<font></font>
<font></font>
     keep_in_cell(i, md-&gt;xyz[i], md);<font></font>
<font></font>
     <span class="hljs-comment">//   </span>
     engElecField += charge * md-&gt;xyz[i].x * md-&gt;elecField.x; <span class="hljs-comment">// Eng = q * x * dU/dx</span><font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//     shared ‚Ä¶</span><font></font>
  atomicAdd(&amp;shEngElField, engElecField);<font></font>
   __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//..    </span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)   <span class="hljs-comment">// 0th thread</span><font></font>
  {<font></font>
      atomicAdd(&amp;md-&gt;engElecField, shEngElField);<font></font>
  }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los par√°metros de entrada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerBlock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerTherad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son iguales al n√∫mero de part√≠culas (√°tomos) procesadas por un bloque y corriente, respectivamente. </font><font style="vertical-align: inherit;">Dado que el n√∫mero de √°tomos en tales c√°lculos suele ser constante, estas variables se pueden calcular de una vez por todas en alg√∫n lugar de la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El par√°metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">tipo * cudaMD es un enlace a la estructura, que contiene enlaces a todas las variables necesarias para el c√°lculo, tales como:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el n√∫mero de part√≠culas;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : una matriz de coordenadas de tipo float3;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vls</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : una matriz de velocidades de tipo float3 (3 componentes del vector);</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - conjunto de fuerzas (tambi√©n 3 componentes del vector);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rMasshdT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> almacena </font><b><font style="vertical-align: inherit;">inmediatamente</font></b><font style="vertical-align: inherit;"> la expresi√≥n 0.5 * dt * m para cada part√≠cula;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : un conjunto de tipos de part√≠culas, porque los √°tomos pueden ser diferentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La matriz de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificaciones</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> almacena propiedades de part√≠culas, masa, carga, etc. </font><font style="vertical-align: inherit;">Para obtener las propiedades de la i-√©sima part√≠cula, debe invertir la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificaci√≥n de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> forma </font><b><font style="vertical-align: inherit;">[tipos [i]]</font></b><font style="vertical-align: inherit;"> .</font></font></li>
</ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combin√© todo esto en una estructura para no pasar un mont√≥n de par√°metros a la funci√≥n. </font><font style="vertical-align: inherit;">¬øQuiz√°s esta no sea la mejor soluci√≥n? </font><font style="vertical-align: inherit;">¬øQuiz√°s vali√≥ la pena declararlas variables globales? </font><font style="vertical-align: inherit;">No en el sentido de que est√°n en la memoria global, sino en el hecho de que son visibles en todas las funciones del programa. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discutiremos la </font><font style="vertical-align: inherit;">funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keep_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la secci√≥n para acelerar los c√°lculos, y la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coloca una part√≠cula en un volumen simulado (recuadro) si sale de ella (como en un pacman, como se dice</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atrevimiento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en su post sobre MD). </font><font style="vertical-align: inherit;">Bueno, dado que la funci√≥n descrita realiza una actualizaci√≥n de las coordenadas de las part√≠culas, tiene sentido calcular todas las energ√≠as que dependen solo de las coordenadas, por ejemplo, la energ√≠a de las part√≠culas en un campo externo, si existe. </font><font style="vertical-align: inherit;">De aqu√≠ en adelante, seg√∫n un comentario v√°lido</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elimin√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la funci√≥n del c√≥digo, </font><b><font style="vertical-align: inherit;">elimin√© la puesta a</font></b><font style="vertical-align: inherit;"> cero de variables como </font><b><font style="vertical-align: inherit;">md-&gt; engElecField</font></b><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ahora est√° seleccionada para estos fines </font><font style="vertical-align: inherit;">. La pregunta sobre la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es la </font><font style="vertical-align: inherit;">siguiente: </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algunas variables (coordenadas, velocidades, etc.) se usan varias veces y ¬øes recomendable descargarlas primero en una memoria m√°s r√°pida? ¬øO es el compilador capaz de optimizar tales cosas por s√≠ mismo?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hace que una part√≠cula que vuela fuera de los bordes de la regi√≥n simulada (recuadro) aparezca en su otro lado (condiciones de contorno peri√≥dicas):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">put_periodic</span><span class="hljs-params">(float3&amp; xyz, float3 vel, <span class="hljs-keyword">float</span> mass, <span class="hljs-keyword">int</span> type, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">if</span> (xyz.x &lt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
      xyz.x += md-&gt;leng.x;<font></font>
<font></font>
      atomicAdd(&amp;md-&gt;specAcBoxNeg[type].x, <span class="hljs-number">1</span>); <font></font>
      atomicAdd(&amp;md-&gt;negMom.x, mass * (-vel.x)); <font></font>
   }<font></font>
   <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> (xyz.x &gt;= md-&gt;leng.x)<font></font>
     {<font></font>
        xyz.x -= md-&gt;leng.x;<font></font>
<font></font>
        atomicAdd(&amp;md-&gt;specAcBoxPos[type].x, <span class="hljs-number">1</span>);<font></font>
        atomicAdd(&amp;md-&gt;posMom.x, mass * vel.x);<font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La funci√≥n funciona para una caja con la geometr√≠a de una caja rectangular. </font><font style="vertical-align: inherit;">El c√≥digo es para medir x, el resto de las medidas son completamente similares. </font><font style="vertical-align: inherit;">Los </font><b><font style="vertical-align: inherit;">campos </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revLeng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son el tama√±o del cuadro en la dimensi√≥n correspondiente y su valor inverso. </font><font style="vertical-align: inherit;">En general, para devolver una part√≠cula al boxeo, puede prescindir de operadores condicionales:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">xyz.x -= <span class="hljs-built_in">floor</span>(xyz.x * md-&gt;revLeng.x) * md-&gt;leng.x;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilic√© operadores condicionales en la versi√≥n en serie, porque ten√≠a que contar el n√∫mero de part√≠culas que pasaban a trav√©s del l√≠mite de la caja y el momento total de estas part√≠culas (la presi√≥n se puede expresar a partir de √©l). </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estos contadores tambi√©n est√°n incluidos en el c√≥digo anterior, quiz√°s para CUDA deber√° pensar en c√≥mo prescindir de ellos</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La segunda parte del integrador de velocidad Verlet:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_2stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i;
  <span class="hljs-keyword">float</span> kinE = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//  </span>
  __shared__ <span class="hljs-keyword">float</span> shKinE;	<span class="hljs-comment">// shared </span><font></font>
<font></font>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-comment">//     shared </span>
 <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shKinE = <span class="hljs-number">0.0</span>;<font></font>
  __syncthreads();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// v = v + f/m * 0.5 dt</span>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
    md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
    md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
    md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
    <span class="hljs-comment">//  mv2</span><font></font>
    kinE += (md-&gt;vls[i].x * md-&gt;vls[i].x + md-&gt;vls[i].y  * md-&gt;vls[i].y + md-&gt;vls[i].z * md-&gt;vls[i].z) * md-&gt;masses[i];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//      shared memory...</span>
  atomicAdd(&amp;shKinE, <span class="hljs-number">0.5</span> * kinE);   <span class="hljs-comment">// kinE = mv2/2</span><font></font>
  __syncthreads();<font></font>
  <span class="hljs-comment">//...   global memory</span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     atomicAdd(&amp;md-&gt;engKin, shKinE);<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo de estructura es completamente similar a la primera parte del integrador. Actualizamos las velocidades para cada part√≠cula, resumimos la energ√≠a cin√©tica. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La "temperatura" funciona </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Los sistemas moleculares difieren de los mec√°nicos en que tienen el concepto de temperatura. MD hered√≥ la definici√≥n de temperatura de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la teor√≠a de la cin√©tica molecular</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde la temperatura es un valor proporcional a la energ√≠a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">cin√©tica</font></a><font style="vertical-align: inherit;"> promedio de las part√≠culas (hay razones para creer que esto es una falacia). Para mantener la temperatura deseada en tales t√©rminos, simplemente puede escalar las velocidades de las part√≠culas, como lo hace la funci√≥n temp_scale:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">temp_scale</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">float</span> k;
   <span class="hljs-keyword">int</span> i;
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   k = <span class="hljs-built_in">sqrt</span>(md-&gt;teKin / md-&gt;engKin);
   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)<font></font>
   {<font></font>
      md-&gt;vls[i].x *= k;<font></font>
      md-&gt;vls[i].y *= k;<font></font>
      md-&gt;vls[i].z *= k;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
    <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;teKin;<font></font>
     }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El campo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiene la energ√≠a cin√©tica objetivo, es proporcional a la temperatura establecida por el usuario. La funci√≥n simplemente multiplica todos los componentes de los vectores de velocidad por k, y luego una corriente establece la energ√≠a cin√©tica igual al valor dado. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠, la variable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> define en cada subproceso, aunque es posible definirlo en uno (ya que es el mismo) para no hacer un trabajo innecesario, especialmente porque la ra√≠z cuadrada est√° involucrada.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tal escala de temperatura primitiva se usa generalmente en las etapas preliminares de la simulaci√≥n (per√≠odo de equilibrio) con una frecuencia de varios pasos. </font><font style="vertical-align: inherit;">Algoritmos de mantenimiento de temperatura m√°s sofisticados (termostatos) simulan colisiones de part√≠culas con un cierto dep√≥sito de una temperatura dada, el m√°s popular es el termostato </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nose-Hoover</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">tstat_nose</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//   if (!blockIdx.x)</span>
<span class="hljs-comment">//     if (!threadIdx.x)   </span>
<span class="hljs-comment">//        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass;</span>
<span class="hljs-comment">//   __synctreads();</span><font></font>
<font></font>
   <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> - md-&gt;tSt * md-&gt;chit;<font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
       md-&gt;vls[i].x *= scale;<font></font>
       md-&gt;vls[i].y *= scale;<font></font>
       md-&gt;vls[i].z *= scale;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
     <span class="hljs-keyword">if</span> (!threadIdx.x)   <font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;engKin * scale * scale;<font></font>
        md-&gt;consInt += md-&gt;tSt * md-&gt;chit * md-&gt;qMassTau2;<font></font>
        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass; <font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La diferencia con la funci√≥n anterior est√° solo en una definici√≥n m√°s compleja del factor de correcci√≥n. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resumir este grupo de funciones. </font><font style="vertical-align: inherit;">Todos ellos est√°n perfectamente paralelizados, no solo porque realizan exactamente las mismas acciones para todas las part√≠culas, sino tambi√©n porque no requieren referencias cruzadas. </font><font style="vertical-align: inherit;">La secuencia, que procesa matrices con √≠ndice i, no accede al √≠ndice j, no hay conflicto de acceso a los mismos datos.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 C√°lculo de fuerzas y lista de celdas</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los sistemas moleculares, la principal fuente de fuerzas que act√∫an sobre la part√≠cula (a excepci√≥n de los campos externos ya mencionados) son otras part√≠culas. </font><font style="vertical-align: inherit;">El c√°lculo de estas fuerzas es la parte m√°s compleja, lenta y ambigua del MD. </font><font style="vertical-align: inherit;">Una de las aproximaciones m√°s simples es que todas las interacciones en el sistema son la suma de las interacciones entre CADA par de part√≠culas (aproximaci√≥n por pares). </font><font style="vertical-align: inherit;">Para estos fines, se introduce un potencial de par, una dependencia funcional de la energ√≠a potencial de interacci√≥n de dos part√≠culas en la distancia entre ellas. </font><font style="vertical-align: inherit;">Los potenciales de pareja m√°s famosos: el potencial de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lennard-Jones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (o "6-12"), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buckingham</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y Born-Mayer-Huggins. </font><font style="vertical-align: inherit;">Por ejemplo, dar√© las expresiones anal√≠ticas de los dos primeros:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mn>4</mn><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>&amp;#x2212;</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.901ex" height="5.634ex" viewBox="0 -1616.6 8137.9 2425.9" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-34" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-3F5" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-28" x="3008" y="0"></use><g transform="translate(3398,0)"><g transform="translate(120,0)"><rect stroke="none" width="1146" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-36" x="810" y="513"></use></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2212" x="5007" y="0"></use><g transform="translate(5785,0)"><g transform="translate(342,0)"><rect stroke="none" width="1500" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-3C3" x="0" y="0"></use><g transform="translate(572,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-32" x="500" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-29" x="7748" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mn>4</mn><mi>œµ</mi><mo stretchy="false">(</mo><mfrac><msup><mi>œÉ</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>‚àí</mo><mfrac><msup><mi>œÉ</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">U=4\epsilon(\frac{\sigma^6}{r^6}-\frac{\sigma^{12}}{r^{12}})</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mi>r</mi><mi>&amp;#x03C1;</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.645ex" height="5.634ex" viewBox="0 -1455.1 9750.1 2425.9" role="img" focusable="false" style="vertical-align: -2.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-41" x="2101" y="0"></use><g transform="translate(3018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-28" x="4548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2212" x="4937" y="0"></use><g transform="translate(5716,0)"><g transform="translate(120,0)"><rect stroke="none" width="637" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-72" x="93" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-3C1" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-29" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2212" x="7205" y="0"></use><g transform="translate(7983,0)"><g transform="translate(342,0)"><rect stroke="none" width="1025" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-43" x="132" y="676"></use><g transform="translate(60,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhjdl0ZXX1PlTWbcfzJ4wYauPCNMtw#MJMAIN-2C" x="9471" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mo>‚àí</mo><mfrac><mi>r</mi><mi>œÅ</mi></mfrac><mo stretchy="false">)</mo><mo>‚àí</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">U=A\exp(-\frac{r}{\rho})-\frac{C}{r^6},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donde U es la energ√≠a potencial de un par de part√≠culas, r es la distancia entre las part√≠culas, y todas las dem√°s letras son par√°metros que dependen solo del tipo de part√≠culas que interact√∫an y se establecen en la etapa de inicializaci√≥n. Sin embargo, incluso m√°s que la energ√≠a, estamos interesados ‚Äã‚Äãen las fuerzas de interacci√≥n entre estas part√≠culas. Las fuerzas son triviales, a trav√©s de la derivada del potencial del par, para lo cual tambi√©n es f√°cil obtener una expresi√≥n anal√≠tica y coser en el programa. Y, dado que la fuerza de acci√≥n es igual a la fuerza de la reacci√≥n, obtenemos inmediatamente las fuerzas que act√∫an sobre ambas part√≠culas, pseudoc√≥digo:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">U = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)
	<span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; N<span class="hljs-number">-1</span>; j++)<font></font>
	{<font></font>
		dx = x[i] ‚Äì x[j];<font></font>
		dy = y[i] ‚Äì y[j];<font></font>
		dz = z[i] ‚Äì z[j];<font></font>
		r = <span class="hljs-built_in">sqrt</span>(dx*dx + dy*dy + dz*dz);<font></font>
		U += pair_pot(r, types[i], types[j]);<font></font>
		F = force(r, types[i], types[j])<font></font>
		fx[i] = F * dx;<font></font>
		fx[j] = -F * dx;<font></font>
		fy[i] = F * dy;<font></font>
		fy[j] = -F * dy;<font></font>
		fz[i] = F * dz;<font></font>
		fz[j] = -F * dz;<font></font>
<font></font>
	}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo es simple: encontramos la distancia entre las part√≠culas, la sustituimos en la funci√≥n por el potencial del par y en la funci√≥n por la fuerza (ambas dependen de los tipos de part√≠culas que interact√∫an) y calculamos la proyecci√≥n de las fuerzas. El ciclo se realiza N (N-1) / 2 veces, donde N es el n√∫mero de part√≠culas. Para reducir al menos de alguna manera el n√∫mero de c√°lculos, podemos aprovechar el hecho de que el valor de estos potenciales disminuye r√°pidamente con la distancia. A distancias mayores de 6-8 angstroms, el potencial no puede calcularse, ser√° casi cero. Agregando la condici√≥n para verificar la distancia (o m√°s bien su cuadrado) reduciremos el n√∫mero de c√°lculos, pero no el n√∫mero de iteraciones del ciclo. Para sistemas grandes, la mayor√≠a de las comprobaciones dar√°n falso. Las siguientes t√©cnicas pueden reducir el n√∫mero de comprobaciones al soltar parte de pares con una gran distancia interat√≥mica conocida.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay dos m√©todos principales para reducir el n√∫mero de b√∫squedas de pares de part√≠culas: una lista de vecinos (tambi√©n conocida como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verlet list</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) y una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de celdas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(lista de celdas). En el primero, para cada part√≠cula recordamos a sus vecinos que est√°n dentro del radio del potencial. La lista de vecinos debe actualizarse con cierta periodicidad previamente desconocida, lo cual es una desventaja del m√©todo. Por lo tanto, deteng√°monos en la lista de celdas, cuya esencia es dividir el volumen (cuadro) simulado en (sub) celdas. Inicialmente, el tama√±o de celda se eligi√≥ para ser mayor o igual que el radio de corte. Entonces es suficiente clasificar los pares de part√≠culas dentro de cada celda y entre celdas adyacentes. El tama√±o de la celda puede ser diferente, lo principal es determinar qu√© pares de celdas debe verificar. De hecho, este es un intento de describir la esfera en cubos. Tradicionalmente, para implementar una lista de celdas en c√≥digo secuencial, se introducen dos matrices, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El tama√±o de la primera es igual al n√∫mero de c√©lulas, el segundo al n√∫mero de part√≠culas. </font><font style="vertical-align: inherit;">El primero almacena el √≠ndice de una de las part√≠culas en una celda determinada, los √≠ndices de la segunda corresponden a los √≠ndices de las part√≠culas y el contenido corresponde al √≠ndice de la siguiente part√≠cula en la celda (-1, si no hay m√°s part√≠culas en la celda), la ilustraci√≥n se muestra a continuaci√≥n. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/tu/bw/hu/tubwhuvbci2oc2uxlupu3nt4zsc.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El pseudoc√≥digo para atravesar dicha lista dentro de una celda con el √≠ndice cell_index:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">i = head[cell_index];
<span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
{<font></font>
      j = <span class="hljs-built_in">list</span>[i];
      <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
              i-j;<font></font>
           j = <span class="hljs-built_in">list</span>[j];<font></font>
      }<font></font>
i = <span class="hljs-built_in">list</span>[i]; <font></font>
}	<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora intentemos implementar una lista de celdas en CUDA. </font><font style="vertical-align: inherit;">En la aproximaci√≥n cero, simplemente distribuimos un rango de celdas a cada flujo, de lo contrario, dejamos un c√≥digo secuencial para enumerar pares de part√≠culas dentro de la celda y pares que involucran part√≠culas de c√©lulas vecinas. </font><font style="vertical-align: inherit;">Para cada celda </font><b><font style="vertical-align: inherit;">, se</font></b><font style="vertical-align: inherit;"> debe definir una matriz de celdas vecinas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lstHNeig [iC] [jC]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el n√∫mero de estas vecinas, una matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nHeadNeig []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cellPerBlock, <span class="hljs-keyword">int</span> cellPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iC, jC;	<span class="hljs-comment">//  </span>
   <span class="hljs-keyword">int</span> i, j;	<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * cellPerBlock + threadId.x * cellPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">for</span> (iC = id0; iC &lt; N; iC++)<font></font>
   {<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         <span class="hljs-comment">//    </span><font></font>
         j = md-&gt;clist[i]; 	<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
               i-j;<font></font>
            j = md-&gt;clist[j];  <font></font>
         }<font></font>
<font></font>
         <span class="hljs-comment">//    </span>
         <span class="hljs-keyword">for</span> (jC = <span class="hljs-number">0</span>; jC &lt; md-&gt;nHeadNeig[iC]; jC++)<font></font>
         {<font></font>
            j = md-&gt;chead[md-&gt;lstHNeig[iC][jC]];<font></font>
            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                  i-j;    <font></font>
               j = md-&gt;clist[j];<font></font>
            }<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En mi opini√≥n, dicha implementaci√≥n no revela completamente el potencial de una tarjeta de video, ya que un solo flujo procesa una celda, que, como regla, es significativamente menor que el n√∫mero de part√≠culas. En segundo lugar, dentro de la funci√≥n de procesar un par de part√≠culas, es posible trabajar solo a trav√©s de operaciones at√≥micas. Intentemos paralelizar la tarea m√°s fuertemente, deje que cada hilo procese un par de celdas vecinas (creemos que ya se ha creado una lista de tales pares):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pairPerBlock, <span class="hljs-keyword">int</span> pairPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, jC;	<span class="hljs-comment">//     </span>
   <span class="hljs-keyword">int</span> i, j;		<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * pairPerBlock + threadId.x * pairPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (iP = id0; iC &lt; N; iP++)<font></font>
   {<font></font>
      iC = md-&gt;cellPairs[iP].x;<font></font>
      jC = md-&gt;cellPairs[iP].y;<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         j = md-&gt;chead[jC];<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
                i-j;<font></font>
             j = md-&gt;clist[j];<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La matriz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellPairs []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiene el n√∫mero de pares de celdas vecinas (.x es la primera celda del par, .y es la segunda). El c√≥digo es m√°s simple y elegante, pero aqu√≠ desaparece el procesamiento de pares de part√≠culas dentro de una celda, para lo cual se debe escribir una funci√≥n separada. Hay otro problema, la organizaci√≥n de la lista de celdas y su rastreo son ineficientes para la computaci√≥n paralela, porque para obtener el √≠ndice de la siguiente part√≠cula en la celda, debe ejecutar todas las anteriores. Intentemos crear un c√≥digo y una estructura de datos m√°s eficientes para que un par de celdas puedan ser procesadas por varios hilos a la vez. Ahora deje que la lista de celdas se almacene en una </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matriz bidimensional </font><b><font style="vertical-align: inherit;">[] []</font></b><font style="vertical-align: inherit;"> , donde el primer √≠ndice define el n√∫mero de la celda y el segundo, el n√∫mero at√≥mico dentro de la celda. Tambi√©n almaceno el n√∫mero de part√≠culas en una celda en el elemento cero de la matriz:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda [i] [0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , el valor de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda [i] [j + 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es igual al √≠ndice general de la part√≠cula en la memoria global. Es cierto que tal implementaci√≥n requiere conocer el n√∫mero m√°ximo de part√≠culas en una c√©lula y ocupar√° m√°s memoria. Tambi√©n dividiremos nuestra tarea en 2 subtareas. La primera funci√≥n calcular√° la interacci√≥n en pares de celdas disjuntos (por ejemplo, con √≠ndices 0-1, 2-3, 4-5, etc.) y dentro de las celdas:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2a</span><span class="hljs-params">(cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, iCA, iCB, step, step1; 
   <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;
   <span class="hljs-keyword">int</span> id;
   <span class="hljs-keyword">int</span> nA, nB, nOwn;  
   <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;		<span class="hljs-comment">//   </span><font></font>
<font></font>
   <span class="hljs-comment">//  --        </span>
   __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
   <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
   <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
<span class="hljs-comment">//   shared </span>
  <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      
  <span class="hljs-keyword">int</span>* sAids = shMem;		<span class="hljs-comment">//     1 (   )</span>
  <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell]; <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     2 (B)</span>
  <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
  <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
  float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
  float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
   <span class="hljs-comment">//   ,    </span><font></font>
   float3 *sXyz;<font></font>
   float3 *sFrs;<font></font>
   <span class="hljs-keyword">int</span> *sTypes;
   <span class="hljs-keyword">int</span> *sIds;<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   iCA = md-&gt;cellPairs[blockIdx.x].x;  <span class="hljs-comment">//   </span>
   iCB = md-&gt;cellPairs[blockIdx.x].y;  <span class="hljs-comment">//   B</span><font></font>
<font></font>
   <span class="hljs-comment">//    -- </span>
  <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      shared_memory</span>
   <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>) <span class="hljs-comment">//!       A,  -   B. ,     </span><font></font>
     {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
     }<font></font>
   <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
     }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
   nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
   nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA  nB</span><font></font>
<font></font>
   <span class="hljs-comment">//   ,     </span>
  step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
   id0 = (threadIdx.x - deltId) * step;<font></font>
   N = min(id0 + step, nOwn);<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
      id = md-&gt;cells[iC][i+<span class="hljs-number">1</span>];<font></font>
      sIds[i] = id;		<span class="hljs-comment">//   </span>
      sXyz[i] = md-&gt;xyz[id];	<span class="hljs-comment">//  </span>
      sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <span class="hljs-comment">//  </span><font></font>
   sTypes[i] = md-&gt;types[id];<font></font>
   }<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//        i=0  j=1,    j     </span>
   i = <span class="hljs-number">0</span>;<font></font>
   j = threadIdx.x ‚Äì deltId + <span class="hljs-number">1</span>;<font></font>
   step1 = blockDim.x / <span class="hljs-number">2</span>;
   <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
   {<font></font>
      <span class="hljs-keyword">while</span> (j &gt;= nOwn)<font></font>
      {<font></font>
          i++;<font></font>
          <span class="hljs-keyword">if</span> (i &gt;= nOwn<span class="hljs-number">-1</span>)<font></font>
          {<font></font>
              ex = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">break</span>;<font></font>
          }<font></font>
          j = i + <span class="hljs-number">1</span> + j - nOwn;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
      pair_in_cell(sXyz[i], @sFrs[i], sTypes[i], sXyz[j], @sFrs[j], sTypes[j], md, eVdW, eCoul);<font></font>
      j = j + step1;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span><font></font>
   step1 = ceilf(nA / blockDim.x);<font></font>
   id1 = threadIdx.x * step1;<font></font>
   N1 = min(id1 + step1, nA);<font></font>
   <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
     <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
       pair_between_cell(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[blockId.x], md, eVdW, eCoul);<font></font>
<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
       md-&gt;frs[sIds[i]] = sFrs[i];<font></font>
<font></font>
   <span class="hljs-comment">//     </span><font></font>
   atomicAdd(&amp;engCoul, eCoul);<font></font>
   atomicAdd(&amp;engVdw, eVdW);<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">if</span> (!threadIdx.x) <font></font>
   {<font></font>
      atomicAdd(&amp;md-&gt;engCoul, engCoul);  <font></font>
      atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
   }<font></font>
}<font></font>
 </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las variables de la forma </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float3PerCell</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son el producto del n√∫mero m√°ximo de part√≠culas en una celda por el tama√±o del tipo float3. Tiene sentido calcularlos una vez durante la inicializaci√≥n del sistema. Las </font><i><font style="vertical-align: inherit;">funciones </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculan las interacciones entre part√≠culas en la misma celda y en celdas diferentes, respectivamente. Como par√°metros, obtienen las coordenadas de las part√≠culas, sus tipos y punteros donde escribir las fuerzas. Par√°metros para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambi√©n incluya la magnitud de los cambios, para tener en cuenta las condiciones de contorno peri√≥dicas. Los c√≥digos para estas funciones se dar√°n a continuaci√≥n. Para ordenar los pares de part√≠culas dentro de la celda, quer√≠a seguir el camino est√°ndar: dividir el n√∫mero de pares en intervalos iguales y dar a cada flujo un intervalo. Sin embargo, para obtener los √≠ndices de part√≠culas ij por el n√∫mero de par, se me ocurri√≥ la ecuaci√≥n cuadr√°tica y decid√≠ hacerlo de manera diferente: el primer hilo procesa un par de part√≠culas con √≠ndices 0-1, el segundo - 0-2, etc. Una vez procesado el par ij, el flujo va al par i- (j + N), donde N es el n√∫mero de flujos en el bloque y si va m√°s all√° del l√≠mite del rango, aumenta el √≠ndice de la primera part√≠cula en el par, vea el diagrama:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/fv/-h/qa/fv-hqah4yeuzhpa9jbidswkmse8.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La enumeraci√≥n de pares entre diferentes celdas es la siguiente: todos los flujos reciben su intervalo de √≠ndices de part√≠culas desde la celda A y calculan las interacciones entre estas part√≠culas y todas las part√≠culas en la celda B. La segunda funci√≥n calcula las interacciones en todos los pares restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2b</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> iPair, iC, iCA, iCB, step, step1; 
    <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;    
    <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">int</span> nA, nB, nOwn; <font></font>
<font></font>
    __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
    <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      <span class="hljs-comment">// declaration of shared memory</span>
    <span class="hljs-keyword">int</span>* sAids = shMem;
    <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell];<font></font>
    float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell];<font></font>
    <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
    <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
    float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
    float3* sXyz;<font></font>
    float3* sFrs;  <font></font>
    <span class="hljs-keyword">int</span>* sTypes;
    <span class="hljs-keyword">int</span>* sIds;<font></font>
<font></font>
    iPair = blockIdx.x + md-&gt;nPair1;<font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    iCA = md-&gt;cellPairs[iPair].x; <font></font>
    iCB = md-&gt;cellPairs[iPair].y;<font></font>
    nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
    nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
    <font></font>
    <span class="hljs-comment">//    ,        </span>
    <span class="hljs-keyword">if</span> (!nA)
       <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!nB)
        <span class="hljs-keyword">return</span>;<font></font>
<font></font>
    <span class="hljs-comment">//      shared_memory</span>
    <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>)<font></font>
    {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
    }<font></font>
    nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA or nB</span><font></font>
<font></font>
    step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id0 = (threadIdx.x - deltId) * step;<font></font>
    N = min(id0 + step, nOwn);<font></font>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        id = md-&gt;cells[iC][i + <span class="hljs-number">1</span>];<font></font>
        sIds[i] = id;     <font></font>
        sXyz[i] = md-&gt;xyz[id];    <font></font>
        sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <font></font>
        sTypes[i] = md-&gt;types[id];<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    step1 = ceilf((<span class="hljs-keyword">double</span>)nA / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id1 = threadIdx.x * step1;<font></font>
    N1 = min(id1 + step1, nA);<font></font>
    <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
        {<font></font>
            pair_between_cell1(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[iPair], md, eVdW, eCoul);<font></font>
<font></font>
        }<font></font>
    __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].x), sFrs[i].x);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].y), sFrs[i].y);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].z), sFrs[i].z);<font></font>
    }<font></font>
<font></font>
    atomicAdd(&amp;engCoul, eCoul);<font></font>
    atomicAdd(&amp;engVdW, eVdW);<font></font>
    __syncthreads();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        atomicAdd(&amp;md-&gt;engCoul1, engCoul);<font></font>
        atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo es casi similar a la funci√≥n anterior, solo se procesan los pares restantes (el √≠ndice del par se desplaza por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; nPair1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), la interacci√≥n se calcula solo entre el par de celdas (ya contadas dentro de las celdas), y al copiar en la memoria global, usamos atomicAdd para resumir los resultados y no sobrescribir ellos. </font><font style="vertical-align: inherit;">Ahora traigo las funciones restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">keep_in_cell</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, float3 xyz, cudaMD* md)</span>
<span class="hljs-comment">//  index    xyz  cell list</span>
</span>{
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">int</span> c = <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.x / (<span class="hljs-keyword">double</span>)md-&gt;cSize.x) * md-&gt;cnYZ + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.y / (<span class="hljs-keyword">double</span>)md-&gt;cSize.y) * md-&gt;cNumber.z + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.z / (<span class="hljs-keyword">double</span>)md-&gt;cSize.z);<font></font>
<font></font>
    <span class="hljs-keyword">int</span> j = atomicAdd(&amp;(md-&gt;cells[c][<span class="hljs-number">0</span>]), <span class="hljs-number">1</span>);<font></font>
    md-&gt;cells[c][j + <span class="hljs-number">1</span>] = index;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En base a las coordenadas, calculamos el √≠ndice de la celda donde entra esta part√≠cula. Aumentamos el contador de part√≠culas en esta celda. Escribimos el √≠ndice de part√≠culas en una nueva celda. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el tama√±o de la celda, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cnYZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el producto del n√∫mero de celdas en las mediciones Y y Z. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede valer la pena no calcular el √≠ndice de la celda, sino almacenarlos como una matriz tridimensional en la memoria de textura, utilizando √≠ndices de la forma [x / md-&gt; cSize.x ] ¬øDar√° un aumento de rendimiento?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Funciones que calculan interacciones:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_in_cell</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x; <font></font>
    dy = xyzA.y - xyzB.y;<font></font>
    dz = xyzA.z - xyzB.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-comment">//if (r2 &lt;= sim-&gt;r2Max)    </span>
    <span class="hljs-comment">//{</span>
    r = <span class="hljs-number">0.0</span>;<font></font>
    f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul);<font></font>
<font></font>
    <span class="hljs-comment">// -- </span><font></font>
    vdw = md-&gt;vdws[typeA][typeB];<font></font>
    <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
        <span class="hljs-comment">//if (r2 &lt;= vdw-&gt;r2cut)   //!      </span><font></font>
            f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
    <span class="hljs-comment">//      atomic,        </span><font></font>
    atomicAdd(&amp;(fxyzA-&gt;x), f * dx);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;y), f * dy);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;z), f * dz);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    <span class="hljs-comment">//}</span><font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculamos la distancia entre las part√≠culas, la sustituimos primero en la funci√≥n de Coulomb y luego en la interacci√≥n de van der Waals. Si se elige el tama√±o de la celda para que su diagonal no exceda el rango del tipo m√°s corto de interacci√≥n, entonces se pueden eliminar las comprobaciones de distancia (espec√≠ficamente las dej√© comentadas en el c√≥digo). Observo que aqu√≠ calculo el cuadrado de la distancia ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), y la distancia ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) en s√≠ misma se calcula en la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matriz chProd [i] [j]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> almacena el producto de las cargas de los tipos de part√≠culas correspondientes. Quiz√°s tambi√©n deber√≠a colocarse en la memoria de textura. La estructura vdw almacena par√°metros potenciales emparejados y un puntero de funci√≥n ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feng_r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) para calcular la interacci√≥n de van der Waals. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funci√≥n para calcular interacciones entre dos celdas diferentes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_between_cell1</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, float3 shift, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x - shift.x;<font></font>
    dy = xyzA.y - xyzB.y - shift.y;<font></font>
    dz = xyzA.z - xyzB.z - shift.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)<font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul); <font></font>
<font></font>
        vdw = md-&gt;vdws[typeA][typeB];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
<font></font>
        fxyzA-&gt;x += f * dx;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
        fxyzA-&gt;y += f * dy;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
        fxyzA-&gt;z += f * dz;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo es casi id√©ntico a la funci√≥n anterior, hay una correcci√≥n en la diferencia de coordenadas para tener en cuenta las condiciones de l√≠mite peri√≥dicas, las comprobaciones de distancia no est√°n comentadas y, como recordamos de las funciones del grupo de funciones </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">no hay necesidad de aplicar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atomicAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a la celda A, porque las part√≠culas en √©l se procesan de forma independiente. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observo que, dependiendo de la distancia entre celdas espec√≠ficas en un par, puede omitir algunas comprobaciones y c√°lculos de distancia. </font><font style="vertical-align: inherit;">Para hacer esto, puede escribir versiones ligeramente diferentes de esta funci√≥n. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambi√©n doy funciones que calculan las fuerzas y energ√≠as de los potenciales de pares para el potencial de Lennard-Jones y Buckingham:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fe_lj</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = 4e[(s/r)^12 - (s/r)^6]</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> sr2 = vdw-&gt;p1 * r2i;
    <span class="hljs-keyword">float</span> sr6 = sr2 * sr2 * sr2;<font></font>
<font></font>
    eng += vdw-&gt;p0 * sr6 * (sr6 - <span class="hljs-number">1.0</span>);
    <span class="hljs-keyword">return</span> vdw-&gt;p2 * r2i * sr6 * (<span class="hljs-number">2.0</span> * sr6 - <span class="hljs-number">1.0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fer_buck</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = A exp(-r/ro) - C/r^6</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> r4i = r2i * r2i;
    <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0.0</span>)    <span class="hljs-comment">//  r , </span>
        r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
<font></font>
    eng += vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) - vdw-&gt;p2 * r4i * r2i;
    <span class="hljs-keyword">return</span> vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) / r / vdw-&gt;p1 - <span class="hljs-number">6.0</span> * vdw-&gt;p2 * r4i * r4i;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las funciones devuelven la fuerza (que debe multiplicarse por la proyecci√≥n del vector de distancia) y agregan energ√≠a a la variable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Un puntero a una de estas funciones se almacena en la estructura cudaVdW. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En t√©rminos generales, para obtener trayectorias de movimiento, la energ√≠a no se puede calcular, es necesaria para diferentes estad√≠sticas. Si eliminamos las expresiones de energ√≠a de estas funciones, es probable que los c√°lculos se aceleren. Y puede hacer esto: una vez unos pocos pasos para llamar a la funci√≥n completa, y el resto del tiempo, solo un an√°logo reducido.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte de la interacci√≥n de Coulomb se calcula mediante la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">real_ewald</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, <span class="hljs-keyword">float</span> chprd, <span class="hljs-keyword">float</span> alpha, <span class="hljs-keyword">float</span>&amp; eng)</span>
</span>{
    <span class="hljs-keyword">float</span> ar; 
    <span class="hljs-keyword">float</span> erfcar;
    <span class="hljs-keyword">float</span> kqq = chprd * d_Fcoul_scale; <span class="hljs-comment">// q[i]*q[j]*1/4pie0;</span><font></font>
<font></font>
    r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
    ar = alpha * r;<font></font>
    erfcar = erfc(ar);<font></font>
<font></font>
    eng += kqq * erfcar / r;<font></font>
    <span class="hljs-keyword">return</span> kqq / r / r2 * (erfcar + <span class="hljs-number">2</span> * ar / d_sqrtpi * <span class="hljs-built_in">exp</span>(-ar * ar));<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto difiere de la ley familiar de Coulomb, pero m√°s sobre eso en un art√≠culo separado. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las pruebas con un ejemplo real mostraron que hay muy pocas part√≠culas en un par de celdas para cargar todos los flujos asignados al bloque. Una optimizaci√≥n adicional de las funciones </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es procesar varios pares a la vez en un bloque. Hasta ahora, he escrito solo la versi√≥n m√°s simple, donde los flujos simplemente se dividen en varios pares de celdas, es decir, un bloque no procesa un par, pero digamos 4: 0-1, 1-2, 3-4, 5-6. Puede notar que, en este caso, cargar los datos en la memoria compartida puede al mismo tiempo procesar los pares 0-2, 0-3, 0-4, etc. Sin embargo, esto requiere trucos adicionales en la etapa de preparaci√≥n de los datos, que a√∫n no he pensado. Tambi√©n si en la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si carga pares con una celda com√∫n (por ejemplo, los mismos 0-2, 0-3, 0-4, etc.), puede reducir el n√∫mero de llamadas a la memoria global copiando los datos de la celda 0 solo una vez. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar si todo funciona correctamente en mi implementaci√≥n de algoritmos de lista de celdas, tambi√©n escrib√≠ una funci√≥n que calcula las interacciones de una manera ingenua, simplemente clasificando todos los pares:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">all_pair</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> i, j;
    <span class="hljs-keyword">int</span> step = blockDim.x * gridDim.x;
    <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// exit flag</span>
    <span class="hljs-keyword">int</span> nAt = md-&gt;nAt;<font></font>
<font></font>
    i = <span class="hljs-number">0</span>;<font></font>
    j = blockIdx.x * blockDim.x + threadIdx.x + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">while</span> (j &gt;= nAt)<font></font>
        {<font></font>
            i++;<font></font>
            <span class="hljs-keyword">if</span> (i &gt;= nAt - <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ex = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            j = i + <span class="hljs-number">1</span> + j - nAt;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
        global_pair(i, j, iStep, md);<font></font>
        j = j + step;<font></font>
    }<font></font>
} <font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">global_pair</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> engCoul = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">float</span> engVdw = <span class="hljs-number">0</span>;<font></font>
    cudaVdW* vdw;<font></font>
    <span class="hljs-keyword">int</span> ti, tj;<font></font>
<font></font>
    <span class="hljs-keyword">float</span> dx = md-&gt;xyz[i].x - md-&gt;xyz[j].x;
    <span class="hljs-keyword">float</span> dy = md-&gt;xyz[i].y - md-&gt;xyz[j].y;
    <span class="hljs-keyword">float</span> dz = md-&gt;xyz[i].z - md-&gt;xyz[j].z;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">if</span> (dx &gt; md-&gt;halfLeng.x)<font></font>
        dx -= md-&gt;leng.x;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dx &lt; -md-&gt;halfLeng.x)<font></font>
            dx += md-&gt;leng.x;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dy &gt; md-&gt;halfLeng.y)<font></font>
        dy -= md-&gt;leng.y;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dy &lt; -md-&gt;halfLeng.y)<font></font>
            dy += md-&gt;leng.y;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dz &gt; md-&gt;halfLeng.z)<font></font>
        dz -= md-&gt;leng.z;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dz &lt; -md-&gt;halfLeng.z)<font></font>
            dz += md-&gt;leng.z;<font></font>
<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)    <font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        ti = md-&gt;types[i];<font></font>
        tj = md-&gt;types[j];<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[ti][tj], md-&gt;alpha, engCoul);<font></font>
<font></font>
        vdw = md-&gt;vdws[ti][tj];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw); <font></font>
<font></font>
        dx *= f;<font></font>
        dy *= f;<font></font>
        dz *= f;<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].x), dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].x), -dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].y), dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].y), -dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].z), dz);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].z), -dz);<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;engCoul1), engCoul);<font></font>
        atomicAdd(&amp;(md-&gt;engVdW), engVdw);<font></font>
<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los resultados de los c√°lculos coincidieron. </font><font style="vertical-align: inherit;">Es cierto, aparentemente, debido a las diferentes secuencias de redondeo, las coordenadas de las part√≠culas dentro del tercer decimal pueden variar de principio a inicio. </font><font style="vertical-align: inherit;">Observo que en un sistema de aproximadamente 1,400 part√≠culas y un radio de corte de 6 angstroms, las funciones </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pierden aproximadamente dos veces el tiempo de ejecuci√≥n para una enumeraci√≥n simple. </font><font style="vertical-align: inherit;">Al procesar varios bloques (8 y 16) a la vez en un bloque, se comparan las velocidades e incluso pueden estar ligeramente por delante de la funci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all_pair</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sin embargo, esto deber√≠a depender mucho del tama√±o del sistema. </font><font style="vertical-align: inherit;">Con un aumento en el n√∫mero de √°tomos, la velocidad de los algoritmos de la lista de c√©lulas crece linealmente y la enumeraci√≥n simple de forma cuadr√°tica. </font><font style="vertical-align: inherit;">Adem√°s, la lista de celdas es muy efectiva para modelar sistemas descargados (grandes distancias entre part√≠culas), por ejemplo, gases</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con esto concluye este art√≠culo, me complacer√° cualquier pregunta y comentario, especialmente sobre el aumento de la productividad. </font><font style="vertical-align: inherit;">Los momentos m√°s disputados en el curso de la narraci√≥n que not√© en rojo. </font><font style="vertical-align: inherit;">Como la transferencia del resto de la din√°mica funcional de la mol√©cula a√∫n debe realizarse, planeo continuar el ciclo de estos art√≠culos:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ewald resumen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interacci√≥n intramolecular.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brecha y formaci√≥n de enlaces.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transferencia electronica.</font></font></li>
</ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la literatura sobre MD puedo recomendar el libro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daan Frenkel y Berend Smit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprensi√≥n de la simulaci√≥n molecular: de algoritmos a aplicaciones</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simulaci√≥n por computadora de l√≠quidos,</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> escrito por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MP Allen, DJ Tildesley</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Para el primero, que yo sepa, hay una traducci√≥n al ruso. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n agradezco a Pavel Kudinov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pavel_kudinov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por su comentario llamando a " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escribir el c√≥digo GPGPU tan simple y directo como un martillo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> lectura que finalmente proced√≠ a la acci√≥n, que result√≥ en este art√≠culo.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27/06/2020. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias por comentar</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elimin√≥ la puesta a cero de los par√°metros globales de las funciones y defini√≥ el rango de part√≠culas emitidas a la corriente de una manera diferente.</font></font></div>
      
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es508380/index.html">Automatizaci√≥n de despacho de mercanc√≠as en China.</a></li>
<li><a href="../es508384/index.html">C√≥mo familiarizar al desarrollador con los valores de su negocio sin recurrir a la violencia</a></li>
<li><a href="../es508390/index.html">VR al entrenar al personal. Los verdaderos pros y contras</a></li>
<li><a href="../es508392/index.html">Financiamiento de la Guerra Civil (EE. UU. Vs. EE. UU.)</a></li>
<li><a href="../es508394/index.html">C√≥mo los estudiantes de primer a√±o del HSE de San Petersburgo escribieron un cliente de torrent, un analizador de c√≥digo, un editor de fotos y no solo durante el semestre</a></li>
<li><a href="../es508398/index.html">Tres formas para un programador: experto, l√≠der, fundador</a></li>
<li><a href="../es508400/index.html">C√≥mo un "ciudadano activo" acostumbra a las personas al phishing</a></li>
<li><a href="../es508402/index.html">C√≥mo la arquitectura HiCampus simplifica las redes del campus</a></li>
<li><a href="../es508404/index.html">AI vs. AI battle: fraude y contenido falso</a></li>
<li><a href="../es508408/index.html">Los antivirus m√≥viles no funcionan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>