<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍✈️ ⛰️ 🎅🏻 Red Hat OpenShift Cloud-basiertes Messaging mit Quarkus und AMQ Online ☸️ 👨‍👦 👩🏿‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo alle zusammen! Hier ist er - unser letzter Beitrag aus der Quarkus-Serie! ( Weitere Informationen finden Sie in unserem Webinar „Dies ist das na...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Red Hat OpenShift Cloud-basiertes Messaging mit Quarkus und AMQ Online</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/503940/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo alle zusammen! Hier ist er - unser letzter Beitrag aus der Quarkus-Serie! ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weitere Informationen finden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie in unserem Webinar </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">„Dies ist das native Java-Framework von Quarkus - Kubernetes“.</font></a><font style="vertical-align: inherit;"> Wir werden zeigen, wie Sie bei </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Null</font></a><font style="vertical-align: inherit;"> anfangen oder vorgefertigte Lösungen übertragen können.) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/ux/ir/pouxirwqx8fafftuhwwcma0jw5q.jpeg" width="100%"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">früheren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beitrag haben wir uns die geeigneten Tools angesehen, mit denen Sie die Verbesserungen quantifizieren können, die durch die Modernisierung von Java erzielt wurden Anwendungen.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ab Version 0.17.0 </font><font style="vertical-align: inherit;">unterstützt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quarkus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Verwendung des Advanced Message Queuing Protocol ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AMQP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), eines offenen Standards für die Übertragung von Geschäftsnachrichten zwischen Anwendungen oder Organisationen. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat AMQ Online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Dienst, der auf dem offenen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EnMasse-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Projekt </font><font style="vertical-align: inherit;">basiert und einen Messaging-Mechanismus implementiert, der auf der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat OpenShift-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Plattform basiert </font><font style="vertical-align: inherit;">. Weitere Informationen zur Funktionsweise finden Sie unter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier (zu EN)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Heute werden wir zeigen, wie AMQ Online und Quarkus kombiniert werden können, um ein modernes OpenShift-basiertes Messaging-System mit zwei neuen Technologien für die Nachrichtenverarbeitung aufzubauen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird davon ausgegangen, dass Sie AMQ Online bereits auf der OpenShift-Plattform bereitgestellt haben (falls nicht, lesen Sie das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installationshandbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst erstellen wir die Quarkus-Anwendung, bei der es sich um ein einfaches Auftragsabwicklungssystem mit reaktivem Messaging handelt. </font><font style="vertical-align: inherit;">Diese Anwendung enthält einen Auftragsgenerator, der Aufträge mit einem festen Intervall an die Nachrichtenwarteschlange sendet, sowie einen Auftragsprozessor, der Nachrichten aus der Warteschlange verarbeitet und Bestätigungen generiert, die im Browser angezeigt werden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Erstellen der Anwendung zeigen wir, wie die Konfiguration des Messagingsystems darin implementiert wird, und verwenden AMQ Online, um die auf diesem System benötigten Ressourcen zu initialisieren.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quarkus App</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Quarkus-Anwendung läuft unter OpenShift und ist eine modifizierte Version von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amqp-quickstart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ein vollständiges Beispiel der Client-Seite finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generator bestellen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Generator sendet alle 5 Sekunden einfach monoton wachsende Auftragskennungen an die Adresse „Aufträge“.</font></font><br>
<br>
<pre><code class="plaintext hljs">@ApplicationScoped<font></font>
public class OrderGenerator {<font></font>
 <font></font>
    private int orderId = 1;<font></font>
 <font></font>
    @Outgoing("orders")<font></font>
    public Flowable&lt;Integer&gt; generate() {<font></font>
        return Flowable.interval(5, TimeUnit.SECONDS)<font></font>
        .map(tick -&gt; orderId++);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestellabwickler</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Auftragsabwickler ist noch einfacher, er gibt lediglich die Bestätigungskennung an die Adresse „Bestätigungen“ zurück.</font></font><br>
<br>
<pre><code class="plaintext hljs">@ApplicationScoped<font></font>
public class OrderProcessor {<font></font>
    @Incoming("orders")<font></font>
    @Outgoing("confirmations")<font></font>
    public Integer process(Integer order) {<font></font>
        //       &lt;img draggable="false" class="emoji" alt=":-)" src="https://s.w.org/images/core/emoji/11.2.0/svg/1f642.svg"&gt;<font></font>
        return order * 2;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestätigungsressourcen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Bestätigungsressource ist ein HTTP-Endpunkt zum Auflisten der von unserer Anwendung generierten Bestätigungen.</font></font><br>
<br>
<pre><code class="plaintext hljs">@Path("/confirmations")<font></font>
public class ConfirmationResource {<font></font>
 <font></font>
    @Inject<font></font>
    @Stream("confirmations") Publisher&lt;Integer&gt; orders;<font></font>
 <font></font>
    @GET<font></font>
    @Produces(MediaType.TEXT_PLAIN)<font></font>
    public String hello() {<font></font>
        return "hello";<font></font>
    }<font></font>
 <font></font>
 <font></font>
    @GET<font></font>
    @Path("/stream")<font></font>
    @Produces(MediaType.SERVER_SENT_EVENTS)<font></font>
    public Publisher&lt;Integer&gt; stream() {<font></font>
        return orders;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anpassung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eine Verbindung zu AMQ Online herzustellen, benötigt unsere Anwendung einige Konfigurationsdaten, nämlich: Quarkus-Connector-Konfiguration, AMQP-Endpunktinformationen und Client-Anmeldeinformationen. </font><font style="vertical-align: inherit;">Es ist natürlich besser, alle Konfigurationsdaten an einem Ort zu speichern, aber wir werden sie speziell trennen, um mögliche Optionen zum Einrichten der Quarkus-Anwendung aufzuzeigen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anschlüsse</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Connector-Konfiguration kann in der Kompilierungsphase mithilfe der Anwendungseigenschaftendatei bereitgestellt werden:</font></font><br>
<br>
<pre><code class="plaintext hljs">mp.messaging.outgoing.orders.connector=smallrye-amqp<font></font>
mp.messaging.incoming.orders.connector=smallrye-amqp<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies nicht zu erschweren, verwenden wir die Nachrichtenwarteschlange nur für die Adresse "Bestellungen". </font><font style="vertical-align: inherit;">Und die Adresse "Bestätigungen" in unserer Anwendung verwendet die Warteschlange im Speicher.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpunkt AMQP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Kompilierungsphase sind der Hostname und die Portnummer für den AMQP-Endpunkt unbekannt, daher müssen sie implementiert werden. </font><font style="vertical-align: inherit;">Der Endpunkt kann in der Konfigurationskarte festgelegt werden, die von AMQ Online erstellt wird. Daher definieren wir sie über die Umgebungsvariablen im Anwendungsmanifest:</font></font><br>
<br>
<pre><code class="plaintext hljs">spec:<font></font>
  template:<font></font>
    spec:<font></font>
      containers:<font></font>
      - env:<font></font>
        - name: AMQP_HOST<font></font>
          valueFrom:<font></font>
            configMapKeyRef:<font></font>
              name: quarkus-config<font></font>
              key: service.host<font></font>
        - name: AMQP_PORT<font></font>
          valueFrom:<font></font>
            configMapKeyRef:<font></font>
              name: quarkus-config<font></font>
              key: service.port.amqp<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referenzen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Dienstkonto-Token können Sie unsere Anwendung in OpenShift authentifizieren. </font><font style="vertical-align: inherit;">Dazu müssen Sie zuerst eine benutzerdefinierte ConfigSource erstellen, die das Authentifizierungstoken aus dem Pod-Dateisystem liest:</font></font><br>
<br>
<pre><code class="plaintext hljs">public class MessagingCredentialsConfigSource implements ConfigSource {<font></font>
    private static final Set&lt;String&gt; propertyNames;<font></font>
 <font></font>
    static {<font></font>
        propertyNames = new HashSet&lt;&gt;();<font></font>
        propertyNames.add("amqp-username");<font></font>
        propertyNames.add("amqp-password");<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public Set&lt;String&gt; getPropertyNames() {<font></font>
        return propertyNames;<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public Map&lt;String, String&gt; getProperties() {<font></font>
        try {<font></font>
            Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();<font></font>
            properties.put("amqp-username", "@@serviceaccount@@");<font></font>
            properties.put("amqp-password", readTokenFromFile());<font></font>
            return properties;<font></font>
        } catch (IOException e) {<font></font>
            throw new UncheckedIOException(e);<font></font>
        }<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public String getValue(String key) {<font></font>
        if ("amqp-username".equals(key)) {<font></font>
            return "@@serviceaccount@@";<font></font>
        }<font></font>
        if ("amqp-password".equals(key)) {<font></font>
            try {<font></font>
                return readTokenFromFile();<font></font>
            } catch (IOException e) {<font></font>
                throw new UncheckedIOException(e);<font></font>
            }<font></font>
        }<font></font>
        return null;<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public String getName() {<font></font>
        return "messaging-credentials-config";<font></font>
    }<font></font>
 <font></font>
    private static String readTokenFromFile() throws IOException {<font></font>
        return new String(Files.readAllBytes(Paths.get("/var/run/secrets/kubernetes.io/serviceaccount/token")), StandardCharsets.UTF_8);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenstellung und Bereitstellung der Anwendung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Anwendung in eine ausführbare Datei kompiliert werden muss, ist eine virtuelle GraalVM-Maschine erforderlich. </font><font style="vertical-align: inherit;">Weitere Informationen zum Einrichten einer Umgebung hierfür finden Sie in den entsprechenden Anweisungen im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quarkus-Handbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Befolgen Sie dann die dortigen Anweisungen, um die Quelle herunterzuladen, unsere Anwendung zu erstellen und bereitzustellen:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/EnMasseProject/enmasse-example-clients<font></font>
cd enmasse-example-clients/quarkus-example-client<font></font>
oc new-project myapp<font></font>
mvn -Pnative -Dfabric8.mode=openshift -Dfabric8.build.strategy=docker package fabric8:build fabric8:resource fabric8:apply<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach diesen Befehlen wird die Anwendung bereitgestellt, jedoch erst gestartet, wenn die erforderlichen Messaging-Ressourcen in AMQ Online konfiguriert wurden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messaging-Setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt müssen die Ressourcen festgelegt werden, die unsere Anwendung im Messagingsystem benötigt. </font><font style="vertical-align: inherit;">Erstellen Sie dazu: 1) den Adressraum zum Initialisieren des Endpunkts des Nachrichtensystems; </font><font style="vertical-align: inherit;">2) die Adresse zum Konfigurieren der Adressen, die wir in der Anwendung verwenden; </font><font style="vertical-align: inherit;">3) der Benutzer des Nachrichtensystems, um die Anmeldeinformationen des Clients festzulegen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adressraum</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das AddressSpace-Objekt in AMQ Online ist eine Gruppe von Adressen, die Verbindungsendpunkte sowie Authentifizierungs- und Autorisierungsrichtlinien gemeinsam nutzen. </font><font style="vertical-align: inherit;">Beim Erstellen eines Adressraums können Sie angeben, wie die Endpunkte des Nachrichtensystems bereitgestellt werden sollen:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: enmasse.io/v1beta1<font></font>
kind: AddressSpace<font></font>
metadata:<font></font>
  name: quarkus-example<font></font>
spec:<font></font>
  type: brokered<font></font>
  plan: brokered-single-broker<font></font>
  endpoints:<font></font>
  - name: messaging<font></font>
    service: messaging<font></font>
    exports:<font></font>
    - name: quarkus-config<font></font>
      kind: configmap<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adressen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adressen werden zum Senden und Empfangen von Nachrichten verwendet. </font><font style="vertical-align: inherit;">Jede Adresse hat einen Typ, der ihre Semantik definiert, sowie einen Plan, der die Anzahl der reservierten Ressourcen festlegt. </font><font style="vertical-align: inherit;">Die Adresse kann zum Beispiel folgendermaßen bestimmt werden:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: enmasse.io/v1beta1<font></font>
kind: Address<font></font>
metadata:<font></font>
  name: quarkus-example.orders<font></font>
spec:<font></font>
  address: orders<font></font>
  type: queue<font></font>
  plan: brokered-queue<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messaging-Benutzer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Nachrichten an Ihre Adressen zu senden und zu empfangen, die nur vertrauenswürdige Anwendungen können, müssen Sie einen Benutzer im Nachrichtensystem erstellen. </font><font style="vertical-align: inherit;">Für Anwendungen, die in einem Cluster ausgeführt werden, können Clients mithilfe eines OpenShift-Dienstkontos authentifiziert werden. </font><font style="vertical-align: inherit;">Der Benutzer "serviceaccount" kann beispielsweise wie folgt definiert werden:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: user.enmasse.io/v1beta1<font></font>
kind: MessagingUser<font></font>
metadata:<font></font>
  name: quarkus-example.app<font></font>
spec:<font></font>
  username: system:serviceaccount:myapp:default<font></font>
  authentication:<font></font>
    type: serviceaccount<font></font>
  authorization:<font></font>
  - operations: ["send", "recv"]<font></font>
    addresses: ["orders"]<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berechtigungen zum Anpassen der Anwendung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit AMQ Online die Konfigurationszuordnung erstellen kann, mit der wir die AMQP-Endpunktinformationen implementiert haben, müssen Sie die Rolle und die Rollenbindung (Role and RoleBinding) angeben:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: rbac.authorization.k8s.io/v1<font></font>
kind: Role<font></font>
metadata:<font></font>
  name: quarkus-config<font></font>
spec:<font></font>
  rules:<font></font>
  - apiGroups: [ "" ]<font></font>
    resources: [ "configmaps" ]<font></font>
    verbs: [ "create" ]<font></font>
  - apiGroups: [ "" ]<font></font>
    resources: [ "configmaps" ]<font></font>
    resourceNames: [ "quarkus-config" ]<font></font>
    verbs: [ "get", "update", "patch" ]<font></font>
---<font></font>
apiVersion: rbac.authorization.k8s.io/v1<font></font>
kind: RoleBinding<font></font>
metadata:<font></font>
  name: quarkus-config<font></font>
roleRef:<font></font>
  apiGroup: rbac.authorization.k8s.io<font></font>
  kind: Role<font></font>
  name: quarkus-config<font></font>
subjects:<font></font>
- kind: ServiceAccount<font></font>
  name: address-space-controller<font></font>
  namespace: amq-online-infra<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So wenden Sie Konfigurationen an</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können die Messaging-Konfiguration folgendermaßen anwenden:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd enmasse-example-clients/quarkus-example-client<font></font>
oc project myapp<font></font>
oc apply -f src/main/resources/k8s/addressspace<font></font>
oc apply -f src/main/resources/k8s/address<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antragsüberprüfung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um sicherzustellen, dass die Anwendung gestartet wurde, prüfen wir zunächst, ob die entsprechenden Adressen erstellt und aktiv sind:</font></font><br>
<br>
<pre><code class="plaintext hljs">until [[ `oc get address quarkus-example.prices -o jsonpath='{.status.phase}'` == "Active" ]]; do echo "Not yet ready"; sleep 5; done
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Überprüfen Sie dann die URL der Anwendungsroute (öffnen Sie einfach diese Adresse im Browser):</font></font><br>
<br>
<pre><code class="plaintext hljs">echo "http://$(oc get route quarkus-example-client -o jsonpath='{.spec.host}')/prices.html"
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Browser sollte sichtbar sein, dass Tickets regelmäßig aktualisiert werden, wenn Nachrichten von AMQ Online gesendet und empfangen werden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher haben wir eine Quarkus-Anwendung geschrieben, die AMQP für Messaging verwendet, diese Anwendung für die Arbeit auf der Red Hat OpenShift-Plattform eingerichtet und ihre Konfiguration basierend auf der AMQ Online-Konfiguration implementiert. </font><font style="vertical-align: inherit;">Anschließend haben wir die Manifeste erstellt, die zum Initialisieren des Messagingsystems für unsere Anwendung erforderlich sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit ist die Quarkus-Serie abgeschlossen, aber es liegen noch viele neue und interessante Dinge vor uns. Bleiben Sie bei uns!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503928/index.html">Aerosol VS-Bewässerung: Was ist besser und gibt es einen Unterschied?</a></li>
<li><a href="../de503932/index.html">Ich bin es leid, dass gewöhnliche Verkäufer sich als Entwickler ausgeben und die Branche entehren. Sie machen die Welt schlimmer</a></li>
<li><a href="../de503934/index.html">[Umfrage zu Übersetzungsschwierigkeiten] Die Lokalisierung von GitLab erfordert eine Community-Meinung</a></li>
<li><a href="../de503936/index.html">Über die Datenbankübersetzung: Was passiert, was sie tun und womit sie essen?</a></li>
<li><a href="../de503938/index.html">Yandex gibt Geld für Werbung aus. Oder nicht?</a></li>
<li><a href="../de503942/index.html">Warum sollten Systemadministratoren, Entwickler und Tester die DevOps-Praktiken lernen?</a></li>
<li><a href="../de503950/index.html">Field Service Management: Was ist das und warum brauchen Serviceunternehmen es?</a></li>
<li><a href="../de503952/index.html">Schweiß, Blut und Rutschen: Wie ein Startplatz funktioniert</a></li>
<li><a href="../de503954/index.html">Ihr erster Schritt in Data Science. Titanic</a></li>
<li><a href="../de503956/index.html">Quält Andrei Breslav Kotlin-Designfehler, die nicht behoben werden können? // Wir sind zum Scheitern verurteilt # 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>