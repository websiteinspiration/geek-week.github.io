<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>↘️ 🦌 💸 P̶y̶t̶h̶o̶̶n̶RustとWebAssemblyによる日本語クロスワードの解決 👠 🕵🏻 👏🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Python用のノノグラムソルバーの作成方法をRustに書き換えて、WebAssemblyを介してブラウザーで直接実行します。
 

TL、DR 
 開始
 

Habréの日本語のクロスワード（ノノグラム）については、すでにいくつかの投稿がありました。例
 ともう1つ。
  , , . , ( ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>P̶y̶t̶h̶o̶̶n̶RustとWebAssemblyによる日本語クロスワードの解決</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454586/"><p><img src="https://habrastorage.org/webt/sy/k0/va/syk0va4uczwmji3lwzhq2nqq2hy.png" alt="ノノグラムとしての錆ロゴ"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python用のノノグラムソルバーの作成方法をRustに書き換えて、WebAssemblyを介してブラウザーで直接実行します。</font></font></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL、DR </font></font></a></p><a name="habracut"></a><br>
<h2 id="nachalo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habréの日本語のクロスワード（ノノグラム）については、すでにいくつかの投稿がありました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう1つ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p><br>
<blockquote>  ,    ,     .   ,    (  ,   )       ,    —         (,     — 4, 1,  3 ,       :  —  ,  —  ,  —    ).  -     ,  ,   ,        ,        (       ).     . </blockquote><p>      —  ""     ,   "" .     ,           / .  ,     <strong></strong>     ,       (   ).         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://nonograms.org/</a> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://nonograms.ru/</a>).            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">      </a>.                   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link">KyberPrizrak</a>       ). </p><br>
<p>        ,   ""    .           -   , ,      ,      .     (  )    .             .</p><br>
<h2 id="python">Python</h2><br>
<p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,        (  ,    ).</p><br>
<p>      Python (   )      ,  ,       .    ,         ,       .</p><br>
<p>  ,          Jan Wolter,     (,   ,        ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>,      ,       . </p><br>
<p>   (   ),        .        , ,    10      .</p><br>
<h3 id="osnovnye-algoritmy"> </h3><br>
<p>        :</p><br>
<ul>
<li><p>(<strong>line</strong>)  :         (clues),   —   .  python-   4   (3      ).     BguSolver,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.         -    .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>.</p><br>
</li>
<li><p>(<strong>propagation</strong>)       ,     ,        ()  , ,   (). ,    .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><p>      .     ()   7 (   <code>???????</code>)    <code>[2, 3]</code>.       <code>?X??XX?</code>,  <code>X</code> —  .    ,      1, 4, 5 (   0).             "" .          (     ).</p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">propagation</span>(<span class="hljs-params">board</span>):</span><font></font>
    line_jobs = PriorityDict()<font></font>
<font></font>
    <span class="hljs-keyword">for</span> row_index <span class="hljs-keyword">in</span> range(board.height):<font></font>
        new_job = (<span class="hljs-literal">False</span>, row_index)<font></font>
        line_jobs[new_job] = <span class="hljs-number">0</span><font></font>
<font></font>
    <span class="hljs-keyword">for</span> column_index <span class="hljs-keyword">in</span> range(board.width):<font></font>
        new_job = (<span class="hljs-literal">True</span>, column_index)<font></font>
        line_jobs[new_job] = <span class="hljs-number">0</span><font></font>
<font></font>
    <span class="hljs-keyword">for</span> (is_column, index), priority <span class="hljs-keyword">in</span> line_jobs.sorted_iter():<font></font>
        new_jobs = solve_and_update(board, index, is_column)<font></font>
<font></font>
        <span class="hljs-keyword">for</span> new_job <span class="hljs-keyword">in</span> new_jobs:
            <span class="hljs-comment"># upgrade priority</span>
            new_priority = priority - <span class="hljs-number">1</span><font></font>
            line_jobs[new_job] = new_priority<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">solve_and_update</span>(<span class="hljs-params">board, index, is_column</span>):</span>
    <span class="hljs-keyword">if</span> is_column:<font></font>
        row_desc = board.columns_descriptions[index]<font></font>
        row = tuple(board.get_column(index))<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
        row_desc = board.rows_descriptions[index]<font></font>
        row = tuple(board.get_row(index))<font></font>
<font></font>
    updated = line_solver(row_desc, row)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> row != updated:
        <span class="hljs-keyword">for</span> i, (pre, post) <span class="hljs-keyword">in</span> enumerate(zip(row, updated)):
            <span class="hljs-keyword">if</span> _is_pixel_updated(pre, post):
                <span class="hljs-keyword">yield</span> (<span class="hljs-keyword">not</span> is_column, i)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> is_column:<font></font>
            board.set_column(index, updated)<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            board.set_row(index, updated)</code></pre><br>
</div></div><br>
</li>
</ul><br>
<ul>
<li><p>(<strong>probing</strong>)           propagation    .    —                  propagation.     —     ,       (   ).    ,     —        /.</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p> True,       . </p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">probe</span>(<span class="hljs-params">self, cell_state</span>):</span><font></font>
    board = self.board<font></font>
<font></font>
    pos, assumption = cell_state.position, cell_state.color<font></font>
    <span class="hljs-comment"># already solved</span>
    <span class="hljs-keyword">if</span> board.is_cell_solved(pos):
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> assumption <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> board.cell_colors(pos):<font></font>
        LOG.warning(<span class="hljs-string">"The probe is useless: color '%s' already unset"</span>, assumption)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
    save = board.make_snapshot()<font></font>
<font></font>
    <span class="hljs-keyword">try</span>:<font></font>
        board.set_color(cell_state)<font></font>
        propagation(<font></font>
            board,<font></font>
            row_indexes=(cell_state.row_index,),<font></font>
            column_indexes=(cell_state.column_index,))<font></font>
    <span class="hljs-keyword">except</span> NonogramError:<font></font>
        LOG.debug(<span class="hljs-string">'Contradiction'</span>, exc_info=<span class="hljs-literal">True</span>)
        <span class="hljs-comment"># rollback solved cells</span><font></font>
        board.restore(save)<font></font>
<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> board.is_solved_full:<font></font>
            self._add_solution()<font></font>
<font></font>
        board.restore(save)<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
    LOG.info(<span class="hljs-string">'Found contradiction at (%i, %i)'</span>, *pos)
    <span class="hljs-keyword">try</span>:<font></font>
        board.unset_color(cell_state)<font></font>
    <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> ex:
        <span class="hljs-keyword">raise</span> NonogramError(str(ex))<font></font>
<font></font>
    propagation(<font></font>
        board,<font></font>
        row_indexes=(pos.row_index,),<font></font>
        column_indexes=(pos.column_index,))<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></code></pre><br>
</div></div><br>
</li>
</ul><br>
<ul>
<li><p>(<strong>backtracking</strong>)        ,        —   (  —       ).     ,           .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>.</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p>    ,       ,     </p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span>(<span class="hljs-params">self, search_directions, path=(<span class="hljs-params"></span>)</span>):</span>
    <span class="hljs-string">"""
    Return False if the given path is a dead end (no solutions can be found)
    """</span><font></font>
    board = self.board<font></font>
    depth = len(path)<font></font>
<font></font>
    save = board.make_snapshot()<font></font>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">while</span> search_directions:<font></font>
            state = search_directions.popleft()<font></font>
<font></font>
            assumption, pos = state.color, state.position<font></font>
            cell_colors = board.cell_colors(pos)<font></font>
<font></font>
            <span class="hljs-keyword">if</span> assumption <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cell_colors:<font></font>
                LOG.warning(<span class="hljs-string">"The assumption '%s' is already expired. "</span>
                            <span class="hljs-string">"Possible colors for %s are %s"</span>,<font></font>
                            assumption, pos, cell_colors)<font></font>
                <span class="hljs-keyword">continue</span><font></font>
<font></font>
            <span class="hljs-keyword">if</span> len(cell_colors) == <span class="hljs-number">1</span>:<font></font>
                LOG.warning(<span class="hljs-string">'Only one color for cell %r left: %s. Solve it unconditionally'</span>,<font></font>
                            pos, assumption)<font></font>
<font></font>
                <span class="hljs-keyword">try</span>:<font></font>
                    self._solve_without_search()<font></font>
                <span class="hljs-keyword">except</span> NonogramError:<font></font>
                    LOG.warning(<font></font>
                        <span class="hljs-string">"The last possible color '%s' for the cell '%s' "</span>
                        <span class="hljs-string">"lead to the contradiction. "</span>
                        <span class="hljs-string">"The path %s is invalid"</span>, assumption, pos, path)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> board.is_solved_full:<font></font>
                    self._add_solution()<font></font>
                    LOG.warning(<font></font>
                        <span class="hljs-string">"The only color '%s' for the cell '%s' lead to full solution. "</span>
                        <span class="hljs-string">"No need to traverse the path %s anymore"</span>, assumption, pos, path)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
                <span class="hljs-keyword">continue</span><font></font>
<font></font>
            rate = board.solution_rate<font></font>
            guess_save = board.make_snapshot()<font></font>
            <span class="hljs-keyword">try</span>:<font></font>
                LOG.warning(<span class="hljs-string">'Trying state: %s (depth=%d, rate=%.4f, previous=%s)'</span>,<font></font>
                            state, depth, rate, path)<font></font>
                success = self._try_state(state, path)<font></font>
            <span class="hljs-keyword">finally</span>:<font></font>
                board.restore(guess_save)<font></font>
<font></font>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> success:
                <span class="hljs-keyword">try</span>:<font></font>
                    LOG.warning(<font></font>
                        <span class="hljs-string">"Unset the color %s for cell '%s'. Solve it unconditionally"</span>,<font></font>
                        assumption, pos)<font></font>
                    board.unset_color(state)<font></font>
                    self._solve_without_search()<font></font>
                <span class="hljs-keyword">except</span> ValueError:<font></font>
                    LOG.warning(<font></font>
                        <span class="hljs-string">"The last possible color '%s' for the cell '%s' "</span>
                        <span class="hljs-string">"lead to the contradiction. "</span>
                        <span class="hljs-string">"The whole branch (depth=%d) is invalid. "</span>, assumption, pos, depth)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> board.is_solved_full:<font></font>
                    self._add_solution()<font></font>
                    LOG.warning(<font></font>
                        <span class="hljs-string">"The negation of color '%s' for the cell '%s' lead to full solution. "</span>
                        <span class="hljs-string">"No need to traverse the path %s anymore"</span>, assumption, pos, path)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-comment"># do not restore the solved cells on a root path - they are really solved!</span>
        <span class="hljs-keyword">if</span> path:<font></font>
            board.restore(save)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_try_state</span>(<span class="hljs-params">self, state, path</span>):</span><font></font>
    board = self.board<font></font>
    full_path = path + (state,)<font></font>
<font></font>
    probe_jobs = self._get_all_unsolved_jobs(board)<font></font>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># update with more prioritized cells</span>
        <span class="hljs-keyword">for</span> new_job, priority <span class="hljs-keyword">in</span> self._set_guess(state):<font></font>
            probe_jobs[new_job] = priority<font></font>
<font></font>
        __, best_candidates = self._solve_jobs(probe_jobs)<font></font>
    <span class="hljs-keyword">except</span> NonogramError <span class="hljs-keyword">as</span> ex:<font></font>
        LOG.warning(<span class="hljs-string">'Dead end found (%s): %s'</span>, full_path[<span class="hljs-number">-1</span>], str(ex))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
    rate = board.solution_rate<font></font>
    LOG.info(<span class="hljs-string">'Reached rate %.4f on %s path'</span>, rate, full_path)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> rate == <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
    cells_left = round((<span class="hljs-number">1</span> - rate) * board.width * board.height)<font></font>
    LOG.info(<span class="hljs-string">'Unsolved cells left: %d'</span>, cells_left)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> best_candidates:
        <span class="hljs-keyword">return</span> self.search(best_candidates, path=full_path)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></code></pre><br>
</div></div><br>
</li>
</ul><br>
<p>,         (     ,         )      .   ,       ,            ,        .</p><br>
<p>    ( ),  python —     ,        CPU-intensive :            . ,    BGU- ( Java)      7-17 (  27)      . </p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre>        pynogram_my BGU_my      speedup<font></font>
Dancer      0.976    0.141      6.921986      <font></font>
Cat         1.064    0.110      9.672727      <font></font>
Skid        1.084    0.101     10.732673     <font></font>
Bucks       1.116    0.118      9.457627      <font></font>
Edge        1.208    0.094     12.851064     <font></font>
Smoke       1.464    0.120     12.200000     <font></font>
Knot        1.332    0.140      9.514286      <font></font>
Swing       1.784    0.138     12.927536     <font></font>
Mum         2.108    0.147     14.340136     <font></font>
DiCap       2.076    0.176     11.795455     <font></font>
Tragic      2.368    0.265      8.935849      <font></font>
Merka       2.084    0.196     10.632653     <font></font>
Petro       2.948    0.219     13.461187     <font></font>
M&amp;M         3.588    0.375      9.568000      <font></font>
Signed      4.068    0.242     16.809917     <font></font>
Light       3.848    0.488      7.885246      <font></font>
Forever   111.000   13.570      8.179808  <font></font>
Center      5.700    0.327     17.431193     <font></font>
Hot         3.150    0.278     11.330935     <font></font>
Karate      2.500    0.219     11.415525     <font></font>
9-Dom     510.000   70.416      7.242672      <font></font>
Flag      149.000    5.628     26.474769     <font></font>
Lion       71.000    2.895     24.525043     <font></font>
Marley     12.108    4.405      2.748695      <font></font>
Thing     321.000   46.166      6.953169      <font></font>
Nature      inf    433.138      inf     <font></font>
Sierp       inf      inf        NaN      <font></font>
Gettys      inf      inf        NaN      <font></font>
</pre> <br>
<p>    ,     ,   Jan Wolter   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></p></div></div><br>
<p>    ,     PyPy,    CPython    ,   PyPy  4-5 !  ,      Java     CPython  28-85 .</p><br>
<p>        (cProfile, SnakeViz, line_profiler)    ,      .</p><br>
<h3 id="itogihttpsgithubcomtsionyxpynogram"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>:</h3><br>
<p><strong>+</strong>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://webpbn.com</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://nonograms.org</a>    (ini-based) </p><br>
<p><strong>+</strong>  -        (  ,   — 10)</p><br>
<p><strong>+</strong>       (blotted). <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>.</p><br>
<p><strong>+</strong>      /   curses /   (    <em>pynogram-web</em>).          . </p><br>
<p><strong>-</strong>   (   ,   - , . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>).</p><br>
<p><strong>-</strong>  :      (    ). </p><br>
<h2 id="rust">Rust</h2><br>
<p>      Rust.  ,  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">The Book</a>,   WASM,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.   -  ,        (    -),    - .      .            Python,   " " . </p><br>
<p>      :   Rust           .       <em>BinaryColor + BinaryBlock</em> / <em>MultiColor + ColoredBlock</em>    -   .  -             ,       .</p><br>
<div class="spoiler"><b class="spoiler_title">    </b><div class="spoiler_text"><pre><code class="rust hljs"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Color</span></span><font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">blank</span></span>() -&gt; <span class="hljs-keyword">Self</span>;
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_solved</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">bool</span>;
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">solution_rate</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">f64</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_updated_with</span></span>(&amp;<span class="hljs-keyword">self</span>, new: &amp;<span class="hljs-keyword">Self</span>) -&gt; <span class="hljs-built_in">Result</span>&lt;<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">String</span>&gt;;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">variants</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">Self</span>&gt;;
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">as_color_id</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;ColorId&gt;;
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">from_color_ids</span></span>(ids: &amp;[ColorId]) -&gt; <span class="hljs-keyword">Self</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Block</span></span><font></font>
{<font></font>
    <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Color</span></span>: Color;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">from_str_and_color</span></span>(s: &amp;<span class="hljs-built_in">str</span>, color: <span class="hljs-built_in">Option</span>&lt;ColorId&gt;) -&gt; <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> size = s.parse::&lt;<span class="hljs-built_in">usize</span>&gt;().expect(<span class="hljs-string">"Non-integer block size given"</span>);<font></font>
        Self::from_size_and_color(size, color)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">from_size_and_color</span></span>(size: <span class="hljs-built_in">usize</span>, color: <span class="hljs-built_in">Option</span>&lt;ColorId&gt;) -&gt; <span class="hljs-keyword">Self</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">size</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">usize</span>;
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">color</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; Self::Color;<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">#[derive(Debug, PartialEq, Eq, Hash, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Description</span></span>&lt;T: Block&gt;
<span class="hljs-keyword">where</span><font></font>
    T: Block,<font></font>
{<font></font>
    <span class="hljs-keyword">pub</span> vec: <span class="hljs-built_in">Vec</span>&lt;T&gt;,<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// for black-and-white puzzles</span><font></font>
<font></font>
<span class="hljs-meta">#[derive(Debug, PartialEq, Eq, Hash, Copy, Clone, PartialOrd)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">BinaryColor</span></span> {<font></font>
    Undefined,<font></font>
    White,<font></font>
    Black,<font></font>
    BlackOrWhite,<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">impl</span> Color <span class="hljs-keyword">for</span> BinaryColor {
    <span class="hljs-comment">// omitted</span><font></font>
}<font></font>
<font></font>
<span class="hljs-meta">#[derive(Debug, PartialEq, Eq, Hash, Default, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BinaryBlock</span></span>(<span class="hljs-keyword">pub</span> <span class="hljs-built_in">usize</span>);<font></font>
<font></font>
<span class="hljs-keyword">impl</span> Block <span class="hljs-keyword">for</span> BinaryBlock {
    <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Color</span></span> = BinaryColor;
    <span class="hljs-comment">// omitted</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// for multicolor puzzles</span><font></font>
<font></font>
<span class="hljs-meta">#[derive(Debug, PartialEq, Eq, Hash, Default, Copy, Clone, PartialOrd, Ord)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">MultiColor</span></span>(<span class="hljs-keyword">pub</span> ColorId);<font></font>
<font></font>
<span class="hljs-keyword">impl</span> Color <span class="hljs-keyword">for</span> MultiColor {
    <span class="hljs-comment">// omitted</span><font></font>
}<font></font>
<font></font>
<span class="hljs-meta">#[derive(Debug, PartialEq, Eq, Hash, Default, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ColoredBlock</span></span> {<font></font>
    size: <span class="hljs-built_in">usize</span>,<font></font>
    color: ColorId,<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">impl</span> Block <span class="hljs-keyword">for</span> ColoredBlock {
    <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">Color</span></span> = MultiColor;
    <span class="hljs-comment">// omitted</span>
}</code></pre></div></div><br>
<p>        ,    ,   Rust ( ,  C++) —     .  ,          .   Python-        , <code>BguSolver</code>  <code>BguColoredSolver</code>  , , -    .  Rust-     generic- <code>struct DynamicSolver&lt;B: Block, S = &lt;B as Block&gt;::Color&gt;</code>,      ,        (<code>DynamicSolver&lt;BinaryBlock&gt;, DynamicSolver&lt;ColoredBlock&gt;</code>). , ,  ,   Python -   ,   Rust     ,      ,      .</p><br>
<p>        Rust,    ""  ,        : </p><br>
<pre>write_initial_code<font></font>
while (compiler_hints = $(cargo check)) != 0; do<font></font>
    fix_errors(compiler_hints)<font></font>
end<font></font>
</pre><br>
<p>      ,         borrow checker-         (,      ).</p><br>
<p>   ,         Rust (   Python-).</p><br>
<div class="spoiler"><b class="spoiler_title">unsolved_neighbours</b><div class="spoiler_text"><p>   ""    (x, y)</p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">unsolved_neighbours</span>(<span class="hljs-params">self, position</span>):</span>
    <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> self.neighbours(position):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_cell_solved(*pos):
            <span class="hljs-keyword">yield</span> pos</code></pre><br>
<pre><code class="rust hljs"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">unsolved_neighbours</span></span>(&amp;<span class="hljs-keyword">self</span>, point: &amp;Point) -&gt; <span class="hljs-keyword">impl</span> <span class="hljs-built_in">Iterator</span>&lt;Item = Point&gt; + <span class="hljs-symbol">'_</span> {
    <span class="hljs-keyword">self</span>.neighbours(&amp;point)<font></font>
        .into_iter()<font></font>
        .filter(<span class="hljs-keyword">move</span> |n| !<span class="hljs-keyword">self</span>.cell(n).is_solved())<font></font>
}</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">partial_sums</b><div class="spoiler_text"><p>  ,   ,    (     ).     ,      (      ). </p><br>
<p>     <code>[2, 3, 1]</code>    <code>[2, 6, 8]</code>,  ,         ,      2- ,     : </p><br>
<pre>            1 2 3 4 5 6 7 8 9 <font></font>
            _ _ _ _ _ _ _ _ _<font></font>
     2 3 1 |_|_|_|_|_|_|_|_|_| <font></font>
              ^       ^   ^<font></font>
              |       |   |<font></font>
 1  |       |   | <font></font>
 2  --------    |<font></font>
 3  ------------<font></font>
</pre><br>
<pre><code class="python hljs"><span class="hljs-meta">@expand_generator</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">partial_sums</span>(<span class="hljs-params">blocks</span>):</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> blocks:
        <span class="hljs-keyword">return</span><font></font>
<font></font>
    sum_so_far = blocks[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">yield</span> sum_so_far<font></font>
<font></font>
    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks[<span class="hljs-number">1</span>:]:<font></font>
        sum_so_far += block + <span class="hljs-number">1</span>
        <span class="hljs-keyword">yield</span> sum_so_far</code></pre><br>
<pre><code class="rust hljs"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">partial_sums</span></span>(desc: &amp;[<span class="hljs-keyword">Self</span>]) -&gt; <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">usize</span>&gt; {<font></font>
    desc.iter()<font></font>
        .scan(<span class="hljs-literal">None</span>, |prev, block| {
            <span class="hljs-keyword">let</span> current = <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-literal">Some</span>(<span class="hljs-keyword">ref</span> prev_size) = prev {<font></font>
                prev_size + block.<span class="hljs-number">0</span> + <span class="hljs-number">1</span>
            } <span class="hljs-keyword">else</span> {<font></font>
                block.<span class="hljs-number">0</span><font></font>
            };<font></font>
            *prev = <span class="hljs-literal">Some</span>(current);<font></font>
            *prev<font></font>
        })<font></font>
        .collect()<font></font>
}</code></pre></div></div><br>
<p>     </p><br>
<ul>
<li>  ()    (     generic-    )</li>
<li>  ( )    </li>
<li> ini     TOML-</li>
<li>   blotted-,  ,  ,      </li>
<li><p>    —   ,          ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>)</p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xm/fd/ez/xmfdezlfahkoksuj3h0djom3p9k.png" alt="Jack Sparrow"></p><br>
</div></div><br>
</li>
</ul><br>
<h3 id="poleznye-instrumenty"> </h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">clippy</a> —   ,      ,    </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">valgrind</a> —     .         (<code>valrgind --tool=callgrind</code>)        (<code>valrgind --tool=massif</code>). :  <em>[profile.release] debug=true</em>  Cargo.toml   .    debug-   .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">kcachegrind</a>    callgrind.            .</li>
</ul><br>
<h3 id="proizvoditelnost"></h3><br>
<p>,       Rust.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>     ,    , .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>      .         ,     .</p><br>
<div class="spoiler"><b class="spoiler_title">  Jupyter-</b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<font></font>
%matplotlib inline<font></font>
<font></font>
<span class="hljs-comment"># strip the spaces</span>
df = pd.read_csv(<span class="hljs-string">'perf.csv'</span>, skipinitialspace=<span class="hljs-literal">True</span>)<font></font>
df.columns = df.columns.str.strip()<font></font>
df[<span class="hljs-string">'name'</span>] = df[<span class="hljs-string">'name'</span>].str.strip()<font></font>
<font></font>
<span class="hljs-comment"># convert to numeric</span>
df = df.replace(<span class="hljs-string">'\+\ *'</span>, np.inf, regex=<span class="hljs-literal">True</span>)<font></font>
ALL_SOLVERS = list(df.columns[<span class="hljs-number">3</span>:])<font></font>
df.loc[:,ALL_SOLVERS] = df.loc[:,ALL_SOLVERS].apply(pd.to_numeric)<font></font>
<span class="hljs-comment"># it cannot be a total zero</span>
df = df.replace(<span class="hljs-number">0</span>, <span class="hljs-number">0.001</span>)
<span class="hljs-comment">#df.set_index('name', inplace=True)</span><font></font>
<font></font>
SURVEY_SOLVERS = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> ALL_SOLVERS <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> s.endswith(<span class="hljs-string">'_my'</span>)]<font></font>
MY_MACHINE_SOLVERS = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> ALL_SOLVERS <span class="hljs-keyword">if</span> s.endswith(<span class="hljs-string">'_my'</span>) <span class="hljs-keyword">and</span> s[:<span class="hljs-number">-3</span>] <span class="hljs-keyword">in</span> SURVEY_SOLVERS]<font></font>
MY_SOLVERS = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> ALL_SOLVERS <span class="hljs-keyword">if</span> s.endswith(<span class="hljs-string">'_my'</span>) <span class="hljs-keyword">and</span> s[:<span class="hljs-number">-3</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> SURVEY_SOLVERS]  <font></font>
<font></font>
bar_width = <span class="hljs-number">0.17</span>
df_compare = df.replace(np.inf, <span class="hljs-number">10000</span>, regex=<span class="hljs-literal">True</span>)<font></font>
plt.rcParams.update({<span class="hljs-string">'font.size'</span>: <span class="hljs-number">20</span>})<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compare</span>(<span class="hljs-params">first, others</span>):</span><font></font>
    bars = [first] + list(others)<font></font>
    index = np.arange(len(df))    <font></font>
    fig, ax = plt.subplots(figsize=(<span class="hljs-number">30</span>,<span class="hljs-number">10</span>))<font></font>
<font></font>
    df_compare.sort_values(first, inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-keyword">for</span> i, column <span class="hljs-keyword">in</span> enumerate(bars):<font></font>
        ax.bar(index + bar_width*i, df_compare[column], bar_width, label=column[:<span class="hljs-number">-3</span>])<font></font>
<font></font>
    ax.set_xlabel(<span class="hljs-string">"puzzles"</span>)<font></font>
    ax.set_ylabel(<span class="hljs-string">"Time, s (log)"</span>)<font></font>
    ax.set_title(<span class="hljs-string">"Compare '{}' with others (lower is better)"</span>.format(first[:<span class="hljs-number">-3</span>]))<font></font>
    ax.set_xticks(index + bar_width / <span class="hljs-number">2</span>)<font></font>
    ax.set_xticklabels(<span class="hljs-string">"#"</span> + df_compare[<span class="hljs-string">'ID'</span>].astype(str) + <span class="hljs-string">": "</span> + df_compare[<span class="hljs-string">'name'</span>].astype(str))<font></font>
    ax.legend()<font></font>
<font></font>
    plt.yscale(<span class="hljs-string">'log'</span>)<font></font>
    plt.xticks(rotation=<span class="hljs-number">90</span>)<font></font>
    plt.show()<font></font>
    fig.savefig(first[:<span class="hljs-number">-3</span>] + <span class="hljs-string">'.png'</span>, bbox_inches=<span class="hljs-string">'tight'</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> my <span class="hljs-keyword">in</span> MY_SOLVERS:<font></font>
    compare(my, MY_MACHINE_SOLVERS)<font></font>
<font></font>
compare(MY_SOLVERS[<span class="hljs-number">0</span>], MY_SOLVERS[<span class="hljs-number">1</span>:])</code></pre></div></div><br>
<h5 id="python-solver">python-</h5><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/si/qb/5o/siqb5ohxk_bjjaulmkohy1uhzkw.png" alt="ファイノグラムパフォーマンス"><br>
</a><br>
(<em> </em>)</p><br>
<p>,  <em>pynogram</em>     .      —  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Tamura/Copris</a>,   SAT,     (  )  ,  .     SAT-:      ,        .       ,  <em>Tamura/Copris</em>            . </p><br>
<h5 id="rust-solver">rust-</h5><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/bh/be/cb/bhbecb0ccinpwfhysauyjkrcx24.png" alt="nonogridパフォーマンス"><br>
</a><br>
(<em> </em>)</p><br>
<p>   ,  <em>nonogrid</em>        ,   ,   C  ++ (<em>Wolter</em>  <em>Syromolotov</em>).   ,      <em>BGU</em>- (Java),        .     <em>Tamura/Copris</em>    .</p><br>
<h5 id="rust-vs-python">rust vs python</h5><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ih/0b/2r/ih0b2rnmyk5o_rpgckz_5hkkifc.png" alt="py-vs-rust-performance"><br>
</a><br>
(<em> </em>)</p><br>
<p>      ,  . ,  Rust-     1-3   .</p><br>
<h3 id="itogihttpsgithubcomtsionyxnonogrid"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>:</h3><br>
<p><strong>+</strong>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://webpbn.com</a> ( blotted — c    ), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://nonograms.org</a>    (TOML-based) </p><br>
<p><strong>+</strong>  -       </p><br>
<p><strong>+</strong>      ( c webpbn.com    )</p><br>
<p><strong>+</strong>   (   ,   - , . ).</p><br>
<p><strong>-</strong>   ,    Python-:   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   20x20</a>)    (    ).          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SAT-</a>.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SAT-  Rust</a>       . </p><br>
<h2 id="webassembly">WebAssembly</h2><br>
<p>,    Rust   :    .  Rust       :   WebAssembly        . </p><br>
<p>        Rust,         boilerplate    Rust   JS- —  <em>wasm-pack</em> (+<em>wasm-bindgen</em>).    c         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Rust and WebAssembly</a>.    ,    :</p><br>
<ul>
<li><p>   ,        JS-,        Rust.     ,      <em>npm</em>.   ,  ,   ,   ,             web-,   <code>npm run start</code>.</p><br>
<p>   wasm-pack  ,    JS- (  npm-). <code>wasm-pack build --target no-modules --no-typescript</code>      : <em>project-name.wasm</em> —  Rust-,   WebAssembly  <em>project-name.js</em>.       HTML- <code>&lt;script src="project-name.js"&gt;&lt;/script&gt;</code>   WASM-,    npm, webpack, ES6,      JS-.  <code>no-modules</code>    -    WASM-,      ,       frontend-.</p><br>
</li>
<li><p>WebAssembly   ,     JavaScript.     ,    .   ,        WebAssembly         .     <em>Warning: Unresponsive script</em>,        .        <em>Web worker</em>.       "" WASM-   :</p><br>
<ol>
<li>     (   )        .</li>
<li>  ,        . </li>
<li>     -   ()</li>
</ol><br>
</li>
</ul><br>
<p>  WASM-         JS,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  WASM</a>.      -   (       ),     <code>HashMap</code>       ,     .    ( JS)    ,          /   .</p><br>
<p>      ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  Mutex</a>,        thread-safe.       smart-    .   thread-safe     <em>Rc</em>  <em>Arc</em>  <em>RefCell</em>  <em>RwLock</em>.         :         30%.         <code>--features=threaded</code>      thread-safe ,     WASM-. </p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">6574</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">8098</a>    (     10 ):</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th>id</th>
<th>non-thread-safe</th>
<th>thread-safe</th>
<th>web-interface</th>
</tr>
</thead>
<tbody>
<tr>
<td>6574</td>
<td>5.4</td>
<td>7.4</td>
<td>9.2</td>
</tr>
<tr>
<td>8098</td>
<td>21.5</td>
<td>28.4</td>
<td>29.9</td>
</tr>
</tbody>
</table></div><br>
<p>,   -    40..70% ,       ,      (32..37%)      thread-safe  (<code>cargo build --release --features=threaded</code>).</p><br>
<p>   Firefox 67.0  Chromium 74.0. </p><br>
<p>WASM-   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>).            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">https://webpbn.com/</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://www.nonograms.org/</a> </p><br>
<h3 id="todo">TODO</h3><br>
<ul>
<li><p>""  /,  /    .</p><br>
</li>
<li><p>    ,     .      "" ,    ,        .      .</p><br>
</li>
<li><p>    (    ,      3600 ).  WASM     ,     (  ,   (!) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,   ,     WASM). ,  , -  ,       nonogrid  .</p><br>
</li>
<li><p>  .      : ,       ,      WASM   .    ,         ( )    ,    JS  ,      .</p><br>
</li>
<li><p>    JS.         backtrace,       .</p><br>
</li>
<li><p>       (     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">TOML-</a>)</p><br>
</li>
</ul><br>
<h2 id="itogi"></h2><br>
<ul>
<li><p>          ,    (, , etc).</p><br>
</li>
<li><p>  Rust  1-3     PyPy       1.5-2  (  ).</p><br>
</li>
<li><p>   Python  Rust  ,            Python (, , comprehensions),      Rust-.</p><br>
</li>
<li><p>  Rust  WebAssembly   .     Rust ,   WASM,      (     1.5  ). </p><br>
</li>
</ul><br>
<h2 id="osnovnye-istochniki"> </h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">The 'pbnsolve' Paint-by-Number Puzzle Solver by Jan Wolter</a> and the <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">survey</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">The BGU Nonograms Project</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Solving Nonograms by combining relaxations</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">An Efficient Approach to Solving Nonograms</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光速で和色クロスワードを解く</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインのカラーと白黒の日本語クロスワード</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態機械を使用して日本語のクロスワードを解く</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">博士による「Nonolib」ライブラリ </font><font style="vertical-align: inherit;">スティーブン・シンプソン</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RustとWebAssembly</font></font></a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454570/index.html">C ++ 17で古いDOSゲームを再作成する</a></li>
<li><a href="../ja454574/index.html">マイクロファイナンスでの機械学習：空の信用履歴を持つクライアントのスコアリングモデルの構築</a></li>
<li><a href="../ja454576/index.html">GandCrabの作者は作業を停止します：彼らは十分に盗まれたと主張します</a></li>
<li><a href="../ja454578/index.html">Android WebViewでPhotoSwipeギャラリーを接続する方法</a></li>
<li><a href="../ja454584/index.html">インターフェイス開発学校：ミンスクとモスクワの新しいセットのタスクの分析</a></li>
<li><a href="../ja454588/index.html">Gazprom Neftはあなたを訪問するように誘います：GPN Data Science Meetup</a></li>
<li><a href="../ja454590/index.html">Zimbra Collaboration SuiteおよびABQを備えたモバイルコントロール</a></li>
<li><a href="../ja454596/index.html">情報セキュリティのメンタルモデル</a></li>
<li><a href="../ja454598/index.html">サーバーレスアーキテクチャとマイクロサービス：完璧な一致？</a></li>
<li><a href="../ja454600/index.html">Freelansimで安全な取引をした方法：選択肢の提供、機能の削減、手数料の比較</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>