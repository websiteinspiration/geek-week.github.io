<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❕ 🤟 👍 DEFCON 27 Conference。Buttplug：真の侵入テスト。パート2 📬 🍊 👩🏻‍✈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="アナリストは、モノのインターネット（IoT）の世界には現在約100億台のデバイスがあると考えています。時々、これらのデバイスは市場での地位を獲得し、文字通り人間の尻を登っていきます。結局のところ、安価で低電力の無線チップは、ホームオートメーションに最適であるだけでなく、大人のおもちゃの扱い方も変えて...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DEFCON 27 Conference。Buttplug：真の侵入テスト。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/495792/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アナリストは、モノのインターネット（IoT）の世界には現在約100億台のデバイスがあると考えています。時々、これらのデバイスは市場での地位を獲得し、文字通り人間の尻を登っていきます。結局のところ、安価で低電力の無線チップは、ホームオートメーションに最適であるだけでなく、大人のおもちゃの扱い方も変えています。このレポートでは、双方向の通信回線を通じてパートナー間で触覚、温度、その他の感覚が伝わる距離でのセックスのテクノロジーであるテレビディルドニクスの世界に突入します。スピーカーは、Buttplug電子電子肛門性玩具の安全性が、スタックの各レベルで脆弱性を見つけて悪用する攻撃者に対抗できることを教えてくれます。最終的には、これにより性玩具自体が危険にさらされ、そしてそれらが接続するデバイス。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z5/yr/ar/z5yraruqzcjhhyd_pc_eym4a5ly.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
smea、またはSmealumというニックネームを持つハッカーは、任天堂DSなどのゲームコンソール用のビデオゲームの開発者としてキャリアを始め、同時にそれらを解読しようとしました。ある時点で、コンソールは深刻なセキュリティシステムを取得し、Smeaは自社開発のソフトウェアからそれを破壊するための開発技術に切り替えました。 Smeaはニンテンドー3DSとWii Uでの「仕事」で知られていますが、最も人気のあるWebブラウザーと仮想化スタックのエクスプロイトの開発にも貢献しました。おそらく、今では彼は「スマートな」肛門プラグに侵入することに興味を持ちました。</font></font><a name="habracut"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEFCON 27 Conference。Buttplug：真の侵入テスト。パート1</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/xq/wz/de/xqwzdenvl7ovwamxxyxf_byvjiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
もちろん、このように短い行の長さでも着信メッセージを管理できます。たとえば、悪意のあるJavaScriptを実行するには30文字で十分です。このスライドは、存在しないソースからの画像の30文字の長さのタグの例を示しています&lt;img src = a onerror = 'alert（1）'&gt;。これにより、アプリケーションでエラーメッセージが表示されます。このメッセージは、画像のロードが本当に不可能な場合に表示されます。スクリーンショットは、侵害されたドングルを介して接続すると、悪意のあるJavaScriptを実行できることを示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/p8/9x/kdp89xy1fdjf_ib5vcifs6wmix4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボリュームペイロードを実現するのは難しいため、32文字の制限は厄介ですが、それは可能です。つまり、USBキーを使用したアプリケーションの侵害に成功し、ハッキングの逆、つまりハッカーのブートプラグを使用してアプリケーションの侵害を行っているところです。ドングルコンピュータサイトでのハッキングは、2つの方法で発生する可能性があります。コンピュータを介してドングルを危険にさらすことと、ドングルを介してコンピュータを危険にさらすことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドングルは、ブートプラグとアプリケーション間の小さなブリッジとして機能します。問題が発生します。同じ脆弱性を使用して、bootplagを介してコンピューター上のアプリケーションを直接侵害することは可能ですか？残念ながら、この質問に対する答えは否定的です。その理由は、ブートプラグインからアプリケーションに送信されるメッセージ文字の長さに別の制限があるためです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/xp/_c/bixp_ckg43nxt6acd4aq_px4wae.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドングルは、ブートプラグインのメッセージをパックしてアプリケーションに送信するだけです。このステップで、HTMLコードをメッセージに挿入できます。ただし、一度に20バイト以下のメッセージを受信できるため、XSS攻撃を実行するには不十分です。ただし、ドングルファームウェアにはバグがあります。行の終わりにnullターミネーターのチェックがありません。したがって、20文字の文字列の終わりの後に初期化されていないデータを配置できる場合は、20文字を超えるアプリケーションを送信できます。残念ながら、実際にこの脆弱性を使用する方法は見つかりませんでしたが、そのような機会は覚えておく価値があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、問題はおそらく、この脆弱性を使用して、ブートプラグインから直接受け取ったコードをアプリケーションに実行させることはできないということです。悲しいことですが、ドングルのファームウェアを見ると、原則として、受信したデータには何の影響も与えず、新しい行にコピーしてさらに送信するだけであることがわかります。したがって、この脆弱性を利用して、メモリバッファをオーバーフローさせて攻撃することはできません。しかし、ブートプラグインから直接アプリケーションをハックできない場合、おそらくブートプラグドングルコンピュータチェーンを通じて行われるでしょうか。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドングルチップを使用すると、元のLovense Hush開発者プログラムに必要なコードよりもはるかに多くのコードを配置できるので便利です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9m/bf/k7/9mbfk7wqpqdoodi2nndnppiirfo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドングルのフラッシュメモリには、DFUローダー用に予約された領域、Lovenseアプリケーション自体用の領域、Nordic Semiconductor BLEチップ用のハードウェアドライバー用の閉じたSoftDevice領域が含まれています。これは、BLEプロトコル自体が処理される場所です。たとえば、アプリケーションがBLEメッセージをおもちゃに送信したい場合、SVCコールを介してSoftDeviceにアクセスします。これら3つの領域に加えて、ドングルには、十分に大きなボリュームのフラッシュメモリの未使用領域があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLE SoftDeviceスタックの脆弱性を見つけるには、オープンソースではないため、リバースエンジニアリングを使用する必要があります。ファームウェアプラグインの脆弱性を見つけるために同じことを行いました。この場合、ASLRもないため、データフローをたどることが非常に簡単で、これらのメッセージを処理するコードを簡単に特定できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yh/wq/ch/yhwqchpeynrmburahytjp2gxqd8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドの右側には、GATTC着信パケットハンドラー（一般的な属性のプロファイル）があり、これは本質的にドングルです。特に、応答パケットのタイプごとの読み取りハンドラーです。私はBluetoothデバイスの専門家ではありませんが、ここでのポイントは、ドングルが周辺デバイスのタイプを読み取り、このタイプに関連付けられた属性のすべてのバリアントのハンドラーを使用することです。つまり、実際には一度に複数の属性を取得でき、属性データのペアの各ハンドラーのサイズはパッケージ内のフィールドとしてエンコードされているため、それらを管理できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/sa/9h/cksa9hsxwiqwgqoyklkgwwhx2pa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドは、そのようなパッケージのサンプルを示しています。 GATTクライアントは、読み取る記述子のタイプと範囲を含む、タイプごとの読み取り要求パケットを送信できます。タイプ別読み取り要求に応答するサーバーは、このタイプに対応する範囲内のハンドラーに関連付けられたデータを返します。記述子とデータのペアの数は、残りのパケットの長さを記述子とデータのペアのフィールド長で割ることによって決定され、このフィールドは常に0x7または0x15です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/zf/gm/j7zfgmebqqi3va1lslmsmr3pzr8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスライドは、対象となる関数の操作を示しています。パケットには属性の配列からのデータがどのように入力され、固定長のバッファが割り当てられています。ここに記述子の値が配置され、次にそれに関連付けられたポインタが配置されます。属性配列は、バッファ内に16進形式で配置されるバイナリデータです。データは青色で強調表示され、その隣に0D記述子とそれに関連するポインター00がオレンジ色で強調表示されます。 2番目と3番目のハンドラーのパッケージは似ています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
脆弱性は以下の通りです。右側のコードを読むと、紫色のフレームに配置されているattribute_data_lengthパラメーターを確認できます。着信メッセージの長さで、その値は潜在的な攻撃者によって完全に制御されています。そこでゼロ値を配置すると、無限ループが発生します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wk/mo/hi/wkmohi2rrehqx3o1mgupqhdseek.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードは、出力バッファーに書き込むデータがこの出力バッファー内にあるかどうかをチェックしないため、ループは無限になります。その結果、デバイスにASLRまたはDEPがなく、コードがすぐに実行されるため、古典的なスタックバッファーオーバーフローが発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゼロの値を割り当てて無限ループを取得すると、実際にはすべてのRAMデータがガベージに置き換えられます。ただし、これはデバイス障害を引き起こす可能性が高いため、失敗したソリューションです。ただし、値1を使用すると、着信メッセージ内のバイト数が制限されます。これは、次のことを意味します。このバッファーをわずかにオーバーフィルすると、スタックに基づくバッファーが、その隣にあるすべてのものを損傷する可能性があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vg/rf/iy/vgrfiyhiseechjyxntzkrztnp14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーバーフローする前のスタックの様子を見てみましょう。これまでに説明したバッファ属性の配列は黄色で強調表示され、保存されているレジスタは青色で、戻りアドレスはオレンジ色で強調表示されています。属性の長さを0x01に設定すると、多くのハンドルとデータポインターのペアがオーバーフローする可能性があります。記述子は2バイトで構成されますが、DWORD記述子の上位2バイトはクリアされません。オーバーフローしているバッファーはスタック上にあり、Cookie、ASLR、DEPはありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/es/oo/ko/esooko6lhrdqef9gglnoyx2ffh8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、システムをテストします。属性の長さが0x01の0xDAバイトでいっぱいのパケットを送信します。戻りアドレスを属性データへのポインターで書き換えていることがわかります。 DEPがないため、関数が戻るたびに、パッケージ内のコードが実行されます。唯一の制限は、LSBを最下位ビットに設定するために戻りアドレスが必要であることです。これにより、Cortex M0プロセッサはARMモードをサポートしないため、コードはThumbモードで実行されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rc/5w/gl/rc5wglu00lbsx5v9gnix6v1as2c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、いくつかのローカル変数を書き換えますが、途中で使用されたものは一切書き換えないようにします。基本的に、私たちは古典的なバックドアパッケージを取得します。このスタックに注意を払うと、書き換えられたものが境界線に対応していないことがわかり、プログラムがクラッシュします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
格納されたレジスタに関しては、別の要件があります。これらは、関数が戻るときに上書きされるローカル変数です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/kv/m2/ftkvm2tpkt7iepg-fwtrpx2kkiq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらの1つは32ビット境界線を逆参照するために使用され、境界線とのコンテンツの不一致によりプログラムがクラッシュします。したがって、saved_arg_3 = 0、saved_arg_4がDWORDに対応していること、つまり、境界内にあり、LSBが設定されていることを確認する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、このパッケージが機能していることを確認する必要があります。幸いなことに、SoftDeviceがこれらの着信パケットを配信する方法は、強制的なアライメント要件のないリングバッファーであるため、これは本当に簡単です。ホワイトシャークは、前のパケットの長さを変更することによって、後続のパケットのアラインメントを制御できることを確認することを可能にしました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/3j/ia/mr3jiaai4k_cnlfzea9a0zyvgqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エクスプロイトパッケージが送信される前に送信される黄色と青の強調表示された2つのパッケージ。これにより、最後のパッケージの配置を制御し、プログラムのクラッシュを引き起こさないようにすることができます。これは、私たちが目指していることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nordic SoftDeviceは生のBLEパケットを送信するためのインターフェースを提供していません。</font><font style="vertical-align: inherit;">これを回避するには、2つのオプションを使用できます。独自のBLEスタックを実装するか、元のパッケージのフックをクラックします。</font><font style="vertical-align: inherit;">私は怠惰なので、オプション2を選択しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのフックは非常にシンプルですが、リバースエンジニアリングが必要です。</font><font style="vertical-align: inherit;">ハッキング方法はgithubにあります。インターフェースはかなり「ダーティ」であり、これが機能する保証はありませんが、私はそれを行いました。</font><font style="vertical-align: inherit;">あなたはまだBTLEJackを使用する方が良いです。</font></font><br>
<br>
<pre><code class="plaintext hljs">void ble_outgoing_hook(uint8_t* buffer, uint8_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このSoftDeviceポインターは、BLEパケットが送信されるたびに呼び出されるため、事前に変更できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">int ble_incoming_hook(uint8_t* buffer, uint16_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このフックSoftDeviceは、BLEパケットが受信されるたびに呼び出されます。戻り値は、通常のSoftDevice処理をスキップするかどうかを決定します。</font></font><br>
<br>
<pre><code class="plaintext hljs">int send_packet(void* handle, void* buffer, uint16_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、このBLE接続に生のパケットを送信する機能がどのように見えるかです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一度に4バイトを超えるコードを処理するにはどうすればよいですか？いくつかのパッケージを送信する必要があります！右側には、着信BLEパケットのリングバッファが表示されます。最初のパケットは緑色で示されています。制御されたパラメーターを使用して関数呼び出しを実行し、「クリーン」を返すシェルコードです。 2番目のパケットは黄色で表示されます。これは、関数呼び出しで使用できるデータバッファーです。 3番目のパケットは青色で示されています—関数呼び出しパラメーターの値を含むバッファーとオレンジ色—命令C1 E7を使用して脆弱性を起動するパケットです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/47/up/ki/47upki5tumqqj_c4ysc09rw2i0g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
純粋な関数を返した後、このパッケージを再送信できます。これらの4つのパケットを送信すると、ドングル内の任意のコードが実行されます。これは何度も繰り返すことができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z2/hg/jg/z2hgjgfs0udpsjpfcm0l7gppqmw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法でmemcpyを数回呼び出すだけで、より大きなシェルコードバイナリをRAMにコピーできるため、これは便利です。次に、この関数を呼び出してメモリ内の元のドングルコードにパッチを適用し、それを使用してコンピューターにインストールされているアプリケーションを危険にさらします。 XSSペイロードは大きいため、送信せず、ドングル自体のシェルコードで生成します。シェルコードは以下の通りです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c7/bi/oy/c7bioypcqko4flgvncaxbz8e2qm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの操作の結果、以下が得られます。アプリケーションを制御できれば、ドングルとブートプラグを制御できます。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zq/qj/dv/zqqjdv3mounl3az58buw63jinri.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
buttplag-dongleセクションでのハッキングには2つの方法があります。ドングルはおもちゃを危険にさらす可能性があり、buttplagはドングルとコンピューターの両方を危険にさらす可能性があります。ボーナスは、Nordic BLEの脆弱性がLovense製品だけでなく、BLEのクライアント側にSoftDevise S110、S120、またはS130を使用するすべてのデバイスにも存在することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、bootplagを使用してアプリケーションを危険にさらす機会があります。これはどのように使用できますか？ Lovenseアプリケーション内でJavaScriptコードを実行しているだけですが、問題は、これによって何が得られるかということです。 lovense.exeアプリケーションはILで実行され、Windowsで実行され、管理者特権がなくても、コンピューター上のファイルにアクセスでき、任意のコードを実行でき、XSSを実装して、ネットワークにアクセスできることがわかります等</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/zo/ng/zezongcdgttvaxcxleyye2bzrwi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の質問：bootplagだけでなく、ユーザーのコンピューターにも感染するランサムウェアプログラムを作成できる場合、ウイルスに感染させることでさらに拡散させる方法はありますか？これでローカルレベルでのハッキングができましたが、ハッカーにとっては、インターネットを介して多くのユーザーコンピュータを制御するほうがはるかに便利です。これどうやってやるの？ビデオチャット、テキストチャット、画像転送、リモコン自体などのおもちゃのソーシャル機能により、攻撃対象が大幅に拡大します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リモートコントロールは優れた目標です。開発者がプロ​​プライエタリなプログラムを使用したい場合、間違いなくバグと脆弱性があるからです。それの使い方？たとえば、コマンド「Vibrate：10」などのコマンドを含むJSONオブジェクトをパートナーに送信できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">{<font></font>
cate: "id",<font></font>
id: {<font></font>
DEADBABEBEEF: {<font></font>
v: 10<font></font>
}<font></font>
}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、受信者は着信JSONを分析し、おもちゃのコマンドを生成してさらに送信します。ここには2つのモードがあります。最初のモード「id：」は1つの特定の大人のおもちゃにコマンドを送信し、2番目のモード「all：」はすべてのリモートおもちゃにコマンドを送信します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力データは正しく検証されていますか？ JSONは非常に柔軟であるため、コードは数値を想定しており、代わりに文字列全体を取得できます。おもちゃに送信されるコマンドを制御できれば、おそらくドングルパーサーのバグを使用できます。次のスライドでは、オレンジ色のフレームは入力データが使用される場所を示し、青いフレームはチェックされる場所を示しています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このバグは、vibrateなどのコマンドの入力が実際に整数であることをアプリケーションが適切にチェックしないことです。この場合、「id：」モードでは、振動強度インデックスがn&gt; = 0であることのみがチェックされ、ゼロより大きい整数12を渡すと、このパラメーターはテストに合格します。文字列、つまり引用符で囲まれた数字「12」を渡しても、システムはそれを受け入れます。 「12test」など、数字と文字を組み合わせた形式の文字列のみを受け入れるわけではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p3/wo/30/p3wo30wl9o4ep3sbfovnxegq2zw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、このチェックではテキストコマンドを入力できません。ただし、コードの下部を見ると、同じチェックが表示されます。今回のみ、アプリケーションは条件n &lt;0をチェックします。ここで、「12test」と入力すると、アプリケーションは指定された式を文字列として0以上であると見なすため、テストに合格しません。ただし、フォームの不等式チェックで文字列を入力すると（「12test」&lt;0）、システムはtrueと見なします。 、これは整数でも数字でもないという事実にもかかわらず、英数字の組み合わせです。つまり、これは、ドングルに送信される任意の文字列をこのコマンドに入力できることを意味します。これにより、JSONパーサーを介してドングルを危険にさらすために以前と同じ方法でエクスプロイトコードを送信できます。唯一の違いは、インターネットを介して実行できるようになったことです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/br/ep/cv/brepcvtjvqntad29bb6yrjzvmqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、着信データをチェックするためのフィルターの実装にバグがあるため、Lovenseアプリケーションを介してリモートでドングルを危険にさらす機会がありました。これにより、ユーザーのコンピューターをクラックすることができます。ドングルをハッキングすることは素晴らしいことですが、成功の条件は、おもちゃのリモートコントロールを偽装した攻撃者にパートナーが転送することに同意することです。これは標的型攻撃には便利ですが、バイラル攻撃にはまったく適していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、テキストチャットと画像には権限は必要ありません。これにより、チャットテキストメッセージで悪意のあるHTMLコードを送信することにより、従来のXSS攻撃を完全に許可できます。ウイルスを配布するのは簡単です。適切なJavaScript関数を作成して、友​​達にスパムを送信するだけです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/l_/8x/khl_8xhfj3bvdiisecommxrbloe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この段階では、メッセージを送信するだけでコードを実行でき、基本的に目標を達成しました。</font><font style="vertical-align: inherit;">最終的なXSSペイロードは次のように機能します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被害者のマシンで発生するはずのことをすべて実行します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャットにアクセスできるJavaScriptオブジェクトを取得します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このスクリプトをダウンロードするXSSペイロードをすべての友達のコンピューターに送信します。</font></font></li>
</ol><br>
<img src="https://habrastorage.org/webt/8_/x5/6c/8_x56cslpr-tywovkeqgo7qbml0.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ブートプラグインからインターネットまで、ネットワークのすべてのノードに危害を加えました。</font><font style="vertical-align: inherit;">これで、任意のデバイスから任意のデバイスを危険にさらすことができます-お尻ワーム、または「assワーム」と呼ばれるウイルスを作成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/iq/lu/gjiqlujshp5vcsj5tm-hv6cbl8q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約束したとおり、今度はライブビデオをお見せします。最初に説明するのは、BTLEジャックを使用して、ブートプラグインとドングルが接続されている通常のWindows仮想マシンとの間の接続をインターセプトすることです。では、ブートプラグをオンにしてみましょう。振動の音が聞こえるといいですね。 （笑い）。うまくいったので、今度はおもちゃをアプリケーションコントロールパネルに追加してみましょう。プログラムがHushを見つけたことを確認しますが、しばらくお待ちください！ BTLEジャックプロセスを開始するのを忘れました。このモードでBTLEジャックを使用する必要がある唯一の理由は、ライブデモを容易にするためですが、実際には、スニッフィングの必要なく既存の接続を傍受できます。だから私は実験を簡単にするためだけにこれを立ち上げています。もう一度繰り返しましょう。おもちゃへの接続が確立されていることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/v6/_h/nzv6_hy7ygt8gu9nqx7opfjz6-u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左側のスニファーは、この接続が見つかったことを示しています。したがって、私たちは大人のおもちゃに関連付けられているアプリケーションを持っています。私が本当にブートプラグインを制御できると聞いているかどうかはわかりません（smeaがスライダーを上に動かすと、振動の増幅音が聞こえます）。これをオフにします（スライダーを下に動かすと、振動音が消えます）。この接続をハックする必要があります。これを行うには、いくつかのパラメーターをコピーしてsmea @ ubuntu行に貼り付け、最後にtパラメーター（接続をインターセプトするコマンド）を入力します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u4/cm/bo/u4cmbo-uglzsqjur_ikimj7lifg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが機能する場合、アプリケーションとの接続を強制終了します。ご覧のように、デバイスとの接続が失われたというメッセージがアプリケーションウィンドウに表示されました。 BTLEジャックに素晴らしいツールをありがとう！ブートログはアプリケーションから切断され、ubuntu仮想マシンを通じて制御されるようになりました。理論的には、リモートで振動させることができるはずです。 Vibrate 20チームと入力すると、ご覧のとおり、すべてが機能します。公式アプリケーション（聴衆からの拍手）を使わずに、リモートでbootplagを制御することができました。これをDFUモードにします。それが機能する場合は、これを停止する必要があります。適切なコマンドを入力すると、振動が止まります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1-/e4/xa/1-e4xaksu_5edfbsymanvlja6ii.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スマートフォンを使用して、アプリケーションを介しておもちゃを再接続できるかどうかを確認します。私はアプリケーションの中でファームウェアプラグインの更新を見つけ、ターゲットDfuTarg-ファームウェアの更新が必要なデバイスを選択しますが、実際には-それに悪意のあるエクスプロイトを導入します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/ft/wt/yjftwtho753czqelp_td1n8gtq4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更新プロセスがどのように行われるかがわかります。デバイスのファームウェアが正常に更新されたことを示すメッセージが画面に表示されます。次に、bootplagを自分のコンピューターにインストールされているアプリケーションに再度接続してみます。何が起こるかがわかります。ランサムウェアスクリーンセーバーが画面に表示されます（聴衆からの拍手）！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o6/fz/tj/o6fztjlfigtenb5mujgp6ukz9ho.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「おっと、お尻のプラグは暗号化されています！ 3日以内に50ドルのビットコインでこの重要なおもちゃへのアクセスを回復するための費用を払ってください。仕組みは次のとおりです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ドングルでコードを実行し、次にコンピューターでインターネットを介してブートプラグを取得しました。ご覧のように、セキュリティの面では、このバットプラグは非常に脆弱です。おそらく北朝鮮が作成したものでしょう。ドングルやその他のハードウェアに接続せずにアプリケーションを実行する仮想マシンがインストールされていることをご存じでしょう。このVMはインターネットに接続されたばかりで、友人のコンピューターに接続されているように見えました。これで、ランサムウェアのウイルス拡散に成功しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以上のことから、いくつかの有益な教訓が得られると思います。このデバイスを例として使用して、モノのインターネットの世界がどれほど脆弱であるかを調査しました。一部のデバイスは生命維持のために使用され、人々はこれらの新しいテクノロジーがどれほど脆弱であるかを理解していません。 1つの「スマート」なものをハッキングすると、インターネットを介して自宅の他の「スマート」デバイスを接続できます。私の研究結果が大人のおもちゃだけでなく、応用できるといいのですが。また、私はこのことのすべてのコードを学ぶつもりですので、Twitterに参加してください。また、独自のブートループをハッキングしたい場合に備えて、本日、GitHubにツールを公開します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/45/wc/wp45wcacsbefq8-9i-6p3k-qqmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が激怒して私を助けて、極端なゲイであるバトルプラグの世界を紹介してくれたすべての友人に感謝したいと思います。</font><font style="vertical-align: inherit;">名前は付けませんが、アーロン、あなた自身が誰なのか知っています（笑）。</font><font style="vertical-align: inherit;">みんなありがとう、それは素晴らしかった！</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RnxcPeemHSc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">広告のビット:)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。私たちの記事は好きですか？もっと面白い資料を見たいですか？</font><b><font style="vertical-align: inherit;">私たちがあなたのために私たちが発明したエントリーレベルのサーバーのユニークなアナログで</font></b><font style="vertical-align: inherit;">ある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 4.99から</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文またはお友達</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に開発者向けのクラウドベースのVPS</font></a><font style="vertical-align: inherit;">をお勧めすることで私たちをサポートして</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ください：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS（KVM）E5-2697 v3（6コア）10GB DDR4 480GB SSD 1Gbpsの真実19ドルから、またはサーバーを分割する方法？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは、アムステルダムのEquinix Tier IVデータセンターで2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは、</font></b><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">199ドルから、インテルTetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></a></b><font style="vertical-align: inherit;">を</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2台</font></a></b><font style="vertical-align: inherit;">だけ持ってい</font><b><font style="vertical-align: inherit;">ます！</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></font></b></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">インフラストラクチャビルディングの構築方法</font></a><font style="vertical-align: inherit;">について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">お</font></a><font style="vertical-align: inherit;">読みください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dell R730xd E5-2650 v4サーバーを使用するクラスcは、1ペニーで9,000ユーロかかりますか？</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495782/index.html">FOSSニュースNo. 10-2020年3月30日〜4月5日の無料およびオープンソースニュースのレビュー</a></li>
<li><a href="../ja495784/index.html">SamsPcbGuide、パート14：テクノロジー-マイクロ開発とチップオンボードテクノロジー</a></li>
<li><a href="../ja495786/index.html">グローバルヌル</a></li>
<li><a href="../ja495788/index.html">コロナウイルスからの装置か、パンの塊からの別のトロリーか？</a></li>
<li><a href="../ja495790/index.html">リスクをヘッジするツールとしての交換：なぜ異常な先物が必要なのか</a></li>
<li><a href="../ja495794/index.html">句動詞について</a></li>
<li><a href="../ja495796/index.html">フラッシュカードの選択：デジタルバラエティを保護するための詳細なガイド</a></li>
<li><a href="../ja495798/index.html">3日でKubernetes。ほぼ複雑</a></li>
<li><a href="../ja495800/index.html">今日フロントエンドを教えたら。初心者向けのヒント</a></li>
<li><a href="../ja495802/index.html">先週のフロントエンドの世界からのフレッシュな素材のダイジェストNo.409（2020年3月30日〜4月5日）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>