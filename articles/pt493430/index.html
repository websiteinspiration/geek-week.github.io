<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏾 🎺 🤶🏻 Arquitetura de rede para aplicativos da Web 🗯️ 🧒🏽 🧗🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quero compartilhar com você uma abordagem que venho usando há muitos anos no desenvolvimento de aplicativos, incluindo aplicativos da Web. Muitos dese...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arquitetura de rede para aplicativos da Web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493430/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quero compartilhar com você uma abordagem que venho usando há muitos anos no desenvolvimento de aplicativos, incluindo aplicativos da Web. </font><font style="vertical-align: inherit;">Muitos desenvolvedores de desktop, servidor e aplicativos móveis estão familiarizados com essa abordagem. </font><font style="vertical-align: inherit;">é fundamental ao criar esses aplicativos, no entanto, ele é muito mal representado na Web, embora definitivamente existam pessoas que desejam usar essa abordagem. </font><font style="vertical-align: inherit;">Além disso, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editor de código VS é escrito</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre essa abordagem </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/ju/vy/djjuvyjprjf_nnnb0bv34ymklkc.png" alt="Arquitetura pura"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado da aplicação dessa abordagem, você se livrará de uma estrutura específica. </font><font style="vertical-align: inherit;">Você pode alternar facilmente a biblioteca de visualizações dentro de seu aplicativo, por exemplo, React, Preact, Vue, Mithril sem reescrever a lógica de negócios e, na maioria dos casos, até visualizações. </font><font style="vertical-align: inherit;">Se você possui um aplicativo no Angular 1, pode traduzi-lo facilmente para Angular 2+, React, Svelte, WebComponents ou até sua biblioteca de apresentações. </font><font style="vertical-align: inherit;">Se você possui um aplicativo no Angular 2+, mas não há especialistas, pode transferi-lo facilmente para uma biblioteca mais popular sem precisar reescrever a lógica comercial. </font><font style="vertical-align: inherit;">Mas, no final, esqueça completamente o problema da migração de uma estrutura para outra. </font><font style="vertical-align: inherit;">Que tipo de mágica é essa?</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que é arquitetura limpa</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender isso, é melhor ler o livro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de Martin Robert "Arquitetura Limpa»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de Robert C.Martin "Arquitetura Limpa»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Um breve trecho do qual é dado no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo por referência</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As principais idéias incorporadas na arquitetura:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independência da estrutura. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A arquitetura não depende da existência de nenhuma biblioteca. </font><font style="vertical-align: inherit;">Isso permite que você use a estrutura como uma ferramenta, em vez de restringir seu sistema às limitações.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testabilidade. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As regras de negócios podem ser testadas sem uma interface com o usuário, banco de dados, servidor da Web ou qualquer outro componente externo.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independência da interface do usuário. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A interface do usuário pode ser facilmente alterada sem alterar o restante do sistema. </font><font style="vertical-align: inherit;">Por exemplo, a interface da web pode ser substituída pelo console, sem alterar as regras de negócios.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independência do banco de dados. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Você pode trocar o Oracle ou o SQL Server pelo MongoDB, BigTable, CouchDB ou qualquer outra coisa. </font><font style="vertical-align: inherit;">Suas regras de negócios não estão relacionadas ao banco de dados.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Independência de qualquer serviço externo. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De fato, suas regras de negócios simplesmente não sabem nada sobre o mundo exterior.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As idéias descritas neste livro há muitos anos têm sido a base para a criação de aplicativos complexos em vários campos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa flexibilidade é obtida dividindo o aplicativo nas camadas Serviço, Repositório e Modelo. </font><font style="vertical-align: inherit;">Adicionei a abordagem MVC à arquitetura limpa e obtive as seguintes camadas:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exibir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - exibe dados para o cliente, na verdade visualiza o estado da lógica para o cliente.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - é responsável por interagir com o usuário por meio de E / S (entrada e saída).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviço</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - é responsável pela lógica de negócios e sua reutilização entre componentes.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - responsável por receber dados de fontes externas, como banco de dados, API, armazenamento local etc.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - é responsável pela transferência de dados entre camadas e sistemas, bem como pela lógica de processamento desses dados.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objetivo de cada camada é discutido abaixo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quem é a arquitetura pura</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O desenvolvimento da Web percorreu um longo caminho, desde o script jquery simples até o desenvolvimento de grandes aplicativos SPA. E agora os aplicativos da Web se tornaram tão grandes que a quantidade de lógica de negócios se tornou comparável ou até superior aos aplicativos de servidor, desktop e móvel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para desenvolvedores que escrevem aplicativos grandes e complexos, bem como transferem a lógica de negócios do servidor para aplicativos da Web para economizar no custo dos servidores, o Pure Architecture ajudará a organizar o código e a escalar sem problemas em grande escala.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, se sua tarefa é apenas layout e animação de páginas de destino, o Clean Architecture simplesmente não tem onde inserir. </font><font style="vertical-align: inherit;">Se sua lógica de negócios estiver no back-end e sua tarefa for obter os dados, exibi-los para o cliente e processar o clique no botão, você não sentirá a flexibilidade da Arquitetura Limpa, mas pode ser um excelente trampolim para o crescimento explosivo do aplicativo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onde já aplicado?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A arquitetura pura não está vinculada a nenhuma estrutura, plataforma ou linguagem de programação específica. </font><font style="vertical-align: inherit;">Durante décadas, tem sido usado para escrever aplicativos de desktop. </font><font style="vertical-align: inherit;">Sua implementação de referência pode ser encontrada nas estruturas para aplicativos de servidor Asp.Net Core, Java Spring e NestJS. </font><font style="vertical-align: inherit;">Também é muito popular ao escrever aplicativos iOS e Android. </font><font style="vertical-align: inherit;">Mas no desenvolvimento da Web, ele apareceu de uma forma extremamente malsucedida nas estruturas Angular. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como eu não sou apenas o Typecript, mas também um desenvolvedor de C #, por exemplo, adotarei a implementação de referência dessa arquitetura para o Asp.Net Core. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui está um aplicativo de amostra simplificado:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicativo de exemplo no Asp.Net Core</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">    <span class="hljs-comment">/**
     * View
     */</span><font></font>
<font></font>
    @model WebApplication1.Controllers.Profile<font></font>
<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">text</span>-<span class="hljs-title">center</span>"&gt;
        &lt;<span class="hljs-title">h1</span>&gt;  @<span class="hljs-title">Model</span>.<span class="hljs-title">FirstName</span>&lt;/<span class="hljs-title">h1</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;

    /**
     * <span class="hljs-title">Controller</span>
     */

    <span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">IndexController</span> : <span class="hljs-title">Controller</span>
    </span>{
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> int _counter = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">private</span> readonly IUserProfileService _userProfileService;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> IndexController(IUserProfileService userProfileService)<font></font>
        {<font></font>
            _userProfileService = userProfileService;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; Index()<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; AddCounter()<font></font>
        {<font></font>
            _counter += <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Service
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileService</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileService</span> : <span class="hljs-title">IUserProfileService</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly IUserProfileRepository _userProfileRepository;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> UserProfileService(IUserProfileRepository userProfileRepository)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._userProfileRepository = userProfileRepository;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._userProfileRepository.GetProfile(id);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Repository
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileRepository</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileRepository</span> : <span class="hljs-title">IUserProfileRepository</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly DBContext _dbContext;
        <span class="hljs-keyword">public</span> UserProfileRepository(DBContext dbContext)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._dbContext = dbContext;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._dbContext<font></font>
                .Set&lt;Profile&gt;()<font></font>
                .FirstOrDefaultAsync((entity) =&gt; entity.Id.Equals(id));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Model
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span>
    </span>{
        <span class="hljs-keyword">public</span> long Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string FirstName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string Birthdate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
    }<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você não entender que isso não diz nada de ruim, analisaremos isso em partes de cada fragmento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um exemplo é dado para um aplicativo Asp.Net Core, mas para Java Spring, WinForms, Android, React, a arquitetura e o código serão os mesmos, apenas o idioma e o trabalho com a exibição (se houver) serão alterados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicação Web</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A única estrutura que tentou usar a arquitetura limpa foi o Angular. </font><font style="vertical-align: inherit;">Mas acabou horrível, que em 1, que em 2+. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E há muitas razões para isso:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estrutura monolítica angular. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E este é o seu principal problema. </font><font style="vertical-align: inherit;">Se você não gosta de algo, precisa se engasgar diariamente, e não há nada que possa fazer. </font><font style="vertical-align: inherit;">Não apenas há muitos problemas, mas também contradiz a ideologia da arquitetura pura.</font></font></li>
<li><b>   DI.</b>     ,            Javascript.</li>
<li><b>  .</b>        JSX.       ,           6,      .                .</li>
<li><b> .</b>      Rollup   ES2015   2        4 ,   angular       9.</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E muitos mais problemas. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, até a tecnologia moderna angular rola com um atraso de 5 anos em relação ao React.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas e outras estruturas? </font><font style="vertical-align: inherit;">React, Vue, Preact, Mithril e outros são exclusivamente bibliotecas de apresentação e não fornecem nenhuma arquitetura ... mas já temos a arquitetura ... resta reunir tudo em um único todo!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Começamos a criar um aplicativo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consideraremos o Pure Architecture pelo exemplo de um aplicativo fictício o mais próximo possível de um aplicativo da Web real. </font><font style="vertical-align: inherit;">Este é um escritório da companhia de seguros que exibe o perfil do usuário, eventos segurados, taxas de seguro propostas e ferramentas para trabalhar com esses dados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/sj/jf/fysjjf8fyz7rq0tzeaboesysuxw.jpeg" alt="Protótipo de aplicação"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No exemplo, apenas uma pequena parte do funcional será implementada, mas a partir dele você poderá entender onde e como posicionar o restante do funcional. </font><font style="vertical-align: inherit;">Vamos começar a criar o aplicativo a partir da camada Controller e conectar a camada View no final. </font><font style="vertical-align: inherit;">E no decorrer da criação, consideramos cada camada com mais detalhes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Padrão do Controlador</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - é responsável pela interação do usuário com o aplicativo. </font><font style="vertical-align: inherit;">Pode ser um clique em um botão em uma página da web, aplicativo de desktop, aplicativo móvel ou digitar um comando em um console Linux ou uma solicitação de rede ou qualquer outro evento de entrada / saída que entrar no aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O controlador mais simples em uma arquitetura limpa é o seguinte:</font></font><br>
<br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleController</span> </span>{ <span class="hljs-comment">// extends React.Component&lt;object, object&gt;</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> todos: string[] = []; <span class="hljs-comment">//  </span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> addTodo(todo: string): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.push(todo);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> removeTodo(index: number): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.splice(index, <span class="hljs-number">1</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// public render(): JSX.Element {...} // view injection</span><font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sua tarefa é receber um evento do usuário e iniciar processos de negócios. </font><font style="vertical-align: inherit;">No caso ideal, o Controlador não sabe nada sobre o View e pode ser reutilizado entre plataformas, como Web, React-Native ou Electron. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos escrever um controlador para nosso aplicativo. </font><font style="vertical-align: inherit;">Sua tarefa é obter um perfil de usuário, tarifas disponíveis e oferecer a melhor tarifa ao usuário:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controlador com lógica de negócios</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageControlle</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
            <span class="hljs-keyword">this</span>.userProfile = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
            <span class="hljs-keyword">this</span>.tariffs = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> findBestTariff(): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.userProfile &amp;&amp; <span class="hljs-keyword">this</span>.tariffs) {
            <span class="hljs-keyword">this</span>.bestTariff = <span class="hljs-keyword">this</span>.tariffs.find((tarif: any) =&gt; {
                <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= <span class="hljs-keyword">this</span>.userProfile.age &amp;&amp; <span class="hljs-keyword">this</span>.userProfile.age &lt; tarif.ageTo;<font></font>
            });<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos um controlador regular sem uma arquitetura limpa; se o herdarmos do React.Component, obteremos um componente funcional com lógica. </font><font style="vertical-align: inherit;">Muitos desenvolvedores de aplicativos da Web escrevem, mas essa abordagem tem muitas desvantagens significativas. </font><font style="vertical-align: inherit;">O principal é a incapacidade de reutilizar a lógica entre os componentes. </font><font style="vertical-align: inherit;">Afinal, a tarifa recomendada pode ser exibida não apenas em sua conta pessoal, mas também na página de destino e em muitos outros lugares para atrair um cliente para o serviço. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para poder reutilizar a lógica entre os componentes, é necessário colocá-la em uma camada especial chamada Serviço.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Padrão de Serviço</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviço</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - responsável por toda a lógica comercial do aplicativo. </font><font style="vertical-align: inherit;">Se o Controlador precisou receber, processar, enviar alguns dados - isso é feito através do Serviço. </font><font style="vertical-align: inherit;">Se vários controladores precisarem da mesma lógica, eles trabalharão com o Serviço. </font><font style="vertical-align: inherit;">Mas a camada de serviço em si não deve saber nada sobre a camada Controller and View e o ambiente em que trabalha. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos mover a lógica do controlador para o serviço e implementar o serviço no controlador:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controlador sem lógica de negócios</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Serviço para trabalhar com perfil de usuário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffService. </font><font style="vertical-align: inherit;">Serviço para trabalhar com tarifas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, se vários controladores precisarem obter um perfil de usuário ou tarifas, eles poderão reutilizar a mesma lógica dos serviços. </font><font style="vertical-align: inherit;">Nos serviços, o principal é não esquecer os princípios do SOLID e que cada serviço é responsável por sua área de responsabilidade. </font><font style="vertical-align: inherit;">Nesse caso, um serviço é responsável por trabalhar com o perfil do usuário e outro serviço é responsável por trabalhar com tarifas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas e se a fonte de dados mudar, por exemplo, a busca puder mudar para websocket ou grps ou o banco de dados, e os dados reais precisarem ser substituídos pelos dados de teste? </font><font style="vertical-align: inherit;">E, em geral, por que a lógica comercial precisa saber algo sobre uma fonte de dados? </font><font style="vertical-align: inherit;">Para resolver esses problemas, existe uma camada de repositório.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Padrão de Repositório</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - responsável pela comunicação com o data warehouse. </font><font style="vertical-align: inherit;">O armazenamento pode ser um servidor, banco de dados, memória, armazenamento local, armazenamento de sessão ou qualquer outro armazenamento. </font><font style="vertical-align: inherit;">Sua tarefa é abstrair a camada de Serviço da implementação de armazenamento específica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos fazer solicitações de rede de serviços no repositório, enquanto o controlador não muda:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Serviço para trabalhar com perfil de usuário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Serviço para trabalhar com armazenamento de perfil de usuário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffService. </font><font style="vertical-align: inherit;">Serviço para trabalhar com tarifas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório Tarifário. </font><font style="vertical-align: inherit;">Repositório para trabalhar com armazenamento tarifário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora basta escrever uma solicitação de dados uma vez e qualquer serviço poderá reutilizá-la. </font><font style="vertical-align: inherit;">Posteriormente, veremos um exemplo de como redefinir o repositório sem tocar no código de serviço e implementar o repositório mocha para teste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No serviço UserProfilService, pode parecer que não é necessário e o controlador pode acessar diretamente o repositório para obter dados, mas não é assim. </font><font style="vertical-align: inherit;">A qualquer momento na camada de negócios, os requisitos podem aparecer ou mudar, uma solicitação adicional pode ser necessária ou os dados podem ser enriquecidos. </font><font style="vertical-align: inherit;">Portanto, mesmo quando não há lógica na camada de serviço, a cadeia Controlador - Serviço - Repositório deve ser preservada. </font><font style="vertical-align: inherit;">Esta é uma contribuição para o seu amanhã. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É hora de descobrir que tipo de repositório é definido, se eles estão corretos. </font><font style="vertical-align: inherit;">A camada de modelos é responsável por isso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos: DTO, Entidades, Modelos de exibição</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - é responsável pela descrição das estruturas com as quais o aplicativo trabalha. </font><font style="vertical-align: inherit;">Essa descrição ajuda muito os novos desenvolvedores de projetos a entender com o que o aplicativo está trabalhando. </font><font style="vertical-align: inherit;">Além disso, é muito conveniente usá-lo para criar bancos de dados ou validar dados armazenados no modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os modelos são divididos em diferentes padrões, dependendo do tipo de uso:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entidades</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - são responsáveis ​​por trabalhar com o banco de dados e são uma estrutura que repete uma tabela ou documento no banco de dados.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DTO (Objeto de transferência de dados)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - são usados ​​para transferir dados entre diferentes camadas do aplicativo.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - contém informações pré-preparadas necessárias para exibição na exibição.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inclua o modelo de perfil de usuário e outros modelos no aplicativo e informe as outras camadas que agora estamos trabalhando não com um objeto abstrato, mas com um perfil muito específico:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Em vez de qualquer, os modelos descritos são usados.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">/**
     *          
     *          .
     */</span>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Em vez de qualquer, especifique o modelo retornado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffService. </font><font style="vertical-align: inherit;">Em vez de qualquer, especifique o modelo retornado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-comment">//  userProfile.age  userProfile.getAge()</span>
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Em vez de qualquer, especifique o modelo retornado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório Tarifário. </font><font style="vertical-align: inherit;">Em vez de qualquer, especifique o modelo retornado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfileDto. </font><font style="vertical-align: inherit;">Um modelo com uma descrição dos dados com os quais trabalhamos</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> </span>{ <span class="hljs-comment">// &lt;--      </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffDto. </font><font style="vertical-align: inherit;">Um modelo com uma descrição dos dados com os quais trabalhamos</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> </span>{
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, independentemente da camada do aplicativo em que estamos, sabemos exatamente com quais dados estamos trabalhando. Além disso, devido à descrição do modelo, encontramos um erro em nosso serviço. Na lógica do serviço, foi usada a propriedade userProfile.age, que na verdade não existe, mas tem uma data de nascimento. E para calcular a idade, você deve chamar o método do modelo userProfile.getAge (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas há um problema. Se tentarmos usar os métodos do modelo fornecido pelo repositório atual, obteremos uma exceção. O problema é que os métodos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">response.json ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON.parse ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ele não retorna nosso modelo, mas um objeto JSON, que não está de forma alguma associado ao nosso modelo. </font><font style="vertical-align: inherit;">Você pode verificar isso se executar o comando userProfile instanceof UserProfileDto, obtendo uma declaração falsa. </font><font style="vertical-align: inherit;">Para converter os dados recebidos de uma fonte externa para o modelo descrito, há um processo de desserialização de dados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desserialização de dados</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desserialização</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - o processo de restaurar a estrutura necessária a partir de uma sequência de bytes. </font><font style="vertical-align: inherit;">Se os dados contiverem informações não especificadas nos modelos, elas serão ignoradas. </font><font style="vertical-align: inherit;">Se houver informações nos dados que contradizem a descrição do modelo, ocorrerá um erro de desserialização. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o mais interessante aqui é que, ao projetar o ES2015 e adicionar a palavra-chave </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">class</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , eles </font><font style="vertical-align: inherit;">esqueceram de desserializar ... O fato de que em todos os idiomas está fora da caixa, no ES2015 eles simplesmente esqueceram ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver esse problema, escrevi uma biblioteca para desserialização </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TS-Serializable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um artigo sobre o qual pode ser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lido neste link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O objetivo é retornar a funcionalidade perdida.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inclua suporte de desserialização no modelo e desserialização em si no repositório:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório Tarifário. </font><font style="vertical-align: inherit;">Adicionar um processo de desserialização</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório Tarifário. </font><font style="vertical-align: inherit;">Adicionar um processo de desserialização</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProfileDto. </font><font style="vertical-align: inherit;">Adicionando suporte à desserialização</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffDto. </font><font style="vertical-align: inherit;">Adicionando suporte à desserialização</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, em todas as camadas do aplicativo, você pode ter certeza absoluta de que estamos trabalhando com os modelos que esperamos. </font><font style="vertical-align: inherit;">Na visualização, controlador e outras camadas, você pode chamar os métodos do modelo descrito.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que são Serializable e jsonProperty?</font></font></b>
                        <div class="spoiler_text">        Serializable —         Ecmascript       Typescript.      jsonProperty         ,       Typescript            uniontypes.            .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos uma aplicação quase finalizada. </font><font style="vertical-align: inherit;">É hora de testar a lógica escrita nas camadas Controller, Service e Models. </font><font style="vertical-align: inherit;">Para fazer isso, precisamos retornar dados de teste especialmente preparados na camada Repositório, em vez de uma solicitação real para o servidor. </font><font style="vertical-align: inherit;">Mas como substituir o Repositório sem tocar no código que entra em produção. </font><font style="vertical-align: inherit;">Existe um padrão de injeção de dependência para isso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injeção de Dependência - Injeção de Dependência</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injeção de Dependência</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - injeta dependências nas camadas Contoller, Service, Repository e permite substituir essas dependências fora dessas camadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No programa, a camada Controller depende da camada Service e da camada Repository. Na forma atual, as próprias camadas causam suas dependências através da instanciação. E, para redefinir a dependência, a camada precisa definir essa dependência de fora. Existem várias maneiras de fazer isso, mas o mais popular é passar a dependência como um parâmetro no construtor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, criar um programa com todas as dependências ficará assim:</font></font><br>
<pre><code class="actionscript hljs"><span class="hljs-keyword">var</span> programm = <span class="hljs-keyword">new</span> IndexPageController(<span class="hljs-keyword">new</span> ProfileService(<span class="hljs-keyword">new</span> ProfileRepository()));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concordo - parece horrível. </font><font style="vertical-align: inherit;">Mesmo levando em conta que existem apenas duas dependências no programa, ele já parece horrível. </font><font style="vertical-align: inherit;">O que dizer sobre programas em que centenas e milhares de dependências. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver o problema, você precisa de uma ferramenta especial, mas para isso precisa encontrá-la. </font><font style="vertical-align: inherit;">Se nos voltarmos para a experiência de outras plataformas, por exemplo, o Asp.Net Core, então o registro de dependências ocorre no estágio de inicialização do programa e fica assim:</font></font><br>
<pre><code class="actionscript hljs">DI.register(IProfileService,ProfileService);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e, em seguida, ao criar o controlador, a própria estrutura criará e implementará essa dependência. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas existem três problemas significativos:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao transpilar o Typecript em Javascript, não há nenhum rastro nas interfaces.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tudo o que caiu no DI clássico permanece nele para sempre. </font><font style="vertical-align: inherit;">É muito difícil limpá-lo durante a refatoração. </font><font style="vertical-align: inherit;">E em um aplicativo da web, você precisa salvar todos os bytes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quase todas as bibliotecas de exibição não usam DI, e os projetistas de controladores estão ocupados com os parâmetros.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em aplicativos da Web, o DI é usado apenas no Angular 2+. </font><font style="vertical-align: inherit;">No Angular 1, ao registrar dependências, em vez de uma interface, uma string era usada; no InversifyJS, Symbol é usado no lugar da interface. </font><font style="vertical-align: inherit;">E tudo isso é implementado de maneira tão terrível que é melhor ter muitos novos, como no primeiro exemplo desta seção, do que essas soluções. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver todos os três problemas, meu próprio DI foi inventado e a solução para ele me ajudou a encontrar a estrutura do Java Spring e seu decorador com conexão automática. </font><font style="vertical-align: inherit;">A descrição de como essa DI funciona pode ser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encontrada no artigo no link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no repositório GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É hora de aplicar o DI resultante em nosso aplicativo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Juntando tudo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para implementar o DI em todas as camadas, adicionaremos um decorador de reflexão, que fará com que o texto datilografado gere meta-informações adicionais sobre tipos de dependência. </font><font style="vertical-align: inherit;">No controlador em que você precisa chamar as dependências, desligaremos o decorador com conexão automática. </font><font style="vertical-align: inherit;">E no local em que o programa foi inicializado, determinamos em qual ambiente qual dependência será implementada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o repositório UserProfilRepository, crie o mesmo repositório, mas com dados de teste em vez da solicitação real. </font><font style="vertical-align: inherit;">Como resultado, obtemos o seguinte código:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Local de Inicialização do Programa</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Dependência através do decorador autowired</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-comment">//     , ..  </span>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Introdução à geração de reflexão e dependência</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffService. </font><font style="vertical-align: inherit;">Introdução à geração de reflexão e dependência</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Apresentando a geração de reflexão</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MockUserProfilRepository. </font><font style="vertical-align: inherit;">Novo repositório para teste</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositório Tarifário. </font><font style="vertical-align: inherit;">Apresentando a geração de reflexão</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, em qualquer lugar do programa, há uma oportunidade de alterar a implementação de qualquer lógica. </font><font style="vertical-align: inherit;">Em nosso exemplo, em vez de uma solicitação real de perfil de usuário para o servidor no ambiente de teste, os dados de teste serão usados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na vida real, as substituições podem ser encontradas em qualquer lugar, por exemplo, você pode alterar a lógica em um serviço, implementando o serviço antigo na produção e, na refatoração, ele já é novo. </font><font style="vertical-align: inherit;">Realize testes A / B com lógica comercial, altere o banco de dados baseado em documentos para relacional e geralmente altere a solicitação de rede para soquetes da web. </font><font style="vertical-align: inherit;">E tudo isso sem interromper o desenvolvimento para reescrever a solução. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É hora de ver o resultado do programa. </font><font style="vertical-align: inherit;">Há uma camada de visualização para isso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visão de Implementação</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A camada View é responsável por apresentar os dados que estão contidos na camada Controller ao usuário. </font><font style="vertical-align: inherit;">No exemplo, usarei React para isso, mas em seu lugar pode haver qualquer outro, por exemplo, Preact, Svelte, Vue, Mithril, WebComponent ou qualquer outro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, simplesmente herde nosso controlador de React.Component e adicione um método de renderização a ele com a representação da visualização:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Começa a desenhar um componente React</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Herda de React.Component e adiciona um método de renderização</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
<span class="hljs-comment">//    React.Component</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">object</span>, <span class="hljs-title">object</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   </span><font></font>
    constructor(props: object, context: object) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//     </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): JSX.Element {
        <span class="hljs-keyword">return</span> (<font></font>
            &lt;&gt;<font></font>
                &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                         : {<span class="hljs-keyword">this</span>.userProfile.getFullname()}<font></font>
                    &lt;/div&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                        : {<span class="hljs-keyword">this</span>.userProfile.getAge()}<font></font>
                    &lt;/div&gt;<font></font>
                &lt;/div&gt;<font></font>
                &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
                    {<span class="hljs-comment">/*    */</span>}<font></font>
                &lt;/div&gt;<font></font>
            &lt;/&gt;<font></font>
        );<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao adicionar apenas duas linhas e um modelo de apresentação, nosso controlador se transformou em um componente de reação com lógica de trabalho.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que o forceUpdate é chamado em vez de setState?</font></font></b>
                        <div class="spoiler_text">     forceUpdate  ,   setState.          setState, Redux, mobX  .,          .  React  Preact  forceUpdate,   ChangeDetectorRef.detectChanges(),  Mithril  redraw   .         Observable   ,    MobX  Angular,   .         .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, mesmo em tal implementação, verificamos que vinculamos à biblioteca React com seu ciclo de vida, implementação da visualização e o princípio de invalidar a visualização, o que contradiz o conceito de Arquitetura Limpa. </font><font style="vertical-align: inherit;">E a lógica e o layout estão no mesmo arquivo, o que complica o trabalho paralelo do compositor e desenvolvedor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separação de Controlador e Visão</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver os dois problemas, colocamos a camada de visualização em um arquivo separado e, em vez do componente React, criamos o componente base que abstrairá nosso controlador de uma biblioteca de apresentação específica. </font><font style="vertical-align: inherit;">Ao mesmo tempo, descrevemos os atributos que o componente pode receber. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recebemos as seguintes alterações:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Eles levaram a visualização para um arquivo separado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageOptions. </font><font style="vertical-align: inherit;">Veja e reaja a um arquivo separado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    BaseComponent</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BaseComponent </font><font style="vertical-align: inherit;">Um componente que nos abstrai de uma estrutura específica</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-comment">//  view</span>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);
        <span class="hljs-comment">//    </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora nossa visão está em um arquivo separado, e o controlador não sabe nada sobre isso, exceto que está. Talvez você não deva injetar a vista através da propriedade do controlador, mas fazê-lo através do decorador como o Angular, mas este é um tópico para alguma reflexão. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O componente básico também contém uma abstração do ciclo de vida da estrutura. Eles são diferentes em todas as estruturas, mas são em todas as estruturas. Angular é ngOnInit, ngOnChanges, ngOnDestroy. Em React e Preact, este é componentDidMount, shouldComponentUpdate, componentWillUnmount. No Vue, isso é criado, atualizado, destruído. No Mithril, ele é criado, atualizado, removido. Em WebComponents, isso é conectadoCallback, attributeChangedCallback ,connectedCallback. E assim em todas as bibliotecas. A maioria ainda tem a mesma interface ou similar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, agora os componentes da biblioteca podem ser expandidos com sua própria lógica para posterior reutilização entre todos os componentes. </font><font style="vertical-align: inherit;">Por exemplo, a introdução de ferramentas para análise, monitoramento, registro etc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nós olhamos para o resultado</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resta apenas avaliar o que aconteceu. </font><font style="vertical-align: inherit;">Todo o programa tem a seguinte forma final:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">O arquivo a partir do qual o programa é iniciado</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Representação de um dos componentes do programa.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">A lógica de um dos componentes para interação do usuário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BaseComponent </font><font style="vertical-align: inherit;">Classe base para todos os componentes do programa</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Serviço para reutilizar a lógica entre componentes para trabalhar com um perfil de usuário</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TariffService. </font><font style="vertical-align: inherit;">Serviço para reutilizar a lógica entre componentes para trabalhar com tarifas</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Repositório para receber um perfil do servidor, verificando e validando</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">MockUserProfilRepository.         </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffRepository.      ,    </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">UserProfileDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtivemos um aplicativo escalável modular com uma quantidade muito pequena de clichê (1 componente básico, 3 linhas para implementar dependências por classe) e sobrecarga muito baixa (na verdade, apenas para implementar dependências, tudo o resto é lógico). </font><font style="vertical-align: inherit;">Além disso, não estamos vinculados a nenhuma biblioteca de apresentações. </font><font style="vertical-align: inherit;">Quando o Angular 1 morreu, muitos começaram a reescrever aplicativos no React. </font><font style="vertical-align: inherit;">Quando os desenvolvedores do Angular 2 acabaram, muitas empresas começaram a sofrer por causa da velocidade do desenvolvimento. </font><font style="vertical-align: inherit;">Quando o React morrer novamente, você terá que reescrever as soluções vinculadas à sua estrutura e ecossistema. </font><font style="vertical-align: inherit;">Mas com a Chita Architecture você pode esquecer de amarrar a estrutura.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual é a vantagem sobre o Redux?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender a diferença, vamos ver como o Redux se comporta quando o aplicativo cresce. </font></font><br>
<img src="https://habrastorage.org/webt/jj/i9/cc/jji9ccsijjqancrthtv9gpudc48.png" alt="Restaurado"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver no diagrama, com o crescimento dos aplicativos Redux dimensionados verticalmente, a Store e o número de redutores também aumentam e se transformam em gargalo. E a quantidade de despesas gerais para reconstruir a loja e encontrar o redutor certo está começando a exceder a carga útil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode verificar a taxa de sobrecarga para carga útil em um aplicativo de tamanho médio com um teste simples.</font></font><br>
<pre><code class="actionscript hljs">let create = <span class="hljs-keyword">new</span> Function([
<span class="hljs-string">"return {"</span>,<font></font>
...new Array(<span class="hljs-number">100</span>).fill(<span class="hljs-number">1</span>).map((val, ind) =&gt; `param${ind}:${ind},`),
<span class="hljs-string">"}"</span>
].join(<span class="hljs-string">""</span>));<font></font>
<font></font>
let obj1 = create();<font></font>
<font></font>
console.time(<span class="hljs-string">"store recreation time"</span>);<font></font>
let obj2 = {<font></font>
    ...obj1,<font></font>
    param100: <span class="hljs-number">100</span> ** <span class="hljs-number">2</span><font></font>
}<font></font>
console.timeEnd(<span class="hljs-string">"store recreation time"</span>);<font></font>
<font></font>
console.time(<span class="hljs-string">"clear logic"</span>);<font></font>
let val = <span class="hljs-number">100</span> ** <span class="hljs-number">2</span>;<font></font>
console.timeEnd(<span class="hljs-string">"clear logic"</span>);<font></font>
<font></font>
console.log(obj2, val);<font></font>
<font></font>
<span class="hljs-comment">// store recreation time: 0.041015625ms</span>
<span class="hljs-comment">// clear logic: 0.0048828125ms</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para recriar a Loja em 100 propriedades, levou 8 vezes mais tempo que a própria lógica. Com 1000 elementos, isso já é 50 vezes mais. Além disso, uma ação do usuário pode gerar toda uma cadeia de ações, cuja chamada é difícil de capturar e depurar. Você certamente pode argumentar que 0,04 ms para recriar a loja é muito pequeno e não diminui a velocidade. Mas 0,04 ms está no processador Core i7 e por uma ação. Dado os processadores móveis mais fracos e o fato de que uma única ação do usuário pode gerar dezenas de ações, tudo isso leva ao fato de que os cálculos não cabem em 16 ms e é criado o sentimento de que o aplicativo está diminuindo a velocidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos comparar como o aplicativo Clean Architecture cresce:</font></font><br>
<img src="https://habrastorage.org/webt/oz/eg/uk/ozegukclnowpqlzdnckk3pfkckc.png" alt="Arquitetura pura"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como pode ser visto devido à separação da lógica e das responsabilidades entre as camadas, o aplicativo é escalonado horizontalmente. </font><font style="vertical-align: inherit;">Se algum componente precisar processar os dados, ele retornará ao serviço correspondente sem tocar nos serviços não relacionados à sua tarefa. </font><font style="vertical-align: inherit;">Após receber os dados, apenas um componente será redesenhado. </font><font style="vertical-align: inherit;">A cadeia de processamento de dados é muito curta e óbvia e, para um máximo de 4 saltos de código, você pode encontrar a lógica necessária e depurá-la. </font><font style="vertical-align: inherit;">Além disso, se traçarmos uma analogia com uma parede de tijolos, podemos remover qualquer tijolo dessa parede e substituí-lo por outro sem afetar a estabilidade dessa parede.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bônus 1: Funcionalidade aprimorada dos componentes da estrutura</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um bônus foi a capacidade de complementar ou alterar o comportamento dos componentes da biblioteca de apresentações. </font><font style="vertical-align: inherit;">Por exemplo, uma reação no caso de um erro na exibição não renderiza o aplicativo inteiro, se uma pequena revisão for feita:</font></font><br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    ...<font></font>
<font></font>
    public render(): React.ReactElement&lt;object&gt; {<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-keyword">return</span> React.createElement(
                <span class="hljs-string">"div"</span>,<font></font>
                { style: { color: <span class="hljs-string">"red"</span> } },<font></font>
                `    : ${e}`<font></font>
            );<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora a reação não atrairá apenas o componente em que o erro ocorreu. </font><font style="vertical-align: inherit;">Da mesma maneira simples, você pode adicionar monitoramento, análises e outros nishtyaki.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bônus 2: Validação de Dados</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além de descrever e transferir dados entre camadas, os modelos têm uma grande margem de oportunidade. </font><font style="vertical-align: inherit;">Por exemplo, se você conectar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioteca de validador de classe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , simplesmente suspendendo os decoradores, poderá validar os dados nesses modelos, incluindo </font><font style="vertical-align: inherit;">com um pouco de refinamento, você pode validar formulários da web.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bônus 3: Criando Entidades</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, se você precisar trabalhar com um banco de dados local, poderá conectar a biblioteca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typeorm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e seus modelos se transformarão em entidades pelas quais o banco de dados será gerado e executado.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obrigado pela atenção</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você gostou do artigo ou da abordagem, curta e não tenha medo de experimentar. </font><font style="vertical-align: inherit;">Se você é adepto do Redux e não gosta de discordar, explique nos comentários como dimensiona, testa e valida os dados em seu aplicativo.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493418/index.html">Por que o aprendizado de máquina usa dados "sintéticos"</a></li>
<li><a href="../pt493420/index.html">Minha maneira de apresentar Python aos alunos do ensino médio</a></li>
<li><a href="../pt493424/index.html">Implementamos conversões de código Python</a></li>
<li><a href="../pt493426/index.html">Organização do código em microsserviços e minha abordagem do uso da arquitetura hexagonal e DDD</a></li>
<li><a href="../pt493428/index.html">"Não daremos origem a teorias da conspiração". Fale sobre conferências de ML com pessoas de empresas de ciência e TI</a></li>
<li><a href="../pt493432/index.html">Por que não iniciar uma carreira em uma pequena empresa que não é de TI</a></li>
<li><a href="../pt493436/index.html">Programa para alteração de direitos de acesso e registro de nomes de arquivos / diretórios no Bash</a></li>
<li><a href="../pt493438/index.html">Exibir resultados de pesquisa e problemas de desempenho</a></li>
<li><a href="../pt493440/index.html">Marketing de influenciadores na China: no que se baseia e no que influenciadores podem oferecer no contexto de emergências</a></li>
<li><a href="../pt493442/index.html">Lembrete de EPI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>