<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚧 🤹 👨🏻‍⚕️ Python依存関係の混乱 👲🏽 🧑🏾‍🤝‍🧑🏾 🌅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pythonパッケージングの歴史を知っていますか？パケット形式でナビゲートしますか？奇跡のように見えても、依存関係のもつれを解明する必要があることを知っていますか？彼らはDepHellライブラリの作者ほどこれに精通していないと思います。
 
 
 
 私は何とかグラムとして知られているニキータ・ボロ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Python依存関係の混乱</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/483920/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonパッケージングの歴史を知っていますか？</font><font style="vertical-align: inherit;">パケット形式でナビゲートしますか？</font><font style="vertical-align: inherit;">奇跡のように見えても、依存関係のもつれを解明する必要があることを知っていますか？</font><font style="vertical-align: inherit;">彼らはDepHellライブラリの作者ほどこれに精通していないと思います。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zp/dv/ao/zpdvaohc2qflukqaxxduyl7rxmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は何とか</font><font style="vertical-align: inherit;">グラムとして知られ</font><font style="vertical-align: inherit;">ている</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニキータ・ボロノフ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と話すことができました&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オルシニウム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、将来のレポートのトピック、悪い依存関係の解決の決定の苦痛、DepHell、pip、最初の一致の原則、Guido、Pipfile、Pythonの増分開発、およびエコシステムの将来について彼に尋ねます。</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Moscow Python Conf ++では、依存関係とその隣にあるすべてについて話します。なぜそのようなトピックをレポートに選んだのですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この質問は、Pythonに関する私のすべての経験を通過するためです。最初のパッケージを作成して最初のコードを書いたとき、他の人がそれをインストールできるように支援する方法を考え、setup.pyを実行しました。それから彼はある会社で働いて、別の会社で働いて、3番目の仕事をしました、仕事は複雑で開発されました。最初はrequirements.txtファイルしかありませんでしたが、依存関係を修正する必要があることに気付きました。pip-toolsとロックファイルが表示されました。その後、私たちはPipenvを取得し、次にPoetryを取得しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次第に多くの問題が発生し、私はこの混乱に深く沈んでいきました。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">最終的にはDepHellを</font></a><font style="vertical-align: inherit;">実装し</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;-依存関係を解決し、別の形式で読み取ることができる依存関係を管理するためのプロジェクト。あらゆる種類のフォーマットで作業している間、私はそれらの内部を十分に見てきましたが、今では内部がどの程度配置されているかを知っていますが、毎日何か新しいことを学びます。したがって、私はあなたに苦痛と悪い決定について多くの興味深いことをあなたに話すことができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-痛みはいつも面白いです。 Pythonのこの部分の現在の問題は何だと思いますか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
JSにはディレクトリがあります</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そして各依存症は、その中に折り畳まれた独自の依存症を持っています。 Pythonでは、これは当てはまりません。たとえば、パッケージは同じ環境にインストールされ、それを使用するすべてのパッケージはこのパッケージの同じバージョンを使用します。これを行うには、依存関係を正しく解決する必要があります。この環境の一般的にすべてのパッケージを満たすこのパッケージのバージョンを選択してください。タスクは非常に重要です。パッケージは相互に依存し、すべてが絡み合っており、依存関係の解決は困難です。 Pythonには実質的にリゾルバはありません。賢いリゾルバーは、PoetryとDepHellだけにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このすべては、pypi.orgがパッケージの依存関係に関する情報を提供しないことが多いため、非常に複雑です。この情報はクライアントが指定する必要があるため、PyPIサーバーはそれ自体では把握できません。</font><font style="vertical-align: inherit;">したがって、パッケージに依存関係がないとPyPIが言った場合、それを信頼することはできません。</font><font style="vertical-align: inherit;">リリース全体をダウンロードして、setup.pyからパッケージの依存関係を解凍して解析する必要があります。</font><font style="vertical-align: inherit;">これは長いプロセスなので、Pythonのリゾルバーは高速にできません。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonにはリゾルバが少ないだけでなく、設計上低速です。 </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポートで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">DepHell解決がどのように機能するかを説明したいと思います。依存グラフを作成する方法、このグラフがどのように見えるか、ほとんどの科学記事が依存関係を解決してこのグラフを操作する方法にある理由。もちろん、これがどのように機能するかについてのホワイトペーパーがあります。賢い人はアルゴリズムを使って記事を書いていますが、ほとんどの場合、Pythonでは機能しません。したがって、実際にDepHellで依存関係の解決を処理する方法について説明します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-プログラマーから、pipを使用しているとよく聞かれますが、すべてうまくいきます。彼らは何を間違っているのですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
彼らは幸運であり、依存関係の衝突に遭遇しません。ただし、クリーンな環境に2つのパッケージのみを配置すると問題が発生する可能性があります。最近、カバレッジ5.0のリリースがあり、指定した場合</font></font><code>pip install pytest-cov coveralls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、次にpipが順番に実行され、最初のパッケージでは最新バージョンのカバレッジ、つまり5.0が選択されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の一致の勝利</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の原則はpip </font><font style="vertical-align: inherit;">で機能するため、バージョンが2番目のパッケージと互換性がない場合でも、最初のパッケージではすでに修正されています。多くの場合、このアプローチは機能しますが、常に機能するとは限りません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、再現可能な環境についても質問があります。 pipは常に最新バージョンを配置するため、ローカル環境と本番環境のバージョンは異なる場合があります。この問題を解決するには、通常、依存関係を修正します。そして、依存関係がすでに修正されている場合、pipがインストールする必要がある特定のバージョンが示され、pipはすでに正常に動作します。 Pipにはリゾルバーがありませんが、DepHellやPoetryなど、他の誰かがその依存関係を解決するときにそれを行います。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-あなたが思うように、なぜこのトピックは今そのような関連性を得ているのですか？以前は何も起こらなかったのに、今ではなくなってしまったのです。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
まず、Pythonエコシステムが成長しています。より多くのパッケージがあり、それらを置くことが多く、より多くの問題がポップアップします。第二に、ファイル形式に関する問題は長い間存在し、長い間議論されてきました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setup.pyは通常、解析が不可能で、実行のみ可能です。たとえば、Goでサーバーを作成してPythonのパッケージをすばやく配布したい場合は、実行可能ファイルであるため、単にsetup.pyを取得して読み取ることはできません。したがって、それを実行するには、Pythonと完全な環境が必要です。また、多くの場合、プロジェクト全体が近くにあり、特定の依存関係がインストールされています。これらすべての困難に加えて、setup.pyの実行は危険な場合があります。他のコードがコンピューター上で実行されるためです。実際、現在のユーザーの下からコードを実行するのも怖いです。たとえば、彼が私の秘密のSSHキーを受け取ってどこかに送信した場合、それは大きな悲劇になるからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係を定義するための2番目のオプションは、長い間存在していて、誰もがそれを使用しており、requirements.txtです。同じ方法で解析することもほとんど不可能です。 Pipはできますが、非常に難しくなります。関数を呼び出す関数、イテレータなど、すべてが混在しています。また、pipはキーの一部をrequirements.txtから読み取ることができます。たとえば、ダウンロード用のインデックスを指定できます。しかし、これはすべてのキーで機能するわけではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、requirements.txtを解析するには、pipまたはいくつかのサードパーティソリューションを使用する必要があります。すべてのサードパーティのソリューションは本質的にフォークであり、ファイルに関するある種の仮定を使用しています。 pipが読み取ることができるすべてのトリッキーなrequirements.txtファイルがこれらのフォークを読み取ることができるわけではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pip自体は、ライブラリとして使用するためのものではありません。これは、コンソールからのみ使用できる排他的なCLIツールです。すべてのpipソースコードは背後</font></font><code>_internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">隠されて</font><font style="vertical-align: inherit;">おり、開発者は直接「使用しないでください！」と言います。また、リリースごとに下位互換性が失われます。彼らは正直に互換性を保証せず、いつでも何でも変更することができます。そしてこれが何が起こるかです-新しいリリースがpipとともに来るたびに、私はDepHellの壊れたCIからそれについて学びます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-他の言語ではどうですか？それと同じくらい悪いのですか、それともこれらの問題はどこかで解決されていますか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最近</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グイドファンロッサム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダイクストラ賞を受賞。私は彼の講義に出席し、Pythonの依存関係について尋ねました。グイドは、すべての言語の中毒は混乱であると言いました、彼はそこに入らないように努め、この問題を解決するためにコミュニティを信頼しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Pythonでは、依存関係の処理はコミュニティによって徐々に編成されます。新しいソリューションが出現しています。 DistutilsがPythonに組み込まれると、多くの問題があることに人々は気づき、Setuptoolsを追加しました。後でパッケージをインストールするように設計されました</font></font><code>easy_Install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、問題もありました。それらを解決するために、pipを作成しました。今、pipには多くの問題があります。そのソースは絶えず変化しており、アーキテクチャはなく、インターフェースもありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コミュニティは何かを考え出そうとしています。</font><font style="vertical-align: inherit;">たとえば、要件2.0と呼ばれる問題については、要件をユーザー（ここではバージョン、こちらはマーカー）と他の言語からプログラムで理解できるようにする方法について長い議論がありました。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らはPipfileを作成しましたが、pipは非常に混乱するため、Pipfileのサポートを追加できませんでした。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、開発者はこれを望んでいます。おそらく、いつかは可能になるでしょうが、これまでのところ、pipはPipfileをサポートできません。それが、pipenvがPipfileと仮想環境、その他の環境とのラッパーで機能するように行われた理由です。しかしpipenvでも、すべてが混同され、混乱しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の言語については、Goでの依存関係管理の実装方法が気に入っています。以前は、バージョン管理がありませんでした</font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。どのリポジトリからどのパッケージをダウンロードするかを指定しました。初心者の観点から見ると、これは便利です。単に書き込むだけ</font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、パッケージはすでにシステムにあります。そして、Pythonで作業を開始すると、すべてのヒープ全体がすぐに折りたたまれます。一部のバージョン、PyPI、pip、requirements.txt、setup.py、さらにはPipfile、Poetry </font></font><code>__pymodules__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonが段階的に進化し、コミュニティの助けを借りて、エコシステムにレガシーが構築されます。 Goはシンプル</font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でしたが、特に環境を再現できるように依存関係を修正する必要があるという問題もありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての依存関係がインストールされたDockerコンテナーを使用して、再生可能な環境を作成できます。ただし、個別の依存関係を更新する必要がある場合があります。たとえば、更新後もすべてが機能することを証明するための十分なテストがプロジェクトにないため、すべてを更新する準備ができていない場合があります。ただし、たとえば、脆弱性が発見されたため、特定の依存関係を更新する必要がある場合があります。これを行うには、Dockerイメージではなく、「特定のパッケージの特定のバージョンをインストールする」というファイルを使用することをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goにはそのようなことはありませんでした。ベンダー化が現れました。すべての依存関係が取得され、1つのディレクトリに配置されました。</font><font style="vertical-align: inherit;">これはダーティソリューションで、これに似て</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">います。しばらくの間、サードパーティのソリューションを使用してGoに実装されていました。</font><font style="vertical-align: inherit;">Pythonでは、このアプローチも使用され</font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">たとえば、pipにはディレクトリがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">あなたがpipを置くとき、依存関係は作られません、そしてあなたはすべてがとてもクールで依存関係がまったくないと思うかもしれません、しかし実際にはそれらはすべて内部にあり</font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約1年前にgo.mod（Goモジュール）がGoに登場しました。</font><font style="vertical-align: inherit;">これは新しい組み込みツールですが、</font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サポートされています。</font><font style="vertical-align: inherit;">プロジェクトには2つのファイルが含まれています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つは、プロジェクトが直接動作する依存関係を説明します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう1つは、すべての依存関係とその特定のバージョンを完全に記述したロックファイルです。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはクールな集中型ソリューションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なことは、彼らは特定のものは特定の方法で見られるべきだと主張することです。たとえば、Goでは、バージョンはsemantic-versionである必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonには、バージョンの外観に関する仕様もあります。これにはPEP 440がありますが、最初に、仕様は非常に複雑です。3つのバージョンコンポーネント（番号）だけでなく、プレリリース、ポストリリース、時代（バージョン管理の方法が変更された場合）もあります。次に、PEP 440はすぐに受け入れられず、段階的に追加されたため、レガシーバージョンがサポートされています。つまり、「Hello world！」などのすべての行をバージョンとして使用できます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-コミュニティは言語を段階的に開発しているとのことですが、解決策は数​​多くあります。</font><font style="vertical-align: inherit;">しかし、このゴミをすべて取り除いてみませんか？</font><font style="vertical-align: inherit;">Distutilsを捨てて、誰も使用していない古い不要なものを捨てて、代わりに積極的に新しいプラクティスやツールを導入してみませんか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらすべてをサポートすることには意味があり、古いパッケージをインストールすることができます。</font><font style="vertical-align: inherit;">決定はコミュニティによって行われるので、それだけを行う必要があることを主張することは不可能です。</font><font style="vertical-align: inherit;">Core Python開発者の誰もが来て、言っていません：「それだけです、私たちは今すべてをやっていて、釘はありません。」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goには、依存関係をすぐに操作するために必要なものがすべて揃っています。</font><font style="vertical-align: inherit;">Pythonでは、すべてを外部から再インストールする必要がありますが、それでも正確に何を理解する必要があります。</font><font style="vertical-align: inherit;">ほとんどの場合、pipで十分ですが、現在、他のオプションが表示されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python Packaging Authority（pip、pipenv、PyPIを作成するグループ）からの公式パッケージ推奨事項が掲載されているサイトでは、pipenvを使用するように記述されています。 pipenvの使用は別の話です。まず、解像度が低いです。第二に、非常に長い間リリースされておらず、コミュニティはすでにこのプロジェクトが死んだことをクリエイターが正直に認めるのを待っています。 pipenvの3番目の問題は、パッケージのみではなくプロジェクトのみに適していることです。pipenvでプロジェクトの依存関係を指定できますが、その名前、バージョンを指定できないため、パッケージに入れてPyPIにダウンロードできます。 Python Packaging Authorityの推奨に従うこととpipenvを使用することはまだそれを理解するのに十分ではないことが判明しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詩は革命的であろうとしています。それは基本的にsetup.pyファイルを生成しません。これは、Poetryがすべての新しい唯一のフォーマットになりたいためです。彼はパッケージの収集方法を知っており、プロジェクトに必要なロックファイルを持っています。それにもかかわらず、詩には奇妙なことがたくさんあり、おなじみの機能の多くはサポートされていません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-依存関係の操作に関して、エコシステムの将来はどうなると思いますか？あなたの予測。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが多かれ少なかれ良くなっています。たとえば、pipの欠員を見て、それを整理する開発者は大金を約束されています。おそらく、pipはより普遍的なソリューションになるでしょう。しかし、あなたはそれを真剣に受け止める人が必要です：私たちがこのようにやっていると言ってください、今、私たちはより厳しいPEPに従っています、そしてそれを主張します（PEPは実際には誰もが推奨するものではないためです従う必要はありません）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、私たちはそのような話をしました：PyYAMLの特定のバージョンがロックファイルでロックされました。ある日、CIのテストに合格し、本番環境にデプロイすると、PyYAMLバージョンが見つからなかったため、すべてがそこでクラッシュします。問題は、ロックされたバージョンがpypi.orgから削除されたことです。誰もが憤慨し、ロックファイルを更新し、どういうわけか生き残ったが、土砂は残った。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少し前に、PEP 592が登場しました。これはすでに採用され、pipで維持されており、ヤンクリリースが登場しました。ヤンクは、リリースがpypi.orgからまだ完全に削除されていないことを意味します-非表示になります。つまり、たとえばPyYAMLのバージョンが3.0よりも大きいことが必要であると指定した場合、pipはヤンクリリースをスキップし、利用可能な最新のものをインストールします。しかし、特定のバージョンがロックファイルに示されていて、このバージョンがヤンクである場合、pipはとにかくそれをインストールします。したがって、ロックファイルとデプロイは壊れませんが、可能であれば、古いバージョンは使用されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目に興味深いのは、PEP for </font></font><code>__pymodules__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。これらは軽量の仮想環境です。プロジェクトディレクトリを開き、</font></font><code>pip install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyYAMLを</font><font style="vertical-align: inherit;">書き込みます</font><font style="vertical-align: inherit;">。PyYAMLはグローバルではなくディレクトリにインストールされます</font></font><code>__pymodules__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Pythonがこのディレクトリで起動すると、PyYAMLはグローバルではなく、このディレクトリからインポートされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分離が少ないため、最低でも仮想環境と呼んでいます。たとえば、バイナリファイルにはアクセスできません。 pytestがインストールされた仮想環境がアクティブ化されると、コンソールから使用できるようになります。pytestを作成して何かを実行するだけです。 C </font></font><code>__pymodules__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージはインポートには使用できますが、実際にはインストールされないため、バイナリは使用できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このPEPは、初心者が簡単に使用できるように設計されています。そのため、仮想環境の複雑なすべてに対処する必要はなく、pip installを使用して必要なすべてのものをインストールするだけ</font></font><code>__pymodules__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-さて、あなたの予測の未来は今よりも明るいです。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、しかし私が言ったように、誰も来て、私たちがやり直し、遺産を捨てようとしていると言った場合、問題は残ります。現在、私たちはツールを蓄積しており、近い将来にそれらを完全に取り除くことは不可能です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-どう思いますか、どの開発者も依存関係を更新できないのですか？企業でもオープンソースでも、ほとんどどこでも-セキュリティリリースを処理するプロセスは、原則として、新しいマイナーリリースまたはメジャーリリースで構築されています。ここで問題はどこにありますか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少なくとも依存関係を更新したい場合、すべての依存関係を更新するのは恐ろしいことです。テストに合格してもすべてが機能することは事実ではないからです。たとえば、Celeryはテストで完全にテストできないため、Celeryでこの状況が発生することがよくあります。何かをロックしたり、簡略化したりできますが、ワーカーが実行されているという事実は確認できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goモジュールのチュートリアルでも、依存関係の更新方法が記述されています。特定の依存関係を更新してテストを実行します。さらに、テストはあなたのものだけでなく、この依存性も実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深い側面はまだ言及する価値があります：テストはPythonのパッケージにあるべきですか？ pypi.orgからパッケージをダウンロードするとき、テストは必要ですか？理論的には、それらは実行するためのメカニズムを備えている必要があります。また、setup.pyで、テストの実行方法、依存関係を指定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、最初に、多くの人々はそれらを実行する方法を知らず、依存するテストを実行しません。したがって、それらはしばしば必要ありません。次に、これらのテストには非常に難しいフィクスチャが含まれることが多いため、テストをパッケージに含めると、パッケージを6〜10倍大きくすることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストあり、テストなしのパッケージをダウンロードできると便利です。しかし、これは今では不可能なので、テストがパッケージ内に追加されないことがよくあります。混乱があり、依存関係を更新するときにこれらの依存関係のテストを実行できるかどうかさえわかりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この側面はほとんど見過ごされているようです。しかし、他の一部の言語、特にGoは良い習慣と考えられており、環境内でパッケージを更新し、すぐにテストを実行して、この環境でこのパッケージが正常に機能することを確認します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-あなたの意見では、Pythonで自動セマンティックバージョニングのツールが人気がないのはなぜですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
問題の1つは、バージョンを多くの場所で説明できることです。ほとんどの場合、それらは3つあります。プロジェクトメタデータ記述形式（pypi.org、poety、setup.pyなど）、プロジェクト自体内、およびドキュメント内です。 3か所でバージョンをアップグレードすることはそれほど難しくありませんが、忘れがちです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DepHellには、バージョンアップグレードのチームがあります。さらに、DepHellはすべての依存形式で機能するように構成されているため、どの形式のバージョンでも機能します。セマンティックバージョン、互換バージョンなどがあります。&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントには、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バージョン管理の方法が何であるかを説明し、これはかなり好奇心旺盛です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深いことに、この問題はFlitで解決されています。 Flitは、パッケージメタデータを記述し、パッケージを分解してダウンロードするための独自の形式を持つ最小限のツールです。唯一の4つのチームがあります</font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>publish</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、プロジェクトフレームワークを作成してビルドし、PyPIにアップロードして、パッケージの依存関係をインストールすることです。すべてが非常に最小限です。</font><font style="vertical-align: inherit;">Flitでは、バージョンは1つの場所、つまりプロジェクト自体から読み取ったバージョンにのみ保存されます。</font><font style="vertical-align: inherit;">そして、モジュール自体のdocstringからプロジェクトの説明を読み取ります。</font><font style="vertical-align: inherit;">他の人がそれをしない理由はわかりませんが、これはクールなソリューションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DepHellは、Flitなどの操作方法も知っています。</font><font style="vertical-align: inherit;">彼はバージョンと説明だけでなく、作者とパッケージの名前も読むことができ、一般に世界のすべてのものを独立して見つけることができます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の目標は、依存関係の管理をできるだけ簡単にすることです。 </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DepHellでは、依存関係の形式をとして指定できます</font></font><code>import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。次に、インポートされるパッケージを見つけ、これらがプロジェクトの依存関係であることを理解し、それらのメタデータを読み取ります。</font><font style="vertical-align: inherit;">複雑で大規模なプロジェクトの場合、これは常に正しく機能するとは限りませんが、初心者がすべてを正しく機能させるのに役立ちます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニキータのインタビューに感謝します</font><font style="vertical-align: inherit;">。3月27日に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モスクワのPython Conf ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">彼に会います</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">DepHellに加えて、バックエンド、Web、データの収集と処理、AI / ML、テスト、DevOps、データベース、IoT、infosec、および会議で優れたコードを作成するためのベストプラクティスについて説明します。</font><font style="vertical-align: inherit;">参加して</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チケットを予約し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モスクワパイソンカンファレンス++でお会いし</font><font style="vertical-align: inherit;">ましょう</font><font style="vertical-align: inherit;">。</font></font></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483910/index.html">視覚情報理論（パート1）</a></li>
<li><a href="../ja483912/index.html">2020年にYouTrackに期待すること</a></li>
<li><a href="../ja483914/index.html">DINS JavaScript EVENINGにご招待します。API設計について話し、代数的データ型を使用して問題を解決します</a></li>
<li><a href="../ja483916/index.html">DJIは1か月間、Android 10用のDJI Flyアプリにパッチを適用できませんでした</a></li>
<li><a href="../ja483918/index.html">企業トレーニング：リーダーがリーダーを指導する</a></li>
<li><a href="../ja483922/index.html">車輪付きスマートホーム...アリス</a></li>
<li><a href="../ja483926/index.html">Three.jsとジオメトリ</a></li>
<li><a href="../ja483930/index.html">注目に値する6つのGitHub Web開発プロジェクト</a></li>
<li><a href="../ja483934/index.html">Linuxファイルの権限</a></li>
<li><a href="../ja483936/index.html">ゲーム開発講座</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>