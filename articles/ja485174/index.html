<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏪ 🎋 🕡 Haskell依存型：なぜソフトウェア開発の未来なのか 🚣🏻 🛳️ 🕡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="セロケルでは、商業プロジェクトだけでなく、世界をより良い方向に変えようとしています。たとえば、私たちはすべてのハスケリストの主要なツールであるグラスゴーハスケルコンパイラ（GHC）の改善に取り組んでいます。私たちは、Richard Eisenbergの作品「Haskellの依存型：理論と実践」の影響...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Haskell依存型：なぜソフトウェア開発の未来なのか</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485174/"><p><img src="https://habrastorage.org/getpro/habr/post_images/fce/995/232/fce99523266b5bc548c3d1730c70b885.jpg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セロケルでは、商業プロジェクトだけでなく、世界をより良い方向に変えようとしています。</font><font style="vertical-align: inherit;">たとえば、私たちはすべてのハスケリストの主要なツールであるグラスゴーハスケルコンパイラ（GHC）の改善に取り組んでいます。</font><font style="vertical-align: inherit;">私たちは、Richard Eisenbergの作品</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Haskellの依存型：理論と実践」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の影響下で型システムを拡張することに焦点を当てました</font><font style="vertical-align: inherit;">。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちのブログ、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウラジスラフはすでにHaskellは依存型を欠いており、どのように我々はそれらを追加することを計画する理由について話しました。</font><font style="vertical-align: inherit;">できるだけ多くの開発者が依存型を使用し、言語としてのHaskellの開発にさらに貢献できるように、この投稿をロシア語に翻訳することにしました。</font></font></p><a name="habracut"></a><br>
<h1 id="tekuschee-polozhenie-del"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現状</font></font></h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/6d3/260/bba/6d3260bbad59d047ba6f10b1fffd5383.jpg" alt="プログラミング言語選択アルゴリズム"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">依存型は、Haskellで最も欠けているものです。</font><font style="vertical-align: inherit;">その理由を説明しましょう。</font><font style="vertical-align: inherit;">必要なコードから：</font></font></p><br>
<ul>
<li>,        ;</li>
<li>    ;</li>
<li>,    . </li>
</ul><br>
<p>        ,      Haskell  .</p><br>
<h2 id="standartnyy-haskell-ergonomika--proizvoditelnost"> Haskell:  + </h2><br>
<p>  Haskell   :  -   ,      .         ,        .    ,   Haskell    .</p><br>
<p>     ,   C,        (,  ,  ).    ,      –   . </p><br>
<p>        : ,     ,  Rust.   , Rust   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">      </a>.      Cyclone       .     , Rust     .   ,    ,    Rust    .  ,       ,        .</p><br>
<p>    ,       ,     .</p><br>
<p>  (, , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>) ,   JavaScript  Clojure,    ,             ( ,      –   ,  !). </p><br>
<p>  ,   Java  Go,      .             . ,     Go   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">interface{}</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   </a>.         (, )   . </p><br>
<p>,       ,      , Haskell  . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>     ,  .         ,    ,   . </p><br>
<p>Haskell    ,                       ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Agda</a>.</p><br>
<p>    ,    Haskell  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  <code>Prelude</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>   <code>primitive</code>):</p><br>
<pre><code class="haskell hljs">(!!) :: [a] -&gt; <span class="hljs-type">Int</span> -&gt; a
<span class="hljs-title">indexArray</span> :: <span class="hljs-type">Array</span> a -&gt; <span class="hljs-type">Int</span> -&gt; a</code></pre><br>
<p>       ,         .          . </p><br>
<h2 id="agda-ergonomika--korrektnost">Agda:  + </h2><br>
<p>   (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Coq</a>) —  ,          .           .    ,  ,     . </p><br>
<p> , ,                  (, ,   ),   (  )  .    – ,  ,  ,           ,     .</p><br>
<p>      –    ,             .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Idris</a>.      () ,         .</p><br>
<p>          Agda.      Haskell,      .   Serokell  ,      .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  . </p><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">lookup</a>   <code>(!!)</code>  Haskell:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">lookup</span> : ∀ (xs : <span class="hljs-type">List</span> <span class="hljs-type">A</span>) → <span class="hljs-type">Fin</span> (length xs) → <span class="hljs-type">A</span></code></pre><br>
<p>     <code>List A</code>,   <code>[a]</code>  Haskell.      <code>xs</code>,         .  Haskell             :</p><br>
<pre><code class="haskell hljs">(!!) :: [a] -&gt; <span class="hljs-type">Int</span> -&gt; a <span class="hljs-comment">--   xs </span>
(!!) = \xs i -&gt; ...     <span class="hljs-comment">--   xs </span></code></pre><br>
<p>   Agda       <code>xs</code>    ,        <code>lookup</code>, <code>Fin (length xs)</code>. ,       ,  <em> </em>     . </p><br>
<p>   <code>lookup</code>   <code>Fin n</code>  <code>n ~ length xs</code>.   <code>Fin n</code>     <code>[0, n)</code>,   <code>Fin (length xs)</code>       .     ,      .  , <code>lookup ["x","y","z"] 2</code>   ,  <code>lookup ["x","y","z"] 42</code>  .</p><br>
<p>       Agda,      Haskell    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MAlonzo</a>.      .    MAlonzo:     <code>unsafeCoerce</code>,  GHC  ,   Agda.    <code>unsafeCoerce</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a> <em>(     ,         – . )</em>.</p><br>
<p>     :    Agda     ,         Haskell.         Agda    ,  .      ,    .  –   ,        . </p><br>
<h2 id="haskell-s-rasshireniyami-korrektnost--proizvoditelnost">Haskell  :  + </h2><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/954/0e8/735/9540e8735ab539e67787046735ee5789.jpg"></p><br>
<p>       , GHC   .    ,    .    Haskell,  GHC 7.4    .             : <code>RankNTypes</code>, <code>GADTs</code>, <code>TypeFamilies</code>, <code>DataKinds</code>,  <code>PolyKinds</code>.</p><br>
<p>       Haskell    :    (Π-),    (Σ-).   ,        !</p><br>
<p>  :</p><br>
<ul>
<li>         ,</li>
<li> ,      ,</li>
<li>         .</li>
</ul><br>
<p>      ,   <code>singletons</code>     Template Haskell.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/003/56f/e2a/00356fe2af43f034df850dbb556fb82f.jpg"></p><br>
<p>           Haskell  .       <code>lookup</code>    Agda:</p><br>
<pre><code class="haskell hljs"><span class="hljs-meta">{-# OPTIONS -Wall -Wno-unticked-promoted-constructors -Wno-missing-signatures #-}</span>
<span class="hljs-meta">{-# LANGUAGE LambdaCase, DataKinds, PolyKinds, TypeFamilies, GADTs,
             ScopedTypeVariables, EmptyCase, UndecidableInstances,
             TypeSynonymInstances, FlexibleInstances, TypeApplications,
             TemplateHaskell #-}</span><font></font>
<font></font>
<span class="hljs-keyword">module</span> ListLookup <span class="hljs-keyword">where</span><font></font>
<font></font>
<span class="hljs-keyword">import</span> Data.Singletons.TH
<span class="hljs-keyword">import</span> Data.Singletons.Prelude<font></font>
<font></font>
<span class="hljs-title">singletons</span><font></font>
  [d|<font></font>
    <span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">N</span> = <span class="hljs-type">Z</span> | <span class="hljs-type">S</span> <span class="hljs-type">N</span></span>
    len :: [a] -&gt; <span class="hljs-type">N</span>
    len [] = <span class="hljs-type">Z</span>
    len (_:xs) = <span class="hljs-type">S</span> (len xs)<font></font>
  |]<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Fin</span> n where</span>
  <span class="hljs-type">FZ</span> :: <span class="hljs-type">Fin</span> (<span class="hljs-type">S</span> n)
  <span class="hljs-type">FS</span> :: <span class="hljs-type">Fin</span> n -&gt; <span class="hljs-type">Fin</span> (<span class="hljs-type">S</span> n)<font></font>
<font></font>
<span class="hljs-title">lookupS</span> :: <span class="hljs-type">SingKind</span> a =&gt; <span class="hljs-type">SList</span> (xs :: [a]) -&gt; <span class="hljs-type">Fin</span> (<span class="hljs-type">Len</span> xs) -&gt; <span class="hljs-type">Demote</span> a
<span class="hljs-title">lookupS</span> <span class="hljs-type">SNil</span> = \<span class="hljs-keyword">case</span>{}
<span class="hljs-title">lookupS</span> (<span class="hljs-type">SCons</span> x xs) =<font></font>
  \<span class="hljs-keyword">case</span>
    <span class="hljs-type">FZ</span> -&gt; fromSing x
    <span class="hljs-type">FS</span> i' -&gt; lookupS xs i'</code></pre><br>
<p>   GHCi, ,  lookupS     :</p><br>
<pre><code class="haskell hljs"><span class="hljs-type">GHCi</span>, version <span class="hljs-number">8.6</span><span class="hljs-number">.2</span>: http://www.haskell.org/ghc/  :? for help<font></font>
[<span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-number">1</span>] <span class="hljs-type">Compiling</span> <span class="hljs-type">ListLookup</span>       ( <span class="hljs-type">ListLookup</span>.hs, interpreted )
<span class="hljs-type">Ok</span>, one <span class="hljs-keyword">module</span> loaded.<font></font>
*ListLookup&gt; :set -XTypeApplications -XDataKinds <font></font>
*ListLookup&gt; lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) FZ<font></font>
"x"<font></font>
*ListLookup&gt; lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>)<font></font>
"y"<font></font>
*ListLookup&gt; lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>))<font></font>
"z"<font></font>
*ListLookup&gt; lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>)))<font></font>
<font></font>
&lt;interactive&gt;:5:34: error:<font></font>
    • Couldn't match type ''S n0' with ''Z'<font></font>
      Expected type: Fin (<span class="hljs-type">Len</span> '["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"])<font></font>
        Actual type: Fin ('<span class="hljs-type">S</span> ('<span class="hljs-type">S</span> ('<span class="hljs-type">S</span> ('<span class="hljs-type">S</span> <span class="hljs-title">n0</span>))))<font></font>
    • In the second argument of 'lookupS', namely '(<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>)))'<font></font>
      In the expression:<font></font>
        lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>)))<font></font>
      In an equation for 'it':<font></font>
          it = lookupS (<span class="hljs-title">sing</span> @["<span class="hljs-title">x</span>", "<span class="hljs-title">y</span>", "<span class="hljs-title">z</span>"]) (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> (<span class="hljs-type">FS</span> <span class="hljs-type">FZ</span>)))</code></pre><br>
<p>  ,     .  ,   Haskell      <code>lookupS</code>,            .          .</p><br>
<p>   ,          ,    .      Agda   ,       . </p><br>
<p>   :</p><br>
<ul>
<li>  <code>a :: t</code>     <code>t :: k</code> . <code>5 :: Integer</code>   ,    . <code>"hi" :: Symbol</code>   ,    .       <code>Demote</code>     .</li>
<li>   <code>Int</code>      ( <code>singletons</code>  <code>Nat</code>   ). <code>Int</code>  <code>Nat</code> –  .           ,        ,   <code>Fin</code>  <code>lookupS</code>. -    <code>length</code>  <code>len</code>.</li>
<li> Haskell        . <code>singletons</code>          ,       .   . ,     <code>len</code>   Template Haskell,  <code>singletons</code>      , <code>Len</code>.</li>
<li>   .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>,       .      <code>SList</code>   <code>lookupS</code>.          .          .   -         (<code>toSing</code>, <code>fromSing</code>)  -    ( <code>SingKind</code>).</li>
</ul><br>
<p> –    .  ,      . ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">#12564</a>   2016 ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">#12088</a>   .       ,     (  ).   GHC     ,  ,   ,  ,       .  ,    GHC,  ,       .</p><br>
<h2 id="rezyume"></h2><br>
<p>  ,        ,    ,    : </p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th> Haskell</th>
<th>Agda</th>
<th>Haskell  </th>
</tr>
</thead>
<tbody>
<tr>
<td>  </td>
<td>+</td>
<td>+</td>
<td>-</td>
</tr>
<tr>
<td></td>
<td>+</td>
<td>-</td>
<td>+</td>
</tr>
<tr>
<td>,   </td>
<td>-</td>
<td>+</td>
<td>+</td>
</tr>
</tbody>
</table></div><br>
<h1 id="svetloe-buduschee"> </h1><br>
<p>       .   ,    :</p><br>
<ul>
<li>  Haskell          <code>singletons</code>. ( ,  ).</li>
<li> Agda       RTS  . ( ,  ).</li>
<li> Haskell  ,       ,     . ( ,  ).</li>
</ul><br>
<p>   ,         ( - ).       Haskell,    ,  ,       .   Agda   ()     <code>unsafeCoerce</code>.  Haskell   – ,   ,    . -  ,  - ,    ,    .</p><br>
<h2 id="izbavlenie-ot-singletons">  <code>singletons</code></h2><br>
<p>       <code>singletons</code>.       Haskell,       ,   <code>singletons</code>,   .         . ,  2016     <code>-XTypeInType</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> KProxy</a>  <code>SingKind</code>  <code>SomeSing</code>.         .     :</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> (<span class="hljs-title">kparam</span> ~ '<span class="hljs-type">KProxy</span>) =&gt; <span class="hljs-type">SingKind</span> (<span class="hljs-title">kparam</span> :: <span class="hljs-type">KProxy</span> <span class="hljs-title">k</span>) <span class="hljs-keyword">where</span></span>
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">DemoteRep</span> kparam :: *</span>
  fromSing :: <span class="hljs-type">SingKind</span> (a :: k) -&gt; <span class="hljs-type">DemoteRep</span> kparam<font></font>
  toSing :: <span class="hljs-type">DemoteRep</span> kparam -&gt; <span class="hljs-type">SomeSing</span> kparam<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> (<span class="hljs-title">a</span> :: <span class="hljs-title">k</span>) = <span class="hljs-type">DemoteRep</span> ('<span class="hljs-type">KProxy</span> :: <span class="hljs-type">KProxy</span> <span class="hljs-title">k</span>)</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">SomeSing</span> (<span class="hljs-title">kproxy</span> :: <span class="hljs-type">KProxy</span> <span class="hljs-title">k</span>) where</span>
  <span class="hljs-type">SomeSing</span> :: <span class="hljs-type">Sing</span> (a :: k) -&gt; <span class="hljs-type">SomeSing</span> ('<span class="hljs-type">KProxy</span> :: <span class="hljs-type">KProxy</span> k)</code></pre><br>
<p>   <code>k</code>     ,     <code>t :: k</code>.   <code>kparam :: KProxy k</code>   <code>k</code>  .</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">SingKind</span> k <span class="hljs-keyword">where</span></span>
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">DemoteRep</span> k :: *</span>
  fromSing :: <span class="hljs-type">SingKind</span> (a :: k) -&gt; <span class="hljs-type">DemoteRep</span> k<font></font>
  toSing :: <span class="hljs-type">DemoteRep</span> k -&gt; <span class="hljs-type">SomeSing</span> k<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> (<span class="hljs-title">a</span> :: <span class="hljs-title">k</span>) = <span class="hljs-type">DemoteRep</span> k</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">SomeSing</span> k where</span>
  <span class="hljs-type">SomeSing</span> :: <span class="hljs-type">Sing</span> (a :: k) -&gt; <span class="hljs-type">SomeSing</span> k</code></pre><br>
<p>   <code>k</code>       ,       <code>KProxy</code>.   ,    GHC 8.0           .</p><br>
<p>  Haskell     : ,   .      GHC 7.10,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.  GHC 8.0   : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>     .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d01/37e/387/d0137e3870470beb4b2aee56240926cf.jpg"></p><br>
<p> Haskell    –    ,    :</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">f</span> :: <span class="hljs-type">T</span> z -&gt; ...               <span class="hljs-comment">-- 'z'  </span>
<span class="hljs-title">g</span> :: <span class="hljs-type">T</span> (a :: z) -&gt; ...        <span class="hljs-comment">-- 'z'  </span>
<span class="hljs-title">h</span> :: <span class="hljs-type">T</span> z -&gt; <span class="hljs-type">T</span> (a :: z) -&gt; ... <span class="hljs-comment">-- 'z'   ,  </span></code></pre><br>
<p> GHC 8.0–8.4            .   GHC 8.6     :   <code>StarIsType</code>    <code>TypeInType</code>  <code>PolyKinds</code>.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  GHC 8.8,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>  GHC 8.10 (<em>   ,         – . </em>).</p><br>
<p>  ?    <code>SingKind</code>    <code>singletons</code>: </p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">SingKind</span> k <span class="hljs-keyword">where</span></span>
  <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> k = (<span class="hljs-title">r</span> :: <span class="hljs-type">Type</span>) | r -&gt; k</span>
  fromSing :: <span class="hljs-type">Sing</span> (a :: k) -&gt; <span class="hljs-type">Demote</span> k<font></font>
  toSing   :: <span class="hljs-type">Demote</span> k -&gt; <span class="hljs-type">SomeSing</span> k</code></pre><br>
<p>  <code>Demote</code>        <code>a :: t</code>     <code>t :: k</code>.   (   ), <code>Demote</code>   :</p><br>
<ul>
<li><code>type Demote Bool = Bool</code></li>
<li><code>type Demote [a] = [Demote a]</code></li>
<li><code>type Demote (Either a b) = Either (Demote a) (Demote b)</code></li>
</ul><br>
<p>, <code>Demote (Either [Bool] Bool) = Either [Bool] Bool</code>.       :</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-type">SingKind</span> k <span class="hljs-keyword">where</span></span>
  fromSing :: <span class="hljs-type">Sing</span> (a :: k) -&gt; k<font></font>
  toSing   :: k -&gt; <span class="hljs-type">SomeSing</span> k</code></pre><br>
<p><code>Demote</code>  ! ,   ,       <code>Either [Bool] Bool</code>,       .  , ,        : <code>Integer,</code> <code>Natural</code>, <code>Char</code>, <code>Text</code>,   .      ,   : <code>1 :: Natural</code>    ,     . -       :</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> <span class="hljs-type">Nat</span> = <span class="hljs-type">Natural</span></span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> <span class="hljs-type">Symbol</span> = <span class="hljs-type">Text</span></span></code></pre><br>
<p>      . , <code>Text</code>  :</p><br>
<pre><code class="haskell hljs"><span class="hljs-comment">-- | A space efficient, packed, unboxed Unicode text type.</span>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Text</span> = <span class="hljs-type">Text</span></span>
    <span class="hljs-meta">{-# UNPACK #-}</span> !<span class="hljs-type">Array</span> <span class="hljs-comment">-- payload (Word16 elements)</span>
    <span class="hljs-meta">{-# UNPACK #-}</span> !<span class="hljs-type">Int</span>   <span class="hljs-comment">-- offset (units of Word16, not Char)</span>
    <span class="hljs-meta">{-# UNPACK #-}</span> !<span class="hljs-type">Int</span>   <span class="hljs-comment">-- length (units of Word16, not Char)</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Array</span> = <span class="hljs-type">Array</span> <span class="hljs-type">ByteArray</span>#</span>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Int</span> = <span class="hljs-type">I</span># <span class="hljs-type">Int</span>#</span></code></pre><br>
<p>     <code>ByteArray#</code>  <code>Int#</code>   ,    <code>Text</code>  <code>Symbol</code>.      <code>Natural</code> , ,   ,    <code>Demote</code>,  ?</p><br>
<p>,  .          : .      <code>Demote</code>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Demote</span> (<span class="hljs-title">k1</span> ~&gt; <span class="hljs-title">k2</span>) = <span class="hljs-type">Demote</span> k1 -&gt; <span class="hljs-type">Demote</span> k2</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> a ~&gt; b = <span class="hljs-type">TyFun</span> a b -&gt; <span class="hljs-type">Type</span></span>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">TyFun</span> :: <span class="hljs-type">Type</span> -&gt; <span class="hljs-type">Type</span> -&gt; <span class="hljs-type">Type</span></span></code></pre><br>
<p><code>~&gt;</code>  ,     singletons     ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</p><br>
<p>      <code>~&gt;</code>  <code>-&gt;</code>,      () .   ,  <code>-&gt;</code>     <code>-&gt;</code>      .   ,    <code>a</code>  <code>b</code>   <code>a -&gt; b</code>.    ,  <em></em>  <code>a</code>  <code>b</code>   <code>a -&gt; b</code>,        .    , GHC ,   <code>f a ~ g b</code>  <code>f ~ g</code>  <code>a ~ b</code>,    ,     –   .</p><br>
<p>,      ,    ,       .   <code>a :-&gt; b</code>,     ,   <code>f a ~ g b</code>  <code>f ~ g</code>  <code>a ~ b</code>.   -    <code>a -&gt; b</code>. , <code>Just :: a :-&gt; Maybe a</code>,    <code>isJust :: Maybe a -&gt; Bool</code>.</p><br>
<p>  <code>Demote</code>  ,   –    <code>Sing</code>.      ,   <code>forall</code>  <code>-&gt;</code>.     isJust :</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">isJust</span> :: <span class="hljs-keyword">forall</span> a. <span class="hljs-type">Maybe</span> a -&gt; <span class="hljs-type">Bool</span>
<span class="hljs-title">isJust</span> =<font></font>
  \x -&gt;<font></font>
    <span class="hljs-keyword">case</span> x <span class="hljs-keyword">of</span>
      <span class="hljs-type">Nothing</span> -&gt; <span class="hljs-type">False</span>
      <span class="hljs-type">Just</span> _  -&gt; <span class="hljs-type">True</span></code></pre><br>
<p> <code>isJust</code>   <code>a</code>,    <code>x :: Maybe a</code>.      :</p><br>
<ul>
<li>.   <code>isJust (Just "hello")</code>   <code>x = Just "hello"</code> ,  <code>a = String</code>   .   Haskell        : <code>isJust @String (Just "hello")</code>. </li>
<li>. ,     <code>isJust</code>  ,       :       <code>case</code>,  ,  <code>Nothing</code>  <code>Just</code>.    .           :    <code>Maybe Int</code>, <code>Maybe String</code>, <code>Maybe Bool</code>  .. ,   .     .</li>
<li>.  <code>forall a. t</code>,  <code>t</code>   <code>a</code>, , ,     <code>a</code>. , <code>isJust @String</code>   <code>Maybe String -&gt; Bool</code>,  <code>isJust @Int</code>   <code>Maybe Int -&gt; Bool</code>.  ,  <code>forall</code> –  .    -:  ,    <code>isJust Nothing</code>  <code>isJust (Just …)</code>,    <code>Bool</code>. , <code>-&gt;</code> –    .</li>
</ul><br>
<p>  <code>Sing</code>,      ,  <code>a -&gt; b</code>,      ,  <code>forall (a :: k). t</code>.    <code>foreach (a :: k) -&gt; t</code>.   <code>SingI</code>,      , <code>foreach (a :: k). t</code>.   <code>singletons</code>   ,          .</p><br>
<h2 id="kratkiy-vzglyad-na-haskell-s-zavisimymi-tipami">   Haskell   </h2><br>
<p>        <code>foreach</code>,    <code>lookupS</code>  :</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">N</span> = <span class="hljs-type">Z</span> | <span class="hljs-type">S</span> <span class="hljs-type">N</span></span><font></font>
<font></font>
<span class="hljs-title">len</span> :: [a] -&gt; <span class="hljs-type">N</span>
<span class="hljs-title">len</span> [] = <span class="hljs-type">Z</span>
<span class="hljs-title">len</span> (_:xs) = <span class="hljs-type">S</span> (len xs)<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">data</span> <span class="hljs-type">Fin</span> n where</span>
  <span class="hljs-type">FZ</span> :: <span class="hljs-type">Fin</span> (<span class="hljs-type">S</span> n)
  <span class="hljs-type">FS</span> :: <span class="hljs-type">Fin</span> n -&gt; <span class="hljs-type">Fin</span> (<span class="hljs-type">S</span> n)<font></font>
<font></font>
<span class="hljs-title">lookupS</span> :: foreach (xs :: [a]) -&gt; <span class="hljs-type">Fin</span> (len xs) -&gt; a
<span class="hljs-title">lookupS</span> [] = \<span class="hljs-keyword">case</span>{}
<span class="hljs-title">lookupS</span> (x:xs) =<font></font>
  \<span class="hljs-keyword">case</span>
    <span class="hljs-type">FZ</span> -&gt; x
    <span class="hljs-type">FS</span> i' -&gt; lookupS xs i'</code></pre><br>
<p>   , - <code>singletons</code>     .     :   <code>Demote</code>, <code>SingKind</code>, <code>SList</code>, <code>SNil</code>, <code>SCons</code>, <code>fromSing</code>.   <code>TemplateHaskell</code>,        <code>len</code>      <code>Len</code>.    ,       <code>fromSing</code>.</p><br>
<p>     <code>length</code>  <code>len</code>,     <code>N</code>  <code>Int</code>. ,            Haskell,  Agda     <code>N</code>   <code>lookup</code>.</p><br>
<p>   Haskell     ,   Haskell. -   ,        .             ,       .    Haskell       ,    <code>singletons</code>.</p><br>
<p>    .     ,    GHC:  ,  ,  ,    Core.   ,    .</p><br>
<hr><br>
<h1 id="tezaurus"></h1><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong></strong><br>
 </td>
<td><strong></strong><br>
 </td>
<td><strong></strong><br>
 </td>
</tr>
<tr>
<td>correct by construction<br>
 </td>
<td>,      <br>
 </td>
<td> ,         (,   ),   .<br>
 </td>
</tr>
<tr>
<td>memory unsafe<br>
 </td>
<td>    <br>
 </td>
<td>        ,    .<br>
 </td>
</tr>
<tr>
<td>unityped<br>
 </td>
<td><br>
 </td>
<td>,   Bob Harper     ,    .           .<br>
 </td>
</tr>
<tr>
<td>boilerplate<br>
 </td>
<td> <br>
 </td>
<td>      ,    -   .<br>
 </td>
</tr>
<tr>
<td>generics<br>
 </td>
<td> <br>
 </td>
<td>      . ,     «»  «»,     ,    &lt;&gt;  &lt;&gt;.<br>
 </td>
</tr>
<tr>
<td>runtime cast<br>
 </td>
<td>   <br>
 </td>
<td>             .<br>
 </td>
</tr>
<tr>
<td>effectful computation<br>
 </td>
<td>   <br>
 </td>
<td>,          .<br>
 </td>
</tr>
<tr>
<td>composable<br>
 </td>
<td><br>
 </td>
<td> ,          .<br>
 </td>
</tr>
<tr>
<td>control structures<br>
 </td>
<td>,   <br>
 </td>
<td> ,       .<br>
 </td>
</tr>
<tr>
<td>proof assistant<br>
 </td>
<td>  <br>
 </td>
<td>      .<br>
 </td>
</tr>
<tr>
<td>strict (eager) evaluation<br>
 </td>
<td> () <br>
 </td>
<td>  ,         .<br>
 </td>
</tr>
<tr>
<td>backend<br>
 </td>
<td><br>
 </td>
<td> ,         .<br>
 </td>
</tr>
<tr>
<td>singleton type<br>
 </td>
<td> <br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプレベルでの対応するパラメーターのインスタンス化によって決定される単一の値によって入力されるタイプ。</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">昇格された定義</font></font><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高度な定義</font></font><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用語レベルで特定の関数に対応するクローズドタイプファミリの定義。</font></font><br>
 </td>
</tr>
</tbody></table></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja485160/index.html">ACIDまたは別の視点で私は何ですか</a></li>
<li><a href="../ja485162/index.html">1940年代から2020年までのコードコメントの進化</a></li>
<li><a href="../ja485164/index.html">バンクーバーのトランスフォーマーと憎しみ：反盗用はNeurIPS-2019にどのように乗り越えるか</a></li>
<li><a href="../ja485166/index.html">それほど害を及ぼさないように会社で知識交換を確立する方法</a></li>
<li><a href="../ja485172/index.html">大規模プロジェクトにおけるアーキテクチャの問題</a></li>
<li><a href="../ja485176/index.html">製品管理の概念の説明に役立つ6つのスキーム</a></li>
<li><a href="../ja485178/index.html">写真から失われた建物を再構築するための方法論</a></li>
<li><a href="../ja485180/index.html">データレイクは必要ですか？データウェアハウスをどうするか</a></li>
<li><a href="../ja485182/index.html">Sennheiser in 2020-記念日のために更新されたワイヤレスヘッドフォン</a></li>
<li><a href="../ja485184/index.html">タブ付き投票結果</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>