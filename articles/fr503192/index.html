<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔵 🐲 👇 oVirt en 2 heures. Partie 4. Opérations de base 🧒 ♑️ 👂🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous examinons un certain nombre d'opérations de base que l'administrateur de l'environnement de virtualisation devra régulièrement effec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt en 2 heures. Partie 4. Opérations de base</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503192/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aujourd'hui, nous examinons un certain nombre d'opérations de base que l'administrateur de l'environnement de virtualisation devra régulièrement effectuer. </font><font style="vertical-align: inherit;">L'article est une continuation de la série oVirt: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">partie 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">partie 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">partie 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenu</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Création d'une machine virtuelle et d'un modèle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration de VM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (migration en direct);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stockage (migration de stockage);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renommer VM et disque</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre à jour oVirt-Host</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (hyperviseur);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre à jour oVirt-Engine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (gestionnaire);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une VM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion des tâches</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des articles</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation du gestionnaire (ovirt-engine) et des hyperviseurs (hôtes) </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paramètres additionnels</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérations de base - nous sommes ici</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Traditionnellement, pour plus de détails sur les tâches administratives, bienvenue dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En entrant dans oVirt, vous verrez 2 portails:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portail d'administration</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portail VM</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier est destiné aux tâches administratives et administratives, le second - aux clients de machines, mais peut également être utilisé par l'administrateur - certaines fonctions y sont encore plus pratiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En haut de la fenêtre de chaque collection d'objets oVirt se trouve un puissant champ de recherche, avec des invites contextuelles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, la sélection d'hôtes problématiques dans le panneau de configuration provoque en fait un filtre:</font></font><br>
<br>
<pre><code class="plaintext hljs">status = unassigned or status = maintenance or status = installing or status = reboot or status = preparingformaintenance or status = pendingapproval or status = connecting or status = installingos or status = kdumping</code></pre><br>
<a name="vm-pool"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer une machine virtuelle et un modèle</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense que vous avez créé une machine virtuelle simple déjà dans la partie 2, maintenant nous allons découvrir d'autres entités oVirt qui sont directement liées aux machines virtuelles - machines virtuelles elles-mêmes, modèles et pools. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un modèle</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une copie d'une machine (généralement pré-préparée) conçue pour créer des machines identiques (clonage). Le modèle peut avoir une version, c'est pratique, car pas besoin de faire un nouveau modèle séparé après chaque mise à jour de la machine de référence. Plus de détails dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un pool</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un groupe de machines identiques générées à partir d'un modèle unique. Pratique pour VDI (infrastructure de bureau virtuel), lorsque des dizaines ou des centaines d'utilisateurs doivent fournir un environnement de travail identique et cela se fait littéralement en un clin d'œil. En savoir plus sur les pools dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créons un modèle pour lequel nous pouvons cloner une machine précédemment créée, mais pour la démonstration, nous allons dans l'autre sens - importer un modèle de la collection externe Glance Images: Storage -&gt; Domains -&gt; ovirt-image-repository (1), Import (2): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fx/gg/lt/fxggltgss5p9llxyplgghxmpbsg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1 - Importation de l'image Fedora 32.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous marquons «Importer comme modèle» (3, Importer comme modèle), donner un nom au modèle (4). Il est fortement recommandé de donner un nom convivial au disque (5, alias de disque). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La progression des tâches est facilement contrôlée dans la section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tâches</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/p6/co/cjp6cor50gw2euzkgnf_vl-lc24.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 2 - Progrès dans l'exécution des tâches dans oVirt.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Une fois le téléchargement réussi, le modèle est ajouté à la liste. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cg/_n/o3/cg_no3kzfukaodkzouox0q2bt3q.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 3 - Modèles.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sur la base du modèle chargé, créez un pool: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/qk/aj/fnqkajhsx4hrbzr_wc8jozs9zua.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4 - Création d'un pool.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons dans Compute -&gt; Pools (1), New (2), sélectionnez le modèle Fedora32 (3), la version - latests (4), attribuez le nom "myPoolA- ??" (5). Nous ne touchons pas encore aux champs Number of VM et Prestarted VM, nous y reviendrons à l'étape suivante. Ensuite, activez les paramètres avancés (6) et passez à la configuration de l'exécution initiale. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/m5/dj/zxm5djt-ud05hne1hyahor2nluo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 4 - Configurer le démarrage initial.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parce que à partir de Glance Images, nous avons téléchargé Cloud Image, nous devons configurer l'authentification. Vérifiez que «Utiliser Cloud-Init / Sysprep» (1) est activé, ouvrez Authentification (2), spécifiez le nom d'utilisateur, par exemple, root ou utilisateur (3). Pour créer un mot de passe unique pour le pool, désactivez «Utiliser le mot de passe déjà configuré» (4) et entrez votre mot de passe (5). Cliquez sur «OK» - le pool est créé, des machines identiques sont apparues dans Calcul -&gt; Machines virtuelles (faites attention à leur icône, c'est différent d'une machine fonctionnant séparément). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque sur le nom de la piscine. Comme vous l'avez remarqué, à la fin est "- ??". Cela inclut la numérotation "normalisée" des machines (complétée par des zéros - 01, 02, ..., 09, 10, etc.). Sinon, la numérotation sera des nombres naturels sans alignement (1, 2, ..., 9, 10, ...)</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de continuer, revenons aux paramètres du pool. </font><font style="vertical-align: inherit;">Notez que le champ «Nombre de VM» est devenu «Augmentez le nombre de VM du pool». </font><font style="vertical-align: inherit;">Nous spécifions ici 31 et le nombre de machines dans le pool devient presque instantanément 32. Maintenant, dans le champ «VM démarrée», nous entrons 16 - cela forcera oVirt à garder le nombre spécifié de machines pré-démarrées et prêtes à connecter les utilisateurs. </font><font style="vertical-align: inherit;">C'est là que nous terminerons sur les machines, les modèles et les pools et passerons à la migration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Icônes de VM clés:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unité de rack - serveur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moniteur - bureau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 tours - serveur de la piscine;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 moniteurs - bureau de la piscine;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rembobinage (rembobinage) - sans état (la machine réinitialise son état à son état d'origine après l'arrêt; toutes les modifications sont annulées);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">triangle dans le moniteur orange - la modification de configuration demandée nécessite un redémarrage.</font></font></li>
</ul><br>
<a name="live-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration de VM (migration en direct)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La migration de l'état de la machine allumée est simple - faites un clic droit sur une machine ou un groupe de machines. </font><font style="vertical-align: inherit;">La procédure est similaire à celle de vMotion dans vSphere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/ne/dz/zmnedzcid6vyhsgubvv95u6cnsy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">5 - Lancez la migration. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculer -&gt; Machine virtuelle, sélectionnez une ou plusieurs machines, Migrez. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/bp/9h/8vbp9hslgmoa_n_v3ltlmuxfknw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">6 - Le processus de migration peut être observé dans les hôtes (Calcul -&gt; Hôtes). </font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À la fois, pas plus de 2 voitures se déplacent.</font></font><br>
<a name="storage-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migration de stockage</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais cette procédure peut sembler inhabituelle à l'utilisateur de VMware vSphere, car </font><font style="vertical-align: inherit;">les approches de stockage des images de disque et des configurations de machine dans les systèmes diffèrent. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour transférer le stockage VM, accédez aux disques (Stockage -&gt; Disques) ou aux domaines (Stockage -&gt; Domaines -&gt; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{Nom de domaine}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -&gt; Disques). </font><font style="vertical-align: inherit;">Sélectionnez le ou les lecteurs et appuyez sur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déplacer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ça y est, les disques sont envoyés vers un autre stockage. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: en raison de l'organisation interne, il existe des restrictions pour la migration du magasin de modèles et du pool. </font><font style="vertical-align: inherit;">Il est préférable de se familiariser avec la migration du stockage sur une machine distincte, en dehors du pool. </font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La copie sur disque s'effectue dans les mêmes menus que le chargement / déchargement manuel.</font></font><br>
<a name="rename"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renommer VM et disque</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Changer le nom d'une machine ou d'un modèle est très simple - Modifiez et entrez un nouveau nom. </font><font style="vertical-align: inherit;">Renommer un pool nécessite de supprimer ses machines et de le recréer, car </font><font style="vertical-align: inherit;">sur cette base, les VM sont générées avec les noms et la configuration correspondants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est également possible de renommer un disque, mais le chemin est plus long que </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e: Calculer -&gt; Machine virtuelle -&gt; {Nom VM} -&gt; Disques -&gt; {Alias ​​de disque VM} -&gt; Modifier, Alias. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les identificateurs d'objet internes sont construits sur des UUID. </font><font style="vertical-align: inherit;">Lors du changement de nom, nous changeons en fait les alias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section traite de la mise à jour, qui est une mise à jour (mineure), et non une mise à niveau (majeure), lorsque le numéro de version change (il s'agit d'une procédure plus compliquée et ne fait pas partie des tâches quotidiennes).</font></font><br>
<a name="update-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre à jour oVirt-Host (hyperviseur)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les mises à jour d'hôte sont plus simples que dans vSphere, le gestionnaire de mise à jour dans oVirt est organiquement intégré à la plateforme et ne nécessite aucun paramètre. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mise à jour </font><font style="vertical-align: inherit;">officielle </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/we/j1/fjwej1ph06a03bqpfx2ye6ijeny.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 7 - S'il y a des mises à jour, le gestionnaire les signalera avec une icône de CD. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ww/vw/rn/wwvwrnz9q9hizaqo3mfndfihp_m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 8 - Avant de démarrer la mise à jour, vous devez activer le mode de maintenance (Gestion -&gt; Maintenance), il démarrera automatiquement la migration de la VM vers d'autres hôtes (voir Fig.6) et préparera la mise à jour. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ol/ry/fw/olryfwdduor2j39tr47n8zlnpew.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 9 - L'icône de clé indique que l'hôte est prêt pour le service. </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ov/rt/ta/ovrttawkmmi6fkfp-wic5_mpy00.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 10 - Installation -&gt; Mise à niveau démarre la procédure de mise à niveau. </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/8z/ch/7s/8zch7sdgo_plq5suw8yevk8nzz8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 11 - Nous pouvons demander au gestionnaire de donner à l'hôte une commande pour redémarrer une fois la mise à jour terminée, pour qu'elle prenne effet.</font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ze/dg/kb/zedgkbmmuxxm7kvy6qoxhh-bvza.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">12 - Après le redémarrage, nous mettons l'hyperviseur hors service (Gestion -&gt; Activer). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons par tous les hôtes et les mettons à jour.</font></font><br>
<a name="update-engine"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre à jour oVirt-Engine (gestionnaire)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, cela peut être déroutant, mais la mise à jour du gestionnaire est effectuée à l'aide de la configuration du moteur, avec des étapes supplémentaires, comme décrit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si possible, créez une archive ou un instantané de la machine, assurez-vous que la dernière sauvegarde planifiée a réussi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous vérifions et mettons à jour les packages d'installation:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-upgrade-check<font></font>
$ sudo update ovirt\*setup\*</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La partie principale de la mise à jour est effectuée par le programme de configuration du moteur. </font><font style="vertical-align: inherit;">Elle posera un certain nombre de questions de configuration, puis arrêtera le service ovirt-engine, téléchargera et installera les packages mis à jour, créera une archive et mettra à jour la base de données, appliquera la configuration mise à jour et démarrera le service ovirt-engine.</font></font><br>
 <br>
<pre><code class="bash hljs">$ sudo engine-setup</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Une fois la mise à jour réussie, nous recevrons le message:</font></font><br>
 <br>
<pre><code class="plaintext hljs">Execution of setup completed successfully</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de sortie du script de configuration du moteur</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">$ sudo engine-setup</code></pre><br>
<pre><code class="plaintext hljs">[ INFO  ] Stage: Initializing<font></font>
[ INFO  ] Stage: Environment setup<font></font>
          Configuration files: ['/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf', '/etc/ovirt-engine-setup.conf.d/10-packaging.conf', '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf']<font></font>
          Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
          Version: otopi-1.8.2 (otopi-1.8.2-1.el7)<font></font>
[ INFO  ] Stage: Environment packages setup<font></font>
[ INFO  ] Stage: Programs detection<font></font>
[ INFO  ] Stage: Environment setup (late)<font></font>
[ INFO  ] Stage: Environment customization<font></font>
         <font></font>
          --== PRODUCT OPTIONS ==--<font></font>
         <font></font>
         <font></font>
          --== PACKAGES ==--<font></font>
         <font></font>
[ INFO  ] Checking for product updates...<font></font>
          Setup needs to install or update the following packages:<font></font>
          [updated] ovirt-engine-4.3.5.5-1.el7.noarch will be updated<font></font>
...<font></font>
          [update] ovirt-engine-wildfly-overlay-17.0.1-1.el7.noarch is an update<font></font>
          Replying "No" will abort Setup. You can pass the option "--offline" to prevent installing or updating packages.<font></font>
          Do you wish to update them now? (Yes, No) [Yes]: <font></font>
[ INFO  ] Checking for an update for Setup...<font></font>
         <font></font>
          --== NETWORK CONFIGURATION ==--<font></font>
         <font></font>
          Setup can automatically configure the firewall on this system.<font></font>
          Note: automatic configuration of the firewall may overwrite current settings.<font></font>
          NOTICE: iptables is deprecated and will be removed in future releases<font></font>
          Do you want Setup to configure the firewall? (Yes, No) [Yes]: <font></font>
[ INFO  ] firewalld will be configured as firewall manager.<font></font>
         <font></font>
          --== DATABASE CONFIGURATION ==--<font></font>
         <font></font>
          The detected DWH database size is 439 MB.<font></font>
          Setup can backup the existing database. The time and space required for the database backup depend on its size. This process takes time, and in some cases (for instance, when the size is few GBs) may take several hours to complete.<font></font>
          If you choose to not back up the database, and Setup later fails for some reason, it will not be able to restore the database and all DWH data will be lost.<font></font>
          Would you like to backup the existing database before upgrading it? (Yes, No) [Yes]: <font></font>
          Perform full vacuum on the oVirt engine history<font></font>
          database ovirt_engine_history@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== OVIRT ENGINE CONFIGURATION ==--<font></font>
         <font></font>
          Perform full vacuum on the engine database engine@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== STORAGE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== PKI CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== APACHE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== SYSTEM CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== MISC CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== END OF CONFIGURATION ==--<font></font>
         <font></font>
[ INFO  ] Stage: Setup validation<font></font>
          During execution engine service will be stopped (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning stale zombie tasks and commands<font></font>
         <font></font>
          --== CONFIGURATION PREVIEW ==--<font></font>
         <font></font>
          Default SAN wipe after delete           : False<font></font>
          Firewall manager                        : firewalld<font></font>
          Update Firewall                         : True<font></font>
          Host FQDN                               : ovirt.example.com<font></font>
          Upgrade packages                        : True<font></font>
          Set up Cinderlib integration            : False<font></font>
          Engine database secured connection      : False<font></font>
          Engine database user name               : engine<font></font>
          Engine database name                    : engine<font></font>
          Engine database host                    : localhost<font></font>
          Engine database port                    : 5432<font></font>
          Engine database host name validation    : False<font></font>
          Engine installation                     : True<font></font>
          PKI organization                        : JSC Open Lab<font></font>
          Set up ovirt-provider-ovn               : False<font></font>
          Configure WebSocket Proxy               : True<font></font>
          DWH installation                        : True<font></font>
          DWH database secured connection         : False<font></font>
          DWH database host                       : localhost<font></font>
          DWH database user name                  : ovirt_engine_history<font></font>
          DWH database name                       : ovirt_engine_history<font></font>
          Backup DWH database                     : True<font></font>
          DWH database port                       : 5432<font></font>
          DWH database host name validation       : False<font></font>
          Configure Image I/O Proxy               : True<font></font>
          Configure VMConsole Proxy               : True<font></font>
         <font></font>
          Please confirm installation settings (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning async tasks and compensations<font></font>
[ INFO  ] Unlocking existing entities<font></font>
[ INFO  ] Checking the Engine database consistency<font></font>
[ INFO  ] Stage: Transaction setup<font></font>
[ INFO  ] Stopping engine service<font></font>
[ INFO  ] Stopping ovirt-fence-kdump-listener service<font></font>
[ INFO  ] Stopping dwh service<font></font>
[ INFO  ] Stopping Image I/O Proxy service<font></font>
[ INFO  ] Stopping vmconsole-proxy service<font></font>
[ INFO  ] Stopping websocket-proxy service<font></font>
[ INFO  ] Stage: Misc configuration (early)<font></font>
[ INFO  ] Stage: Package installation<font></font>
[ INFO  ] Yum Status: Downloading Packages<font></font>
...<font></font>
[ INFO  ] Stage: Misc configuration<font></font>
[ INFO  ] Upgrading CA<font></font>
[ INFO  ] Not rewriting /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
[ INFO  ] Backing up database localhost:ovirt_engine_history to '/var/lib/ovirt-engine-dwh/backups/dwh-20200522233531.6LDItj.dump'.<font></font>
[ INFO  ] Creating/refreshing DWH database schema<font></font>
[ INFO  ] Configuring Image I/O Proxy<font></font>
[ INFO  ] Configuring WebSocket Proxy<font></font>
[ INFO  ] Backing up database localhost:engine to '/var/lib/ovirt-engine/backups/engine-20200522233538.LZCwME.dump'.<font></font>
[ INFO  ] Creating/refreshing Engine database schema<font></font>
[ INFO  ] Creating/refreshing Engine 'internal' domain database schema<font></font>
          Unregistering existing client registration info.<font></font>
[ INFO  ] Generating post install configuration file '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf'<font></font>
[ INFO  ] Stage: Transaction commit<font></font>
[ INFO  ] Stage: Closing up<font></font>
[ INFO  ] Starting engine service<font></font>
[ INFO  ] Starting dwh service<font></font>
[ INFO  ] Restarting ovirt-vmconsole proxy service<font></font>
         <font></font>
          --== SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Restarting httpd<font></font>
          Web access is enabled at:<font></font>
              http://ovirt.example.com:80/ovirt-engine<font></font>
              https://ovirt.example.com:443/ovirt-engine<font></font>
          SSH fingerprint: SHA256:JvilhbwRuMjBCJEjQVPlFQgk0aLaKz7Od0WzsZtx4j4<font></font>
          Did not update /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
         <font></font>
          --== END OF SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Stage: Clean up<font></font>
          Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
[ INFO  ] Generating answer file '/var/lib/ovirt-engine/setup/answers/20200522233608-setup.conf'<font></font>
[ INFO  ] Stage: Pre-termination<font></font>
[ INFO  ] Stage: Termination<font></font>
[ INFO  ] Execution of setup completed successfully</code></pre></div>
                    </div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous mettons à jour le système d'exploitation et d'autres packages supplémentaires:</font></font><br>
 <pre><code class="bash hljs">$ sudo yum update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Si nécessaire (mise à jour du noyau ou de ses composants) nous redémarrons la machine.</font></font></li>
</ol><br>
<a name="import-vm"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une VM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez importer à partir de VMware, Export Domain (une entité spéciale oVirt pour échanger des images entre le centre de données), Virtual Appliance (OVA), XEN, KVM. </font><font style="vertical-align: inherit;">Toutes les options officiellement prises en charge:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une VM à partir de VMware ESXi / VSPHERE s'exécute sur l'hôte + authentification vers l'hôte sur lequel ESXi / VSPHERE s'exécute</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une machine virtuelle KVM / Xen depuis Libvirt: l'utilisateur spécifie l'URL + l'authentification sur l'hôte sur lequel Libvirt s'exécute</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une machine virtuelle KVM / Xen à partir d'un chemin donné: l'utilisateur spécifie le chemin nfs / posix vers la configuration et les disques de la machine virtuelle</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import VM qui a été exporté à partir de VMware: L'utilisateur spécifie le chemin nfs / posix vers le fichier ova</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upload KVM / Xen VM: L'utilisateur spécifie les fichiers de la configuration et les disques</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upload VM qui a été exporté à partir de VMware: L'utilisateur spécifie le fichier ova</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer une VM à partir d'un dossier: l'utilisateur spécifie le chemin d'accès au dossier qui contient les VM KVM / Xen ou VM exportées à partir de VMware</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arrêtons-nous sur 2 options - importer depuis vSphere et une machine autonome avec KVM. </font><font style="vertical-align: inherit;">Pour démarrer l'import import dans Calcul -&gt; Machines virtuelles, cliquez sur le bouton pour des éléments de menu supplémentaires (3 points verticaux, voir Fig. 13). </font><font style="vertical-align: inherit;">La machine source doit être éteinte.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer des machines depuis vCenter</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'assistant:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source de données: VMware;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fournisseur externe: dans Administration -&gt; Fournisseurs, vous pouvez configurer un modèle pour les opérations fréquentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCenter: nom ou adresse du serveur vCenter;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESXi: de quel hyperviseur prendrons-nous la voiture;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Ceter: chemin d'accès complet au cluster;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster: contenant un cluster d'hyperviseur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nom d'utilisateur / mot de passe: nom d'utilisateur et mot de passe pour se connecter à vCenter;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vérifiez le certificat SSL du serveur: lorsque vous utilisez des certificats auto-signés, vous devrez désactiver leur vérification.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/g9/0i/4b/g90i4btxfdhaz_ji-bntbutlaei.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">13 - Importez des VM à partir de VMware vSphere.</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importer des machines depuis KVM</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Détails sur l'importation depuis KVM dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, vous devez activer la connexion au KVM de l'extérieur, si cela n'a pas été configuré auparavant.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autorisation d'exporter des machines vers KVM</font></font></b>
                        <div class="spoiler_text">        ,      .       ! ,      ,        ,       .     , .,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ArchLinux</a>.<br>
<br>
 ,   libvirtd<br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/sysconfig/libvirtd</code></pre><br>
 <br>
<br>
<pre><code class="plaintext hljs">LIBVIRTD_ARGS="--listen"</code></pre><br>
      <br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/libvirt/libvirtd.conf /etc/libvirt/libvirtd.conf.`date +%F`<font></font>
$ sudo vim /etc/libvirt/libvirtd.conf</code></pre><br>
  :<br>
<br>
<pre><code class="plaintext hljs">listen_tls = 0<font></font>
listen_tcp = 1<font></font>
listen_addr = "0.0.0.0"<font></font>
auth_tcp = "none"</code></pre><br>
     <br>
<br>
<pre><code class="plaintext hljs">log_outputs="3:syslog:libvirtd"</code></pre><br>
    libvirtd.    ,    libvirtd &gt; 0.6 (  libvirtd --version),   .<br>
<br>
<pre><code class="bash hljs">$ sudo service libvirtd restart</code></pre><br>
     tcp:16509.<br>
<br>
 CentOS 7     (  permanent):<br>
<br>
<pre><code class="bash hljs">$ sudo firewall-cmd --add-rich-rule=<span class="hljs-string">'rule family="ipv4" source address="172.17.71.32/30" port port="16509" protocol="tcp" accept'</span></code></pre><br>
 :<br>
<br>
<pre><code class="bash hljs">$ virsh -r -c <span class="hljs-string">'qemu+tcp://mgmt@kvm46.example.com/system'</span> list --all</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, l'importation elle-même est très simple: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calculer -&gt; Machines virtuelles -&gt;: (menu supplémentaire, 3 points verticaux) -&gt; Importer -&gt; Source (KVM via libvirt) -&gt; URI (qemu + tcp: //kvm46.example.com / système) -&gt; Authentification requise (Désactiver) -&gt; Charger. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous marquons les machines nécessaires, sélectionnons la politique d'allocation (Politique d'allocation). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Politique d'allocation - Pré-alloué est préférable pour les volumes de stockage avec détection de zéro matériel, pour les volumes avec des E / S élevées, les volumes avec une occupation élevée, etc., sinon un provisionnement fin peut être. Dans tous les cas, nous regardons la situation et l'analysons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le «Clone» coché est coché, mais ne copie pas la voiture. Par exemple, une nouvelle adresse MAC pour l'interface réseau sera attribuée.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous l'onglet Général, il est important de spécifier le type de système d'exploitation approprié et sous l'onglet Interfaces réseau, vous pouvez spécifier le réseau souhaité. </font><font style="vertical-align: inherit;">Ensuite, «importez» et, selon la vitesse de l'équipement, nous obtenons la machine importée. </font><font style="vertical-align: inherit;">Après l'importation (ou avant), n'oubliez pas d'installer ovirt-guest-agent.</font></font><br>
<br>
<a name="task-mgmt"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion des tâches</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque les tâches se figent, des «danses» difficiles commencent, dont certaines que j'essaierai d'aborder. </font><font style="vertical-align: inherit;">Avec un comportement régulier, on peut les observer sur la Fig. </font><font style="vertical-align: inherit;">2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la tâche est exécutée plus ou moins normalement, des outils réguliers suffisent. </font><font style="vertical-align: inherit;">Avec des pimers et des images que vous pouvez voir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tâches sont exécutées sur oVirt-host.</font></font><br>
<br>
<pre><code class="plaintext hljs">[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task getStatus taskID=&lt;TASKID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task stop taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task clear taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, vdsm-client peut essayer de restaurer la tâche, toutes les méthodes prises en charge:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vdsm-client Task -h</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Méthodes de tâche: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 méthode [arg = valeur] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getStatus Récupère les informations sur l'état de la tâche. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 annuler la restauration d'une tâche pour restaurer l'état précédent du système. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 clear Supprimer les informations sur une tâche terminée. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getInfo Obtenez des informations sur une tâche. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 stop Arrête une tâche en cours d'exécution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, les mouvements deviennent plus compliqués si la tâche ne peut pas être arrêtée en utilisant des méthodes standard. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Officiellement, l'outil taskcleaner est utilisé pour cela:</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo /usr/share/ovirt-engine/setup/dbutils/taskcleaner.sh --<span class="hljs-built_in">help</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les cas encore plus graves, une édition directe de la base de données est requise. </font><font style="vertical-align: inherit;">Cette méthode ne doit être utilisée qu'en dernier recours, en ayant de nouvelles archives d'oVirt et des machines concernées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous connectons la collection de logiciels</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo scl <span class="hljs-built_in">enable</span> rh-postgresql10 <span class="hljs-string">"psql -d engine -U postgres"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, connectez-vous à la base de données</font></font><br>
<br>
<pre><code class="plaintext hljs">su postgres<font></font>
psql -d engine -U postgres<font></font>
select * from job order by start_time desc;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et suppression directe - exécution de la procédure DeleteJob pour la tâche problématique:</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('UUID_HERE');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple:</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('ed0127c7-b052-4ec2-a67c-8b3a65d55e19');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout pour aujourd'hui, et j'espère que vous n'aurez jamais besoin de modifier manuellement une base de données!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr503172/index.html">C #: Présentation des générateurs de code source</a></li>
<li><a href="../fr503176/index.html">Implémentation d'un algorithme de détermination de la largeur d'un objet à l'aide d'un télémètre à ultrasons et d'encodeurs en langage RobotC</a></li>
<li><a href="../fr503178/index.html">Apple Mac et appareils fantaisie. LTO, SAS, Fibre Channel, eSATA</a></li>
<li><a href="../fr503182/index.html">"Je suis le premier développeur aveugle de mon entreprise." Partie 1</a></li>
<li><a href="../fr503184/index.html">Nous vous invitons à la réunion en ligne Zabbix</a></li>
<li><a href="../fr503194/index.html">ISA ne pardonne pas les erreurs</a></li>
<li><a href="../fr503196/index.html">450 cours gratuits de la Ivy League</a></li>
<li><a href="../fr503200/index.html">YOLOv4 - le réseau neuronal en temps réel le plus précis du jeu de données Microsoft COCO</a></li>
<li><a href="../fr503204/index.html">Comment flasher Xiaomi Redmi 4 Prime / Pro / Premium sur Android 10</a></li>
<li><a href="../fr503208/index.html">Quel est le meilleur moment pour investir?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>