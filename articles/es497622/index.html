<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíë üèõÔ∏è üëß Detector autom√°tico COVID-19 de im√°genes de fluorograf√≠a üë®üèæ‚Äçüî¨ ü§òüèª üé≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En esta gu√≠a, aprender√° a detectar autom√°ticamente COVID-19 en un conjunto de datos especialmente seleccionado utilizando Keras, TensorFlow y aprendiz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detector autom√°tico COVID-19 de im√°genes de fluorograf√≠a</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta gu√≠a, aprender√° a detectar autom√°ticamente COVID-19 en un conjunto de datos especialmente seleccionado utilizando Keras, TensorFlow y aprendizaje profundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como la mayor√≠a de las personas en el mundo en este momento, estoy sinceramente preocupado por COVID-19. </font><font style="vertical-align: inherit;">Noto que comenc√© a analizar constantemente mi salud personal y sospecho que ya me he infectado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuanto m√°s me preocupa esto, m√°s se manifiesta una combinaci√≥n dolorosa de s√≠ntomas reales con hipocondr√≠a:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me despert√© por la ma√±ana, me siento un poco abrumado.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando me levant√© de la cama, ya ten√≠a una fuga de mi nariz (aunque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ahora se sabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que la secreci√≥n nasal no es un s√≠ntoma de COVID-19).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mientras llegaba al ba√±o para tomar una servilleta, tambi√©n tosi√≥.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio no le di mucha importancia a esto: soy al√©rgico al polen y, debido al clima c√°lido en la costa este, la primavera lleg√≥ a principios de este a√±o. Lo m√°s probable es que mi alergia acaba de estallar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero los s√≠ntomas no mejoraron en todo el d√≠a. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y aqu√≠ estoy sentado aqu√≠, escribiendo este manual con un term√≥metro en la boca; y mirar hacia abajo muestra 37.4 ¬∞ C. La temperatura es m√°s alta que mis 36.3 ¬∞ C habituales. Todo por encima de 37.2 ¬∞ C, ya considero un poco de fiebre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øTos y un poco de fiebre? Podr√≠a ser COVID-19 ... o simplemente mi alergia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es imposible descubrirlo sin una prueba, y es precisamente esta "ignorancia" lo que hace que esta situaci√≥n sea tan peligrosa para el equilibrio mental. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para las personas no hay nada m√°s terrible que lo desconocido.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pesar de todos los miedos, trato de deshacerme de ellos de manera racional. Tengo m√°s de treinta a√±os, estoy en buena forma, mi sistema inmunol√≥gico es muy fuerte. Ir√© a cuarentena (por si acaso), descansar√© y me recuperar√© normalmente. COVID-19 no me asusta en t√©rminos de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> salud </font><i><font style="vertical-align: inherit;">personal</font></i><font style="vertical-align: inherit;"> (al menos sigo dici√©ndome esto). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, me preocupan mis parientes mayores, incluidos los que tienen enfermedades cr√≥nicas y los que se encuentran en un hogar de ancianos o en un hospital. Son vulnerables, y ser√° realmente triste si los perdemos debido a esta infecci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para no quedarme de brazos cruzados y no sucumbir a la debilidad (ya sea alergia, COVID-19 o simplemente ansiedad), decid√≠ hacer lo que mejor hago:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servir a toda la comunidad de visi√≥n artificial y aprendizaje profundo al escribir c√≥digo, realizar experimentos y ense√±ar a otros c√≥mo usar la visi√≥n por computadora y el aprendizaje profundo en aplicaciones pr√°cticas del mundo real</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, para ser honesto, este no es el art√≠culo m√°s cient√≠fico que he escrito. </font><font style="vertical-align: inherit;">De hecho, lejos de la mayor√≠a. </font><font style="vertical-align: inherit;">Los m√©todos y conjuntos de datos utilizados no merecen publicaci√≥n. </font><font style="vertical-align: inherit;">Pero pueden ser el punto de partida para aquellos que quieren ayudar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero quiero hacer todo lo que est√© en mi poder. </font><font style="vertical-align: inherit;">Este art√≠culo es simplemente mi manera de superar mentalmente tiempos dif√≠ciles y al mismo tiempo ayudar a otros en una situaci√≥n similar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que me entiendas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la lecci√≥n de hoy haremos lo siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recopilaremos un conjunto de datos abiertos de fluorogramas de pacientes con una prueba positiva para COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recopilamos una selecci√≥n de fluorogramas de pacientes sanos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrenaremos la red neuronal convolucional para detectar autom√°ticamente COVID-19 en las im√°genes del conjunto creado.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Evaluaremos los resultados obtenidos desde un punto de vista educativo.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descargo de responsabilidad: ya lo he insinuado, pero lo dir√© sin rodeos. </font><font style="vertical-align: inherit;">Los m√©todos y t√©cnicas en este art√≠culo son solo para fines educativos. </font><font style="vertical-align: inherit;">Este no es un estudio cient√≠fico real, y no ser√° publicado en una revista. </font><font style="vertical-align: inherit;">El art√≠culo est√° dirigido a lectores que est√©n interesados ‚Äã‚Äãen (1) visi√≥n por computadora / aprendizaje profundo y quieran aprender utilizando m√©todos pr√°cticos, y (2) est√©n preocupados por los eventos actuales. </font><font style="vertical-align: inherit;">Te ruego que te relaciones con esto de esta manera.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19 en fluorogramas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la primera parte, discutimos c√≥mo se puede detectar COVID-19 en las radiograf√≠as de t√≥rax. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces considere nuestro conjunto de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, le mostrar√© c√≥mo entrenar el modelo de aprendizaje profundo utilizando Keras y TensorFlow para definir COVID-19 en nuestro conjunto de datos de im√°genes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mi tarea es inspirarlo y mostrarle que el estudio de la visi√≥n por computadora / aprendizaje profundo y luego aplicar este conocimiento en el campo de la medicina puede tener un gran impacto en el mundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En pocas palabras: no necesita un t√≠tulo m√©dico para contribuir a la medicina. Los especialistas en aprendizaje profundo que trabajan en estrecha colaboraci√≥n con m√©dicos y proveedores de atenci√≥n m√©dica pueden resolver problemas complejos, salvar vidas y hacer del mundo un lugar mejor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que esta gu√≠a te inspire a hacer exactamente eso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero con todo esto dicho, las revistas cient√≠ficas y los sistemas de evaluaci√≥n de expertos est√°n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llenos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> materiales con modelos de pron√≥stico de COVID-19 de dudosa calidad. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No tome el c√≥digo / modelo de este art√≠culo y no lo env√≠e a la revista ni lo ponga en el dominio p√∫blico en sitios cient√≠ficos, solo agregar√° algo de ruido.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Adem√°s, si tiene la intenci√≥n de utilizar este art√≠culo (o cualquier otro art√≠culo de COVID-19 de Internet) en su propia investigaci√≥n, aseg√∫rese de verificar las </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reglas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TR√çPODE para crear modelos de informes de pron√≥stico</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como probablemente sepa, el uso de la IA en la medicina tiene </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consecuencias muy reales</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Publique o use dichos modelos solo despu√©s de una estrecha consulta con un experto m√©dico.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higo. 1. Un ejemplo de un fluorograma de un paciente con una prueba positiva para COVID-19. Usando Keras y TensorFlow en tales im√°genes, es posible entrenar al clasificador para detectar COVID-19. Actualmente, las</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
pruebas de</font><i><font color="gray"><font style="vertical-align: inherit;"> COVID-19</font></font></i><font style="vertical-align: inherit;"> son dif√≠ciles de encontrar,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simplemente no son suficientes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y no se pueden hacer lo suficientemente r√°pido, lo que causa p√°nico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando hay p√°nico, algunas personas viles se aprovechan de esto y</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> venden kits de prueba falsos COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encontrando v√≠ctimas en las redes sociales y mensajeros instant√°neos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que el n√∫mero de kits de prueba COVID-19 es limitado, debe confiar en otros m√©todos de diagn√≥stico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los m√©dicos a menudo conf√≠an en las radiograf√≠as de t√≥rax (com√∫nmente llamadas fluorogramas) para diagnosticar neumon√≠a, neumon√≠a, abscesos y / o ganglios linf√°ticos agrandados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19 ataca el epitelio del tracto respiratorio, y los rayos X ayudan a examinar la condici√≥n pulmonar del paciente. Las m√°quinas de rayos X se instalan en la mayor√≠a de los hospitales, por lo que es l√≥gico usar fluorograf√≠a para probar COVID-19 sin kits de prueba especiales. La desventaja es que dicho an√°lisis requiere un especialista en radiolog√≠a y requiere un tiempo considerable. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, el desarrollo de un sistema automatizado ser√° muy valioso para ahorrar el valioso tiempo de los profesionales m√©dicos de todo el mundo. </font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Algunas publicaciones m√°s recientes sugieren que la tomograf√≠a computarizada es mejor para diagnosticar COVID-19, pero en esta lecci√≥n solo trabajamos con fluorogramas.</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conjunto de datos</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higo. </font><font style="vertical-align: inherit;">2. A la izquierda hay muestras positivas (de pacientes infectados), y a la derecha son negativas. </font><font style="vertical-align: inherit;">Estas im√°genes se utilizan para entrenar un modelo para predecir autom√°ticamente la presencia de una enfermedad.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nuestro conjunto de datos fue compilado por el</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un estudiante graduado de la Universidad de Montreal. </font><font style="vertical-align: inherit;">A principios de marzo, comenz√≥ a recolectar fluorogramas de pacientes con COVID-19, MERS, SARS y SARS y a publicarlos en el</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repositorio en GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos descargar un archivo del repositorio</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y seleccionar las l√≠neas desde donde se indica</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultado positivo en COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo de pulmones 'posterior-anterior' (PA). </font><font style="vertical-align: inherit;">Por lo que yo entiendo, este es el tipo de imagen utilizada en im√°genes "saludables".</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se encontraron un total de 25 fluorogramas con casos positivos de COVID-19 (Fig. 2, izquierda). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para pacientes sanos, utilic√© el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de datos de Cuggle (neumon√≠a)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y seleccion√© 25 im√°genes de pacientes sanos (Fig. 2, derecha). </font><font style="vertical-align: inherit;">Este conjunto de datos tiene varios problemas, a saber, etiquetas ruidosas / incorrectas, pero servir√° para una verificaci√≥n conceptual del detector autom√°tico COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estructura del proyecto</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la secci√≥n de Descargas de mi sitio web, puede ingresar su direcci√≥n de correo electr√≥nico y encontrar un enlace al archivo con c√≥digo, scripts y otros archivos para este proyecto. </font><font style="vertical-align: inherit;">Extraiga los archivos y ver√° la estructura del directorio:</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
‚îú‚îÄ‚îÄ dataset<font></font>
‚îÇ   ‚îú‚îÄ‚îÄ covid [25 entries]<font></font>
‚îÇ   ‚îî‚îÄ‚îÄ normal [25 entries]<font></font>
‚îú‚îÄ‚îÄ build_covid_dataset.py<font></font>
‚îú‚îÄ‚îÄ sample_kaggle_dataset.py<font></font>
‚îú‚îÄ‚îÄ train_covid19.py<font></font>
‚îú‚îÄ‚îÄ plot.png<font></font>
‚îî‚îÄ‚îÄ covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los fluorogramas est√°n en un directorio </font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde dos clases de datos se dividen en directorios </font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ambos scripts se presentan para crear un conjunto de datos, pero no los consideraremos hoy. </font><font style="vertical-align: inherit;">En cambio, considere una secuencia de comandos </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que ense√±a nuestro detector COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementaci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos a configurar una red neuronal convolucional. </font><font style="vertical-align: inherit;">Abra el archivo </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y pegue el siguiente c√≥digo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este script utiliza varias bibliotecas de aprendizaje profundo de TensorFlow 2.0 y Keras. </font><font style="vertical-align: inherit;">Adem√°s, utilizamos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la biblioteca est√°ndar de Python para aprendizaje autom√°tico, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para gr√°ficos y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para cargar y procesar im√°genes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para instalar TensorFlow 2.0 (incluidas las bibliotecas apropiadas de scikit-learn, OpenCV y matplotlib), solo siga mis instrucciones para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, analizaremos los argumentos de la l√≠nea de comandos e inicializaremos los hiperpar√°metros:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tres </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumentos de l√≠nea de comando</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ruta al conjunto de datos de entrada</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Una ruta opcional al horario de salida para su historial de aprendizaje. </font><font style="vertical-align: inherit;">A menos que se especifique lo contrario, el valor predeterminado es</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ruta opcional al modelo de salida; </font><font style="vertical-align: inherit;">defecto</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las siguientes l√≠neas inicializan la velocidad de aprendizaje inicial, el n√∫mero de eras y los hiperpar√°metros del tama√±o del paquete. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora estamos listos para descargar y preprocesar los fluorogramas:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para cargar datos, capturamos todas las rutas a las im√°genes en el cat√°logo </font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Luego para cada uno </font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuperamos la etiqueta de clase ( </font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">de la ruta </font><font style="vertical-align: inherit;">.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo cargamos </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y procesamos previamente, lo convertimos a RGB y lo redimensionamos a 224 √ó 224 p√≠xeles, para que est√© listo para la red neuronal.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizaci√≥n de listas </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, escale la intensidad de p√≠xeles al rango [0, 1] y convierta los datos y las etiquetas al formato de matriz NumPy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, realizamos una codificaci√≥n directa </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dividiendo los datos en conjuntos para entrenamiento / prueba:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La codificaci√≥n directa significa que los datos se convierten al siguiente formato:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada etiqueta codificada consiste en una matriz con dos elementos: 'hot' (1) o 'not' (0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, las siguientes l√≠neas separan nuestros datos, dejando un 80% para capacitaci√≥n y un 20% para pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para asegurarnos de que el modelo est√© generalizado, realizamos el aumento de los datos configurando la imagen para que gire al azar 15 ¬∞ en sentido horario o antihorario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las √∫ltimas tres l√≠neas inicializan el objeto generador de aumento de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora inicializar nuestro modelo VGGNet y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajustarlo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las primeras dos l√≠neas crean una instancia de la red VGG16 con pesos previamente entrenados en ImageNet sin tocar la capa completamente conectada (FC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego construimos una nueva capa totalmente conectada, que consta de capas </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y la agregamos encima de VGG16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego congelamos los pesos </font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para VGG16, por lo que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se entrenar√° la </font><font style="vertical-align: inherit;">capa FC. Esto completa la configuraci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora estamos listos para compilar y entrenar nuestro modelo de aprendizaje profundo para COVID-19:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las primeras l√≠neas compilan la red neuronal con la opci√≥n de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducir la velocidad de aprendizaje</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el optimizador </font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dado que este es un problema de dos clases, usamos p√©rdida en </font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lugar de entrop√≠a cruzada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comenzar el proceso de aprendizaje, llamamos al </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">en Keras</font></a><font style="vertical-align: inherit;"> , pasando los fluorogramas a trav√©s de nuestro objeto de aumento de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Evaluamos el modelo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para evaluar, primero hacemos pron√≥sticos sobre el conjunto de pruebas, preservando los √≠ndices de pron√≥stico. </font><font style="vertical-align: inherit;">Luego creamos y mostramos un informe de clasificaci√≥n usando scikit-learn, donde existe una funci√≥n auxiliar de este tipo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, calculamos la matriz de inexactitudes para una evaluaci√≥n estad√≠stica adicional:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hacemos lo siguiente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generamos una matriz de imprecisiones.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Con su ayuda, calculamos la precisi√≥n, la sensibilidad y la especificidad imprimiendo todas estas m√©tricas.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para la autocomprobaci√≥n, generamos un gr√°fico con un historial de precisi√≥n y p√©rdidas de entrenamiento, y lo enviamos a un archivo gr√°fico:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, guarde el modelo clasificador </font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el disco:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrenamiento de detectores</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de descargar todos los archivos del archivo con las fuentes y los scripts mencionados anteriormente, abra la consola y ejecute el siguiente comando para entrenar el detector:</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagn√≥stico autom√°tico de COVID-19 seg√∫n los resultados de la fluorograf√≠a.</font></font></h2><br>
<i><b>  :</b>      ,  ¬´¬ª   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se puede ver en los resultados anteriores, nuestro detector autom√°tico tiene una precisi√≥n de aproximadamente 90-92% en un conjunto de muestras existente. </font><font style="vertical-align: inherit;">Esta calificaci√≥n se basa √∫nicamente en el an√°lisis de im√°genes. </font><font style="vertical-align: inherit;">Durante el entrenamiento, no se utilizaron m√°s datos, incluida la ubicaci√≥n geogr√°fica, la densidad de poblaci√≥n, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sensibilidad fue del 100% y la especificidad del 80%, lo que significa:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los pacientes verdaderamente infectados se reconocen en el 100% de los casos.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los pacientes sanos son reconocidos como saludables con una probabilidad del 80%.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como muestra el gr√°fico del historial de entrenamiento, nuestra red no est√° demasiado capacitada, a pesar de un </font><font style="vertical-align: inherit;">conjunto de datos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muy limitado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
capacidad de reconocer COVID-19 con absoluta precisi√≥n es excelente, aunque la tasa de falsos positivos es un poco preocupante, porque muchas personas sanas ser√°n enviadas a cuarentena con pacientes realmente infectados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Equilibrar la sensibilidad y la especificidad es incre√≠blemente dif√≠cil cuando se trata de aplicaciones m√©dicas, especialmente en el caso de enfermedades infecciosas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando se trata de visi√≥n por computadora y educaci√≥n profunda en medicina, siempre debe recordar que nuestros modelos predictivos pueden tener consecuencias muy reales: un diagn√≥stico omitido puede costar la vida.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez m√°s, estos resultados se recopilan solo con fines educativos. </font><font style="vertical-align: inherit;">Este art√≠culo y los resultados que lo acompa√±an no est√°n destinados a su publicaci√≥n en una revista cient√≠fica y no cumplen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con las reglas del TR√çPODE para la creaci√≥n de modelos de informes de pron√≥stico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitaciones, mejoras y trabajos futuros.</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higo. 4. Actualmente, los especialistas en inteligencia artificial (IA) y los especialistas en aprendizaje profundo adolecen de una falta de datos de calidad para la capacitaci√≥n efectiva de los sistemas de detecci√≥n autom√°tica COVID-19 en im√°genes ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuente de imagen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Una de las principales limitaciones para crear tales sistemas son los datos. Simplemente no tenemos suficientes datos (confiables) para entrenar el detector COVID-19. Los hospitales est√°n llenos de pacientes con COVID-19, pero dados sus derechos y privacidad, es cada</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vez m√°s dif√≠cil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recopilar conjuntos de im√°genes m√©dicas de calidad de manera oportuna.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongo que en los pr√≥ximos 12-18 meses el problema se resolver√°, pero por ahora estamos contentos con lo que tenemos. Hice mi mejor esfuerzo (considerando mi condici√≥n f√≠sica y mental actual) para compilar una gu√≠a para aquellos que est√©n interesados ‚Äã‚Äãen usar la visi√≥n por computadora y el aprendizaje profundo en la lucha contra COVID-19, teniendo en cuenta las limitaciones de tiempo y recursos. Pero debo recordarle que no soy un experto m√©dico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un verdadero detector COVID-19 debe someterse a pruebas rigurosas por parte de profesionales m√©dicos capacitados que trabajen de la mano con profesionales experimentados en aprendizaje profundo. El m√©todo descrito aqu√≠, por supuesto, no es adecuado para uso pr√°ctico y est√° destinado solo para fines educativos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, debemos preguntarnos qu√© "aprende" realmente este modelo.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como dije en</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seg√∫n la gu√≠a Grad-CAM la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semana pasada, es completamente posible que nuestro modelo estudie patrones que no est√°n relacionados con COVID-19, sino que simplemente son variaciones entre dos conjuntos de datos (es decir, entre pacientes con y sin COVID-19). Para confirmar los resultados, se requieren pruebas exhaustivas y asistencia de expertos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente, los detectores futuros (y los mejores) ser√°n multimodales.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ahora </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consideramos </font><font style="vertical-align: inherit;">im√°genes (por ejemplo, rayos X). Los mejores detectores autom√°ticos COVID-19 deben usar varias fuentes de datos, no limitadas a im√°genes, incluidos signos vitales del paciente, densidad de poblaci√≥n, ubicaci√≥n geogr√°fica, etc. Las im√°genes por s√≠ solas generalmente no son suficientes para este tipo de aplicaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que esta gu√≠a sirva como punto de partida para cualquier persona interesada en usar la visi√≥n por computadora y el aprendizaje profundo para detectar autom√°ticamente COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQue sigue?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo general, finalizo los art√≠culos de mi blog con una recomendaci√≥n de uno de mis libros o cursos para que pueda aprender m√°s sobre el uso de la visi√≥n por computadora y el aprendizaje profundo. </font><font style="vertical-align: inherit;">Por respeto a la gravedad del coronavirus, no voy a hacer esto, ahora no es el momento ni el lugar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cambio, dir√© que ahora estamos en un per√≠odo de vida muy terrible. </font><font style="vertical-align: inherit;">Al igual que las estaciones, todo pasar√°, pero por ahora debes ponerte en cuclillas y prepararte para el fr√≠o invierno; es probable que lo peor est√© por venir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recib√≠ varias cartas de lectores de PyImageSearch que desean utilizar este tiempo de inactividad para estudiar la visi√≥n por computadora y el aprendizaje profundo, en lugar de volverse locos en sus hogares. </font><font style="vertical-align: inherit;">Este es un pensamiento √∫til.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta gu√≠a, aprendi√≥ a usar Keras y TensorFlow para entrenar el detector autom√°tico COVID-19 en un conjunto de fluorogramas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay conjuntos de datos de im√°genes revisados ‚Äã‚Äãpor pares de alta calidad para COVID-19 (todav√≠a), por lo que tuvimos que trabajar con lo que ten√≠amos, a saber, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el repositorio de Joseph Cohen en GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccionamos 25 im√°genes del conjunto de datos de Cohen, seleccionando solo la vista posterior-anterior (AP) y un diagn√≥stico confirmado.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luego, se seleccionaron 25 im√°genes de pacientes sanos de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un conjunto de datos con im√°genes de fluorograf√≠a de Kaggle (neumon√≠a)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilizamos Keras y TensorFlow para entrenar el detector COVID-19, que demuestra una precisi√≥n del 90-92%, una sensibilidad del 100% y una especificidad del 80% en el conjunto de prueba (dado nuestro conjunto de datos limitado). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenga en cuenta que el detector COVID-19 descrito es solo para fines educativos.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es497612/index.html">La historia de c√≥mo la mano invisible del mercado me transfiri√≥ a un lugar remoto</a></li>
<li><a href="../es497614/index.html">Experimentos de pensamiento, paradojas y l√≠mites de la l√≥gica // Estamos condenados # 2</a></li>
<li><a href="../es497616/index.html">Entrevista con Alexander Makarov (Yii) sobre Opensource, conferencias y Yii</a></li>
<li><a href="../es497618/index.html">Implementaci√≥n del concepto de acceso remoto altamente seguro</a></li>
<li><a href="../es497620/index.html">Escribir un complemento de alerta de telegrama de Chrome</a></li>
<li><a href="../es497624/index.html">Campus de banca digital - resultados del programa de pasant√≠as</a></li>
<li><a href="../es497628/index.html">C√≥mo matar mucho tiempo con un script peque√±o o el historial de una solicitud de extracci√≥n</a></li>
<li><a href="../es497632/index.html">Web HighLoad: c√≥mo gestionamos el tr√°fico de decenas de miles de dominios</a></li>
<li><a href="../es497634/index.html">Rainbow Coloring son los mejores amigos de los matem√°ticos</a></li>
<li><a href="../es497636/index.html">C√≥mo la falta de poder de c√≥mputo afect√≥ las batallas navales en las guerras mundiales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>