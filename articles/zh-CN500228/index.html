<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🏇🏽 🐄 盖茨比如何规避Next.js 👨🏾‍🚀 🛄 👴🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这篇文章的作者（我们今天出版的翻译版本）是Antler的一名程序员。这家公司是一家全球性的创业公司。每年都会在Antler举行几次演示日，汇聚了来自世界各地的许多创业者和投资者。COVID-19周围的情况迫使鹿茸将其事件转换为在线格式。
 
 
 
 该公司希望确保虚拟事件的访问者能够看到最重要的信...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>盖茨比如何规避Next.js</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/500228/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这篇文章的作者（我们今天出版的翻译版本）是Antler的一名程序员。</font><font style="vertical-align: inherit;">这家公司是一家全球性的创业公司。</font><font style="vertical-align: inherit;">每年都会在Antler举行几次演示日，汇聚了来自世界各地的许多创业者和投资者。</font><font style="vertical-align: inherit;">COVID-19周围的情况迫使鹿茸将其事件转换为在线格式。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/hq/r9/an/hqr9anmkfyicv4znlhi2ynk16rm.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该公司希望确保虚拟事件的访问者能够看到最重要的信息，而不会被任何事情分散注意力，也不会被困在任何地方。</font><font style="vertical-align: inherit;">即，将初创企业的想法呈现给公众，以网页的内容表示。</font><font style="vertical-align: inherit;">虚拟演示日可能会吸引相当多的听众。</font><font style="vertical-align: inherit;">该受众群体的某些成员可能是第一次参加这样的活动。</font><font style="vertical-align: inherit;">因此，该公司必须以最佳方式做所有事情，并提供代表初创公司的页面的高速加载。</font><font style="vertical-align: inherit;">他们认为，只有高性能的渐进式Web应用程序（PWA，渐进式Web App）可以派上用场时，情况才是如此。</font><font style="vertical-align: inherit;">主要问题是找到开发PWA的正确技术。</font></font><br>
<a name="habracut"></a><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f54/6f9/1fa/f546f91fa52e40c139cc78fe26b1ad06.gif"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器渲染还是静态网站生成器？</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，我将向您介绍该课程。我们所有的项目都基于React和Material-UI库。结果，我们最初决定不放弃该技术堆栈，这将使我们能够确保高开发速度并使新项目与我们现有的产品兼容。这个新项目与我们其他React应用程序之间的主要区别在于，它们的数据库是使用create-react-app创建的，并且已在客户端上完全呈现（CSR，客户端渲染）。特别是，这导致了这样一个事实，即在最初加载应用程序时，在项目JavaScript代码正在加载，处理和执行时，用户被迫观察空白的白屏。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要一个不折不扣的性能水平。因此，我们开始考虑使用服务器端渲染（SSR，服务器端渲染）或静态站点生成器（SSG，静态站点生成器），以便尽快加载应用程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的数据存储在Cloud Firestore中，我们使用Algolia访问它们。这使我们能够在数据库字段级别上控制使用受限API密钥对数据的公共访问。这也提高了查询性能。根据经验，我们知道Algolia查询的速度比平常快，并且压缩的Firestore JavaScript SDK大小为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">86 KB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。对于Algolia，为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.5 Kb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，我们希望使提供给客户的数据尽可能新鲜。这将帮助我们非常迅速地纠正可能会意外发布的错误数据。虽然SSG的标准做法是在项目的组装过程中实现对数据的相关请求，但我们希望在数据库中写入数据的频率很高。特别是，我们谈论的是管理员使用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">firetable</font></a><font style="vertical-align: inherit;">界面启动的数据记录</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并根据项目的创建者的倡议使用网络门户。这导致了项目的竞争性组装。此外，由于我们数据库的结构特征，较小的更改可能导致新的项目组装操作。这使我们的CI / CD管道效率极低。因此，每次用户请求加载页面时，我们都需要执行从存储库接收数据的请求。不幸的是，这意味着我们的解决方案不会成为“干净的” SSG项目的示例。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初，我们的应用程序是在Gatsby的基础上创建的，因为我们已经使用了基于Gatsby构建的登陆页面，并且其中之一已经使用了Material-UI库。</font><font style="vertical-align: inherit;">该项目的第一个版本形成了一个页面，该页面在加载数据时显示一个“骨架”。</font><font style="vertical-align: inherit;">同时，第一个合格涂料（FCP）大约在1秒内。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d75/578/718/d7557871834d0d244f8501327d68810d.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载页面的“骨架”并随后加载数据</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
该解决方案虽然很有趣，但是它有缺点，因为页面输出的数据是在客户端的主动下下载的：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要查看该页面的内容，用户必须等待该页面本身的下载以及其中显示的数据，这些数据是通过4个向Algolia的请求获得的。</font></font></li>
<li>    JS-    .   ,  React   «»      .         DOM.</li>
<li>         .  ,  ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，在一个漫长的周末中，我决定尝试使用Next.js创建的项目的SSR版本。对我来说幸运的是，Material-UI的文档中有一个Next.js的示例项目。因此，我不需要从头开始学习所有这些框架。我只需要仔细阅读本教程和文档的某些部分。我将应用程序转换为在服务器上呈现的项目。当用户请求页面加载时，服务器执行请求以填充页面所需的数据。此步骤使我们能够解决上述所有三个问题。这是两个应用程序选项的测试结果。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b60/0da/cda/b600dacda702f25e97808ed9f762ff8c.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google PageSpeed Insights</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究应用程序的结果</font><font style="vertical-align: inherit;">。左侧是Gatsby（SSG），右侧是Next.js（SSR）（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始图像</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
该项目的Next.js版本的FCP大约是其基于Gatsby的版本的FCP约3倍。该项目的Gatsby版本的Speed Index为3.3秒，而Next.js版本的为6.2秒。使用Next.js时，到第一个字节的时间（TTFB，到第一个字节的时间）为2.56秒，使用Gatsby时为10-20毫秒。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
应当注意，该站点的Next.js版本已部署到另一个服务（此处我们使用了ZEIT Now和Firebase Hosting服务-这也可能影响TTFB的增加）。但是，尽管如此，很明显，尽管所有页面资料都是在大约同一时间加载的，但将数据上传操作转移到服务器使站点显得较慢。事实是，在项目的Next.js版本中，一段时间内用户只能看到空白的白页。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e0/8a2/ab3/6e08a2ab3bcb4c06471cc92545848d8a.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该屏幕截图显示了加载应用程序的两个版本。</font><font style="vertical-align: inherit;">下载未同时完成。</font><font style="vertical-align: inherit;">按下Enter键后，记录将同步，</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
这为我们在Web开发领域提供了重要的启示：您需要为用户提供视觉反馈。</font><font style="vertical-align: inherit;">一项</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现，使用骨架屏幕的应用程序加载速度似乎更快。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而且，此结果与您阅读最近几年有关Web开发的文章时可能会产生的心情不符。</font><font style="vertical-align: inherit;">也就是说，我们正在谈论的事实是，使用客户的资源没有错，并且SSR并不是解决性能问题的全面解决方案。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静态网站生成性能：比较Gatsby和Next.js</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管考虑中的两个框架Gatsby和Next.js分别具有生成静态站点和服务器呈现的能力，但在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js 9.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中改进</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">对SSG的支持，这使其成为Gatsby的竞争对手。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在撰写本文时，Next.js生成静态站点的能力仍然很新鲜。她有一个多月了。在项目的第一页上仍会报告她。现在，对Gatsby和Next.js的SSG功能的比较不多（或者也许根本没有这样的比较）。结果，我决定进行自己的实验。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我将项目的Gatsby版本恢复到在客户端上下载数据时的状态，并进行了修改，以使应用程序的两个版本都具有完全相同的功能集。也就是说，我必须删除Gatsby插件负责的工作：SEO函数，生成网站图标，PWA清单。为了专门比较由框架创建的JavaScript包，我没有在项目中包含从外部源下载的图像和其他内容。这两个版本的应用程序均已部署在Firebase托管平台上。作为参考，基于Gatsby 2.20.9和Next.js 9.3.4创建了该应用程序的两个版本。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个版本我在计算机上运行Lighthouse 6次。结果显示，盖茨比略有优势。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82a/522/059/82a522059afba13a70e62df76144b6e6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个框架启动6个Lighthouse之后获得的平均值（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始图像</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
就整体性能评估而言，Next.js版本仅略低于Gatsby版本。 FCP和速度指数也是如此。应用程序的Next.js版本的“下一个潜在的优先输入延迟”略高于Gatsby版本。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了更好地了解正在发生的事情，我转到了Chrome开发人员工具的“网络”标签。事实证明，在该项目的Next.js版本中，将JavaScript代码拆分为的片段数比在Gatsby版本中（不包括清单文件）多3个，但压缩后的代码小了20 KB。下载这些文件所需的额外请求是否可以远远超过较小捆绑包的好处，从而损害性能？</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/d84/d9a/27bd84d9aad10ae1f3421a0f829c3fa2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在该项目的Gatsby版本中，执行了7个请求以下载379 KB数据。在该项目的Next.js版本中，有12个请求下载359 KB数据（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始图像</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果您分析JavaScript性能，则开发人员工具表示该项目的Next.js版本需要额外的300 ms才能进行首次渲染，并且该版本在“评估脚本”任务上花费了更多时间。在开发人员的工具中，该任务甚至被标记为“长期任务”。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24b/1be/11c/24b1be11c62fc6a1561a413555e53c0f.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Chrome开发人员工具的“性能”标签对不同项目选项的性能进行了分析（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始图像</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我比较了项目代码，以了解它们的实现中是否存在任何可能影响性能的差异。除了删除不必要的代码和与缺少TypeScript类型相关的更正外，唯一的区别是在移至页面的各个部分时实现了页面的平滑滚动。此功能以前是由文件引入的</font></font><code>gatsby-browser.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，已被移至</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态导入的组件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。结果，此代码只能在浏览器中运行。 （我们使用了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> smooth-scroll</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm包</font><font style="vertical-align: inherit;">，并且在导入时，他需要一个对象</font></font><code>window</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）这个问题可能是罪魁祸首，但是我只是不知道在Next.js中是如何处理的。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从开发人员的角度来看，盖茨比更方便</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我决定选择该项目的Gatsby版本。此外，在这里，我没有考虑盖茨比与Next.js SSG机制相比所表现出的很小的性能优势（我不会认真抓住0.6秒的优势吗？）。事实是，在该项目的Gatsby版本中，已经实现了许多PWA功能，并且我没有看到在应用程序的Next.js版本中再次实现它们的意义。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当我刚创建该项目的第一个盖茨比版本时，我能够快速向该项目添加一些有用的PWA功能。例如，要将SEO所需的自己的meta标签添加到每个页面，我只需要</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读手册</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。要为项目配备PWA清单，我只需要使用适当的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。为了为该项目配备支持所有可用平台的</font><font style="vertical-align: inherit;">favicon </font><font style="vertical-align: inherit;">（在这种情况下仍然是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一团糟</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），我什至无需做任何事情，因为favicon支持是负责清单的插件的一部分。很舒服！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在应用程序的Next.js版本中实现相同的功能将需要更多的工作。我将不得不寻找各种“最佳实践”的培训手册。无论如何，我会成功的事实不会给我带来任何好处。毕竟，该项目的Next.js版本在性能上与其Gatsby版本没有什么不同。另外，这就是为什么我决定直接禁用项目的Gatsby版本的相应功能，并将其与Next.js版本进行比较的原因。 Next.js文档比Gatsby文档更简洁（也许事实是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">我真的很喜欢游戏化的Next.js教程 </font><font style="vertical-align: inherit;">但是，更全面的Gatsby文档对于PWA的实际开发更有价值，尽管乍一看它看起来非常庞大。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/138/800/0101388008c84ce2dda5f6f8f522cf6d.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">盖茨比文档</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
确实，我不能对Next.js的优势保持沉默：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多亏了Next.js的教程和简洁的文档，感觉这个框架比Gatsby的学习速度更快。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js中使用的数据加载系统基于异步功能和Fetch API。</font><font style="vertical-align: inherit;">结果，在开发Next.js时，开发人员没有感觉到需要学习GraphQL才能充分利用框架的功能。</font></font></li>
<li> Next.js    TypeScript,      Gatsby        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>).     Next.js      ,     ,        ,        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于Next.js改进了对SSG的支持，因此该框架已成为功能强大的工具，允许在每个页面的层次上选择使用它的方法。</font><font style="vertical-align: inherit;">它可以是SSR，SSG或CSR。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实上，如果我能产生一个完全静态的形式这个应用程序，然后Next.js会更适合我，因为我可以用标准的Algolia JS-API，并可能继续加载数据的代码</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在同一个文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为和组件代码。</font><font style="vertical-align: inherit;">由于Algolia没有内置的GraphQL API，并且没有用于Algolia的Gatsby插件，因此在Gatsby中实现这种机制将需要将此代码添加</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到新文件中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这违背了描述页面的直观声明方式。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于提高项目绩效的其他方法</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解决了选择框架的问题后，可以注意到，还有其他一些与框架无关的改善项目绩效的方法。</font><font style="vertical-align: inherit;">这些改进很可能使Lighthouse项目的评分达到100。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三月的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algolia </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">邮件列表中，</font></a><font style="vertical-align: inherit;">建议添加提示</font></font><code>preconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以进一步提高查询执行速度。</font><font style="vertical-align: inherit;">（不幸的是，时事通讯中给出了错误的代码片段。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确的代码。）</font></font></li>
<li>    .   JS-  CSS-,  webpack- Gatsby.   Gatsby  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>   .  ,       ,   Netlify  Amazon S3. ,  Firebase Hosting,  ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们在应用程序中使用由启动创建者上传的JPEG和PNG图像。</font><font style="vertical-align: inherit;">我们不压缩和优化它们。</font><font style="vertical-align: inherit;">改善我们应用程序的这一方面是一个很大的挑战，超出了该项目的范围。</font><font style="vertical-align: inherit;">另外，如果所有这些图像都转换为WebP格式，那就太好了。</font><font style="vertical-align: inherit;">结果，我们将只能使用一种高效的图形格式存储图像。</font><font style="vertical-align: inherit;">不幸的是，与许多其他PWA功能一样，Safari WebKit开发团队对WebP支持很着迷。</font><font style="vertical-align: inherit;">现在，它是唯一</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种格式的</font><font style="vertical-align: inherit;">主流浏览器</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果我们简要总结一下我们在这里所说的话，那么我们可以这样说：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端在数据加载期间页面的“骨架”版本的输出使用户感觉到网站操作比服务器在加载数据时查看空白页面时更快。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该网站的gatsby版本仅比Next.js版本略快。</font><font style="vertical-align: inherit;">但是，Gatsby插件系统和高质量的项目文档为开发人员增加了该框架的可用性。</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">亲爱的读者们！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您是否使用静态网站生成器或服务器端渲染系统来加速项目？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN500216/index.html">忘记人类世：我们已经进入了合成时代</a></li>
<li><a href="../zh-CN500218/index.html">流行病学模型Covid-19</a></li>
<li><a href="../zh-CN500220/index.html">黑胶唱片和录音带就在您的Android中</a></li>
<li><a href="../zh-CN500222/index.html">英国第一次世界大战双翼飞机的无绳电话</a></li>
<li><a href="../zh-CN500224/index.html">DIY电子鼻</a></li>
<li><a href="../zh-CN500232/index.html">学习Akka.NET：一个简单的在线游戏的服务器</a></li>
<li><a href="../zh-CN500234/index.html">为什么我为Git + JS进行个人费用会计项目</a></li>
<li><a href="../zh-CN500238/index.html">告诉我是什么困扰着你</a></li>
<li><a href="../zh-CN500244/index.html">阵列外</a></li>
<li><a href="../zh-CN500246/index.html">保护和黑客Xbox 360（第3部分）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>