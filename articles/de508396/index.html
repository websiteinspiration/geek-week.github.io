<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈯️ 🖖🏿 🌁 Übertragung der Molekulardynamik auf CUDA. Teil I: Die Grundlagen ⚱️ 🏺 😚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Zweck dieses Artikels ist es, die Probleme der Parallelisierung des Codes eines Programms zur numerischen Modellierung unter Verwendung der Moleku...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Übertragung der Molekulardynamik auf CUDA. Teil I: Die Grundlagen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/508396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Zweck dieses Artikels ist es, die Probleme der Parallelisierung des Codes eines Programms zur numerischen Modellierung unter Verwendung der Molekulardynamik (MD) -Methode unter Verwendung der CUDA-Technologie aufzuwerfen. Warum ist dies überhaupt notwendig, da bereits MD-Softwarepakete vorhanden sind, einschließlich solcher, die mit CUDA funktionieren? Tatsache ist, dass ich mein eigenes Konzept eines „nicht konstanten Kraftfelds“ entwickle, das in bestehenden MD-Programmen nicht implementiert ist. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Neuerstellen des Codes eines anderen für diese Anforderungen ist eine ziemlich undankbare Aufgabe, daher habe ich beschlossen, meinen bereits geschriebenen sequentiellen Code zu übertragen und gleichzeitig einige Gedanken auszutauschen. Darüber hinaus ist dies eine Reaktion auf den Kommentar, der </font><font style="vertical-align: inherit;">oft hier flackert auf CUDA Artikel wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist Molekulardynamik? </font><font style="vertical-align: inherit;">Auf Habré gibt es bereits mehrere Beiträge zu diesem Thema, zum Beispiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kurz gesagt, MD ist eine Methode, mit der Sie die Bewegung vieler Partikel (einschließlich Atome, Ionen, Moleküle) simulieren und die kollektiven Eigenschaften des Systems in Abhängigkeit von dieser Bewegung berechnen können. </font><font style="vertical-align: inherit;">Wie es funktioniert? </font><font style="vertical-align: inherit;">Angenommen, für eine Menge von N Teilchen sind einige Anfangskoordinaten, Geschwindigkeiten, Massen und (am wichtigsten!) Wechselwirkungsgesetze zwischen ihnen angegeben. </font><font style="vertical-align: inherit;">Wir ändern die Koordinaten entsprechend den Geschwindigkeiten. </font><font style="vertical-align: inherit;">Basierend auf den Wechselwirkungsgesetzen berechnen wir die zwischen den Partikeln wirkenden Kräfte. </font><font style="vertical-align: inherit;">Da wir Kraft und Masse kennen, kennen wir die Beschleunigung. </font><font style="vertical-align: inherit;">Wir passen die Geschwindigkeit unter Berücksichtigung der Beschleunigung an. </font><font style="vertical-align: inherit;">Und wieder fahren wir mit dem Ändern der Koordinaten fort. </font><font style="vertical-align: inherit;">Und so wiederholen wir tausendmal, bis </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie müde werden</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir bekommen nicht genug Statistiken.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/getpro/habr/post_images/d14/4f3/4f0/d144f34f09888282c2118202bc8d201a.jpg" alt="Bild">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In realen Anwendungen ist die Abfolge der Berechnungen der „Koordinate - Geschwindigkeit - Kraft“ etwas komplizierter, basierend auf der Erweiterung der Teilchenkoordinate in eine Reihe von Funktionen. Am gebräuchlichsten ist der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocity Verlet-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algorithmus </font><font style="vertical-align: inherit;">. Der auf dem Verlet-Integrator basierende Pseudocode des MD-Programms lautet wie folgt:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">init_md;
<span class="hljs-keyword">int</span> iStep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (iStep &lt; nStep)<font></font>
{<font></font>
    reset_quantities;<font></font>
    clear_cell_list;<font></font>
    verlet_1stage;<font></font>
    forces_calculation;<font></font>
    verlet_2stage;<font></font>
    temp_scale;<font></font>
    termostat;<font></font>
    some_output;<font></font>
    iStep++;<font></font>
}<font></font>
final_md; <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptprogrammschleife führt eine benutzerdefinierte Anzahl von Malen aus ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nStep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Eine Iteration dieser Schleife wird als Zeitschritt oder einfach als Zeitschritt bezeichnet. Die Funktionen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INIT_MD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some_output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden nicht berücksichtigt. Sie lesen </font><i><font style="vertical-align: inherit;">Eingabeinformationen</font></i><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">setzen</font></i><font style="vertical-align: inherit;"> Werte auf Null, geben die Daten aus, weisen Speicher zu und geben ihn frei usw. Aus Sicht der Informationsausgabe ist die Molekulardynamik ideal für Berechnungen auf einer Grafikkarte: Die meisten Berechnungen müssen nicht entladen werden. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funktionen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_2stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beziehen sich auf den Integrator von Bewegungs- und Temperaturgleichungen. </font><font style="vertical-align: inherit;">Die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forces_Calculation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berechnet die zwischen Partikeln wirkenden Kräfte, und die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clear_cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bezieht sich auf die Technik der Beschleunigung von Berechnungen (dazu später mehr). </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie alle diese Funktionsgruppen.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Integration von Bewegungsgleichungen</font></font></h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Essenz der ersten Stufe des Verlet-Algorithmus kann durch die folgenden Formeln ausgedrückt werden:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.568ex" height="5.134ex" viewBox="0 -1455.1 9716.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-58" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2B" x="3261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-56" x="4262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-64" x="5031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-74" x="5555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2B" x="6138" y="0"></use><g transform="translate(6917,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-64" x="8377" y="0"></use><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-32" x="511" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X = X + Vdt + \frac{F}{m}dt^2</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2E" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">V = V + \frac{F}{m}\frac{dt}{2}. </script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweite:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2C" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">V = V + \frac{F}{m}\frac{dt}{2},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist X die Teilchenkoordinate, V die Geschwindigkeit, F die auf sie einwirkende Kraft, m die Masse und dt der Zeitschritt. </font><font style="vertical-align: inherit;">All dies gilt für alle Partikel und tritt natürlich in drei Dimensionen auf, also:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_1stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i, t
  <span class="hljs-keyword">float</span> charge;
  <span class="hljs-keyword">float</span> engElecField = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//     </span>
  __shared__ <span class="hljs-keyword">float</span> shEngElField;	<span class="hljs-comment">// shared   </span><font></font>
<font></font>
  <span class="hljs-comment">//    shared </span>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shEngElField = <span class="hljs-number">0</span>;<font></font>
    __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//   ,     </span>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
<font></font>
     t = md-&gt;types[i];<font></font>
     charge = md-&gt;specs[t].charge;<font></font>
<font></font>
     <span class="hljs-comment">//  v = v + f/m * 0.5 dt</span><font></font>
     md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
     md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
     md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
     <span class="hljs-comment">// x = x + v * dt</span><font></font>
     md-&gt;xyz[i].x += md-&gt;vls[i].x * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].y += md-&gt;vls[i].y * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].z += md-&gt;vls[i].z * md-&gt;tSt;<font></font>
<font></font>
     put_periodic(&amp;md-&gt;xyz[i], md-&gt;vls[i], md-&gt;masses[i], md-&gt;types[i], md);<font></font>
<font></font>
     keep_in_cell(i, md-&gt;xyz[i], md);<font></font>
<font></font>
     <span class="hljs-comment">//   </span>
     engElecField += charge * md-&gt;xyz[i].x * md-&gt;elecField.x; <span class="hljs-comment">// Eng = q * x * dU/dx</span><font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//     shared …</span><font></font>
  atomicAdd(&amp;shEngElField, engElecField);<font></font>
   __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//..    </span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)   <span class="hljs-comment">// 0th thread</span><font></font>
  {<font></font>
      atomicAdd(&amp;md-&gt;engElecField, shEngElField);<font></font>
  }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Eingabeparameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerBlock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerTherad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entsprechen der Anzahl der Partikel (Atome), die von einem Block bzw. Stream verarbeitet werden. </font><font style="vertical-align: inherit;">Da die Anzahl der Atome in solchen Berechnungen normalerweise konstant ist, können diese Variablen ein für alle Mal irgendwo in der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init_md berechnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der Parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vom </font><font style="vertical-align: inherit;">Typ * cudaMD ist eine Verknüpfung zur Struktur, die Verknüpfungen zu allen für die Berechnung erforderlichen Variablen enthält, z.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist die Anzahl der Partikel;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Array von Koordinaten vom Typ float3;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vls</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Array von Geschwindigkeiten vom Typ float3 (3 Komponenten des Vektors);</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Anordnung von Kräften (auch 3 Komponenten des Vektors);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rMasshdT-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Array </font><font style="vertical-align: inherit;">speichert </font><b><font style="vertical-align: inherit;">sofort</font></b><font style="vertical-align: inherit;"> den Ausdruck 0,5 * dt * m für jedes Partikel.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine Reihe von Partikeltypen, da Atome unterschiedlich sein können;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spezifikationsarray</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> speichert Partikeleigenschaften, Masse, Ladung usw. </font><font style="vertical-align: inherit;">Um die Eigenschaften des i-ten Partikels zu erhalten, müssen Sie die Formularspezifikation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[types [i]]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invertieren </font><font style="vertical-align: inherit;">.</font></font></li>
</ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe dies alles zu einer Struktur zusammengefasst, um nicht eine Reihe von Parametern an die Funktion zu übergeben. </font><font style="vertical-align: inherit;">Vielleicht ist dies nicht die beste Lösung? </font><font style="vertical-align: inherit;">Vielleicht hat es sich gelohnt, sie als globale Variablen zu deklarieren? </font><font style="vertical-align: inherit;">Nicht in dem Sinne, dass sie sich im globalen Speicher befinden, sondern in der Tatsache, dass sie in allen Funktionen des Programms sichtbar sind. </font></font></font><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die </font><font style="vertical-align: inherit;">Funktion </font><i><font style="vertical-align: inherit;">keep_in_cell</font></i><font style="vertical-align: inherit;"> im Abschnitt zur Beschleunigung von Berechnungen diskutieren, und die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic platziert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ein Partikel in einem simulierten Volumen (Box), wenn es aus ihm </font><i><font style="vertical-align: inherit;">herausfliegt</font></i><font style="vertical-align: inherit;"> (wie in einem Pacman, wie es treffend ausgedrückt wird)</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wagen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in seinem Beitrag über MD). </font><font style="vertical-align: inherit;">Nun, da die beschriebene Funktion eine Aktualisierung der Koordinaten der Teilchen durchführt, ist es sinnvoll, alle Energien zu berechnen, die nur von den Koordinaten abhängen, beispielsweise die Energie der Teilchen in einem externen Feld, falls vorhanden. </font><font style="vertical-align: inherit;">Im Folgenden nach einer gültigen Bemerkung</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe die Funktion aus dem Code entfernt, die Nullung von Variablen wie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engElecField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engKin entfernt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist jetzt für diese Zwecke ausgewählt </font><font style="vertical-align: inherit;">. Die Frage zur Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lautet </font><i><font style="vertical-align: inherit;">wie</font></i><font style="vertical-align: inherit;"> folgt: </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Variablen (Koordinaten, Geschwindigkeiten usw.) werden mehrmals verwendet. </font></font></font><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Ist </font></i><font color="red"><font style="vertical-align: inherit;">es ratsam, sie zuerst in einen schnelleren Speicher zu entladen? Oder kann der Compiler solche Dinge selbst optimieren?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mit der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird ein Partikel, das aus den Grenzen des simulierten Bereichs (Feld) herausfliegt, auf der anderen Seite angezeigt (periodische Randbedingungen):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">put_periodic</span><span class="hljs-params">(float3&amp; xyz, float3 vel, <span class="hljs-keyword">float</span> mass, <span class="hljs-keyword">int</span> type, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">if</span> (xyz.x &lt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
      xyz.x += md-&gt;leng.x;<font></font>
<font></font>
      atomicAdd(&amp;md-&gt;specAcBoxNeg[type].x, <span class="hljs-number">1</span>); <font></font>
      atomicAdd(&amp;md-&gt;negMom.x, mass * (-vel.x)); <font></font>
   }<font></font>
   <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> (xyz.x &gt;= md-&gt;leng.x)<font></font>
     {<font></font>
        xyz.x -= md-&gt;leng.x;<font></font>
<font></font>
        atomicAdd(&amp;md-&gt;specAcBoxPos[type].x, <span class="hljs-number">1</span>);<font></font>
        atomicAdd(&amp;md-&gt;posMom.x, mass * vel.x);<font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion funktioniert für eine Box mit der Geometrie einer rechteckigen Box. </font><font style="vertical-align: inherit;">Der Code ist für die Messung von x, der Rest der Messungen ist völlig ähnlich. </font><font style="vertical-align: inherit;">Die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revLeng Felder</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind die Kastengröße in der entsprechenden Dimension und dessen inverser Wert. </font><font style="vertical-align: inherit;">Um ein Partikel wieder in das Boxen zu bringen, können Sie im Allgemeinen auf bedingte Operatoren verzichten:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">xyz.x -= <span class="hljs-built_in">floor</span>(xyz.x * md-&gt;revLeng.x) * md-&gt;leng.x;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe in der seriellen Version bedingte Operatoren verwendet, weil ich die Anzahl der Partikel, die durch die Kastengrenze gelangen, und den Gesamtimpuls dieser Partikel zählen musste (der Druck kann daraus ausgedrückt werden). </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Zähler sind auch im obigen Code enthalten. Vielleicht müssen Sie für CUDA darüber nachdenken, wie Sie auf if verzichten können</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Teil des Verlet-Geschwindigkeitsintegrators:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_2stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i;
  <span class="hljs-keyword">float</span> kinE = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//  </span>
  __shared__ <span class="hljs-keyword">float</span> shKinE;	<span class="hljs-comment">// shared </span><font></font>
<font></font>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-comment">//     shared </span>
 <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shKinE = <span class="hljs-number">0.0</span>;<font></font>
  __syncthreads();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// v = v + f/m * 0.5 dt</span>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
    md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
    md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
    md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
    <span class="hljs-comment">//  mv2</span><font></font>
    kinE += (md-&gt;vls[i].x * md-&gt;vls[i].x + md-&gt;vls[i].y  * md-&gt;vls[i].y + md-&gt;vls[i].z * md-&gt;vls[i].z) * md-&gt;masses[i];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//      shared memory...</span>
  atomicAdd(&amp;shKinE, <span class="hljs-number">0.5</span> * kinE);   <span class="hljs-comment">// kinE = mv2/2</span><font></font>
  __syncthreads();<font></font>
  <span class="hljs-comment">//...   global memory</span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     atomicAdd(&amp;md-&gt;engKin, shKinE);<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Strukturcode ist dem ersten Teil des Integrators völlig ähnlich. Wir aktualisieren die Geschwindigkeiten für jedes Teilchen und fassen die kinetische Energie zusammen. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Temperatur" -Funktionen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Molekulare Systeme unterscheiden sich von mechanischen darin, dass sie das Konzept der Temperatur haben. MD erbte die Definition der Temperatur von der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">molekularkinetischen Theorie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wobei die Temperatur ein Wert ist, der proportional zur durchschnittlichen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">kinetischen</font></a><font style="vertical-align: inherit;"> Energie von Partikeln ist (es gibt Grund zu der Annahme, dass dies ein Irrtum ist). Um die gewünschte Temperatur so zu halten, können Sie einfach die Partikelgeschwindigkeiten skalieren, wie es die Funktion temp_scale tut:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">temp_scale</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">float</span> k;
   <span class="hljs-keyword">int</span> i;
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   k = <span class="hljs-built_in">sqrt</span>(md-&gt;teKin / md-&gt;engKin);
   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)<font></font>
   {<font></font>
      md-&gt;vls[i].x *= k;<font></font>
      md-&gt;vls[i].y *= k;<font></font>
      md-&gt;vls[i].z *= k;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
    <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;teKin;<font></font>
     }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teKin-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Feld </font><font style="vertical-align: inherit;">enthält die kinetische </font><b><font style="vertical-align: inherit;">Zielenergie</font></b><font style="vertical-align: inherit;"> und ist proportional zur vom Benutzer eingestellten Temperatur. Die Funktion multipliziert einfach alle Komponenten der Geschwindigkeitsvektoren mit k, und dann setzt ein Strom die kinetische Energie gleich dem gegebenen Wert. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier wird die Variable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in jedem Thread definiert, obwohl es möglich ist, sie in einem zu definieren (da sie gleich ist), um keine unnötige Arbeit zu leisten, insbesondere da die Quadratwurzel beteiligt ist.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine solche primitive Temperaturskalierung wird üblicherweise in den Vorstufen der Simulation (Äquilibrierungsperiode) mit einer Häufigkeit von mehreren Schritten verwendet. </font><font style="vertical-align: inherit;">Anspruchsvollere Algorithmen zur Temperaturerhaltung (Thermostate) simulieren Partikelkollisionen mit einem bestimmten Reservoir einer bestimmten Temperatur. Am beliebtesten ist der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nose-Hoover-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Thermostat </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">tstat_nose</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//   if (!blockIdx.x)</span>
<span class="hljs-comment">//     if (!threadIdx.x)   </span>
<span class="hljs-comment">//        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass;</span>
<span class="hljs-comment">//   __synctreads();</span><font></font>
<font></font>
   <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> - md-&gt;tSt * md-&gt;chit;<font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
       md-&gt;vls[i].x *= scale;<font></font>
       md-&gt;vls[i].y *= scale;<font></font>
       md-&gt;vls[i].z *= scale;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
     <span class="hljs-keyword">if</span> (!threadIdx.x)   <font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;engKin * scale * scale;<font></font>
        md-&gt;consInt += md-&gt;tSt * md-&gt;chit * md-&gt;qMassTau2;<font></font>
        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass; <font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Unterschied zur vorherigen Funktion besteht nur in einer komplexeren Definition des Korrekturfaktors. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Gruppe von Funktionen zusammenzufassen. </font><font style="vertical-align: inherit;">Alle von ihnen sind perfekt parallelisiert, nicht nur, weil sie für alle Partikel genau die gleichen Aktionen ausführen, sondern auch, weil sie keine Querverweise erfordern. </font><font style="vertical-align: inherit;">Der Stream, der Arrays mit Index i verarbeitet, greift nicht auf Index j zu, es besteht kein Zugriffskonflikt auf dieselben Daten.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Berechnung der Kräfte und Liste der Zellen</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In molekularen Systemen sind andere Partikel die Hauptkraftquelle, die auf das Teilchen wirkt (mit Ausnahme der bereits erwähnten äußeren Felder). </font><font style="vertical-align: inherit;">Die Berechnung dieser Kräfte ist der komplexeste, zeitaufwändigste und mehrdeutigste Teil der MD. </font><font style="vertical-align: inherit;">Eine der einfachsten Näherungen ist, dass alle Wechselwirkungen im System die Summe der Wechselwirkungen zwischen JEDEM Teilchenpaar sind (paarweise Näherung). </font><font style="vertical-align: inherit;">Zu diesem Zweck wird ein Paarpotential eingeführt - eine funktionale Abhängigkeit der potentiellen Wechselwirkungsenergie zweier Teilchen vom Abstand zwischen ihnen. </font><font style="vertical-align: inherit;">Die bekanntesten Paarpotentiale: das Potenzial von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lennard-Jones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (oder "6-12"), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buckingham</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Born-Mayer-Huggins. </font><font style="vertical-align: inherit;">Zum Beispiel werde ich die analytischen Ausdrücke der ersten beiden geben:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mn>4</mn><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>&amp;#x2212;</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.901ex" height="5.634ex" viewBox="0 -1616.6 8137.9 2425.9" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-34" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-3F5" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-28" x="3008" y="0"></use><g transform="translate(3398,0)"><g transform="translate(120,0)"><rect stroke="none" width="1146" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-36" x="810" y="513"></use></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2212" x="5007" y="0"></use><g transform="translate(5785,0)"><g transform="translate(342,0)"><rect stroke="none" width="1500" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-3C3" x="0" y="0"></use><g transform="translate(572,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-32" x="500" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-29" x="7748" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mn>4</mn><mi>ϵ</mi><mo stretchy="false">(</mo><mfrac><msup><mi>σ</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>−</mo><mfrac><msup><mi>σ</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">U=4\epsilon(\frac{\sigma^6}{r^6}-\frac{\sigma^{12}}{r^{12}})</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mi>r</mi><mi>&amp;#x03C1;</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.645ex" height="5.634ex" viewBox="0 -1455.1 9750.1 2425.9" role="img" focusable="false" style="vertical-align: -2.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-41" x="2101" y="0"></use><g transform="translate(3018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-28" x="4548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2212" x="4937" y="0"></use><g transform="translate(5716,0)"><g transform="translate(120,0)"><rect stroke="none" width="637" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-72" x="93" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-3C1" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-29" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2212" x="7205" y="0"></use><g transform="translate(7983,0)"><g transform="translate(342,0)"><rect stroke="none" width="1025" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-43" x="132" y="676"></use><g transform="translate(60,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhjn4Kat8n2VfKZZNv6ooDO5DXOFQ#MJMAIN-2C" x="9471" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mfrac><mi>r</mi><mi>ρ</mi></mfrac><mo stretchy="false">)</mo><mo>−</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">U=A\exp(-\frac{r}{\rho})-\frac{C}{r^6},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist U die potentielle Energie eines Partikelpaares, r der Abstand zwischen Partikeln und alle anderen Buchstaben sind Parameter, die nur von der Art der wechselwirkenden Partikel abhängen und in der Initialisierungsphase festgelegt werden. Noch mehr als Energie interessieren uns jedoch die Wechselwirkungskräfte zwischen diesen Partikeln. Die Kräfte sind trivial, durch die Ableitung des Paarpotentials, für das es auch leicht ist, einen analytischen Ausdruck zu erhalten und in das Programm zu nähen. Und da die Wirkkraft gleich der Stärke der Reaktion ist, erhalten wir sofort die Kräfte, die auf beide Teilchen wirken, voneinander, Pseudocode:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">U = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)
	<span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; N<span class="hljs-number">-1</span>; j++)<font></font>
	{<font></font>
		dx = x[i] – x[j];<font></font>
		dy = y[i] – y[j];<font></font>
		dz = z[i] – z[j];<font></font>
		r = <span class="hljs-built_in">sqrt</span>(dx*dx + dy*dy + dz*dz);<font></font>
		U += pair_pot(r, types[i], types[j]);<font></font>
		F = force(r, types[i], types[j])<font></font>
		fx[i] = F * dx;<font></font>
		fx[j] = -F * dx;<font></font>
		fy[i] = F * dy;<font></font>
		fy[j] = -F * dy;<font></font>
		fz[i] = F * dz;<font></font>
		fz[j] = -F * dz;<font></font>
<font></font>
	}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Code ist einfach: Wir finden den Abstand zwischen den Partikeln, ersetzen ihn in der Funktion für das Paarpotential und in der Funktion für die Kraft (beide hängen von der Art der wechselwirkenden Partikel ab) und berechnen die Projektion der Kräfte. Der Zyklus wird N (N-1) / 2 Mal durchgeführt, wobei N die Anzahl der Partikel ist. Um die Anzahl der Berechnungen zumindest irgendwie zu reduzieren, können wir die Tatsache ausnutzen, dass der Wert dieser Potentiale mit der Entfernung schnell abnimmt. Bei Abständen von mehr als 6-8 Angström kann das Potential nicht berechnet werden, es wird fast Null sein. Durch Hinzufügen der Bedingung zum Überprüfen des Abstands (oder vielmehr seines Quadrats) wird die Anzahl der Berechnungen verringert, nicht jedoch die Anzahl der Iterationen des Zyklus. Bei großen Systemen ergeben die meisten Überprüfungen false. Die folgenden Techniken können die Anzahl von Überprüfungen reduzieren, indem ein Teil von Paaren mit einem bekannten großen interatomaren Abstand fallengelassen wird.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt zwei Hauptmethoden, um die Anzahl der Suchvorgänge nach Partikelpaaren zu verringern: eine Liste der Nachbarn (auch als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verlet-Liste bezeichnet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) und eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der Zellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Zellenliste). Im ersten Fall erinnern wir uns für jedes Teilchen an seine Nachbarn, die sich im Radius des Potentials befinden. Die Liste der Nachbarn muss mit einer bisher unbekannten Periodizität aktualisiert werden, was der Nachteil der Methode ist. Lassen Sie uns daher auf die Liste der Zellen eingehen, deren Kern darin besteht, das simulierte Volumen (Feld) in (Unter-) Zellen aufzuteilen. Anfänglich wurde die Zellengröße so gewählt, dass sie größer oder gleich dem Grenzradius ist. Dann reicht es aus, die Partikelpaare in jeder Zelle und zwischen benachbarten Zellen zu sortieren. Die Zellengröße kann unterschiedlich sein. Die Hauptsache besteht darin, zu bestimmen, welche Zellpaare Sie überprüfen müssen. Tatsächlich ist dies ein Versuch, die Kugel in Würfeln zu beschreiben. Um eine Liste von Zellen in sequentiellem Code zu implementieren, werden traditionell zwei Arrays eingeführt, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die Größe der ersten entspricht der Anzahl der Zellen, die zweite der Anzahl der Partikel. </font><font style="vertical-align: inherit;">Der erste speichert den Index eines der Partikel in einer bestimmten Zelle, die Indizes des zweiten entsprechen den Indizes der Partikel und der Inhalt entspricht dem Index des nächsten Partikels in der Zelle (-1, wenn sich keine Partikel mehr in der Zelle befinden). Die Abbildung ist unten angegeben. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/tu/bw/hu/tubwhuvbci2oc2uxlupu3nt4zsc.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Pseudocode zum Durchlaufen einer solchen Liste innerhalb einer Zelle mit dem Index cell_index:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">i = head[cell_index];
<span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
{<font></font>
      j = <span class="hljs-built_in">list</span>[i];
      <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
              i-j;<font></font>
           j = <span class="hljs-built_in">list</span>[j];<font></font>
      }<font></font>
i = <span class="hljs-built_in">list</span>[i]; <font></font>
}	<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir nun, eine Liste von Zellen in CUDA zu implementieren. </font><font style="vertical-align: inherit;">In der nullten Näherung verteilen wir einfach einen Bereich von Zellen auf jeden Strom, andernfalls belassen wir einen sequentiellen Code zum Aufzählen von Partikelpaaren innerhalb der Zelle und von Paaren, an denen Partikel benachbarter Zellen beteiligt sind. </font><font style="vertical-align: inherit;">Für jede Zelle muss ein Array benachbarter Zellen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lstHNeig [iC] [jC]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die Anzahl dieser Nachbarn, ein Array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nHeadNeig [],</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> definiert werden </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cellPerBlock, <span class="hljs-keyword">int</span> cellPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iC, jC;	<span class="hljs-comment">//  </span>
   <span class="hljs-keyword">int</span> i, j;	<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * cellPerBlock + threadId.x * cellPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">for</span> (iC = id0; iC &lt; N; iC++)<font></font>
   {<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         <span class="hljs-comment">//    </span><font></font>
         j = md-&gt;clist[i]; 	<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
               i-j;<font></font>
            j = md-&gt;clist[j];  <font></font>
         }<font></font>
<font></font>
         <span class="hljs-comment">//    </span>
         <span class="hljs-keyword">for</span> (jC = <span class="hljs-number">0</span>; jC &lt; md-&gt;nHeadNeig[iC]; jC++)<font></font>
         {<font></font>
            j = md-&gt;chead[md-&gt;lstHNeig[iC][jC]];<font></font>
            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                  i-j;    <font></font>
               j = md-&gt;clist[j];<font></font>
            }<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meiner Meinung nach zeigt eine solche Implementierung das Potenzial einer Grafikkarte nicht vollständig auf, da ein einzelner Stream eine Zelle verarbeitet, was in der Regel erheblich weniger ist als die Anzahl der Partikel. Zweitens ist es innerhalb der Funktion der Verarbeitung eines Partikelpaares möglich, nur durch atomare Operationen zu arbeiten. Versuchen wir, die Aufgabe stärker zu parallelisieren, und lassen Sie jeden Thread ein Paar benachbarter Zellen verarbeiten (wir glauben, dass bereits eine Liste solcher Paare erstellt wurde):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pairPerBlock, <span class="hljs-keyword">int</span> pairPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, jC;	<span class="hljs-comment">//     </span>
   <span class="hljs-keyword">int</span> i, j;		<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * pairPerBlock + threadId.x * pairPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (iP = id0; iC &lt; N; iP++)<font></font>
   {<font></font>
      iC = md-&gt;cellPairs[iP].x;<font></font>
      jC = md-&gt;cellPairs[iP].y;<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         j = md-&gt;chead[jC];<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
                i-j;<font></font>
             j = md-&gt;clist[j];<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellPairs []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enthält die Anzahl der Paare benachbarter Zellen (.x ist die erste Zelle des Paares, .y ist die zweite). Der Code ist einfacher und eleganter, aber hier verschwindet die Verarbeitung von Partikelpaaren innerhalb einer Zelle, für die eine separate Funktion geschrieben werden muss. Es gibt ein weiteres Problem: Die Organisation der Liste der Zellen und deren Durchforsten sind für die parallele Berechnung ineffizient, da Sie alle vorherigen Partikel durchlaufen müssen, um den Index des nächsten Partikels in der Zelle zu erhalten. Versuchen wir, eine effizientere Code- und Datenstruktur zu erstellen, damit mehrere Zellen von mehreren Threads gleichzeitig verarbeitet werden können. Lassen Sie nun die Liste der Zellen in einer zweidimensionalen Array- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zelle [] []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gespeichert werden </font><font style="vertical-align: inherit;">, wobei der erste Index die Nummer der Zelle und der zweite die Ordnungszahl innerhalb der Zelle definiert. Ich speichere auch die Anzahl der Partikel in einer Zelle im Nullelement des Arrays:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zelle [i] [0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Wert von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zelle [i] [j + 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gleich dem allgemeinen Index des Partikels im globalen Speicher. Eine solche Implementierung erfordert zwar die Kenntnis der maximalen Anzahl von Partikeln in einer Zelle und beansprucht mehr Speicher. Wir werden unsere Aufgabe auch in 2 Unteraufgaben aufteilen. Die erste Funktion berechnet die Interaktion in disjunkten Zellpaaren (z. B. mit den Indizes 0-1, 2-3, 4-5 usw.) und innerhalb der Zellen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2a</span><span class="hljs-params">(cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, iCA, iCB, step, step1; 
   <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;
   <span class="hljs-keyword">int</span> id;
   <span class="hljs-keyword">int</span> nA, nB, nOwn;  
   <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;		<span class="hljs-comment">//   </span><font></font>
<font></font>
   <span class="hljs-comment">//  --        </span>
   __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
   <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
   <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
<span class="hljs-comment">//   shared </span>
  <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      
  <span class="hljs-keyword">int</span>* sAids = shMem;		<span class="hljs-comment">//     1 (   )</span>
  <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell]; <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     2 (B)</span>
  <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
  <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
  float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
  float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
   <span class="hljs-comment">//   ,    </span><font></font>
   float3 *sXyz;<font></font>
   float3 *sFrs;<font></font>
   <span class="hljs-keyword">int</span> *sTypes;
   <span class="hljs-keyword">int</span> *sIds;<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   iCA = md-&gt;cellPairs[blockIdx.x].x;  <span class="hljs-comment">//   </span>
   iCB = md-&gt;cellPairs[blockIdx.x].y;  <span class="hljs-comment">//   B</span><font></font>
<font></font>
   <span class="hljs-comment">//    -- </span>
  <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      shared_memory</span>
   <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>) <span class="hljs-comment">//!       A,  -   B. ,     </span><font></font>
     {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
     }<font></font>
   <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
     }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
   nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
   nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA  nB</span><font></font>
<font></font>
   <span class="hljs-comment">//   ,     </span>
  step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
   id0 = (threadIdx.x - deltId) * step;<font></font>
   N = min(id0 + step, nOwn);<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
      id = md-&gt;cells[iC][i+<span class="hljs-number">1</span>];<font></font>
      sIds[i] = id;		<span class="hljs-comment">//   </span>
      sXyz[i] = md-&gt;xyz[id];	<span class="hljs-comment">//  </span>
      sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <span class="hljs-comment">//  </span><font></font>
   sTypes[i] = md-&gt;types[id];<font></font>
   }<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//        i=0  j=1,    j     </span>
   i = <span class="hljs-number">0</span>;<font></font>
   j = threadIdx.x – deltId + <span class="hljs-number">1</span>;<font></font>
   step1 = blockDim.x / <span class="hljs-number">2</span>;
   <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
   {<font></font>
      <span class="hljs-keyword">while</span> (j &gt;= nOwn)<font></font>
      {<font></font>
          i++;<font></font>
          <span class="hljs-keyword">if</span> (i &gt;= nOwn<span class="hljs-number">-1</span>)<font></font>
          {<font></font>
              ex = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">break</span>;<font></font>
          }<font></font>
          j = i + <span class="hljs-number">1</span> + j - nOwn;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
      pair_in_cell(sXyz[i], @sFrs[i], sTypes[i], sXyz[j], @sFrs[j], sTypes[j], md, eVdW, eCoul);<font></font>
      j = j + step1;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span><font></font>
   step1 = ceilf(nA / blockDim.x);<font></font>
   id1 = threadIdx.x * step1;<font></font>
   N1 = min(id1 + step1, nA);<font></font>
   <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
     <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
       pair_between_cell(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[blockId.x], md, eVdW, eCoul);<font></font>
<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
       md-&gt;frs[sIds[i]] = sFrs[i];<font></font>
<font></font>
   <span class="hljs-comment">//     </span><font></font>
   atomicAdd(&amp;engCoul, eCoul);<font></font>
   atomicAdd(&amp;engVdw, eVdW);<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">if</span> (!threadIdx.x) <font></font>
   {<font></font>
      atomicAdd(&amp;md-&gt;engCoul, engCoul);  <font></font>
      atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
   }<font></font>
}<font></font>
 </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variablen der Form </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float3PerCell</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind das Produkt der maximalen Anzahl von Partikeln in einer Zelle nach der Größe des Typs float3. Es ist sinnvoll, sie während der Systeminitialisierung einmal zu berechnen. Die </font><i><font style="vertical-align: inherit;">Funktionen </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berechnen Wechselwirkungen zwischen Partikeln in derselben bzw. in verschiedenen Zellen. Als Parameter erhalten sie die Koordinaten der Partikel, ihre Typen und Zeiger, wo Kräfte geschrieben werden sollen. Parameter für </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie auch die Größe der Verschiebungen an, um die periodischen Randbedingungen zu berücksichtigen. Codes für diese Funktionen werden unten angegeben. Um die Partikelpaare in der Zelle zu sortieren, wollte ich den Standardweg gehen - die Anzahl der Paare in gleiche Intervalle teilen und jedem Stream ein Intervall geben. Um jedoch die Partikelindizes ij anhand der Paarzahl zu erhalten, habe ich mir die quadratische Gleichung ausgedacht und beschlossen, dies anders zu machen: Der erste Thread verarbeitet ein Partikelpaar mit den Indizes 0-1, der zweite - 0-2 usw. Nachdem das ij-Paar verarbeitet wurde, geht der Fluss zum i- (j + N) -Paar, wobei N die Anzahl der Flüsse im Block ist. Wenn er die Bereichsgrenze überschreitet, erhöht er den Index des ersten Partikels im Paar, siehe Abbildung:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/fv/-h/qa/fv-hqah4yeuzhpa9jbidswkmse8.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Aufzählung von Paaren zwischen verschiedenen Zellen ist wie folgt: Alle Flüsse erhalten ihr Intervall der Partikelindizes aus Zelle A und berechnen die Wechselwirkungen zwischen diesen Partikeln und allen Partikeln in Zelle B. Die zweite Funktion berechnet die Wechselwirkungen in allen verbleibenden Paaren:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2b</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> iPair, iC, iCA, iCB, step, step1; 
    <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;    
    <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">int</span> nA, nB, nOwn; <font></font>
<font></font>
    __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
    <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      <span class="hljs-comment">// declaration of shared memory</span>
    <span class="hljs-keyword">int</span>* sAids = shMem;
    <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell];<font></font>
    float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell];<font></font>
    <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
    <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
    float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
    float3* sXyz;<font></font>
    float3* sFrs;  <font></font>
    <span class="hljs-keyword">int</span>* sTypes;
    <span class="hljs-keyword">int</span>* sIds;<font></font>
<font></font>
    iPair = blockIdx.x + md-&gt;nPair1;<font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    iCA = md-&gt;cellPairs[iPair].x; <font></font>
    iCB = md-&gt;cellPairs[iPair].y;<font></font>
    nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
    nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
    <font></font>
    <span class="hljs-comment">//    ,        </span>
    <span class="hljs-keyword">if</span> (!nA)
       <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!nB)
        <span class="hljs-keyword">return</span>;<font></font>
<font></font>
    <span class="hljs-comment">//      shared_memory</span>
    <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>)<font></font>
    {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
    }<font></font>
    nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA or nB</span><font></font>
<font></font>
    step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id0 = (threadIdx.x - deltId) * step;<font></font>
    N = min(id0 + step, nOwn);<font></font>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        id = md-&gt;cells[iC][i + <span class="hljs-number">1</span>];<font></font>
        sIds[i] = id;     <font></font>
        sXyz[i] = md-&gt;xyz[id];    <font></font>
        sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <font></font>
        sTypes[i] = md-&gt;types[id];<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    step1 = ceilf((<span class="hljs-keyword">double</span>)nA / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id1 = threadIdx.x * step1;<font></font>
    N1 = min(id1 + step1, nA);<font></font>
    <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
        {<font></font>
            pair_between_cell1(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[iPair], md, eVdW, eCoul);<font></font>
<font></font>
        }<font></font>
    __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].x), sFrs[i].x);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].y), sFrs[i].y);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].z), sFrs[i].z);<font></font>
    }<font></font>
<font></font>
    atomicAdd(&amp;engCoul, eCoul);<font></font>
    atomicAdd(&amp;engVdW, eVdW);<font></font>
    __syncthreads();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        atomicAdd(&amp;md-&gt;engCoul1, engCoul);<font></font>
        atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Code ähnelt fast der vorherigen Funktion, nur die verbleibenden Paare werden jetzt verarbeitet (der Index des Paares wird um </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; nPair1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verschoben </font><font style="vertical-align: inherit;">), die Interaktion wird nur zwischen dem </font><b><font style="vertical-align: inherit;">Zellenpaar</font></b><font style="vertical-align: inherit;"> (das bereits in den Zellen gezählt ist) berechnet, und beim Kopieren in den globalen Speicher verwenden wir atomicAdd, um die Ergebnisse zusammenzufassen und nicht zu überschreiben Sie. </font><font style="vertical-align: inherit;">Jetzt bringe ich die restlichen Funktionen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">keep_in_cell</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, float3 xyz, cudaMD* md)</span>
<span class="hljs-comment">//  index    xyz  cell list</span>
</span>{
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">int</span> c = <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.x / (<span class="hljs-keyword">double</span>)md-&gt;cSize.x) * md-&gt;cnYZ + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.y / (<span class="hljs-keyword">double</span>)md-&gt;cSize.y) * md-&gt;cNumber.z + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.z / (<span class="hljs-keyword">double</span>)md-&gt;cSize.z);<font></font>
<font></font>
    <span class="hljs-keyword">int</span> j = atomicAdd(&amp;(md-&gt;cells[c][<span class="hljs-number">0</span>]), <span class="hljs-number">1</span>);<font></font>
    md-&gt;cells[c][j + <span class="hljs-number">1</span>] = index;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basierend auf den Koordinaten berechnen wir den Index der Zelle, in die dieses Partikel eintritt. Wir erhöhen den Partikelzähler in dieser Zelle. Wir schreiben den Partikelindex in eine neue Zelle. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist die Zellengröße, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cnYZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist das Produkt der Anzahl der Zellen in den Y- und Z-Messungen. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es kann sinnvoll sein</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , den </font><b><font style="vertical-align: inherit;">Zellindex </font></b><font color="red"><font style="vertical-align: inherit;">nicht zu berechnen, sondern sie als dreidimensionales Array im Texturspeicher unter Verwendung von Indizes der Form [x / md-&gt; cSize.x zu speichern ]. Wird es einen Leistungsschub geben?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Funktionen zur Berechnung von Interaktionen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_in_cell</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x; <font></font>
    dy = xyzA.y - xyzB.y;<font></font>
    dz = xyzA.z - xyzB.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-comment">//if (r2 &lt;= sim-&gt;r2Max)    </span>
    <span class="hljs-comment">//{</span>
    r = <span class="hljs-number">0.0</span>;<font></font>
    f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul);<font></font>
<font></font>
    <span class="hljs-comment">// -- </span><font></font>
    vdw = md-&gt;vdws[typeA][typeB];<font></font>
    <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
        <span class="hljs-comment">//if (r2 &lt;= vdw-&gt;r2cut)   //!      </span><font></font>
            f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
    <span class="hljs-comment">//      atomic,        </span><font></font>
    atomicAdd(&amp;(fxyzA-&gt;x), f * dx);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;y), f * dy);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;z), f * dz);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    <span class="hljs-comment">//}</span><font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir berechnen den Abstand zwischen den Partikeln, setzen ihn zuerst in die Funktion für das Coulomb und dann für die Van-der-Waals-Wechselwirkung ein. Wenn die Zellengröße so gewählt wird, dass ihre Diagonale den Bereich der kürzesten Art der Interaktion nicht überschreitet, können Entfernungsprüfungen entfernt werden (ich habe sie ausdrücklich im Code auskommentiert). Ich </font><i><font style="vertical-align: inherit;">stelle</font></i><font style="vertical-align: inherit;"> fest, dass ich hier das Quadrat der Entfernung ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">berechne </font><font style="vertical-align: inherit;">und die Entfernung ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) selbst in der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berechnet wird </font><font style="vertical-align: inherit;">. Das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array chProd [i] [j]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> speichert das Produkt der Ladungen der entsprechenden Partikeltypen. Vielleicht sollte es auch im Texturspeicher abgelegt werden. Die vdw-Struktur speichert gepaarte potentielle Parameter und einen Funktionszeiger ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feng_r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), um die Van-der-Waals-Wechselwirkung zu berechnen. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funktion zur Berechnung von Wechselwirkungen zwischen zwei verschiedenen Zellen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_between_cell1</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, float3 shift, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x - shift.x;<font></font>
    dy = xyzA.y - xyzB.y - shift.y;<font></font>
    dz = xyzA.z - xyzB.z - shift.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)<font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul); <font></font>
<font></font>
        vdw = md-&gt;vdws[typeA][typeB];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
<font></font>
        fxyzA-&gt;x += f * dx;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
        fxyzA-&gt;y += f * dy;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
        fxyzA-&gt;z += f * dz;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Code ist fast identisch mit der vorherigen Funktion, es gibt eine Korrektur der Koordinatendifferenz, um periodische Randbedingungen zu berücksichtigen, Abstandsprüfungen sind nicht kommentiert, und wie wir uns aus den Funktionen der Funktionsgruppe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erinnern, </font><font style="vertical-align: inherit;">besteht keine Notwendigkeit, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atomicAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf Zelle A </font><font style="vertical-align: inherit;">anzuwenden </font><font style="vertical-align: inherit;">, da die darin enthaltenen Partikel unabhängig verarbeitet werden. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich stelle fest, dass Sie abhängig von der Entfernung zwischen bestimmten Zellen in einem Paar einige Entfernungsprüfungen und Berechnungen weglassen können. </font><font style="vertical-align: inherit;">Dazu können Sie leicht unterschiedliche Versionen dieser Funktion schreiben. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich gebe auch Funktionen an, die die Kräfte und Energien von Paarpotentialen für das Potential von Lennard-Jones und Buckingham berechnen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fe_lj</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = 4e[(s/r)^12 - (s/r)^6]</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> sr2 = vdw-&gt;p1 * r2i;
    <span class="hljs-keyword">float</span> sr6 = sr2 * sr2 * sr2;<font></font>
<font></font>
    eng += vdw-&gt;p0 * sr6 * (sr6 - <span class="hljs-number">1.0</span>);
    <span class="hljs-keyword">return</span> vdw-&gt;p2 * r2i * sr6 * (<span class="hljs-number">2.0</span> * sr6 - <span class="hljs-number">1.0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fer_buck</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = A exp(-r/ro) - C/r^6</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> r4i = r2i * r2i;
    <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0.0</span>)    <span class="hljs-comment">//  r , </span>
        r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
<font></font>
    eng += vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) - vdw-&gt;p2 * r4i * r2i;
    <span class="hljs-keyword">return</span> vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) / r / vdw-&gt;p1 - <span class="hljs-number">6.0</span> * vdw-&gt;p2 * r4i * r4i;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktionen geben die Kraft zurück (die mit der Projektion des Distanzvektors multipliziert werden muss) und addieren Energie zur Variablen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ein Zeiger auf eine dieser Funktionen ist in der cudaVdW-Struktur gespeichert. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Allgemeinen kann Energie nicht berechnet werden, um Bewegungsbahnen zu erhalten. Sie wird für verschiedene Statistiken benötigt. Wenn wir die Energieausdrücke aus diesen Funktionen entfernen, werden sich die Berechnungen wahrscheinlich beschleunigen. Und Sie können dies tun: einmal ein paar Schritte, um die volle Funktion aufzurufen, und den Rest der Zeit - nur ein reduziertes Analog.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ein Teil der Coulomb-Interaktion wird von der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berechnet </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">real_ewald</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, <span class="hljs-keyword">float</span> chprd, <span class="hljs-keyword">float</span> alpha, <span class="hljs-keyword">float</span>&amp; eng)</span>
</span>{
    <span class="hljs-keyword">float</span> ar; 
    <span class="hljs-keyword">float</span> erfcar;
    <span class="hljs-keyword">float</span> kqq = chprd * d_Fcoul_scale; <span class="hljs-comment">// q[i]*q[j]*1/4pie0;</span><font></font>
<font></font>
    r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
    ar = alpha * r;<font></font>
    erfcar = erfc(ar);<font></font>
<font></font>
    eng += kqq * erfcar / r;<font></font>
    <span class="hljs-keyword">return</span> kqq / r / r2 * (erfcar + <span class="hljs-number">2</span> * ar / d_sqrtpi * <span class="hljs-built_in">exp</span>(-ar * ar));<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies unterscheidet sich vom bekannten Coulomb-Gesetz, aber mehr dazu in einem separaten Artikel. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tests mit einem realen Beispiel zeigten, dass sich in einem Zellenpaar nur sehr wenige Partikel befinden, um alle dem Block zugewiesenen Flüsse zu laden. Eine weitere Optimierung der Funktionen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> besteht darin, mehrere Paare gleichzeitig in einem Block zu verarbeiten. Bisher habe ich nur die einfachste Version geschrieben, bei der die Flüsse einfach in mehrere Zellenpaare unterteilt sind, d. H. Ein Block verarbeitet nicht ein Paar, aber sagen wir 4: 0-1, 1-2, 3-4, 5-6. Möglicherweise stellen Sie fest, dass in diesem Fall beim Laden der Daten in den gemeinsam genutzten Speicher gleichzeitig die Paare 0-2, 0-3, 0-4 usw. verarbeitet werden können. Dies erfordert jedoch zusätzliche Tricks bei der Vorbereitung der Daten, die ich noch nicht durchdacht habe. Auch wenn in der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Paare mit einer gemeinsamen Zelle laden (z. B. 0-2, 0-3, 0-4 usw.), können Sie die Anzahl der Aufrufe in den globalen Speicher reduzieren, indem Sie Daten nur einmal aus Zelle 0 kopieren. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu überprüfen, ob bei der Implementierung von Zelllistenalgorithmen alles richtig funktioniert, habe ich auch eine Funktion geschrieben, die Interaktionen auf naive Weise berechnet und einfach alle Paare sortiert:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">all_pair</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> i, j;
    <span class="hljs-keyword">int</span> step = blockDim.x * gridDim.x;
    <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// exit flag</span>
    <span class="hljs-keyword">int</span> nAt = md-&gt;nAt;<font></font>
<font></font>
    i = <span class="hljs-number">0</span>;<font></font>
    j = blockIdx.x * blockDim.x + threadIdx.x + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">while</span> (j &gt;= nAt)<font></font>
        {<font></font>
            i++;<font></font>
            <span class="hljs-keyword">if</span> (i &gt;= nAt - <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ex = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            j = i + <span class="hljs-number">1</span> + j - nAt;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
        global_pair(i, j, iStep, md);<font></font>
        j = j + step;<font></font>
    }<font></font>
} <font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">global_pair</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> engCoul = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">float</span> engVdw = <span class="hljs-number">0</span>;<font></font>
    cudaVdW* vdw;<font></font>
    <span class="hljs-keyword">int</span> ti, tj;<font></font>
<font></font>
    <span class="hljs-keyword">float</span> dx = md-&gt;xyz[i].x - md-&gt;xyz[j].x;
    <span class="hljs-keyword">float</span> dy = md-&gt;xyz[i].y - md-&gt;xyz[j].y;
    <span class="hljs-keyword">float</span> dz = md-&gt;xyz[i].z - md-&gt;xyz[j].z;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">if</span> (dx &gt; md-&gt;halfLeng.x)<font></font>
        dx -= md-&gt;leng.x;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dx &lt; -md-&gt;halfLeng.x)<font></font>
            dx += md-&gt;leng.x;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dy &gt; md-&gt;halfLeng.y)<font></font>
        dy -= md-&gt;leng.y;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dy &lt; -md-&gt;halfLeng.y)<font></font>
            dy += md-&gt;leng.y;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dz &gt; md-&gt;halfLeng.z)<font></font>
        dz -= md-&gt;leng.z;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dz &lt; -md-&gt;halfLeng.z)<font></font>
            dz += md-&gt;leng.z;<font></font>
<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)    <font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        ti = md-&gt;types[i];<font></font>
        tj = md-&gt;types[j];<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[ti][tj], md-&gt;alpha, engCoul);<font></font>
<font></font>
        vdw = md-&gt;vdws[ti][tj];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw); <font></font>
<font></font>
        dx *= f;<font></font>
        dy *= f;<font></font>
        dz *= f;<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].x), dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].x), -dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].y), dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].y), -dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].z), dz);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].z), -dz);<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;engCoul1), engCoul);<font></font>
        atomicAdd(&amp;(md-&gt;engVdW), engVdw);<font></font>
<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ergebnisse der Berechnungen stimmten überein. </font><font style="vertical-align: inherit;">Offensichtlich können die Koordinaten der Partikel innerhalb der 3. Dezimalstelle aufgrund unterschiedlicher Rundungssequenzen von Anfang zu Anfang variieren. </font><font style="vertical-align: inherit;">Ich </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fest, dass bei einem System von ungefähr 1.400 Partikeln und einem Grenzradius von 6 Angström die Funktionen </font><i><font style="vertical-align: inherit;">cell_list2a</font></i><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ungefähr </font><font style="vertical-align: inherit;">das </font><i><font style="vertical-align: inherit;">Zweifache</font></i><font style="vertical-align: inherit;"> der Ausführungszeit für eine einfache Aufzählung verlieren. </font><font style="vertical-align: inherit;">Wenn mehrere Blöcke (8 und 16) gleichzeitig in einem Block verarbeitet werden, werden die Geschwindigkeiten verglichen und liegen möglicherweise sogar etwas vor der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all_pair</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies sollte jedoch stark von der Größe des Systems abhängen. </font><font style="vertical-align: inherit;">Mit zunehmender Anzahl von Atomen wächst die Geschwindigkeit von Zelllistenalgorithmen linear und die einfache Aufzählung quadratisch. </font><font style="vertical-align: inherit;">Darüber hinaus ist die Zellliste sehr effektiv bei der Modellierung entladener Systeme (große Abstände zwischen Partikeln), beispielsweise Gasen</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit ist dieser Artikel abgeschlossen. Ich freue mich über alle Fragen und Kommentare, insbesondere zur Steigerung der Produktivität. </font><font style="vertical-align: inherit;">Die umstrittensten Momente im Verlauf der Erzählung habe ich rot notiert. </font><font style="vertical-align: inherit;">Da die Übertragung des Restes der Funktion der Molekulardynamik noch durchgeführt werden muss, plane ich, den Zyklus dieser Artikel fortzusetzen:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ewald Summation.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intramolekulare Wechselwirkung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lücken- und Bindungsbildung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elektronische Übertragung.</font></font></li>
</ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus der Literatur zu MD kann ich das Buch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daan Frenkel und Berend Smit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen </font><font style="vertical-align: inherit;">. </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Molekulare Simulation verstehen: Von Algorithmen zu Anwendungen</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computersimulation von Flüssigkeiten,</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verfasst von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MP Allen, DJ Tildesley</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Zum ersten gibt es meines Wissens eine Übersetzung ins Russische. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich danke auch Pavel Kudinov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pavel_kudinov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für seinen Kommentar, in dem er forderte, " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPGPU-Code so einfach und unkompliziert wie ein Hammer zu schreiben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", las ich schließlich, was schließlich zu diesem Artikel führte.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.06.2020. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Danke an den Kommentar</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Das Nullstellen globaler Parameter wurde aus den Funktionen entfernt und der Bereich der Partikel, die auf andere Weise an den Stream abgegeben wurden, definiert.</font></font></div>
      
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de508380/index.html">Automatisierung des Warenversands in China</a></li>
<li><a href="../de508384/index.html">So machen Sie den Entwickler mit den Werten Ihres Unternehmens vertraut, ohne auf Gewalt zurückzugreifen</a></li>
<li><a href="../de508390/index.html">VR bei der Schulung des Personals. Die wahren Vor- und Nachteile</a></li>
<li><a href="../de508392/index.html">Bürgerkriegsfinanzierung (USA vs. USA)</a></li>
<li><a href="../de508394/index.html">Wie Neulinge der HSE in St. Petersburg einen Torrent-Client, einen Code-Analysator, einen Bildbearbeiter und nicht nur für das Semester geschrieben haben</a></li>
<li><a href="../de508398/index.html">Drei Möglichkeiten für einen Programmierer: Experte, Leiter, Gründer</a></li>
<li><a href="../de508400/index.html">Wie ein „aktiver Bürger“ Menschen an Phishing gewöhnt</a></li>
<li><a href="../de508402/index.html">Wie die HiCampus-Architektur die Campus-Vernetzung vereinfacht</a></li>
<li><a href="../de508404/index.html">KI gegen KI-Kampf: Betrug und gefälschte Inhalte</a></li>
<li><a href="../de508408/index.html">Mobile Antivirenprogramme funktionieren nicht</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>