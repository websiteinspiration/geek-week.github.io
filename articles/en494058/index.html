<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëéüèæ üêß üë©üèΩ‚Äçüíº Tooth brushing timer üßó üïù üò∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, Habr! 
 
 
 
 This article is for those who do not have all the brushes in the bathroom with a timer, and who do not want to use an hourglas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Tooth brushing timer</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494058/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good day, Habr! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/9-/jw/kf9-jwevd_sekilnlp_-ervkxgw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article is for those who do not have all the brushes in the bathroom with a timer, and who do not want to use an hourglass.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have two daughters. Each time they enter the bathroom to brush their teeth, they ask to be spotted for two minutes (out of four children's brushes, only one has a timer for brushing your teeth). To make the process more interesting, and we did not have to remind the children to leave the bathroom four times a day, I decided to figure out a timer. The hourglass fell away immediately - it‚Äôs somehow not sporty. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/z0/di/ynz0dieaj7n70tdbqwmqspauruu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1. Timer circuit</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The timer circuit is very simple and is shown in Fig. 1. The mechanical buttons are not very suitable for the bathroom, as from pressing with wet hands they can fail (I will varnish the board), so it was decided to make the button touch. I previously used the TTP223 chip, and I installed it accordingly, but now it will work as a reset for the microcontroller. I thought that since the timer is turned off almost all the time (if you do not take into account that children will constantly poke into it, going to wash their hands), then you can use standby mode, and when you press the button, just reset the MK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The microcontroller used the one that was available - STM32F031G4. The small UFQFPN-28 is very convenient for miniature crafts. Specially did not add a tweeter (to save battery) and buck-boost, so that the dimensions were minimal.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hz/0c/qm/hz0cqmbl3qxqpn2rqakpknmddu8.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 2. Printed circuit board top</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
On the circuit board, I made only ten vias, and, so as not to be an eyesore, eight of them were located on the LED platforms. I also really wanted to stick a fingerprint picture somewhere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mu/uu/t7/muuut7av1aj7acl9fly_vypjub8.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3. Printed circuit board bottom I</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
tried to make the </font><i><font style="vertical-align: inherit;">circuit board</font></i><font style="vertical-align: inherit;"> as small as possible, because I don‚Äôt know yet whether I‚Äôll print the case or just stick the double-sided tape to the tile or mirror on the battery compartment. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1o/u3/ir/1ou3irruebs43lawnqmwx4hqc0u.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4. The board with the bottom components. The</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
firmware is also quite simple (generated in CubeMX for IAR). Blink diodes at startup and extinguish, then light at intervals of 30 seconds one at a time and blink again before bedtime. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For standby, only a couple of lines are used:</font></font><br>
<br>
<pre><code class="cpp hljs">DBGMCU-&gt;CR |= DBGMCU_CR_DBG_STANDBY;  </code></pre><br>
<pre><code class="cpp hljs">HAL_PWR_EnterSTANDBYMode();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After falling asleep, the SWD falls off, but since I have a sensor on the reset, we just press the touch and flash it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LEDs use Chinese with ali. </font><font style="vertical-align: inherit;">With a multimeter (UNI-T UT70A) it turned out to measure something like this:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 LED - 3.2mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 LEDs - 3.4mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 LEDs - 3.6mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 LEDs - 3.8mA;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In standby mode 8uA.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I think to play with the frequency of STM, and in the mode of operation to make it minimal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope the children will be delighted) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS: The </font></font><br>
<img src="https://habrastorage.org/webt/5a/ei/mi/5aeimimvj-trwjxe4pvxzswduiy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
children are delighted! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for the attention!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494048/index.html">The best materials for the independent manufacture of medical masks</a></li>
<li><a href="../en494050/index.html">"Udalenka". Notes from yesterday's office developer</a></li>
<li><a href="../en494052/index.html">What is wrong with collections in Java and why Guava will not help</a></li>
<li><a href="../en494054/index.html">Issue # 33: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../en494056/index.html">Lab X - Google's Top Secret Projects Factory</a></li>
<li><a href="../en494062/index.html">Internet History: Era of Fragmentation; part 1: load factor</a></li>
<li><a href="../en494064/index.html">Play with the cat, buy a bathrobe: Linus Torvalds thoughts on working from home</a></li>
<li><a href="../en494072/index.html">The future is here: how voice robots work and what they can do</a></li>
<li><a href="../en494074/index.html">How to keep the player's attention in the game</a></li>
<li><a href="../en494076/index.html">Analysis: investor behavior strategies during stock market crashes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>