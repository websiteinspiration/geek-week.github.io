<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🤝‍👨🏿 🎻 👤 Telegramによる自動テスト管理 🐲 👩🏼‍⚖️ 🏣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QAエンジニアとして、セルフテストシステムを開発しました。多くの問題に直面しました：
 
 

- テストの種類ごとに、CIで独自のジョブを作成し、手動で実行する必要がありました。
- 開発者はセルフテストケースの実行を拒否しました。
- どこからでも/デバイスから自動テストを実行できない。
- Q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Telegramによる自動テスト管理</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471364/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QAエンジニアとして、セルフテストシステムを開発しました。</font><font style="vertical-align: inherit;">多くの問題に直面しました：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> テストの種類ごとに、CIで独自のジョブを作成し、手動で実行する必要がありました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 開発者はセルフテストケースの実行を拒否しました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> どこからでも/デバイスから自動テストを実行できない。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> QA手動テストエンジニアは、自動テストを自分で実行できませんでした。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、自動テストを実行するボットの小さなプロトタイプを作成することにしました。これにより、上記の問題のほとんどがカバーされます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アイデアの説明：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーザーは、構成で指定されたルールに従って、必要なコマンドをチャットに送信し、CIシステムでビルドを起動します。</font><font style="vertical-align: inherit;">CIはpytestマークを使用して自動テストを実行します。</font><font style="vertical-align: inherit;">実行後、テストリポジトリ内のスクリプトは、ビルド状態に関する情報を受け取り、ログを収集して、電報チャットでユーザーに送り返します。</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツール：</font></font></b><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツール</font></font></b><div class="spoiler_text"><ul>
<li>  — Python</li>
<li>  — Pytest</li>
<li>HTTP  — Requests</li>
<li>DataBase — SQLite3</li>
<li>ORM — Peewee</li>
<li>CI  — Travis CI</li>
</ul><br>
</div></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> トレーニング</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボット登録 </font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストリポジトリの準備 </font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> テストとロギング</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> レポートの生成</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Travis CIを構成する </font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ボットのセットアップ </font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ボットの原則</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Herokuでの展開 </font></font></a></li>
</ol><br>
<a name="1"></a><br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボット登録</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、ボットの電報を登録し、トークンであるその一意のIDを取得する必要があります。</font><font style="vertical-align: inherit;">これを行うには、@ BotFatherボットにメッセージ/ startを書き込みます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの主なチームは/ newbotです。これを入力すると、ボットの名前を付けるように求められます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、1つのルールがあります。名前はボットで終わる必要があります。</font><font style="vertical-align: inherit;">BotFatherはボット名を受け入れ、トークンを返します。</font><font style="vertical-align: inherit;">チャットを開始してボットをアクティブにします。</font><font style="vertical-align: inherit;">次に、getUpdatesメソッドでAPIにリクエストを送信する必要があります。</font></font><br>
<br>
<pre><code class="python hljs">https://api.telegram.org/bot{_}/getUpdates</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
受け取ったhat_idを覚えておいてください。 </font></font><br>
<br>
<a name="2"></a><br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストリポジトリの準備</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、テストを含むリポジトリを編成するか、事前に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準備された</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事を</font><font style="vertical-align: inherit;">使用する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="3"></a><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストとロギング</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
テスト関数を作成し、pytestマーク（フル、スモーク、バード）でマークします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pytest.iniファイルを作成し、テスト関数のロギングライブラリからinfoメソッドへの呼び出しを追加して、テストにロギングを追加することが重要です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pytest.iniファイルには、ライブログのテンプレートとログファイルが含まれています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">試験例</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> pytest
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> logging<font></font>
<font></font>
<font></font>
<span class="hljs-meta">@pytest.mark.full</span>
<span class="hljs-meta">@pytest.mark.smoke</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_cat_facts</span>():</span>
    query = {<span class="hljs-string">"animal_type"</span>: <span class="hljs-string">"cat"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-string">"2"</span>}<font></font>
    response = requests.get(<span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span>, params=query)<font></font>
    logging.info(<span class="hljs-string">f"Request url: <span class="hljs-subst">{response.request.url}</span>, body: <span class="hljs-subst">{response.request.body}</span>"</span>)<font></font>
    logging.info(<span class="hljs-string">f"Request status: <span class="hljs-subst">{response.status_code}</span>, body: <span class="hljs-subst">{response.text}</span>"</span>)
    <span class="hljs-keyword">assert</span> response.status_code == <span class="hljs-number">200</span><font></font>
<font></font>
<span class="hljs-meta">@pytest.mark.full</span>
<span class="hljs-meta">@pytest.mark.smoke</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_dog_facts</span>():</span>
    query = {<span class="hljs-string">"animal_type"</span>: <span class="hljs-string">"dog"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-string">"2"</span>}<font></font>
    response = requests.get(<span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span>, params=query)<font></font>
    logging.info(<span class="hljs-string">f"Request url: <span class="hljs-subst">{response.request.url}</span>, body: <span class="hljs-subst">{response.request.body}</span>"</span>)<font></font>
    logging.info(<span class="hljs-string">f"Request status: <span class="hljs-subst">{response.status_code}</span>, body: <span class="hljs-subst">{response.text}</span>"</span>)
    <span class="hljs-keyword">assert</span> response.status_code == <span class="hljs-number">200</span><font></font>
<font></font>
<font></font>
<span class="hljs-meta">@pytest.mark.full</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_horse_facts</span>():</span>
    query = {<span class="hljs-string">"animal_type"</span>: <span class="hljs-string">"horse"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-string">"2"</span>}<font></font>
    response = requests.get(<span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span>, params=query)<font></font>
    logging.info(<span class="hljs-string">f"Request url: <span class="hljs-subst">{response.request.url}</span>, body: <span class="hljs-subst">{response.request.body}</span>"</span>)<font></font>
    logging.info(<span class="hljs-string">f"Request status: <span class="hljs-subst">{response.status_code}</span>, body: <span class="hljs-subst">{response.text}</span>"</span>)
    <span class="hljs-keyword">assert</span> response.status_code == <span class="hljs-number">200</span><font></font>
<font></font>
<span class="hljs-meta">@pytest.mark.bird</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_bird_facts</span>():</span>
    query = {<span class="hljs-string">"animal_type"</span>: <span class="hljs-string">"bird"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-string">"2"</span>}<font></font>
    response = requests.get(<span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span>, params=query)<font></font>
    logging.info(<span class="hljs-string">f"Request url: <span class="hljs-subst">{response.request.url}</span>, body: <span class="hljs-subst">{response.request.body}</span>"</span>)<font></font>
    logging.info(<span class="hljs-string">f"Request status: <span class="hljs-subst">{response.status_code}</span>, body: <span class="hljs-subst">{response.text}</span>"</span>)
    <span class="hljs-keyword">assert</span> response.status_code == <span class="hljs-number">200</span></code></pre><br>
</div></div><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pytest.ini</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">[pytest]<font></font>
<font></font>
markers =<font></font>
    smoke: for smoking testing<font></font>
    full: for regression testing<font></font>
    bird: facts only bird<font></font>
<font></font>
log_cli = 1<font></font>
log_cli_level=INFO<font></font>
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s<font></font>
log_cli_date_format='%Y-%m-%d %H:%M:%S'<font></font>
<font></font>
log_file = test_log.log<font></font>
log_file_level=INFO<font></font>
log_file_format= %(asctime)s [%(levelname)8s] %(message)s<font></font>
log_file_date_format='%Y-%m-%d %H:%M:%S'</code></pre><br>
</div></div><br>
<br>
<a name="4"></a><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポートの</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
生成アセンブリが完了した後、CIシステムから情報を収集し、それらをログと共に電報チャットに送信するスクリプトを作成します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプト内で、TELEGRAM_BOTとCHAT_IDの値を以前に受け取った値に置き換える必要があります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトコード</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> os<font></font>
<font></font>
TRAVIS_TEST_RESULT = os.environ.get(<span class="hljs-string">"TRAVIS_TEST_RESULT"</span>)<font></font>
TRAVIS_REPO_SLUG = os.environ.get(<span class="hljs-string">"TRAVIS_REPO_SLUG"</span>)<font></font>
TRAVIS_BRANCH = os.environ.get(<span class="hljs-string">"TRAVIS_BRANCH"</span>)<font></font>
TRAVIS_JOB_WEB_URL = os.environ.get(<span class="hljs-string">"TRAVIS_JOB_WEB_URL"</span>)<font></font>
TRAVIS_COMMIT_MESSAGE = os.environ.get(<span class="hljs-string">"TRAVIS_COMMIT_MESSAGE"</span>)<font></font>
TELEGRAM_TOKEN = <span class="hljs-string">"808619876:GHrtj9zs-KvKhhtWyu1YoxjtIikUYMGVjD8g"</span>
CHAT_ID = <span class="hljs-string">"272560060"</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> TRAVIS_TEST_RESULT != <span class="hljs-number">0</span>:<font></font>
    build_status = <span class="hljs-string">""</span>
<span class="hljs-keyword">else</span>:<font></font>
    build_status = <span class="hljs-string">""</span><font></font>
<font></font>
TEXT = <span class="hljs-string">f" : <span class="hljs-subst">{build_status}</span> \n : <span class="hljs-subst">{TRAVIS_REPO_SLUG}</span> \n : <span class="hljs-subst">{TRAVIS_BRANCH}</span> \n Commit : <span class="hljs-subst">{TRAVIS_COMMIT_MESSAGE}</span> \n -: <span class="hljs-subst">{TRAVIS_JOB_WEB_URL}</span>"</span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_message</span>():</span>
    URL = <span class="hljs-string">f"https://api.telegram.org/bot<span class="hljs-subst">{TELEGRAM_TOKEN}</span>/sendMessage"</span>
    body = {<span class="hljs-string">'chat_id'</span>: CHAT_ID, <span class="hljs-string">'text'</span>: TEXT}<font></font>
    response = requests.post(url=URL, json=body)<font></font>
    <span class="hljs-keyword">return</span> response<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_file</span>():</span>
    URL = <span class="hljs-string">f"https://api.telegram.org/bot<span class="hljs-subst">{TELEGRAM_TOKEN}</span>/sendDocument"</span>
    body = {<span class="hljs-string">'chat_id'</span>: CHAT_ID}<font></font>
    file = {<span class="hljs-string">"document"</span>: open(<span class="hljs-string">"test_log.log"</span>)}<font></font>
    response = requests.post(url=URL, data=body, files=file)<font></font>
    <span class="hljs-keyword">return</span> response<font></font>
<font></font>
<font></font>
send_message()<font></font>
send_file()</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトはシステム変数を使用し、Travis CIから値を受け取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TRAVIS_TEST_RESULTの値がゼロではない場合-値が「成功」に設定されている場合、send_message関数が最初に実行され、アセンブリ情報がチャットに送信されます（リポジトリ名、選択されたブランチ、使用されたコミットの名前、Webログへのリンク）。次に、送信するsend_file関数ログファイル。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストリポジトリで、構成ファイル-travis.ymlを追加します。</font><font style="vertical-align: inherit;">内部では、アセンブリが機能するパイプラインについて説明します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis.yml</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">language: python<font></font>
python:<font></font>
  - "3.7"<font></font>
install:<font></font>
  - pip install -r requirements.txt<font></font>
<font></font>
script:<font></font>
  pytest -m smoke<font></font>
<font></font>
after_script:<font></font>
  - python tg_command.py</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、リポジトリをGitHubにデプロイしてTravis CIに追加する必要があります。 </font></font><br>
<br>
<a name="5"></a><br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRAVIS_CI設定</font></font></b></h3><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
行き</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitHubアカウントを使用してログインします。</font><font style="vertical-align: inherit;">[ダッシュボード]タブに切り替えます。</font><font style="vertical-align: inherit;">以前にDevTools（ネットワーク）を開いた後、テストリポジトリの反対側のサイトの[リポジトリ]サブタブで、スライダーを動かし、そのアセンブリをアクティブにします。</font><font style="vertical-align: inherit;">[ネットワーク]タブ（DevTools）でアクティブなリクエストが受信され、リポジトリのIDに関する情報があるプレビューでは、番号を覚えておく必要があります（コピー/書き込み）。</font><font style="vertical-align: inherit;">[設定]タブでサイトに切り替えます。</font><font style="vertical-align: inherit;">トークンをコピーまたは記憶します-必要です。</font></font><br>
<br>
<a name="6"></a><br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットのセットアップ</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、コードの分析については詳しく説明しません</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リポジトリで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確認でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここで、トピックの基本を理解することが重要なので、ボットの設定に移りましょう：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リポジトリ内にはファイルがあります：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.py-ボットスクリプト;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">models.py-ORMのモデルを含むファイル。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf.ini-構成変数を含むファイル。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">runtime.txt-Travis CIのPythonバージョン値を修正しました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">procfile-gunicornの設定。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wsgi.py-gunicornを使用したアプリケーション起動ファイル。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットを機能させるには、conf.iniのデータを置き換える必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis_token-受信したトークンをTravis CIに示します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis_base_url-Travis CI APIのアドレスを指定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travis_repository_id-Travis CI内で、自動テストでリポジトリのIDを指定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegram_chat_id-ボットからのメッセージが送信されるテレグラムのチャットIDを指定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegram_bot_url-ボットのURLを指定します。</font></font></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conf.iniの例</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs"><font></font>
[travis]<font></font>
travis_token  = token HkjhkjgGKJhjgFGfdgd<font></font>
travis_base_url = https://api.travis-ci.org<font></font>
travis_repository_id = 10898384<font></font>
[telegram]<font></font>
telegram_chat_id = 24234234<font></font>
telegram_bot_url = https://api.telegram.org/bot87543366:AAHtj9zs-Kv4zGWyu1eTXegikUYMGVjD8g/</code></pre><br>
</div></div><br>
<a name="7"></a><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットの原則</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
各リクエストが200に等しいレスポンスステータスを提供することが重要です。それ以外の場合、テレグラムは有効なレスポンスを受信するまでリクエストを周期的に送信し始めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットには一連のコマンドがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
区切り文字には、アンダースコア以外の任意の特殊文字を使用できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add_m-テストキット（pythonマーク）を追加します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 テンプレート：*コマンド* {キットの説明} {区切り文字} {名前マーク}。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 例：add_mテスト用の鳥/鳥。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add_b-テスト用のブランチを追加します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テンプレート：*コマンド* {ブランチの説明} {delimiter} {gitからのブランチの名前}。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例：add_bマスター。</font></font></li>
<li>select —       .<br>
 : **.<br>
 :    select,    ,       add_b. </li>
<li>run —   .<br>
 : **.<br>
 :    run,     ,       add_m.     ,   select. </li>
<li>del_m —   .<br>
 : ** { marks}.<br>
 : del_m bird. </li>
<li>del_b —     .<br>
 : ** {  git}.<br>
 : del_b master. </li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットはどのように機能しますか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーがテストのセットを追加する（add_m）：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドは、ユーザーからのデータを2つの部分に分割します</font><font style="vertical-align: inherit;">-git </font><font style="vertical-align: inherit;">のブランチの説明と名前。名前はデータベース内のmark_name列に記述され、説明はmark_description列に記述されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーがブランチを追加する（add_b）：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドは、ユーザーからのデータを2つの部分に分割します</font><font style="vertical-align: inherit;">-gitのブランチ</font><font style="vertical-align: inherit;">の説明と名前。名前はデータベース内のbranch_name列に書き込まれ、説明はbranch_description列に書き込まれます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーはデフォルトのブランチ（select）を選択します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーは、branch_descriptionテーブルとbranch_nameテーブルのデータに基づいて形成されたチャット内のボタンを受け取ります。ユーザーは、目的のブランチを持つボタンを選択します。これは、favorite_branchテーブルに書き込まれます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーはビルド（実行）の初期化を開始します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーは、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mark_descriptionおよびmark_nameテーブル</font><font style="vertical-align: inherit;">からのデータに従って形成されたチャット内のボタンを受け取ります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ユーザーは、キットのボタンを選択して自動テストを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが選択したデータに基づいて、ボットはTravisCIクラスのトリガーメソッドでリクエストを生成し、それをTravisに送信して実行します。</font><font style="vertical-align: inherit;">Travisシステム内で、ビルドオプションのトリガーがアクティブになります。</font><font style="vertical-align: inherit;">このオプションはtravis.ymlファイルを上書きし、スクリプトセクションをユーザーが選択したデータに変更します。</font></font><br>
<br>
<a name="8"></a><br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEROKUでの展開</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットが機能するには、ホスティングにデプロイする必要があります。このプラットフォームには無料の関税があり、ボットが機能するために必要な電力を提供するため、Herokuの使用をお勧めします。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットをデプロイする方法は？</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プロセス全体を説明しないため</font><font style="vertical-align: inherit;">、最初に</font><font style="vertical-align: inherit;">公式</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">への</font><font style="vertical-align: inherit;">リンクを残しておきます</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。GUI経由でHerokuを操作する場合は、Githubにコードを入力します。 Heroku Webインターフェイスから登録する必要があります。登録後、[新規]-&gt; [新しいアプリの作成]-&gt;アプリの名前を入力し、地域を選択します。 [Deploy]タブに移動し、DeploymentメソッドでGithubとの統合を選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの前に、リポジトリを検索するためのブロックが表示されます。</font><font style="vertical-align: inherit;">リポジトリの名前を入力し、[検索]ボタンをクリックします。</font><font style="vertical-align: inherit;">検索結果で、リポジトリ名の反対側にある[接続]ボタンをクリックします。</font><font style="vertical-align: inherit;">手動デプロイブロックでブランチを選択し、[デプロイ]をクリックします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の瞬間-GETリクエストを使用してWebhookをアクティブにする必要があります。</font></font><br>
<pre><code class="python hljs">https://api.telegram.org/bot{id_}/setWebhook?url=https://{_}.herokuapp.com/bot</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットが使用できます。</font><font style="vertical-align: inherit;">すべてがうまくいったことを確認します。</font></font><br>
<br>
<img src="https://cdn1.radikalno.ru/uploads/2019/10/13/7d55521afbcfd87833197fc0a3ad0c82-full.jpg" alt="画像"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja471346/index.html">先週のフロントエンドの世界からの新鮮な食材のダイジェストNo. 384（2019年10月7日〜13日）</a></li>
<li><a href="../ja471348/index.html">フルスタックTypeScriptアプリ</a></li>
<li><a href="../ja471350/index.html">1969年のアナログコンピューターからの低ノイズオペアンプのリバースエンジニアリング</a></li>
<li><a href="../ja471352/index.html">LaTeXでプレゼンテーションを書く</a></li>
<li><a href="../ja471360/index.html">複製方法。ICEの設計からの11の例</a></li>
<li><a href="../ja471366/index.html">EU裁判所はデフォルトでCookieに反対しています-事前にチェックされたチェックボックスがあってはなりません</a></li>
<li><a href="../ja471372/index.html">企業はなぜ従業員のスマートフォンを管理する必要があるのですか？</a></li>
<li><a href="../ja471374/index.html">ハリコフのNIXMultiConf＃3にご招待します</a></li>
<li><a href="../ja471378/index.html">プログラミングはどこから始まりますか？</a></li>
<li><a href="../ja471380/index.html">サイバーセキュリティの最前線にいる侵入者</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>