<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊🏾 🛵 🎷 ReactおよびTypeScriptコンポーネントライブラリの開始 ✌️ 🛬 👩🏿‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="私の仕事の大部分はバックエンドを作成していますが、先日、Reactでコンポーネントのライブラリーを開始するタスクがありました。数年前、Reactのバージョンがフロントエンド開発での経験と同じくらい小さかったとき、私はすでに発射体にアプローチしましたが、それは不器用に不器用に判明しました。現在のRea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ReactおよびTypeScriptコンポーネントライブラリの開始</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461439/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/57/zc/nc57zcknvdousryimpgxxqsiz1i.jpeg"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の仕事の大部分はバックエンドを作成していますが、先日、Reactでコンポーネントのライブラリーを開始するタスクがありました。</font><font style="vertical-align: inherit;">数年前、Reactのバージョンがフロントエンド開発での経験と同じくらい小さかったとき、私はすでに発射体にアプローチしましたが、それは不器用に不器用に判明しました。</font><font style="vertical-align: inherit;">現在のReactエコシステムの成熟度と私の成長経験を考慮して、今回はすべてを適切かつ便利に実行するように刺激を受けました。</font><font style="vertical-align: inherit;">その結果、将来のライブラリのために空白があり、何も忘れずにすべてを1か所に集めるために、このチートシートの記事が書かれました。これは、どこから始めればよいかわからない人にも役立つはずです。</font><font style="vertical-align: inherit;">私が何をしたか見てみましょう。</font></font></p><a name="habracut"></a><br>
<p><strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL / DR：すぐに開始できるライブラリのコードは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">githubで</font></a><font style="vertical-align: inherit;">確認できます</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></em></strong></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この問題には2つの側面からアプローチできます。</font></font></p><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既製のスターターキット、ボイラープレート、CLIジェネレーターを見つける</font></font></li>
<li>  </li>
</ol><br>
<p>     ,            .      ,                .</p><br>
<p>    ,          ,       .        .     .</p><br>
<h2 id="create-react-library">Create React Library</h2><br>
<p> ,     React       React,            — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Create React App</a> (CRA).  ,         (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a>). ,       ui-kit     SPA.        (src),       (example),     ("")         (dist).        SPA ,      .   ,         CRA  — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Creat React Library</a> (CRL).</p><br>
<p>CRL,    CRA,  "easy-to-use" CLI-.      .   :</p><br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Rollup</a>   cjs  es   source map   css-</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">babel</a>    ES5</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Jest</a>  </li>
<li>TypeScript (TS)  ,     </li>
</ul><br>
<p>    (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">npx</a>     ):</p><br>
<pre><code class="bash hljs">npx create-react-library</code></pre><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wd/ql/qq/wdqlqqfmjrgntiqz6zphcdyccdw.png" alt="CLRの質問"></p></div></div><br>
<p>             .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/vs/d4/l2/vsd4l2o2g1wn3n0folb_yr30ui8.png" alt="Clrツリー"></p></div></div><br>
<div class="spoiler"><b class="spoiler_title">  -   ...</b><div class="spoiler_text"><p>     ,            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">npm-check</a>:</p><br>
<pre><code class="bash hljs">npx npm-check -u</code></pre><br>
<p>     ,  -   <code>example</code>   js.      TypeScript,  <code>tsconfig.json</code>    (,  <code>typescript</code>   <code>@types</code>).</p><br>
<p>  <code>react-scripts-ts</code>  <code>deprecated</code>    .     <code>react-scripts</code>,      CRA (   <code>react-scripts</code>)  TypeScript   (  Babel 7).</p><br>
<p>       <code>react-scripts</code>     .   , Jest       <code>isolatedModules</code>,           <code>d.ts</code>   (  -    Babel 7,   Jest  <code>react-scripts</code>   TS).    <code>eject</code>  <code>react-scripts</code>,       ,     .</p></div></div><br>
<h2 id="tsdx">tsdx</h2><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link">StanEgo</a>,      Create React Library — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">tsdx</a>.  cli-    CRA            Rollup, TS, Prettier, husky, Jest  React.  React   .   :</p><br>
<pre><code class="bash hljs">npx tsdx create mytslib</code></pre><br>
<p>            .    CRL .    CRL — Zero-config. . .  Rollup     tsdx (    CRA). </p><br>
<p>   ,          -  eject   CRA.   issue , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a>.  -     ,       .      ,  tsdx  ,   .</p><br>
<h2 id="beryom-upravlenie-v-svoi-ruki">    </h2><br>
<p> ,        ? ,   .  <code>npm init</code>   <code>package.json</code>  .       . ,     node  npm   <code>engines</code>.         <code>dist</code>.     <code>files</code>.     react,    ,        —    <code>peerDependencies</code>    <code>react</code>  <code>react-dom</code>.</p><br>
<p>   <code>react</code>  <code>react-dom</code>   types (..      TypeScript)  devDependencies (      ):</p><br>
<pre><code class="bash hljs">npm install --save-dev react react-dom @types/react @types/react-dom</code></pre><br>
<p> TypeScript:</p><br>
<pre><code class="bash hljs">npm install --save-dev typescript</code></pre><br>
<p>       : <code>tsconfig.json</code>  <code>tsconfig.test.json</code>.  <code>target</code>   <code>es5</code>,   <code>sourceMap</code>  ..            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.    <code>include</code>    ,   <code>exclude</code>   <code>node_modules</code>  <code>dist</code>.  <code>package.json</code>    <code>typings</code>,       — <code>dist/index</code>.</p><br>
<p>  <code>src</code>    .   ,  <code>.gitignore</code>, <code>.editorconfig</code>,     <code>README.md</code>.</p><br>
<h3 id="rollup">Rollup</h3><br>
<p>    Rollup,   CRL.    ,     CRL.   ,  Rollup   ,  Webpack  . ,    Webpack (  ,     CRA),  Rollup  ,   .</p><br>
<p>:</p><br>
<pre><code class="bash hljs">npm install --save-dev rollup rollup-plugin-babel rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-postcss rollup-plugin-typescript2 rollup-plugin-url @svgr/rollup</code></pre><br>
<p> <code>package.json</code>       ,    <code>rollup</code> — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">pkg.module</a>:</p><br>
<pre><code class="json hljs">   <span class="hljs-string">"main"</span>: <span class="hljs-string">"dist/index.js"</span>,
   <span class="hljs-string">"module"</span>: <span class="hljs-string">"dist/index.es.js"</span>,
   <span class="hljs-string">"jsnext:main"</span>: <span class="hljs-string">"dist/index.es.js"</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title">   rollup.config.js</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> typescript <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-typescript2'</span>;
<span class="hljs-keyword">import</span> commonjs <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-commonjs'</span>;
<span class="hljs-keyword">import</span> external <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-peer-deps-external'</span>;
<span class="hljs-keyword">import</span> postcss <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-postcss'</span>;
<span class="hljs-keyword">import</span> resolve <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-node-resolve'</span>;
<span class="hljs-keyword">import</span> url <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-url'</span>;
<span class="hljs-keyword">import</span> svgr <span class="hljs-keyword">from</span> <span class="hljs-string">'@svgr/rollup'</span>;<font></font>
<font></font>
<span class="hljs-keyword">import</span> pkg <span class="hljs-keyword">from</span> <span class="hljs-string">'./package.json'</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
   <span class="hljs-attr">input</span>: <span class="hljs-string">'src/index.tsx'</span>,
   <span class="hljs-attr">output</span>: [<font></font>
      {<font></font>
         <span class="hljs-attr">file</span>: pkg.main,
         <span class="hljs-attr">format</span>: <span class="hljs-string">'cjs'</span>,
         <span class="hljs-attr">exports</span>: <span class="hljs-string">'named'</span>,
         <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span><font></font>
      },<font></font>
      {<font></font>
         <span class="hljs-attr">file</span>: pkg.module,
         <span class="hljs-attr">format</span>: <span class="hljs-string">'es'</span>,
         <span class="hljs-attr">exports</span>: <span class="hljs-string">'named'</span>,
         <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span><font></font>
      }<font></font>
   ],<font></font>
   <span class="hljs-attr">plugins</span>: [<font></font>
      external(),<font></font>
      postcss({<font></font>
         <span class="hljs-attr">modules</span>: <span class="hljs-literal">false</span>,
         <span class="hljs-attr">extract</span>: <span class="hljs-literal">true</span>,
         <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>,
         <span class="hljs-attr">sourceMap</span>: <span class="hljs-literal">true</span><font></font>
      }),<font></font>
      url(),<font></font>
      svgr(),<font></font>
      resolve(),<font></font>
      typescript({<font></font>
         <span class="hljs-attr">rollupCommonJSResolveHack</span>: <span class="hljs-literal">true</span>,
         <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span><font></font>
      }),<font></font>
      commonjs()<font></font>
   ]<font></font>
};</code></pre></div></div><br>
<p>   js-,    .   <code>input</code>  ,       . <code>output</code> —      —         .</p><br>
<div class="spoiler"><b class="spoiler_title">       </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-peer-deps-external</a> —   <code>peerDependencies</code>  <code>bundle</code>,    .  ,   <code>peerDependencies</code>    </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-postcss</a> —  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PostCss</a>  Rollup.    css-modules,        css,      sourceMap.      css,    ,  <code>extract</code>   —    css       head     .          css (,   ..),       css-bundle .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-url</a> —    ,  </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">svgr</a> —  svg  React-</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-node-resolve</a> —      node_modules</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-typescript2</a> —   TypeScript      </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">rollup-plugin-commonjs</a> —  commonjs-   es-,       bundle</li>
</ul></div></div><br>
<p>   <code>scripts</code> <code>package.json</code>    (<code>"build": "rollup -c"</code>)     watch-    (<code>"start": "rollup -c -w &amp;&amp; npm run prettier-watch"</code>).</p><br>
<h3 id="pervyy-komponent-i-eksportnyy-fayl">    </h3><br>
<p>   react-,      .             — <code>src/components/ExampleComponent</code>.           — <code>tsx</code>, <code>css</code>, <code>test.tsx</code>  .<br>
 -      <code>tsx</code>-  .</p><br>
<div class="spoiler"><b class="spoiler_title">ExampleComponent.tsx</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@class <span class="hljs-variable">ExampleComponent</span></span>
 */</span><font></font>
<font></font>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;<font></font>
<font></font>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./ExampleComponent.css'</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> interface Props {
   <span class="hljs-comment">/**
    * Simple text prop
    **/</span>
   <span class="hljs-attr">text</span>: string;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/** My First component */</span>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{<font></font>
   render() {<font></font>
      <span class="hljs-keyword">const</span> { text } = <span class="hljs-keyword">this</span>.props;<font></font>
<font></font>
      <span class="hljs-keyword">return</span> (
         <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"test"</span>&gt;</span>
            Example Component: {text}
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Coool!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
         <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
      );<font></font>
   }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ExampleComponent;</code></pre></div></div><br>
<p>  <code>src</code>        ,      css  svg (  CRL).</p><br>
<div class="spoiler"><b class="spoiler_title">typings.d.ts</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">/**
 * Default CSS definition for typescript,
 * will be overridden with file-specific definitions by rollup
 */</span>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">'*.css'</span> {
   <span class="hljs-keyword">const</span> content: { [className: string]: string };
   <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> content;<font></font>
}<font></font>
<font></font>
interface SvgrComponent extends React.FunctionComponent&lt;React.SVGAttributes&lt;SVGElement&gt;&gt; {}<font></font>
<font></font>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">'*.svg'</span> {
   <span class="hljs-keyword">const</span> svgUrl: string;
   <span class="hljs-keyword">const</span> svgComponent: SvgrComponent;
   <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> svgUrl;
   <span class="hljs-keyword">export</span> { svgComponent <span class="hljs-keyword">as</span> ReactComponent };<font></font>
}</code></pre></div></div><br>
<p>    css      .    — <code>src/index.tsx</code>.  - css            <code>src/index.tsx</code>,      ,  .</p><br>
<div class="spoiler"><b class="spoiler_title">src/index.tsx</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { ExampleComponent, Props } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ExampleComponent'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./export.css'</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> { ExampleComponent, Props };</code></pre></div></div><br>
<p>     — <code>npm run build</code>.    <code>rollup</code>      ,      <code>dist</code>.</p><br>
<p>            .</p><br>
<h3 id="zabyvaem-o-formatirovanii-koda-s-prettier">     Prettier</h3><br>
<p>    code-review        ,      .      ,      ,     ,     .   —    .       — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">prettier</a>.  :</p><br>
<pre><code class="bash hljs">npm install --save-dev prettier</code></pre><br>
<p>      .</p><br>
<div class="spoiler"><b class="spoiler_title">.prettierrc.json</b><div class="spoiler_text"><pre><code class="json hljs">{
   <span class="hljs-attr">"tabWidth"</span>: <span class="hljs-number">3</span>,
   <span class="hljs-attr">"singleQuote"</span>: <span class="hljs-literal">true</span>,
   <span class="hljs-attr">"jsxBracketSameLine"</span>: <span class="hljs-literal">true</span>,
   <span class="hljs-attr">"arrowParens"</span>: <span class="hljs-string">"always"</span>,
   <span class="hljs-attr">"printWidth"</span>: <span class="hljs-number">100</span>,
   <span class="hljs-attr">"semi"</span>: <span class="hljs-literal">true</span>,
   <span class="hljs-attr">"bracketSpacing"</span>: <span class="hljs-literal">true</span>
}</code></pre></div></div><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>. WebStrom        <code>prettier</code>     IDE.      ,     <code>/node_modules</code>  <code>/dist</code>    <code>.prettierignore</code> (  <code>.gitignore</code>).    <code>prettier</code>,      :</p><br>
<pre><code class="bash hljs">prettier --write <span class="hljs-string">"**/*"</span></code></pre><br>
<p>          ,         <code>prettier</code>,   <code>prettier</code>  <code>precommit-hook</code>  ,   <code>staged</code> ( <code>git add</code>).       . - —  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">hasky</a>,    -   ,   ..  - —  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">lint-staged</a>,       <code>staged</code> .       ,          <code>package.json</code>:</p><br>
<pre><code class="bash hljs">npx mrm lint-staged</code></pre><br>
<p>      ,   ,  <code>prettier</code>         . ,      — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">onchange</a>.                . :</p><br>
<pre><code class="bash hljs">npm install --save-dev --save-exact onchange</code></pre><br>
<p>    <code>scripts</code>  <code>package.json</code> :</p><br>
<pre><code class="json hljs"><span class="hljs-string">"prettier-watch"</span>: <span class="hljs-string">"onchange 'src/**/*' -- prettier --write {{changed}}"</span></code></pre><br>
<p>          .</p><br>
<h3 id="izbegaem-oshibok-s-eslint">   ESLint</h3><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ESLint</a>            js  ts-.    .   ESLint   CRA,       CRA     .  ,    TS  <code>prettier</code> (    <code>ESLint</code>  <code>prettier</code>):</p><br>
<pre><code class="bash hljs">npm install --save-dev eslint eslint-config-react-app eslint-loader eslint-plugin-flowtype eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser babel-eslint eslint-config-prettier eslint-plugin-prettier</code></pre><br>
<p> <code>ESLint</code>    .</p><br>
<div class="spoiler"><b class="spoiler_title">.eslintrc.json</b><div class="spoiler_text"><pre><code class="json hljs">{
   <span class="hljs-attr">"extends"</span>: [
      <span class="hljs-string">"plugin:@typescript-eslint/recommended"</span>,
      <span class="hljs-string">"react-app"</span>,
      <span class="hljs-string">"prettier"</span>,
      <span class="hljs-string">"prettier/@typescript-eslint"</span><font></font>
   ],<font></font>
   <span class="hljs-attr">"plugins"</span>: [
      <span class="hljs-string">"@typescript-eslint"</span>,
      <span class="hljs-string">"react"</span><font></font>
   ],<font></font>
   <span class="hljs-attr">"rules"</span>: {
      <span class="hljs-attr">"@typescript-eslint/no-empty-interface"</span>: <span class="hljs-string">"off"</span>,
      <span class="hljs-attr">"@typescript-eslint/explicit-function-return-type"</span>: <span class="hljs-string">"off"</span>,
      <span class="hljs-attr">"@typescript-eslint/explicit-member-accessibility"</span>: <span class="hljs-string">"off"</span><font></font>
   }<font></font>
}</code></pre></div></div><br>
<p>   <code>scripts</code>  <code>package.json</code>  <code>lint</code> — <code>eslint src/**/* --ext .ts,.tsx --fix</code>.    eslint  <code>npm run lint</code>.</p><br>
<h3 id="testiruem-s-jest">  Jest</h3><br>
<p>      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Jest</a> —    facebook. , ..   TS   babel 7,   tsc,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ts-jest</a>:</p><br>
<pre><code class="bash hljs">npm install --save-dev jest ts-jest @types/jest</code></pre><br>
<p> jest    css   ,    .   <code>__mocks__</code>     .<br>
<code>styleMock.ts</code>:</p><br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {};</code></pre><br>
<p><code>fileMock.ts</code>:</p><br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = <span class="hljs-string">'test-file-stub'</span>;</code></pre><br>
<p>   jest.</p><br>
<div class="spoiler"><b class="spoiler_title">jest.config.js</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {
   <span class="hljs-attr">preset</span>: <span class="hljs-string">'ts-jest'</span>,
   <span class="hljs-attr">testEnvironment</span>: <span class="hljs-string">'node'</span>,
   <span class="hljs-attr">moduleNameMapper</span>: {
      <span class="hljs-string">'\\.(css|less|sass|scss)$'</span>: <span class="hljs-string">'&lt;rootDir&gt;/__mocks__/styleMock.ts'</span>,
      <span class="hljs-string">'\\.(gif|ttf|eot|svg)$'</span>: <span class="hljs-string">'&lt;rootDir&gt;/__mocks__/fileMock.ts'</span><font></font>
   }<font></font>
};</code></pre></div></div><br>
<p>     <code>ExampleComponent</code>   .</p><br>
<div class="spoiler"><b class="spoiler_title">ExampleComponent.test.tsx</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { ExampleComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ExampleComponent'</span>;<font></font>
<font></font>
describe(<span class="hljs-string">'ExampleComponent'</span>, () =&gt; {<font></font>
   it(<span class="hljs-string">'is truthy'</span>, () =&gt; {<font></font>
      expect(ExampleComponent).toBeTruthy();<font></font>
   });<font></font>
});</code></pre></div></div><br>
<p>   <code>scripts</code>  <code>package.json</code>  <code>test</code> — <code>npm run lint &amp;&amp; jest</code>.      .       ,    — <code>npm run test</code>.         <code>dist</code>,    <code>Rollup</code>  <code>typescritp</code>  <code>exclude</code> — <code>['src/**/*.test.(tsx|ts)']</code>.     <code>husky pre-commit hook</code>   <code>lint-staged</code> — <code>"pre-commit": "npm run test &amp;&amp; lint-staged"</code>.</p><br>
<h3 id="razrabatyvaem-dokumentiruem-i-lyubuemsya-komponentami-s-storybook">,      Storybook</h3><br>
<p>           .     ,       ,      ,      .       .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Styleguidist</a>.        markdown,        React-.        --,    ,    ,    ,      .</p><br>
<p>          — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Storybook</a>.           .  ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>         markdown-.    Storybook  ,     —     .  ,       -    (   CRL).  storybook   <code>stories</code> — ts-,          <code>props</code>    (   ,   ).     <code>stories</code>  -.</p><br>
<p> ,    storybook:</p><br>
<pre><code class="bash hljs">npx -p @storybook/cli sb init</code></pre><br>
<p>    TS.       ,      :</p><br>
<pre><code class="bash hljs">npm install --save-dev awesome-typescript-loader @types/storybook__react @storybook/addon-info react-docgen-typescript-loader @storybook/addon-actions @storybook/addon-knobs @types/storybook__addon-info @types/storybook__addon-knobs webpack-blocks</code></pre><br>
<p>     <code>storybook</code> — <code>.storybook</code>    ,    .       <code>addons</code>  <code>config</code>  <code>ts</code>.   <code>addons.ts</code>  :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> <span class="hljs-string">'@storybook/addon-actions/register'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@storybook/addon-links/register'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'@storybook/addon-knobs/register'</span>;</code></pre><br>
<p>,   storybook    webpack   <code>.storybook</code>.</p><br>
<div class="spoiler"><b class="spoiler_title">webpack.config.js</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">{ config }</span>) =&gt;</span> {<font></font>
   config.module.rules.push({<font></font>
      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ts|tsx)$/</span>,<font></font>
      use: [<font></font>
         {<font></font>
            <span class="hljs-attr">loader</span>: <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'awesome-typescript-loader'</span>)<font></font>
         },<font></font>
         <span class="hljs-comment">// Optional</span><font></font>
         {<font></font>
            <span class="hljs-attr">loader</span>: <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'react-docgen-typescript-loader'</span>)<font></font>
         }<font></font>
      ]<font></font>
   });<font></font>
   config.resolve.extensions.push(<span class="hljs-string">'.ts'</span>, <span class="hljs-string">'.tsx'</span>);
   <span class="hljs-keyword">return</span> config;<font></font>
};</code></pre></div></div><br>
<p>   <code>config.ts</code>,         stories.</p><br>
<div class="spoiler"><b class="spoiler_title">config.ts</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { configure } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/react'</span>;
<span class="hljs-keyword">import</span> { addDecorator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/react'</span>;
<span class="hljs-keyword">import</span> { withInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/addon-info'</span>;
<span class="hljs-keyword">import</span> { withKnobs } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/addon-knobs'</span>;<font></font>
<font></font>
<span class="hljs-comment">// automatically import all files ending in *.stories.tsx</span>
<span class="hljs-keyword">const</span> req = <span class="hljs-built_in">require</span>.context(<span class="hljs-string">'../src'</span>, <span class="hljs-literal">true</span>, /\.stories\.tsx$/);<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadStories</span>(<span class="hljs-params"></span>) </span>{<font></font>
   req.keys().forEach(req);<font></font>
}<font></font>
<font></font>
configure(loadStories, <span class="hljs-built_in">module</span>);<font></font>
<font></font>
addDecorator(withInfo);<font></font>
addDecorator(withKnobs);</code></pre></div></div><br>
<p>   <code>story</code>    <code>ExampleComponent</code></p><br>
<div class="spoiler"><b class="spoiler_title">ExampleComponent.stories.tsx</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { storiesOf } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/react'</span>;
<span class="hljs-keyword">import</span> { ExampleComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ExampleComponent'</span>;
<span class="hljs-keyword">import</span> { text } <span class="hljs-keyword">from</span> <span class="hljs-string">'@storybook/addon-knobs/react'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> stories = storiesOf(<span class="hljs-string">'ExampleComponent'</span>, <span class="hljs-built_in">module</span>);<font></font>
<font></font>
stories.add(<span class="hljs-string">'ExampleComponent'</span>, () =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ExampleComponent</span> <span class="hljs-attr">text</span>=<span class="hljs-string">{text(</span>'<span class="hljs-attr">text</span>', '<span class="hljs-attr">Some</span> <span class="hljs-attr">text</span>')} /&gt;</span></span>, {
   <span class="hljs-attr">info</span>: { <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span> },
   <span class="hljs-attr">text</span>: <span class="hljs-string">`

  ### Notes

  Simple example component

  ### Usage
  ~~~js
  &lt;ExampleComponent
    text="Some text"
  /&gt;
  ~~~

`</span>
});</code></pre><br>
<p>  :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">knobs</a> —       props    Storybook .     props     stories</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">info</a> —      props   story</li>
</ul></div></div><br>
<p>  ,    storybook     <code>package.json</code>  <code>storybook</code>.     <code>npm run storybook</code>. Storybook      <code>http://localhost:6006</code>.         <code>typescript</code>  <code>Rollup</code> — <code>'src/**/*.stories.tsx'</code>.</p><br>
<h3 id="razrabatyvaem"></h3><br>
<p>,          ,      .         <code>src/components</code>   .          — css,    tsx-, , stories.  storybook,    stories,      .    . -     <code>index.ts</code>.</p><br>
<p> ,    <code>npm</code>       npm-.       git-   master,     . ,     :</p><br>
<pre><code class="bash hljs">npm i -s git+https://github.com/jmorozov/react-library-example.git</code></pre><br>
<p>  -    <code>node_modules</code>     <code>dist</code>   ,     <code>scripts</code>  <code>"prepare": "npm run build"</code>. </p><br>
<p>,  TS,     IDE.</p><br>
<h2 id="podvodim-itogi"> </h2><br>
<p>  2019           React  TypeScript,    .         ,     .    ,       .    ,       ,  ,    .</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<p>  ,         , ,   -.                 .  ,       . Happy coding!</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461425/index.html">プロダクトマネージャーになり、さらに成長する方法</a></li>
<li><a href="../ja461431/index.html">「好き嫌い」：DNS over HTTPS</a></li>
<li><a href="../ja461433/index.html">Net Core 3.0でのIdentity Server 4の使用</a></li>
<li><a href="../ja461435/index.html">畳み込みニューラルネットワークを使用した感情認識</a></li>
<li><a href="../ja461437/index.html">370個の電球</a></li>
<li><a href="../ja461441/index.html">Rを使用したスト​​レージの状態に関するレポート。並列コンピューティング、グラフ、xlsx、電子メールなど</a></li>
<li><a href="../ja461443/index.html">事後分析：SKS Keyserver暗号鍵サーバーネットワークに対する最新の攻撃について知られていること</a></li>
<li><a href="../ja461447/index.html">絶滅危惧種としてのシステム管理者に関する叙事詩</a></li>
<li><a href="../ja461449/index.html">PhpStorm 2019.2：PHP 7.4型付きプロパティ、重複するファインダー、EditorConfig、シェルスクリプトなど</a></li>
<li><a href="../ja461451/index.html">俳句との私の2日目：嬉しいですが、まだ行く準備ができていません</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>