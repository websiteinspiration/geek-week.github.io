<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👰 ✉️ 👈🏻 Leitfaden zur Reverse Client-Server-Apk am Beispiel des Jobs NeoQUEST-2020 🌥️ ✊🏽 ☝🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute haben wir ein umfangreiches Programm (es würde so viele Cybersicherheitsbereiche gleichzeitig geben!): Erwägen Sie, eine Android-Anwendung zu de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Leitfaden zur Reverse Client-Server-Apk am Beispiel des Jobs NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/496922/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f0/7j/vf/f07jvfe9r6534tbgp9bwdruryvy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heute haben wir ein umfangreiches Programm (es würde so viele Cybersicherheitsbereiche gleichzeitig geben!): Erwägen Sie, eine Android-Anwendung zu dekompilieren, den Datenverkehr abzufangen, um URLs abzurufen, apk ohne Quellcode neu zu erstellen, mit Kryptoanalytikern zu arbeiten und vieles mehr :) </font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Legende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nach</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fand der Held </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NeoQUEST-2020</font></a><font style="vertical-align: inherit;"> alte Roboterteile, die verwendet werden müssen, um den Schlüssel zu erhalten. </font><font style="vertical-align: inherit;">Lass uns anfangen!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Reversim apk</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor uns liegt also ein wenig, das wir aus einem halb zerlegten Roboter extrahieren konnten - eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apk-Anwendung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die uns irgendwie helfen sollte, den Schlüssel zu bekommen. Lassen Sie uns das offensichtlichste tun: Führen Sie apk aus und sehen Sie sich die Funktionalität an. Die mehr als minimalistische Anwendungsoberfläche lässt keinen Zweifel offen - dies ist ein benutzerdefinierter FileDroid-Datei-Client, mit dem Sie eine Datei von einem Remote-Server herunterladen können. Okay, es sieht einfach aus. Wir verbinden das Telefon mit dem Internet, machen einen Testversuch zum Herunterladen (sofort key.txt - na ja, was ist wenn?) - erfolglos fehlt die Datei auf dem Server. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/kf/z3/b4kfz3wd44ev6ckfy664ba0ugho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen hinsichtlich der Komplexität zum nächsten Ereignis über - wir dekompilieren apk mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JADX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und analysieren Sie den Quellcode der Anwendung, der zum Glück überhaupt nicht verschleiert ist. Unsere aktuelle Aufgabe besteht darin, zu verstehen, welche Dateien der Remote-Server zum Herunterladen anbietet, und die Datei mit dem Schlüssel auszuwählen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir beginnen mit der Klasse com.ctf.filedroid.MainActivity, die die für uns interessanteste onClick () -Methode enthält, bei der der Klick auf die Schaltfläche „Download“ verarbeitet wird. Innerhalb dieser Methode wird die ConnectionHandler-Klasse zweimal aufgerufen: Zuerst wird die ConnectionHandler.getToken () -Methode aufgerufen und erst dann ConnectionHandler.getEncryptedFile (), die den Namen der vom Benutzer angeforderten Datei übergibt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m5/66/by/m566byk1sozhodekerf1ggpf1hc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, das heißt, zuerst brauchen wir einen Token! Wir werden uns etwas näher mit dem Prozess der Erlangung befassen.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die ConnectionHandler.getToken () -Methode verwendet zwei Eingabezeilen und sendet dann eine GET-Anforderung, wobei diese Zeilen als Parameter "crc" und "sign" übergeben werden. Als Antwort sendet der Server die Daten im JSON-Format, aus dem unsere Anwendung das Zugriffstoken extrahiert und zum Herunterladen der Datei verwendet. Das ist natürlich alles gut, aber was sind "crc" und "sign"? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/gy/lg/yngylgy7dstfocghhk0w_eufgcg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies zu verstehen, gehen wir weiter in Richtung der Checks-Klasse und stellen freundlicherweise die Methoden badHash () und badSign () zur Verfügung. Der erste berechnet die Prüfsumme aus classes.dex und resources.arsc, verkettet diese beiden Werte und verpackt sie in Base64 (beachten Sie das Flag 10 = NO_WRAP | URL_SAFE, dies ist praktisch). Und was ist mit der zweiten Methode? Dasselbe tut er mit dem SHA-256-Fingerabdruck der Anwendungssignatur. Eh, es sieht so aus, als ob FileDroid nicht wirklich darauf aus ist, wieder aufgebaut zu werden :(</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/yj/xo/ljyjxoxvrlc8q3pjfxyrerya5ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, sagen wir, wir haben den Token erhalten. Was weiter? Wir übergeben es an die Eingabe der ConnectionHandler.getEncryptedFile () -Methode, die den Namen der angeforderten Datei an das Token anfügt und eine weitere GET-Anforderung generiert, diesmal mit den Parametern "token" und "file". Der Server sendet als Antwort (gemessen am Namen der Methode) eine verschlüsselte Datei, die auf / sdcard / gespeichert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eine kleine Zwischensumme zusammenzufassen: Wir haben zwei Neuigkeiten und ... beide sind schlecht. Erstens unterstützt FileDroid unseren Eifer, apk zu ändern (Prüfsumme und Signatur werden überprüft), nicht wirklich, und zweitens verspricht die vom Server empfangene Datei, verschlüsselt zu werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Okay, wir werden die Probleme lösen, sobald sie verfügbar sind, und jetzt besteht unser Hauptproblem darin, dass wir immer noch nicht wissen, welche Datei wir herunterladen müssen. Während des Studiums der ConnectionHandler-Klasse konnten wir jedoch feststellen, dass die FileDroid-Entwickler zwischen den Methoden getToken () und getEncryptedFile () eine weitere sehr verführerische Methode namens speakListing () vergessen haben. Der Server unterstützt also solche Funktionen ... Es scheint, dass Sie dies benötigen!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fk/xz/v1/fkxzv1ac9ictxo7gy67ku_u44nq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Auflistung zu erhalten, benötigen wir das bekannte "crc" und "sign" - kein Problem, wir wissen bereits, woher sie kommen. </font><font style="vertical-align: inherit;">Wir lesen die Werte, senden eine GET-Anfrage und ... Also, hör auf. </font><font style="vertical-align: inherit;">Wohin senden wir die GET-Anfrage? </font><font style="vertical-align: inherit;">Es wäre schön, zuerst die URL des Remote-Servers zu erhalten. </font><font style="vertical-align: inherit;">Eh, wir kehren zu MainActivity.onClick () zurück und sehen, wie die netPath-Argumente generiert werden, um die Methoden getToken () und getEncryptedFile () aufzurufen:</font></font><br>
<br>
<pre><code class="coffeescript hljs">Method getSecureMethod = <font></font>
wat.class.getDeclaredMethod("getSecure", <span class="hljs-keyword">new</span> Class[]{String.class});<font></font>
<font></font>
// . . .<font></font>
<font></font>
// netPath --&gt; ConnectionHandler.getToken()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"fnks"})<font></font>
<font></font>
// netPath --&gt; ConnectionHandler. getEncryptedFile()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"qdkm"})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seltsame Buchstabenkombinationen „fnks“ und „qdmk“ zwingen uns, uns dem Ergebnis der Dekompilierung der Methode wat.getSecure () zuzuwenden. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoiler: JADX hat dieses Ergebnis so lala. </font></font></s><br>
<br>
<img src="https://habrastorage.org/webt/-r/ih/gi/-rihgizr3f3kvj0uge_1ekoaxsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei näherer Betrachtung wird deutlich, dass all dieser nicht sehr angenehme Inhalt der Methode durch den üblichen Schaltkasten dieser Art ersetzt werden kann:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-regexp">//</span> . . .
<span class="hljs-keyword">switch</span>(CODE)<font></font>
{<font></font>
    case «qdkm»: <font></font>
        r<span class="hljs-number">.2</span> = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case «tkog»: <font></font>
        r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case «fnks»: <font></font>
        String r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">0</span>);
	<span class="hljs-keyword">break</span>;<font></font>
}<font></font>
java.lang.StringBuilder r1 = <span class="hljs-keyword">new</span> java.lang.StringBuilder <font></font>
r1.&lt;init&gt;(r2) <font></font>
java.lang.String r0 = r1.toString() <font></font>
java.lang.String r1 = radon(r0)<font></font>
<span class="hljs-keyword">return</span> r1 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da "fnks" und "qdmk" bereits verwendet werden, um ein Token abzurufen und eine Datei herunterzuladen, sollte "tkog" die URL angeben, die erforderlich ist, um eine Liste der verfügbaren Dateien auf dem Server anzufordern. </font><font style="vertical-align: inherit;">Es scheint, dass es eine Hoffnung gibt, den erforderlichen Pfad billig zu erhalten ... Lassen Sie uns zunächst sehen, wie URLs in der Anwendung gespeichert werden. </font><font style="vertical-align: inherit;">Wir öffnen die Funktion com.ctf.filedroid.x37AtsW8g.rlieh786d () und sehen, dass jede URL als codiertes Bytearray gespeichert wird und die Funktion selbst aus diesen Bytes eine Zeichenfolge bildet und diese zurückgibt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/4e/xz/yt4exza37qeytal-i9snbrlo4co.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gut. </font><font style="vertical-align: inherit;">Dann wird die Zeile an die Funktion com.ctf.filedroid.wat.radon () übergeben, deren Implementierung an die native Bibliothek libae3d8oe1.so gesendet wird. </font><font style="vertical-align: inherit;">Reverse Arm64? </font><font style="vertical-align: inherit;">Netter Versuch, FileDroid, aber kommst du zu einem anderen Zeitpunkt?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Holen Sie sich die Server-URLs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir, uns von der anderen Seite zu nähern: Um den Datenverkehr abzufangen, URLs im Klartext abzurufen (und als Bonus auch Prüfsummen- und Signaturwerte!), Ordnen Sie sie Byte-Arrays von com.ctf.filedroid.x37AtsW8g.rlieh786d () zu - das kann Stellt sich heraus, dass die Verschlüsselung die übliche Caesar- oder XOR-Verschlüsselung ist? Dann ist es nicht schwierig, die dritte URL wiederherzustellen und die Auflistung durchzuführen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Datenverkehr umzuleiten, können Sie einen beliebigen Proxy verwenden ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fiddler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BURP)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usw.). Wir konfigurieren die Weiterleitung auf einem mobilen Gerät, installieren das entsprechende Zertifikat, überprüfen, ob das Abfangen erfolgreich ist, und starten FileFroid. Wir versuchen eine beliebige Datei herunterzuladen und ... siehe "NetworkError". Dieser Fehler wurde durch das Vorhandensein von Zertifikat-Pinning verursacht (siehe Methode com.ctf.filedroid.ConnectionHandler.sendRequest): Der Datei-Client überprüft, ob das in der Anwendung „verkabelte“ Zertifikat dem Server entspricht, mit dem es interagiert. Jetzt ist klar, warum die Integrität der Anwendungsressourcen kontrolliert wird! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8y/su/ya/8ysuya2vqxuwxdzrmt9xsuajq7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im abgefangenen Datenverkehr sehen wir jedoch mindestens den Domänennamen des Servers, auf den der Datei-Client zugreift, was bedeutet, dass die Hoffnung auf Entschlüsselung der URLs bestehen bleibt!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/2w/8l/im2w8l7u7b0optrada1cuhbxcge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kehren wir zur Funktion com.ctf.filedroid.x37AtsW8g.rlieh786d () zurück und beachten Sie, dass die ersten zehn Bytes in allen Arrays übereinstimmen:</font></font><br>
<br>
<pre><code class="coffeescript hljs">cArr[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'i'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . ., <span class="hljs-string">'='</span>};
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus weist das letzte Byte des dritten Arrays darauf hin, dass es nicht ohne base64 war. </font><font style="vertical-align: inherit;">Versuchen wir, die resultierenden Bytes mit einem bekannten Teil der URL zu dekodieren und </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8o/mh/1m/8omh1mtmtqzkcdy7mpqyemyiuzw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
zu stecken </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Es scheint, dass noch nie jemand so glücklich mit ARMag3dd0n war! </font><font style="vertical-align: inherit;">Die Sache ist klein: Decodieren Sie nacheinander base64-URLs und xorim mit dem gefundenen Schlüssel. </font><font style="vertical-align: inherit;">Aber ... und wenn es nicht XOR war, sondern eine selbst erstellte Permutations-Chiffre, die Sie selbst mit hundert Versuchen nicht erfassen können?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Baue apk mit Frida wieder auf</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Rahmen dieses Aufsatzes werden wir eine schmerzlosere (und unserer Meinung nach schönere) Lösungsmethode in Betracht ziehen - unter Verwendung des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frida-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Frameworks </font><font style="vertical-align: inherit;">, mit dem wir beliebige apk-Anwendungsmethoden mit den Argumenten ausführen können, die wir zur Laufzeit benötigen. </font><font style="vertical-align: inherit;">Dazu benötigen Sie ein Telefon mit Root-Rechten oder einen Emulator. </font><font style="vertical-align: inherit;">Wir gehen von folgendem Aktionsplan aus:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren von Frida-Komponenten auf einem PC und einem Testtelefon.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie URLs wieder her, die mit Token- oder Listenanforderungen übereinstimmen, und laden Sie die Datei herunter (mithilfe von Frida).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen der Prüfsummen- und Signaturwerte der ursprünglichen Anwendung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen einer Liste der auf dem Server gespeicherten Dateien und Identifizieren der gewünschten Datei.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laden Sie die Datei herunter und entschlüsseln Sie sie.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst werden wir die Beziehung zwischen dem verwurzelten Telefon und apk klären. Wir installieren die Anwendung, führen sie aus, aber der Datei-Client möchte nicht vollständig booten, sondern blinkt nur und wird geschlossen. Wir überprüfen Nachrichten über logcat - ja, FileDroid hat bereits das Gefühl, dass etwas nicht stimmt, und widersteht so gut es geht. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/8s/2b/vn8s2bzyijssy664hsdgcxqnawc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir wenden uns erneut der MainActivity-Klasse zu und stellen fest, dass die doChecks () -Methode in onCreate () aufgerufen wird und die folgenden Fehler im Protokoll anzeigt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/xl/i6/wsxli6hxrjmgqnnkuh6b5a7h8my.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem prüft onResume (), ob der für Frida typische Port geöffnet ist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-k/df/kv/-kdfkvyea8g0p6y-dkwxpk3flo4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser Datei-Client ist etwas intolerant zu debuggen, root und Frida selbst. Ein solcher Widerspruch ist in unseren Plänen absolut nicht enthalten, daher erhalten wir den Smali-Code der Anwendung mit dem Dienstprogramm </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apktool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Öffnen Sie die Datei MainActivity.smali in einem beliebigen Texteditor, suchen Sie die Methode onCreate () und verwandeln Sie den Aufruf von doChecks () in einen harmlosen Kommentar: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z6/r2/ra/z6r2rautxzhef-0prc9odxmj2ek.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann entziehen wir </font><font style="vertical-align: inherit;">der Methodeicide () </font><font style="vertical-align: inherit;">die Möglichkeit, die Anwendung wirklich herunterzufahren: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/ti/q6/iutiq6k6idg5_6h7wd1he2mjyem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Nächstes erstellen wir unsere leicht verbesserte Anwendung erneut mit apktool und sign Führen Sie die folgenden Befehle aus (möglicherweise benötigen Sie Administratorrechte):</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> <span class="hljs-string">"C:\Program Files\Java\jdk-14\bin"</span>
.\keytool -genkey -v -keystore filedroid.keystore -<span class="hljs-built_in">alias</span> filedroid_alias -keyalg RSA -keysize 2048 -validity 10000<font></font>
.\jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore  filedroid.keystore filedroid_patched.apk filedroid_alias<font></font>
.\jarsigner -verify -verbose -certs filedroid_patched.apk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir installieren die Anwendung auf dem Telefon neu, führen sie aus - Hurra, der Download verläuft ohne Zwischenfälle, das Protokoll ist sauber! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qm/u4/k2/qmu4k2ta7zji47msjnyhhq8ibqi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir fahren fort, das Frida-Framework auf einem PC und einem mobilen Gerät zu installieren:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo pip3 install frida-tools<font></font>
$ wget https://github.com/frida/frida/releases/download/$(frida --version)/frida-server-$(frida --version)-android-arm.xz<font></font>
$ unxz frida-server-$(frida --version)-android-arm.xz<font></font>
$ adb push frida-server-$(frida --version)-android-arm /data/<span class="hljs-built_in">local</span>/tmp/frida-server
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starten Sie den Frida Framework-Server auf einem mobilen Gerät:</font></font><br>
<br>
<pre><code class="bash hljs">$ adb shell su - <span class="hljs-string">"chmod 755 /data/local/tmp/frida-server"</span>
$ adb shell su - <span class="hljs-string">"/data/local/tmp/frida-server &amp;"</span>  
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bereiten ein einfaches get-urls.js-Skript vor, das wat.getSecure () für alle unterstützten Anforderungsserver aufruft:</font></font><br>
<br>
<pre><code class="actionscript hljs">Java.perform(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> 
</span>{
     <span class="hljs-keyword">const</span> wat = Java.use(<span class="hljs-string">'com.ctf.filedroid.wat'</span>);<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"fnks"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"qdmk"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"tkog"</span>));<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir starten FileDroid auf dem mobilen Gerät und „klammern“ uns mit unserem Skript an den entsprechenden Prozess: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/ir/if/pcirifn_grrejaapwi7s-7hg-xe.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Rufen Sie die Liste der Dateien auf dem Server ab</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Endlich ist uns der Remote-Server etwas näher gekommen! </font><font style="vertical-align: inherit;">Jetzt wissen wir, dass der Server Anforderungen auf folgende Weise unterstützt:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filesroid.neoquest.ru/api/verifyme?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filesroid.neoquest.ru/api/list_post_apocalyptic_collection?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filesroid.neoquest.ru/api/file?file=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {file} &amp; token = {token}</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eine Liste der verfügbaren Dateien zu erhalten, müssen die Prüfsummen- und Signaturwerte der ursprünglichen Anwendung berechnet und anschließend in base64 codiert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit einem solchen Skript in Python3 können Sie Folgendes tun:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoiler</font></font></b>
                        <div class="spoiler_text"><pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> binascii
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> asn1crypto <span class="hljs-keyword">import</span> cms, x509
<span class="hljs-keyword">from</span> zipfile <span class="hljs-keyword">import</span> ZipFile<font></font>
<font></font>
<font></font>
def get_info(apk):<font></font>
    with ZipFile(apk, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> zipObj:<font></font>
        classes = zipObj.read(<span class="hljs-string">"classes.dex"</span>)<font></font>
        resources = zipObj.read(<span class="hljs-string">"resources.arsc"</span>)<font></font>
        cert = zipObj.read(<span class="hljs-string">"META-INF/CERT.RSA"</span>)<font></font>
        crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
        <span class="hljs-keyword">return</span> get_full_crc(classes, resources).decode(<span class="hljs-string">"utf-8"</span>), get_sign(cert).decode(<span class="hljs-string">"utf-8"</span>)<font></font>
<font></font>
<font></font>
def get_crc(file):<font></font>
    crc = binascii.crc32(file) &amp; <span class="hljs-number">0xffffffff</span>
    <span class="hljs-keyword">return</span> crc<font></font>
<font></font>
<font></font>
def get_full_crc(classes, resources):<font></font>
    crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(bytes(crc, <span class="hljs-string">"utf-8"</span>))<font></font>
<font></font>
<font></font>
def get_sign(file):<font></font>
    pkcs7 = cms.ContentInfo.load(file)<font></font>
    data = pkcs7[<span class="hljs-string">'content'</span>][<span class="hljs-string">'certificates'</span>][<span class="hljs-number">0</span>].chosen.dump()<font></font>
    sha256 = hashlib.sha256()<font></font>
    sha256.update(data)<font></font>
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(sha256.digest())  <font></font>
<font></font>
get_info(<span class="hljs-string">'filedroid.apk'</span>)
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können auch manuell. Wir betrachten CRC32 von classes.dex und resources.arsc jedes geeignete Werkzeug zu sein (zB für Linux - die Standard - </font><font style="vertical-align: inherit;">crc32 Dienstprogramm), wir die Werte 1276945813 und 2814166583 bzw. erhalten, verketten sie (12769458132814166583 kommt heraus) und codieren in base64 zum Beispiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/ba/km/wbbakmhm-8jmtyyudjhofelaz8s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um ein ähnliches Verfahren zum Signieren der Anwendung auszuführen, gehen Sie im JADX-Fenster zum Abschnitt „APK-Signatur“, kopieren Sie den Wert „SHA-256 Fingerprint“ und codieren Sie ihn in base64 als Byte-Array: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/s9/zg/wxs9zgvtahyytsnvxis-k8lq8wg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wichtig:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der ursprünglichen apk wird die base64-Codierung mit dem URL_SAFE-Flag durchgeführt, d.h. </font><font style="vertical-align: inherit;">Anstelle der Zeichen "+" und "/" werden "-" und "_" verwendet. </font><font style="vertical-align: inherit;">Es ist darauf zu achten, dass dies auch bei der Selbstcodierung beachtet wird. </font><font style="vertical-align: inherit;">Um dies zu tun, können Sie beim Online-Codieren das mit "ABCDEFGHIJKLMNOPQRSTUVWXYZabcde fghijklmnopqrstuvwxyz0123456789 + /" verwendete Alphabet durch "ABCDEFGHIJKLMNOPQRSTUVWXYZabc script64" verwenden </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich haben wir alle Zutaten für eine erfolgreiche Auflistung von Dateien:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filesroid.neoquest.ru/api/list_post_apocalyptic_collection?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crc: MTI3Njk0NTgxMzI4MTQxNjY1ODM =</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeichen: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY =</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir führen die GET-Anfrage aus - und Prost, unsere Auflistung! </font><font style="vertical-align: inherit;">Darüber hinaus spricht der Name einer der Dateien für sich selbst - "Öffnen, wenn Sie entkommen wollen" - es scheint, dass wir ihn brauchen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/k4/vz/bkk4vzawktgg1ilhn1x06q90ahq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes fordern wir ein einmaliges Zugriffstoken an und laden die Datei herunter:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/verifyme'</span>, <font></font>
    		params={    <span class="hljs-string">'crc'</span>: <span class="hljs-string">'MTI3Njk0NTgxMzI4MTQxNjY1ODM='</span>, 
<span class="hljs-string">'sign'</span>: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY=},<font></font>
verify=False)<font></font>
    <font></font>
token = response.json()[<span class="hljs-string">'token'</span>]
<span class="hljs-built_in">print</span>(token)<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/file'</span>, <font></font>
params={<span class="hljs-string">'token'</span>: token, <span class="hljs-string">'file'</span>: <span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>}, verify=False)<font></font>
<font></font>
with open(<span class="hljs-string">"0p3n1fuw4nt2esk4p3.jpg"</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> fd:<font></font>
        fd.write(response.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir öffnen die heruntergeladene Datei und erinnern uns an einen kleinen Umstand, den wir für später hinterlassen haben:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/dc/rz/ktdcrzjrng635moxnmt5_phu2nu.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Fügen Sie eine Prise Kryptographie hinzu ...</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh, zu früh haben wir FileDroid verschoben. Kehren wir zu JADX zurück und prüfen, ob die Entwickler des Datei-Clients uns etwas Nützliches hinterlassen haben. Ja, dies ist der Fall, wenn die Codebereinigung eindeutig nicht beliebt ist: Die nicht verwendete decryptFile () -Methode wartet leise auf unsere Aufmerksamkeit in der ConnectionHandler-Klasse. Was wir haben? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verschlüsselung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AES-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der CBC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sinhroposylka belegt die ersten 16 Bytes ... Faulheit - der Motor des Fortschritts, es ist besser, wieder Frida zu verwenden und unser 0p3n1fuw4nt2esk4p3.jpg mühelos zu entschlüsseln. Aber einfach als Verschlüsselungsschlüssel übergeben? Es gibt nicht viele Optionen, aber angesichts des Vorhandenseins einer anderen "vergessenen" savePlainFile-Methode (String-Datei, String-Token) liegt die Wahl auf der Hand. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bereiten Sie das folgende decrypt.js-Skript vor (als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Geben Sie den tatsächlichen Wert an, z. B. 'HoHknc572mVpZESSQN1Xa7S9zOidxX1PMbykdoM1EXI ='):</font></font><br>
<br>
<pre><code class="coffeescript hljs">Java.perform(function () {<font></font>
    const JavaString = Java.use(<span class="hljs-string">'java.lang.String'</span>);<font></font>
    const file_name = JavaString.$<span class="hljs-keyword">new</span>(<span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>);<font></font>
    const ConnectionHandler = Java.use(<span class="hljs-string">'com.ctf.filedroid.ConnectionHandler'</span>);<font></font>
    const result = ConnectionHandler.savePlainFile(file_name, &lt;token&gt;);<font></font>
    <span class="hljs-built_in">console</span>.log(result);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir legen die verschlüsselte Datei 0p3n1fuw4nt2esk4p3.jpg auf / sdcard / ab, führen FileDroid aus und fügen das Skript decrypt.js mit Frida ein. </font><font style="vertical-align: inherit;">Nachdem das Skript ausgeführt wurde, wird die Datei plainfile.jpg auf / sdcard / angezeigt. </font><font style="vertical-align: inherit;">Wir öffnen es und ... gerade gelöst! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fb/3-/ah/fb3-ahlzcqlnfjsromkmbz9eil0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für diese schwierige Aufgabe mussten die Teilnehmer über Kenntnisse und Fähigkeiten in verschiedenen Bereichen der Informationssicherheit gleichzeitig verfügen, und wir freuen uns, dass die meisten Wettbewerber erfolgreich damit fertig wurden! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir hoffen, dass diejenigen, die vor Erhalt des Schlüssels nicht genügend Zeit oder Wissen hatten, ähnliche Aufgaben in einer CTF erfolgreich bestehen werden :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496910/index.html">Erstellen und passen Sie Ihr CDN an</a></li>
<li><a href="../de496912/index.html">ThinkPad E480 Intel unter Windows VS ThinkPad E495 AMD unter Ubuntu Gibt es einen Unterschied?</a></li>
<li><a href="../de496914/index.html">Das kürzeste Dezimalprogramm</a></li>
<li><a href="../de496916/index.html">Fernunterricht, Verhandlung und Beratung - Teil 3: Yealink Meeting Server und 4 Sonderangebote</a></li>
<li><a href="../de496920/index.html">Mit ASP.NET Core und Arduino ein Smart Home erstellen</a></li>
<li><a href="../de496924/index.html">Webkomponenten-Routing</a></li>
<li><a href="../de496936/index.html">Verschlüsseln wir SSL-Zertifikate mit dem Cert-Manager in Kubernetes</a></li>
<li><a href="../de496938/index.html">Supercomputer, Genomsequenzierung und die Aussichten, das Coronavirus zu besiegen</a></li>
<li><a href="../de496940/index.html">Wie GM-Ingenieure Elektronik testen</a></li>
<li><a href="../de496942/index.html">Digitale Ereignisse in Moskau vom 13. bis 19. April</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>