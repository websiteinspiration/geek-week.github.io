<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐴 🐔 🛄 ミハイル・サロシン。Golang Meetup。Watch +アプリケーションのバックエンドでGoを使用する 🤚 🎲 👩🏾‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ミハイルサロシン（以下-MS）： -みなさん、こんにちは！私の名前はマイケルです。私はMC2 Softwareでバックエンド開発者として働いており、Watch +モバイルアプリケーションのバックエンドでGoを使用することについて話します。
 
 
 
 ホッケーのように存在する人はいますか？
 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ミハイル・サロシン。Golang Meetup。Watch +アプリケーションのバックエンドでGoを使用する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/490750/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミハイルサロシン（以下-MS）：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -みなさん、こんにちは！</font><font style="vertical-align: inherit;">私の名前はマイケルです。</font><font style="vertical-align: inherit;">私はMC2 Softwareでバックエンド開発者として働いており、Watch +モバイルアプリケーションのバックエンドでGoを使用することについて話します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/pc/yj/tfpcyjrufa8t1o-_ilgh2iqqb1w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホッケーのように存在する人はいますか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/td/g7/l_/tdg7l_zyrrg7vw1shoc3fdxywda.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このアプリはあなたのためです。</font><font style="vertical-align: inherit;">AndroidおよびiOS向けで、オンラインやレコーディングでさまざまなスポーツイベントの放送を見るために使用されます。</font><font style="vertical-align: inherit;">また、アプリケーションには、さまざまな統計、テキストブロードキャスト、会議用テーブル、トーナメント、およびファンに役立つその他の情報があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ps/cn/fa/pscnfash29d-yqq6ldluvigihoq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、アプリケーションにはビデオの瞬間などのようなものがあります。つまり、試合の激しい瞬間（ゴール、戦い、シュートアウトなど）を見ることができます。</font><font style="vertical-align: inherit;">放送全体を見たくない場合は、最も興味深いものだけを見ることができます。</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発に何が使用されましたか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本体は囲碁で書かれました。モバイルクライアントが通信するAPIはGoで記述されています。また、モバイルにプッシュ通知を送信するためのサービスがGoに作成されました。また、いつか話し合う可能性のある独自のORMを作成する必要がありました。さて、いくつかの小さなサービスはGoで書かれています：エディターのサイズ変更と画像の読み込み... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースとしてPostgres（PostgreSQL）を使用しました。エディター用のインターフェースは、ActiveAdmin gemを使用してRuby on Railsで作成されました。統計プロバイダーからの統計のインポートもRubyで書かれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムAPIテストでは、Pythonユニットテスト（Python）を使用しました。</font><font style="vertical-align: inherit;">MemcachedはAPI支払い要求の抑制、Chefは構成の制御、Zabbixは内部システム統計の収集と監視に使用されます。</font><font style="vertical-align: inherit;">Graylog2-ログを収集するためのSlateは、クライアント向けのAPIドキュメントです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n5/v_/tc/n5v_tcwffefrpa-fxomv5jc_moc.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコルの選択</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが最初に遭遇した問題：次の点に基づいて、バックエンドとモバイルクライアントのやり取りのためのプロトコルを選択する必要がありました...</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も重要な要件：クライアントのデータはリアルタイムで更新する必要があります。</font><font style="vertical-align: inherit;">つまり、現在放送を視聴しているすべての人がほぼ瞬時に更新を受信する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単にするために、クライアントと同期されているデータは削除されず、特別なフラグを使用して非表示になることを受け入れました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あらゆる種類のまれな要求（統計、ラインナップ、チーム統計など）は、通常のGET要求によって受信されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加えて、システムは同時に10万人のユーザーに穏やかに耐えることができました。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに基づいて、2つのプロトコルオプションがありました。</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebSocket。</font><font style="vertical-align: inherit;">しかし、クライアントからサーバーへのチャネルは必要ありませんでした。</font><font style="vertical-align: inherit;">サーバーからクライアントに更新を送信するだけでよいため、Webソケットは冗長なオプションです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバー送信イベント（SSE）がちょうどいいようになりました！</font><font style="vertical-align: inherit;">それは非常にシンプルで、基本的に私たちが必要とするすべてを満たしています。</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバー送信イベント</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがどのように機能するかについての簡単な説明... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
http接続の上で機能します。</font><font style="vertical-align: inherit;">クライアントはリクエストを送信し、サーバーはContent-Type：text / event-streamで応答し、クライアントとの接続を閉じませんが、接続へのデータの書き込みを続行します。データ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0s/qp/5j/0sqp5jdkevts9970rrbpwa0bm9i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はクライアントと合意した形式で送信できます。</font><font style="vertical-align: inherit;">この例では、次の形式で送信しました。イベントフィールドに変更された構造の名前（person、player）が送信され、データフィールド-プレーヤーの新しい変更されたフィールドを含むJSONが送信されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、相互作用自体がどのように機能するかについて説明します。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まず、クライアントはサービスとの最後の同期がいつ行われたかを判断します。クライアントはローカルデータベースを調べ、そこから記録された最後の変更の日付を判断します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼はこの日付でリクエストを送信します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それに応えて、この日に行われたすべての更新を送信します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その後、ライブチャネルに接続し、次の更新が必要になるまで閉じません。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/_v/t9/t1/_vt9t1r7nq_--sskm6vc_-0qydw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは彼に変更のリストを送信します。誰かがゴールを決めた場合-私たちは試合のスコアを変更し、怪我をしました-リアルタイムでも送信されます。</font><font style="vertical-align: inherit;">したがって、試合のイベントストリームでは、顧客は関連データを即座に受け取ります。</font><font style="vertical-align: inherit;">定期的に、サーバーが停止していないこと、クライアントに何も起こっていないことをクライアントが理解できるように、15秒ごとにタイムスタンプを送信します。これにより、すべてが正常であり、再接続する必要がないことがわかります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブ接続はどのように提供されますか？</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まず、バッファを使用した更新が行われるチャネルを作成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その後、このチャンネルを購読してアップデートを受信します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正しいヘッダーを設定して、クライアントがすべて問題ないことを認識できるようにします。</font></font></li>
<li>  ping.    timestamp .</li>
<li>         ,     .       timestamp,  ,       .</li>
</ul><br>
<img src="https://habrastorage.org/webt/rf/hl/s9/rfhls98e0zi4dogfbjpptkb-feg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが遭遇した最初の問題は次のとおりです：クライアントで開かれた各接続について、15秒ごとに1刻みのタイマーを作成しました-1つのマシン（1つのAPIサーバー）との接続が6,000ある場合、 6000のタイマーが作成されました。</font><font style="vertical-align: inherit;">これは、マシンが必要な負荷を保持していないという事実につながりました。</font><font style="vertical-align: inherit;">問題は私たちにはそれほど明白ではありませんでしたが、彼らは私たちを少し助けてくれ、私たちはそれを排除しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、更新が送信されたのと同じチャネルからpingが送信されるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、15秒に1回ティックするタイマーは1つだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにいくつかのヘルパー関数があります-ヘッダー、ping、および構造自体を送信します。</font><font style="vertical-align: inherit;">つまり、テーブルの名前（人、試合、シーズン）とこのレコードに関する情報がここに送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/g2/rh/qug2rhecowmxbnqmqz7zk5p-_7g.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新を送信するメカニズム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、変更がどこから来るのかについて少し説明します。</font><font style="vertical-align: inherit;">放送をリアルタイムで視聴する編集者が何人かいます。</font><font style="vertical-align: inherit;">彼らはすべてのイベントを作成します：誰かが削除された、誰かが怪我をした、ある種の交換... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CMSの助けを借りて、データがデータベースに入れられます。</font><font style="vertical-align: inherit;">その後、Listen / Notifyメカニズムを使用するデータベースは、これについてAPIサーバーに通知します。</font><font style="vertical-align: inherit;">APIサーバーはすでにこの情報をクライアントに送信しています。</font><font style="vertical-align: inherit;">したがって、実際には、データベースに接続されているサーバーはわずかであり、クライアントはデータベースと直接対話しないため、データベースに特別な負荷はかかりません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/wp/ei/azwpei0ysoe2uspec2ybfe9mdag.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL：聞く/通知する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgresのListen / Notifyメカニズムを使用すると、イベントが変更されたことをサブスクライバに通知できます。データベースにある種のレコードが作成されています。これを行うために、単純なトリガーと関数を作成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/i_/ms/hji_msz1f-kwrtijbes4flcctr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レコードを挿入または変更するときは、data_updatesチャネルで通知関数を呼び出し、変更または挿入されたレコードのテーブル名と識別子を転送します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントと同期する必要があるすべてのテーブルについて、レコードを変更または更新した後、下のスライドに示されている関数を呼び出すトリガーを定義します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIはこれらの変更をどのようにサブスクライブしますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファンアウトメカニズムが作成され、クライアントにメッセージが送信されます。彼はすべての顧客チャネルを収集し、これらのチャネルを通じて受け取った更新を送信します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kx/op/vl/kxopvlizual_4yyz48t79flo8w8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、データベースに接続し、チャネル（data_updates）をリッスンすることを希望していることを示す標準のpqライブラリは、接続が開いていることとすべてが正常であることを確認します。</font><font style="vertical-align: inherit;">スペースを節約するためにエラーチェックを省略します（エラーをチェックしないでください）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ティッカーを非同期に設定します。これにより、15秒ごとにpingが送信され、サブスクライブしたチャネルのリスニングが開始されます。</font><font style="vertical-align: inherit;">pingを受け取った場合は、このpingを公開します。</font><font style="vertical-align: inherit;">レコードを受け取った場合、このファンアウトのすべてのサブスクライバーにこのレコードを公開します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファンアウトはどのように機能しますか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロシア語では、これは「スプリッター」として解釈されます。更新を受け取りたいサブスクライバーを登録する1つのオブジェクトがあります。そして、このオブジェクトへの更新が到着するとすぐに、この更新を、それが持っているすべてのサブスクライバーに拡散します。十分にシンプル：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/je/tw/76/jetw76q3dzqifpq22yo9dc3j4ha.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goでの実装方法：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/gl/o8/nzglo8wnz5iwzrtjfc39zlqqxa8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
構造があり、Mutexeを使用して同期されます。これには、Fanout接続のステータスをデータベースに保存するフィールドがあります。つまり、リッスンして更新を受信する時点で、使用可能なすべてのチャネルのリストと、マップです。そのキーは、値の形式のチャネルと構造体です（実際には、まったく使用されません）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの方法-接続および切断-を使用して、Fanoutにベースへの接続があること、および表示され、ベースへの接続が切断されていることを通知できます。 2番目のケースでは、すべてのクライアントを切断し、クライアントとの接続が閉じたため、何も聞くことができなくなり、再接続することをクライアントに通知する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リスナーにチャネルを追加するSubscribeメソッドもあり</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/hu/rh/i1hurht2d0x5mmdikeem_gpmm3i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。クライアントが切断した場合にリスナーからチャネルを削除するUnsubscribeメソッドと、すべてのサブスクライバーにメッセージを送信できるPublishメソッドがあります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">質問：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -このチャネルを通じて何が送信されますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -変更またはpingを実行したモデルが送信されます（基本的には数値、整数のみ）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-何でも送信でき、どのような構造でも公開できます。JSONに変わるだけです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Postgresから通知を受け取り</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;"> -テーブル名と識別子が含まれています。</font><font style="vertical-align: inherit;">取得するテーブルの名前と必要なレコードを取得する識別子によって、この構造は既に公開のために送信されています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インフラ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インフラストラクチャの点でどのように見えますか？ 7台の鉄製サーバーがあります。そのうちの1台は完全にベース専用で、残りの6台で仮想コンピュータが稼働しています。 APIのコピーは6つあります。APIを備えた各仮想マシンは個別のIronサーバーで実行されます-これは信頼性のためです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/2_/4e/hu2_4eyv8ko_you4ygxuowle6m4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクセシビリティを向上させるためにKeepalivedがインストールされている2つのフロントエンドがあるため、一方のフロントエンドがもう一方のフロントエンドを置き換えることができます。 CMSの別の2つのコピー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統計のインポーターもあります。バックアップが定期的に作成されるDBスレーブがあります。 Pigeon Pusherがあります。Zabbix、Graylog2、Chefなどのインフラストラクチャと同様に、顧客にプッシュを送信するアプリケーションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、このインフラストラクチャは冗長です。10万台をより少ないサーバーで処理できるためです。</font><font style="vertical-align: inherit;">しかし、鉄がありました-私たちはそれを使用しました（それが可能であると言われました-なぜそうではないか）</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">囲碁の長所</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプリケーションに取り組んだ後、Goのそのような明らかな利点が明らかになりました。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クールなhttpライブラリ。</font><font style="vertical-align: inherit;">それを使用すると、箱から出してすぐにかなり多くを作成できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、顧客に通知を送信するメカニズムを非常に簡単に実装できるチャネル。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">素晴らしいレース検出機能により、いくつかの重大なバグ（ステージングインフラストラクチャ）を排除できました。</font><font style="vertical-align: inherit;">ステージングで機能するものはすべて実行され、Raceキーでコンパイルされます。</font><font style="vertical-align: inherit;">したがって、ステージングインフラストラクチャに潜在的な問題があるかどうかを確認できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">言語のミニマリズムとシンプルさ。</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/eb/lc/mo/eblcmow1odoou6z22y2rady3n6k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者を募集しています！</font><font style="vertical-align: inherit;">誰かが望むなら-お願いします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ご質問</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
聴衆からの質問（以下-B）：-ファンアウトに関する重要なポイントを1つ逃したようです。クライアントに応答を送信するときに、クライアントが読みたくない場合はブロックされることを正しく理解していますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -いいえ、ブロックしていません。まず、すべてnginxの背後にあります。つまり、遅いクライアントでも問題はありません。第2に、クライアントにはバッファ付きのチャネルがあります。実際には、最大100の更新をそこに置くことができます...チャネルに書き込むことができない場合は、チャネルを削除します。チャネルがブロックされていることがわかった場合は、チャネルを閉じるだけです。問題がある場合、クライアントは再接続します。したがって、原則としてここではブロッキングは発生しません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -識別子テーブルではなく、すぐにListen / Notifyレコードに送信できますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Listen / Notifyは、プリロードごとに8000バイトの制限があり、送信します。原則として、少量のデータを扱っていれば送信することは可能ですが、信頼性の高い方法のように思えます。制限はPostgres自体にあります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -顧客は興味のない試合の最新情報を受け取りますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-一般に、はい。原則として、2〜3件の一致が並行して発生しますが、それは非常にまれです。クライアントが何かを見ている場合、通常、彼は進行中の試合を見ています。次に、クライアントにはローカルデータベースがあり、これらの更新がすべて追加されます。インターネットに接続していなくても、クライアントは更新がある過去のすべての一致を確認できます。実際、サーバー上のデータベースをクライアントのローカルデータベースと同期して、オフラインで作業できるようにします。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ORMを作成したのはなぜですか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexey（「Watch +」の開発者の1人）：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-当時（1年前）、ORMは現在よりも少なく、非常に多く存在していました。既存のORMの大部分のうち、私が最も嫌うのは、それらのほとんどが空のインターフェースで動作することです。つまり、これらの</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ORM </font><font style="vertical-align: inherit;">で準備ができているメソッド：構造体、構​​造体ポインター、数値、まったく関係のないもの... </font><font style="vertical-align: inherit;">私たちのORMは、データモデルに基づいて構造体を生成します。自体。したがって、すべてのメソッドは具体的であり、リフレクションを使用しないなどです。これらのメソッドは構造を受け入れ、次の構造を使用することを期待しています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -何人が参加しましたか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -最初の段階では、2人が参加しました。 6月のどこかで開始し、8月に主要部分の準備が整いました（最初のバージョン）。 9月にリリースがありました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AT：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-SSEについて説明する場合は、タイムアウトを使用しません。何故ですか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -正直なところ、SSEはまだhtml5プロトコルです。SSE標準は、私が理解しているように、ブラウザーと通信するように設計されています。ブラウザーが再接続できるように（など）追加の機能がありますが、情報を接続および受信するためのロジックを実装できるクライアントがあったため、それらは必要ありません。おそらくSSEではなく、SSEに似たものを実行しました。これはプロトコル自体ではありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要はありませんでした。私が理解している限り、クライアントは接続メカニズムをゼロから実装しました。原則として、彼らは気にしませんでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -他にどのユーティリティを使用しましたか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gofmtと同様にスタイルを統一するためにgovetとgolintを使用した最もアクティブなもの。彼らは他に何も使用しませんでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -何をデバッグしましたか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -概して、デバッグはテストを使用して行われました。デバッガーなし、使用しなかったGOP。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -公開機能が実装されているスライドを返せますか？ 1文字の変数名は気になりませんか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -いいえ。それらはかなり「狭い」範囲を持っています。それらは他の場所（ここを除く）（このクラスの内部を除く）で使用されておらず、非常にコンパクトです-たった7行で済みます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -どういうわけかそれはまだ直感的ではありません... </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-いいえ、いいえ、これは本当のコードです！スタイルではありません。これは、非常に実用的な非常に小さなクラスです。クラス内にはフィールドが3つしかありません... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yx/vb/a8/yxvba8lbupf_3aw2halepbbmlce.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -概して、顧客（季節のマッチ、プレーヤー）と同期されるすべてのデータは変更されません。大まかに言えば、試合を変更する必要がある他のスポーツをする場合は、クライアントの新しいバージョンのすべてを考慮するだけで、クライアントの古いバージョンは禁止されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -依存関係管理用のサードパーティパッケージはありますか？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -go depを使用しました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -レポートの件名にビデオについて何かがありましたが、レポートのビデオについてはありませんでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -いいえ、ビデオに関するトピックには何もありません。 「Look +」と呼ばれます-これはアプリケーションの名前です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AT：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-あなたは顧客にストリーミングしていると言いましたか？.. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -私たちはストリーミングビデオをしませんでした。</font><font style="vertical-align: inherit;">これは完全にメガホンによって行われました。</font><font style="vertical-align: inherit;">はい、アプリケーションがメガホンであるとは言いませんでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Go-すべてのデータを送信するには-スコア別、試合イベント別、統計別... Go-これはアプリケーションのバックエンド全体です。</font><font style="vertical-align: inherit;">ユーザーが試合を観戦できるように、クライアントはどこからプレーヤーに使用するリンクを見つける必要があります。</font><font style="vertical-align: inherit;">準備されているビデオとストリームへのリンクがあります。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Kq0cWRBd1MU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">広告のビット:)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。私たちの記事は好きですか？もっと面白い資料を見たいですか？</font><b><font style="vertical-align: inherit;">私たちがあなたのために私たちが発明したエントリーレベルのサーバーのユニークなアナログで</font></b><font style="vertical-align: inherit;">ある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 4.99から</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文またはお友達</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に開発者向けのクラウドベースのVPS</font></a><font style="vertical-align: inherit;">をお勧めすることで私たちをサポートして</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ください：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS（KVM）E5-2697 v3（6コア）10GB DDR4 480GB SSD 1Gbpsの真実19ドルから、またはサーバーを分割する方法？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは、アムステルダムのEquinix Tier IVデータセンターで2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは</font></b><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">199ドルのIntel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></a></b><font style="vertical-align: inherit;">が</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2つ</font></a></b><font style="vertical-align: inherit;">だけあり</font><b><font style="vertical-align: inherit;">ます！</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></font></b></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">インフラストラクチャビルディングの構築方法</font></a><font style="vertical-align: inherit;">について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">お</font></a><font style="vertical-align: inherit;">読みください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dell R730xd E5-2650 v4サーバーを使用するクラスcは、1ペニーで9,000ユーロかかりますか？</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490738/index.html">Liskの置換原理</a></li>
<li><a href="../ja490740/index.html">*** sの欠陥は単なるランダム化ではありません</a></li>
<li><a href="../ja490742/index.html">ロボット工学の新時代が始まりました</a></li>
<li><a href="../ja490746/index.html">Yandex.Taxiでの評価：深刻なトピックに関する短い投稿</a></li>
<li><a href="../ja490748/index.html">開発者の仕事、またはベンダーなしでハンドスキャナーをスキャンする方法</a></li>
<li><a href="../ja490754/index.html">Visual Studioコードコードエディター。初心者向けプラグインのセットアップとインストールに関する最も詳細なガイド</a></li>
<li><a href="../ja490756/index.html">Jenkinsをコードとしてデプロイする</a></li>
<li><a href="../ja490758/index.html">数学者は乱流の普遍的な法則を証明しました</a></li>
<li><a href="../ja490760/index.html">レイキャスティングビジュアルサーチ（RCVS）。ジオメトリが似ている3Dモデルを見つけるためのシンプルで高速なアルゴリズム</a></li>
<li><a href="../ja490762/index.html">航空運賃を予測するには？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>