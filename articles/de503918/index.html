<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏻 ☂️ 🧑🏽‍🤝‍🧑🏽 Verwalten von Paketen mit Go-Modulen: Ein pragmatischer Leitfaden 👨🏻‍🏭 🎿 💷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo alle zusammen. Im Vorfeld des Beginns des Golang-Entwicklerkurses haben wir eine weitere interessante Übersetzung für Sie vorbereitet.
 
 
 Modu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Verwalten von Paketen mit Go-Modulen: Ein pragmatischer Leitfaden</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/503918/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo alle zusammen. </font><font style="vertical-align: inherit;">Im Vorfeld des Beginns des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Golang-Entwicklerkurses haben wir eine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weitere interessante Übersetzung für Sie vorbereitet.</font></font></b></i><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Module sind eine Möglichkeit, mit Abhängigkeiten in Go umzugehen. Zunächst als Experiment vorgestellt, sollen die Module als neuer Standard für die Verwaltung von Paketen ab Version 1.13 ins Feld eingeführt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich finde dieses Thema ungewöhnlich genug für Anfänger aus anderen Sprachen. Deshalb habe ich beschlossen, hier einige Gedanken und Tipps zu sammeln, um anderen wie mir zu helfen, sich ein Bild von der Paketverwaltung in Go zu machen. Wir beginnen mit einer allgemeinen Einführung und gehen dann zu den weniger offensichtlichen Aspekten über, einschließlich der Verwendung des Herstellerordners, der Verwendung von Modulen mit Docker in der Entwicklung, Werkzeugabhängigkeiten usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie bereits mit Go-Modulen vertraut sind und das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiki kennen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie Ihr Handrücken wird dieser Artikel für Sie wahrscheinlich nicht sehr hilfreich sein. </font><font style="vertical-align: inherit;">Im Übrigen können jedoch mehrere Stunden Versuch und Irrtum eingespart werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie unterwegs sind, springen Sie hinein und genießen Sie die Fahrt.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/tr/d9/eq/trd9eqcuki5uwi4w5b2gexcp8q4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnellstart</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Versionskontrolle bereits in Ihr Projekt integriert ist, können Sie sie einfach ausführen</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder geben Sie den Pfad zum Modul manuell an. </font><font style="vertical-align: inherit;">Dies ist so etwas wie ein Name, eine URL und ein Importpfad für Ihr Paket:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init github.com/you/hello</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dadurch wird eine Datei erstellt </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, in der auch die Projektanforderungen und das Lochit in Abhängigkeit von der richtigen Version definiert werden (als Analogie für Sie ist es wie </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in einer einzigen Datei zusammengefasst):</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ausführen </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um Ihrem Projekt eine neue Abhängigkeit hinzuzufügen: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beachten Sie, dass Sie mit go get zwar keinen Versionsbereich angeben können, hier jedoch keine bestimmte Version, sondern eine Mindestversion definieren. </font><font style="vertical-align: inherit;">Wie wir später sehen werden, gibt es eine Möglichkeit, Abhängigkeiten entsprechend dem Semver ordnungsgemäß zu aktualisieren.</font></font></i><br>
<br>
<pre><code class="go hljs"># use Git tags
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@v4<span class="hljs-number">.0</span><span class="hljs-number">.1</span><font></font>
# or Git branch name<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@master<font></font>
# or Git commit hash<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@<span class="hljs-number">08</span>c92af</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist unsere Datei </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie folgt:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible <span class="hljs-comment">// indirect</span></code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Suffix wird </font></font><code>+incompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allen Paketen hinzugefügt, die noch nicht für Go-Module konfiguriert sind oder deren Versionskontrollregeln verletzen. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir dieses Paket nirgendwo in unserem Projekt importiert haben, wurde es als markiert </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wir können dies mit dem folgenden Befehl aufräumen:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod tidy</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abhängig vom aktuellen Status Ihres Repositorys wird entweder ein nicht verwendetes Modul oder ein Kommentar gelöscht </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn eine Abhängigkeit für sich genommen keine hat </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(z. B. ist sie noch nicht für Module konfiguriert), werden alle ihre Abhängigkeiten in die übergeordnete Datei geschrieben </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(optional wird Ihre Datei </font></font><code>go.mod)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zusammen mit einem Kommentar </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angezeigt, um anzuzeigen, dass sie nicht direkt importiert werden In Ihrem</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
globalen Plan besteht das Ziel </font></font><code>go mod tidy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auch darin, Abhängigkeiten hinzuzufügen, die für andere Kombinationen von Betriebssystemen, Architekturen und Build-Tags erforderlich sind. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Führen Sie diese vor jeder Version aus.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Stellen Sie außerdem sicher, dass nach dem Hinzufügen der Abhängigkeit eine Datei erstellt wird</font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie könnten denken, dass dies eine Sperrdatei ist. </font><font style="vertical-align: inherit;">Tatsächlich </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bietet </font><font style="vertical-align: inherit;">es jedoch </font><font style="vertical-align: inherit;">bereits genügend Informationen für 100% reproduzierbare Builds. </font><font style="vertical-align: inherit;">Die Datei </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird zu Überprüfungszwecken erstellt: Sie enthält die erwarteten kryptografischen Prüfsummen des Inhalts einzelner Versionen des Moduls. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zum Teil, weil es sich </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht um eine Sperrdatei handelt, werden die schriftlichen Prüfsummen für die Modulversion gespeichert, auch wenn Sie dieses Modul nicht mehr verwenden. </font><font style="vertical-align: inherit;">Auf diese Weise können Sie die Prüfsummen überprüfen, wenn Sie sie später wieder verwenden, was zusätzliche Sicherheit bietet.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_5/j8/vi/_5j8vigrklvhkwaucssmy7zaf88.png"><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mkcert ist gerade auf die Module migriert (mit Hersteller / aus Gründen der Abwärtskompatibilität) und alles verlief reibungslos. </font></font></i> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Https://github.com/FiloSottile/mkcert/commit/26ac5f35395fb9cba3805faf1a5a04d260271291</font></font></a><br>
<br>
<pre><code class="go hljs">$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod init<font></font>
$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod vendor<font></font>
$ git add <span class="hljs-keyword">go</span>.mod <span class="hljs-keyword">go</span>.sum vendor<font></font>
$ git rm Gopkg.lock Gopkg.toml Makefile</code></pre><br>
<img src="https://habrastorage.org/webt/kt/ch/ro/ktchrocah4xszqqrfkqtug3qzty.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQ: Soll ich mich </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Git verpflichten? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A: Auf jeden Fall ja. </font><font style="vertical-align: inherit;">Damit müssen die Eigentümer Ihrer Quellen anderen GitHub-Repositorys und Eigentümern von benutzerdefinierten Importpfaden nicht vertrauen. </font><font style="vertical-align: inherit;">Schon auf dem Weg zu uns, etwas Besseres, aber im Moment ist dies das gleiche Modell wie die Hashes in den Sperrdateien.</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><code>go build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">Befehle </font></font><code>go test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden alle fehlenden Abhängigkeiten automatisch laden, obwohl Sie dies explizit mit Hilfe tun können </font></font><code>go mod download</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pre-bevölkern lokalen Caches , </font><font style="vertical-align: inherit;">die für CI nützlich sein kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardmäßig werden alle unsere Pakete aus allen Projekten in das Verzeichnis geladen </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wir werden dies später genauer besprechen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktualisieren von Paketversionen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können </font></font><code>go get -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entweder verwenden </font></font><code>go get -u=patch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um Abhängigkeiten auf die neueste Nebenversion bzw. den neuesten Patch zu aktualisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können jedoch nicht auf solche Hauptversionen aktualisieren. </font><font style="vertical-align: inherit;">Der in Go-Modulen enthaltene Code muss technisch den folgenden Regeln entsprechen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Match Semver (Beispiel-Tag VCS v1.2.3).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn das Modul Version v2 oder höher ist, sollte die Hauptversion des Moduls sowohl </font></font><code>/vN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">am Ende des in der Datei verwendeten Modulpfads </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als auch im Paketimportpfad enthalten sein:</font></font></li>
</ul><br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/you/hello/v2"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anscheinend geschieht dies, damit verschiedene Versionen von Paketen in eine Assembly importiert werden können (siehe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem mit der Diamantabhängigkeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kurz gesagt, Go erwartet von Ihnen, dass Sie bei der Einführung von Hauptversionen sehr vorsichtig sind.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importierte Module ersetzen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können das erforderliche Modul für Ihre eigene Verzweigung oder sogar den lokalen Pfad zur Datei mithilfe der folgenden Anweisung angeben </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -replace github.com/<span class="hljs-keyword">go</span>-chi/chi=./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ergebnis:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible<font></font>
replace github.com/<span class="hljs-keyword">go</span>-chi/chi =&gt; ./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können die Zeile manuell löschen oder ausführen:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -dropreplace github.com/<span class="hljs-keyword">go</span>-chi/chi</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projektabhängigkeitsmanagement </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Vergangenheit wurde der gesamte Go-Code in einem riesigen Mono-Repository gespeichert, da Google auf diese Weise seine Codebasis organisiert. Dies wirkt sich auf das Sprachdesign aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Go-Module weichen von diesem Ansatz ab. Sie müssen nicht mehr alle Ihre Projekte behalten </font></font><code>$GOPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Technisch gesehen sind jedoch alle heruntergeladenen Abhängigkeiten weiterhin vorhanden </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn Sie Docker-Container für die lokale Entwicklung verwenden, kann dies ein Problem sein, da Abhängigkeiten außerhalb des Projekts gespeichert werden. Standardmäßig sind sie in Ihrer IDE einfach nicht sichtbar. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ye/2c/_o/ye2c_o9jcsodsrhdekb4djz7lve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist normalerweise kein Problem für andere Sprachen, aber dies ist das, was ich zum ersten Mal bei der Arbeit mit der Go-Codebasis festgestellt habe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Glücklicherweise gibt es mehrere (undokumentierte) Möglichkeiten, um dieses Problem zu lösen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option 1. Installieren Sie GOPATH in Ihrem Projektverzeichnis.</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf den ersten Blick mag dies nicht </font><font style="vertical-align: inherit;">intuitiv </font><font style="vertical-align: inherit;">erscheinen, aber </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenn Sie Go aus einem Container</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausführen, können Sie GOPATH überschreiben, sodass es auf das Projektverzeichnis verweist, sodass auf Pakete vom Host aus zugegriffen werden kann:</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    environment:<font></font>
      #        - /code/.<span class="hljs-keyword">go</span>/pkg/mod<font></font>
      - GOPATH=/code/.<span class="hljs-keyword">go</span><font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beliebte IDEs sollten in der Lage sein, GOPATH auf Projektebene (Arbeitsbereich) zu installieren: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_t/jz/d_/_tjzd_trva2fekp6vmt5ewc_xke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einzige Nachteil dieses Ansatzes ist die mangelnde Interaktion mit der Go-Laufzeit auf dem Host-Computer. </font><font style="vertical-align: inherit;">Sie müssen alle Go-Befehle im Container ausführen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option 2: Verkauf Ihrer Abhängigkeiten</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine andere Möglichkeit besteht darin, die Abhängigkeiten Ihres Projekts in einen Ordner zu kopieren </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sollte sofort beachtet werden: Wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlauben</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Go </font><b><font style="vertical-align: inherit;">NICHT,</font></b><font style="vertical-align: inherit;"> Materialien direkt in den Lieferantenordner hochzuladen. Dies ist mit Modulen nicht möglich. </font><font style="vertical-align: inherit;">Wir kopieren einfach bereits heruntergeladene Pakete. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Ihre Abhängigkeiten wie im obigen Beispiel lösen, dann löschen </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und dann versuchen, Ihrem Projekt mehrere neue Abhängigkeiten hinzuzufügen, wird Folgendes </font><font style="vertical-align: inherit;">angezeigt </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go erstellt den Download-Cache für alle Softwarepakete neu </font></font><code>$GOPATH/pkg/mod/cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle geladenen Module werden kopiert </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schließlich kopiert Go diese Module in einen </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordner und löscht Beispiele, Tests und einige andere Dateien, von denen Sie nicht direkt abhängig sind.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus fehlen in diesem neu erstellten Herstellerordner viele Dinge: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rj/w-/lt/rjw-ltm1y1s8jwia34bfars6ngw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine typische Docker Compose-Datei sieht folgendermaßen aus (beachten Sie die Datenträgerbindungen):</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
     #    <span class="hljs-keyword">go</span>,           <font></font>
      - modules:/<span class="hljs-keyword">go</span>/pkg/mod/cache<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code <font></font>
<font></font>
volumes:<font></font>
  modules:<font></font>
    driver: local</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass ich diesen Herstellerordner im Versionskontrollsystem NICHT komisch mache oder ihn nicht in der Produktion verwenden werde. </font><font style="vertical-align: inherit;">Dies ist ein streng lokales Entwicklungsskript, das normalerweise in einigen anderen Sprachen verfügbar ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich jedoch </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kommentare von einigen Go-Betreuern</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und einige Angebote im Zusammenhang mit Teilverkäufen (?) Lies, habe ich den Eindruck, dass diese Funktion ursprünglich nicht für diesen Benutzerfall gedacht war. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kommentatoren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von reddit hat mir dabei geholfen, etwas Licht ins Dunkel zu bringen:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normalerweise bieten die Benutzer ihre Abhängigkeiten aus Gründen wie dem Wunsch nach engen Assemblys ohne Zugriff auf das Netzwerk sowie einer Kopie vorgefertigter Abhängigkeiten im Falle eines Github-Fehlers oder des Verschwindens des Repositorys und der Möglichkeit einer einfacheren Prüfung von Abhängigkeitsänderungen mithilfe von Standard-VCS-Tools usw. an. .</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ja, es sieht nicht wie etwas aus der Tatsache , </font><font style="vertical-align: inherit;">dass ich interessiert sein könnte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gemäß dem Befehl Go können Sie den Verkauf einfach aktivieren, indem Sie eine Umgebungsvariable festlegen </font></font><code>GOFLAGS=-mod=vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ich empfehle dies nicht. Die Verwendung von Flags wird einfach unterbrochen, </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne dass Ihr täglicher Workflow weitere Vorteile bietet: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/ul/uw/dfuluwbr13eacullfzphguhrbeo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einzige Ort, an dem Sie den Verkauf aktivieren müssen, ist Ihre IDE:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/x2/pz/jvx2pzgtrx5wcfmlum4s5hheorw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einigem Ausprobieren habe ich das folgende Verfahren zum Hinzufügen von Lieferantenabhängigkeiten in diesem Ansatz entwickelt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 1. Anforderung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können eine Abhängigkeit verlangen mit </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> get github.com/rs/zerolog@v1<span class="hljs-number">.14</span><span class="hljs-number">.3</span></code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 2. Importieren</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importieren Sie es dann irgendwo in Ihren Code:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> (<font></font>
   _ <span class="hljs-string">"github.com/rs/zerolog"</span>
)</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 3. Verkauf</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Öffnen Sie abschließend Ihre Abhängigkeiten erneut:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es steht ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorschlag aus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dem Go-Mod-Anbieter zu erlauben, bestimmte Modulvorlagen zu akzeptieren, die möglicherweise einige der mit diesem Workflow verbundenen Probleme lösen (oder auch nicht). </font></font><br>
<br>
<code>go mod vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erfordert bereits automatisch verpasste Importe, daher ist </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schritt 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in diesem Workflow optional (wenn Sie keine Versionsbeschränkungen angeben möchten). Ohne Schritt 2 wird das heruntergeladene Paket jedoch nicht abgerufen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Ansatz funktioniert besser mit dem Hostsystem, ist jedoch ziemlich verwirrend, wenn es darum geht, Ihre Abhängigkeiten zu bearbeiten.</font></font><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Persönlich denke ich, dass die Neudefinition von GOPATH ein sauberer Ansatz ist, da die Funktionalität nicht beeinträchtigt wird </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Trotzdem wollte ich beide Strategien zeigen, da der Herstellerordner möglicherweise Personen aus anderen Sprachen wie PHP, Ruby, Javascript usw. besser bekannt ist. Wie Sie dem in diesem Artikel beschriebenen Betrug entnehmen können, ist dies der Fall keine besonders gute Wahl für Go.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Werkzeugabhängigkeiten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Möglicherweise müssen wir einige Go-basierte Tools installieren, die nicht importiert, sondern als Teil der Projektentwicklungsumgebung verwendet werden. </font><font style="vertical-align: inherit;">Ein einfaches Beispiel für ein solches Tool ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompileDaemon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit dem Sie Ihren Code auf Änderungen überwachen und Ihre Anwendung neu starten können. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der offiziell empfohlene</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ansatz besteht darin, eine </font></font><code>tools.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei (der Name spielt keine Rolle) mit folgendem Inhalt </font><font style="vertical-align: inherit;">hinzuzufügen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// +build tools</span>
<span class="hljs-keyword">package</span> tools
<span class="hljs-keyword">import</span> (<font></font>
_ <span class="hljs-string">"github.com/githubnemo/CompileDaemon"</span>
)</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Einschränkung </font></font><code>// +build tools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verhindert, dass Ihre regulären Baugruppen Ihr Werkzeug tatsächlich importieren.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dem Importausdruck können go-Befehle Versionsinformationen Ihrer Tools genau in </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ihre Moduldatei </font><font style="vertical-align: inherit;">schreiben </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist also alles. </font><font style="vertical-align: inherit;">Ich hoffe, Sie werden nicht so verwirrt sein wie zu Beginn meiner Verwendung von Go-Modulen. </font><font style="vertical-align: inherit;">Weitere Informationen </font><font style="vertical-align: inherit;">finden Sie im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go Modules-Wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steig auf den Kurs.</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503904/index.html">Die Welt und n Welten oder Mathematik für die Geisteswissenschaften</a></li>
<li><a href="../de503906/index.html">LabVIEW NXG - Einfache Datentypen und Typenzwang</a></li>
<li><a href="../de503908/index.html">Rufen Sie gemeinsam genutzte Bibliotheken von Similink aus auf</a></li>
<li><a href="../de503910/index.html">Experimente an Menschen, die nach "udalenka" gegangen sind</a></li>
<li><a href="../de503916/index.html">Lernen, an der Börse zu handeln. Teil eins: Einrichten einer Testumgebung</a></li>
<li><a href="../de503920/index.html">Wie wir Mikrofonsysteme auf STM32 testen: die Erfahrung von Yandex-Geräteentwicklern</a></li>
<li><a href="../de503922/index.html">Warum beseitigt die EU Kekswände?</a></li>
<li><a href="../de503924/index.html">Übersicht über den Intraoralen 3D-Scanner Medit i500</a></li>
<li><a href="../de503926/index.html">Wer ist wer im Zahlungsverkehr 2020. Teil 2</a></li>
<li><a href="../de503928/index.html">Aerosol VS-Bewässerung: Was ist besser und gibt es einen Unterschied?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>