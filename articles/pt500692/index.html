<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖüèª üë®üèª‚Äçüöí üöí Renderiza√ß√£o de jogos em 3D: introdu√ß√£o üëºüèª ‚ôâÔ∏è üçÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voc√™ joga o novo Call of Mario: Deathduty Battleyard no seu PC para jogos perfeito. Veja o lindo monitor 4K super amplo, admirando a paisagem magn√≠fic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Renderiza√ß√£o de jogos em 3D: introdu√ß√£o</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/500692/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/hw/gw/dqhwgwxgezi8q8erzwy94bjwst0.jpeg" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ joga o novo Call of Mario: Deathduty Battleyard no seu PC para jogos perfeito. Veja o lindo monitor 4K super amplo, admirando a paisagem magn√≠fica e os detalhes complexos. Voc√™ j√° se perguntou como os gr√°ficos chegam √† tela? Voc√™ j√° se perguntou como o jogo faz o computador mostrar tudo isso? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem-vindo ao nosso tour pela renderiza√ß√£o de jogos em 3D: uma jornada para iniciantes, a partir da qual voc√™ aprender√° a criar um quadro b√°sico na tela.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d50/b40/462/d50b40462a4a18cef3e522b236f52c99.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os anos, centenas de novos jogos para smartphones, consoles e PCs s√£o lan√ßados. A variedade de formatos e g√™neros √© muito grande, mas um deles, talvez, √© dominado melhor - s√£o jogos em 3D. Qual jogo foi o primeiro - uma pergunta discut√≠vel e uma r√°pida olhada na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base do Guinness Book of Records</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deu v√°rios resultados. Pode ser considerado o primeiro jogo Ultimate Knight Lore, lan√ßado em 1984, mas, estritamente falando, as imagens neste jogo eram bidimensionais - nenhuma informa√ß√£o foi usada em tr√™s dimens√µes completas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, se realmente queremos entender como os jogos 3D modernos formam uma imagem, precisamos come√ßar com outro exemplo: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winning Run</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namco, lan√ßado em 1988. Talvez este tenha sido o primeiro jogo completamente tridimensional usando tecnologias que n√£o s√£o muito diferentes das modernas. √â claro que qualquer jogo com idade superior a 30 anos n√£o √© o mesmo que, digamos, o Codemasters F1, lan√ßado em 2018. Mas os diagramas de circuitos s√£o semelhantes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/512/06c/a91/51206ca91484780f2fd5c73deffd796b.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, veremos o processo de gera√ß√£o de uma imagem b√°sica para um monitor ou TV usando um jogo em 3D. </font><font style="vertical-align: inherit;">Vamos come√ßar com o resultado final e nos perguntar: "O que estou vendo?" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o analisamos cada est√°gio da forma√ß√£o da imagem que vemos. </font><font style="vertical-align: inherit;">No curso da a√ß√£o, consideraremos conceitos como v√©rtices e pixels, texturas e passes, buffers e sombreamento, software e instru√ß√µes. </font><font style="vertical-align: inherit;">Vamos descobrir como a placa de v√≠deo est√° envolvida no processo e por que ela √© necess√°ria. </font><font style="vertical-align: inherit;">Depois disso, voc√™ poder√° ver seus jogos e PCs sob uma nova luz e come√ßar a apreciar mais os gr√°ficos de v√≠deo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de quadro: pixels e cores</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar o jogo em 3D. Como exemplo, levaremos a </font><font style="vertical-align: inherit;">empresa Crytek </font><font style="vertical-align: inherit;">lan√ßada em 2007 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crysis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Abaixo est√° uma fotografia da tela em que o jogo √© exibido:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/142/b40/5c4/142b405c4f4583d032427b7513391735.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa imagem geralmente √© chamada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quadro</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mas o que exatamente estamos olhando? </font><font style="vertical-align: inherit;">Usamos uma lente macro:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/593/f64/712/593f64712c5065a03fcbca1c90649938.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, o brilho e a luz de fundo externa do monitor estragam a foto, mas se a melhorarmos um pouco, teremos</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/915/b4f/3df/915b4f3dff7fdfb77917465635d64610.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que o quadro no monitor consiste em uma grade de elementos coloridos separados e, se os aumentarmos ainda mais, perceberemos que cada elemento √© um bloco de tr√™s pe√ßas. Esse bloco √© chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pixel, abrevia√ß√£o de elemento de imagem). Na maioria dos monitores, os pixels s√£o pintados usando tr√™s cores: vermelho, verde e azul (RGB, vermelho-verde-azul). Para exibir um novo quadro, voc√™ precisa processar uma lista de milhares, se n√£o milh√µes, de valores RGB e salv√°-los em um peda√ßo de mem√≥ria ao qual o monitor tem acesso. Esses fragmentos de mem√≥ria s√£o chamados de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, o monitor recebe o conte√∫do do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer de quadro</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© o ponto final de todo o processo, ent√£o agora vamos avan√ßar na dire√ß√£o oposta ao seu in√≠cio. </font><font style="vertical-align: inherit;">O processo √© frequentemente descrito pelo termo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renderiza√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (renderiza√ß√£o), mas, na realidade, √© uma sequ√™ncia de etapas separadas conectadas entre si, que em ess√™ncia diferem bastante. </font><font style="vertical-align: inherit;">Imagine que voc√™ √© um chef em um restaurante com estrela Michelin: o resultado final √© um prato de comida deliciosa, mas quanto precisa ser feito para isso. </font><font style="vertical-align: inherit;">Assim como na culin√°ria, s√£o necess√°rios ingredientes b√°sicos para a renderiza√ß√£o.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elementos de constru√ß√£o necess√°rios: modelos e texturas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os principais componentes de qualquer jogo em 3D s√£o recursos visuais que preenchem o mundo a ser desenhado. </font><font style="vertical-align: inherit;">Filmes, programas de TV e teatros precisam de atores, figurinos, adere√ßos, cen√°rio, ilumina√ß√£o - a lista √© bastante longa. </font><font style="vertical-align: inherit;">A mesma coisa com os jogos em 3D. </font><font style="vertical-align: inherit;">Tudo o que voc√™ v√™ no quadro gerado foi desenvolvido por artistas e especialistas em modelagem. </font><font style="vertical-align: inherit;">Para deixar mais claro, vamos voltar para a velha escola e dar uma olhada no modelo Quake II da empresa de software id:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/938/10b/28f/93810b28f68f5e90d272480b2effbf97.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O jogo saiu h√° mais de 20 anos. </font><font style="vertical-align: inherit;">Naquela √©poca, o Quake II era uma obra-prima tecnol√≥gica, embora, como em qualquer jogo daqueles anos, os modelos pare√ßam muito primitivos. </font><font style="vertical-align: inherit;">Mas √© f√°cil demonstrar em que consistem.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a04/5f2/834/a045f2834673247daedbaaf24b3f33e9.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na foto anterior, vemos um cara angular composto por tri√¢ngulos conectados um ao outro. Cada canto √© chamado de v√©rtice ou v√©rtice. Cada v√©rtice atua como um ponto no espa√ßo e √© descrito por pelo menos tr√™s n√∫meros: as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordenadas x, y, z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No entanto, isso n√£o √© suficiente para um jogo em 3D; portanto, cada v√©rtice possui valores adicionais: cor, dire√ß√£o da frente (sim, um ponto n√£o pode ter uma frente ... basta ler!), Brilho, grau de transpar√™ncia, etc.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c42/4ff/db3/c424ffdb3f95d9758bc1a8eeb5c4a870.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os v√©rtices sempre t√™m um conjunto de valores associados aos mapas de textura. Estas s√£o fotos das ‚Äúroupas‚Äù usadas pela modelo. Mas como a imagem √© plana, o mapa deve conter uma vista de qualquer dire√ß√£o, de onde podemos olhar para o modelo. O exemplo do Quake II ilustra uma abordagem simples: imagens da frente, de tr√°s e dos lados (bra√ßos). E os modernos jogos em 3D j√° operam para modelos com v√°rios mapas de texturas, cada um com muitos detalhes, sem espa√ßos vazios entre eles. Alguns mapas n√£o se parecem com materiais ou propriedades; em vez disso, fornecem informa√ß√µes sobre como a luz √© refletida na superf√≠cie. Cada v√©rtice possui um conjunto de coordenadas no mapa de textura associado ao modelo, para que possa ser "esticado" sobre o v√©rtice. Isso significa que quando voc√™ move o v√©rtice, a textura se move com ele.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No mundo tridimensional renderizado, tudo o que voc√™ v√™ come√ßa com um conjunto de v√©rtices e mapas de textura. Eles s√£o carregados nos buffers de mem√≥ria conectados um ao outro. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O buffer de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√©rtice ( </font><i><font style="vertical-align: inherit;">buffer de</font></i><font style="vertical-align: inherit;"> v√©rtice) cont√©m texturas e partes de mem√≥ria alocadas para renderiza√ß√£o subsequente. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buffer de comando cont√©m uma lista de instru√ß√µes sobre o que fazer com esses recursos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo isso forma a estrutura necess√°ria que ser√° usada para criar a grade final de pixels coloridos. </font><font style="vertical-align: inherit;">Em alguns jogos, essa √© uma quantidade enorme de dados, porque leva muito tempo para recriar os buffers para cada novo quadro. </font><font style="vertical-align: inherit;">Os jogos tamb√©m armazenam em buffers as informa√ß√µes necess√°rias para formar um mundo inteiro que um jogador pode ver, ou uma parte grande o suficiente, atualizando conforme necess√°rio. </font><font style="vertical-align: inherit;">Por exemplo, em um jogo de corrida como F1 2018, tudo ser√° armazenado em uma grande cole√ß√£o de buffers. </font><font style="vertical-align: inherit;">E em um jogo de mundo aberto como o Skyrim, os dados ser√£o carregados nos buffers e exclu√≠dos deles √† medida que a c√¢mera se move ao redor do mundo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o de cena: v√©rtices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendo todas as informa√ß√µes visuais, o jogo come√ßar√° o processo de exibi√ß√£o visual. A cena come√ßa em uma determinada posi√ß√£o por padr√£o, com o arranjo b√°sico de modelos, fontes de luz etc. Essa ser√° a tela "zero" - o ponto de partida para os gr√°ficos. Geralmente n√£o √© exibido, √© simplesmente processado pelo sistema. Para ilustrar o que acontece na primeira etapa da renderiza√ß√£o, usaremos a ferramenta online </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Real-Time Rendering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vamos criar o "jogo" mais simples: uma caixa no ch√£o.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6eb/6c2/84a/6eb6c284ac1f6dbfd1d88b80ccce1e7b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este objeto cont√©m 8 v√©rtices, cada um dos quais √© descrito por uma lista de n√∫meros. </font><font style="vertical-align: inherit;">Os v√©rtices formam um modelo composto por 12 tri√¢ngulos. </font><font style="vertical-align: inherit;">Cada tri√¢ngulo, e at√© o pr√≥prio objeto, √© chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primitivo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">√Ä medida que as primitivas se movem, giram e escalam, os n√∫meros passam por cadeias de opera√ß√µes matem√°ticas e s√£o atualizados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/683/dfb/2cf/683dfb2cf7936d1ae5d7150ee5e3691a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observe que os n√∫meros dos pontos do modelo n√£o mudam. </font><font style="vertical-align: inherit;">Esses n√∫meros mostram exatamente onde o modelo est√° localizado no mundo virtual. </font><font style="vertical-align: inherit;">A considera√ß√£o dos c√°lculos matem√°ticos correspondentes est√° al√©m do escopo do artigo; diremos apenas que primeiro todos os objetos s√£o colocados onde deveriam estar. </font><font style="vertical-align: inherit;">E ent√£o a colora√ß√£o come√ßa.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/245/ab4/c10/245ab4c109ab76e81bb20fb9dab7bab4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pegue outro modelo que tenha 10 vezes mais v√©rtices que a caixa anterior. </font><font style="vertical-align: inherit;">No processo mais simples de pintura, a cor de cada v√©rtice √© obtida e, em seguida, as altera√ß√µes de cor de superf√≠cie para superf√≠cie s√£o calculadas. </font><font style="vertical-align: inherit;">Isso √© chamado de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interpola√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6bb/54f/3b7/6bb54f3b70c60c558dfbe029e3361207.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aumentar o n√∫mero de v√©rtices no modelo n√£o apenas permite criar objetos mais realistas, como tamb√©m melhora o resultado da interpola√ß√£o de cores.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/682/c4e/d4d/682c4ed4d29b1d3e7bd03302783c9057.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta fase da renderiza√ß√£o, o efeito das fontes de luz na cena pode ser calculado em detalhes. </font><font style="vertical-align: inherit;">Por exemplo, como os materiais do modelo refletem as cores. </font><font style="vertical-align: inherit;">Esses c√°lculos devem levar em considera√ß√£o a posi√ß√£o e a dire√ß√£o da c√¢mera, bem como a posi√ß√£o e a dire√ß√£o das fontes de luz.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0e9/044/b91/0e9044b9132d022e5a19e490cfe36091.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, existem v√°rios m√©todos matem√°ticos diferentes, alguns simples, outros muito complexos. Na ilustra√ß√£o acima, vemos que o objeto √† direita parece muito melhor e mais realista, mas √© necess√°rio mais trabalho para desenh√°-lo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â importante notar que agora comparamos objetos com um pequeno n√∫mero de picos com os jogos mais modernos. Role para cima e examine cuidadosamente a imagem de Crysis: essa cena exibe mais de um milh√£o de tri√¢ngulos. Usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benchmark Unigine Valley como</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exemplo, </font><font style="vertical-align: inherit;">voc√™ pode entender quantos tri√¢ngulos s√£o usados ‚Äã‚Äãnos jogos modernos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/486/232/4ec/4862324ec5749273f8b64dd9ad463386.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada objeto nesta imagem consiste em v√©rtices conectados entre si, formados pelas primitivas que consistem em tri√¢ngulos. </font><font style="vertical-align: inherit;">A refer√™ncia pode ser executada no modo de estrutura de arame, no qual as bordas de cada tri√¢ngulo s√£o indicadas por linhas brancas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/636/687/f15/636687f15006991fcf278df6af74227e.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, qualquer objeto consiste em tri√¢ngulos e para cada tri√¢ngulo s√£o calculados o local, a dire√ß√£o e a cor. </font><font style="vertical-align: inherit;">Isso leva em considera√ß√£o a localiza√ß√£o das fontes de luz, bem como a localiza√ß√£o e a dire√ß√£o da c√¢mera. </font><font style="vertical-align: inherit;">Todas as altera√ß√µes associadas aos v√©rtices devem ser transferidas para o jogo, de modo a ter todas as informa√ß√µes necess√°rias para desenhar o pr√≥ximo quadro - isso √© feito atualizando o buffer de v√©rtices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surpreendentemente, essa n√£o √© a parte mais dif√≠cil de renderizar, com o hardware certo, todos os c√°lculos s√£o feitos em alguns mil√©simos de segundo! </font><font style="vertical-align: inherit;">Ir em frente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perder dimens√£o: rasteriza√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de processar todos os v√©rtices e concluir a coloca√ß√£o de todos os objetos em nossa cena tridimensional, o processo de renderiza√ß√£o prossegue para um est√°gio muito importante. </font><font style="vertical-align: inherit;">At√© o momento, o jogo era realmente tridimensional, mas o quadro final n√£o √© mais esse: no decorrer de uma s√©rie de mudan√ßas, o mundo visto √© transformado de um espa√ßo 3D que consiste em milhares de pontos conectados em uma imagem bidimensional que consiste em pixels coloridos. </font><font style="vertical-align: inherit;">Na maioria dos jogos, esse procedimento consiste em pelo menos duas fases: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espa√ßo na tela de proje√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (proje√ß√£o do espa√ßo na tela) e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rasteriza√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/17f/b9b/264/17fb9b264f727fefbc583b0768b0619b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De volta √† nossa ferramenta de renderiza√ß√£o baseada na Web, ela nos mostrar√° como o volume do mundo virtual se transforma em uma imagem plana. A c√¢mera √© mostrada √† esquerda, as linhas que emanam dela criam uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pir√¢mide truncada de visibilidade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (frustum) e tudo o que entra nela pode ser exibido no quadro final. A sec√ß√£o perpendicular da pir√¢mide √© chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> visor - isso √© o que ser√° mostrado no monitor. In√∫meros c√°lculos matem√°ticos s√£o usados ‚Äã‚Äãpara projetar todo o conte√∫do da pir√¢mide na √°rea de visualiza√ß√£o, levando em considera√ß√£o a perspectiva da c√¢mera.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora os gr√°ficos na √°rea de visualiza√ß√£o sejam bidimensionais, os dados ainda s√£o verdadeiramente tridimensionais e, posteriormente, essas informa√ß√µes ser√£o usadas para calcular quais primitivas s√£o vis√≠veis para n√≥s e quais est√£o ocultas. Isso pode ser surpreendentemente dif√≠cil de fazer, porque os primitivos podem projetar sombras vis√≠veis para n√≥s, mesmo que os pr√≥prios primitivos estejam ocultos de n√≥s. Remova escondido de n√≥s as primitivas chamadas de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abandono</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (abate). Esta opera√ß√£o pode afetar significativamente a velocidade de renderiza√ß√£o de todo o quadro. Depois que a classifica√ß√£o em primitivas vis√≠veis e ocultas √© conclu√≠da, e os tri√¢ngulos s√£o removidos fora dos limites da pir√¢mide de visibilidade, o √∫ltimo est√°gio da tridimensionalidade √© conclu√≠do e o quadro √© totalmente bidimensional usando rasteriza√ß√£o.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6db/645/fe9/6db645fe9bd2138481a6f502c1ca8eda.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ilustra√ß√£o acima mostra um exemplo muito simples de quadro que cont√©m um primitivo. </font><font style="vertical-align: inherit;">A grade de pixels √© sobreposta √† forma geom√©trica e os pixels correspondentes s√£o marcados para processamento subseq√ºente. </font><font style="vertical-align: inherit;">O resultado final n√£o se parece muito com o tri√¢ngulo original, porque n√£o estamos usando pixels suficientes. </font><font style="vertical-align: inherit;">Nesse sentido, surge o problema de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serrilhado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (serrilhado, trampolim), que √© resolvido de v√°rias maneiras. </font><font style="vertical-align: inherit;">Portanto, uma altera√ß√£o na </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resolu√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do jogo </font><font style="vertical-align: inherit;">(o n√∫mero total de pixels no quadro) afeta tanto o resultado final: mais pixels n√£o apenas melhoram a exibi√ß√£o dos formul√°rios, mas tamb√©m reduzem o efeito de aliasing indesejado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de concluir esta parte da renderiza√ß√£o, passamos para o pr√≥ximo grande passo: a colora√ß√£o final de todos os pixels no quadro. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leve a luz: est√°gio de pixel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chegamos ao est√°gio mais dif√≠cil de renderiza√ß√£o. </font><font style="vertical-align: inherit;">Uma vez se tratou de usar modelos de roupas (texturas) usando informa√ß√µes de pixel (originalmente obtidas dos v√©rtices). </font><font style="vertical-align: inherit;">No entanto, o fato √© que, embora as texturas e o pr√≥prio quadro sejam bidimensionais, o mundo virtual no est√°gio de processamento de v√©rtices foi distorcido, alterado e alterado. </font><font style="vertical-align: inherit;">Para explicar tudo isso, c√°lculos matem√°ticos adicionais s√£o usados, no entanto, novos problemas podem ser caracter√≠sticos do resultado.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c0f/3f4/f2b/c0f3f4f2b83db10efd3058fec26c27fe.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta ilustra√ß√£o, uma textura quadriculado √© aplicada ao plano. H√° uma ondula√ß√£o visual desagrad√°vel, que √© exacerbada pelo alias. Para resolver esse problema, use vers√µes menores de mapas de textura ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√°rios mapeamentos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mipmaps), reutilize as informa√ß√µes dessas texturas ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtragem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , filtragem) e c√°lculos matem√°ticos adicionais. O efeito √© percept√≠vel:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e8d/a5b/bcd/e8da5bbcd3bf8fc8e9e75c7a9614d2eb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para qualquer jogo, esse foi realmente um est√°gio dif√≠cil, mas hoje n√£o √© mais, porque, devido ao amplo uso de outros efeitos visuais, como reflexos e sombras, o processamento de textura se tornou um est√°gio relativamente pequeno do processo de renderiza√ß√£o. Ao reproduzir em altas resolu√ß√µes, a carga nos est√°gios de rasteriza√ß√£o e processamento de pixels aumenta, mas isso afeta o processamento de v√©rtices relativamente pouco. Embora a colora√ß√£o prim√°ria devida √†s fontes de luz seja realizada no est√°gio de v√©rtice, efeitos de ilumina√ß√£o mais sofisticados podem ser aplicados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a62/0bc/a60/a620bca60aa98557848fd500e30f3d94.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na ilustra√ß√£o anterior, n√£o vemos mais mudan√ßas de cores entre tri√¢ngulos diferentes, o que nos d√° a sensa√ß√£o de um objeto sem costura suave. Embora neste exemplo a esfera consista no mesmo n√∫mero de tri√¢ngulos que a esfera verde na ilustra√ß√£o acima, como resultado do procedimento de colora√ß√£o de pixels, parece-nos que muito mais tri√¢ngulos s√£o usados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/321/204/fa2/321204fa222c1a25b1f6197b04c30f52.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em muitos jogos, a fase do pixel precisa ser executada v√°rias vezes. Por exemplo, para que um espelho ou superf√≠cie da √°gua reflita o mundo circundante, primeiro √© preciso desenhar esse mundo. Cada corrida √© chamada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (passe) e, para obter a imagem final de cada quadro, pode ser usado facilmente quatro ou mais passes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, √†s vezes voc√™ precisa executar o est√°gio de v√©rtice novamente para redesenhar o mundo a partir de outro ponto e usar esta imagem em uma cena que √© mostrada ao jogador. Para fazer isso, use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a renderiza√ß√£o de buffer √∫nico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (destinos de renderiza√ß√£o) - use buffers que atuam como o armazenamento final do quadro, mas tamb√©m podem funcionar como texturas com uma passagem diferente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para avaliar a complexidade do est√°gio de pixel, voc√™ pode ler</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an√°lise de quadros no Doom 2016</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voc√™ ficar√° chocado com o n√∫mero de opera√ß√µes necess√°rias para criar um quadro.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fc/618/e79/4fc618e791b417e9359ca81948ae187f.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo o trabalho realizado para criar o quadro deve ser salvo no buffer, seja o resultado final ou intermedi√°rio. </font><font style="vertical-align: inherit;">Em geral, o jogo usa em tempo real pelo menos dois buffers para exibi√ß√£o final: um para "trabalho atual" e o segundo buffer est√° aguardando o acesso de um monitor ou est√° em processo de exibi√ß√£o. </font><font style="vertical-align: inherit;">Voc√™ sempre precisa de um buffer de tela no qual o resultado da renderiza√ß√£o ser√° salvo e, quando todos os buffers estiverem cheios, ser√° necess√°rio seguir em frente e criar um novo buffer. </font><font style="vertical-align: inherit;">Ap√≥s a conclus√£o do trabalho com o quadro, √© dado um comando simples, os buffers finais do quadro s√£o trocados, o monitor recebe o √∫ltimo quadro renderizado e o processo de renderiza√ß√£o do pr√≥ximo quadro √© iniciado.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/925/e6e/c4d/925e6ec4d1593ec473c0660ffa555969.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse quadro da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assassin's Creed Odyssey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vemos o conte√∫do do buffer de quadros completo. </font><font style="vertical-align: inherit;">Este conte√∫do pode ser representado em uma tabela que cont√©m apenas n√∫meros. </font><font style="vertical-align: inherit;">Eles s√£o enviados na forma de sinais el√©tricos para um monitor ou TV, e os pixels da tela alteram seus valores. </font><font style="vertical-align: inherit;">Nossos olhos veem uma imagem plana e s√≥lida, mas nosso c√©rebro a interpreta como tridimensional. </font><font style="vertical-align: inherit;">H√° tanto trabalho escondido nos bastidores de apenas uma cena do jogo que vale a pena dar uma olhada em como os programadores podem lidar com isso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de processos: APIs e instru√ß√µes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para descobrir como fazer o jogo executar e gerenciar todos os c√°lculos, v√©rtices, texturas, ilumina√ß√£o, buffers, etc. - esta √© uma tarefa enorme. Felizmente, ajude-nos nessas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interfaces de programa√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (interface de programa√ß√£o de aplicativos, API). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As APIs de renderiza√ß√£o reduzem a complexidade geral, oferecendo estruturas, regras e bibliotecas de software que permitem instru√ß√µes simplificadas e independentes de hardware. Fa√ßa qualquer jogo 3D lan√ßado para PC nos √∫ltimos tr√™s anos: ele foi criado usando uma das tr√™s APIs populares - Direct3D, OpenGL ou Vulkan. Existem outros desenvolvimentos semelhantes, especialmente no segmento m√≥vel, mas neste artigo falaremos sobre os tr√™s mencionados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/383/aea/228/383aea228f8c09089472da334107b6e2.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar das diferen√ßas nos nomes de instru√ß√µes e opera√ß√µes (por exemplo, um bloco de c√≥digo para processamento de pixels no DirectX √© chamado de sombreador de pixels e no Vulkan √© chamado de sombreador de fragmentos), o resultado final n√£o difere, mais precisamente, n√£o deve ser diferente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diferen√ßa ser√° manifestada em qual equipamento √© usado para renderiza√ß√£o. As instru√ß√µes geradas pela API precisam ser convertidas em comandos compat√≠veis com o hardware que s√£o processados ‚Äã‚Äãpelos drivers de dispositivo. E os fabricantes de equipamentos precisam gastar muitos recursos e tempo para que seus drivers realizem essa convers√£o o mais r√°pido e corretamente poss√≠vel.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8df/431/c77/8df431c7781e07219bfaab3829f209df.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, a vers√£o beta inicial de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Talos Principle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2014) suportava todas as tr√™s APIs mencionadas. </font><font style="vertical-align: inherit;">Para demonstrar como os resultados de diferentes combina√ß√µes de drivers e interfaces podem diferir, executamos o benchmark interno padr√£o, definindo a resolu√ß√£o para 1080p e as configura√ß√µes de qualidade m√°xima. </font><font style="vertical-align: inherit;">O processador Intel Core i7-9700K funcionou sem overclock, a placa de v√≠deo Nvidia Titan X (Pascal), RAM - DDR4 de 32 GB RAM.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectX 9 = uma m√©dia de 188,4 quadros / s.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectX 11 = uma m√©dia de 202,3 quadros / s.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL = m√©dia de 87,9 quadros / s.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vulkan = uma m√©dia de 189,4 quadros / s.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o analisaremos os resultados e eles certamente n√£o dizem que uma API √© "melhor" que a outra (n√£o se esque√ßa, a vers√£o beta do jogo foi testada). Diremos apenas que a programa√ß√£o para diferentes APIs est√° associada a v√°rias dificuldades e, a qualquer momento, o desempenho tamb√©m ser√° diferente. Em geral, os desenvolvedores de jogos escolhem a API com a qual t√™m mais experi√™ncia e otimizam seu c√≥digo. √Äs vezes, o termo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mecanismo √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usado para descrever o c√≥digo respons√°vel pela renderiza√ß√£o, </font><font style="vertical-align: inherit;">mas estritamente falando, o mecanismo √© um conjunto completo de ferramentas que processa todos os aspectos do jogo, n√£o apenas gr√°ficos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o √© t√£o f√°cil criar um programa a partir do zero que renderiza um jogo em 3D. Portanto, hoje em muitos jogos s√£o utilizados sistemas de terceiros licenciados (por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unreal Engine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Para avaliar sua complexidade, abra o mecanismo de c√≥digo aberto do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quake</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e visualize o arquivo gl_draw.c: ele cont√©m instru√ß√µes para diferentes opera√ß√µes de renderiza√ß√£o e reflete apenas uma pequena parte do mecanismo inteiro. </font><font style="vertical-align: inherit;">Mas o Quake foi lan√ßado h√° mais de 20 anos e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todo o jogo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (incluindo todos os recursos visuais, sons, m√∫sicas etc.) ocupa 55 MB. </font><font style="vertical-align: inherit;">Para compara√ß√£o, no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Far Cry 5, </font></font></a> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apenas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shaders ocupam 62 MB.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O tempo √© mais importante: usar o equipamento certo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os itens acima podem ser calculados e processados ‚Äã‚Äãpelo processador de qualquer sistema de computador. Os processadores modernos da fam√≠lia x86-64 suportam todas as opera√ß√µes matem√°ticas necess√°rias e at√© cont√™m subsistemas separados para isso. No entanto, a tarefa de renderizar um √∫nico quadro requer numerosos c√°lculos repetidos e paraleliza√ß√£o significativa do trabalho. Os processadores centrais n√£o est√£o adaptados para isso, porque s√£o criados para resolver a maior variedade poss√≠vel de tarefas. Processadores especializados para computa√ß√£o gr√°fica s√£o chamados de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPUs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (unidades de processamento gr√°fico). Eles s√£o criados para DirectX, OpenGL e Vulkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usaremos uma refer√™ncia que permite renderizar um quadro usando um processador central ou equipamento especializado - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V-ray NEXT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empresas do Grupo Caos. </font><font style="vertical-align: inherit;">De fato, ele faz o tra√ßado de raios em vez de renderizar, mas a maioria das opera√ß√µes num√©ricas aqui tamb√©m depende do hardware.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/4be/7bd/dc64be7bd6494f79cec1f01c501b7502.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos passar a refer√™ncia em tr√™s modos: apenas o processador central, apenas o processador gr√°fico e uma combina√ß√£o dos dois processadores:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU sozinha = 53 milh√µes de raios</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU sozinha = 251 milh√µes de raios</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A combina√ß√£o dos dois processadores = 299 milh√µes de raios</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A unidade de medida pode ser ignorada, a ess√™ncia √© cinco vezes a diferen√ßa. </font><font style="vertical-align: inherit;">Mas, ainda assim, esse teste n√£o est√° muito relacionado aos jogos, ent√£o vamos ao benchmark da velha escola </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Futuremark 3DMark03</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vamos executar um teste simples de Wings of Fury com um c√°lculo for√ßado de todos os shaders de v√©rtice (ou seja, com um conjunto completo de opera√ß√µes para mover e colorir tri√¢ngulos) usando o processador central.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f3/f30/609/9f3f30609c33987cb25f2e10c4aff602.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado n√£o deve surpreend√™-lo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processador central = m√©dia de 77 quadros / s.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU = m√©dia de 1.580 quadros / s.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando todos os c√°lculos com os v√©rtices s√£o executados pelo processador central, s√£o necess√°rios 13 ms em m√©dia para renderizar e exibir cada quadro. E ao usar um processador gr√°fico, esse n√∫mero cai para 0,6 ms - mais de 20 vezes mais r√°pido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diferen√ßa aumenta ainda mais se voc√™ executar o teste de benchmark mais dif√≠cil - a M√£e Natureza. O processador central produziu 3,1 quadros / s insignificantes! E o processador gr√°fico disparou em 1388 quadros / s .: quase 450 vezes mais r√°pido. Observe: o 3DMark03 saiu 16 de volta e, no teste no processador central, apenas os v√©rtices s√£o processados, o processador gr√°fico ainda assume o est√°gio de rasteriza√ß√£o e pixel. Imagine se o benchmark fosse moderno e a maioria das opera√ß√µes fosse executada programaticamente?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ec/85a/87f/7ec85a87fbffad6ef27cf88d08970aea.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, tentaremos novamente o benchmark </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unigine Valley</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , os gr√°ficos que ele processa s√£o muito semelhantes aos usados ‚Äã‚Äãem jogos como Far Cry 5. Tamb√©m h√° um mecanismo de renderiza√ß√£o de software completo, al√©m do DirectX 11. padr√£o. Ao rodar em um processador de v√≠deo, obtivemos um resultado m√©dio de 196 quadros / s . E a vers√£o do software? Ap√≥s algumas falhas, um poderoso PC de teste gerou uma m√©dia de 0,1 quadros / s. quase </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duas mil vezes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mais devagar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A raz√£o para uma diferen√ßa t√£o grande est√° nos c√°lculos matem√°ticos e no formato de dados usado na renderiza√ß√£o em 3D. Cada n√∫cleo da CPU est√° equipado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com m√≥dulos de ponto flutuante</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O i7-9700K cont√©m 8 n√∫cleos, cada um com dois desses m√≥dulos. Embora a arquitetura dos m√≥dulos no Titan X seja diferente, ambos os tipos podem executar os mesmos c√°lculos com dados do mesmo formato. Esta placa de v√≠deo possui mais de 3500 m√≥dulos para realizar c√°lculos compar√°veis ‚Äã‚Äãe, embora sua frequ√™ncia de clock seja muito menor do que no processador central (1,5 GHz e 4,7 GHz), no entanto, o processador de v√≠deo aceita o n√∫mero de m√≥dulos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora o Titan X n√£o seja uma placa gr√°fica de massa, mesmo um modelo econ√¥mico ultrapassar√° qualquer processador central. Portanto, todos os jogos 3D e APIs s√£o projetados para equipamentos especializados. Voc√™ pode fazer o download de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V-ray</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3DMark</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qualquer </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benchmark </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unigine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e teste seu sistema - veja voc√™ mesmo como os processadores de v√≠deo est√£o adaptados para renderizar gr√°ficos em jogos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Palavras finais</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foi uma pequena digress√£o no processo de cria√ß√£o de um √∫nico quadro em jogos 3D, de um ponto no espa√ßo a uma imagem colorida em um monitor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, todo o processo est√° apenas trabalhando com n√∫meros. No entanto, muito permaneceu fora do escopo do artigo. N√£o consideramos c√°lculos matem√°ticos espec√≠ficos da √°lgebra linear euclidiana, trigonometria e c√°lculos diferenciais realizados por vertex e pixel shaders. Tamb√©m n√£o falamos sobre como as texturas s√£o processadas usando amostragem estat√≠stica. Omiti efeitos visuais interessantes, como bloquear a luz ambiente no espa√ßo da tela, reduzir a interfer√™ncia no rastreamento de raios, usar a faixa din√¢mica estendida e a suaviza√ß√£o temporal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E da pr√≥xima vez que voc√™ lan√ßar um jogo 3D moderno, esperamos que voc√™ n√£o apenas observe os gr√°ficos com olhos diferentes, mas tamb√©m queira saber mais sobre ele.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt500670/index.html">Como criamos nosso produto. Parte Um, Pesquisa</a></li>
<li><a href="../pt500672/index.html">Continua√ß√£o do fluxo para testadores e n√£o apenas</a></li>
<li><a href="../pt500676/index.html">An√∫ncio de um workshop on-line sobre automa√ß√£o de testes</a></li>
<li><a href="../pt500678/index.html">ClickHouse para usu√°rios avan√ßados em perguntas e respostas</a></li>
<li><a href="../pt500688/index.html">Trabalhando com um banco de dados no Flask: de junho a junho</a></li>
<li><a href="../pt500694/index.html">68 dicas n√£o solicitadas</a></li>
<li><a href="../pt500696/index.html">Como os t√™nis est√£o tentando se adaptar ao p√© feminino</a></li>
<li><a href="../pt500698/index.html">Evgeny Katyshev: ‚ÄúO OpenStreetMap n√£o √© adequado para nenhuma informa√ß√£o‚Äù</a></li>
<li><a href="../pt500700/index.html">Suporte para TLS1.3 e expans√£o de sua conta pessoal: o que foi feito no primeiro trimestre de 2020</a></li>
<li><a href="../pt500704/index.html">Unic√≥rnios (Airbnb, Uber, Lyft, Careem) demitem milhares de funcion√°rios em meio a problemas durante a pandemia de coronav√≠rus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>