<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👩‍👦‍👦 👩🏿‍🔬 🏄 Ajout intelligent de groupes musicaux à Google Sheets via VK API, Tampermonkey et Telegram bot 👨‍🍳 👩‍❤️‍💋‍👩 🧕🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comment organiser le stockage de musique dans Google Sheets avec la prise en charge de plusieurs programmes?
 
 
 Éléments fournis: comptes dans Googl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Ajout intelligent de groupes musicaux à Google Sheets via VK API, Tampermonkey et Telegram bot</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504664/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment organiser le stockage de musique dans Google Sheets avec la prise en charge de plusieurs programmes?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/jq/sf/hrjqsf-vqmo0b_zofufnv6lt3ls.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éléments</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fournis: comptes dans Google, VK, télégramme. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tâche</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : créer un référentiel de groupes de musique avec possibilité de réapprovisionnement pratique. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outils</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Google Apps Script (GAS), VK API, Tampermonkey, Telegram Bot API.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer des feuilles de calcul Google</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez une nouvelle feuille de calcul Google. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous faisons un en-tête fixe (alors tous les cycles d'énumération des cellules, à cause de cela, commenceront non pas à partir de 0, mais à partir de 1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, notre modèle est prêt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La seule chose est que je n'ai pas lié aux colonnes par les noms (je ne voulais pas utiliser de boucles), donc tout au long du script, je ferai référence au numéro de colonne câblé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquez sur "Outils - Script Editor".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ge/xg/exgexg7amygeqbhjaaudvtir3p8.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 Créez un script: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kod.gs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot.gs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs">access_token = <span class="hljs-string">'1111111111'</span> <span class="hljs-comment">// VK token</span>
ss = SpreadsheetApp.getActiveSpreadsheet() <span class="hljs-comment">// </span>
sheet = ss.getSheets()[getNumSheet(<span class="hljs-string">''</span>)] <span class="hljs-comment">// </span>
data = sheet.getDataRange().getValues() <span class="hljs-comment">//  </span>
numRows = sheet.getLastRow()+<span class="hljs-number">1</span> <span class="hljs-comment">//  </span>
faveTag = <span class="hljs-string">'.'</span> <span class="hljs-comment">//    </span><font></font>
<font></font>
<span class="hljs-comment">//   get </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doGet</span>(<span class="hljs-params">e</span>) </span>{
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> link = e.parameters[<span class="hljs-string">'link'</span>]
    <span class="hljs-comment">/*
      A - 
      B - English
      C - 
      D - 
      E - 
      F - 
      G - 
    */</span>
    <span class="hljs-keyword">var</span> n = searchExists(link)
    <span class="hljs-keyword">if</span> (n != <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> ContentService.createTextOutput(<span class="hljs-string">' '</span>+n+<span class="hljs-string">'  !'</span>)
    <span class="hljs-comment">//   API VK https://vk.com/dev/groups.getById</span>
    <span class="hljs-keyword">var</span> html = UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/groups.getById.json?group_id='</span>+link+<span class="hljs-string">'&amp;fields=city,description&amp;access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.107'</span>)
    <span class="hljs-comment">//   json   response</span>
    <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(html).response[<span class="hljs-number">0</span>]<font></font>
    addInTableFromArray(json, link)<font></font>
    sort()<font></font>
    <span class="hljs-keyword">return</span> ContentService.createTextOutput(<span class="hljs-string">''</span>)<font></font>
  } <span class="hljs-keyword">catch</span> (e) {
     <span class="hljs-keyword">return</span> ContentService.createTextOutput(<span class="hljs-string">'   doGet! '</span>+e)<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//  /     </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">searchGenre</span>(<span class="hljs-params">txt</span>) </span>{
  <span class="hljs-keyword">var</span> t = txt.match(<span class="hljs-regexp">/(?:(?:[||||]|genre|[|||]?)[\s:-]+){1}([a-z-\/-]+)/i</span>)
  <span class="hljs-keyword">if</span>(txt != <span class="hljs-string">''</span> &amp;&amp; t) <span class="hljs-keyword">return</span> t[<span class="hljs-number">1</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//     </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isRus</span>(<span class="hljs-params">txt</span>) </span>{
  <span class="hljs-keyword">return</span> txt.search(<span class="hljs-regexp">/[^A-Za-z0-9\/.:_]+/i</span>)<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sort</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-comment">//         </span>
  <span class="hljs-keyword">var</span> tableRange = <span class="hljs-string">"A2:G"</span>+numRows
  <span class="hljs-keyword">var</span> editedCell = sheet.getActiveCell()
  <span class="hljs-keyword">var</span> range = sheet.getRange(tableRange)
  <span class="hljs-comment">//     .    0,   1</span><font></font>
  range.sort([{ <font></font>
    <span class="hljs-attr">column</span> : <span class="hljs-number">4</span>,
    <span class="hljs-attr">ascending</span>: <span class="hljs-literal">true</span><font></font>
  },{<font></font>
    <span class="hljs-attr">column</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">ascending</span>: <span class="hljs-literal">true</span><font></font>
  },{<font></font>
    <span class="hljs-attr">column</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">ascending</span>: <span class="hljs-literal">true</span><font></font>
  }])<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">searchExists</span>(<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">if</span> (t == data[i][<span class="hljs-number">2</span>] || <span class="hljs-string">'club'</span>+t == data[i][<span class="hljs-number">2</span>]){
      <span class="hljs-keyword">return</span> data[i][<span class="hljs-number">0</span>]+data[i][<span class="hljs-number">1</span>]<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//      </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInfo</span>(<span class="hljs-params">isBot = false</span>) </span>{
  <span class="hljs-keyword">var</span> arr = []
  <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>
  <span class="hljs-keyword">var</span> part = <span class="hljs-number">1000</span> <span class="hljs-comment">// - ,      . -      UrlFetchApp.fetch</span>
  arr[j] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>()
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">var</span> txt = data[i][<span class="hljs-number">2</span>].replace(<span class="hljs-string">'https://vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'^club'</span>,<span class="hljs-string">''</span>)
    <span class="hljs-keyword">if</span> (txt != <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">0</span>] == <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">1</span>] == <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">3</span>] == <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">4</span>] == <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">5</span>] == <span class="hljs-string">''</span> &amp;&amp; data[i][<span class="hljs-number">6</span>] == <span class="hljs-string">''</span>){<font></font>
      arr[j].push(txt)<font></font>
      <span class="hljs-keyword">if</span> (arr[j].toString().length &gt; part){<font></font>
        j++<font></font>
        arr[j] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>()<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (arr[<span class="hljs-number">0</span>].length == <span class="hljs-number">0</span>){
    <span class="hljs-keyword">if</span> (isBot) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">else</span>{<font></font>
      SpreadsheetApp.getUi().alert(<span class="hljs-string">' ,   '</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-number">0</span>; t &lt; <span class="hljs-built_in">Math</span>.ceil(arr.toString().length/part); t++) {
    <span class="hljs-keyword">var</span> html = UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/groups.getById.json?group_ids='</span>+arr[t].toString()+<span class="hljs-string">'&amp;fields=city,description&amp;access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.107'</span>)
    <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(html).response
    <span class="hljs-keyword">if</span>(json){
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; json.length; i++) {
        <span class="hljs-keyword">var</span> id = json[i].id
        <span class="hljs-keyword">var</span> link = json[i].screen_name
        <span class="hljs-keyword">var</span> name = json[i].name
        <span class="hljs-keyword">var</span> description = (json[i].description)?json[i].description:<span class="hljs-string">''</span>
        <span class="hljs-keyword">var</span> city = (json[i].city)?json[i].city.title:<span class="hljs-string">''</span>
        <span class="hljs-keyword">var</span> rus = (isRus(name) != <span class="hljs-number">-1</span>)?<span class="hljs-string">"A"</span>:<span class="hljs-string">"B"</span>    
        <span class="hljs-comment">//         arr</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">1</span>; j &lt; data.length; j++) {
          <span class="hljs-keyword">var</span> nameCell = data[j][<span class="hljs-number">2</span>].replace(<span class="hljs-string">'https://vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'^club'</span>,<span class="hljs-string">''</span>)
          <span class="hljs-keyword">if</span> (nameCell == link || nameCell == id){
            <span class="hljs-keyword">var</span> num = j+<span class="hljs-number">1</span>
            <span class="hljs-keyword">break</span><font></font>
          }<font></font>
        }<font></font>
        sheet.getRange(rus+num).setValue(name.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>))<font></font>
        sheet.getRange(<span class="hljs-string">"C"</span>+num).setValue(<span class="hljs-string">'=HYPERLINK("https://vk.com/'</span>+link+<span class="hljs-string">'";"'</span>+link+<span class="hljs-string">'")'</span>)<font></font>
        sheet.getRange(<span class="hljs-string">"D"</span>+num).setValue(city)<font></font>
        sheet.getRange(<span class="hljs-string">"E"</span>+num).setValue(searchGenre(description))<font></font>
        sheet.getRange(<span class="hljs-string">"F"</span>+num).setValue(description)<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  sort()<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//     </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getVkFave</span>(<span class="hljs-params">isBot = false</span>) </span>{
  <span class="hljs-keyword">var</span> idTag
  <span class="hljs-keyword">var</span> getTags = UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/fave.getTags.json?access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.107'</span>)
  <span class="hljs-keyword">var</span> res = <span class="hljs-built_in">JSON</span>.parse(getTags).response
  <span class="hljs-keyword">var</span> iTag = res.items
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; iTag.length; i++) {
    <span class="hljs-keyword">if</span> (iTag[i].name == faveTag) idTag = iTag[i].id<font></font>
  }<font></font>
  <font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">if</span> (!isBot){
    <span class="hljs-keyword">var</span> ui = SpreadsheetApp.getUi()
    <span class="hljs-keyword">var</span> resp = ui.alert(<span class="hljs-string">'     "'</span>+faveTag+<span class="hljs-string">'"     . ?'</span>, ui.ButtonSet.YES_NO)<font></font>
  }<font></font>
  <span class="hljs-keyword">var</span> inside = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> getPages = UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/fave.getPages.json?tag_id='</span>+idTag+<span class="hljs-string">'&amp;fields=city,description&amp;access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.107'</span>)
    <span class="hljs-keyword">var</span> iPage = <span class="hljs-built_in">JSON</span>.parse(getPages).response.items
    <span class="hljs-comment">//    .   ,   </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; iPage.length; j++) {
      <span class="hljs-keyword">var</span> gr = iPage[j].group<font></font>
      addInTableFromArray(gr)<font></font>
      numRows++<font></font>
        UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/fave.removePage?group_id='</span>+gr.id+<span class="hljs-string">'&amp;access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.107'</span>)<font></font>
        Utilities.sleep(<span class="hljs-number">1000</span>) <span class="hljs-comment">// </span><font></font>
    }<font></font>
    sort()<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (isBot) { <span class="hljs-comment">// ,      ui</span><font></font>
    inside()<font></font>
  }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(resp == ui.Button.YES) {<font></font>
    inside()<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInTableFromArray</span>(<span class="hljs-params">arr, linkIn</span>) </span>{
  <span class="hljs-keyword">if</span> (linkIn){
    <span class="hljs-keyword">var</span> link = linkIn<font></font>
  }<span class="hljs-keyword">else</span>{
    <span class="hljs-keyword">var</span> link = arr.screen_name
    <span class="hljs-keyword">if</span> (searchExists(link) != <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><font></font>
  }<font></font>
  <span class="hljs-keyword">var</span> name = arr.name <span class="hljs-comment">// </span>
  <span class="hljs-keyword">var</span> description = (arr.description)?arr.description:<span class="hljs-string">''</span> <span class="hljs-comment">//</span>
  <span class="hljs-keyword">var</span> city = (arr.city)?arr.city.title:<span class="hljs-string">''</span> <span class="hljs-comment">// </span>
  <span class="hljs-comment">//      ,      "English"</span>
  <span class="hljs-keyword">var</span> rus = (isRus(name) != <span class="hljs-number">-1</span>)?<span class="hljs-string">"A"</span>:<span class="hljs-string">"B"</span>
  <span class="hljs-comment">//    </span>
  sheet.getRange(rus+numRows).setValue(name.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>))<font></font>
  sheet.getRange(<span class="hljs-string">"C"</span>+numRows).setValue(<span class="hljs-string">'=HYPERLINK("https://vk.com/'</span>+link+<span class="hljs-string">'";"'</span>+link+<span class="hljs-string">'")'</span>)<font></font>
  sheet.getRange(<span class="hljs-string">"D"</span>+numRows).setValue(city)<font></font>
  sheet.getRange(<span class="hljs-string">"E"</span>+numRows).setValue(searchGenre(description))<font></font>
  sheet.getRange(<span class="hljs-string">"F"</span>+numRows).setValue(description)<font></font>
}<font></font>
<span class="hljs-comment">//  . .</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkActualLink</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">var</span> num = i+<span class="hljs-number">1</span>
      UrlFetchApp.fetch(<span class="hljs-string">"https://vk.com/"</span>+data[i][<span class="hljs-number">2</span>])<font></font>
      sheet.getRange(<span class="hljs-string">'C'</span>+num).setBackgroundColor(<span class="hljs-string">''</span>)<font></font>
    }<span class="hljs-keyword">catch</span>(err) {
      <span class="hljs-keyword">var</span> num = i+<span class="hljs-number">1</span>
      sheet.getRange(<span class="hljs-string">'C'</span>+num).setBackgroundColor(<span class="hljs-string">'red'</span>)<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<span class="hljs-comment">//  URL  .     </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getStatusUrl</span>(<span class="hljs-params">url</span>)</span>{
   <span class="hljs-keyword">var</span> options = {
     <span class="hljs-string">'muteHttpExceptions'</span>: <span class="hljs-literal">true</span>,
     <span class="hljs-string">'followRedirects'</span>: <span class="hljs-literal">false</span><font></font>
   }<font></font>
   <span class="hljs-keyword">var</span> response = UrlFetchApp.fetch(url.trim(), options)
   <span class="hljs-keyword">return</span> response.getResponseCode()<font></font>
}<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNumSheet</span>(<span class="hljs-params">nameList</span>)</span>{
  <span class="hljs-keyword">var</span> s = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(nameList)
  <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> s.getIndex()<span class="hljs-number">-1</span>
  }<span class="hljs-keyword">else</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><font></font>
  }<font></font>
}<font></font>
<span class="hljs-comment">// </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeHtml</span>(<span class="hljs-params">text</span>) </span>{
  <span class="hljs-keyword">return</span> text<font></font>
      .replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">""</span>)<font></font>
      .replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">""</span>)<font></font>
      .replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">""</span>);<font></font>
}<font></font>
<span class="hljs-comment">// </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onOpen</span>(<span class="hljs-params"></span>) </span>{<font></font>
  SpreadsheetApp.getUi()<font></font>
  .createMenu(<span class="hljs-string">' '</span>)<font></font>
  .addItem(<span class="hljs-string">''</span>, <span class="hljs-string">'sort'</span>)<font></font>
  .addItem(<span class="hljs-string">'   '</span>, <span class="hljs-string">'getVkFave'</span>)<font></font>
  .addItem(<span class="hljs-string">' '</span>, <span class="hljs-string">'addInfo'</span>)<font></font>
  .addToUi();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ll</span>(<span class="hljs-params">t</span>)</span>{
  <span class="hljs-keyword">return</span> Logger.log(t)<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot.gs</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> botApi = <span class="hljs-string">'https://api.telegram.org/bot1123123:AAA/'</span> <span class="hljs-comment">//  Telegram  </span>
<span class="hljs-comment">/* :
 /start -   
 /sort - 
 /getvkfave -     
 /addinfo -  
 /getall -   
*/</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doPost</span>(<span class="hljs-params">e</span>)</span>{
  <span class="hljs-keyword">var</span> inp = <span class="hljs-built_in">JSON</span>.parse(e.postData.contents)
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">var</span> sheet2 = ss.getSheets()[getNumSheet(<span class="hljs-string">''</span>)]<font></font>
  sheet2.getRange(<span class="hljs-string">'A1'</span>).setValue(inp)<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> inpTxt = inp.message.text
  <span class="hljs-keyword">var</span> chatId = inp.message.chat.id<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> link = inpTxt.replace(<span class="hljs-string">'https://vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'vk.com/'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'^club'</span>,<span class="hljs-string">''</span>)
  <span class="hljs-comment">//  </span>
  <span class="hljs-comment">// start</span>
  <span class="hljs-keyword">if</span> (inpTxt == <span class="hljs-string">'/start'</span> || inpTxt == <span class="hljs-string">' '</span>){<font></font>
    sendText(chatId, <span class="hljs-string">'      Google .\n'</span>+
                    <span class="hljs-string">'/start -   \n'</span>+
                    <span class="hljs-string">'/sort - \n'</span>+
                    <span class="hljs-string">'/getvkfave -    \n'</span>+
                    <span class="hljs-string">'/addinfo -  \n'</span>+
                    <span class="hljs-string">'/getall -   '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <span class="hljs-comment">// sort</span>
  <span class="hljs-keyword">if</span> (inpTxt == <span class="hljs-string">'/sort'</span> || inpTxt == <span class="hljs-string">''</span>){<font></font>
    sort()<font></font>
    sendText(chatId, <span class="hljs-string">''</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <span class="hljs-comment">// getvkfave</span>
  <span class="hljs-keyword">if</span> (inpTxt == <span class="hljs-string">'/getvkfave'</span> || inpTxt == <span class="hljs-string">'   '</span>){<font></font>
    getVkFave(<span class="hljs-literal">true</span>)<font></font>
    sendText(chatId, <span class="hljs-string">''</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <span class="hljs-comment">// addinfo</span>
  <span class="hljs-keyword">if</span> (inpTxt == <span class="hljs-string">'/addinfo'</span> || inpTxt == <span class="hljs-string">' '</span>){
    <span class="hljs-keyword">if</span> (addInfo(<span class="hljs-literal">true</span>)) sendText(chatId, <span class="hljs-string">''</span>)
    <span class="hljs-keyword">else</span> sendText(chatId, <span class="hljs-string">' ,   '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <span class="hljs-comment">// getall</span>
  <span class="hljs-keyword">if</span> (inpTxt == <span class="hljs-string">'/getall'</span> || inpTxt == <span class="hljs-string">'  '</span>){
    <span class="hljs-keyword">var</span> arr = [[],[],[],[],[],[],[],[],[],[],[<span class="hljs-string">' '</span>]] <span class="hljs-comment">// TODO </span>
    <span class="hljs-keyword">var</span> repeat = <span class="hljs-string">''</span>
    <span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>
    <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) {
      <span class="hljs-keyword">if</span> (j == <span class="hljs-number">4</span>){ <span class="hljs-comment">//    </span><font></font>
        n++<font></font>
        j = <span class="hljs-number">0</span><font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (repeat != data[i][<span class="hljs-number">3</span>]){<font></font>
        arr[n][j] = data[i][<span class="hljs-number">3</span>]
        <span class="hljs-keyword">if</span> (data[i][<span class="hljs-number">3</span>] == <span class="hljs-string">''</span>) arr[n][j] = <span class="hljs-string">'---'</span><font></font>
        j++<font></font>
      }<font></font>
      repeat = data[i][<span class="hljs-number">3</span>]<font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> key = <span class="hljs-built_in">JSON</span>.stringify({<span class="hljs-attr">keyboard</span>: <font></font>
                              arr,<font></font>
                              <span class="hljs-attr">resize_keyboard</span>:<span class="hljs-literal">true</span>,
                              <span class="hljs-attr">one_time_keyboard</span>:<span class="hljs-literal">true</span><font></font>
                            });<font></font>
    sendText(chatId, <span class="hljs-string">' '</span>, key)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">if</span> (isRus(link) != <span class="hljs-number">-1</span>) {
    <span class="hljs-keyword">var</span> name = (inpTxt == <span class="hljs-string">'---'</span>)?<span class="hljs-string">' '</span>:inpTxt
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">1</span>; j &lt; data.length; j++) {
      <span class="hljs-keyword">if</span> (data[j][<span class="hljs-number">3</span>] == inpTxt || inpTxt == <span class="hljs-string">'---'</span>) {
        <span class="hljs-keyword">var</span> str = <span class="hljs-string">' '</span>+name+<span class="hljs-string">'\n\n'</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) {
          <span class="hljs-keyword">if</span> ((data[j][<span class="hljs-number">3</span>] == data[i][<span class="hljs-number">3</span>]) || (data[i][<span class="hljs-number">3</span>] == <span class="hljs-string">''</span> &amp;&amp; inpTxt == <span class="hljs-string">'---'</span>)) {
            <span class="hljs-keyword">if</span> (str.length &gt;= <span class="hljs-number">4000</span>) { <span class="hljs-comment">//   -    Telegram </span><font></font>
              sendText(chatId, str)<font></font>
              str = <span class="hljs-string">''</span><font></font>
            }<font></font>
            str = str + <span class="hljs-string">'&lt;a href="https://vk.com/'</span> + data[i][<span class="hljs-number">2</span>] + <span class="hljs-string">'"&gt;'</span> + escapeHtml(data[i][<span class="hljs-number">0</span>] + data[i][<span class="hljs-number">1</span>]) + <span class="hljs-string">'&lt;/a&gt; \n'</span><font></font>
          }<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (str != <span class="hljs-string">''</span>) sendText(chatId, str)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
      }<font></font>
    }<font></font>
    sendText(chatId, inpTxt + <span class="hljs-string">' -   .    '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">if</span> (getStatusUrl(<span class="hljs-string">'https://vk.com/'</span>+link) != <span class="hljs-number">200</span> &amp;&amp; getStatusUrl(<span class="hljs-string">'https://vk.com/club'</span>+link) != <span class="hljs-number">200</span>){<font></font>
    sendText(chatId, inpTxt+<span class="hljs-string">' -  '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> name = searchExists(link)
  <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">false</span>){<font></font>
    sendText(chatId, <span class="hljs-string">' '</span>+name+<span class="hljs-string">'  '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }<span class="hljs-keyword">else</span>{
    <span class="hljs-keyword">var</span> html = UrlFetchApp.fetch(<span class="hljs-string">'https://api.vk.com/method/groups.getById.json?group_id='</span>+link+<span class="hljs-string">'&amp;fields=city,description&amp;access_token='</span>+access_token+<span class="hljs-string">'&amp;v=5.103'</span>)
    <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(html).response[<span class="hljs-number">0</span>]<font></font>
    addInTableFromArray(json, link)<font></font>
    sort()<font></font>
    sendText(chatId, <span class="hljs-string">' '</span>+json.name+<span class="hljs-string">' '</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
  }<font></font>
}<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendText</span>(<span class="hljs-params">chatId, text, key = <span class="hljs-string">''</span></span>)</span>{
  <span class="hljs-keyword">var</span> payload = {
    <span class="hljs-string">'method'</span>: <span class="hljs-string">'sendMessage'</span>,
    <span class="hljs-string">'chat_id'</span>: <span class="hljs-built_in">String</span>(chatId),
    <span class="hljs-string">'text'</span>: text,
    <span class="hljs-string">'parse_mode'</span>: <span class="hljs-string">'HTML'</span>,
    <span class="hljs-string">'reply_markup'</span>: key,
    <span class="hljs-string">'disable_web_page_preview'</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">'one_time_keyboard'</span>:<span class="hljs-literal">true</span><font></font>
  }     <font></font>
  <span class="hljs-keyword">var</span> data = {
    <span class="hljs-string">"method"</span>: <span class="hljs-string">"post"</span>,
    <span class="hljs-string">"payload"</span>: payload<font></font>
  }<font></font>
  <span class="hljs-comment">//    UrlFetchApp.fetch   ll(text)</span><font></font>
  UrlFetchApp.fetch(botApi, data)<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus de détails ci-dessous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquez sur " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publier - Déployer en tant qu'application Web</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zl/kv/1x/zlkv1xdmgtujkydke7npwbz8ypu.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant un lien du formulaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script.google.com/macros/s/AAA/exec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en lui substituant le paramètre "link", nous pouvons ajouter le groupe VK à Google Table.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts utilisateur dans le navigateur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première et principale façon de saisir des données! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ouvrez le navigateur Google Chrome ou Mozilla Firefox et installez le plug-in de script utilisateur Tampermonkey. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mozilla</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'origine utilisé Greasemonkey, mais a dû passer à </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampermonkey en</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> raison de la compatibilité entre les navigateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qui se demandera pourquoi les paramètres du script utilisateur commencent par le préfixe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GM_</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et non </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TM_</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - l'idée n'est pas la mienne, consultez la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9y/wp/s5/9ywps5qxha6jnsvfepz62o6xpv4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous insérons le script </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vkGroupToGS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en cliquant sur le premier onglet avec un signe plus.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vkGroupToGS</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">// ==UserScript==</span>
<span class="hljs-comment">// @name         vkGroupToGS</span>
<span class="hljs-comment">// @namespace    https://vk.com/*</span>
<span class="hljs-comment">// @version      0.1</span>
<span class="hljs-comment">// @author       You</span>
<span class="hljs-comment">// @match        https://vk.com/*</span>
<span class="hljs-comment">// @grant        GM_xmlhttpRequest</span>
<span class="hljs-comment">// ==/UserScript==</span>
    <span class="hljs-keyword">var</span> url_first = <span class="hljs-string">'https://script.google.com/macros/s/AAA/exec'</span>
    <span class="hljs-keyword">var</span> url_short = <span class="hljs-built_in">document</span>.location.href.replace(<span class="hljs-string">"https://vk.com/"</span>, <span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>)
    <span class="hljs-keyword">var</span> head = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.left_menu_nav_wrap'</span>)<font></font>
    d.setAttribute(<span class="hljs-string">'id'</span>, <span class="hljs-string">'send_group'</span>)<font></font>
    d.style.display = <span class="hljs-string">'inline-block'</span>
    d.style.position = <span class="hljs-string">'relative'</span>
    d.style.fontSize = <span class="hljs-string">'50pt'</span>
    d.style.cursor = <span class="hljs-string">'pointer'</span>
    d.innerHTML = <span class="hljs-string">'+'</span><font></font>
    head.parentNode.appendChild(d)<font></font>
    d.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<font></font>
        GM_xmlhttpRequest({<font></font>
            <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
            <span class="hljs-attr">url</span>: url_first + <span class="hljs-string">'?link='</span> + url_short,
            <span class="hljs-attr">headers</span>: {
                <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/atom+xml,application/xml,text/xml'</span><font></font>
            },<font></font>
            <span class="hljs-attr">onload</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
                <span class="hljs-built_in">console</span>.log(x.responseText)
                <span class="hljs-keyword">if</span> (<span class="hljs-regexp">//</span>.test(x.responseText)) <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#send_group'</span>).style.color = <span class="hljs-string">'red'</span>
                <span class="hljs-keyword">else</span> <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#send_group'</span>).style.color = <span class="hljs-string">'green'</span><font></font>
            }<font></font>
        })<font></font>
    }, <span class="hljs-number">0</span>)<font></font>
};<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Fichier - Enregistrer".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/em/zh/pu/emzhpukphz204ikcn66qobqnf6i.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, notre script dessine un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signe plus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ce qui était suffisant pour l'imagination) dans le bloc gauche </font><i><font style="vertical-align: inherit;">left_menu_nav_wrap</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/zf/-j/j1zf-jnibtq16f4152hqafj--ak.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cliquant sur le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signe plus, GM_xmlhttpRequest</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vkGroupToGS est exécuté</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans notre script </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs en</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant le lien Google Sheets ci-dessus (url_first). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampermonkey nous demandera d'associer ces 2 scripts à des droits, cliquez sur " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toujours autoriser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " ou " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toujours autoriser le domaine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " pour " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script.google.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">Répétez au besoin pour " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script.googleusercontent.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ye/k8/5-/yek85-3w5grvstyw4-fzvbnevsu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dès que la demande s'envole avec succès, le rappel de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GM_xmlhttpRequest</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> viendra </font><font style="vertical-align: inherit;">colorer notre bouton en vert </font></font><font color="green"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">✚</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lors de l'ajout réussi ou en rouge </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">✚</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si l'erreur revient. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus Tampermonkey</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - stockage dans le cloud de scripts dans Google (pas auparavant) en présence de leur fertilité et de leur imagination. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retour à Google Sheets. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer à analyser notre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> je souhaite partager la documentation pour le développement dans VK - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/dev</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jeton VK</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtention d'une clé d'accès. </font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faire des demandes à l'API VKontakte.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jusqu'à présent, je n'ai appris qu'une seule façon d'obtenir un jeton - grâce à des applications auto-écrites. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">venons ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plate-forme - " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application autonome</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après la création, tout ce dont nous avons besoin est un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID d'application</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (maintenant à sept chiffres), que ce soit 1234567. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais nous avons besoin d'un jeton. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Très bien sur le jeton est écrit dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meet the VK API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous ne voulons pas lire, ouvrez simplement le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://oauth.vk.com/authorize%3Fclient_id%3D1234567%26scope%3Ddocs,offline%26redirect_uri%3D" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en insérant </font><font style="vertical-align: inherit;">votre </font><i><font style="vertical-align: inherit;">ID d'application</font></i><font style="vertical-align: inherit;"> dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client_id</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Nous sommes redirigés vers une page avec l'inscription:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez ne pas copier les données de la barre d'adresse pour les sites tiers. </font><font style="vertical-align: inherit;">Ainsi, vous risquez de perdre l'accès à votre compte.</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et c'est vrai, soyez très prudent avec le jeton! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous copions le jeton de la barre d'adresse après </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">access_token</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je partagerai immédiatement qu'avec ce jeton, vous pouvez interroger comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/dev/groups.search?params%5Bq%5D=%D0%BC%D1%83%D0%B7%D1%8B%D0%BA%D0%B0¶ms % 5Btype% 5D = page &amp; params% 5Bcountry_id% 5D = 1 &amp; params% 5Bcity_id% 5D = 1 &amp; params% 5Bmarket% 5D = 0 &amp; params% 5Boffset% 5D = 0 &amp; params% 5Bcount% 5D = 5 &amp; params% 5Bcount% 5D = 5 &amp; params% 5D</font></font></a> <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kz/85/az/kz85azkcm2tl83wiy3telzotaj4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
peut être converti en toute sécurité en liens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.vk.com/method/groups.search?q=%D0%BC%D1%83%D0%B7%D1%8B%D0%BA%D0%B0&amp;type=page&amp;country_id=1&amp;city_id=1&amp;future= 0 &amp; market = 0 &amp; offset = 0 &amp; count = 10 &amp; access_token = 1111111111111 &amp; v = 5.107</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et recevez des informations dans n'importe quelle application.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/64/nb/z5/64nbz5mxmx78sp8ilbr-6bwvz0y.png"></div></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai ouvert une petite boîte de Pandore, ce n'est peut-être pas une nouveauté, mais de cette façon, vous pouvez obtenir beaucoup de choses utiles de VK, automatiser de nombreux processus et créer beaucoup de choses pratiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, avec certaines </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">limitations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , disons pas plus de 999 entités dans la réponse ou 20 requêtes par seconde, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, quelqu'un sera intéressé à jouer avec les fichiers stockés - dans notre application, l'onglet " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procédures stockées</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a ses propres </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">règles pour</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> extraire des informations, ce qui est très pratique pour les requêtes séquentielles, afin de ne pas faire beaucoup de boucles dans votre code. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suivez les versions!</font></font></b> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Avec leurs modifications, la fonctionnalité des méthodes peut changer. Maintenant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'applique des exemples pour la version </font><b><font style="vertical-align: inherit;">5.107</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous avons le jeton, allez à ... </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs </font></font></b><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doGet (e)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Nous acceptons les requêtes get entrantes du bot, VK et seulement du navigateur. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les paramètres d'entrée sont analysés comme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e.parameters ['INPUT_Parameter']</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un lien arrive, vérifiez s'il y a une table. Sinon, demandez des informations détaillées via </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groups.getById</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , parsim, add. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
! Attention! Le script est simple, il avalera donc tous les liens entrants, donc soyez prudent même en saisissant 123 lors de la vérification du script. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">searchGenre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une recherche intelligente du style / genre du groupe, à cause de laquelle j'ai mis le libellé «expressions régulières» dans l'article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des améliorations sont possibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que cela ne fonctionne que pour rechercher la chaîne de mots suivante à travers une barre oblique ou un tiret après les mots "</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le style ou le </font><font style="vertical-align: inherit;">genre ou le </font><font style="vertical-align: inherit;">genre</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . » </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isRus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une règle simple régulière à l'exception des </font><font style="vertical-align: inherit;">lettres russes. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tri je mis la valeur par défaut à 1. ville, 2. nom.. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">searchExists</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - recherche pour les </font><font style="vertical-align: inherit;">groupes existants à </font><font style="vertical-align: inherit;">travers une boucle. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADDINFO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fait un script pour moi - </font><font style="vertical-align: inherit;">même, laissé ici , en bonus. Il est nécessaire si vous avez une liste de liens, mais qu'il n'y a pas de données dessus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insérez la liste dans la colonne "Lien", cliquez sur " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplir vide</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dans le menu principal et les colonnes restantes sont reconstituées à partir de VK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En raison de restrictions sur le nombre de caractères dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrlFetchApp .fetch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le nombre de liens placés dans la barre d'adresse a dû faire un cycle de 1000 caractères. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getVkFave</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Un autre bonus qui s'est produit dans ma tête lors de la rédaction d'un article et que j'ai moi-même commencé à utiliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'essentiel est que nous entrions dans l'application VC à partir du téléphone, tombons sur le groupe que nous voulons enregistrer, enregistrez-le dans des signets avec l'étiquette </font><font style="vertical-align: inherit;">« </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupe de musique</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> » </font><font style="vertical-align: inherit;">ajoutée à l'avance </font><font style="vertical-align: inherit;">(variable globale </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faveTag</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment s'accumulent-ils, accédez à notre tableau Google, appelez le menu, cliquez sur " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récupérer les signets de VK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script avec le jeton </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rampe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">api.vk.com/method/fave.getTags</font></a><font style="vertical-align: inherit;"> , analyse, ajoute à la table, ayant précédemment averti de la suppression du VC (ici, plus précisément avec les tests, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout est supprimé complètement des signets avec cette balise</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getStatusUrl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checkActualLink</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- une expérience qui a abouti à 2 scripts. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'essentiel est de vérifier la validité et l'accès aux liens. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parce qu'au fil des années d'accumulation de groupes musicaux, j'ai été confronté au fait que les enregistrements publics sont supprimés ou renommés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qui utilisera ma convenance, je conseille à </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TODO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui supprimera non seulement les liens invalides, mais vérifiera également </font><font style="vertical-align: inherit;">la présence dans VK </font><font style="vertical-align: inherit;">via </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groups.search</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par nom. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checkActualLink</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><b><font style="vertical-align: inherit;">vérifie</font></b><font style="vertical-align: inherit;"> une fois la validité en colorant invalide en rouge.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moins - basse vitesse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, vous pouvez le faire quand vous le souhaitez.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getStatusUrl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - appelé dans la cellule via un script</font></font><br>
<br>
<pre><code class="javascript hljs">=getStatusUrl(CONCAT(<span class="hljs-string">"https://vk.com/"</span>;C2))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a pris la base </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moins - s'exécute pour toutes les cellules à chaque ouverture de la page.</font></font></li>
<li> —     ,      ,   <b>checkActualLink</b>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viennent ensuite la commodité des scripts Google: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addInTableFromArray</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ajouter une ligne à la table. </font><font style="vertical-align: inherit;">Soit à partir du cycle ou d'une seule fois. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getNumSheet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Recherchez le numéro de feuille par nom. </font><font style="vertical-align: inherit;">Honnêtement, je n'ai pas trouvé de moyen plus simple sur Internet que celui-ci. </font><font style="vertical-align: inherit;">Il est nécessaire en raison du décalage des numéros de feuille lors de l'ajout de nouveaux. </font><font style="vertical-align: inherit;">Il a pris la base </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escapeHtml</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Supprimer les caractères spéciaux </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fait </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logger.log</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> court </font><font style="vertical-align: inherit;">pour lui </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">même </font><font style="vertical-align: inherit;">, réduit le temps, je conseille. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onOpen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Une fonctionnalité familière pour dessiner des menus dans Google Sheets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, notre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attrape des liens de VK à Tampermonkey et ajoute des groupes à Google Table.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allumez la paresse</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous sommes assis devant l'ordinateur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous sommes assis au téléphone.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis un ordinateur, nous avons appris à ajouter des groupes via le " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signe plus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " dans VK et via des signets. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Via le téléphone, uniquement via les signets de l'application VK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons deux autres options pour créer des groupes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USI</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Scripts utilisateur dans un navigateur mobile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour certains, cela semblera démodé et inutile, mais il y aura ces gens qui en retireront les avantages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'à présent, la recherche sur Internet n'a trouvé qu'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tel plugin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne fonctionne que dans Firefox (testé uniquement sous Android). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un énorme avantage - vous pouvez utiliser le script Tampermonkey. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En raison des différences de disposition entre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m.vk.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et également en raison de l'ouverture de la fenêtre par défaut dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m.vk.com,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> je </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'ai pas</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dessiné de </font><i><font style="vertical-align: inherit;">signe plus</font></i><font style="vertical-align: inherit;"> , mais </font><font style="vertical-align: inherit;">j'ai </font><font style="vertical-align: inherit;">créé un script simple </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VK_event_to_list_mvk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui fonctionne lorsque la fenêtre s'ouvre (me brûler en enfer pour </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setTimeout</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je sais).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code.gs</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">// ==UserScript==</span>
<span class="hljs-comment">// @name         VK_event_to_list_mvk</span>
<span class="hljs-comment">// @namespace    https://m.vk.com/*</span>
<span class="hljs-comment">// @match        https://m.vk.com/*</span>
<span class="hljs-comment">// @grant    GM_xmlhttpRequest</span>
<span class="hljs-comment">// ==/UserScript==</span>
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> url_first = <span class="hljs-string">'https://script.google.com/macros/s/111/exec'</span>;
    <span class="hljs-keyword">var</span> url_short = <span class="hljs-built_in">document</span>.location.href.replace(<span class="hljs-string">"https://m.vk.com/"</span>, <span class="hljs-string">""</span>);<font></font>
    GM_xmlhttpRequest({<font></font>
        <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
        <span class="hljs-attr">url</span>: url_first + <span class="hljs-string">'?link='</span> + url_short,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/atom+xml,application/xml,text/xml'</span><font></font>
        },<font></font>
        <span class="hljs-attr">onload</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{<font></font>
            alert(x.responseText);<font></font>
        }<font></font>
    });<font></font>
}, <span class="hljs-number">2000</span>);
</code></pre><br>
</div>
                    </div><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/uk/x3/ed/ukx3edytaakulssozlawwix_e-i.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/re/7y/fl/re7yflb336er_3z4jnj4jhop9pi.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/sb/uz/du/sbuzdu-l-ji4uovmwghch-85kfy.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/o8/n5/u8/o8n5u8794binenepowlz8_hh3qi.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/hw/tr/ng/hwtrngrumjglnkqpvu3lzmbw1d4.jpeg"></a></td>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/hi/ca/_q/hica_q7l2gvw5ij0zd437e5rjhu.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/xj/17/fq/xj17fqjnlx58gy57ycngwq_2nyw.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/e5/fq/pg/e5fqpgvxuike9rjhxn_nygob64w.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/vp/cp/uf/vpcpufhriafofuxiavwsrsfw_zu.jpeg"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/4c/ee/19/4cee19rvq8t8buo1wnqlueeritk.jpeg"></a></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram Bot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons un bot selon les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instructions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons besoin d'un jeton, que ce soit 123123. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez un script </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot.gs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , insérez </font><font style="vertical-align: inherit;">notre 123123 </font><font style="vertical-align: inherit;">dans la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">botApi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">encadrez-</font></i><font style="vertical-align: inherit;"> le avec des guillemets et le lien </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.telegram.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons associer notre bot à Google Sheets. </font><font style="vertical-align: inherit;">Vous pouvez voir comment procéder via WebHook dans l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article précédent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que fera notre bot? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On décompose par les commandes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ start - Démarre le bot</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sort - Trier</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ getvkfave - Récupère les signets de VK</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ addinfo - Remplissez vide</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ getall - Récupère tous les groupes</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons que nous avons le début du bot, là nous allons insérer juste un tutoriel avec une partie descriptive à votre discrétion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois commandes du menu principal au cas où. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le prochain bonus est </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ getall</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , à ce sujet ci-dessous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des commandes pour un appel pratique (écrivez une barre oblique dans la ligne d'entrée du message) peuvent être ajoutées au même @BotFather via / setcommands. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Format - lignes à travers un tiret:</font></font><br>
<br>
<pre><code class="xml hljs">start -   <font></font>
sort - <font></font>
getvkfave -    <font></font>
addinfo -  <font></font>
getall -   </code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/h9/rd/vm/h9rdvmirpvb1lqizi05zf9f1668.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot.gs </font></font></b><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doPost</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - accepte les </font><font style="vertical-align: inherit;">messages entrants du bot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, en tant que programmeur curieux, j'ai immédiatement commencé à utiliser les journaux. Il existe peut-être des moyens plus simples, mais je viens de créer une nouvelle feuille, appelée «Journaux» et j'attrape les demandes entrantes dans la première cellule. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, après avoir analysé le message entrant via </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON.parse (e.postData.contents)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous écrivons immédiatement dans les journaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous déterminons laquelle des équipes est venue nous voir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il ne s'agit pas d'une équipe, nous vérifions la validité, c'est-à-dire s'il existe un groupe dans VK. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendText</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - envoie des messages au bot (parse_mode = HTML par défaut), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ getall</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nous l' </font><b><font style="vertical-align: inherit;">analyserons</font></b><font style="vertical-align: inherit;"> séparément. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'ayez pas peur de ma décision de</font></font><br>
<br>
<pre><code class="javascript hljs">[[],[],[],[],[],[],[],[],[],[],[<span class="hljs-string">' '</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conçu pour remplir les lignes avec les villes, alors que nous nous limitons à 8-10 lignes dans 4 villes (variable j = 4). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le groupe de musique est sans ville, insérez ---. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il suffit de </font><font style="vertical-align: inherit;">choisir la ville et attraper les </font><font style="vertical-align: inherit;">lettres russes à </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot.gs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous affichons une liste de liens, rien de plus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/i8/w-/su/i8w-susuojbx8tce-_cs8ov3r5u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas que l'accès à la documentation et au test du bot via la barre d'adresse via le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy VPN gratuit Hotspot Shield est un VPN illimité</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pour Google Chrome). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc appris trois façons d'entrer dans notre table:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts utilisateur dans le navigateur</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts utilisateur dans un navigateur mobile (USI)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram Bot</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce que vous devez savoir et retenir?</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le préfixe de club dans les liens VK Les</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
groupes </font><b><font style="vertical-align: inherit;">VK</font></b><font style="vertical-align: inherit;"> ont 2 types de stockage d'identifiant.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom est en anglais avec des traits de soulignement et des tirets valides.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifiant</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ils peuvent donner le meilleur et ainsi de suite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vérification est simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il y a un groupe, disons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/4soulsband</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , remplacez 4soulsband par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group_ids</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/dev/groups.getById</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une liste de paramètres s'affiche, dont l'un est un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et si on met le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">club</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devant lui </font><font style="vertical-align: inherit;">, le tour est joué, on arrive à la même page </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/club68130764</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limiter le stockage des groupes en VK à 5000</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cela semble ridicule, mais je n'en avais pas assez. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ma peine avec la mise à jour de la page VK,</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
je l'avoue jusqu'à ce que je puisse vaincre la capture de la transition entre les pages en VK pour réinitialiser le signe plus à Tampermonkey. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TODO </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation de Google Sheets comme base de données</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus - disponibilité</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moins - lorsque plus de 5000 lignes sont accumulées, le travail avec la " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ralentit</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Donc, pour les projets sérieux, il est préférable d'utiliser un SGBD normal.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Définition d'une ville de groupe L'</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
adresse de </font><b><font style="vertical-align: inherit;">groupe</font></b><font style="vertical-align: inherit;"> dans VK peut être ici </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vk.com/dev/groups.getAddresses</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , respectivement, qui souhaite améliorer la recherche d'une ville pour un groupe peut l'utiliser.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On a:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau de collecte de données Google avec lequel nous avons appris à travailler.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connaissance de l'API VK. </font><font style="vertical-align: inherit;">Autrement dit, vous savez déjà que nous ne pouvons pas être limités aux groupes musicaux.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram Bot avec une base de données qui n'a pas besoin d'être déployée et configurée.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon objectif n'est pas de me vanter du prochain jouet créé, mon objectif est de montrer aux nouveaux arrivants (et pas seulement) une énorme couche d'API ouvertes qui peuvent aider à rendre la vie à un degré ou à un autre, passer de la terre de fer aux «nuages», pour ainsi dire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fonctionnalité est prête, comme elle est ouverte à des améliorations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne chance dans le développement et la compréhension de nouvelles connaissances.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script Google Apps - Service de feuille de calcul </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Telegram Bot API </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VK </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apprenez à écrire des scripts </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisateur. </font><font style="vertical-align: inherit;">Approfondir la </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surveillance du site à l'aide de Google Docs </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pampering. </font><font style="vertical-align: inherit;">Nous écrivons le bot Telegram sur le script Google </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Exemples, Script Google Apps] Développement de modules complémentaires / scripts pour Google Sheets (feuilles de calcul) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment utiliser les feuilles de calcul Google pour vérifier les liens cassés</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504654/index.html">ZPM - gestionnaire de paquets pour InterSystems IRIS</a></li>
<li><a href="../fr504656/index.html">Attachez vos ceintures de sécurité: comment l'industrie du cloud va changer</a></li>
<li><a href="../fr504658/index.html">Pourquoi Yota est un opérateur gênant et ce qui peut être mieux fait</a></li>
<li><a href="../fr504660/index.html">Princess Frog 2.0 alias Pelophylax ridibundus</a></li>
<li><a href="../fr504662/index.html">Dessiner de la musique: danse du cercueil dans Pure Data</a></li>
<li><a href="../hi486176/index.html">कॉर्पोरेट ईमेल पत्राचार मेमो</a></li>
<li><a href="../hi486178/index.html">FOSS News No. 1 - 27 जनवरी - 2 फरवरी, 2020 के लिए स्वतंत्र और मुक्त स्रोत समाचार की समीक्षा</a></li>
<li><a href="../hi486180/index.html">सर्वर रहित एप्लिकेशन बनाने के लिए सुझाव और स्रोत</a></li>
<li><a href="../hi486184/index.html">प्रभावी ढंग से खोज का उपयोग कैसे करें</a></li>
<li><a href="../hi486186/index.html">प्रलयकारी बादल: यह कैसे काम करता है</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>