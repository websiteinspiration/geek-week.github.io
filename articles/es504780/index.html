<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïç üõÑ üéÖ NSA, Ghidra y Unicornios üßìüèª ‚Ü©Ô∏è üë®üèæ‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta vez, el equipo de PVS-Studio se sinti√≥ atra√≠do por Ghidra, un marco grande y malvado para la ingenier√≠a inversa con el que puede analizar varios ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NSA, Ghidra y Unicornios</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/504780/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/zb/b9/po/zbb9pocjsbhx8woze4xo8picks0.png" alt="NSA, Ghidra y Unicornios"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta vez, el equipo de PVS-Studio se sinti√≥ atra√≠do por Ghidra, un marco grande y malvado para la ingenier√≠a inversa con el que puede analizar varios archivos binarios y hacer todo tipo de cosas aterradoras con ellos. </font><font style="vertical-align: inherit;">Lo m√°s interesante de esto no es que sea de uso gratuito o se extienda bien con complementos, sino que fue escrito en la NSA y publicado en GitHub para todos. </font><font style="vertical-align: inherit;">Por un lado, la NSA parece tener suficientes recursos para mantener limpia la base del c√≥digo. </font><font style="vertical-align: inherit;">Y, por otro lado, los nuevos contribuyentes que no estaban muy familiarizados con √©l podr√≠an haber agregado accidentalmente errores no detectados √∫ltimamente. </font><font style="vertical-align: inherit;">Por lo tanto, armados con un an√°lisis est√°tico, decidimos buscar debilidades en este proyecto.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preludio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En total, el analizador est√°tico PVS-Studio emiti√≥ 651 advertencias altas, 904 medias y 909 bajas en la parte Java del proyecto Ghidra ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n 9.1.2, commit 687ce7f</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Entre ellos, aproximadamente la mitad de las respuestas altas y medias fueron desencadenadas por el diagn√≥stico </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">V6022</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El par√°metro no se usa dentro del cuerpo del m√©todo ", que generalmente aparece despu√©s de la refactorizaci√≥n, cuando alg√∫n par√°metro ya no era necesario o alguna funcionalidad estaba temporalmente desactivada por los comentarios. Un vistazo r√°pido a estas advertencias (hay demasiadas para verlas como un observador externo) ) en este proyecto no revel√≥ nada obviamente sospechoso. Probablemente est√© permitido que este proyecto desactive temporalmente este diagn√≥stico en la configuraci√≥n del analizador para no distraerse con √©l. En la pr√°ctica, a menudo puede ver errores tipogr√°ficos en el nombre del setter o par√°metro del constructor y, en general, no deber√≠a Estoy seguro de que la mayor√≠a de los lectores al menos una vez se encuentran con un patr√≥n desagradable similar:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{
  <span class="hljs-keyword">private</span> String value;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">A</span><span class="hljs-params">(String val)</span> </span>{ <span class="hljs-comment">// V6022</span>
    <span class="hljs-keyword">this</span>.value = value;<font></font>
  }<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> value.hashCode(); <span class="hljs-comment">// NullPointerException</span><font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s de la mitad de las advertencias bajas fueron hechas por el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagn√≥stico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">V6008 Desreferencia</font></a><font style="vertical-align: inherit;"> potencial nula del </font><font style="vertical-align: inherit;">diagn√≥stico </font><font style="vertical-align: inherit;">'variable'", por ejemplo, el valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File.getParentFile () se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usa a menudo </font><font style="vertical-align: inherit;">sin verificar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si el objeto de archivo en el que se llam√≥ a este m√©todo se construy√≥ sin una ruta absoluta, se devolver√° </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la ausencia de verificaci√≥n puede descartar la aplicaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por tradici√≥n, analizaremos solo las advertencias de niveles altos y medios, ya que la mayor parte de los errores reales est√°n contenidos en ellos. Al trabajar con informes del analizador, siempre recomendamos analizar las advertencias en orden descendente de su fiabilidad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, consideramos algunos fragmentos indicados por el analizador que me parecieron sospechosos o interesantes. </font><font style="vertical-align: inherit;">La base del c√≥digo del proyecto result√≥ ser de un tama√±o impresionante, y es casi imposible encontrar dichos lugares manualmente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 1: validaci√≥n rota</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">parseDataTypeTextEntry</span><span class="hljs-params">()</span>
<span class="hljs-keyword">throws</span> InvalidDataTypeException </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">try</span> {<font></font>
    newDataType = parser.parse(selectionField.getText(),<font></font>
                               getDataTypeRootForCurrentText());<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (CancelledException e) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (newDataType != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">if</span> (maxSize &gt;= <span class="hljs-number">0</span>
        &amp;&amp; newDataType.getLength() &gt; newDataType.getLength()) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidDataTypeException(<span class="hljs-string">"data-type larger than "</span>
                                         + maxSize + <span class="hljs-string">" bytes"</span>);<font></font>
    }<font></font>
    selectionField.setSelectedValue(newDataType);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencia de PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hay </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">subexpresiones</font></a><font style="vertical-align: inherit;"> id√©nticas 'newDataType.getLength ()' a la izquierda y a la derecha del operador '&gt;'. DataTypeSelectionEditor.java data66 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta clase proporciona un componente gr√°fico para seleccionar un tipo de datos que admita la finalizaci√≥n autom√°tica. El desarrollador que usa este componente puede establecer el tama√±o m√°ximo permitido del tipo de datos seleccionado (a trav√©s del campo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) o hacerlo ilimitado estableciendo un valor negativo. Se asumi√≥ que al validar los datos ingresados, al exceder el l√≠mite se produce una excepci√≥n, que luego se captura en la pila de llamadas y se le muestra un mensaje al usuario.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que el autor del componente estaba distra√≠do justo en el momento de escribir esta prueba, o tal vez pens√≥ en el significado de la vida, pero al final, la validaci√≥n simplemente no funciona, ya que el n√∫mero nunca puede ser mayor que √©l mismo y, en consecuencia, nos ignoramos de esta condici√≥n. Esto significa que este componente puede proporcionar datos no v√°lidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro error similar se encontr√≥ en dos clases m√°s: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GuidUtil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewGuid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GuidUtil</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GuidInfo <span class="hljs-title">parseLine</span><span class="hljs-params">(...)</span> </span>{<font></font>
    ...<font></font>
    <span class="hljs-keyword">long</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">long</span>[<span class="hljs-number">4</span>];<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (isOK(data)) {
      <span class="hljs-keyword">if</span> (!hasVersion) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GuidInfo(guidString, name, guidType);<font></font>
      }<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VersionedGuidInfo(guidString, version, name, guidType);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
  }<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
      <span class="hljs-keyword">if</span> ((data[i] != <span class="hljs-number">0</span>) || (data[i] != <span class="hljs-number">0xFFFFFFFFL</span>)) { <span class="hljs-comment">// &lt;=</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advertencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">V6007 La</font></a><font style="vertical-align: inherit;"> expresi√≥n 'datos [i]! = 0xFFFFFFFFL' siempre es verdadera. GuidUtil.java:200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El ciclo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><font style="vertical-align: inherit;">m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica que el mismo valor no sea igual a dos n√∫meros diferentes al mismo tiempo. Si es as√≠, el GUID se reconoce inmediatamente como v√°lido. Es decir, el GUID no ser√° v√°lido solo si la matriz de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° </font><font style="vertical-align: inherit;">vac√≠a, y esto nunca sucede, ya que el valor de la variable correspondiente se asigna solo una vez, al comienzo del m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parseLine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Cuerpo del</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en ambas clases coincide por completo, lo que sugiere la idea de otra copia y pega de c√≥digo incorrecto. </font><font style="vertical-align: inherit;">No estoy seguro de qu√© es exactamente lo que el autor quer√≠a verificar, pero puedo suponer que este m√©todo deber√≠a solucionarse de la siguiente manera:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">if</span> ((data[i] == <span class="hljs-number">0</span>) || (data[i] == <span class="hljs-number">0xFFFFFFFFL</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 2: ocultando excepciones</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">putByte</span><span class="hljs-params">(<span class="hljs-keyword">long</span> offsetInMemBlock, <span class="hljs-keyword">byte</span> b)</span>
<span class="hljs-keyword">throws</span> MemoryAccessException, IOException </span>{
  <span class="hljs-keyword">long</span> offsetInSubBlock = offsetInMemBlock - subBlockOffset;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (ioPending) {
      <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"Cyclic Access"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
    ioPending = <span class="hljs-keyword">true</span>;<font></font>
    doPutByte(mappedAddress.addNoWrap(offsetInSubBlock / <span class="hljs-number">8</span>),<font></font>
              (<span class="hljs-keyword">int</span>) (offsetInSubBlock % <span class="hljs-number">8</span>), b);<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (AddressOverflowException e) {
    <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"No memory at address"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span> {<font></font>
    ioPending = <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencia de PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6006</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El objeto se cre√≥ pero no se est√° utilizando. Podr√≠a faltar la palabra clave 'throw': 'new MemoryAccessException ("Cyclic Access")'. BitMappedSubMemoryBlock.java:99 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los objetos de excepci√≥n en s√≠ mismos, como saben, no hacen nada (o al menos no deber√≠an hacer nada). Casi siempre, sus nuevas instancias se lanzan a trav√©s del </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lanzamiento</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en algunos casos raros, se transfieren a alg√∫n lugar o tal vez se colocan en una colecci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La clase que contiene este m√©todo es un contenedor sobre un bloque de memoria que permite leer y escribir datos. Aqu√≠, debido al hecho de que no se lanzan excepciones, se </font><i><font style="vertical-align: inherit;">puede violar</font></i><font style="vertical-align: inherit;"> la restricci√≥n impuesta de acceso al bloque de memoria actual con el indicador </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioPending</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y, adem√°s, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ignora una </font><i><font style="vertical-align: inherit;">AddressOverflowException</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por lo tanto, los datos se pueden corromper silenciosamente y, en lugar de indicar expl√≠citamente un error en un lugar en particular, el desarrollador recibir√° artefactos extra√±os que el depurador debe analizar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hubo ocho de estas excepciones perdidas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BitMappedSubMemoryBlock.java: l√≠neas 77, 99, 106, 122</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ByteMappedSubMemoryBlock.java: l√≠neas 52, 73, 92, 114</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es caracter√≠stico que en los mismos archivos existen m√©todos extremadamente similares en los que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">throw est√°</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> presente. </font><font style="vertical-align: inherit;">Lo m√°s probable es que un m√©todo se haya escrito originalmente de manera similar al fragmento anterior, despu√©s de lo cual se copi√≥ varias veces, de alguna manera encontr√≥ un error y lo corrigi√≥ en aquellos lugares que pod√≠an recordar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 3: campo minado</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processSelection</span><span class="hljs-params">(OptionsTreeNode selectedNode)</span> </span>{
  <span class="hljs-keyword">if</span> (selectedNode == <span class="hljs-keyword">null</span>) {<font></font>
    setViewPanel(defaultPanel, selectedNode); <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setViewPanel</span><span class="hljs-params">(JComponent component, OptionsTreeNode selectedNode)</span> </span>{<font></font>
  ...<font></font>
  setHelpLocation(component, selectedNode);<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHelpLocation</span><span class="hljs-params">(JComponent component, OptionsTreeNode node)</span> </span>{<font></font>
  Options options = node.getOptions();<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advertencia de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">V6008 Desreferencia</font></a><font style="vertical-align: inherit;"> nula de 'selectedNode' en la funci√≥n 'setViewPanel'. OptionsPanel.java:266 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El analizador mentido un poco - por el momento, llamando a la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√©todo </font><i><font style="vertical-align: inherit;">no</font></i><font style="vertical-align: inherit;"> no conduce a una </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ya que este m√©todo se llama s√≥lo dos veces, y antes de que se llama, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectedNode se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comprob√≥ expl√≠citamente </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nula</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esto no debe hacerse, ya que otro desarrollador puede ver que el m√©todo maneja expl√≠citamente el caso </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y decide que este es un valor v√°lido, lo que provocar√° el bloqueo de la aplicaci√≥n. Tales sorpresas son especialmente peligrosas solo en proyectos abiertos, ya que las personas que no conocen la base del c√≥digo participan a fondo en ellos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, debo decir que todo el m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parece bastante extra√±o. </font><font style="vertical-align: inherit;">Es probable que se trate de un error de copiar y pegar, ya que en el mismo m√©todo se encuentra un bloque if con el mismo cuerpo dos veces m√°s, aunque con diferentes condiciones. </font><font style="vertical-align: inherit;">Sin embargo, en este punto, el </font><i><font style="vertical-align: inherit;">Nodo </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seleccionado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ya no ser√° </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la cadena de llamada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setViewPanel-setHelpLocation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no dar√° como resultado una </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 4: autocompletado para el mal</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] UNSUPPORTED_OPCODES_LIST = { ... };
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;Integer&gt; UNSUPPORTED_OPCODES = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();<font></font>
<font></font>
<span class="hljs-keyword">static</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> opcode : UNSUPPORTED_OPCODES) {<font></font>
    UNSUPPORTED_OPCODES.add(opcode);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencia de PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La colecci√≥n se modifica mientras la iteraci√≥n est√° en progreso. ConcurrentModificationException puede ocurrir. DWARFExpressionOpCodes.java:205 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, el analizador volvi√≥ a mentir un poco: la excepci√≥n no se lanzar√°, ya que la colecci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNSUPPORTED_OPCODES</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> siempre </font><i><font style="vertical-align: inherit;">est√°</font></i><font style="vertical-align: inherit;"> vac√≠a y el bucle simplemente no se ejecutar√°. Adem√°s, sucedi√≥ que la colecci√≥n es una multitud, y agregar un elemento ya presente no lo cambiar√°. Lo m√°s probable es que el autor ingres√≥ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada uno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el nombre de la colecci√≥n mediante autocompletado y no se dio cuenta de que se propuso un campo incorrecto. </font><font style="vertical-align: inherit;">La modificaci√≥n de la colecci√≥n durante la iteraci√≥n es imposible, pero en buenas circunstancias, como en este caso, la aplicaci√≥n puede no caer. </font><font style="vertical-align: inherit;">Aqu√≠, este error tiene un efecto indirecto: la m√°quina que analiza los archivos DWARF se basa en esta colecci√≥n para detener el an√°lisis al encontrar c√≥digos de operaci√≥n no compatibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comenzando con Java 9, vale la pena usar los m√©todos de f√°brica de la biblioteca est√°ndar para colecciones constantes: por ejemplo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set.of (T ... elements)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no solo es mucho m√°s conveniente, sino que tambi√©n hace que la colecci√≥n creada sea inmutable, lo que aumenta la confiabilidad del c√≥digo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 5: hay de todo</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValueAt</span><span class="hljs-params">(Object aValue, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> column)</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">int</span> index = indexOf(newName);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {                  <span class="hljs-comment">// &lt;=</span><font></font>
    Window window = tool.getActiveWindow();<font></font>
    Msg.showInfo(getClass(), window, <span class="hljs-string">"Duplicate Name"</span>,
                 <span class="hljs-string">"Name already exists: "</span> + newName);
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
<font></font>
  ExternalPath path = paths.get(row); <span class="hljs-comment">// &lt;=</span><font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(String name)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; paths.size(); i++) {<font></font>
    ExternalPath path = paths.get(i);<font></font>
    <span class="hljs-keyword">if</span> (path.getName().equals(name)) {
      <span class="hljs-keyword">return</span> i;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencias de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expresi√≥n 'index&gt; = 0' siempre es verdadera. </font><font style="vertical-align: inherit;">ExternalNamesTableModel.java:105</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V6019</a> Unreachable code detected. It is possible that an error is present. ExternalNamesTableModel.java:109</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El autor lo pens√≥ y en el m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf en</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lugar de "index" -1 para un valor no detectado devuelve 0: el √≠ndice del primer elemento de la colecci√≥n de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rutas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Incluso si la colecci√≥n est√° vac√≠a. O tal vez se gener√≥ el m√©todo, pero olvid√≥ cambiar el valor de retorno predeterminado. Como resultado, el m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descartar√° cualquier valor que se le pase y mostrar√° al usuario un error "El nombre ya existe", incluso si no hay un nombre existente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no se usa en ning√∫n otro lugar, y su valor solo se necesita para determinar si el elemento que est√° buscando existe. Quiz√°s, en lugar de un m√©todo separado, escriba </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada uno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directamente en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y haga una </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devoluci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en un elemento coincidente en lugar de juegos con √≠ndices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: No pude reproducir el supuesto error. </font><font style="vertical-align: inherit;">El m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt probablemente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ya no se use o se llame solo bajo ciertas condiciones.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 6: guarda silencio</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> Map&lt;Character, String&gt; DELIMITER_NAME_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">20</span>);
<span class="hljs-comment">// Any non-alphanumeric char can be used as a delimiter.</span>
<span class="hljs-keyword">static</span> {<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">' '</span>, <span class="hljs-string">"Space"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'~'</span>, <span class="hljs-string">"Tilde"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'`'</span>, <span class="hljs-string">"Back quote"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"Exclamation point"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"At sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'#'</span>, <span class="hljs-string">"Pound sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'$'</span>, <span class="hljs-string">"Dollar sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'%'</span>, <span class="hljs-string">"Percent sign"</span>);<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencia de PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6033</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ya se ha agregado un elemento con la misma clave '@'. FilterOptions.java:45 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ghidra admite el filtrado de datos en varios contextos: por ejemplo, puede filtrar la lista de archivos de proyecto por nombre. Adem√°s, se implementa el filtrado por varias palabras clave a la vez: '.java, .c' cuando el modo 'OR' est√° activado, muestra todos los archivos cuyo nombre contiene '.java' o '.c'. Se entiende que cualquier car√°cter especial se puede utilizar como separador de palabras (se selecciona un separador espec√≠fico en la configuraci√≥n del filtro), pero en realidad el signo de exclamaci√≥n no estaba disponible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tales hojas de inicializaci√≥n, es muy f√°cil sellar, ya que a menudo se escriben usando copiar y pegar, y cuando mira dicho c√≥digo, sus ojos se vuelven borrosos r√°pidamente. </font><font style="vertical-align: inherit;">Y si el error tipogr√°fico no estaba en dos l√≠neas adyacentes, entonces a mano seguramente casi nadie lo ver√°.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 7: el resto de la divisi√≥n siempre es 0</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactorys</span><span class="hljs-params">(FieldFactory[] fieldFactorys,
                 DataFormatModel dataModel, <span class="hljs-keyword">int</span> margin)</span> </span>{<font></font>
  factorys = <span class="hljs-keyword">new</span> FieldFactory[fieldFactorys.length];<font></font>
<font></font>
  <span class="hljs-keyword">int</span> x = margin;
  <span class="hljs-keyword">int</span> defaultGroupSizeSpace = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; factorys.length; i++) {<font></font>
    factorys[i] = fieldFactorys[i];<font></font>
    factorys[i].setStartX(x);<font></font>
    x += factorys[i].getWidth();<font></font>
    <span class="hljs-comment">// add in space between groups</span>
    <span class="hljs-keyword">if</span> (((i + <span class="hljs-number">1</span>) % defaultGroupSizeSpace) == <span class="hljs-number">0</span>) { <span class="hljs-comment">// &lt;=</span><font></font>
      x += margin * dataModel.getUnitDelimiterSize();<font></font>
    }<font></font>
  }<font></font>
  width = x - margin * dataModel.getUnitDelimiterSize() + margin;<font></font>
  layoutChanged();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencias de PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expresi√≥n '((i + 1)% defaultGroupSizeSpace) == 0' siempre es verdadera. </font><font style="vertical-align: inherit;">ByteViewerLayoutModel.java:66</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6048</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esta expresi√≥n se puede simplificar. </font><font style="vertical-align: inherit;">El operando 'defaultGroupSizeSpace' en la operaci√≥n es igual a 1. ByteViewerLayoutModel.java:66</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El visor de bytes hexadecimales admite la elecci√≥n del tama√±o de los grupos mostrados: por ejemplo, puede configurar la salida en el formato 'ffff ffff' o 'ff ff ff ff'. El m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setFactorys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es responsable de la ubicaci√≥n de estos grupos en la interfaz de usuario </font><font style="vertical-align: inherit;">. A pesar de que la personalizaci√≥n y la visualizaci√≥n funcionan correctamente, el ciclo en este m√©todo parece extremadamente sospechoso: el resto de la divisi√≥n por uno siempre es cero, lo que significa que la coordenada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aumentar√° en cada iteraci√≥n. La sospecha agrega propiedades y disponibilidad </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la configuraci√≥n de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataModel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øBasura restante despu√©s de refactorizar? O tal vez se perdieron los c√°lculos de la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DefaultGroupSizeSpace</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">En cualquier caso, un intento de reemplazar su valor con </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataModel.getGroupSize ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rompi√≥ el dise√±o, y quiz√°s solo el autor de este c√≥digo pueda dar una respuesta inequ√≠voca.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 8: validaci√≥n rota, parte 2</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">parseArrayDimensions</span><span class="hljs-params">(String datatype,
                                    List&lt;Integer&gt; arrayDimensions)</span> </span>{<font></font>
  String dataTypeName = datatype;<font></font>
  <span class="hljs-keyword">boolean</span> zeroLengthArray = <span class="hljs-keyword">false</span>;
  <span class="hljs-keyword">while</span> (dataTypeName.endsWith(<span class="hljs-string">"]"</span>)) {
    <span class="hljs-keyword">if</span> (zeroLengthArray) {                   <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// only last dimension may be 0</span><font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> rBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">']'</span>);
    <span class="hljs-keyword">int</span> lBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">'['</span>);
    <span class="hljs-keyword">if</span> (lBracketPos &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> dimension;
    <span class="hljs-keyword">try</span> {<font></font>
      dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                          rBracketPos));<font></font>
      <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span><font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">catch</span> (NumberFormatException e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    dataTypeName = dataTypeName.substring(<span class="hljs-number">0</span>, lBracketPos).trim();<font></font>
    arrayDimensions.add(dimension);<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> dataTypeName;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Advertencia de PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6007 La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expresi√≥n 'zeroLengthArray' siempre es falsa. PdbDataTypeParser.java:278 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este m√©todo analiza la dimensi√≥n de una matriz multidimensional y devuelve el texto restante despu√©s del an√°lisis o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para datos no v√°lidos. Un comentario al lado de una de las comprobaciones de validaci√≥n indica que solo el √∫ltimo tama√±o de lectura puede ser cero. El an√°lisis va de derecha a izquierda, por lo que se entiende que '[0] [1] [2]' es un texto de entrada v√°lido y '[2] [1] [0]' no lo es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, problema: nadie agreg√≥ la verificaci√≥n de que el siguiente tama√±o es cero, y el analizador come datos no v√°lidos sin preguntas innecesarias. Probablemente deber√≠as arreglar el bloque try de la siguiente manera:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">try</span> {<font></font>
  dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                      rBracketPos));<font></font>
  <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dimension == <span class="hljs-number">0</span>) {<font></font>
    zeroLengthArray = <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
}<font></font>
<span class="hljs-keyword">catch</span> (NumberFormatException e) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, existe la posibilidad de que este criterio de validez en el tiempo resulte innecesario, o el comentario del autor tiene un significado diferente y es necesario verificar la lectura de la primera dimensi√≥n. </font><font style="vertical-align: inherit;">En cualquier caso, la validaci√≥n de datos es una parte cr√≠tica de cualquier aplicaci√≥n, que debe tomarse con total responsabilidad. </font><font style="vertical-align: inherit;">Los errores pueden provocar bloqueos bastante inofensivos de la aplicaci√≥n, as√≠ como agujeros de seguridad, fuga de datos, corrupci√≥n o p√©rdida de datos (por ejemplo, si omite la inyecci√≥n de SQL durante la validaci√≥n de la consulta).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un poco sobre el resto de las advertencias</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El lector puede notar que se emitieron muchas advertencias, pero se consideraron pocas. El cloc no muy bien ajustado en el proyecto cont√≥ aproximadamente 1,25 millones de l√≠neas de c√≥digo Java (no est√° vac√≠o y no hay comentarios). El hecho es que casi todas las advertencias son extremadamente similares: aqu√≠ se olvidaron de buscar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no eliminaron el c√≥digo heredado no utilizado all√≠. Realmente no quiero aburrir al lector enumerando lo mismo, y mencion√© parte de tales casos al comienzo del art√≠culo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro ejemplo son las cincuenta advertencias " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funci√≥n </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">V6009</font></a><font style="vertical-align: inherit;"> recibe un argumento extra√±o" en el contexto del uso incorrecto del m√©todo de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subcadena</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CParserUtils.java:280, ComplexName.java:48 y otros) para obtener el resto de la cadena despu√©s de cualquier separador. </font><font style="vertical-align: inherit;">Los desarrolladores a menudo esperan que este separador est√© presente en la cadena y olvidan que de lo contrario </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devolver√° -1, que es un valor incorrecto para la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subcadena</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Naturalmente, si los datos se validaron o no se recibieron desde el exterior, la probabilidad de que la aplicaci√≥n se bloquee se reduce significativamente. </font><font style="vertical-align: inherit;">Sin embargo, en general, estos son lugares potencialmente peligrosos de los que queremos ayudar a deshacernos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, Ghidra est√° satisfecho con la calidad del c√≥digo: no hay pesadillas especiales evidentes. </font><font style="vertical-align: inherit;">El c√≥digo est√° bien formateado y tiene un estilo muy consistente: en la mayor√≠a de los casos, las variables, los m√©todos y todo lo dem√°s reciben nombres claros, se encuentran comentarios explicativos y hay una gran cantidad de pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, no hubo problemas, entre los cuales:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo muerto, que, muy probablemente, permaneci√≥ despu√©s de numerosas refactorizaciones</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muchos javadocs est√°n irremediablemente desactualizados y, por ejemplo, indican par√°metros inexistentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No hay posibilidad de desarrollo conveniente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuando se usa IntelliJ IDEA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un sistema modular construido alrededor de la reflexi√≥n hace que navegar por un proyecto y encontrar dependencias entre componentes sea mucho m√°s dif√≠cil.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No descuides las herramientas de desarrollador. </font><font style="vertical-align: inherit;">El an√°lisis est√°tico, como los cinturones de seguridad, no es una panacea, pero ayudar√° a prevenir algunos desastres antes del lanzamiento. </font><font style="vertical-align: inherit;">Y a nadie le gusta usar el software conectado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puedes leer sobre otros proyectos probados en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuestro blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y tambi√©n tenemos una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">licencia de prueba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y varias </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opciones para</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usar el analizador sin la necesidad de pagarlo.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea compartir este art√≠culo con una audiencia de habla inglesa, utilice el enlace a la traducci√≥n: Nikita Lazeba. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSA, Ghidra y Unicornios</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es504768/index.html">Pr√°cticas de analista en Yandex: an√°lisis de tareas de prueba</a></li>
<li><a href="../es504770/index.html">Distribuciones de juegos de Linux</a></li>
<li><a href="../es504772/index.html">Eventos digitales en Mosc√∫ del 1 al 7 de junio</a></li>
<li><a href="../es504774/index.html">Encuesta a ejecutivos de TI sobre las necesidades cambiantes de servicios de TI</a></li>
<li><a href="../es504776/index.html">Escribir un motor de juego en tu primer a√±o: ¬°f√°cil! (Casi)</a></li>
<li><a href="../es504784/index.html">El certificado ra√≠z AddTrust de Sectigo expir√≥ el 30 de mayo de 2020, lo que caus√≥ problemas en los clientes OpenSSL 1.0.xy GnuTLS</a></li>
<li><a href="../es504786/index.html">Todo lo que necesitas saber sobre el almacenamiento en cach√©</a></li>
<li><a href="../es504790/index.html">Una selecci√≥n de art√≠culos sobre aprendizaje autom√°tico: casos, gu√≠as y estudios para mayo de 2020</a></li>
<li><a href="../es504792/index.html">Pensi√≥n de servicio. C√≥mo NSPK salv√≥ su sala de servicio de un coronavirus</a></li>
<li><a href="../es504796/index.html">Udalenka es genial. Tal vez quedarse para siempre?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>