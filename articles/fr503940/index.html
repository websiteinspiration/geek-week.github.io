<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑‍🤝‍🧑 🙋🏾 ✨ Messagerie cloud Red Hat OpenShift utilisant Quarkus et AMQ Online 🍑 👨🏼‍🍳 🤚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous! Le voici - notre dernier article de la série Quarkus! (Soit dit en passant, consultez notre webinaire «C'est le framework Java natif d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Messagerie cloud Red Hat OpenShift utilisant Quarkus et AMQ Online</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/503940/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour à tous! Le voici - notre dernier article de la série Quarkus! (Soit dit en passant, consultez notre webinaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«C'est le framework Java natif de Quarkus - Kubernetes»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous montrerons comment recommencer à zéro ou transférer des solutions prêtes à l'emploi) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/ux/ir/pouxirwqx8fafftuhwwcma0jw5q.jpeg" width="100%"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">précédent,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous avons examiné les outils appropriés avec lesquels vous pouvez quantifier les améliorations apportées à la suite de la modernisation de Java. applications.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À partir de la version 0.17.0, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quarkus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prend en charge l'utilisation du protocole Advanced Message Queuing Protocol ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AMQP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), qui est une norme ouverte pour le transfert de messages d'entreprise entre des applications ou des organisations. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat AMQ Online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un service construit sur la base du projet open </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EnMasse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et implémente un mécanisme de messagerie basé sur la plate-forme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat OpenShift</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour en savoir plus sur son fonctionnement, voir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici (vers EN)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aujourd'hui, nous montrons comment combiner AMQ Online et Quarkus pour créer un système de messagerie moderne basé sur OpenShift en utilisant deux nouvelles technologies liées au traitement des messages.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est supposé que vous avez déjà déployé AMQ Online sur la plate-forme OpenShift (sinon, consultez le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide d'installation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, nous allons créer l'application Quarkus, qui sera un simple système de traitement des commandes utilisant la messagerie réactive. </font><font style="vertical-align: inherit;">Cette application comprendra un générateur de commandes qui envoie des commandes à la file d'attente de messages avec un intervalle fixe, ainsi qu'un processeur de commandes qui traitera les messages de la file d'attente et générera des confirmations disponibles pour visualisation dans le navigateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir créé l'application, nous montrerons comment implémenter la configuration du système de messagerie et utiliser AMQ Online pour initialiser les ressources dont nous avons besoin sur ce système.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application Quarkus</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application Quarkus fonctionne sur OpenShift et est une version modifiée de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amqp-quickstart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Un exemple complet du côté client peut être trouvé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Générateur de commandes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le générateur toutes les 5 secondes envoie simplement de manière monotone des identifiants de commande croissants à l'adresse «commandes».</font></font><br>
<br>
<pre><code class="plaintext hljs">@ApplicationScoped<font></font>
public class OrderGenerator {<font></font>
 <font></font>
    private int orderId = 1;<font></font>
 <font></font>
    @Outgoing("orders")<font></font>
    public Flowable&lt;Integer&gt; generate() {<font></font>
        return Flowable.interval(5, TimeUnit.SECONDS)<font></font>
        .map(tick -&gt; orderId++);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestionnaire de commandes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processeur de commande est encore plus simple, il renvoie simplement l'identifiant de confirmation à l'adresse «confirmations».</font></font><br>
<br>
<pre><code class="plaintext hljs">@ApplicationScoped<font></font>
public class OrderProcessor {<font></font>
    @Incoming("orders")<font></font>
    @Outgoing("confirmations")<font></font>
    public Integer process(Integer order) {<font></font>
        //       &lt;img draggable="false" class="emoji" alt=":-)" src="https://s.w.org/images/core/emoji/11.2.0/svg/1f642.svg"&gt;<font></font>
        return order * 2;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ressources de confirmation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une ressource de confirmation est un point de terminaison HTTP pour répertorier les confirmations générées par notre application.</font></font><br>
<br>
<pre><code class="plaintext hljs">@Path("/confirmations")<font></font>
public class ConfirmationResource {<font></font>
 <font></font>
    @Inject<font></font>
    @Stream("confirmations") Publisher&lt;Integer&gt; orders;<font></font>
 <font></font>
    @GET<font></font>
    @Produces(MediaType.TEXT_PLAIN)<font></font>
    public String hello() {<font></font>
        return "hello";<font></font>
    }<font></font>
 <font></font>
 <font></font>
    @GET<font></font>
    @Path("/stream")<font></font>
    @Produces(MediaType.SERVER_SENT_EVENTS)<font></font>
    public Publisher&lt;Integer&gt; stream() {<font></font>
        return orders;<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personnalisation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour se connecter à AMQ Online, notre application aura besoin de certaines données de configuration, à savoir: la configuration du connecteur Quarkus, les informations de point de terminaison AMQP et les informations d'identification du client. </font><font style="vertical-align: inherit;">Il est bien sûr préférable de conserver toutes les données de configuration en un seul endroit, mais nous les séparerons spécialement pour afficher les options possibles pour la configuration de l'application Quarkus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connecteurs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuration du connecteur peut être fournie au stade de la compilation à l'aide du fichier de propriétés d'application:</font></font><br>
<br>
<pre><code class="plaintext hljs">mp.messaging.outgoing.orders.connector=smallrye-amqp<font></font>
mp.messaging.incoming.orders.connector=smallrye-amqp<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas compliquer cela, nous n'utiliserons la file d'attente de messages que pour l'adresse «commandes». </font><font style="vertical-align: inherit;">Et l'adresse «confirmations» dans notre application utilisera la file d'attente en mémoire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpoint AMQP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au stade de la compilation, le nom d'hôte et le numéro de port du point de terminaison AMQP sont inconnus, ils doivent donc être implémentés. </font><font style="vertical-align: inherit;">Le point de terminaison peut être défini dans la configmap, qui est créée par AMQ Online, nous allons donc les définir via les variables d'environnement dans le manifeste de l'application:</font></font><br>
<br>
<pre><code class="plaintext hljs">spec:<font></font>
  template:<font></font>
    spec:<font></font>
      containers:<font></font>
      - env:<font></font>
        - name: AMQP_HOST<font></font>
          valueFrom:<font></font>
            configMapKeyRef:<font></font>
              name: quarkus-config<font></font>
              key: service.host<font></font>
        - name: AMQP_PORT<font></font>
          valueFrom:<font></font>
            configMapKeyRef:<font></font>
              name: quarkus-config<font></font>
              key: service.port.amqp<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifiants</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le jeton de compte de service peut être utilisé pour authentifier notre application dans OpenShift. </font><font style="vertical-align: inherit;">Pour ce faire, vous devez d'abord créer un ConfigSource personnalisé qui lira le jeton d'authentification à partir du système de fichiers pod:</font></font><br>
<br>
<pre><code class="plaintext hljs">public class MessagingCredentialsConfigSource implements ConfigSource {<font></font>
    private static final Set&lt;String&gt; propertyNames;<font></font>
 <font></font>
    static {<font></font>
        propertyNames = new HashSet&lt;&gt;();<font></font>
        propertyNames.add("amqp-username");<font></font>
        propertyNames.add("amqp-password");<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public Set&lt;String&gt; getPropertyNames() {<font></font>
        return propertyNames;<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public Map&lt;String, String&gt; getProperties() {<font></font>
        try {<font></font>
            Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();<font></font>
            properties.put("amqp-username", "@@serviceaccount@@");<font></font>
            properties.put("amqp-password", readTokenFromFile());<font></font>
            return properties;<font></font>
        } catch (IOException e) {<font></font>
            throw new UncheckedIOException(e);<font></font>
        }<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public String getValue(String key) {<font></font>
        if ("amqp-username".equals(key)) {<font></font>
            return "@@serviceaccount@@";<font></font>
        }<font></font>
        if ("amqp-password".equals(key)) {<font></font>
            try {<font></font>
                return readTokenFromFile();<font></font>
            } catch (IOException e) {<font></font>
                throw new UncheckedIOException(e);<font></font>
            }<font></font>
        }<font></font>
        return null;<font></font>
    }<font></font>
 <font></font>
    @Override<font></font>
    public String getName() {<font></font>
        return "messaging-credentials-config";<font></font>
    }<font></font>
 <font></font>
    private static String readTokenFromFile() throws IOException {<font></font>
        return new String(Files.readAllBytes(Paths.get("/var/run/secrets/kubernetes.io/serviceaccount/token")), StandardCharsets.UTF_8);<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblage et déploiement de l'application</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que l'application doit être compilée dans un fichier exécutable, une machine virtuelle GraalVM est requise. </font><font style="vertical-align: inherit;">Pour plus d'informations sur la configuration d'un environnement à cet effet, consultez les instructions associées dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guide Quarkus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, en suivant les instructions, vous devez télécharger la source, créer et déployer notre application:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/EnMasseProject/enmasse-example-clients<font></font>
cd enmasse-example-clients/quarkus-example-client<font></font>
oc new-project myapp<font></font>
mvn -Pnative -Dfabric8.mode=openshift -Dfabric8.build.strategy=docker package fabric8:build fabric8:resource fabric8:apply<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après ces commandes, l'application sera déployée, mais ne démarrera pas tant que nous n'aurons pas configuré les ressources de messagerie nécessaires dans AMQ Online.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration de la messagerie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste maintenant à définir les ressources dont notre application a besoin dans le système de messagerie. </font><font style="vertical-align: inherit;">Pour ce faire, créez: 1) l'espace d'adressage pour initialiser le noeud final du système de messagerie; </font><font style="vertical-align: inherit;">2) l'adresse pour configurer les adresses que nous utilisons dans l'application; </font><font style="vertical-align: inherit;">3) l'utilisateur du système de messagerie pour définir les informations d'identification du client.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espace d'adressage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'objet AddressSpace dans AMQ Online est un groupe d'adresses qui partagent des points de terminaison de connexion, ainsi que des stratégies d'authentification et d'autorisation. </font><font style="vertical-align: inherit;">Lors de la création d'un espace d'adressage, vous pouvez spécifier comment les noeuds finaux du système de messagerie seront fournis:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: enmasse.io/v1beta1<font></font>
kind: AddressSpace<font></font>
metadata:<font></font>
  name: quarkus-example<font></font>
spec:<font></font>
  type: brokered<font></font>
  plan: brokered-single-broker<font></font>
  endpoints:<font></font>
  - name: messaging<font></font>
    service: messaging<font></font>
    exports:<font></font>
    - name: quarkus-config<font></font>
      kind: configmap<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresses</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les adresses sont utilisées pour envoyer et recevoir des messages. </font><font style="vertical-align: inherit;">Chaque adresse a un type qui définit sa sémantique, ainsi qu'un plan qui définit le nombre de ressources réservées. </font><font style="vertical-align: inherit;">L'adresse peut être déterminée, par exemple, comme ceci:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: enmasse.io/v1beta1<font></font>
kind: Address<font></font>
metadata:<font></font>
  name: quarkus-example.orders<font></font>
spec:<font></font>
  address: orders<font></font>
  type: queue<font></font>
  plan: brokered-queue<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisateur de messagerie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour envoyer et recevoir des messages à vos adresses, seules les applications de confiance peuvent le faire, vous devez créer un utilisateur dans le système de messagerie. </font><font style="vertical-align: inherit;">Pour les applications s'exécutant sur un cluster, les clients peuvent être authentifiés à l'aide d'un compte de service OpenShift. </font><font style="vertical-align: inherit;">L'utilisateur "serviceaccount" peut être défini, par exemple, comme suit:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: user.enmasse.io/v1beta1<font></font>
kind: MessagingUser<font></font>
metadata:<font></font>
  name: quarkus-example.app<font></font>
spec:<font></font>
  username: system:serviceaccount:myapp:default<font></font>
  authentication:<font></font>
    type: serviceaccount<font></font>
  authorization:<font></font>
  - operations: ["send", "recv"]<font></font>
    addresses: ["orders"]<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autorisations pour personnaliser l'application</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour qu'AMQ Online crée la carte de configuration que nous avons utilisée pour implémenter les informations de point de terminaison AMQP, vous devez spécifier le rôle et la liaison de rôle (Role et RoleBinding):</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: rbac.authorization.k8s.io/v1<font></font>
kind: Role<font></font>
metadata:<font></font>
  name: quarkus-config<font></font>
spec:<font></font>
  rules:<font></font>
  - apiGroups: [ "" ]<font></font>
    resources: [ "configmaps" ]<font></font>
    verbs: [ "create" ]<font></font>
  - apiGroups: [ "" ]<font></font>
    resources: [ "configmaps" ]<font></font>
    resourceNames: [ "quarkus-config" ]<font></font>
    verbs: [ "get", "update", "patch" ]<font></font>
---<font></font>
apiVersion: rbac.authorization.k8s.io/v1<font></font>
kind: RoleBinding<font></font>
metadata:<font></font>
  name: quarkus-config<font></font>
roleRef:<font></font>
  apiGroup: rbac.authorization.k8s.io<font></font>
  kind: Role<font></font>
  name: quarkus-config<font></font>
subjects:<font></font>
- kind: ServiceAccount<font></font>
  name: address-space-controller<font></font>
  namespace: amq-online-infra<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment appliquer des configurations</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez appliquer la configuration de messagerie comme ceci:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd enmasse-example-clients/quarkus-example-client<font></font>
oc project myapp<font></font>
oc apply -f src/main/resources/k8s/addressspace<font></font>
oc apply -f src/main/resources/k8s/address<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vérification d'application</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous assurer que l'application a démarré, nous allons tout d'abord vérifier si les adresses correspondantes sont créées et actives:</font></font><br>
<br>
<pre><code class="plaintext hljs">until [[ `oc get address quarkus-example.prices -o jsonpath='{.status.phase}'` == "Active" ]]; do echo "Not yet ready"; sleep 5; done
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vérifiez ensuite l'URL de l'itinéraire de l'application (ouvrez simplement cette adresse dans le navigateur):</font></font><br>
<br>
<pre><code class="plaintext hljs">echo "http://$(oc get route quarkus-example-client -o jsonpath='{.spec.host}')/prices.html"
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il doit être visible dans le navigateur que les tickets sont périodiquement mis à jour à mesure que les messages sont envoyés et reçus par AMQ Online.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Résumer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc écrit une application Quarkus qui utilise AMQP pour la messagerie, avons configuré cette application pour qu'elle fonctionne sur la plate-forme Red Hat OpenShift, et avons également implémenté sa configuration basée sur la configuration AMQ Online. </font><font style="vertical-align: inherit;">Nous avons ensuite créé les manifestes nécessaires pour initialiser le système de messagerie de notre application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci conclut la série Quarkus, mais il y a beaucoup de choses nouvelles et intéressantes à venir, restez avec nous!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr503928/index.html">Irrigation en aérosol VS: quel est le meilleur, et y a-t-il une différence?</a></li>
<li><a href="../fr503932/index.html">Je suis fatigué du fait que les vendeurs ordinaires usurpent l'identité de développeurs et déshonorent l'industrie. Ils rendent le monde pire</a></li>
<li><a href="../fr503934/index.html">[Sondage sur les difficultés de traduction] La localisation de GitLab nécessite l'avis de la communauté</a></li>
<li><a href="../fr503936/index.html">À propos de la traduction de bases de données: ce qui se passe, ce qu'ils font et ce qu'ils mangent avec</a></li>
<li><a href="../fr503938/index.html">Yandex donne de l'argent pour la publicité. Ou pas?</a></li>
<li><a href="../fr503942/index.html">Pourquoi les administrateurs système, les développeurs et les testeurs devraient-ils apprendre les pratiques DevOps?</a></li>
<li><a href="../fr503950/index.html">Gestion des services sur le terrain: qu'est-ce que c'est et pourquoi les sociétés de services en ont-elles besoin?</a></li>
<li><a href="../fr503952/index.html">Sueur, sang et toboggans: comment fonctionne un pitch de startup</a></li>
<li><a href="../fr503954/index.html">Votre première étape dans la science des données. Titanesque</a></li>
<li><a href="../fr503956/index.html">Andrei Breslav tourmente les erreurs de conception de Kotlin qui ne peuvent pas être corrigées // Nous sommes condamnés # 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>