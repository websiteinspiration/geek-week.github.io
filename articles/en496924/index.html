<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò® ‚û∞ üì∂ Web Component Routing üé≥ üôÄ ü§±üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes it seems that web components do not reach the framework, especially when compared with the most popular representatives. But much of the mos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Web Component Routing</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496924/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sometimes it seems that web components do not reach the framework, especially when compared with the most popular representatives. </font><font style="vertical-align: inherit;">But much of the most pressing that is not obscured by the implementation of the standards included in the concept of web components is easy enough to fasten using libraries or a small amount of its elegant code. </font><font style="vertical-align: inherit;">One of these features is front-end routing. </font><font style="vertical-align: inherit;">The feature is not always necessary, perhaps even controversial, but in most frameworks it is present and used by many. </font><font style="vertical-align: inherit;">What about web components? </font><font style="vertical-align: inherit;">And we will try to implement routing using the navigo library.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To make console commands work better on Windows, you can install Unix utilities from the git distribution for this system, or, apparently, use the new WSL and terminal features. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, create a project:</font></font><br>
<br>
<pre><code class="bash hljs">mkdir testnavigo
<span class="hljs-built_in">cd</span> testnavigo<font></font>
npm init<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and many times we press enter until it releases </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
then we put the library</font></font><br>
<br>
<pre><code class="bash hljs">npm i navigo --save
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
create index.html </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and connect the library in it and define the main class of the application; here it will encapsulate the logic of routing and control of all child components. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Web components gave us the opportunity to auto-call a hook when an element appears in the tree that our class is assigned to in the tree of browser objects. </font><font style="vertical-align: inherit;">In it, we initialize the routing library with code directly from the example from the library github (in real life, it should be done more beautifully with modular loading).</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/node_modules/navigo/lib/navigo.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">my-app</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">my-app</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">

   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>{

       connectedCallback() {
           <span class="hljs-keyword">let</span> root = <span class="hljs-literal">null</span>;
           <span class="hljs-keyword">let</span> useHash = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Defaults to: false</span>
           <span class="hljs-keyword">let</span> hash = <span class="hljs-string">'#!'</span>; <span class="hljs-comment">// Defaults to: '#'</span>
           <span class="hljs-keyword">this</span>.router = <span class="hljs-keyword">new</span> Navigo(root, useHash, hash);
       }
    }
   customElements.define(<span class="hljs-string">'my-app'</span>, MyApp);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add route processing:</font></font><br>
<br>
<pre><code class="javascript hljs">connectedCallback() {
   <span class="hljs-keyword">let</span> root = <span class="hljs-literal">null</span>;
   <span class="hljs-keyword">let</span> useHash = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Defaults to: false</span>
   <span class="hljs-keyword">let</span> hash = <span class="hljs-string">'#!'</span>; <span class="hljs-comment">// Defaults to: '#'</span>
   <span class="hljs-keyword">this</span>.router = <span class="hljs-keyword">new</span> Navigo(root, useHash, hash);<font></font>
   router<font></font>
       .on(<span class="hljs-string">'page-a'</span>, () =&gt; {
           <span class="hljs-keyword">this</span>.innerHTML = <span class="hljs-string">''</span>;
           <span class="hljs-keyword">this</span>.insertAdjacentHTML(<span class="hljs-string">'beforeend'</span>, <span class="hljs-string">'&lt;page-a&gt;&lt;/page-a&gt;'</span>);<font></font>
       })<font></font>
       .on(<span class="hljs-string">'page-b'</span>, () =&gt; {
           <span class="hljs-keyword">this</span>.innerHTML = <span class="hljs-string">''</span>;
           <span class="hljs-keyword">this</span>.insertAdjacentHTML(<span class="hljs-string">'beforeend'</span>, <span class="hljs-string">'&lt;page-b&gt;&lt;/page-b&gt;'</span>);<font></font>
       })<font></font>
       .on(<span class="hljs-string">'*'</span>, () =&gt; {
           <span class="hljs-keyword">this</span>.innerHTML = <span class="hljs-string">''</span>;
           <span class="hljs-keyword">this</span>.insertAdjacentHTML(<span class="hljs-string">'beforeend'</span>, <span class="hljs-string">'&lt;div&gt;Please click links above&lt;/div&gt;'</span>);<font></font>
       })<font></font>
       .resolve();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each time the route is changed, our component updates the internal content by adding a new tag to it. </font><font style="vertical-align: inherit;">It remains to register these tags for the new page components.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>{<font></font>
   connectedCallback() {<font></font>
       <span class="hljs-keyword">this</span>.insertAdjacentHTML(<span class="hljs-string">'beforeend'</span>, <span class="hljs-string">'&lt;div&gt;This is a page A&lt;/div&gt;'</span>);<font></font>
   }<font></font>
}<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>{<font></font>
   connectedCallback() {<font></font>
       <span class="hljs-keyword">this</span>.insertAdjacentHTML(<span class="hljs-string">'beforeend'</span>, <span class="hljs-string">'&lt;div&gt;This is a page B&lt;/div&gt;'</span>);<font></font>
   }<font></font>
}<font></font>
customElements.define(<span class="hljs-string">'page-a'</span>, PageA);<font></font>
customElements.define(<span class="hljs-string">'page-b'</span>, PageB);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the very top of the page, add links to check the navigation:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"page-a"</span> <span class="hljs-attr">data-navigo</span>&gt;</span>Page A<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"page-b"</span> <span class="hljs-attr">data-navigo</span>&gt;</span>Page B<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
the data-navigo attribute allows clicking on them to be processed by the router, rather than making requests for the backend. </font><font style="vertical-align: inherit;">Which is time to start, for example, like this:</font></font><br>
<br>
<pre><code class="bash hljs">npx http-server
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
open </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">127.0.0.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8080 </font><font style="vertical-align: inherit;">in the browser </font><font style="vertical-align: inherit;">or whatever it writes to you there and make sure that everything works. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t1/1k/rs/t11krslhm3qhr_uoywydrwl0kbo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we can distribute everything as it should in separate files, attach template and dynamic loading of pages, take out routes to the configuration. Web Components will undertake most of the work with the life cycle of application objects, only opening event should not be forgotten razbindivat in Hook </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disconnectedCallback ()</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As I wanted to show how fast it's all done, stretch further article probably will not;) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On something of this I already wrote in articles: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quick start with WebComponents</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
and </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebComponents as frameworks, interaction of components</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wait for a new revelation ^ W articles, share and like!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The resulting source code can be viewed here in the repository on the bitpack: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://bitbucket.org/techminded/testnavigo/</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en496912/index.html">ThinkPad E480 Intel on Windows VS ThinkPad E495 AMD on Ubuntu is there any difference?</a></li>
<li><a href="../en496914/index.html">The shortest decimal program</a></li>
<li><a href="../en496916/index.html">Teaching, Negotiating, and Consulting Remotely - Part 3: Yealink Meeting Server and 4 Special Offers</a></li>
<li><a href="../en496920/index.html">Making a smart home with ASP.NET Core and Arduino</a></li>
<li><a href="../en496922/index.html">Guide on reverse client-server apk on the example of the job NeoQUEST-2020</a></li>
<li><a href="../en496926/index.html">John Romero on Doom: 25 Years of Rip & Tear</a></li>
<li><a href="../en496936/index.html">Let's encrypt SSL certificates with cert-manager in Kubernetes</a></li>
<li><a href="../en496938/index.html">Supercomputers, genome sequencing and the prospects of defeating the coronavirus</a></li>
<li><a href="../en496940/index.html">How GM engineers test electronics</a></li>
<li><a href="../en496942/index.html">Digital events in Moscow April 13-19</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>