<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😱 🤛🏻 🤷🏿 ELFのレシピ 👌🏾 🧘🏽 ▫️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ロシア語では、ELFファイル（Executable and Linkable Format-Linuxおよび多くのUnixシステムの実行可能ファイルの主な形式）の操作方法に関するかなりの情報があります。エルフと一緒に作業するシナリオをすべて網羅しているわけではありませんが、参考書やプログラマーやリバ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ELFのレシピ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inforion/blog/460247/"><p><img src="https://habrastorage.org/webt/xk/e_/v6/xke_v6gzyavn2y7zh5skzlm3op0.jpeg" alt="画像"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロシア語では、ELFファイル（Executable and Linkable Format-Linuxおよび多くのUnixシステムの実行可能ファイルの主な形式）の操作方法に関するかなりの情報があります。</font><font style="vertical-align: inherit;">エルフと一緒に作業するシナリオをすべて網羅しているわけではありませんが、参考書やプログラマーやリバースエンジニア向けのレシピ集の形で情報が役立つことを願っています。</font></font></p><br>
<p>,         ELF (      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Executable and Linkable Format 101</a>).</p><br>
<p>      ,     , ,   <del></del>  ,       .</p><a name="habracut"></a><br>
<blockquote>—   …   …   …   …   !..   …    …<br>
()     </blockquote><br>
<h1 id="instrumenty"></h1><br>
<p>        Linux,    Windows.</p><br>
<p>      :</p><br>
<ul>
<li>   binutils (objcopy, objdump, readelf, strip);</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">radare2</a>;</li>
<li>hex-     (   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">010Editor</a>,   , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Veles</a>); </li>
<li>Python   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">LIEF</a>;</li>
<li>  (   ).</li>
</ul><br>
<h1 id="testovye-elfy"> </h1><br>
<p>  «»   ELF- <em>simple</em>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">nutcake's PieIsMyFav</a>  crackmes.one,     «» .            ,       .</p><br>
<p>«»      :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a>;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   radare2</a>;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> ElfHacks  Github</a> —      ;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Crackme  Unix/Linux</a> —   ,      .</li>
</ul><br>
<h1 id="chtenie-poluchenie-informacii">,  </h1><br>
<h2 id="tip-fayla-zagolovok-sekcii"> , , </h2><br>
<p>      :</p><br>
<ul>
<li>  (DYN — , EXEC — , RELOC — );</li>
<li>  (E_MACHINE — x86_64, x86, ARM  ..);</li>
<li>    (Entry Point);</li>
<li>  .</li>
</ul><br>
<h3 id="010editor">010Editor</h3><br>
<p>HEX- 010Editor   .  ELF-  ,   , <em>ELF.bt</em>     <em>Executable</em> ( Templates — Executable).<br>
  , ,      (entry point) (   ).</p><br>
<p><img src="https://habrastorage.org/webt/uz/f4/i6/uzf4i6yhfy9epat61pd4uolvegw.png" alt="画像"></p><br>
<h3 id="readelf">readelf</h3><br>
<p> <em>readelf</em>    -     ELF-.</p><br>
<ul>
<li>  :<br>
<pre><code class="bash hljs">$ readelf -h simple</code></pre></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="markdown hljs">ELF Header:<font></font>
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00<font></font>
  Class:                             ELF64<font></font>
  Data:                              2's complement, little endian<font></font>
  Version:                           1 (current)<font></font>
  OS/ABI:                            UNIX - System V<font></font>
  ABI Version:                       0<font></font>
  Type:                              DYN (Shared object file)<font></font>
  Machine:                           Advanced Micro Devices X86-64<font></font>
  Version:                           0x1<font></font>
  Entry point address:               0x1070<font></font>
  Start of program headers:          64 (bytes into file)<font></font>
  Start of section headers:          14800 (bytes into file)<font></font>
  Flags:                             0x0<font></font>
  Size of this header:               64 (bytes)<font></font>
  Size of program headers:           56 (bytes)<font></font>
  Number of program headers:         11<font></font>
  Size of section headers:           64 (bytes)<font></font>
  Number of section headers:         30<font></font>
  Section header string table index: 29</code></pre></div></div><br>
<ul>
<li>     :<br>
<pre><code class="bash hljs">$ readelf -l -W simple</code></pre></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p>      32- :</p><br>
<pre><code class="markdown hljs">Elf file type is DYN (Shared object file)<font></font>
Entry point 0x1070<font></font>
There are 11 program headers, starting at offset 64<font></font>
<font></font>
Program Headers:<font></font>
 Type         Offset   VirtAddr   PhysAddr   FileSiz  MemSiz   Flg Align<font></font>
 PHDR         0x000040 0x00000040 0x00000040 0x000268 0x000268 R   0x8<font></font>
 INTERP       0x0002a8 0x000002a8 0x000002a8 0x00001c 0x00001c R   0x1<font></font>
<span class="hljs-code">     [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
 LOAD         0x000000 0x00000000 0x00000000 0x0005f8 0x0005f8 R   0x1000
 LOAD         0x001000 0x00001000 0x00001000 0x00026d 0x00026d R E 0x1000
 LOAD         0x002000 0x00002000 0x00002000 0x0001b8 0x0001b8 R   0x1000
 LOAD         0x002de8 0x00003de8 0x00003de8 0x000258 0x000260 RW  0x1000
 DYNAMIC      0x002df8 0x00003df8 0x00003df8 0x0001e0 0x0001e0 RW  0x8
 NOTE         0x0002c4 0x000002c4 0x000002c4 0x000044 0x000044 R   0x4
 GNU_EH_FRAME 0x002070 0x00002070 0x00002070 0x00003c 0x00003c R   0x4
 GNU_STACK    0x000000 0x00000000 0x00000000 0x000000 0x000000 RW  0x10
 GNU_RELRO    0x002de8 0x00003de8 0x00003de8 0x000218 0x000218 R   0x1
</span><font></font>
 Section to Segment mapping:<font></font>
  Segment Sections...<font></font>
   00     <font></font>
   01     .interp<font></font>
   02     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version<span class="hljs-emphasis">_r .rela.dyn .rela.plt
   03     .init .plt .plt.got .text .fini
   04     .rodata .eh_</span>frame<span class="hljs-emphasis">_hdr .eh_</span>frame<font></font>
   05     .init<span class="hljs-emphasis">_array .fini_</span>array .dynamic .got .got.plt .data .bss<font></font>
   06     .dynamic<font></font>
   07     .note.ABI-tag .note.gnu.build-id<font></font>
   08     .eh<span class="hljs-emphasis">_frame_</span>hdr<font></font>
   09     <font></font>
   10     .init<span class="hljs-emphasis">_array .fini_</span>array .dynamic .got</code></pre></div></div><br>
<ul>
<li>   :<br>
<pre><code class="bash hljs">$ readelf -S -W simple</code></pre></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p>      32- :</p><br>
<pre><code class="markdown hljs">There are 30 section headers, starting at offset 0x39d0:<font></font>
<font></font>
Section Headers:<font></font>
  [Nr] Name              Type            Address  Off    Size   ES Flg Lk Inf Al<font></font>
  [ 0]                   NULL            00000000 000000 000000 00      0   0  0<font></font>
  [ 1] .interp           PROGBITS        000002a8 0002a8 00001c 00   A  0   0  1<font></font>
  [ 2] .note.ABI-tag     NOTE            000002c4 0002c4 000020 00   A  0   0  4<font></font>
  [ 3] .note.gnu.build-id NOTE            000002e4 0002e4 000024 00   A  0   0  4<font></font>
  [ 4] .gnu.hash         GNU<span class="hljs-emphasis">_HASH        00000308 000308 000024 00   A  5   0  8
  [ 5] .dynsym           DYNSYM          00000330 000330 0000d8 18   A  6   1  8
  [ 6] .dynstr           STRTAB          00000408 000408 0000a2 00   A  0   0  1
  [ 7] .gnu.version      VERSYM          000004aa 0004aa 000012 02   A  5   0  2
  [ 8] .gnu.version_</span>r    VERNEED         000004c0 0004c0 000030 00   A  6   1  8<font></font>
  [ 9] .rela.dyn         RELA            000004f0 0004f0 0000c0 18   A  5   0  8<font></font>
  [10] .rela.plt         RELA            000005b0 0005b0 000048 18  AI  5  23  8<font></font>
  [11] .init             PROGBITS        00001000 001000 000017 00  AX  0   0  4<font></font>
  [12] .plt              PROGBITS        00001020 001020 000040 10  AX  0   0 16<font></font>
  [13] .plt.got          PROGBITS        00001060 001060 000008 08  AX  0   0  8<font></font>
  [14] .text             PROGBITS        00001070 001070 0001f2 00  AX  0   0 16<font></font>
  [15] .fini             PROGBITS        00001264 001264 000009 00  AX  0   0  4<font></font>
  [16] .rodata           PROGBITS        00002000 002000 000070 00   A  0   0  8<font></font>
  [17] .eh<span class="hljs-emphasis">_frame_</span>hdr     PROGBITS        00002070 002070 00003c 00   A  0   0  4<font></font>
  [18] .eh<span class="hljs-emphasis">_frame         PROGBITS        000020b0 0020b0 000108 00   A  0   0  8
  [19] .init_</span>array       INIT<span class="hljs-emphasis">_ARRAY      00003de8 002de8 000008 08  WA  0   0  8
  [20] .fini_</span>array       FINI<span class="hljs-emphasis">_ARRAY      00003df0 002df0 000008 08  WA  0   0  8
  [21] .dynamic          DYNAMIC         00003df8 002df8 0001e0 10  WA  6   0  8
  [22] .got              PROGBITS        00003fd8 002fd8 000028 08  WA  0   0  8
  [23] .got.plt          PROGBITS        00004000 003000 000030 08  WA  0   0  8
  [24] .data             PROGBITS        00004030 003030 000010 00  WA  0   0  8
  [25] .bss              NOBITS          00004040 003040 000008 00  WA  0   0  1
  [26] .comment          PROGBITS        00000000 003040 00001c 01  MS  0   0  1
  [27] .symtab           SYMTAB          00000000 003060 000630 18     28  44  8
  [28] .strtab           STRTAB          00000000 003690 000232 00      0   0  1
  [29] .shstrtab         STRTAB          00000000 0038c2 000107 00      0   0  1
Key to Flags:
  W (write), A (alloc), X (execute), M (merge), S (strings), l (large)
  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)
  O (extra OS processing required) o (OS specific), p (processor specific)</span></code></pre></div></div><br>
<ul>
<li>   :<br>
<pre><code class="bash hljs">$ readelf -s -W simple</code></pre></li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p>    :</p><br>
<pre><code class="markdown hljs">Symbol table '.dynsym' contains 9 entries:<font></font>
   Num:  Value        Size   Type    Bind    Vis      Ndx Name<font></font>
<span class="hljs-code">     0: 00000000   0 NOTYPE  LOCAL  DEFAULT  UND
     1: 00000000   0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTable
     2: 00000000   0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)
     3: 00000000   0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2.5 (2)
     4: 00000000   0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)
     5: 00000000   0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     6: 00000000   0 FUNC    GLOBAL DEFAULT  UND __isoc99_scanf@GLIBC_2.7 (3)
     7: 00000000   0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable
     8: 00000000   0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)
</span><font></font>
Symbol table '.symtab' contains 66 entries:<font></font>
   Num:  Value        Size   Type    Bind    Vis      Ndx Name<font></font>
<span class="hljs-code">     0: 00000000   0 NOTYPE  LOCAL  DEFAULT  UND
     1: 000002a8   0 SECTION LOCAL  DEFAULT    1
     2: 000002c4   0 SECTION LOCAL  DEFAULT    2
     3: 000002e4   0 SECTION LOCAL  DEFAULT    3
     4: 00000308   0 SECTION LOCAL  DEFAULT    4
     5: 00000330   0 SECTION LOCAL  DEFAULT    5
     6: 00000408   0 SECTION LOCAL  DEFAULT    6
     7: 000004aa   0 SECTION LOCAL  DEFAULT    7
     ....
    26: 00000000   0 SECTION LOCAL  DEFAULT   26
    27: 00000000   0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    28: 000010a0   0 FUNC    LOCAL  DEFAULT   14 deregister_tm_clones
    29: 000010d0   0 FUNC    LOCAL  DEFAULT   14 register_tm_clones
    30: 00001110   0 FUNC    LOCAL  DEFAULT   14 __do_global_dtors_aux
    31: 00004040   1 OBJECT  LOCAL  DEFAULT   25 completed.7389
     ....</span></code></pre></div></div><br>
<p> <code>-W</code>       ( , 80 ).</p><br>
<h3 id="lief">LIEF</h3><br>
<p>           Python   LIEF ( API    Python):</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary = lief.parse(<span class="hljs-string">"simple.elf"</span>)<font></font>
header = binary.header<font></font>
<font></font>
print(<span class="hljs-string">"Entry point: %08x"</span> % header.entrypoint)<font></font>
print(<span class="hljs-string">"Architecture: "</span>, header.machine_type)<font></font>
<font></font>
<span class="hljs-keyword">for</span> section <span class="hljs-keyword">in</span> binary.sections:<font></font>
    print(<span class="hljs-string">"Section %s - size: %s bytes"</span> % (section.name, section.size)</code></pre><br>
<h2 id="informaciya-o-kompilyatore">  </h2><br>
<p>          <code>.comment</code>  <code>.note</code>.</p><br>
<h3 id="objdump">objdump</h3><br>
<pre><code class="bash hljs">$ objdump -s --section .comment simple</code></pre><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="markdown hljs">simple:     file format elf64-x86-64<font></font>
<font></font>
Contents of section .comment:<font></font>
 0000 4743433a 20284465 6269616e 20382e32  GCC: (Debian 8.2<font></font>
 0010 2e302d39 2920382e 322e3000           .0-9) 8.2.0.</code></pre></div></div><br>
<h3 id="readelf-1">readelf</h3><br>
<pre><code class="bash hljs">$ readelf -p .comment simple</code></pre><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="markdown hljs">String dump of section '.comment':<font></font>
  [     0]  GCC: (Debian 8.2.0-9) 8.2.0</code></pre></div></div><br>
<pre><code class="bash hljs">$ readelf -n simple</code></pre><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="markdown hljs">Displaying notes found at file offset 0x000002c4 with length 0x00000020:<font></font>
  Owner                 Data size    Description<font></font>
  GNU                  0x00000010    NT<span class="hljs-emphasis">_GNU_</span>ABI<span class="hljs-emphasis">_TAG (ABI version tag)
    OS: Linux, ABI: 3.2.0

Displaying notes found at file offset 0x000002e4 with length 0x00000024:
  Owner                 Data size    Description
  GNU                  0x00000014    NT_</span>GNU<span class="hljs-emphasis">_BUILD_</span>ID (unique build ID bitstring)
<span class="hljs-code">    Build ID: dae0509e4edb79719a65af37962b74e4cf2a8c2e</span></code></pre></div></div><br>
<h3 id="lief-1">LIEF</h3><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"simple"</span>)<font></font>
comment = binary.get_section(<span class="hljs-string">".comment"</span>)<font></font>
print(<span class="hljs-string">"Comment: "</span>, bytes(comment.content))
</code></pre><br>
<h2 id="ya-vychislyu-tebya-po-rpath">   … RPATH</h2><br>
<p>        .      <code>LD_LIBRARY_PATH</code>   ,   «»    ELF-.</p><br>
<p>      <code>.dynamic</code>   <code>DT_RPATH</code>  <code>DT_RUNPATH</code> (.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Directories Searched by the Runtime Linker</a>  ).</p><br>
<p><strong>  ,  ,  «»   !</strong></p><br>
<h3 id="kak-poyavlyaetsya-rpath">  RPATH?</h3><br>
<p>   RPATH-   —  <code>-rpath</code>     .  :</p><br>
<pre><code class="bash hljs">$ gcc -L./lib -Wall -Wl,-rpath=/run/media/pablo/disk1/projects/cheat_sheets/ELF/lib/ -o test_rpath.elf bubble_main.c -lbubble</code></pre><br>
<p>     <code>.dynamic</code> RPATH-   <code>/run/media/pablo/disk1/projects/cheat_sheets/ELF/lib/</code>.</p><br>
<h3 id="readelf-2">readelf</h3><br>
<p>    <code>.dynamic</code> (    RPATH)  :</p><br>
<pre><code class="bash hljs">$ readelf -d test_rpath.elf </code></pre><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p>     :</p><br>
<pre><code class="markdown hljs">Dynamic section at offset 0x2dd8 contains 28 entries:<font></font>
  Tag        Type                         Name/Value<font></font>
 0x0000000000000001 (NEEDED)             Shared library: [libbubble.so]<font></font>
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]<font></font>
 0x000000000000000f (RPATH)              Library rpath: [/run/media/pablo/disk1/projects/cheat<span class="hljs-emphasis">_sheets/ELF/lib/]
 0x000000000000000c (INIT)               0x1000
 0x000000000000000d (FINI)               0x11c8
....</span></code></pre></div></div><br>
<h3 id="lief-2">LIEF</h3><br>
<p>   LIEF    RPATH-  :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief
<span class="hljs-keyword">from</span> lief.ELF <span class="hljs-keyword">import</span> DYNAMIC_TAGS<font></font>
<font></font>
elf = lief.parse(<span class="hljs-string">"test_rpath.elf"</span>)<font></font>
<font></font>
<span class="hljs-keyword">if</span> elf.has(DYNAMIC_TAGS.RPATH):<font></font>
    rpath = next(filter(<span class="hljs-keyword">lambda</span> x: x.tag == DYNAMIC_TAGS.RPATH, elf.dynamic_entries))
    <span class="hljs-keyword">for</span> path <span class="hljs-keyword">in</span> rpath.paths:<font></font>
        print(path)<font></font>
<span class="hljs-keyword">else</span>:<font></font>
    print(<span class="hljs-string">"No RPATH in ELF"</span>) </code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   .dynamic</a></p><br>
<h2 id="proverka-elfa-na-bezopasnost">   </h2><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">checksec.sh</a>   Tobias Klein (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">A Bug Hunter's Diary</a>)    2011 .    ELF-     RelRO (Read Only Relocations), NX (Non-Executable Stack), Stack Canaries, PIE (Position Independent Executables)       <em>readelf</em>.</p><br>
<h3 id="lief-3">LIEF</h3><br>
<p>     <del></del> Python  LIEF (        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">separate-code</a>):</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief
<span class="hljs-keyword">from</span> lief.ELF <span class="hljs-keyword">import</span> DYNAMIC_TAGS, SEGMENT_TYPES<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">filecheck</span>(<span class="hljs-params">filename</span>):</span><font></font>
    binary = lief.parse(filename)<font></font>
<font></font>
    <span class="hljs-comment"># check RELRO</span>
    <span class="hljs-keyword">if</span> binary.has(SEGMENT_TYPES.GNU_RELRO):<font></font>
        print(<span class="hljs-string">"+ Full RELRO"</span>) <span class="hljs-keyword">if</span> binary.has(DYNAMIC_TAGS.BIND_NOW) <span class="hljs-keyword">else</span> print(<span class="hljs-string">"~ Partial RELRO"</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        print(<span class="hljs-string">"- No RELRO"</span>)            <font></font>
<font></font>
    <span class="hljs-comment"># check for stack canary support</span>
    print(<span class="hljs-string">"+ Canary found"</span>) <span class="hljs-keyword">if</span> binary.has_symbol(<span class="hljs-string">"__stack_chk_fail"</span>) <span class="hljs-keyword">else</span> print(<span class="hljs-string">"- No canary found"</span>)<font></font>
<font></font>
    <span class="hljs-comment"># check for NX support (check X-flag for GNU_STACK-segment)</span>
    print(<span class="hljs-string">"+ NX enabled"</span>) <span class="hljs-keyword">if</span> binary.has_nx <span class="hljs-keyword">else</span> print(<span class="hljs-string">"- NX disabled"</span>)<font></font>
<font></font>
    <span class="hljs-comment"># check for PIE support</span>
    print(<span class="hljs-string">"+ PIE enabled"</span>) <span class="hljs-keyword">if</span> binary.is_pie <span class="hljs-keyword">else</span> print(<span class="hljs-string">"- No PIE"</span>)<font></font>
<font></font>
    <span class="hljs-comment"># check for rpath / run path</span>
    print(<span class="hljs-string">"+ RPATH"</span>) <span class="hljs-keyword">if</span> binary.has(DYNAMIC_TAGS.RPATH) <span class="hljs-keyword">else</span> print(<span class="hljs-string">"- No RPATH"</span>)<font></font>
    print(<span class="hljs-string">"+ RUNPATH"</span>)<span class="hljs-keyword">if</span> binary.has(DYNAMIC_TAGS.RUNPATH) <span class="hljs-keyword">else</span> print(<span class="hljs-string">"- No RUNPATH"</span>)<font></font>
<font></font>
    <span class="hljs-comment"># check separate-code option</span>
    <span class="hljs-keyword">if</span> set(binary.get_section(<span class="hljs-string">'.text'</span>).segments) == set(binary.get_section(<span class="hljs-string">'.rodata'</span>).segments):<font></font>
        print(<span class="hljs-string">"- Not Separated Code Sections"</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        print(<span class="hljs-string">"+ Separated Code Sections"</span>)<font></font>
<font></font>
filecheck(<span class="hljs-string">'test_rpath.elf'</span>)</code></pre><br>
<h3 id="radare2">Radare2</h3><br>
<p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link">dukebarman</a>     Radare2     <em>checksec</em>:</p><br>
<pre><code class="bash hljs">&gt; r2 -c i~pic,canary,nx,crypto,stripped,static,relocs test_stack_proteck</code></pre><br>
<h2 id="syroy-kod-iz-elfa-binary-from-elf">« »   (binary from ELF)</h2><br>
<p> ,  « »   ELF-  ,    «»   .</p><br>
<h3 id="objcopy">objcopy</h3><br>
<p> <em>objcopy</em>   ,   :</p><br>
<pre><code class="bash hljs">$ objcopy -O binary -S -g simple.elf simple.bin</code></pre><br>
<ul>
<li><code>-S</code> —    ;</li>
<li><code>-g</code> —    .</li>
</ul><br>
<h3 id="lief-4">LIEF</h3><br>
<p> .          :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief
<span class="hljs-keyword">from</span> lief.ELF <span class="hljs-keyword">import</span> SECTION_FLAGS, SECTION_TYPES<font></font>
<font></font>
binary = lief.parse(<span class="hljs-string">"test"</span>)<font></font>
end_addr = <span class="hljs-number">0</span><font></font>
data = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> section <span class="hljs-keyword">in</span> filter(<span class="hljs-keyword">lambda</span> x: x.has(SECTION_FLAGS.ALLOC) <span class="hljs-keyword">and</span><font></font>
                                x.type != SECTION_TYPES.NOBITS,<font></font>
                      binary.sections):<font></font>
    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; end_addr &lt; section.virtual_address:<font></font>
        align_bytes = <span class="hljs-string">b'\x00'</span> * (section.virtual_address - end_addr)<font></font>
        data.append(align_bytes)        <font></font>
<font></font>
    data.append(bytes(section.content))<font></font>
    end_addr = section.virtual_address + section.size<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">'test.lief.bin'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> d_bytes <span class="hljs-keyword">in</span> data:<font></font>
        f.write(d_bytes)</code></pre><br>
<h2 id="mangled---demangled-imena-funkciy">Mangled — demangled  </h2><br>
<p> ELF-,   ++ ,    ()      .         .</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></p><br>
<h3 id="nm">nm</h3><br>
<p>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">nm</a>   binutils: </p><br>
<pre><code class="bash hljs"><span class="hljs-comment">#       </span><font></font>
$ nm -D demangle-test-cpp<font></font>
     ...<font></font>
      U _Unwind_Resume<font></font>
      U _ZdlPv<font></font>
      U _Znwm<font></font>
      U _ZSt17__throw_bad_allocv<font></font>
      U _ZSt20__throw_length_errorPKc<font></font>
<font></font>
<span class="hljs-comment">#       </span><font></font>
$ nm -D --demangle demangle-test-cpp<font></font>
      ...<font></font>
      U _Unwind_Resume<font></font>
      U operator delete(void*)<font></font>
      U operator new(unsigned long)<font></font>
      U std::__throw_bad_alloc()<font></font>
      U std::__throw_length_error(char const*)</code></pre><br>
<h3 id="lief-5">LIEF</h3><br>
<p>         LIEF:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"demangle-test-cpp"</span>)
<span class="hljs-keyword">for</span> symb <span class="hljs-keyword">in</span> binary.symbols:<font></font>
    print(symb.name, symb.demangled_name)</code></pre><br>
<h1 id="sborka-zapis-modifikaciya-elfa">, ,  </h1><br>
<h2 id="elf-bez-metainformacii">  </h2><br>
<p>         ,    :</p><br>
<ul>
<li>  —    ;</li>
<li>    —          (  );</li>
<li>  —       (    ).</li>
</ul><br>
<h2 id="udalenie-simvolnoy-informacii">  </h2><br>
<p>  —     .      .</p><br>
<h3 id="strip">strip</h3><br>
<p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">strip</a>   binutils.        :</p><br>
<ul>
<li>  :<br>
<pre><code class="bash hljs">$ strip -s simple</code></pre></li>
<li>  :<br>
<pre><code class="bash hljs">$ strip --strip-unneeded libsimple.so</code></pre></li>
</ul><br>
<h3 id="sstrip">sstrip</h3><br>
<p>     (        )    sstrip   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ELFkickers</a>.        :</p><br>
<pre><code class="bash hljs">$ sstrip -z simple</code></pre><br>
<h3 id="lief-6">LIEF</h3><br>
<p>C   LIEF     strip (   —  <code>.symtab</code>):</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"simple"</span>)<font></font>
binary.strip()<font></font>
binary.write(<span class="hljs-string">"simple.stripped"</span>)</code></pre><br>
<h2 id="udalenie-tablicy-sekciy">  </h2><br>
<p>  , /        .           .<br>
  LIEF  Python  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a>:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"simple"</span>)<font></font>
binary.header.numberof_sections = <span class="hljs-number">0</span>
binary.header.section_header_offset = <span class="hljs-number">0</span>
binary.write(<span class="hljs-string">"simple.modified"</span>)</code></pre><br>
<h2 id="izmenenie-i-udalenie-rpath">   RPATH</h2><br>
<h3 id="chrpath-patchelf">chrpath, PatchELF</h3><br>
<p>  RPATH  Linux    <em>chrpath</em> (   )  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">PatchELF</a>.</p><br>
<ul>
<li><p> RPATH:</p><br>
<pre><code class="bash hljs">$ chrpath -r /opt/my-libs/lib:/foo/lib test_rpath.elf</code></pre><br>
<p></p><br>
<pre><code class="bash hljs">$ patchelf --<span class="hljs-built_in">set</span>-rpath /opt/my-libs/lib:/foo/lib test_rpath.elf</code></pre><br>
</li>
<li><p> RPATH:</p><br>
<pre><code class="bash hljs">$ chrpath -d test_rpath.elf</code></pre><br>
<p> </p><br>
<pre><code class="bash hljs">$ patchelf --shrink-rpath test_rpath.elf</code></pre><br>
</li>
</ul><br>
<h3 id="lief-7">LIEF</h3><br>
<p> LIEF    ,    RPATH-.</p><br>
<ul>
<li><p> RPATH:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary  = lief.parse(<span class="hljs-string">"test_rpath.elf"</span>)<font></font>
rpath = next(filter(<span class="hljs-keyword">lambda</span> x: x.tag == lief.ELF.DYNAMIC_TAGS.RPATH, binary.dynamic_entries))<font></font>
rpath.paths = [<span class="hljs-string">"/opt/my-lib/here"</span>]<font></font>
binary.write(<span class="hljs-string">"test_rpath.patched"</span>)</code></pre><br>
</li>
<li><p> RPATH:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary  = lief.parse(<span class="hljs-string">"test_rpath.elf"</span>)<font></font>
binary.remove(lief.ELF.DYNAMIC_TAGS.RPATH)<font></font>
binary.write(<span class="hljs-string">"test_rpath.patched"</span>)</code></pre><br>
</li>
</ul><br>
<h2 id="obfuskaciya-simvolnoy-informacii">  </h2><br>
<p>       ,    .      <em>crackme01_32bit</em>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">crackme01 by seveb</a>.</p><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   LIEF   :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary = lief.parse(<span class="hljs-string">"crackme01_32bit"</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i, symb <span class="hljs-keyword">in</span> enumerate(binary.static_symbols):<font></font>
    symb.name = <span class="hljs-string">"zzz_%d"</span> % i<font></font>
<font></font>
binary.write(<span class="hljs-string">"crackme01_32bit.obfuscated"</span>)</code></pre><br>
<p>  :</p><br>
<pre><code class="bash hljs">$ readelf -s crackme01_32bit.obfuscated<font></font>
...<font></font>
Symbol table <span class="hljs-string">'.symtab'</span> contains 78 entries:<font></font>
   Num:    Value  Size Type    Bind   Vis      Ndx Name<font></font>
     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND zzz_0<font></font>
     1: 08048154     0 SECTION LOCAL  DEFAULT    1 zzz_1<font></font>
     2: 08048168     0 SECTION LOCAL  DEFAULT    2 zzz_2<font></font>
     3: 08048188     0 SECTION LOCAL  DEFAULT    3 zzz_3<font></font>
     4: 080481ac     0 SECTION LOCAL  DEFAULT    4 zzz_4<font></font>
     5: 080481d0     0 SECTION LOCAL  DEFAULT    5 zzz_5<font></font>
     6: 080482b0     0 SECTION LOCAL  DEFAULT    6 zzz_6<font></font>
     7: 0804835a     0 SECTION LOCAL  DEFAULT    7 zzz_7<font></font>
     8: 08048378     0 SECTION LOCAL  DEFAULT    8 zzz_8<font></font>
     9: 080483b8     0 SECTION LOCAL  DEFAULT    9 zzz_9<font></font>
    10: 080483c8     0 SECTION LOCAL  DEFAULT     10 zzz_10<font></font>
...</code></pre><br>
<h2 id="podmena-funkciy-cherez-pltgot">   PLT/GOT</h2><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ELF PLT INFECTION</a>.</p><br>
<p>  ,     :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    ELF-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Infecting the plt/got with LIEF</a></li>
</ul><br>
<h2 id="izmenit-tochku-vhoda">  </h2><br>
<p>     ,      ,      .      crackme01_32bit  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">crackme01 by seveb</a></p><br>
<h3 id="radare2-1">radare2</h3><br>
<p>radare2     ( <code>-w</code>) —      :</p><br>
<pre><code class="bash hljs">$ ./crackme01_32bit<font></font>
Please enter the secret number: ^C<font></font>
<font></font>
$ r2 -w -nn crackme01_32bit<font></font>
[0x00000000]&gt; .pf.elf_header.entry=0x0804860D<font></font>
[0x00000000]&gt; q<font></font>
<font></font>
$ ./crackme01_32bit<font></font>
Nope.</code></pre><br>
<h3 id="lief-8">LIEF</h3><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary = lief.parse(<span class="hljs-string">"crackme01_32bit"</span>)<font></font>
header = binary.header<font></font>
header.entrypoint = <span class="hljs-number">0x0804860D</span>
binary.write(<span class="hljs-string">"crackme01_32bit.patched"</span>)</code></pre><br>
<h2 id="patching-koda"> </h2><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">novn91's crackmepal</a>.      : </p><br>
<pre><code class="bash hljs">$ ./crackmeMario<font></font>
usage &lt;password&gt;</code></pre><br>
<p>   -  :</p><br>
<pre><code class="bash hljs">./crackmeMario qwerty<font></font>
try again pal.</code></pre><br>
<p> ,        «good job! now keygen me!»</p><br>
<h3 id="radare2-2">radare2</h3><br>
<p>radare2    ,   .         :</p><br>
<pre><code class="plaintext hljs"># Rapatch for https://crackmes.one/crackme/5ccecc7e33c5d4419da559b3<font></font>
!echo Patching crackme<font></font>
0x115D : jmp 0x1226</code></pre><br>
<p>    :</p><br>
<pre><code class="bash hljs">$ r2 -P patch.txt crackmeMario</code></pre><br>
<p>     radare2:</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Binary Patching Using Radare2 by wolfshirtz</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Radare2 Explorations. Tutorial 1 — Simple Patch</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Ground Zero: Part 3-2 – Reverse Engineering – Patching Binaries with Radare2 – ARM64</a></li>
</ul><br>
<h3 id="lief-9">LIEF</h3><br>
<p>LIEF    ( )    .            :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"crackmeMario"</span>)<font></font>
binary.patch_address(<span class="hljs-number">0x115D</span>, bytearray(<span class="hljs-string">b"\xe9\xc4\x00\x00\x00"</span>))<font></font>
binary.write(<span class="hljs-string">"crackmeMario.patched"</span>)</code></pre><br>
<p>     :</p><br>
<pre><code class="bash hljs">$ ./crackmeMario.patched<font></font>
good job! now keygen me!</code></pre><br>
<h2 id="dobavit-sekciyu-v-elf">   ELF</h2><br>
<h3 id="objcopy-1">objcopy</h3><br>
<p><em>objcopy</em>   ,                   :</p><br>
<pre><code class="bash hljs">$ objcopy --add-section .testme=data.zip \<font></font>
   --<span class="hljs-built_in">set</span>-section-flags .testme=alloc,contents,load,<span class="hljs-built_in">readonly</span> \<font></font>
   --change-section-address .testme=0x08777777 \ <font></font>
   simple simple.patched.elf</code></pre><br>
<h3 id="lief-10">LIEF</h3><br>
<p> LIEF         ( <strong><code>loaded=True</code></strong>)   ELF:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary  = lief.parse(<span class="hljs-string">"simple"</span>)<font></font>
data = bytearray(<span class="hljs-string">b"\xFF"</span> * <span class="hljs-number">16</span>)<font></font>
<font></font>
section = lief.ELF.Section(<span class="hljs-string">".testme"</span>, lief.ELF.SECTION_TYPES.PROGBITS)<font></font>
section += lief.ELF.SECTION_FLAGS.EXECINSTR<font></font>
section += lief.ELF.SECTION_FLAGS.ALLOC<font></font>
section.content = data  <font></font>
<font></font>
binary.add(section, loaded=<span class="hljs-literal">True</span>)<font></font>
binary.write(<span class="hljs-string">"simple.testme.lief"</span>)</code></pre><br>
<h2 id="izmenit-sekciyu"> </h2><br>
<h3 id="objcopy-2">objcopy</h3><br>
<p><em>objcopy</em>       ,        :</p><br>
<pre><code class="bash hljs">$ objcopy --update-section .testme=patch.bin \<font></font>
    --change-section-address .testme=0x08999999<font></font>
    simple simple.testme.elf</code></pre><br>
<h3 id="lief-11">LIEF</h3><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary  = lief.parse(<span class="hljs-string">"simple"</span>)<font></font>
data = bytearray(<span class="hljs-string">b"\xFF"</span> * <span class="hljs-number">17</span>)<font></font>
<font></font>
section = binary.get_section(<span class="hljs-string">".text"</span>)<font></font>
section.content = data  <font></font>
<font></font>
binary.write(<span class="hljs-string">"simple.patched"</span>)</code></pre><br>
<h2 id="udalit-sekciyu"> </h2><br>
<h3 id="objcopy-3">objcopy</h3><br>
<p><em>objcopy</em>      :</p><br>
<pre><code class="bash hljs">$ objcopy --remove-section .testme simple.testme.elf simple.no_testme.elf</code></pre><br>
<h3 id="lief-12">LIEF</h3><br>
<p>     LIEF  :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
binary = lief.parse(<span class="hljs-string">"simple.testme.elf"</span>)<font></font>
binary.remove_section(<span class="hljs-string">".testme"</span>)<font></font>
binary.write(<span class="hljs-string">"simple.no_testme"</span>)</code></pre><br>
<h2 id="elf-konteyner">-</h2><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ELF :  ,  ELF- —  ?</a>.   man’   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">elfwrap</a>   Solaris,    ELF-   ,   ELF    .</p><br>
<p>      Python  LIEF.<br>
 ,     LIEF    - c ,     —   ELF-:</p><br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> | gcc -m32 -fpic -o empty.o -c -xc -<font></font>
$ gcc -m32 -shared -o libempty.so empty.o</code></pre><br>
<p>       :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary = lief.parse(<span class="hljs-string">"libempty.so"</span>)<font></font>
filename = <span class="hljs-string">"crackme.zip"</span>
data = open(filename, <span class="hljs-string">'rb'</span>).read()<font></font>
<font></font>
<span class="hljs-comment"># Add section with zip-archive as content</span><font></font>
section = lief.ELF.Section()<font></font>
section.content = data<font></font>
section.name = <span class="hljs-string">".%s"</span>%filename<font></font>
binary.add(section, loaded=<span class="hljs-literal">True</span>)   <font></font>
<font></font>
<span class="hljs-comment"># Add symbol as a reference to zip-archive</span><font></font>
symb = lief.ELF.Symbol()<font></font>
symb.type = lief.ELF.SYMBOL_TYPES.OBJECT<font></font>
symb.binding = lief.ELF.SYMBOL_BINDINGS.GLOBAL<font></font>
symb.size = len(data)<font></font>
symb.name = filename<font></font>
symb.value = section.virtual_address<font></font>
binary.add_static_symbol(symb)<font></font>
<font></font>
binary.write(<span class="hljs-string">"libdata.crackme.container"</span>)</code></pre><br>
<h2 id="elf-s-pricepom"> « »</h2><br>
<p>ELF-     ,    ,       .  ,    ,    ELF-   <em>-</em>.  <em>-</em>       ,      ,      <em>-</em>    . </p><br>
<ul>
<li><em>IDA Pro       </em></li>
</ul><br>
<p><em>   « »</em><br>
<img src="https://habrastorage.org/webt/rr/br/sk/rrbrsktjs_p8l7fmdfq7t4mejns.jpeg" alt="画像"></p><br>
<h3 id="radare2-3">radare2</h3><br>
<p> «»  ,       :</p><br>
<pre><code class="bash hljs">$ radare2 test.elf<font></font>
[0x00001040]&gt; ?v <span class="hljs-variable">$s</span><font></font>
0x40c1<font></font>
[0x00001040]&gt; iZ<font></font>
14699</code></pre><br>
<h3 id="readelf-3">readelf</h3><br>
<p><em>readelf</em>      «»,    : </p><br>
<pre><code class="bash hljs">$ ls -l test.elf<font></font>
<font></font>
<span class="hljs-comment">#   16577 </span><font></font>
<font></font>
$ readelf -h test.elf<font></font>
Start of section headers    e_shoff     14704<font></font>
Size of section headers     e_shentsize 64<font></font>
Number of section headers   e_shnum     29<font></font>
<font></font>
<span class="hljs-comment">#  ELF-: e_shoff + ( e_shentsize * e_shnum ) = 16560</span></code></pre><br>
<h3 id="lief-13">LIEF</h3><br>
<p> LIEF     «»,    .   LIEF    :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> lief<font></font>
<font></font>
binary  = lief.parse(<span class="hljs-string">"test"</span>)<font></font>
<font></font>
<span class="hljs-comment"># check if overlay exists</span>
print(<span class="hljs-string">'ELF has overlay data'</span>) <span class="hljs-keyword">if</span> binary.has_overlay <span class="hljs-keyword">else</span> print(<span class="hljs-string">"No overlay data"</span>)<font></font>
<font></font>
<span class="hljs-comment"># add overlay data to ELF</span>
data = bytearray(<span class="hljs-string">b'\xFF'</span>*<span class="hljs-number">17</span>)<font></font>
binary.overlay = data<font></font>
<font></font>
binary.write(<span class="hljs-string">'test.overlay'</span>)</code></pre><br>
<h2 id="elf-iz-pustoty-elf-from-scratch">   (ELF from scratch)</h2><br>
<p>        ELF- «» —         «ELF from scratch»:</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  Github</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Elf from scratch</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">elf_from_scratch</a>    LIEF</li>
</ul><br>
<p>           ELF.</p><br>
<h2 id="samyy-malenkiy-elf">  </h2><br>
<p>        :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">A Whirlwind Tutorial on Creating Really Teensy ELF Executables for Linux</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">A Whirlwind Tutorial on Creating Somewhat Teensy ELF Executables for Linux</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    ELF</a></li>
</ul><br>
<p> ,             ,             ELF’ (    ):</p><br>
<pre><code class="plaintext hljs">; tiny.asm<font></font>
<font></font>
  BITS 32<font></font>
<font></font>
     org     0x00010000<font></font>
     db      0x7F, "ELF"             ; e_ident<font></font>
     dd      1                                       ; p_type<font></font>
     dd      0                                       ; p_offset<font></font>
     dd      $$                                      ; p_vaddr <font></font>
     dw      2                       ; e_type        ; p_paddr<font></font>
     dw      3                       ; e_machine<font></font>
     dd      _start                  ; e_version     ; p_filesz<font></font>
     dd      _start                  ; e_entry       ; p_memsz<font></font>
     dd      4                       ; e_phoff       ; p_flags<font></font>
  _start:<font></font>
     mov     bl, 42                  ; e_shoff       ; p_align<font></font>
     xor     eax, eax<font></font>
     inc     eax                     ; e_flags<font></font>
     int     0x80<font></font>
     db      0<font></font>
     dw      0x34                    ; e_ehsize<font></font>
     dw      0x20                    ; e_phentsize<font></font>
     db      1                       ; e_phnum<font></font>
                                     ; e_shentsize<font></font>
                                     ; e_shnum<font></font>
                                     ; e_shstrndx<font></font>
  filesize      equ     $ - $$</code></pre><br>
<p>   ELF … <strong>45 </strong>:</p><br>
<pre><code class="bash hljs">  $ nasm -f bin -o a.out tiny.asm<font></font>
  $ chmod +x a.out<font></font>
  $ ./a.out ; <span class="hljs-built_in">echo</span> $?<font></font>
  42<font></font>
  $ wc -c a.out<font></font>
       45 a.out</code></pre><br>
<h2 id="elf-po-shablonu">  </h2><br>
<p>      LIEF     (.  «-»):</p><br>
<ul>
<li>  ELF-   ;</li>
<li>  ,   ;</li>
<li>   ( , ).</li>
</ul><br>
<h1 id="vmesto-zaklyucheniya"> </h1><br>
<p> , ,   -    LIEF.      —      ELF-    .</p><br>
<p>    ,      —     .</p><br>
<h1 id="ssylki-i-literatura">  </h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ELF</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     Oracle</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ELF’   radare2</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  LIEF</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   LIEF</a></li>
<li> «PRACTICAL BINARY ANALYSIS», Dennis Andriesse</li>
<li> «Learning Linux Binary Analysis», Ryan "elfmaster" O'Neill</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460227/index.html">カスタムリファクタリングツール：Swift</a></li>
<li><a href="../ja460231/index.html">OpenGear-帯域外管理を備えたコンソールサーバーを使用してビジネスのダウンタイムを削減</a></li>
<li><a href="../ja460233/index.html">ゲームCities：Skylinesはチューリング完全であることがわかりました。4ビットの加算器を作成します</a></li>
<li><a href="../ja460237/index.html">EBay詐欺師（1つの不正行為の話）</a></li>
<li><a href="../ja460239/index.html">NextGen Firewallを自分で完全に無料で自宅に戻す方法</a></li>
<li><a href="../ja460249/index.html">pwnable.kr 07を使用したタスクのソリューション-入力。pwntoolsを理解する</a></li>
<li><a href="../ja460251/index.html">人工的な愚かさ：私を助けなかったボット</a></li>
<li><a href="../ja460253/index.html">音声アシスタントのスキルを高める10の理由</a></li>
<li><a href="../ja460255/index.html">Node.jsのバックドア：理由、理由、方法</a></li>
<li><a href="../ja460257/index.html">"こんにちは世界" ターミナルに深く浸る</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>