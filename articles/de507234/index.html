<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ üë∏üèø üó®Ô∏è Schnauben oder Suricata. Teil 2: Installation und Ersteinrichtung von Suricata ‚¨áÔ∏è üõ°Ô∏è üßëüèº‚Äçü§ù‚Äçüßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Laut Statistik steigt das Netzwerkverkehrsvolumen jedes Jahr um etwa 50%. Dies f√ºhrt zu einer Erh√∂hung der Belastung des Ger√§ts und insbesondere zu ei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Schnauben oder Suricata. Teil 2: Installation und Ersteinrichtung von Suricata</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/507234/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laut Statistik steigt das Netzwerkverkehrsvolumen jedes Jahr um etwa 50%. </font><font style="vertical-align: inherit;">Dies f√ºhrt zu einer Erh√∂hung der Belastung des Ger√§ts und insbesondere zu einer Erh√∂hung der Leistungsanforderungen von IDS / IPS. </font><font style="vertical-align: inherit;">Sie k√∂nnen teure Spezialhardware kaufen, aber es gibt eine billigere Option - die Einf√ºhrung eines der Open-Source-Systeme. </font><font style="vertical-align: inherit;">Vielen unerfahrenen Administratoren f√§llt es schwer, kostenloses IPS zu installieren und zu konfigurieren. </font><font style="vertical-align: inherit;">Im Fall von Suricata ist dies nicht ganz richtig - Sie k√∂nnen es installieren und in wenigen Minuten typische Angriffe mit einer Reihe kostenloser Regeln abwehren.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/nn/5i/pc/nn5ipc7z3qk2abxsmfthdja8vww.jpeg"></div></a><a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnauben oder Suricata. </font><font style="vertical-align: inherit;">Teil 1: W√§hlen Sie ein kostenloses IDS / IPS, um das Unternehmensnetzwerk zu sch√ºtzen</font></font></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum brauche ich ein anderes offenes IPS?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Snort-System, das als Standard gilt, wurde lange Zeit seit Ende der neunziger Jahre entwickelt und war urspr√ºnglich ein Single-Threaded-System. Im Laufe der Jahre sind alle modernen Chips darin aufgetaucht, wie beispielsweise die IPv6-Unterst√ºtzung, die M√∂glichkeit, Protokolle auf Anwendungsebene zu analysieren, oder ein universelles Datenzugriffsmodul. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Basis-Engine Snort 2.X hat gelernt, mit mehreren Kernen zu arbeiten, ist jedoch Single-Threaded geblieben und kann daher die Vorteile moderner Hardware-Plattformen nicht optimal nutzen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem wurde in der dritten Version des Systems gel√∂st, aber es wurde so lange vorbereitet, dass Suricata, von Grund auf neu geschrieben, auf den Markt kam. </font><font style="vertical-align: inherit;">Im Jahr 2009 begannen sie, es genau als Multithread-Alternative zu Snort zu entwickeln, das sofort IPS-Funktionen bietet. </font><font style="vertical-align: inherit;">Der Code wird unter der GPLv2-Lizenz verteilt, aber die Finanzpartner des Projekts haben Zugriff auf eine geschlossene Version der Engine. </font><font style="vertical-align: inherit;">Einige Probleme mit der Skalierbarkeit traten in den ersten Versionen des Systems auf, wurden jedoch schnell behoben.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum Suricata?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suricata verf√ºgt √ºber mehrere Module (wie Snort): Erfassen, Erfassen, Dekodieren, Erkennen und Ausgeben. Standardm√§√üig wird der erfasste Datenverkehr vor dem Decodieren durch einen Stream √ºbertragen, obwohl das System dadurch mehr belastet wird. Bei Bedarf k√∂nnen Threads in den Einstellungen aufgeteilt und auf Prozessoren verteilt werden. Suricata ist sehr gut f√ºr eine bestimmte Hardware optimiert, obwohl dies f√ºr Anf√§nger kein HOWTO-Level mehr ist. Es ist auch erw√§hnenswert, dass Suricata √ºber ein erweitertes HTTP-Inspektionstool verf√ºgt, das auf der HTP-Bibliothek basiert. Sie k√∂nnen auch verwendet werden, um Datenverkehr ohne Erkennung aufzuzeichnen. Das System unterst√ºtzt auch die IPv6-Decodierung, einschlie√ülich IPv4-in-IPv6-, IPv6-in-IPv6-Tunnel und anderer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Abfangen des Datenverkehrs k√∂nnen verschiedene Schnittstellen verwendet werden (NFQueue, IPFRing, LibPcap, IPFW, AF_PACKET, PF_RING). Im Unix-Socket-Modus k√∂nnen PCAP-Dateien, die von einem anderen Sniffer erfasst wurden, automatisch analysiert werden. Dar√ºber hinaus erleichtert die modulare Architektur von Suricata das Verbinden neuer Elemente zum Erfassen, Dekodieren, Analysieren und Verarbeiten von Netzwerkpaketen. Es ist auch wichtig zu beachten, dass in Suricata der Datenverkehr mithilfe eines Standardfilters des Betriebssystems blockiert wird. Unter GNU / Linux stehen zwei IPS-Optionen zur Verf√ºgung: √ºber die NFQUEUE-Warteschlange (NFQ-Modus) und √ºber die Nullkopie (AF_PACKET-Modus). Im ersten Fall wird das Paket, das in iptables eingeht, an die NFQUEUE-Warteschlange gesendet, wo es auf Benutzerebene verarbeitet werden kann. Suricata f√ºhrt es nach eigenen Regeln aus und f√§llt eines von drei Urteilen: NF_ACCEPT, NF_DROP und NF_REPEAT.Die ersten beiden Erkl√§rungen sind nicht erforderlich, und mit der letzten k√∂nnen Sie Pakete markieren und an den Anfang der aktuellen iptables-Tabelle senden. Der AF_PACKET-Modus zeichnet sich durch eine h√∂here Geschwindigkeit aus, unterliegt jedoch einer Reihe von Einschr√§nkungen f√ºr das System: Er muss √ºber zwei Netzwerkschnittstellen verf√ºgen und als Gateway fungieren. Ein blockiertes Paket wird einfach nicht an die zweite Schnittstelle weitergeleitet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wichtiges Merkmal von Suricata ist die F√§higkeit, Entwicklungen f√ºr Snort zu verwenden. Der Administrator kann insbesondere auf die Regels√§tze Sourcefire VRT und OpenSource Emerging Threats sowie auf den kommerziellen Emerging Threats Pro zugreifen. Die einheitliche Ausgabe kann mithilfe g√§ngiger Backends analysiert werden, und die Ausgabe an PCAP und Syslog wird ebenfalls unterst√ºtzt. Systemeinstellungen und Regeln werden in YAML-Dateien gespeichert, die leicht zu lesen sind und automatisch verarbeitet werden k√∂nnen. Die Suricata-Engine erkennt viele Protokolle, sodass in den Regeln keine Bindung an die Portnummer erforderlich ist. Dar√ºber hinaus wird das Konzept der Flowbits in Suricata-Regeln aktiv praktiziert. Um die Antwort zu verfolgen, werden Sitzungsvariablen verwendet, um verschiedene Z√§hler und Flags zu erstellen und anzuwenden.Viele IDS betrachten unterschiedliche TCP-Verbindungen als separate Entit√§ten und sehen m√∂glicherweise keine Verbindung zwischen ihnen, was auf den Beginn eines Angriffs hinweist. Suricata versucht, das gesamte Bild zu sehen und erkennt in vielen F√§llen b√∂swilligen Datenverkehr, der √ºber verschiedene Verbindungen verteilt ist. Sie k√∂nnen lange √ºber seine Vorteile sprechen, wir gehen besser zur Installation und Konfiguration √ºber.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie installiert man?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden Suricata auf einem virtuellen Server installieren, auf dem Ubuntu 18.04 LTS ausgef√ºhrt wird. </font><font style="vertical-align: inherit;">Alle Befehle m√ºssen als root (root) ausgef√ºhrt werden. </font><font style="vertical-align: inherit;">Die sicherste Option besteht darin, √ºber SSH mit den Rechten eines normalen Benutzers eine Verbindung zum Server herzustellen und dann das Dienstprogramm sudo zu verwenden, um die Berechtigungen zu erh√∂hen. </font><font style="vertical-align: inherit;">Zuerst m√ºssen Sie die Pakete installieren, die wir ben√∂tigen:</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt -y install libpcre3 libpcre3-dev build-essential autoconf automake libtool libpcap-dev libnet1-dev libyaml-0-2 libyaml-dev zlib1g zlib1g-dev libmagic-dev libcap-ng-dev libjansson-dev pkg-config libnetfilter-queue-dev geoip-bin geoip-database geoipupdate apt-transport-https</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verbinden ein externes Repository:</font></font><br>
<br>
<pre><code class="bash hljs">sudo add-apt-repository ppa:oisf/suricata-stable<font></font>
sudo apt-get update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installieren Sie die neueste stabile Version von Suricata:</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install suricata</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie gegebenenfalls den Namen der Konfigurationsdatei und ersetzen Sie das Standard-eth0 durch den tats√§chlichen Namen der externen Serverschnittstelle. </font><font style="vertical-align: inherit;">Die Standardeinstellungen werden in der Datei / etc / default / suricata und die Benutzereinstellungen in /etc/suricata/suricata.yaml gespeichert. </font><font style="vertical-align: inherit;">Das Einrichten von IDS beschr√§nkt sich gr√∂√ütenteils auf das Bearbeiten dieser Konfigurationsdatei. </font><font style="vertical-align: inherit;">Es hat viele Parameter, die in Name und Zweck mit denen von Snort √ºbereinstimmen. </font><font style="vertical-align: inherit;">Die Syntax ist jedoch v√∂llig anders, aber die Datei ist viel einfacher zu lesen als Snort-Konfigurationen und gut kommentiert.</font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/default/suricata</code></pre><br>
<img src="https://habrastorage.org/webt/d3/oc/qt/d3ocqteatkouq5i01wub0k9dmyo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und</font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/suricata/suricata.yaml</code></pre><br>
<img src="https://habrastorage.org/webt/nh/v8/it/nhv8itz1ajztjvvvkpmfxxxw8cc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachtung! </font><font style="vertical-align: inherit;">Bevor Sie beginnen, sollten Sie die Werte der Variablen im Abschnitt vars √ºberpr√ºfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Konfiguration abzuschlie√üen, m√ºssen Sie suricata-update installieren, um die Regeln zu aktualisieren und herunterzuladen. </font><font style="vertical-align: inherit;">Dies zu tun ist ganz einfach:</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install python-pip<font></font>
sudo pip install pyyaml<font></font>
sudo pip install &lt;a href=<span class="hljs-string">"https://github.com/OISF/suricata-update/archive/master.zip"</span>&gt;https://github.com/OISF/suricata-update/archive/master.zip&lt;/a&gt;<font></font>
sudo pip install --pre --upgrade suricata-update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als N√§chstes m√ºssen wir den Befehl suricata-update ausf√ºhren, um den Regelsatz Emerging Threats Open festzulegen:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update</code></pre><br>
<img src="https://habrastorage.org/webt/tg/nz/yd/tgnzydwuy7jqdeq7swl0sf1xwmc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie den folgenden Befehl aus, um die Liste der Regelquellen anzuzeigen:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update list-sources</code></pre><br>
<img src="https://habrastorage.org/webt/8o/tf/od/8otfodsrz6j0r0lxgnyjuirwyso.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aktualisieren der Regelquellen:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update update-sources</code></pre><br>
<img src="https://habrastorage.org/webt/yc/gf/jd/ycgfjdt8bfuxkd5ncvt03uhxtgc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir besuchen aktualisierte Quellen erneut:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update list-sources</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Bedarf k√∂nnen Sie verf√ºgbare kostenlose Quellen aktivieren:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update <span class="hljs-built_in">enable</span>-source ptresearch/attackdetection<font></font>
sudo suricata-update <span class="hljs-built_in">enable</span>-source oisf/trafficid<font></font>
sudo suricata-update <span class="hljs-built_in">enable</span>-source sslbl/ssl-fp-blacklist</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach m√ºssen Sie die Regeln erneut aktualisieren:</font></font><br>
<br>
<pre><code class="bash hljs">sudo suricata-update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Zusammenhang kann die Installation und Erstkonfiguration von Suricata in Ubuntu 18.04 LTS als abgeschlossen betrachtet werden. </font><font style="vertical-align: inherit;">Der interessanteste Teil beginnt: Im n√§chsten Artikel werden wir einen virtuellen Server √ºber VPN mit dem B√ºronetzwerk verbinden und mit der Analyse des gesamten eingehenden und ausgehenden Datenverkehrs beginnen. </font><font style="vertical-align: inherit;">Wir werden besonderes Augenmerk auf das Blockieren von DDoS-Angriffen, Malware-Aktivit√§ten und Versuchen legen, Schwachstellen in Diensten auszunutzen, auf die √ºber √∂ffentliche Netzwerke zugegriffen werden kann. </font><font style="vertical-align: inherit;">Aus Gr√ºnden der √úbersichtlichkeit werden Angriffe der g√§ngigsten Typen modelliert.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/gu/ab/cg/guabcgmwuqoopx1ar80sjpz6keq.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/de/0y/l-/de0yl-6ppopvisr_a80b4yuhjj8.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de507214/index.html">So erstellen und √§ndern Sie interaktive PDF-Formulare oder die neue F√§higkeit ABBYY FineReader PDF</a></li>
<li><a href="../de507218/index.html">Lesen Sie mich oder warum der Text nicht bis zum Ende gelesen wird</a></li>
<li><a href="../de507222/index.html">Warum jeder Masken tragen sollte</a></li>
<li><a href="../de507224/index.html">So beseitigen Sie blinde Flecken mit visuellen Tests</a></li>
<li><a href="../de507226/index.html">OCR f√ºr PDF in .NET - So extrahieren Sie Text aus unzug√§nglichen PDF-Dokumenten</a></li>
<li><a href="../de507236/index.html">Wir erh√∂hen die Effektivit√§t der Interaktion zwischen Designern und Frontend-Entwicklern</a></li>
<li><a href="../de507238/index.html">Wir verwenden DS, um Kundenbewertungen von gro√üen Websites zu verarbeiten</a></li>
<li><a href="../de507242/index.html">Was ist interessant Wi-Fi 6 in der Leistung von Huawei</a></li>
<li><a href="../de507250/index.html">Definieren einer gewinnenden Pokerhand mithilfe von Map / Reduce in JavaScript</a></li>
<li><a href="../de507254/index.html">Zabbix - Erweiterung der Makrogrenzen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>