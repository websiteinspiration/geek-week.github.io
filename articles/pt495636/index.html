<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèôÔ∏è üë¶ üë®üèª‚Äç‚öñÔ∏è Criando liga√ß√µes Python para bibliotecas C / C ++ usando SIP. Parte 2 üöß üÜë üÜé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na primeira parte do artigo, examinamos os conceitos b√°sicos de trabalho com o utilit√°rio SIP projetado para criar liga√ß√µes Python para bibliotecas es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Criando liga√ß√µes Python para bibliotecas C / C ++ usando SIP. Parte 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495636/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeira parte do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> artigo, examinamos os conceitos b√°sicos de trabalho com o utilit√°rio SIP projetado para criar liga√ß√µes Python para bibliotecas escritas em C e C ++. </font><font style="vertical-align: inherit;">Examinamos os arquivos b√°sicos que voc√™ precisa criar para trabalhar com o SIP e come√ßamos a examinar diretivas e anota√ß√µes. </font><font style="vertical-align: inherit;">At√© agora, fizemos a liga√ß√£o para uma biblioteca simples escrita em C. Nesta parte, descobriremos como fazer a liga√ß√£o para uma biblioteca C ++ que cont√©m classes. </font><font style="vertical-align: inherit;">Usando o exemplo desta biblioteca, veremos quais t√©cnicas podem ser √∫teis ao trabalhar com uma biblioteca orientada a objetos e, ao mesmo tempo, lidaremos com novas diretivas e anota√ß√µes para n√≥s.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os exemplos deste artigo est√£o dispon√≠veis no reposit√≥rio do github em: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Jenyay/sip-examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma liga√ß√£o para uma biblioteca em C ++</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O exemplo a seguir, que consideraremos, est√° na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, crie uma biblioteca para a qual faremos a liga√ß√£o. </font><font style="vertical-align: inherit;">A biblioteca ainda residir√° na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e conter√° uma classe - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O arquivo de cabe√ßalho </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com a declara√ß√£o desta classe √© o seguinte:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-keyword">char</span>* _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val);
        <span class="hljs-keyword">virtual</span> ~Foo();<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta √© uma classe simples com dois getters e setters que configuram e retornam valores do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A implementa√ß√£o da classe √© a seguinte:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* string_val): _int_val(int_val) {<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
    set_string_val(string_val);<font></font>
}<font></font>
<font></font>
Foo::~Foo(){<font></font>
    <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    _string_val = <span class="hljs-literal">nullptr</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* val)</span> </span>{
    <span class="hljs-keyword">if</span> (_string_val != <span class="hljs-literal">nullptr</span>) {
        <span class="hljs-keyword">delete</span>[] _string_val;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">auto</span> count = <span class="hljs-built_in">strlen</span>(val) + <span class="hljs-number">1</span>;<font></font>
    _string_val = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[count];
    <span class="hljs-built_in">strcpy</span>(_string_val, val);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para testar a funcionalidade da biblioteca, a pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tamb√©m cont√©m o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"string_val: "</span> &lt;&lt; foo.get_string_val() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar a biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">use o seguinte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=g++<font></font>
CFLAGS=-c -fPIC<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
    $(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.cpp<font></font>
    $(CC) $(CFLAGS) main.cpp -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.cpp<font></font>
    $(CC) $(CFLAGS) foo.cpp -o $(DIR_OUT)/foo.o<font></font>
    ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
    mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
    rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diferen√ßa do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos exemplos anteriores, al√©m de alterar o compilador de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √© que outra op√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-fPIC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> foi adicionada para compila√ß√£o </font><font style="vertical-align: inherit;">, o que instrui o compilador a colocar o c√≥digo na biblioteca de uma certa maneira (o chamado "c√≥digo independente de posi√ß√£o"). Como este artigo n√£o trata de compiladores, n√£o examinaremos em mais detalhes o que esse par√¢metro faz e por que √© necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar a amarrar para esta biblioteca. Os arquivos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permanecem </font><i><font style="vertical-align: inherit;">praticamente inalterados</font></i><font style="vertical-align: inherit;"> nos exemplos anteriores. Aqui est√° a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apar√™ncia do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> agora </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoocpp"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoocpp]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, nossos exemplos escritos em C ++ ser√£o empacotados no pacote </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><font style="vertical-align: inherit;">, talvez essa seja a √∫nica altera√ß√£o percept√≠vel nesse arquivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permanece o mesmo que no exemplo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E aqui </font><font style="vertical-align: inherit;">consideraremos o </font><font style="vertical-align: inherit;">arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mais detalhes. Deixe-me lembr√°-lo de que este arquivo descreve a interface para o futuro m√≥dulo Python: o que deve incluir, a apar√™ncia da interface da classe etc. O arquivo .sip n√£o √© necess√°rio para repetir o arquivo de cabe√ßalho da biblioteca, embora eles tenham muito em comum. Dentro desta classe, podem ser adicionados novos m√©todos que n√£o estavam na classe original. Essa. a interface descrita no arquivo .sip pode adaptar as classes da biblioteca aos princ√≠pios aceitos no Python, se necess√°rio. No arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , veremos novas diretivas para n√≥s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, vamos ver o que esse arquivo cont√©m:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As primeiras linhas j√° devem estar claras para os exemplos anteriores. Na diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">indicamos o nome do m√≥dulo Python que ser√° criado (ou seja, para usar este m√≥dulo, precisaremos usar os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comandos import foocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foocpp import ....</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Na mesma diretiva, indicamos que agora temos a linguagem - C ++. A </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretiva% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> define a codifica√ß√£o que ser√° usada para converter a string Python nos tipos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, a declara√ß√£o da interface da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> segue </font><font style="vertical-align: inherit;">. Imediatamente ap√≥s a declara√ß√£o da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ainda n√£o √© usada a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que termina com a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretiva% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve conter um c√≥digo que declare a interface da classe C ++ para a qual o wrapper est√° sendo criado. Como regra, nesta diretiva √© suficiente incluir o arquivo de cabe√ßalho na declara√ß√£o de classe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, os m√©todos de classe que ser√£o convertidos nos m√©todos da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para a linguagem Python </font><font style="vertical-align: inherit;">s√£o listados </font><font style="vertical-align: inherit;">. √â importante observar que, neste ponto, declaramos apenas m√©todos p√∫blicos que ser√£o acess√≠veis a partir da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no Python (j√° que n√£o h√° membros privados e protegidos no Python). Como usamos a diretiva </font><i><font style="vertical-align: inherit;">% DefaultEncoding</font></i><font style="vertical-align: inherit;"> no in√≠cio</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em m√©todos que usam argumentos do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , n√£o √© poss√≠vel usar a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para especificar a codifica√ß√£o para converter esses par√¢metros em seq√º√™ncias de caracteres Python e vice-versa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora s√≥ precisamos compilar o pacote </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python </font><font style="vertical-align: inherit;">e test√°-lo. </font><font style="vertical-align: inherit;">Mas antes de montar um pacote completo de roda, vamos usar o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e ver quais arquivos de origem o SIP criar√° para compila√ß√£o posterior e tentar encontrar neles algo semelhante √† classe que ser√° criada no c√≥digo Python. </font><font style="vertical-align: inherit;">Para fazer isso, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acima </font><font style="vertical-align: inherit;">deve ser chamado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Como resultado, a pasta de </font><i><font style="vertical-align: inherit;">compila√ß√£o</font></i><font style="vertical-align: inherit;"> ser√° criada.</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com o seguinte conte√∫do:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Construir</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fo‚îÄ‚îÄ foocpp</font></font><font></font>
    ‚îú‚îÄ‚îÄ apiversions.c<font></font>
    ‚îú‚îÄ‚îÄ array.c<font></font>
    ‚îú‚îÄ‚îÄ array.h<font></font>
    ‚îú‚îÄ‚îÄ bool.cpp<font></font>
    ‚îú‚îÄ‚îÄ build<font></font>
    ‚îÇ&nbsp;&nbsp; ‚îî‚îÄ‚îÄ temp.linux-x86_64-3.8<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ apiversions.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ array.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ bool.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ descriptors.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ int_convertors.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ objmap.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ qtlib.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ sipfoocppcmodule.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ sipfoocppFoo.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ siplib.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îú‚îÄ‚îÄ threads.o<font></font>
    ‚îÇ&nbsp;&nbsp;     ‚îî‚îÄ‚îÄ voidptr.o<font></font>
    ‚îú‚îÄ‚îÄ descriptors.c<font></font>
    ‚îú‚îÄ‚îÄ foocpp.cpython-38-x86_64-linux-gnu.so<font></font>
    ‚îú‚îÄ‚îÄ int_convertors.c<font></font>
    ‚îú‚îÄ‚îÄ objmap.c<font></font>
    ‚îú‚îÄ‚îÄ qtlib.c<font></font>
    ‚îú‚îÄ‚îÄ sipAPIfoocpp.h<font></font>
    ‚îú‚îÄ‚îÄ sipfoocppcmodule.cpp<font></font>
    ‚îú‚îÄ‚îÄ sipfoocppFoo.cpp<font></font>
    ‚îú‚îÄ‚îÄ sip.h<font></font>
    ‚îú‚îÄ‚îÄ sipint.h<font></font>
    ‚îú‚îÄ‚îÄ siplib.c<font></font>
    ‚îú‚îÄ‚îÄ threads.c<font></font>
    ‚îî‚îÄ‚îÄ voidptr.c<font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uma tarefa adicional, considere cuidadosamente o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocppFoo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (n√£o o discutiremos em detalhes neste artigo):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*
 * Interface wrapper code.
 *
 * Generated by SIP 5.1.1
 */</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"sipAPIfoocpp.h"</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 6 <span class="hljs-meta-string">"/home/jenyay/temp/2/pyfoocpp.sip"</span></span>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">line</span> 12 <span class="hljs-meta-string">"/home/jenyay/temp/2/build/foocpp/sipfoocppFoo.cpp"</span></span><font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_int_val, <span class="hljs-string">"set_int_val(self, int)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"Bi"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_int_val(a0);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_int_val, doc_Foo_set_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_int_val, <span class="hljs-string">"get_int_val(self) -&gt; int"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_int_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">int</span> sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_int_val();<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_int_val, doc_Foo_get_int_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_set_string_val, <span class="hljs-string">"set_string_val(self, str)"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_set_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a0;<font></font>
        PyObject *a0Keep;<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"BA8"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp, &amp;a0Keep, &amp;a0))<font></font>
        {<font></font>
            sipCpp-&gt;set_string_val(a0);<font></font>
            Py_DECREF(a0Keep);<font></font>
<font></font>
            Py_INCREF(Py_None);<font></font>
            <span class="hljs-keyword">return</span> Py_None;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_set_string_val, doc_Foo_set_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo_get_string_val, <span class="hljs-string">"get_string_val(self) -&gt; str"</span>);<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *, PyObject *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> PyObject *<span class="hljs-title">meth_Foo_get_string_val</span><span class="hljs-params">(PyObject *sipSelf, PyObject *sipArgs)</span>
</span>{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
         ::Foo *sipCpp;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseArgs(&amp;sipParseErr, sipArgs, <span class="hljs-string">"B"</span>, &amp;sipSelf, sipType_Foo, &amp;sipCpp))<font></font>
        {<font></font>
            <span class="hljs-keyword">char</span>*sipRes;<font></font>
<font></font>
            sipRes = sipCpp-&gt;get_string_val();<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (sipRes == SIP_NULLPTR)<font></font>
            {<font></font>
                Py_INCREF(Py_None);<font></font>
                <span class="hljs-keyword">return</span> Py_None;<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> PyUnicode_FromString(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/* Raise an exception if the arguments couldn't be parsed. */</span><font></font>
    sipNoMethod(sipParseErr, sipName_Foo, sipName_get_string_val, doc_Foo_get_string_val);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Call the instance's destructor. */</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *, <span class="hljs-keyword">int</span>)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_Foo</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *sipCppV, <span class="hljs-keyword">int</span>)</span>
</span>{
    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">reinterpret_cast</span>&lt; ::Foo *&gt;(sipCppV);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dealloc_Foo</span><span class="hljs-params">(sipSimpleWrapper *sipSelf)</span>
</span>{
    <span class="hljs-keyword">if</span> (sipIsOwnedByPython(sipSelf))<font></font>
    {<font></font>
        release_Foo(sipGetAddress(sipSelf), <span class="hljs-number">0</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *, 
                 PyObject *, PyObject **, PyObject **, PyObject **)</span></span>;}
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">init_type_Foo</span><span class="hljs-params">(sipSimpleWrapper *, PyObject *sipArgs, PyObject *sipKwds,
                                   PyObject **sipUnused, PyObject **, PyObject **sipParseErr)</span>
</span>{<font></font>
     ::Foo *sipCpp = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">int</span> a0;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* a1;<font></font>
        PyObject *a1Keep;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"iA8"</span>, &amp;a0, &amp;a1Keep, &amp;a1))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(a0,a1);<font></font>
            Py_DECREF(a1Keep);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span>  ::Foo* a0;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (sipParseKwdArgs(sipParseErr, sipArgs, sipKwds, SIP_NULLPTR, sipUnused, <span class="hljs-string">"J9"</span>, sipType_Foo, &amp;a0))<font></font>
        {<font></font>
            sipCpp = <span class="hljs-keyword">new</span>  ::Foo(*a0);<font></font>
<font></font>
            <span class="hljs-keyword">return</span> sipCpp;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">static</span> PyMethodDef methods_Foo[] = {<font></font>
    {sipName_get_int_val, meth_Foo_get_int_val, METH_VARARGS, doc_Foo_get_int_val},<font></font>
    {sipName_get_string_val, meth_Foo_get_string_val, METH_VARARGS, doc_Foo_get_string_val},<font></font>
    {sipName_set_int_val, meth_Foo_set_int_val, METH_VARARGS, doc_Foo_set_int_val},<font></font>
    {sipName_set_string_val, meth_Foo_set_string_val, METH_VARARGS, doc_Foo_set_string_val}<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_Foo, <span class="hljs-string">"\1Foo(int, str)\n"</span>
<span class="hljs-string">"Foo(Foo)"</span>);<font></font>
<font></font>
sipClassTypeDef sipTypeDef_foocpp_Foo = {<font></font>
    {<font></font>
        <span class="hljs-number">-1</span>,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_TYPE_CLASS,<font></font>
        sipNameNr_Foo,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    },<font></font>
    {<font></font>
        sipNameNr_Foo,<font></font>
        {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>},
        <span class="hljs-number">4</span>, methods_Foo,
        <span class="hljs-number">0</span>, SIP_NULLPTR,
        <span class="hljs-number">0</span>, SIP_NULLPTR,<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
         SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    },<font></font>
    doc_Foo,<font></font>
    <span class="hljs-number">-1</span>,
    <span class="hljs-number">-1</span>,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    init_type_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    dealloc_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    release_Foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora construa o pacote usando o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Depois de executar este comando, se tudo der certo, ser√° </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um </font><i><font style="vertical-align: inherit;">arquivo pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;"> ou com um nome semelhante. </font><font style="vertical-align: inherit;">Instale-o usando o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando pip install --user pyfoocpp-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e execute o interpretador Python para verificar:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_int_val(<span class="hljs-number">50</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.set_string_val(<span class="hljs-string">''</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trabalho! </font><font style="vertical-align: inherit;">Assim, acabamos de criar um m√≥dulo Python com uma liga√ß√£o para uma classe em C ++. </font><font style="vertical-align: inherit;">Al√©m disso, traremos beleza a esta classe e adicionaremos v√°rias comodidades.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar propriedades</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As classes criadas usando o SIP n√£o s√£o necess√°rias para repetir exatamente a interface da classe C ++. Por exemplo, em nossa classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">existem dois getters e dois setters, que podem ser claramente combinados em uma propriedade para tornar a classe mais "Python". Adicionar propriedades usando sip √© f√°cil o suficiente, como mostra um exemplo na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este exemplo √© semelhante ao anterior, a principal diferen√ßa est√° no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que agora se parece com o seguinte:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, tudo √© bem simples. Para adicionar uma propriedade, a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedade%</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directiva tem por objectivo </font><font style="vertical-align: inherit;">, que tem dois par√¢metros necess√°rios: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nome</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para especificar o nome da propriedade, e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para especificar um m√©todo que retorna um valor (getter). Pode n√£o haver um setter, mas se tamb√©m for necess√°rio atribuir valores √† propriedade, o m√©todo setter ser√° especificado como o valor do par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No nosso exemplo, as propriedades s√£o criadas de maneira bastante direta, pois j√° existem fun√ß√µes que funcionam como getters e setters. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S√≥ podemos coletar o pacote usando o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , instal√°-lo, depois verificaremos a opera√ß√£o das propriedades no modo de comando do interpretador python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val
<span class="hljs-number">10</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.int_val = <span class="hljs-number">50</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_int_val()
<span class="hljs-number">50</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver a partir do exemplo da utiliza√ß√£o do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">, os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trabalhar tanto para ler e escrever.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar linhas de documenta√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Continuaremos a melhorar nossa classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O exemplo a seguir, localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_03,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mostra como adicionar linhas de documenta√ß√£o (docstring) a v√°rios elementos de uma classe. </font><font style="vertical-align: inherit;">Este exemplo √© baseado no anterior e a principal altera√ß√£o refere-se ao arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Aqui est√° o seu conte√∫do:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
%Docstring<font></font>
Class example from C++ library<font></font>
%End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"prepended"</span>)<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring(format=<span class="hljs-string">"deindented"</span>, signature=<span class="hljs-string">"appended"</span>)<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring <span class="hljs-string">"deindented"</span>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ j√° entendeu, para adicionar linhas de documenta√ß√£o a qualquer elemento da classe, voc√™ precisa usar a diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este exemplo mostra v√°rias maneiras de usar esta diretiva. Para uma melhor compreens√£o deste exemplo, vamos compilar imediatamente o pacote </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , instal√°-lo e lidaremos com qual par√¢metro desta diretiva afeta o que, considerando as linhas de documenta√ß√£o resultantes no modo de comando Python. Deixe-me lembr√°-lo de que as linhas de documenta√ß√£o s√£o armazenadas como membros dos </font><font style="vertical-align: inherit;">objetos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__doc__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aos quais essas linhas pertencem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira linha de documenta√ß√£o √© para a classe </font><i><font style="vertical-align: inherit;">Foo</font></i><font style="vertical-align: inherit;"> .</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Como voc√™ pode ver, todas as linhas de documenta√ß√£o est√£o localizadas entre as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretivas% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . As linhas 5-7 deste exemplo n√£o usam par√¢metros adicionais da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; portanto, a linha de documenta√ß√£o ser√° gravada na classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como est√°. √â por isso que n√£o h√° recuo nas linhas 5-7, caso contr√°rio, os recuos na frente da linha de documenta√ß√£o tamb√©m cairiam em Foo .__ doc__. Garantiremos que a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realmente contenha a linha de documenta√ß√£o que introduzimos:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.__doc__
<span class="hljs-string">'Class example from C++ library'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seguir </font><font style="vertical-align: inherit;">, localizada nas linhas 17-19, usa dois par√¢metros ao mesmo tempo. O par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode assumir um dos dois valores: ‚Äúbruto‚Äù ou ‚Äúdesindentado‚Äù. No primeiro caso, as linhas de documenta√ß√£o s√£o salvas √† medida que s√£o gravadas e, no segundo, os caracteres de espa√ßo inicial (mas n√£o as guias) s√£o exclu√≠dos. O valor padr√£o para o caso, se o par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><font style="vertical-align: inherit;">for </font><font style="vertical-align: inherit;">especificado, pode ser configurado usando a diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (consideraremos um pouco mais tarde) e, se n√£o for especificado, ser√° assumido que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "raw"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m das linhas de documenta√ß√£o especificadas, o SIP adiciona uma descri√ß√£o de sua assinatura (que tipos de vari√°veis ‚Äã‚Äãs√£o esperados na entrada e que tipo a fun√ß√£o retorna) √†s linhas de documenta√ß√£o de fun√ß√µes. O par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indica onde colocar essa assinatura: antes da linha de documenta√ß√£o especificada ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura = "pr√©- </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anexada"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">, depois dela ( </font><i><font style="vertical-align: inherit;">assinatura = "anexada"</font></i><font style="vertical-align: inherit;"> ) ou n√£o a assinatura ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura = "descartada"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso exemplo define a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura = "prefixado"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par√¢metro </font><font style="vertical-align: inherit;">para os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√µes set_int_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bem como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a assinatura = "anexado"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√µes set_string_val</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format = "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tamb√©m foi adicionado </font><font style="vertical-align: inherit;">para remover espa√ßos no in√≠cio da linha de documenta√ß√£o. Vamos verificar como esses par√¢metros funcionam no Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_int_val.__doc__
<span class="hljs-string">'get_int_val(self) -&gt; int\nReturn integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_int_val.__doc__
<span class="hljs-string">'set_int_val(self, int)\nSet integer value'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.get_string_val.__doc__
<span class="hljs-string">'Return string value\nget_string_val(self) -&gt; str'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>Foo.set_string_val.__doc__
<span class="hljs-string">'Set string value\nset_string_val(self, str)'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, usando o par√¢metro </font><font style="vertical-align: inherit;">de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">voc√™ pode alterar a posi√ß√£o da descri√ß√£o da assinatura da fun√ß√£o na linha de documenta√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora considere adicionar uma linha de documenta√ß√£o √†s propriedades. Observe que, nesse caso, as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diretivas% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% End</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o colocadas entre chaves ap√≥s a diretiva% Property. Este formato de grava√ß√£o √© descrito na documenta√ß√£o da diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observe tamb√©m como especificamos o par√¢metro da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esse formato para escrever diretivas √© poss√≠vel se definirmos apenas o primeiro par√¢metro da diretiva (nesse caso, o par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Portanto, neste exemplo, tr√™s m√©todos de uso de diretivas s√£o usados ‚Äã‚Äãao mesmo tempo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifique se a linha de documenta√ß√£o para as propriedades est√° definida:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; Foo.int_val.__doc__<font></font>
'The property for integer value'<font></font>
<font></font>
&gt;&gt;&gt; Foo.string_val.__doc__<font></font>
'The property for string value'<font></font>
<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
Help on class Foo in module foocpp:<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      Return string value<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      Set string value<font></font>
 |      set_string_val(self, str)<font></font>
...<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos simplificar este exemplo, definindo os valores padr√£o para os par√¢metros de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formato</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando as </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">diretivas </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O uso dessas diretivas √© mostrado no exemplo da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neste exemplo cont√©m o seguinte c√≥digo:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span></span>;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No in√≠cio do arquivo, as linhas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat "deindented"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature "prepended" foram adicionadas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, em seguida, todos os par√¢metros da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> foram removidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s montar e instalar este exemplo, podemos ver como √© a descri√ß√£o da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agora </font><font style="vertical-align: inherit;">, que o comando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">help (Foo)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exibe </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Foo<font></font>
&gt;&gt;&gt; help(Foo)<font></font>
<font></font>
class Foo(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Foo<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_int_val(...)<font></font>
 |      get_int_val(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_val(...)<font></font>
 |      get_string_val(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_int_val(...)<font></font>
 |      set_int_val(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_val(...)<font></font>
 |      set_string_val(self, str)<font></font>
 |      Set string value<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo parece bem arrumado e do mesmo tipo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renomear classes e m√©todos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como j√° dissemos, a interface fornecida pelas liga√ß√µes do Python n√£o precisa corresponder √† interface que a biblioteca C / C ++ fornece. Adicionamos propriedades √†s classes acima e agora veremos mais uma t√©cnica que pode ser √∫til se surgirem conflitos de nomes ou fun√ß√µes de classe, por exemplo, se um nome de fun√ß√£o corresponder a alguma palavra-chave Python. Para fazer isso, voc√™ pode renomear classes, fun√ß√µes, exce√ß√µes e outras entidades. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para renomear uma entidade, a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><i><font style="vertical-align: inherit;">usada</font></i><font style="vertical-align: inherit;"> , cujo valor precisa ser atribu√≠do a um novo nome de entidade. O trabalho com a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mostrado no exemplo da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este exemplo √© baseado no exemplo anterior.</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e difere dele pelo arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cujo conte√∫do agora se parece com isso:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span>
%DefaultDocstringFormat <span class="hljs-string">"deindented"</span>
%DefaultDocstringSignature <span class="hljs-string">"prepended"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> /<span class="hljs-title">PyName</span>=<span class="hljs-title">Bar</span>/ {</span><font></font>
    %Docstring<font></font>
    Class example from C++ library<font></font>
    %End<font></font>
<font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> /PyName</span>=set_integer_value/;<font></font>
        %Docstring<font></font>
            Set integer value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span> /PyName</span>=get_integer_value/;<font></font>
        %Docstring<font></font>
            Return integer value<font></font>
        %End<font></font>
<font></font>
        %Property(name=int_val, get=get_integer_value, <span class="hljs-built_in">set</span>=set_integer_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> integer value<font></font>
            %End<font></font>
        };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)</span> /PyName</span>=set_string_value/;<font></font>
        %Docstring<font></font>
            Set <span class="hljs-built_in">string</span> value<font></font>
        %<span class="hljs-function">End

        <span class="hljs-keyword">char</span>* <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span> /PyName</span>=get_string_value/;<font></font>
        %Docstring<font></font>
            Return <span class="hljs-built_in">string</span> value<font></font>
        %End<font></font>
<font></font>
        %Property(name=string_val, get=get_string_value, <span class="hljs-built_in">set</span>=set_string_value)<font></font>
        {<font></font>
            %Docstring<font></font>
                The property <span class="hljs-keyword">for</span> <span class="hljs-built_in">string</span> value<font></font>
            %End<font></font>
        };<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste exemplo, renomeamos a </font><font style="vertical-align: inherit;">classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e tamb√©m </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atribu√≠mos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> outros nomes a todos os m√©todos usando a anota√ß√£o </font><i><font style="vertical-align: inherit;">PyName</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Eu acho que tudo aqui √© bastante simples e claro, a √∫nica coisa que merece aten√ß√£o √© a cria√ß√£o de propriedades. </font><font style="vertical-align: inherit;">Na diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">os par√¢metros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devem especificar os nomes dos m√©todos, como ser√£o chamados na classe Python, e n√£o os nomes para os quais foram originalmente chamados no c√≥digo C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compile o exemplo, instale-o e veja como essa classe ficar√° no Python:</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt;&gt;&gt; from foocpp import Bar<font></font>
&gt;&gt;&gt; help(Bar)<font></font>
<font></font>
Help on class Bar in module foocpp:<font></font>
<font></font>
class Bar(sip.wrapper)<font></font>
 |  Class example from C++ library<font></font>
 |  <font></font>
 |  Method resolution order:<font></font>
 |      Bar<font></font>
 |      sip.wrapper<font></font>
 |      sip.simplewrapper<font></font>
 |      builtins.object<font></font>
 |  <font></font>
 |  Methods defined here:<font></font>
 |  <font></font>
 |  get_integer_value(...)<font></font>
 |      get_integer_value(self) -&gt; int<font></font>
 |      Return integer value<font></font>
 |  <font></font>
 |  get_string_value(...)<font></font>
 |      get_string_value(self) -&gt; str<font></font>
 |      Return string value<font></font>
 |  <font></font>
 |  set_integer_value(...)<font></font>
 |      set_integer_value(self, int)<font></font>
 |      Set integer value<font></font>
 |  <font></font>
 |  set_string_value(...)<font></font>
 |      set_string_value(self, str)<font></font>
 |      Set string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
 |  Data descriptors defined here:<font></font>
 |  <font></font>
 |  __weakref__<font></font>
 |      list of weak references to the object (if defined)<font></font>
 |  <font></font>
 |  int_val<font></font>
 |      The property for integer value<font></font>
 |  <font></font>
 |  string_val<font></font>
 |      The property for string value<font></font>
 |  <font></font>
 |  ----------------------------------------------------------------------<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funcionou! </font><font style="vertical-align: inherit;">Conseguimos renomear a pr√≥pria classe e seus m√©todos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Äs vezes, as bibliotecas usam o acordo de que os nomes de todas as classes come√ßam com um prefixo, por exemplo, com a letra "Q" em Qt ou "wx" em wxWidgets. </font><font style="vertical-align: inherit;">Se na sua liga√ß√£o Python voc√™ deseja renomear todas as classes, se livrando desses prefixos, para n√£o definir a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para cada classe, voc√™ pode usar a diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% AutoPyName</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">N√£o consideraremos essa diretiva neste artigo, diremos apenas que a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% AutoPyName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve estar localizada dentro da diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e nos restringir a um exemplo da documenta√ß√£o:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module PyQt5.QtCore<font></font>
{<font></font>
    %AutoPyName(remove_leading="Q")<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar convers√£o de tipo</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo usando a classe std :: wstring</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© agora, vimos fun√ß√µes e classes que funcionaram com tipos simples como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para esses tipos, o SIP criou automaticamente um conversor de e para as classes Python. No exemplo a seguir, localizado na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , consideraremos o caso em que os m√©todos de classe aceitam e retornam objetos mais complexos, por exemplo, cadeias de caracteres de STL. Para simplificar o exemplo e n√£o complicar a convers√£o de bytes em Unicode e vice-versa, a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> string </font><i><font style="vertical-align: inherit;">std :: wstring</font></i><font style="vertical-align: inherit;"> ser√° usada neste exemplo </font><font style="vertical-align: inherit;">. A id√©ia deste exemplo √© mostrar como voc√™ pode definir manualmente as regras para a convers√£o de classes C ++ de e para classes Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste exemplo, mudaremos a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da biblioteca </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Agora a defini√ß√£o da classe ficar√° assim (arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FOO_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOO_LIB</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span>
    <span class="hljs-keyword">private</span>:
        <span class="hljs-keyword">int</span> _int_val;
        <span class="hljs-built_in">wstring</span> _string_val;
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A implementa√ß√£o da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>;<font></font>
<font></font>
Foo::Foo(<span class="hljs-keyword">int</span> int_val, <span class="hljs-built_in">wstring</span> string_val):<font></font>
    _int_val(int_val), _string_val(string_val) {}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>{<font></font>
    _int_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Foo::get_int_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _int_val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Foo::set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">wstring</span> val)</span> </span>{<font></font>
    _string_val = val;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-built_in">wstring</span> <span class="hljs-title">Foo::get_string_val</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> _string_val;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para verificar a funcionalidade da biblioteca:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"foo.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>;
<span class="hljs-keyword">using</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>{
    <span class="hljs-keyword">auto</span> foo = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">L"Hello"</span>);
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
<font></font>
    foo.set_int_val(<span class="hljs-number">0</span>);<font></font>
    foo.set_string_val(<span class="hljs-string">L"Hello world!"</span>);<font></font>
<font></font>
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"int_val: "</span> &lt;&lt; foo.get_int_val() &lt;&lt; <span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">L"string_val: "</span> &lt;&lt; foo.get_string_val().c_str() &lt;&lt; <span class="hljs-built_in">endl</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os arquivos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como antes, est√£o localizados na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> processo de cria√ß√£o de </font><i><font style="vertical-align: inherit;">makefile</font></i><font style="vertical-align: inherit;"> e biblioteca n√£o mudou. </font><font style="vertical-align: inherit;">Tamb√©m n√£o h√° altera√ß√µes significativas nos arquivos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoocpp.sip tornou-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se notavelmente mais complicado:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foocpp, language=<span class="hljs-string">"C++"</span>)<font></font>
%DefaultEncoding <span class="hljs-string">"UTF-8"</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> {</span><font></font>
    %TypeHeaderCode<font></font>
    <span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;foo.h&gt;</span></span><font></font>
    %End<font></font>
<font></font>
    <span class="hljs-keyword">public</span>:<font></font>
        Foo(<span class="hljs-keyword">int</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>);<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_int_val</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_int_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=int_val, get=get_int_val, <span class="hljs-built_in">set</span>=set_int_val)<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_string_val</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>)</span></span>;
        <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> <span class="hljs-title">get_string_val</span><span class="hljs-params">()</span></span>;<font></font>
        %Property(name=string_val, get=get_string_val, <span class="hljs-built_in">set</span>=set_string_val)<font></font>
};<font></font>
<font></font>
%MappedType <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span><font></font>
{<font></font>
%TypeHeaderCode<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><font></font>
%End<font></font>
<font></font>
%ConvertFromTypeCode<font></font>
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
<font></font>
%ConvertToTypeCode<font></font>
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fins</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ilustrativos </font><i><font style="vertical-align: inherit;">, o</font></i><font style="vertical-align: inherit;"> arquivo </font><i><font style="vertical-align: inherit;">pyfoocpp.sip</font></i><font style="vertical-align: inherit;"> n√£o adiciona linhas de documenta√ß√£o. Se </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deix√°ssemos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apenas a declara√ß√£o da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no arquivo </font><i><font style="vertical-align: inherit;">pyfoocpp.sip</font></i><font style="vertical-align: inherit;"> sem a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> subsequente, </font><i><font style="vertical-align: inherit;">obter√≠amos</font></i><font style="vertical-align: inherit;"> o seguinte erro durante o processo de compila√ß√£o:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ sip-wheel<font></font>
<font></font>
These bindings will be built: pyfoocpp.<font></font>
Generating the pyfoocpp bindings...<font></font>
sip-wheel: std::wstring is undefined<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos descrever explicitamente como um objeto do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° convertido em algum objeto Python e tamb√©m descrever a transforma√ß√£o inversa. Para descrever a convers√£o, teremos de trabalhar em um n√≠vel bastante baixo na linguagem C e usar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Python / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como a API Python / C √© um t√≥pico importante, digno de um artigo separado, mas de um livro, nesta se√ß√£o, consideraremos apenas as fun√ß√µes usadas no exemplo, sem entrar em muitos detalhes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para declarar convers√µes de objetos C ++ para Python e vice-versa, a diretiva </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">destinada</font></a><font style="vertical-align: inherit;"> , dentro da qual pode haver tr√™s outras diretivas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ap√≥s a express√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , especifique o tipo para o qual os conversores ser√£o criados. </font><font style="vertical-align: inherit;">No nosso caso, a diretiva come√ßa com a express√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">J√° </font><i><font style="vertical-align: inherit;">cumprimos a</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na se√ß√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazendo uma liga√ß√£o para uma biblioteca em C ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Deixe-me lembr√°-lo de que esta diretiva se destina a declarar os tipos usados ‚Äã‚Äãou a incluir os arquivos de cabe√ßalho nos quais eles s√£o declarados. </font><font style="vertical-align: inherit;">Neste exemplo </font><font style="vertical-align: inherit;">, a </font><i><font style="vertical-align: inherit;">string do</font></i><font style="vertical-align: inherit;"> arquivo de cabe√ßalho </font><font style="vertical-align: inherit;">, onde a classe </font><i><font style="vertical-align: inherit;">std :: string √©</font></i><font style="vertical-align: inherit;"> declarada, √© </font><font style="vertical-align: inherit;">conectada </font><font style="vertical-align: inherit;">√† diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% TypeHeaderCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Agora precisamos descrever as transforma√ß√µes</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode. </font><font style="vertical-align: inherit;">Convertendo objetos C ++ em Python</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßamos convertendo objetos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para a </font><font style="vertical-align: inherit;">classe </font><font style="vertical-align: inherit;">Python </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Essa convers√£o no exemplo √© a seguinte:</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertFromTypeCode
    <span class="hljs-comment">// Convert an std::wstring to a Python (Unicode) string</span><font></font>
    PyObject* newstring;<font></font>
    newstring = PyUnicode_FromWideChar(sipCpp-&gt;data(), <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">return</span> newstring;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro dessa diretiva, temos a vari√°vel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - um ponteiro para um objeto do c√≥digo C ++, pelo qual precisamos criar um objeto Python e retornar o objeto criado a partir da diretiva usando a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instru√ß√£o return</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nesse caso, a vari√°vel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para criar a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , use a fun√ß√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da API Python / C. Essa fun√ß√£o aceita uma matriz (ponteiro) do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const wchar_t * w</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como o primeiro par√¢metro </font><font style="vertical-align: inherit;">e o tamanho dessa matriz como o segundo par√¢metro. Se voc√™ passar o valor -1 como o segundo par√¢metro, a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√≥pria</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√£o </font><i><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></i><font style="vertical-align: inherit;"> calcular√° o comprimento usando a fun√ß√£o</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wcslen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obter a matriz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wchar_t *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">use o m√©todo de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_FromWideChar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retorna um ponteiro para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no caso de um erro. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© qualquer objeto Python, nesse caso, ser√° a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Na API Python / C, o trabalho com objetos geralmente ocorre por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meio de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ponteiros </font><i><font style="vertical-align: inherit;">PyObject *</font></i><font style="vertical-align: inherit;"> ; portanto, nesse caso, </font><font style="vertical-align: inherit;">retornamos o ponteiro </font><i><font style="vertical-align: inherit;">PyObject *</font></i><font style="vertical-align: inherit;"> da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode. </font><font style="vertical-align: inherit;">Converter objetos Python em C ++</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A convers√£o inversa de um objeto Python (essencialmente de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) para a classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><font style="vertical-align: inherit;">descrita na diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No exemplo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_cpp_06, a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> convers√£o √© a seguinte:</font></font><br>
<br>
<pre><code class="cpp hljs">%ConvertToTypeCode
    <span class="hljs-comment">// Convert a Python (Unicode) string to an std::wstring</span>
    <span class="hljs-keyword">if</span> (sipIsErr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> PyUnicode_Check(sipPy);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (PyUnicode_Check(sipPy)) {<font></font>
        *sipCppPtr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span>(PyUnicode_AS_UNICODE(sipPy));
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
%End<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parece mais complicado, porque durante o processo de convers√£o √© chamado v√°rias vezes para prop√≥sitos diferentes. Dentro da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o </font><font style="vertical-align: inherit;">SIP cria v√°rias vari√°veis ‚Äã‚Äãque podemos (ou devemos) usar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma dessas vari√°veis, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject * sipPy,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um objeto Python que voc√™ precisa para criar uma inst√¢ncia da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nesse caso </font><font style="vertical-align: inherit;">. O resultado precisar√° ser gravado em outra vari√°vel - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um ponteiro duplo para o objeto criado, ou seja, no nosso caso, essa vari√°vel ser√° do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring **</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro </font><i><font style="vertical-align: inherit;">% ConvertToTypeCode</font></i><font style="vertical-align: inherit;"> criado dentro da diretiva</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a vari√°vel √© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int * sipIsErr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se o valor dessa vari√°vel for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° chamada apenas para verificar se a convers√£o de tipo √© poss√≠vel. Nesse caso, n√£o somos obrigados a realizar a transforma√ß√£o, mas apenas precisamos verificar se √© poss√≠vel em princ√≠pio. Se poss√≠vel, a diretiva deve retornar um valor diferente de zero; caso contr√°rio, se a convers√£o n√£o for poss√≠vel, eles devem retornar 0. Se esse ponteiro n√£o for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ser√° necess√°rio executar a convers√£o e, se ocorrer um erro durante a convers√£o, o c√≥digo de erro inteiro poder√° ser salvo. nessa vari√°vel (dado que essa vari√°vel √© um ponteiro para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste exemplo, para verificar se </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipPy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© uma string unicode (classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usada a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macro </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">PyUnicode_Check</font></a><font style="vertical-align: inherit;"> , que recebe um argumento do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyObject *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se o argumento passado for uma string unicode ou uma classe derivada dela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A convers√£o para um objeto C ++ √© realizada usando a string </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* sipCppPtr = new std :: wstring (PyUnicode_AS_UNICODE (sipPy));</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Isso chama a macro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da API Python / C, que retorna uma matriz do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Py_UNICODE *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que √© equivalente a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wchar_t *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Essa matriz √© passada para o construtor da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como mencionado acima, o resultado √© armazenado na vari√°vel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipCppPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento, a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUnicode_AS_UNICODE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° </font><font style="vertical-align: inherit;">obsoleta e √© recomend√°vel usar outras macros, mas essa macro √© usada para simplificar o exemplo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a convers√£o foi bem-sucedida, a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve retornar um valor diferente de zero (neste caso, 1) e, no caso de um erro, deve retornar 0.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifica </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descrevemos a convers√£o do tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: wstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e vice-versa, agora podemos garantir que o pacote seja constru√≠do com √™xito e que a liga√ß√£o funcione como deveria. </font><font style="vertical-align: inherit;">Para construir, chame </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , instale o pacote usando pip e verifique a operabilidade no modo de comando Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foocpp <span class="hljs-keyword">import</span> Foo
<span class="hljs-meta">&gt;&gt;&gt; </span>x = Foo(<span class="hljs-number">10</span>, <span class="hljs-string">'Hello'</span>)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">'Hello'</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val = <span class="hljs-string">''</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.string_val
<span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>x.get_string_val()
<span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, tudo funciona, tamb√©m n√£o h√° problemas com o idioma russo, ou seja, </font><font style="vertical-align: inherit;">Convers√µes de seq√º√™ncia de caracteres Unicode executadas corretamente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, abordamos o b√°sico do uso do SIP para criar liga√ß√µes Python para bibliotecas escritas em C e C ++. </font><font style="vertical-align: inherit;">Primeiro (na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeira parte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), criamos uma biblioteca simples em C e descobrimos os arquivos que precisam ser criados para trabalhar com o SIP. </font><font style="vertical-align: inherit;">O arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m informa√ß√µes sobre o pacote (nome, n√∫mero da vers√£o, licen√ßa e caminhos para os arquivos de cabe√ßalho e objeto). </font><font style="vertical-align: inherit;">Usando o arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">voc√™ pode influenciar o processo de cria√ß√£o do pacote Python, por exemplo, come√ßar a criar a biblioteca C / C ++ ou permitir que o usu√°rio especifique o local dos arquivos de cabe√ßalho e de objeto da biblioteca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descreve a interface do m√≥dulo Python, listando as fun√ß√µes e classes que estar√£o contidas no m√≥dulo. </font><font style="vertical-align: inherit;">Diretivas e anota√ß√µes s√£o usadas </font><font style="vertical-align: inherit;">para descrever a interface no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A interface da classe Python n√£o precisa corresponder √† interface da classe C ++. Por exemplo, voc√™ pode adicionar propriedades a classes usando a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , renomear entidades usando a anota√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ PyName /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e adicionar linhas de documenta√ß√£o usando a diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Docstring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tipos elementares como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc. O SIP converte automaticamente em classes Python semelhantes, mas se voc√™ precisar executar uma convers√£o mais complexa, precisar√° program√°-lo dentro da diretiva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% MappedType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando a API Python / C. A convers√£o da classe Python para C ++ deve ser feita na diretiva aninhada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertToTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A convers√£o de um tipo C ++ para uma classe Python deve ser feita na diretiva aninhada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% ConvertFromTypeCode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algumas diretivas como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringFormat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultDocstringSignature</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o auxiliares e permitem definir valores padr√£o para casos em que alguns par√¢metros de anota√ß√£o n√£o s√£o explicitamente definidos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, examinamos apenas as diretrizes e anota√ß√µes b√°sicas e mais simples, mas muitas delas foram ignoradas. </font><font style="vertical-align: inherit;">Por exemplo, existem diretrizes para gerenciar o GIL, para criar novas exce√ß√µes em Python, para gerenciar manualmente coletores de mem√≥ria e lixo, para ajustar classes para diferentes sistemas operacionais e muitas outras que podem ser √∫teis ao criar liga√ß√µes complexas da biblioteca C / C ++. </font><font style="vertical-align: inherit;">Tamb√©m contornamos a quest√£o de criar pacotes para diferentes sistemas operacionais, limitando-nos a criar no Linux usando compiladores gcc / g ++.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Refer√™ncias</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira parte do artigo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplos para este artigo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P√°gina inicial do SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o para SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o da API Python / C</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495618/index.html">A quarentena leva a perdas. Como viver sem quarentena?</a></li>
<li><a href="../pt495620/index.html">Montou uma colheitadeira de videoconfer√™ncia em Jabra Panacast, vantagens e desvantagens de escrit√≥rio e casa</a></li>
<li><a href="../pt495622/index.html">Aeronaves do sistema digital de ar condicionado duplo (SLE)</a></li>
<li><a href="../pt495624/index.html">Por que o Xbox Series X ser√° a principal compra de 2020</a></li>
<li><a href="../pt495634/index.html">Todo mundo faz: por que os funcion√°rios s√£o a principal amea√ßa √† seguran√ßa da informa√ß√£o corporativa e como lidar com ela</a></li>
<li><a href="../pt495638/index.html">V√≠rgula em ingl√™s: 5 regras e os 3 principais erros</a></li>
<li><a href="../pt495642/index.html">Comece a coletar erros nas fun√ß√µes de c√≥pia</a></li>
<li><a href="../pt495644/index.html">TS Vista Total. Ferramenta de coleta de eventos, an√°lise de incidentes e automa√ß√£o de respostas a amea√ßas</a></li>
<li><a href="../pt495646/index.html">Quais podcasts n√£o estressantes para ouvir no fim de semana</a></li>
<li><a href="../pt495658/index.html">Onde obter √°udio para aprendizado de m√°quina: uma sele√ß√£o de bibliotecas abertas licenciadas sob Creative Commons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>