<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔱 😢 👻 CSS Houdini教程 ✌🏻 👩🏾‍⚕️ ◽️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="朋友们，美好的一天！
 
 什么是Houdini？
 Houdini（Houdini）-浏览器API的集合，可以显着改善Web开发过程，包括CSS标准的开发。开发人员将能够使用JavaScript扩展CSS，从而影响CSS渲染并告诉浏览器应如何应用样式。与使用多聚体相比，这将显着提高性能和稳定性。
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CSS Houdini教程</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494660/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">朋友们，美好的一天！</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是Houdini？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Houdini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）-浏览器API的集合，可以显着改善Web开发过程，包括CSS标准的开发。</font><font style="vertical-align: inherit;">开发人员将能够使用JavaScript扩展CSS，从而影响CSS渲染并告诉浏览器应如何应用样式。</font><font style="vertical-align: inherit;">与使用多聚体相比，这将显着提高性能和稳定性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini由两个API组组成-高级API和低级API。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
高级API与呈现过程（样式-布局-绘图-合成）相关联。</font><font style="vertical-align: inherit;">该组包括：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paint API-允许您在渲染视觉元素（颜色，背景，边框等）的步骤（即渲染阶段）扩展CSS。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局API-允许您在确定元素的大小，位置和对齐方式的步骤中扩展CSS。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画API-显示和设置元素动画的步骤中的“扩展点”。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
低级API是高级API的基础，包括：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型对象模型API</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义属性和值API</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字体指标API</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作台</font></font></li>
</ul><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS的未来</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini与常规CSS不同，它允许开发人员以更自然的方式扩展CSS。</font><font style="vertical-align: inherit;">这是否意味着CSS规范将停止发展并采用新的标准？</font><font style="vertical-align: inherit;">一点也不。</font><font style="vertical-align: inherit;">Houdini的目标是通过创建可以轻松标准化的工作原型来帮助开发CSS新功能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，开发人员可以轻松共享打开的CSS工作集，而无需担心兼容性。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型对象模型（TOM）API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Houdini之前，JS和CSS交互的唯一方法是将CSS转换为字符串并对其进行修改。</font><font style="vertical-align: inherit;">由于需要对值类型进行两次转换（例如，从数字到字符串，反之亦然），因此手动解析和重新定义样式可能很复杂且容易出错。</font><font style="vertical-align: inherit;">您还必须手动指定新值的度量单位。</font></font><br>
<br>
<pre><code class="javascript hljs">selectedElement.style.fontSize = newFontSize + <span class="hljs-string">'px'</span> <span class="hljs-comment">// newFontSize = 20</span>
<span class="hljs-built_in">console</span>.log(selectedElement.style.fontSize) <span class="hljs-comment">// 20px</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过将CSS属性表示为类型化的JS对象，TOM为CSS属性赋予了更多语义含义。</font><font style="vertical-align: inherit;">这大大提高了性能，稳定性并促进了代码支持。</font><font style="vertical-align: inherit;">CSS值由CSSUnitValue接口表示，该接口由值和``度量单位''属性组成。</font></font><br>
<br>
<pre><code class="javascript hljs">{
  <span class="hljs-attr">value</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">unit</span>: <span class="hljs-string">'px'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该界面可用于以下新功能：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">computeStyleMap（）：用于解析计算（非内置）样式。</font><font style="vertical-align: inherit;">在解析或使用其他方法之前，将调用此方法。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attributeStyleMap：用于解析和修改内联样式。</font><font style="vertical-align: inherit;">这是一个项目属性。</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-comment">//       ( )</span>
selectedElement.computedStyleMap().get(<span class="hljs-string">'font-size'</span>) <span class="hljs-comment">// { value: 20, unit: 'px' }</span><font></font>
<font></font>
<span class="hljs-comment">//   </span>
selectedElement.attributeStyleMap.set(<span class="hljs-string">'font-size'</span>, CSS.em(<span class="hljs-number">2</span>))<font></font>
selectedElement. attributeStyleMap.set(<span class="hljs-string">'color'</span>, <span class="hljs-string">'blue'</span>)<font></font>
<font></font>
<span class="hljs-comment">//    </span>
selectedElement.computedStyleMap().get(<span class="hljs-string">'font-size'</span>) <span class="hljs-comment">// { value: 20, unit: 'px' }</span><font></font>
<font></font>
<span class="hljs-comment">//    </span>
selectedElement.attributeStyleMap.get(<span class="hljs-string">'font-size'</span>) <span class="hljs-comment">// { value: 2, unit: 'em' }</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意分配新值时如何使用CSS类型。</font><font style="vertical-align: inherit;">使用此语法可以避免与类型相关的问题，并且生成的代码变得更加安全。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正在考虑的API不仅包括get和set，还包括其他方法，例如：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清除：删除所有内联样式</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete：删除特定的CSS属性及其值</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有：根据指定属性的可用性返回true / false</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">append：向支持多个值的属性添加额外的值</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></h4><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> selectedElement = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'example'</span>)<font></font>
<font></font>
<span class="hljs-keyword">if</span>(selectedElement.attributeStyleMap){
  <span class="hljs-comment">// ...</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span>(selectedElement.computedStyleMap){
  <span class="hljs-comment">// ...</span><font></font>
}<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作草案</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：发布以供社区讨论。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铬</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歌剧</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火狐浏览器</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苹果浏览器</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义属性和值API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该API允许开发人员通过定义类型，初始值和继承来扩展CSS变量。</font><font style="vertical-align: inherit;">为了定义自定义属性，必须使用registerProperty方法注册它。</font><font style="vertical-align: inherit;">此方法确定浏览器应如何应用属性和处理错误。</font></font><br>
<br>
<pre><code class="javascript hljs">CSS.registerProperty({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'--colorPrimary'</span>,
  <span class="hljs-attr">syntax</span>: <span class="hljs-string">'&lt;color&gt;'</span>,
  <span class="hljs-attr">inherits</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">initialValue</span>: <span class="hljs-string">'blue'</span>,<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
具有以下属性的对象将作为参数传递给此方法：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称：自定义属性的名称</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法：解析指令。</font><font style="vertical-align: inherit;">预定义值是：&lt;颜色&gt;，&lt;整数&gt;，&lt;数字&gt;，&lt;长度&gt;，&lt;百分比&gt;等。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initialValue：默认值（覆盖之前以及发生错误时）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在上面的示例中，定义了&lt;color&gt;类型的自定义属性。</font><font style="vertical-align: inherit;">此属性将用于确定渐变。</font><font style="vertical-align: inherit;">常规CSS不支持渐变过渡。</font><font style="vertical-align: inherit;">注意，如何使用custom属性定义过渡。</font></font><br>
<br>
<pre><code class="javascript hljs">.gradient-box {
  <span class="hljs-attr">background</span>: linear-gradient(<span class="hljs-number">45</span>deg, rgba(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">1</span>) <span class="hljs-number">0</span>% <span class="hljs-keyword">var</span>(--colorPrimary) <span class="hljs-number">60</span>%);<font></font>
  transition: --colorPrimary <span class="hljs-number">0.5</span>s ease;<font></font>
  ...<font></font>
}<font></font>
<font></font>
.gradient-box:hover {<font></font>
  --colorPrimary: red;<font></font>
  ...<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
浏览器不知道如何进行渐变过渡，但知道如何进行颜色过渡。</font><font style="vertical-align: inherit;">这就是为什么我们将属性类型定义为&lt;color&gt;的原因。</font><font style="vertical-align: inherit;">在支持Houdini的浏览器中，将鼠标悬停时将发生渐变更改。</font><font style="vertical-align: inherit;">也可以使用CSS自定义属性（注册为&lt;percentage&gt;）来更改以百分比为单位的渐变位置。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将来可能会在CSS中直接注册自定义属性。</font></font><br>
<br>
<pre><code class="javascript hljs">@property --colorPrimary {
  <span class="hljs-attr">syntax</span>: <span class="hljs-string">'&lt;color&gt;'</span>;<font></font>
  inherits: <span class="hljs-literal">false</span>;<font></font>
  initial-value: blue;<font></font>
}<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个简单的示例说明了如何使用自定义CSS属性更改渐变的颜色和控制点。</font><font style="vertical-align: inherit;">可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到示例代码</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/p4/_n/fnp4_n8vvdfqg3c4xey3vrng-v0.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></h4><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span>(CSS.registeredProperty) {
  <span class="hljs-comment">// ...</span><font></font>
}<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作草案</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：发布以供社区讨论。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铬</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歌剧</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火狐浏览器</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苹果浏览器</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字体指标API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该API处于开发的早期阶段，因此该规范将来可能会发生巨大变化。</font><font style="vertical-align: inherit;">当前，它提供了用于测量屏幕上显示的文本元素大小的方法，从而允许开发人员影响字符的呈现。</font><font style="vertical-align: inherit;">现有的CSS功能不允许您使用这些值或使这项工作非常困难。</font><font style="vertical-align: inherit;">使用此API的一个示例是文本的多行动态截断。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意见征集</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：草稿未发表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不支持浏览器。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorkleta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在继续使用以下API之前，您需要了解Worklet的概念。</font><font style="vertical-align: inherit;">Vorklet是在渲染期间运行的脚本，并且独立于基础JS代码。</font><font style="vertical-align: inherit;">它们扩展了渲染引擎的功能，专为并行执行（2个或更多实例）而设计，不阻塞主线程，对全局范围的访问受限，并且在必要时由引擎调用。</font><font style="vertical-align: inherit;">Vorklet只能通过HTTPS（生产环境）或localhost（出于开发和测试目的）运行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini包含以下扩展浏览器呈现引擎的工作集：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paint Worklet-Paint API</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画作品-动画API</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局工作簿-布局API</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绘画API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paint API允许开发人员使用JS函数通过2D渲染上下文（它是HTML5 Canvas API的子集）来绘制元素的背景，边框或内容。</font><font style="vertical-align: inherit;">Paint API使用Paint Worklet绘制图像，该图像取决于CSS的更改（例如CSS变量的更改）。</font><font style="vertical-align: inherit;">那些熟悉Canvas API的人将会对Paint API感到宾至如归。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建Paint Worklet包含几个步骤：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用registerPaint函数编写和注册工作集</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用CSS.paintWorklet.addModule调用HTML或JS中的工作表</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在CSS中使用paint（）方法以及vorklet的名称和传递的参数</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下registerPaint函数，该函数用于注册和确定Paint Worklet的功能。</font></font><br>
<br>
<pre><code class="javascript hljs">registerPaint(<span class="hljs-string">'paintWorkletExample'</span>, <span class="hljs-class"><span class="hljs-keyword">class</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">inputProperties</span>() { <span class="hljs-keyword">return</span> [<span class="hljs-string">'--myVariable'</span>]; }
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">inputArguments</span>() { <span class="hljs-keyword">return</span> [<span class="hljs-string">'&lt;color&gt;'</span>]; }
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">contextOptions</span>() { <span class="hljs-keyword">return</span> {<span class="hljs-attr">alpha</span>: <span class="hljs-literal">true</span>} }<font></font>
<font></font>
  paint(ctx, size, properties, args) {<font></font>
    <span class="hljs-comment">// ...</span><font></font>
  }<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
registerPaint函数由以下部分组成：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inputProperties：工作项正在观察的自定义CSS属性的数组。</font><font style="vertical-align: inherit;">该数组表示工作项的依赖关系</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inputArguments：可以从函数传递到外部CSS的参数数组</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contextOptions：颜色透明度。</font><font style="vertical-align: inherit;">如果为假，则所有颜色将完全不透明</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paint：主要功能，采用以下参数：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctx：2D绘图上下文，几乎与Canvas API的2D画布上下文相同</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">size：具有元素宽度和高度的对象。</font><font style="vertical-align: inherit;">值取决于布局渲染过程。</font><font style="vertical-align: inherit;">画布大小与实际商品大小相同</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性：inputProperties中包含的变量</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">args：传递给paint函数的参数数组</font></font></li>
</ul></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注册工作文件后，必须以HTML调用它，指示文件的路径。</font></font><br>
<br>
<pre><code class="javascript hljs">CSS.paintWorklet.addModule(<span class="hljs-string">'path/to/worklet/file.js'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以从任何外部来源（例如，从CDN）添加Vorklet，这使其成为模块化且可重复使用。</font></font><br>
<br>
<pre><code class="javascript hljs">CSS.paintWorklet.addModule(<span class="hljs-string">'https://url/to/worklet/file.js'</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
调用工作件后，可以使用“ paint”功能在CSS中使用它。</font><font style="vertical-align: inherit;">此函数作为第一个参数，采用vorklet的注册名称以及在inputArguments中指定的所有参数。</font><font style="vertical-align: inherit;">从这一刻起，浏览器就知道何时调用工作集以及哪些用户操作导致CSS自定义属性的某些值发生更改。</font></font><br>
<br>
<pre><code class="javascript hljs">.example-element {
  <span class="hljs-comment">// paintWorkletExample -  </span>
  <span class="hljs-comment">// blue - ,  </span>
  <span class="hljs-attr">background</span>: paint(paintWorkletExample, blue);<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下面的示例演示了Paint API的用法以及工作集的模块化和重用。</font><font style="vertical-align: inherit;">它使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Chrome Labs存储库中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的涟漪工作表</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看示例代码</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u3/yk/2y/u3yk2yldoyuza04pdyyz1zbxs-u.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></h4><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span>(‘paintWorklet’ <span class="hljs-keyword">in</span> CSS){
  <span class="hljs-comment">// …</span><font></font>
}<font></font>
<font></font>
@supports(background: paint(paintWorkletExample)){<font></font>
  <span class="hljs-comment">// …</span>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建议</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：稳定的工作草案，随时可用。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铬</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歌剧</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火狐浏览器</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苹果浏览器</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持者</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该API通过处理各种事件（滚动，悬停，单击等）扩展了Web动画，并通过动画工作集以自己的流形式启动动画来提高性能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
像其他任何工作区一样，必须首先注册锻炼动画。</font></font><br>
<br>
<pre><code class="javascript hljs">registerAnimation(‘animationWorkletExample’, <span class="hljs-class"><span class="hljs-keyword">class</span> </span>{
  <span class="hljs-keyword">constructor</span>(options){
    <span class="hljs-comment">// …</span><font></font>
  }<font></font>
  animate(currentTime, effect){<font></font>
    <span class="hljs-comment">// …</span><font></font>
  }<font></font>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此类包含两个功能：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数：在创建新实例时调用。</font><font style="vertical-align: inherit;">用于常规设置。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画：包含动画逻辑的主要功能。</font><font style="vertical-align: inherit;">接受以下参数：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentTime：特定时间轴上的时间戳</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">效果：动画中使用的一系列效果</font></font></li>
</ul></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注册后，该工作集将包含在主JS文件中，并添加了动画（元素，框架，设置）并将其附加到时间轴上。</font><font style="vertical-align: inherit;">下一节将介绍时间轴标记的概念和网络动画的基础。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//   </span>
<span class="hljs-keyword">await</span> CSS.animationWorklet.addModule(‘path/to/worklet/file.js’)<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-keyword">const</span> elementExample = <span class="hljs-built_in">document</span>.getElementById(‘element-example’)<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">const</span> effectExample = <span class="hljs-keyword">new</span> KeyframeEffect(<font></font>
  elementExample, <span class="hljs-comment">//  </span>
  [ <span class="hljs-comment">// … ], //  </span>
  { <span class="hljs-comment">// … } //  - , ,    ..</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-keyword">new</span> WorkletAnimation(<font></font>
  ‘animationWorkletExample’ <span class="hljs-comment">//  </span>
  effectExample, <span class="hljs-comment">//  </span>
  <span class="hljs-built_in">document</span>.timeline, <span class="hljs-comment">//  </span>
  {},  <span class="hljs-comment">//   </span>
).play()</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时标</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Web动画基于时间戳-动画时间表上效果的里程碑。</font><font style="vertical-align: inherit;">例如，我们分析了一个重复的线性动画，该动画由三个帧（开始，中间，结尾）组成，在页面完全加载（延迟）后1秒开始，持续4秒。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
效果的时间戳将如下所示（对于持续4秒且没有延迟的动画）：</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时标</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画框架</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一帧-动画的开始</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二帧-动画的中间</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后一帧-动画结束或重置为第一帧</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
值为3000ms（给定延迟为1000ms）的effect.localTime会将动画绑定到时间轴上的平均帧（1000ms延迟+ 2000ms平均帧）。</font><font style="vertical-align: inherit;">设置7000ms和11000ms时将获得相同的效果，因为动画每4000ms重复一次。</font></font><br>
<br>
<pre><code class="javascript hljs">animate(currentTime, effect){<font></font>
  effect.localTime = <span class="hljs-number">3000</span> <span class="hljs-comment">// 1000ms  + 2000ms  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用effect.localTime的恒定值，动画将锁定在特定帧上。</font><font style="vertical-align: inherit;">因此，effect.localTime的值应更改。</font><font style="vertical-align: inherit;">该值应该是绑定到currentTime或另一个变量的函数。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
线性动画代码如下所示：</font></font><br>
<br>
<pre><code class="javascript hljs">animate(currentTime, effect){<font></font>
  effect.localTime = currentTime <span class="hljs-comment">// y = x  </span>
}</code></pre><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时间轴（document.timeline）</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时间戳记</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">帧</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 0ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 0ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 1000ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 1000ms（延迟）+ 0ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 3000ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开始时间+ 1000毫秒（延迟）+ 2000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中间</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 5000ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开始时间+ 1000毫秒（延迟）+ 4000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后/第一</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 7000ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开始时间+ 1000毫秒（延迟）+ 6000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中间</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startTime + 9000ms（经过的时间）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开始时间+ 1000毫秒（延迟）+ 8000毫秒</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后/第一</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
时间戳不限于1：1。</font><font style="vertical-align: inherit;">动画API允许开发人员使用标准JS函数创建复杂的效果，通过动画函数来操纵标记。</font><font style="vertical-align: inherit;">动画也可以在每次迭代中变化（具有可重复的动画）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
动画不仅可以与文档加载相关联，还可以与用户操作相关联。</font><font style="vertical-align: inherit;">可以通过ScrollTimeline对象在动画中使用诸如滚动页面之类的用户操作。</font><font style="vertical-align: inherit;">例如，动画可以在滚动200像素时开始，而在滚动800像素时结束。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> scrollTimelineExample = <span class="hljs-keyword">new</span> ScrollTimeline({
  <span class="hljs-attr">scrollSource</span>: scrollElement, <span class="hljs-comment">// ,     </span>
  <span class="hljs-attr">orientation</span>: ‘vertical’, <span class="hljs-comment">//  </span>
  <span class="hljs-attr">startScrollOffset</span>: ‘<span class="hljs-number">200</span>px’, <span class="hljs-comment">//  </span>
  <span class="hljs-attr">endScrollOffset</span>: ‘<span class="hljs-number">800</span>px’, <span class="hljs-comment">//  </span>
  <span class="hljs-attr">timeRange</span>: <span class="hljs-number">1200</span>, <span class="hljs-comment">//  </span>
  <span class="hljs-attr">fill</span>: ‘forwards’ <span class="hljs-comment">//  </span>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
动画会自动适应滚动速度，同时保持平滑和响应。</font><font style="vertical-align: inherit;">由于动画在其自己的流中运行并连接到浏览器渲染引擎，因此动画可以平稳启动并且不会影响性能。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下面的示例演示非线性动画。</font><font style="vertical-align: inherit;">它使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高斯函数，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并在此前后同时旋转。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看示例代码</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hq/aw/es/hqawes_i_8t4arxvc3-7mo-ouqc.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></h4><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span>(CSS.animationWorklet){
  <span class="hljs-comment">// …</span>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一份公共工作草案</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：准备进行社区讨论，将来可能会发生变化。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铬</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歌剧</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火狐浏览器</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苹果浏览器</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layout API允许开发人员通过定义要在CSS“ display”属性中使用的新模块来扩展布局渲染过程。</font><font style="vertical-align: inherit;">该API引入了新概念，非常复杂，并且提供了大量设置来开发用于处理页面布局的自定义算法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，需要注册一个Worklet。</font></font><br>
<br>
<pre><code class="javascript hljs">registerLayout(‘exampleLayout’, <span class="hljs-class"><span class="hljs-keyword">class</span></span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">inputProperties</span>() { <span class="hljs-keyword">return</span> [‘--example-variable’] }<font></font>
<font></font>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">childrenInputProperties</span>() { <span class="hljs-keyword">return</span> [‘--exampleChildVariable’] }<font></font>
<font></font>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> <span class="hljs-title">layoutOptions</span>(){
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">childDisplay</span>: ‘normal’,
      <span class="hljs-attr">sizing</span>: ‘block-like’<font></font>
    }<font></font>
  }<font></font>
<font></font>
  intrinsicSizes(children, edges, styleMap){<font></font>
    <span class="hljs-comment">// …</span><font></font>
  }<font></font>
<font></font>
  layout(children, edges, constraints, styleMap, breakToken){<font></font>
    <span class="hljs-comment">// …</span><font></font>
  }<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注册工作簿包括以下方法：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inputProperties：工作集正在观察并属于父级的自定义CSS属性的数组，父属性是导致布局呈现的元素。</font><font style="vertical-align: inherit;">此数组表示布局依赖性</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">childrenInputProperties：小部件监视的属于后代的自定义CSS属性的数组</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">layoutOptions：定义以下布局属性：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">childDisplay：预定义的值是block和normal。</font><font style="vertical-align: inherit;">定义项目的显示方式（块或行）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大小：预定义值是块状和手动的。</font><font style="vertical-align: inherit;">确定是否需要初步计算元素大小（如果未指定）</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nativeSizes：定义如何在布局上下文中显示容器或其内容：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">children：导致页面布局呈现的元素的子元素</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘：容器边界</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">styleMap：键入的容器样式对象模型</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">layout：使用布局的主要功能：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子元素：子元素</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘：边框</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">约束：父布局施加的约束</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">styleMap：键入的容器样式对象模型</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">breakToken：分页或打印布局拆分的断点</font></font></li>
</ul></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，将工作项添加到HTML或JS文件。</font></font><br>
<br>
<pre><code class="javascript hljs">CSS.layoutWorklet.addModule(‘path/to/worklet/file.js’)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们用样式链接到文件中的工作项。</font></font><br>
<br>
<pre><code class="javascript hljs">.example-element {
  <span class="hljs-attr">display</span>: layout(exampleLayout)<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局API如何与布局一起使用</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在前面的示例中，我们定义了exampleLayout。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
.example-element称为父级布局，包括缩进，边框和滚动滑块。</font><font style="vertical-align: inherit;">父布局由称为当前布局的子元素组成。</font><font style="vertical-align: inherit;">当前布局是目标元素，其布局是使用Layout API“自定义”的。</font><font style="vertical-align: inherit;">例如，当使用“ display：flex”时，元素的后代会根据灵活的布局进行重新排列。</font><font style="vertical-align: inherit;">这类似于Layout API的操作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当前的每个布局都包含子布局，这些子布局包含用于渲染子元素LayoutChild的算法（包括伪类:: before和:: after）。</font><font style="vertical-align: inherit;">LayoutChild-由CSS生成的容器，其中包含样式数据（不包含布局数据）。</font><font style="vertical-align: inherit;">浏览器会在应用样式阶段自动创建LayoutChild元素。</font><font style="vertical-align: inherit;">子布局可以创建一个Fragment，其中包含用于渲染布局的指令。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此示例还使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了Google Chrome Labs存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是文本被替换为图像。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看示例代码</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/ft/b_/ypftb_-lievo3nmpij1lidenius.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></h4><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span>(CSS.layoutWorklet){
  <span class="hljs-comment">// …</span>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规格状态</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一份公共工作草案</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：准备进行社区讨论，将来可能会发生变化。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铬</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">边缘</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歌剧</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">火狐浏览器</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苹果浏览器</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">胡迪尼和不断进步</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管Houdini当前没有最佳的浏览器支持，但可以将其用于逐步改进。</font><font style="vertical-align: inherit;">如果您不熟悉渐进式改进的概念，建议您阅读</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用Houdini时，应考虑以下几点：</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始终确定支持以避免错误。</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个Houdini API和Worklet都有一种检查可用性的简便方法。</font><font style="vertical-align: inherit;">这样可以避免在尚不支持该技术的浏览器中使用Houdini的问题。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Houdini改善显示和可视化效果。</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用不支持Houdini的浏览器的用户应有权访问该网站的内容和基本功能。</font><font style="vertical-align: inherit;">用户体验和内容显示不应依赖Houdini。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用标准CSS作为替代</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，自定义CSS属性可以用作自定义属性和值API的替代方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
专注于开发生产和可靠的应用程序，将Houdini用于装饰目的只是一种渐进的改进。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini允许开发人员在渲染过程中使用JS代码处理样式，从而提高应用程序性能和稳定性。在呈现过程中嵌入代码的功能使您可以创建易于与他人共享，应用甚至可能包含在规范中的CSS多义词。此外，Houdini允许开发人员和设计人员在使用样式，布局和动画时减少对CSS限制的依赖。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houdini现在可以使用，但只能作为逐步的改进。这将允许不支持Houdini的浏览器显示页面而不会出现错误，从而提供最佳的用户体验。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我等不及开发人员社区才能充分享受Houdini的功能。以下是几个示例：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS Houdini过期CSS Houdini </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交互式介绍Houdini </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Chrome实验室的示例</font></font></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Houdini </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Houdini </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">规范的W3C草案</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">（Chrome Dev Summit 2018）</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动画工作集-Google Developers</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
感谢您的关注。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN494646/index.html">分析主管的生活或“我认为您会自己做”</a></li>
<li><a href="../zh-CN494648/index.html">我们分析了GOST R 53894-2016“知识管理”的问题。术语和定义”</a></li>
<li><a href="../zh-CN494650/index.html">在语言的所有单词中搜索字词和变音符号</a></li>
<li><a href="../zh-CN494652/index.html">ACID有多少营销？</a></li>
<li><a href="../zh-CN494658/index.html">在Laravel中使用特征进行多态关系</a></li>
<li><a href="../zh-CN494662/index.html">我们的空间-太糟糕了吗？</a></li>
<li><a href="../zh-CN494664/index.html">实施安全流程如何帮助过渡到远程工作</a></li>
<li><a href="../zh-CN494666/index.html">音频人的发现：在哪里聆听过去时代的音乐</a></li>
<li><a href="../zh-CN494668/index.html">强大的Typescript装饰器-它们如何工作，被编译成什么以及适用于哪些应用程序任务</a></li>
<li><a href="../zh-CN494670/index.html">交叉口观察员API案例研究</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>