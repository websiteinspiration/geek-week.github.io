<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí¨ üî´ üßëüèº Wie seltsamer Code verbirgt Fehler? TensorFlow.NET-Analyse üë©üèæ‚Äçüé§ üâë üë®‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die statische Analyse ist ein √§u√üerst n√ºtzliches Werkzeug f√ºr jeden Entwickler, da sie hilft, nicht nur Fehler, sondern auch verd√§chtige und seltsame ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wie seltsamer Code verbirgt Fehler? TensorFlow.NET-Analyse</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/496250/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/bb4/d84/765bb4d84187d986358a301bbeed082f.png" alt="TensorFlow.NET und PVS-Studio"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die statische Analyse ist ein √§u√üerst n√ºtzliches Werkzeug f√ºr jeden Entwickler, da sie hilft, nicht nur Fehler, sondern auch verd√§chtige und seltsame Codeteile rechtzeitig zu finden, die f√ºr Programmierer, die in Zukunft mit ihm arbeiten m√ºssten, Verwirrung stiften k√∂nnen. Diese Idee wird durch eine Analyse des offenen C # -Projekts von TensorFlow.NET demonstriert, das f√ºr die Zusammenarbeit mit der beliebten TensorFlow-Bibliothek f√ºr maschinelles Lernen entwickelt wird.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hei√üe Nikita Lipilin. </font><font style="vertical-align: inherit;">Vor einiger Zeit bin ich in die C # -Programmiererabteilung von PVS-Studio eingetreten. </font><font style="vertical-align: inherit;">Traditionell schreiben alle Neulinge im Team Artikel, in denen die Ergebnisse der √úberpr√ºfung verschiedener offener Projekte mit dem statischen Analyseger√§t PVS-Studio erl√§utert werden. </font><font style="vertical-align: inherit;">Solche Artikel helfen neuen Mitarbeitern, das Produkt besser kennenzulernen, und bieten gleichzeitig zus√§tzliche Vorteile bei der Verbreitung der statischen Analysemethode. </font><font style="vertical-align: inherit;">Ich schlage vor, dass Sie sich mit meiner ersten Arbeit zum Thema Analyse offener Projekte vertraut machen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vielzahl m√∂glicher Fehler im Programmcode ist erstaunlich. Einige von ihnen zeigen sich sofort bei einer Oberfl√§chenuntersuchung der erstellten Anwendung, andere k√∂nnen selbst bei einer Code√ºberpr√ºfung durch ein Team erfahrener Entwickler schwer zu bemerken sein. Es kommt jedoch auch vor, dass der Programmierer aus Unaufmerksamkeit oder aus anderen Gr√ºnden manchmal einfach seltsamen und unlogischen Code schreibt, der seine Funktion jedoch (scheinbar) erfolgreich erf√ºllt. Aber nur weiter, wenn wir zu dem zur√ºckkehren, was geschrieben wurde, oder wenn andere diesen Code studieren, tauchen Fragen auf, die nicht beantwortet werden k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Refactoring von altem Code kann zu Problemen f√ºhren, insbesondere wenn andere Teile des Programms davon abh√§ngen. Wenn Sie also selbst einige offen gekr√ºmmte Konstruktionen finden, funktioniert das "Funktioniert es?" Fass es nicht an! ‚Ä≥. In der Folge macht es dies schwierig, die Quelle zu untersuchen, und daher wird es schwierig, die verf√ºgbaren F√§higkeiten zu erweitern. Die Codebasis ist verstopft. Es besteht die Wahrscheinlichkeit, dass ein kleines und unsichtbares, aber m√∂glicherweise sehr unangenehmes internes Problem nicht rechtzeitig behoben wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Irgendwann werden die Konsequenzen dieses Fehlers zu sp√ºren sein, aber seine Suche wird viel Zeit in Anspruch nehmen, da der Verdacht des Entwicklers auf eine gro√üe Anzahl seltsamer Codefragmente f√§llt, die nicht gleichzeitig √ºberarbeitet wurden. Daraus folgt, dass verschiedene Probleme und Kuriosit√§ten in einem bestimmten Fragment unmittelbar nach seinem Schreiben behoben werden sollten. In dem Fall, in dem es vern√ºnftige Gr√ºnde gibt, alles so zu belassen, wie es ist (z. B. wenn der Code als eine Art Leerzeichen "f√ºr sp√§ter" geschrieben ist), sollte einem solchen Fragment ein erl√§uternder Kommentar beigef√ºgt werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist auch erw√§hnenswert, dass unabh√§ngig von der Qualifikation des Entwicklers einige problematische und einfach erfolglose Momente aus seinem Blick verschwinden k√∂nnen und manchmal an einer Stelle eine ‚Äûvor√ºbergehende L√∂sung‚Äú angewendet werden kann, die bald vergessen wird und ‚Äûdauerhaft‚Äú wird. Anschlie√üend wird die Analyse eines solchen Codes (h√∂chstwahrscheinlich wird ein anderer Entwickler daran beteiligt sein) inakzeptabel viel Aufwand erfordern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In solchen F√§llen kann die Code√ºberpr√ºfung hilfreich sein. Wenn die Aufgabe jedoch sehr ernst ist, ben√∂tigt diese Option viel Zeit. Wenn viele kleine Fehler oder M√§ngel vorliegen, bemerkt der Pr√ºfer m√∂glicherweise keine Fehler auf hoher Ebene. Das √úberpr√ºfen des Codes wird zu einer m√ºhsamen Routine, und die Wirksamkeit der √úberpr√ºfung nimmt allm√§hlich ab.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Offensichtlich werden Routineaufgaben viel besser von Person zu Computer √ºbertragen. Dieser Ansatz wird in vielen Bereichen der Moderne angewendet. Die Automatisierung verschiedener Prozesse ist der Schl√ºssel zum Wohlstand. Was ist Automatisierung im Kontext dieses Themas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein zuverl√§ssiger Assistent bei der L√∂sung des Problems, vern√ºnftigen und stabilen Arbeitscode zu schreiben, ist die statische Analyse. Jedes Mal, bevor der Programmierer die Ergebnisse seiner Aktivit√§ten an die √úberpr√ºfung sendet, kann er eine automatisierte √úberpr√ºfung durchf√ºhren und andere Entwickler (und sich selbst) nicht mit unn√∂tiger Arbeit belasten. Der Code wird erst zur √úberpr√ºfung gesendet, nachdem alle Warnungen des Analysators ber√ºcksichtigt wurden: Fehler wurden behoben und seltsame Momente wurden neu geschrieben oder zumindest durch einen Kommentar erkl√§rt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich verschwindet die Notwendigkeit der Code√ºberpr√ºfung nicht, aber die statische Analyse erg√§nzt und vereinfacht die Implementierung erheblich. </font><font style="vertical-align: inherit;">Ein ausreichend gro√üer Teil der Fehler wird dank des Analysators behoben, und seltsame Momente werden definitiv nicht vergessen und entsprechend markiert. </font><font style="vertical-align: inherit;">Dementsprechend wird es bei einer Code√ºberpr√ºfung m√∂glich sein, sich darauf zu konzentrieren, die Richtigkeit der Implementierung komplexer logischer Interaktionen zu √ºberpr√ºfen und zugrunde liegende Probleme zu finden, die vom Analysator (bisher) leider nicht erkannt werden k√∂nnen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow.NET</font></font></h2><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d02/39d/72d/d0239d72ded7154a696d5c975a0555d1.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel ist vom TensorFlow.NET-Projekt inspiriert. Es stellt die Implementierung der F√§higkeit dar, mit der Funktionalit√§t der beliebten TensorFlow-Bibliothek f√ºr maschinelles Lernen √ºber C # -Code zu arbeiten (wir haben </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºbrigens auch </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">getestet</font></a><font style="vertical-align: inherit;"> ). Diese Idee schien ziemlich interessant zu sein, da zum Zeitpunkt des Schreibens die Arbeit mit der Bibliothek nur in Python, Java und Go verf√ºgbar ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verf√ºgbare Quellcode </font><font style="vertical-align: inherit;">wird st√§ndig aktualisiert und hat jetzt ein Volumen von etwas mehr als hunderttausend Zeilen. Nach einer oberfl√§chlichen Untersuchung bestand der Wunsch, eine √úberpr√ºfung mittels statischer Analyse durchzuf√ºhren. PVS-Studio wurde als spezifisches Tool verwendet, das sich in einer relativ gro√üen Anzahl </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verschiedener Projekte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bew√§hrt hat </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/261/70b/247/26170b247e9b81a3643bd5682b7d5203.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr TensorFlow.NET zeigte der Analysator eine Reihe von Warnungen an: 39 Hohe Stufen, 227 Mittlere Stufen und 154 Niedrige Stufen (Informationen zu Warnstufen finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Unterabschnitt ‚ÄûWarnstufen und Diagnoseregels√§tze‚Äú). Eine detaillierte Analyse von jedem von ihnen w√ºrde diesen Artikel gigantisch machen, daher werden im Folgenden nur diejenigen beschrieben, die mir am interessantesten erschienen. Es ist auch erw√§hnenswert, dass einige der gefundenen Probleme mehrmals im Projekt auftreten und die Analyse jedes solchen Codes √ºber den Rahmen dieses Artikels hinausgeht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Projekt stellt sich einer ziemlich ernsten Aufgabe, und leider ist das Auftreten verschiedener Arten von seltsamen Codefragmenten unvermeidlich. </font><font style="vertical-align: inherit;">In diesem Artikel werde ich versuchen zu zeigen, dass die Verwendung der statischen Analyse die Arbeit von Programmierern erheblich vereinfachen kann, indem ich auf Bereiche verweise, die Fragen verursachen k√∂nnen. </font><font style="vertical-align: inherit;">Nicht immer weist eine Warnung auf einen Fehler hin, aber h√§ufig weist sie auf einen Code hin, der bei einer Person Fragen verursachen w√ºrde. </font><font style="vertical-align: inherit;">Dementsprechend ist die Wahrscheinlichkeit, dass ein seltsamer Code entweder neu gestaltet oder auf jeden Fall entsprechend kommentiert wird, erheblich erh√∂ht.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmente, die beim Studium des Analysatorberichts Aufmerksamkeit erregt haben</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tats√§chlich kann eine ziemlich gro√üe Anzahl von Analysatorwarnungen f√ºr dieses Projekt nicht als so viele Fehler, sondern als seltsamer Code bezeichnet werden. Beim Betrachten von Zeilen, f√ºr die eine Warnung ausgegeben wird, tritt zumindest Verwirrung auf. Nat√ºrlich sind einige der folgenden Beispiele wahrscheinlich "vor√ºbergehende L√∂sungen", aber sie geben keine Kommentare zu diesem Problem ab. Dies bedeutet, dass jemand, der in Zukunft mit diesem Code arbeiten wird, Fragen hat und nach Antworten sucht wird zus√§tzliche Zeit in Anspruch nehmen.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/3fc/e7c/2633fce7cba470cd8a0c16e6751b3513.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig weisen einige Warnungen auf Code hin, der offensichtlich nicht nur seltsam, sondern auch falsch ist. </font><font style="vertical-align: inherit;">Dies ist die Hauptgefahr von "seltsamem Code" - es ist √§u√üerst schwierig, einen echten Fehler zu bemerken, wenn Sie hier und da seltsame L√∂sungen sehen und sich allm√§hlich daran gew√∂hnen, dass der Code falsch zu sein scheint.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anspruchsvolle Sammeltour</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> _RemoveDefaultAttrs(....)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
  producer_op_list.Op.Select(op =&gt;<font></font>
  {<font></font>
    producer_op_dict[op.Name] = op;<font></font>
    <span class="hljs-keyword">return</span> op;<font></font>
  }).ToArray();           <font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysator Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Der R√ºckgabewert der Funktion 'ToArray' muss verwendet werden. importer.cs 218 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Analysator betrachtet den Aufruf von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an dieser Stelle als verd√§chtig, da der von dieser Funktion zur√ºckgegebene Wert keiner Variablen zugewiesen ist. Ein solcher Code ist jedoch kein Fehler. Dieses Konstrukt wird verwendet, um das W√∂rterbuch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Producer_op_dict</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit </font><font style="vertical-align: inherit;">Werten zu f√ºllen, die den Elementen der Liste </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Producer_op_list.Op entsprechen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ein Aufruf von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray ist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erforderlich, damit die als Argument an die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Methode √ºbergebene Funktion </font><font style="vertical-align: inherit;">f√ºr alle Elemente in der Auflistung aufgerufen wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meiner Meinung nach sieht der Code nicht gut aus. </font><font style="vertical-align: inherit;">Das Ausf√ºllen des W√∂rterbuchs ist etwas offensichtlich, und einige Entwickler m√∂chten m√∂glicherweise den "unn√∂tigen" Aufruf von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray entfernen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es w√§re viel einfacher und verst√§ndlicher, die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foreach-Schleife</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hier zu verwenden </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
<font></font>
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> op <span class="hljs-keyword">in</span> producer_op_list.Op)<font></font>
{<font></font>
  producer_op_dict[op.Name] = op;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall sieht der Code so einfach wie m√∂glich aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderer √§hnlicher Moment sieht so aus:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  inference_graph.Node.Select(x =&gt; map_name_to_node[x.Name] = x).ToArray();<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysator Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Der R√ºckgabewert der Funktion 'ToArray' muss verwendet werden. </font><font style="vertical-align: inherit;">graph_util_impl.cs 48 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einzige Unterschied besteht darin, dass ein solcher Datensatz pr√§gnanter aussieht, aber nur die Versuchung, den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufruf </font><font style="vertical-align: inherit;">hier </font><font style="vertical-align: inherit;">zu entfernen, </font><font style="vertical-align: inherit;">nicht verschwindet und immer noch nicht offensichtlich ist.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vor√ºbergehende L√∂sung</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> source_op_name = get_input_name(node);
  <span class="hljs-keyword">while</span>(map_name_to_node[source_op_name].Op == <span class="hljs-string">"Identity"</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException);<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer-Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ein bedingungsloser "Wurf" innerhalb einer Schleife. graph_util_impl.cs 73 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dem betrachteten Projekt wird h√§ufig der folgende Ansatz verwendet: Wenn ein bestimmtes Verhalten sp√§ter implementiert werden sollte, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an der entsprechenden Stelle eine </font><i><font style="vertical-align: inherit;">NotImplementedException</font></i><font style="vertical-align: inherit;"> ausgel√∂st </font><font style="vertical-align: inherit;">. Es ist klar, warum der Analysator vor einem m√∂glichen Fehler in diesem Artikel warnt: Die Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anstelle von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sieht nicht wirklich vern√ºnftig aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist nicht die einzige Warnung, die aufgrund der Verwendung tempor√§rer L√∂sungen angezeigt wird. Zum Beispiel gibt es eine Methode:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _SoftmaxCrossEntropyWithLogitsGrad(<font></font>
  Operation op, Tensor[] grads<font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> grad_loss = grads[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> grad_grad = grads[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> softmax_grad = op.outputs[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> grad = _BroadcastMul(grad_loss, softmax_grad);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> logits = op.inputs[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span>(grad_grad != <span class="hljs-literal">null</span> &amp;&amp; !IsZero(grad_grad)) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"_SoftmaxCrossEntropyWithLogitsGrad"</span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[] <font></font>
  {<font></font>
    grad,<font></font>
    _BroadcastMul(grad_loss, -nn_ops.log_softmax(logits))<font></font>
  };<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysator Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ausdruck 'grad_grad! = Null &amp;&amp;! IsZero (grad_grad)' ist immer falsch. </font><font style="vertical-align: inherit;">nn_grad.cs 93 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tats√§chlich wird eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException ("_ SoftmaxCrossEntropyWithLogitsGrad")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> niemals ausgel√∂st, da dieser Code einfach nicht erreichbar ist. </font><font style="vertical-align: inherit;">Um den Grund zu ermitteln, m√ºssen Sie zum Code der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsZero-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion gehen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsZero</span>(<span class="hljs-params">Tensor g</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>[] { <span class="hljs-string">"ZerosLike"</span>, <span class="hljs-string">"Zeros"</span> }.Contains(g.op.type))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"IsZero"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Methode gibt entweder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true zur√ºck</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder l√∂st eine Ausnahme aus. </font><font style="vertical-align: inherit;">Dieser Code ist kein Fehler - die Implementierung hier bleibt nat√ºrlich f√ºr sp√§ter. </font><font style="vertical-align: inherit;">Die Hauptsache ist, dass "dann" wirklich angekommen ist. </font><font style="vertical-align: inherit;">Nun, es hat sich sehr erfolgreich herausgestellt, dass PVS-Studio Sie nicht vergessen l√§sst, dass es hier eine solche Unvollkommenheit gibt :)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist Tensor Tensor?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Tensor[] _ExtractInputShapes(Tensor[] inputs)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> sizes = <span class="hljs-keyword">new</span> Tensor[inputs.Length];
  <span class="hljs-keyword">bool</span> fully_known = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inputs.Length; i++)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> x = inputs[i];<font></font>
<font></font>
    <span class="hljs-keyword">var</span> input_shape = array_ops.shape(x);
    <span class="hljs-keyword">if</span> (!(input_shape <span class="hljs-keyword">is</span> Tensor) || input_shape.op.type != <span class="hljs-string">"Const"</span>)<font></font>
    {<font></font>
      fully_known = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
<font></font>
    sizes[i] = input_shape;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysator Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eine √ºberm√§√üige Typpr√ºfung. </font><font style="vertical-align: inherit;">Das Objekt ist bereits vom Typ 'Tensor'. </font><font style="vertical-align: inherit;">array_grad.cs 154 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der R√ºckgabetyp des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formverfahrens</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">input_shape ist also Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Check </font><font style="vertical-align: inherit;">sieht zumindest komisch aus. </font><font style="vertical-align: inherit;">Sobald die Methode einen Wert eines anderen Typs zur√ºckgegeben hat und die √úberpr√ºfung sinnvoll war, ist es m√∂glicherweise auch m√∂glich, dass die Bedingung anstelle von Tensor eine Art Erbe dieser Klasse angibt. </font><font style="vertical-align: inherit;">Auf die eine oder andere Weise sollte der Entwickler auf dieses Fragment achten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gr√ºndliche √úberpr√ºfung</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _BaseFusedBatchNormGrad(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> results = grad_fun(<span class="hljs-keyword">new</span> FusedBatchNormParams<font></font>
  {<font></font>
    YBackprop = grad_y,<font></font>
    X = x,<font></font>
    Scale = scale,<font></font>
    ReserveSpace1 = pop_mean,<font></font>
    ReserveSpace2 = pop_var,<font></font>
    ReserveSpace3 = version == <span class="hljs-number">2</span> ? op.outputs[<span class="hljs-number">5</span>] : <span class="hljs-literal">null</span>,<font></font>
    Epsilon = epsilon,<font></font>
    DataFormat = data_format,<font></font>
    IsTraining = is_training<font></font>
  });<font></font>
<font></font>
  <span class="hljs-keyword">var</span> (dx, dscale, doffset) = (results[<span class="hljs-number">0</span>], results[<span class="hljs-number">1</span>], results[<span class="hljs-number">2</span>]);
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warnungen des Analysators</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es gibt zwei ' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">if'</font></a><font style="vertical-align: inherit;"> -Anweisungen mit identischen bedingten Ausdr√ºcken. </font><font style="vertical-align: inherit;">Die erste 'if'-Anweisung enth√§lt die Methodenr√ºckgabe. </font><font style="vertical-align: inherit;">Dies bedeutet, dass die zweite 'if'-Anweisung sinnlos ist. Nn_grad.cs 230</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022 Der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ausdruck 'data_format == "NCHW"' ist immer falsch. </font><font style="vertical-align: inherit;">nn_grad.cs 247</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Gegensatz zu einigen der vorherigen Beispiele stimmt der Code eindeutig nicht. </font><font style="vertical-align: inherit;">Die zweite Pr√ºfung macht keinen Sinn, da die Ausf√ºhrung des Programms die Bedingung √ºberhaupt nicht erreicht, wenn sie erf√ºllt ist. </font><font style="vertical-align: inherit;">Vielleicht ist hier ein Tippfehler erlaubt, oder eine der Pr√ºfungen ist im Allgemeinen √ºberfl√ºssig.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Illusion der Wahl</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Tensor <span class="hljs-title">Activate</span>(<span class="hljs-params">Tensor x, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  ....<font></font>
  Tensor negative_part;<font></font>
  <span class="hljs-keyword">if</span> (Math.Abs(_threshold) &gt; <span class="hljs-number">0.000001f</span>)<font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  } <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer-Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Anweisung 'then' entspricht der Anweisung 'else'. gen_nn_ops.activations.cs 156 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine ziemlich am√ºsante Demonstration der Wirksamkeit der Verwendung statischer Analysen in der Entwicklung. Es ist schwierig, einen vern√ºnftigen Grund zu finden, warum der Entwickler diesen bestimmten Code geschrieben hat - h√∂chstwahrscheinlich handelt es sich um einen typischen Fehler beim Kopieren und Einf√ºgen (obwohl dies nat√ºrlich ein weiterer "f√ºr sp√§ter" sein kann). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt andere Fragmente eines √§hnlichen Plans, zum Beispiel:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Operation _GroupControlDeps(
  <span class="hljs-keyword">string</span> dev, Operation[] deps, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span><font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">return</span> tf_with(ops.control_dependencies(deps), ctl =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (dev == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
  });<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer-Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Anweisung 'then' entspricht der Anweisung 'else'. </font><font style="vertical-align: inherit;">control_flow_ops.cs 135 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht hat die √úberpr√ºfung einmal Sinn gemacht, aber im Laufe der Zeit ist sie verschwunden, oder es sind weitere √Ñnderungen in der Zukunft geplant. </font><font style="vertical-align: inherit;">Weder die eine noch die andere Option scheint jedoch eine ausreichende Rechtfertigung daf√ºr zu sein, etwas √Ñhnliches im Code zu belassen, ohne diese Seltsamkeit in irgendeiner Weise zu erkl√§ren. </font><font style="vertical-align: inherit;">Mit hoher Wahrscheinlichkeit wurde ein Kopier- und Einf√ºgefehler genauso gemacht.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versp√§teter Scheck</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] <span class="hljs-title">Input</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[] batch_shape = <span class="hljs-literal">null</span>,
  TF_DataType dtype = TF_DataType.DtInvalid,
  <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">bool</span> sparse = <span class="hljs-literal">false</span>,
  Tensor tensor = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> batch_size = batch_shape[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> shape = batch_shape.Skip(<span class="hljs-number">1</span>).ToArray(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
  InputLayer input_layer = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (batch_shape != <span class="hljs-literal">null</span>)                   <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
  <span class="hljs-keyword">else</span><font></font>
    ....<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer-Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Das Objekt 'batch_shape' wurde verwendet, bevor es gegen null verifiziert wurde. </font><font style="vertical-align: inherit;">√úberpr√ºfen Sie die Zeilen: 39, 42. keras.layers.cs 39 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein klassischer und ziemlich gef√§hrlicher Fehler bei der m√∂glichen Verwendung einer Variablen, die eine Verbindung zu nirgendwo darstellt. </font><font style="vertical-align: inherit;">In diesem Fall bedeutet der Code explizit die M√∂glichkeit , </font><font style="vertical-align: inherit;">dass </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_shape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - das ergibt sich </font><font style="vertical-align: inherit;">sowohl aus der Liste der Argumente und der anschlie√üenden √úberpr√ºfung der gleichen Variablen. </font><font style="vertical-align: inherit;">Somit zeigt der Analysator hier einen eindeutigen Fehler an.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noch ein "f√ºr sp√§ter"?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MnistDataSet</span>(<span class="hljs-params">
  NDArray images, NDArray labels, Type dataType, <span class="hljs-keyword">bool</span> reshape // &lt;=
</span>)</span> <font></font>
{<font></font>
  EpochsCompleted = <span class="hljs-number">0</span>;<font></font>
  IndexInEpoch = <span class="hljs-number">0</span>;<font></font>
<font></font>
  NumOfExamples = images.shape[<span class="hljs-number">0</span>];<font></font>
<font></font>
  images = images.reshape(<font></font>
    images.shape[<span class="hljs-number">0</span>], images.shape[<span class="hljs-number">1</span>] * images.shape[<span class="hljs-number">2</span>]<font></font>
  );<font></font>
  images = images.astype(dataType);<font></font>
  <span class="hljs-comment">// for debug np.multiply performance</span>
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> Stopwatch();<font></font>
  sw.Start();<font></font>
  images = np.multiply(images, <span class="hljs-number">1.0f</span> / <span class="hljs-number">255.0f</span>);<font></font>
  sw.Stop();<font></font>
  Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{sw.ElapsedMilliseconds}</span>ms"</span>);<font></font>
  Data = images;<font></font>
<font></font>
  labels = labels.astype(dataType);<font></font>
  Labels = labels;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysator Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117 Der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konstruktorparameter ' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Umformen</font></a><font style="vertical-align: inherit;"> ' wird nicht verwendet. </font><font style="vertical-align: inherit;">MnistDataSet.cs 15 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bei einigen anderen Kuriosit√§ten ist dies h√∂chstwahrscheinlich auf die Tatsache zur√ºckzuf√ºhren, dass die Funktionalit√§t bei weitem nicht vollst√§ndig implementiert ist und es durchaus m√∂glich ist, dass der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umformungsparameter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Zukunft in diesem Konstruktor irgendwie verwendet wird. </font><font style="vertical-align: inherit;">Aber vorerst scheint es, als w√ºrde er einfach so hierher geworfen. </font><font style="vertical-align: inherit;">Wenn dies wirklich "f√ºr sp√§ter" getan wird, w√§re es ratsam, dies mit einem Kommentar zu markieren. </font><font style="vertical-align: inherit;">Wenn nicht, stellt sich heraus, dass der Code, der das Objekt erstellt, einen zus√§tzlichen Parameter in den Konstruktor werfen muss, und es ist durchaus bequemer, dies nicht zu tun.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schwer fassbare m√∂gliche Null-Dereferenzierung</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _GatherV2Grad(Operation op, Tensor[] grads)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">int</span>)axis_static == <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> params_tail_shape = params_shape.slice(<span class="hljs-keyword">new</span> NumSharp.Slice(start:<span class="hljs-number">1</span>));
    <span class="hljs-keyword">var</span> values_shape = array_ops.concat(
      <span class="hljs-keyword">new</span>[] { indices_size, params_tail_shape }, <span class="hljs-number">0</span><font></font>
    );<font></font>
    <span class="hljs-keyword">var</span> values = array_ops.reshape(grad, values_shape);<font></font>
    indices = array_ops.reshape(indices, indices_size);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[]<font></font>
    {<font></font>
      <span class="hljs-keyword">new</span> IndexedSlices(values, indices, params_shape), <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-literal">null</span>,
      <span class="hljs-literal">null</span><font></font>
    };<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3146</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> M√∂gliche Null-Dereferenzierung des ersten Arguments 'Werte' innerhalb der Methode. Der Wert '_outputs.FirstOrDefault ()' kann den Standardwert null zur√ºckgeben. array_grad.cs 199 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu verstehen, wo das Problem liegt, sollten Sie sich zun√§chst dem Konstruktorcode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexedSlices zuwenden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">IndexedSlices</span>(<span class="hljs-params">
  Tensor values, Tensor indices, Tensor dense_shape = <span class="hljs-literal">null</span>
</span>)</span><font></font>
{<font></font>
  _values = values;<font></font>
  _indices = indices;<font></font>
  _dense_shape = dense_shape;<font></font>
<font></font>
  _values.Tag = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// &lt;=</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie </font><font style="vertical-align: inherit;">diesem Konstruktor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null √ºbergeben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wird </font><font style="vertical-align: inherit;">offensichtlich </font><font style="vertical-align: inherit;">eine Ausnahme ausgel√∂st. Doch warum h√§lt der Analysator , </font><font style="vertical-align: inherit;">dass die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Werte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variable </font><font style="vertical-align: inherit;">enthalten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio verwendet die Datenflussanalysetechnik, mit der Sie die S√§tze m√∂glicher Werte von Variablen in verschiedenen Teilen des Codes finden k√∂nnen. Eine Warnung weist Sie darauf hin, dass null in der angegebenen Variablen mit der folgenden Zeile zur√ºckgegeben werden kann: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Allerdings Blick auf den Code oben, k√∂nnen Sie den Wert der feststellen , </font><font style="vertical-align: inherit;">dass </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Werte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variable wird </font><font style="vertical-align: inherit;">durch den </font><font style="vertical-align: inherit;">Aufruf erhalten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Woher</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kommt dann </font><i><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></i><font style="vertical-align: inherit;"> ?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsache ist, dass bei der Analyse des Datenstroms nicht nur die aktuelle Funktion ber√ºcksichtigt wird, sondern auch alle aufgerufen werden. </font><font style="vertical-align: inherit;">PVS-Studio erh√§lt √ºberall Informationen √ºber die m√∂glichen Werte einer Variablen. </font><font style="vertical-align: inherit;">Eine Warnung bedeutet also, dass die Implementierung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen Aufruf von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault () enth√§lt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dessen Ergebnis letztendlich zur√ºckgegeben wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies zu √ºberpr√ºfen, gehen Sie zur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umformungsimplementierung</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
            =&gt; gen_array_ops.reshape(tensor, shape, <span class="hljs-literal">null</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie dann zu der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umformungsmethode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">die im Inneren aufgerufen wird:</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> _op = _op_def_lib._apply_op_helper(
    <span class="hljs-string">"Reshape"</span>, name, <span class="hljs-keyword">new</span> { tensor, shape }<font></font>
  );<font></font>
  <span class="hljs-keyword">return</span> _op.output;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_apply_op_helper</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gibt ein Objekt der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operation-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse zur√ºck </font><font style="vertical-align: inherit;">, das die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausgabeeigenschaft</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enth√§lt </font><font style="vertical-align: inherit;">. Nach Erhalt seines Wertes wird der in der Warnung beschriebene Code aufgerufen:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> Tensor output =&gt; _outputs.FirstOrDefault();</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist nat√ºrlich ein Referenztyp, daher ist der Standardwert daf√ºr </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Aus all dem ist ersichtlich, dass PVS-Studio die logische Struktur des Codes akribisch analysiert und tief in die Struktur von Aufrufen eindringt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Analysator hat seine Arbeit abgeschlossen und weist auf einen m√∂glicherweise problematischen Ort hin. </font><font style="vertical-align: inherit;">Der Programmierer muss pr√ºfen, ob eine Situation auftreten kann, wenn Elemente in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fehlen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit wird die statische Analyse den Entwickler zumindest zwingen, auf das verd√§chtige Fragment zu achten, um zu beurteilen, ob der Fehler dort tats√§chlich auftreten kann. </font><font style="vertical-align: inherit;">Mit diesem Ansatz wird die Anzahl der Fehler, die unbemerkt bleiben, schnell reduziert.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unzuverl√§ssiges Warten?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> (LoopVar&lt;TItem&gt;, Tensor[]) _BuildLoop&lt;TItem&gt;(<font></font>
  ....<font></font>
) <span class="hljs-keyword">where</span> ....<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-comment">// Finds the closest enclosing non-None control pivot.</span>
  <span class="hljs-keyword">var</span> outer_context = _outer_context;
  <span class="hljs-keyword">object</span> control_pivot = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">while</span> (outer_context != <span class="hljs-literal">null</span> &amp;&amp; control_pivot == <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (control_pivot != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer-Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3032 Das</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Warten auf diesen Ausdruck ist unzuverl√§ssig, da der Compiler m√∂glicherweise einige der Variablen optimiert. </font><font style="vertical-align: inherit;">Verwenden Sie fl√ºchtige Variablen oder Synchronisationsprimitive, um dies zu vermeiden. </font><font style="vertical-align: inherit;">WhileContext.cs 212 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Analysator gibt an, dass eine solche Implementierung des Wartens vom Compiler optimiert werden kann, aber ich bezweifle, dass sie wirklich versucht haben, das Warten hier zu implementieren - h√∂chstwahrscheinlich wurde der Code einfach nicht hinzugef√ºgt und wird in Zukunft weiterentwickelt. </font><font style="vertical-align: inherit;">Es k√∂nnte sich lohnen, hier eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException auszul√∂sen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da diese Vorgehensweise an anderer Stelle im Projekt verwendet wird. </font><font style="vertical-align: inherit;">Auf die eine oder andere Weise glaube ich, dass ein erkl√§render Kommentar offensichtlich nicht schaden w√ºrde.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grenzen brechen</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TensorShape</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[][] dims</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span>(dims.Length == <span class="hljs-number">1</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">switch</span> (dims[<span class="hljs-number">0</span>].Length)<font></font>
    {<font></font>
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: shape = <span class="hljs-keyword">new</span> Shape(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: shape = Shape.Vector((<span class="hljs-keyword">int</span>)dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: shape = Shape.Matrix(dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], dims[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]); <span class="hljs-keyword">break</span>; <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">default</span>: shape = <span class="hljs-keyword">new</span> Shape(dims[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"TensorShape int[][] dims"</span>);<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> M√∂glicherweise ist der Index nicht gebunden. Der '1'-Index zeigt √ºber die' dims'-Grenze hinaus. TensorShape.cs 107 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter den seltsamen Codefragmenten, die ich gesehen habe, gab es einen echten Fehler, der sehr schwer zu bemerken ist. Das folgende Fragment ist hier fehlerhaft: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [1] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Das Abrufen eines Elements mit Index 1 aus einem Array eines Elements ist offensichtlich ein Fehler. Wenn Sie das Fragment in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √§ndern </font><font style="vertical-align: inherit;">, tritt gleichzeitig ein weiterer Fehler auf: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eines Elements mit Index 2 aus dem Array </font><i><font style="vertical-align: inherit;">dims [0]</font></i><font style="vertical-align: inherit;"> , dessen L√§nge in diesem Fall 2 betr√§gt. Somit stellte sich dieses Problem heraus als ob mit einem "doppelten Boden".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In jedem Fall sollte dieses Codefragment vom Entwickler untersucht und korrigiert werden. </font><font style="vertical-align: inherit;">Meiner Meinung nach ist dieses Beispiel ein hervorragendes Beispiel f√ºr die Leistung der Datenflussanalyse in PVS-Studio.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olepatka?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> _init_from_args(<span class="hljs-keyword">object</span> initial_value = <span class="hljs-literal">null</span>, ....) <span class="hljs-comment">// &lt;=</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> init_from_fn = initial_value.GetType().Name == <span class="hljs-string">"Func`1"</span>; <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
  tf_with(...., scope =&gt;<font></font>
  {<font></font>
    ....<font></font>
    tf_with(...., <span class="hljs-keyword">delegate</span><font></font>
    {<font></font>
      initial_value = ops.convert_to_tensor(  <span class="hljs-comment">// &lt;=</span>
        init_from_fn ? (initial_value <span class="hljs-keyword">as</span> Func&lt;Tensor&gt;)():initial_value,<font></font>
        name: <span class="hljs-string">"initial_value"</span>,<font></font>
        dtype: dtype<font></font>
      );<font></font>
    });<font></font>
    _shape = shape ?? (initial_value <span class="hljs-keyword">as</span> Tensor).TensorShape;<font></font>
    _initial_value = initial_value <span class="hljs-keyword">as</span> Tensor; <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
    _dtype = _initial_value.dtype.as_base_dtype(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_in_graph_mode)<font></font>
    {<font></font>
      ....<font></font>
<font></font>
      <span class="hljs-keyword">if</span> (initial_value != <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      {<font></font>
        ....<font></font>
      }<font></font>
<font></font>
      ....<font></font>
    }<font></font>
<font></font>
    ....<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den obigen Code zu verstehen, lohnt es sich auch, die Implementierung der Funktion tf_with einzuf√ºhren:</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">DebuggerStepThrough</span>] <span class="hljs-comment">// with "Just My Code" enabled this lets the </span>
[<span class="hljs-meta">DebuggerNonUserCode()</span>]  <span class="hljs-comment">//debugger break at the origin of the exception</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> tf_with&lt;T&gt;(<font></font>
  T py, Action&lt;T&gt; action<font></font>
) <span class="hljs-keyword">where</span> T : ITensorFlowObject<font></font>
{<font></font>
  <span class="hljs-keyword">try</span><font></font>
  {<font></font>
    py.__enter__();<font></font>
    action(py);<font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span><font></font>
  {<font></font>
    py.__exit__();<font></font>
    py.Dispose();<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer Warnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : V3019 M√∂glicherweise wird eine falsche Variable nach der Typkonvertierung mit dem Schl√ºsselwort 'as' mit null verglichen. √úberpr√ºfen Sie die Variablen 'initial_value', '_initial_value'. ResourceVariable.cs 137 </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_init_from_args</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine ziemlich umfangreiche Funktion, daher wurden viele Fragmente weggelassen. Sie k√∂nnen es vollst√§ndig sehen, indem Sie auf den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> klicken </font><font style="vertical-align: inherit;">. Obwohl mir die Warnung zun√§chst nicht wirklich ernst erschien, stellte ich nach dem Studium fest, dass mit dem Code definitiv etwas nicht stimmte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zun√§chst sei darauf hingewiesen, dass das Verfahren ohne Parameter√ºbergabe aufgerufen werden kann und wird standardm√§√üig es </font><font style="vertical-align: inherit;">wird </font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;"> in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In diesem Fall wird in der ersten Zeile eine Ausnahme ausgel√∂st. </font><font style="vertical-align: inherit;">
Zweitens die √úberpr√ºfung</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ungleichheit </font><font style="vertical-align: inherit;">sieht seltsam aus </font><font style="vertical-align: inherit;">: wenn </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wirklich wird </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nach dem </font><font style="vertical-align: inherit;">Aufruf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ops.convert_to_tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dann </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w√§re </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , was bedeutet , </font><font style="vertical-align: inherit;">dass Aufruf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value.dtype.as_base_dtype ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w√§re auch eine Ausnahme werfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Analysator weist darauf hin, dass Sie m√∂glicherweise pr√ºfen m√ºssen, ob </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist. </font><i><font style="vertical-align: inherit;">Wie</font></i><font style="vertical-align: inherit;"> oben erw√§hnt, erfolgt die Bezugnahme auf diese Variable jedoch vor diesem Test, sodass diese Option ebenfalls falsch w√§re. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§re dieser kleine Fehler in einer so riesigen Funktion ohne PVS-Studio aufgefallen? </font><font style="vertical-align: inherit;">Ich bezweifle es sehr.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem Projekt mit vielen Beispielen f√ºr seltsamen Code k√∂nnen viele Probleme ausgeblendet werden. Der Programmierer, der sich daran gew√∂hnt, das Unverst√§ndliche zu sehen, bemerkt gleichzeitig keine Fehler mehr. Die Folgen k√∂nnen sehr traurig sein. In der Tat gibt es unter den Warnungen des Analysators auch falsche. In den meisten F√§llen weisen Warnungen jedoch zumindest auf Codefragmente hin, die beim Betrachten durch eine Person Fragen verursachen k√∂nnen. In dem Fall, in dem der seltsame Code absichtlich geschrieben wurde, lohnt es sich, Erkl√§rungen zu hinterlassen, damit das Fragment dem Entwickler klar ist, der in Zukunft mit diesem Code arbeiten wird (auch wenn dies bedeutet, Kommentare f√ºr sich selbst zu hinterlassen).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig k√∂nnen statische Analysewerkzeuge wie PVS-Studio eine gro√üe Hilfe sein, um potenzielle Fehler und Kuriosit√§ten zu finden, damit sie sichtbar und nicht vergessen werden. Alle tempor√§ren L√∂sungen werden anschlie√üend verfeinert und in ein sauberes, strukturiertes und stabiles Funktionieren umgewandelt der Code.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie diesen Artikel einem englischsprachigen Publikum zug√§nglich machen m√∂chten, verwenden Sie bitte den Link zur √úbersetzung: Nikita Lipilin. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie verbirgt seltsamer Code Fehler? </font><font style="vertical-align: inherit;">TensorFlow.NET-Analyse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496234/index.html">Der Hauptgrund warum nicht Linux</a></li>
<li><a href="../de496238/index.html">Achtundzwanzig Schritte, um in der Krise zu √ºberleben und Erfolg zu haben</a></li>
<li><a href="../de496240/index.html">Product Discovery 101 f√ºr Product Manager</a></li>
<li><a href="../de496242/index.html">Cyberpunk ist bereits da: Sch√ºler lernen bei Minecraft und Sch√ºler machen physische Tests in CS: GO</a></li>
<li><a href="../de496248/index.html">Herausforderungen, kahle K√∂pfe und Wein. Wie wir bei HFLabs Selbstisolation ertragen</a></li>
<li><a href="../de496252/index.html">Aerodynamisch versetzte Zentrierflugzeuge</a></li>
<li><a href="../de496254/index.html">Wie Rostelecom den Datenverkehr f√§lschlicherweise an Google, AWS, Cloudflare usw. umleitete</a></li>
<li><a href="../de496256/index.html">Maschinelles Lernen auf R: Expertentechniken f√ºr die pr√§diktive Analyse</a></li>
<li><a href="../de496258/index.html">Online-Holivar: Ein neues Format f√ºr den Erfahrungsaustausch. Diesen Samstag</a></li>
<li><a href="../de496260/index.html">Tipps zur Cybersicherheit f√ºr die Arbeit von zu Hause aus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>