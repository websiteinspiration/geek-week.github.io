<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🔧 🙌 💜 負荷の高いGolangアプリケーションのデバッグ、またはKubernetesに存在しない問題の探し方 🛣️ 🅾️ 🎬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="現代のKubernetesクラウドの世界では、何らかの方法で、自分や同僚が作成したのではないソフトウェアエラーに直面する必要がありますが、解決する必要があります。この記事は、GolangとKubernetesの世界の初心者が、自分のソフトウェアと外国のソフトウェアをデバッグするいくつかの方法を理解す...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>負荷の高いGolangアプリケーションのデバッグ、またはKubernetesに存在しない問題の探し方</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/domclick/blog/495450/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現代のKubernetesクラウドの世界では、何らかの方法で、自分や同僚が作成したのではないソフトウェアエラーに直面する必要がありますが、解決する必要があります。</font><font style="vertical-align: inherit;">この記事は、GolangとKubernetesの世界の初心者が、自分のソフトウェアと外国のソフトウェアをデバッグするいくつかの方法を理解するのに役立ちます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ok/xx/pi/okxxpinnrmycv6thscy9dusxm5u.jpeg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の名前はViktor Yagofarovです。私はDomKlikでKubernetesクラウドを開発しています。本日は、本番環境のk8s（Kubernetes）クラスターの主要コンポーネントの1つで問題を解決した方法についてお話します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの戦闘クラスターでは（執筆時）：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1890 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポッド</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と577サービスが</font><font style="vertical-align: inherit;">開始さ</font><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">（実際のマイクロサービスの数もこの図の領域にあります）</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingress-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コントローラーは約6k RPSを提供し、ほぼ同じ量がIngressから直接</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hostPortに送信され</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
</ul><a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数か月前、ポッドでDNS名の解決に問題が発生し始めました。実際のところ、DNSは主にUDP上で動作し、Linuxカーネルでは</font><font style="vertical-align: inherit;">conntrackとUDPに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかの問題</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。 k8sサービスのサービスアドレスにアクセスするときのDNATは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conntrackレースの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題を悪化させるだけ</font><font style="vertical-align: inherit;">です。問題が発生した時点のクラスターでは、DNSサーバーであるCoreDNSに対して約40kのRPSがあったことを付け加えておきます。</font><font style="vertical-align: inherit;">クラスタの各ワーカーノードの</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/806/213/0a2/8062130a2c09d4c45735aec5b9a65420.jpg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コミュニティによって特別に作成された</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NodeLocal DNS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（nodelocaldns）</font><font style="vertical-align: inherit;">ローカルキャッシングDNSサーバーを使用することが決定されました</font><font style="vertical-align: inherit;">。これはまだベータ版であり、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">すべての問題</font></a><font style="vertical-align: inherit;">を解決するように設計されて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">います</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。つまり、クラスターDNSに接続するときにUDPを削除し、NATを削除して、追加のキャッシュレイヤーを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実装nodelocaldnsの最初の反復では、</font><font style="vertical-align: inherit;">«kubernetes-installer» </font><i><font style="vertical-align: inherit;">Kubesprayに付属する</font></i><font style="vertical-align: inherit;">バージョン</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.15.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キューブ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のバージョンと混同しないでください</font><font style="vertical-align: inherit;">）を使用しました。これは</font><font style="vertical-align: inherit;">、Southbridgeの会社のフォークフォークについて話しています。</font><font style="vertical-align: inherit;">
導入のほぼ直後に、問題が発生しました。メモリが流れ、ハースが</font><i><font style="vertical-align: inherit;">メモリ制限</font></i><font style="vertical-align: inherit;">（OOM-Kill）</font><font style="vertical-align: inherit;">に従って再起動しました</font><font style="vertical-align: inherit;">。すべてのポッドで</font><i><font style="vertical-align: inherit;">/etc/resolv.conf</font></i><font style="vertical-align: inherit;">がnodelocaldnsのIPアドレスを正確にポイントしているため、</font><font style="vertical-align: inherit;">これを再起動するときに、ホスト上のすべてのトラフィックが失われ</font><font style="vertical-align: inherit;">ました。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この状況は明らかにすべての人に適しているわけではなく、OPSチームはそれを排除するためにいくつかの対策を講じました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私自身もGolangを初めて使用しているので、このすばらしい方法を使い、このすばらしいプログラミング言語でアプリケーションをデバッグすることに慣れることに非常に興味を持っていました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策を探しています</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
じゃ、行こう！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バージョン</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.15.7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はdev clusterにダウンロードされました</font><font style="vertical-align: inherit;">。これはすでにベータ版であり、1.15.4のアルファ版ではないと見なされてい</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">が、乙女にはDNS（40k RPS）にそのようなトラフィックがありません。悲しい。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その過程で、私たちはKubesprayからnodelocaldnsをアンタイズし、</font><font style="vertical-align: inherit;">より便利な展開のために</font><font style="vertical-align: inherit;">特別な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helmチャート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">作成し</font></a><font style="vertical-align: inherit;">ました。同時に、彼らはKubesprayのプレイブックを作成しました。これにより</font><font style="vertical-align: inherit;">、クラスター全体の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を1時間で消化することなく、</font><i><font style="vertical-align: inherit;">kubeletの</font></i><font style="vertical-align: inherit;">設定を変更できます</font><font style="vertical-align: inherit;">。さらに、これは個別に行うことができます（最初に少数のノードでチェックします）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、nodelocaldns 1.15.7のバージョンをprodにロールアウトしました。悲しいかな、状況は繰り返されました。記憶が流れていた。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
公式の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodelocaldnsリポジトリに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、1.15で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">タグ付けさ</font></a><font style="vertical-align: inherit;">れたバージョン</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">があり</font></a><font style="vertical-align: inherit;">ました。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、しかし、何らかの理由</font><font style="vertical-align: inherit;">でこのバージョンで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker pull</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実行できず</font><font style="vertical-align: inherit;">、公式のDockerイメージをまだコンパイルしていないと思ったため、このバージョンは使用しないでください。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは重要なポイントであり、私たちはそれに戻ります。</font></font></b><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ：ステージ1</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長い間、私は以来、原則としてnodelocaldnsの私のバージョンを組み立てる方法を理解できなかった</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefileの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カブは、ドッキングウィンドウの画像の中から、不可解なエラーでクラッシュしたから、と私は本当に巧妙で行くプロジェクト構築する方法を理解していなかった</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">govendor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">妙に一度のディレクトリに配置されました、いくつかの異なるDNSサーバーオプション。</font><font style="vertical-align: inherit;">重要なのは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常の標準の依存関係のバージョン管理</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がすでに表示されていたときに、Goの学習を始めたことです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pavel Selivanovがこの問題を解決してくれました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポールジャム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、彼に感謝します。私はなんとか自分のバージョンを組み立てました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pprof</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロファイラーをねじ込み、</font><font style="vertical-align: inherit;">乙女でアセンブリをテストして、製品に展開しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チャットチームの同僚は、プロファイリングを理解するのに本当に役立ちました。これにより、CLI URLを介してpprofユーティリティに簡単に執着し、ブラウザーのインタラクティブメニューを使用してメモリとプロセススレッドを調査できるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一見すると、プロファイラーの出力に基づいて、プロセスはうまくいっていました。ほとんどのメモリは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタック</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に割り当てられて</font><font style="vertical-align: inherit;">おり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Goルーチン</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって</font><font style="vertical-align: inherit;">常に</font><font style="vertical-align: inherit;">使用されているよう</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ある時点で、nodelocaldnsの「悪い」ハースは、「正常な」ものと比較してアクティブなスレッドが多すぎることが明らかになりました。</font><font style="vertical-align: inherit;">そして、スレッドはどこにも消えることはありませんでしたが、メモリ内でハングし続けました。</font><font style="vertical-align: inherit;">このとき、パヴェルセリバノフの「糸が流れている」という直感が確認されました。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/e19/328/56c/e1932856c5c346e5bb40aefeb6490926.jpg" alt="画像"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ：ステージ2</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが発生している理由（スレッドが流れている）が興味深くなり、nodelocaldnsプロセスの調査の次の段階が始まりました。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタティックアナライザー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">staticcheck</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、nodelocaldns（inkluda nodelocaldns'omで使用されるinkluda CoreDNS）で使用される</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">スレッドを作成する段階でいくつかの問題があることを示しました</font><font style="vertical-align: inherit;">。私が理解しているように、一部の場所では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、構造へのポインタでは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なく、</font><font style="vertical-align: inherit;">それらの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コピー</font><i><font style="vertical-align: inherit;">が</font></i><font style="vertical-align: inherit;">送信され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">gcoreユーティリティを使用して「不良」プロセスの</font><i><font style="vertical-align: inherit;">コアダンプ</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を作成し、</font><font style="vertical-align: inherit;">内部を確認することが決定されました。</font><font style="vertical-align: inherit;">
gdbのような</font><i><font style="vertical-align: inherit;">dlv</font></i><font style="vertical-align: inherit;">ツールでコアダンプにスタック</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その力には気づきましたが、長い間このように理由を探していたのです。</font><font style="vertical-align: inherit;">そのため、コアダンプをGoland IDEにロードして、プロセスメモリの状態を分析しました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ：ステージ3</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムの構造を調べ、それを作成するコードを確認することは非常に興味深いことでした。</font><font style="vertical-align: inherit;">約10分で、多くのgo-routineがTCP接続用のある種の構造を作成し、それらを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にマークして</font><font style="vertical-align: inherit;">削除しない</font><font style="vertical-align: inherit;">ことが明らかになり</font><font style="vertical-align: inherit;">ました（約40k RPSを覚えていますか？）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/14e/b5c/cff/14eb5ccffcf7f257f04e88d8c5e4deae.jpg" alt="画像"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0ff/3f0/b21/0ff3f0b210d54df3b398b23dbc639349.jpg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリーンショットでは、コードの問題のある部分と、UDPセッションが閉じられたときにクリアされなかった構造を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、コアダンプから、非常に多くのRPSの原因がこれらの構造のIPアドレスによって知られるようになりました（クラスターのボトルネックを見つける手助けをしてくれてありがとう:)。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題との戦いの中で、Kubernetesコミュニティの同僚の助けを借りて、nodelocaldns 1.15.8の公式のDockerイメージがまだ存在していることを発見しました（実際に手が曲がっていて、どういうわけか間違ったDockerプルを実行したか、WIFIがいたずら引く瞬間）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このバージョンでは、彼の用途が大幅にあることをライブラリのバージョンは「動揺」：具体的には、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「犯人」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「20回のバージョンアップについて」apnalized！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、新しいバージョンはすでにpprofによるプロファイリングをサポートしており、Configmapを通じて有効になっているため、何も再構築する必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいバージョンが最初に開発され、次に製品でダウンロードされました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
III ... </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勝利</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセスはメモリをシステムに戻し始め、問題は停止しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下のグラフには、「喫煙者のDNSと </font><font style="vertical-align: inherit;">健康な人のDNS。」</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fcd/70e/565/fcd70e56544fa4d0f482ee3413ecdf94.jpg" alt="画像"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論は簡単です。自分が何をしているかを何度も確認し、コミュニティの支援を軽視しないでください。</font><font style="vertical-align: inherit;">その結果、問題の解決に数日間多くの時間を費やしましたが、コンテナーでDNSフェイルセーフ操作を受け取りました。</font><font style="vertical-align: inherit;">この時点までお読みいただきありがとうございます:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
役立つリンク：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.freecodecamp.org/news/how-i-investigated-memory-leaks-in-go-using-pprof-on-a-large-codebase-4bec4325e192</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2 。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr.com/en/company/roistat/blog/413175</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
3. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rakyll.org</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495438/index.html">Excelユーザー向けのR言語（無料ビデオコース）</a></li>
<li><a href="../ja495440/index.html">オランダのサーバーはほぼ終わりました。新しい注文を処理できない場合があります。VPSとインターネットは終了しますか？</a></li>
<li><a href="../ja495444/index.html">C ++の配列</a></li>
<li><a href="../ja495446/index.html">反重力はあなたが思っていたものではありません</a></li>
<li><a href="../ja495448/index.html">4月3日以降、オンライン、バック、フロント、QA、PM、DevOps、およびロボットの1週間のオンラインmitap</a></li>
<li><a href="../ja495452/index.html">負荷の増加に備えてサイトを準備する方法</a></li>
<li><a href="../ja495454/index.html">BPFとeBPFの簡単な紹介</a></li>
<li><a href="../ja495456/index.html">＃家に座っているときに生産性を高めるのに役立つFigmaの14の新しいプラグインのレビュー</a></li>
<li><a href="../ja495458/index.html">子供たちがあなたの周りを走り回り、「何のために働きますか？」</a></li>
<li><a href="../ja495460/index.html">地球の22,000倍の気泡が天王星で爆発した</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>