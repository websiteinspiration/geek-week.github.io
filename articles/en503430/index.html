<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∑Ô∏è ü•ä üëÄ MS Remote Desktop Gateway, HAProxy and password guessing üö´ üçç üò¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi friends! 
 
 There are many ways to connect from home to a workplace in an office. One of them is to use Microsoft Remote Desktop Gateway. This is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MS Remote Desktop Gateway, HAProxy and password guessing</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503430/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hi friends! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are many ways to connect from home to a workplace in an office. One of them is to use Microsoft Remote Desktop Gateway. This is RDP over HTTP. I don‚Äôt want to touch upon the configuration of RDGW itself, I don‚Äôt want to discuss why it is good or bad, let's treat it as one of the remote access tools. I want to talk about protecting your RDGW server from the evil Internet. When I set up the RDGW server, I immediately became preoccupied with protection, especially password protection. I was surprised that I did not find articles on the Internet on how to do this. Well, you have to do it yourself.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RDGW itself does not have any protections. Yes, it is possible to expose a bare </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rail</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interface in a white net and will work just fine. But the right administrator or IB'shnik will be restless from this. In addition, it will allow avoiding the situation of blocking an account when a negligent employee remembered the password of the corporate account on the home computer, and then changed his password. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A good way to protect internal resources from the external environment is through various proxies, publishing systems, and other WAFs. Recall that RDGW is all the same http, then it directly begs to stick a specialized solution between internal servers and the Internet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I know there are cool F5, A10, Netscaler (ADC). As the administrator of one of these systems, I‚Äôll say that it is also possible to set up protection against busting on these systems. And yes, these systems will protect you from any syn flood along the way. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But not every company can afford to buy such a solution (and find the administrator of such a system :), but it can take care of security! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is possible to install the free version of HAProxy on a free operating system. I tested on Debian 10, in the stable repository version of haproxy 1.8.19. I also checked on version 2.0.xx from the testing repository.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setting up debian itself is beyond the scope of this article. Briefly: on the white interface, close everything except 443 ports, on the gray interface - according to your policy, for example, close everything except 22 ports. Open only what is necessary for work (VRRP for example, for floating ip). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First of all, I configured haproxy to SSL bridging mode (aka mode http) and turned on logging to see what goes inside RDP. So to speak, climbed in the middle. So, the / RDWeb path specified in "all" articles on configuring RDGateway is missing. All that is there is /rpc/rpcproxy.dll and / remoteDesktopGateway /. In this case, standard GET / POST requests are not used, its own request type is RDG_IN_DATA, RDG_OUT_DATA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not much, but at least something. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's test.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I start mstsc, go to the server, I see four 401 errors (unauthorized) in the logs, then I enter the login / password and I see the answer 200. I </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
turn off, I start again, I see the same four 401 errors in the logs. I enter the wrong username / password and I see four again errors 401. What you need. This is what we will catch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since it was not possible to determine the login url, and besides, I don‚Äôt know how to catch the 401 error in haproxy, I will catch (not actually catch, but count) all 4xx errors. Also happy to solve the problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The essence of protection will be that we will count the number of 4xx errors (on the backend) per unit of time and if it exceeds the specified limit, then reject (on the frontend) all further connections from this ip for the specified time.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Technically, this will not be password protection, it will be 4xx error protection. </font><font style="vertical-align: inherit;">For example, if you frequently request a non-existent url (404), then protection will also work. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The easiest and most working way is to count and beat off on the backend, if something superfluous has appeared:</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/desktop.example.com.pem<font></font>
    mode http<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    mode http<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-comment"># , , 1000 ,   15 ,  -    10 </span>
    stick-table <span class="hljs-built_in">type</span> string len 128 size 1k expire 15s store http_err_rate(10s)
    <span class="hljs-comment"># ip</span><font></font>
    http-request track-sc0 src<font></font>
    <span class="hljs-comment">#  http  429,    10   4 </span>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> { sc_http_err_rate(0) gt 4 }<font></font>
	<font></font>
	...<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not a good option, complicate. </font><font style="vertical-align: inherit;">We will count on the backend, and block it on the frontend. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We‚Äôll act rudely with the attacker, we will drop the tcp connection to him.</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/ertelecom_ru_2020_06_11.pem<font></font>
    mode http<font></font>
    ...<font></font>
    <span class="hljs-comment">#  ip , 1000 ,   15 ,    </span>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0
    <span class="hljs-comment"># </span><font></font>
    tcp-request connection track-sc0 src<font></font>
    <span class="hljs-comment"># tcp ,    &gt;0</span>
    tcp-request connection reject <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
	<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    mode http<font></font>
    ...<font></font>
	<font></font>
    <span class="hljs-comment">#  ip , 1000 ,   15 ,  -   10 </span>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)
    <span class="hljs-comment"># ,  -   10   8</span><font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    <span class="hljs-comment">#     ( )</span><font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    <span class="hljs-comment">#  </span><font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    <span class="hljs-comment"># </span><font></font>
    tcp-request content track-sc1 src<font></font>
    <span class="hljs-comment">#, ,  </span>
    tcp-request content reject <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser
    <span class="hljs-comment">#,   </span>
    tcp-request content accept <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
	<font></font>
    ...<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
the same thing, but politely, we will return the error http 429 (Too Many Requests)</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc<font></font>
    ...<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0<font></font>
    http-request track-sc0 src<font></font>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)<font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    http-request track-sc1 src<font></font>
    http-request allow <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser<font></font>
    ...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check: run mstsc and start randomly entering passwords. After the third attempt, it kicks me in 10 seconds, and mstsc gives an error. As can be seen in the logs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Explanations I am far from a haproxy master. I do not understand why, for example, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
http-request deny deny_status 429 if {sc_http_err_rate (0) gt 4} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
allows you to make about 10 errors before it works. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I am confused in the numbering of the counters. Haproxy masters, I will be glad if you supplement me, correct me, do better. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the comments, you can throw other ways to protect RD Gateway, it will be interesting to study.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regarding the Windows Remote Desktop Client (mstsc), it is worth noting that it does not support TLS1.2 (at least in Windows 7), so I had to leave TLS1; </font><font style="vertical-align: inherit;">does not support current cipher, so I also had to leave the old ones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For those who </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do not understand anything,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> just learning, and already want to do well, I will give the whole config.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haproxy.conf</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">global
        <span class="hljs-built_in">log</span> /dev/<span class="hljs-built_in">log</span>    local0
        <span class="hljs-built_in">log</span> /dev/<span class="hljs-built_in">log</span>    local1 notice<font></font>
        chroot /var/lib/haproxy<font></font>
        stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners<font></font>
        stats timeout 30s<font></font>
        user haproxy<font></font>
        group haproxy<font></font>
        daemon<font></font>
<font></font>
        <span class="hljs-comment"># Default SSL material locations</span><font></font>
        ca-base /etc/ssl/certs<font></font>
        crt-base /etc/ssl/private<font></font>
<font></font>
        <span class="hljs-comment"># See: https://ssl-config.mozilla.org/#server=haproxy&amp;server-version=2.0.3&amp;config=intermediate</span>
        <span class="hljs-comment">#ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE</span><font></font>
-RSA-AES256-GCM-SHA384<font></font>
        ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS<font></font>
        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256<font></font>
        <span class="hljs-comment">#ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets</span><font></font>
        ssl-default-bind-options no-sslv3<font></font>
        ssl-server-verify none<font></font>
<font></font>
<font></font>
defaults<font></font>
        <span class="hljs-built_in">log</span>     global<font></font>
        mode    http<font></font>
        option  httplog<font></font>
        option  dontlognull<font></font>
        timeout connect 5000<font></font>
        timeout client  15m<font></font>
        timeout server  15m<font></font>
        errorfile 400 /etc/haproxy/errors/400.http<font></font>
        errorfile 403 /etc/haproxy/errors/403.http<font></font>
        errorfile 408 /etc/haproxy/errors/408.http<font></font>
        errorfile 500 /etc/haproxy/errors/500.http<font></font>
        errorfile 502 /etc/haproxy/errors/502.http<font></font>
        errorfile 503 /etc/haproxy/errors/503.http<font></font>
        errorfile 504 /etc/haproxy/errors/504.http<font></font>
<font></font>
<font></font>
frontend fe_rdp_tsc<font></font>
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/dektop.example.com.pem<font></font>
    mode http<font></font>
    capture request header Host len 32<font></font>
    <span class="hljs-built_in">log</span> global<font></font>
    option httplog<font></font>
    timeout client 300s<font></font>
    maxconn 1000<font></font>
<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0<font></font>
    tcp-request connection track-sc0 src<font></font>
    tcp-request connection reject <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
<font></font>
    acl rdweb_domain hdr(host) -i beg dektop.example.com<font></font>
    http-request deny deny_status 400 <span class="hljs-keyword">if</span> !rdweb_domain<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    balance <span class="hljs-built_in">source</span><font></font>
    mode http<font></font>
    <span class="hljs-built_in">log</span> global<font></font>
<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)<font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    tcp-request content track-sc1 src<font></font>
    tcp-request content reject <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser<font></font>
    tcp-request content accept <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
<font></font>
    option forwardfor<font></font>
    http-request add-header X-CLIENT-IP %[src]<font></font>
<font></font>
    option httpchk GET /<font></font>
    cookie RDPWEB insert nocache<font></font>
    default-server inter 3s    rise 2  fall 3<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
<font></font>
<font></font>
frontend fe_stats<font></font>
    mode http<font></font>
    <span class="hljs-built_in">bind</span> *:8080<font></font>
    acl ip_allow_admin src 192.168.66.66<font></font>
    stats <span class="hljs-built_in">enable</span><font></font>
    stats uri /stats<font></font>
    stats refresh 30s<font></font>
    <span class="hljs-comment">#stats admin if LOCALHOST</span>
    stats admin <span class="hljs-keyword">if</span> ip_allow_admin
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why two servers on the backend? </font><font style="vertical-align: inherit;">Because this is how fault tolerance can be done. </font><font style="vertical-align: inherit;">Haproxy can also do two with floating white ip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computing resources: you can start with "two gigs, two cores, a gaming PC." </font><font style="vertical-align: inherit;">According to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this will be enough with a margin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuring rdp-gateway from HAProxy </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">The only article I found where I was </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">bothered with password cracking</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503412/index.html">Project Loom: Java virtual threads are close</a></li>
<li><a href="../en503414/index.html">Hack The Box. Walkthrough Rope. PWN. Format strings and ROP using pwntools</a></li>
<li><a href="../en503420/index.html">Lemmatize it faster (PyMorphy2, PyMystem3 and some magic)</a></li>
<li><a href="../en503426/index.html">44.2 Tb / s over fiber - how does it work?</a></li>
<li><a href="../en503428/index.html">How to Improve Written English for Communication Abroad: Linguix Business Project</a></li>
<li><a href="../en503432/index.html">Cross-platform multi-threaded TCP / IP server in C ++</a></li>
<li><a href="../en503446/index.html">Where can you open a bank account for a non-resident company from the high-risk category in 2020?</a></li>
<li><a href="../en503448/index.html">How not to join the ranks of aspiring specialists if you are Data Scientist</a></li>
<li><a href="../en503450/index.html">Stories about my work in the Netherlands</a></li>
<li><a href="../es486176/index.html">Memo de correspondencia de correo electr√≥nico corporativo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>