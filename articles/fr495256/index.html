<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈺 🚴🏿 💅🏾 À propos des ports et du chiffrement dans les serveurs de messagerie 🙆🏾 ☘️ 😎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors de la configuration du serveur de messagerie sortant sur le client de messagerie, vous voyez 3 options de cryptage - sans cryptage, SMTPS et STAR...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>À propos des ports et du chiffrement dans les serveurs de messagerie</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495256/"><img src="https://habrastorage.org/webt/pj/a_/os/pja_osqbo80fknqvjnkwxjfdqma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la configuration du serveur de messagerie sortant sur le client de messagerie, vous voyez 3 options de cryptage - sans cryptage, SMTPS et STARTTLS, ainsi que 3 ports possibles - 25, 465, 587. Que choisir et pour quoi - comprenons.</font></font><br>
 <a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vidéo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/GvyQvKyrEaI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Précédent &lt; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modes de fonctionnement des serveurs de messagerie</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Suivant&gt; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrements DNS pour les serveurs de messagerie</font></font></a><br>
<img src="https://habrastorage.org/webt/xd/iz/0b/xdiz0b5aiuipl9f9oylqxannogi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lorsque vous envoyez un message à quelqu'un, votre client de messagerie utilise le protocole ESMTP pour envoyer ce message, puis votre serveur de messagerie utilise le même protocole s'il doit transférer ce message à un autre serveur. </font><font style="vertical-align: inherit;">Et tandis que tout le monde parle et écrit SMTP, il s'agit généralement d'ESMTP - le même SMTP, mais avec un ensemble d'extensions, telles que l'autorisation et le cryptage. </font><font style="vertical-align: inherit;">Oui, une fois que SMTP n'a même pas pris en charge l'autorisation.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/q8/zz/xc/q8zzxcz0tpk86ealobs3ghe6hd4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant un peu sur SMTPS. </font><font style="vertical-align: inherit;">Une fois Internet était si simple que tout y était transmis en texte clair. </font><font style="vertical-align: inherit;">Viennent ensuite les protocoles de chiffrement cryptographiques, le même SSL. </font><font style="vertical-align: inherit;">Et les services qui transmettaient auparavant des informations sous une forme ouverte, ont commencé à envelopper le trafic dans SSL.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ly/sg/vilysgbdveruivjlnd6bx00uk2o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il n'a pas été facile de le faire sur les mêmes ports standard - le client et le serveur doivent s'entendre sur une méthode de cryptage, et pour qu'un service sur un port fonctionne simultanément pour certains avec cryptage, et pour d'autres sans - cela nécessiterait des modifications dans les protocoles. Et afin de ne pas tout compliquer, ils ont commencé à sculpter des ports séparés pour les connexions cryptées - c'est ainsi que 443 pour HTTPS et 465 pour SMTPS sont apparus. Mais nous l'avons réalisé en ce moment - il y a peu de ports dédiés, le nombre de services augmente, et si chacun d'entre eux utilisera plusieurs ports avec cryptage et sans cryptage à leurs fins - problème.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/se/qs/ku/seqskuovnrhned_eis83hcbf9x0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et à la fin, ils ont décidé de modifier un peu les protocoles. Dans certains cas, cela n'a pas très bien fonctionné, par exemple pour HTTP, et dans le cas de SMTP, cela s'est avéré être une option parfaitement adaptée. Pour cela, l'extension STARTTLS a été ajoutée à SMTP. En général, l'extension STARTTLS n'est pas seulement utilisée pour SMTP, en général c'est une commande pour démarrer les négociations de chiffrement. Contrairement à SMTPS, qui utilise un port dédié 465 et crypte immédiatement la connexion, STARTTLS n'est qu'une extension pour SMTP, ce qui signifie que la session est lancée en tant que session SMTP standard. Les serveurs de messagerie se saluent, puis proposent de commencer le cryptage et de sélectionner les protocoles cryptographiques disponibles.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3-/md/bw/3-mdbw0y7amg4gvwt2vh6e_csdy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, avec l'avènement de STARTTLS des normes, ils ont décidé de supprimer SMTPS sur le port 465 en tant que service distinct. Ils l'ont retiré des normes, mais le service est resté et est toujours utilisé. En ce qui concerne le cryptage, je ferai toujours un sujet distinct, mais pour l'instant parlons de STARTTLS.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bv/-v/pi/bv-vpiqh-9bsozbp7cu7ajr1vfq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai dit plus tôt qu'avec STARTTLS, les serveurs de messagerie ou un client / serveur ouvraient une connexion sans cryptage, puis convenaient du cryptage. Ils utilisent le même SSL / TLS pour le chiffrement. Mais que se passe-t-il s'ils ne peuvent pas s'entendre? Il s'avère qu'ils communiqueront sous forme non cryptée? Sur Internet? Pendant ce temps, ils acceptent sans aucun cryptage, trompant ainsi facilement le serveur ou le client par le manque de méthodes de cryptage disponibles. Et à un moment donné, ils ont attrapé l'un des fournisseurs dans une telle attaque. Et puis vous avez besoin d'un tel cryptage, demandez-vous. Tout n'est pas si désespéré. En fait, l'administrateur peut désactiver la possibilité d'envoyer du courrier s'il n'est pas possible de s'entendre sur le chiffrement, et les clients de messagerie sont tenus d'avertir que le serveur ne prend pas en charge le chiffrement.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jk/jd/yr/jkjdyrfzt3wgtv8rq35xchtqa3c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et donc, nous avons compris qu'il y a SMTP qui fonctionne sur le port 25, il y a SMTPS qui fonctionne sur 465, mais il y a un autre port - 587, qui est également utilisé par le serveur de messagerie.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qw/di/er/qwdiersbgizdugoml737dpbiihq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous l'avez remarqué, les clients de messagerie se connectent aux serveurs via SMTP. Et les serveurs de messagerie se connectent également via SMTP. J'ai également dit dans la dernière partie qu'il existe de tels serveurs - des hôtes relais qui transfèrent le courrier. Pour certaines raisons, principalement humaines, il existe des hôtes relais sur Internet qui permettent aux utilisateurs non autorisés de rediriger les messages depuis n'importe quelle adresse. Et ces hôtes apparaissent chaque fois qu'un administrateur négligent soulève le serveur de messagerie, et cela se produit souvent. En conséquence, les attaquants lèvent des serveurs temporaires ou infectent les ordinateurs des utilisateurs qui envoient du spam via ces relais à des hôtes sans autorisation. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/im/ml/ftimml9dpl0jriux1qzfyk4vxkm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, certains fournisseurs Internet bloquent toutes les connexions utilisateur au port 25.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f2/zd/w9/f2zdw98_ws_lxyyldagtxnhuaf0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce port est ouvert entre les serveurs sur Internet, mais ils ont créé un service distinct pour les utilisateurs - MSA (agent de soumission des messages - agent d'envoi), séparant ainsi les connexions utilisateur des connexions serveur qui communiquent toujours via MTA. En général, MSA fonctionne même sur le port 25, mais le port officiel est le 587. Qu'est-ce qui empêche les spammeurs d'utiliser ce port? Le fait que le MSA, en règle générale, nécessite une autorisation de l'utilisateur. Ce n'est pas la seule raison de l'existence de MSA - car il fonctionne avec les clients de messagerie, il est mieux optimisé pour le travail des clients - il avertit immédiatement de toute erreur dans les messages, par exemple, l'absence de l'adresse de domaine du destinataire.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nk/in/xg/nkinxgm7k5y9--jpyllipbfbej4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, suivons le processus d'envoi d'un e-mail. </font><font style="vertical-align: inherit;">Pour ce faire, utilisez Wireshark, un client de messagerie et un compte Gmail. </font><font style="vertical-align: inherit;">Tout commence par la négociation TCP standard, après quoi la session SMTP est lancée. </font><font style="vertical-align: inherit;">Dans la session, le client de messagerie et le serveur se saluent, après quoi le client de messagerie propose de crypter la session, le serveur accepte, après quoi les clés sont échangées et la session TLSv1.3 commence, après quoi le client se connecte crypté et envoie un message qui n'est pas visible pour un intercepteur de trafic.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495242/index.html">5NO - NodeJS ORM pour Postgres</a></li>
<li><a href="../fr495246/index.html">Spécialiste SAP: qui est et comment en devenir un</a></li>
<li><a href="../fr495248/index.html">Le rôle de l'auto-isolement et du lavage des mains</a></li>
<li><a href="../fr495250/index.html">Les manettes de jeu ont-elles un avenir?</a></li>
<li><a href="../fr495254/index.html">Simulation de cyberattaques ciblées, Red Team, Pentest, analyse de vulnérabilité. Avantages et inconvénients de diverses méthodes</a></li>
<li><a href="../fr495258/index.html">Comment Zoom est devenu l'entreprise la plus importante à l'ère des coronavirus</a></li>
<li><a href="../fr495262/index.html">Pratique de mise à niveau de la version PostgreSQL. Andrey Salnikov</a></li>
<li><a href="../fr495266/index.html">E-learning de la Renaissance. Pourquoi 2020 montrera tous les avantages de l'enseignement à distance</a></li>
<li><a href="../fr495268/index.html">Cas UI / UX: automatisation du stationnement dans les aéroports</a></li>
<li><a href="../fr495272/index.html">Emulateurs SNES à quelques pixels de la perfection absolue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>