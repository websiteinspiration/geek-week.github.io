<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“ ğŸ‘¨ğŸ¿â€ğŸ’¼ â™ï¸ IntÃ©grez votre appareil Smart Home dans l'Ã©cosystÃ¨me SmartThings ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ ğŸ™ğŸ¾ ğŸ¦ˆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les plateformes Smart Home vous permettent d'intÃ©grer des appareils et de crÃ©er de nouveaux scÃ©narios pour leur interaction. L'effet de plate-forme es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IntÃ©grez votre appareil Smart Home dans l'Ã©cosystÃ¨me SmartThings</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/samsung/blog/489834/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les plateformes Smart Home vous permettent d'intÃ©grer des appareils et de crÃ©er de nouveaux scÃ©narios pour leur interaction. </font><font style="vertical-align: inherit;">L'effet de plate-forme est connu: les utilisateurs sont plus susceptibles de choisir celui avec lequel leurs appareils existants sont compatibles, plutÃ´t que de passer Ã  un nouveau. </font><font style="vertical-align: inherit;">Par consÃ©quent, pour les dÃ©veloppeurs de nouveaux appareils ingÃ©nieux, il peut s'avÃ©rer plus rentable de s'intÃ©grer dans une plate-forme dÃ©jÃ  terminÃ©e, en se concentrant sur le produit Â«ferÂ», plutÃ´t que de dÃ©velopper vos propres Â«vÃ©losÂ» sous la forme d'Ã©cosystÃ¨mes cloud et de comptes personnels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons comment intÃ©grer votre propre appareil Ã  la plateforme Samsung SmartThings Smart Home. </font><font style="vertical-align: inherit;">Nous mettons en Å“uvre une option de connexion directe pour contrÃ´ler l'appareil Smart Home en utilisant l'exemple d'un interrupteur Ã  bouton et d'une ampoule tricolore.&nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cx/se/xy/cxsexydnzipoeqmkj3n7jq9x4iu.gif"><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi avons-nous besoin de plateformes Smart Home?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, des gadgets et des appareils intelligents sont en vente - autant que vous le souhaitez. Pas de problÃ¨me pour acheter une bouilloire avec contrÃ´le Bluetooth ou une ampoule avec WiFi. Mais cela rend-il votre maison Â«intelligenteÂ»? Une situation n'est pas rare: une ampoule n'est contrÃ´lÃ©e que via une application mobile du constructeur. Cela crÃ©e des inconvÃ©nients si vous essayez de combiner au moins plusieurs marques diffÃ©rentes. Par consÃ©quent, la plate-forme idÃ©ale est celle qui vous permet de gÃ©rer les appareils de diffÃ©rents fabricants de la mÃªme maniÃ¨re.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, j'aimerais voir un Â«ordinateur se dissoudre dans la vie de tous les joursÂ», comme le rÃªvait Mark Weiser de Xerox PARC: ne contrÃ´lez pas via une application spÃ©ciale, ne vaporisez pas votre attention. Je voudrais une interaction naturelle avec un environnement intelligent qui ne change pas nos habitudes. Comment l'implÃ©menter techniquement? Par exemple, il peut s'agir de scÃ©narios impliquant des appareils hÃ©tÃ©rogÃ¨nes dans la maison: vous vous Ãªtes rÃ©veillÃ© - l'appareil portable l'a dÃ©tectÃ© et la bouilloire s'est allumÃ©e; vous Ãªtes rentrÃ© Ã  la maison - le capteur sur la porte l'a enregistrÃ©, en tenant compte de l'heure, des rideaux fermÃ©s, de la lampe allumÃ©e et de la climatisation allumÃ©e en tenant compte de la tempÃ©rature.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scÃ©narios deviennent encore plus utiles si nous utilisons Internet: par exemple, pour vÃ©rifier Ã  distance si la prise avec le fer Ã  repasser est fermÃ©e. </font><font style="vertical-align: inherit;">Ou un exemple banal: votre maison intelligente a regardÃ© les prÃ©visions mÃ©tÃ©orologiques et vous a donnÃ© des conseils sur la meilleure faÃ§on de s'habiller. </font><font style="vertical-align: inherit;">Ou vous pouvez ajouter une commande vocale via un haut-parleur intelligent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plateforme Smart Home est conÃ§ue pour tout cela. </font><font style="vertical-align: inherit;">ConsidÃ©rez ce que la plateforme Samsung SmartThings peut faire.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contexte - Que sont les SmartThings?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SmartThings a commencÃ© en tant que startup. Au moment oÃ¹ il est apparu, en 2012 aux Ã‰tats-Unis, le thÃ¨me de la Â«Smart HomeÂ» n'Ã©tait pas encore au sommet du battage mÃ©diatique, il n'y avait toujours pas d'enceintes intelligentes et une variÃ©tÃ© de gadgets en magasin. L'idÃ©e est venue au fondateur de la startup, Alex Hawkinson, aprÃ¨s un incident: sa maison familiale au Colorado a souffert du fait qu'aprÃ¨s une panne de courant temporaire, les conduites d'eau Ã©taient trÃ¨s froides, elles ont Ã©clatÃ© et tout le sol a Ã©tÃ© inondÃ©. Puis il a pensÃ© qu'il aurait pu prÃ©venir le problÃ¨me s'il avait su ce qui se passait dans la maison.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir vainement cherchÃ© une solution clÃ© en main, Hawkinson et ses collÃ¨gues ont rÃ©alisÃ© un prototype de l'appareil et lancÃ© une campagne sur Kickstarter. La campagne a connu un succÃ¨s excessif, recueillant 1 200 000 $ au lieu des 250 000 $ prÃ©vus dans 30 jours. La vente d'un hub hub avec un petit ensemble d'appareils dans le kit a commencÃ©: prise intelligente, capteur d'ouverture de porte, capteur de mouvement, capteur de prÃ©sence. Et en 2019, dÃ©jÃ  sous la marque Samsung SmartThings, la troisiÃ¨me version du hub a Ã©tÃ© lancÃ©e. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/xk/vi/hexkviuwr8rq2bf7z84ft-akdnm.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La clÃ© du succÃ¨s sur Kickstarter Ã©tait la disponibilitÃ© de prototypes fonctionnels de fer et de logiciels, et la convivialitÃ© pour la communautÃ© des fabricants</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les crÃ©ateurs de la startup ont quittÃ© l'environnement de bricolage, ils dÃ©veloppent donc constamment le concept d'une API ouverte pour les fabricants de geek qui peuvent agir en tant qu'adopteurs prÃ©coces Ã  un stade prÃ©coce. Dans la campagne Kickstarter, il y avait un bouclier pour Arduino et divers modules cloud pour connecter en toute transparence votre appareil tiers. Sur Internet, vous pouvez trouver de nombreux exemples d'appareils faits maison compatibles avec SmartThings, qu'il s'agisse d'une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">porte de poulailler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contrÃ´lÃ©e </font><font style="vertical-align: inherit;">(avec la solution d'une tÃ¢che de la vie sÃ©rieuse - pour sauver les poulets d'un vison prÃ©dateur), ou de l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation Ã </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distance </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">d'</font></a><font style="vertical-align: inherit;"> un code de verrouillage Ã©lectronique pour les clients avec Airbnb. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/fd/tl/ctfdtl25yhvhmrnz2yufm_qwhfw.jpeg" width="500"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source de la photo: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.hackster.io/aaronpk/auto-airbnb-entry-745799</font></font></a></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2012-2013, SmartThings a effectuÃ© plusieurs cycles d'investissement et a reÃ§u 12,5 millions de dollars. </font><font style="vertical-align: inherit;">Enfin, en 2014, elle s'est intÃ©ressÃ©e Ã  Samsung et a Ã©tÃ© acquise pour 200 millions de dollars dans le cadre d'une stratÃ©gie visant Ã  pÃ©nÃ©trer le marchÃ© de l'Internet des objets. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les capacitÃ©s du cloud de la plate-forme sont restÃ©es gratuites: les auteurs, dÃ©sormais employÃ©s de Samsung, n'excluant pas la possibilitÃ© thÃ©orique de facturer de gros volumes de trafic, soulignent: il y aura toujours une option gratuite pour les dÃ©veloppeurs d'appareils. </font><font style="vertical-align: inherit;">C'est bien, car maintenant presque tous les services cloud prÃ©voient la monÃ©tisation, et souvent mÃªme pour une pÃ©riode d'essai, vous devez joindre une carte bancaire. </font><font style="vertical-align: inherit;">SmartThings est une plateforme entiÃ¨rement gratuite.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture de SmartThings</font></font></h1><br>
<img src="https://habrastorage.org/webt/dm/gw/ir/dmgwirddjoqbh-1caazcx5kg-sc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DÃ©plaÃ§ons le motif de gauche Ã  droite.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispositifs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PÃ©riphÃ©riques SmartThings - il peut s'agir non seulement de pÃ©riphÃ©riques de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la suite SmartThings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais Ã©galement de nombreux partenaires tiers de la liste des partenaires. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ut/j6/oq/utj6oqymmwwnqazkm_jekxgymwq.jpeg" width="300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'appareil ne figure pas dans la liste des appareils officiellement pris en charge, vous pouvez y rechercher le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gestionnaire d'appareil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - il peut Ãªtre fourni par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la communautÃ© des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dÃ©veloppeurs - ou Ã©crire le vÃ´tre.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MÃ©thodes de connexion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez connecter des appareils Ã  la plate-forme des maniÃ¨res suivantes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConnectÃ© au concentrateur - via un concentrateur concentrateur, pertinent pour les appareils qui n'ont pas leur connexion Internet, mais qui sont connectÃ©s via des rÃ©seaux sans fil traditionnels comme ZigBee pour de tels systÃ¨mes.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directement connectÃ© - via Internet directement au cloud. </font><font style="vertical-align: inherit;">SmartThings a rÃ©cemment </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publiÃ© un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> camÃ©scope, une ampoule et une prise intelligente, et ils fonctionnent sans concentrateur - via le WiFi. </font><font style="vertical-align: inherit;">C'est l'option que nous allons implÃ©menter dans ce guide.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConnectÃ© au cloud - via un cloud tiers pour les appareils qui ont dÃ©jÃ  leur propre Ã©cosystÃ¨me cloud. </font><font style="vertical-align: inherit;">C'est plus compliquÃ©, donc nous n'envisagerons pas une telle option.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Centre</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En rÃ¨gle gÃ©nÃ©rale, pour connecter une variÃ©tÃ© d'Ã©quipements dans votre maison devrait Ãªtre un petit serveur spÃ©cial "Smart Home" qui prend en charge divers protocoles. </font><font style="vertical-align: inherit;">Lui - un hub, un hub, une passerelle - les noms sont diffÃ©rents. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gx/yy/_b/gxyy_bk9o6kvzdfzldagqw4lbb0.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hub et un ensemble d'appareils Ã  elle. </font><font style="vertical-align: inherit;">Source de la photo: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IXBT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application SmartThings est une application qui peut Ãªtre installÃ©e sur le systÃ¨me d'exploitation mobile principal et avec son aide: ajouter de nouveaux appareils au systÃ¨me, contrÃ´ler ceux dÃ©jÃ  ajoutÃ©s, dÃ©finir des rÃ¨gles d'automatisation, recevoir des notifications par push et SMS, et bien plus encore.&nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ua/tu/-q/uatu-qhi_oijgiuumtopuqsjedk.png" width="400"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abstraction</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans SmartThings, comme dans de nombreuses autres plates-formes de maison intelligente, il existe les abstractions suivantes: piÃ¨ces, scÃ¨nes, scÃ©narios.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les appareils sont regroupÃ©s en piÃ¨ces. </font><font style="vertical-align: inherit;">Vous attachez simplement tel ou tel gadget Ã  une piÃ¨ce de l'application et vous l'appelez Â«CuisineÂ», Â«Salle de bainÂ», Â«CouloirÂ». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe encore des scÃ¨nes (scÃ¨nes) - ce sont des situations: Â«sommeilÂ», Â«reposÂ», Â«travailÂ», Â«regarder un filmÂ» - chacune des situations est caractÃ©risÃ©e par son propre ensemble d'Ã©tats de pÃ©riphÃ©rique. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/vo/5o/qtvo5o8yo8thwuwhptupdthayjc.png" width="300"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScÃ¨nes et piÃ¨ces sur l'Ã©cran d'application</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, les scripts (Routines): rÃ¨gles d'automatisation if-then. Par dÃ©faut, le programme comporte quatre scÃ©narios: Â«Je suis de retourÂ», Â«Bonne nuitÂ», Â«Au revoirÂ», Â«BonjourÂ». Vous pouvez configurer l'activation du script en fonction de la condition du matin, ou en cas de mouvement, ou en cas d'ouverture de la porte, etc. Un exemple non trivial: lorsque j'entre du trafic rÃ©seau Ã  domicile sur ma camÃ©ra de surveillance Ã  domicile pour Ã©viter la fuite de mes vidÃ©os personnelles. Ou un exemple Ã©ducatif cruel: dÃ©connectez de force la tablette du rÃ©seau quand il est 11 heures du soir pour vous empÃªcher de rester sur Internet au lieu d'un sommeil sain.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7j/gp/qg/7jgpqgdehbjdzjtpmfnf7a2supc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, dans le programme SmartThings au tÃ©lÃ©phone, il existe une opportunitÃ© intÃ©ressante - mÃ©moriser des actions typiques. Lorsque vous utilisez souvent le tÃ©lÃ©phone, au fil du temps, il commence Ã  vous indiquer la meilleure faÃ§on de configurer les scÃ¨nes en fonction des applications les plus frÃ©quemment lancÃ©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter de nouveaux pÃ©riphÃ©riques au systÃ¨me, un systÃ¨me de plug-in est fourni. Le dÃ©veloppeur peut programmer le plug-in pour son propre appareil - l'interface utilisateur Ã  l'intÃ©rieur de l'application SmartThings et la logique de l'appareil. Il s'agit essentiellement d'une application Web. Du point de vue du dÃ©veloppeur, le plugin peut s'abonner aux Ã©vÃ©nements ou notifications de l'appareil, lui envoyer un message, surveiller l'Ã©tat de la connexion avec l'appareil. Il existe une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> claire </font><font style="vertical-align: inherit;">sur le cycle de vie du plugin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils sont tÃ©lÃ©chargÃ©s par l'utilisateur depuis le "plug-in store" selon les besoins, afin de ne pas gonfler l'application sur le tÃ©lÃ©phone. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2t/i7/6p/2ti76pkvardmqwv2efyxjh5nec4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais maintenant, nous ne ferons plus de plug-ins, mais nous allons simplifier: nous allons ajouter un appareil fait maison en utilisant uniquement des outils de plate-forme standard.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendre votre appareil compatible avec SmartThings</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous avez peut-Ãªtre une question: pourquoi? </font><font style="vertical-align: inherit;">Quel est l'intÃ©rÃªt de le rendre compatible si vous Ãªtes dÃ©veloppeur d'appareils?</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principal avantage est l'augmentation de la valeur du produit grÃ¢ce Ã  l'intÃ©gration automatique avec l'ensemble de l'Ã©cosystÃ¨me.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sous rÃ©serve du succÃ¨s des tests fonctionnels, vous pouvez coller le logo: Â«Compatible avec SmartThingsÂ» sur la boÃ®te du produit, garantissant ainsi une installation et une configuration sans problÃ¨me de l'appareil dans l'Ã©cosystÃ¨me SmartThings.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme avec n'importe quelle plate-forme, votre tÃ¢che est facilitÃ©e: vous n'avez plus besoin d'essayer de dÃ©velopper, par exemple, une interface utilisateur - vous pouvez utiliser les boutons standard et d'autres Ã©lÃ©ments de l'interface SmartThings.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous obtenez des relations publiques et un public d'utilisateurs grÃ¢ce Ã  la communautÃ© SmartThings (elle est vivante et active).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le manuel ci-dessous, nous connecterons notre propre appareil entiÃ¨rement personnalisÃ©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que propose-t-on de faire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le SDK SmartThings Device (STDK) a rÃ©cemment Ã©tÃ© prÃ©sentÃ© Ã  la Samsung Developer Conference en octobre 2019. Ci-dessous, nous proposons une traduction du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manuel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de ce SDK. Et pas seulement une traduction: nous avons fait la mÃªme chose et l'avons rÃ©pÃ©tÃ©e de nos propres mains, il y aura donc des commentaires pratiques qui vont au-delÃ  du manuel d'origine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ã€ quoi ressemblera le rÃ©sultat final dans la vidÃ©o:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Rvo6pbI2-0U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La lampe RVB est connectÃ©e Ã  la plate-forme SmartThings via WiFi, et vous la contrÃ´lez via le tÃ©lÃ©phone. La lampe elle-mÃªme est mise en Å“uvre de la maniÃ¨re la moins chÃ¨re et la plus simple - sur la puce ESP8266 super populaire. Le fer n'est pas important: il peut Ãªtre fait sur n'importe quel microcontrÃ´leur, car le SDK est Ã©crit en C, disposÃ© dans le domaine public et il peut Ãªtre portÃ© si vous le souhaitez. Il est peu probable que l'ESP entre en production (pour commencer, il est plus pratique d'utiliser d'autres interfaces dans la maison intelligente que le WiFi), mais il convient tout Ã  fait au modÃ¨le et Ã  l'illustration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonctionnalitÃ© de l'ampoule intelligente qui en rÃ©sulte sera la suivante: ContrÃ´le LED RVB Ã  l'aide de la roue chromatique du tÃ©lÃ©phone. En plus de l'Ã©teindre et de l'activer Ã  l'aide du bouton. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus de dÃ©veloppement est illustrÃ© dans le diagramme:</font></font><br>
<img src="https://habrastorage.org/webt/ba/kb/_h/bakb_hunqhwmmaovm0jk2xrbqgk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus indiquÃ© n'est pas difficile, certaines Ã©tapes peuvent Ãªtre inversÃ©es, ce que nous montrerons dans le manuel.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le manuel d'origine montre tout sur l'exemple de la carte WeMos D1 Mini, il s'agit d'une carte de dÃ©bogage basÃ©e sur ESP8266 qui peut Ãªtre insÃ©rÃ©e dans la planche Ã  pain. </font><font style="vertical-align: inherit;">En gÃ©nÃ©ral, il n'y a rien de dÃ©licat, c'est juste un module de la puce ESP chinoise qui est super populaire parmi les fans, soudÃ© pour plus de commoditÃ© Ã  une carte plus large de la taille de la planche Ã  pain. </font><font style="vertical-align: inherit;">Par consÃ©quent, vous pouvez tout faire sur n'importe quel autre tableau. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/lo/8t/rslo8ts8_gfmrhvrrnh-jb87yry.jpeg" width="200"> <img src="https://habrastorage.org/webt/bl/sg/mw/blsgmwf3onhbr9x9y4s9dxialiw.jpeg" width="200"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gauche: WeMos D1, droite - Troyka WiFi Shield</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Doux</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce dont vous avez besoin pour construire l'exemple:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version Ubuntu Linux pas infÃ©rieure Ã  18.04 (vous pouvez construire un exemple pour Windows et MacOS, mais pour Ãªtre prÃ©cis, nous avons choisi Linux)</font></font><br>
</li>
<li>  Android    1.7.39,  iOS    1.6.41-343.   Play Market  SmartThings,     Samsung Account.       Samsung,    .<br>
</li>
<li>ESP8266 SDK.  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  ,   ,   :<br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/espressif/ESP8266_RTOS_SDK.git</code></pre><br>
     SDK   IDF_PATH:<br>
<br>
<pre><code class="bash hljs">nano ~/.bashrc
<span class="hljs-built_in">export</span> IDF_PATH=<span class="hljs-string">"~/git/ESP8266_RTOS_SDK:<span class="hljs-variable">$IDF_PATH</span>"</span></code></pre></li>
<li>   :<br>
<br>
<pre><code class="bash hljs">sudo apt-get install gcc git wget make libncurses-dev flex bison gperf python python-pip python-setuptools python-serial python-cryptography python-future python-pyparsing python-pyelftools</code></pre><br>
   ():<br>
<br>
<pre><code class="bash hljs">sudo mkdir /opt/Espressif<font></font>
sudo chown username /opt/Espressif/<font></font>
<span class="hljs-built_in">cd</span> /opt/Espressif<font></font>
wget https://dl.espressif.com/dl/xtensa-lx106-elf-linux64-1.22.0-100-ge567ec7-5.2.0.tar.gz<font></font>
tar -xzf ./xtensa-lx106-elf-linux64-1.22.0-100-ge567ec7-5.2.0.tar.gz<font></font>
<span class="hljs-built_in">cd</span> xtensa-lx106-elf
<span class="hljs-built_in">export</span> PATH=<span class="hljs-string">"/opt/Espressif/xtensa-lx106-elf/bin:<span class="hljs-variable">$PATH</span>"</span></code></pre><br>
</li>
<li>Smart Things Device SDK C â€“   .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  github,         ,     ,       .<br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/SmartThingsCommunity/st-device-sdk-c-ref.git
<span class="hljs-built_in">cd</span> st-device-sdk-c-ref<font></font>
./setup.sh esp8266</code></pre><br>
</li>
</ul><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les appareils suivants seront considÃ©rÃ©s comme des exemples: interrupteur intelligent et ampoule intelligente. </font><font style="vertical-align: inherit;">Nous allons commencer par un interrupteur intelligent, plus simple et ne nÃ©cessitant aucun pÃ©riphÃ©rique externe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‰tape 1. Enregistrez votre appareil.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le travail commence dans l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace de travail du dÃ©veloppeur SmartThings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oÃ¹ vous devez vous connecter Ã  l'aide de votre compte Samsung. </font><font style="vertical-align: inherit;">Ce compte est crÃ©Ã© gratuitement, et pour le crÃ©er il n'est pas nÃ©cessaire d'avoir un tÃ©lÃ©phone Samsung.&nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rz/vc/tb/rzvctbgclnb7ug6rcxccoqsfe88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Developer Workspace, il vous est immÃ©diatement proposÃ© de crÃ©er le premier projet. </font><font style="vertical-align: inherit;">Nous sommes d'accord, aprÃ¨s quoi, parmi les deux options de projet, vous devez sÃ©lectionner l'intÃ©gration des pÃ©riphÃ©riques. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mh/7z/0f/mh7z0fghp37p2_kfmlj4p3bjkvg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le choix sera donnÃ© trois options pour intÃ©grer l'appareil:&nbsp;</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmartThings Cloud Connector - pour connecter des appareils qui ont leur propre cloud qui seront connectÃ©s au cloud SmartThings</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmartThings Hub n'est pas disponible pour les appareils ZigBee, Z-Wave, Bluetooth et au moment de la rÃ©daction, car le hub n'est pas encore officiellement vendu en Russie</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directly Connected est l'option la plus simple pour se connecter directement, sans intermÃ©diaire.&nbsp;</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choisissez la troisiÃ¨me option. </font><font style="vertical-align: inherit;">Pensez Ã  un nom de projet, par exemple, pour plus de simplicitÃ© - SmartSwitch. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/dg/5w/ordg5wpiqskc-9kyau_hjlquhaq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez un profil d'appareil. </font><font style="vertical-align: inherit;">En termes de POO, un profil de pÃ©riphÃ©rique est une telle Â«classeÂ», et un pÃ©riphÃ©rique spÃ©cifique est une Â«instance de classeÂ». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons dÃ©terminer les caractÃ©ristiques fonctionnelles de l'appareil en termes de capacitÃ© SmartThings. </font><font style="vertical-align: inherit;">Vous pouvez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur les Â«capacitÃ©sÂ» gÃ©nÃ©rales de l'appareil </font><font style="vertical-align: inherit;">dans le manuel.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gk/sx/wl/gksxwlnkswip3cxd21fngup5jc0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous remplissons les champs avec nos valeurs. </font><font style="vertical-align: inherit;">Par exemple, le nom du profil peut Ãªtre saisi Test Switch Profile, description - n'importe quel texte, type d'appareil - Switch, Vendor ID - n'importe quel texte. </font><font style="vertical-align: inherit;">"Type d'appareil" affecte l'icÃ´ne de votre appareil et l'interface utilisateur. </font><font style="vertical-align: inherit;">Il n'y a pas beaucoup de types d'appareils possibles sur la liste (bien qu'il y en ait des exotiques, par exemple WineCellar - une cave Ã  vin), donc si vous ne trouvez pas le vÃ´tre, ne vous dÃ©couragez pas et choisissez simplement le plus proche et le plus proche. </font><font style="vertical-align: inherit;">Sur le dernier Ã©cran (Dashboard Control), vous ne pouvez rien changer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir crÃ©Ã© le profil, n'oubliez pas de cliquer sur le bouton Â«Ajouter un profil d'appareil au projetÂ» en haut Ã  droite.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/py/_m/ou/py_mouuxfu6aqpzsuhypzlwxhau.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important: Health Check est requis pour tous les appareils directement connectÃ©s. </font><font style="vertical-align: inherit;">Ajoutez-le au profil de l'appareil.&nbsp;</font></font><br>
</li>
<li>  Â« Â»   : Switch, Health Check.<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez maintenant le profil d'authentification (profil d'intÃ©gration). En bref, dans ce profil, vous pouvez personnaliser les Ã©crans qui apparaissent lorsque vous vous connectez et vous connectez pour la premiÃ¨re fois. Saisissez un nom et un numÃ©ro Ã  trois chiffres. Vous pouvez ignorer les deux autres Ã©crans pour l'instant. Sur le dernier Ã©cran, sÃ©lectionnez l'option de confirmation - Bouton Confirmer - en appuyant sur le bouton de l'appareil. Dans ce manuel, nous supposons que vous avez une carte avec un bouton intÃ©grÃ©. Si tout Ã  coup il n'y a pas de bouton (par exemple, vous utilisez un autre module ESP), alors vous pouvez choisir l'option sans authentification du tout - elle s'appelle Just Works, c'est-Ã -dire qu'elle Â«fonctionne justeÂ» sans aucune question. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et encore une fois, par analogie avec l'exemple prÃ©cÃ©dent, n'oubliez pas de cliquer sur le bouton "Ajouter l'intÃ©gration de l'appareil au projet".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_4/8w/k1/_48wk1mewseukstfc4rbvdjx8qw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne reste plus qu'Ã  cliquer sur le bouton DÃ©ployer. </font><font style="vertical-align: inherit;">AprÃ¨s cela, vous pouvez voir votre appareil dans l'application SmartThings - mais uniquement en mode dÃ©veloppeur. </font><font style="vertical-align: inherit;">Si Deploy n'est pas poussÃ© et qu'ils Ã©crivent Â«Veuillez ajouter un nom de modÃ¨leÂ» - cela signifie que vous n'avez pas spÃ©cifiÃ© d'ID d'intÃ©gration de pÃ©riphÃ©rique, faites dÃ©filer la page ci-dessous et faites-le - entrez le nom de votre choix. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l1/cc/pr/l1ccprru9d4xx-2onzisikmuhlk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez maintenant commencer Ã  tester votre appareil virtuel sur votre tÃ©lÃ©phone. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premiÃ¨re Ã©tape entiÃ¨re est prÃ©sentÃ©e en dÃ©tail dans la vidÃ©o:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/0KLJNC2nj5M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrer un appareil dans le cloud</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer Ã  travailler avec le matÃ©riel rÃ©el, vous devez faire autre chose. AprÃ¨s avoir appuyÃ© sur le bouton DÃ©ployer, l'Ã©cran sera diffÃ©rent: un nouveau champ IdentitÃ© du pÃ©riphÃ©rique y apparaÃ®tra.&nbsp; </font></font><br>
<img src="https://habrastorage.org/webt/ow/hj/tk/owhjtkpdu8stli8nbv5hykchulo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour authentifier votre appareil dans le cloud SmartThings, vous devez entrer son numÃ©ro de sÃ©rie et sa clÃ© publique (avec le schÃ©ma de signature ED25519). C'est assez simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet exemple montre comment crÃ©er une paire de clÃ©s ED25519 Ã  l'aide d'un outil du SDK. Vous obtiendrez le fichier </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">device_info.json</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme rÃ©sultat du programme dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dossier tools / keygen / linux / output_ {serialNumber}</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La version Linux de keygen se trouve dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st-iot-device-sdk-c-reference / iot-core / tools / keygen / linux</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st-device-sdk-c / tools / keygen / linux</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le numÃ©ro de sÃ©rie de l'appareil de test sera gÃ©nÃ©rÃ© de maniÃ¨re alÃ©atoire au format STDK + [MNID] + format alphanumÃ©rique (8 caractÃ¨res). </font><font style="vertical-align: inherit;">Vous pouvez trouver votre MNID dans le profil de dÃ©veloppeur dans la section GÃ©rer le compte.&nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f6/6b/tq/f66btqfqggupzu83olz6lbaru6c.png" width="300"><br>
<br>
<img src="https://habrastorage.org/webt/qv/1k/p0/qv1kp0xha-it8b8xnyaa4hj2fe8.png" width="300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, pour gÃ©nÃ©rer la partie alphanumÃ©rique, vous devez entrer votre MNID (4 caractÃ¨res) comme paramÃ¨tre keygen. </font><font style="vertical-align: inherit;">Dans l'exemple ci-dessous, le MNID est fJ * c.</font></font><br>
<br>
<pre><code class="bash hljs">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">cd</span> ~/Workspace/st-iot-device-sdk-c-ref/iot-core/tools/keygen<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;./stdk-keygen -m fJ*c<font></font>
&nbsp;&nbsp;&nbsp; Go Device Identity of Developer Workspace.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;Serial Number:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;â”‚ STDKfJ*c&nbsp; &nbsp; â”‚ abed**5c   â”‚<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;Public Key:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;waGgyjWIvHhF1LU***FG2hx/4u***ADFHr/ry0j5jbk=<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez Â«abed ** 5cÂ» de l'Ã©mission keygen et collez-le dans les champs XXXXXXXX de la section Enregistrement de l'identitÃ© du pÃ©riphÃ©rique. </font><font style="vertical-align: inherit;">Une fenÃªtre apparaÃ®tra vous demandant d'entrer la clÃ© publique. </font></font><br>
<img src="https://habrastorage.org/webt/wv/bd/ft/wvbdftti3tqz7qug9us-jphddq8.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez la clÃ© publique de l'Ã©mission keygen (Â«waGgyjWIvHhF1LU *** FG2hx / 4u *** ADFHr / ry0j5jbk =Â» dans cet exemple) et collez-la dans le champ Â«Device Public KeyÂ».</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gx/wn/60/gxwn602ru15zwlvouhg68zo8918.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‰tape 2. Micrologiciel de l'appareil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlez du code que vous tÃ©lÃ©chargerez sur l'appareil. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des exemples de firmware se trouvent dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dossier st-device-sdk-c-ref / apps / esp8266 /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous serons intÃ©ressÃ©s par l'exemple </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st_switch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TÃ©lÃ©chargez </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onboarding_profile.json</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la fenÃªtre de </font><b><font style="vertical-align: inherit;">prÃ©sentation</font></b><font style="vertical-align: inherit;"> de votre appareil dans le bureau du dÃ©veloppeur.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o5/he/mn/o5hemnlglw1ak1cu134aqeka4sm.png"><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiez le fichier </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onboarding_profile.json</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tÃ©lÃ©chargÃ© </font><font style="vertical-align: inherit;">dans le rÃ©pertoire de votre application - dans notre cas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apps / esp8266 / st_switch / main</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~/Workspace/st-device-sdk-c-ref/apps/esp8266/st_switch/main/<font></font>
cp ~/Downloads/onboarding_profile.json .<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe dÃ©jÃ  un exemple d'un tel fichier - remplacez-le simplement par le vÃ´tre.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De mÃªme, copiez le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">device_info.json</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fichier </font><font style="vertical-align: inherit;">de l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outil / keygen / linux / output_ {} serialNumber dossier</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans lequel les informations spÃ©cifiques Ã  l' </font><font style="vertical-align: inherit;">appareil se trouve, dans le mÃªme dossier, en </font><font style="vertical-align: inherit;">remplaÃ§ant le fichier existant.</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~/Workspace/st-device-sdk-c-ref/iot-core/tools/keygen/linux/<font></font>
cp output_{serialNumber}/device_info.json ~/Workspace/st-device-sdk-c-ref/apps/esp8266/st_switch/main/</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce fichier, en plus des clÃ©s et du numÃ©ro de sÃ©rie, il y a la ligne Â«firmwareVersionÂ» - elle peut Ãªtre remplacÃ©e par la version de votre programme.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, assemblez et flashez le programme.</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~/Workspace/st-device-sdk-c-ref<font></font>
./build.sh esp8266 st_switch<font></font>
./build.sh esp8266 st_switch flash<font></font>
./build.sh esp8266 st_switch monitor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou le mÃªme, mais plus court:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~/Workspace/st-device-sdk-c-ref<font></font>
./build.sh esp8266 st_switch flash monitor</code></pre><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
! </font><font style="vertical-align: inherit;">Si vous ne pouvez pas flasher le programme de quelque maniÃ¨re que ce soit, vous avez probablement oubliÃ© de mettre la carte ESP8266 en mode de programmation. </font><font style="vertical-align: inherit;">Cela se fait gÃ©nÃ©ralement en appuyant sur un bouton de la carte elle-mÃªme. </font><font style="vertical-align: inherit;">Par exemple, le module Wi-Fi Troyka peut Ãªtre traduit en maintenant enfoncÃ© le bouton PROG, puis en appuyant et en relÃ¢chant le bouton RESET. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois le firmware tÃ©lÃ©chargÃ©, n'oubliez pas de redÃ©marrer la carte.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‰tape 3. Connexion et contrÃ´le depuis le tÃ©lÃ©phone</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Activez le mode dÃ©veloppeur dans l'application SmartThings sur votre tÃ©lÃ©phone. Comment faire est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©crit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le site officiel, mais il est plus facile de l'expliquer avec des mots: entrez les paramÃ¨tres via le "gear" et appuyez sur le bouton "SmartThings Details" pendant 20 secondes. Le menu Â«Developer ModeÂ» apparaÃ®t ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/di/vs/hs/divshsyn6jnwbmaox3t_mkpaebe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre appareil doit Ãªtre visible dans la liste de l'application SmartThings: lancez l'application, cliquez sur le bouton plus et Ajouter un appareil. Faites dÃ©filer jusqu'Ã  la fin de la liste des fournisseurs et voyez l'icÃ´ne Â«Mes appareils de testÂ». Cliquez dessus et sÃ©lectionnez votre appareil. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_o/ks/pa/_okspakmd1pndm_lh-xpbeehyw8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus: si vous avez dÃ©jÃ  activÃ© le mode dÃ©veloppeur et allumÃ© l'appareil, vous aurez alors un menu contextuel proposant d'ajouter cet appareil particulier! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion </font><i><font style="vertical-align: inherit;">dÃ©marre</font></i><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8n/by/pd/8nbypdf-00xmksrlukpvetjlv2m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gÃ©rez l'appareil Ã  partir de l'application SmartThings.&nbsp;</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un premier temps, l'appareil apparaÃ®t comme un point d'accÃ¨s, car il ne connaÃ®t pas encore le mot de passe de votre WiFi. </font><font style="vertical-align: inherit;">Au cours du processus de connexion, vous spÃ©cifiez le rÃ©seau avec lequel l'appareil doit se connecter. </font><font style="vertical-align: inherit;">Si vous avez un point d'accÃ¨s cachÃ©, ESP ne pourra pas s'y connecter, alors choisissez un point ouvert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le rÃ©sultat sera le suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/--/pw/ne/--pwnex-v3o9iewlsmw7xk-lps8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st-switch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), vous contrÃ´lez la LED intÃ©grÃ©e sur la carte en appuyant sur le bouton de la carte elle-mÃªme. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, pour cet exemple, vous n'avez mÃªme pas besoin de pÃ©riphÃ©riques supplÃ©mentaires, uniquement la carte ESP8266 elle-mÃªme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez Ã©galement allumer / Ã©teindre l'appareil avec le bouton du panneau de commande dans l'application mobile: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/ze/-7/nzze-7ywppruvlqiafqpz4-xgew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et bien sÃ»r, si vous appuyez sur le bouton physique, le statut de l'ampoule dans l'application est Ã©galement mis Ã  jour.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'Ã©clairage intelligent</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir fait l'exemple Smart Switch, essayons de compliquer un peu les choses. </font><font style="vertical-align: inherit;">Il y aura une LED RVB, et nous activerons / dÃ©sactiverons un bouton externe, et sÃ©lectionnerons Ã©galement une couleur via l'application.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le schÃ©ma de connexion sera simple: </font></font><br>
<img src="https://habrastorage.org/webt/sv/xh/cf/svxhcfrv9zn7brswyuebeh_jd9o.png" width="500"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le schÃ©ma de circuit ne fait pas de mal non plus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1z/gu/8v/1zgu8vamare3efr_qqtqt_s6bqa.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si vous regardez la source (situÃ©e Ã : st-device-sdk-c-ref / apps / esp8266 / st_lamp), alors la connexion est la suivante: </font><font style="vertical-align: inherit;">
vous pouvez rÃ©affecter les conclusions selon lesquelles c'est le modÃ¨le de la planche que vous avez. </font><font style="vertical-align: inherit;">Veuillez noter qu'il existe un systÃ¨me de notation (D1, D2 ...) sur la carte, et un autre dans le code, mais cela est facile Ã  comprendre simplement en consultant la documentation de votre carte.</font></font><br>
<br>
<code>#define GPIO_OUTPUT_NOTIFICATION_LED 2<br>
#define GPIO_INPUT_BUTTON 5<br>
#define GPIO_OUTPUT_COLORLED_R 16<br>
#define GPIO_OUTPUT_COLORLED_G 14<br>
#define GPIO_OUTPUT_COLORLED_B 12<br>
#define GPIO_OUTPUT_COLORLED_0 13&nbsp;</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie logiciel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la partie logicielle, nous allons changer plusieurs Ã©tapes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors de l'ajout de capacitÃ©s, vous devez spÃ©cifier les Ã©lÃ©ments suivants: Switch, Switch Level, Color Control, Health Check. </font><font style="vertical-align: inherit;">Le type d'appareil sera - Light.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous prenons un exemple de firmware du mÃªme dossier avec des exemples, il s'appelle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st_lamp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp;</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'interface de l'application </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r9/qh/d_/r9qhd_lnaxlrnd5qcxonqzu2k70.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ressemblera Ã  </font><font style="vertical-align: inherit;">ceci: Ã  </font><font style="vertical-align: inherit;">quoi cela ressemble en action - encore une fois GIF:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cx/se/xy/cxsexydnzipoeqmkj3n7jq9x4iu.gif"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, vous avez un exemple de travail prÃªt. </font><font style="vertical-align: inherit;">Vous voyez que la plupart du code a dÃ©jÃ  Ã©tÃ© fait pour vous - tout ce qui concerne la connexion, l'authentification, l'interface de l'appareil. </font><font style="vertical-align: inherit;">L'exemple SmartThings est prÃ©cieux en ce qu'il n'est liÃ© Ã  aucun pÃ©riphÃ©rique matÃ©riel, et vous pouvez regarder et Ã©valuer les fonctionnalitÃ©s de la plate-forme nÃ©cessaires dans 2k20 si vous dÃ©veloppez une maison intelligente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g8/kt/h0/g8kth04siprq-9s2uwlli2fp6ae.jpeg" align="left"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tatyana Volkova - Auteur du programme de suivi de l'Internet des objets de la Samsung IT Academy, spÃ©cialiste des programmes de responsabilitÃ© sociale des entreprises au Samsung Research Center</font></font><br>
</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489822/index.html">GÃ©nÃ©ration de nombres pseudo-alÃ©atoires Ã  l'aide d'un automate cellulaire: rÃ¨gle 30</a></li>
<li><a href="../fr489824/index.html">7 outils de surveillance de la sÃ©curitÃ© du cloud open source Ã  connaÃ®tre</a></li>
<li><a href="../fr489826/index.html">Ã€ propos des mÃ©thodes mutables d'un objet Math en JavaScript</a></li>
<li><a href="../fr489828/index.html">Travailler avec GeoJSON dans Node.js: une introduction pratique</a></li>
<li><a href="../fr489832/index.html">Perles atomiques artificielles: manipulations avec des macrocycles</a></li>
<li><a href="../fr489836/index.html">Lidars du futur: 11 000 lasers au lieu de 128</a></li>
<li><a href="../fr489838/index.html">Fuite de mÃ©moire cÃ´tÃ© serveur Nuxt Ã  l'aide de SSR (rendu cÃ´tÃ© serveur)</a></li>
<li><a href="../fr489840/index.html">Drive Anatomy: Disques durs</a></li>
<li><a href="../fr489844/index.html">Analyse comparative de certains dÃ©compilateurs Java</a></li>
<li><a href="../fr489848/index.html">Pourquoi mes collÃ¨gues / employÃ©s se comportent-ils comme @% Â§?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>