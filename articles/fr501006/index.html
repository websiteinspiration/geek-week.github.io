<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛵️ 😗 👩🏼‍🔬 Nous sommes amis STM32 avec écran LCD 1604 sur bus I2C (bibliothèque HAL) 👩🏻 😲 👩🏼‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 
 
 Dans cet article, je voudrais parler de mon expérience de connexion d'écrans LCD au microcontrôleur STM32 à l'aide de la bibliothèq...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous sommes amis STM32 avec écran LCD 1604 sur bus I2C (bibliothèque HAL)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501006/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, je voudrais parler de mon expérience de connexion d'écrans LCD au microcontrôleur STM32 à l'aide de la bibliothèque HAL sur le bus I2C. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/tq/li/yjtqliuuokrq220g_4kyg5lty3y.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je connecterai les écrans 1602 et 2004. Ils ont tous deux un adaptateur I2C soudé basé sur la puce PCF8574T. </font><font style="vertical-align: inherit;">La carte de débogage sera </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nucleo767ZI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'environnement de développement sera </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32CubeIDE 1.3.0.</font></font></b><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne parlerai pas en détail du principe de fonctionnement du bus I2C, je vous conseille de regarder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons le projet, sélectionnez la carte de débogage: Nous </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ka/dg/gq/kadggqufgj38rtpnuhafups7usg.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
indiquons que nous utiliserons I2C1. Je vais également connecter UART5 pour communiquer avec la carte, cela est nécessaire pour recevoir des informations de la carte sur l'adresse d'affichage. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/h2/o5/cvh2o5rcohuwwpqecrcedg4m62a.jpeg" alt="image"><br>
<br>
<img src="https://habrastorage.org/webt/cp/iz/dt/cpizdtxz2sosftjpdrvgycthcz8.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la même fenêtre, vous pouvez voir les numéros des jambes auxquelles l'écran est connecté, dans mon cas, il s'est avéré comme ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/jg/yd/gjjgydsz_j5o4czfol2wgsqfayy.jpeg" alt="image"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, connectez un seul écran, je commencerai par 1602. De plus, je connecterai l'adaptateur USB-UART CH340, connu des pilotes Arduin expérimentés, pour recevoir des données de la carte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pl/ka/tq/plkatqffrxr3txh7d3gar6m9wka.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que l'adaptateur connecte RX à TX et TX à RX, le cavalier sur l'adaptateur est de 3,3 V</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/u-/jl/n_u-jlv9qayzjrgmqg9yoqlz7mi.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons de plus près comment travailler avec la puce et l'affichage PCF8574T. </font><font style="vertical-align: inherit;">Ci-dessous, un schéma de principe d'un module avec écran: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/-p/5e/-v-p5ehplnmtvvbvncmbaqqo1ru.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La puce PCF8574T est similaire en fonction au registre à décalage 74hc595 - elle reçoit des octets via l'interface I2C et affecte les valeurs du bit correspondant à ses sorties (P0-P7). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez quelles broches du microcircuit sont connectées à l'écran et de quoi elles sont responsables:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La borne P0 du microcircuit est connectée à la borne RS de l'affichage, qui est chargée de recevoir les données d'affichage (1) ou les instructions de fonctionnement d'affichage (0);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La broche P1 est connectée à R \ W, si 1 - écrire des données sur l'affichage, 0 - lire;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La borne P2 est connectée à CS - la borne dont le changement d'état est en cours de lecture;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion P3 - contrôle du rétroéclairage;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les conclusions P4 - P7 sont utilisées pour transmettre des données à l'écran. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plusieurs appareils peuvent être connectés à un bus I2C en même temps. Afin de pouvoir accéder à un appareil spécifique, chacun d'eux a sa propre adresse, nous allons d'abord le découvrir. Si les contacts A1, A2 et A3 sur la carte adaptateur ne sont pas scellés, l'adresse sera probablement 0x27, mais il vaut mieux vérifier. Pour ce faire, nous allons écrire une petite fonction qui montrera les adresses de tous les appareils connectés au bus I2C:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">I2C_Scan</span> <span class="hljs-params">()</span>
</span>{
	<span class="hljs-comment">//  ,  </span><font></font>
        HAL_StatusTypeDef res;                          <font></font>
	<span class="hljs-comment">//    </span>
        <span class="hljs-keyword">char</span> info[] = <span class="hljs-string">"Scanning I2C bus...\r\n"</span>;      
        <span class="hljs-comment">//    UART	</span>
        HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)info, <span class="hljs-built_in">strlen</span>(info), HAL_MAX_DELAY);  
	<span class="hljs-comment">/* &amp;huart5 -   UART
	 * (uint8_t*)info -     
	 * strlen(info) -   
	 * HAL_MAX_DELAY - 
	 */</span>
        <span class="hljs-comment">//    </span>
	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">uint16_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">128</span>; i++)              <font></font>
	{<font></font>
            <span class="hljs-comment">// ,      i  </span>
            res = HAL_I2C_IsDeviceReady(&amp;hi2c1, i &lt;&lt; <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, HAL_MAX_DELAY);                   
	    <span class="hljs-comment">//  , </span>
            <span class="hljs-keyword">if</span>(res == HAL_OK)                              <font></font>
	    {<font></font>
	    	<span class="hljs-keyword">char</span> msg[<span class="hljs-number">64</span>];
	    	<span class="hljs-comment">//   i,   ,     </span>
                <span class="hljs-comment">// 16 :</span>
	    	<span class="hljs-built_in">snprintf</span>(msg, <span class="hljs-keyword">sizeof</span>(msg), <span class="hljs-string">"0x%02X"</span>, i);
	    	<span class="hljs-comment">//    </span>
	    	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)msg, <span class="hljs-built_in">strlen</span>(msg), HAL_MAX_DELAY);
	    	<span class="hljs-comment">//    </span>
	    	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"\r\n"</span>, <span class="hljs-number">2</span>, HAL_MAX_DELAY);<font></font>
	    }<font></font>
	    <span class="hljs-keyword">else</span> HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"."</span>, <span class="hljs-number">1</span>, HAL_MAX_DELAY);<font></font>
	}<font></font>
	HAL_UART_Transmit(&amp;huart5, (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-string">"\r\n"</span>, <span class="hljs-number">2</span>, HAL_MAX_DELAY);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fonction interroge toutes les adresses de 0 à 127 et si une réponse est reçue de cette adresse, elle envoie le numéro d'adresse sous forme hexadécimale à UART. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour communiquer avec le conseil, j'utilise le programme Termite. Par défaut, la vitesse UART du microcontrôleur est définie sur 115200, vous devez définir la même chose dans les termites. Nous appelons la fonction dans le corps principal du programme, flashons la carte et nous connectons en termite à notre microcontrôleur: les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0f/3d/uj/0f3dujga-iwbhudpe7kauth_ivi.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
points montrent toutes les adresses dont la réponse n'a pas été reçue. L'adresse sur mon écran est 0x26, car j'ai soudé le cavalier A0. Maintenant, connectez le deuxième écran en parallèle au premier et voyez ce que le programme donnera:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f4/dz/hm/f4dzhm0py_f9kbvecthsshrpemi.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons deux adresses: 0x26 (affichage 1602) et 0x27 (affichage 2004). Maintenant, comment travailler avec l'écran. Le microcontrôleur envoie un octet d'adresse et tous les appareils connectés au bus le vérifient avec le leur. S'il correspond, le module commence la communication avec le microcontrôleur. Tout d'abord, vous devez configurer l'affichage: d'où ira le nombre de caractères et dans quelle direction, comment se comportera le curseur, etc. Après cela, il sera déjà possible de transmettre des informations à afficher à l'écran. La particularité est que nous ne pouvons utiliser que 4 bits pour transmettre des informations, c'est-à-dire les données doivent être divisées en deux parties. Les données sont stockées dans les bits hauts (4-7), et les bits bas sont utilisés pour indiquer si le rétroéclairage s'allumera (3 bits), si les données viennent pour la sortie ou pour afficher les paramètres (sortie RS, 0 bits) et 2 bits, par le changement dont la lecture a lieu, c'est-à-diree pour envoyer 1 octet de données, vous devez envoyer 4 octets - le 1er octet contiendra 4 bits d'information, le 2e bit à l'état 1, le 2e octet est une répétition du 1er, seul le 2e bit à l'état 0. Les 3e et 4e octets sont similaires, ils contiennent seulement seconde moitié des données. Cela semble un peu incompréhensible, je vais vous montrer un exemple:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">I2C_send</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> data, <span class="hljs-keyword">uint8_t</span> flags)</span>
</span>{<font></font>
	HAL_StatusTypeDef res;<font></font>
	 <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">for</span>(;;) {
                <span class="hljs-comment">// ,      lcd_addr                                                                                        </span>
	        res = HAL_I2C_IsDeviceReady(&amp;hi2c1, LCD_ADDR, <span class="hljs-number">1</span>, HAL_MAX_DELAY);               
	         <span class="hljs-comment">//  ,     </span>
                <span class="hljs-keyword">if</span>(res == HAL_OK) <span class="hljs-keyword">break</span>;                                                  <font></font>
	    }<font></font>
        <span class="hljs-comment">//    1111 0000      0  3,    4  7</span>
	<span class="hljs-keyword">uint8_t</span> up = data &amp; <span class="hljs-number">0xF0</span>;   
        <span class="hljs-comment">//   ,  data   4                	</span>
        <span class="hljs-keyword">uint8_t</span> lo = (data &lt;&lt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF0</span>;          <font></font>
                                          <font></font>
	<span class="hljs-keyword">uint8_t</span> data_arr[<span class="hljs-number">4</span>];
         <span class="hljs-comment">// 4-7   ,  0-3   </span>
	data_arr[<span class="hljs-number">0</span>] = up|flags|BACKLIGHT|PIN_EN; 
         <span class="hljs-comment">//  ,       0  </span>
	data_arr[<span class="hljs-number">1</span>] = up|flags|BACKLIGHT;         <font></font>
	data_arr[<span class="hljs-number">2</span>] = lo|flags|BACKLIGHT|PIN_EN;<font></font>
	data_arr[<span class="hljs-number">3</span>] = lo|flags|BACKLIGHT;<font></font>
<font></font>
	HAL_I2C_Master_Transmit(&amp;hi2c1, LCD_ADDR, data_arr, <span class="hljs-keyword">sizeof</span>(data_arr), HAL_MAX_DELAY);<font></font>
	HAL_Delay(LCD_DELAY_MS);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons-le dans l'ordre. Au début, il y a des variables qui stockent l'adresse d'affichage et des bits de paramètres qui doivent être envoyés à chaque fois avec les données. Dans la fonction d'envoi, nous vérifions tout d'abord s'il y a un module à l'adresse enregistrée. En cas de réception du message HAL_OK, nous commençons à former des octets pour l'envoi. Au début de l'octet que nous enverrons, il est nécessaire de diviser en deux parties, d'écrire les deux sur les bits hauts. Supposons que nous voulons que l'affichage affiche le caractère 's', dans le système binaire, il est 1110011 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculatrice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) En utilisant l'opération logique et nous écrivons = 01110000 dans la variable, c'est-à-dire écrire uniquement les bits les plus significatifs. Les bits de poids faible sont décalés vers la gauche de 4 caractères au début, puis sont écrits dans la variable lo = 00110000. Ensuite, nous formons un tableau de 4 octets qui contient des informations sur le caractère à afficher. Maintenant, nous attribuons des bits de configuration (0-3 bits) aux octets existants. Après cela, nous envoyons l'octet d'adresse et 4 octets d'informations à l'écran à l'aide de la fonction HAL_I2C_Master_Transmit (); </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ne vous précipitez pas pour télécharger le programme, car au début, vous devez définir les paramètres d'affichage. Le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a un excellent tableau traduit avec des commandes pour personnaliser l'affichage. Après l'avoir vérifié avec la documentation, je suis arrivé aux paramètres suivants qui sont optimaux pour moi:</font></font><br>
<br>
<pre><code class="cpp hljs">  I2C_send(<span class="hljs-number">0b00110000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">// 8  </span>
  I2C_send(<span class="hljs-number">0b00000010</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//     </span>
  I2C_send(<span class="hljs-number">0b00001100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   ,  </span>
  I2C_send(<span class="hljs-number">0b00000001</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//  </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous plaçons ces commandes avant le début d'une boucle infinie, afin que les paramètres soient envoyés une fois avant de commencer le travail (comme la configuration void en arduinki). </font><font style="vertical-align: inherit;">La fonction I2C_send, en plus de l'octet, vous oblige à spécifier si les paramètres d'affichage ou les données seront envoyés. </font><font style="vertical-align: inherit;">Si le deuxième argument de la fonction est 0, alors les paramètres et si 1, alors les données. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et la dernière touche - vous avez besoin d'une fonction qui enverra un délai caractère par caractère. </font><font style="vertical-align: inherit;">Tout est assez simple ici:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LCD_SendString</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *str)</span>
</span>{
    <span class="hljs-comment">// *char    </span>
    <span class="hljs-comment">//    </span>
	<span class="hljs-keyword">while</span>(*str) <font></font>
        {                                   <font></font>
                <span class="hljs-comment">//    </span>
		I2C_send((<span class="hljs-keyword">uint8_t</span>)(*str), <span class="hljs-number">1</span>); 
                <span class="hljs-comment">//     1               </span><font></font>
                str++;                                     <font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir rassemblé toutes ces fonctions ensemble, vous pouvez écrire:</font></font><br>
<br>
<pre><code class="cpp hljs">  LCD_SendString(<span class="hljs-string">"  Hello"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//  </span>
  LCD_SendString(<span class="hljs-string">"    Habr"</span>);
</code></pre><br>
<img src="https://habrastorage.org/webt/wl/yz/_p/wlyz_pkm6xjhc8pqk9anu93m5n0.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, nous avons compris l'écran 1602, maintenant 2004. La différence entre eux est minime, même ce code fonctionnera bien. Toute la différence se résume à organiser les adresses des cellules sur l'écran. Dans les deux affichages, la mémoire contient 80 cellules, dans l'affichage 1602, les 16 premières cellules sont responsables de la première ligne et les cellules 40 à 56 sont responsables de la deuxième ligne. Les cellules mémoire restantes ne sont pas affichées, donc si vous envoyez 17 caractères à l'affichage, la dernière ne sera pas transférée sur la deuxième ligne, et sera enregistré dans une cellule mémoire qui n'a pas de sortie à l'écran. Un peu plus clairement, la mémoire est organisée comme suit: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pz/-u/cp/pz-ucp3k76pfuilzikli5ce_m7g.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour utiliser le </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saut de</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ligne, j'ai utilisé la commande </font><u><font style="vertical-align: inherit;">I2C_send (0b11000000,0);</font></u><font style="vertical-align: inherit;"> , il va juste à 40 cellules. L'affichage 2004 est plus intéressant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première ligne correspond aux cellules 1 à 20 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxième ligne correspond aux cellules 40 à 60</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième rangée - cellules de 21 à 40 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La quatrième rangée - cellules de 60 à 80, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c.-à </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">d. </font><font style="vertical-align: inherit;">si vous envoyez une commande</font></font><br>
<br>
<pre><code class="cpp hljs">LCD_SendString(<span class="hljs-string">"___________________1___________________2___________________3___________________4"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons ce qui suit: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z9/fe/xw/z9fexwtyq9grtdqtnq1bbw7jijm.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour organiser les transitions entre les lignes, vous devez déplacer manuellement le curseur vers la cellule de mémoire souhaitée, ou vous pouvez compléter par programme la fonction. </font><font style="vertical-align: inherit;">Jusqu'à présent, je me suis installé sur la version manuelle:</font></font><br>
<br>
<pre><code class="cpp hljs">  I2C_send(<span class="hljs-number">0b10000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   1 </span>
  LCD_SendString(<span class="hljs-string">"  Hello Habr"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11000000</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   2 </span>
  LCD_SendString(<span class="hljs-string">" STM32 + LCD 1602"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b10010100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   3 </span>
  LCD_SendString(<span class="hljs-string">" +LCD 2004A"</span>);<font></font>
  I2C_send(<span class="hljs-number">0b11010100</span>,<span class="hljs-number">0</span>);   <span class="hljs-comment">//   4 </span>
  LCD_SendString(<span class="hljs-string">" library HAL"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Résultat: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/tq/li/yjtqliuuokrq220g_4kyg5lty3y.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c'est probablement tout avec ces affichages, liens utiles grâce auxquels j'ai pu tout comprendre:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code ressemblait beaucoup </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les tableaux pour la configuration de l'affichage ont regardé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La procédure a été consultée </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></li>
</ol><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programme et fiche technique</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS: n'oubliez pas de régler à l'avance la luminosité de l'écran.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500992/index.html">Comment est la gestion de la performance dans les meilleures entreprises informatiques</a></li>
<li><a href="../fr500994/index.html">Exécutez la fourmi. Courir</a></li>
<li><a href="../fr500996/index.html">Comment devenir ingénieur DevOps en six mois ou plus vite. Partie 1. Introduction</a></li>
<li><a href="../fr501002/index.html">Umka: nouveau langage de script typé statiquement</a></li>
<li><a href="../fr501004/index.html">Fais le. Travail</a></li>
<li><a href="../fr501008/index.html">Pavage Dominos</a></li>
<li><a href="../fr501010/index.html">Linux Kernel TLS et Nginx</a></li>
<li><a href="../fr501012/index.html">Comment je cherchais un moteur enfant pour un blog</a></li>
<li><a href="../fr501016/index.html">Sur les tendances de développement de l'architecture de processeur, ou pourquoi je crois au succès de Huawei sur le marché des serveurs</a></li>
<li><a href="../fr501018/index.html">Comment contourner certaines restrictions de Google Translate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>