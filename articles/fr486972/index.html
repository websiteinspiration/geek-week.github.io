<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåï üíÇ üöí Arbres d'expression en C # √† l'aide d'un exemple de recherche d'un d√©riv√© (Expression Tree Visitor vs Pattern matching) üé± üí™üèº üë©üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journ√©e. Les arbres d'expression, en particulier lorsqu'ils sont combin√©s avec le mod√®le Visitor, ont toujours √©t√© un sujet assez d√©routant. Par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arbres d'expression en C # √† l'aide d'un exemple de recherche d'un d√©riv√© (Expression Tree Visitor vs Pattern matching)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486972/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonne journ√©e. </font><font style="vertical-align: inherit;">Les arbres d'expression, en particulier lorsqu'ils sont combin√©s avec le mod√®le Visitor, ont toujours √©t√© un sujet assez d√©routant. </font><font style="vertical-align: inherit;">Par cons√©quent, plus l'information sur ce sujet est diversifi√©e, plus il y a d'exemples, plus il sera facile pour ceux qui sont int√©ress√©s de trouver quelque chose de clair et utile pour eux.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xt/6c/bf/xt6cbf1-gfkv4-64zs250n_-7pa.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'article est construit comme d'habitude - il commence par le cadre conceptuel et les d√©finitions et se termine par des exemples et des modes d'utilisation. </font><font style="vertical-align: inherit;">Table des mati√®res ci-dessous. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notions de base des arborescences d'expression </font></font></a></b><br>
 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syntaxe des arborescences d'expression </font></font></a></b><br>
 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types d' </font></font></a></b><font style="vertical-align: inherit;"><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">expressions </font></a></b></font><br>
 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correspondance du </font></font></a></b><br>
 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visiteur na√Øf Visiteur </font></font></a></b><br>
 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classique</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eh bien, le but n'est pas d'imposer une solution sp√©cifique ou de dire que l'une est meilleure que l'autre. </font><font style="vertical-align: inherit;">Je propose de tirer nous-m√™mes des conclusions en tenant compte de toutes les nuances de votre cas. </font><font style="vertical-align: inherit;">Je vais exprimer mon opinion sur mon exemple.</font></font><br>
<br>
<a name="basic"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbres d'expression</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les bases</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord g√©rer les arbres d'expression. Ils signifient le type d'expression ou l'un de ses h√©ritiers (ils seront discut√©s plus tard). Dans le sc√©nario habituel, l'expression / les algorithmes sont pr√©sent√©s sous la forme de code / d'instructions ex√©cutables avec lesquels l'utilisateur peut ne pas avoir grand-chose √† faire (principalement ex√©cuter). Le type Expression vous permet de repr√©senter une expression / un algorithme (g√©n√©ralement des lambdas, mais pas n√©cessaire) sous forme de donn√©es organis√©es dans une arborescence √† laquelle l'utilisateur a acc√®s. La fa√ßon arborescente d'organiser les informations sur l'algorithme et le nom de la classe nous donne des "arbres d'expression". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour plus de clart√©, nous analyserons un exemple simple. Supposons que nous ayons lambda </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(x) =&gt; Console.WriteLine (x + 5)</font></font></i></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cela peut √™tre repr√©sent√© comme l'arborescence suivante</font></font><br>
<br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/yv/wy/sq/yvwysqugbtttw-gvz07tipuq-oy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La racine de l'arborescence est le sommet de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MethodCall</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les param√®tres de la m√©thode sont √©galement des expressions, elle peut donc avoir n'importe quel nombre d'enfants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, il n'y a qu'un seul descendant - le sommet de " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArithmeticOperation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". Il contient des informations sur le type d'op√©ration et les op√©randes gauche et droite sont √©galement des expressions. Un tel sommet aura toujours 2 descendants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les op√©randes sont repr√©sent√©s par une constante ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constante</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) et un param√®tre ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param√®tre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). De telles expressions n'ont pas de descendants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sont des exemples tr√®s simplifi√©s, mais refl√®tent pleinement l'essence.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principale caract√©ristique des arbres d'expression est qu'ils peuvent √™tre analys√©s et lire toutes les informations n√©cessaires sur ce que l'algorithme doit faire. D'un certain point de vue, c'est l'oppos√© des attributs. Les attributs sont un moyen de description d√©clarative du comportement (tr√®s conditionnel, mais le but ultime est √† peu pr√®s le m√™me). Tandis que les arbres d'expression utilisent une fonction / un algorithme pour d√©crire les donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils sont utilis√©s, par exemple, dans les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fournisseurs de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> structure d'entit√©. L'application est √©vidente - pour analyser l'arbre d'expressions, comprendre ce qui doit y √™tre ex√©cut√© et faire du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL √†</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de cette description </font><font style="vertical-align: inherit;">. Moins d' </font><font style="vertical-align: inherit;">exemples bien connus sont la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> biblioth√®que moqueur </font><font style="vertical-align: inherit;">. Les arbres d'expression sont √©galement utilis√©s dans le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLR.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(runtime de langage dynamique). </font><font style="vertical-align: inherit;">Les d√©veloppeurs de compilateurs les utilisent pour assurer la compatibilit√© entre la nature dynamique et dotnet, au lieu de g√©n√©rer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSIL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient √©galement de mentionner que les arbres d'expression sont immuables.</font></font><br>
<a name="syn"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syntaxe</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine chose √† discuter est la syntaxe. </font><font style="vertical-align: inherit;">Il existe 2 fa√ßons principales:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'arbres d'expression via des m√©thodes statiques de la classe Expression</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation d'expressions lambda compil√©es dans Expression</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©thodes statiques de la classe d'expression</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La cr√©ation d'arbres d'expression √† l'aide de m√©thodes statiques de la classe Expression est moins couramment utilis√©e (en particulier du point de vue de l'utilisateur). C'est lourd, mais assez simple, nous avons </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
beaucoup de briques de base </font><font style="vertical-align: inherit;">√† notre </font><font style="vertical-align: inherit;">disposition, √† partir desquelles vous pouvez construire des </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
choses </font><font style="vertical-align: inherit;">assez complexes </font><font style="vertical-align: inherit;">. La cr√©ation se fait par des m√©thodes statiques depuis les constructeurs d'expression ont un modificateur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Et cela ne signifie pas que vous devez d√©couvrir la r√©flexion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä titre d'exemple, je vais cr√©er une expression √† partir de l'exemple ci-dessus: </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(x) =&gt; Console.WriteLine (x + 5)</font></font></i></b><br>
<br>
<pre><code class="cs hljs">ParameterExpression parameter = Expression.Parameter(<span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));<font></font>
ConstantExpression constant = Expression.Constant(<span class="hljs-number">5</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));<font></font>
BinaryExpression <span class="hljs-keyword">add</span> = Expression.Add(parameter, constant);<font></font>
MethodInfo writeLine = <span class="hljs-keyword">typeof</span>(Console).GetMethod(<span class="hljs-keyword">nameof</span>(Console.WriteLine), <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>) });<font></font>
MethodCallExpression methodCall = Expression.Call(<span class="hljs-literal">null</span>, writeLine, <span class="hljs-keyword">add</span>);<font></font>
Expression&lt;Action&lt;<span class="hljs-keyword">double</span>&gt;&gt; expressionlambda = Expression.Lambda&lt;Action&lt;<span class="hljs-keyword">double</span>&gt;&gt;(methodCall, parameter);<font></font>
Action&lt;<span class="hljs-keyword">double</span>&gt; delegateLambda = expressionlambda.Compile();<font></font>
delegateLambda(<span class="hljs-number">123321</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce n'est peut-√™tre pas un moyen tr√®s pratique, mais cela refl√®te pleinement la structure interne des arbres d'expression. </font><font style="vertical-align: inherit;">De plus, cette m√©thode fournit plus de fonctionnalit√©s et de fonctionnalit√©s qui peuvent √™tre utilis√©es dans les arborescences d'expressions: √† partir de boucles, de conditions, de try-catch, de goto, d'affectation, se terminant par des blocs de d√©faut, des informations de d√©bogage pour les points d'arr√™t, dynamiques, etc.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expression lambda</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de lambdas comme expressions est une mani√®re plus fr√©quente. </font><font style="vertical-align: inherit;">Cela fonctionne tr√®s simplement - le compilateur intelligent au stade de la compilation examine √† quoi sert lambda. </font><font style="vertical-align: inherit;">Et le compile soit en d√©l√©gu√©, soit en expression. </font><font style="vertical-align: inherit;">Sur un exemple d√©j√† ma√Ætris√©, il se pr√©sente comme suit</font></font><br>
<br>
<pre><code class="cs hljs">Expression&lt;Action&lt;<span class="hljs-keyword">double</span>&gt;&gt; write =  =&gt; Console.WriteLine( + <span class="hljs-number">5</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il vaut la peine de clarifier une telle chose - une expression est une description exhaustive. </font><font style="vertical-align: inherit;">Et cela suffit pour </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
obtenir le r√©sultat. </font><font style="vertical-align: inherit;">Les arbres d'expression tels que LambdaExpression ou ses descendants peuvent √™tre </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convertis en IL ex√©cutable. </font><font style="vertical-align: inherit;">Les types restants ne peuvent pas √™tre convertis directement en code ex√©cutable (mais cela n'a pas beaucoup de sens). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, si quelqu'un critique la compilation rapide d'une expression, vous pouvez jeter un ≈ìil √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> projet tiers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'inverse n'est pas vrai dans le cas g√©n√©ral. </font><font style="vertical-align: inherit;">Un d√©l√©gu√© ne peut pas simplement le ramasser et se pr√©senter comme une expression (mais cela est toujours possible). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les lambdas ne peuvent pas √™tre convertis en arbres d'expression. </font><font style="vertical-align: inherit;">Ceux-ci inclus:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenant l'op√©rateur d'affectation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dynamique contributive</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asynchrone</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec corps (bretelles)</font></font></li>
</ul><br>
<pre><code class="cs hljs"><span class="hljs-keyword">double</span> variable;
<span class="hljs-keyword">dynamic</span> <span class="hljs-keyword">dynamic</span>;<font></font>
Expression&lt;Action&gt; assignment = () =&gt; variable = <span class="hljs-number">5</span>; <span class="hljs-comment">//Compiler error: An expression tree may not contain an assignment operator</span>
Expression&lt;Func&lt;<span class="hljs-keyword">double</span>&gt;&gt; dynamically = () =&gt; <span class="hljs-keyword">dynamic</span>; <span class="hljs-comment">//Compiler error: An expression tree may not contain a dynamic operation</span>
Expression&lt;Func&lt;Task&gt;&gt; asynchon = <span class="hljs-keyword">async</span> () =&gt; <span class="hljs-keyword">await</span> Task.CompletedTask; <span class="hljs-comment">//Compiler error: Async lambda cannot be converted to expresiion trees</span>
Expression&lt;Action&gt; body = () =&gt; { }; <span class="hljs-comment">//Compiler error: A lambda expression with a statement body cannot be converted to an expression tree</span>
</code></pre> <br>
<a name="types"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types d'expressions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je sugg√®re un aper√ßu rapide des types disponibles pour repr√©senter les opportunit√©s que nous avons. </font><font style="vertical-align: inherit;">Tous se trouvent dans l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> noms </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">System.Linq.Expressions</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vous sugg√®re de vous familiariser avec plusieurs fonctionnalit√©s vraiment int√©ressantes et inhabituelles. </font><font style="vertical-align: inherit;">Les types d'expressions les plus simples que j'ai rassembl√©s dans une tablette avec une br√®ve description.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dynamique</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant DynamicExpression, il est possible d'utiliser dynamique et toutes ses fonctionnalit√©s dans les arborescences d'expression. </font><font style="vertical-align: inherit;">Il y a une API assez d√©routante, je me suis assis sur cet exemple plus longtemps que sur tous les autres combin√©s. </font><font style="vertical-align: inherit;">Toute la confusion est fournie par un tas de drapeaux diff√©rents. </font><font style="vertical-align: inherit;">Et certains d'entre eux sont similaires √† ceux que vous recherchez, mais ils ne le sont pas n√©cessairement. </font><font style="vertical-align: inherit;">Et lorsque vous travaillez avec des arbres d'expression dynamiques, il est difficile d'obtenir une erreur de conversation. </font><font style="vertical-align: inherit;">Exemple:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> parameter1 = Expression.Parameter(<span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">object</span>), <span class="hljs-string">"name1"</span>);
<span class="hljs-keyword">var</span> parameter2 = Expression.Parameter(<span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">object</span>), <span class="hljs-string">"name2"</span>); 
<span class="hljs-keyword">var</span> dynamicParam1 = CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, <span class="hljs-literal">null</span>);
<span class="hljs-keyword">var</span> dynamicParam2 = CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, <span class="hljs-literal">null</span>);<font></font>
CallSiteBinder csb = Microsoft.CSharp.RuntimeBinder.Binder.BinaryOperation(CSharpBinderFlags.None, ExpressionType.Add, <span class="hljs-keyword">typeof</span>(Program), <span class="hljs-keyword">new</span>[] { dynamicParam1, dynamicParam2 });
<span class="hljs-keyword">var</span> dyno = Expression.Dynamic(csb, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">object</span>), parameter1, parameter2);<font></font>
Expression&lt;Func&lt;<span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>&gt;&gt; expr = Expression.Lambda&lt;Func&lt;<span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>&gt;&gt;(dyno, <span class="hljs-keyword">new</span>[] { parameter1, parameter2 });<font></font>
Func&lt;<span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>, <span class="hljs-keyword">dynamic</span>&gt; action = expr.Compile();
<span class="hljs-keyword">var</span> res = action(<span class="hljs-string">"1"</span>, <span class="hljs-string">"2"</span>);<font></font>
Console.WriteLine(res); <span class="hljs-comment">//12</span>
res = action(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);<font></font>
Console.WriteLine(res); <span class="hljs-comment">//3</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai explicitement indiqu√© d'o√π vient le classeur afin d'√©viter toute confusion avec le classeur de System.Reflection. </font><font style="vertical-align: inherit;">Parmi les choses int√©ressantes, nous pouvons faire des param√®tres ref et out, des param√®tres nomm√©s, des op√©rations unaires et, en principe, tout ce qui peut √™tre fait via la dynamique, mais cela n√©cessitera une certaine comp√©tence.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blocs de capture d'exception</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxi√®me chose √† laquelle je ferai attention est la fonctionnalit√© try / catch / finalement / fault, ou plut√¥t le fait </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
que nous ayons acc√®s au bloc de d√©faut. </font><font style="vertical-align: inherit;">Il n'est pas disponible en C #, mais il est en MSIL C'est une sorte de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
finalement analogique qui sera ex√©cut√© en cas d'exception. </font><font style="vertical-align: inherit;">Dans l'exemple ci-dessous, une exception sera lev√©e, apr√®s quoi "Hi" sera affich√© et le programme attendra l'entr√©e. </font><font style="vertical-align: inherit;">Ce n'est qu'apr√®s cela qu'il tombera compl√®tement. </font><font style="vertical-align: inherit;">Je ne recommande pas cette pratique pour une utilisation.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> throwSmth = Expression.Throw(Expression.Constant(<span class="hljs-keyword">new</span> Exception(), <span class="hljs-keyword">typeof</span>(Exception)));
<span class="hljs-keyword">var</span> log = Expression.Call(<span class="hljs-literal">null</span>, <span class="hljs-keyword">typeof</span>(Console).GetMethod(<span class="hljs-keyword">nameof</span>(Console.WriteLine), <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">string</span>) }), Expression.Constant(<span class="hljs-string">"Hi"</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">string</span>)));
<span class="hljs-keyword">var</span> read = Expression.Call(<span class="hljs-literal">null</span>, <span class="hljs-keyword">typeof</span>(Console).GetMethod(<span class="hljs-keyword">nameof</span>(Console.ReadLine)));
<span class="hljs-keyword">var</span> fault = Expression.TryFault(throwSmth, Expression.Block(<span class="hljs-keyword">new</span>[] { log, read }));<font></font>
Expression&lt;Action&gt; expr = Expression.Lambda&lt;Action&gt;(fault);<font></font>
Action compiledExpression = expr.Compile();<font></font>
compiledExpression();<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Br√®ve description des types d'arbres d'expression disponibles</font></font></b><div class="spoiler_text"><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table</font></font></h4><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un type</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Br√®ve description</font></font></th>
</tr>
<tr>
<td colspan="2" align="center"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principal</font></font></b></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expression</font></font></td>
<td> ,      .     ,      </td>
</tr>
<tr>
<td>Expression&lt;TDelegate&gt;</td>
<td>    </td>
</tr>
<tr>
<td colspan="2" align="center"><b> </b></td>
</tr>
<tr>
<td>BinaryExpression</td>
<td>     (+, ‚Äî  )</td>
</tr>
<tr>
<td>UnaryExpression</td>
<td> (+, -),    throw</td>
</tr>
<tr>
<td>ConstantExpression</td>
<td> ‚Äî   </td>
</tr>
<tr>
<td>ParameterExpression</td>
<td> </td>
</tr>
<tr>
<td>MethodCallExpression</td>
<td>  ,  MethodInfo</td>
</tr>
<tr>
<td>IndexExpression</td>
<td></td>
</tr>
<tr>
<td>BlockExpression</td>
<td>,   .      </td>
</tr>
<tr>
<td colspan="2" align="center"><b>  </b></td>
</tr>
<tr>
<td>ConditionalExpression </td>
<td>   ‚Äî if-else</td>
</tr>
<tr>
<td>LabelTarget</td>
<td>   goto</td>
</tr>
<tr>
<td>LabelExpression</td>
<td> ,            .    LabelTarget.    ,    GotoExpression,    ‚Äî   .    void,    .</td>
</tr>
<tr>
<td>GotoExpression</td>
<td>  .    . ( .. ¬´break¬ª)</td>
</tr>
<tr>
<td>LoopExpression</td>
<td> ,    ¬´break¬ª</td>
</tr>
<tr>
<td>SwitchCase</td>
<td>    SwitchExpression</td>
</tr>
<tr>
<td>SwitchExpression</td>
<td>  switch/case</td>
</tr>
<tr>
<td>TryExpression</td>
<td>    try/catch/finally/fault </td>
</tr>
<tr>
<td>CatchBlock</td>
<td>,   ,    </td>
</tr>
<tr>
<td colspan="2" align="center"><b></b></td>
</tr>
<tr>
<td>ElementInit</td>
<td>    IEnumerable.   ListInitExpression</td>
</tr>
<tr>
<td>ListInitExpression</td>
<td>  +   </td>
</tr>
<tr>
<td>DefaultExpression</td>
<td>       </td>
</tr>
<tr>
<td>NewArrayExpression</td>
<td>   +  </td>
</tr>
<tr>
<td>NewExpression</td>
<td> </td>
</tr>
<tr>
<td colspan="2" align="center"><b>  /</b></td>
</tr>
<tr>
<td>MemberAssignment</td>
<td>    </td>
</tr>
<tr>
<td>MemberBinding</td>
<td>  ,    ,  ,        </td>
</tr>
<tr>
<td>MemberExpression</td>
<td>  /</td>
</tr>
<tr>
<td>MemberInitExpression</td>
<td>      </td>
</tr>
<tr>
<td>MemberListBinding</td>
<td> /  </td>
</tr>
<tr>
<td>MemberMemberBinding</td>
<td> / ,    /</td>
</tr>
<tr>
<td colspan="2" align="center"><b></b></td>
</tr>
<tr>
<td>LambdaExpression</td>
<td></td>
</tr>
<tr>
<td>InvocationExpression</td>
<td>   -    </td>
</tr>
<tr>
<td>DebugInfoExpression</td>
<td>       .         </td>
</tr>
<tr>
<td>SymbolDocumentInfo</td>
<td>       ,        .</td>
</tr>
<tr>
<td>DynamicExpression</td>
<td>   ( )</td>
</tr>
<tr>
<td>RuntimeVariablesExpression</td>
<td>   /    </td>
</tr>
<tr>
<td>TypeBinaryExpression</td>
<td>,      (is)</td>
</tr>
</tbody></table></div><br>
      <br>
<br>
<ul>
<li>ExpressionVisitor ‚Äî     .  .</li>
<li>DynamicExpressionVisitor ‚Äî      DynamicExpression ( VisitDynamic)</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces informations sont suffisantes pour commencer √† comparer les m√©thodes de travail avec les arbres d'expression. </font><font style="vertical-align: inherit;">J'ai d√©cid√© d'analyser tout cela par l'exemple de trouver le d√©riv√©. </font><font style="vertical-align: inherit;">Je n'ai pas pr√©vu toutes les options possibles - seulement celles de base. </font><font style="vertical-align: inherit;">Mais si pour une raison quelconque quelqu'un a d√©cid√© de le modifier et de l'utiliser, je serai heureux de partager les am√©liorations via la demande √† mon </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©f√©rentiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="pm"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correspondance de motifs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, la t√¢che est de faire un calcul des d√©riv√©s. </font><font style="vertical-align: inherit;">Vous pouvez estimer ce qui suit: il existe quelques r√®gles pour trouver la d√©riv√©e pour diff√©rents types d'op√©rations - multiplication, division, etc. </font><font style="vertical-align: inherit;">Selon l'op√©ration, vous devez s√©lectionner une formule sp√©cifique. </font><font style="vertical-align: inherit;">Dans une formulation aussi banale, la t√¢che est id√©alement plac√©e sur le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commutateur / bo√Ætier</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et dans la derni√®re version du langage, nous avons √©t√© pr√©sent√©s avec switch / case 2.0 ou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pattern matching</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est difficile de discuter de quelque chose ici. </font><font style="vertical-align: inherit;">Sur un hub, une telle quantit√© de code semble lourde et mal lue, je sugg√®re donc de regarder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour un exemple d'un d√©riv√©, il s'est av√©r√© comme ceci:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></b><div class="spoiler_text"><pre><code class="cs hljs">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PatterntMatchingDerivative</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MethodInfo _pow = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Pow));
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MethodInfo _log = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Log), <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>) });
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConstantExpression _zero = Expression.Constant(<span class="hljs-number">0</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConstantExpression _one = Expression.Constant(<span class="hljs-number">1</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));<font></font>
		<font></font>
        <span class="hljs-keyword">public</span> Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; ParseDerivative(Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; function)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> Expression.Lambda&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt;(ParseDerivative(function.Body), function.Parameters);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> Expression <span class="hljs-title">ParseDerivative</span>(<span class="hljs-params">Expression function</span>)</span> =&gt; function <span class="hljs-keyword">switch</span><font></font>
        {<font></font>
            BinaryExpression binaryExpr =&gt; function.NodeType <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                ExpressionType.Add =&gt; Expression.Add(ParseDerivative(binaryExpr.Left), ParseDerivative(binaryExpr.Right)),<font></font>
                ExpressionType.Subtract =&gt; Expression.Subtract(ParseDerivative(binaryExpr.Left), ParseDerivative(binaryExpr.Right)),<font></font>
<font></font>
                ExpressionType.Multiply =&gt; (binaryExpr.Left, binaryExpr.Right) <span class="hljs-keyword">switch</span><font></font>
		{	<font></font>
	  	    (ConstantExpression _, ConstantExpression _) =&gt; _zero,<font></font>
		    (ConstantExpression constant, ParameterExpression _) =&gt; constant,<font></font>
		    (ParameterExpression _, ConstantExpression constant) =&gt; constant,<font></font>
		    _ =&gt; Expression.Add(Expression.Multiply(ParseDerivative(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, ParseDerivative(binaryExpr.Right)))<font></font>
		},<font></font>
<font></font>
                ExpressionType.Divide =&gt; (binaryExpr.Left, binaryExpr.Right) <span class="hljs-keyword">switch</span><font></font>
		{<font></font>
		    (ConstantExpression _, ConstantExpression _) =&gt; _zero,<font></font>
		    (ConstantExpression constant, ParameterExpression parameter) =&gt; Expression.Divide(constant, Expression.Multiply(parameter, parameter)),<font></font>
		    (ParameterExpression _, ConstantExpression constant) =&gt; Expression.Divide(_one, constant),<font></font>
		    _ =&gt; Expression.Divide(Expression.Subtract(Expression.Multiply(ParseDerivative(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, ParseDerivative(binaryExpr.Right))), Expression.Multiply(binaryExpr.Right, binaryExpr.Right))<font></font>
	        },<font></font>
            },<font></font>
            MethodCallExpression methodCall <span class="hljs-keyword">when</span> methodCall.Method == _pow =&gt; (methodCall.Arguments[<span class="hljs-number">0</span>], methodCall.Arguments[<span class="hljs-number">1</span>]) <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                (ConstantExpression constant, ParameterExpression _) =&gt; Expression.Multiply(methodCall, Expression.Call(<span class="hljs-literal">null</span>, _log, constant)),<font></font>
                (ParameterExpression param, ConstantExpression constant) =&gt; Expression.Multiply(constant, Expression.Call(<span class="hljs-literal">null</span>, _pow, param, Expression.Constant((<span class="hljs-keyword">double</span>)constant.Value - <span class="hljs-number">1</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>)))),<font></font>
                (ConstantExpression constant, Expression expression) =&gt; Expression.Multiply(Expression.Multiply(ParseDerivative(expression), methodCall), Expression.Call(<span class="hljs-literal">null</span>, _log, constant)),<font></font>
             },<font></font>
             _ =&gt; function.NodeType <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                ExpressionType.Constant =&gt; _zero,<font></font>
                ExpressionType.Parameter =&gt; _one,<font></font>
                _ =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> OutOfMemoryException(<span class="hljs-string">"Bitmap best practice"</span>)<font></font>
             }<font></font>
        };<font></font>
    }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela semble un peu inhabituel, mais int√©ressant. </font><font style="vertical-align: inherit;">Ce fut un plaisir d'√©crire ceci - toutes les conditions tiennent organiquement sur une seule ligne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple parle de lui-m√™me, vous ne pouvez pas le d√©crire mieux avec des mots.</font></font><br>
<a name="nv"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visiteur na√Øf</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans une telle t√¢che, un visiteur de l'arbre d'expression vient imm√©diatement √† l'esprit, ce qui fait beaucoup de bruit </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et un peu de panique parmi les fans pour discuter de l'agilit√© dans la cuisine. </font><font style="vertical-align: inherit;">¬´Ne craignez pas l'ignorance, mais la fausse connaissance. </font><font style="vertical-align: inherit;">Il vaut mieux ne rien savoir que de consid√©rer la v√©rit√© comme ce qui n'est pas vrai. " </font><font style="vertical-align: inherit;">Rappelant cette merveilleuse phrase de Tolsto√Ø, reconnaissant l'ignorance et obtenant le soutien de Google, vous pouvez trouver le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suivant </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai ce lien est le premier (apr√®s la Sib√©rie en 1949) pour la requ√™te "visiteur de l'arbre d'expression". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä premi√®re vue, c'est exactement ce dont nous avons besoin. </font><font style="vertical-align: inherit;">Le titre de l'article correspond √† ce que nous voulons faire, et les classes dans les exemples sont nomm√©es avec le suffixe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visitor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir revu l'article et r√©alis√©, par analogie avec notre exemple avec les d√©riv√©s, on obtient: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien vers github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomDerivativeExpressionTreeVisitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">public</span> Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; Visit(Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; function)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> Expression.Lambda&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt;(Visitor.CreateFromExpression(function.Body).Visit(), function.Parameters);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Visitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> MethodInfo Pow = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Pow));
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> MethodInfo Log = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Log), <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>) });
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">readonly</span> ConstantExpression Zero = Expression.Constant(<span class="hljs-number">0</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">readonly</span> ConstantExpression One = Expression.Constant(<span class="hljs-number">1</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Expression <span class="hljs-title">Visit</span>(<span class="hljs-params"></span>)</span>;
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Visitor <span class="hljs-title">CreateFromExpression</span>(<span class="hljs-params">Expression node</span>)</span>
            =&gt; node <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                BinaryExpression be =&gt; <span class="hljs-keyword">new</span> BinaryVisitor(be),<font></font>
                MethodCallExpression mce <span class="hljs-keyword">when</span> mce.Method == Pow =&gt; <span class="hljs-keyword">new</span> PowMethodCallVisitor(mce),<font></font>
                _ =&gt; <span class="hljs-keyword">new</span> SimpleVisitor(node),<font></font>
            };<font></font>
        <font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BinaryVisitor</span> : <span class="hljs-title">Visitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> BinaryExpression _node;<font></font>
        <font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BinaryVisitor</span>(<span class="hljs-params">BinaryExpression node</span>)</span><font></font>
        {<font></font>
            _node = node;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">Visit</span>(<span class="hljs-params"></span>)</span>
            =&gt; _node.NodeType <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                ExpressionType.Add =&gt; Expression.Add(ParseDerivative(binaryExpr.Left), ParseDerivative(binaryExpr.Right)),<font></font>
                ExpressionType.Subtract =&gt; Expression.Subtract(ParseDerivative(binaryExpr.Left), ParseDerivative(binaryExpr.Right)),<font></font>
<font></font>
                ExpressionType.Multiply =&gt; (binaryExpr.Left, binaryExpr.Right) <span class="hljs-keyword">switch</span><font></font>
		{	<font></font>
	  	    (ConstantExpression _, ConstantExpression _) =&gt; _zero,<font></font>
		    (ConstantExpression constant, ParameterExpression _) =&gt; constant,<font></font>
		    (ParameterExpression _, ConstantExpression constant) =&gt; constant,<font></font>
		    _ =&gt; Expression.Add(Expression.Multiply(ParseDerivative(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, ParseDerivative(binaryExpr.Right)))<font></font>
		},<font></font>
<font></font>
                ExpressionType.Divide =&gt; (binaryExpr.Left, binaryExpr.Right) <span class="hljs-keyword">switch</span><font></font>
		{<font></font>
		    (ConstantExpression _, ConstantExpression _) =&gt; _zero,<font></font>
		    (ConstantExpression constant, ParameterExpression parameter) =&gt; Expression.Divide(constant, Expression.Multiply(parameter, parameter)),<font></font>
		    (ParameterExpression _, ConstantExpression constant) =&gt; Expression.Divide(_one, constant),<font></font>
		    _ =&gt; Expression.Divide(Expression.Subtract(Expression.Multiply(ParseDerivative(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, ParseDerivative(binaryExpr.Right))), Expression.Multiply(binaryExpr.Right, binaryExpr.Right))<font></font>
	        },<font></font>
            };<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PowMethodCallVisitor</span> : <span class="hljs-title">Visitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MethodCallExpression _node;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PowMethodCallVisitor</span>(<span class="hljs-params">MethodCallExpression node</span>)</span><font></font>
        {<font></font>
            _node = node;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">Visit</span>(<span class="hljs-params"></span>)</span>
            =&gt; (_node.Arguments[<span class="hljs-number">0</span>], _node.Arguments[<span class="hljs-number">1</span>]) <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                (ConstantExpression constant, ParameterExpression _) =&gt; Expression.Multiply(_node, Expression.Call(<span class="hljs-literal">null</span>, Log, constant)),<font></font>
                (ParameterExpression param, ConstantExpression constant) =&gt; Expression.Multiply(constant, Expression.Call(<span class="hljs-literal">null</span>, Pow, param, Expression.Constant((<span class="hljs-keyword">double</span>)constant.Value - <span class="hljs-number">1</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>)))),<font></font>
                (ConstantExpression constant, Expression expression) =&gt; Expression.Multiply(Expression.Multiply(CreateFromExpression(expression).Visit(), _node), Expression.Call(<span class="hljs-literal">null</span>, Log, constant)),<font></font>
            };<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SimpleVisitor</span> : <span class="hljs-title">Visitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Expression _node;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SimpleVisitor</span>(<span class="hljs-params">Expression node</span>)</span><font></font>
        {<font></font>
            _node = node;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">Visit</span>(<span class="hljs-params"></span>)</span>
            =&gt; _node.NodeType <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                ExpressionType.Constant =&gt; Zero,<font></font>
                ExpressionType.Parameter =&gt; One,<font></font>
            };<font></font>
    }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait - nous r√©partissons les cas de commutation pour diff√©rentes classes. </font><font style="vertical-align: inherit;">Il n'y en avait pas moins, la magie n'apparaissait pas. </font><font style="vertical-align: inherit;">Tous les m√™mes cas, beaucoup plus de lignes. </font><font style="vertical-align: inherit;">Et o√π est la promesse de double exp√©dition promise?</font></font><br>
<a name="cv"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visiteur classique et double exp√©dition</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, il convient de parler du mod√®le de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visiteur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lui </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">m√™me </font><font style="vertical-align: inherit;">, il s'agit √©galement de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visitor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est la base du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visiteur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><i><font style="vertical-align: inherit;">l'arbre d'expression</font></i><font style="vertical-align: inherit;"> . Analysons-le uniquement sur l'exemple des arbres d'expression. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons un instant que nous concevions des arbres d'expression. Nous voulons donner aux utilisateurs la possibilit√© d'it√©rer dans l'arborescence d'expressions et, selon les types de n≈ìuds (types d'expression), effectuer certaines actions. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re option</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est de ne rien faire. Autrement dit, forcer les utilisateurs √† utiliser un commutateur / bo√Ætier. Ce n'est pas une si mauvaise option. Mais ici, il y a une telle nuance: nous diffusons la logique responsable d'un type particulier. Autrement dit, polymorphisme et d√©fis virtuels ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aka liaison tardive</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) permettent de d√©placer la d√©finition de type vers le runtime et de supprimer ces contr√¥les de notre code. Il nous suffit d'avoir une logique qui cr√©e une instance du type souhait√©, alors tout sera fait par le runtime pour nous. </font></font><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me option.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La solution √©vidente consiste √† int√©grer la logique dans des m√©thodes virtuelles. En rempla√ßant la m√©thode virtuelle dans chaque successeur, nous pouvons oublier switch / case. Le m√©canisme des appels polymorphes d√©cidera pour nous. La table des m√©thodes fonctionnera ici, les m√©thodes seront appel√©es par le d√©calage qui s'y trouve. Mais c'est un sujet pour un article entier, alors ne nous laissons pas emporter. Les m√©thodes virtuelles semblent r√©soudre notre probl√®me. Mais malheureusement, ils en cr√©ent un autre. Pour notre t√¢che, nous pourrions ajouter la m√©thode GetDeriviative (). Mais maintenant, les classes d'expression elles-m√™mes semblent √©tranges. Nous pourrions ajouter de telles m√©thodes pour toutes les occasions, mais elles ne correspondent pas √† la logique g√©n√©rale de la classe. Et nous n'avons toujours pas donn√© l'occasion de faire quelque chose de similaire aux utilisateurs (de mani√®re ad√©quate, bien s√ªr). Nous devons laisser l'utilisateur d√©finir la logique de chaque type particulier,mais gardez le polymorphisme (qui est √† notre disposition).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seuls les efforts de l'utilisateur pour y parvenir ne r√©ussiront pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l√† que r√©side le vrai visiteur. </font><font style="vertical-align: inherit;">Dans le type de hi√©rarchie de base (Expression dans notre cas), nous d√©finissons une m√©thode de la forme</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">virtual</span> Expression <span class="hljs-title">Accept</span>(<span class="hljs-params">ExpressionVisitor visitor</span>)</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chez les h√©ritiers, cette m√©thode sera remplac√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ExpressionVisitor lui-m√™me est une classe de base qui contient une m√©thode virtuelle avec la m√™me signature </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pour chaque type de hi√©rarchie. </font><font style="vertical-align: inherit;">En utilisant la classe ExpressionVisitor comme exemple, VisitBinary (...), VisitMethodCall (...), VisitConstant (...), VisitParameter (...). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces m√©thodes sont appel√©es dans la classe correspondante de notre hi√©rarchie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceux. </font><font style="vertical-align: inherit;">La m√©thode Accept dans la classe BinaryExpression ressemblera √† ceci:</font></font><br>
<br>
<pre><code class="cs hljs">	
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">internal</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">Accept</span>(<span class="hljs-params">ExpressionVisitor visitor</span>)</span><font></font>
{<font></font>
        <span class="hljs-keyword">return</span> visitor.VisitBinary(<span class="hljs-keyword">this</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, pour d√©finir un nouveau comportement, l'utilisateur n'a qu'√† cr√©er un h√©ritier de la classe ExpressionVisitor, dans laquelle les m√©thodes correspondantes pour r√©soudre un probl√®me seront red√©finies. Dans notre cas, un DerivativeExpressionVisitor est cr√©√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous avons certains objets des successeurs d'Expression, mais lesquels sont inconnus, mais pas n√©cessaires.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous appelons la m√©thode virtuelle Accept avec l'impl√©mentation ExpressionVisitor dont nous avons besoin, c'est-√†-dire avec DerivativeExpressionVisitor. Gr√¢ce √† la r√©partition dynamique, une impl√©mentation remplac√©e d'Accept est appel√©e, comme un run-time, par exemple BinaryExpression. Dans le corps de cette m√©thode, nous comprenons parfaitement que nous sommes dans BinaryExpression, mais nous ne savons pas quel successeur d'ExpressionVisitor est venu nous voir. Mais depuis VisitBinary est √©galement virtuel, nous n'avons pas besoin de le savoir. Encore une fois, nous appelons simplement la r√©f√©rence √† la classe de base, l'appel est envoy√© dynamiquement (au moment de l'ex√©cution) et une impl√©mentation VisitBinary substitu√©e du type d'ex√©cution est appel√©e. Voil√† pour la double d√©p√™che - ping-pong dans le style ¬´tu le fais¬ª - ¬´non, toi¬ª. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce que cela nous donne. En fait, cela permet d‚Äôajouter des m√©thodes virtuelles de l‚Äôext√©rieur,</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
changer la classe. </font><font style="vertical-align: inherit;">Cela semble g√©nial, mais a ses inconv√©nients:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Certains gauchistes sous la forme de la m√©thode Accept, qui est responsable de tout et de rien en m√™me temps</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'effet d'entra√Ænement d'une bonne fonction de hachage est que lorsque vous ajoutez un seul h√©ritier √† la hi√©rarchie, dans le pire des cas, tout le monde devra finir ses visiteurs</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais la nature des arbres d'expression permet ces co√ªts en raison des sp√©cificit√©s du travail avec les expressions, car ce type de solutions de contournement est l'une de leurs principales caract√©ristiques. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous pouvez voir toutes les m√©thodes disponibles pour la </font><font style="vertical-align: inherit;">surcharge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons donc √† quoi √ßa ressemble √† la fin. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien vers github.</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BuildinExpressionTreeVisitor</span> : <span class="hljs-title">ExpressionVisitor</span><font></font>
    {<font></font>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MethodInfo _pow = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Pow));
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MethodInfo _log = <span class="hljs-keyword">typeof</span>(Math).GetMethod(<span class="hljs-keyword">nameof</span>(Math.Log), <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>) });
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConstantExpression _zero = Expression.Constant(<span class="hljs-number">0</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConstantExpression _one = Expression.Constant(<span class="hljs-number">1</span>d, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>));<font></font>
<font></font>
        <span class="hljs-keyword">public</span> Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; GetDerivative(Expression&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt; function)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> Expression.Lambda&lt;Func&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;&gt;(Visit(function.Body), function.Parameters);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">VisitBinary</span>(<span class="hljs-params">BinaryExpression binaryExpr</span>)</span>
            =&gt; binaryExpr.NodeType <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                ExpressionType.Add =&gt; Expression.Add(Visit(binaryExpr.Left), Visit(binaryExpr.Right)),<font></font>
                ExpressionType.Subtract =&gt; Expression.Subtract(Visit(binaryExpr.Left), Visit(binaryExpr.Right)),<font></font>
<font></font>
                ExpressionType.Multiply <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ConstantExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ConstantExpression =&gt; _zero,<font></font>
                ExpressionType.Multiply <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ConstantExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ParameterExpression =&gt; binaryExpr.Left,<font></font>
                ExpressionType.Multiply <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ParameterExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ConstantExpression =&gt; binaryExpr.Right,<font></font>
                ExpressionType.Multiply =&gt; Expression.Add(Expression.Multiply(Visit(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, Visit(binaryExpr.Right))),<font></font>
<font></font>
                ExpressionType.Divide <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ConstantExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ConstantExpression =&gt; _zero,<font></font>
                ExpressionType.Divide <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ConstantExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ParameterExpression =&gt; Expression.Divide(binaryExpr.Left, Expression.Multiply(binaryExpr.Right, binaryExpr.Right)),<font></font>
                ExpressionType.Divide <span class="hljs-keyword">when</span> binaryExpr.Left <span class="hljs-keyword">is</span> ParameterExpression &amp;&amp; binaryExpr.Right <span class="hljs-keyword">is</span> ConstantExpression =&gt; Expression.Divide(_one, binaryExpr.Right),<font></font>
                ExpressionType.Divide =&gt; Expression.Divide(Expression.Subtract(Expression.Multiply(Visit(binaryExpr.Left), binaryExpr.Right), Expression.Multiply(binaryExpr.Left, Visit(binaryExpr.Right))), Expression.Multiply(binaryExpr.Right, binaryExpr.Right)),<font></font>
            };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">VisitMethodCall</span>(<span class="hljs-params">MethodCallExpression methodCall</span>)</span>
            =&gt; (methodCall.Arguments[<span class="hljs-number">0</span>], methodCall.Arguments[<span class="hljs-number">1</span>]) <span class="hljs-keyword">switch</span><font></font>
            {<font></font>
                (ConstantExpression constant, ParameterExpression _) =&gt; Expression.Multiply(methodCall, Expression.Call(<span class="hljs-literal">null</span>, _log, constant)),<font></font>
                (ParameterExpression param, ConstantExpression constant) =&gt; Expression.Multiply(constant, Expression.Call(<span class="hljs-literal">null</span>, _pow, param, Expression.Constant((<span class="hljs-keyword">double</span>)constant.Value - <span class="hljs-number">1</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">double</span>)))),<font></font>
                (ConstantExpression constant, Expression expression) =&gt; Expression.Multiply(Expression.Multiply(Visit(expression), methodCall), Expression.Call(<span class="hljs-literal">null</span>, _log, constant)),<font></font>
            };<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">VisitConstant</span>(<span class="hljs-params">ConstantExpression _</span>)</span> =&gt; _zero;<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Expression <span class="hljs-title">VisitParameter</span>(<span class="hljs-params">ParameterExpression b</span>)</span> =&gt; _one;<font></font>
    }<font></font>
</code></pre><br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©sultats</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-√™tre, comme dans la plupart des t√¢ches de programmation, une r√©ponse d√©finitive ne peut √™tre donn√©e. </font><font style="vertical-align: inherit;">Tout, comme toujours, d√©pend de la situation sp√©cifique. </font><font style="vertical-align: inherit;">J'aime la correspondance de motifs habituelle pour mon exemple, car </font><font style="vertical-align: inherit;">Je ne l'ai pas d√©velopp√© √† l'√©chelle du d√©veloppement industriel. </font><font style="vertical-align: inherit;">Si cette expression augmentait de fa√ßon incontr√¥lable, cela valait la peine de penser au visiteur. </font><font style="vertical-align: inherit;">Et m√™me un visiteur na√Øf a droit √† la vie - apr√®s tout, c'est un bon moyen de disperser une grande quantit√© de code dans des classes si la hi√©rarchie n'a pas fourni de support de sa part. </font><font style="vertical-align: inherit;">Et m√™me ici, il y a des exceptions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De m√™me, le soutien du visiteur de la hi√©rarchie est une chose tr√®s controvers√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais j'esp√®re que les informations fournies ici sont suffisantes pour faire le bon choix.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr486972/">https://habr.com/ru/post/fr486972/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486948/index.html">Comment choisir un √©diteur et pourquoi choisir NeoVim?</a></li>
<li><a href="../fr486950/index.html">Antiquit√©s: la mise √† niveau impitoyable du 386e ordinateur</a></li>
<li><a href="../fr486962/index.html">Revue de d√©veloppement de jeux HSE</a></li>
<li><a href="../fr486964/index.html">Multit√¢che et curieux. La championne de Java Mitya Alexandrov sur la cr√©ation de la communaut√© informatique, la "distance" et la vie</a></li>
<li><a href="../fr486966/index.html">Pourquoi la commodit√© contre la s√©curit√© n'est pas un compromis</a></li>
<li><a href="../fr486974/index.html">Production de masse d'√©lectronique en Russie. Automatisation des tests</a></li>
<li><a href="../fr486976/index.html">Probl√®mes de l'enseignement de l'information en russe et leurs solutions possibles</a></li>
<li><a href="../fr486978/index.html">Notes de terrain: l'une des plus grandes conf√©rences OpenSource FOSDEM 2020</a></li>
<li><a href="../fr486980/index.html">Kim Dotcom: Caught, la personne la plus recherch√©e en ligne. Partie 1</a></li>
<li><a href="../fr486982/index.html">Comment apprendre le d√©veloppement frontal, trouver son premier emploi et ne pas se faire de soucis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>