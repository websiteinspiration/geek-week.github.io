<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèæ üë®üèø ü§∑ Comment les nombres entiers tr√®s longs sont-ils impl√©ment√©s en Python? üôÉ ü§öüèæ üóº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours de d√©veloppeur Python .
 
 
 
 
 Lorsque vous √©crivez dans un lang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment les nombres entiers tr√®s longs sont-ils impl√©ment√©s en Python?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/489258/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©veloppeur Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
</i></b><br>
<br>
<img src="https://habrastorage.org/webt/83/4n/6h/834n6hzjg8axynzih1kpbfszk_4.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous √©crivez dans un langage de bas niveau tel que C, vous vous inqui√©tez de choisir le bon type de donn√©es et les bons qualificateurs pour vos entiers, √† chaque √©tape, vous analysez s'il sera suffisant de l'utiliser simplement </font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou si vous devez ajouter </font></font><code>long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou m√™me </font></font><code>long double</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cependant, lorsque vous √©crivez du code en Python, vous n'avez pas √† vous soucier de ces choses "mineures", car Python peut fonctionner avec des nombres de </font></font><code>integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'importe quel </font><font style="vertical-align: inherit;">type de </font><font style="vertical-align: inherit;">taille.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En C, si vous essayez de calculer 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20000 en</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant la fonction int√©gr√©e </font></font><code>powl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous obtiendrez la sortie </font></font><code>inf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#include &lt;stdio.h&gt;</span>
<span class="hljs-comment">#include &lt;math.h&gt;</span><font></font>
<font></font>
int main(void) {<font></font>
  printf(<span class="hljs-string">"%Lf\n"</span>, powl(<span class="hljs-number">2</span>, <span class="hljs-number">20000</span>));
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
$ ./a.out<font></font>
inf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais en Python, rendre cela plus facile que jamais est facile:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">2</span> ** <span class="hljs-number">20000</span>
<span class="hljs-number">39802768403379665923543072061912024537047727804924259387134</span> ...<font></font>
...<font></font>
<span class="hljs-meta">... </span><span class="hljs-number">6021</span> digits long ...<font></font>
...<font></font>
<span class="hljs-number">6309376</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce doit √™tre sous le capot que Python fait quelque chose de tr√®s beau, et aujourd'hui nous allons d√©couvrir ce qu'il fait pour travailler avec des entiers de taille arbitraire!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©sentation et d√©finition</font></font></h3> <br>
<code>Integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Python, il s'agit d'une structure C d√©finie comme suit:</font></font><br>
<br>
<pre><code class="python hljs">struct _longobject {<font></font>
    PyObject_VAR_HEAD<font></font>
    digit ob_digit[<span class="hljs-number">1</span>];<font></font>
};<font></font>
</code></pre><br>
<code>PyObject_VAR_HEAD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est une macro, elle se d√©veloppe en </font></font><code>PyVarObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui a la structure suivante:</font></font><br>
<br>
<pre><code class="python hljs">typedef struct {<font></font>
    PyObject ob_base;<font></font>
    Py_ssize_t ob_size; /* Number of items <span class="hljs-keyword">in</span> variable part */<font></font>
} PyVarObject;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 D'autres types qui ont </font></font><code>PyObject_VAR_HEAD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyBytesObject</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyTupleObject</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyListObject</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela signifie qu'un entier, comme un tuple ou une liste, a une longueur variable, et c'est la premi√®re √©tape pour comprendre comment Python peut prendre en charge le travail avec des nombres g√©ants. </font><font style="vertical-align: inherit;">Une fois d√©velopp√©e, la macro </font></font><code>_longobject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut √™tre consid√©r√©e comme:</font></font><br>
<br>
<pre><code class="python hljs">struct _longobject {<font></font>
    PyObject ob_base;<font></font>
    Py_ssize_t ob_size; /* Number of items <span class="hljs-keyword">in</span> variable part */<font></font>
    digit ob_digit[<span class="hljs-number">1</span>];<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il </font></font><code>PyObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y a quelques m√©ta-champs </font><font style="vertical-align: inherit;">dans la structure </font><font style="vertical-align: inherit;">qui sont utilis√©s pour le comptage des r√©f√©rences (garbage collection), mais pour en parler, nous avons besoin d'un article s√©par√©. </font><font style="vertical-align: inherit;">Le domaine sur lequel nous allons nous concentrer sur cela </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et dans un peu </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©cryptage </font></font><code>ob_digit</code></h3> <br>
<code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est un tableau allou√© statiquement de longueur unitaire de type </font></font><code>digit (typedef  uint32_t)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Puisqu'il s'agit d'un tableau, il </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'agit principalement d'un pointeur vers un nombre et, par cons√©quent, si n√©cessaire, il peut √™tre augment√© √† l'aide de la fonction malloc √† n'importe quelle longueur. </font><font style="vertical-align: inherit;">De cette fa√ßon, python peut repr√©senter et traiter des nombres tr√®s longs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√®gle g√©n√©rale, dans les langages de bas niveau tels que C, la pr√©cision des entiers est limit√©e √† 64 bits, mais Python prend en charge les entiers de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©cision arbitraire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">√Ä partir de Python 3, tous les nombres sont pr√©sent√©s sous la forme </font></font><code>bignum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et ne sont limit√©s que par la m√©moire syst√®me disponible.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©cryptage </font></font><code>ob_size</code></h3><br>
<code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stocke le nombre d'√©l√©ments dans </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Python remplace et utilise ensuite la valeur </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour d√©terminer le nombre r√©el d'√©l√©ments contenus dans le tableau pour augmenter l'efficacit√© de l'allocation de m√©moire au tableau </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espace de rangement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fa√ßon la plus na√Øve de stocker des nombres entiers est de stocker un chiffre d√©cimal dans un √©l√©ment du tableau, puis des op√©rations telles que l'addition et la soustraction peuvent √™tre effectu√©es selon les r√®gles math√©matiques de l'√©cole primaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette approche, le nombre 5238 sera enregistr√© comme ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z_/gt/qz/z_gtqzwee0xfpoaktyogzh1_cv8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette approche est inefficace, car nous utiliserons jusqu'√† 32 bits (uint32_t) pour stocker un chiffre d√©cimal, qui, en fait, va de 0 √† 9 et peut √™tre facilement repr√©sent√© avec seulement 4 bits, car lors de l'√©criture de quelque chose d'aussi polyvalent que python, le d√©veloppeur du noyau doit √™tre encore plus inventif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, pouvons-nous faire mieux? </font><font style="vertical-align: inherit;">Bien s√ªr, sinon je n'aurais pas post√© cet article. </font><font style="vertical-align: inherit;">Examinons de plus pr√®s comment Python stocke un entier extra-long.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chemin Python</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de stocker un seul chiffre d√©cimal dans chaque √©l√©ment du tableau </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Python convertit les nombres du syst√®me num√©rique avec une base de 10 en nombres dans un syst√®me avec une base de 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et appelle chaque √©l√©ment comme un chiffre dont la valeur varie de 0 √† 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30-1</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le syst√®me num√©rique hexad√©cimal, la base 16 ~ 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signifie que chaque "chiffre" du nombre hexad√©cimal va de 0 √† 15 dans le syst√®me num√©rique d√©cimal. En Python, de m√™me, un ¬´nombre¬ª avec une base de 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui signifie que le nombre variera de 0 √† 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 1 = 1073741823 en d√©cimal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De cette fa√ßon, Python utilise efficacement la quasi-totalit√© de l'espace allou√© de 32 bits par chiffre, √©conomise des ressources et effectue toujours des op√©rations simples, telles que l'ajout et la soustraction au niveau math√©matique de l'√©cole √©l√©mentaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la plate-forme, Python utilise soit des tableaux entiers non sign√©s 32 bits, soit des tableaux entiers non sign√©s 16 bits avec des chiffres de 15 bits. Pour effectuer les op√©rations qui seront discut√©es plus loin, vous n'avez besoin que de quelques bits. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple: 1152921504606846976</font></font></i></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Comme mentionn√©, pour Python, les nombres sont repr√©sent√©s dans un syst√®me de base 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-√†-dire que si vous convertissez 1152921504606846976 en un nombre de base avec 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> base </font><font style="vertical-align: inherit;">, vous obtenez 100. </font></font><br>
 <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1152921504606846976 = 1 * (2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 0 * (2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 0 * (2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sup></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√âtant donn√© que le </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chiffre </font><font style="vertical-align: inherit;">le </font><font style="vertical-align: inherit;">moins significatif est enregistr√© en premier, il est enregistr√© sous 001 sous forme de trois chiffres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La structure </font></font><code>_longobject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de cette valeur contiendra:</font></font><br>
<br>
<ul>
<li><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme 3</font></font></li>
<li><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme [0, 0, 1]</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/hb/fj/y4/hbfjy4kl64ogtyfjjx6hikzvray.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai cr√©√© une d√©mo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REPL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui montrera comment Python stocke un entier √† l'int√©rieur de lui-m√™me, et fait √©galement r√©f√©rence aux membres de la structure tels que </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ob_refcount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√©rations longues enti√®res</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous avons une id√©e claire de la fa√ßon dont Python impl√©mente des entiers de pr√©cision arbitraire, il est temps de comprendre comment diverses op√©rations math√©matiques sont effectu√©es avec eux.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une addition</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les entiers sont stock√©s "en nombre", ce qui signifie que l'addition est aussi simple qu'√† l'√©cole primaire, et le code source Python nous montre que c'est ainsi que l'addition est impl√©ment√©e. </font><font style="vertical-align: inherit;">Une fonction avec un nom </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">x_add</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans un fichier </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">longobject.c</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajoute deux nombres.</font></font><br>
<br>
<pre><code class="python hljs">...
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; size_b; ++i) {<font></font>
        carry += a-&gt;ob_digit[i] + b-&gt;ob_digit[i];<font></font>
        z-&gt;ob_digit[i] = carry &amp; PyLong_MASK;<font></font>
        carry &gt;&gt;= PyLong_SHIFT;<font></font>
    }<font></font>
    <span class="hljs-keyword">for</span> (; i &lt; size_a; ++i) {<font></font>
        carry += a-&gt;ob_digit[i];<font></font>
        z-&gt;ob_digit[i] = carry &amp; PyLong_MASK;<font></font>
        carry &gt;&gt;= PyLong_SHIFT;<font></font>
    }<font></font>
    z-&gt;ob_digit[i] = carry;<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'extrait de code ci-dessus est tir√© d'une fonction </font></font><code>x_add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, il it√®re sur un nombre par nombre et effectue l'ajout de nombres, calcule le r√©sultat et ajoute un trait d'union. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela devient plus int√©ressant lorsque le r√©sultat de l'addition est un nombre n√©gatif. </font><font style="vertical-align: inherit;">Le signe </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est un signe entier, c'est-√†-dire que si vous avez un nombre n√©gatif, ce </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sera un moins. </font><font style="vertical-align: inherit;">La valeur </font></font><code>ob_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modulo d√©terminera le nombre de chiffres dans </font></font><code>ob_digit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soustraction </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout comme l'addition a lieu, la soustraction a √©galement lieu. </font><font style="vertical-align: inherit;">Une fonction avec un nom </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">x_sub</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le fichier </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">longobject.c</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soustrait un nombre d'un autre.</font></font><br>
<br>
<pre><code class="python hljs">...
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; size_b; ++i) {<font></font>
        borrow = a-&gt;ob_digit[i] - b-&gt;ob_digit[i] - borrow;<font></font>
        z-&gt;ob_digit[i] = borrow &amp; PyLong_MASK;<font></font>
        borrow &gt;&gt;= PyLong_SHIFT;<font></font>
        borrow &amp;= <span class="hljs-number">1</span>; /* Keep only one sign bit */<font></font>
    }<font></font>
    <span class="hljs-keyword">for</span> (; i &lt; size_a; ++i) {<font></font>
        borrow = a-&gt;ob_digit[i] - borrow;<font></font>
        z-&gt;ob_digit[i] = borrow &amp; PyLong_MASK;<font></font>
        borrow &gt;&gt;= PyLong_SHIFT;<font></font>
        borrow &amp;= <span class="hljs-number">1</span>; /* Keep only one sign bit */<font></font>
    }<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'extrait de code ci-dessus est tir√© d'une fonction </font></font><code>x_sub</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous y voyez comment l'√©num√©ration des nombres se produit et la soustraction est effectu√©e, le r√©sultat est calcul√© et le transfert est distribu√©. </font><font style="vertical-align: inherit;">En effet, il est tr√®s similaire √† l'addition.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiplication</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et encore une fois, la multiplication sera mise en ≈ìuvre de la m√™me mani√®re na√Øve que celle que nous avons apprise des le√ßons de math√©matiques au primaire, mais elle n'est pas tr√®s efficace. </font><font style="vertical-align: inherit;">Pour maintenir l'efficacit√©, Python impl√©mente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'algorithme de Karatsuba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui multiplie deux nombres √† n chiffres en O (n </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log </font></font></sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></sub><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) √©tapes simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'algorithme n'est pas simple et son impl√©mentation d√©passe le cadre de cet article, mais vous pouvez trouver son impl√©mentation dans les fonctions </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">k_mul</a> </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">k_lopsided_mul</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le fichier </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">longobject.c</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Division et autres op√©rations</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les op√©rations sur les entiers sont d√©finies dans le fichier </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">longobject.c</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, elles sont tr√®s simples pour trouver et tracer le travail de chacun. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention: </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une compr√©hension d√©taill√©e du travail de chacun d'entre eux prendra du temps, alors faites le plein de pop-corn √† l'avance</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <br>
<h3>    </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python pr√©alloue </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> petit nombre d'entiers en m√©moire allant de -5 √† 256. Cette allocation se produit lors de l'initialisation, et comme nous ne pouvons pas changer les entiers (immuabilit√©), ces nombres pr√©-allou√©s sont singleton et sont directement r√©f√©renc√©s au lieu d'√™tre allou√©s. Cela signifie que chaque fois que nous utilisons / cr√©ons un petit nombre, Python au lieu de le vendre renvoie simplement une r√©f√©rence au num√©ro pr√©c√©demment allou√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une telle optimisation peut √™tre trac√©e dans la macro </font></font><code>IS_SMALL_INT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et la fonction </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">get_small_int</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">longobject.c</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Python √©conomise donc beaucoup d'espace et de temps dans le calcul des nombres entiers couramment utilis√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci est le deuxi√®me article de la s√©rie Python Internals. Le premier article √©tait sur la fa√ßon dont j'ai chang√© ma version de Python pour la rendre</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ambigu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il vous aidera √† faire les premiers pas dans la compr√©hension du code source Python et √† continuer le chemin pour devenir un d√©veloppeur de noyau Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez voir plus d'articles similaires, abonnez-vous √† ma newsletter et recevez-les directement dans votre bo√Æte de r√©ception. </font><font style="vertical-align: inherit;">J'√©cris sur l'ing√©nierie, l'ing√©nierie des syst√®mes et un peu sur la programmation tous les vendredis. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envoyez-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> moi un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">courriel</font></a><font style="vertical-align: inherit;"> √† </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">@arpit_bhayani</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez retrouver mes pr√©c√©dents articles sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ arpitbhayani.me / blogs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout. </font><font style="vertical-align: inherit;">Rendez-vous sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parcours</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> !</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489244/index.html">D√©veloppement de plugins pour Zabbix Agent 2</a></li>
<li><a href="../fr489246/index.html">J'ai 14 ans et j'ai d√©cid√© de d√©velopper un jeu</a></li>
<li><a href="../fr489252/index.html">L'histoire de Telegram: d'une id√©e √† sa propre crypto-monnaie</a></li>
<li><a href="../fr489254/index.html">Yandex aide-t-il √† propager des logiciels malveillants?</a></li>
<li><a href="../fr489256/index.html">Syst√®mes d'automatisation Foundation Fieldbus</a></li>
<li><a href="../fr489260/index.html">Comment concevoir un syst√®me automatis√© √† grande √©chelle pour une grande entreprise en sept √©tapes</a></li>
<li><a href="../fr489262/index.html">Pourquoi il n'est pas facile de donner aux d√©veloppeurs la libert√© de choix</a></li>
<li><a href="../fr489268/index.html">Mise en ≈ìuvre du processus de t√©l√©chargement d'un fichier depuis un conteneur avec un navigateur vers un framework de test</a></li>
<li><a href="../fr489270/index.html">WebAuthn dans la vraie vie</a></li>
<li><a href="../fr489272/index.html">Yeux, cerveau, qualit√© vid√©o: r√©flexions sur 120fps, 8K, HDR, baguettes, c√¥nes et ¬´effet feuilleton¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>