<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ö±Ô∏è „äôÔ∏è üíØ When will the pandemic decline? Evaluating in Python with Pandas ‚òÅÔ∏è üßì üôéüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. 
 
 I saw several dashboards on COVID-19, but I have not yet found the main thing - the forecast of the time of the recession of the e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>When will the pandemic decline? Evaluating in Python with Pandas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495752/"><img src="https://habrastorage.org/webt/m3/fz/ve/m3fzvefgb0glikzia-3tq3b_vju.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hello everyone. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I saw several dashboards on COVID-19, but I have not yet found the main thing - the forecast of the time of the recession of the epidemic. </font><font style="vertical-align: inherit;">Therefore, I wrote a small Python script. </font><font style="vertical-align: inherit;">He takes data from WHO tables on Github, lays out by country, and draws trend lines. </font><font style="vertical-align: inherit;">And he makes predictions based on them - when in each country of the TOP 20 by the number of cases of COVID-19, a decline in infections can be expected. </font><font style="vertical-align: inherit;">I admit, I am not an expert in the field of epidemiology. </font><font style="vertical-align: inherit;">The calculations below are based on publicly available data and common sense. </font><font style="vertical-align: inherit;">All details are under cut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update from 04/10/2020 - the main table and graphs have been updated. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update 04/16/2020 - User</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h3cksl</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">made an update of the graphs and posted them on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">his website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update from 04/29/2020 - It has now become apparent that the curves of the daily number of infections are very different in different countries. </font><font style="vertical-align: inherit;">And it seems to depend heavily on the extent of the infection. </font><font style="vertical-align: inherit;">An ideal bell-shaped curve modeled on South Korea is more likely an exception to the rule. </font><font style="vertical-align: inherit;">A more common form is with a sharp increase to a peak and a subsequent decrease that is more extended over time. </font><font style="vertical-align: inherit;">Therefore, in reality, the decline in the incidence will last longer than that which was predicted by this model in early April.</font></font><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UFO Care Minute</font></font></h3><br>
     COVID-19 ‚Äî     ,   SARS-CoV-2 (2019-nCoV).        ‚Äî    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"> </b>
                        <div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> </a></li>
<li>       </li>
</ul><br>
     ,      .</div>
                    </div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></blockquote><br>
<h1>  </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first, in order to assess the timing of the epidemic, I used publicly available dashboards. One of the first was the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of the Center for Systems Science and Engineering of Johns Hopkins University. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3b/wp/qo/3bwpqo8nkyxvnxchi1u9yodfdyy.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
He's pretty pretty with his ominous simplicity. Until recently, it did not allow building the dynamics of the increment of infections by days, but it was corrected. And it is curious in that it allows you to see the spread of a pandemic on a world map. Given the black and red gamut of the dashboard, it‚Äôs not recommended to watch it for a long time. I think this may be fraught with the occurrence of anxiety attacks, turning into various forms of panic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to keep my finger on the pulse I liked the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page about COVID-19 more</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the Worldometer resource. </font><font style="vertical-align: inherit;">It contains information on countries in the form of a table: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/48/w5/rf/48w5rfy3tmloezx_cpg-yver0ea.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When you click on the desired country, we fall into more detailed information about it, including daily and cumulative curves for infected / recovered / dead. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are other dashboards. </font><font style="vertical-align: inherit;">For example, for in-depth information about our country, you can simply type in ‚ÄúCOVID-19‚Äù in the Yandex search line and you will find this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uy/pi/zj/uypizjcftuxfhofadcrw5decnsy.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, perhaps this will stop. </font><font style="vertical-align: inherit;">Neither on these three dashboards, nor on several others, I was able to find information with forecasts when the pandemic will finally decline.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A bit about graphs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Currently, infection is only gaining momentum and the most interesting are the graphs with a daily increase in the number of cases. Here is an example for the USA: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o-/mp/w6/o-mpw6ch2rb7ymt49ofpx7cpdum.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be seen that the number of infected people is growing every day. On such graphs, of course, we are not talking about all those who have become infected (it is not possible to determine their exact number), but only about confirmed cases. But for brevity, hereinafter we will call these confirmed infected simply ‚Äúinfected‚Äù. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What does a </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamed pandemic</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> look like </font><font style="vertical-align: inherit;">? An example here is a graph of South Korea:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/06/wd/r4/06wdr4j_z8ypumhggh-awymerw0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be seen that the daily increment of the infected first grew, then reached a peak, went down and fixed at a certain constant level (about 100 people per day). </font><font style="vertical-align: inherit;">This is not a complete victory over the virus, but significant success. </font><font style="vertical-align: inherit;">This allowed the country to start the economy (although, they say, Koreans managed not to slow it down) and return to a less normal life. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be assumed that the situation in other countries will develop in a similar way. </font><font style="vertical-align: inherit;">That is, growth at the first stage will be replaced by stabilization, and then the number of sick people will decline every day. </font><font style="vertical-align: inherit;">The result is a bell-shaped curve. </font><font style="vertical-align: inherit;">Let's look for the peaks of the curves of the most ‚Äúinfected‚Äù countries.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download and process data</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Coronavirus distribution data are updated on an ongoing basis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The source tables contain cumulative curves, they can be picked up and pre-processed with a small script.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Like this</font></font></b>
                        <div class="spoiler_text"><pre><code class="python">import pandas as pd<font></font>
import ipywidgets as widgets<font></font>
from ipywidgets import interact<font></font>
import matplotlib.pyplot as plt<font></font>
<font></font>
pd.set_option('display.max_columns', None)<font></font>
<font></font>
#  <font></font>
url = 'https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/'<font></font>
confirmed = pd.read_csv(url + 'time_series_covid19_confirmed_global.csv', sep = ',')<font></font>
deaths = pd.read_csv(url + 'time_series_covid19_deaths_global.csv', sep = ',')<font></font>
recovered = pd.read_csv(url + 'time_series_covid19_recovered_global.csv', sep = ',')<font></font>
<font></font>
#   -   'dd.mm.yy'<font></font>
new_cols = list(confirmed.columns[:4]) + list(confirmed.columns[4:].map(lambda x: '{0:02d}.{1:02d}.{2:d}'.format(int(x.split(sep='/')[1]), int(x.split(sep='/')[0]), int(x.split(sep='/')[2]))))<font></font>
confirmed.columns = new_cols<font></font>
recovered.columns = new_cols<font></font>
deaths.columns = new_cols<font></font>
<font></font>
#     <font></font>
confirmed_daily = confirmed.copy()<font></font>
confirmed_daily.iloc[:,4:] = confirmed_daily.iloc[:,4:].diff(axis=1)<font></font>
deaths_daily = deaths.copy()<font></font>
deaths_daily.iloc[:,4:] = deaths_daily.iloc[:,4:].diff(axis=1)<font></font>
recovered_daily = recovered.copy()<font></font>
recovered_daily.iloc[:,4:] = recovered_daily.iloc[:,4:].diff(axis=1)<font></font>
<font></font>
#       <font></font>
smooth_conf_daily = confirmed_daily.copy()<font></font>
smooth_conf_daily.iloc[:,4:] = smooth_conf_daily.iloc[:,4:].rolling(window=8, min_periods=2, center=True, axis=1).mean()<font></font>
smooth_conf_daily.iloc[:,4:] = smooth_conf_daily.iloc[:,4:].round(1)<font></font>
<font></font>
#   ,    <font></font>
last_date = confirmed.columns[-1]<font></font>
<font></font>
#  20       <font></font>
confirmed_top = confirmed.iloc[:, [1, -1]].groupby('Country/Region').sum().sort_values(last_date, ascending = False).head(20)<font></font>
countries = list(confirmed_top.index)<font></font>
<font></font>
# ,      20 <font></font>
conf_tot_ratio = confirmed_top.sum() / confirmed.iloc[:, 4:].sum()[-1]<font></font>
<font></font>
#    <font></font>
# countries.append('Russia')<font></font>
<font></font>
#       ,   <font></font>
l1 = 'Infected at ' + last_date + ' - ' + str(confirmed.iloc[:, 4:].sum()[-1])<font></font>
l2 = 'Recovered at ' + last_date + ' - ' + str(recovered.iloc[:, 4:].sum()[-1])<font></font>
l3 = 'Dead at ' + last_date + ' - ' + str(deaths.iloc[:, 4:].sum()[-1])<font></font>
<font></font>
#      <font></font>
fig, ax = plt.subplots(figsize = [16,6])<font></font>
ax.plot(confirmed.iloc[:, 4:].sum(), '-', alpha = 0.6, color = 'orange', label = l1)<font></font>
ax.plot(recovered.iloc[:, 4:].sum(), '-', alpha = 0.6, color = 'green', label = l2)<font></font>
ax.plot(deaths.iloc[:, 4:].sum(), '-', alpha = 0.6, color = 'red', label = l3)<font></font>
<font></font>
ax.legend(loc = 'upper left', prop=dict(size=12))<font></font>
ax.xaxis.grid(which='minor')<font></font>
ax.yaxis.grid()<font></font>
ax.tick_params(axis = 'x', labelrotation = 90)<font></font>
plt.title('COVID-19 in all countries. Top 20 countries consists {:.2%} of total confirmed infected cases.'.format(conf_tot_ratio[0]))<font></font>
plt.show()</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, you can get the same curves as on dashboards: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bw/i0/fg/bwi0fgdbszgcpqxywa4be9qr3lk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is a little extra in the script that is not needed to display the graph, but will be needed in the next steps. </font><font style="vertical-align: inherit;">For example, I immediately formed a list of 20 countries with the maximum number of infected today. </font><font style="vertical-align: inherit;">By the way - this is 90% of all infected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Move on. </font><font style="vertical-align: inherit;">The figures of the daily increase in the sick are quite ‚Äúnoisy‚Äù. </font><font style="vertical-align: inherit;">Therefore, it would be nice to smooth the chart. </font><font style="vertical-align: inherit;">Add a trend line to the daily charts (I used a centered moving average). </font><font style="vertical-align: inherit;">It turns out somehow like this:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/gj/33/kkgj33clru3yphaaet6jt7vifde.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The trend is shown in black. This is a fairly smooth curve with a single peak. It remains to find the beginning of the outbreak of the disease (red arrow) and the peak incidence (green). With a peak, everything is simple - this is the maximum on smoothed data. Moreover, if the maximum falls on the far right point of the graph, then the peak has not yet been passed. If the maximum remains to the left - most likely the peak has remained in the past. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The start of the burst can be found in different ways. Suppose for simplicity that this is the point in time when the number of infected per day begins to exceed 1% of the maximum number of infected per day. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The graph is quite symmetrical. That is, the duration from the onset of the epidemic to a peak is approximately equal to the duration from peak to decline.</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, if we find the number of days from the beginning to the peak, then approximately the same number of days will need to wait until the epidemic subsides</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will lay all this logic in the following script.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In such a</font></font></b>
                        <div class="spoiler_text"><pre><code class="python">from datetime import timedelta, datetime<font></font>
<font></font>
#     20  + .<font></font>
confirmed_top = confirmed_top.rename(columns={str(last_date): 'total_confirmed'})<font></font>
dates = [i for i in confirmed.columns[4:]]<font></font>
<font></font>
for country in countries:<font></font>
    <font></font>
    #       ,      ,  <font></font>
    confirmed_top.loc[country, 'total_confirmed'] = confirmed.loc[confirmed['Country/Region'] == country,:].sum()[4:][-1]<font></font>
    confirmed_top.loc[country, 'last_day_conf'] = confirmed.loc[confirmed['Country/Region'] == country,:].sum()[-1] - confirmed.loc[confirmed['Country/Region'] == country,:].sum()[-2]<font></font>
    confirmed_top.loc[country, 'mortality, %'] = round(deaths.loc[deaths['Country/Region'] == country,:].sum()[4:][-1]/confirmed.loc[confirmed['Country/Region'] == country,:].sum()[4:][-1]*100, 1)<font></font>
    <font></font>
    #       .<font></font>
    smoothed_conf_max = round(smooth_conf_daily[smooth_conf_daily['Country/Region'] == country].iloc[:,4:].sum().max(), 2)<font></font>
    peak_date = smooth_conf_daily[smooth_conf_daily['Country/Region'] == country].iloc[:,4:].sum().idxmax()<font></font>
    peak_day = dates.index(peak_date)<font></font>
    <font></font>
    #      ,      1%    <font></font>
    start_day = (smooth_conf_daily[smooth_conf_daily['Country/Region'] == country].iloc[:,4:].sum() &lt; smoothed_conf_max/100).sum()<font></font>
    start_date = dates[start_day-1]<font></font>
    <font></font>
    #     <font></font>
    confirmed_top.loc[country, 'trend_max'] = smoothed_conf_max<font></font>
    confirmed_top.loc[country, 'start_date'] = start_date<font></font>
    confirmed_top.loc[country, 'peak_date'] = peak_date<font></font>
    confirmed_top.loc[country, 'peak_passed'] = round(smooth_conf_daily.loc[smooth_conf_daily['Country/Region'] == country, last_date].sum(), 2) != smoothed_conf_max<font></font>
    confirmed_top.loc[country, 'days_to_peak'] = peak_day - start_day<font></font>
    <font></font>
    #   ,    <font></font>
    if confirmed_top.loc[country, 'peak_passed']:<font></font>
         confirmed_top.loc[country, 'end_date'] = (datetime.strptime(confirmed_top.loc[country, 'peak_date']+'20', "%d.%m.%Y").date() + timedelta(confirmed_top.loc[country, 'days_to_peak'])).strftime('%d.%m.%Y')<font></font>
<font></font>
#    <font></font>
confirmed_top.loc['China', 'start_date'] = '22.01.20'<font></font>
confirmed_top</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the output we get just such a table for the top 20 countries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update 10.04.2020: At the time of writing, Russia was not in the top twenty, but on April 7 it appeared in 20th place. April 10 left on the 18th. The table also includes the dates of quarantine measures in different countries. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/py/s7/za/pys7zajylfkbzgavdz84et5pt2q.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following columns are in the table: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
total_confirmed - the total number of infected in the country; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
last_day_conf - the number of infected on the last day; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mortality,% - mortality rate (number of dead / number of infected); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
trend_max - trend maximum; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
start_date - date the epidemic began in the country; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
peak_date - peak date; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
peak_passed - peak flag (if True - peak passed); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
days_to_peak - how many days have passed from the beginning to the peak;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end_date - end date of the epidemic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update 10.04.2020: the incidence peak was reached in 14 countries out of 20. Moreover, on average, from the beginning of mass infections to the peak, an average of 25 days passes: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1e/dm/ok/1edmoktmg1_mhsc2qhscociq0o8.png" alt="image"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">According to the above logic, by the end of April, the situation will have to normalize in almost all countries under consideration</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">As it will be, only time will tell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update 10.04.2020: You can see that the charts of European countries, in contrast to the chart of South Korea, have a more gentle recession after the peak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is another script that allows you to display graphs for each of the countries.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This</font></font></b>
                        <div class="spoiler_text"><pre><code class="python">@interact<font></font>
def plot_by_country(country = countries):<font></font>
    <font></font>
    #   <font></font>
    l1 = 'Infected at ' + last_date + ' - ' + str(confirmed.loc[confirmed['Country/Region'] == country,:].sum()[-1])<font></font>
    l2 = 'Recovered at ' + last_date + ' - ' + str(recovered.loc[recovered['Country/Region'] == country,:].sum()[-1])<font></font>
    l3 = 'Dead at ' + last_date + ' - ' + str(deaths.loc[deaths['Country/Region'] == country,:].sum()[-1])<font></font>
    <font></font>
    #        <font></font>
    df = pd.DataFrame(confirmed_daily.loc[confirmed_daily['Country/Region'] == country,:].sum()[4:])<font></font>
    df.columns = ['confirmed_daily']<font></font>
    df['recovered_daily'] = recovered_daily.loc[recovered_daily['Country/Region'] == country,:].sum()[4:]<font></font>
    df['deaths_daily'] = deaths_daily.loc[deaths_daily['Country/Region'] == country,:].sum()[4:]<font></font>
    df['deaths_daily'] = deaths_daily.loc[deaths_daily['Country/Region'] == country,:].sum()[4:]<font></font>
    df['smooth_conf_daily'] = smooth_conf_daily.loc[smooth_conf_daily['Country/Region'] == country,:].sum()[4:]<font></font>
    <font></font>
    #  <font></font>
    fig, ax = plt.subplots(figsize = [16,6], nrows = 1)<font></font>
    plt.title('COVID-19 dinamics daily in ' + country)<font></font>
    <font></font>
    #      ,   <font></font>
    ax.bar(df.index, df.confirmed_daily, alpha = 0.5, color = 'orange', label = l1)<font></font>
    ax.bar(df.index, df.recovered_daily, alpha = 0.6, color = 'green', label = l2)<font></font>
    ax.bar(df.index, df.deaths_daily, alpha = 0.7, color = 'red', label = l3)<font></font>
    ax.plot(df.index, df.smooth_conf_daily, alpha = 0.7, color = 'black')<font></font>
    <font></font>
    #     .<font></font>
    start_date = confirmed_top[confirmed_top.index == country].start_date.iloc[0]<font></font>
    start_point = smooth_conf_daily.loc[smooth_conf_daily['Country/Region'] == country, start_date].sum()<font></font>
    ax.plot_date(start_date, start_point, 'o', alpha = 0.7, color = 'black')<font></font>
    shift = confirmed_top.loc[confirmed_top.index == country, 'trend_max'].iloc[0]/40<font></font>
    plt.text(start_date, start_point + shift, 'Start at ' + start_date, ha ='right', fontsize = 20)<font></font>
    <font></font>
    peak_date = confirmed_top[confirmed_top.index == country].peak_date.iloc[0]<font></font>
    peak_point = smooth_conf_daily.loc[smooth_conf_daily['Country/Region'] == country, peak_date].sum()<font></font>
    ax.plot_date(peak_date, peak_point, 'o', alpha = 0.7, color = 'black')<font></font>
    plt.text(peak_date, peak_point + shift, 'Peak at ' + peak_date, ha ='right', fontsize = 20)<font></font>
    <font></font>
    ax.xaxis.grid(False)<font></font>
    ax.yaxis.grid(False)<font></font>
    ax.tick_params(axis = 'x', labelrotation = 90)<font></font>
    ax.legend(loc = 'upper left', prop=dict(size=12))<font></font>
    <font></font>
    #         .<font></font>
    max_pos = max(df['confirmed_daily'].max(), df['recovered_daily'].max())<font></font>
    if confirmed_top[confirmed_top.index == country].peak_passed.iloc[0]:<font></font>
        estimation = 'peak is passed - end of infection ' + confirmed_top[confirmed_top.index == country].end_date.iloc[0]<font></font>
    else:<font></font>
        estimation = 'peak is not passed - end of infection is not clear'<font></font>
    plt.text(df.index[len(df.index)//2], 3*max_pos//4, country, ha ='center', fontsize = 50)<font></font>
    plt.text(df.index[len(df.index)//2], 2*max_pos//3, estimation, ha ='center', fontsize = 20)<font></font>
    <font></font>
    #plt.savefig(country + '.png', bbox_inches='tight', dpi = 75)<font></font>
    plt.show()</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the current situation in Russia (update of 04/10/2020): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/qu/x5/axqux5c-nlco0-3z0axjcu7npzc.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, the peak has not yet been passed, so it is difficult to make predictions regarding the timing of the decrease in the incidence. </font><font style="vertical-align: inherit;">But given that the outbreak lasts 26 days at the moment, we can expect that during the week we will see a peak and the incidence will begin to decline. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I would venture to suggest that in early May the situation is normalizing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (I have always been an optimist, I must say). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you very much for reading to the end. </font><font style="vertical-align: inherit;">Be healthy and strength will be with us. </font><font style="vertical-align: inherit;">Below are charts for the rest of the twenty countries in descending order of the number of infected. </font><font style="vertical-align: inherit;">If you need more recent data - you can run the scripts given in the text, everything will be recalculated for the current date. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Update 10.04.2020 - the graphics are updated.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USA</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/il/sc/gt/ilscgts5k2vcr1se1jrfwcclyha.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spain</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/84/k_/jm/84k_jmnkj3-bkmkdhiultruhjcs.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Italy</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/eg/nk/l4/egnkl4v7lyot-jpyzktk6gnogug.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Germany</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/mm/zr/65/mmzr65zadf0ecueq5ju-zqzoo4k.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">France</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/j3/cr/1o/j3cr1oy1awvbiivptl0imdyful4.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">China</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/rt/og/us/rtogusfbdsp9e66zqod2fgbsf2m.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iran</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/26/ba/uf/26baufs15jticwrerqseuaizhhq.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">United Kingdom</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/-h/64/46/-h6446hkss6wh24idxkiarw5uxi.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turkey</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/w5/so/hk/w5sohkutmgaqnmpq0ya8h5hde5i.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Switzerland</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/hi/yq/2a/hiyq2a9_pkbtwsnr7-8-x6dsh9g.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Belgium</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/08/fb/pf/08fbpfwchavnnbr6v36hmal4m2e.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netherlands</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/aj/x6/yd/ajx6ydt2gqjyuprhvvzxui3f5ci.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canada</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/c6/lo/up/c6louppbvtnghvf79gutf7ajqeq.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Austria</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/kd/hq/xd/kdhqxdtdaragxjqotg0et0zkuum.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portugal</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/00/tb/go/00tbgotvnbd0qmnxcze7be7kf7w.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brazil</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/pa/xp/km/paxpkm9aour3qqdqa98ouvs0imo.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">South Korea</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/ma/d7/ld/mad7lddh5h4oa7yjvnwjm-k4tao.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Israel</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/uw/iz/ya/uwizyarggjredvypw81e66_58-a.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sweden</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/oy/4l/8r/oy4l8rsf_ljgqp_zf_4t2tlbiaa.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norway</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/hx/3z/77/hx3z77hiuzyzmypehwjexzw3nom.png" alt="image"><br>
</div>
                    </div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495730/index.html">Hack The Box. Passage Registry. Docker, RCE in CMS Bolt and Restic</a></li>
<li><a href="../en495732/index.html"># 03 - And a whole byte is not enough ... | 2B or not 2B</a></li>
<li><a href="../en495740/index.html">As we for a week without money, connections and software launched a food delivery service and almost did not screw up</a></li>
<li><a href="../en495746/index.html">We form View in SwiftUI, proceeding from conditions</a></li>
<li><a href="../en495748/index.html">New Punto Switcher for linux: xswitcher</a></li>
<li><a href="../en495754/index.html">Sim-sim open or reverse engineering smart intercom</a></li>
<li><a href="../en495756/index.html">Key principles for using ECS ‚Äã‚Äãin game development</a></li>
<li><a href="../en495758/index.html">Fires and Strategy</a></li>
<li><a href="../en495760/index.html">Brighter than the Stars: HGST rebranding and replenishment of the Ultrastar line</a></li>
<li><a href="../en495762/index.html">Prosto: remove boilerplate when working with RecyclerView</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>