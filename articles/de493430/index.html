<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛌 ⛹️ 🧑🏽‍🤝‍🧑🏻 Netzarchitektur für Webanwendungen 😙 🛁 🍸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich möchte Ihnen einen Ansatz vorstellen, den ich seit vielen Jahren bei der Entwicklung von Anwendungen, einschließlich Webanwendungen, verwende. Vie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Netzarchitektur für Webanwendungen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493430/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich möchte Ihnen einen Ansatz vorstellen, den ich seit vielen Jahren bei der Entwicklung von Anwendungen, einschließlich Webanwendungen, verwende. </font><font style="vertical-align: inherit;">Viele Entwickler von Desktop-, Server- und Mobilanwendungen sind mit diesem Ansatz vertraut. </font><font style="vertical-align: inherit;">ist beim Erstellen solcher Anwendungen von grundlegender Bedeutung, wird jedoch im Web sehr schlecht dargestellt, obwohl es definitiv Leute gibt, die diesen Ansatz verwenden möchten. </font><font style="vertical-align: inherit;">Darüber hinaus ist der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VS-Code-Editor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für diesen Ansatz geschrieben </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/ju/vy/djjuvyjprjf_nnnb0bv34ymklkc.png" alt="Reine Architektur"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Anwendung dieses Ansatzes wird ein bestimmtes Framework entfernt. </font><font style="vertical-align: inherit;">Sie können die Präsentationsbibliothek in Ihrer Anwendung einfach wechseln, z. B. React, Preact, Vue, Mithril, ohne die Geschäftslogik und in den meisten Fällen sogar Ansichten neu zu schreiben. </font><font style="vertical-align: inherit;">Wenn Sie eine Anwendung auf Angular 1 haben, können Sie diese problemlos in Angular 2+, React, Svelte, WebComponents oder sogar in Ihre Präsentationsbibliothek übersetzen. </font><font style="vertical-align: inherit;">Wenn Sie eine Anwendung auf Angular 2+ haben, aber keine Spezialisten dafür haben, können Sie die Anwendung problemlos in eine beliebtere Bibliothek übertragen, ohne die Geschäftslogik neu zu schreiben. </font><font style="vertical-align: inherit;">Vergessen Sie am Ende jedoch völlig das Problem der Migration vom Framework zum Framework. </font><font style="vertical-align: inherit;">Was für eine Art von Magie ist das?</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist saubere Architektur?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies zu verstehen, lesen Sie am besten das Buch </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von Martin Robert "Saubere Architektur"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von Robert C. </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Martin "Saubere Architektur </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">"</font></a><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ein kurzer Auszug, auf den im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel Bezug genommen wird</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptideen der Architektur:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unabhängigkeit vom Rahmen. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architektur hängt nicht von der Existenz einer Bibliothek ab. </font><font style="vertical-align: inherit;">Auf diese Weise können Sie das Framework als Tool verwenden, anstatt Ihr System in seine Grenzen zu drängen.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testbarkeit. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geschäftsregeln können ohne Benutzeroberfläche, Datenbank, Webserver oder andere externe Komponenten getestet werden.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unabhängigkeit von der Benutzeroberfläche. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Benutzeroberfläche kann einfach geändert werden, ohne den Rest des Systems zu ändern. </font><font style="vertical-align: inherit;">Beispielsweise kann die Weboberfläche durch die Konsole ersetzt werden, ohne die Geschäftsregeln zu ändern.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unabhängigkeit von der Datenbank. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können Oracle oder SQL Server gegen MongoDB, BigTable, CouchDB oder etwas anderes austauschen. </font><font style="vertical-align: inherit;">Ihre Geschäftsregeln sind nicht datenbankbezogen.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unabhängigkeit von externen Diensten. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tatsächlich wissen Ihre Geschäftsregeln einfach nichts über die Außenwelt.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die in diesem Buch seit vielen Jahren beschriebenen Ideen waren die Grundlage für die Erstellung komplexer Anwendungen in verschiedenen Bereichen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Flexibilität wird erreicht, indem die Anwendung in Service-, Repository- und Modellebenen unterteilt wird. </font><font style="vertical-align: inherit;">Ich habe den MVC-Ansatz zu Clean Architecture hinzugefügt und die folgenden Ebenen erhalten:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ansicht</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Zeigt dem Client Daten an und visualisiert dem Client den Status der Logik.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist für die Interaktion mit dem Benutzer über IO (Input-Output) verantwortlich.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist verantwortlich für die Geschäftslogik und deren Wiederverwendung zwischen Komponenten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - verantwortlich für den Empfang von Daten aus externen Quellen wie einer Datenbank, einer API, einem lokalen Speicher usw.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelle</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist verantwortlich für die Übertragung von Daten zwischen Schichten und Systemen sowie für die Logik der Verarbeitung dieser Daten.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zweck jeder Schicht wird unten diskutiert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wer ist reine Architektur?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Webentwicklung hat einen langen Weg zurückgelegt, von einfachen JQuery-Skripten bis zur Entwicklung großer SPA-Anwendungen. Und jetzt sind Webanwendungen so groß geworden, dass der Umfang der Geschäftslogik mit Server-, Desktop- und Mobilanwendungen vergleichbar oder sogar überlegen ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für Entwickler, die komplexe und große Anwendungen schreiben und Geschäftslogik vom Server auf Webanwendungen übertragen, um Serverkosten zu sparen, hilft Clean Architecture dabei, den Code und die Skalierung ohne Probleme in großem Umfang zu organisieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Ihre Aufgabe nur das Layout und die Animation von Zielseiten ist, kann Clean Architecture einfach nirgendwo eingefügt werden. </font><font style="vertical-align: inherit;">Wenn sich Ihre Geschäftslogik im Backend befindet und Ihre Aufgabe darin besteht, die Daten abzurufen, dem Kunden anzuzeigen und den Klick auf die Schaltfläche zu verarbeiten, werden Sie die Flexibilität von Clean Architecture nicht spüren, aber es kann ein hervorragendes Sprungbrett für das explosive Wachstum der Anwendung sein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wo bereits angewendet?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reine Architektur ist nicht an ein bestimmtes Framework, eine bestimmte Plattform oder eine bestimmte Programmiersprache gebunden. </font><font style="vertical-align: inherit;">Seit Jahrzehnten wird es zum Schreiben von Desktop-Anwendungen verwendet. </font><font style="vertical-align: inherit;">Die Referenzimplementierung finden Sie in den Frameworks für Serveranwendungen Asp.Net Core, Java Spring und NestJS. </font><font style="vertical-align: inherit;">Es ist auch sehr beliebt beim Schreiben von iOs und Android-Anwendungen. </font><font style="vertical-align: inherit;">In der Webentwicklung erschien er jedoch in einer äußerst erfolglosen Form in den Angular-Frameworks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da ich selbst nicht nur Typescript, sondern auch C # -Entwickler bin, werde ich beispielsweise die Referenzimplementierung dieser Architektur für Asp.Net Core übernehmen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist eine vereinfachte Beispielanwendung:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispielanwendung auf Asp.Net Core</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">    <span class="hljs-comment">/**
     * View
     */</span><font></font>
<font></font>
    @model WebApplication1.Controllers.Profile<font></font>
<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">text</span>-<span class="hljs-title">center</span>"&gt;
        &lt;<span class="hljs-title">h1</span>&gt;  @<span class="hljs-title">Model</span>.<span class="hljs-title">FirstName</span>&lt;/<span class="hljs-title">h1</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;

    /**
     * <span class="hljs-title">Controller</span>
     */

    <span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">IndexController</span> : <span class="hljs-title">Controller</span>
    </span>{
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> int _counter = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">private</span> readonly IUserProfileService _userProfileService;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> IndexController(IUserProfileService userProfileService)<font></font>
        {<font></font>
            _userProfileService = userProfileService;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; Index()<font></font>
        {<font></font>
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;IActionResult&gt; AddCounter()<font></font>
        {<font></font>
            _counter += <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> profile = await <span class="hljs-keyword">this</span>._userProfileService.GetProfile(_counter);
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">"Index"</span>, profile);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Service
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileService</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileService</span> : <span class="hljs-title">IUserProfileService</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly IUserProfileRepository _userProfileRepository;<font></font>
<font></font>
        <span class="hljs-keyword">public</span> UserProfileService(IUserProfileRepository userProfileRepository)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._userProfileRepository = userProfileRepository;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._userProfileRepository.GetProfile(id);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Repository
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserProfileRepository</span>
    </span>{<font></font>
        Task&lt;Profile&gt; GetProfile(long id);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileRepository</span> : <span class="hljs-title">IUserProfileRepository</span>
    </span>{
        <span class="hljs-keyword">private</span> readonly DBContext _dbContext;
        <span class="hljs-keyword">public</span> UserProfileRepository(DBContext dbContext)<font></font>
        {<font></font>
            <span class="hljs-keyword">this</span>._dbContext = dbContext;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">public</span> async Task&lt;Profile&gt; GetProfile(long id)<font></font>
        {<font></font>
            <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>._dbContext<font></font>
                .Set&lt;Profile&gt;()<font></font>
                .FirstOrDefaultAsync((entity) =&gt; entity.Id.Equals(id));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * Model
     */</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span>
    </span>{
        <span class="hljs-keyword">public</span> long Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string FirstName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        <span class="hljs-keyword">public</span> string Birthdate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }<font></font>
    }<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie nicht verstehen, dass es nichts Schlechtes sagt, werden wir es in Teilen jedes Fragments analysieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel wird für eine Asp.Net Core-Anwendung gegeben, aber für Java Spring, WinForms, Android, React sind Architektur und Code identisch, nur die Sprache und die Arbeit mit der Ansicht (falls vorhanden) ändern sich.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internetanwendung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das einzige Framework, das Clean Architecture verwenden wollte, war Angular. </font><font style="vertical-align: inherit;">Aber es stellte sich einfach als schrecklich heraus, dass in 1, dass in 2+. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dafür gibt es viele Gründe:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winkel monolithisches Gerüst. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und das ist sein Hauptproblem. </font><font style="vertical-align: inherit;">Wenn Ihnen etwas darin nicht gefällt, müssen Sie täglich daran ersticken, und Sie können nichts dagegen tun. </font><font style="vertical-align: inherit;">Es gibt nicht nur viele Problemstellen, sondern widerspricht auch der Ideologie der reinen Architektur.</font></font></li>
<li><b>   DI.</b>     ,            Javascript.</li>
<li><b>  .</b>        JSX.       ,           6,      .                .</li>
<li><b> .</b>      Rollup   ES2015   2        4 ,   angular       9.</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und viele weitere Probleme. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Allgemeinen rollt bis zur eckigen modernen Technologie mit einer Verzögerung von 5 Jahren relativ zu React.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber was ist mit anderen Frameworks? </font><font style="vertical-align: inherit;">React, Vue, Preact, Mithril und andere sind ausschließlich Repräsentationsbibliotheken und bieten keine Architektur ... und wir haben bereits Architektur ... es bleibt, alles zu einem Ganzen zusammenzufügen!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir beginnen eine Anwendung zu erstellen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden Pure Architecture am Beispiel einer fiktiven Anwendung betrachten, die einer echten Webanwendung so nahe wie möglich kommt. </font><font style="vertical-align: inherit;">Dies ist ein Büro in der Versicherungsgesellschaft, in dem das Benutzerprofil, die versicherten Ereignisse, die vorgeschlagenen Versicherungstarife und die Tools für die Arbeit mit diesen Daten angezeigt werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/sj/jf/fysjjf8fyz7rq0tzeaboesysuxw.jpeg" alt="Anwendungsprototyp"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Beispiel wird nur ein kleiner Teil der Funktion implementiert, aber daraus können Sie erkennen, wo und wie der Rest der Funktion positioniert werden muss. </font><font style="vertical-align: inherit;">Beginnen wir mit der Erstellung der Anwendung auf der Controller-Ebene und verbinden die View-Ebene ganz am Ende. </font><font style="vertical-align: inherit;">Und im Verlauf der Erstellung betrachten wir jede Ebene detaillierter.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller-Muster</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist für die Benutzerinteraktion mit der Anwendung verantwortlich. </font><font style="vertical-align: inherit;">Dies kann ein Klick auf eine Schaltfläche auf einer Webseite, einer Desktop-Anwendung, einer mobilen Anwendung oder die Eingabe eines Befehls in der Linux-Konsole oder eine Netzwerkanforderung oder ein anderes E / A-Ereignis sein, das in die Anwendung eingeht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einfachste Controller in einer sauberen Architektur lautet wie folgt:</font></font><br>
<br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleController</span> </span>{ <span class="hljs-comment">// extends React.Component&lt;object, object&gt;</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> todos: string[] = []; <span class="hljs-comment">//  </span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> addTodo(todo: string): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.push(todo);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> removeTodo(index: number): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.todos.splice(index, <span class="hljs-number">1</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// public render(): JSX.Element {...} // view injection</span><font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seine Aufgabe ist es, ein Ereignis vom Benutzer zu empfangen und Geschäftsprozesse zu starten. </font><font style="vertical-align: inherit;">Im Idealfall weiß der Controller nichts über View und kann dann zwischen Plattformen wie Web, React-Native oder Electron wiederverwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schreiben wir nun einen Controller für unsere Anwendung. </font><font style="vertical-align: inherit;">Seine Aufgabe ist es, ein Benutzerprofil und verfügbare Tarife zu erhalten und dem Benutzer den besten Tarif anzubieten:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controller mit Geschäftslogik</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageControlle</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
            <span class="hljs-keyword">this</span>.userProfile = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
            <span class="hljs-keyword">this</span>.tariffs = await response.json();
            <span class="hljs-keyword">this</span>.findBestTariff();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> findBestTariff(): <span class="hljs-keyword">void</span> { <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.userProfile &amp;&amp; <span class="hljs-keyword">this</span>.tariffs) {
            <span class="hljs-keyword">this</span>.bestTariff = <span class="hljs-keyword">this</span>.tariffs.find((tarif: any) =&gt; {
                <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= <span class="hljs-keyword">this</span>.userProfile.age &amp;&amp; <span class="hljs-keyword">this</span>.userProfile.age &lt; tarif.ageTo;<font></font>
            });<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben einen regulären Controller ohne saubere Architektur. Wenn wir ihn von React.Component erben, erhalten wir eine funktionierende Komponente mit Logik. </font><font style="vertical-align: inherit;">So viele Webanwendungsentwickler schreiben, aber dieser Ansatz hat viele wesentliche Nachteile. </font><font style="vertical-align: inherit;">Das Hauptproblem ist die Unfähigkeit, Logik zwischen Komponenten wiederzuverwenden. </font><font style="vertical-align: inherit;">Schließlich kann der empfohlene Tarif nicht nur in Ihrem persönlichen Konto, sondern auch auf der Zielseite und an vielen anderen Orten angezeigt werden, um einen Kunden für den Service zu gewinnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Logik zwischen Komponenten wiederverwenden zu können, muss sie in einer speziellen Ebene namens Service platziert werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicemuster</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - verantwortlich für die gesamte Geschäftslogik der Anwendung. </font><font style="vertical-align: inherit;">Wenn der Controller Daten empfangen, verarbeiten und senden musste, geschieht dies über den Dienst. </font><font style="vertical-align: inherit;">Wenn mehrere Controller dieselbe Logik benötigen, arbeiten sie mit Service zusammen. </font><font style="vertical-align: inherit;">Die Service-Schicht selbst sollte jedoch nichts über die Controller- und View-Schicht und die Umgebung wissen, in der sie arbeitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verschieben wir die Logik vom Controller zum Service und implementieren den Service im Controller:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Controller ohne Geschäftslogik</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: any = {};
    <span class="hljs-keyword">public</span> insuranceCases: any[] = [];
    <span class="hljs-keyword">public</span> tariffs: any[] = [];
    <span class="hljs-keyword">public</span> bestTariff: any = {};<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Service zum Arbeiten mit Benutzerprofil</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarifservice. </font><font style="vertical-align: inherit;">Service für die Arbeit mit Tarifen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn mehrere Controller ein Benutzerprofil oder Tarife benötigen, können sie dieselbe Logik aus den Diensten wiederverwenden. </font><font style="vertical-align: inherit;">Bei Dienstleistungen ist es wichtig, die SOLID-Prinzipien nicht zu vergessen und dass jeder Dienst für seinen Verantwortungsbereich verantwortlich ist. </font><font style="vertical-align: inherit;">In diesem Fall ist ein Dienst für die Arbeit mit dem Benutzerprofil verantwortlich, und ein anderer Dienst ist für die Arbeit mit Tarifen verantwortlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was aber, wenn sich die Datenquelle ändert, z. B. Fetch in Websocket oder Grps oder die Datenbank ändern kann und die realen Daten durch Testdaten ersetzt werden müssen? </font><font style="vertical-align: inherit;">Und warum muss die Geschäftslogik im Allgemeinen etwas über eine Datenquelle wissen? </font><font style="vertical-align: inherit;">Um diese Probleme zu lösen, gibt es eine Repository-Schicht.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository-Muster</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - verantwortlich für die Kommunikation mit dem Data Warehouse. </font><font style="vertical-align: inherit;">Der Speicher kann ein Server, eine Datenbank, ein Speicher, ein lokaler Speicher, ein Sitzungsspeicher oder ein anderer Speicher sein. </font><font style="vertical-align: inherit;">Seine Aufgabe besteht darin, die Service-Schicht von der spezifischen Speicherimplementierung zu abstrahieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns Netzwerkanforderungen von Diensten im Repository stellen, während sich der Controller nicht ändert:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Service zum Arbeiten mit Benutzerprofil</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Dienst zum Arbeiten mit Benutzerprofilspeicher</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;any&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarifservice. </font><font style="vertical-align: inherit;">Service für die Arbeit mit Tarifen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: any): Promise&lt;any&gt; {
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.getTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: any) =&gt; {
            <span class="hljs-keyword">return</span> tarif.ageFrom &lt;= userProfile.age &amp;&amp;<font></font>
                userProfile.age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifRepository. </font><font style="vertical-align: inherit;">Repository für die Arbeit mit Tarifspeicher</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;any&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt reicht es aus, eine Datenanforderung einmal zu schreiben, und jeder Dienst kann diese Anforderung wiederverwenden. </font><font style="vertical-align: inherit;">Später sehen wir uns ein Beispiel an, wie Sie das Repository neu definieren, ohne den Servicecode zu berühren, und das Mokka-Repository zum Testen implementieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im UserProfilService-Dienst scheint dies nicht erforderlich zu sein, und der Controller kann direkt auf das Repository für Daten zugreifen. Dies ist jedoch nicht der Fall. </font><font style="vertical-align: inherit;">Zu jedem Zeitpunkt können Anforderungen in der Geschäftsschicht auftreten oder sich ändern, eine zusätzliche Anforderung kann erforderlich sein oder Daten können angereichert werden. </font><font style="vertical-align: inherit;">Selbst wenn die Serviceschicht keine Logik enthält, muss die Controller-Service-Repository-Kette daher beibehalten werden. </font><font style="vertical-align: inherit;">Dies ist ein Beitrag zu Ihrem Morgen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist Zeit herauszufinden, welche Art von Repository eingerichtet wird, ob sie überhaupt korrekt sind. </font><font style="vertical-align: inherit;">Die Ebene Models ist dafür verantwortlich.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelle: DTO, Entities, ViewModels</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelle</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ist verantwortlich für die Beschreibung der Strukturen, mit denen die Anwendung arbeitet. </font><font style="vertical-align: inherit;">Eine solche Beschreibung hilft neuen Projektentwicklern sehr zu verstehen, mit was die Anwendung arbeitet. </font><font style="vertical-align: inherit;">Darüber hinaus ist es sehr praktisch, damit Datenbanken zu erstellen oder im Modell gespeicherte Daten zu validieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Modelle sind je nach Verwendungsart in verschiedene Muster unterteilt:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entitäten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - sind für die Arbeit mit der Datenbank verantwortlich und sind eine Struktur, die eine Tabelle oder ein Dokument in der Datenbank wiederholt.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DTO (Data Transfer Object)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - werden zum Übertragen von Daten zwischen verschiedenen Ebenen der Anwendung verwendet.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - enthält vorbereitete Informationen, die für die Anzeige in der Ansicht erforderlich sind.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie der Anwendung das Benutzerprofilmodell und andere Modelle hinzu, und teilen Sie den anderen Ebenen mit, dass wir jetzt nicht mit einem abstrakten Objekt, sondern mit einem ganz bestimmten Profil arbeiten:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Anstelle von irgendwelchen werden die beschriebenen Modelle verwendet.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">/**
     *          
     *          .
     */</span>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService: UserProfilService = <span class="hljs-keyword">new</span> UserProfilService();
    <span class="hljs-keyword">private</span> readonly tarifService: TariffService = <span class="hljs-keyword">new</span> TariffService();<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Geben Sie statt eines das zurückgegebene Modell an</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository =
        <span class="hljs-keyword">new</span> UserProfilRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarifservice. </font><font style="vertical-align: inherit;">Geben Sie statt eines das zurückgegebene Modell an</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository = <span class="hljs-keyword">new</span> TariffRepository();<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-comment">//  userProfile.age  userProfile.getAge()</span>
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Geben Sie statt eines das zurückgegebene Modell an</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifRepository. </font><font style="vertical-align: inherit;">Geben Sie statt eines das zurückgegebene Modell an</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">return</span> await response.json();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfileDto. </font><font style="vertical-align: inherit;">Ein Modell mit einer Beschreibung der Daten, mit denen wir arbeiten</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> </span>{ <span class="hljs-comment">// &lt;--      </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifDto. </font><font style="vertical-align: inherit;">Ein Modell mit einer Beschreibung der Daten, mit denen wir arbeiten</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> </span>{
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unabhängig davon, in welcher Ebene der Anwendung wir uns befinden, wissen wir genau, mit welchen Daten wir arbeiten. Aufgrund der Beschreibung des Modells haben wir auch einen Fehler in unserem Service gefunden. In der Servicelogik wurde die Eigenschaft userProfile.age verwendet, die eigentlich nicht vorhanden ist, aber ein Geburtsdatum hat. Um das Alter zu berechnen, müssen Sie die Modellmethode userProfile.getAge () aufrufen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt jedoch ein Problem. Wenn wir versuchen, die Methoden aus dem Modell zu verwenden, das das aktuelle Repository bereitgestellt hat, erhalten wir eine Ausnahme. Die Sache ist, dass die Methoden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">response.json ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON.parse ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt nicht unser Modell zurück, sondern ein JSON-Objekt, das in keiner Weise mit unserem Modell verknüpft ist. </font><font style="vertical-align: inherit;">Sie können dies überprüfen, wenn Sie den Befehl userProfile instanceof UserProfileDto ausführen und eine falsche Anweisung erhalten. </font><font style="vertical-align: inherit;">Um die von einer externen Quelle empfangenen Daten in das beschriebene Modell zu konvertieren, wird die Daten deserialisiert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten-Deserialisierung</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deserialisierung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - der Prozess der Wiederherstellung der erforderlichen Struktur aus einer Folge von Bytes. </font><font style="vertical-align: inherit;">Wenn die Daten Informationen enthalten, die nicht in den Modellen angegeben sind, werden sie ignoriert. </font><font style="vertical-align: inherit;">Wenn die Daten Informationen enthalten, die der Beschreibung des Modells widersprechen, tritt ein Deserialisierungsfehler auf. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und das Interessanteste dabei ist, dass sie beim Entwerfen des ES2015 und beim Hinzufügen des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassenschlüsselworts</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vergessen haben, Deserialisierung hinzuzufügen ... Die Tatsache, dass sie in allen Sprachen sofort einsatzbereit sind, haben sie in ES2015 einfach vergessen ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu lösen, habe ich eine Bibliothek für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TS-Serializable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deserialization geschrieben </font><font style="vertical-align: inherit;">, einen Artikel darüber kann unter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesem Link gelesen werden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Der Zweck besteht darin, die verlorene Funktionalität zurückzugeben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie dem Modell Deserialisierungsunterstützung und Deserialisierung selbst zum Repository hinzu:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifRepository. </font><font style="vertical-align: inherit;">Fügen Sie einen Deserialisierungsprozess hinzu</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifRepository. </font><font style="vertical-align: inherit;">Fügen Sie einen Deserialisierungsprozess hinzu</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; { <span class="hljs-comment">//  </span>
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object); <span class="hljs-comment">//  </span><font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProfileDto. </font><font style="vertical-align: inherit;">Deserialisierungsunterstützung hinzufügen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifDto. </font><font style="vertical-align: inherit;">Deserialisierungsunterstützung hinzufügen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{ <span class="hljs-comment">// &lt;--    </span><font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;--  </span>
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können Sie in allen Ebenen der Anwendung absolut sicher sein, dass wir mit den Modellen arbeiten, die wir erwarten. </font><font style="vertical-align: inherit;">In der Ansicht, dem Controller und anderen Ebenen können Sie die Methoden des beschriebenen Modells aufrufen.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wofür sind Serializable und jsonProperty?</font></font></b>
                        <div class="spoiler_text">        Serializable —         Ecmascript       Typescript.      jsonProperty         ,       Typescript            uniontypes.            .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt haben wir eine fast fertige Bewerbung. </font><font style="vertical-align: inherit;">Es ist Zeit, die in den Ebenen Controller, Service und Models geschriebene Logik zu testen. </font><font style="vertical-align: inherit;">Dazu müssen wir speziell vorbereitete Testdaten in der Repository-Schicht anstelle einer echten Anfrage an den Server zurückgeben. </font><font style="vertical-align: inherit;">Aber wie man das Repository ersetzt, ohne den Code zu berühren, der in die Produktion geht. </font><font style="vertical-align: inherit;">Hierfür gibt es ein Abhängigkeitsinjektionsmuster.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeitsinjektion - Abhängigkeitsinjektion</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeitsinjektion</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Fügt Abhängigkeiten in die Ebenen "Contoller", "Service" und "Repository" ein und ermöglicht es Ihnen, diese Abhängigkeiten außerhalb dieser Ebenen zu überschreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Programm hängt die Controller-Schicht von der Service-Schicht und von der Repository-Schicht ab. In der aktuellen Form verursachen Ebenen selbst ihre Abhängigkeiten durch Instanziierung. Und um die Abhängigkeit neu zu definieren, muss die Schicht diese Abhängigkeit von außen einstellen. Es gibt viele Möglichkeiten, dies zu tun, aber die beliebteste ist das Übergeben der Abhängigkeit als Parameter im Konstruktor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann sieht das Erstellen eines Programms mit allen Abhängigkeiten folgendermaßen aus:</font></font><br>
<pre><code class="actionscript hljs"><span class="hljs-keyword">var</span> programm = <span class="hljs-keyword">new</span> IndexPageController(<span class="hljs-keyword">new</span> ProfileService(<span class="hljs-keyword">new</span> ProfileRepository()));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stimme zu - es sieht schrecklich aus. </font><font style="vertical-align: inherit;">Selbst wenn man bedenkt, dass das Programm nur zwei Abhängigkeiten enthält, sieht es schon schrecklich aus. </font><font style="vertical-align: inherit;">Was soll man über Programme sagen, in denen Hunderte und Tausende von Abhängigkeiten bestehen? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Problem zu lösen, benötigen Sie ein spezielles Werkzeug, aber dafür müssen Sie es finden. </font><font style="vertical-align: inherit;">Wenn wir uns den Erfahrungen anderer Plattformen zuwenden, beispielsweise Asp.Net Core, erfolgt die Registrierung von Abhängigkeiten in der Initialisierungsphase des Programms und sieht ungefähr so ​​aus:</font></font><br>
<pre><code class="actionscript hljs">DI.register(IProfileService,ProfileService);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erstellen des Controllers erstellt und implementiert das Framework selbst diese Abhängigkeit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt jedoch drei wesentliche Probleme:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beim Transpilieren von Typescript in Javascript sind keine Spuren der Schnittstellen mehr vorhanden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alles, was in den klassischen DI fiel, bleibt für immer darin. </font><font style="vertical-align: inherit;">Es ist sehr schwierig, es während des Refactorings zu reinigen. </font><font style="vertical-align: inherit;">In einer Webanwendung müssen Sie jedes Byte speichern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fast alle Ansichtsbibliotheken verwenden DI nicht, und Controller-Designer sind mit Parametern beschäftigt.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Webanwendungen wird DI nur in Angular 2+ verwendet. </font><font style="vertical-align: inherit;">In Winkel 1 wurde beim Registrieren von Abhängigkeiten anstelle einer Schnittstelle eine Zeichenfolge verwendet, in InversifyJS wird Symbol anstelle der Schnittstelle verwendet. </font><font style="vertical-align: inherit;">Und all dies ist so schrecklich implementiert, dass es besser ist, viel Neues als im ersten Beispiel dieses Abschnitts zu haben als diese Lösungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um alle drei Probleme zu lösen, wurde mein eigenes DI erfunden, und die Lösung dafür half mir, das Java Spring-Framework und seinen automatisch verdrahteten Dekorator zu finden. </font><font style="vertical-align: inherit;">Die Beschreibung der Funktionsweise dieses DI finden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie im Artikel unter dem Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im GitHub-Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist Zeit, den resultierenden DI in unserer Anwendung anzuwenden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alles zusammenfügen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um DI auf allen Ebenen zu implementieren, fügen wir einen Reflection Decorator hinzu, der bewirkt, dass Typoskript zusätzliche Metainformationen zu Abhängigkeitstypen generiert. </font><font style="vertical-align: inherit;">In der Steuerung, in der Sie die Abhängigkeiten aufrufen müssen, hängen wir den automatisch verdrahteten Dekorator auf. </font><font style="vertical-align: inherit;">Und an der Stelle, an der das Programm initialisiert wird, bestimmen wir, in welcher Umgebung welche Abhängigkeit implementiert wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie für das UserProfilRepository-Repository dasselbe Repository, jedoch mit Testdaten anstelle der eigentlichen Anforderung. </font><font style="vertical-align: inherit;">Als Ergebnis erhalten wir den folgenden Code:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Speicherort für die Programminitialisierung</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Abhängigkeit durch den Autodrahtdekorateur</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired() <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    constructor() {<font></font>
        <span class="hljs-comment">//     , ..  </span>
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Einführung in Reflexion und Abhängigkeitsgenerierung</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarifservice. </font><font style="vertical-align: inherit;">Einführung in Reflexion und Abhängigkeitsgenerierung</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-comment">//    </span>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Einführung in die Reflexionsgenerierung</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MockUserProfilRepository. </font><font style="vertical-align: inherit;">Neues Repository zum Testen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TarifRepository. </font><font style="vertical-align: inherit;">Einführung in die Reflexionsgenerierung</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt gibt es überall im Programm die Möglichkeit, die Implementierung einer Logik zu ändern. </font><font style="vertical-align: inherit;">In unserem Beispiel werden anstelle einer echten Benutzerprofilanforderung an den Server in der Testumgebung Testdaten verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im wirklichen Leben können Ersetzungen überall gefunden werden. Sie können beispielsweise die Logik in einem Service ändern, den alten Service in der Produktion implementieren und beim Refactoring ist er bereits neu. </font><font style="vertical-align: inherit;">Führen Sie A / B-Tests mit Geschäftslogik durch, ändern Sie die dokumentbasierte Datenbank in relational und ändern Sie die Netzwerkanforderung im Allgemeinen in Web-Sockets. </font><font style="vertical-align: inherit;">Und das alles, ohne die Entwicklung anzuhalten, um die Lösung neu zu schreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist Zeit, das Ergebnis des Programms zu sehen. </font><font style="vertical-align: inherit;">Hierfür gibt es eine Ansichtsebene.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">View implementieren</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ansichtsebene ist dafür verantwortlich, dem Benutzer die in der Controller-Ebene enthaltenen Daten zu präsentieren. </font><font style="vertical-align: inherit;">In diesem Beispiel werde ich React dafür verwenden, aber an seiner Stelle kann es sich auch um ein anderes handeln, z. B. Preact, Svelte, Vue, Mithril, WebComponent oder ein anderes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erben Sie dazu einfach unseren Controller von React.Component und fügen Sie ihm eine Rendermethode mit der Darstellung der Ansicht hinzu:</font></font><br>
<br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Startet das Zeichnen einer React-Komponente</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-comment">//         </span>
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Erbt von React.Component und fügt eine Rendermethode hinzu</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
<span class="hljs-comment">//    React.Component</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">object</span>, <span class="hljs-title">object</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   </span><font></font>
    constructor(props: object, context: object) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//     </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate(); <span class="hljs-comment">//  view   </span>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): JSX.Element {
        <span class="hljs-keyword">return</span> (<font></font>
            &lt;&gt;<font></font>
                &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                         : {<span class="hljs-keyword">this</span>.userProfile.getFullname()}<font></font>
                    &lt;/div&gt;<font></font>
                    &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                        : {<span class="hljs-keyword">this</span>.userProfile.getAge()}<font></font>
                    &lt;/div&gt;<font></font>
                &lt;/div&gt;<font></font>
                &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
                    {<span class="hljs-comment">/*    */</span>}<font></font>
                &lt;/div&gt;<font></font>
            &lt;/&gt;<font></font>
        );<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch Hinzufügen von nur zwei Zeilen und einer Präsentationsvorlage wurde unser Controller zu einer Reaktionskomponente mit Arbeitslogik.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum wird forceUpdate anstelle von setState aufgerufen?</font></font></b>
                        <div class="spoiler_text">     forceUpdate  ,   setState.          setState, Redux, mobX  .,          .  React  Preact  forceUpdate,   ChangeDetectorRef.detectChanges(),  Mithril  redraw   .         Observable   ,    MobX  Angular,   .         .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber selbst in einer solchen Implementierung stellte sich heraus, dass wir mit der React-Bibliothek mit ihrem Lebenszyklus, der Ansichtsimplementierung und dem Prinzip der Ungültigmachung der Ansicht verbunden waren, was dem Konzept der sauberen Architektur widerspricht. </font><font style="vertical-align: inherit;">Logik und Layout befinden sich in derselben Datei, was die parallele Arbeit von Schriftsetzer und Entwickler erschwert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trennung von Controller und Ansicht</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um beide Probleme zu lösen, fügen wir die Ansichtsebene in eine separate Datei ein und erstellen anstelle der React-Komponente die Basiskomponente, die unseren Controller von einer bestimmten Präsentationsbibliothek abstrahiert. </font><font style="vertical-align: inherit;">Gleichzeitig beschreiben wir die Attribute, die die Komponente annehmen kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten folgende Änderungen:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Sie nahmen die Ansicht in eine separate Datei</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageOptions. </font><font style="vertical-align: inherit;">Betrachten und reagieren Sie auf eine separate Datei</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    BaseComponent</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BaseComponent </font><font style="vertical-align: inherit;">Eine Komponente, die uns von einem bestimmten Framework abstrahiert</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-comment">//  view</span>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);
        <span class="hljs-comment">//    </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   view</span>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt befindet sich unsere Ansicht in einer separaten Datei, und der Controller weiß nichts darüber, außer dass dies der Fall ist. Vielleicht sollten Sie die Ansicht nicht über die Controller-Eigenschaft einfügen, sondern wie Angular über den Dekorator, aber dies ist ein Thema, über das Sie nachdenken sollten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Grundkomponente enthält auch eine Abstraktion vom Lebenszyklus des Frameworks. Sie unterscheiden sich in allen Frameworks, aber in allen Frameworks. Angular ist ngOnInit, ngOnChanges, ngOnDestroy. In React and Preact ist dies componentDidMount, shouldComponentUpdate, componentWillUnmount. In Vue wird dies erstellt, aktualisiert und zerstört. In Mithril ist es oncreate, onupdate, onremove. In WebComponents ist dies ConnectedCallback, AttributeChangedCallback, DisconnectedCallback. Und so in jeder Bibliothek. Die meisten haben sogar die gleiche oder eine ähnliche Schnittstelle.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem können die Bibliothekskomponenten jetzt mit einer eigenen Logik für die spätere Wiederverwendung zwischen allen Komponenten erweitert werden. </font><font style="vertical-align: inherit;">Zum Beispiel Einführung von Tools für Analyse, Überwachung, Protokollierung usw.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir schauen uns das Ergebnis an</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es bleibt nur zu bewerten, was passiert ist. </font><font style="vertical-align: inherit;">Das gesamte Programm hat die folgende endgültige Form:</font></font><br>
<blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main.ts. </font><font style="vertical-align: inherit;">Die Datei, aus der das Programm gestartet wird</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { override } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { MockUserProfilRepository } from "./MockUserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { render } from "react-dom";</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"test"</span>) {
    <span class="hljs-keyword">override</span>(UserProfilRepository, MockUserProfilRepository);<font></font>
}<font></font>
<font></font>
render(React.createElement(UserPageController), document.body);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageView. </font><font style="vertical-align: inherit;">Darstellung einer der Programmkomponenten.</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserPageOptions, UserPageController } from "./UserPageController";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-keyword">const</span> userPageView = &lt;P <span class="hljs-keyword">extends</span> UserPageOptions, S&gt;(<font></font>
    ctrl: UserPageController&lt;P, S&gt;,<font></font>
    props: P<font></font>
): JSX.Element =&gt; (<font></font>
    &lt;&gt;<font></font>
        &lt;div className=<span class="hljs-string">"user"</span>&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-name"</span>&gt;<font></font>
                 : {ctrl.userProfile.getFullname()}<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className=<span class="hljs-string">"user-age"</span>&gt;<font></font>
                : {ctrl.userProfile.getAge()}<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        &lt;div className=<span class="hljs-string">"tarifs"</span>&gt;<font></font>
            {<span class="hljs-comment">/*    */</span>}<font></font>
        &lt;/div&gt;<font></font>
    &lt;/&gt;<font></font>
);<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserPageController. </font><font style="vertical-align: inherit;">Die Logik einer der Komponenten für die Benutzerinteraktion</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilService } from "./UserProfilService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffService } from "./TariffService";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { InsuranceCaseDto } from "./InsuranceCasesDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { autowired } from "first-di";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { BaseComponent } from "./BaseComponent";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { userPageView } from "./UserPageview";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserPageOptions</span> </span>{<font></font>
    param1?: number;<font></font>
    param2?: string;<font></font>
}<font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPageController</span>&lt;<span class="hljs-title">P</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UserPageOptions</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> userProfile: UserProfileDto = <span class="hljs-keyword">new</span> UserProfileDto();
    <span class="hljs-keyword">public</span> insuranceCases: InsuranceCaseDto[] = [];
    <span class="hljs-keyword">public</span> tariffs: TariffDto[] = [];
    <span class="hljs-keyword">public</span> bestTariff: TariffDto | <span class="hljs-keyword">void</span> = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> readonly view = userPageView;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilService!: UserProfilService;<font></font>
<font></font>
    @autowired()<font></font>
    <span class="hljs-keyword">private</span> readonly tarifService!: TariffService;<font></font>
<font></font>
    <span class="hljs-comment">//   componentDidMount, . BaseComponent</span>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.requestUserProfile();
        <span class="hljs-keyword">this</span>.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestUserProfile(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.userProfile = await <span class="hljs-keyword">this</span>.userProfilService.getUserProfile();
            <span class="hljs-keyword">this</span>.bestTariff = await <span class="hljs-keyword">this</span>.tarifService.findBestTariff(<span class="hljs-keyword">this</span>.userProfile);
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;<span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">this</span>.tariffs = await <span class="hljs-keyword">this</span>.tarifService.getTariffs();
            <span class="hljs-keyword">this</span>.forceUpdate();<font></font>
        } <span class="hljs-keyword">catch</span> (e) {<font></font>
            console.error(e);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...   ,   ,
     *  ,    
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BaseComponent </font><font style="vertical-align: inherit;">Basisklasse für alle Programmkomponenten</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> React from "react";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">public</span> view?: (ctrl: <span class="hljs-keyword">this</span>, props: P) =&gt; JSX.Element;<font></font>
<font></font>
    constructor(props: P, context: S) {<font></font>
        <span class="hljs-keyword">super</span>(props, context);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentDidMount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.activate &amp;&amp; <span class="hljs-keyword">this</span>.activate();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> shouldComponentUpdate(<font></font>
        nextProps: Readonly&lt;P&gt;,<font></font>
        nextState: Readonly&lt;S&gt;,<font></font>
        nextContext: any<font></font>
    ): boolean {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.update(nextProps, nextState, nextContext);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> componentWillUnmount(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">this</span>.dispose();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> activate(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> update(nextProps: Readonly&lt;P&gt;, nextState: Readonly&lt;S&gt;, nextContext: any): boolean {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> dispose(): <span class="hljs-keyword">void</span> {
        <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> render(): React.ReactElement&lt;object&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilService. </font><font style="vertical-align: inherit;">Dienst zum Wiederverwenden der Logik zwischen Komponenten, um mit einem Benutzerprofil zu arbeiten</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfilRepository } from "./UserProfilRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly userProfilRepository: UserProfilRepository;<font></font>
<font></font>
    constructor(userProfilRepository: UserProfilRepository) {<font></font>
        <span class="hljs-keyword">this</span>.userProfilRepository = userProfilRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.userProfilRepository.getUserProfile();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarifservice. </font><font style="vertical-align: inherit;">Service zur Wiederverwendung von Logik zwischen Komponenten für die Arbeit mit Tarifen</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffRepository } from "./TariffRepository";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffService</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> readonly tarifRepository: TariffRepository;<font></font>
<font></font>
    constructor(tarifRepository: TariffRepository) {<font></font>
        <span class="hljs-keyword">this</span>.tarifRepository = tarifRepository;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async getTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">return</span> await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> async findBestTariff(userProfile: UserProfileDto): Promise&lt;TariffDto | <span class="hljs-keyword">void</span>&gt; {
        <span class="hljs-keyword">const</span> tariffs = await <span class="hljs-keyword">this</span>.tarifRepository.requestTariffs();
        <span class="hljs-keyword">return</span> tariffs.find((tarif: TariffDto) =&gt; {
            <span class="hljs-keyword">const</span> age = userProfile.getAge();
            <span class="hljs-keyword">return</span> age &amp;&amp;<font></font>
                tarif.ageFrom &lt;= age &amp;&amp;<font></font>
                age &lt; tarif.ageTo;<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...       
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserProfilRepository. </font><font style="vertical-align: inherit;">Repository zum Empfangen, Überprüfen und Validieren eines Profils vom Server</font></font></b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfilRepository</span> </span>{
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/user-profile"</span>);
        <span class="hljs-keyword">const</span> object = await response.json();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserProfileDto().fromJSON(object);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">MockUserProfilRepository.         </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { UserProfileDto } from "./UserProfileDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserProfilRepository</span> </span>{ <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">public</span> async getUserProfile(): Promise&lt;UserProfileDto&gt; {
        <span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">new</span> UserProfileDto();<font></font>
        profile.firstName = <span class="hljs-string">""</span>;<font></font>
        profile.lastName = <span class="hljs-string">""</span>;<font></font>
        profile.birthdate = <span class="hljs-keyword">new</span> Date(Date.now() - <span class="hljs-number">1.5e12</span>);
        <span class="hljs-keyword">return</span> Promise.resolve(profile); <span class="hljs-comment">//   </span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffRepository.      ,    </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { TariffDto } from "./TariffDto";</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { reflection } from "first-di";</span><font></font>
<font></font>
@reflection <span class="hljs-comment">//  typescript  </span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffRepository</span> </span>{
    <span class="hljs-keyword">public</span> async requestTariffs(): Promise&lt;TariffDto[]&gt; {
        <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-string">"./api/tariffs"</span>);
        <span class="hljs-keyword">const</span> objects: object[] = await response.json();
        <span class="hljs-keyword">return</span> objects.map((object: object) =&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TariffDto().fromJSON(object);<font></font>
        });<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * ...        
     */</span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">UserProfileDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserProfileDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> firstName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(String, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> lastName: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    @jsonProperty(Date, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> birthdate: Date | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getAge(): number | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.birthdate) {
            <span class="hljs-keyword">const</span> ageDifMs = Date.now() - <span class="hljs-keyword">this</span>.birthdate.getTime();
            <span class="hljs-keyword">const</span> ageDate = <span class="hljs-keyword">new</span> Date(ageDifMs);
            <span class="hljs-keyword">return</span> Math.abs(ageDate.getUTCFullYear() - <span class="hljs-number">1970</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> getFullname(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> [
            <span class="hljs-keyword">this</span>.firstName ?? <span class="hljs-string">""</span>,
            <span class="hljs-keyword">this</span>.lastName ?? <span class="hljs-string">""</span><font></font>
        ]<font></font>
            .join(<span class="hljs-string">" "</span>)<font></font>
            .trim() || <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">TariffDto.           </b>
                        <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span> { Serializable, jsonProperty } from "ts-serializable";</span><font></font>
<font></font>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TariffDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>{<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageFrom: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> ageTo: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
    @jsonProperty(Number, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">public</span> price: number = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis haben wir eine modular skalierbare Anwendung mit einer sehr geringen Menge an Boilerplate (1 Basiskomponente, 3 Zeilen zum Implementieren von Abhängigkeiten pro Klasse) und einem sehr geringen Overhead (eigentlich nur zum Implementieren von Abhängigkeiten, alles andere ist logisch) erhalten. </font><font style="vertical-align: inherit;">Wir sind auch nicht an eine Präsentationsbibliothek gebunden. </font><font style="vertical-align: inherit;">Als Angular 1 starb, begannen viele, Anwendungen in React neu zu schreiben. </font><font style="vertical-align: inherit;">Als die Entwickler von Angular 2 erschöpft waren, litten viele Unternehmen unter der Geschwindigkeit der Entwicklung. </font><font style="vertical-align: inherit;">Wenn React erneut stirbt, müssen Sie die Lösungen, die an das Framework und das Ökosystem gebunden sind, neu schreiben. </font><font style="vertical-align: inherit;">Mit Chita Architecture können Sie jedoch vergessen, das Framework zu binden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist der Vorteil gegenüber Redux?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Unterschied zu verstehen, wollen wir sehen, wie sich Redux verhält, wenn die Anwendung wächst. </font></font><br>
<img src="https://habrastorage.org/webt/jj/i9/cc/jji9ccsijjqancrthtv9gpudc48.png" alt="Redux"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie dem Diagramm entnehmen können, nehmen mit dem vertikal skalierten Wachstum von Redux-Anwendungen auch der Store und die Anzahl der Reduzierer zu und werden zu einem Engpass. Und der Aufwand für den Wiederaufbau des Geschäfts und die Suche nach dem richtigen Reduzierer beginnt, die Nutzlast zu überschreiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können das Verhältnis von Overhead zu Nutzlast in einer mittelgroßen Anwendung mit einem einfachen Test überprüfen.</font></font><br>
<pre><code class="actionscript hljs">let create = <span class="hljs-keyword">new</span> Function([
<span class="hljs-string">"return {"</span>,<font></font>
...new Array(<span class="hljs-number">100</span>).fill(<span class="hljs-number">1</span>).map((val, ind) =&gt; `param${ind}:${ind},`),
<span class="hljs-string">"}"</span>
].join(<span class="hljs-string">""</span>));<font></font>
<font></font>
let obj1 = create();<font></font>
<font></font>
console.time(<span class="hljs-string">"store recreation time"</span>);<font></font>
let obj2 = {<font></font>
    ...obj1,<font></font>
    param100: <span class="hljs-number">100</span> ** <span class="hljs-number">2</span><font></font>
}<font></font>
console.timeEnd(<span class="hljs-string">"store recreation time"</span>);<font></font>
<font></font>
console.time(<span class="hljs-string">"clear logic"</span>);<font></font>
let val = <span class="hljs-number">100</span> ** <span class="hljs-number">2</span>;<font></font>
console.timeEnd(<span class="hljs-string">"clear logic"</span>);<font></font>
<font></font>
console.log(obj2, val);<font></font>
<font></font>
<span class="hljs-comment">// store recreation time: 0.041015625ms</span>
<span class="hljs-comment">// clear logic: 0.0048828125ms</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Wiederherstellen des Speichers in 100 Eigenschaften dauerte achtmal länger als die Logik selbst. Mit 1000 Elementen ist dies bereits 50-mal mehr. Darüber hinaus kann eine Benutzeraktion eine ganze Reihe von Aktionen erzeugen, deren Aufruf schwer abzufangen und zu debuggen ist. Sie können sicherlich argumentieren, dass 0,04 ms zum Wiederherstellen des Stores sehr klein sind und nicht langsamer werden. Aber 0,04 ms sind auf dem Core i7-Prozessor und für eine Aktion. Angesichts der schwächeren mobilen Prozessoren und der Tatsache, dass eine einzelne Benutzeraktion Dutzende von Aktionen hervorrufen kann, führt dies dazu, dass die Berechnungen nicht in 16 ms passen und das Gefühl entsteht, dass die Anwendung langsamer wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergleichen wir, wie die Clean Architecture-Anwendung wächst:</font></font><br>
<img src="https://habrastorage.org/webt/oz/eg/uk/ozegukclnowpqlzdnckk3pfkckc.png" alt="Reine Architektur"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie aufgrund der Trennung von Logik und Verantwortlichkeiten zwischen den Ebenen zu sehen ist, wird die Anwendung horizontal skaliert. </font><font style="vertical-align: inherit;">Wenn eine Komponente die Daten verarbeiten muss, wendet sie sich an den entsprechenden Dienst, ohne die Dienste zu berühren, die nicht mit ihrer Aufgabe zusammenhängen. </font><font style="vertical-align: inherit;">Nach dem Empfang der Daten wird nur eine Komponente neu gezeichnet. </font><font style="vertical-align: inherit;">Die Datenverarbeitungskette ist sehr kurz und offensichtlich, und für maximal 4 Codesprünge können Sie die erforderliche Logik finden und debuggen. </font><font style="vertical-align: inherit;">Wenn wir eine Analogie zu einer Mauer ziehen, können wir außerdem jeden Stein von dieser Mauer entfernen und durch einen anderen ersetzen, ohne die Stabilität dieser Mauer zu beeinträchtigen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 1: Verbesserte Funktionalität der Komponenten des Frameworks</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Bonus war die Fähigkeit, das Verhalten der Komponenten der Präsentationsbibliothek zu ergänzen oder zu ändern. </font><font style="vertical-align: inherit;">Eine Reaktion im Falle eines Fehlers in der Ansicht rendert beispielsweise nicht die gesamte Anwendung, wenn eine kleine Überarbeitung vorgenommen wird:</font></font><br>
<pre><code class="actionscript hljs">export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseComponent</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;<span class="hljs-title">P</span>, <span class="hljs-title">S</span>&gt; </span>{<font></font>
<font></font>
    ...<font></font>
<font></font>
    public render(): React.ReactElement&lt;object&gt; {<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.view) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.view(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.props);<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">"div"</span>, {}, <span class="hljs-string">"  "</span>);<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-keyword">return</span> React.createElement(
                <span class="hljs-string">"div"</span>,<font></font>
                { style: { color: <span class="hljs-string">"red"</span> } },<font></font>
                `    : ${e}`<font></font>
            );<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt zeichnet die Reaktion nicht nur die Komponente, in der der Fehler aufgetreten ist. </font><font style="vertical-align: inherit;">Auf die gleiche einfache Weise können Sie Überwachung, Analyse und andere Nishtyaki hinzufügen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 2: Datenvalidierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modelle beschreiben nicht nur Daten und übertragen Daten zwischen Ebenen, sondern bieten auch einen großen Spielraum. </font><font style="vertical-align: inherit;">Wenn Sie beispielsweise die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassenvalidatorbibliothek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verbinden </font><font style="vertical-align: inherit;">, können Sie durch einfaches Aufhängen der Dekoratoren die Daten in diesen Modellen validieren, einschließlich </font><font style="vertical-align: inherit;">Mit ein wenig Verfeinerung können Sie Webformulare validieren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus 3: Entitäten erstellen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mit einer lokalen Datenbank arbeiten müssen, können Sie außerdem die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typorm-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek verbinden, </font><font style="vertical-align: inherit;">und Ihre Modelle werden zu Entitäten, mit denen die Datenbank generiert und ausgeführt wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielen Dank für Ihre Aufmerksamkeit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Ihnen der Artikel oder Ansatz gefallen hat, mögen Sie es und haben Sie keine Angst zu experimentieren. </font><font style="vertical-align: inherit;">Wenn Sie ein Redux-Anhänger sind und Dissens nicht mögen, erläutern Sie bitte in den Kommentaren, wie Sie die Daten in Ihrer Anwendung skalieren, testen und validieren.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493418/index.html">Warum maschinelles Lernen „synthetische“ Daten verwendet</a></li>
<li><a href="../de493420/index.html">Mein Weg, Schüler der Mittelstufe in Python einzuführen</a></li>
<li><a href="../de493424/index.html">Wir implementieren Python-Code-Konvertierungen</a></li>
<li><a href="../de493426/index.html">Organisation von Code in Microservices und mein Ansatz zur Verwendung von hexagonaler Architektur und DDD</a></li>
<li><a href="../de493428/index.html">"Wir werden keine Verschwörungstheorien hervorbringen." Sprechen Sie über ML-Konferenzen mit Menschen aus Wissenschafts- und IT-Unternehmen</a></li>
<li><a href="../de493432/index.html">Warum nicht eine Karriere in einem kleinen Nicht-IT-Unternehmen beginnen?</a></li>
<li><a href="../de493436/index.html">Programm zum Ändern von Zugriffsrechten und zum Registrieren von Datei- / Verzeichnisnamen auf Bash</a></li>
<li><a href="../de493438/index.html">Anzeigen von Suchergebnissen und Leistungsproblemen</a></li>
<li><a href="../de493440/index.html">Influencer Marketing in China: Worauf basiert es und was können Influencer im Notfall bieten?</a></li>
<li><a href="../de493442/index.html">PSA-Erinnerung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>