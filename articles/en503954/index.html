<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐆 🤾🏼 🤽🏽 Your first step in Data Science. Titanic 🎰 👨‍👨‍👦‍👦 💤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small introduction
 I believe that we could do more things if we were provided with step-by-step instructions that will tell what and how to do. I m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Your first step in Data Science. Titanic</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503954/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A small introduction</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I believe that we could do more things if we were provided with step-by-step instructions that will tell what and how to do. I myself recall in my life those moments when a business could not start due to the fact that it was simply difficult to understand where to start. Perhaps, once upon a time on the Internet you saw the words “Data Science” and decided that you are far from that, and the people who are doing this somewhere out there, in another world. So no, they are right here. And, perhaps, thanks to people from this sphere, an article has appeared in your feed. There are many courses that will help you get comfortable with this craft, here I will help you take the first step.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, are you ready? </font><font style="vertical-align: inherit;">I must say right away that you will have to know Python 3, since I will use it here. </font><font style="vertical-align: inherit;">And also I advise you to pre-install on the Jupyter Notebook or see how to use google colab.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step one</font></font></h3><br>
<img src="https://miro.medium.com/max/1024/1*bQYZ7fp_wcjWFwpBbcRS-Q.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kaggle is your significant assistant in this matter. In principle, you can do without it, but I will talk about this in another article. This is the platform that hosts the Data Science competition. In each such competition in the early stages you will receive an unrealistic amount of experience in solving various problems, development experience and teamwork experience, which is important in our time. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will take our task from there. It is called so: "Titanic." The condition is this: to predict each individual person will survive. Generally speaking, the task of the person involved in DS is the collection of data, their processing, model training, forecasting and so on. At kaggle, we are allowed to skip the data collection stage - they are presented on the platform. We need to download them and you can get started! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can do this as follows:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
in the Data tab are the files that contain the data </font></font><br>
<br>
<img src="https://b.radikal.ru/b31/2005/bd/f6f11e081358.png" alt="image"><br>
<br>
<img src="https://a.radikal.ru/a25/2005/bb/fc5bc583eabe.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Downloaded data, prepared our Jupyter notebooks and ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Second step</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How do we download this data now? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, we import the necessary libraries:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pandas will allow us to download .csv files for further processing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Numpy is needed to present our data table as a matrix with numbers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Move on. </font><font style="vertical-align: inherit;">Take the train.csv file and upload it to us:</font></font><br>
<br>
<pre><code class="python hljs">dataset = pd.read_csv(<span class="hljs-string">'train.csv'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will refer to our sample train.csv data through the dataset variable. </font><font style="vertical-align: inherit;">Let's take a look at what is located there:</font></font><br>
<br>
<pre><code class="python hljs">dataset.head()
</code></pre><br>
<img src="https://d.radikal.ru/d36/2005/9a/547a7024db31.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The head () function allows us to view the first few lines of the data frame. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Survived columns are just our results, which are known in this data frame. On the issue of the problem, we need to predict the Survived column for test.csv data. This data stores information about other passengers of the Titanic, for whom we, the decision makers, are not aware of the outcomes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we will divide our table into dependent and independent data. Everything is simple here. Dependent data is that </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data that is independent of</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> what is in the outcomes. Independent data is data that influences the outcome. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we have such a data set: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“Vova taught computer science - no. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vova received on computer science 2. "</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assessment in computer science depends on the answer to the question: did Vova teach computer science? Is it clear? Moving on, we are closer to the goal! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The traditional variable for independent data is X. For dependent, y. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We do the following:</font></font><br>
<br>
<pre><code class="python hljs">X = dataset.iloc[ : , <span class="hljs-number">2</span> : ]<font></font>
y = dataset.iloc[ : , <span class="hljs-number">1</span> : <span class="hljs-number">2</span> ]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What it is? </font><font style="vertical-align: inherit;">With the iloc [:, 2:] function, we tell the python: I want to see in the variable X the data starting from the second column (inclusively and provided that the count starts from zero). </font><font style="vertical-align: inherit;">In the second row we say that we want to see in the data of the first column. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[a: b, c: d] is a construction of what we use in parentheses. </font><font style="vertical-align: inherit;">If you do not specify any variables, they will remain defaulted. </font><font style="vertical-align: inherit;">That is, we can specify [:,: d] and then we will get in the data frame all the columns, except those that go, starting from the number d and further. </font><font style="vertical-align: inherit;">Variables a and b define strings, but we all need them, so we leave this default. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's see what happened:</font></font><br>
<br>
<pre><code class="python hljs">X.head()</code></pre><br>
<img src="https://b.radikal.ru/b23/2005/cc/504c684c17a7.png" alt="image"><br>
<br>
<pre><code class="python hljs">y.head()</code></pre><br>
<img src="https://d.radikal.ru/d00/2005/9c/24dc68bac71e.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to simplify this small lesson, we will remove columns that require special “care”, or do not affect survival at all. </font><font style="vertical-align: inherit;">They contain data of type str.</font></font><br>
<br>
<pre><code class="python hljs">count = [<span class="hljs-string">'Name'</span>, <span class="hljs-string">'Ticket'</span>, <span class="hljs-string">'Cabin'</span>, <span class="hljs-string">'Embarked'</span>]<font></font>
X.drop(count, inplace=<span class="hljs-literal">True</span>, axis=<span class="hljs-number">1</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Super! </font><font style="vertical-align: inherit;">We go to the next step.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step three</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we need to encode our data so that the machine better understands how this data affects the result. </font><font style="vertical-align: inherit;">But we will not encode everything, but only the data of str type that we left. </font><font style="vertical-align: inherit;">Column "Sex". </font><font style="vertical-align: inherit;">How do we want to encode? </font><font style="vertical-align: inherit;">Imagine the data on the human gender by the vector: 10 - male, 01 - female. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To get started, we will translate our tables into the NumPy matrix:</font></font><br>
<br>
<pre><code class="python hljs">X = np.array(X)<font></font>
y = np.array(y)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now we look: </font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.compose <span class="hljs-keyword">import</span> ColumnTransformer
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> OneHotEncoder<font></font>
<font></font>
ct = ColumnTransformer(transformers=[(<span class="hljs-string">'encoder'</span>, OneHotEncoder(), [<span class="hljs-number">1</span>])],<font></font>
                       remainder=<span class="hljs-string">'passthrough'</span>)<font></font>
X = np.array(ct.fit_transform(X))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The sklearn library is such a cool library that allows us to do the full work in Data Science. It contains a large number of interesting machine learning models, and also allows us to do data preparation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OneHotEncoder will allow us to encode the gender of the person in that representation, as we described. 2 classes will be created: male, female. If the person is a man, then 1 will be written in the “male” column, and 0, respectively. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After OneHotEncoder (), it costs [1] - this means that we want to encode column number 1 (counting from scratch). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Super. We move even further!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a rule, this happens that some data remains empty (that is, NaN - not a number). </font><font style="vertical-align: inherit;">For example, there is information about a person: his name, gender. </font><font style="vertical-align: inherit;">But there is no data on his age. </font><font style="vertical-align: inherit;">In this case, we will use this method: we find the arithmetic mean of all the columns and, if some data is missing in the column, then fill the void with the arithmetic mean.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.impute <span class="hljs-keyword">import</span> SimpleImputer<font></font>
imputer = SimpleImputer(missing_values=np.nan, strategy=<span class="hljs-string">'mean'</span>)<font></font>
imputer.fit(X)<font></font>
X = imputer.transform(X)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's take into account that such situations happen when the data is very much scattered. </font><font style="vertical-align: inherit;">Some data is in the interval [0: 1], and some can go for hundreds and thousands. </font><font style="vertical-align: inherit;">To exclude such a spread and the computer was more accurate in the calculations, we will scale the data, scale it. </font><font style="vertical-align: inherit;">Let all numbers not exceed three. </font><font style="vertical-align: inherit;">To do this, use the function StandartScaler.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
sc = StandardScaler()<font></font>
X[:, <span class="hljs-number">2</span>:] = sc.fit_transform(X[:, <span class="hljs-number">2</span>:])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now our data looks like this: </font></font><br>
<br>
<img src="https://c.radikal.ru/c37/2005/52/6e921a4aa650.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Class. </font><font style="vertical-align: inherit;">We are already close to our goal!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fourth step</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Train our first model! </font><font style="vertical-align: inherit;">From the sklearn library we can find a huge amount of interesting things. </font><font style="vertical-align: inherit;">I applied the Gradient Boosting Classifier model to this task. </font><font style="vertical-align: inherit;">We use a classifier, since our task is a classification task. </font><font style="vertical-align: inherit;">It is necessary to attribute the forecast to 1 (survived) or 0 (did not survive).</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> GradientBoostingClassifier<font></font>
gbc = GradientBoostingClassifier(learning_rate=<span class="hljs-number">0.5</span>, max_depth=<span class="hljs-number">5</span>, n_estimators=<span class="hljs-number">150</span>)<font></font>
gbc.fit(X, y)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fit function tells python: Let the model look for dependencies between X and y. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Less than a second and the model is ready. </font></font><br>
<br>
<img src="https://b.radikal.ru/b13/2005/f2/87d5716c073b.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to apply it? </font><font style="vertical-align: inherit;">We will see now!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step Five </font><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we need to load the table with our test data, for which we need to make a forecast. </font><font style="vertical-align: inherit;">With this table, we will do all the same actions that we did for X.</font></font><br>
<br>
<pre><code class="python hljs">X_test = pd.read_csv(<span class="hljs-string">'test.csv'</span>, index_col=<span class="hljs-number">0</span>)<font></font>
<font></font>
count = [<span class="hljs-string">'Name'</span>, <span class="hljs-string">'Ticket'</span>, <span class="hljs-string">'Cabin'</span>, <span class="hljs-string">'Embarked'</span>]<font></font>
X_test.drop(count, inplace=<span class="hljs-literal">True</span>, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
X_test = np.array(X_test)<font></font>
<font></font>
<span class="hljs-keyword">from</span> sklearn.compose <span class="hljs-keyword">import</span> ColumnTransformer
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> OneHotEncoder<font></font>
ct = ColumnTransformer(transformers=[(<span class="hljs-string">'encoder'</span>, OneHotEncoder(), [<span class="hljs-number">1</span>])],<font></font>
                       remainder=<span class="hljs-string">'passthrough'</span>)<font></font>
X_test = np.array(ct.fit_transform(X_test))<font></font>
<font></font>
<span class="hljs-keyword">from</span> sklearn.impute <span class="hljs-keyword">import</span> SimpleImputer<font></font>
imputer = SimpleImputer(missing_values=np.nan, strategy=<span class="hljs-string">'mean'</span>)<font></font>
imputer.fit(X_test)<font></font>
X_test = imputer.transform(X_test)<font></font>
<font></font>
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
sc = StandardScaler()<font></font>
X_test[:, <span class="hljs-number">2</span>:] = sc.fit_transform(X_test[:, <span class="hljs-number">2</span>:])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will apply our model already!</font></font><br>
<br>
<pre><code class="python hljs">gbc_predict = gbc.predict(X_test)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All. </font><font style="vertical-align: inherit;">We made a forecast. </font><font style="vertical-align: inherit;">Now it needs to be recorded in csv and sent to the site.</font></font><br>
<br>
<pre><code class="python hljs">np.savetxt(<span class="hljs-string">'my_gbc_predict.csv'</span>, gbc_predict, delimiter=<span class="hljs-string">","</span>, header = <span class="hljs-string">'Survived'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Done. </font><font style="vertical-align: inherit;">Got a file containing predictions for each passenger. </font><font style="vertical-align: inherit;">It remains to upload these decisions to the site and get an estimate of the forecast. </font><font style="vertical-align: inherit;">Such a primitive solution gives not only 74% of the correct answers on the public, but also some impetus to Data Science. </font><font style="vertical-align: inherit;">The most curious can at any time write me in private messages and ask a question. </font><font style="vertical-align: inherit;">Thanks to all!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503938/index.html">Yandex gives out money for advertising. Or not?</a></li>
<li><a href="../en503940/index.html">Red Hat OpenShift Cloud-Based Messaging Using Quarkus and AMQ Online</a></li>
<li><a href="../en503942/index.html">Why should system administrators, developers, and testers learn DevOps practices?</a></li>
<li><a href="../en503950/index.html">Field Service Management: what is it and why do service companies need it?</a></li>
<li><a href="../en503952/index.html">Sweat, blood and slides: how a startup pitch works</a></li>
<li><a href="../en503956/index.html">Do Andrei Breslav torment Kotlin design mistakes that cannot be fixed // We are doomed # 6</a></li>
<li><a href="../en503958/index.html">Open API Game: Swagger Play</a></li>
<li><a href="../en503960/index.html">How Linux sort sorts strings</a></li>
<li><a href="../en503962/index.html">Autonomous Driving - hype in cars, but the need for data center network services</a></li>
<li><a href="../en503964/index.html">DataStore - CRUD (Create Read Update Delete)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>