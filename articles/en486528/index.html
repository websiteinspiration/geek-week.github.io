<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª üö¶ ü•ú This is the norm - 3: normal map types üôè „äôÔ∏è üìê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1: what are normal maps and how do they work 
 
 Part 2: how are normal maps baked
 
 Like many other things in our industry, normal maps have ev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>This is the norm - 3: normal map types</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486528/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1: what are normal maps and how do they work </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 2: how are normal maps baked</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Like many other things in our industry, normal maps have evolved over the years, and today there are several types that can look different. In the article I will list those that I remember, but maybe there are others. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map of the tangent space normals</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Tangent space normal map): the most common type today, normal maps; that is what we talked about in previous articles. It modifies the direction of the normals of the model based on the direction of the normals of its vertices (that is, we need to control the normals of the vertices of the lowpoly model).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/862/0ac/5aa/8620ac5aaca576891aaa13188c1d3a75.jpg" alt="image"></div><a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normal map of the tangent space Mikk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Mikk tangent space normal map). Not all 3D editors calculate the average of vertex normals the same. This leads to the fact that the appearance of normal maps is different in different engines, so we need to bake the normal map using the same method that the rendering program uses (this is called "use a synchronized workflow ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">synched workflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )")</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mikk proposed a way to calculate vertex normals, which was supposed to be universal so that all programs calculate them the same way. From the point of view of the workflow, this means that you can use the low poly model with all its averaged normals (with one smoothing group or with smoothing all the faces), bake the normal map in the tangent space of Mikk, and it will look exactly just like a high poly model, without the need to eliminate smoothing errors or separating hard edges in UV. In the future I will write a tutorial on how to do this. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remember that this is still a map of normals of the tangent space, but the normals of the model are calculated in a universal way and the models can be used in different programs.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/327/02a/ab5/32702aab582f315e26e2560cf332395b.gif" alt="image"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Two</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -channel tangent space normal map: it turns out that using the information stored in two of the three channels of the normal map, the computer can calculate the third, reducing the memory footprint at the cost of increasing the number of calculations. Since memory is usually in greater shortage, this optimization is often used and some engines execute it automatically (for example, Unreal Engine, when we set the ‚Äúnormal map‚Äù parameter to compress texture normal). Having freed one channel of the normal map, we can reduce the size of the texture or use this channel for metalness / roughness / opacity ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normally, the blue channel of the normal map is eliminated, so such textures look yellow. </font><font style="vertical-align: inherit;">Since this optimization is sometimes performed automatically by some engines, you can notice such textures in your project.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/805/7f6/673/8057f667375cac84c5838caf29d9d5ef.jpg" alt="image"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map of the world space normals</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (World space normal map): this card is normal, instead of modifying the direction of the vertex normals, completely ignores them and changes the way light reflection lowpoly-model in world space (world space) (when baked it considers that vertex normals parallel to the axes of the world). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can say that the normal map of tangent space tells the model "you must reflect the light to the right," and the normal map of world space - "you must reflect the light to the east."</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/722/f07/479/722f07479fc336a72c697cf215f590d6.jpg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such normal maps are more colorful and have more noticeable gradients; they were used because in this case you don‚Äôt need to think about the normals of the lowpoly vertices, but they have a drawback - you can‚Äôt move the model because it will look strange (we set the face so that it always reflects light to the east. If we rotate it, then the edge will continue to reflect light to the east.).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/272/1a0/72e/2721a072e67f8ebbebc213c77cba9000.jpg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today, normals of world space are rarely used in games, but they can still be used to create beautiful textures, for example, the blue channel shows how the model should reflect the light falling on top of the model, so you can use it to add color lighting to the texture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is also worth remembering that the world coordinates in different applications are implemented differently: in Unreal, 3D Studio Max, Blender, the Z axis is directed upward, and in Maya, Modo and Cinema4D, the Y axis is directed. This means that when transferring world normals between applications spaces may deteriorate. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object Space Normal Map</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Object space normal map): This is an improved version of the previous type of map, and it is very similar to it. The idea is that when you move a model in the world, its normal map of world space should be reoriented relative to the object. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This can be described as "this face should reflect light to the right of the model." If you rotate the model in the world, then the normal map should change in accordance with these changes. However, this does not work with deformable meshes, because in such maps only the movement of the object is taken into account. It is for this reason that the normal maps of tangent space are most common today. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inclined Normal Maps</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Bent normal maps): in essence, they combine AO ‚Äã‚Äãinformation and normal maps, tilting the directions of the normals so that the light tends to reflect to those parts of the model that the light hits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such cards are used to enhance Ambient Oclussion and to avoid an effect called ‚Äúlight leaking,‚Äù in which a model can reflect light in parts that it cannot reach. Personally, I have never used them, but I would have explored their capabilities if I had encountered a noticeable "light leak." More information can be found </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16-bit normal maps</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(16 bit normal maps): sometimes when there is a very smooth gradient on the normal map, we can notice the appearance of stripes. These stripes are due to lack of colors to represent a smooth gradient, usually caused by texture compression. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in the case of a large and smooth surface, such problems can arise even with an uncompressed texture. In this situation, you can use 16-bit normal maps, usually in .tga file format, which have more colors and are larger than regular 8-bit normal maps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can learn more about 16-bit normal maps at the tutorial god himself - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Earthquake</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0aa/3dc/a55/0aa3dca55bf9928f7366d2313f63f36b.jpg" alt="image"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/540/d26/3d6/540d263d61737ce8b11fd5ae6cd32a6d.jpg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should also be noted that other techniques exist to reduce the consequences of this problem, for example, completely eliminating normal maps (only geometry is used to represent this smooth surface), transforming lowpoly so that it looks more like highpoly so that gradients are less noticeable, or the use of dithering. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So which type should we use? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 90% of cases, the best solution is the normal maps of the tangent space Mikk. Unlike options using normal maps of the space of the world or an object, the model will be able to deform, and the direction of the normals will remain correct.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You should bake the normal map in the same tangent space as in the rendering program. </font><font style="vertical-align: inherit;">The most common tangent space is Mikk, so use it whenever possible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If pixelation appears on your normal map, consider using 16 normal maps or one of the solutions mentioned above. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, these are all types of normal maps that I could recall. </font><font style="vertical-align: inherit;">If you know of any other types, then let me know about them and I will add them to this tutorial! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for reading, I hope the article was useful to you. </font><font style="vertical-align: inherit;">Thanks to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for comments and help.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/en486528/">https://habr.com/ru/post/en486528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486510/index.html">Displaying Exception Information Before Emergency Exit</a></li>
<li><a href="../en486512/index.html">Briefly on how to teach Brother MFPs to scan in Windows Server</a></li>
<li><a href="../en486514/index.html">Weekend Reading: 10 materials about replicas of sound cards, open sound libraries and audio software</a></li>
<li><a href="../en486516/index.html">Scientists have found T cells that open up the promise of universal anti-cancer immune therapy</a></li>
<li><a href="../en486518/index.html">Like 20 years ago</a></li>
<li><a href="../en486530/index.html">Mainstream. Honorary Workers. Biographical novel</a></li>
<li><a href="../en486532/index.html">Data backup using a bunch of FreeFileSync and 7-zip</a></li>
<li><a href="../en486538/index.html">How I uploaded soft skills online and what it gave me</a></li>
<li><a href="../en486540/index.html">HighLoad ++, Mikhail Makurov, Maxim Chernetsov (Intersvyaz): Zabbix, 100kNVPS on one server</a></li>
<li><a href="../en486542/index.html">Parse the sound of a dial-up modem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>