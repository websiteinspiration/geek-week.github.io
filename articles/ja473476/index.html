<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏻 🦃 ☃️ PVS-Studioを使用したOpenCVでのOpenCvSharpラッパーの確認 🤾 👨🏾‍🎤 🍗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="OpenCVは、多くのC ++開発者によく知られているオープンソースのコンピュータービジョンアルゴリズム、画像処理、汎用数値アルゴリズムのライブラリーです。C ++に加えて、OpenCVはPython、Java、Ruby、Matlab、Lua、およびその他の言語用にも開発されています。これらの言語に...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PVS-Studioを使用したOpenCVでのOpenCvSharpラッパーの確認</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/473476/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/mr/0s/oi/mr0soiovipbs1ma0roktme3nj1i.png" alt="図2"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCVは、多くのC ++開発者によく知られているオープンソースのコンピュータービジョンアルゴリズム、画像処理、汎用数値アルゴリズムのライブラリーです。</font><font style="vertical-align: inherit;">C ++に加えて、OpenCVはPython、Java、Ruby、Matlab、Lua、およびその他の言語用にも開発されています。</font><font style="vertical-align: inherit;">これらの言語には私の主な言語C＃がないため、C＃のOpenCvSharpラッパーライブラリに注意を払い、このプロジェクトを確認することにしました。</font><font style="vertical-align: inherit;">これから来たものは、この記事で見つけることができます。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前、PVS-Studioに参加する前は、展示会でロボット工学に従事していました。</font><font style="vertical-align: inherit;">私のタスクには、最も基本的な修正（大規模な故障が発生した場合は、ロボットが別の人に渡された）と、さまざまなソフトウェアとユーティリティの開発が含まれていました。</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/s9/sk/p-/s9skp-nztgw-u2nt8j0dfuvae3m.png" alt="写真1"></div> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">疲れて、最近新しい街に到着しました、私は新たに開梱されたKIKIロボットと一緒に。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
開発と言えば。かなり面白かった。チームの誰かがアイデアを思いつくたびに、展覧会のゲストを驚かせるものは何でもありましたが、私たちはこの問題を一般的な議論のために持ち出し、アイデアが良いものである場合は、それを実行に移しました。かつて、人間の顔に歓迎の言葉で応える生き物を作るというアイデアが浮かびました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターネットで自分のニーズに合ったライブラリを検索した後、コンピュータビジョンアルゴリズムのライブラリであるOpenCV Webサイトを見つけました。</font><font style="vertical-align: inherit;">私はすぐにがっかりしました-OpenCVはC ++で実装されました。</font><font style="vertical-align: inherit;">私が大学から得た利点についての私の知識は明らかに十分ではありませんでした。</font><font style="vertical-align: inherit;">したがって、短時間グーグルすることで、OpenCvSharpに出会いました。これは、私のライブラリであるC＃の下にあるこのライブラリのラッパーです。</font><font style="vertical-align: inherit;">それから6か月が経過しましたが、このプログラムは長い間記述および使用されてきたため、OpenCvSharpの内部に足を踏み入れ、PVS-Studio静的アナライザーを使用してソースコードを確認することにしました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">監査済みプロジェクト</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCvSharp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、C＃プロジェクトでライブラリを使用するためのOpenCVのラッパーです。</font><font style="vertical-align: inherit;">ちなみにOpenCVライブラリ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もチェックしました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">OpenCvSharpの利点には、コードサンプルの大規模なコレクション、クロスプラットフォーム（Monoがサポートする任意のプラットフォームで動作可能）、およびインストールの容易さが含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラッパーは小さなプロジェクトで、C＃で約112,200行のコードが含まれています。</font><font style="vertical-align: inherit;">これらのうち、1.2％はコメントですが、偶然にも疑わしいほど小さなものです。</font><font style="vertical-align: inherit;">しかし、そのような小さなプロジェクトには多くの間違いがあります。</font><font style="vertical-align: inherit;">この記事では20を超えるエラーを書きましたが、それほど興味深いものや明らかではないものもありました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioコードアナライザー</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、C、C ++、C＃、およびJavaで記述されたプログラムのソースコードのエラーおよび潜在的な脆弱性を検出するためのツールです。</font><font style="vertical-align: inherit;">Windows、Linux、およびmacOSで動作します。</font><font style="vertical-align: inherit;">達成不可能なコード、エラー、タイプミスに加えて、PVS-Studioは上記のように潜在的な脆弱性を検出できます。</font><font style="vertical-align: inherit;">したがって、静的アプリケーションセキュリティテスト（静的アプリケーションセキュリティテスト、SAST）のツールと見なすことができます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アナライザーレポートを調べるときに注意を引いたコード</font></font></h2><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WriteableBitmapConverter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font><font style="vertical-align: inherit;">は、PVS-Studioからの同じタイプの4つの警告ですぐに注目を集めます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3005 'optimumChannels [PixelFormats.Indexed1]'変数はそれ自体に割り当てられています。</font><font style="vertical-align: inherit;">WriteableBitmapConverter.cs 22</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3005 'optimumChannels [PixelFormats.Indexed8]'変数はそれ自体に割り当てられています。</font><font style="vertical-align: inherit;">WriteableBitmapConverter.cs 23</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3005 'optimumTypes [PixelFormats.Indexed1]'変数がそれ自体に割り当てられています。</font><font style="vertical-align: inherit;">WriteableBitmapConverter.cs 50</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3005 'optimumTypes [PixelFormats.Indexed8]'変数がそれ自体に割り当てられています。</font><font style="vertical-align: inherit;">WriteableBitmapConverter.cs 51</font></font></li>
</ul><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">WriteableBitmapConverter</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  optimumChannels = <span class="hljs-keyword">new</span> Dictionary<font></font>
                        &lt;PixelFormat, <span class="hljs-keyword">int</span>&gt;();<font></font>
  optimumChannels[PixelFormats.Indexed1] =         <span class="hljs-comment">// &lt;=</span>
  optimumChannels[PixelFormats.Indexed8] =         <span class="hljs-comment">// &lt;=</span><font></font>
  optimumChannels[PixelFormats.Gray2] =<font></font>
  optimumChannels[PixelFormats.Gray4] =<font></font>
  optimumChannels[PixelFormats.Gray8] =<font></font>
  optimumChannels[PixelFormats.Gray16] =<font></font>
  optimumChannels[PixelFormats.Gray32Float] =<font></font>
  optimumChannels[PixelFormats.Indexed1] =         <span class="hljs-comment">// &lt;=</span><font></font>
  optimumChannels[PixelFormats.Indexed2] =<font></font>
  optimumChannels[PixelFormats.Indexed4] =<font></font>
  optimumChannels[PixelFormats.Indexed8] =         <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
<font></font>
  optimumTypes = <span class="hljs-keyword">new</span> Dictionary<font></font>
                 &lt;PixelFormat, MatType&gt;();<font></font>
  optimumTypes[PixelFormats.Indexed1] =            <span class="hljs-comment">// &lt;=</span>
  optimumTypes[PixelFormats.Indexed8] =            <span class="hljs-comment">// &lt;=</span><font></font>
  optimumTypes[PixelFormats.Gray2] =<font></font>
  optimumTypes[PixelFormats.Gray4] =<font></font>
  optimumTypes[PixelFormats.Gray8] =<font></font>
  optimumTypes[PixelFormats.Indexed1] =            <span class="hljs-comment">// &lt;=</span><font></font>
  optimumTypes[PixelFormats.Indexed2] =<font></font>
  optimumTypes[PixelFormats.Indexed4] =<font></font>
  optimumTypes[PixelFormats.Indexed8] =            <span class="hljs-comment">// &lt;=</span><font></font>
  optimumTypes[PixelFormats.BlackWhite] = <font></font>
  ....<font></font>
}<font></font>
....<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PixelFormats</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PixelFormat Indexed8 { <span class="hljs-keyword">get</span>; }<font></font>
  ....<font></font>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PixelFormat Indexed1 { <span class="hljs-keyword">get</span>; }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PixelFormats</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
クラス</font><i><font style="vertical-align: inherit;">は</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Windows.Media名前空間で</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定義され、</font><font style="vertical-align: inherit;">さまざまなピクセル形式のコレクションです。</font><font style="vertical-align: inherit;">アナライザがあるという事実に注意を引く</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WriteableBitmapConverterの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法は、</font><font style="vertical-align: inherit;">に値を再割り当て</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimumChannels [PixelFormats.Indexed1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimumChannels [PixelFormats.Indexed8]要素</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際には意味がありません。これが単純なタイプミスなのか、それ以外の意味なのかは不明です。ちなみに、このコードのセクションでは、静的アナライザーの利点を明確に示しています。目の前に同じタイプの行がたくさんあるのを見ると、目が「ぼやけ」始め、注意力が失われます。コードを確認した後でも、タイプミスがプログラムに忍び込んでも驚くことではありません。また、静的アナライザーは注意力に問題がなく、休息する必要がないため、そのようなエラーを見つけやすくなります。</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/1g/ok/vg/1gokvgep_oiqjqsqy9btoh3nncg.png" alt="図5"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静解析の力と力を感じてください。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ条件式を持つ2つの「if」ステートメントがあります。</font><font style="vertical-align: inherit;">最初の「if」ステートメントには、メソッドの戻り値が含まれています。</font><font style="vertical-align: inherit;">これは、2番目の「if」ステートメントが意味のないInputArray.cs 394であることを意味します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MatType <span class="hljs-title">EstimateType</span>(<span class="hljs-params">Type t</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec2b))
    <span class="hljs-keyword">return</span> MatType.CV_8UC2;
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec3b))
    <span class="hljs-keyword">return</span> MatType.CV_8UC3;
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec4b))
    <span class="hljs-keyword">return</span> MatType.CV_8UC4;
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec6b))
    <span class="hljs-keyword">return</span> MatType.CV_8UC(<span class="hljs-number">6</span>);
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec2s))         <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span> MatType.CV_16SC2;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (t == <span class="hljs-keyword">typeof</span>(Vec2s))         <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span> MatType.CV_32SC2;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このエラーは、前のエラーと少し似ています。</font><font style="vertical-align: inherit;">プログラマーが同じ条件を2回チェックする状況を作りました。</font><font style="vertical-align: inherit;">この場合、これは意味がありません。次の理由により、「複製された」</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ifステートメントの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分岐は</font><font style="vertical-align: inherit;">実行されません。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の条件式が真の場合、メソッドは終了します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストされる変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-t-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は条件式間で変化しないため</font><font style="vertical-align: inherit;">、最初の条件がfalseの場合、2番目の条件もfalseになります</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者はこのコードを再確認する必要があります。 2番目の変数の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりにVec2s</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を他の</font><font style="vertical-align: inherit;">変数に</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">必要がある</font><font style="vertical-align: inherit;">可能性が</font><font style="vertical-align: inherit;">あります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数 'ToString'の戻り値を利用する必要があります。 ImgProcTest.cs 80</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> RectanglesIntersectTypes
<span class="hljs-title">RotatedRectangleIntersection</span>(<span class="hljs-params">RotatedRect rect1, 
                             RotatedRect rect2, 
                             <span class="hljs-keyword">out</span> Point2f[] intersectingRegion</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> intersectingRegionVec = <span class="hljs-keyword">new</span> VectorOfPoint2f())<font></font>
  {<font></font>
    <span class="hljs-keyword">int</span> ret = NativeMethods<font></font>
                .imgproc_rotatedRectangleIntersection_vector(<font></font>
                         rect1, rect2, intersectingRegionVec.CvPtr);<font></font>
    intersectingRegion = intersectingRegionVec.ToArray();<font></font>
    <span class="hljs-keyword">return</span> (RectanglesIntersectTypes) ret;<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RotatedRectangleIntersectionVector</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> rr1 = <span class="hljs-keyword">new</span> RotatedRect(<span class="hljs-keyword">new</span> Point2f(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>),
                            <span class="hljs-keyword">new</span> Size2f(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>), 
                            <span class="hljs-number">45</span>);
  <span class="hljs-keyword">var</span> rr2 = <span class="hljs-keyword">new</span> RotatedRect(<span class="hljs-keyword">new</span> Point2f(<span class="hljs-number">130</span>, <span class="hljs-number">100</span>), 
                            <span class="hljs-keyword">new</span> Size2f(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>), 
                            <span class="hljs-number">0</span>);<font></font>
<font></font>
  Cv2.RotatedRectangleIntersection(rr1, rr2,<font></font>
                <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> intersectingRegion);<font></font>
<font></font>
  ....<font></font>
<font></font>
  intersectingRegion.ToString();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RotatedRectangleIntersection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">intersectingRegion</font></i><font style="vertical-align: inherit;">パラメータを介して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Point2f</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素の配列を返し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">プログラムが</font><i><font style="vertical-align: inherit;">intersectingRegionに</font></i><font style="vertical-align: inherit;">値を入力すると、この配列で</font><i><font style="vertical-align: inherit;">ToString（）</font></i><font style="vertical-align: inherit;">メソッドが呼び出され</font><i><font style="vertical-align: inherit;">ます。</font></i><font style="vertical-align: inherit;">配列の要素を使用すると、これによる変更は発生せず、最後の行で有用な作業は行われません。したがって、開発者が単にそれを削除するのを忘れたことを疑うのには理由があります。</font><b><font style="vertical-align: inherit;">PVS-Studioの警告</font></b><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021同じ条件式を持つ2つの「if」ステートメントがあります。</font><font style="vertical-align: inherit;">最初の「if」ステートメントには、メソッドの戻り値が含まれています。</font><font style="vertical-align: inherit;">これは、2番目の「if」ステートメントが無意味であることを意味しますCv2_calib3d.cs 1370</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022式 'objectPoints == null'は常にfalseです。</font><font style="vertical-align: inherit;">Cv2_calib3d.cs 1372</font></font></li>
</ul><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span> <span class="hljs-title">CalibrateCamera</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (objectPoints == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(objectPoints));
  <span class="hljs-keyword">if</span> (objectPoints == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(objectPoints));<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、コードフラグメントが重複していたため、2つの警告が表示されました。</font><font style="vertical-align: inherit;">最初の警告は、両方の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ifステートメントの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件式が同じである</font><font style="vertical-align: inherit;">ことを示してい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この式が真の場合、メソッドは</font><font style="vertical-align: inherit;">最初の</font><i><font style="vertical-align: inherit;">ifステートメントの</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチを</font><font style="vertical-align: inherit;">終了し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">このため、次の警告が示すように、2番目の条件は常にfalseになります。</font><font style="vertical-align: inherit;">どうやら、テキストはコピーされましたが、修正するのを忘れていました。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/cy/db/s1/cydbs1dussvael3m4ihcmwdfw4y.png" alt="図6"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">かわいいコピー＆ペースト。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の同様のアナライザー警告：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021同じ条件式を持つ2つの「if」ステートメントがあります。</font><font style="vertical-align: inherit;">最初の「if」ステートメントには、メソッドの戻り値が含まれています。</font><font style="vertical-align: inherit;">これは、2番目の「if」ステートメントが無意味であることを意味しますCv2_calib3d.cs 1444</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022式 'objectPoints == null'は常にfalseです。</font><font style="vertical-align: inherit;">Cv2_calib3d.cs 1446</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;">式 'label == MarkerValue'は常にfalseです。</font><font style="vertical-align: inherit;">Labeller.cs 135</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Labeller</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MarkerValue = <span class="hljs-number">-1</span>;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Perform</span>(<span class="hljs-params">Mat img, CvBlobs blobs</span>)</span><font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">int</span> label = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">int</span> lastLabel = <span class="hljs-number">0</span>;<font></font>
    CvBlob lastBlob = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">0</span>; y &lt; h; y++)<font></font>
    {<font></font>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt; w; x++)<font></font>
      {<font></font>
        <span class="hljs-keyword">if</span> (imgIn[x + y * step] == <span class="hljs-number">0</span>)
          <span class="hljs-keyword">continue</span>;<font></font>
<font></font>
        <span class="hljs-keyword">bool</span> labeled = labels[y, x] != <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (....)<font></font>
        {<font></font>
          labeled = <span class="hljs-literal">true</span>;<font></font>
<font></font>
          <span class="hljs-comment">// Label contour.</span><font></font>
          label++;<font></font>
          <span class="hljs-keyword">if</span> (label == MarkerValue)    <span class="hljs-comment">// &lt;=</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception();<font></font>
          ....<font></font>
        }<font></font>
        ....<font></font>
      }<font></font>
      ....<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードのセクションで</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">ゼロの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">が作成されます。</font><font style="vertical-align: inherit;">特定の条件が満たされると、この変数に1つ追加できます。</font><font style="vertical-align: inherit;">さらに、コードでは、変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベルの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値は</font><font style="vertical-align: inherit;">下向きに変化しません。</font><font style="vertical-align: inherit;">矢印でマークされた行では、この変数は-1に等しい定数と比較され、実際には意味がありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数がメソッドに数回渡されました。</font><font style="vertical-align: inherit;">代わりに他の引数を渡す必要がある可能性があります。</font><font style="vertical-align: inherit;">Cv2_photo.cs 124</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FastNlMeansDenoisingMulti</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  NativeMethods.photo_fastNlMeansDenoisingMulti(<font></font>
    srcImgPtrs, <font></font>
    srcImgPtrs.Length, <font></font>
    dst.CvPtr, <font></font>
    imgToDenoiseIndex, <font></font>
    templateWindowSize,<font></font>
    h, <font></font>
    templateWindowSize,<font></font>
    searchWindowSize);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーの意味を理解するために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photo_fastNlMeansDenoisingMulti</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドのパラメーターを見てみましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">void</span> <span class="hljs-title">photo_fastNlMeansDenoisingMulti</span>(<span class="hljs-params">
  IntPtr[] srcImgs, 
  <span class="hljs-keyword">int</span> srcImgsLength,
  IntPtr dst, 
  <span class="hljs-keyword">int</span> imgToDenoiseIndex, 
  <span class="hljs-keyword">int</span> temporalWindowSize, 
  <span class="hljs-keyword">float</span> h, 
  <span class="hljs-keyword">int</span> templateWindowSize,
  <span class="hljs-keyword">int</span> searchWindowSize</span>)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに単純化して、それを非常に明確にします。</font><font style="vertical-align: inherit;">これらの行を比較してください：</font></font><br>
<br>
<pre><code class="cs hljs">NativeMethods.photo_fastNlMeansDenoisingMulti(<font></font>
  ....<font></font>
  templateWindowSize, ....<font></font>
  templateWindowSize, ....);<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">void</span> <span class="hljs-title">photo_fastNlMeansDenoisingMulti</span>(<span class="hljs-params">
  ....
  <span class="hljs-keyword">int</span> temporalWindowSize, ....
  <span class="hljs-keyword">int</span> templateWindowSize, ....</span>)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、開発者が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">templateWindowSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数を2回使用したという事実に注意を向けます</font><font style="vertical-align: inherit;">が、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temporalWindowSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がこの変数の最初の言及の場所にあるはずです</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">の値ということも疑わしいです</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temporalWindowSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photo_fastNlMeansDenoisingMultiの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法が</font><i><font style="vertical-align: inherit;">されて</font></i><font style="vertical-align: inherit;">一切使用していません。</font><font style="vertical-align: inherit;">おそらくこれは意図的に行われたものですが、開発者の代わりにこのコードを詳しく見る価値はありますが、そこに間違いが潜んでいますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様のアナライザー警告：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038引数がメソッドに数回渡されました。</font><font style="vertical-align: inherit;">代わりに他の引数を渡す必要がある可能性があります。</font><font style="vertical-align: inherit;">Cv2_photo.cs 149</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038引数がメソッドに数回渡されました。</font><font style="vertical-align: inherit;">代わりに他の引数を渡す必要がある可能性があります。</font><font style="vertical-align: inherit;">Cv2_photo.cs 180</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038引数がメソッドに数回渡されました。</font><font style="vertical-align: inherit;">代わりに他の引数を渡す必要がある可能性があります。</font><font style="vertical-align: inherit;">Cv2_photo.cs 205</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のエラーは、前のエラーと少し似ています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'calib3d_Rodrigues_MatToVec'メソッドに渡される引数の順序が間違っている可能性があります： 'matrixM.CvPtr'および 'vectorM.CvPtr'。</font><font style="vertical-align: inherit;">Cv2_calib3d.cs 86</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Rodrigues</span>(<span class="hljs-params"><span class="hljs-keyword">double</span>[,] matrix, <span class="hljs-keyword">out</span> <span class="hljs-keyword">double</span>[] vector,
  <span class="hljs-keyword">out</span> <span class="hljs-keyword">double</span>[,] jacobian</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> jacobianM = <span class="hljs-keyword">new</span> Mat&lt;<span class="hljs-keyword">double</span>&gt;())<font></font>
  {<font></font>
    NativeMethods.calib3d_Rodrigues_MatToVec<font></font>
    (matrixM.CvPtr, vectorM.CvPtr, <font></font>
     jacobianM.CvPtr);<font></font>
    ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パラメータ</font><i><font style="vertical-align: inherit;">calib3d_Rodrigues_MatToVecを</font></i><font style="vertical-align: inherit;">見てみましょう</font></font><i><font style="vertical-align: inherit;"></font></i><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">void</span> <span class="hljs-title">calib3d_Rodrigues_MatToVec</span>(<span class="hljs-params">
  IntPtr vector, IntPtr matrix, IntPtr jacobian</span>)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calib3d_Rodrigues_MatToVec</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを呼び出すとき</font><font style="vertical-align: inherit;">に、引数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matrixM.CvPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vectorM.CvPtr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が混同されていました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">開発者は、このコードをよく見る必要があります。</font><font style="vertical-align: inherit;">エラーが入り込み、正しい計算を妨害する可能性があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3063</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">評価される場合、条件式の一部は常にfalseです：data == null。</font><font style="vertical-align: inherit;">Mat.cs 3539</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckArgumentsForConvert</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(data));<font></font>
<font></font>
  MatType t = Type();<font></font>
  <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span> || (data.Length * dataDimension)      <span class="hljs-comment">// &lt;=</span>
    (data.Length * dataDimension) % t.Channels != <span class="hljs-number">0</span>) <font></font>
   ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、2番目のチェック</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ== null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">なることは決してないことを示してい</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最初の条件で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、例外がスローされ、プログラムの実行は2番目のチェックに到達しません。</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/c1/b1/xf/c1b1xfih5imz4n4cifsucaqzrrw.png" alt="図7"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう疲れているとのことですが、あと少しです。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3127</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つの類似したコードフラグメントが見つかりました。おそらく、これはタイプミスであり、「src2」の代わりに「window」変数を使用する必要があります。Cv2_imgproc.cs 1547</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Point2d <span class="hljs-title">PhaseCorrelateRes</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (src1 == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(src1));
  <span class="hljs-keyword">if</span> (src2 == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(src2));
  <span class="hljs-keyword">if</span> (window == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(src2));   <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、アナライザーはタイプミスを見つけました。コードのこのセクションでは、変数の値が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">かどうか</font><font style="vertical-align: inherit;">がチェックされ</font><font style="vertical-align: inherit;">、この条件が満たされている場合、変数ごとに例外がスローされます。ただし、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数は</font><font style="vertical-align: inherit;">それほど単純で</font><font style="vertical-align: inherit;">はあり</font><font style="vertical-align: inherit;">ません。この変数が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、例外も生成されますが、この例外のテキストのスペルが間違っています。変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自体はこの例外のテキストには表示されず</font><font style="vertical-align: inherit;">、代わりに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">src2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が示され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。どうやら、最後の条件は次のようになります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (window == <span class="hljs-literal">null</span>)
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(window));</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3142</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到達不能コードが検出されました。</font><font style="vertical-align: inherit;">エラーが発生している可能性があります。</font><font style="vertical-align: inherit;">MatOfT.cs 873 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、変更のために、到達不能コードを報告するときにアナライザーが実際には完全に正しいが、エラーはない場合を見てみましょう。</font><font style="vertical-align: inherit;">これは、アナライザーが正しいと同時に誤った警告を同時に生成していると言える場合です。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> new Mat&lt;TElem&gt; <span class="hljs-title">SubMat</span>(<span class="hljs-params"><span class="hljs-keyword">params</span> Range[] ranges</span>)</span><font></font>
{<font></font>
  Mat result = <span class="hljs-keyword">base</span>.SubMat(ranges);
  <span class="hljs-keyword">return</span> Wrap(result);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、ここでは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returnステートメントに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到達できないと主張しています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これを確認するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SubMat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの本体を見てください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Mat <span class="hljs-title">SubMat</span>(<span class="hljs-params"><span class="hljs-keyword">params</span> Range[] ranges</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException();
  <span class="hljs-comment">/*
  if (ranges == null)
   throw new ArgumentNullException();

  ThrowIfDisposed();
  CvSlice[] slices = new CvSlice[ranges.Length];
  for (int i = 0; i &lt; ranges.Length; i++)
  {
    slices[i] = ranges[i];
  }

  IntPtr retPtr = NativeMethods.core_Mat_subMat1(ptr, ranges.Length,
  ranges);
  Mat retVal = new Mat(retPtr);
  return retVal;*/</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、関数はまだ追加されておらず、常に例外がスローされます。</font><font style="vertical-align: inherit;">そして、アナライザーは到達不能コードを報告するときに適切です。</font><font style="vertical-align: inherit;">しかし、これは本当の間違いとは言えません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーによって検出された次の3つのエラーは同じタイプですが、それらは非常にクールなので、すべて書き出さざるを得ませんでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;">式 'String.IsNullOrEmpty（ "winName"）'は常にfalseです。</font><font style="vertical-align: inherit;">Cv2_highgui.cs 46</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> 
<span class="hljs-title">DestroyWindow</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> winName</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (String.IsNullOrEmpty(<span class="hljs-string">"winName"</span>))<font></font>
    ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;">式 'string.IsNullOrEmpty（ "fileName"）'は常にfalseです。</font><font style="vertical-align: inherit;">FrameSource.cs 37</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> FrameSource 
<span class="hljs-title">CreateFrameSource_Video</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> fileName</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">string</span>.IsNullOrEmpty(<span class="hljs-string">"fileName"</span>))<font></font>
    ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;">式 'string.IsNullOrEmpty（ "fileName"）'は常にfalseです。</font><font style="vertical-align: inherit;">FrameSource.cs 53</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> FrameSource 
<span class="hljs-title">CreateFrameSource_Video_CUDA</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> fileName</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">string</span>.IsNullOrEmpty(<span class="hljs-string">"fileName"</span>))<font></font>
    ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アナライザーの警告の背後にある場合</font><font style="vertical-align: inherit;">（式は常にtrue / falseです）、非常に奇妙な、またはおかしいことがあります。</font><font style="vertical-align: inherit;">3つのケースすべてで、同じ状況が観察されます。</font><font style="vertical-align: inherit;">メソッドコードには</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型のパラメーターがあり</font><font style="vertical-align: inherit;">、その値を確認する必要があります。</font><font style="vertical-align: inherit;">ただし、チェックされるのは変数の値ではなく、名前付きの文字列リテラルです。</font><font style="vertical-align: inherit;">名前は無駄に引用されています。</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/mk/rr/fm/mkrrfmqeimdl5l_osrff2p-ime4.png" alt="図18"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どうやら、開発者は一度封印し、コピーと貼り付けを使用してこのエラーにコードを乗じました。 </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCvSharpの開発者は重要で素晴らしい仕事をしてきました。そして、私はこのライブラリのユーザーとして、彼らにとても感謝しています。感謝。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、PVS-Studioチームに所属してコードを調べていると、その品質の問題が十分に解決されていないことを認めざるを得ません。ほとんどの場合、静的コードアナライザーはこのプロジェクトでは定期的に使用されません。また、多くのエラーは、より高価な方法で修正されます（たとえば、ユーザーレビューによるテスト）。そして、一般的にコードに長期間存続するものもあり、それらを見つけるだけです。このアイデアは</font><font style="vertical-align: inherit;">、静的分析の方法論を使用する哲学についての</font><font style="vertical-align: inherit;">短い</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でより詳細に提示されています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトはオープンでGitHubにあるため、開発者は使用する機会があります</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">無料ライセンスオプション</font></a><font style="vertical-align: inherit;">で、定期的に分析の適用を開始します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご清聴ありがとうございました。</font><font style="vertical-align: inherit;">PVS-Studioの体験版を使用して、プロジェクトを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">してテストします。</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事を英語を話す視聴者と共有したい場合は、翻訳へのリンクを使用してください：Ekaterina Nikiforova。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-StudioでOpenCVのOpenCvSharpラッパーを確認し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja473456/index.html">防衛QAの最後のフロンティア：自動エラー検出</a></li>
<li><a href="../ja473460/index.html">К вопросу о математике</a></li>
<li><a href="../ja473462/index.html">Security Week 44：NordVPN、TorGuard、Half Hack</a></li>
<li><a href="../ja473468/index.html">ベイズの定理を理解する</a></li>
<li><a href="../ja473470/index.html">マージ要求と監査APIの依存関係が改善されたGitLab 12.4</a></li>
<li><a href="../ja473482/index.html">サウジアラビアのキャンペーンの成功、ハロウィーンPR、そして日本航空の広告キャンペーンについて</a></li>
<li><a href="../ja473484/index.html">CSセンターのC ++コース、後編</a></li>
<li><a href="../ja473488/index.html">クロスプラットフォームナビゲーション：NavControllerがIonic 4でAngular / Routerを破った理由</a></li>
<li><a href="../ja473490/index.html">トップ物理学者がストリング理論を愛する理由</a></li>
<li><a href="../ja473500/index.html">TSD上のアプリケーションと1Cとの通信：HTTPサービスによるエンタープライズ8.3。パート1（交換メソッドの選択。APIの説明）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>