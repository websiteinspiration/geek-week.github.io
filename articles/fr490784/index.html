<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💊 🤹🏿 👨🏿‍🏫 Je suis développeur Android et je n'aimais pas faire de travail manuel. 👴🏾 👨🏽‍🌾 👩‍👩‍👦‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quand je me suis installé à Skyeng, le soleil brillait un peu plus, l'herbe n'était pas plus verte (c'était le même début de printemps) et le chef d'é...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Je suis développeur Android et je n'aimais pas faire de travail manuel.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/490784/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quand je me suis installé à Skyeng, le soleil brillait un peu plus, l'herbe n'était pas plus verte (c'était le même début de printemps) et le chef d'équipe m'a demandé d'écrire à Jira combien de temps a été consacré au codage, et combien de discussions et de révisions. Au moins une fois toutes les deux semaines. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p0/gd/rw/p0gdrwyypbzz6wn81ybvknbmohq.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Sur la base de ces données, nous essayons de comprendre s'il est nécessaire d'ajuster les estimations et s'il y a des problèmes de communication dans l'équipe", ont-ils déclaré. Mais à qui une telle «babayka» n'a-t-elle jamais été révélée?</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque nous sommes tous des travailleurs à distance, l'idée semblait raisonnable. Et il est devenu intéressant pour moi où ces huit heures étaient passées: les voilà, mais pour quoi exactement? Cependant, l'exploitation forestière était inhabituelle. Et dans la paresse générale. J'ai alors décidé de chercher quelque chose qui continuerait à fonctionner pour moi. Et en cours de recherche, je me suis un peu emporté et j'ai écrit mon plugin pour IntelliJ IDEA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous trouverez ci-dessous</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examen subjectif des outils finis et de mon vélo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (avec source).</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'étudie les solutions que l'équipe utilise</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première chose que j'ai faite a été d'aller me renseigner auprès de mes collègues qui utilisent quoi. </font><font style="vertical-align: inherit;">Les options sont approximativement les suivantes:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clockify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un bouton pour tout </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">contrôler</font></a></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avez-vous besoin de temps pour coder ou écrire des quais? </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le plugin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ajoutera un bouton (un pacman gris assez discret) presque n'importe où.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/9-/ic/yy9-icorb-pi37wptn9yh7wxtxk.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il regarde donc dans Google Docs</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1k/tf/m0/1ktfm0ax7-xl9rmwtlq9jvwtgec.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et sur GitHub,</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
vous pouvez admirer Natrekannyi sur un tableau de bord, ou vous pouvez importer dans une table et le déposer dans Jira. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/js/bf/6h/jsbf6htyizodd76lwvq5hbzuqhy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'intégration dans Jira est fournie séparément, également par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extension de navigateur</font></font></a></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
, mais il est possible de télécharger un tableau avec les journaux de travail obtenus de Clockify dans votre calendrier de travail. </font><font style="vertical-align: inherit;">Et pour le suivi du temps hors ligne, il existe des applications de bureau pour Windows, Linux et Mac. </font><font style="vertical-align: inherit;">Des applications mobiles aussi. </font><font style="vertical-align: inherit;">La fonctionnalité principale est gratuite, mais il existe plusieurs plans tarifaires avec des goodies comme la confidentialité, des rappels et des modèles de projets.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toggl</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , juste Toggl</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est à peu près la même chose, mais un peu plus de goodies - par exemple, dans une application de bureau, vous pouvez vous définir des rappels sur la journalisation du temps, activer le mode pomodoro, il y a même la possibilité de lier une application spécifique à un projet spécifique et de configurer le suivi automatique.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hl/yp/sv/hlypsvcpl66hldse0c4ayfhkmzi.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais il y a une nuance: le premier jour d'utilisation j'ai été étonné par cette fenêtre et les notifications avec rappels. </font><font style="vertical-align: inherit;">Bien que la théorie semblait cool)</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Script Toggl + </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : quand un simple bouton ne suffit plus</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'invention de mon collègue. </font><font style="vertical-align: inherit;">D'une manière ou d'une autre, il a décidé de réduire les gestes pour exporter des tables vers Jira et a déplacé le déchargement de la taxation dans Toggl vers un script. </font><font style="vertical-align: inherit;">Vous pouvez mettre un cron et profiter de la vie.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wakatime</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - où nous allons, aucun bouton nécessaire</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enregistre tout lui-même. Par conséquent, la première chose à retenir lors de la connexion de son extension de navigateur est la liste noire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des extensions, il fournit plusieurs intégrations et un nombre décent de plugins pour les IDE et les éditeurs les plus courants. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xz/4u/uk/xz4uuk51xsdjdkemxh-ichx8ceg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les plugins pour l'IDE suivent le temps passé à la fois dans une branche git spécifique et dans un fichier spécifique. A l'écran, la liste des disponibles est très impressionnante. Serenyk - «dans les plans», pour leur mise en œuvre rapide, vous pouvez voter. Certains plugins dans un abonnement payant pour 9 $ par mois.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, sur le tableau de bord, vous pouvez voir combien de temps est consacré en pourcentage à l'écriture de code dans différentes langues: si vous vous souvenez qu'un projet Android régulier implique l'utilisation de Kotlin, Java, Groovy et xml - cela a du sens pour lui-même). </font><font style="vertical-align: inherit;">Et si vous travaillez avec le plugin installé pendant un certain temps, vous remarquerez qu'il est plutôt impitoyable: le tableau de bord obtient le temps de lire et d'écrire du code. </font><font style="vertical-align: inherit;">Et coller ne pénètre pas dans le moniteur avec un aspect de verre. </font><font style="vertical-align: inherit;">Inutile de dire, un amateur.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hmm, le code source de WakaTime est ouvert: vous pouvez essayer de comprendre comment cela fonctionne ...</font></font></b><div class="spoiler_text">  , ?           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   IDE  JetBrains</a>. <br>
<br>
 .     WakaTime.java.    ,         ,    Heartbeat (),   WakaTime CLI    .      , , ,       . <br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Écrire votre vélo par analogie</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un pistolet à pommes de terre serait peut-être plus utile, mais vous ne ferez rien à des fins de recherche. Après avoir médité sur les sources WakaTime, j'ai décidé de créer mon propre plug-in qui peut suivre l'activité dans l'IDE, enregistrer le temps d'écriture et l'envoyer à Jira. (dans notre flux, les branches sont nommées d'après les tâches dans Jira, donc cela semble assez réaliste). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et afin de ne pas remplir le serveur de requêtes pendant que vous travaillez sur le code, nous enverrons les journaux lorsque Android Studio sera fermé, et jusqu'à ce moment, stockez-le localement.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Quelles entités pouvons-nous trouver dans le code source du plugin (et les utiliser dans les nôtres)?</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous n'utilisons pas de composants (c'est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legacy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui étaient auparavant les principales unités structurelles du plugin. Peut être au niveau de l'application, au niveau du projet ou au niveau du module. Il existe un ApplicationComponent dans la source WakaTime, mais ils le peuvent, le code source a déjà cinq ans et il devrait conserver une compatibilité descendante. Les composants sont liés au cycle de vie du niveau auquel ils sont associés. Ainsi, par exemple, ApplicationComponent est chargé au démarrage de l'EDI. Lorsqu'ils sont utilisés, ils empêcheront le plugin de redémarrer sans redémarrer l'IDE et se comporteront généralement de manière désagréable. Par conséquent, il est préférable d'utiliser des services à la place. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous utilisons les services</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- principales unités structurelles actuelles. </font><font style="vertical-align: inherit;">Ils sont divisés en les mêmes niveaux de l'application, du projet et du module, ils nous aideront à encapsuler la logique aux niveaux appropriés et à stocker l'état du plugin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement aux composants, les services doivent être chargés seuls à l'aide de la méthode ServiceManager.getService (). </font><font style="vertical-align: inherit;">La plateforme garantit que chaque service est un singleton. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter des actions</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - elles peuvent être un raccourci, un élément de menu supplémentaire - en un mot, elles sont responsables de tout ce qui affecte en quelque sorte les actions des utilisateurs dans l'EDI. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous utilisons des extensions</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - toute extension de fonctionnalité qui sera plus compliquée que les actions: par exemple, connectez-vous au cycle de vie IDE et faites quelque chose tout en affichant un écran de démarrage ou avant de quitter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela doit être déclaré dans le fichier /META_INF/plugin.xml.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Plugin.xml et build.gradle</font></font></h4><br>
<img src="https://habrastorage.org/webt/ap/ia/vz/apiavzht769ipgzd8ltqaobce4o.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fenêtre de création de projet. </font><font style="vertical-align: inherit;">Nous allons écrire notre plugin dans Kotlin, et utiliser Gradle pour l'assemblage.C'est</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
la première chose que nous voyons après avoir créé le plugin vierge dans IDEA (Fichier -&gt; Nouveau -&gt; Projet ... -&gt; Gradle -&gt; IntelliJ Platform Plugin). </font><font style="vertical-align: inherit;">Il contient des informations sur les dépendances du plugin et sa brève description. </font><font style="vertical-align: inherit;">Il doit déclarer les composants du plug-in - les composants, services, actions et extensions mentionnés précédemment. </font><font style="vertical-align: inherit;">Il n'y aura pas de point d'entrée spécifique - il s'agira d'une action personnalisée ou d'un événement de cycle de vie IDE, selon nos besoins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous aurons besoin de ces dépendances - après tout, nous voulons écrire un plugin pour le studio et pour qu'il puisse fonctionner avec Git.</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">depends</span>&gt;</span>Git4Idea<span class="hljs-tag">&lt;/<span class="hljs-name">depends</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">depends</span>&gt;</span>com.intellij.modules.androidstudio<span class="hljs-tag">&lt;/<span class="hljs-name">depends</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Git4Idea est un plug-in pour le système de fichiers virtuel (VCS) et fournit des rubriques, grâce auxquelles nous pourrons plus tard écouter les événements git - comme les extractions, par exemple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque nous voulons également que le plugin puisse fonctionner avec Jira, nous allons connecter via le gradle une bibliothèque aimablement fournie avec un client de repos. </font><font style="vertical-align: inherit;">Pour ce faire, ajoutez-y le référentiel Atlassian maven:</font></font><br>
<br>
<pre><code class="kotlin hljs">repositories {<font></font>
   mavenCentral()<font></font>
   maven {<font></font>
       url <span class="hljs-string">"https://packages.atlassian.com/maven/repository/public"</span><font></font>
   }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et en fait les bibliothèques:</font></font><br>
<br>
<pre><code class="kotlin hljs">implementation <span class="hljs-string">"joda-time:joda-time:2.10.4"</span>
implementation(<span class="hljs-string">"com.atlassian.jira:jira-rest-java-client-core:4.0.0"</span>) {<font></font>
   exclude group: <span class="hljs-string">'org.slf4j'</span><font></font>
   dependencies {<font></font>
       implementation <span class="hljs-string">"com.atlassian.fugue:fugue:2.6.1"</span><font></font>
   }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous déterminons la version de l'IDE qui nous intéresse et le chemin vers celui-ci (oh, si le vrai Android Studio a démarré et travaillé aussi vite que sa version légère pour le débogage des plugins):</font></font><br>
<br>
<pre><code class="kotlin hljs">intellij {<font></font>
   version <span class="hljs-string">'2019.1'</span>
   plugins <span class="hljs-string">'git4idea'</span>
   alternativeIdePath <span class="hljs-string">'E:\\Android Studio'</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ici, peut-être, un jour, nous écrirons sur une nouvelle fonctionnalité améliorée. </font><font style="vertical-align: inherit;">Mais pas maintenant.</font></font><br>
<br>
<pre><code class="kotlin hljs">patchPluginXml {<font></font>
   changeNotes <span class="hljs-string">"""
     Add change notes here.&lt;br&gt;
     &lt;em&gt;most HTML tags may be used&lt;/em&gt;"""</span>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Création d'une interface utilisateur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour insérer quelque chose dans Jira, vous devez d'abord vous connecter. </font><font style="vertical-align: inherit;">Il est logique de le faire juste après l'ouverture du projet. </font><font style="vertical-align: inherit;">Il semble que nous ayons besoin d'une extension, et nous n'hésiterons pas à la déclarer dans plugin.xml:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">postStartupActivity</span> <span class="hljs-attr">implementation</span>=<span class="hljs-string">"Heartbeat"</span>/&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et montrer le dialogue en elle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les composants de l'interface utilisateur sont principalement des composants de Swing avec quelques extensions de la plate-forme sdk. </font><font style="vertical-align: inherit;">Tout cela a récemment été enveloppé dans du kotlin ui dsl. </font><font style="vertical-align: inherit;">Au moment de la rédaction, la documentation a noté que dsl peut changer beaucoup entre les versions principales, nous l'utilisons donc avec une légère crainte:</font></font><br>
<br>
<pre><code class="kotlin hljs">
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createCenterPanel</span><span class="hljs-params">()</span></span>: JComponent? {<font></font>
<font></font>
   title = <span class="hljs-string">"Jira credentials"</span>
   setOKButtonText(<span class="hljs-string">"Save"</span>)<font></font>
<font></font>
   <span class="hljs-keyword">return</span> panel {<font></font>
       row {<font></font>
           JLabel(<span class="hljs-string">"Jira hostname"</span>)()<font></font>
           hostname = JTextField(<span class="hljs-string">"https://"</span>)<font></font>
           hostname()<font></font>
       }<font></font>
       row {<font></font>
           JLabel(<span class="hljs-string">"Username:"</span>)()<font></font>
           username = JTextField()<font></font>
           username()<font></font>
       }<font></font>
       row {<font></font>
           JLabel(<span class="hljs-string">"Password:"</span>)()<font></font>
           password = JPasswordField()<font></font>
           password()<font></font>
       }<font></font>
   }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons créé un dialogue, l'avons montré, reçu des lettres de créance de Jira. </font><font style="vertical-align: inherit;">Maintenant, nous devons les sauvegarder, et de préférence en toute sécurité, autant que possible. </font><font style="vertical-align: inherit;">PersistingStateComponent viendra à la rescousse.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Dispositif PersistingStateComponent (pas très compliqué)</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PersistingStateComponent peut faire deux choses - saveState et loadState: sérialiser et enregistrer l'objet qui lui est transmis et le récupérer du stockage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Où exactement il doit enregistrer les données, il apprend de l'annotation State. </font><font style="vertical-align: inherit;">Deux options les plus simples sont mentionnées dans la documentation - spécifiez votre fichier ou stockez tout dans les paramètres de l'espace de travail:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-meta">@Storage(<span class="hljs-meta-string">"yourName.xml"</span>)</span>
<span class="hljs-meta">@Storage(StoragePathMacros.WORKSPACE_FILE)</span> 
<span class="hljs-meta">@State(
   name = <span class="hljs-meta-string">"JiraSettings"</span>,
   storages = [
       Storage(<span class="hljs-meta-string">"trackerSettings.xml"</span>)</span>
   ])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous avons un cas particulier, nous nous tournons vers la documentation pour le stockage des données sensibles.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getState</span><span class="hljs-params">()</span></span>: Credentials? {
   <span class="hljs-keyword">if</span> (credentials == <span class="hljs-literal">null</span>)  {
       <span class="hljs-keyword">val</span> credentialAttributes = createCredentialAttributes()<font></font>
       credentials = PasswordSafe.instance.<span class="hljs-keyword">get</span>(credentialAttributes)<font></font>
   }<font></font>
   <span class="hljs-keyword">return</span> credentials<font></font>
}<font></font>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadState</span><span class="hljs-params">(state: <span class="hljs-type">Credentials</span>)</span></span> {<font></font>
   credentials = state<font></font>
   <span class="hljs-keyword">val</span> credentialAttributes = createCredentialAttributes()<font></font>
   PasswordSafe.instance.<span class="hljs-keyword">set</span>(credentialAttributes, credentials)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre PersistingStateComponent traitera du stockage de l'heure enregistrée pour différentes branches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jira a trouvé la connexion. </font><font style="vertical-align: inherit;">Avec le stockage des données utilisateur également. </font><font style="vertical-align: inherit;">Vous devez maintenant suivre en quelque sorte l'événement de paiement sur la succursale pour démarrer le compte à rebours.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Abonnez-vous aux événements</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La plate-forme IntelliJ offre la possibilité de suspendre Observer sur des événements qui nous intéressent en souscrivant à leurs sujets dans le messageBus du niveau souhaité. </font><font style="vertical-align: inherit;">Voici le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est assez intéressant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un sujet est un certain point final, une représentation d'un événement. </font><font style="vertical-align: inherit;">Tout ce que vous avez à faire est de vous abonner et d'implémenter un écouteur qui devrait gérer ce qui se passe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, je dois écouter les extractions dans Git ...</font></font><br>
<br>
<pre><code class="kotlin hljs">subscribeToProjectTopic(project, GitRepository.GIT_REPO_CHANGE) {<font></font>
    GitRepositoryChangeListener {<font></font>
        currentBranch = it.currentBranch<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... fermeture de l'application (pour se mettre en gage joyeusement) ...</font></font><br>
<br>
<pre><code class="kotlin hljs">subscribeToAppTopic(AppLifecycleListener.TOPIC) {
    <span class="hljs-keyword">object</span>: AppLifecycleListener {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">appWillBeClosed</span><span class="hljs-params">(isRestart: <span class="hljs-type">Boolean</span>)</span></span> {
            <span class="hljs-keyword">if</span> (!isRestart) {<font></font>
                JiraClient.logTime(entry.key, DateTime.now(), entry.value)<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... et la sauvegarde des documents (juste pour que ce soit le cas).</font></font><br>
<br>
<pre><code class="kotlin hljs">subscribeToAppTopic(AppTopics.FILE_DOCUMENT_SYNC) {<font></font>
    CustomSaveListener()<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, cela suffit déjà (sinon, vous pouvez toujours écrire le vôtre). </font><font style="vertical-align: inherit;">Mais que se passe-t-il si nous voulons entendre le moindre mouvement de défilement et de souris?</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. EditorEventMulticaster</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il collecte tout ce qui se passe dans les fenêtres de l'éditeur ouvert - édition, modification de la zone visible, mouvements de la souris - et vous permet de vous y abonner en un seul endroit et immédiatement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous avons tout ce dont nous avons besoin. </font><font style="vertical-align: inherit;">Nous pouvons extraire le nom de la tâche dans Jira de la branche actuelle (si elle existe), calculer le temps passé à travailler dessus et quitter immédiatement le studio pour l'ajouter à la tâche.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Code et détails </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour fonctionner, vous avez besoin de la dernière version d'Android Studio (3.6.1). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour tester les performances - git et une branche avec un nom qui est au moins similaire à distance à la tâche dans Jira. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que le plug-in ne se contente pas de générer du temps sur la console, il le suive - décommentez la ligne correspondante dans Heartbeat.kt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Liens utiles</font></font></h4><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une série d'articles sur le développement de plugins</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre article intéressant sur le développement d'un plugin à partir d'un développeur Android</font></font></a></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS Et qu'avez-vous finalement choisi?</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Merde, c'est un peu trop mal. </font><font style="vertical-align: inherit;">Et si je n'écris pas de code? </font><font style="vertical-align: inherit;">Et si je prends mon nez et essaie de comprendre ce qui s'y passe? </font><font style="vertical-align: inherit;">Dans le code, au sens de. </font><font style="vertical-align: inherit;">Après tout, cela prend la plupart du temps. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Ensuite, faites-le au moins défiler. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Ce n'est donc pas loin de simuler une activité violente. </font><font style="vertical-align: inherit;">Et puis, je ne peux pas fermer le studio pendant des semaines et ne pas redémarrer. </font><font style="vertical-align: inherit;">Peut-être que nous n'avons pas besoin d'un tel bonheur? </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 "Certainement pas nécessaire." </font><font style="vertical-align: inherit;">Ensuite, une autre raison est nécessaire, sinon j'ai aimé écrire des plugins. </font><font style="vertical-align: inherit;">Et je ne comprenais toujours pas vraiment VCS. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"L'utilisez-vous vous-même?" </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Nan. </font><font style="vertical-align: inherit;">J'ai en quelque sorte appris à me connecter avec mes mains, imperceptiblement pour moi.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490772/index.html">Comment rédiger et publier un contrat intelligent dans le Telegram Open Network (TON)</a></li>
<li><a href="../fr490774/index.html">Sensible</a></li>
<li><a href="../fr490778/index.html">Les gens qui comprennent le travail d'un programmeur peuvent être trouvés n'importe où</a></li>
<li><a href="../fr490780/index.html">Intel Xeon Scalable Gen2: grande vente de cœurs</a></li>
<li><a href="../fr490782/index.html">Conférence AnalogBytes: Roskomnadzor, media, highload et all-all-all</a></li>
<li><a href="../fr490786/index.html">Analyse de fuite de second ordre: quand elle fuit de ceux qui volent des données d'une banque</a></li>
<li><a href="../fr490788/index.html">REPL inutile. Rapport Yandex</a></li>
<li><a href="../fr490790/index.html">Fichiers Zip: historique, explication et implémentation</a></li>
<li><a href="../fr490792/index.html">VXLAN dans NSX-V - Sous-couche en difficulté</a></li>
<li><a href="../fr490796/index.html">Comment automatiser la sécurité des conteneurs dans le style de la stratégie en tant que code à l'aide de CRD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>