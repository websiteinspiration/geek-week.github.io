<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåï üßôüèø üìº Konfigurieren der Verlustfunktion f√ºr ein neuronales Netzwerk basierend auf seismischen Daten üë®‚Äçüë®‚Äçüëß‚Äçüë¶ üë¶üèø üíÇüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In einem fr√ºheren Artikel haben wir ein Experiment beschrieben, um die Mindestanzahl manuell beschrifteter Abschnitte zum Trainieren eines neuronalen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Konfigurieren der Verlustfunktion f√ºr ein neuronales Netzwerk basierend auf seismischen Daten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/488852/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fr√ºheren Artikel haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir ein Experiment beschrieben, um die Mindestanzahl manuell beschrifteter Abschnitte zum Trainieren eines neuronalen Netzwerks unter Verwendung seismischer Daten zu bestimmen. </font><font style="vertical-align: inherit;">Heute setzen wir dieses Thema fort, indem wir die am besten geeignete Verlustfunktion ausw√§hlen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zwei grundlegende Funktionsklassen werden betrachtet - bin√§re Kreuzentropie und Schnittmenge √ºber Union - in 6 Varianten mit Auswahl von Parametern sowie Kombinationen von Funktionen verschiedener Klassen. </font><font style="vertical-align: inherit;">Zus√§tzlich wird die Regularisierung der Verlustfunktion ber√ºcksichtigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spoiler: Es ist gelungen, die Qualit√§t der Netzwerkprognose deutlich zu verbessern.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nq/rn/qt/nqrnqtl1xaabhj0vtklokcrbtpc.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unternehmensforschungsziele</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden die Beschreibung der Besonderheiten der seismischen Vermessung, der erhaltenen Daten und der Aufgaben ihrer Interpretation nicht wiederholen. All dies ist in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unserem vorherigen Artikel beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Idee dieser Studie wurde durch die Ergebnisse des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wettbewerbs f√ºr die Suche nach Salzablagerungen auf 2D-Scheiben angeregt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Laut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Teilnehmern des Wettbewerbs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um </font><font style="vertical-align: inherit;">dieses Problem zu l√∂sen, wurde ein ganzer Zoo von verschiedenen Verlustfunktionen verwendet dar√ºber hinaus mit unterschiedlichen Erfolgen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deshalb haben wir uns gefragt: Ist es wirklich m√∂glich, dass solche Probleme bei solchen Daten durch Auswahl der Verlustfunktion zu einem signifikanten Qualit√§tsgewinn f√ºhren? Oder ist dies nur f√ºr die Wettbewerbsbedingungen charakteristisch, wenn um die von den Organisatoren vordefinierte Metrik um die vierte oder f√ºnfte Dezimalstelle gek√§mpft wird?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Aufgaben, die mit Hilfe neuronaler Netze gel√∂st werden, basiert die Abstimmung des Lernprozesses in der Regel haupts√§chlich auf den Erfahrungen des Forschers und einigen Heuristiken. Beispielsweise werden f√ºr die Probleme der Bildsegmentierung am h√§ufigsten Verlustfunktionen verwendet, die auf der Beurteilung des Zusammentreffens der Formen erkannter Zonen basieren, der sogenannten Schnittmenge √ºber der Union. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intuitiv, basierend auf einem Verst√§ndnis des Verhaltens und der Forschungsergebnisse, liefern diese Arten von Funktionen bessere Ergebnisse als diejenigen, die f√ºr Bilder nicht gesch√§rft sind, wie z. B. Kreuzentropie. Dennoch werden Experimente auf der Suche nach der besten Option f√ºr diese Art von Aufgabe als Ganzes und jede Aufgabe einzeln fortgesetzt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die zur Interpretation vorbereiteten seismischen Daten weisen eine Reihe von Merkmalen auf, die einen erheblichen Einfluss auf das Verhalten der Verlustfunktion haben k√∂nnen. </font><font style="vertical-align: inherit;">Zum Beispiel sind die Horizonte, die die geologischen Schichten trennen, glatt und √§ndern sich nur an den Stellen der Verwerfungen st√§rker. </font><font style="vertical-align: inherit;">Zus√§tzlich haben die unterscheidbaren Zonen eine ausreichend gro√üe Fl√§che relativ zum Bild, d.h. </font><font style="vertical-align: inherit;">kleine Flecken auf Interpretationsergebnissen werden meist als Erkennungsfehler angesehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Rahmen dieses Experiments haben wir versucht, Antworten auf die folgenden lokalen Fragen zu finden:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist die Verlustfunktion der Klasse "Schnittmenge √ºber Union" wirklich das beste Ergebnis f√ºr das unten betrachtete Problem? </font><font style="vertical-align: inherit;">Es scheint, dass die Antwort offensichtlich ist, aber welche? </font><font style="vertical-align: inherit;">Und wie viel ist aus gesch√§ftlicher Sicht das Beste?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist es m√∂glich, die Ergebnisse durch die Kombination von Funktionen verschiedener Klassen zu verbessern? </font><font style="vertical-align: inherit;">Zum Beispiel Schnittpunkt √ºber Union und Kreuzentropie mit unterschiedlichen Gewichten.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist es m√∂glich, die Ergebnisse zu verbessern, indem der Verlustfunktion verschiedene Erg√§nzungen hinzugef√ºgt werden, die speziell f√ºr seismische Daten entwickelt wurden?</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und zu einer globaleren Frage: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lohnt es sich, sich mit der Auswahl der Verlustfunktion f√ºr die Interpretation seismischer Daten zu befassen, oder ist der Qualit√§tsgewinn nicht mit dem Zeitverlust f√ºr die Durchf√ºhrung solcher Studien vergleichbar? </font><font style="vertical-align: inherit;">Vielleicht lohnt es sich, intuitiv eine Funktion auszuw√§hlen und Energie f√ºr die Auswahl wichtigerer Trainingsparameter aufzuwenden?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allgemeine Beschreibung des Experiments und der verwendeten Daten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr das Experiment haben wir die gleiche Aufgabe √ºbernommen, geologische Schichten auf 2D-Schnitten eines seismischen W√ºrfels zu isolieren (siehe Abbildung 1). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w6/j3/gn/w6j3gnflms5vqyxc3mbjdnzsaam.png"> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 1. Beispiel eines 2D-Schnitts (links) und das Ergebnis der Markierung der entsprechenden geologischen Schichten (rechts) ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
und des gleichen Satzes vollst√§ndig beschrifteter Daten aus dem niederl√§ndischen Sektor der Nordsee. Die seismischen Quelldaten sind auf der Website des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open Seismic Repository: Project Netherlands Offshore F3 Block</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verf√ºgbar </font><font style="vertical-align: inherit;">. Eine kurze Beschreibung findet sich bei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Silva et al. "Niederl√§ndischer Datensatz: Ein neuer √∂ffentlicher Datensatz f√ºr maschinelles Lernen in der seismischen Interpretation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">"</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Da es sich in unserem Fall um 2D-Schnitte handelt, haben wir nicht den urspr√ºnglichen 3D-W√ºrfel verwendet, sondern das bereits erstellte ‚ÄûSchneiden‚Äú, das hier verf√ºgbar ist:</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niederlande F3 Interpretationsdatensatz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§hrend des Experiments haben wir die folgenden Probleme gel√∂st:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben uns die Quelldaten angesehen und die Schnitte ausgew√§hlt, deren Qualit√§t der manuellen Markierung am n√§chsten kommt (√§hnlich dem vorherigen Experiment).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die Architektur des neuronalen Netzwerks, die Methodik und die Parameter des Trainings sowie das Prinzip der Auswahl von Schichten f√ºr das Training und die Validierung festgelegt (√§hnlich wie im vorherigen Experiment).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die untersuchten Verlustfunktionen gew√§hlt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die besten Parameter f√ºr die parametrisierten Verlustfunktionen ausgew√§hlt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben neuronale Netze mit unterschiedlichen Funktionen auf demselben Datenvolumen trainiert und die beste Funktion ausgew√§hlt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben neuronale Netze mit verschiedenen Kombinationen der ausgew√§hlten Funktion mit Funktionen einer anderen Klasse auf derselben Datenmenge trainiert.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben neuronale Netze mit Regularisierung der ausgew√§hlten Funktion auf dieselbe Datenmenge trainiert.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Vergleich verwendeten wir die Ergebnisse eines fr√ºheren Experiments, bei dem die Verlustfunktion ausschlie√ülich intuitiv gew√§hlt wurde und eine Kombination von Funktionen verschiedener Klassen mit Koeffizienten war, die ebenfalls ‚Äûmit dem Auge‚Äú ausgew√§hlt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ergebnisse dieses Experiments in Form von gesch√§tzten Metriken, die von den Netzwerken der Schichtmasken vorhergesagt werden, sind nachstehend dargestellt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 1. Datenauswahl</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als erste Daten verwendeten wir vorgefertigte Inlines und Crosslines eines seismischen W√ºrfels aus dem niederl√§ndischen Sektor der Nordsee. </font><font style="vertical-align: inherit;">Wie im vorherigen Experiment, bei dem die Arbeit des Dolmetschers simuliert wurde, haben wir f√ºr das Training des Netzwerks nur saubere Masken ausgew√§hlt, nachdem wir alle Schnitte betrachtet hatten. </font><font style="vertical-align: inherit;">Als Ergebnis wurden 700 Kreuzlinien und 400 Inlines aus ~ 1600 Quellbildern ausgew√§hlt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 2. Festlegen der Parameter des Experiments</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser und die folgenden Abschnitte sind vor allem f√ºr Spezialisten in Data Science von Interesse, daher wird eine geeignete Terminologie verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr das Training haben wir 5% der Gesamtzahl der Slices ausgew√§hlt, au√üerdem Inlines und Crosslines zu gleichen Teilen, d. H. 40 + 40. Die Scheiben wurden gleichm√§√üig im gesamten W√ºrfel ausgew√§hlt. Zur Validierung wurde 1 Schicht zwischen benachbarten Bildern der Trainingsprobe verwendet. Somit bestand die Validierungsstichprobe aus 39 Inlines und 39 Crosslines. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
321 Inline und 621 Crossline fielen in die verz√∂gerte Stichprobe, mit der die Ergebnisse verglichen wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ñhnlich wie im vorherigen Experiment wurde keine Bildvorverarbeitung durchgef√ºhrt, und es wurde dieselbe UNet-Architektur mit denselben Trainingsparametern verwendet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Zielscheibenmasken wurden als Bin√§rw√ºrfel der Dimension HxBx10 dargestellt, wobei die letzte Dimension der Anzahl der Klassen entspricht und jeder Wert des W√ºrfels 0 oder 1 ist, je nachdem, ob dieses Pixel im Bild zur Klasse der entsprechenden Ebene geh√∂rt oder nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jede Netzwerkvorhersage war ein √§hnlicher W√ºrfel, dessen Wert sich auf die Wahrscheinlichkeit bezieht, dass ein bestimmtes Bildpixel zur Klasse der entsprechenden Schicht geh√∂rt. In den meisten F√§llen wurde dieser Wert unter Verwendung eines Sigmoid in die Wahrscheinlichkeit selbst umgewandelt. Dies sollte jedoch nicht f√ºr alle Verlustfunktionen durchgef√ºhrt werden, daher wurde die Aktivierung nicht f√ºr die letzte Schicht des Netzwerks verwendet. Stattdessen wurden die entsprechenden Konvertierungen in den Funktionen selbst durchgef√ºhrt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Einfluss der Zuf√§lligkeit der Wahl der Anfangsgewichte auf die Ergebnisse zu verringern, wurde das Netzwerk f√ºr eine √Ñra mit bin√§rer Kreuzentropie als Funktion von Verlusten trainiert. </font><font style="vertical-align: inherit;">Alle anderen Trainings begannen mit diesen erhaltenen Gewichten.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 3. Die Auswahl der Verlustfunktionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr das Experiment wurden 2 Grundklassen von Funktionen in 6 Varianten ausgew√§hlt: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bin√§re Kreuzentropie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin√§re Kreuzentropie;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gewichtete bin√§re Kreuzentropie;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ausgeglichene bin√§re Kreuzentropie.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnittpunkt √ºber Union</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaccard Verlust;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tversky Verlust;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lov√°sz Verlust.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine kurze Beschreibung der aufgelisteten Funktionen mit Code f√ºr Keras finden Sie im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hier pr√§sentieren wir die wichtigsten mit Links (wo m√∂glich) zu einer detaillierten Beschreibung jeder Funktion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr unser Experiment ist die Konsistenz der w√§hrend des Trainings verwendeten Funktion mit der Metrik wichtig, anhand derer wir das Ergebnis der Netzwerkprognose f√ºr die verz√∂gerte Stichprobe bewerten. </font><font style="vertical-align: inherit;">Daher haben wir unseren in TensorFlow und Numpy implementierten Code verwendet, der direkt mit den folgenden Formeln geschrieben wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die folgende Notation wird in den Formeln verwendet</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pt - f√ºr die bin√§re Zielmaske (Ground Truth);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pp - f√ºr Netzwerkvorhersagemaske.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr alle Funktionen wird, sofern nicht anders angegeben, angenommen, dass die Netzwerkvorhersagemaske Wahrscheinlichkeiten f√ºr jedes Pixel im Bild enth√§lt, d. H. </font><font style="vertical-align: inherit;">Werte im Intervall (0, 1).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bin√§re Kreuzentropie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beschreibung: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://towardsdatascience.com/understanding-binary-cross-entropy-log-loss-a-visual-explanation-a3ac6025181a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fc/-1/ep/fc-1epf3rdg8gfdq0ycdtywgxee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Funktion versucht, die Netzwerkprognoseverteilung n√§her an das Ziel heranzuf√ºhren und nicht nur fehlerhafte, sondern auch unsichere Vorhersagen zu bestrafen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gewichtete bin√§re Kreuzentropie</font></font></h3><br>
<img src="https://habrastorage.org/webt/gm/ud/n3/gmudn3reniryckosw6v_myxzyh0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Funktion stimmt mit der bin√§ren Kreuzentropie mit einem Beta-Wert von 1 √ºberein. Sie wird f√ºr starke Klassenungleichgewichte empfohlen. </font><font style="vertical-align: inherit;">F√ºr Beta&gt; 1 nimmt die Anzahl falsch negativer Vorhersagen (falsch negativ) ab und die Vollst√§ndigkeit (R√ºckruf) nimmt zu, f√ºr Beta &lt;1 nimmt die Anzahl falsch positiver Vorhersagen (falsch positiv) ab und die Genauigkeit nimmt zu (Pr√§zision).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausgeglichene bin√§re Kreuzentropie</font></font></h3><br>
<img src="https://habrastorage.org/webt/pd/pn/sd/pdpnsd3ah6jwiofykm1ftkggfec.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Funktion √§hnelt der gewichteten Kreuzentropie, korrigiert jedoch den Beitrag nicht nur einzelner, sondern auch null Werte der Zielmaske. </font><font style="vertical-align: inherit;">F√§llt (bis zu einer Konstanten) mit bin√§rer Kreuzentropie bei einem Wert des Koeffizienten Beta = 0,5 zusammen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaccard Verlust </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Jacquard-Koeffizient (auch bekannt als Intersection over Union, IoU) bestimmt das Ma√ü f√ºr die ‚Äû√Ñhnlichkeit‚Äú der beiden Bereiche. </font><font style="vertical-align: inherit;">Der W√ºrfelindex macht dasselbe: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ej/ak/to/ejakto7j-ghcfffxulq6o6i7kz0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es macht keinen Sinn, beide Funktionen zu ber√ºcksichtigen. </font><font style="vertical-align: inherit;">Wir haben uns f√ºr Jacquard entschieden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Fall, dass beide Bereiche mit bin√§ren Masken angegeben werden, kann die obige Formel in Bezug auf die Werte der Masken leicht umgeschrieben werden: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n-/6w/zh/n-6wzhefudinbxqnol6vaibdbaw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr nicht-bin√§re Vorhersagen ist die Optimierung des Jacquard-Koeffizienten eine nicht triviale Aufgabe. </font><font style="vertical-align: inherit;">Wir werden dieselbe Formel f√ºr Wahrscheinlichkeiten in der Prognosemaske als eine bestimmte Nachahmung des Anfangskoeffizienten und dementsprechend die folgende Verlustfunktion verwenden:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/yi/8f/eqyi8fefrizsnxxu909mlx9wmgm.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tversky Verlust</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beschreibung: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://arxiv.org/pdf/1706.05721.pdf</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/hr/3k/cc/hr3kccuxmb3qfogjzaotqbz1ewa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Diese Funktion ist eine parametrisierte Version der Optimierung des Jacquard-Koeffizienten, die mit ihm bei alpha = beta = 1 und mit dem W√ºrfelindex bei alpha = beta = 0,5 √ºbereinstimmt. </font><font style="vertical-align: inherit;">F√ºr andere Nicht-Null- und Nicht-√úbereinstimmungswerte k√∂nnen wir den Schwerpunkt auf Genauigkeit oder Vollst√§ndigkeit verschieben, genauso wie bei den Funktionen der gewichteten und ausgeglichenen Kreuzentropie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem der Betonungsverschiebung kann unter Verwendung eines einzelnen Koeffizienten, der im Intervall (0, 1) liegt, umgeschrieben werden. </font><font style="vertical-align: inherit;">Die resultierende Verlustfunktion sieht folgenderma√üen aus:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/re/og/fdreog2gzjmosed7ggczhjwj9oo.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lov√°sz Verlust</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist schwierig, eine Formel f√ºr diese Funktion anzugeben, da dies eine Option zur Optimierung des Jacquard-Koeffizienten durch einen Algorithmus ist, der auf sortierten Fehlern basiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beschreibung der Funktion finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Eine der Codeoptionen finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wichtige Erkl√§rung! </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Vergleich von Werten und Graphen im Folgenden zu vereinfachen, werden wir unter dem Begriff "Jacquard-Koeffizient" die Einheit abz√ºglich des Koeffizienten selbst weiter verstehen. </font><font style="vertical-align: inherit;">Jaccard-Verlust ist eine M√∂glichkeit, dieses Verh√§ltnis zu optimieren, zusammen mit Tversky-Verlust und Lov√°sz-Verlust.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 4. Auswahl der besten Parameter f√ºr parametrisierte Verlustfunktionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die beste Verlustfunktion f√ºr denselben Datensatz auszuw√§hlen, wird ein Bewertungskriterium ben√∂tigt. In seiner Qualit√§t haben wir die durchschnittliche / mittlere Anzahl verbundener Komponenten f√ºr die resultierenden Masken ausgew√§hlt. Zus√§tzlich haben wir den Jacquard-Koeffizienten f√ºr Vorhersagemasken verwendet, die in einschichtiges Argmax konvertiert und erneut in bin√§risierte Schichten unterteilt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anzahl der verbundenen Komponenten (d. H. Feste Flecken derselben Farbe) bei jeder erhaltenen Vorhersage ist ein indirektes Kriterium zur Beurteilung des Volumens ihrer nachfolgenden Verfeinerung durch den Interpreter. Wenn dieser Wert 10 ist, werden die Ebenen korrekt ausgew√§hlt und es handelt sich um ein Maximum der geringf√ºgigen Horizontkorrektur. Wenn es nicht mehr viele gibt, m√ºssen Sie nur kleine Bereiche des Bildes "reinigen". Wenn es wesentlich mehr davon gibt, ist alles schlecht und muss m√∂glicherweise sogar komplett neu gestaltet werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Jacquard-Koeffizient charakterisiert wiederum das Zusammentreffen von Bildzonen, die einer Klasse zugeordnet sind, und deren Grenzen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gewichtete bin√§re Kreuzentropie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gem√§√ü den Ergebnissen der Experimente wurde der Wert des Parameters Beta = 2 ausgew√§hlt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/uo/hs/iuuohsoebw2mam6axgianwbi_se.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 2. Vergleich der Qualit√§t der Netzwerkprognose f√ºr die Hauptverlustfunktion und der ausgew√§hlten Kriterien </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/dm/-c/3t/dm-c3teowwucpbfd2cckbspwbi0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 3. Statistik f√ºr die Anzahl der verbundenen Komponenten in Bezug auf die Werte des Beta-Parameters</font></font><br>
</i><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausgeglichene bin√§re Kreuzentropie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gem√§√ü den Ergebnissen der Experimente wurde der Wert des Parameters Beta = 0,7 gew√§hlt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ae/cl/p8/aeclp8omibpajaurlwmrg9sttai.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 4. Vergleich der Qualit√§t der Netzwerkprognose durch die Hauptverlustfunktion und die ausgew√§hlten Kriterien </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/lj/r0/fm/ljr0fmrrxbyarastm-wudodn0w0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 5. Statistik f√ºr die Anzahl der angeschlossenen Komponenten</font></font><br>
</i><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tversky Verlust</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gem√§√ü den Ergebnissen der Experimente wurde der Wert des Parameters Beta = 0,7 gew√§hlt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3a/rk/vt/3arkvtetkqy6i9k3ih8zyo8is78.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 6. Vergleich der Qualit√§t der Netzwerkprognose durch die Hauptverlustfunktion und die ausgew√§hlten Kriterien </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ct/qx/bh/ctqxbh-6f4hy2ek2k-phurk4zmg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 7. Vergleich der Qualit√§t der Netzwerkprognose durch die Hauptverlustfunktion und die ausgew√§hlten Kriterien</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Aus den obigen Abbildungen lassen sich zwei Schlussfolgerungen ziehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens korrelieren die ausgew√§hlten Kriterien ziemlich gut miteinander, d.h. </font><font style="vertical-align: inherit;">Der Jacquard-Koeffizient stimmt mit einer Sch√§tzung des Volumens der erforderlichen Verfeinerung √ºberein. </font><font style="vertical-align: inherit;">Zweitens unterscheidet sich das Verhalten der Kreuzentropieverlustfunktionen logischerweise ziemlich vom Verhalten der Kriterien, d.h. </font><font style="vertical-align: inherit;">Es lohnt sich immer noch nicht, nur diese Funktionskategorie ohne zus√§tzliche Auswertung der Ergebnisse zu trainieren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 5. Auswahl der besten Verlustfunktion.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergleichen Sie nun die Ergebnisse, die die ausgew√§hlten 6 Verlustfunktionen im selben Datensatz zeigten. </font><font style="vertical-align: inherit;">Um das Bild zu vervollst√§ndigen, haben wir die Vorhersagen des Netzwerks hinzugef√ºgt, die im vorherigen Experiment erhalten wurden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/xr/my/wcxrmy--zexfjmduml37g4smpvc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 8. Vergleichsprojektionsnetzwerke, die mit unterschiedlichen Verlustfunktionen f√ºr die ausgew√§hlten Kriterien trainiert wurden</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tabelle 1. Die Mittelwerte der Kriterien </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kx/89/87/kx8987wn5narwnkfza5k2nemhbm.png"><br>
<br>
<img src="https://habrastorage.org/webt/6s/f4/_k/6sf4_kelwapket3g27sjs2eukyw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 9. Vergleichsnetzwerkprojektionen zur Anzahl der Vorhersagen der angegebenen Anzahl verbundener Komponenten</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
aus den dargestellten Diagrammen und Tabellen, die folgenden Schlussfolgerungen zur Verwendung von "Solo" Verlustfunktionen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In unserem Fall zeigen die "Jacquard" -Funktionen der Intersection over Union-Klasse wirklich bessere Werte als die Cross-Entropy-Funktionen. </font><font style="vertical-align: inherit;">Dar√ºber hinaus deutlich besser.</font></font></li>
<li>              Lovazh loss.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergleichen wir die Prognosen f√ºr die Schichten visuell mit einem der besten und einem der schlechtesten Lovazh-Verlustwerte und der Anzahl der verbundenen Komponenten. Die Zielmaske wird in der oberen rechten Ecke angezeigt, die Vorhersage, die im vorherigen Experiment erhalten wurde, in der unteren rechten Ecke: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/xi/ra/xpxirarzwu1-6gfacc2c1cjh5yy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 10. Netzwerkvorhersagen f√ºr eine der besten Schichten </font></font><br>
 </i><br>
<img src="https://habrastorage.org/webt/xq/13/dr/xq13drinuno-gjldxvuknxurm-m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 11. Netzwerkvorhersagen f√ºr eine der schlechtesten Schichten</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es ist ersichtlich, dass alle Netzwerke auf gut erkennbaren Ebenen gleich gut funktionieren Scheiben. Aber selbst in einem schlecht erkennbaren Bereich, in dem alle Netzwerke falsch sind, ist die Prognose f√ºr den Lovazh-Verlust visuell besser als die Prognosen anderer Netzwerke. Obwohl es einer der schlimmsten Verluste f√ºr diese Funktion ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Schritt haben wir uns also f√ºr einen klaren F√ºhrer entschieden - den Verlust von Lovazh, dessen Ergebnisse wie folgt beschrieben werden k√∂nnen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etwa 60% der Prognosen sind nahezu ideal, d.h. </font><font style="vertical-align: inherit;">erfordern nur Anpassungen an einzelnen Abschnitten des Horizonts;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ungef√§hr 30% der Vorhersagen enthalten nicht mehr als 2 zus√§tzliche Punkte, d.h. </font><font style="vertical-align: inherit;">kleinere Verbesserungen erfordern;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ungef√§hr 1% der Vorhersagen enthalten 10 bis 25 zus√§tzliche Punkte, d.h. </font><font style="vertical-align: inherit;">erfordert eine wesentliche Verbesserung.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Schritt, bei dem nur die Verlustfunktion ersetzt wurde, konnten wir eine signifikante Verbesserung der Ergebnisse im Vergleich zum vorherigen Experiment erzielen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kann es durch eine Kombination verschiedener Funktionen noch verbessert werden? </font><font style="vertical-align: inherit;">H√∂r zu.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 6. Auswahl der besten Kombination von Verlustfunktionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kombination von Verlustfunktionen verschiedener Art wird ziemlich oft verwendet. Die beste Kombination zu finden ist jedoch nicht einfach. Ein gutes Beispiel ist das Ergebnis eines fr√ºheren Experiments, das sich als noch schlechter als die "Solo" -Funktion herausstellte. Der Zweck solcher Kombinationen besteht darin, das Ergebnis durch Optimierung nach verschiedenen Prinzipien zu verbessern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir, verschiedene Optionen der im vorherigen Schritt ausgew√§hlten Funktion mit anderen zu sortieren, jedoch nicht mit allen in einer Reihe. Wir beschr√§nken uns auf Kombinationen von Funktionen verschiedener Typen, in diesem Fall mit Kreuzentropiefunktionen. Es macht keinen Sinn, Kombinationen von Funktionen des gleichen Typs in Betracht zu ziehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insgesamt haben wir 3 Paare mit jeweils 9 m√∂glichen Koeffizienten √ºberpr√ºft (von 0,1 \ 0,9 bis 0,9 \ 0,1). In den folgenden Abbildungen zeigt die x-Achse den Koeffizienten vor dem Lovazh-Verlust. Der Koeffizient vor der zweiten Funktion ist gleich eins minus dem Koeffizienten vor der ersten. Der linke Wert ist nur eine Kreuzentropiefunktion, der rechte Wert ist nur der Lovazh-Verlust. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/gq/rq/-d/gqrq-d_mwnnwg5dgvyzysvlxzqw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 12. Bewertung der Prognoseergebnisse von auf BCE + Lovazh trainierten Netzwerken </font></font><br>
 </i><br>
<img src="https://habrastorage.org/webt/1p/as/9p/1pas9pcxuskc8hnyj2igbzjibkc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 13. Bewertung der Prognoseergebnisse von auf BCE + Lovazh trainierten Netzwerken </font></font></i><br>
 <br>
<img src="https://habrastorage.org/webt/dy/22/8z/dy228z6wlagamlmywmivsvbvzmg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 14. Bewertung der Prognoseergebnisse der auf BBCE + Lovazh trainierten Netzwerke</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist ersichtlich, dass die ausgew√§hlte "Solo" -Funktion durch Hinzuf√ºgen von Kreuzentropie nicht verbessert wurde. Das Reduzieren einiger Werte des Jacquard-Koeffizienten um 1-2 Tausendstel kann in einem Wettbewerbsumfeld wichtig sein, kompensiert jedoch nicht die gesch√§ftliche Verschlechterung des Kriteriums f√ºr die Anzahl der verbundenen Komponenten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das typische Verhalten einer Kombination von Funktionen verschiedener Typen zu √ºberpr√ºfen, haben wir eine √§hnliche Reihe von Schulungen f√ºr Jaccard-Verlust durchgef√ºhrt. F√ºr nur ein Paar konnten die Werte beider Kriterien gleichzeitig leicht verbessert werden: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,8 * JaccardLoss + 0,2 * BBCE </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durchschnitt der verbundenen Komponenten: 11,5695 -&gt; 11,2895 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durchschnitt der Jaccard: 0,0307 -&gt; 0,0283 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber selbst diese Werte sind schlechter als der Lovazh-Verlust ‚Äûsolo‚Äú.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher ist es sinnvoll, Kombinationen von Funktionen unterschiedlicher Art auf unseren Daten nur unter Wettbewerbsbedingungen oder in Gegenwart von Freizeit und Ressourcen zu untersuchen. </font><font style="vertical-align: inherit;">Es ist unwahrscheinlich, dass eine signifikante Qualit√§tssteigerung erreicht wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe 7. Regularisierung der besten Verlustfunktion.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Schritt haben wir versucht, die zuvor ausgew√§hlte Verlustfunktion durch einen Zusatz zu verbessern, der speziell f√ºr seismische Daten entwickelt wurde. Dies ist die im Artikel beschriebene Regularisierung: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Neuronale Netze f√ºr Geophysiker und ihre Anwendung auf die Interpretation seismischer Daten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">"</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Artikel erw√§hnt, dass Standard-Regularisierungen wie das Abfallen von Gewichten bei seismischen Daten nicht gut funktionieren. Stattdessen wird ein Ansatz vorgeschlagen, der auf der Norm der Gradientenmatrix basiert und darauf abzielt, die Grenzen von Klassen zu gl√§tten. Der Ansatz ist logisch, wenn wir uns daran erinnern, dass die Grenzen der geologischen Schichten glatt sein sollten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Verwendung einer solchen Regularisierung ist jedoch mit einer gewissen Verschlechterung der Ergebnisse nach dem Jacquard-Kriterium zu rechnen, da gegl√§ttete Klassengrenzen fallen weniger wahrscheinlich mit m√∂glichen abrupten √úberg√§ngen zusammen, die mit manuellem Markup erhalten werden. Wir haben jedoch noch ein Kriterium f√ºr die √úberpr√ºfung - die Anzahl der angeschlossenen Komponenten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben 13 Netzwerke mit der im Artikel beschriebenen Regularisierung und dem Koeffizienten davor trainiert und Werte von 0,1 bis 0,0001 angenommen. Die folgenden Abbildungen zeigen einige der Bewertungen f√ºr beide Kriterien. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/hz/ud/no/hzudnopqafa6t6chsygeikxsvwy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 15. Vergleich der Qualit√§t der Netzwerkprognose anhand der ausgew√§hlten Kriterien </font></font><br>
 </i><br>
<img src="https://habrastorage.org/webt/rq/v7/2h/rqv72hpfiaplc9m3_nfurrxk3xq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 16. Statistik f√ºr die Anzahl der verbundenen Komponenten in Bezug auf die Koeffizientenwerte vor der Regularisierung</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist ersichtlich, dass die Regularisierung mit einem Koeffizienten von 0,025 die Statistik f√ºr das Kriterium f√ºr die Anzahl der verbundenen Komponenten signifikant reduzierte. Das Jacquard-Kriterium stieg in diesem Fall jedoch erwartungsgem√§√ü auf 0,0357. Dies ist jedoch ein leichter Anstieg im Vergleich zu einer Verringerung der manuellen Verfeinerung. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/oa/-1/ow/oa-1owbvsfhyuzxqsugvjmlk1ro.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 17. Vergleich der Netzwerkvorhersagen anhand der Anzahl der Vorhersagen mit der angegebenen Anzahl verbundener Komponenten.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Schlie√ülich vergleichen wir die Klassengrenzen auf dem Ziel und die vorhergesagten Masken f√ºr den zuvor ausgew√§hlten schlechtesten Schnitt. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/gh/sp/1o/ghsp1oiatktuohroonfpakr3teq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 18. Die Netzwerkprognose f√ºr eine der schlechtesten Schichten. </font></font></i><br>
 <br>
<img src="https://habrastorage.org/webt/ge/0b/zg/ge0bzgqe3gpsuktjwgmxannuxca.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 19. √úberlagern eines Teils des Horizonts der Zielmaske und der Prognose</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie aus den Figuren ersichtlich ist, ist die Vorhersagemaske nat√ºrlich an einigen Stellen falsch, aber gleichzeitig gl√§ttet sie die Schwingungen der Zielhorizonte, d.h. </font><font style="vertical-align: inherit;">korrigiert kleinere Fehler im anf√§nglichen Markup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusammenfassende Merkmale der ausgew√§hlten Verlustfunktion mit Regularisierung:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etwa 87% der Prognosen sind nahezu ideal, d.h. </font><font style="vertical-align: inherit;">erfordern nur Anpassungen an einzelnen Abschnitten des Horizonts;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ungef√§hr 10% der Vorhersagen enthalten 1 zus√§tzlichen Punkt, d.h. </font><font style="vertical-align: inherit;">kleinere Verbesserungen erfordern;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etwa 3% der Vorhersagen enthalten 2 bis 5 zus√§tzliche Punkte, d.h. </font><font style="vertical-align: inherit;">erfordern eine etwas substanziellere Verfeinerung.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nur durch die Anpassung eines Lernparameters - der Verlustfunktion - konnten wir die Qualit√§t der Netzwerkprognose signifikant verbessern und den Umfang der erforderlichen Verfeinerung um etwa das Dreifache reduzieren. </font></font></li>
<li>             Intersection over Union (     Lovazh loss)      .            -,       .</li>
<li>    -,      .         , ..     .</li>
</ul><br>
<h2>  :</h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reinaldo Mozart Silva, Lais Baroni, Rodrigo S. Ferreira, Daniel Civitarese, Daniela Szwarcman, Emilio Vital Brazil. Netherlands Dataset: A New Public Dataset for Machine Learning in Seismic Interpretation</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lars Nieradzik. Losses for Image Segmentation</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daniel Godoy. Understanding binary cross-entropy / log loss: a visual explanation</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Seyed Sadegh Mohseni Salehi, Deniz Erdogmus, and Ali Gholipour. Tversky loss function for image segmentation using 3D fully convolutional deep networks</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maxim Berman, Amal Rannen Triki, Matthew B. Blaschko. The Lovasz-Softmax loss: A tractable surrogate for the optimization of the intersection-over-union measure in neural networks</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bas Peters, Eldad Haber, and Justin Granek. Neural-networks for geophysicists and their application to seismic data interpretation</a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488842/index.html">Fangen Sie ein Elektron: Beobachten Sie einen Prozess, der eine Quintillionstelsekunde dauert</a></li>
<li><a href="../de488844/index.html">Grenzen f√ºr Grenzschutzbeamte: Das US-Gericht hat Regeln f√ºr die √úberpr√ºfung von Ger√§ten festgelegt - diskutieren Sie die Situation</a></li>
<li><a href="../de488846/index.html">Postgresso 19</a></li>
<li><a href="../de488848/index.html">CTO alle starten</a></li>
<li><a href="../de488850/index.html">Verwenden von RabbitMQ mit MonsterMQ Teil 1</a></li>
<li><a href="../de488854/index.html">10. Fortinet Erste Schritte v6.0. Begleiten</a></li>
<li><a href="../de488856/index.html">Gut CRM und CRM. Alles ist einfacher als Sie denken.</a></li>
<li><a href="../de488860/index.html">Importsubstitution und Schiffbau</a></li>
<li><a href="../de488866/index.html">√úberpr√ºfen von Bildern mit Gitlab CI / CD</a></li>
<li><a href="../de488868/index.html">Ank√ºndigung von Mobius 2020 Piter: Was begeistert mobile Entwickler?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>