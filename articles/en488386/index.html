<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📋 🧚🏾 💂🏼 Cases for applying network anomaly analysis tools: attacks through browser plug-ins 🤘🏼 💃🏽 👂🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attacks on browsers are a fairly popular vector for attackers who, through various vulnerabilities in surfing programs on the Internet or through weak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cases for applying network anomaly analysis tools: attacks through browser plug-ins</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/488386/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attacks on browsers are a fairly popular vector for attackers who, through various vulnerabilities in surfing programs on the Internet or through weakly protected plug-ins for them, try to penetrate inside corporate and departmental networks. This usually starts on completely legal and even whitelisted sites that have vulnerabilities used by cybercriminals. Add-ons, extensions, plugins, once installed even for good purposes, begin to monitor user activity, “merge” the history of visited sites to developers, introduce annoying ads into the pages, sometimes malicious. Users often don’t even understand that the ad banner that they see on the site’s page was added by the plugin they installed,It is not originally embedded on the page. And sometimes such plug-ins and extensions even serve as an entrance door for attackers to users' computers, from which a victorious march through the enterprise’s internal network begins. It is through these extensions that attackers can install malicious code, track data or steal it. At the same time, we are not always able to force all users to properly configure their browsers and monitor their configuration. What to do in such a situation when only one user can become the weakest link and open the “gate to hell”? Network traffic monitoring solutions can help in this case.with which the victorious procession begins on the internal network of the enterprise. It is through these extensions that attackers can install malicious code, track data or steal it. At the same time, we are not always able to force all users to properly configure their browsers and monitor their configuration. What to do in such a situation when only one user can become the weakest link and open the “gate to hell”? Network traffic monitoring solutions can help in this case.with which the victorious procession begins on the internal network of the enterprise. It is through these extensions that attackers can install malicious code, track data or steal it. At the same time, we are not always able to force all users to properly configure their browsers and monitor their configuration. What to do in such a situation when only one user can become the weakest link and open the “gate to hell”? Network traffic monitoring solutions can help in this case.when only one user can become the weakest link and open the “gate to hell”? Network traffic monitoring solutions can help in this case.when only one user can become the weakest link and open the “gate to hell”? Network traffic monitoring solutions can help in this case.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nj/1y/zc/nj1yzcepmgaxbl77ce0_rxtt-uy.png" alt="image"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of Cisco’s research units, Cisco Cognitive Intelligence, which appeared after the Czech company Cognitive Security was bought many years ago, revealed that many malicious browser plug-ins have unique characteristics that can be detected and monitored as part of the analysis of network traffic. The only difference that is present compared to the previous three cases examined earlier ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leak detection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">malicious code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNSpionage campaigns</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) - in order to detect the activity of plugins that introduce adverts for which cybercriminals earn money or who merge your data, you need to do a lot of research yourself (we spent about a year analyzing several thousand plugins to identify patterns of behavior and describe them), or trust the manufacturer of the NTA class solution, which contains such an opportunity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what this feature looks like in the Cisco Stealthwatch solution. We see that from two addresses of the internal network with addresses 10.201.3.45 and 10.201.3.108, activity associated with click fraud, the introduction of ads into pages (Ad injection), and malicious advertising is recorded. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/o9/dz/cvo9dzu9redezchepoc-55esxpk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviously, we want to investigate this activity:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/c4/8a/lyc48apyvnnmj2spn38if7nfdva.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see that the node in the corporate network interacts with the domain located on the legal Amazon (therefore, it will not work to block by IP address; if you are not Roskomnadzor, of course). However, the application of various machine learning algorithms to traffic shows that this activity is malicious.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nj/1y/zc/nj1yzcepmgaxbl77ce0_rxtt-uy.png" alt="image"><br>
<cut></cut><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An even deeper dive allows us to understand even more details about the threat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qz/a6/rv/qza6rvvuqfsoohsxv6pqwefffwu.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, case # CADP01 is associated with the malicious code AdPeak, which injects additional advertising into the visited Web pages and for showing them, the attackers earn money. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z-/bo/kn/z-boknz8xqnrkx8-qyplmth9e-o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Case # CDPY01 is associated with a potentially unwanted application that injects ads into a browser session and can lead to subsequent infection of the computer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/rj/2o/birj2o4fn1ihs4_zly-5wuktwx8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the detection of malicious browser activity may be a sign of an infection that has already happened, we need to conduct an investigation that will show who the compromised node is interacting with on our network, what kind of node it is, what its role is, what user works for it, etc.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/bf/ei/awbfeip6zgij6zrijxdts51sdjo.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the mentioned node 10.201.3.45 belongs to the Development group (development or software development). We also see all the data streams associated with this node and the main security events. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/d6/fs/lxd6fsxbptliy7eyl_rruwsyw9o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, the node we are interested in most often interacts with local DNS servers, which leads to thoughts about a possible attack on DNS or through DNS ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remember</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DNSpionage or Sea Turtle described in the last post).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What do we see in the list of security events? Flow Denied. What it is? The answer to this question depends very much on the context, since the connections of the internal nodes with the internal ones are very different from the connection of the internal nodes with the external ones and can mean very different things. For example, if the internal node has many forbidden connections (flows) to the internal resource through the same port, then this is probably the wrong configuration for any application. A lot of forbidden flows with different ports or internal nodes, most likely speaks of reconnaissance, one of the first stages in any attack. Blocked flows from inside to external Internet sites can characterize the operation of malicious code, remote access utilities (RATs), information leakage, and many other “interesting” events that your security policy defines as prohibited.And since they are detected by your network traffic analysis system, it means that something is wrong with you.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This case is interesting in that it slightly changes the view on the capabilities of systems of the NTA class, which rely on the analysis of Netflow (or other flow protocols) in their work. </font><font style="vertical-align: inherit;">It can be seen that such systems can not only work at the network level, but also allow us to rise much higher and detect attacks at the application level, which are far from always visible to the firewall or even the means of protection of terminal devices.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488374/index.html">Telegram + 1C + Webhooks + Apache + Self-Signed Certificate</a></li>
<li><a href="../en488376/index.html">When the principle "to hell with everything, take it and do it!" not working: procrastinator notes</a></li>
<li><a href="../en488378/index.html">Briefly about naming in JS</a></li>
<li><a href="../en488380/index.html">The easiest start in STM through "one place"</a></li>
<li><a href="../en488382/index.html">I add 3-25 seconds delay to sites that I visit</a></li>
<li><a href="../en488388/index.html">Relogin and HTTP Basic Auth</a></li>
<li><a href="../en488390/index.html">How to make Telegram bot friends with OpenId Connect</a></li>
<li><a href="../en488392/index.html">Production-ready images for k8s</a></li>
<li><a href="../en488404/index.html">Games worth waiting for in 2020</a></li>
<li><a href="../en488406/index.html">IPv6 - you are doing it wrong</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>