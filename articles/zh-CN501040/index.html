<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¤› ğŸ•‰ï¸ åº”ç”¨ç¨‹åºä¸­çš„å…¸å‹é”™è¯¯ä¼šå¯¼è‡´postgresqlè†¨èƒ€ã€‚å®‰å¾·çƒˆÂ·è¨å°”å°¼ç§‘å¤«ï¼ˆAndrey Salnikovï¼‰ ğŸ§’ğŸ¼ ğŸ›¤ï¸ ğŸ¥”</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘å»ºè®®æ‚¨ç†Ÿæ‚‰å®‰å¾·çƒˆÂ·è¨å°”å°¼ç§‘å¤«ï¼ˆAndrey Salnikovï¼‰å¯¹2016å¹´åˆæŠ¥å‘Šçš„è§£è¯»ï¼Œâ€œåº”ç”¨ç¨‹åºä¸­çš„å…¸å‹é”™è¯¯å¯¼è‡´postgresqlè†¨èƒ€â€
 

åœ¨æ­¤æŠ¥å‘Šä¸­ï¼Œæˆ‘å°†åˆ†æåœ¨è®¾è®¡å’Œç¼–å†™åº”ç”¨ç¨‹åºä»£ç é˜¶æ®µå‡ºç°çš„åº”ç”¨ç¨‹åºä¸­çš„ä¸»è¦é”™è¯¯ã€‚è€Œä¸”æˆ‘å°†åªè€ƒè™‘é‚£äº›å¯¼è‡´Postgresqlè†¨èƒ€çš„é”™è¯¯ã€‚é€šå¸¸ï¼Œè¿™æ˜¯æ•´ä¸ªç³»ç»Ÿæ€§...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>åº”ç”¨ç¨‹åºä¸­çš„å…¸å‹é”™è¯¯ä¼šå¯¼è‡´postgresqlè†¨èƒ€ã€‚å®‰å¾·çƒˆÂ·è¨å°”å°¼ç§‘å¤«ï¼ˆAndrey Salnikovï¼‰</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501040/"><p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å»ºè®®æ‚¨ç†Ÿæ‚‰å®‰å¾·çƒˆÂ·è¨å°”å°¼ç§‘å¤«ï¼ˆAndrey Salnikovï¼‰å¯¹2016å¹´åˆæŠ¥å‘Šçš„è§£è¯»ï¼Œâ€œåº”ç”¨ç¨‹åºä¸­çš„å…¸å‹é”™è¯¯å¯¼è‡´postgresqlè†¨èƒ€â€</font></font></strong></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤æŠ¥å‘Šä¸­ï¼Œæˆ‘å°†åˆ†æåœ¨è®¾è®¡å’Œç¼–å†™åº”ç”¨ç¨‹åºä»£ç é˜¶æ®µå‡ºç°çš„åº”ç”¨ç¨‹åºä¸­çš„ä¸»è¦é”™è¯¯ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”æˆ‘å°†åªè€ƒè™‘é‚£äº›å¯¼è‡´Postgresqlè†¨èƒ€çš„é”™è¯¯ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œè¿™æ˜¯æ•´ä¸ªç³»ç»Ÿæ€§èƒ½ç»“æŸçš„å¼€å§‹ï¼Œå°½ç®¡æœ€åˆå¹¶æ²¡æœ‰å¯è§çš„å…ˆå†³æ¡ä»¶ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/j4/gz/vk/j4gzvk96v4s9_slh-p4gnciohqw.png"></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ˆé«˜å…´æ¬¢è¿å¤§å®¶ï¼</font><font style="vertical-align: inherit;">è¿™ä»½æŠ¥å‘Šçš„æŠ€æœ¯æ€§ä¸å¦‚æˆ‘åŒäº‹çš„ä¸Šä¸€ä»½ã€‚</font><font style="vertical-align: inherit;">è¯¥æŠ¥å‘Šä¸»è¦é’ˆå¯¹åç«¯ç³»ç»Ÿçš„å¼€å‘äººå‘˜ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¤§é‡çš„å®¢æˆ·ã€‚</font><font style="vertical-align: inherit;">ä»–ä»¬éƒ½çŠ¯äº†åŒæ ·çš„é”™è¯¯ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä¼šå‘Šè¯‰ä½ æœ‰å…³å®ƒä»¬çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">æˆ‘å°†è§£é‡Šè¿™äº›é”™è¯¯å¯¼è‡´çš„è‡´å‘½å’Œä¸è‰¯åæœã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/9o/25/7s/9o257sxpafvagscbtymhpyqqakg.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆä¼šçŠ¯é”™è¯¯ï¼Ÿ</font><font style="vertical-align: inherit;">æ‰§è¡Œå®ƒä»¬çš„åŸå› æœ‰ä¸¤ä¸ªï¼šå¶ç„¶ï¼Œä¹Ÿè®¸æ˜¯ç”±äºå¯¹åŸºç¡€å’Œåº”ç”¨ç¨‹åºä¹‹é—´ä»¥åŠåŸºç¡€æœ¬èº«ä¸­å‘ç”Ÿçš„æŸç§æœºåˆ¶çš„æ— çŸ¥ã€‚</font></font></p><br>
<p>        ,    .    ,   .     ,   ,        .        . </p><br>
<p><img src="https://habrastorage.org/webt/ch/r5/vr/chr5vre616zbkrcrk_fcbaz60ak.png"></p><br>
<p>    ,      .     ,      .   -       .</p><br>
<p><img src="https://habrastorage.org/webt/jx/m_/ng/jxm_nggqmszbi0aa-x0sl8lan-q.png"></p><br>
<p>  :   , 2 MB.           .     â€“ 2 000     .</p><br>
<p><img src="https://habrastorage.org/webt/fx/hv/ed/fxhvedvfa8g_cbgyxmfeadzgiyq.png"></p><br>
<p>        ,    ,  .   2   .   â€“  ,      . </p><br>
<p>     ,       .    2 MB.    . </p><br>
<p>      , .    . </p><br>
<p>   â€“    .  ,    .      ,   â€“   -.        .</p><br>
<p><img src="https://habrastorage.org/webt/7k/kd/_3/7kkd_32jzk8cmll4xgh4hgsgg78.png"></p><br>
<p>      .           .    ,         ,  . ,    (   )      . </p><br>
<p>   ,            ,    .      â€“ 2 000  ,     . </p><br>
<p><img src="https://habrastorage.org/webt/ln/oi/kk/lnoikk3gactr_rj8v3f0af_suro.png"></p><br>
<p>     .  -     .    : </p><br>
<ul>
<li>    â€“  ,          .      . . .   ,                  ,    -    .        â€“ ,  .</li>
<li> ,       -   exception.    exception    .         . </li>
<li>  â€“     .   .    .  ,       ,     . </li>
</ul><br>
<p>    ? </p><br>
<p> ,         .       bloat.       ,          ,      .        .        10     , 10    ,      20 .        . </p><br>
<p>  ,  .    ,      .        ,   ,            300 .        , . .     .</p><br>
<p><img src="https://habrastorage.org/webt/72/q9/ca/72q9caetfeh_s85jaz2ekfjhsvw.png"></p><br>
<p>           . . .       .       Postgres   ,  -     .</p><br>
<p><img src="https://habrastorage.org/webt/dx/21/3d/dx213dhxb1rxroqoht-fjkl-flq.png"></p><br>
<p>     ?  .            .     ,   ,       .    .     ,          .    .    â€“          ,          . </p><br>
<p><img src="https://habrastorage.org/webt/7k/lc/rq/7klcrqmf767vibtfeyvfcnytqoi.png"></p><br>
<p>    .     ,      .     .      .    . </p><br>
<p> ,      ,     ,    .     ,   .  -      .     ,    . </p><br>
<p><img src="https://habrastorage.org/webt/_j/he/_i/_jhe_ix0hqxffvpmj0_j_dfdugc.png"></p><br>
<p> : Â«      ?Â».      .     ,         .          .      .     .          .       -   ,        . </p><br>
<p><img src="https://habrastorage.org/webt/6u/zb/uu/6uzbuuhl9l1dzipogae1xmq087u.png"></p><br>
<p>     ,    :         .         .</p><br>
<p>      ,           .          . ,     -  . . .              .     . </p><br>
<p>  ,   ,  .        ,      . </p><br>
<p><img src="https://habrastorage.org/webt/xa/vx/5u/xavx5up_mbqc52btb-_7nwssgaa.png"></p><br>
<p>  ,   ,       ,    .    .      ?</p><br>
<p>   .  -     .      .     , ,   .      .    ,   ,  ,     .   ,       .     -  Postgres.</p><br>
<p>  ?   -  ,       : Â« , , id   ,        Â».     id.         .   ,  -       ,        ,      ,    .   .</p><br>
<p>        ,   -   .    ,    ,   .       , . .     -   ,      ,   .       PostgreSQL.</p><br>
<p><img src="https://habrastorage.org/webt/ff/5v/ir/ff5virwfhf3vlipk3m-d_paqfvg.png"></p><br>
<p>    ?     ?</p><br>
<p>    - , - , -  .  .      ,      ,    id.   id,     ,  .    ,        .    ,      .        . </p><br>
<p>        . -   , ,  .        ?    ,        .         . </p><br>
<p>      .        ,          . </p><br>
<p>    ,       :  ,  ,    .        Â«bloatÂ»,       . ,  2 MB,  300 MB?                 .</p><br>
<p><img src="https://habrastorage.org/webt/y5/sj/mu/y5sjmulskvpso8avoizedjlmspg.png"></p><br>
<p>     ? </p><br>
<ul>
<li>        150 .        ,       . </li>
<li>       .        ,     .      ,          ,    -     .     ,          ,      . </li>
<li>       .     ,     . </li>
<li>      ,        10   , 10    ,            10   , . .     .         20   , 10   .  ,          .    -  ,  , , ,   . </li>
<li> : Â«   ?Â»,           ,   . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/mu/8n/es/mu8ness1qpe1lcxbssbsvzahea4.png"></p><br>
<p>     ,  . </p><br>
<p>     ,  .  ,   -     ,  -  .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">pgstattuple</a>.   ,    ,     ,    . </p><br>
<p> ,     ,   .     .       .  â€“  VACUUM FULL.  ,   ,     . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Pg_repack</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">pgcompacttable</a> â€“      .        . </p><br>
<p>     ,   .        . ,    .    . </p><br>
<p> ,    , ,    ,   ,      :</p><br>
<ul>
<li>   .       -. <strong>     idle in transaction</strong>.  ,     , -      ,   . </li>
<li>  ,   ,        .    .    .     Â«Â» ,    . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/c5/ml/bb/c5mlbbr-awkevvdayxmrv_mo-o8.png"></p><br>
<p>      ,         ,       VACUUM FULLâ€™  .     production.</p><br>
<p>          .          . </p><br>
<p><img src="https://habrastorage.org/webt/mf/v7/lp/mfv7lpm5hb875bsiz9d3bhbfltw.png"></p><br>
<p>     ,      ,  ,              . ,      ,     .     ,       ,    ,     ,     .          .    , ,   .</p><br>
<p><img src="https://habrastorage.org/webt/x-/-v/zt/x--vztacibsriajurryybhx7x90.png"></p><br>
<p>    .   .    ,    ,    .     . </p><br>
<p> ,         </p><br>
<p><img src="https://habrastorage.org/webt/er/je/qy/erjeqyfmzmqt6mamwovpkdce-_i.png"></p><br>
<ul>
<li>      .  ,           :   ,    .     ,     -   ETL.     .         . </li>
<li> ,        . ,   ,  .    ,      ,    . </li>
<li> . </li>
<li>  .  . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/dt/20/wf/dt20wfy6x4wrt9r3pp8wiufxcvi.png"></p><br>
<p>    ?              .       -. </p><br>
<p>        .   .  ,      .  ,        ,   2 .    ,    .     . </p><br>
<p><img src="https://habrastorage.org/webt/jm/kx/bh/jmkxbhmxuqvkqdb6klcwnkbhkgq.png"></p><br>
<p>          .         ,   .    . </p><br>
<p><img src="https://habrastorage.org/webt/sp/qf/5i/spqf5iac8b7dka6dbsdgltikv40.png"></p><br>
<p>   ,            .      . </p><br>
<p>      ,   .   . </p><br>
<p>  â€“   .  ,      3 .    â€“ 3 .  ,         ,    . </p><br>
<p> ,      .  .       â€“ hot_standby_feedback.  . Hot_standby_feedback       .        .       .</p><br>
<p><img src="https://habrastorage.org/webt/8b/mb/dj/8bmbdjqpu-xvnqvvi-oo29dgttk.png"></p><br>
<p>         -?   -     .    ,      .   ,       -       -.   ,     ,    .        .            .  - . </p><br>
<p><img src="https://habrastorage.org/webt/4e/ib/ne/4eibnen11hx3m6prbe55bwsua9c.png"></p><br>
<p>     ,         .       .        .      ,   . </p><br>
<p><img src="https://habrastorage.org/webt/ob/hd/mz/obhdmztz6o_ks2_s5v47m3om9ki.png"></p><br>
<p>   ,    ,      ?</p><br>
<ul>
<li>   .        ,  ,            .     .  .  ,   Load Average  . </li>
<li>  ,        .   ,   .  ,  . </li>
<li>  .      raid.      .     .  ,  ,   . </li>
<li> : ,   .   . </li>
<li>  -      . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/1i/jz/8b/1ijz8bgp8qwrihslh52nmopyflk.png"></p><br>
<p>          .   .    .  ,         .             ,    ,    ,   . </p><br>
<p> .    -    -  .        -   .  , -,    ,    .      .      ,      .</p><br>
<p><img src="https://habrastorage.org/webt/eo/bh/bg/eobhbgp0qi84jmah2rgt4qi4k_y.png"></p><br>
<p>  ,      ,      .       . ,  ,  .        .       ,      . </p><br>
<p><img src="https://habrastorage.org/webt/vl/bl/97/vlbl97m63q5xbodozflngxns2va.png"></p><br>
<p>              - ,    . </p><br>
<p>    .  .   .    ,      . </p><br>
<ul>
<li>  hot_standby_feedback? ,        .        -     .    -     ,          . </li>
<li> max_standby_streaming_delay? ,   â€“  .         ,      -  ,    .      ,      .     , ,     -   .  ,    ,     â€“    ,              . </li>
<li>,      , ,     hot_standby_feedback  .      .    ,    .    .     ,     .       .  .       ,    . </li>
<li>          ,          .    streaming_delay.         .      ,     6 ,  .    . </li>
</ul><br>
<p>     :</p><br>
<ul>
<li>  .</li>
<li>    ,   . </li>
</ul><br>
<p>    .    . </p><br>
<p><img src="https://habrastorage.org/webt/pp/rt/v7/pprtv72jjqpv1h92ytkly6l2q8o.png"></p><br>
<p>    ,     . </p><br>
<p><img src="https://habrastorage.org/webt/50/ac/ws/50acwsegb4pnh0mnqhrhnkxpmfe.png"></p><br>
<ul>
<li>   .    .      .   ,       ,          ,       . </li>
<li>    . ,      ,       . , ,     ,         .       :       . </li>
<li>          . , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Liquibase</a>.    .      .  .  .     ,      .       .  , .  . </li>
<li>  ,  . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/3i/0p/zd/3i0pzdxv5jsip1tylx0ya4j3efq.png"></p><br>
<p>      .        ,    15 GB.       ,       ,      . </p><br>
<p><img src="https://habrastorage.org/webt/af/8h/55/af8h55v9-pmhl4cxxeal6knig3m.png"></p><br>
<p>          ,           ,    .         ,    . . .          5     ,        ,   7,5. </p><br>
<p><img src="https://habrastorage.org/webt/eg/vq/wp/egvqwpk4ywpu3p7vvavc9cf8j3i.png"></p><br>
<p>     . </p><br>
<p>  , :</p><br>
<ul>
<li>    . </li>
<li>    . </li>
<li>     ,  . </li>
<li>, ,       ,   ,    . </li>
</ul><br>
<p>   bloat,     . </p><br>
<p><img src="https://habrastorage.org/webt/yc/5g/0y/yc5g0y3mlnw53wtdmy4hcokdyfu.png"></p><br>
<p>  ,  ,     ,      .       . </p><br>
<p><img src="https://habrastorage.org/webt/zx/uq/pd/zxuqpdxaazk54i9bbjo2gyxavq4.png"></p><br>
<p>       ,   ,             .            7,5,   .       2 ,      1,5 , . .     .    â€“    .          . </p><br>
<p><img src="https://habrastorage.org/webt/ry/6a/6g/ry6a6g7_shhfpn9hrukkqgu1wza.png"></p><br>
<p>   ,     .    .      .</p><br>
<ul>
<li>     .     . </li>
<li>     .     DBA  ,     DBA.   .  ,       ,  ,     . </li>
<li>   ,   ,     ,    , . .   ,     :</li>
<li>  ,        . </li>
<li>         .    ? -,      .  ,     -     -. </li>
<li>     ,        ,          ,     . </li>
<li> ,        (     )  ,       .    â€“      . </li>
<li>         ,           ,    .   -  ,      . </li>
<li>       . </li>
</ul><br>
<p>      bloat     . </p><br>
<p>    . </p><br>
<p><img src="https://habrastorage.org/webt/g4/3-/be/g43-beor7ucrudazmduy_nhiaig.png"></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://github.com/dataegret/pg-utils/blob/master/sql/table_bloat.sql</a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://github.com/dataegret/pg-utils/blob/master/sql/table_bloat_approx.sql</a></p><br>
<p>      ,       . </p><br>
<p> ,   bloat,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">pgstattuple</a>.</p><br>
<p>    ,        .    .    . </p><br>
<ul>
<li>   ,        bloat  . </li>
<li>     ,     â€“  bloat   bloat  .     ,  bloat   Postgres  .     MVCC. </li>
<li> 20 % bloat â€“       . . .        . </li>
</ul><br>
<p>  ,    ,  , ,    . </p><br>
<p>  ,   bloat:</p><br>
<ul>
<li>       , . .        VACUUM FULL.             ,      .   VACUUM FULL?                .      .   ,    .          .  ,         :    ,    ,   .  VACUUM FULL     ,   .</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">pg_repack</a>.        VACUUM FULL,                .              ,     ,        ,   .          VACUUM FULL.      ,     ,     .      ,       -. </li>
<li>  â€“  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">pgcompacttable</a>.      ,       .    pgcompacttable  ,            .       ,    ,      ,     .       , . .       .         . </li>
</ul><br>
<p>  . </p><br>
<p><img src="https://habrastorage.org/webt/nf/-z/pi/nf-zpinx8zbhv1j-jh-59ve35pi.png"></p><br>
<p>    bloat       ,      :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://www.slideshare.net/alexius2Mb/where-is-the-space-postgres</a> â€“    .    ,     Postgres      .              bloat. </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">https://github.com/dataegret/pg-utils</a> â€“     ,           .        bloat. </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"></a>   ,     . </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">http://blog.dataegret.com/2Mb018/03/postgresql-bloatbusters.html</a> â€“    .         bloat       . </li>
</ul><br>
<p>       ,            ,      .     .   !</p><br>
<p></p><br>
<p><em>  !    ,    .     ? . .    ,        ,     -  .    -  joins.  -   ,   ,     - . . .    ,   .   ?    ,   ?    ?</em></p><br>
<p>   â€“      ,   DBA.</p><br>
<p><em> .</em></p><br>
<p> PostgreSQL   ,  pg_stat_activity,     .    ,     .</p><br>
<p><em>   5    ?</em></p><br>
<p> cron  .      ,    . . .     ,   .   ,    .    .</p><br>
<p><em>  ,   ?</em></p><br>
<p>  .    .      .</p><br>
<p><em>  !   pg_repack  .      , â€¦</em></p><br>
<p>   . </p><br>
<p>â€¦ <em>     .         ?</em></p><br>
<p>,     , . . pg_repack     ,  . ,  -    .     . </p><br>
<p><em>. .    - ?</em></p><br>
<p>       ,     . </p><br>
<p><em>  ,  VACUUM FULL?</em></p><br>
<p>VACUUM FULL,  ,    .      ,    .  pg_repack        .       ,    ,    . </p><br>
<p><em>!     .     ,     . . .  â€“    .       -  ?</em></p><br>
<p>. Postgres   .    .    ,     .   id ,    ,    .     ,     .  -      .      ,           .     . </p><br>
<p><em> .      .   . ,     .      .     -  ,         .</em> </p><br>
<p>,       .  Postgres     .     .  ,     ,    tos-.    : , json.     .          bloat, . .   .    . </p><br>
<p><em>  !        statement timeout?</em></p><br>
<p> .    .  . .     ,    ,     .     . . .      cron,  .      ,     .    ,    10 .         .      pg_stat_activity.</p><br>
<p><em>  !       .       ,    .  - exception,    rollback .    .      .   , .      ,    PostgreSQL     ,    ?</em></p><br>
<p>      ,      ,   ,   ORM,  .    .     auto commit on,    ,   .</p><br>
<p><em>. .     ?</em></p><br>
<p>   .    .  auto commit on.   .   ,  - .      Â«start transactionÂ»  Â«end transactionÂ»,      . </p><br>
<p><em>!   ! ,     ,  -      .  - ,    ?</em> </p><br>
<p>   -  . </p><br>
<p><em>, DBA   ,     . .</em></p><br>
<p>   ,     -   ,    . </p><br>
<p><em>    ?</em></p><br>
<p>    reserved space, . .        ,    ,    .     ,  .     â€“  ,        .   - ,     . </p><br>
<p><em>  ?</em></p><br>
<p>   .    ,    ,     ,  .      ,    ,    .    . </p><br>
<p><em>  !    . -,   ,  ,           ,    .       ,   .    ?</em></p><br>
<p>   . </p><br>
<p><em>    ?</em></p><br>
<p>   . , pg_rapack, pgcompacttable.   ,  .  VACUUM FULL   ,   , . .    . </p><br>
<p><em>  .   ,          .  ,   â€“  ,   â€“  .</em> </p><br>
<p>    ?    ,    .    .   ,  ?   -  .          ,     ,     ,         ,    .      ,      ,     ,       ,   .   PostgreSQL  ,    .     ,      ,      . </p><br>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®‰å¾·çƒˆï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ã€‚</font><font style="vertical-align: inherit;">æ‚¨åœ¨æ¼”ç¤ºè¿‡ç¨‹ä¸­æ˜¾ç¤ºçš„è¿™äº›ç²¾ç¾å›¾å½¢æ˜¯å·¥ä½œçš„ç»“æœï¼Œæ˜¯æŸç§å®ç”¨ç¨‹åºçš„ç»“æœå—ï¼Ÿ</font><font style="vertical-align: inherit;">æ˜¯ä»€ä¹ˆå»ºç«‹äº†å›¾è¡¨ï¼Ÿ</font></font></em></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Okometer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœåŠ¡</font><font style="vertical-align: inherit;">ã€‚</font></font></p><br>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯å•†ä¸šäº§å“å—ï¼Ÿ</font></font></em></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ç§å•†ä¸šäº§å“ã€‚</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN501022/index.html">â€œæˆ‘åœ¨æ²™æ¼ ä¸­â€ï¼šä¸ºä»€ä¹ˆè‡ªæˆ‘å­¤ç«‹å¯¹æˆ‘ä»¬æ„æˆä¸¥é‡å‹åŠ›ï¼Œè¿™ä¸€åˆ‡å¯¼è‡´äº†ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN501026/index.html">è¿œç¨‹é“¶è¡Œè¯†åˆ«ï¼šä»å¤æ‚åˆ°ç®€å•ï¼Œæˆ–ä»é“¶è¡Œå¼€å§‹ï¼Œä¸ºä»€ä¹ˆéœ€è¦ç”Ÿç‰©è¯†åˆ«ï¼Ÿ</a></li>
<li><a href="../zh-CN501030/index.html">ä»£ç åˆ†ææ¼”ç¤ºSecond Reality</a></li>
<li><a href="../zh-CN501032/index.html">æ¥è‡ªä¸­å›½é›¶ä»¶çš„å»‰ä»·æœåŠ¡å™¨ã€‚ç¬¬ä¸€éƒ¨åˆ†ï¼Œé“</a></li>
<li><a href="../zh-CN501034/index.html">IBMæ¯å‘¨ç ”è®¨ä¼š-2020å¹´5æœˆ</a></li>
<li><a href="../zh-CN501042/index.html">Likbezå…³äºåˆè§„æ€§ï¼šæˆ‘ä»¬äº†è§£ç›‘ç®¡æœºæ„åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸçš„è¦æ±‚</a></li>
<li><a href="../zh-CN501044/index.html">ĞĞµ Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚Ğµ Ğ»ÑĞ´ĞµĞ¹ Ğ·Ğ° Ğ¸Ğ´Ğ¸Ğ¾Ñ‚Ğ¾Ğ² Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞº Ñ Ğ¸Ğ½Ğ¶ĞµĞ½ĞµÑ€Ğ½Ñ‹Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑĞ¶ĞµÑ‡ÑŒ Ğ²Ñ‹ÑˆĞºÑƒ ÑĞ¾Ñ‚Ğ¾Ğ²Ğ¾Ğ¹ ÑĞ²ÑĞ·Ğ¸ (Ğ²Ğ¸Ğ´ĞµĞ¾)</a></li>
<li><a href="../zh-CN501046/index.html">å›´ç»•ç¨³å›ºçš„ä¼˜åŠ¿ï¼šC ++ Russia 2019 Piterä¼šè®®çš„åå¤§æŠ¥å‘Š</a></li>
<li><a href="../zh-CN501048/index.html">åœ¨OpenVPNä¸Šç»„ç»‡è¿œç¨‹å·¥ä½œSMBç»„ç»‡</a></li>
<li><a href="../zh-CN501050/index.html">å®‰è£…å¹¶æ¿€æ´»LabVIEWç¤¾åŒºç‰ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>