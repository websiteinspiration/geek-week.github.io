<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🅱️ 🔝 🤽🏽 P4プログラミング言語 💙 🎬 ⛔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="P4は、パケットルーティングルールをプログラムするために設計されたプログラミング言語です。 CやPythonなどの汎用言語とは異なり、P4はネットワーク固有の言語であり、ネットワークルーティング用に最適化された多数の構成要素を備えています。
 
 P4は、P4言語コンソーシアムと呼ばれる非営利組織に...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>P4プログラミング言語</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/fgts/blog/460439/"><div style="text-align:center;"><img width="670" height="330" src="https://habrastorage.org/webt/hb/w7/o-/hbw7o-cd3zovgayloqdt6cfirjg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4は、パケットルーティングルールをプログラムするために設計されたプログラミング言語です。 CやPythonなどの汎用言語とは異なり、P4はネットワーク固有の言語であり、ネットワークルーティング用に最適化された多数の構成要素を備えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4は、P4言語コンソーシアムと呼ばれる非営利組織によってライセンスおよびサポートされているオープンソース言語です。また、オープンソースネットワーキングプロジェクトにおける2つの最大の組織であるOpen Networking Foundation（ONF）とLinux Foundation（LF）によってもサポートされています。</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この言語は2013年に作成され、2014年に「プロトコルに依存しないパケットルーティングプロセッサプログラミング」というタイトルのSIGCOMM CCRドキュメントで説明されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4はその誕生以来、飛躍的に成長し、進化を遂げ、急速に、ネットワークアダプター、スイッチ、ルーターなどのネットワークデバイスによるパケット伝送を記述するための標準になりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「SDNはネットワーク業界を変革し、P4はSDNを次のレベルに引き上げ、ルーティングの分野でプログラマビリティを提供します」とOpen Networking FoundationのエグゼクティブディレクターであるGuru Parulkarは述べています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4言語は当初、Google、Intel、Microsoft Research、Barefoot、Princeton、Stanfordのエンジニアと研究者のグループによって作成されました。目標は単純でした。ソフトウェア開発者が1日で学習できる使いやすい言語を作成し、それを使用してネットワーク上でパケットが送信される方法を正確に説明しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初から、P4は目標に依存しないように設計されていました（つまり、P4で記述されたプログラムは、ASIC、FPGA、CPU、NPU、GPUなどのさまざまな目的で変更せずにコンパイルできます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、言語はプロトコルに依存しません（つまり、P4プログラムは既存の標準プロトコルを記述したり、新しいカスタムアドレス指定モードを示すために使用したりできます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
業界では、P4はプログラミングデバイスに使用されます。おそらく将来的には、インターネット-RFCおよびIEEE規格にもP4仕様が含まれるようになるでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4は、プログラマブルデバイスと固定機能デバイスの両方に使用できます。たとえば、SONiCオープンソーススイッチOSで使用されるスイッチアブストラクションインターフェース（SAI）APIのスイッチパイプラインの動作を正確に記録するために使用されます。 P4は、ONF Stratumプロジェクトでも使用され、さまざまな固定およびプログラマブルデバイス全体のスイッチング動作を記述します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スイッチとネットワークアダプターの動作を初めて説明すると、展開前にネットワーク全体の正確な実行可能モデルを作成できます。大規模なクラウドプロバイダーは、ソフトウェアを使用してネットワークを完全にテストおよびデバッグできます。これにより、高価な機器を必要とせずに、ラボの相互作用をテストする時間とコストを大幅に削減できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4を使用すると、ネットワーク機器ベンダーは、すべての製品にわたって共通の基本的なルーティング動作に依存できるため、テストインフラストラクチャの再利用が可能になり、管理ソフトウェアの開発が簡素化され、最終的に相互運用性が保証されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、P4を使用して、まったく新しいルーティング方法を記述するプログラムを作成できます。たとえば、P4はデータセンター、エンタープライズネットワーク、サービスプロバイダーのテレメトリや測定に広く使用されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
研究コミュニティも強化されています。いくつかの主要な学術ネットワークテクノロジー研究グループが、ロードバランシング、一貫したプロトコル、キーバリューキャッシングなど、P4プログラムに基づく興味深い新しいアプリケーションを公開しています。新しいプログラミングパラダイムが作成され、イノベーションがハードウェアからソフトウェアに移行しているため、予想外の、新しくて素晴らしいアイデアが数多く生まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発コミュニティは、コンパイラ、パイプライン、動作モデル、API、テスト環境、アプリケーションなどを含むコード開発に多大な貢献をしてきました。</font><font style="vertical-align: inherit;">Alibaba、AT＆T、Barefoot、Cisco、Fox Networks、Google、Intel、IXIA、Juniper Networks、Mellanox、Microsoft、Netcope、Netronome、VMware、Xilinx、ZTEなどの企業には専任の開発者がいます。</font><font style="vertical-align: inherit;">BUPT、コーネル、ハーバード、MIT、NCTU、プリンストン、スタンフォード、テクニオン、清華、UMass、USIなどの大学から。</font><font style="vertical-align: inherit;">CORD、FD.io、OpenDaylight、ONOS、OvS、SAI、Stratumを含むオープンソースプロジェクトは、P4が独立したコミュニティプロジェクトであることを強調しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的なP4コントローラーの生成：</font></font><br>
<br>
<div style="text-align:center;"><img width="602" height="409" src="https://habrastorage.org/webt/7q/07/am/7q07amo-jzmkmtiut50ptueiesu.png"></div><br>
<br>
<h2><font color="#1B469F"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションの見通し</font></font></font></h2><br>
<div style="text-align:center;"><img width="467" height="300" src="https://habrastorage.org/webt/eq/h0/e2/eqh0e289qu_lsq8-cgx_jprgwjw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この言語はルーティングアプリケーションを対象としているため、要件と設計オプションのリストは、汎用プログラミング言語とは異なります。</font><font style="vertical-align: inherit;">言語の主な機能は次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲット実装からの独立性。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用するプロトコルの独立性。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの再構成可能性。</font></font></li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲット実装からの独立</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
P4プログラムは、実装に依存しないように設計されています。つまり、汎用プロセッサ、FPGA、オンチップシステム、ネットワークプロセッサ、ASICなど、さまざまなタイプの実行マシン用にコンパイルできます。これらのさまざまなタイプのマシンはP4ターゲットと呼ばれ、P4ソースコードをターゲットスイッチモデルに変換するには、各ターゲットにコンパイラが必要です。コンパイラは、ターゲットデバイス、外部ソフトウェア、またはクラウドサービスに組み込むことができます。 P4プログラムの元のターゲットの多くは単純なパケット交換に使用されていたため、「ターゲットP4」の使用がより正確であっても、「P4スイッチ」という用語をよく耳にします。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用されるプロトコルの独立性</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4はプロトコルに依存しません。つまり、この言語には、IP、イーサネット、TCP、VxLAN、MPLSなどの一般的なプロトコルのサポートが組み込まれていません。代わりに、P4プログラマーは、プログラムで必要なプロトコルのヘッダー形式とフィールド名を記述します。これは、コンパイルされたプログラムとターゲットデバイスによって解釈および処理されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド再構成可能性</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プロトコルの独立性と抽象言語モデルにより、再構成可能-P4ターゲットは、システムの展開後にパケットの処理を変更できる必要があります。この機能は、従来、固定機能の集積回路ではなく、汎用プロセッサまたはネットワークプロセッサを介したルーティングに関連付けられています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特定のプロトコルのセットの最適化を妨げる可能性のある言語はありませんが、これらの最適化は言語の作成者には見えず、最終的にはシステムと目的の柔軟性、およびそれらの再構成可能性を低下させる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言語のこれらの特性は、もともとネットワークインフラストラクチャで広く使用されることを志向して、作成者によって設定されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、この言語は多くの企業で使用されています</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。1）ハイパースケールデータセンター。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
中国の会社Tencentは世界最大の投資会社であり、最大のベンチャーキャピタル会社の1つです。 Tencentの子会社は、中国と世界の他の国の両方で、さまざまなインターネットサービス、人工知能および電子娯楽の分野の開発など、ハイテクビジネスのさまざまな分野を専門としています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4とプログラマブルルーティングは、同社のネットワークアーキテクチャで使用される高度なテクノロジーです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googleはクリエーターの1人として、ネットワーク業界、特にデータセンターのアーキテクチャ設計の分野でP4が急速に導入されたことに誇りを持っています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）営利会社;</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goldman Sachsは、オープンソースコミュニティとの協力と共通の標準とソリューションの開発を利用して、ネットワークインフラストラクチャに革新をもたらし、顧客に最高のソリューションを提供しています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3）生産;</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ネットワーク業界全体は、通話転送動作を一意に定義するP4のような言語の恩恵を受けます。シスコでは、この言語を使用するように製品ラインを移行することも検討してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジュニパーネットワークスは、P4およびP4ランタイムを多数の製品に組み込んでおり、ジュニパーの組み込みプロセッサとそのプログラムコードへのプログラムによるアクセスを提供しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ruijie NetworksはP4の積極的なサポーターであり、P4がネットワークにもたらすメリットです。 P4を使用すると、企業は幅広い顧客にクラス最高のソリューションを作成して提供できます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4）通信プロバイダー;</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
AT＆TはP4の最初のサポーターの1人であり、P4を使用してネットワークで見たい動作を決定し、そのネットワークでP4プログラマブル転送デバイスを使用した最初の1人です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deutsche Telekomは、この言語を使用して、Access 4.0で主要なネットワーク機能のプロトタイプを作成しています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5）半導体産業;</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この言語により、ベアフットによってソフトウェア機能をネットワークルーティングプレーンに転送するための新しいパラダイムを実装することが可能になりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ザイリンクスはP4.orgの創設者の1人であり、P4言語の開発に積極的に参加して、SmartNICおよびNFV機器向けのFPGAベースのプログラマブルプラットフォームに実装し、最初のP4コンパイラの1つをリリースしました</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDNet設計の一部として。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6）ソフトウェア。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
VMwareは、P4が途方もないエネルギー、イノベーション、コミュニティを生み出し、ネットワークに意味のある必要な変革をもたらすと信じています。イノベーションの新しい波はインフラストラクチャの機能を拡張し、最新の製品に実装するソフトウェアアプローチによって推進されるため、VMwareはもともとこの業界の動きの一部でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、P4は目標に依存せず、プロトコルに依存しないプログラミング言語であり、パケットルーティングの動作をプログラムとして一意に決定するために業界や科学コミュニティで使用され、プログラムはいくつかの目的でコンパイルできます。</font><font style="vertical-align: inherit;">今日の目標には、ハードウェアとソフトウェアのスイッチ、ハイパーバイザースイッチ、NPU、GPU、FPGA、SmartNIC、およびASICが含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言語の主な機能は、アプリケーションの範囲を大幅に拡大し、ネットワークアーキテクチャでの迅速な実装を提供します。</font></font><br>
<br>
<h2><font color="#1B469F"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこから始めるか</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4はオープンソースプロジェクトです。すべての関連情報は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4.orgの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Webサイトで入手できます</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a><font style="vertical-align: inherit;">例</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">https://github.com/p4langに</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
リンクして</font><font style="vertical-align: inherit;">、サンプルのソースコードやトレーニング資料を入手できます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Plug</font></a><font style="vertical-align: inherit;"> for Eclipse for P4 support、しかし、私たちは</font><font style="vertical-align: inherit;">Barefootの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">P4 Studio</font></a><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">推奨でき</font><font style="vertical-align: inherit;">ます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img width="602" height="358" src="https://habrastorage.org/webt/b0/62/dv/b062dvii5juvwxcnulh4pfrxbj0.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カーネルの主な抽象概念を分析します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダーの定義</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -それらの助けを借りて、プロトコルヘッダーが定義されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヘッダーセットの定義：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージ形式の説明とヘッダーフィールド名</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">固定および可変許可フィールド</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、</font><b><font style="vertical-align: inherit;">パーサー</font></b><font style="vertical-align: inherit;">はヘッダーを解析するタスクです。</font><font style="vertical-align: inherit;">
次のパーサーの例では、マシンの最終状態の1つの初期状態から2つの最終状態の1つへの遷移を決定します。</font></font><br>
<br>
<code><b>header</b> Ethernet_h{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;48&gt;&nbsp;&nbsp;dstAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;48&gt;&nbsp;&nbsp;srcAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;16&gt;&nbsp;&nbsp;etherType;<br>
}<br>
</code><br>
<br>
<code><b>header</b> IPv4_h{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;4&gt;&nbsp;&nbsp;version;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;4&gt;&nbsp;&nbsp;ihl;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;8&gt;&nbsp;&nbsp;diffserv;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;16&gt;&nbsp;&nbsp;totalLen;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;16&gt;&nbsp;&nbsp;identification;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;3&gt;&nbsp;&nbsp;flags;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;13&gt;&nbsp;&nbsp;fragOffset;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;8&gt;&nbsp;&nbsp;ttl;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;8&gt;&nbsp;&nbsp;protocol;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;16&gt;&nbsp;&nbsp;hdrChecksum;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;32&gt;&nbsp;&nbsp;srcAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>bit</b>&lt;32&gt;&nbsp;&nbsp;dstAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>varbit</b>&lt;320&gt;&nbsp;&nbsp;options;<br>
}<br>
</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img width="400" height="200" src="https://habrastorage.org/webt/mm/hc/8w/mmhc8wkkyn1jkvlldtyszv6q8om.png"></div><br>
<br>
<code><b>parser</b> MyParser(){<br>
&nbsp;state&nbsp;&nbsp;start{transition parse_ethernet;}<br>
&nbsp;state&nbsp;&nbsp;parse_ethernet{<br>
&nbsp;&nbsp;&nbsp;&nbsp;packet.extract(hdr.ethernet);<br>
&nbsp;&nbsp;&nbsp;&nbsp;transition select(hdr.ethernet.etherType){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE_IPV4: parse_ipv4;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default: accept;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}…<br>
}<br>
</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ユーザーキーとアクションを関連付けるマシンの状態が含まれます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクション</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -パッケージの操作方法の説明。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テーブルには、パケットを転送するための状態（管理レベルで定義）が含まれており、Match-Actionのアクションの単位を説明し</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。パケットのマッチングは、以下によって実行されます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全に一致</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プレフィックス付きの最長一致（LPM）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリプルマッチング（マスキング）</font></font></li>
</ul><br>
<code><b>table</b> ipv4_lpm{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>reads</b>{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ipv4.dstAddr: lpm;<br>
&nbsp;&nbsp;&nbsp;&nbsp;} <b>actions</b> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;forward();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能なすべてのアクションは、事前にテーブルで定義する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクションはコードとデータで構成されています。データは管理レベルで到着します（例：IPアドレス/ポート番号）。特定のループレスプリミティブは、動作中に直接指定できますが、コマンドの数は予測可能でなければなりません。したがって、アクションにループや条件ステートメントを含めることはできません。</font><b><font style="vertical-align: inherit;">Match-Actionモジュール</font></b><font style="vertical-align: inherit;"> -検索キーを作成するアクション、テーブルを検索するアクション、アクションを実行するアクション。</font><font style="vertical-align: inherit;">
一般的なモジュールの例を図に示します。</font></font><br>
<br>
<code><b>action</b> ipv4_forward(macAddr_t dstAddr, egressSpec_t port){<br>
&nbsp;&nbsp;&nbsp;&nbsp;standard_metadata.egress_spec = port;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hdr.ethernet.srcAddr = hdr.ethernet.dstAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hdr.ethernet.dstAddr = dstAddr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hdr.ipv4.ttl = hdr.ipv4.ttl - 1;<br>
}<br>
</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img width="602" height="389" src="https://habrastorage.org/webt/wu/fs/xo/wufsxojasau1t4jrpnyljydudyg.png"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御フロー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Match-Actionモジュールの適用順序を示します。これは、高レベルのロジックとMatch-Actionシーケンスを定義する命令型プログラムです。制御フローはすべてのオブジェクトをリンクし、制御レベルを設定します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部オブジェクト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、明確に定義されたアーキテクチャとAPIを持つ特定のオブジェクトです。たとえば、チェックサム計算、レジスター、カウンター、カウンターなど。</font><b><font style="vertical-align: inherit;">メタデータ</font></b><font style="vertical-align: inherit;">は、各パッケージに関連付けられたデータ構造です。</font><font style="vertical-align: inherit;">
メタデータには2つのタイプがあります：</font><b><font style="vertical-align: inherit;">カスタムメタデータ（すべてのパッケージの空の構造）</font></b><font style="vertical-align: inherit;"> 
&nbsp;&nbsp;&nbsp;&nbsp;必要なすべてのものをここに置くことができます</font><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;。</font></font><br>
<br>
<code><b>extern</b> register{<br>
&nbsp;&nbsp;&nbsp;&nbsp;register(bit&lt;32&gt; size);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>void</b> read(out T result, in bit&lt;32&gt; index);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>void</b> write(in bit&lt;32&gt; index, in T value);<br>
}<br>
</code><br>
<br>
<code><b>extern</b> Checksum16{<br>
&nbsp;&nbsp;Checksum16();&nbsp;&nbsp;&nbsp;&nbsp;//constructor<br>
&nbsp;&nbsp;<b>void</b> clear();&nbsp;&nbsp;&nbsp;&nbsp;//prepare unit for computation<br>
&nbsp;&nbsp;<b>void</b> update(in T data);&nbsp;&nbsp;&nbsp;&nbsp;//add data to checksum<br>
&nbsp;&nbsp;<b>void</b> remove(in T data);&nbsp;&nbsp;/remove data from existing checksum<br>
&nbsp;&nbsp;<b>bit</b>&lt;16&gt; get(); //get the checksum for the data added since last clear<br>
}<br>
</code><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
&nbsp;&nbsp;<b><font style="vertical-align: inherit;"></font></b><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;パケットハッシュの保存など、独自の目的での使用に便利</font></font><br>
<br>
&nbsp;&nbsp;<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部メタデータ-アーキテクチャにより提供</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
&nbsp;&nbsp;&nbsp;&nbsp;入力ポート、出力ポートはここで定義されます</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;パケットがキューに入れられたときのタイムスタンプ、キューの深さ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;マルチキャストハッシュ/マルチキャストキュー</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;パケットの優先度、パケットの重要度</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;出力ポートの指定（例：出力キュー）</font></font><br>
<br>
<h2><font color="#1B469F"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンパイラP4</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P4コンパイラー（P4C）は以下を生成します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データプレーンランタイム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データプレーンのマシン状態制御用のAPI</font></font></li>
</ol><br>
<div style="text-align:center;"><img width="602" height="252" src="https://habrastorage.org/webt/py/6u/ub/py6uubwvudieedqy31iuica4w4u.png"></div><br>
<h2><font color="#1B469F"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4のソフトウェアスイッチの例</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースコードはリポジトリからダウンロードできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
p4lang / p4c-bm：bmv2のJSON構成を作成します</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
p4lang / bmv2：bmv2バージョン</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の</font><font style="vertical-align: inherit;">JSON構成を理解するソフトウェアスイッチ</font><font style="vertical-align: inherit;">この図は、プロジェクトのコンパイルスキームを示しています。</font></font><br>
<br>
<div style="text-align:center;"><img width="602" height="292" src="https://habrastorage.org/webt/um/ai/gi/umaigihuirmpetawiiozcyupug4.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テーブル、読み取りレジスタ、カウンタを使用した操作：</font><font style="vertical-align: inherit;">
ソースコードには、ソフトウェアスイッチAPIを便利に使用するためのsimple_switch_CLIプログラムが含まれています。</font><font style="vertical-align: inherit;">
これと他の例をリポジトリにダウンロードできます。</font></font><br>
<br>
<code><ul>
<li>table_set_default &lt;table name&gt; &lt;action name&gt; &lt;action parameters&gt;</li>
<li>table_add &lt;table name&gt; &lt;action name&gt; &lt;match fields&gt; =&gt; &lt;action <br>
parameters&gt; [priority]</li>
<li>table_delete &lt;table name&gt; &lt;entry handle&gt;</li>
</ul></code><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img width="511" height="286" src="https://habrastorage.org/webt/fu/xv/dd/fuxvdd-cq7g1h8nrhcz6qyj5iqw.png"></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インテルは初夏に、ハイパースケールクラウドのユーザーのニーズに迅速に対応することを目的として、ベアフットネットワークを買収する契約を結びました。 Navin Shenoy（Intel Corporationのデータセンターグループのエグゼクティブバイスプレジデント兼ゼネラルマネージャー）によれば、これによりIntelはデータセンターの顧客により大きなワークロードとより多くの機会を提供できるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の個人的な意見では、インテルはFPGAチップの製造におけるリーダーであり、優れたQuartus環境を備えていることを忘れないでください。したがって、ベアフットの会社はインテルの登場により製品ラインを拡大するだけでなく、QuartusとP4 StudioがToffinoとToffino 2のラインで深刻なアップデートと補充を受けることを期待できます。P4 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コミュニティの公式メンバーは会社です</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グループファクター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460425/index.html">地獄の寒さ、浮揚およびプラズマ：超伝導の過去、現在および未来</a></li>
<li><a href="../ja460431/index.html">Azure DevOpsで自動テストパイプラインを構築する</a></li>
<li><a href="../ja460433/index.html">モノのインターネットにおけるリスクと脅威</a></li>
<li><a href="../ja460435/index.html">ささいな喜び＃8：データベースを操作するためのささいな喜び</a></li>
<li><a href="../ja460437/index.html">テクニカルサポートバイクの出し方</a></li>
<li><a href="../ja460441/index.html">グレブ・ニッツマン：「私は、人々が放射性元素に含まれる金をまだ追っていなかった時代の終わりを見つけました」</a></li>
<li><a href="../ja460443/index.html">デザイナー対開発者：アプリケーション「My smart city」の作成の歴史について</a></li>
<li><a href="../ja460445/index.html">講座「デジタル信号処理の基礎」</a></li>
<li><a href="../ja460451/index.html">人間は全世界で使用するために彼の第三の耳を作った-芸術のために</a></li>
<li><a href="../ja460453/index.html">スマートプリンター。Octoprintの改善</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>