<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏽 🎎 🌱 1Cで外付け部品の技術を守らないことは可能ですか？または、1Cを使用して同僚を祝福する方法は？ 🧑🏽‍🤝‍🧑🏼 🏳️ 👩🏿‍🍳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="たとえば、彼女のお気に入りの1Cプログラムの助けを借りて、多かれ少なかれ独自の方法で私たちの主任会計士を祝福するという考えがありましたか？しかし、どうやって？
 
 いくつかの考えの後、アイデアは背景に使用するようになりました1C77-1C82の構成の従来のフォームのクライアント領域、または管理され...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>1Cで外付け部品の技術を守らないことは可能ですか？または、1Cを使用して同僚を祝福する方法は？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466713/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、彼女のお気に入りの1Cプログラムの助けを借りて、多かれ少なかれ独自の方法で私たちの主任会計士を祝福するという考えがありましたか？</font><font style="vertical-align: inherit;">しかし、どうやって？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかの考えの後、アイデアは背景に使用するようになりました1C77-1C82の構成の従来のフォームのクライアント領域、または管理されたフォーム1C82の外部ウィンドウ、およびすべてのケースで1C83の背景イメージの背景画像。</font><font style="vertical-align: inherit;">その上で、図に示すように、目的のメッセージを表示し、お祝いビデオへのリンクを提供します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a77/0bd/055/a770bd055ca43fdb5ad8d6f1f124253b.jpg" alt="1Cでおめでとう"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1-結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかに、このアイデアは新しいものではありません。したがって、2011年に、</font><b><font style="vertical-align: inherit;">Alex、</font></b><b><i><font style="vertical-align: inherit;">別名ALF</font></i></b><b><font style="vertical-align: inherit;">によってFormEx.dllに</font></b><font style="vertical-align: inherit;">基づいて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同様のソリューション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が提案さ</font><font style="vertical-align: inherit;">れ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました</font></font><i><font style="vertical-align: inherit;"></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。そして</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これを達成する方法についての</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">質問</font><font style="vertical-align: inherit;">が2008年に再度行われました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
かつて、このコンポーネントを使用して1C77の背景画像をロードしました。しかし、大きなbmpファイル（および他のファイルは使用できません）の読み込みが遅いため（タイルが配置された小さな画像が使用されたため）、必要な画像のみをダウンロードする独自の外部コンポーネント（VK）を作成する必要がありました。実験のためのテストの基盤となるものは他に何ですか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなコンポーネントが作成されました（また、必要に応じてタイリングを使用して、bmpファイルのみ）。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinAPI LoadImage（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数がそこで使用されました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このdllはFormEx.dllと競合しませんでした。シンプルで十分な速度があり、長い間使用されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらはすべて素晴らしいものでしたが、その機能を拡張するときが来たので、ここでは別のアプローチが必要でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、マルチメディアファイルの作成に関する問題については取り上げません。</font><font style="vertical-align: inherit;">これは私たちの専門ではありません。</font><font style="vertical-align: inherit;">私たちは、1Cの外部コンポーネントのプログラミングの一部のニュアンスにのみ制限しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C77</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1Cプラットフォームのバージョンは異なる場合があるため、いくつかの解決策が考えられます。私たちの場合、これらは1C77の構成でした（図1）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8b4/611/4ad/8b46114ad1ae83e57667cc4bb84aae7e.jpg" alt="図。 1. 1C77のテスト構成のお祝いイメージ"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 1. 1C77のテスト構成のお祝いイメージ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにあるビデオは独自のものですが、その作成のアイデアは</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「特別なケース」というニックネームでアンナシャヤノワ</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から集められたもの</font><font style="vertical-align: inherit;">です。この女の子は才能があり、真似することができますが、スタイルを完全に繰り返すことはほとんど不可能です。この場合、私は少なくとも創造性のある要素が欲しかっただけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同僚の1人がすでに他の人のお祝いを見るのに飽きている場合は、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alt + I</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」で</font><font style="vertical-align: inherit;">画像に負荷をかけることができます</font><font style="vertical-align: inherit;">（図2-3）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/01a/8c1/200/01a8c120008b72dd648b7c8697298d65.jpg" alt="図。 2.「ファイル/背景を選択」メニューまたは「Alt + I」で別の背景画像を選択する"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 2. [ファイル/背景の選択]メニューまたは[Alt + I]で別の背景画像を選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alt + L</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」で</font><font style="vertical-align: inherit;">使用されるモジュールに関する情報を確認します</font><font style="vertical-align: inherit;">（図3）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/499/499/f23/499499f23ec33734bd6a5068f5d493b8.jpg" alt="図。 3.オーバーロードされた背景画像とプログラムに関する情報（「ヘルプ/ LionExt32.dllモジュールについて」または「Alt + L」）"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">3.オーバーロードされた背景画像とプログラムに関する情報（ "ヘルプ/ LionExt32.dllモジュールについて"または "Alt + L"）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C82従来型</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然のことながら、大多数は現在、G8（1C8x）を指向しています。</font><font style="vertical-align: inherit;">ただし、1Cでの背景画像の操作は、バージョン8.2以下の通常のフォームでのみ可能であり、「デスクトップ」モードで開始する処理を使用しない場合、背景が完全に重なるだけです（図4）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/390/123/bfd/390123bfd2ef88bfbc108dbe44c70835.jpg" alt="図。 4.通常のフォーム1C82のテスト構成のお祝いイメージ"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">4.通常のフォーム1C82のテスト構成のお祝いイメージ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図へのリンクに注意してください。</font><font style="vertical-align: inherit;">4はビデオではないことを示します。</font><font style="vertical-align: inherit;">それらはテストのためだけに示されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常の形式では、1C82はメニューにアクセスするための標準的な方法を提供しません。これは、「7」のように体系的ではなく、「独自」です（システムは作成できますが、2つのメインメニューが必要なのはなぜですか？）。</font><font style="vertical-align: inherit;">ただし、ホットキーは使用できます。</font><font style="vertical-align: inherit;">したがって、コンポーネントで「Alt + I」を押すと、図2のようにダイアログが呼び出され、別の背景が読み込まれます（図5）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c3f/535/deb/c3f535deb522e2ae7ad8937ce31b1188.jpg" alt="図。 5.「厚い」1C82フォームのオーバーロードされた背景画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">5.「厚い」1C82フォームのオーバーロードされた背景画像。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様に、図のように「Alt + L」キーを押すと、モジュールに関する情報を取得できます。</font><font style="vertical-align: inherit;">3。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C82管理されたフォーム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1C82のマネージフォームの場合、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V8FormElement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">など、7番目の入れ子レベルで必要なウィンドウを見つけてそこに描画できますが</font><font style="vertical-align: inherit;">、どういうわけか興味深いものではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちにとって、これらの考慮事項から、個々のケースを処理するよりも、お祝いのメッセージ（図6）を含む外部ウィンドウを作成する方が簡単であることがわかります。ウィンドウ自体は、より正確には、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + F4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alt + F4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」、または「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十字</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」を</font><font style="vertical-align: inherit;">クリックして</font><font style="vertical-align: inherit;">閉じることができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/790/cd9/79d/790cd979df8a4d97ff5488c50fa4bd6c.jpg" alt="図。 6.管理されたフォーム1C82のテスト構成のお祝いイメージ"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 6.管理されたフォーム1C82のテスト構成のお祝いイメージ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、最小化されたウィンドウ（図7）を再び拡大できます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/66c/1a7/c7f/66c1a7c7f725404604318cdcde3a9915.jpg" alt="図。 7.管理されたフォーム1C82の外部ウィンドウの最小化された画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 7.管理されたフォーム1C82の外部ウィンドウの最小化された画像。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
外部ウィンドウの寸法と相対位置は変更できます。ここではすべて通常どおりです（図6と図10の外部ウィンドウの拡大画像を参照）。</font><font style="vertical-align: inherit;">ホットキーは、外部ウィンドウがアクティブな場合にのみ機能することに注意してください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C83従来型</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1C83では子ウィンドウがなくなったため、dllのバージョン1Cの基準として使用できます。</font><font style="vertical-align: inherit;">さらに、「厚い」フォームはフレームウィンドウ（図8）であり、管理されたフォームはフレームなし（図9）です。</font><font style="vertical-align: inherit;">つまり、フレームでないものはすべて再描画できます。</font><font style="vertical-align: inherit;">フレームはシステム要素としてのみ再描画することもできます。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><img src="https://habrastorage.org/getpro/habr/post_images/f9c/35e/0da/f9c35e0da01025306525d14f700d22a4.jpg" alt="図。 8.「厚い」フォーム1C83のフレームウィンドウ"></th>
<th><img src="https://habrastorage.org/getpro/habr/post_images/962/5f9/e7c/9625f9e7c28fed4c9226ee73d8126ed8.jpg" alt="図。 9.管理されたフォーム1C83のフレームレスウィンドウ"></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">8.「厚い」フォーム1C83のフレームウィンドウ。</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">9.管理されたフォーム1C83のフレームレスウィンドウ。</font></font></th>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここでは、ダイナミックライブラリを使用して、テストウィンドウを作成し、メインの1Cウィンドウに従属させました。</font><font style="vertical-align: inherit;">図に動作の違いが見られます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C83管理されたフォーム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1C83の場合、管理されたフォーム1C82の場合と同様に、背景ではなく別のウィンドウでお祝いを描きます。そのプロトタイプを図1に示します。</font><font style="vertical-align: inherit;">8-9。</font><font style="vertical-align: inherit;">結果として、目的のコンポーネント（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LionExt32.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LionExt64.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）は次の結果をもたらします（図10-12）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/104/cf1/f10/104cf1f10c6ae652d24edea7082c7e6c.jpg" alt="図。 10.従来のフォーム1C83の外部ウィンドウの背景画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">10.通常のフォーム1C83の外部ウィンドウの背景画像。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/56a/03f/fc7/56a03ffc7fe1f2bfee6358ecb81af9fa.jpg" alt="図。 11.管理対象フォーム1C83、リリース14、64ビットバージョンの外部ウィンドウの背景画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">11.マネージフォーム1C83、リリース14、64ビットバージョンの外部ウィンドウの背景画像。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/05e/12f/71c/05e12f71ccfb9212b96bc3db92630869.jpg" alt="図。 12.管理対象フォーム1C83、リリース15、64ビットバージョンの外部ウィンドウの背景画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。</font><font style="vertical-align: inherit;">12.管理対象フォーム1C83、リリース15、64ビットバージョンの外部ウィンドウの背景画像。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予備調査結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコンポーネントは実際に実際に使用され（図1）、主任会計士は満足し、すべてが素晴らしかった。その過程で、ユーザーは自分の背景画像（この場合は「7」）を選択することを好むことがわかりました。 G8の場合、私たちのコンポーネントは将来に備えて調整されていますが、デモバージョンと見なす必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでの関心は、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このコンポーネントが1Cから外部コンポーネントを作成するテクノロジーに準拠する必要がないことでした。</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。おそらく、その機能を拡張するために追加のアイデアが生まれるでしょう。たとえば、完全にサポートされている構成の場合、特別な必要なしに1Cコードを変更する必要はありません。この場合、外部の任意のdllをアドレス空間1Cにロードするオプションを提供できます。しかし、これは別の記事のトピックです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
技術革新のうち、ロックは1Cプラットフォームでコンポーネントをアンロードするために使用されていました（VK形式に準拠していないため）。また、</font><font style="vertical-align: inherit;">オペレーティングシステムの</font><b><font style="vertical-align: inherit;">ウィンドウ</font></b><font style="vertical-align: inherit;">がそのようなメニュー従属ウィンドウの作成をブロック</font><font style="vertical-align: inherit;">するため、子ウィンドウ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のローカルメニュー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を割り当てる別のトリックも許可さ</font><font style="vertical-align: inherit;">れてい</font><font style="vertical-align: inherit;">ます。したがって、ローカルメニューは同じ</font><b><font style="vertical-align: inherit;">MDIの</font></b><font style="vertical-align: inherit;">どこにも表示されません。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（マルチドキュメントインターフェース）。彼は、コマンドパネル、ツールバー、およびコンテキストメニューに置き換えられました。ウィンドウを更新する瞬間はまだあります。時にはそれは、そのどちらも起こる</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateWindow（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidateRect（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕事を適切。しかし、この場合のいくつかの機能は成功しています。</font></font><br>
<br>
<pre><code class="cpp hljs">ShowWindow(hWnd, SW_HIDE);<font></font>
ShowWindow(hWnd, SW_SHOW);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、1C77のFormEx.dllなど、他のコンポーネントと競合する可能性があることにも注意してください。この場合、最後にロードする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、バージョン1C-8.3.14以降で構成を作成すると、コンポーネントが通常の方法でロードされないことがわかります。ただし、データベースが1Cの以前のバージョンで作成され、最新バージョンで開いている場合は、VKのロードに問題はありません。これは、外部ブートローダーを作成する必要があることを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロジェクトは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinAPI GDI +</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブシステムを使用します</font><font style="vertical-align: inherit;">。これを使用して、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bmp、jpg、gif、png、tif</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など</font><font style="vertical-align: inherit;">のさまざまな形式の画像を表示できます</font><font style="vertical-align: inherit;">。同じ順序で、コンポーネントは最初に使用可能な</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をロードしようとします</font><b><font style="vertical-align: inherit;">。*</font></b><font style="vertical-align: inherit;">ローカルディレクトリから</font><font style="vertical-align: inherit;">ファイル</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在の構成の</font><b><font style="vertical-align: inherit;">写真</font></b><font style="vertical-align: inherit;">。これらのファイルが見つからない場合は、コンポーネントリソースの単純な背景画像が使用されます。図では図13は、64ビット1C83、リリース15の通常のフォームのこの背景画像を示しています。変更のために、スラングの外部ウィンドウが拡大され、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">化された</font><b><font style="vertical-align: inherit;">Main1.png</font></b><font style="vertical-align: inherit;">ファイルからの別の画像がその背景に追加されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/71c/80a/48a/71c80a48a18236e495a1d62b0f316e11.jpg" alt="図。 13.通常のフォーム64ビット1C83、リリース15のデフォルトの壁紙"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 13.通常の形式の64ビット1C83、リリース15のデフォルトの背景画像。さらに、Main1.pngファイルから別の画像が追加され、「タイリング」されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なるビットモードでのコンポーネントの動作の違いは観察されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、コンポーネントがメインの1CウィンドウとそのMDIクライアントをサブクラス化していることにも注意してください。</font><font style="vertical-align: inherit;">これは明らかに、最後にロードされたとき（1C77）にFormEx.dllとの競合の原因となります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2-テクニカル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接プロジェクト自体は次のリンクで見つけることができます：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C77のテスト構成</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C82のテスト構成</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C83のテスト構成</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS VS C ++、vのプロジェクト </font><font style="vertical-align: inherit;">十三</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プロジェクト</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、構成ファイル</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">文字列「</font><b><font style="vertical-align: inherit;">v120</font></b><font style="vertical-align: inherit;">」が「</font><b><font style="vertical-align: inherit;">v100</font></b><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">に置き換えられ</font><font style="vertical-align: inherit;">、「</font><b><font style="vertical-align: inherit;">ToolsVersion =「12.0</font></b><font style="vertical-align: inherit;">」が「</font><b><font style="vertical-align: inherit;">ToolsVersion =「4.0</font></b><font style="vertical-align: inherit;">」」に</font><b><font style="vertical-align: inherit;">置き換え</font></b><font style="vertical-align: inherit;">られれば、バージョン</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単に適合</font><font style="vertical-align: inherit;">できます</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">1C</font></b><font style="vertical-align: inherit;"> 
の</font><b><font style="vertical-align: inherit;">32</font></b><font style="vertical-align: inherit;">ビット</font><font style="vertical-align: inherit;">バージョン</font><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">64</font></b><font style="vertical-align: inherit;">ビットバージョン</font><font style="vertical-align: inherit;">のコード</font><font style="vertical-align: inherit;">は同じで、同時にコンパイルできます。</font><font style="vertical-align: inherit;">
バージョン1C77は外部コンポーネントでゼロ以外の関数</font><b><font style="vertical-align: inherit;">ハンドルGetMenu（）</font></b><font style="vertical-align: inherit;">によって決定され、バージョン1C83は</font><font style="vertical-align: inherit;">メインウィンドウに子ウィンドウが存在しないことによって決定され、そのハンドルは</font><b><font style="vertical-align: inherit;">GetForegroundWindow（）</font></b><font style="vertical-align: inherit;">関数によって決定されます</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C用の外部コンポーネントを作成する技術について</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1C社のITSディスクとインターネットでは、VCの作成と対応するテンプレートに関する情報をさまざまなプログラミング言語で簡単に見つけることができます。しかし、1C77の時代には、これらのパターンは「すべての人だけではない」を満たしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特に1C77で広く使用されているコンポーネントを見ると、それらの作成者が設計の機能を拡張するために特別なプログラミング手法を使用していることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく最初のそのような外部コンポーネントの1つは、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「1C用のレインボーアドイン2000：エンタープライズ7.7」でした。</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。おそらくここで最も重要なのは、公式のVKテクノロジーが許可したものよりも「7つ」の腸への浸透が深かったことですが、VKフォーマットに従っています。これは、他の広く知られているプロジェクトで使用されている1C77ライブラリファイルのヘッダー（* .h-files）を受け取ったため、おそらく非標準的な方法で実現されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadExternalComponent（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConnectExternalComponent（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの1C関数を</font><font style="vertical-align: inherit;">使用すると、独自のアドレス空間に</font><b><font style="vertical-align: inherit;">外部DLL</font></b><font style="vertical-align: inherit;">を実装できます。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（まず第一に、VCテクノロジーのフォーマットを満たす）、ユーザープログラムが誘惑に屈して、それらから隠されている他のプロシージャやターゲットプラットフォームの他のオブジェクトにアクセスしようとしないのはなぜですか？このアプローチは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rainbow.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントによって成功裏に実証されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、コンポーネント1Cバージョン7.7の他の作成者が同様のメカニズムを採用しました。特に注意が必要なのは、「7つの」</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C ++</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のコンポーネントであり、</font><b><font style="vertical-align: inherit;">Dll</font></b><font style="vertical-align: inherit;">と、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FormEx.dllの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特殊なケースです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、1C77の外部コンポーネントの設計への重要なアプローチはそこで終わりませんでした。どうやら、誰かが言ったはずです。「なぜ鍛冶屋が必要なのですか？鍛冶屋はいらない！」ここで、「鍛冶屋」とは、MicroSoftのCOMテクノロジーを意味し、ある意味では、「7」のVKテクノロジーがそれに続きました。いいえ、まあ、本当に、VKを直接ダウンロードする場合、なぜレジストリが必要なのですか？これは、インターネットで動作するWebブラウザーには意味がありますが、ローカル操作の場合、レジストリの使用は明らかに冗長です。少なくとも、これは前提条件であってはなりません。さらに、レジストリを編集するには、管理者権限が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1Cがこのテクノロジーを非常に気に入っていたことに注意してください（少なくとも1CをLinuxに移植するまで）。私たちは彼女をかなりかっこよく扱います。 COMはActiveXコンポーネントを使用するのに便利ですが、後者はもともとインターネット用に開発されたものであるため、これは当然のことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、最新バージョンでは、1Cが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブAPI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジーを使用する機能を追加した</font><font style="vertical-align: inherit;">ため、レジストリの必要がなくなりました。原則として、これは私たちが必要とするものですが、このテクノロジーは「7」には適用できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、ボイラープレートテンプレートコードVKの束を使用したくない場合は、比較的単純なタスクが発生することがあります。外部コンポーネントの側からのみ1Cを使用することをお勧めします。</font><font style="vertical-align: inherit;">たとえば、私たちのケースでは、クライアント領域、または必要に応じて別のウィンドウでの構成1Cでのお祝いイメージのデモンストレーション。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言い換えれば、1CとVKの間で直接データを交換する予定がない場合、1Cの外部コンポーネントのより単純でより汎用的なバージョンに非常に満足します。</font><font style="vertical-align: inherit;">ここでは、ボイラープレートコードがないため、シンプルさが実現されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1CのVKを作成するための代替技術</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VK for 1Cは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMサーバーの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特殊なケースであるため</font><font style="vertical-align: inherit;">（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブAPI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジーの前</font><font style="vertical-align: inherit;">）、「COM-いいえ！」と言ったVK開発者がいました。特に目立つのは、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アレクサンダー・オレフコフ</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によるこの方向の活動</font><b><i><font style="vertical-align: inherit;">です</font></i></b><font style="vertical-align: inherit;">。そのコンポーネント「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1sqlite.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」、「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TurboMD.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」、およびおそらく他の</font><font style="vertical-align: inherit;">コンポーネント</font><font style="vertical-align: inherit;">は、「完全に」という言葉からCOMを使用しません。また、このパスに沿ってコンポーネント</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yoksel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（« </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SpreadSheet.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> »）を</font><font style="vertical-align: inherit;">開発します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、1C77のVKローダーはこれらのコンポーネントをどのようにロードしますか？結局、彼らはそこにある種のCOMを真似ようとさえしません。そして実際、もし私たちが愚かにも</font><b><font style="vertical-align: inherit;">LoadExternalComponent（）</font></b><font style="vertical-align: inherit;">関数に</font><b><font style="vertical-align: inherit;">入れよ</font></b><font style="vertical-align: inherit;">うとした場合</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS VC ++の</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターなどによって生成されたいくつかの標準DLL </font><font style="vertical-align: inherit;">は、困惑するのを待っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「7」では、次のようなメッセージが表示されます。</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;フルパス\コンポーネント名&gt; .dllコンポーネントからオブジェクトを作成中にエラーが発生しました（CLSIDがありません）</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「8」メッセージの「シック」32ビットクライアントでも同様です。</font><font style="vertical-align: inherit;">同じDLLは同様の悪態を引き起こします（図15）。</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストメソッドの呼び出し中にエラーが発生しました（Load ExternalComponent）：外部コンポーネントのロード中にエラーが発生しました</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでも、言及されたライブラリはこの問題をどのように解決しますか？</font><font style="vertical-align: inherit;">OrefkovおよびYokselプログラムのテキストを調査すると、最終的</font><font style="vertical-align: inherit;">に、リソースファイル（* .rcまたは* .rc2）</font><font style="vertical-align: inherit;">の次の「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魔法の行</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">は「責任がある」という結論に達し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="plaintext hljs">STRINGTABLE DISCARDABLE <font></font>
BEGIN<font></font>
    100 "\0sd"  // 1sqlite.dll<font></font>
    100 "\0tmd"  // TurboMD.dll<font></font>
    100  "\0f"  // SpreadSheet.dll<font></font>
END</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それら。</font><font style="vertical-align: inherit;">必ず、プログラムリソースには、識別子が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、最初の文字がゼロである文字列値</font><font style="vertical-align: inherit;">がある行</font><font style="vertical-align: inherit;">があります。</font><font style="vertical-align: inherit;">このような行の変形を試すことができますが、文字列「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ 0L</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">で</font><b><font style="vertical-align: inherit;">十分</font></b><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">したがって、リソースファイルを作成し、次のような行を記述します。</font></font><br>
<br>
<pre><code class="plaintext hljs">STRINGTABLE DISCARDABLE <font></font>
BEGIN<font></font>
    100 "\0L"  //    1     !<font></font>
END</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルをMS C ++ウィザードによって生成された最も単純なdllプロジェクトに接続し、コードを追加します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">BOOL APIENTRY <span class="hljs-title">DllMain</span><span class="hljs-params">(HANDLE hModule, DWORD dwReason, LPVOID lpReserved)</span>  </span>{
    <span class="hljs-keyword">switch</span>(dwReason) {
        <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:<font></font>
            MessageBox(<span class="hljs-literal">NULL</span>, <span class="hljs-string">",  DllMain()!"</span>, <span class="hljs-string">""</span>, MB_OK);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:
            <span class="hljs-keyword">break</span>;<font></font>
    }  <span class="hljs-comment">// switch(dwReason)</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> TRUE;<font></font>
}  <span class="hljs-comment">// DllMain()</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
観察します（図14）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/715/a71/7f7/715a717f7ee778dd219e79e5fbd43e97.jpg" alt="図。 14. 1C82で最も単純な「VK」の使用"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 14. 1C82で最も単純な「VK」を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リソースファイルに「マジックライン」がなければ、DLLはMessageBoxを表示した後、すぐに1C側から呪いでアンロードします（図15）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a98/cec/432/a98cec4326033180917940aa248dbc96.jpg" alt="図。 15. 1C82での通常のDLLの読み込みエラー"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図。 15. 1C82での通常のDLLの読み込みエラー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、これらの行は実際には外部1Cコンポーネントのローダーに魔法のような効果をもたらします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のように、「魔法の線」は彼の古い記事で</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexei Fedorov（ALF）</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって記述されて</font><font style="vertical-align: inherit;">いたようですが、それへのリンクはもう利用できず、著者はその再出版の要点を見ていません。さらに、</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アレクサンドル・オレフコフ</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はそれらを最も集中的</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">使用しました</font><font style="vertical-align: inherit;">、そして、明らかに、彼の提出から、著者は</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヨクセルでした</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。したがって、私たちはについて話します</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フェドロフ・オレフコフの「魔法の」ライン</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。それらの意味は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Load ExternalComponent（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数による非標準（1Cの観点から）dllファイルのアンロードをブロックすること</font><font style="vertical-align: inherit;">です。さらに、ご覧のとおり、この手法は1C77だけでなく、「厚い」1C82形式でも機能します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、マネージフォーム1C82およびすべてのバージョンの1C83では、この機能は既に完全にブロックされています（別のローダーが表示されました-外部コンポーネントの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、1Cの最新バージョンでは、Fedorov-Orefkovの「魔法」のラインに対する他の単純な代替手段を探す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、そのような代替案は簡単に提供できます。ポイントは簡単です。 1Cローダーは、指定されたプロトコルを使用してコンポーネントにアクセスしようとしたときに例外をスローした場合、たとえばコンポーネントのバージョンを要求した場合に、「間違った」コンポーネントをアンロードします。当然のことながら、非標準のdllをアンロードするための基礎となる、この種のものはありません。ただし、オペレーティングシステムがこのダイナミックライブラリをアンロードするための1Cの要件は、このVKがまだどこかで使用されている場合、システムによって無視できます。削除自体の代わりに、システムは目的のモジュールの使用カウンタを減らすだけです。そして、このカウンターがリセットされる前に、物理的に削除しないでください。したがって、私たちの仕事は、このカウンターを人為的に増やすことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL_THREAD_ATTACH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションで</font><font style="vertical-align: inherit;">DLL関数WinAPI </font><b><font style="vertical-align: inherit;">LoadLibrary（）を</font></b><font style="vertical-align: inherit;">再度呼び出します。</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">BOOL APIENTRY <span class="hljs-title">DllMain</span><span class="hljs-params">(HANDLE hModule, DWORD dwReason, LPVOID lpReserved)</span>  </span>{
    <span class="hljs-keyword">switch</span>(dwReason) {
        <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH: {<font></font>
             WCHAR szDllName[_MAX_PATH] = {<span class="hljs-number">0</span>};<font></font>
<font></font>
             <span class="hljs-comment">//     dll</span><font></font>
             GetModuleFileName(hModule, szDllName, _MAX_PATH);<font></font>
             <span class="hljs-comment">//MessageBox(NULL, szDllName, L"Info", MB_OK);</span><font></font>
<font></font>
             <span class="hljs-comment">//    dll (     183), </span>
             <span class="hljs-comment">//      DLL_PROCESS_ATTACH</span><font></font>
             HMODULE hDll = LoadLibrary(szDllName);<font></font>
  <font></font>
            <span class="hljs-keyword">break</span>;<font></font>
        }  <span class="hljs-comment">// case DLL_PROCESS_ATTACH</span>
        <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:
            <span class="hljs-keyword">break</span>;<font></font>
    }  <span class="hljs-comment">// switch(dwReason)</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> TRUE;<font></font>
}  <span class="hljs-comment">// DllMain()</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべて！問題は解決されました。同じ動的ライブラリを呼び出すと、使用カウンタが1つ増加し、アンロード（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL_THREAD_DETACH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションへの予備</font><b><font style="vertical-align: inherit;">エントリ</font></b><font style="vertical-align: inherit;">を含む</font><font style="vertical-align: inherit;">）が1つ減少します。合計は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2-1 = 1&gt; 0なので</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、オペレーティングシステムはdllをアンロードしません。さらに、重要なのは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL_PROCESS_ATTACH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションの再初期化が</font><font style="vertical-align: inherit;">発生しないことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、このことから、1Cが最新バージョンで同様のトリックをどのように処理できるかがわかります（そして、明らかに、1C-8.3.14以降で作成された構成ではすでにこれを行っています）。</font><font style="vertical-align: inherit;">初期化セクション</font><b><font style="vertical-align: inherit;">DLL_PROCESS_ATTACHの</font></b><font style="vertical-align: inherit;">実行をブロックするパラメーターを指定して</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadLibraryEx（）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用できます。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、その後、必要なエクスポートされた関数をすぐに呼び出します。そして実際、ネイティブAPIのVKサンプルのコードを見ると、VK形式では空でなければならないため、初期化コードを呼び出す必要がないことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COMテクノロジの使用例については、初期化セクション</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL_PROCESS_ATTACHの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行</font><font style="vertical-align: inherit;">が必要である</font><font style="vertical-align: inherit;">ことは明らかです</font><font style="vertical-align: inherit;">。したがって、1Cの新バージョンではなく、より正確には、1C-8.3.13以下で行われた構成では、1Cローダーが適しています。</font></font><br>
<br>
<pre><code class="plaintext hljs">(, , .COM);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、デフォルトで暗黙的に指定されているため、最後のパラメーターを削除できます。同時に、それらはより高いバージョンで正常に開くことができます。バージョン1C83では、以前のブートローダー</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadExternalComponent（コンポーネントアドレス）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はもはや適していません（それぞれ、Fedorov-Orefkovの「マジックライン」は機能しません）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的なケースでは、すでに述べたように、外部ブートローダーを使用することで問題を解決できます。または、1Cの外部コンポーネントの技術をある程度観察することは、かなり自然なことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ビット深度が異なる1Cのファイルバージョンで行った実験にも注意してください。コンポーネントをダウンロードするには、構成の「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同期呼び出し使用モード</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」プロパティ</font><font style="vertical-align: inherit;">を「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してください</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、メインプログラムでの潜在的な問題を回避するために、ユーザー自身の責任でそのような技法の使用を実行し、テスト構成またはワーカーのコピーを事前に実験することを理解する必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年9月11日から更新</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「バージョン1C-8.3.14以降では、外部コンポーネントの初期化セクションは、単語から完全に実行されなくなりました」と私は無駄に心配していることがわかりました。</font><b><font style="vertical-align: inherit;">ConnectExternalComponent（）</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数の戻りメッセージのみを</font><font style="vertical-align: inherit;">処理する必要がないことが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">わかり</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。さらに、指定するコンポーネントのタイプに関係なく、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Native API</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、1Cの現在利用可能なすべてのバージョンで構成を作成できます。完全にサポートされている構成を変更したくない場合を除いて、コンポーネントはどこでも問題なく機能し、外部ブートローダーの作成が適切です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この点で、1C82と1C83のテスト構成のコードはわずかに変更されていますが、それらの違いは基本的なものではなくなりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、1C企業は、VNでの初期化コードの実行を簡単にブロックできる、少なくとも</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブAPIの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ような外部コンポーネントについて</font><font style="vertical-align: inherit;">は、テンプレートで判断する必要がないため、</font><font style="vertical-align: inherit;">明らかに有効なままであるという私たちの発言</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">VKタイプ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の場合、これまでのところそのようなニーズがありますが、それが取り除くのを妨げているのは何ですか？</font><font style="vertical-align: inherit;">同時に、彼らがこの情報を考慮に入れるかどうか見てみましょうか？</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja466699/index.html">信頼プロトコルの調整-InterSystems IRISを使用したOAuth認証</a></li>
<li><a href="../ja466701/index.html">Let's Encryptはドメインの約30％に対応</a></li>
<li><a href="../ja466705/index.html">Android向けVivaldi Beta-リアルブラウザ</a></li>
<li><a href="../ja466709/index.html">モノリシックなUnixライクなOSの開発-Cライブラリ（2）</a></li>
<li><a href="../ja466711/index.html">脆弱性DaOfficeがソーシャルネットワークから任意のユーザーを削除することを許可</a></li>
<li><a href="../ja466719/index.html">超軽量速度プロファイリング：理論と実践。パート1</a></li>
<li><a href="../ja466721/index.html">[エカテリンバーグ、発表] java.ural.Meetup @ 3-java.ural.Meetup @ 2からの3番目のJava mitap +ビデオレポートの発表</a></li>
<li><a href="../ja466723/index.html">Apple Text Broadcast-2019年9月10日</a></li>
<li><a href="../ja466725/index.html">ダガー2は初級（パート1）</a></li>
<li><a href="../ja466727/index.html">怠惰なアップグレード：PostgreSQL 12がパフォーマンスを向上させる方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>