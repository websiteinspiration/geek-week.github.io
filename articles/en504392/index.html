<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß üÜì üé≥ How many programmers and words do you need to recognize a handwritten passport? üññüèæ ü•¶ üôÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you think handwritten passports are often found in our country? When we began to design a passport recognition system at Smart Engines , it seemed ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How many programmers and words do you need to recognize a handwritten passport?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/smartengines/blog/504392/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do you think handwritten passports are often found in our country? When we </font><font style="vertical-align: inherit;">began to design a passport recognition system </font><font style="vertical-align: inherit;">at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Smart Engines</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it seemed that it was enough to teach the system to recognize typewritten documents in a quality manner. At that time, the presence of handwritten passports that could not be automatically recognized did not seem to be an important problem: there were enough unsolved problems without it. A year ago, analyzing the quality of work of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Smart IDReader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we realized that we got to the point where handwritten passports constitute a significant class of errors. In accordance with the scientific approach, they studied the problem and took up the decision. Today there will be a story about how we made the recognition of a handwritten passport of the Russian Federation, successfully solving the last problem on the way to fully automate the input of passport data.</font></font><br>
<img src="https://habrastorage.org/webt/0y/7f/bx/0y7fbxh1mf2gv2sw1sqocbh8pjg.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The task of recognizing handwritten text in a general way sounds fundamental, large-scale, and unsolvable. </font><font style="vertical-align: inherit;">Therefore, at first it is important to correctly limit the formalization of the task. </font><font style="vertical-align: inherit;">So, we will recognize the handwritten text of the main U-turn of the Russian civil passport. </font><font style="vertical-align: inherit;">Such passports are filled in neat calligraphic (at least according to the passportist) handwriting. </font><font style="vertical-align: inherit;">On the one hand, this makes the task easier: we don‚Äôt have to recognize ‚Äúmedical scribbles‚Äù and other poorly read texts. </font><font style="vertical-align: inherit;">But, on the other hand, we have to face all the variability of calligraphic styles of Cyrillic letters. </font><font style="vertical-align: inherit;">Well, well, this is more of a serious challenge, not an insurmountable problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The task of handwriting recognition in the passport we divided into three subtasks:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detection of the presence of the manuscript in the passport.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segmentation of a handwritten line into characters.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Character recognition and post-processing.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further in the article we will tell you more about the solution to each subtask. </font><font style="vertical-align: inherit;">But first, we will discuss one very important problem that always arises first in recognition - datasets. </font><font style="vertical-align: inherit;">Without datasets, normal recognition cannot be done: even if you can train neural networks on synthesized data, you still need data that will measure the accuracy of the trained system. </font><font style="vertical-align: inherit;">As it turned out, there aren‚Äôt any suitable manuscript datasets on the network. </font><font style="vertical-align: inherit;">Therefore, our list of subtasks was supplemented with a zero point - "Preparing the dataset." </font><font style="vertical-align: inherit;">We approached this process creatively: we distributed notebooks ‚Äúin a ruler‚Äù and asked all our programmers to ‚Äúget used to the role‚Äù of calligraphy masters - to rewrite some pre-prepared texts with beautiful handwriting. </font><font style="vertical-align: inherit;">These were verses by A.S. </font><font style="vertical-align: inherit;">Pushkin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we were waiting for the first disappointment. No matter how tough it may sound, it turned out that our programmers have completely forgotten how to write. And you can‚Äôt say that they did not try. No, they just forgot how to spell letters by hand. Here is an example of what happened: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w9/57/53/w95753bx8w0pvjq8a3k2h-m7rwa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agree, it‚Äôs not at all what is needed. The letters are dancing, the sizes are not respected ... I had to look for copybooks on the Internet, and, as in the first class, put everyone in writing in the literal sense of the word! We still remember this time with a smile: the entire team (without exception, from third-year students to honored doctors of science) sits at a desk and carefully displays letters.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7m/6r/br/7m6rbrrla_mh9z4prkrr4fjiojm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In two days, having filled our hand, we were ready to repeat an attempt to collect ‚Äúraw‚Äù data for the handwritten dataset. </font><font style="vertical-align: inherit;">The letters became smoother, the words more readable. </font><font style="vertical-align: inherit;">And some even managed to introduce some elements of calligraphy. </font><font style="vertical-align: inherit;">Now, look at the new samples yourself: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z9/kp/oq/z9kpoqyzwll639flvarpp3tevia.png"><br>
<br>
<img src="https://habrastorage.org/webt/bn/of/bi/bnofbiic3b1hhujhi93sjlfy0e0.png"><br>
<br>
<img src="https://habrastorage.org/webt/jd/m8/kg/jdm8kgsatxhuzzczsmzevlrbilq.png"><br>
<br>
<img src="https://habrastorage.org/webt/jy/il/ze/jyilzeghjba7usqjv7r68scn21o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result of such blanks with different texts and handwriting, we collected about 1000 pieces, carefully digitized them and put them into lines and symbols. </font><font style="vertical-align: inherit;">All, congratulations, the manuscript dataset is ready. </font><font style="vertical-align: inherit;">Back to the algorithms.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passport manuscript detection</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manuscript detection is an important element of an industrial document recognition system. </font><font style="vertical-align: inherit;">This functionality belongs to the category of "understanding of the document" and is in great demand on the side of the business customer. </font><font style="vertical-align: inherit;">We trained a binary convolutional neural network, which analyzed the input images of individual text lines of the passport. </font><font style="vertical-align: inherit;">Each of the fields of the passport is analyzed for manuscript using this network and then, by weighing the received estimates, a general decision is made on the ‚Äúmanuscript‚Äù of the passport as a whole.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handwritten line segmentation into characters</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Handwriting segmentation is fundamentally different from typescript segmentation. </font><font style="vertical-align: inherit;">To understand the first level of the problem, just try handwriting the word ‚Äúchinchilla‚Äù and look at these ‚Äúslender rows of hooks‚Äù. </font><font style="vertical-align: inherit;">For the segmentation of handwritten tests, we again used neural networks. </font><font style="vertical-align: inherit;">We trained a special neural network, which as an answer returns an estimate of the presence of a ‚Äúcut‚Äù between letters at each point of the input image of the text. </font><font style="vertical-align: inherit;">Further, applying the principles of dynamic programming, sections of letters are constructed.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/8f/wk/wj8fwkefhdbhbub5fjaksjr6syw.png" width="100%"><br>
<img src="https://habrastorage.org/webt/gv/0u/6n/gv0u6n2gkok1p58u6llulbfkva0.png" width="100%"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem of putting gaps between letters is far from all the pain of segmentation. </font><font style="vertical-align: inherit;">You must correctly limit each character vertically. </font><font style="vertical-align: inherit;">And here the search for ‚Äúbaseline‚Äù lines, which is often used when recognizing printed text, is not at all applicable - the height of handwritten letters jumps within unlimited limits.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Character Recognition and Post Processing</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem of recognizing handwritten characters is mainly the same style of different characters. </font><font style="vertical-align: inherit;">Look at the example above: which surname is written - ‚ÄúPetrov‚Äù or ‚ÄúNetrov‚Äù? </font><font style="vertical-align: inherit;">When a person reads a handwritten text, he never reads it character by character, but always within the given context. </font><font style="vertical-align: inherit;">The recognition system in this case should behave the same way. </font><font style="vertical-align: inherit;">So, a neural network that recognizes handwritten characters should be ‚Äútolerant‚Äù to different letters that have the same type (from a mathematical point of view, it should return the same confidence values ‚Äã‚Äãfor such characters), and subsequent algorithms for analyzing and processing recognition results (so called "postprocessors") should take into account the features of the recognized field.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What did we achieve in the end?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, in a year, we learned to recognize handwritten passports, leaving behind this fundamental problem that seemed unsolvable several years ago! </font><font style="vertical-align: inherit;">What's next? </font><font style="vertical-align: inherit;">Then, as usual, work on quality and new frontiers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS I almost forgot about the answer to the question stated in the title. </font><font style="vertical-align: inherit;">So, we have 62 programmers in the company. </font><font style="vertical-align: inherit;">We bought 150 notebooks and printed 2,000 sheets of prescriptions.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5sVElJbZPE0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504370/index.html">Office 365 & Microsoft Teams - Convenience of Collaboration and Impact on Security</a></li>
<li><a href="../en504374/index.html">Simple graph traversal: depth and breadth-first search using JavaScript as an example</a></li>
<li><a href="../en504382/index.html">How I (PhD Neurobiology) became a Data Scientist in 6 months</a></li>
<li><a href="../en504384/index.html">Gradually introduce TypeScript into your React project</a></li>
<li><a href="../en504386/index.html">Vassbotn H. Class Virtual Variables</a></li>
<li><a href="../en504400/index.html">Caching. Part 2: 60 days before release</a></li>
<li><a href="../en504402/index.html">May 29th Java Digest</a></li>
<li><a href="../en504408/index.html">Simple and convenient test framework template on selenide for UI autotests</a></li>
<li><a href="../en504412/index.html">Online programming championship "Open Finals of Moscow Training"</a></li>
<li><a href="../en504414/index.html">How Microsoft Killed AppGet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>