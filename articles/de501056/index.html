<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÅ üêä üë®üèæ‚Äçüíº Warum, wann und wie Multithreading und Multiprocessing in Python verwendet werden üà≤ ü§úüèΩ üôÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gru√ü, Chabrowsk. Im Moment hat OTUS ein Set f√ºr den Kurs f√ºr maschinelles Lernen er√∂ffnet. In diesem Zusammenhang haben wir f√ºr Sie ein sehr interessa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Warum, wann und wie Multithreading und Multiprocessing in Python verwendet werden</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/501056/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gru√ü, Chabrowsk. </font><font style="vertical-align: inherit;">Im Moment hat OTUS ein Set f√ºr den Kurs f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maschinelles Lernen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> er√∂ffnet. In diesem Zusammenhang haben wir f√ºr Sie ein sehr interessantes ‚ÄûM√§rchen‚Äú √ºbersetzt. </font><font style="vertical-align: inherit;">Gehen.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/mi/su/ev/misuevluvampqjc3br79pgtgscg.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war einmal in einer fernen, fernen Galaxie ... Ein </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
weiser und m√§chtiger Zauberer lebte in einem kleinen Dorf mitten in der W√ºste. </font><font style="vertical-align: inherit;">Und sie hie√üen Dumbledalf. </font><font style="vertical-align: inherit;">Er war nicht nur weise und m√§chtig, sondern half auch Menschen aus fernen L√§ndern, einen Zauberer um Hilfe zu bitten. </font><font style="vertical-align: inherit;">Unsere Geschichte begann, als ein Reisender dem Zauberer eine magische Schriftrolle brachte. </font><font style="vertical-align: inherit;">Der Reisende wusste nicht, was in der Schriftrolle war, er wusste nur, dass dies Dumbledalf war, wenn jemand alle Geheimnisse der Schriftrolle enth√ºllen konnte.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kapitel 1: Single-Threaded, Single-Process</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie es noch nicht erraten haben, habe ich eine Analogie zum Prozessor und seinen Funktionen gezogen. </font><font style="vertical-align: inherit;">Unser Assistent ist ein Prozessor, und eine Schriftrolle ist eine Liste von Links, die dazu f√ºhren, dass Python die F√§higkeit und das Wissen besitzt, diese zu beherrschen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Gedanke des Zauberers, der die Liste ohne Schwierigkeiten entschl√ºsselte, war, seinen treuen Freund (Garrigorn? Ich wei√ü, ich wei√ü, das klingt schrecklich) an jeden der Orte zu schicken, die in der Schriftrolle beschrieben wurden, um zu finden und zu bringen, was er dort finden konnte.</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">import</span> urllib.request
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<font></font>
In [<span class="hljs-number">2</span>]:<font></font>
urls = [<font></font>
  <span class="hljs-string">'http://www.python.org'</span>,
  <span class="hljs-string">'https://docs.python.org/3/'</span>,
  <span class="hljs-string">'https://docs.python.org/3/whatsnew/3.7.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/tutorial/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/library/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/reference/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/using/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/howto/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/installing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/distributing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/extending/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/c-api/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/faq/index.html'</span><font></font>
  ]<font></font>
In [<span class="hljs-number">3</span>]:<font></font>
%%time<font></font>
<font></font>
results = []<font></font>
<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:
    <span class="hljs-keyword">with</span> urllib.request.urlopen(url) <span class="hljs-keyword">as</span> src:<font></font>
        results.append(src)<font></font>
<font></font>
CPU times: user <span class="hljs-number">135</span> ms, sys: <span class="hljs-number">283</span> ¬µs, total: <span class="hljs-number">135</span> ms<font></font>
Wall time: <span class="hljs-number">12.3</span> s<font></font>
In [ ]:<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen k√∂nnen, durchlaufen wir einfach die URLs einzeln mit der for-Schleife und lesen die Antwort. </font><font style="vertical-align: inherit;">Dank </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%% Zeit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und der Magie von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPython</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen wir sehen, dass es mit meinem traurigen Internet ungef√§hr 12 Sekunden </font><i><font style="vertical-align: inherit;">gedauert hat</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kapitel 2: Multithreading</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war nicht ohne Grund, dass der Zauberer f√ºr seine Weisheit ber√ºhmt war, er konnte schnell einen viel effektiveren Weg finden. Anstatt eine Person an jeden Ort zu schicken, sollten Sie eine Gruppe zuverl√§ssiger Mitarbeiter zusammenstellen und sie gleichzeitig in verschiedene Teile der Welt schicken! Der Assistent kann das gesamte Wissen, das er mitbringt, auf einmal vereinen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstatt die Liste nacheinander in einer Schleife anzuzeigen, k√∂nnen wir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multithreading verwenden,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um auf mehrere URLs gleichzeitig zuzugreifen.</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">import</span> urllib.request
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<font></font>
In [<span class="hljs-number">2</span>]:<font></font>
urls = [<font></font>
  <span class="hljs-string">'http://www.python.org'</span>,
  <span class="hljs-string">'https://docs.python.org/3/'</span>,
  <span class="hljs-string">'https://docs.python.org/3/whatsnew/3.7.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/tutorial/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/library/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/reference/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/using/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/howto/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/installing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/distributing/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/extending/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/c-api/index.html'</span>,
  <span class="hljs-string">'https://docs.python.org/3/faq/index.html'</span><font></font>
  ]<font></font>
In [<span class="hljs-number">4</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">122</span> ms, sys: <span class="hljs-number">8.27</span> ms, total: <span class="hljs-number">130</span> ms<font></font>
Wall time: <span class="hljs-number">3.83</span> s<font></font>
In [<span class="hljs-number">5</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">8</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">122</span> ms, sys: <span class="hljs-number">14.7</span> ms, total: <span class="hljs-number">137</span> ms<font></font>
Wall time: <span class="hljs-number">1.79</span> s<font></font>
In [<span class="hljs-number">6</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> executor:<font></font>
    results = executor.map(urllib.request.urlopen, urls)<font></font>
<font></font>
CPU times: user <span class="hljs-number">143</span> ms, sys: <span class="hljs-number">3.88</span> ms, total: <span class="hljs-number">147</span> ms<font></font>
Wall time: <span class="hljs-number">1.32</span> s<font></font>
In [ ]:<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viel besser! Fast wie ... Magie. Die Verwendung mehrerer Threads kann viele E / A-Aufgaben erheblich beschleunigen. In meinem Fall ist die meiste Zeit f√ºr das Lesen von URLs auf die Netzwerklatenz zur√ºckzuf√ºhren. An E / A gebundene Programme verbringen den gr√∂√üten Teil ihres Lebens damit, auf Eingabe oder Ausgabe zu warten (genau wie ein Assistent darauf wartet, dass seine Freunde von der Schriftrolle zu Orten gehen und zur√ºckkehren). Dies kann √ºber das Netzwerk, die Datenbank, die Datei oder vom Benutzer eingegeben / ausgegeben werden. Eine solche E / A nimmt normalerweise viel Zeit in Anspruch, da die Quelle m√∂glicherweise eine Vorverarbeitung durchf√ºhren muss, bevor die Daten an die E / A √ºbertragen werden. Beispielsweise z√§hlt ein Prozessor viel schneller als eine Netzwerkverbindung Daten √ºbertr√§gt (mit einer Geschwindigkeit von ungef√§hr)wie Flash gegen deine Gro√ümutter).</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kann bei Aufgaben wie dem Bereinigen von Webseiten sehr n√ºtzlich sein.</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kapitel 3: Mehrfachverarbeitung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jahre vergingen, der Ruhm des guten Zauberers wuchs und mit ihm wuchs der Neid eines unparteiischen dunklen Zauberers (Sarumort? Oder vielleicht Volandeman?). </font><font style="vertical-align: inherit;">Mit unermesslicher List bewaffnet und von Neid getrieben, warf der dunkle Zauberer Dumbledalf einen schrecklichen Fluch auf. </font><font style="vertical-align: inherit;">Als der Fluch ihn √ºberholte, erkannte Dumbledalf, dass er nur wenige Momente hatte, um ihn abzuwehren. </font><font style="vertical-align: inherit;">Verzweifelt kramte er in seinen Zauberb√ºchern und fand schnell einen Gegenzauber, der funktionieren sollte. </font><font style="vertical-align: inherit;">Das einzige Problem war, dass der Assistent die Summe aller Primzahlen unter 1.000.000 berechnen musste. Ein seltsamer Zauber nat√ºrlich, aber was wir haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zauberer wusste, dass die Berechnung des Werts trivial sein w√ºrde, wenn er genug Zeit h√§tte, aber er hatte diesen Luxus nicht. Trotz der Tatsache, dass er ein gro√üartiger Zauberer ist, ist er durch seine Menschlichkeit eingeschr√§nkt und kann jeweils nur eine Zahl auf Einfachheit pr√ºfen. Wenn er sich entschied, die Primzahlen einfach nacheinander zu addieren, w√ºrde es zu lange dauern. Als nur noch Sekunden vor dem Anwenden </font><font style="vertical-align: inherit;">des Gegenzaubers </font><font style="vertical-align: inherit;">√ºbrig waren, erinnerte er sich pl√∂tzlich an den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mehrfachverarbeitungszauber</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , den er vor vielen Jahren aus der magischen Schriftrolle gelernt hatte. Dieser Zauber erm√∂glicht es ihm, sich selbst zu kopieren, um Zahlen zwischen seinen Kopien zu verteilen und mehrere gleichzeitig zu √ºberpr√ºfen. Und am Ende muss er nur die Zahlen addieren, die er und seine Kopien entdecken werden.</font></font><br>
<br>
<pre><code class="python hljs">In [<span class="hljs-number">1</span>]:
<span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<font></font>
In [<span class="hljs-number">2</span>]:
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">if_prime</span>(<span class="hljs-params">x</span>):</span>
    <span class="hljs-keyword">if</span> x &lt;= <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">elif</span> x &lt;= <span class="hljs-number">3</span>:
        <span class="hljs-keyword">return</span> x
    <span class="hljs-keyword">elif</span> x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    i = <span class="hljs-number">5</span>
    <span class="hljs-keyword">while</span> i**<span class="hljs-number">2</span> &lt;= x:
        <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x % (i + <span class="hljs-number">2</span>) == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        i += <span class="hljs-number">6</span>
    <span class="hljs-keyword">return</span> x<font></font>
In [<span class="hljs-number">17</span>]:<font></font>
%%time<font></font>
<font></font>
answer = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1000000</span>):<font></font>
    answer += if_prime(i)<font></font>
<font></font>
CPU times: user <span class="hljs-number">3.48</span> s, sys: <span class="hljs-number">0</span> ns, total: <span class="hljs-number">3.48</span> s<font></font>
Wall time: <span class="hljs-number">3.48</span> s<font></font>
In [<span class="hljs-number">18</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
CPU times: user <span class="hljs-number">114</span> ms, sys: <span class="hljs-number">4.07</span> ms, total: <span class="hljs-number">118</span> ms<font></font>
Wall time: <span class="hljs-number">1.91</span> s<font></font>
In [<span class="hljs-number">19</span>]:<font></font>
%%time<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
CPU times: user <span class="hljs-number">99.5</span> ms, sys: <span class="hljs-number">30.5</span> ms, total: <span class="hljs-number">130</span> ms<font></font>
Wall time: <span class="hljs-number">1.12</span> s<font></font>
In [<span class="hljs-number">20</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">8</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">729</span> ms ¬± <span class="hljs-number">3.02</span> ms per loop (mean ¬± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">21</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">512</span> ms ¬± <span class="hljs-number">39.8</span> ms per loop (mean ¬± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">22</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">32</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">518</span> ms ¬± <span class="hljs-number">13.3</span> ms per loop (mean ¬± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [<span class="hljs-number">23</span>]:<font></font>
%%timeit<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">with</span> Pool(<span class="hljs-number">64</span>) <span class="hljs-keyword">as</span> p:<font></font>
        answer = sum(p.map(if_prime, list(range(<span class="hljs-number">1000000</span>))))<font></font>
<font></font>
<span class="hljs-number">621</span> ms ¬± <span class="hljs-number">10.5</span> ms per loop (mean ¬± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">1</span> loop each)<font></font>
In [ ]:</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moderne Prozessoren haben mehr als einen Kern, sodass wir die Aufgaben mithilfe der Multiprozessverarbeitung des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiprozessverarbeitungsmoduls</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beschleunigen k√∂nnen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die mit dem Prozessor verbundenen Aufgaben sind Programme, mit denen die meiste Zeit Berechnungen am Prozessor durchgef√ºhrt werden (triviale mathematische Berechnungen, Bildverarbeitung usw.). </font><font style="vertical-align: inherit;">Wenn die Berechnungen unabh√§ngig voneinander durchgef√ºhrt werden k√∂nnen, haben wir die M√∂glichkeit, sie auf die verf√ºgbaren Prozessorkerne aufzuteilen, wodurch eine signifikante Erh√∂hung der Verarbeitungsgeschwindigkeit erzielt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles was du tun musst, ist:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bestimmen Sie, welche Funktion angewendet werden soll</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bereiten Sie eine Liste der Elemente vor, auf die die Funktion angewendet wird.</font></font></li>
<li>    <code>multiprocessing.Pool</code>. ,     <code>Pool()</code>,     .   <code>with</code> ,         .</li>
<li>     Pool    <code>map</code>.    map  ,    ,    .</li>
</ol><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Eine Funktion kann definiert werden, um jede Aufgabe auszuf√ºhren, die parallel ausgef√ºhrt werden kann. Beispielsweise kann eine Funktion Code enthalten, um das Ergebnis einer Berechnung in eine Datei zu schreiben.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Warum m√ºssen wir uns trennen</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Wenn Sie jemals versucht haben, die Leistung einer Aufgabe auf dem Prozessor mithilfe von Multithreading zu verbessern, ist das Ergebnis genau das Gegenteil. Das ist einfach schrecklich! Mal sehen, wie es passiert ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So wie ein Zauberer durch seine menschliche Natur eingeschr√§nkt ist und nur eine Zahl pro Zeiteinheit berechnen kann, wird Python mit einer Funktion namens</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Global Interpreter Lock (GIL) geliefert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Python l√§sst Sie gerne so viele Threads erzeugen, wie Sie m√∂chten, aber</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stellt sicher, dass immer nur einer dieser Threads ausgef√ºhrt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei einer Aufgabe im Zusammenhang mit E / A ist diese Situation v√∂llig normal. Ein Thread sendet eine Anfrage an eine URL und wartet auf eine Antwort. Erst dann kann dieser Thread durch einen anderen ersetzt werden, wodurch eine weitere Anfrage an eine andere URL gesendet wird. Da der Thread nichts tun muss, bis er eine Antwort erh√§lt, spielt es keine Rolle, dass zum angegebenen Zeitpunkt nur ein Thread ausgef√ºhrt wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Aufgaben, die auf dem Prozessor ausgef√ºhrt werden, ist das Vorhandensein mehrerer Threads fast so nutzlos wie Nippel in der Panzerung. Da pro Zeiteinheit nur ein Thread ausgef√ºhrt werden kann, arbeitet der Prozessor auch mit nur einem Thread, selbst wenn Sie mehrere Threads generieren, denen zur Vereinfachung jeweils eine Nummer zugewiesen wird. Tats√§chlich werden diese Nummern immer noch einzeln √ºberpr√ºft. Der Aufwand f√ºr die Arbeit mit mehreren Threads verringert die Leistung, die Sie nur bei </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgaben auf dem Prozessor beobachten k√∂nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese ‚ÄûEinschr√§nkung‚Äú zu umgehen, verwenden wir das Modul</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Anstatt Threads zu verwenden, verwendet Multiprocessing, wie Sie sagen, mehrere Prozesse. Jeder Prozess erh√§lt seinen eigenen pers√∂nlichen Interpreter und Speicherplatz, sodass die GIL Sie nicht einschr√§nkt. Tats√§chlich verwendet jeder Prozess seinen eigenen Prozessorkern und arbeitet mit seiner eigenen eindeutigen Nummer. Dies wird gleichzeitig mit der Arbeit anderer Prozesse durchgef√ºhrt. Wie s√º√ü von ihnen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√∂glicherweise stellen Sie fest, dass die CPU-Auslastung bei Verwendung h√∂her ist als </font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bei einer regul√§ren for-Schleife oder sogar </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dies geschieht, weil Ihr Programm nicht einen Kern, sondern mehrere verwendet. Und das ist gut! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
erinnere dich daran</font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es hat seinen eigenen Aufwand f√ºr die Verwaltung mehrerer Prozesse, der normalerweise schwerwiegender ist als die Kosten f√ºr Multithreading. (Multiprocessing erzeugt separate Interpreter und weist jedem Prozess einen eigenen Speicherbereich zu. Ja!) Das hei√üt, es ist in der Regel besser, eine Light-Version von Multithreading zu verwenden, wenn Sie auf diese Weise aussteigen m√∂chten (denken Sie an Aufgaben im Zusammenhang mit E / A). Wenn die Berechnung auf dem Prozessor jedoch zu einem Engpass wird, kommt die Modulzeit </font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aber denken Sie daran, dass mit gro√üer Kraft gro√üe Verantwortung verbunden ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mehr Prozesse erzeugen, als Ihr Prozessor pro Zeiteinheit verarbeiten kann, werden Sie feststellen, dass die Leistung allm√§hlich abnimmt. </font><font style="vertical-align: inherit;">Dies liegt daran, dass das Betriebssystem mehr Arbeit leisten muss, indem Prozesse zwischen den Prozessorkernen gemischt werden, da mehr Prozesse vorhanden sind. </font><font style="vertical-align: inherit;">In Wirklichkeit kann alles noch komplizierter sein, als ich Ihnen heute gesagt habe, aber ich habe die Hauptidee vermittelt. </font><font style="vertical-align: inherit;">Auf meinem System sinkt beispielsweise die Leistung, wenn die Anzahl der Prozesse 16 betr√§gt. Dies liegt daran, dass mein Prozessor nur 16 logische Kerne enth√§lt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kapitel 4: Fazit</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Aufgaben im Zusammenhang mit E / A </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann die Leistung verbessert werden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Aufgaben im Zusammenhang mit E / A </font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann dies ebenfalls die Produktivit√§t steigern, die Kosten sind jedoch in der Regel h√∂her als bei der Verwendung </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Existenz der Python-GIL macht uns klar, dass zu einem bestimmten Zeitpunkt in einem Programm nur ein Thread ausgef√ºhrt werden kann.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Aufgaben im Zusammenhang mit dem Prozessor </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann die </font><font style="vertical-align: inherit;">Verwendung </font><font style="vertical-align: inherit;">die Leistung verringern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei prozessorbezogenen Aufgaben </font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann die </font><font style="vertical-align: inherit;">Verwendung </font><font style="vertical-align: inherit;">die Leistung verbessern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zauberer sind gro√üartig!</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier werden wir heute unsere Einf√ºhrung in </font></font><code>multithreading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>multiprocessing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Python </font><font style="vertical-align: inherit;">beenden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jetzt geh und gewinne!</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Modellierung von COVID-19 mithilfe von Diagrammanalyse und Analyse offener Daten." </font><font style="vertical-align: inherit;">Kostenlose Lektion.</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501044/index.html">Halten Sie keine Personen f√ºr Idioten oder warum eine Person mit einem technischen Hintergrund einen Zellturm verbrennen kann (Video)</a></li>
<li><a href="../de501046/index.html">Rund um solide Vorteile: Top 10 Berichte der Konferenz C ++ Russia 2019 Piter</a></li>
<li><a href="../de501048/index.html">Organisation der Remote-Arbeit SMB-Organisation auf OpenVPN</a></li>
<li><a href="../de501050/index.html">Installieren und aktivieren Sie die LabVIEW Community Edition</a></li>
<li><a href="../de501052/index.html">Die R√ºckkehr des chinesischen Raumschiffs</a></li>
<li><a href="../de501058/index.html">Teamcenter Rapid Start Solution hilft Herstellern von Industrieanlagen, die Konstruktionszeit um 25% zu verk√ºrzen</a></li>
<li><a href="../de501060/index.html">JetBrains .NET Days Online, 13.-14. Mai</a></li>
<li><a href="../de501062/index.html">Alle Berichte des kostenlosen Online-Teils von PHP Russia mit ausl√§ndischen Sprechern k√∂nnen in √úbersetzung eingesehen werden</a></li>
<li><a href="../de501064/index.html">Zum Flug des chinesischen Versuchsschiffs. Infografiken und Collagen.</a></li>
<li><a href="../de501068/index.html">Deepfakes und Deep Media: Ein neues Schlachtfeld f√ºr Sicherheit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>