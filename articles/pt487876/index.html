<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç∏ üèÜ üí§ O que √© o Windows PowerShell e o que ele come? Parte 1: Recursos Principais üõåüèΩ ü§ü üì∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Historicamente, os utilit√°rios de linha de comando nos sistemas Unix s√£o mais desenvolvidos do que no Windows, no entanto, com o advento de uma nova s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>O que √© o Windows PowerShell e o que ele come? Parte 1: Recursos Principais</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487876/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Historicamente, os utilit√°rios de linha de comando nos sistemas Unix s√£o mais desenvolvidos do que no Windows, no entanto, com o advento de uma nova solu√ß√£o, a situa√ß√£o mudou. </font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Windows PowerShell permite que os administradores de sistema automatizem a maioria das tarefas de rotina. </font><font style="vertical-align: inherit;">Com sua ajuda, voc√™ pode alterar as configura√ß√µes, interromper e iniciar servi√ßos, al√©m de executar a manuten√ß√£o da maioria dos aplicativos instalados. </font><font style="vertical-align: inherit;">Seria errado perceber a janela azul como outro int√©rprete de comando. </font><font style="vertical-align: inherit;">Essa abordagem n√£o reflete a ess√™ncia das inova√ß√µes propostas pela Microsoft. </font><font style="vertical-align: inherit;">Na verdade, as possibilidades do Windows PowerShell s√£o muito maiores: em uma pequena s√©rie de artigos, tentaremos descobrir como a solu√ß√£o da Microsoft difere das ferramentas mais familiares.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caracter√≠sticas principais&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, o Windows PowerShell √© principalmente um shell de comando com uma linguagem de script, originalmente criada com base no .NET Framework e, mais tarde, no .NET Core. Ao contr√°rio dos shells que aceitam e retornam dados textuais, o Windows PowerShell trabalha com classes .NET que possuem propriedades e m√©todos. O PowerShell permite executar comandos comuns e tamb√©m fornece acesso a objetos COM, WMI e ADSI. Ele usa v√°rios reposit√≥rios, como o sistema de arquivos ou o registro do Windows, para acessar aos quais os chamados fornecedores (fornecedores). Vale a pena notar a capacidade de incorporar componentes execut√°veis ‚Äã‚Äãdo PowerShell em outros aplicativos para implementar v√°rias opera√ß√µes, incluindo atrav√©s da interface gr√°fica. O inverso tamb√©m √© verdadeiro: muitos aplicativos Windows fornecem acesso a suas interfaces de gerenciamento por meio do PowerShell.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Windows PowerShell permite:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alterar as configura√ß√µes do sistema operacional;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciar servi√ßos e processos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar fun√ß√µes e componentes de servidor;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalar software</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciar software instalado atrav√©s de interfaces especiais;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incorporar componentes execut√°veis ‚Äã‚Äãem programas de terceiros;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crie scripts para automatizar tarefas de administra√ß√£o;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabalhe com o sistema de arquivos, registro do Windows, armazenamento de certificados, etc.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shell e ambiente de desenvolvimento</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° o Windows PowerShell de duas maneiras: al√©m do emulador de console com um shell de comando, h√° um ambiente de script integrado (ISE). </font><font style="vertical-align: inherit;">Para acessar a interface da linha de comandos, basta selecionar o atalho apropriado no menu Windows ou executar o powershell.exe no menu Executar. </font><font style="vertical-align: inherit;">Uma janela azul aparece na tela, com capacidades significativamente diferentes do cmd.exe antediluviano. </font><font style="vertical-align: inherit;">H√° preenchimento autom√°tico e outros recursos familiares aos usu√°rios de shells de comando para sistemas Unix.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/gl/te/dsgltei5iog1igfonvgmqrprvpg.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para trabalhar com o shell, voc√™ precisa se lembrar de algumas combina√ß√µes de teclas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As setas para cima e para baixo percorrem o hist√≥rico para repetir comandos digitados anteriormente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A seta √† direita no final da linha recicla o comando anterior, caractere por caractere;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Home exclui o texto digitado da posi√ß√£o do cursor at√© o in√≠cio da linha;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + End exclui o texto do cursor at√© o final da linha.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F7 exibe uma janela com os comandos digitados e permite selecionar um deles. </font><font style="vertical-align: inherit;">A sele√ß√£o do mouse, copiar e colar, posicionamento do cursor, exclus√£o e backspace tamb√©m funcionam no console - tudo como desejamos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/dz/8y/4zdz8ycsabniuypzx-tloxc9vk4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Windows PowerShell ISE √© um ambiente de desenvolvimento completo que oferece suporte a guias e realce de sintaxe com um editor de c√≥digo, designer de comandos, depurador interno e outras alegrias da programa√ß√£o. </font><font style="vertical-align: inherit;">Se voc√™ escrever um h√≠fen no editor do ambiente de desenvolvimento ap√≥s o nome do comando, obter√° todos os par√¢metros dispon√≠veis com um tipo na lista suspensa. </font><font style="vertical-align: inherit;">Voc√™ pode iniciar o PowerShell ISE por meio de um atalho no menu do sistema ou usando o arquivo execut√°vel powershell_ise.exe.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/4o/wo/yp4owoc2brcx0vrosfgjkkb_vz4.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmdlets&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Windows PowerShell, o chamado cmdlets Essas s√£o classes .NET especializadas que cont√™m funcionalidades diversas. Eles s√£o nomeados de acordo com o princ√≠pio ‚ÄúObjeto de A√ß√£o‚Äù (ou ‚ÄúSubstantivo-Verbo, se voc√™ preferir‚Äù), e uma conjun√ß√£o hifenizada se assemelha ao predicado e ao sujeito nas frases das l√≠nguas naturais. Por exemplo, Get-Help significa literalmente "Get-Help" ou, no contexto do PowerShell: "Show-Help". Na verdade, esse √© um an√°logo do comando man nos sistemas Unix e os manuais no PowerShell precisam ser solicitados dessa maneira, e n√£o chamando os cmdlets com a tecla --help ou /?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m de Get, outros verbos (e n√£o apenas verbos, estritamente falando) s√£o usados ‚Äã‚Äãem cmdlets para indicar a√ß√µes. Na lista abaixo, damos alguns exemplos: </font></font><br>
<br>
<code>Add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- add; </font></font><br>
<code>Clear</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- limpar \ limpo; </font></font><br>
<code>Enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- habilitar; </font></font><br>
<code>Disable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- desligar; </font></font><br>
<code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- crio; </font></font><br>
<code>Remove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- excluir; </font></font><br>
<code>Set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- pergunte; </font></font><br>
<code>Start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- corre; </font></font><br>
<code>Stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Pare; </font></font><br>
<code>Export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- exporta√ß√£o; </font></font><br>
<code>Import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- importar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem sistema, usu√°rio e cmdlets opcionais: como resultado da execu√ß√£o, todos retornam um objeto ou uma matriz de objetos. Eles n√£o diferenciam mai√∫sculas de min√∫sculas, ou seja, do ponto de vista do interpretador de comandos, n√£o h√° diferen√ßa entre Get-Help e get-help. O caractere ';' √© usado para separa√ß√£o, mas √© obrigat√≥rio configur√°-lo apenas se v√°rios cmdlets forem executados na mesma linha.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os cmdlets do Windows PowerShell s√£o agrupados em m√≥dulos (NetTCPIP, Hyper-V etc.) e o cmdlet Get-Command existe para pesquisar por objeto e a√ß√£o. </font><font style="vertical-align: inherit;">Voc√™ pode mostrar ajuda assim:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/ek/ub/guekubdaoboz6eitvbzzqppmyvi.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, o comando exibe uma breve ajuda, mas se necess√°rio, os par√¢metros (argumentos) s√£o passados ‚Äã‚Äãpara os cmdlets. </font><font style="vertical-align: inherit;">Utilizando-os, por exemplo, voc√™ pode obter ajuda detalhada (par√¢metro detalhado) ou completa (par√¢metro completo), al√©m de exibir exemplos (par√¢metro -Exemplos):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Examples</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ajuda no Windows PowerShell √© atualizada com o cmdlet Update-Help. Se a linha de comando for muito longa, os argumentos do cmdlet podem ser transferidos para o pr√≥ximo, escrevendo o caractere de servi√ßo `` '' e pressionando Enter - basta terminar de escrever o comando em uma linha e continuar na outra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abaixo est√£o alguns exemplos de cmdlets comuns:&nbsp; </font></font><br>
<br>
<code>Get-Process</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- mostram processos em execu√ß√£o no sistema; </font></font><br>
<code>Get-Service</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- mostrar servi√ßos e seu status; </font></font><br>
<code>Get-Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- exibe o conte√∫do do arquivo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para cmdlets e utilit√°rios externos usados ‚Äã‚Äãcom freq√º√™ncia no Windows PowerShell, h√° breves sin√¥nimos - aliases (do alias em ingl√™s). </font><font style="vertical-align: inherit;">Por exemplo, dir √© um alias de Get-ChildItem. </font><font style="vertical-align: inherit;">A lista de sin√¥nimos cont√©m an√°logos de comandos dos sistemas Unix (ls, ps, etc.), e o cmdlet Get-Help √© chamado pelo comando help. </font><font style="vertical-align: inherit;">Uma lista completa de sin√¥nimos pode ser exibida usando o cmdlet Get-Alias:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d-/p_/m-/d-p_m-vc7nnwcrq2weryyqbeb8o.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts, fun√ß√µes, m√≥dulos e idioma do PowerShell</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os scripts do Windows PowerShell s√£o armazenados como arquivos de texto sem formata√ß√£o com a extens√£o .ps1. Voc√™ n√£o pode inici√°-los com um clique duplo: clique com o bot√£o direito do mouse no menu de contexto e selecione o item "Executar no PowerShell". No console, voc√™ precisar√° especificar o caminho completo para o script ou ir para o diret√≥rio apropriado e escrever o nome do arquivo. A execu√ß√£o de scripts tamb√©m √© limitada pela pol√≠tica do sistema e, para verificar as configura√ß√µes atuais, voc√™ pode usar o cmdlet Get-ExecutionPolicy, que fornecer√° um dos seguintes valores: </font></font><br>
<br>
<code>Restricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- a execu√ß√£o de scripts √© proibida (por padr√£o); </font></font><br>
<code>AllSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- somente o lan√ßamento de scripts assinados por um desenvolvedor confi√°vel √© permitido; </font></font><br>
<code>RemoteSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- permiss√£o para executar scripts assinados e personalizados; </font></font><br>
<code>Unrestricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- permitido executar qualquer script.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O administrador tem duas op√ß√µes. O mais seguro envolve a assinatura de scripts, mas essa √© uma feiti√ßaria bastante s√©ria - trataremos disso nos artigos a seguir. Agora vamos seguir o caminho de menor resist√™ncia e mudar a pol√≠tica:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Set-ExecutionPolicy</span> RemoteSigned</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/da/gg/k7dagg4xwaerpartpet4k_5eaa4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, o PowerShell precisar√° ser executado como administrador, embora, usando um par√¢metro especial, voc√™ possa alterar a pol√≠tica do usu√°rio atual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os scripts s√£o escritos em uma linguagem de programa√ß√£o orientada a objetos, cujos comandos s√£o nomeados de acordo com o mesmo princ√≠pio dos cmdlets discutidos anteriormente: "Action-Object" ("Verb-Noun"). Seu principal objetivo √© a automa√ß√£o de tarefas de administra√ß√£o, mas √© uma linguagem interpretada completa que possui todas as constru√ß√µes necess√°rias: ramifica√ß√£o condicional, loops, vari√°veis, matrizes, objetos, tratamento de erros, etc. Qualquer editor de texto √© adequado para escrever scripts, mas √© mais conveniente iniciar o Windows PowerShell ISE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode passar par√¢metros para o script, torn√°-los obrigat√≥rios e tamb√©m definir valores padr√£o. </font><font style="vertical-align: inherit;">Al√©m disso, o Windows PowerShell permite criar fun√ß√µes e cham√°-las da mesma maneira que os cmdlets: para isso, voc√™ usa a constru√ß√£o Function e chaves. </font><font style="vertical-align: inherit;">Um script com fun√ß√µes √© chamado de m√≥dulo e possui a extens√£o .psm1. </font><font style="vertical-align: inherit;">Os m√≥dulos devem ser armazenados em diret√≥rios definidos nas vari√°veis ‚Äã‚Äãde ambiente do PowerShell. </font><font style="vertical-align: inherit;">Voc√™ pode visualiz√°-los usando o seguinte comando:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Env:\PSModulePath | <span class="hljs-built_in">Format-Table</span> <span class="hljs-literal">-AutoSize</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transportadores</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No √∫ltimo exemplo, usamos um design familiar aos usu√°rios de shells para sistemas Unix. No Windows PowerShell, a barra vertical tamb√©m permite transferir a sa√≠da de um comando para a entrada de outro, mas h√° uma diferen√ßa significativa na implementa√ß√£o do pipeline: n√£o se trata de um conjunto de caracteres ou de algum texto. Os cmdlets internos ou as fun√ß√µes definidas pelo usu√°rio retornam objetos ou matrizes de objetos e tamb√©m podem receb√™-los na entrada. Como o shell Bourne e seus muitos seguidores, o PowerShell simplifica tarefas complexas com um pipeline. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O exemplo mais simples de um pipeline √© assim:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/pm/l0/zmpml0zpq48xqcsbqga7c-lvkfo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, o cmdlet Get-Service √© executado e, em seguida, todos os servi√ßos que recebe s√£o passados ‚Äã‚Äãpara o cmdlet Sort-Object para classifica√ß√£o pela propriedade Status. </font><font style="vertical-align: inherit;">O argumento para o qual o resultado da se√ß√£o anterior do pipeline √© passado depende de seu tipo - geralmente esse √© um InputObject. </font><font style="vertical-align: inherit;">Este problema ser√° discutido em mais detalhes no artigo dedicado √† linguagem de programa√ß√£o do PowerShell.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se desejar, voc√™ pode continuar a cadeia e passar o resultado do objeto de classifica√ß√£o para outro cmdlet (eles ser√£o executados da esquerda para a direita). </font><font style="vertical-align: inherit;">A prop√≥sito, o design familiar do Windows para sa√≠da de pagina√ß√£o tamb√©m est√° dispon√≠vel para todos os Unixoids:&nbsp;</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status | more</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Executando tarefas em segundo plano&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muitas vezes, voc√™ precisa executar um determinado comando em segundo plano para n√£o esperar o resultado de sua execu√ß√£o em uma sess√£o de shell. </font><font style="vertical-align: inherit;">No Windows PowerShell, existem v√°rios cmdlets para este caso: </font></font><br>
<br>
<code>Start-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- iniciando uma tarefa em segundo plano; </font></font><br>
<code>Stop-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- interrompa a tarefa em segundo plano; </font></font><br>
<code>Get-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Veja uma lista de tarefas em segundo plano; </font></font><br>
<code>Receive-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- veja o resultado da tarefa em segundo plano; </font></font><br>
<code>Remove-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- remo√ß√£o da tarefa em segundo plano; </font></font><br>
<code>Wait-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Transfira a tarefa em segundo plano de volta para o console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para iniciar uma tarefa em segundo plano, usamos o cmdlet Start-Job e indicamos colchetes um comando ou um conjunto de comandos:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Start-Job</span> {<span class="hljs-built_in">Get-Service</span>}</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_l/v7/31/_lv731nqaggn7kyk7thfu1g4gzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As tarefas em segundo plano no Windows PowerShell podem ser manipuladas sabendo seus nomes. </font><font style="vertical-align: inherit;">Primeiro, aprenda como exibi-los:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Job</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tu/r4/ha/tur4halfauj3kro8ajjersimf8o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, mostramos o resultado do trabalho1:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Receive-Job</span> Job1 | more</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/od/yz/znodyzk81wsadjjacvg9tmeis9g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â bem simples.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execu√ß√£o de comando remoto</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Windows PowerShell permite executar comandos e scripts n√£o apenas no local, mas tamb√©m no computador remoto e at√© em um grupo inteiro de m√°quinas. </font><font style="vertical-align: inherit;">Existem v√°rias maneiras de fazer isso:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muitos cmdlets t√™m um par√¢metro </font></font><code>-ComputerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas dessa forma falhar√°, por exemplo, na cria√ß√£o de um pipeline;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cmdlet </font></font><code>Enter-PSSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite criar uma sess√£o interativa em uma m√°quina remota;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando o cmdlet, </font></font><code>Invoke-Command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ pode executar comandos ou scripts em um ou mais computadores remotos.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√µes do PowerShell</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde seu primeiro lan√ßamento em 2006, o PowerShell mudou bastante. A ferramenta est√° dispon√≠vel para muitos sistemas executando em diferentes plataformas de hardware (x86, x86-64, Itanium, ARM): Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008/2008 R2, Windows 7, Windows 8, Windows 8.1, Windows RT, Windows RT 8.1, Windows Server 2012/2012 R2, Windows 10, Windows Server 2016, GNU / Linux e OS X. A vers√£o mais recente 6.2 foi lan√ßada em 10 de janeiro de 2018. √â mais prov√°vel que os scripts escritos para vers√µes anteriores funcionem em vers√µes posteriores, mas pode haver problemas com a portabilidade reversa, porque ao longo dos anos de desenvolvimento, um grande n√∫mero de novos cmdlets apareceu no PowerShell. Voc√™ pode descobrir a vers√£o do shell instalado no computador usando a propriedade PSVersion da vari√°vel interna $ PSVersionTable:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PSVersionTable</span>.PSVersion</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/0o/8z/ib0o8zeqxrn7ye3ddykovsckmis.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode usar o cmdlet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> <span class="hljs-literal">-Name</span> PSVersionTable ‚ÄìValueOnly</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3m/zc/r4/3mzcr4i_lettn4s_ulrqo_jpm8g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mesmo √© feito com o cmdlet Get-Host. </font><font style="vertical-align: inherit;">De fato, existem muitas op√ß√µes, mas para us√°-las, voc√™ precisa aprender a linguagem de programa√ß√£o do PowerShell, que √© o que faremos no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√≥ximo artigo</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp;</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A Microsoft conseguiu criar um shell de comando verdadeiramente poderoso com um ambiente integrado conveniente para o desenvolvimento de scripts. Ele difere dos meios familiares para n√≥s no mundo Unix pela profunda integra√ß√£o com os sistemas operacionais Windows, al√©m de software para eles e da plataforma .NET Core. O PowerShell pode ser chamado de shell orientado a objetos, pois os cmdlets e as fun√ß√µes definidas pelo usu√°rio retornam objetos ou matrizes de objetos e podem receb√™-los na entrada. Pensamos que todos os administradores de servidores Windows devem possuir esta ferramenta: j√° passou o tempo em que poderiam ficar sem a linha de comando. Um shell de console avan√ßado √© especialmente necess√°rio em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nosso VPS de baixo custo executando o Windows Server Core</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas isso √© outra hist√≥ria.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> 4:   ,  <br>
</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt487862/index.html">Quanto custa Nyasha?</a></li>
<li><a href="../pt487864/index.html">Passaportes eletr√¥nicos: aderir √† pr√°tica mundial ou correr o risco de vazamento de dados pessoais?</a></li>
<li><a href="../pt487868/index.html">Digitaliza√ß√£o de documentos e reconhecimento de texto com o VisionKit e o Vision Framework no iOS</a></li>
<li><a href="../pt487872/index.html">Moldes de silicone l√≠quido em casa</a></li>
<li><a href="../pt487874/index.html">Intel NUC Chaco Canyon - funciona onde voc√™ precisa</a></li>
<li><a href="../pt487878/index.html">5 perguntas sobre SQL frequentemente feitas por cientistas de dados para entrevistas de emprego</a></li>
<li><a href="../pt487882/index.html">O Chrome bloquear√° automaticamente an√∫ncios em v√≠deo irritantes</a></li>
<li><a href="../pt487884/index.html">5 coisas que eu gostaria de saber antes de desenvolver o interc√¢mbio</a></li>
<li><a href="../pt487888/index.html">CSRF na Umbraco CMS</a></li>
<li><a href="../pt487890/index.html">Traduzir fala para texto no iOS usando a estrutura de fala</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>