<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé† üìã üàÅ Grafana, InfluxDB, dos etiquetas y una cantidad. ¬øO c√≥mo calcular la suma de subgrupos? üíΩ üëÑ üö∂üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Hola a todos! 
 
 Comprometido en pruebas de rendimiento. Y realmente me gusta configurar el monitoreo y disfrutar las m√©tricas en Grafana . Y el est...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Grafana, InfluxDB, dos etiquetas y una cantidad. ¬øO c√≥mo calcular la suma de subgrupos?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/490764/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ol/b6/9a/olb69a8cdqhqtmjf-ic8x8qjevi.png"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Hola a todos! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comprometido en pruebas de rendimiento. </font><font style="vertical-align: inherit;">Y realmente me gusta configurar el monitoreo y disfrutar las m√©tricas en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y el est√°ndar para almacenar m√©tricas en herramientas de carga es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede guardar m√©tricas de herramientas tan populares como:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" title="  Apache.JMeter
Real-time results

In this document we will present the configuration setup to graph and historize the data in different backends:

 ‚Ä¢ InfluxDB setup for InfluxDBBackendListenerClient
 ‚Ä¢ InfluxDB setup for GraphiteBackendListenerClient
 ‚Ä¢ Grafana
 ‚Ä¢ Graphite"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache.JMeter</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" title="  Gatling
Realtime monitoring

The sections below describe how to configure Gatling with InfluxDB and Graphite, and use Grafana as a graphing library"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatling</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" title="  LoadRunner Enterprise
Manage analysis servers

This section describes how to configure external analysis database servers to be used with LoadRunner Enterprise"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empresa Loadrunner</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" title="  Yandex.Tank
Modules / Artifact uploaders / InfluxDB

      Yandex.Tank  InfluxDB"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Tank</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al trabajar con herramientas de prueba de rendimiento y sus m√©tricas, he acumulado una selecci√≥n de recetas de programaci√≥n para la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combinaci√≥n de Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Propongo considerar un problema interesante que surge cuando hay una m√©trica con dos o m√°s etiquetas. </font><font style="vertical-align: inherit;">Creo que esto no es raro. </font><font style="vertical-align: inherit;">Y en el caso general, la tarea suena as√≠: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calcular la m√©trica total para un grupo, que se divide en subgrupos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay tres opciones: </font></font></h3><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solo la cantidad agrupada por etiqueta de tipo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana-way. </font><font style="vertical-align: inherit;">Usamos una pila de valores</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suma de m√°ximos con subconsulta</font></font></a></li>
</ol> <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥mo todo empez√≥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Monitoreo de JVM MBean configurado utilizando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jolokia</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegraf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Y visualiz√≥ m√©tricas en los grupos de memoria: cu√°nta memoria asigna cada grupo de memoria en HEAP y m√°s all√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√°ficos sobre agrupaciones de memoria JVM y actividad del recolector de basura desde las 13:00 del d√≠a anterior hasta la 01:00 de la noche del d√≠a actual (per√≠odo de 12 horas). Aqu√≠ puede ver que los grupos de memoria se dividen en dos grupos: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Y que alrededor de las 17:00 hubo recolecci√≥n de basura, despu√©s de lo cual el tama√±o de los bloques de memoria disminuy√≥: </font><font style="vertical-align: inherit;">
Para m√©tricas por cobrar a grupos de memoria, he especificado los </font><font style="vertical-align: inherit;">siguientes ajustes </font><font style="vertical-align: inherit;">en el </font><b><font style="vertical-align: inherit;">telegraf</font></b><font style="vertical-align: inherit;"> fichero de configuraci√≥n </font><font style="vertical-align: inherit;">: </font><b><font style="vertical-align: inherit;">telegraf.conf</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ow/ow/os/owowosl0e-neglcsbew-0u7bjjq.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<pre><code class="apache hljs">[<span class="hljs-attribute">outputs</span>.influxdb]
  <span class="hljs-attribute">urls</span> =<span class="hljs-meta"> ["http://influxdb_server:8086"]</span>
  <span class="hljs-attribute">database</span> = <span class="hljs-string">"telegraf"</span>
  <span class="hljs-attribute">username</span> = <span class="hljs-string">"login-InfluxDb"</span>
  <span class="hljs-attribute">password</span> = <span class="hljs-string">"*****"</span>
  <span class="hljs-attribute">retention_policy</span> = <span class="hljs-string">"month"</span>
  <span class="hljs-attribute">influx_uint_support</span> = false<font></font>
<font></font>
[<span class="hljs-attribute">agent</span>]
  <span class="hljs-attribute">collection_jitter</span> = <span class="hljs-string">"2s"</span>
  <span class="hljs-attribute">interval</span> = <span class="hljs-string">"2s"</span>
  <span class="hljs-attribute">precision</span> = <span class="hljs-string">"s"</span><font></font>
<font></font>
[[<span class="hljs-attribute">inputs</span>.jolokia<span class="hljs-number">2</span>_agent]]
  <span class="hljs-attribute">username</span> = <span class="hljs-string">"login-Jolokia"</span>
  <span class="hljs-attribute">password</span> = <span class="hljs-string">"*****"</span>
  <span class="hljs-attribute">urls</span> =<span class="hljs-meta"> ["http://127.0.0.1:7777/jvm-service"]</span><font></font>
<font></font>
[[<span class="hljs-attribute">inputs</span>.jolokia<span class="hljs-number">2</span>_agent.metric]]
  <span class="hljs-attribute">paths</span> =<span class="hljs-meta"> ["Usage","PeakUsage","CollectionUsage","Type"]</span>
  <span class="hljs-attribute">name</span> = <span class="hljs-string">"java_memory_pool"</span>
  <span class="hljs-attribute">mbean</span> = <span class="hljs-string">"java.lang:name=*,type=MemoryPool"</span>
  <span class="hljs-attribute">tag_keys</span> =<span class="hljs-meta"> ["name"]</span><font></font>
<font></font>
[[<span class="hljs-attribute">processors</span>.converter]]<font></font>
  [<span class="hljs-attribute">processors</span>.converter.fields]
    <span class="hljs-attribute">integer</span> =<span class="hljs-meta"> ["CollectionUsage.*", "PeakUsage.*", "Usage.*"]</span>
    <span class="hljs-attribute">tag</span> =<span class="hljs-meta"> ["Type"]</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constru√≠ una solicitud a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para mostrar en gr√°ficos el valor m√©trico m√°ximo </font></font><b><code>Usage.Committed</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durante un per√≠odo de tiempo con un paso </font></font><b><code>$granularity</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1m) y agrupado por dos etiquetas </font></font><b><code>Type</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(HEAP o NON_HEAP) y </font></font><b><code>name</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Metaspace, G1 Old Gen, ...): </font><font style="vertical-align: inherit;">
la misma solicitud en forma de texto, teniendo en cuenta todas </font><b><font style="vertical-align: inherit;">las</font></b><font style="vertical-align: inherit;"> variables de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> (preste atenci√≥n al escape de valores de variables con </font><font style="vertical-align: inherit;">- esto es importante para que la consulta funcione correctamente):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/qx/2z/-2/qx2z-2mblgxyi-u6g4mrbyvybf8.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><code>:regex</code></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^${jolokia:regex}$/ <span class="hljs-keyword">AND</span><font></font>
    $timeFilter<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-built_in">time</span>($granularity)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La misma consulta en forma de texto, teniendo en cuenta los valores espec√≠ficos de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variables de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^serverName$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^<span class="hljs-keyword">http</span>:\/\/<span class="hljs-number">127</span>\<span class="hljs-number">.0</span>\<span class="hljs-number">.0</span>\<span class="hljs-number">.1</span>:<span class="hljs-number">7777</span>\/jvm-service$/ <span class="hljs-keyword">AND</span>
    <span class="hljs-built_in">time</span> &gt;= <span class="hljs-number">1583834400000</span>ms <span class="hljs-keyword">and</span> <span class="hljs-built_in">time</span> &lt;= <span class="hljs-number">1583877600000</span>ms
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-built_in">time</span>(<span class="hljs-number">1</span>m)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agrupaci√≥n por tiempo </font></font><b><code>GROUP BY time($granularity)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o se </font></font><b><code>GROUP BY time(1m)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliza para reducir el n√∫mero de puntos en el gr√°fico. </font><font style="vertical-align: inherit;">Para un per√≠odo de tiempo de 12 horas y un paso de agrupaci√≥n de 1 minuto, obtenemos: 12 x 60 = 720 veces o 721 puntos (el √∫ltimo punto con un valor de nulo).</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuerde que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">721</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el n√∫mero esperado de puntos en respuesta a las solicitudes a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con la configuraci√≥n actual para el intervalo de tiempo (12 horas) y el paso de agrupaci√≥n (1 minuto).</font></font></blockquote> <br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agrupaci√≥n de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
memoria </font><b><font style="vertical-align: inherit;">NON_HEAP: Metaspace</font></b><font style="vertical-align: inherit;"> (azul) est√° a la cabeza en el consumo de memoria a las 20:00. </font><font style="vertical-align: inherit;">Y seg√∫n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP: G1 Old Gen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (amarillo) hubo un peque√±o aumento local a las 17:03. </font><font style="vertical-align: inherit;">Y a las 20:00, en total, todos los </font><font style="vertical-align: inherit;">grupos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dejaron </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.5 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (113.2 + 45.9 + 13.4) y los </font><font style="vertical-align: inherit;">grupos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (67 + 57 + 4).</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ku/mo/wf/kumowfdo6gkw3wx_b8mugtsp8l4.png"></a><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuerde los valores para las 20:00: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pools </font><b><font style="vertical-align: inherit;">172.5 </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pools </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nos centraremos en estos valores en el futuro.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el contexto de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , obtuvimos el valor de la m√©trica f√°cilmente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el contexto de solo la etiqueta de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , el valor de la m√©trica tambi√©n es f√°cil de obtener, ya que todos los nombres de las agrupaciones de memoria son √∫nicos, y es suficiente para dejar la agrupaci√≥n de resultados solo por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La pregunta sigue siendo: ¬øc√≥mo obtener qu√© tama√±o se asigna para todos los grupos HEAP y todos los grupos NON_HEAP en total?</font></font></blockquote><br>
<a name="1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Solo la cantidad agrupada por etiqueta de tipo</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">Suma agrupada por etiqueta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera soluci√≥n que puede venir a la mente es agrupar los valores por la etiqueta </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y calcular la suma de los valores en cada grupo. </font><font style="vertical-align: inherit;">Tal consulta se ver√° as√≠: Una </font><font style="vertical-align: inherit;">
representaci√≥n textual de una solicitud de c√°lculo de suma agrupada por etiqueta </font><b><font style="vertical-align: inherit;">Tipo</font></b><font style="vertical-align: inherit;"> con todas </font><b><font style="vertical-align: inherit;">las</font></b><font style="vertical-align: inherit;"> variables de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/xz/w_/4a/xzw_4aonrgekrw4onxv9fwcctlg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^${jolokia:regex}$/ <span class="hljs-keyword">AND</span><font></font>
    $timeFilter<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es una consulta v√°lida, pero devolver√° solo dos puntos: la suma se calcular√° con la agrupaci√≥n solo por la etiqueta </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con dos valores (HEAP y NON_HEAP). </font><font style="vertical-align: inherit;">Ni siquiera veremos el horario. </font><font style="vertical-align: inherit;">Habr√° dos puntos independientes con una suma enorme en valores (m√°s de 3 TiB): </font><font style="vertical-align: inherit;">
tal suma no es adecuada, se necesita un desglose en intervalos de tiempo.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/sz/lx/bo/szlxboh0o4r3-jsq7jg9d49wnic.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">Cantidad agrupada por etiqueta por minuto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la consulta original, agrupamos las m√©tricas por un intervalo de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">granularidad $</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> personalizado </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Hagamos la agrupaci√≥n ahora por un intervalo personalizado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta consulta resultar√°, agreg√≥ </font></font><b><code>GROUP BY time($granularity)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
Obtenemos valores inflados, en lugar de 172.5 MiB por </font><b><font style="vertical-align: inherit;">NON_HEAP</font></b><font style="vertical-align: inherit;"> vemos 4.88 GiB: </font><font style="vertical-align: inherit;">
Dado que las m√©tricas se env√≠an a InfluxDB una vez cada 2 segundos (ver </font><b><font style="vertical-align: inherit;">telegraf.conf</font></b><font style="vertical-align: inherit;"> arriba), la suma de lecturas en un minuto no dar√° la cantidad en el momento, y la suma de treinta de esas cantidades. </font><font style="vertical-align: inherit;">Tampoco podemos </font><font style="vertical-align: inherit;">
dividir el resultado entre </font><b><font style="vertical-align: inherit;">30</font></b><font style="vertical-align: inherit;"> constantes </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como </font><b><font style="vertical-align: inherit;">$ granularity</font></b><font style="vertical-align: inherit;"> es un par√°metro, se puede establecer en 1 minuto y 10 minutos. </font><font style="vertical-align: inherit;">Y el valor de la cantidad cambiar√°.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/yb/xp/tw/ybxptwbmibq2xlujuuwbkwb83nq.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/9l/lo/hn/9llohn9ncpoztbtcsrfqzfzoqya.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3. </font><font style="vertical-align: inherit;">Etiqueta agrupada por segundo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obtener correctamente el valor de la m√©trica para la intensidad de recopilaci√≥n de la m√©trica actual (2 segundos), debe calcular la cantidad para un intervalo fijo que no exceda la intensidad de recopilaci√≥n de la m√©trica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intentemos mostrar estad√≠sticas con una agrupaci√≥n en segundos. Agregue a la </font></font><b><code>GROUP BY</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agrupaci√≥n </font></font><b><code>time(1s)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
con una granularidad tan peque√±a, obtenemos una gran cantidad de puntos para nuestro intervalo de tiempo de 12 horas (12 horas * 60 minutos * 60 segundos = 43.200 intervalos, 43.201 puntos por l√≠nea, la √∫ltima de las cuales es nula): </font><font style="vertical-align: inherit;">
43.201 puntos en cada l√≠nea de la gr√°fica. Hay tantos </font><b><font style="vertical-align: inherit;">puntos</font></b><font style="vertical-align: inherit;"> que </font><b><font style="vertical-align: inherit;">InfluxDB</font></b><font style="vertical-align: inherit;"> formar√° una respuesta durante mucho tiempo, </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> tardar√° m√°s en responder y luego el navegador extraer√° una cantidad tan enorme de puntos durante mucho tiempo.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/vn/sl/q_/vnslq_lq48mzzh9hgmjwiuvcy2i.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/_2/mw/4k/_2mw4ki9rcnf140m2doyqsn-zxy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y no en cada segundo hay puntos: las m√©tricas se recopilaron cada 2 segundos y se agruparon por cada segundo, lo que significa que cada segundo punto ser√° nulo. Para ver una l√≠nea suave, configure la conexi√≥n de valores no vac√≠os. De lo contrario, no veremos los gr√°ficos: </font><font style="vertical-align: inherit;">
anteriormente, </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> era tal que el navegador se </font><b><font style="vertical-align: inherit;">bloqueaba</font></b><font style="vertical-align: inherit;"> durante el sorteo de una gran cantidad de puntos. Ahora la versi√≥n de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> tiene la capacidad de dibujar varias decenas de miles de puntos: el navegador simplemente omite algunos de ellos, dibuja un gr√°fico utilizando los datos reducidos. Pero el gr√°fico se suaviza. Los m√°ximos se muestran como m√°ximos promedio.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/xx/ya/hf/xxyahfkl3xzk6ezsakvgsbi8lp4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, hay un gr√°fico, se muestra con precisi√≥n, las m√©tricas a las 20:00 se calculan correctamente, las m√©tricas en la leyenda del gr√°fico se calculan correctamente. </font><font style="vertical-align: inherit;">Pero el gr√°fico est√° suavizado: las r√°fagas no son visibles con una precisi√≥n de 1 segundo. </font><font style="vertical-align: inherit;">En particular, el aumento de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a las 17:03 desapareci√≥ del gr√°fico, el gr√°fico </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><font style="vertical-align: inherit;">muy suave: el </font><font style="vertical-align: inherit;">
menos en el rendimiento se manifestar√° claramente durante un intervalo de tiempo m√°s largo. </font><font style="vertical-align: inherit;">Si intenta construir un gr√°fico en un mes (720 horas), y no en 12 horas, entonces todo se congelar√° con una granularidad tan peque√±a (1 segundo), habr√° demasiados puntos. </font><font style="vertical-align: inherit;">Y hay una desventaja en ausencia de picos, una paradoja: </font><b><font style="vertical-align: inherit;">debido a la alta precisi√≥n de la obtenci√≥n de m√©tricas, obtenemos una baja precisi√≥n de su visualizaci√≥n</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/1g/vs/m8/1gvsm8owfg-ifjjcqwf-w1q2lbk.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a name="2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Grafana-way. </font><font style="vertical-align: inherit;">Usamos una pila de valores</font></font></h2><br><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">No fue</font></b><font style="vertical-align: inherit;"> posible </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crear una</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
soluci√≥n simple y productiva con </font><b><font style="vertical-align: inherit;">InfluxDB</font></b><font style="vertical-align: inherit;"> y el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dise√±ador de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consultas </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Solo intentaremos usar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> herramientas de </font><b><font style="vertical-align: inherit;">Grafana para</font></b><font style="vertical-align: inherit;"> resumir las m√©tricas que se </font><b><font style="vertical-align: inherit;">muestran</font></b><font style="vertical-align: inherit;"> en el gr√°fico original. </font><font style="vertical-align: inherit;">Y s√≠, esto es posible!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1. </font><font style="vertical-align: inherit;">Simplemente haga que la informaci√≥n sobre herramientas de desplazamiento / valor apilado: acumulativo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dejaremos la solicitud para elegir m√©tricas sin cambios, igual que en la secci√≥n "C√≥mo comenz√≥ todo": las </font><font style="vertical-align: inherit;">
m√©tricas se agrupar√°n por </font><b><font style="vertical-align: inherit;">Tipo</font></b><font style="vertical-align: inherit;"> y </font><b><font style="vertical-align: inherit;">nombre</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pero solo mostraremos la etiqueta </font><b><font style="vertical-align: inherit;">Tipo</font></b><font style="vertical-align: inherit;"> en los nombres de los gr√°ficos </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
y en la configuraci√≥n de visualizaci√≥n, </font><b><font style="vertical-align: inherit;">agruparemos</font></b><font style="vertical-align: inherit;"> las m√©tricas por pilas de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">
Primero, agregue la separaci√≥n de dos etiquetas en dos pilas diferentes A y B, para que sus valores no se crucen:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/s5/an/3e/s5an3errkt29lgc8byme6tnowz4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ls/vg/to/lsvgtohynssezzeiy04px0qwq3c.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/no/py/5g/nopy5ggb9ittxbz2phdei1egphg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregar anulaci√≥n de serie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / HEAP / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : A</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregar anulaci√≥n de serie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / NON_HEAP / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : B</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, configure la visualizaci√≥n de m√©tricas para mostrar los valores totales en una informaci√≥n sobre herramientas con gr√°ficos:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apilamiento y nulo valor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pila</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : En</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despliegue de informaci√≥n sobre herramientas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor apilado</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : acumulativo</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despliegue de informaci√≥n sobre herramientas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : solo</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido a las diferentes caracter√≠sticas de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> debe realizar acciones en ese orden. </font><font style="vertical-align: inherit;">Si cambia el orden de las acciones o deja algunos campos con la configuraci√≥n predeterminada, algo no funcionar√°:</font></font><br>
<br>
<ul>
<li>    Stack <b>A</b>  <b>B</b>    <b>Stacking &amp; Null value</b> / <b>Stack</b>: On,    ;</li>
<li>  <b>Hover tooltip / Mode</b>    ,    <b>Single</b>,  <b>Hover tooltip</b>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora, vemos muchas l√≠neas, como para nosotros mismos. </font><font style="vertical-align: inherit;">¬°Pero! </font><font style="vertical-align: inherit;">Si </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pasa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el </font><b><font style="vertical-align: inherit;">cursor</font></b><font style="vertical-align: inherit;"> sobre el </font><b><font style="vertical-align: inherit;">NON_HEAP</font></b><font style="vertical-align: inherit;"> superior </font><font style="vertical-align: inherit;">, la informaci√≥n sobre herramientas mostrar√° la suma de los valores de todos los </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El monto se considera verdadero, ya que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> significa </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
Y si pasa el cursor sobre el cuadro superior con el nombre </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> , veremos el monto por </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El gr√°fico se muestra correctamente. </font><font style="vertical-align: inherit;">Incluso el aumento de </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> a las 17:03 es visible: </font><font style="vertical-align: inherit;">
formalmente, la tarea se ha completado. </font><font style="vertical-align: inherit;">
Pero hay inconvenientes: se muestran muchos gr√°ficos adicionales. </font><font style="vertical-align: inherit;">Debes colocar el cursor en la parte superior de ellos. </font><font style="vertical-align: inherit;">Y en la leyenda del gr√°fico, no se acumulan, pero se muestran valores individuales, por lo que la leyenda se ha vuelto in√∫til.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/p9/tx/tw/p9txtwio9i4uozvliutk5_dg13o.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/g5/78/bo/g578boco1u0sncwf0jmh8ejsyow.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2. </font><font style="vertical-align: inherit;">Valor apilado: acumulativo con l√≠neas intermedias ocultas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arreglemos el primer signo negativo de la soluci√≥n anterior: aseg√∫rese de que no se muestren gr√°ficos adicionales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para esto:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregue nuevas m√©tricas con un nombre diferente y un valor 0 a los resultados.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregue nuevas m√©tricas a la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pila A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pila B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en la parte superior de la pila.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ocultar de la pantalla: las l√≠neas originales de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agregamos dos nuevos despu√©s de la solicitud principal: solicitud </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para recibir una serie con valores 0 y nombre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[NON_HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y solicitud </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para recibir una serie con valores 0 y nombre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para obtener 0, tomamos el primer valor del campo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Usage.committed"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en cada grupo de tiempo </font><font style="vertical-align: inherit;">y lo restamos: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primero ("Usage.committed") - primero ("Usage.committed")</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - obtenemos un 0. estable Los nombres de los gr√°ficos se cambian sin perder significado debido a los corchetes: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[NON_HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">[HEAP]</font></b><font style="vertical-align: inherit;"> y </font><b><font style="vertical-align: inherit;">HEAP se</font></b><font style="vertical-align: inherit;"> combinan en la </font><b><font style="vertical-align: inherit;">Pila A</font></b><font style="vertical-align: inherit;"> , y tambi√©n ocultan todo </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">[NON_HEAP]</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/no/kh/0f/nokh0fb2fp1t_ictdthli2etylg.png"></a><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">combine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pila B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oculte NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">obtenga la</font></b><font style="vertical-align: inherit;"> 
cantidad correcta en </font><b><font style="vertical-align: inherit;">[NON_HEAP]</font></b><font style="vertical-align: inherit;"> en la informaci√≥n sobre herramientas al pasar el cursor sobre el gr√°fico: </font><b><font style="vertical-align: inherit;">obtenga</font></b><font style="vertical-align: inherit;"> 
la cantidad correcta en </font><b><font style="vertical-align: inherit;">[HEAP]</font></b><font style="vertical-align: inherit;"> en la informaci√≥n sobre herramientas al pasar sobre el gr√°fico. </font><font style="vertical-align: inherit;">E incluso todas las explosiones son visibles: </font><font style="vertical-align: inherit;">
y el cronograma se forma r√°pidamente. </font><font style="vertical-align: inherit;">Pero la leyenda siempre muestra 0, la leyenda se ha vuelto in√∫til. </font><font style="vertical-align: inherit;">
¬°Todo sali√≥ bien! </font><font style="vertical-align: inherit;">La verdadera derivaci√≥n es a trav√©s de las pilas de </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es por esto que el art√≠culo se agreg√≥ a la categor√≠a de </font><b><font style="vertical-align: inherit;">Programaci√≥n anormal</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/uf/zw/7s/ufzw7sw-oxjflnzkglbilrdgmw4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ga/mh/nz/gamhnzyw1thhnbi5mflkwrlvr_i.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/p_/tp/ev/p_tpevfzm7rwkc1534vyhe92ozg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a name="3"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. La suma de los m√°ximos con la subconsulta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como ya nos hemos embarcado en el camino de la programaci√≥n anormal con un mont√≥n de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , continuemos. </font><font style="vertical-align: inherit;">Hagamos que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devuelva un peque√±o n√∫mero de puntos y haga que aparezca la leyenda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 Suma de incrementos de la suma acumulada de m√°ximos</font></font></h3><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profundicemos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
en las posibilidades de </font><b><font style="vertical-align: inherit;">InfluxDB</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Anteriormente, a menudo ayudaba tomando la derivada de la cantidad acumulada, as√≠ que intentaremos aplicar este enfoque ahora. </font><font style="vertical-align: inherit;">Cambiemos al modo de edici√≥n manual de solicitudes: </font><font style="vertical-align: inherit;">
hagamos tal solicitud:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/om/-b/yt/om-bytkvhp5zisny6gw5io_g2ba.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"U"</span>) <span class="hljs-keyword">FROM</span> (
        <span class="hljs-keyword">SELECT</span> non_negative_difference(cumulative_sum(<span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>))) <span class="hljs-keyword">AS</span> <span class="hljs-string">"U"</span> 
        <span class="hljs-keyword">FROM</span> <span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span> 
        <span class="hljs-keyword">WHERE</span> <font></font>
            (<font></font>
                <span class="hljs-string">"host"</span> =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span> 
                <span class="hljs-string">"jolokia_agent_url"</span> =~ /^${jolokia:regex}$/<font></font>
            ) <span class="hljs-keyword">AND</span> <font></font>
            $timeFilter <font></font>
        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span><font></font>
)<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">"Type"</span>, <span class="hljs-built_in">time</span>($granularity)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ se toma el valor m√°ximo de la m√©trica en el grupo por tiempo y la suma de dichos valores desde el momento en que comienza la referencia, agrupados por las etiquetas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como resultado, en cada momento habr√° una suma de todas las indicaciones por tipo ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) con separaci√≥n por nombre de grupo, pero no se suman 30 valores, como fue el caso en la versi√≥n 1.2, pero solo uno es el m√°ximo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y si tomamos el incremento de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diferencia no negativa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">dicha suma acumulativa para el √∫ltimo paso, obtendremos el valor de la suma de todos los grupos de datos agrupados por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font><font style="vertical-align: inherit;">etiquetas de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al comienzo del intervalo de tiempo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, para obtener la cantidad solo por etiqueta</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escriba</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sin agrupar por etiqueta de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , debe realizar una solicitud de nivel superior con par√°metros de agrupaci√≥n similares, pero sin agrupar por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de una consulta tan compleja, obtenemos la suma de todos los tipos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Horario perfecto </font><font style="vertical-align: inherit;">La suma de los m√°ximos se calcula correctamente. </font><font style="vertical-align: inherit;">Hay una leyenda con los valores correctos, distintos de cero. </font><font style="vertical-align: inherit;">En la informaci√≥n sobre herramientas puede mostrar todas las m√©tricas, no solo Single. </font><font style="vertical-align: inherit;">Incluso se muestran r√°fagas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">
una cosa, pero la solicitud result√≥ ser dif√≠cil: la suma del incremento de la suma acumulada de m√°ximos con un cambio en el nivel de agrupaci√≥n.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/an/yv/1t/anyv1t7m69cwrl6cnwgl-dwd7xy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 Suma de m√°ximos con un cambio en el nivel de agrupaci√≥n</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øSe puede hacer algo m√°s simple que en la versi√≥n 3.1? El cuadro de Pandora ya est√° abierto, cambiamos al modo de edici√≥n de consulta manual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existe la sospecha de que recibir un incremento de la cantidad acumulada conduce a un efecto cero: uno extingue al otro. Desh√°gase de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diferencia no_negativa (suma acumulativa (...))</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simplifica la solicitud. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simplemente dejamos la suma de los m√°ximos, con una disminuci√≥n en el nivel de agrupaci√≥n:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"A"</span>)
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">"A"</span>
    <span class="hljs-keyword">FROM</span> <span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span> 
    <span class="hljs-keyword">WHERE</span><font></font>
            (<font></font>
                <span class="hljs-string">"host"</span> =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span> 
                <span class="hljs-string">"jolokia_agent_url"</span> =~ /^${jolokia:regex}$/<font></font>
            ) <span class="hljs-keyword">AND</span> <font></font>
            $timeFilter<font></font>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span><font></font>
)<font></font>
<span class="hljs-keyword">WHERE</span> $timeFilter
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta es una consulta simple y r√°pida que devuelve solo 721 puntos por serie en 12 horas, cuando se agrupa por minutos: 12 (horas) * 60 (minutos) = 720 intervalos, 721 puntos (√∫ltimo vac√≠o). Tenga en cuenta que el filtro de tiempo est√° duplicado. Est√° en la subconsulta y en la solicitud de agrupaci√≥n: </font><font style="vertical-align: inherit;">
sin </font><b><font style="vertical-align: inherit;">$ timeFilter,</font></b><font style="vertical-align: inherit;"> en la solicitud de agrupaci√≥n externa, el n√∫mero de puntos devueltos no ser√° 721 en 12 horas, sino m√°s. Dado que la subconsulta se agrupa para el intervalo </font><b><font style="vertical-align: inherit;">de</font></b><font style="vertical-align: inherit;"> ... </font><b><font style="vertical-align: inherit;">a</font></b><font style="vertical-align: inherit;"> , y la agrupaci√≥n de una solicitud externa sin filtro ser√° para el intervalo </font><b><font style="vertical-align: inherit;">de</font></b><font style="vertical-align: inherit;"> ... </font><b><font style="vertical-align: inherit;">ahora</font></b><font style="vertical-align: inherit;"> . Y si en </font><b><font style="vertical-align: inherit;">Grafana se selecciona</font></b><font style="vertical-align: inherit;"> un intervalo de tiempo que no dura las X horas (no es tal que </font><b><font style="vertical-align: inherit;">to</font></b><font style="vertical-align: inherit;"> = </font><b><font style="vertical-align: inherit;">now</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/8s/ab/tg/8sabtg9rebcu-tonmirjck2jdmk.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), pero para el intervalo del pasado ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasta</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ahora</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), aparecer√°n puntos vac√≠os con un valor nulo al final de la selecci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El gr√°fico resultante result√≥ ser simple, r√°pido, correcto. </font><font style="vertical-align: inherit;">Con una leyenda que muestra m√©tricas de resumen. </font><font style="vertical-align: inherit;">Con informaci√≥n sobre herramientas para varias l√≠neas a la vez. </font><font style="vertical-align: inherit;">Y tambi√©n con la visualizaci√≥n de todas las r√°fagas de valores: ¬° </font><font style="vertical-align: inherit;">
se logra el resultado!</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/an/yv/1t/anyv1t7m69cwrl6cnwgl-dwd7xy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referencias (en lugar de referencias)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distribuciones de las herramientas utilizadas en el art√≠culo:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grafana</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (6.5.0)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">influxdb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.7.9)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegraf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.13.3)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jolokia-jvm-1.6.2-agent.jar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.6.2)</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Documentaci√≥n sobre las capacidades de las herramientas utilizadas en el art√≠culo:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esencia</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n</font></font></th>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pol√≠tica de retenci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retenci√≥n de datos InfluxDB</font></font></a></td>
<td>Retention policy <b>montn</b>   30  ,     JVM    .       <b>auto</b>,     .   ¬´  ¬ª   <b>telegraf.conf</b>      <b>InfluxDB</b>  ,      <b>Grafana</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">InfluxDB v1.x Output Plugin</a></td>
<td>    <b>Telegraf</b>  <b>InfluxDB</b>.     <b>telegraf.conf</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">agent / interval</a></td>
<td>   ,     2 .   ¬´  ¬ª   <b>telegraf.conf</b>.   ¬´1.2.       ¬ª  ¬´1.3.       ¬ª</td>
</tr>
<tr>
<td>Java 8 / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Interface MemoryPoolMXBean</a></td>
<td>  MemoryPool,  ,     bool,  long.     <b>telegraf.conf</b>    int</td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jolokia2 Input Plugins</a></td>
<td>  <b>telegraf.conf</b>   MBean-,     <b>InfluxDB</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Converter Processor</a></td>
<td>  <b>telegraf.conf</b>,      <b>float</b>   <b>int</b>    <b>InfluxDB</b>.      <b>Type</b>   <b>Type</b>,        </td>
</tr>
<tr>
<td>Grafana / Variables / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Advanced Formatting Options / Regex</a></td>
<td> Grafana,    Multiselect    ,    ,     ,    <b><code>~ /^<u>${}</u>$/</code></b> ‚Äî ,  <b><code>~ /^${<u>:regex</u>}$/</code></b></td>
</tr>
<tr>
<td>Grafana / Variables / Global Built-in Variables / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">The $timeFilter or $__timeFilter Variable</a></td>
<td> Grafana- <b>$timeFilter</b>,     </td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MAX()</a></td>
<td>  <b>MAX()</b>  <b>InfluxDB</b> 1.7,       </td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SUM()</a></td>
<td>    <b>SUM()</b>  <b>InfluxDB</b> 1.7</td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Subqueries</a></td>
<td>    <b>InfluxDB</b> 1.7,     3 </td>
</tr>
<tr>
<td>InfluxDB / Transformation / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CUMULATIVE_SUM()</a></td>
<td>  <b>CUMULATIVE_SUM()</b>,        <b>InfluxDB</b>,    <b>NON_NEGATIVE_DERIVATIVE()</b></td>
</tr>
<tr>
<td>InfluxDB / Transformation / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NON_NEGATIVE_DERIVATIVE()</a></td>
<td>  <b>NON_NEGATIVE_DERIVATIVE()</b>,     3 .     <b>CUMULATIVE_SUM()</b> ‚Äî          3</td>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Using Grafana‚Äôs Query Inspector to troubleshoot issues</a></td>
<td> <b>Query Inspector</b>,         ,        Grafana-</td>
</tr>
<tr>
<td>Grafana / Graph / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Draw Options</a></td>
<td>  Stack, Tooltip,‚Ä¶              ¬´2. Grafana-way.   ¬ª </td>
</tr>
<tr>
<td>Grafana / Graph / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Series overrides</a></td>
<td>       (     )  <b>Grafana</b></td>
</tr>
</tbody></table></div><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los </font><font style="vertical-align: inherit;">ingenieros de pruebas de rendimiento deben conocer bien la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combinaci√≥n de Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Y en este paquete, muchas tareas simples son muy interesantes y no siempre se pueden resolver con m√©todos de programaci√≥n normales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A veces conocimientos de programaci√≥n anormales pueden ser necesarios con los </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> caracter√≠sticas </font><font style="vertical-align: inherit;">y sutilezas de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consulta </font><b><font style="vertical-align: inherit;">lenguaje</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el art√≠culo, se tomaron en cuenta cuatro pasos de la implementaci√≥n de resumir una m√©trica con una agrupaci√≥n por una etiqueta, pero que tiene varias etiquetas. La tarea fue interesante. Y hay muchas de esas tareas. </font><b><font style="vertical-align: inherit;">Estoy</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
preparando un informe sobre las sutilezas de la programaci√≥n con </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Peri√≥dicamente publicar√© materiales sobre este tema. </font><font style="vertical-align: inherit;">Mientras tanto, estar√© contento con sus preguntas sobre el art√≠culo actual.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es490754/index.html">Visual Studio Code Code Editor. La gu√≠a m√°s detallada para configurar e instalar complementos para principiantes</a></li>
<li><a href="../es490756/index.html">Implementar Jenkins como c√≥digo</a></li>
<li><a href="../es490758/index.html">Los matem√°ticos han demostrado la ley universal de la turbulencia.</a></li>
<li><a href="../es490760/index.html">Ray Casting Visual Search (RCVS). Algoritmo simple y r√°pido para encontrar modelos 3D similares en geometr√≠a</a></li>
<li><a href="../es490762/index.html">¬øC√≥mo pronosticar el pasaje a√©reo?</a></li>
<li><a href="../es490766/index.html">¬øC√≥mo entender a un principiante, qu√© idioma elegir para la profesi√≥n deseada?</a></li>
<li><a href="../es490768/index.html">Cuando los juegos de computadora son su trabajo: el dispositivo interno de los juegos en la nube</a></li>
<li><a href="../es490770/index.html">¬°Abajo la deuda t√©cnica! En TechLead Conf 2020, le mostraremos c√≥mo</a></li>
<li><a href="../es490772/index.html">C√≥mo escribir y publicar un contrato inteligente en Telegram Open Network (TON)</a></li>
<li><a href="../es490774/index.html">Sensible</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>