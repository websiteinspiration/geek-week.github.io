<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôçüèø üñåÔ∏è üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø Economize tempo, nervos e horas de trabalho üï¥üèª üçÜ üòØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nossos projetos s√£o geralmente regionais e clientes, geralmente minist√©rios. Mas, al√©m do setor p√∫blico, organiza√ß√µes privadas tamb√©m usam nossos sist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Economize tempo, nervos e horas de trabalho</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/barsgroup/blog/495942/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nossos projetos s√£o geralmente regionais e clientes, geralmente minist√©rios. </font><font style="vertical-align: inherit;">Mas, al√©m do setor p√∫blico, organiza√ß√µes privadas tamb√©m usam nossos sistemas. </font><font style="vertical-align: inherit;">Praticamente n√£o h√° problemas com eles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, os principais projetos s√£o regionais e, √†s vezes, h√° problemas com eles. </font><font style="vertical-align: inherit;">Por exemplo, com desempenho, quando em regi√µes a partir de 20k, nossos usu√°rios preciosos est√£o no per√≠odo de implanta√ß√£o de novas funcionalidades nos servidores do produto. </font><font style="vertical-align: inherit;">√â uma dor ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu nome √© Ruslan e estou envolvido na escolta dos sistemas de informa√ß√µes do BARS Group e no </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desenvolvimento de um bot assassino para DBAs seriais brutais</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O jejum n√£o √© para os fracos de cora√ß√£o - muitas cartas e fotos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_2/kf/av/_2kfavets7hbt3nwzvy_bd9mqos.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguns de nossos aplicativos s√£o executados no Oracle DBMS. Existem projetos no DBMS do PostgreSQL. A Oracle tem uma coisa maravilhosa: coletar estat√≠sticas sobre a carga no DBMS, que destaca os problemas existentes e at√© fornece recomenda√ß√µes para elimina√ß√£o - AWR (Automatic Workload Repository). Em um ponto (a saber, no momento da dor), os desenvolvedores constantemente pediam para coletar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rios de AWR para an√°lise de desempenho</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Honestamente, fomos ao servidor DBMS, coletamos relat√≥rios, arrastamos-os para n√≥s e os enviamos para an√°lise para produ√ß√£o. Uma vez ap√≥s o dia 5 come√ßou a esticar ... ap√≥s o dia 10 - para causar irrita√ß√£o ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dia, um dos meus colegas expressou a ideia de que tudo o que √© feito mais de uma vez deve ser automatizado. At√© o momento do aborrecimento, para ser sincero, eu n√£o pensava nisso e tentava automatizar tudo o que pode ser automatizado, mas muitas vezes n√£o era procurado e era mais pesquisa do que aplicada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E ent√£o pensei: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Administradores n√£o s√£o necess√°rios para gerar um relat√≥rio ..."</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Afinal, coletar um relat√≥rio √© executar o script sql @ $ ORACLE_HOME / rdbms / admin / awrrpt.sql e pegar o relat√≥rio do servidor para n√≥s mesmos ... Ah, sim, n√£o deixamos o desenvolvimento √† venda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pesquisei as informa√ß√µes necess√°rias no Google, criei uma fun√ß√£o a partir do artigo com base em testes, puxei o script e um milagre - o relat√≥rio foi coletado e pode ser salvo localmente. Fun√ß√µes criadas onde os relat√≥rios AWR eram frequentemente necess√°rios, informavam aos desenvolvedores como us√°-lo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nessa √©poca, no meu tempo livre, depois de conversar com o @BotFather, criei um bot do Telegram para mim, apenas por divers√£o. Eu estraguei um funcional simples l√° - para mostrar a hora atual, as taxas de c√¢mbio, o clima, o ensinei a enviar elogios para minha esposa (ent√£o uma garota) em um hor√°rio. Talvez naquele momento o envio de elogios fosse a funcionalidade mais procurada do meu bot, minha esposa apreciou.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim. Os desenvolvedores nos escrevem no Telegram, enviamos um relat√≥rio a eles no Telegram ... Mas e se eles n√£o escrevem para n√≥s, mas para o bot? De fato, ser√° melhor para todos, o relat√≥rio ser√° recebido mais rapidamente e, o mais importante, por n√≥s. Assim, a ideia da primeira funcionalidade procurada nasceu para o meu bot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comecei a implementa√ß√£o. Fiz isso, como gerenciei, em PHP (na verdade, nosso aplicativo est√° em PHP, eu o entendo mais que Python). O codificador √© muito parecido comigo, ent√£o n√£o mostrarei meu c√≥digo :) O </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot vive em nossa rede corporativa, tem acesso a determinados projetos, incluindo bancos de dados de destino. Para n√£o me incomodar com os par√¢metros no comando ou no menu, estraguei essa funcionalidade em um bate-papo em grupo com notifica√ß√µes de monitoramento. Portanto, o bot sabe imediatamente em qual banco de dados coletar o relat√≥rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendo recebido um comando do formul√°rio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em que N √© o n√∫mero de horas completas para as quais um relat√≥rio √© necess√°rio (por padr√£o - 1 hora), mesmo por uma semana, se o banco de dados n√£o for reiniciado, o bot come√ßar√° a funcionar imediatamente, coletar√° o relat√≥rio, o publicar√° como uma p√°gina da web e logo ali (quase ali mesmo) fornece um link para um relat√≥rio muito necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seguimos o link e aqui est√° o relat√≥rio do AWR: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yr/tk/kiyrtktigm4qjsumovp2vl4roa0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como esperado, os desenvolvedores lidaram com essa gera√ß√£o de relat√≥rio, algu√©m at√© agradeceu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendo apreciado a conveni√™ncia da equipe, os gerentes de projeto de outras regi√µes queriam o mesmo, porque, acima de tudo, </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recebem luli do cliente que se</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> preocupa com o desempenho e a disponibilidade dos sistemas. Adicionado um bot para outros chats. Eles ainda usam, e eu estou feliz com isso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais tarde, colegas do CIT escreveram sobre como coletamos relat√≥rios, eles tamb√©m queriam. </font><font style="vertical-align: inherit;">N√£o os adicionei aos nossos bate-papos, criei um bate-papo separado com a gera√ß√£o de relat√≥rios de acordo com o cronograma e a pedido.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ pgBadger</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos outras aplica√ß√µes em PHP em conjunto com o PostgreSQL. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementou a coleta do relat√≥rio pgBadger para os necessitados com o mesmo princ√≠pio - em bate-papos em grupo. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A princ√≠pio eles usaram, mas depois pararam. </font><font style="vertical-align: inherit;">Corte funcional como desnecess√°rio.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ dever</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em nosso departamento, h√° turnos da noite e, portanto, h√° um hor√°rio. </font><font style="vertical-align: inherit;">Est√° nas tabelas do google. </font><font style="vertical-align: inherit;">Nem sempre √© conveniente procurar um link, abrir uma agenda, cuidar de si mesmo ... Um dos ex-colegas tamb√©m brincou com seu bot do Telegram e introduziu </font><b><font style="vertical-align: inherit;">notifica√ß√µes sobre o in√≠cio de um turno de turno para os funcion√°rios</font></b><font style="vertical-align: inherit;"> do departamento no bate-papo do departamento </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O bot analisa a programa√ß√£o, determina o atendente pela data atual e, de acordo com a programa√ß√£o ou a pedido, informa quem est√° de plant√£o hoje. </font><font style="vertical-align: inherit;">Acabou √≥timo, confort√°vel. </font><font style="vertical-align: inherit;">√â verdade que n√£o gostei muito do formato da mensagem. </font><font style="vertical-align: inherit;">Al√©m disso, para funcion√°rios de outro departamento (por exemplo, o centro de neg√≥cios "Medicina"), as informa√ß√µes sobre os oficiais de servi√ßo em outras √°reas n√£o s√£o realmente necess√°rias, mas voc√™ precisa saber quem √© o oficial de servi√ßo em "Medicina" em caso de problemas. </font><font style="vertical-align: inherit;">Decidi "emprestar" a funcionalidade, mas mudar o que n√£o gostei. </font><font style="vertical-align: inherit;">Criei um formato de mensagem conveniente para mim e para os outros, removendo informa√ß√µes redundantes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ tnls</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s o "teste da caneta" da automa√ß√£o atrav√©s do bot do Telegram, surgiram muitas id√©ias diferentes, mas eu queria fazer as coisas estritamente necess√°rias. Decidi manter as </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estat√≠sticas dos recursos.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para acessar os projetos de nossos clientes, implementamos o chamado ‚Äúservidor de salto‚Äù ou o servidor de encaminhamento. As conex√µes VPN s√£o criadas nele e, por meio do ssh, as portas de aplicativos, os bancos de dados e outras sondas auxiliares s√£o encaminhadas para a nossa rede local para facilitar o acesso aos projetos de nossos funcion√°rios, sem problemas com as conex√µes VPN. Basta configurar uma conex√£o VPN para a nossa rede corporativa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As estat√≠sticas das chamadas sugerem que, muitas vezes, ap√≥s a queda de um dos t√∫neis (em caso de problemas na rede, por tempo limite, por exemplo), eles est√£o voltando para restaurar o acesso ao projeto. </font><font style="vertical-align: inherit;">Na maioria dos casos, basta reiniciar a conex√£o e tudo fica bem. </font><font style="vertical-align: inherit;">Vamos fazer voc√™ mesmo. </font><font style="vertical-align: inherit;">Aqui √© o comando: </font></font><br>
<img src="https://habrastorage.org/webt/pq/th/ad/pqthadwkyi0tegqd7tn2qzrpxws.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúQueda atrav√©s‚Äù para o item de menu desejado, selecione seu projeto, espere um minuto e todo mundo est√° feliz e satisfeito ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando um comando √© recebido, por um ligeiro movimento </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dos</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bytes e bits, as Liga√ß√µes bot para o servidor de encaminhamento, sabendo de antem√£o necessidades que encaminhamento de ser reiniciado, e faz seu trabalho - restaura a conex√£o com o projeto. </font><font style="vertical-align: inherit;">Escrevi instru√ß√µes para resolver esses problemas por conta pr√≥pria. </font><font style="vertical-align: inherit;">E fomos contatados apenas se a ferramenta fornecida n√£o funcionar ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ecp_to_pem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, as estat√≠sticas mostraram que muitas vezes √© necess√°rio converter a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assinatura digital</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><b><font style="vertical-align: inherit;">Crypto Pro para o formato pem</font></b><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) para v√°rias integra√ß√µes, e temos muitas delas. Tarefa: voc√™ pega o cont√™iner, copia-o para um computador Windows com o utilit√°rio P12FromGostCSP instalado (a prop√≥sito, pago), converte-o em pfx e converte-o usando OpenSSL (com suporte √† criptografia GOST) para pem. N√£o √© muito conveniente, mas quero com um clique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google novamente veio para o resgate. Encontrou a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilidade de alguma pessoa gentil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Coletado, conforme escrito em README - ganho. Ele ensinou o bot a trabalhar com o utilit√°rio e conseguiu uma convers√£o quase instant√¢nea.</font></font><br>
<img src="https://habrastorage.org/webt/aq/qo/yu/aqqoyu8qmwsrjbske46acai6bie.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento da implementa√ß√£o final, um pedido foi emitido para mudar para um novo formato de criptografia - gost-2012. </font><font style="vertical-align: inherit;">Tanto quanto me lembro, o utilit√°rio naquele momento funcionava apenas com o antigo GOST (2001), talvez fosse geralmente outro utilit√°rio semelhante de outra pessoa boa, n√£o me lembro exatamente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a transi√ß√£o para o novo GOST, a funcionalidade do bot foi removida por motivos de seguran√ßa. </font><font style="vertical-align: inherit;">Implementado em um cont√™iner de docker.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerfile, de repente quem precisa:</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">FROM ubuntu:16.04                                                                                                                                                                        <font></font>
RUN apt update &amp;&amp; apt -y install git sudo wget unzip gcc g++ make &amp;&amp; \                       <font></font>
   cd /srv/ &amp;&amp; git clone https://github.com/kov-serg/get-cpcert.git &amp;&amp; \                    <font></font>
   cd get-cpcert &amp;&amp; chmod +x *.sh &amp;&amp; ./prepare.sh &amp;&amp; ./build.sh &amp;&amp; \                        <font></font>
   mkdir -p /srv/{in,out} &amp;&amp; \                                                              <font></font>
   echo '#!/bin/bash' &gt; /srv/getpem.sh &amp;&amp; \                                                 <font></font>
   echo 'cd /srv/get-cpcert' &gt;&gt; /srv/getpem.sh &amp;&amp; \                                         <font></font>
   echo './get-cpcert /srv/in/$CONT.000 $PASS &gt; /srv/out/$CONT.pem' &gt;&gt; /srv/getpem.sh &amp;&amp; \  <font></font>
   chmod +x /srv/getpem.sh                                                                  ENTRYPOINT /srv/getpem.sh</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para converter, voc√™ precisa colocar o cont√™iner de origem (um diret√≥rio do formato xxx.000) no diret√≥rio / srv / in e selecionar o pem finalizado em / srv / out. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Converter:</font></font><br>
<br>
<pre><code class="plaintext hljs"> docker run -t -i -e CONT='&lt;   ( ".000")&gt;' -e PASS='&lt;  &gt;' -v /srv/in:/srv/in -v /srv/out:/srv/out --name ecptopem &lt;  &gt;/med/ecptopem:latest </code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop e / emstart</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma vez, nossa empresa obteve um DBA Oracle muito interessante, com mais experi√™ncia na administra√ß√£o do DBMS e no desenvolvimento. E isso n√£o aconteceu imediatamente com uma conex√£o ssh com os servidores DBMS: ou ele n√£o sabe onde se conectar e como, ent√£o os acessos n√£o s√£o claramente descritos, √© imposs√≠vel encaminhar algo para si mesmo. Bem, estamos felizes em ajudar, conversamos sobre como conectar e encaminhamos o Enterprise Manager para ele. Mas com o ssh ainda n√£o deu certo. Um dos colegas explicou simplesmente: DBA puro-sangue :) Decidimos que, se precisarmos refor√ßar algo no servidor, faremos sozinhos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O EM trava com muita carga e, reiniciando-o ... voc√™ precisa se conectar via ssh e reiniciar atrav√©s do terminal. </font><font style="vertical-align: inherit;">"Os administradores sabem disso muito bem", decidiu nosso novo colega. </font><font style="vertical-align: inherit;">Grandes cargas no DBMS n√£o s√£o incomuns, solicita√ß√µes para reiniciar o EM tamb√©m s√£o frequentes. </font><font style="vertical-align: inherit;">Depois, o mesmo cen√°rio: tens√£o, irrita√ß√£o e a busca de uma solu√ß√£o para o problema. </font><font style="vertical-align: inherit;">Portanto, no mesmo grupo de bate-papos, apareceu o comando: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop e / emstart.</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/kk/yd/8j/kkyd8jikdyflvrkkoqvyens8dym.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ mate</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No caso de forte concorr√™ncia na base, e isso √†s vezes acontece, voc√™ precisa descarregar rapidamente o banco de dados. </font><font style="vertical-align: inherit;">A maneira mais r√°pida √© matar o processo problem√°tico ... Para fazer isso, conecte-se via ssh, mate -9 ... O bot ajudar√°! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jb/8q/cs/jb8qcsft8ce6jp5e7rijqtvcjti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexey apreciou a equipe e deu um nome afetuoso - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Kilyalka"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou uma arma. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma vez, depois de ver como Alex est√° tentando e sofrendo, cada vez que entra / mata xxx em cada um dos processos, decidi adicionar "multilateralismo" √† nossa arma: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/sc/kh/5dsckh_3qe5lhmvhop1pmxkt1hk.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â melhor! </font><font style="vertical-align: inherit;">Tudo para voc√™, Alex, apenas trabalhe, querida! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, o acesso a um comando t√£o importante foi limitado </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pelo user_id - "prote√ß√£o contra o tolo".</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vendo como Lesha acertou os processos no servidor de banco de dados, v√°rias pessoas tentaram digitar um comando com um n√∫mero de processo aleat√≥rio, mas voc√™ n√£o pode enganar meu bot inteligente, ele imediatamente recusou.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, apenas no caso, eu fiz um comando: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog &lt;n√∫mero de linhas&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - obt√©m o n√∫mero especificado de linhas alertlog'a O </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot puxa o alertlog e o envia para o nosso servi√ßo, como pastebin, chamado pyste, e envia um link para a pasta para o chat de solicita√ß√£o.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Verifica√ß√µes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, veio uma solicita√ß√£o para </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitorar o desempenho real de nosso aplicativo.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> At√© agora, o suporte t√©cnico para o projeto coletava esses dados manualmente. N√£o √© um acordo! Nossos valiosos testadores desenvolveram casos de teste para isso. O log de teste resultante n√£o √© muito conveniente de ler, um usu√°rio inexperiente entender√° por um longo tempo e n√£o o fato de destacar as informa√ß√µes necess√°rias. E n√£o gostamos de fazer com as m√£os o que n√£o podemos fazer com as m√£os ... Uma nova tarefa para o bot! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/--/u6/1l/--u61ld0yk0fljkwuerjn3g8zsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O comando / checks exibe um menu direto e inequ√≠voco, desta vez nossos funcion√°rios aprenderam a usar esse comando sem instru√ß√µes! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando voc√™ seleciona o item desejado, em vez do menu, aparece uma notifica√ß√£o sobre o in√≠cio do teste, para que usu√°rios impacientes n√£o executem nosso teste 100500 vezes:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/xv/sv/j7xvsv_byo8gdw7y3qweig15msq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependendo do item de menu selecionado, um teste espec√≠fico √© iniciado em nossa rede, a partir da m√°quina em que o bot vive (o jmeter √© pr√©-configurado l√°, os testes necess√°rios s√£o colocados ...) ou imediatamente no data center (da m√°quina preparada ao lado do aplicativo), para que ao testar elimine atrasos na rede, ou reduza-os. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de concluir o teste e receber o log, o bot o analisa e exibe o resultado em um formul√°rio ‚Äúleg√≠vel por humanos‚Äù:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/xp/s8/7wxps8jupg80bbq_uuywyz1-gag.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cole√ß√£o de m√©tricas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A funcionalidade foi "inserida" e os gerentes de projeto que desejam receber essa fun√ß√£o para suas regi√µes. E um gerente de projeto compassivo disse: "Quero ter estat√≠sticas a tempo!" Algu√©m do CIT disse a ela que seria conveniente monitorar tudo isso no Zabbix. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zabbix, ent√£o Zabbix ...</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pensei que era necess√°rio se preparar para a necessidade de duplicar a solu√ß√£o ... Eu projetei a id√©ia em um cont√™iner de encaixe. No cont√™iner, de acordo com a programa√ß√£o (a cada 10 minutos), o jmeter √© iniciado, adiciona o log em um local espec√≠fico, o php o analisa e exibe os dados necess√°rios na forma de uma p√°gina da web. O Zabbix usa a tecla web.page.get para acessar esta p√°gina, seleciona regularmente os dados necess√°rios para certos elementos dependentes e constr√≥i um gr√°fico.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/aq/cd/oqaqcdqj2mjodianmnwmrucyix8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que acabou n√£o sendo ruim. </font><font style="vertical-align: inherit;">Observando o gr√°fico, em primeiro lugar, vemos a velocidade aproximada da aplica√ß√£o e, se forem detectados picos no gr√°fico, sabemos aproximadamente onde est√° o ‚Äúplugue‚Äù. </font><font style="vertical-align: inherit;">Tudo √© simples. </font><font style="vertical-align: inherit;">At√© o momento, acabou sendo demandado apenas por uma regi√£o, mas estou pronto para replic√°-lo para aqueles que desejam.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desenvolvimento de aplica√ß√µes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As estat√≠sticas de tarefas do mesmo tipo n√£o faz muito tempo lan√ßaram id√©ias para simplificar e facilitar o trabalho. Em alguns projetos, em servidores de aplicativos, √© necess√°rio instalar os principais cont√™ineres do Crypto Pro, existem muitos, e a assinatura digital expirar√° com o tempo. √Äs vezes, 2 tarefas "voam" por dia. Mas considerei o uso do bot inseguro para esses fins e decidi que faria a funcionalidade diretamente no aplicativo. Naturalmente com autoriza√ß√£o e controle de acesso. Se voc√™ tiver os privil√©gios necess√°rios, um item de menu adicional estar√° dispon√≠vel para trabalhar com assinaturas digitais, instala√ß√£o, remo√ß√£o, visualiza√ß√£o de informa√ß√µes etc. etc. No momento, a funcionalidade est√° em desenvolvimento. Como se viu, isso n√£o √© muito dif√≠cil, voc√™ precisa ler um pouco as instru√ß√µes, ver exemplos de c√≥digo, perguntar a colegas mais experientes em desenvolvimento e pronto.No processo de pesquisa, surgiram id√©ias para adicionar ao aplicativo. N√£o construirei planos napole√¥nicos - h√° desenvolvimento, deixemos que todos fa√ßam suas pr√≥prias coisas. Mas, por enquanto, √© interessante - estou fazendo isso sozinho.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como eu disse, muitas id√©ias diferentes nasceram para usar nosso bot e n√£o apenas - em geral, digamos, id√©ias para "pontos de automa√ß√£o", muitas delas foram esquecidas, pois n√£o tive tempo de anot√°-las. </font><font style="vertical-align: inherit;">Agora, tento escrever tudo o que vem √† mente e recomendo que outras pessoas fa√ßam o mesmo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas Alex n√£o esquece de jogar sua lista de desejos. </font><font style="vertical-align: inherit;">Deste √∫ltimo: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_sql SQL_ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mata todas as sess√µes com uma consulta SQL_ID </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mata a sess√£o de bloqueio de raiz </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ show_em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mostra uma imagem de desempenho EM </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trick, quer costurar DBA pelo telefone =) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â assim que trabalhamos para o bem da p√°tria! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E como voc√™ se salva de tarefas rotineiras e desinteressantes?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que a leitura tenha sido interessante e talvez at√© √∫til para algu√©m, e n√£o tive tempo de cansar o leitor ... Boa sorte para todos n√≥s.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495924/index.html">Por que √© t√£o dif√≠cil criar um bom modelo de distribui√ß√£o COVID-19?</a></li>
<li><a href="../pt495926/index.html">Estamos escrevendo firmware para a TI cc2530 no Z-Stack 3.0 para rel√© Zigbee Sonoff BASICZBR3 com sensor ds18b20</a></li>
<li><a href="../pt495932/index.html">Qual √© o significado oculto dos autores no Guia SCRUM. Parte 1. Sobre o processo</a></li>
<li><a href="../pt495934/index.html">DataGovernan√ßa em casa</a></li>
<li><a href="../pt495938/index.html">Uma sele√ß√£o de artigos sobre aprendizado de m√°quina: casos, guias e estudos para mar√ßo de 2020</a></li>
<li><a href="../pt495944/index.html">TOP50 atualizado (classifica√ß√£o dos supercomputadores da CEI): din√¢mica e tend√™ncias</a></li>
<li><a href="../pt495946/index.html">Norbert Wiener: o pai distra√≠do da cibern√©tica</a></li>
<li><a href="../pt495948/index.html">Ferrugem incorporada. Desenvolvimento para processadores Cortex-M3 usando a placa de depura√ß√£o STM32F103C8T6 (Black Pill)</a></li>
<li><a href="../pt495954/index.html">Como a Cisco opera em modo de acesso remoto e em um per√≠metro ausente h√° 20 anos?</a></li>
<li><a href="../pt495956/index.html">Tenho que ir r√°pido. Otimizando solicita√ß√µes de conte√∫do de email IMAP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>