<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤱🏼 🤕 🧓🏽 Wie Gatsby Next.js umging 🧡 〽️ 👩🏼‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, arbeitet als Programmierer bei Antler. Dieses Unternehmen ist ein globaler Start...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wie Gatsby Next.js umging</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/500228/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, arbeitet als Programmierer bei Antler. </font><font style="vertical-align: inherit;">Dieses Unternehmen ist ein globaler Startup-Generator. </font><font style="vertical-align: inherit;">Bei Antler finden mehrmals im Jahr Demo-Tage statt, an denen viele Startup-Entwickler und Investoren aus der ganzen Welt zusammenkommen. </font><font style="vertical-align: inherit;">Die Situation um COVID-19 zwang Antler, seine Ereignisse in ein Online-Format zu übersetzen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/hq/r9/an/hqr9anmkfyicv4znlhi2ynk16rm.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Unternehmen wollte sicherstellen, dass Besucher ihrer virtuellen Veranstaltungen, ohne von irgendetwas abgelenkt zu werden und nirgendwo hängen zu bleiben, das Wichtigste sehen. </font><font style="vertical-align: inherit;">Die Ideen von Startups, die der Öffentlichkeit präsentiert werden, werden als Inhalt von Webseiten ausgedrückt. </font><font style="vertical-align: inherit;">Virtuelle Demonstrationstage können für ein ziemlich breites Publikum von Interesse sein. </font><font style="vertical-align: inherit;">Einige Mitglieder dieses Publikums nehmen möglicherweise zum ersten Mal an so etwas teil. </font><font style="vertical-align: inherit;">Daher musste das Unternehmen alles auf die bestmögliche Weise tun und das Hochladen von Seiten, die Startups darstellen, mit hoher Geschwindigkeit bereitstellen. </font><font style="vertical-align: inherit;">Sie entschieden, dass dies nur dann der Fall ist, wenn eine leistungsstarke progressive Webanwendung (PWA, Progressive Web App) nützlich sein kann. </font><font style="vertical-align: inherit;">Das Hauptproblem bestand darin, die richtige Technologie für die Entwicklung von PWA zu finden.</font></font><br>
<a name="habracut"></a><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f54/6f9/1fa/f546f91fa52e40c139cc78fe26b1ad06.gif"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server-Rendering oder statischer Site-Generator?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst möchte ich Ihnen den Kurs ein wenig vorstellen. Alle unsere Projekte basieren auf React und der Material-UI-Bibliothek. Aus diesem Grund haben wir uns zunächst entschieden, nicht von diesem Technologie-Stack abzuweichen, um eine hohe Entwicklungsgeschwindigkeit zu gewährleisten und das neue Projekt mit dem zu vereinbaren, was wir bereits haben. Der Hauptunterschied zwischen diesem neuen Projekt und unseren anderen React-Anwendungen bestand darin, dass die Datenbank für sie mit der Create-React-App erstellt wurde und dass sie vollständig auf dem Client gerendert wurden (CSR, Client-Side Rendering). Dies führte insbesondere dazu, dass Benutzer beim erstmaligen Laden der Anwendung gezwungen waren, einen leeren weißen Bildschirm zu beobachten, während der JavaScript-Code des Projekts geladen, verarbeitet und ausgeführt wurde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir brauchten ein kompromissloses Leistungsniveau. Aus diesem Grund haben wir uns Gedanken darüber gemacht, entweder serverseitiges Rendering (SSR, serverseitiges Rendering) oder einen statischen Site-Generator (SSG, statischer Site-Generator) zu verwenden, damit das anfängliche Laden von Anwendungen so schnell wie möglich erfolgt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Daten werden im Cloud Firestore gespeichert und wir greifen mit Algolia darauf zu. Auf diese Weise können wir auf Datenbankfeldebene den öffentlichen Zugriff auf Daten mit eingeschränkten API-Schlüsseln steuern. Dies verbessert auch die Abfrageleistung. Aus Erfahrung wissen wir, dass Algolia-Abfragen schneller als normal sind und dass das komprimierte Firestore-JavaScript-SDK </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">86 KB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> groß ist </font><font style="vertical-align: inherit;">. Im Fall von Algolia sind dies </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,5 Kb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus wollten wir die Daten, die wir unseren Kunden geben, so aktuell wie möglich gestalten. Dies würde uns helfen, fehlerhafte Daten, die versehentlich veröffentlicht werden könnten, sehr schnell zu korrigieren. Während die Standardpraxis von SSG die Implementierung relevanter Datenanforderungen während der Montage des Projekts vorsieht, haben wir erwartet, dass die Daten in unserer Datenbank ziemlich häufig geschrieben werden. Insbesondere handelt es sich um Datenaufzeichnungen, die von Administratoren über die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Firetable-</font></a><font style="vertical-align: inherit;"> Schnittstelle initiiert wurden</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und auf Initiative der Gründer der Projekte, die das Webportal nutzen. Dies führt zu einer wettbewerbsfähigen Montage des Projekts. Aufgrund der strukturellen Merkmale unserer Datenbank können geringfügige Änderungen zu neuen Projektmontagevorgängen führen. Dies macht unsere CI / CD-Pipeline äußerst ineffizient. Daher mussten die Anforderungen zum Empfangen von Daten aus dem Repository jedes Mal ausgeführt werden, wenn ein Benutzer das Laden einer Seite anfordert. Leider bedeutete dies, dass unsere Lösung kein Beispiel für ein „sauberes“ SSG-Projekt sein würde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ursprünglich wurde unsere Anwendung auf der Basis von Gatsby erstellt, da wir bereits auf Gatsby erstellte Zielseiten verwendet haben und auf einer davon bereits die Material-UI-Bibliothek verwendet wurde. </font><font style="vertical-align: inherit;">Die erste Version des Projekts bildete eine Seite, auf der während des Ladens der Daten ein "Skelett" angezeigt wurde. </font><font style="vertical-align: inherit;">Gleichzeitig lag die erste inhaltliche Farbe (FCP) im Bereich von 1 Sekunde.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d75/578/718/d7557871834d0d244f8501327d68810d.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herunterladen des "Skeletts" der Seite mit anschließendem Laden der Daten</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Die Lösung erwies sich als interessant, hatte jedoch ihre Nachteile, da die Daten für die Ausgabe der Seite auf Initiative des Kunden heruntergeladen wurden:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um den Inhalt der Seite zu sehen, müssten Benutzer auf den Download dieser Seite selbst und der darin angezeigten Daten warten, die durch 4 Anfragen an Algolia erhalten wurden.</font></font></li>
<li>    JS-    .   ,  React   «»      .         DOM.</li>
<li>         .  ,  ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus diesem Grund habe ich mich am langen Wochenende entschlossen, mit der SSR-Version des mit Next.js erstellten Projekts zu experimentieren. Zum Glück hatte die Dokumentation für Material-UI ein Beispielprojekt für Next.js. Daher musste ich dieses Framework nicht von Grund auf neu lernen. Ich musste nur einige Teile des Tutorials und der Dokumentation durchsehen. Ich habe die Anwendung in ein Projekt konvertiert, das auf dem Server gerendert wurde. Wenn ein Benutzer das Laden einer Seite angefordert hat, hat der Server Datenanforderungen ausgeführt, die zum Ausfüllen der Seite erforderlich sind. Dieser Schritt ermöglichte es uns, alle drei oben genannten Probleme zu lösen. Hier sind die Testergebnisse für zwei Anwendungsoptionen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b60/0da/cda/b600dacda702f25e97808ed9f762ff8c.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse der Recherche nach Anwendungen mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google PageSpeed ​​Insights</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Links ist Gatsby (SSG), rechts ist Next.js (SSR) ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Originalbild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der FCP für die Next.js-Version des Projekts war etwa dreimal höher als für die auf Gatsby basierende Version. Die Gatsby-Version des Projekts hatte einen Geschwindigkeitsindex von 3,3 Sekunden, während die Next.js-Version 6,2 Sekunden hatte. Die Zeit bis zum ersten Byte (TTFB, Time To First Byte) betrug 2,56 Sekunden bei Verwendung von Next.js und 10 bis 20 ms bei Verwendung von Gatsby.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass die Next.js-Version der Site für einen anderen Dienst bereitgestellt wurde (hier haben wir die Dienste ZEIT Now und Firebase Hosting verwendet - dies könnte sich auch auf die Erhöhung des TTFB auswirken). Trotzdem war klar, dass die Übertragung von Daten-Upload-Vorgängen auf den Server die Site langsamer erscheinen ließ, obwohl alle Seitenmaterialien ungefähr zur gleichen Zeit geladen wurden. Tatsache ist, dass der Benutzer in der Next.js-Version des Projekts für einige Zeit nur eine leere weiße Seite sieht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e0/8a2/ab3/6e08a2ab3bcb4c06471cc92545848d8a.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot zeigt das Laden von zwei Versionen einer Anwendung. </font><font style="vertical-align: inherit;">Der Download wurde nicht gleichzeitig abgeschlossen. </font><font style="vertical-align: inherit;">Die Datensätze werden synchronisiert, sobald Sie die Eingabetaste drücken.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
All dies gibt uns eine wichtige Lehre aus dem Bereich der Webentwicklung: Sie müssen den Benutzern visuelles Feedback geben. </font><font style="vertical-align: inherit;">Eine</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Studie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ergab, dass Anwendungen, die Skelettbildschirme verwenden, schneller geladen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus entspricht dieses Ergebnis nicht der Stimmung, die Sie möglicherweise beim Lesen von Artikeln über die Webentwicklung in den letzten Jahren hatten. </font><font style="vertical-align: inherit;">Wir sprechen nämlich von der Tatsache, dass die Verwendung der Ressourcen des Clients nichts auszusetzen hat und dass die SSR keine umfassende Lösung für Leistungsprobleme darstellt.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leistung bei der statischen Site-Generierung: Vergleich von Gatsby und Next.js.</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während die beiden betrachteten Frameworks Gatsby und Next.js für ihre Fähigkeit bekannt sind, statische Sites und Server-Rendering zu generieren, wurde die </font><font style="vertical-align: inherit;">Unterstützung für SSG </font><font style="vertical-align: inherit;">in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js 9.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verbessert, was es zu einem Konkurrenten von Gatsby macht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Zeitpunkt dieses Schreibens war die Fähigkeit von Next.js, statische Sites zu generieren, noch sehr neu. Sie war etwas mehr als einen Monat alt. Sie wird immer noch auf der ersten Seite des Projekts gemeldet. Jetzt gibt es nicht mehr viele Vergleiche der SSG-Funktionen von Gatsby und Next.js (oder vielleicht gibt es überhaupt keine derartigen Vergleiche). Aus diesem Grund habe ich beschlossen, mein eigenes Experiment durchzuführen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe die Gatsby-Version des Projekts auf den Status zurückgesetzt, als die Daten auf den Client heruntergeladen wurden, und sie so erstellt, dass beide Versionen der Anwendung genau die gleichen Funktionen haben. Ich musste nämlich entfernen, wofür Gatsby-Plugins verantwortlich sind: SEO-Funktionen, Generieren von Favoriten, PWA-Manifest. Um ausschließlich von Frameworks erstellte JavaScript-Bundles zu vergleichen, habe ich keine Bilder und andere Inhalte, die von externen Quellen heruntergeladen wurden, in die Projekte aufgenommen. Beide Versionen der Anwendung wurden auf der Firebase Hosting-Plattform bereitgestellt. Als Referenz wurden zwei Versionen der Anwendung basierend auf Gatsby 2.20.9 und Next.js 9.3.4 erstellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe Lighthouse 6 Mal für jede Version auf meinem Computer ausgeführt. Die Ergebnisse zeigten einen leichten Vorteil für Gatsby.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82a/522/059/82a522059afba13a70e62df76144b6e6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durchschnittswerte nach 6 Lighthouse-Starts für jedes Framework ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Originalbild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In Bezug auf die Gesamtleistungsbewertung lag die Next.js-Version nur geringfügig hinter der Gatsby-Version zurück. Gleiches gilt für FCP und Speed ​​Index. Die nächste mögliche Verzögerung der ersten Eingabe für die Next.js-Version der Anwendung ist geringfügig höher als für die Gatsby-Version.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um besser zu verstehen, was passiert, habe ich die Registerkarte "Netzwerk" der Chrome-Entwicklertools aufgerufen. Wie sich herausstellte, ist in der Next.js-Version des Projekts die Anzahl der Fragmente, in die der JavaScript-Code aufgeteilt wird, 3 höher als in der Gatsby-Version (ohne Manifestdateien), aber der komprimierte Code ist 20 KB kleiner. Können die zusätzlichen Anforderungen, die zum Herunterladen dieser Dateien erforderlich sind, die Vorteile eines kleineren Bundles so stark überwiegen, dass die Leistung beeinträchtigt wird?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/d84/d9a/27bd84d9aad10ae1f3421a0f829c3fa2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der Gatsby-Version des Projekts werden 7 Anforderungen ausgeführt, um 379 KB Daten herunterzuladen. In der Next.js-Version des Projekts - 12 Anforderungen zum Herunterladen von 359 KB Daten ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Originalbild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn Sie die JavaScript-Leistung analysieren, geben die Entwicklertools an, dass die Next.js-Version des Projekts zusätzliche 300 ms für das erste Rendern benötigt dass diese Version mehr Zeit für die Aufgabe "Skript auswerten" benötigt. In den Tools des Entwicklers wurde diese Aufgabe sogar als "lange Aufgabe" markiert.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24b/1be/11c/24b1be11c62fc6a1561a413555e53c0f.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse der Leistung verschiedener Projektoptionen mithilfe der Registerkarte Leistung der Chrome-Entwicklertools ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Originalbild</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ich habe den Projektcode verglichen, um festzustellen, ob es Unterschiede in der Implementierung gibt, die die Leistung beeinträchtigen könnten. Mit Ausnahme des Entfernens von unnötigem Code und Korrekturen, die mit fehlenden TypeScript-Typen verbunden sind, bestand der einzige Unterschied in der Implementierung eines reibungslosen Bildlaufs der Seite beim Verschieben zu ihren einzelnen Teilen. Diese Funktion wurde zuvor von einer Datei eingeführt</font></font><code>gatsby-browser.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und in eine</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dynamisch importierte Komponente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verschoben</font><font style="vertical-align: inherit;">. Infolgedessen würde dieser Code nur in einem Browser ausgeführt. (Wir haben das</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smooth-Scroll-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket npm verwendet</font><font style="vertical-align: inherit;">, und beim Importieren benötigt er ein Objekt</font></font><code>window</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) Dieses Problem mag der Schuldige sein, aber ich weiß nicht, wie es in Next.js behandelt wird.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby ist aus Sicht des Entwicklers bequemer</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende habe ich mich für die Gatsby-Version des Projekts entschieden. Außerdem habe ich hier den sehr kleinen Leistungsvorteil, den Gatsby im Vergleich zum SSG-Mechanismus von Next.js gezeigt hat, nicht berücksichtigt (ich werde mich nicht ernsthaft an den Vorteil von 0,6 Sekunden halten?). Tatsache ist, dass in der Gatsby-Version des Projekts bereits viele PWA-Funktionen implementiert sind, und ich habe nicht den Sinn gesehen, sie in der Next.js-Version der Anwendung erneut zu implementieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als ich gerade die erste Gatsby-Version des Projekts erstellte, konnte ich dem Projekt schnell einige nützliche PWA-Funktionen hinzufügen. Um beispielsweise jeder Seite meine eigenen Meta-Tags hinzuzufügen, die für SEO benötigt werden, musste ich nur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Handbuch lesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Um das Projekt mit einem PWA-Manifest auszustatten, musste ich nur das entsprechende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plugin verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Um das Projekt mit Favicons auszustatten, die alle verfügbaren Plattformen unterstützen (und in diesem Fall gibt es immer noch ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schreckliches Durcheinander</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), musste ich nicht einmal etwas tun, da die Favicon-Unterstützung Teil des Plugins ist, das für das Manifest verantwortlich ist. Es ist sehr bequem!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Implementieren derselben Funktionen in der Next.js-Version der Anwendung würde mehr Arbeit erfordern. Ich müsste nach Schulungshandbüchern suchen, nach allen möglichen „Best Practices“. Und die Tatsache, dass ich sowieso Erfolg haben würde, würde mir keine Vorteile bringen. Immerhin unterscheidet sich die Next.js-Version des Projekts nicht in der höheren Leistung als die Gatsby-Version. Dies war außerdem der Grund, warum ich beschlossen habe, die entsprechenden Funktionen der Gatsby-Version des Projekts einfach zu deaktivieren und mit der Next.js-Version zu vergleichen. Die Next.js-Dokumentation ist prägnanter als die Gatsby-Dokumentation (möglicherweise ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kleiner als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Ich mag das gamifizierte Next.js.-Tutorial sehr </font><font style="vertical-align: inherit;">Die umfangreichere Gatsby-Dokumentation ist jedoch bei der tatsächlichen Entwicklung von PWA wertvoller, obwohl sie auf den ersten Blick riesig aussieht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/138/800/0101388008c84ce2dda5f6f8f522cf6d.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby-Dokumentation</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Richtig, ich kann nicht über die Stärken von Next.j schweigen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dank des Tutorials und der übersichtlichen Dokumentation von Next.js scheint dieses Framework schneller zu erlernen als Gatsby.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das in Next.js verwendete Datenladesystem basiert auf asynchronen Funktionen und der Fetch-API. </font><font style="vertical-align: inherit;">Infolgedessen hat der Entwickler bei der Entwicklung von Next.js nicht das Gefühl, dass er GraphQL lernen muss, um die Funktionen des Frameworks voll nutzen zu können.</font></font></li>
<li> Next.js    TypeScript,      Gatsby        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>).     Next.js      ,     ,        ,        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dank der Tatsache, dass Next.js die SSG-Unterstützung verbessert hat, ist dieses Framework zu einem leistungsstarken Tool geworden, mit dem auf der Ebene jeder einzelnen Seite die Arbeitsweise ausgewählt werden kann. </font><font style="vertical-align: inherit;">Dies kann SSR, SSG oder CSR sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich diese Anwendung in einer vollständig statischen Form generieren könnte, würde Next.js besser zu mir passen, da ich die Standard-JS-API von Algolia verwenden und den Code zum Laden von Daten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in derselben Datei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wie halten könnte und Komponentencode. </font><font style="vertical-align: inherit;">Da Algolia keine integrierte GraphQL-API hat und es kein Gatsby-Plugin für Algolia gibt, müsste für die Implementierung eines solchen Mechanismus in Gatsby dieser Code </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einer neuen Datei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzugefügt </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">werden</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Und dies widerspricht der intuitiven deklarativen Beschreibung von Seiten.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zu zusätzlichen Möglichkeiten zur Verbesserung der Projektleistung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir das Problem der Auswahl eines Frameworks gelöst haben, kann festgestellt werden, dass es zusätzliche Möglichkeiten zur Verbesserung der Projektleistung gibt, die nicht mit dem Framework zusammenhängen. </font><font style="vertical-align: inherit;">Diese Verbesserungen können die Lighthouse-Projektbewertung auf 100 bringen.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mailingliste von March</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algolia wurde empfohlen, einen Hinweis hinzuzufügen </font></font><code>preconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um die Geschwindigkeit der Abfrageausführung weiter zu erhöhen. </font><font style="vertical-align: inherit;">(Richtig, leider wird im Newsletter das falsche Codefragment angegeben. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> richtige Code.)</font></font></li>
<li>    .   JS-  CSS-,  webpack- Gatsby.   Gatsby  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>   .  ,       ,   Netlify  Amazon S3. ,  Firebase Hosting,  ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir verwenden JPEG- und PNG-Bilder, die von Startup-Erstellern in der Anwendung hochgeladen wurden. </font><font style="vertical-align: inherit;">Wir komprimieren und optimieren sie nicht. </font><font style="vertical-align: inherit;">Die Verbesserung dieses Aspekts unserer Anwendung ist eine ziemliche Herausforderung und geht über den Rahmen dieses Projekts hinaus. </font><font style="vertical-align: inherit;">Darüber hinaus wäre es einfach großartig, wenn alle diese Bilder in das WebP-Format konvertiert würden. </font><font style="vertical-align: inherit;">Infolgedessen müssten wir Bilder nur in einem hocheffizienten Grafikformat speichern. </font><font style="vertical-align: inherit;">Leider macht das Safari WebKit-Entwicklungsteam wie bei vielen anderen PWA-Funktionen süchtig nach WebP-Unterstützung. </font><font style="vertical-align: inherit;">Jetzt ist es der einzige große Browser, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dieses Format </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">nicht unterstützt</font></a><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir kurz zusammenfassen, worüber wir hier gesprochen haben, können wir Folgendes sagen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ausgabe der "Skelett" -Version der Seite während des Ladens von Daten durch den Client erzeugt dem Benutzer das Gefühl eines schnelleren Website-Betriebs als wenn der Benutzer eine leere Seite betrachtet, während der Server Daten lädt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Gatsby-Version der Site war nur geringfügig schneller als die Next.js-Version. </font><font style="vertical-align: inherit;">Das Gatsby-Plug-In-System und die hochwertige Projektdokumentation erhöhen jedoch die Benutzerfreundlichkeit dieses Frameworks für den Entwickler.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden Sie statische Site-Generatoren oder serverseitige Rendering-Systeme, um Ihre Projekte zu beschleunigen?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500216/index.html">Vergessen Sie das Anthropozän: Wir sind in das synthetische Zeitalter eingetreten</a></li>
<li><a href="../de500218/index.html">Epidemiologisches Modell Covid-19</a></li>
<li><a href="../de500220/index.html">Schallplatten und Kassetten direkt in Ihrem Android</a></li>
<li><a href="../de500222/index.html">Schnurlostelefone von britischen Doppeldeckern aus dem Ersten Weltkrieg</a></li>
<li><a href="../de500224/index.html">DIY elektronische Nase</a></li>
<li><a href="../de500232/index.html">Akka.NET lernen: Server eines einfachen Online-Spiels</a></li>
<li><a href="../de500234/index.html">Warum ich ein persönliches Spesenabrechnungsprojekt für Git + JS gemacht habe</a></li>
<li><a href="../de500238/index.html">Sag mir, was dich stört</a></li>
<li><a href="../de500244/index.html">Außerhalb des Arrays</a></li>
<li><a href="../de500246/index.html">Schützen und Hacken der Xbox 360 (Teil 3)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>