<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕊️ ☣️ 🧑🏿 Redisのベストプラクティス、パート1 🔚 🧒🏾 🌡️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="いくつかの一連の記事で、Redis Labs公式WebサイトのRedisベストプラクティスセクションの翻訳を紹介します。
 第二部はこちら。
 
 Redisのベストプラクティス
 Redisは無数の方法で使用できますが、一般的な問題を解決するために使用できるパターンがいくつかあります。これらの問題...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Redisのベストプラクティス、パート1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485672/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかの一連の記事で</font><font style="vertical-align: inherit;">、Redis Labs公式Webサイト</font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redisベストプラクティス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションの翻訳を紹介し</font><font style="vertical-align: inherit;">ます。</font></font><div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/6y/f5/hr6yf5w1hp0fh-i5vfa0p1pxeuy.png" width="15%"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二部は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redisのベストプラクティス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisは無数の方法で使用できますが、一般的な問題を解決するために使用できるパターンがいくつかあります。</font><font style="vertical-align: inherit;">これらの問題を解決するための</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベストプラクティス</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を検討する一般的なパターンのコレクションをまとめました</font><font style="vertical-align: inherit;">。このコレクションは網羅的ではなく、Redisを使用する唯一の方法のセットではないようですが、Redisを使用して問題を解決するための出発点として役立つことを願っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドをベストプラクティスに分けて、必要に応じて章とサブチャプターに分割しました（翻訳者注：一部のサブチャプターは短いので、1つにまとめます）：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「インデックスパターン」の章では、Redisを使用した通常のキーと値のアクセスを超える方法について説明します。</font><font style="vertical-align: inherit;">これには、さまざまなRedisデータ型をインテリジェントに使用してキーパターンを使用し、データを見つけるだけでなく、アクセスの複雑さを軽減する方法も含まれます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相互作用パターンの章では、インフラストラクチャ間でデータを移動するRedisパターンに焦点を当てています。</font><font style="vertical-align: inherit;">この場合、Redisはリポジトリとしてではなく、データのガイドとして機能します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「データストレージパターン」の章では、Redisでデータの複雑な表現を保存する方法について説明しています。</font><font style="vertical-align: inherit;">単純で複雑な方法に一般化できるドキュメントの複雑なスクリプトを計算します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一時的に保存されたデータに関するパターンについては、「時系列パターン」の章で説明します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制限速度はRedisでよく使用されます。</font><font style="vertical-align: inherit;">「速度制限の基本パターン」の章では、その使用例の基本に進みます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブルームフィルターはRedisで古くから見られてきました。「ブルームフィルターを使用したパターン」の章では、確率的なデータ構造と、ありそうもない類似体との違いについて説明します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カウンターは意外と奥が深いです。</font><font style="vertical-align: inherit;">別の章では、効率的な計算方法でアクティビティと一意の要素を計算する方法を探ります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に、Luaを活用してRedisがより少ないリソースでより多くのことを行えるようにする方法について説明します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドには一貫性がないため、どの章からでも開始できます。</font><font style="vertical-align: inherit;">各投稿の冒頭にあるナビゲーションを使用して、適切なものを見つけることもできます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスパターン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
概念的には、Redisは、各データが特定のキーに関連付けられている場合、キー/値パラダイムに基づくデータベースです。</font><font style="vertical-align: inherit;">キー以外のデータを取得したい場合は、Redisで利用可能な多くのデータ型の1つを使用するインデックスを実装する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisでのインデックス作成は他のデータベースで提供されるものとはかなり異なるため、独自のユースケースとデータがインデックス作成の最良の戦略を決定します。</font><font style="vertical-align: inherit;">この章では、単純なキー/値の取得以外に、いくつかの一般的なデータ取得戦略について説明します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスとしてソートされたセット。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">辞書式インデックス;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地理空間インデックス;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPジオロケーション</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文検索;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティション化されたインデックス。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスとしてソートされたセット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
並べ替えられたセット（ZSET）はRedisの標準データ型であり、多くの一意のオブジェクト（繰り返しは保存されません）を表します。各オブジェクトは、自然な並べ替えメカニズムとして機能する番号（「カウント」と呼ばれます）に割り当てられます。</font><font style="vertical-align: inherit;">また、オブジェクトを繰り返すことはできませんが、いくつかのオブジェクトは同じスコアを持つことができます。</font><font style="vertical-align: inherit;">（ランクまたはカウントによる）値の範囲の追加、削除、および取得の時間の複雑さが比較的低いため、ソートされたセットはインデックスとして非常に適しています。</font><font style="vertical-align: inherit;">例として、世界の国々を人口でランク付けしてみましょう。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZADD countries-by-pop 1409517397 china<font></font>
&gt; ZADD countries-by-pop 146573899 russia<font></font>
&gt; ZADD countries-by-pop 81456724 germany<font></font>
&gt; ZADD countries-by-pop 333016381 usa<font></font>
&gt; ZADD countries-by-pop 1 mars<font></font>
&gt; ZADD countries-by-pop 37290812 afghanistan<font></font>
&gt; ZADD countries-by-pop 1388350202 india</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上位5か国を取得するのは簡単です。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGE countries-by-pop 0 4<font></font>
1) "mars"<font></font>
2) "afghanistan"<font></font>
3) "germany"<font></font>
4) "russia"<font></font>
5) "india"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして人口が1,000万から1,000,000,000の間の国を取得する：</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGEBYSCORE countries-by-pop 10000000 1000000000<font></font>
1) "afghanistan"<font></font>
2) "germany"<font></font>
3) "russia"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複数のインデックスを作成して、データをソートするさまざまな方法を示すことができます。</font><font style="vertical-align: inherit;">この例では、同じオブジェクトを使用できますが、人数ではなく、人口密度、地理的なサイズ、インターネットユーザーの数などを使用します。</font><font style="vertical-align: inherit;">これにより、さまざまな側面の高性能インデックスが作成されます。</font><font style="vertical-align: inherit;">さらに、オブジェクトの名前を、Redis（ハッシュなど）または別のデータストアに格納されたデータで分割することにより、必要に応じて、セカンダリプロセスで各要素に関する追加情報を取得できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">辞書式インデックス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カウントによるランキング付きのソートされたセット（ZSET）には、大まかなアルファベット順のソートメカニズムを作成するために使用できる興味深いプロパティが1つあります。</font><font style="vertical-align: inherit;">プロパティは、同じスコアを持つオブジェクトが辞書式順序で、境界値によって返されることです。</font><font style="vertical-align: inherit;">次のデータを取ります：</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZADD animal-list 0 bison 0 boa 0 dog 0 emu 0 falcon 0 alligator 0 chipmunk</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドは、いくつかの動物を動物リストキーに追加します。</font><font style="vertical-align: inherit;">各オブジェクトのスコアは0です。引数0と-1を指定してZRANGEコマンドを実行すると、奇妙な順序が表示されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGE animal-list 0 -1<font></font>
1) "alligator"<font></font>
2) "bison"<font></font>
3) "boa"<font></font>
4) "chipmunk"<font></font>
5) "dog"<font></font>
6) "emu"<font></font>
7) "falcon"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイテムはアルファベット順に追加されませんでしたが、アルファベット順にソートされて返されました。</font><font style="vertical-align: inherit;">この順序は、バイトごとのバイナリ文字列比較の結果です。</font><font style="vertical-align: inherit;">つまり、ASCII文字はアルファベット順に返されます。</font><font style="vertical-align: inherit;">これは次のことを示唆しています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小文字と大文字は同じものとして認識されません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチバイト文字は期待どおりにソートされません。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisは、辞書式検索をさらに絞り込むためのいくつかの高度な機能も提供します。</font><font style="vertical-align: inherit;">たとえば、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で始まり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で終わる</font><font style="vertical-align: inherit;">動物を返したいとし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次のコマンドを使用できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [b (f<font></font>
1) "bison"<font></font>
2) "boa"<font></font>
3) "chipmunk"<font></font>
4) "dog"<font></font>
5) "emu"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
引数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（f</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は少し混乱する可能性があります。Redisはアルファベットの文字の文字通りの理解について何も知らないため、これは重要なポイントです。これは</font><font style="vertical-align: inherit;">、後続の文字に関係なく、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始まるすべてのもの</font><font style="vertical-align: inherit;">が常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">始まるすべての前にある</font><font style="vertical-align: inherit;">ことを考慮する必要があることを意味します</font><font style="vertical-align: inherit;">もう1つの注意点は、角括弧が包含を含む検索を示し、丸括弧が包含を含まない検索を示すことです。この場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">クエリを実行すると</font><font style="vertical-align: inherit;">、リストに含まれますが、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は選択に表示されません。必要な場合最後までのすべての要素は、エンコードされた最後の文字（255または0xFF）を使用します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [c "[\xff"<font></font>
1) "chipmunk"<font></font>
2) "dog"<font></font>
3) "emu"<font></font>
4) "falcon"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドは制限することもできるため、ページ分割が確実に行われます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [b (f LIMIT 0 2<font></font>
1) "bison"<font></font>
2) "boa"<font></font>
<font></font>
&gt; ZRANGEBYLEX animal-list [b (f LIMIT 2 2<font></font>
1) "chipmunk"<font></font>
2) "dog"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
唯一の落とし穴は、インデントが増えるにつれて時間の複雑さが増すことです（LIMITの後の最初の引数）。</font><font style="vertical-align: inherit;">したがって、100万個のオブジェクトがあり、最後の2個を取得しようとしている場合は、100万個のクロールが必要になります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地理空間インデックス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisにはいくつかの地理空間インデックス作成チーム（GEOチーム）がありますが、他のチームとは異なり、これらのチームには独自のデータ型がありません。これらのコマンドは、実際にはソート済みセットのタイプを補完します。これは、geohashアルゴリズムを使用して、ソートされたセットのスコアに緯度と経度をエンコードすることで実現されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジオインデックスへの要素の追加は簡単です。道路を走行する車のグループを追跡するとします。この車のセットを単に「車」と呼びます。特定のマシンが「my-car」オブジェクトとして識別できるとしましょう（地理インデックスは単にセットの形式であるため、「オブジェクト」という用語を使用します）。セットにマシンを追加するには、次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEOADD cars -115.17087 36.12306 my-car</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の引数は追加するセットで、2番目は緯度、3番目は経度、4番目はオブジェクトの名前です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マシンの場所を更新するには、新しい座標でコマンドを再度実行する必要があります。</font><font style="vertical-align: inherit;">これが機能するのは、地理インデックスが重複した要素が許可されていない単なるセットであるためです。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEOADD cars -115.17172 36.12196 my-car</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「cars」に2台目の車を追加します。</font><font style="vertical-align: inherit;">今回はVolodyaが彼女を率いています：</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEOADD cars -115.171971 36.120609 volodias-car</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
座標を見ると、これらの車は非常に近いと言えますが、どれくらいですか？</font><font style="vertical-align: inherit;">これはGEODISTコマンドで定義できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEODIST cars my-car volodias-car<font></font>
"151.9653"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、2台の車両が約151メートル離れていることを意味します。</font><font style="vertical-align: inherit;">他の単位で計算することもできます：</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEODIST cars my-car robins-car ft<font></font>
"498.5737"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは同じ映像を返しました。</font><font style="vertical-align: inherit;">マイル（ml）またはキロメートル（km）を使用することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、特定のポイントの半径内にいる人を確認します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEORADIUS cars -115.17258 36.11996 100 m<font></font>
1) "volodias-car"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、指定されたポイントの半径100メートル以内の全員が返されました。</font><font style="vertical-align: inherit;">また、セットから任意のオブジェクトの半径内の全員をリクエストすることもできます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m<font></font>
1) "volodias-car"<font></font>
2) "my-car"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オプションのWITHDIST引数を追加して距離を含めることもできます（これはGEORADIUSまたはGEORADIUSBYMEMBERで機能します）。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m WITHDIST<font></font>
1) 1) "volodias-car"<font></font>
   2) "0.0000"<font></font>
2) 1) "my-car"<font></font>
   2) "151.9653"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GEORADIUSおよびGEORADIUSBYMEMBERのもう1つのオプションの引数はWITHCOORDで、各オブジェクトの座標を返します。</font><font style="vertical-align: inherit;">WITHDISTとWITHCOORDは、一緒にまたは別々に使用できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m WITHDIST WITHCOORD<font></font>
1) 1) "volodias-car"<font></font>
   2) "0.0000"<font></font>
   3) 1) "-115.17197102308273315"<font></font>
      2) "36.12060917648089031"<font></font>
2) 1) "my-car"<font></font>
   2) "151.9653"<font></font>
   3) 1) "-115.17171889543533325"<font></font>
      2) "36.12196018285882104"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
地理空間インデックスはソートされたセットの代替に過ぎないため、後者のいくつかの演算子を使用できます。</font><font style="vertical-align: inherit;">「cars」のセットから「my-car」を削除する場合は、ZREMのソートされたセットのコマンドを使用できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZREM cars my-car</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisは地理空間を操作するための豊富なツールセットを提供します。このセクションでは、基本的なツールのみを調べました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPジオロケーション</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接続されたサービスの実際の場所を見つけることは非常に役立ちます。 IPジオロケーションテーブルは通常非常に大きく、効果的に管理することが困難です。ソートされたセットを使用して、高速で効率的なIPジオロケーションサービスを実装できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、IPv4は10進表記で参照されます（たとえば、74.125.43.99）。ただし、ネットワークサービスはこれと同じアドレスを32ビットの数値として認識し、各バイトは10進数形式の4つの数値の1つを表します。上記の例は、16進数の0x4A7D2B63または10進数の1249717091です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPジオロケーションデータセットは広く利用可能で、通常は3つの列（開始、終了、場所）を持つ単純なテーブルの形式をとります。先頭と末尾はIPv4の10進数表現です。 Redisでは、IP範囲に「穴」がないため、ソートされたセットをこの形式に適合させることができます。したがって、ある範囲の終わりが別の範囲の始まりであると想定しても問題ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単な例として、ソートされたセットにいくつかの範囲を追加します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZADD ip-loc 1249716479 us:1<font></font>
&gt; ZADD ip-loc 1249716735 taiwan:1<font></font>
&gt; ZADD ip-loc 1249717759 us:2<font></font>
&gt; ZADD ip-loc 1249718015 finland:1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の引数は私たちのセットのキーであり、2番目はIP範囲の終わりの10進表記であり、最後はオブジェクト自体です。</font><font style="vertical-align: inherit;">セットオブジェクトのコロンの後に番号が付いていることに注意してください。</font><font style="vertical-align: inherit;">これは例を簡単にするためです。</font><font style="vertical-align: inherit;">実際のIPテーブルでは、各範囲には独自の一意の識別子（および国の名前だけでなく追加情報）があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特定のIPアドレスについてテーブルをクエリするには、ZRANGEBYSCOREコマンドをいくつかの追加の引数と共に使用できます。</font><font style="vertical-align: inherit;">IPアドレスを取得して、10進数に変換します。</font><font style="vertical-align: inherit;">これは、プログラミング言語を使用して行うことができます。</font><font style="vertical-align: inherit;">最初に、元の例74.125.43.99（1249717091）のアドレスを使用します。</font><font style="vertical-align: inherit;">この数値を基準点として最大値を指定せず、結果を最初のオブジェクトのみに制限すると、その場所がわかります。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; ZRANGEBYSCORE ip-loc 1249717091 +inf LIMIT 0 1<font></font>
1) "us:2"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の引数はソートされたセットのキー、2番目はIPアドレスの10進表記、3番目（+ inf）は上限なしでリクエストするようRedisに指示し、最後の3つの引数は最初の結果のみを取得することを単に示しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文検索</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールが登場する前は、ネイティブのRedisコマンドを使用して全文検索が実装されていました。 RedisSearchモジュールはこのパターンよりもはるかに生産的ですが、一部の環境では使用できません。さらに、このパターンは非常に興味深いものであり、RedisSearchが理想的でない他のワークロードに一般化できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検索が必要なテキストドキュメントがいくつかあるとします。キーアクセスを提供するため、これはRedisの明らかなユースケースではないかもしれませんが、一方で、Redisは完全に新しいフルテキスト検索エンジンとして使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、ドキュメント内のサンプルテキストをいくつか見てみましょう。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Redisは非常に高速です」</font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「チーターは高速です」</font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「チーターにはスポットがあります」</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらを単語のセットに分割し、簡単にするためにスペースで区切ります。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SADD ex1 redis is very fast<font></font>
&gt; SADD ex2 cheetahs are very fast<font></font>
&gt; SADD ex3 cheetahs have spots</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各行を独自のセットに配置していることに注意してください。</font><font style="vertical-align: inherit;">行全体を追加しているように見えるかもしれません-SADDは可変であり、引数として一度にいくつかの要素を取ります。</font><font style="vertical-align: inherit;">また、すべての単語を下げました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このインデックスを反転して、どの単語がどのドキュメントに含まれているかを示す必要があります。</font><font style="vertical-align: inherit;">これを行うには、単語ごとにセットを作成し、ドキュメントの名前をオブジェクトとして配置します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SADD redis ex1<font></font>
&gt; SADD is ex1<font></font>
&gt; SADD very ex1 ex2<font></font>
&gt; SADD fast ex1 ex2<font></font>
&gt; SADD cheetahs ex2 ex3<font></font>
&gt; SADD have ex3<font></font>
&gt; SADD spots ex3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明確にするために、これを異なるコマンドに分割しましたが、すべてのコマンドは通常、MULTI / EXECブロックでアトミックに実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小さな全文索引を照会するには、SINTERコマンド（セットの交差）を使用します。</font><font style="vertical-align: inherit;">「非常に」および「高速」でドキュメントを検索します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SINTER very fast<font></font>
1) "ex2"<font></font>
2) "ex1"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リクエストに一致するドキュメントがない場合、空の結果が返されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SINTER cheetahs redis<font></font>
(empty list or set)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一貫性を保つために、SINTERの代わりにSUNIONを使用することをお勧めします。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SUNION cheetahs redis<font></font>
1) "ex2"<font></font>
2) "ex1"<font></font>
3) "ex3"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスからオブジェクトを削除することはもう少し複雑です。</font><font style="vertical-align: inherit;">まず、ドキュメントからインデックス付きの単語を取得し、次に各単語からドキュメント識別子を削除します。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; SMEMBERS ex3<font></font>
1) "spots"<font></font>
2) "have"<font></font>
3) "cheetahs"<font></font>
&gt; SREM have ex3<font></font>
&gt; SREM cheetahs ex3<font></font>
&gt; SREM spots ex3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisには、1つのコマンドでこれらすべての手順を実行するための個別の演算子がないため、最初にSMEMBERSコマンドでクエリを実行し、次にSREMを使用して各オブジェクトを順番に削除する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これは非常に単純化された全文検索です。</font><font style="vertical-align: inherit;">通常のセットの代わりにソートされたセットを使用することにより、より高度なことができます。</font><font style="vertical-align: inherit;">この場合、単語がドキュメント内に複数回出現する場合、その単語が1回出現するドキュメントよりも高くランク付けできます。</font><font style="vertical-align: inherit;">上記のパターンは、使用されるセットのタイプを除いて、ほぼ同じです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティション化されたインデックス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redisの単一インスタンス（またはシャード）は非常に実用的ですが、複数のインスタンスに分散したインデックスが必要になる場合があります。たとえば、インスタンスの空き領域よりも大きいインデックスを並列化することでスループットを向上させます。複数のキーを操作したいとします。これらのキーを分離（パーティション）する効果的な方法は、各パーティションにキーを均一に分散させ、各パーティションで任意の操作を並行して実行し、最後に結果を結合することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
均一なキー配布を実現するために、非暗号化ハッシュアルゴリズムを使用します。任意の高速ハッシュ関数で十分ですが、例としてよく知られているCRC-32を使用します。ほとんどの場合、これらのアルゴリズムは結果を16進数で返します（「my-cool-document」の場合、CRC-32はF9FDB2C9を返します）。 16進数表現はマシンにとってより単純ですが、これは10進整数の単なる別の表現です。つまり、これらの値に対して計算を実行できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、パーティションの数を決定する必要があります-これは少なくともコピー数のx2である必要があります。これはさらにスケーリングに貢献します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのコピーと6つのパーティションがあるとします。ドキュメントの送信先のパーティションは、次の操作で計算できます。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x445;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x435;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x448;</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x444;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x443;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x446;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x44F;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x434;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x435;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x442;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x444;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x430;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x442;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x440;</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x434;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x443;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x435;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x442;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x430;</mo></mrow><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x447;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x441;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43B;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43E;</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x430;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x440;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x442;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x446;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x438;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x439;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="60.725ex" height="2.634ex" viewBox="0 -809.3 26145.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text><g transform="translate(430,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(813,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-5F" x="1476" y="0"></use><g transform="translate(1977,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2535,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2966,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3450,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3881,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4365,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4849,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-28" x="5245" y="0"></use><g transform="translate(5635,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6119,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6557,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6940,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(7424,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(7801,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(8285,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(8844,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(9328,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(9759,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10189,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10566,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10997,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-5F" x="11427" y="0"></use><g transform="translate(11928,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(12366,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(12796,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(13227,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(13657,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(14202,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(14585,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(15069,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(15446,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-29" x="15877" y="0"></use><g transform="translate(17433,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-6D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-6F" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-64" x="1334" y="0"></use></g><g transform="translate(19823,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(20256,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(20741,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(21123,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(21554,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/485672/&amp;usg=ALkJrhj3RMn9mne9buuLsUTqJJEbfwhV9w#MJMAIN-5F" x="21984" y="0"></use><g transform="translate(22485,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(22969,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(23400,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(23830,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(24207,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(24692,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(25176,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(25660,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mi mathvariant="normal">_</mi><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mi mathvariant="normal">_</mi><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mi mathvariant="normal">_</mi><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">\_(\_) \mod \_</script></p><br>
<br>
<pre><code class="plaintext hljs">CRC32(“my-cool-document”) = F9FDB2C9 (16)  4194153161 (10)<font></font>
4194153161 mod 6 = 5</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redis Enterpriseでは、事前定義された正規表現を使用するか、キーの一部を中括弧で囲むことにより、キーが属するパーティションを制御できます。したがって、この例では、ドキュメントのキーを次のように設定できます</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。idx：my-cool-document {5}</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次に、番号3のパーティションを発行する別のドキュメントがあるため、キーは次のようになります</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。idx：my-other-ドキュメント{3}</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
作業する必要があり、このドキュメントに関連付けられている追加の補助キーがある場合は、両方のキーを同時に使用して操作を実行できるように、同じパーティションにいる必要があります。たくさんの間違いで。これを行うには、ドキュメントと同じパーティション番号をキーに追加する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データをリモートで見ると、インデックスがパーティション間でかなり均等に分散されていることがわかります。</font><font style="vertical-align: inherit;">パーティションごとに実行する必要があるタスクを並列化できます。</font><font style="vertical-align: inherit;">インデックス全体で実行する必要があるタスクがある場合、アプリケーションはパーティションごとに同じロジックを実行し、結果を返し、アプリケーションで必要に応じて組み合わせる必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、最初の記事は終わります。</font><font style="vertical-align: inherit;">次は「相互作用パターン」と「データストレージパターン」の小見出しの翻訳になります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja485654/index.html">物理学からのアイデアは、AIがより高い次元で機能するのに役立ちます。</a></li>
<li><a href="../ja485656/index.html">機械のスカイネット：工場には労働者なしで未来はありませんか？</a></li>
<li><a href="../ja485660/index.html">DDoS保護会社自身がDDoS攻撃を仕掛けた、その創設者は認めた</a></li>
<li><a href="../ja485664/index.html">Jenkinsジョブでの動的パラメーターの作成、またはタスクをユーザーフレンドリーにする方法</a></li>
<li><a href="../ja485670/index.html">7. Fortinet Getting Started v6.0。ウイルス対策とIPS</a></li>
<li><a href="../ja485678/index.html">Javaバックエンド、Javaコアをインタビューするための質問（60の質問）</a></li>
<li><a href="../ja485682/index.html">時間管理は役に立たない：先延ばしは時間ではなく感情を調整する問題</a></li>
<li><a href="../ja485688/index.html">Myappが休日を延長</a></li>
<li><a href="../ja485692/index.html">ITスペシャリストによるお客様へのアドバイス、または混乱を自動化する方法</a></li>
<li><a href="../ja485694/index.html">ElbrusプロセッサのEmbox。または、インテリジェンスで得たものを決して忘れない</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>