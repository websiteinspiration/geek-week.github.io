<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🎨 👩🏼‍⚖️ ✊🏿 Jaringan saraf dan Proses Penambangan: mencoba berteman 👏🏿 🚵 ❓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Proses Penambangan adalah bidang analisis data yang memungkinkan Anda untuk menganalisis proses berdasarkan log sistem informasi. Karena ada sangat se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Jaringan saraf dan Proses Penambangan: mencoba berteman</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/493152/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proses Penambangan adalah bidang analisis data yang memungkinkan Anda untuk menganalisis proses berdasarkan log sistem informasi. Karena ada sangat sedikit publikasi tentang topik penggunaan pembelajaran mesin di bidang ini pada Habré, kami memutuskan untuk berbagi pengalaman kami dalam mengembangkan model prediksi untuk memecahkan masalah yang berorientasi pada proses. Sebagai bagian dari program VTB, seorang junior TI untuk para profesional TI pemula, pekerja magang dari tim Proses penambangan menguji metode pembelajaran mesin dalam konteks tugas-tugas meneliti proses-proses bank. Di bawah potongan, kita akan berbicara tentang kapan dan bagaimana kita memiliki ide untuk menyelesaikan masalah seperti itu, apa yang kita lakukan dan apa hasil yang kita dapatkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6n/hi/lg/6nhilgitc0hyxrpmzuypu6w0irg.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IT Junior Program adalah program magang tahunan untuk para profesional TI pemula di VTB Bank, yang pertama kali dimulai pada September 2019. </font><font style="vertical-align: inherit;">Magang berlangsung enam bulan. </font><font style="vertical-align: inherit;">Menurut hasil program 2019, lebih dari setengah pekerja magang bergabung dengan staf dan menjadi karyawan perusahaan. </font><font style="vertical-align: inherit;">Informasi lebih lanjut tentang program ini, awal seleksi dan persyaratan untuk kandidat dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Beginilah cara para peserta program ini mendekati tugas-tugas bank. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam sistem koordinat klasik, untuk memahami dan memformalkan proses, perlu:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melakukan wawancara dengan karyawan;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menganalisis laporan dan dokumentasi yang tersedia.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pendekatan Proses Penambangan, model proses digital dibentuk atas dasar tidak hanya pendapat ahli dari peserta proses, tetapi juga data yang relevan dari sistem informasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasilnya, kami mendapatkan model digital proses yang obyektif, yang merupakan cerminan dari pergerakan data nyata dalam sistem proses TI. Model yang dihasilkan bekerja secara real time dan memungkinkan Anda untuk menampilkan kondisi proses saat ini dengan tingkat detail yang diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">artikel</font></a><font style="vertical-align: inherit;"> kami sebelumnya</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami berbicara tentang platform Proses Penambangan kami dan tugas nyata Bank Dunia, yang diselesaikan dengan bantuannya. </font><font style="vertical-align: inherit;">Solusi yang diterapkan memungkinkan kami untuk secara signifikan mengurangi waktu yang diperlukan untuk menyiapkan laporan wajib kepada lembaga pemerintah, dan juga membantu mengidentifikasi dan mengoptimalkan ketidaksempurnaan proses, untuk membuat presentasi harian tentang status pembelian saat ini dalam pekerjaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, pelanggan kami memiliki kebutuhan tidak hanya untuk secara kualitatif menentukan kondisi proses saat ini, tetapi juga untuk memprediksi kondisi masa depannya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami akan menjelaskan langkah demi langkah bagaimana kami memecahkan masalah dalam memprediksi durasi proses pengadaan (menggunakan dataset BPI Challenge 2019 sebagai contoh) menggunakan serangkaian acara terkenal menggunakan Stasiun DGX berkinerja tinggi, yang disediakan kepada kami oleh NVIDIA untuk penelitian.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplikasi Pembelajaran Mesin untuk Proses Penambangan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memecahkan masalah, kami membangun garis dasar menggunakan CatBoostRegressor, dan kemudian mengembangkan solusi dengan jaringan saraf dan menanamkan variabel kategori. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena adanya fitur kategorikal dan material dalam data sumber, diputuskan untuk menggunakan peningkatan, yang dapat memproses fitur kategoris tanpa pengkodean, dan juga menyelesaikan masalah pada input diskrit dan material. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jaring digunakan untuk membangun atribut material sepenuhnya dan menyelesaikan masalah pada seluruh input material, dan kemudian membandingkan dua pendekatan ini dan memutuskan apakah akan peduli dengan jaring.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi Data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diputuskan untuk menggunakan data eksternal yang sesuai dengan kami di area bisnis dan memiliki serangkaian karakteristik yang serupa. </font><font style="vertical-align: inherit;">Dataset BPI Challenge 2019 yang digunakan mencakup 250 ribu kasus - ini adalah 1,5 juta peristiwa. </font><font style="vertical-align: inherit;">Data awal dijelaskan oleh satu set 21 tanda: 18 kategorikal (ada tanda indeks), dua Boolean dan satu nyata. </font><font style="vertical-align: inherit;">Waktu pelaksanaan proses pengadaan dipilih sebagai variabel target, yang sesuai dengan kebutuhan nyata bisnis. </font><font style="vertical-align: inherit;">Untuk deskripsi rinci tentang karakteristik, Anda dapat merujuk ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deskripsi dataset</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baseline</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum pelatihan model, data dibagi menjadi sampel pelatihan (kereta) dan uji (uji) dengan rasio 0,8 / 0,2. Selain itu, pembagian itu tidak terjadi menurut peristiwa, tetapi menurut kasus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menentukan seberapa tepat menggunakan solusi eksklusif yang kompleks dalam bentuk jaringan saraf, baseline dibangun menggunakan CatBoost, perpustakaan canggih gradien yang meningkatkan pada pohon keputusan. Untuk membangun garis dasar, dilakukan pemrosesan data minimal (pengkodean fitur kategoris dengan frekuensi yang sesuai dalam data), variabel target (durasi kasus) dan sejumlah fitur baru dikembangkan (selain yang sudah ada dalam dataset asli):</font></font><br>
<br>
<ul>
<li>   .  ,        :      ,         ,     ,          ,   ,      .<br>
</li>
<li>Exponential Moving Average     . EMA     ,         .<br>
</li>
<li>     (, ,  ).<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah melatih CatBoostRegressor di set pelatihan, kami mendapatkan hasil sebagai berikut: MAE (Mean Absolute Error) = 17,5 hari (yaitu, nilai variabel target yang diprediksi rata-rata 17,5 hari berbeda dari nilai sebenarnya). Hasil ini digunakan untuk menguji efektivitas jaringan saraf.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu perincian penting di sini adalah pengembangan variabel target untuk baseline.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita punya kasing. Kami menyatakannya dengan c_i dari himpunan C (himpunan semua kasus dalam dataset kami). Setiap case adalah urutan kejadian yang terurut, yaitu c_i = (e_0, ​​..., e_ni), di mana ni adalah panjang dari case ke-i. Untuk setiap acara, kami memiliki cap waktu - waktu yang tepat untuk memulai. Dengan menggunakan prangko sementara ini, Anda dapat menghitung durasi kasing tanpa acara terakhir. Namun, menetapkan target seperti itu untuk setiap peristiwa, yaitu, membuat korespondensi ek ∈ ​​ci, ek → ti (ti adalah durasi kasus ke-i), tidak terlalu baik. Pertama, kejadian serupa (tipikal) dapat terjadi pada kasus dengan durasi yang berbeda. Kedua, kami ingin memprediksi durasi kasus dari kejadian tertentu (dipesan dalam waktu) peristiwa (ini termotivasi oleh fakta bahwa kami tidak tahu seluruh urutan peristiwa, yaitu, kami tidak tahu kasus sebelumnyabagaimana itu terjadi, tetapi kami ingin membuat penilaian tentang durasi seluruh kasus berdasarkan beberapa peristiwa (yang terjadi) yang diketahui dari kasus ini).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, kita perlu memecah setiap kasus menjadi urutan panjang dari satu ke panjang kasus peristiwa yang diurutkan waktu dan menetapkan variabel target yang sama dengan durasi kasus dari mana urutan ini diperoleh, yaitu, korespondensi ci ∈ C, ci → {sub_cj} ni (ni seperti sebelumnya, panjang case ith), j = 1 dan len (sub_cj) = j. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan demikian, kami memecah setiap kasus menjadi urutan dan menetapkan durasi seluruh kasus untuk setiap urutan tersebut. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lebih lanjut tentang tindak lanjut</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Seperti yang disebutkan sebelumnya, kami membagi kasus ke bagian berikutnya dan menetapkan durasi kasus untuk masing-masing kasus. Kita akan menggunakan boosting yang sesuai dengan ukuran data input. Jadi sekarang kita memiliki X = {{sub_c </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> } </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ni </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> } </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1 N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sub_c </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ik</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah k-th berikutnya dari kasus ke-i, t </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah panjang dari kasus ke-i, N adalah jumlah kasus. Artinya, dimensi [Σ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sc, 17], </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah variabel sama dengan panjang subsequence dari kasus yang sesuai.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah pengkodean variabel kategorikal berdasarkan frekuensinya, kami memiliki variabel nyata dan Boolean, serta variabel kategorikal berkode (variabel indeks tidak akan digunakan dalam proses pembelajaran). Kita juga dapat rata-rata nilai atas suatu urutan, sementara dalam fitur kategorikal kita mendapatkan frekuensi rata-rata dari nilai-nilai kategorikal yang terjadi, yang juga dapat dianggap sebagai karakteristik yang menggambarkan agregasi dari subset peristiwa dalam suatu kasus, yaitu, sebagai karakteristik yang menggambarkan sebuah urutan. Tinggalkan dan lihat apa yang terjadi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah rata-rata sc lebih dimensi, kita memperoleh dimensi berikut: [Σ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t = 1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 17]. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bangunan model</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan kasus, kami membagi kereta ke kereta lain dan sampel validasi, mengambil CatBoostRegressor dengan parameter default, meneruskannya sampel pelatihan, memvalidasi sampel validasi, mengambil iterasi terbaik, menggunakan MAE sebagai metrik validasi. Kami mendapatkan yang berikut (pada gambar di bawah) pada tes (kami akan secara terpisah menyiapkan tes untuk pipa yang sama dengan yang dibangun kereta. Semua tanda didasarkan pada data yang ada dalam tes, yaitu, kami tidak memiliki tanda-tanda yang berfokus pada variabel target. Satu-satunya peringatan: jika fitur kategorikal dalam tes tidak memenuhi nilai yang kami lihat di kereta, maka kami mempertimbangkan frekuensi nilai ini pada tes dan memperbarui kamus untuk pengkodean). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil baseline</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/90b/f18/386/90bf183863f8ad2cdb50098c58d06a37.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
• Iterasi: 500. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Laju pembelajaran: 0,1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter pelatihan:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Waktu pelatihan: kurang dari 2 menit. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Besi: Tesla k80 (dari colab). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasil: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Tes MAE: 17,5 hari. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Durasi rata-rata kasus dalam tes: 66,3 hari.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaringan syaraf</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mendirikan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melatih jaringan saraf, data ditingkatkan: embedding untuk variabel kategori dibangun, dan distribusi variabel target disesuaikan. </font><font style="vertical-align: inherit;">Selanjutnya, jaringan saraf dilatih pada NVIDIA Tesla K80 (Google Colab) dan pada NVIDIA DGX Station. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasil-hasil berikut diperoleh:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu pelatihan di NVIDIA K80 (Google Colab): 20 menit.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu pelatihan di Stasiun NVIDIA DGX: 8 menit.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Waktu pelatihan jaringan saraf disebabkan oleh perbedaan karakteristik teknis GPU yang digunakan:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NVIDIA Tesla K80 (Google Colab)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stasiun NVIDIA DGX</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1X NVIDIA Tesla K80 12GB</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4X NVIDIA Tesla V100 32GB</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preprocessing</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tanda-tanda baru</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EMA pada nilai acara: kami ingin menangkap tren dalam biaya kegiatan untuk setiap kasus.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenis cacat: dalam deskripsi dataset Anda dapat menemukan informasi tentang empat jenis statistik deskriptif pembelian (event) - tipe-tipe ini dibagi ke dalam nilai dua variabel dalam dataset asli. </font><font style="vertical-align: inherit;">Kami hanya mengumpulkannya kembali (jika Anda melihat deskripsi dataset, akan jelas apa yang sedang kita bicarakan).</font></font><br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tanda-tanda kategoris Kami</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
hanya menyandikan nilai-nilai unik dari tanda-tanda kategorikal dengan angka alami, sehingga nantinya kami bisa mengajarkan embeddings. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embeddings untuk variabel kategori</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kami menentukan dimensi embeddings untuk setiap variabel kategori:</font></font><br>
<br>
<ul>
<li>,   ̆  ̆ ̆.    ̆ ,         ̆  ̆ ,    ̆,  .  : MUi&nbsp; = min(CAT_EMBEDDING_DIM; (len(uniquei) + 1) // 2), CAT_EMBEDDING_DIM — , uniquei —   i-  .<br>
</li>
<li> ,      3,       i-̆ ̆   max(3;MUi)+1,  1,        ,     train,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">unk</a>-.<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menyesuaikan distribusi target pada sampel kereta api.</font></font></b>&nbsp;<br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Distribusi awal ternyata sangat bergeser ke kiri karena pencilan (kasus yang bertahan 250 ribu hari) dan sejumlah besar kasus pendek, jadi kami menghitung 0,05 dan 0,95 persentil dan meninggalkan data dari kereta dengan target antara jeram ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, kami masih memiliki kasus yang berlangsung sekitar satu dan sekitar 100 hari, yaitu variabel target melewati beberapa urutan besarnya. Oleh karena itu, asumsi bahwa varians konstan dalam distribusi variabel target di sekitar algoritma keputusan hampir tidak terpenuhi, yaitu, distribusi variabel target mendekati normal, tetapi varians tidak konstan karena fakta bahwa variabel target dapat kurang dari 1 atau lebih dari 100. Oleh karena itu, untuk setidaknya entah bagaimana tingkat efek ini, kami menormalkan data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya ditunjukkan pada grafik di bawah ini (garis hitam adalah distribusi normal).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k4/qs/vz/k4qsvz1egedfnm9q4y6nljidoam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kami membagi berdasarkan kasus data kami menjadi kereta dan validasi. </font><font style="vertical-align: inherit;">Ada juga nuansa yang jelas di sini: kita menormalkan target dengan rata-rata dan penyimpangan, dihitung berdasarkan semua data, dan kemudian dibagi dengan kereta api dan validasi, yaitu, ternyata seperti wajah di kereta, tetapi karena kita menyelesaikan masalah tambahan di sini, wajah ini tidak tampak kritis.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tanda-tanda bangunan</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ide</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami hanya mengambil tanda-tanda kategoris dari kereta kami, dikodekan oleh bilangan alami.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami tidak mengambil substring dari kasus, tetapi hanya peristiwa, yaitu, satu baris dalam data kami untuk pernikahan - ini adalah salah satu peristiwa yang ditandai oleh fitur kategorikal yang dikodekan.</font></font><br>
</li>
<li> :     ,   ̆,      ,   ,        ,            ̆  ̆    ̆. - ,         ̆,  ,  ,     ̆ (    ),      (     ,  - ̆  ).<br>
</li>
<li>       ̆        .<br>
</li>
<li>     ,     8-̆̆   elu   ̆,   (  ,   ,     ,  L2-)     .<br>
</li>
<li>,           , —    ,      ,    .<br>
</li>
<li>Summary:    — ̆  ̆ ̆ ̆        —  ̆.<br>
</li>
</ul><br>
<h3>   </h3><br>
<ul>
<li>Batch size = 1000</li>
<li>Learning rate = 3e-04.</li>
<li>  = 15.</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station .</li>
<li> (colab) – 50 .</li>
<li> (Nvidia DGX Station) — 18 .</li>
</ul><br>
<img src="https://habrastorage.org/webt/53/4y/gh/534yghkinehatjl8cm1xwg5j0oi.png"><br>
<br>
<h3> </h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persiapan data</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang kami memiliki embeddings untuk variabel kategori (ada nuansa di sini: kami dengan jujur ​​mengambil nilai-nilai unik dari variabel kategori di kereta kami (bukan pada yang kami alokasikan untuk embeddings pelatihan, tetapi pada yang kami alokasikan di awal untuk pelatihan), oleh karena itu ada kemungkinan bahwa pada data uji akan ada nilai variabel kategori yang tidak kita lihat di kereta, yaitu, kita tidak memiliki pelatihan penanaman untuk nilai ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk nilai-nilai seperti itu, garis terpisah dibuat dalam matriks penanaman, tetapi dalam kasus kami masalahnya adalah bahwa selama pelatihan itu tidak terlibat, dan karena itu tidak belajar. Berdasarkan hal ini, jika kita memenuhi nilai variabel kategori yang tidak terlihat sebelumnya, maka kita mengambil vektor ini, tetapi sebenarnya itu hanya diambil dari distribusi inisialisasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam cara melatih vektor ini, ada arah untuk meningkatkan model. Idenya adalah bahwa nilai yang sangat langka di kereta dapat dikodekan dengan vektor ini, karena jika kita melihat nilai baru hanya dalam tes, yang secara kondisional membentuk 20% dari seluruh sampel awal, maka nilai ini jarang dan mungkin berperilaku sama dengan nilai langka di kereta.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam setiap peristiwa, kami mengganti variabel kategori dengan embedding yang sesuai, terhubung dengan atribut nyata dan Boolean, kami memperoleh matriks ukuran [N, F], di mana F adalah jumlah dimensi embed untuk variabel kategori, jumlah atribut nyata dan Boolean. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melakukan pengelompokan acara di acara berikutnya (seperti yang dilakukan sebelumnya). </font><font style="vertical-align: inherit;">Variabel target untuk urutan adalah durasi kasus dari mana urutan tersebut diperoleh. </font><font style="vertical-align: inherit;">Tambahkan jumlah acara dan jumlah biaya peristiwa dalam urutan ini ke vektor urutan berikutnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita memiliki matriks ukuran tetap - Anda dapat memasukkan ke dalam model (sebelum itu kita menormalkan matriks). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode paralelisasi</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami membuat menara untuk setiap GPU.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di setiap langkah, kami membagi parameter di antara menara.</font></font><br>
</li>
<li>       .<br>
</li>
<li> ̆   ,   .<br>
</li>
<li>       (      ,       ̆ ̆         ).<br>
</li>
<li>        .<br>
</li>
<li>     ,   -  (   ,  word2vec-style,     ).<br>
</li>
</ul><br>
<b></b><br>
<br>
<ul>
<li>          ()   ()  ().<br>
</li>
<li>̆ :   —   ,     gpu     ,    ,   gpu     .<br>
</li>
</ul><br>
<b></b><br>
<br>
<ul>
<li>: 7-̆̆    elu.<br>
</li>
<li>   ̆ ,    .<br>
</li>
<li>Batch size = 1000.<br>
</li>
<li>Learning rate = 3e-04.<br>
</li>
<li>  = 15.<br>
</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station.<br>
</li>
<li> (colab) = 20 .<br>
</li>
<li> (Nvidia DGX Station) = 8 .<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sepotong grafik model. </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/u5/4e/3e/u54e3eoth5n5kmcdryndbpqgcua.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsumsi sumber daya dan paralelisasi.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pelatihan jaringan saraf pada CPU membutuhkan waktu sekitar empat kali lebih banyak daripada di NVIDIA DGX Station. Dalam hal ini, perbedaannya tampaknya tidak signifikan - delapan menit pada NVIDIA DGX Station dan 32 menit pada CPU. Namun, ini adalah model kecil dengan sejumlah kecil data. Saat mengimplementasikan proyek nyata, di mana akan ada beberapa kali lebih banyak kasus dan peristiwa, pelatihan pada CPU akan memakan waktu setidaknya seminggu. Dalam hal ini, penggunaan Stasiun NVIDIA DGX akan mengurangi waktu pelatihan menjadi dua hari, yang akan sangat meningkatkan efisiensi kerja.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga terungkap bahwa kecepatan proses pembelajaran sangat tergantung pada jumlah GPU yang digunakan, yang menunjukkan keunggulan NVIDIA DGX Station.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini dikonfirmasi oleh percobaan sebelumnya pada NVIDIA DGX Station CPU dan GPU menggunakan kumpulan data asli tanpa pemrosesan awal:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu belajar pada CPU: 6 menit 18 detik.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu pelatihan GPU: 34 detik.</font></font><br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Visualisasi beban </font></b><b><font style="vertical-align: inherit;">GPU </font></b></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/6f1/015/d82/6f1015d82101dda1e0af40e599ee96a2.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisasi beban CPU</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/efe/3ae/f3b/efe3aef3b801dcbd14655b3851ae9ad3.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil jaringan saraf</font></font></h3><br>
<img src="https://habrastorage.org/webt/-g/2g/p1/-g2gp1o1sdktbwtspcurjfdiwqu.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tes MAE = 10 hari.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durasi rata-rata kasus pada tes = 67 hari.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu inferensi = 20 detik.</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temuan</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menerapkan uji coba untuk mengevaluasi metode pembelajaran mesin dalam konteks tugas Penambangan Proses.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menguji dan memperluas daftar alat kami yang dengannya kami akan memecahkan masalah yang penting bagi bisnis.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salah satu hasil yang menarik adalah penulisan implementasi komputasi paralel kami sendiri pada 4 kartu Tesla v100 yang dilengkapi dengan stasiun DGX: penggunaan beberapa GPU mempercepat belajar hampir sejalan dengan jumlah GPU (kode diparalelkan).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transisi ke entri yang sepenuhnya kontinu dan penggunaan jaringan saraf memungkinkan untuk mengambil satu minggu dari baseline.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu meningkat dari beberapa menit menjadi satu setengah jam (pelatihan arsitektur akhir dan embeddings, tetapi embeddings dapat digunakan sebelum pelatihan, sehingga waktu dikurangi menjadi 20 menit).</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eksperimen yang dijelaskan menunjukkan bahwa di bidang Penambangan proses, mesin dan algoritma pembelajaran yang mendalam dapat berhasil diterapkan. </font><font style="vertical-align: inherit;">Selain itu, terungkap bahwa kecepatan proses pembelajaran sangat tergantung pada jumlah GPU yang digunakan, yang menunjukkan keunggulan NVIDIA DGX Station.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa dan bagaimana bisa diperbaiki</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Word2vec-style embeddings untuk acara</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ketika kami membuat model kami, termasuk embeddings untuk variabel kategori, kami tidak memperhitungkan urutan kejadian relatif satu sama lain, yaitu, semantik khusus peristiwa dalam kasus. </font><font style="vertical-align: inherit;">Untuk mempelajari sesuatu yang berguna dari urutan kejadian di dalam kasing, Anda perlu melatih embeddings untuk acara ini. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ide</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengambil satu fitur kategorikal dan satu nyata, membagi yang nyata dengan ember, maka setiap transaksi akan ditandai dengan nilai variabel kategorikal dan ember tempat nilai variabel riil jatuh. </font><font style="vertical-align: inherit;">Kombinasikan kedua nilai ini, kita dapatkan, seolah-olah, analog dari kata untuk acara tersebut.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menganggap kasus sebagai kalimat (himpunan kata dalam kalimat sesuai dengan himpunan peristiwa dalam kasus).</font></font><br>
</li>
<li> ̆      ,          ̆   ̆,    ,             .<br>
</li>
<li>   ̆,     Skipgram  CBOW   .<br>
</li>
<li>  ,      ̆,            .<br>
</li>
</ul><br>
<b> </b><br>
<br>
<ul>
<li>  Skipgram.<br>
</li>
<li>  — 5.<br>
</li>
</ul><br>
<ul>
<li>Batch size = 1000.<br>
</li>
<li>Learning rate = 3e-04.<br>
</li>
<li>  = 10.<br>
</li>
<li>: Tesla k80 (colab) + Nvidia DGX Station.<br>
</li>
<li> (colab) — 20 .<br>
</li>
<li> (Nvidia DGX Station) — 8 .<br>
</li>
<li>Test MAE    : 10 ̆.&nbsp;<br>
</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hitung</font></font></b><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/438/137/cb8/438137cb87ac22637e44a01da4a56dfc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Menggunakan fitur dari embeddings memberi peningkatan beberapa persepuluh hari. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embeddings ternyata, tentu saja, tidak berpendidikan, karena mereka sedikit terlatih.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada sekitar 290 fitur dari pernikahan kategori, dan 20 fitur dari pernikahan semantik (tidak masuk akal untuk dilakukan karena ukuran kamusnya kecil), sehingga pengaruh fitur-fitur semantik ini dapat diratakan karena ketidakseimbangan dalam proporsi fitur.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semantik antara peristiwa perlu entah bagaimana ditambahkan ke set pelatihan, karena karena fakta bahwa urutan peristiwa (kasus) dipesan, urutan masalah, dan informasi dapat diekstraksi dari ini.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat menggunakan arsitektur yang lebih canggih untuk hiasan pernikahan.</font></font><br>
</li>
<li>      ,       ,    —     .<br>
</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id493138/index.html">Bicaralah padaku: apa yang dapat dilakukan oleh robot suara hari ini</a></li>
<li><a href="../id493140/index.html">Petualangan Cipollino: Karantina IT Quest dari Flant</a></li>
<li><a href="../id493142/index.html">"Ayo gunakan Kubernet!" Anda sekarang memiliki 8 masalah</a></li>
<li><a href="../id493146/index.html">Proyek sampingan menarik yang dapat Anda lakukan hari ini</a></li>
<li><a href="../id493150/index.html">"Remote" dengan router Cisco</a></li>
<li><a href="../id493158/index.html">Loghouse 0.3 - pembaruan yang lama ditunggu-tunggu dari sistem logging kami di Kubernetes</a></li>
<li><a href="../id493160/index.html">Bagaimana kami meningkatkan Pencarian Cerdas di hh.ru pada tahun 2019: infografis</a></li>
<li><a href="../id493162/index.html">Daftar terbuka rapat dan konferensi online</a></li>
<li><a href="../id493164/index.html">Ternyata bisnis online bertahan di lingkungan saat ini. Mengapa? DNA dihapus</a></li>
<li><a href="../id493166/index.html">Ontol: pilihan artikel tentang "burnout" [100+]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>