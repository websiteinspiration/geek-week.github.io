<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§§ üë©üèæ üë©üèΩ‚Äç‚úàÔ∏è Inexpresiblemente atractivo: c√≥mo creamos un haniot que no puede ser expuesto üë®‚Äçüë¶ üë∂üèø üï∫üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", - - ‚Äî , ¬´ ¬ª . , : , . , , , . , , ¬´Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats¬ª. ‚Äî . 
 
  : -
 La tarea principa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Inexpresiblemente atractivo: c√≥mo creamos un haniot que no puede ser expuesto</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="imagen"><br>
<i> , -       - ‚Äî ,  ¬´  ¬ª        .    ,      :   ,        .     ,    ,        ,    .  ,   ,      ¬´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</a>¬ª.     ‚Äî   . </i><br>
<a name="habracut"></a><br>
<h3> : -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tarea principal en la creaci√≥n de nuestra s√∫per trampa fue evitar que fu√©ramos expuestos por hackers que mostraron inter√©s en ella. </font><font style="vertical-align: inherit;">Para hacer esto, tuve que hacer mucho trabajo:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cree una leyenda realista sobre la empresa, incluido el nombre y la foto de los empleados, n√∫meros de tel√©fono y correos electr√≥nicos.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inventar e implementar un modelo de infraestructura industrial que corresponda a la leyenda de nuestra empresa. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decida qu√© servicios de red estar√°n disponibles en el exterior, pero no se involucre en la apertura de puertos vulnerables para que no parezca una trampa para los focos. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organice la aparici√≥n de fugas de informaci√≥n sobre el sistema vulnerable y difunda esta informaci√≥n entre los posibles atacantes.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implemente una vigilancia discreta de los piratas inform√°ticos en la infraestructura de la trampa. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora, lo primero es lo primero.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creando una leyenda</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los ciberdelincuentes ya est√°n acostumbrados al hecho de que se enfrentan a muchas manipulaciones, por lo que la parte m√°s avanzada realiza un estudio en profundidad de cada sistema vulnerable para asegurarse de que esto no sea una trampa. Por la misma raz√≥n, nos esforzamos por lograr no solo el realismo del hanipot en t√©rminos de dise√±o y aspectos t√©cnicos, sino tambi√©n crear la apariencia de una empresa real. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Poni√©ndonos en el lugar de un hipot√©tico kulhaker, desarrollamos un algoritmo de verificaci√≥n que distinguir√≠a un sistema real de una trampa. Incluy√≥ la b√∫squeda de direcciones IP de la empresa en sistemas de reputaci√≥n, la investigaci√≥n inversa del historial de direcciones IP, la b√∫squeda de nombres y palabras clave relacionadas con la empresa, as√≠ como sus contrapartes y muchas otras cosas. Como resultado, la leyenda result√≥ ser bastante convincente y atractiva.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidimos posicionar la f√°brica de trampas como una peque√±a boutique de prototipos industriales, trabajando para clientes an√≥nimos muy grandes del segmento militar y de aviaci√≥n. Esto elimin√≥ las dificultades legales asociadas con el uso de una marca existente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, tuvimos que idear una visi√≥n, misi√≥n y nombre de la organizaci√≥n. Decidimos que nuestra empresa ser√≠a una startup con un peque√±o n√∫mero de empleados, cada uno de los cuales es fundador. Esto agreg√≥ credibilidad a la leyenda de la especializaci√≥n de nuestro negocio, lo que le permite trabajar con proyectos delicados para clientes grandes e importantes. Quer√≠amos que nuestra empresa se viera d√©bil en t√©rminos de ciberseguridad, pero al mismo tiempo era obvio que est√°bamos trabajando con activos importantes en los sistemas objetivo.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de pantalla del sitio MeTech Hanipot. Fuente: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Elegimos la palabra MeTech como nombre de la empresa. El sitio se cre√≥ sobre la base de una plantilla gratuita. Las im√°genes fueron tomadas de bancos de fotos, utilizando las m√°s impopulares y refinadas para hacerlas menos reconocibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quer√≠amos que la empresa se viera real, por lo que tuvimos que agregar empleados con habilidades profesionales correspondientes al perfil del negocio. Se nos ocurrieron nombres y personalidades para ellos, y luego intentamos seleccionar im√°genes de bancos de fotos de acuerdo con su origen √©tnico. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="imagen"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captura de pantalla del sitio MeTech Hanipot. Fuente: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para no revelarnos, est√°bamos buscando fotos grupales de buena calidad de las cuales pudi√©ramos elegir las caras que necesit√°bamos. </font><font style="vertical-align: inherit;">Sin embargo, luego abandonamos esta opci√≥n, ya que un cracker potencial podr√≠a aprovechar la b√∫squeda inversa de im√°genes y descubrir que nuestros "empleados" viven solo en bancos de fotos. </font><font style="vertical-align: inherit;">Al final, aprovechamos las fotograf√≠as de personas inexistentes creadas usando redes neuronales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los perfiles de los empleados publicados en el sitio conten√≠an informaci√≥n importante sobre sus habilidades t√©cnicas, pero evitamos las instrucciones de instituciones educativas y ciudades espec√≠ficas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para crear buzones, utilizamos el servidor del proveedor de alojamiento y luego alquilamos varios n√∫meros de tel√©fono en los EE. UU. Y los combinamos en una central telef√≥nica virtual con un men√∫ de voz y un contestador autom√°tico.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infraestructura Hanipot</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para evitar la exposici√≥n, decidimos usar una combinaci√≥n de equipos industriales reales, computadoras f√≠sicas y m√°quinas virtuales seguras. </font><font style="vertical-align: inherit;">Mirando hacia el futuro, decimos que verificamos el resultado de nuestros esfuerzos utilizando el motor de b√∫squeda Shodan, y demostr√≥ que el hanipot parece un sistema industrial real. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El resultado de escanear un hanipot con Shodan. </font><font style="vertical-align: inherit;">Fuente: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Utilizamos cuatro PLC como hardware para nuestra trampa:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dos AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estos PLC fueron seleccionados por su popularidad en el mercado global de sistemas de control. </font><font style="vertical-align: inherit;">Y cada uno de estos controladores utiliza su propio protocolo, que nos permite verificar cu√°l de los PLC atacar√° con m√°s frecuencia y si interesar√°n a alguien en principio. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El equipo de nuestra trampa de "f√°brica". </font><font style="vertical-align: inherit;">Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
No solo colocamos piezas de hierro y las conectamos a Internet. </font><font style="vertical-align: inherit;">Programamos cada controlador para realizar tareas, entre las cuales estaban</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mezcla</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">control de quemador y cinta transportadora,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paletizar con un brazo rob√≥tico.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y para que el proceso de producci√≥n sea realista, programamos la l√≥gica para cambiar aleatoriamente los par√°metros de retroalimentaci√≥n, simular el arranque y la parada de los motores, encender y apagar el quemador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra f√°brica ten√≠a tres computadoras virtuales y una f√≠sica. Las m√°quinas virtuales se utilizaron para controlar la planta, el robot de paletizaci√≥n y como el lugar de trabajo automatizado del ingeniero de software PLC. La computadora f√≠sica funcionaba como un servidor de archivos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de monitorear los ataques en el PLC, quer√≠amos monitorear el estado de los programas descargados en nuestros dispositivos. Para hacer esto, creamos una interfaz que nos permiti√≥ determinar r√°pidamente c√≥mo se modificaron los estados de nuestros actuadores e instalaciones virtuales. Ya en la etapa de planificaci√≥n, descubrimos que es mucho m√°s f√°cil implementar esto con la ayuda de un programa de control que a trav√©s de la programaci√≥n directa de la l√≥gica del controlador. Abrimos el acceso a la interfaz de gesti√≥n de dispositivos de nuestro hanipot a trav√©s de VNC sin contrase√±a.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los robots industriales son un componente clave de la fabricaci√≥n inteligente moderna. En este sentido, decidimos agregar un robot y AWP para controlarlo en el equipo de nuestra trampa de f√°brica. Para hacer que la "f√°brica" ‚Äã‚Äãsea m√°s realista, instalamos un software real en el control AWP, que los ingenieros utilizan para programar gr√°ficamente la l√≥gica del robot. Bueno, dado que los robots industriales generalmente se encuentran en una red interna aislada, decidimos dejar el acceso VNC desprotegido solo a la administraci√≥n de la estaci√≥n de trabajo. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entorno RobotStudio con un modelo 3D de nuestro robot. Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En una m√°quina virtual con una estaci√≥n de trabajo de control de robot, instalamos el entorno de programaci√≥n RobotStudio de ABB Robotics. </font><font style="vertical-align: inherit;">Despu√©s de configurar RobotStudio, abrimos un archivo de simulaci√≥n con nuestro robot para que su imagen 3D fuera visible en la pantalla. </font><font style="vertical-align: inherit;">Como resultado, Shodan y otros motores de b√∫squeda, habiendo descubierto un servidor VNC desprotegido, recibir√°n esta imagen de la pantalla y se la mostrar√°n a aquellos que buscan robots industriales con acceso abierto para controlar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El significado de tal atenci√≥n al detalle era crear un objetivo atractivo y m√°s realista para los atacantes que, al descubrirlo, volver√≠an a √©l una y otra vez.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingeniero AWP</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para programar la l√≥gica del PLC, agregamos una computadora de ingenier√≠a a la infraestructura. </font><font style="vertical-align: inherit;">Se instal√≥ un software industrial para la programaci√≥n del PLC:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIA Portal para Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix para el controlador Allen-Bradley,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One para Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidimos que la estaci√≥n de trabajo de ingenier√≠a no ser√≠a accesible fuera de la red. </font><font style="vertical-align: inherit;">En su lugar, configuramos la misma contrase√±a para la cuenta de administrador que en las estaciones de trabajo del control de robot y las estaciones de trabajo de la f√°brica accesibles desde Internet. </font><font style="vertical-align: inherit;">Esta configuraci√≥n es bastante com√∫n en muchas empresas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desafortunadamente, a pesar de todos nuestros esfuerzos, ning√∫n atacante alcanz√≥ el AWP del ingeniero.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor de archivos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo necesit√°bamos como se√±uelo para los intrusos y como un medio para respaldar nuestro propio "trabajo" en una f√°brica de trampas. Esto nos permiti√≥ compartir archivos con nuestro haniot utilizando dispositivos USB, sin dejar rastros en la trampa de la red. Como sistema operativo para el servidor de archivos, instalamos Windows 7 Pro, en el que hicimos una carpeta compartida accesible para leer y escribir a cualquiera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, no hicimos ninguna jerarqu√≠a de carpetas y documentos en el servidor de archivos. Sin embargo, result√≥ que los atacantes estaban estudiando activamente esta carpeta, por lo que decidimos llenarla con varios archivos. Para hacer esto, escribimos un script de Python que cre√≥ un archivo de tama√±o aleatorio con una de las extensiones especificadas, formando un nombre basado en el diccionario. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un script para generar nombres de archivo atractivos. Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de ejecutar el script, obtuvimos el resultado deseado en forma de una carpeta llena de archivos con nombres muy interesantes. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El resultado del gui√≥n. </font><font style="vertical-align: inherit;">Fuente: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entorno de vigilancia</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habiendo gastado tanto esfuerzo en crear una empresa realista, simplemente no pod√≠amos permitirnos inyectarnos en el entorno para monitorear a nuestros "visitantes". Tuvimos que obtener todos los datos en tiempo real para que los atacantes no se dieran cuenta de que estaban siendo vigilados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementamos esto usando cuatro adaptadores USB-Ethernet, cuatro acopladores Ethernet SharkTap, Raspberry Pi 3 y una gran unidad externa. El esquema de nuestra red se ve√≠a as√≠: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esquema de una red de hanipot con equipo de monitoreo. Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Organizamos tres toques SharkTap para monitorear todo el tr√°fico externo a los PLC a los que solo se puede acceder desde la red interna. El cuarto SharkTap rastre√≥ el tr√°fico de invitados de la m√°quina virtual vulnerable.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acoplador Ethernet SharkTap y enrutador Sierra Wireless AirLink RV50. </font><font style="vertical-align: inherit;">Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi llev√≥ a cabo la captura diaria de tr√°fico. </font><font style="vertical-align: inherit;">Establecimos una conexi√≥n a Internet utilizando el enrutador celular Sierra Wireless AirLink RV50, que a menudo se utiliza en empresas industriales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desafortunadamente, este enrutador no permiti√≥ el bloqueo selectivo de ataques que no cumpl√≠an con nuestros planes, por lo que agregamos el firewall Cisco ASA 5505 en modo transparente a la red para realizar el bloqueo con un impacto m√≠nimo en la red.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An√°lisis de tr√°fico</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark y tcpdump son apropiados para resolver r√°pidamente los problemas actuales, pero en nuestro caso sus capacidades no fueron suficientes, ya que ten√≠amos muchos gigabytes de tr√°fico, que fueron analizados por varias personas. </font><font style="vertical-align: inherit;">Utilizamos el analizador de c√≥digo abierto Moloch desarrollado por AOL. </font><font style="vertical-align: inherit;">En t√©rminos de funcionalidad, es comparable a Wireshark, pero tiene m√°s funciones para colaboraci√≥n, descripci√≥n y etiquetado de paquetes, exportaci√≥n y otras tareas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no quer√≠amos procesar los datos recopilados en las computadoras hanipot, los volcados de PCAP se exportaron todos los d√≠as al repositorio de AWS, desde donde ya los importamos a la m√°quina con Moloch.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grabaci√≥n de pantalla </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para documentar las acciones de los crackers en nuestro hanipot, escribimos un script que tomaba capturas de pantalla de la m√°quina virtual en un intervalo determinado y, en comparaci√≥n con la captura de pantalla anterior, determinamos si algo estaba sucediendo all√≠ o no. </font><font style="vertical-align: inherit;">Cuando se detect√≥ actividad, el gui√≥n inclu√≠a una grabaci√≥n de pantalla. </font><font style="vertical-align: inherit;">Este enfoque ha demostrado ser el m√°s efectivo. </font><font style="vertical-align: inherit;">Tambi√©n intentamos analizar el tr√°fico VNC del volcado de PCAP para comprender qu√© cambios ocurrieron en el sistema, pero al final, la grabaci√≥n de pantalla que implementamos result√≥ ser m√°s simple y visual.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoreo de sesiones de VNC</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para esto, utilizamos Chaosreader y VNCLogger. </font><font style="vertical-align: inherit;">Ambas utilidades extraen las pulsaciones de teclas del volcado de PCAP, pero VNCLogger maneja teclas como Retroceso, Entrar, Ctrl m√°s correctamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger tiene dos inconvenientes. </font><font style="vertical-align: inherit;">Primero: solo puede extraer claves al "escuchar" el tr√°fico en la interfaz, por lo que tuvimos que simular una sesi√≥n de VNC para ello usando tcpreplay. </font><font style="vertical-align: inherit;">El segundo inconveniente de VNCLogger es com√∫n con Chaosreader: ambos no muestran el contenido del portapapeles. </font><font style="vertical-align: inherit;">Para hacer esto, tuve que usar Wireshark.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atraer a los piratas inform√°ticos</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creamos un hanipot para ser atacado. </font><font style="vertical-align: inherit;">Para lograr esto, organizamos una fuga de informaci√≥n dise√±ada para atraer la atenci√≥n de posibles crackers. </font><font style="vertical-align: inherit;">Los siguientes puertos se abrieron en el hanipot: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="imagen"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El puerto RDP tuvo que cerrarse poco despu√©s del inicio del trabajo, porque debido a la gran cantidad de tr√°fico de escaneo en nuestra red, hubo problemas de rendimiento. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los terminales VNC primero funcionaron en el modo "solo lectura" sin contrase√±a, y luego los cambiamos "por error" al modo de acceso completo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para atraer a los atacantes, publicamos dos publicaciones con informaci√≥n filtrada sobre el sistema industrial disponible en PasteBin. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una de las publicaciones publicadas en PasteBin para atraer ataques. </font><font style="vertical-align: inherit;">Fuente: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los ataques</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los Hanipot vivieron en l√≠nea durante unos siete meses. El primer ataque ocurri√≥ un mes despu√©s del lanzamiento de Hanipot en l√≠nea. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esc√°neres</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Hubo mucho tr√°fico de esc√°neres de compa√±√≠as conocidas: ip-ip, Rapid, Shadow Server, Shodan, ZoomEye y otros. Hab√≠a tantos de ellos que tuvimos que excluir sus direcciones IP del an√°lisis: 610 de 9452 o el 6.45% de todas las direcciones IP √∫nicas pertenec√≠an a esc√°neres completamente leg√≠timos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estafadores</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Uno de los mayores riesgos que tuvimos que enfrentar fue el uso de nuestro sistema con fines delictivos: comprar tel√©fonos inteligentes a trav√©s de la cuenta de un suscriptor, retirar millas de aerol√≠neas con tarjetas de regalo y otros tipos de fraude </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mineros</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de los primeros visitantes de nuestro sistema result√≥ ser un minero. Carg√≥ el software de miner√≠a Monero. No habr√≠a podido ganar mucho en nuestro sistema espec√≠fico debido a la baja productividad. Sin embargo, si combinamos los esfuerzos de varias decenas o incluso cientos de tales sistemas, podr√≠a resultar bastante bien. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extorsionistas</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante el funcionamiento del hanipot, nos encontramos dos veces con virus ransomware reales. En el primer caso, fue Crysis. Sus operadores iniciaron sesi√≥n en el sistema a trav√©s de VNC, pero luego instalaron TeamViewer y ya realizaron m√°s acciones con √©l. Despu√©s de esperar un mensaje de ransomware que exig√≠a un rescate de $ 10,000 en BTC, entablamos correspondencia con los delincuentes y les pedimos que descifraran uno de los archivos por nosotros. Cumplieron la solicitud y repitieron la demanda de rescate. Logramos regatear hasta 6 mil d√≥lares, luego de lo cual simplemente recargamos el sistema en una m√°quina virtual, porque obtuvimos toda la informaci√≥n necesaria. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo ransomware fue Phobos. El pirata inform√°tico que lo instal√≥ durante una hora examin√≥ el sistema de archivos del hanipot y escane√≥ la red, y luego a√∫n instal√≥ el ransomware.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El tercer ataque de ransomware result√≥ ser falso. </font><font style="vertical-align: inherit;">Un "hacker" desconocido descarg√≥ el archivo haha.bat en nuestro sistema, luego de lo cual vimos por un tiempo c√≥mo intentaba hacerlo funcionar. </font><font style="vertical-align: inherit;">Un intento fue cambiar el nombre de haha.bat a haha.rnsmwr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="imagen"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hacker" aumenta la nocividad del archivo bat, cambiando su extensi√≥n a .rnsmwr. </font><font style="vertical-align: inherit;">Fuente: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cuando el archivo por lotes finalmente comenz√≥ a ejecutarse, el pirata inform√°tico lo edit√≥, aumentando el rescate de $ 200 a $ 750. </font><font style="vertical-align: inherit;">Despu√©s de eso, "cifr√≥" todos los archivos, dej√≥ un mensaje de ransomware en el escritorio y desapareci√≥, cambiando las contrase√±as en nuestro VNC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de un par de d√≠as, el hacker regres√≥ y, para recordarlo, lanz√≥ un archivo por lotes, que abri√≥ muchas ventanas con un sitio porno. </font><font style="vertical-align: inherit;">Aparentemente, de esta manera trat√≥ de llamar la atenci√≥n sobre su demanda.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumen</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante el estudio, result√≥ que tan pronto como se public√≥ informaci√≥n sobre la vulnerabilidad, el hanipot atrajo la atenci√≥n y la actividad creci√≥ d√≠a a d√≠a. Para que la trampa atraiga la atenci√≥n, tuvimos que admitir muchas violaciones de seguridad de nuestra compa√±√≠a ficticia. Desafortunadamente, esta situaci√≥n est√° lejos de ser rara entre muchas compa√±√≠as reales que no cuentan con personal de seguridad inform√°tica y de informaci√≥n a tiempo completo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso general, las organizaciones deben usar el principio de privilegio m√≠nimo, mientras que hemos implementado exactamente lo contrario para atraer intrusos. Y cuanto m√°s vimos los ataques, m√°s sofisticados se volvieron en comparaci√≥n con los m√©todos de prueba de penetraci√≥n est√°ndar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y lo m√°s importante: todos estos ataques fallar√≠an si se implementaran medidas de seguridad adecuadas al configurar la red. </font><font style="vertical-align: inherit;">Las organizaciones deben asegurarse de que sus equipos y componentes de infraestructura industrial no sean accesibles desde Internet, como lo hicimos espec√≠ficamente en nuestra trampa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aunque no registramos un solo ataque en la estaci√≥n de trabajo del ingeniero, a pesar de utilizar la misma contrase√±a de administrador local en todas las computadoras, debemos evitar esta pr√°ctica para minimizar la posibilidad de intrusos. </font><font style="vertical-align: inherit;">De hecho, la escasa seguridad sirve como una invitaci√≥n adicional para atacar sistemas industriales que durante mucho tiempo han sido de inter√©s para los cibercriminales.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es490392/index.html">Catchain: Algoritmo de consenso TON Blockchain</a></li>
<li><a href="../es490394/index.html">Commodore Amiga 500+: que nadie se ofenda</a></li>
<li><a href="../es490398/index.html">Hogwarts rojos. Oficiales, o por qu√© un historiador es como un detective</a></li>
<li><a href="../es490400/index.html">Uso de la biblioteca OpenCV para reconocer arcos el√≠pticos en secciones 2D de nubes de puntos 3D</a></li>
<li><a href="../es490404/index.html">Por qu√© y c√≥mo 5G lo cambiar√° todo: tecnolog√≠a, implementaci√≥n por fases y base de elementos para el equipo del suscriptor</a></li>
<li><a href="../es490410/index.html">Neuronas vivas y artificiales conectadas a trav√©s de Internet</a></li>
<li><a href="../es490412/index.html">¬øQuiz√°s deber√≠amos calmarnos un poco con JavaScript?</a></li>
<li><a href="../es490416/index.html">Video de la conferencia Computer Science Club</a></li>
<li><a href="../es490418/index.html">Millennials y Generation Alpha VS Educaci√≥n Superior</a></li>
<li><a href="../es490420/index.html">Lifehacks para desarrolladores de un reclutador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>