<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🏫 💒 🙅🏻 Diseño de contraseña en el software antivirus Avira Free Antivirus 🕴🏽 🤒 👌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¿Qué sucede si le digo que la única función de uno de los componentes del software antivirus que tiene una firma digital confiable es recopilar todas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Diseño de contraseña en el software antivirus Avira Free Antivirus</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500852/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Qué sucede si le digo que la única función de uno de los componentes del software antivirus que tiene una firma digital confiable es recopilar todas sus credenciales almacenadas en los navegadores de Internet más populares? </font><font style="vertical-align: inherit;">¿Y si le digo eso no importa en interés de quién recogerlos? </font><font style="vertical-align: inherit;">Probablemente piense que estoy delirando. </font><font style="vertical-align: inherit;">¿Y veamos cómo es realmente?</font></font></p><a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resuelto</font></font></h4><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una compañía antivirus como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avira GmbH &amp; Co.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vive y sigue viviendo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">. </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">KG</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lanza varios productos relacionados con la seguridad de la información. </font><font style="vertical-align: inherit;">El surtido incluso tiene productos gratuitos para uso doméstico.</font></font></p><br>
 <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos a establecer interés por el bien de la versión gratuita, ver qué puede hacer el producto de colegas alemanes. </font><font style="vertical-align: inherit;">Echamos un vistazo a la interfaz, nada inusual. </font><font style="vertical-align: inherit;">No encontramos ninguna mención de otro producto de la compañía: Avira Password Manager.</font></font></p><br>
 <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y echemos un vistazo al componente con el nombre " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avira.PWM.NativeMessaging.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><font style="vertical-align: inherit;">que no llama la atención </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Está compilado para la plataforma .NET y no está ofuscado de ninguna manera, por lo que lo cargamos en dnSpy y estudiamos libremente el código del programa.</font></font></p> <br>
 <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El programa es una consola y espera comandos en una secuencia de entrada estándar. La función principal que usa " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " lee los datos de la secuencia, verifica el formato y pasa el comando a la función " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProcessMessage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". Lo mismo, a su vez, comprueba que el comando transmitido es " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchChromePasswords</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " o " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchCredentials</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " (aunque ¿qué diferencia </font><i><font style="vertical-align: inherit;">hace</font></i><font style="vertical-align: inherit;"> si el comportamiento adicional es el mismo?) Y luego comienza lo más interesante: llamar a la función " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RetrieveBrowserCredentials</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". Incluso es interesante ... ¿qué puede hacer una función con ese nombre?</font></font></p><br>
<p><img src="https://habrastorage.org/webt/jx/w2/k8/jxw2k8gdwep7izfay76tr_gyc1u.png" alt="Listado de código para la función ProcessMessage"></p><br>
<p>  ,         ,      - «Chrome», «Opera» (  Chromium), «Firefox»  «Edge» (  Chromium)      JSON-.</p><br>
<p><img src="https://habrastorage.org/webt/zm/mr/tg/zmmrtgg_s425z4dza3eubn1zkey.png" alt="Listado del código de función RetrieveBrowserCredentials"></p><br>
<p>       :</p><br>
<p><img src="https://habrastorage.org/webt/lh/vt/bn/lhvtbnaqg_ax2vper4am3l-guww.png" alt="Captura de pantalla de la línea de comando con los datos recibidos."></p><br>
 <h4> </h4><br>
<ul>
<li>    ;</li>
<li>     (,        );</li>
<li>  «»           ;</li>
<li>    .</li>
</ul><br>
<h4>IoC</h4><br>
<p>SHA1: 13c95241e671b98342dba51741fd02621768ecd5.</p><br>
<p>     CVE-2020-12680.</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre este tema envié una carta a support@avira.com e info@avira.com con una descripción completa el 07/04/2020. </font><font style="vertical-align: inherit;">No hubo cartas de respuesta, incluso de sistemas automáticos. </font><font style="vertical-align: inherit;">Un mes después, el componente descrito todavía se distribuye en la distribución Avira Free Antivirus.</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es500834/index.html">Almacenamiento web</a></li>
<li><a href="../es500836/index.html">Qué sucede con el transporte el 7 de mayo: diferentes cuarentenas en diferentes regiones</a></li>
<li><a href="../es500840/index.html">Análisis de cuadros de Mortal Kombat 11</a></li>
<li><a href="../es500844/index.html">Ir optimizaciones en VictoriaMetrics. Alexander Valyalkin</a></li>
<li><a href="../es500848/index.html">MVP por un solo desarrollador</a></li>
<li><a href="../es500854/index.html">Cómo apoyamos técnicamente el funcionamiento de las oficinas de ABBYY durante la cuarentena</a></li>
<li><a href="../es500856/index.html">Sobre la traducción de "interés" sin interés</a></li>
<li><a href="../es500860/index.html">En China, se instalan cámaras de vigilancia frente a las puertas de entrada y dentro de los apartamentos de los ciudadanos.</a></li>
<li><a href="../es500862/index.html">Rueda de Sansara: principios de la lucha contra la rutina.</a></li>
<li><a href="../es500864/index.html">Cuando la información y la seguridad funcional se encuentran</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>