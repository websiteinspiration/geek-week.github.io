<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèæ üìá üéÖ Does Mac OS slow down? - Catalina checks any unsigned code over the Internet at startup ‚ôÇÔ∏è üõå üñºÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many users after switching to Catalina began to complain about the brakes. Western colleagues found out the reason: MacOS sends a hash of any unsigned...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Does Mac OS slow down? - Catalina checks any unsigned code over the Internet at startup</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503670/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Many users after switching to Catalina began to complain about the brakes. </font><font style="vertical-align: inherit;">Western colleagues found out the reason: MacOS sends a hash of any unsigned code to Apple servers.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This creates serious delays in execution, which can be easily checked:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> $<span class="hljs-string">'#!/bin/sh\necho Hello'</span> &gt; /tmp/test.sh &amp;&amp; chmod a+x /tmp/test.sh<font></font>
time /tmp/test.sh &amp;&amp; time /tmp/test.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The results are surprising:</font></font><br>
<br>
<pre><code class="bash hljs">$ time /tmp/test.sh &amp;&amp; time /tmp/test.sh<font></font>
Hello<font></font>
<font></font>
real    0m1.417s<font></font>
user    0m0.001s<font></font>
sys 0m0.003s<font></font>
Hello<font></font>
<font></font>
real    0m0.003s<font></font>
user    0m0.001s<font></font>
sys 0m0.002s</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why it happens? </font><font style="vertical-align: inherit;">Apple has been using the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notarization</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mechanism for quite some time </font><font style="vertical-align: inherit;">- with it, users can be sure that a program signed by a valid Developer-ID does not contain malicious components. </font><font style="vertical-align: inherit;">That is, in addition to the fact that the application is signed, Apple will also automatically check it for malware elements. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, in the future, Apple generally plans to ban the launch of non-notarized programs. </font><font style="vertical-align: inherit;">Quote:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginning in macOS 10.14.5, software signed with a new Developer ID certificate and all new or updated kernel extensions must be notarized to run. </font><font style="vertical-align: inherit;">Beginning in macOS 10.15, all software built after June 1, 2019, and distributed with Developer ID must be notarized.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, apparently, in order to break in, any new unsigned code that you run is sent to the AAPL server. This can be easily verified by running any network analyzer and seeing calls to the api.apple-cloudkit.com domain. It should be noted that it is not the code itself that is transmitted, but the hash amount. You can check this in two ways - compare the amount of data transmitted over the network for scripts of different sizes; as well as looking at the contents of the daemon responsible for sending data ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otool -tV / usr / libexec / syspolicyd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). However, with a slow Internet connection, delays can be seconds - a user from China writes about a delay of 5.47 seconds.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the one hand, Apple can understand - it cares about the security of users, however, at the same time turning the process of any development on their platform into hell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But I want to quote the developer who first drew attention to the problem: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This behavior of the operating system indicates serious problems in its design when two methods from the low-level system API (for example, exec and getxattr) perform synchronous network calls before returning the result. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lapcatsoftware.com/articles/catalina-executables.html </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">news.ycombinator.com/item?id=23275922 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sigpipe.macromates.com/2020/macos-catalina-slow-by-design</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503656/index.html">The band suppression algorithm in the image as a tool for improving the quality of tomographic reconstruction</a></li>
<li><a href="../en503660/index.html">Test projects without pain. Yandex Report</a></li>
<li><a href="../en503662/index.html">NEW - VoIP Phone Snom D335</a></li>
<li><a href="../en503666/index.html">Startup and Business Course Translation from Stanford University. Lecture number 1. How to start a startup</a></li>
<li><a href="../en503668/index.html">Circle Squared: Visual Evidence</a></li>
<li><a href="../en503672/index.html">Which side are you on: Push and Pull in Desired State Configuration</a></li>
<li><a href="../en503676/index.html">Three geek projects for Geek Pride Day</a></li>
<li><a href="../en503678/index.html">Vuex breaks encapsulation</a></li>
<li><a href="../en503680/index.html">DBA: in pursuit of flying locks</a></li>
<li><a href="../en503682/index.html">Snom Exchange A to Z</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>