<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜë üë©üèº‚ÄçüöÄ ü§õüèº Hierarchical Depth Buffer üë©‚Äçüë¶ üêù üåÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Short review
 A hierarchical depth buffer is a multi-level depth buffer (Z-buffer) used as an acceleration structure for depth queries. As in the case...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hierarchical Depth Buffer</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494376/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/fr/kx/e8/frkxe8hnnru9xzoo2g9k8qec2sq.png"></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Short review</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A hierarchical depth buffer is a multi-level depth buffer (Z-buffer) used as an acceleration structure for depth queries. As in the case of texture mip chains, the sizes of each level are usually the result of dividing by the degree of two the sizes of the full resolution buffer. In this article, I will talk about two ways to generate a hierarchical depth buffer from a full resolution buffer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, I will show how to generate a complete mip chain for a depth buffer, which preserves the accuracy of depth queries in the texture coordinate space (or NDC) even for depth buffer sizes not equal to powers of two. (On the Internet, I have come across code examples that do not guarantee this accuracy, which complicates the execution of accurate queries at high mip levels.)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then, for cases in which only one level of downsampling is required, I will demonstrate how to generate this level with a single call to a compute shader using atomic operations in the shared memory of the workgroup. </font><font style="vertical-align: inherit;">For my application, where only 1/16 x 1/16 resolution is required (mip level 4), the method with the computational shader is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2-3 times faster</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> than the usual approach with downsampling the mip chain in several passes.</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hierarchical Depths (also called Hi-Z) is a technique often used in 3D graphics. It is used to accelerate the trimming of invisible geometry (occlusion culling) (in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">well as</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), the calculation of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reflections in the screen space</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volumetric fog,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and much more. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hi-Z</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GPUs </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">are often implemented</font></a><font style="vertical-align: inherit;"> as part of a rasterization pipeline. Quick Hi-Z search operations in the caches on the chip allow you to completely skip fragment tiles if they are completely covered by previously rendered primitives.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hi-Z's basic idea is to speed up depth query operations by reading from lower resolution buffers. </font><font style="vertical-align: inherit;">This is faster than reading full resolution depths from the buffer, for two reasons:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One texel (or just a few texels) of a lower resolution buffer can be used as an approximate value of a plurality of texels of a high resolution buffer.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A lower resolution buffer can be small enough and cached, which greatly speeds up the execution of search operations (especially with random access).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The content of down-sampled Hi-Z buffer levels depends on how they are used (whether the depth buffer will be </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúinverted‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , what types of requests should be used). In general, a texel at the Hi-Z buffer level stores </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all texels corresponding to it at the previous level. Sometimes the values ‚Äã‚Äãof </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">are stored at the same time </font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Simple averaged values ‚Äã‚Äã(which are often used in the mip levels of regular textures) are used infrequently because they are rarely useful for such types of queries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hi-Z buffers are most often requested almost immediately at the exit to avoid further processing and more accurate search operations in the full resolution buffer. For example, if we store values</font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for a non-inverted depth buffer (in which the greater the depth value, the farther the object is), we can quickly determine exactly whether a particular position in the screen space is covered by a depth buffer (if its coordinate Z&gt; is the value (max) stored in some higher level (i.e., lower resolution) of the Hi-Z buffer). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that I used the phrase ‚Äúexactly‚Äù: if the coordinate Z &lt;= the received value (max), then it is not known whether its buffer overlaps. </font><font style="vertical-align: inherit;">In some applications, in cases of uncertainty, it may be necessary to search the buffer for full resolution depths; </font><font style="vertical-align: inherit;">in other cases, this is not required (for example, if only unnecessary calculations are at stake, and not the correct rendering).</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My application: rendering particles in a computational shader</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I was faced with the need to use Hi-Z when implementing </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">particle rendering in a computational shader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the engine of my </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PARTICULATE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> VR application </font><font style="vertical-align: inherit;">. Since this rendering technique does not use rasterization with fixed functions, it needs to use its own depth check for each particle with a size of one pixel. And since the particles are not sorted in any way, access to the depth buffer is (in the worst of cases) almost random. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Search operations on a full-screen random-access texture is the way to poor performance. To reduce the load, I first search for depths in the reduced depth buffer with a resolution of 1/16 x 1/16 from the original. This buffer contains depth values.</font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which allows the computational rendering shader for the vast majority of visible particles to skip the full resolution depth test. (If the particle depth is &lt;the minimum depth stored in the lower resolution buffer, then we know that it is absolutely visible. If it is&gt; = min, then we need to check the full resolution depth buffer.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to this, the depth test for visible particles in the general case becomes a low-cost operation. (For particles overlapped by geometry, it is more expensive, but it suits us because it does not cause rendering costs, so the particles still require little computation.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Due to the fact that the search is first performed in the buffer of depths of lower resolution (as mentioned above) , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">particle rendering time is reduced by a maximum of 35%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compared to the case when the search is performed only in the full resolution buffer. </font><font style="vertical-align: inherit;">Therefore, for my application, Hi-Z is very beneficial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we will look at two techniques for generating a hierarchical depth buffer.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Technique 1: generating a complete Mip chain</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In many Hi-Z applications, the creation of a complete depth buffer mip chain is required. For example, when performing occlusion culling using Hi-Z, the bounding volume is projected into the screen space and the projected size is used to select the appropriate mip level (so that a fixed number of texels is involved in each overlap test). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Generating a mip chain from the full resolution depth buffer is usually a simple task - for each texel at level N we take </font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(or </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, or both) the corresponding 4 texels in the previously generated level N-1. We perform sequential passes (each time reducing the size by half) until we get the last mip level 1x1 in size.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, in the case of depth buffers, the sizes of which do not correspond to the powers of two, everything is more complicated. Since Hi-Z for depth buffers is often built from standard screen resolutions (which are rarely powers of two), we need to find a reliable solution to this problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's first decide what will mean the value of each texel mip-level depth buffer. In this article, we will assume that the mip chain stores values </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Depth search operations should use filtering of the nearest neighbors, because the interpolation of values ‚Äã‚Äãis </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">useless for us and will harm the hierarchical nature of the created mip-chain of depths. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, what exactly will the value of the individual texel at the mip-level N obtained by us mean? This should be the minimum value (</font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) of all texels of the full-screen depth buffer that occupies the same space in the (normalized) texture coordinate space. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In other words, if a separate coordinate of the texture (in the interval</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="2.884ex" viewBox="0 -916.9 2457.1 1241.8" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1224" y="0"></use><g transform="translate(1724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="393" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">[0, 1]^2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) is mapped (by filtering the nearest neighbors) to an individual texel of the full resolution buffer, then this texel of full resolution should be considered as a candidate for the value </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculated for the texel at each subsequent higher mip level, with which the same texture coordinate is mapped. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If this correspondence is guaranteed, then we will be sure that the search operation at high mip levels will never return the depth value&gt; texel value in the same texture coordinate corresponding to the full resolution buffer (level 0). In the case of a separate N, this guarantee is maintained for all levels below it (&lt;N).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For even dimensions (and in the case of full resolution buffers, which are powers of two, even dimensions at each level until the very last, where the dimensions become equal to 1) will be easy to do. </font><font style="vertical-align: inherit;">In the one-dimensional case, for texel with an index</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.009ex" viewBox="0 -755.5 345.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at level N we need to take texels at level N-1 with indices </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.009ex" viewBox="0 -755.5 500.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.968ex" height="2.134ex" viewBox="0 -755.5 2569.4 918.9" role="img" focusable="false" style="vertical-align: -0.38ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2B" x="1068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="2068" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">2i + 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and find their meaning </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">I.e</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mtext>min</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.481ex" height="2.634ex" viewBox="0 -809.3 16137.7 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="1171" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="1556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="1835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="2180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-3D" x="2737" y="0"></use><g transform="translate(3793,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-69" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6E" x="1112" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-28" x="5461" y="0"></use><g transform="translate(5851,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="8312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="8590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="9091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="9436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2C" x="9715" y="0"></use><g transform="translate(10160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="12621" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="12900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="13400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2B" x="13968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="14969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="15469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-29" x="15748" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mtext>min</mtext><mo stretchy="false">(</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">[</mo><mn>2</mn><mi>i</mi><mo stretchy="false">]</mo><mo>,</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">D_{N}[i] = \text{min}(D_{N-1}[2i], D_{N-1}[2i + 1])</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We can directly compare the texels in the ‚Äú2 to 1‚Äù ratio (and therefore the size of the texture coordinates), because the size of each level is exactly two times smaller than the previous one.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/11f/ca7/b43/11fca7b43dd706d72f35590f69422e2c.svg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of even level sizes: 6 texels at this level are reduced to 3 at a higher level. </font><font style="vertical-align: inherit;">The texture coordinate sizes of each of the three high-level texels are precisely superimposed on every two lower-level texels. </font><font style="vertical-align: inherit;">(Dots are the centers of texels, and squares are the dimensions of the texture coordinate when filtering the nearest neighbors.)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the case of odd level sizes (and full resolution buffers that are not a power of two will have at least one level with an odd size) everything getting harder. </font><font style="vertical-align: inherit;">For level N-1 of odd size</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>d</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>i</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>m</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.595ex" height="2.384ex" viewBox="0 -755.5 3270.2 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-69" x="511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-6D" x="819" y="0"></use><g transform="translate(1637,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">m</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">\mathit{dim}_{N-1}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the size of the next level (N) will be equal </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>d</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>i</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>m</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></msub><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230A;</mo><mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>d</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>i</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>m</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mn>2</mn></mfrac><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230B;</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.865ex" height="3.759ex" viewBox="0 -1132.2 7261.2 1618.6" role="img" focusable="false" style="vertical-align: -1.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-69" x="511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-6D" x="819" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="2315" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-3D" x="2643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-230A" x="3699" y="0"></use><g transform="translate(4144,0)"><g transform="translate(120,0)"><rect stroke="none" width="2432" height="60" x="0" y="220"></rect><g transform="translate(60,558)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-69" x="511" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-6D" x="819" y="0"></use><g transform="translate(1157,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="1469" y="-542"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-230B" x="6816" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">m</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></msub><mo>=</mo><mo fence="false" stretchy="false">‚åä</mo><mfrac><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">m</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mn>2</mn></mfrac><mo fence="false" stretchy="false">‚åã</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">\mathit{dim}_{N} = \lfloor \frac{\mathit{dim}_{N-1}}{2} \rfloor</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, i.e </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2260;</mo><mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>d</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>i</mi><mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;>m</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mn>2</mn></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.66ex" height="3.759ex" viewBox="0 -1132.2 3728.6 1618.6" role="img" focusable="false" style="vertical-align: -1.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2260" x="0" y="0"></use><g transform="translate(778,0)"><g transform="translate(397,0)"><rect stroke="none" width="2432" height="60" x="0" y="220"></rect><g transform="translate(60,558)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-69" x="511" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAINI-6D" x="819" y="0"></use><g transform="translate(1157,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="1469" y="-542"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>‚â†</mo><mfrac><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">d</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">m</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-8">\neq \frac{\mathit{dim}_{N-1}}{2}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that now we do not have a clear 2-to-1 mapping of texels of level N-1 to texels of level N. Now the size of the texture coordinate of each texel at level N is superimposed on the size of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> texels at level N-1.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/48d/9d6/6e1/48d9d66e16424a3781e695a3340d2cb4.svg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of an odd level size: 7 texels of this level are reduced to 3 texels at the next level. </font><font style="vertical-align: inherit;">The dimensions of the texture coordinates of the three high-level texels are superimposed on the sizes of the three texels from the lower level. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hence</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mtext>min</mtext><mo stretchy=&quot;false&quot;>(</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.493ex" height="2.634ex" viewBox="0 -809.3 22170.5 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="1171" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="1556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="1835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="2180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-3D" x="2737" y="0"></use><g transform="translate(3793,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-69" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6E" x="1112" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-28" x="5461" y="0"></use><g transform="translate(5851,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="8312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="8590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="9091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="9436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2C" x="9715" y="0"></use><g transform="translate(10160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="12621" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="12900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="13400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2B" x="13968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="14969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="15469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2C" x="15748" y="0"></use><g transform="translate(16193,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1667" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="18654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="18933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-69" x="19433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2B" x="20001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="21002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="21502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-29" x="21781" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></msub><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mtext>min</mtext><mo stretchy="false">(</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">[</mo><mn>2</mn><mi>i</mi><mo stretchy="false">]</mo><mo>,</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>,</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">[</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">D_{N}[i] = \text{min}(D_{N-1}[2i], D_{N-1}[2i + 1], D_{N-1}[2i + 2])</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This means that one texel at the level of N-1 sometimes affects the value </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculated for </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> texels at the level of N. This is necessary to maintain the comparison described above. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The description above has been presented in just one dimension for simplicity. </font><font style="vertical-align: inherit;">In two dimensions, if both dimensions of the N-1 level are even, then the 2x2 texel region at the N-1 level is mapped to one texel at the N level. If one of the dimensions is odd, the 2x3 or 3x2 region at the N-1 level is mapped to one texel at level N. If </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">both</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimensions are </font><font style="vertical-align: inherit;">odd </font><font style="vertical-align: inherit;">, then the ‚Äúangular‚Äù texel should also be taken into account, that is, the 3x3 region at level N-1 is compared with one texel at level N.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code example</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The GLSL shader code shown below implements the algorithm we described. </font><font style="vertical-align: inherit;">It must be executed for each subsequent mip, starting from level 1 (level 0 is the full resolution level).</font></font><br>
<br>
<pre><code class="cpp hljs">uniform sampler2D u_depthBuffer;<font></font>
uniform <span class="hljs-keyword">int</span> u_previousLevel;<font></font>
uniform ivec2 u_previousLevelDimensions;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{<font></font>
	ivec2 thisLevelTexelCoord = ivec2(gl_FragCoord);<font></font>
	ivec2 previousLevelBaseTexelCoord = <span class="hljs-number">2</span> * thisLevelTexelCoord;<font></font>
<font></font>
	vec4 depthTexelValues;<font></font>
	depthTexelValues.x = texelFetch(u_depthBuffer,<font></font>
                                    previousLevelBaseTexelCoord,<font></font>
                                    u_previousLevel).r;<font></font>
	depthTexelValues.y = texelFetch(u_depthBuffer,<font></font>
                                    previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>),<font></font>
                                    u_previousLevel).r;<font></font>
	depthTexelValues.z = texelFetch(u_depthBuffer,<font></font>
                                    previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<font></font>
                                    u_previousLevel).r;<font></font>
	depthTexelValues.w = texelFetch(u_depthBuffer,<font></font>
                                    previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>),<font></font>
                                    u_previousLevel).r;<font></font>
<font></font>
	<span class="hljs-keyword">float</span> minDepth = min(min(depthTexelValues.x, depthTexelValues.y),<font></font>
                         min(depthTexelValues.z, depthTexelValues.w));<font></font>
<font></font>
    <span class="hljs-comment">// Incorporate additional texels if the previous level's width or height (or both) </span>
    <span class="hljs-comment">// are odd. </span>
	<span class="hljs-keyword">bool</span> shouldIncludeExtraColumnFromPreviousLevel = ((u_previousLevelDimensions.x &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>);
	<span class="hljs-keyword">bool</span> shouldIncludeExtraRowFromPreviousLevel = ((u_previousLevelDimensions.y &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>);
	<span class="hljs-keyword">if</span> (shouldIncludeExtraColumnFromPreviousLevel) {<font></font>
		vec2 extraColumnTexelValues;<font></font>
		extraColumnTexelValues.x = texelFetch(u_depthBuffer,<font></font>
                                              previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>),<font></font>
                                              u_previousLevel).r;<font></font>
		extraColumnTexelValues.y = texelFetch(u_depthBuffer,<font></font>
                                              previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<font></font>
                                              u_previousLevel).r;<font></font>
<font></font>
		<span class="hljs-comment">// In the case where the width and height are both odd, need to include the </span>
        <span class="hljs-comment">// 'corner' value as well. </span>
		<span class="hljs-keyword">if</span> (shouldIncludeExtraRowFromPreviousLevel) {
			<span class="hljs-keyword">float</span> cornerTexelValue = texelFetch(u_depthBuffer,<font></font>
                                                previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>),<font></font>
                                                u_previousLevel).r;<font></font>
			minDepth = min(minDepth, cornerTexelValue);<font></font>
		}<font></font>
		minDepth = min(minDepth, min(extraColumnTexelValues.x, extraColumnTexelValues.y));<font></font>
	}<font></font>
	<span class="hljs-keyword">if</span> (shouldIncludeExtraRowFromPreviousLevel) {<font></font>
		vec2 extraRowTexelValues;<font></font>
		extraRowTexelValues.x = texelFetch(u_depthBuffer,<font></font>
                                           previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),<font></font>
                                           u_previousLevel).r;<font></font>
		extraRowTexelValues.y = texelFetch(u_depthBuffer,<font></font>
                                           previousLevelBaseTexelCoord + ivec2(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<font></font>
                                           u_previousLevel).r;<font></font>
		minDepth = min(minDepth, min(extraRowTexelValues.x, extraRowTexelValues.y));<font></font>
	}<font></font>
<font></font>
	gl_FragDepth = minDepth;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flaws in this code</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, in the case of full resolution depth buffers for which one dimension is more than two times the size of another dimension, call indices </font></font><code>texelFetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">may go beyond </font></font><code>u_depthBuffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. (In such cases, the smaller dimension turns into 1 before the other.) I wanted to use this example </font></font><code>texelFetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(using integer coordinates) so that what was happening was as clear as possible, and did not personally encounter such particularly wide / high depth buffers. If you encounter such problems, you can limit ( </font></font><code>clamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) the transmitted </font></font><code>texelFetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinates or use the </font></font><code>texture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normalized coordinates of the texture (in the sampler, set a limit on the edge). When calculating </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should always consider one texel several times for the presence of borderline cases.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secondly, despite the fact that the first four calls </font></font><code>texelFetch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be replaced with one </font></font><code>textureGather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this complicates things (since the </font></font><code>textureGather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mip level cannot be indicated); </font><font style="vertical-align: inherit;">In addition, I did not notice an increase in speed when using </font></font><code>textureGather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I used the fragment shader above to generate two full mip chains for two depth buffers (one for each eye) in my VR engine. </font><font style="vertical-align: inherit;">In the test, the resolution for each eye was 1648x1776, which led to the creation of 10 additional reduced mip levels (which means 10 passes). </font><font style="vertical-align: inherit;">It took 0.25 ms on the NVIDIA GTX 980 and 0.30 ms on the AMD R9 290 to generate a full chain for both eyes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/805/461/815/8054618153533c29d1de1000fcee2878.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8f/2b6/950/a8f2b6950b278655f3deff3ca456874c.png"></div><br>
<i>Mip- 4, 5  6,    ,     . ( ,     ,  ,     .) Mip- 4 ‚Äî ,    (103x111)     2.</i><br>
<br>
<h2>   mip-</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The task of the algorithm described above is to maintain the accuracy of depth queries in the texture coordinate space (or NDC). For completeness (and because I refused this guarantee in the technique below 2), I would like to demonstrate one more method that I came across (for example, in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that, like the previous one, this alternative method is designed to work with full resolution buffers whose sizes are not powers of two (but, of course, they work with sizes equal to powers of two).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this alternative method, when downsampling a level with an odd width (or height) instead of adding for each output texel an additional column (or row) of texels from the previous (lower) level, we perform this operation only for output texels with maximum indices (‚Äúextreme‚Äù texels ) The only thing that changes in the fragment shader presented above is setting values </font></font><code>shouldIncludeExtraColumnFromPreviousLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>shouldIncludeExtraRowFromPreviousLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// If the previous level's width is odd and this is the highest-indexed "edge" texel for </span>
<span class="hljs-comment">// this level, incorporate the rightmost edge texels from the previous level. The same goes </span>
<span class="hljs-comment">// for the height. </span>
<span class="hljs-keyword">bool</span> shouldIncludeExtraColumnFromPreviousLevel =<font></font>
    (previousMipLevelBaseTexelCoords.x == u_previousLevelDimensions.x - <span class="hljs-number">3</span>);
<span class="hljs-keyword">bool</span> shouldIncludeExtraRowFromPreviousLevel =<font></font>
    (previousMipLevelBaseTexelCoords.y == u_previousLevelDimensions.y - <span class="hljs-number">3</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because of this, the extreme texels with the highest index become very ‚Äúthick‚Äù, since each division by 2 odd dimensions leads to the fact that they occupy a proportionately larger interval of the normalized texture coordinate space. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The disadvantage of this approach is that it becomes more difficult to perform depth queries of high mip levels. </font><font style="vertical-align: inherit;">Instead of just using the normalized texture coordinates, we first need to determine the full resolution texel corresponding to these coordinates, and then transfer the coordinates of this texel to the coordinates of the corresponding mip level, the request of which is being executed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code snippet below is migrating from NDC space</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.515ex" height="2.884ex" viewBox="0 -916.9 3235.6 1241.8" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-2C" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-31" x="2002" y="0"></use><g transform="translate(2503,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="393" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-10">[-1, 1]^2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to texel coordinates at mip level </font></font><code>higherMipLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs">vec2 windowCoords = (<span class="hljs-number">0.5</span> * ndc.xy + vec2(<span class="hljs-number">0.5</span>)) * textureSize(u_depthBuffer, <span class="hljs-number">0</span>);
<span class="hljs-comment">// Account for texel centers being halfway between integers. </span>
ivec2 texelCoords = ivec2(round(windowCoords.xy - vec2(<span class="hljs-number">0.5</span>)));<font></font>
ivec2 higherMipLevelTexelCoords =<font></font>
    min(texelCoords / (<span class="hljs-number">1</span> &lt;&lt; higherMipLevel),<font></font>
        textureSize(u_depthBuffer, higherMipLevel).xy - ivec2(<span class="hljs-number">1</span>));</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Technique 2: Generate a Single Hi-Z Level Using a Computing Shader</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Generating a complete mip chain is pretty fast, but it bothered me a bit that my application generates all these levels and uses only one of them (level 4). </font><font style="vertical-align: inherit;">In addition to eliminating this slight inefficiency, I also wanted to see how much everything could be accelerated if I used only one compute shader call to generate the level I needed. </font><font style="vertical-align: inherit;">(It‚Äôs worth noting that my application can stop at level 4 when using a solution with a multi-pass fragment shader, so at the end of this section I used it as a basis for comparing runtime.)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In most Hi-Z applications, only one depth level is required, so I find this situation to be common. I wrote a computational shader for my own specific requirements (generating level 4, which has a resolution of 1/16 x 1/16 from the original). Similar code can be used to generate different levels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The computational shader is well suited for this task, because it can use shared workgroup memory to exchange data between threads. Each working group is responsible for one output texel (reduced by downsampling of the buffer), and the threads of the working group share the work of calculating the </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corresponding texels of full resolution, sharing the results through shared memory.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I tried two main solutions based on computational shaders. In the first, each thread called </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for one shared memory variable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that since programmers cannot (without extensions for the hardware of a particular manufacturer) perform atomic operations on non-integer values ‚Äã‚Äã(and my depths are stored as </font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), some trick is needed here. Since non-negative floating-point values ‚Äã‚Äãof the IEEE 754 standard keep their order when their bits are processed as unsigned integer values, we can use </font></font><code>floatBitsToUint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to bring (using reinterpret cast) the depth values </font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to </font></font><code>uint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and then call </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(to then execute </font></font><code>uintBitsToFloat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for the finished minimum value </font></font><code>uint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most obvious solution to </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">would be to create 16x16 thread groups in which each thread receives one texel and then executes it </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a value in the shared memory. I compared this approach using smaller stream blocks (8x8, 4x8, 4x4, 2x4, 2x2), in which each stream receives a texel region and calculates its own local minimum, and then calls </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fastest of all these tested solutions with</font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">both NVIDIA and AMD turned out to have a solution with 4x4 stream blocks (in which each stream itself receives a 4x4 texel area). </font><font style="vertical-align: inherit;">I don‚Äôt quite understand why this option turned out to be the fastest, but perhaps it reflects a compromise between the competition of atomic operations and calculations in independent flows. </font><font style="vertical-align: inherit;">It is also worth noting that the size of the 4x4 workgroup uses only 16 threads per warp / wave (and it is also possible to use 32 or 64), which is interesting. </font><font style="vertical-align: inherit;">The example below implements this approach. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As an alternative to using, </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I tried to perform parallel reduction using the techniques used in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this actively cited NVIDIA presentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">(The basic idea is to use a shared memory array of the same size as the number of threads in the workgroup, as well as</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>log</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.23ex" height="2.634ex" viewBox="0 -809.3 3112.9 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-67" x="779" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-32" x="1809" y="-343"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-28" x="1733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMATHI-6E" x="2122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/494376/&amp;usg=ALkJrhhuNqt1Udl2fj7WiKa_HF_5kxU0Mg#MJMAIN-29" x="2723" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>log</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">\log_{2} (n)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passes for sequential joint calculation of the </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimums of each stream until the final minimum of the entire working group is obtained.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I tried this solution with all the same sizes of working groups as in solution c </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Even with all the optimizations described in the NVIDIA presentation, the parallel reduction solution is slightly slower (within ten GPUs on both GPUs) than the solution </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I came to. </font><font style="vertical-align: inherit;">In addition, the solution with is </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">much simpler in terms of code.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code example</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With this method, the easiest way is not to try to maintain correspondence in the normalized space of texture coordinates between texels of reduced buffers and full resolution. </font><font style="vertical-align: inherit;">You can simply perform conversions from texel coordinates of full resolution to texel coordinates of reduced resolution:</font></font><br>
<br>
<pre><code class="cpp hljs">ivec2 reducedResTexelCoords = texelCoords / ivec2(downscalingFactor);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my case (generating the equivalent of mip-level 4) </font></font><code>downscalingFactor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is 16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As mentioned above, this GLSL computational shader implements a solution with </font></font><code>atomicMin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4x4 workgroup sizes, where each thread receives a 4x4 texel area from the full resolution buffer. </font><font style="vertical-align: inherit;">The resulting reduced value depth buffer </font></font><code>min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is 1/16 x 1/16 of the full resolution buffer size (rounded up when full resolution sizes are not divisible by 16 completely).</font></font><br>
<br>
<pre><code class="cpp hljs">uniform sampler2D u_inputDepthBuffer;<font></font>
uniform <span class="hljs-keyword">restrict</span> writeonly image2DArray u_outputDownsampledMinDepthBufferImage;
<span class="hljs-comment">// The dimension in normalized texture coordinate space of a single texel in </span>
<span class="hljs-comment">// u_inputDepthBuffer. </span><font></font>
uniform vec2 u_texelDimensions;<font></font>
<font></font>
<span class="hljs-comment">// Resulting image is 1/16th x 1/16th resolution, but we fetch 4x4 texels per thread, hence </span>
<span class="hljs-comment">// the divisions by 4 here. </span>
layout(local_size_x = <span class="hljs-number">16</span>/<span class="hljs-number">4</span>, local_size_y = <span class="hljs-number">16</span>/<span class="hljs-number">4</span>, local_size_z = <span class="hljs-number">1</span>) in;<font></font>
<font></font>
<span class="hljs-comment">// This is stored as uint because atomicMin only works on integer types. Luckily </span>
<span class="hljs-comment">// (non-negative) floats maintain their order when their bits are interpreted as uint (using </span>
<span class="hljs-comment">// floatBitsToUint). </span><font></font>
shared uint s_workgroupMinDepthEncodedAsUint;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
	<span class="hljs-keyword">if</span> (gl_LocalInvocationIndex == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Initialize to 1.0 (max depth) before performing atomicMin's. </span>
		s_workgroupMinDepthEncodedAsUint = floatBitsToUint(<span class="hljs-number">1.0</span>);<font></font>
	}<font></font>
<font></font>
	memoryBarrierShared();<font></font>
	barrier();<font></font>
<font></font>
	<span class="hljs-comment">// Fetch a 4x4 texel region per thread with 4 calls to textureGather. 'gatherCoords' </span>
    <span class="hljs-comment">// are set up to be equidistant from the centers of the 4 texels being gathered (which </span>
    <span class="hljs-comment">// puts them on integer values). In my tests textureGather was not faster than </span>
    <span class="hljs-comment">// individually fetching each texel - I use it here only for conciseness. </span>
    <span class="hljs-comment">// </span>
    <span class="hljs-comment">// Note that in the case of the full-res depth buffer's dimensions not being evenly </span>
    <span class="hljs-comment">// divisible by the downscaling factor (16), these textureGather's may try to fetch </span>
    <span class="hljs-comment">// out-of-bounds coordinates - that's fine as long as the texture sampler is set to </span>
    <span class="hljs-comment">// clamp-to-edge, as redundant values don't affect the resulting min. </span><font></font>
<font></font>
	uvec2 baseTexelCoords = <span class="hljs-number">4</span> * gl_GlobalInvocationID.xy;<font></font>
	vec2 gatherCoords1 = (baseTexelCoords + uvec2(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) * u_texelDimensions;<font></font>
	vec2 gatherCoords2 = (baseTexelCoords + uvec2(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>)) * u_texelDimensions;<font></font>
	vec2 gatherCoords3 = (baseTexelCoords + uvec2(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)) * u_texelDimensions;<font></font>
	vec2 gatherCoords4 = (baseTexelCoords + uvec2(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>)) * u_texelDimensions;<font></font>
<font></font>
	vec4 gatheredTexelValues1 = textureGather(u_inputDepthBuffer, gatherCoords1);<font></font>
	vec4 gatheredTexelValues2 = textureGather(u_inputDepthBuffer, gatherCoords2);<font></font>
	vec4 gatheredTexelValues3 = textureGather(u_inputDepthBuffer, gatherCoords3);<font></font>
	vec4 gatheredTexelValues4 = textureGather(u_inputDepthBuffer, gatherCoords4);<font></font>
<font></font>
	<span class="hljs-comment">// Now find the min across the 4x4 region fetched, and apply that to the workgroup min </span>
    <span class="hljs-comment">// using atomicMin. </span><font></font>
	vec4 gatheredTexelMins = min(min(gatheredTexelValues1, gatheredTexelValues2),<font></font>
                                 min(gatheredTexelValues3, gatheredTexelValues4));<font></font>
	<span class="hljs-keyword">float</span> finalMin = min(min(gatheredTexelMins.x, gatheredTexelMins.y),<font></font>
                         min(gatheredTexelMins.z, gatheredTexelMins.w));<font></font>
	atomicMin(s_workgroupMinDepthEncodedAsUint, floatBitsToUint(finalMin));<font></font>
<font></font>
	memoryBarrierShared();<font></font>
	barrier();<font></font>
<font></font>
    <span class="hljs-comment">// Thread 0 writes workgroup-wide min to image. </span>
	<span class="hljs-keyword">if</span> (gl_LocalInvocationIndex == <span class="hljs-number">0</span>) {
		<span class="hljs-keyword">float</span> workgroupMinDepth = uintBitsToFloat(s_workgroupMinDepthEncodedAsUint);<font></font>
<font></font>
		imageStore(u_outputDownsampledMinDepthBufferImage,<font></font>
		           ivec2(gl_WorkGroupID.xy),<font></font>
                   <span class="hljs-comment">// imageStore can only be passed vec4, but only a float is stored. </span><font></font>
				   vec4(workgroupMinDepth));<font></font>
	}<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I used the computational shader above to process the full resolution depth buffer with the same dimensions that were used to generate the full mip chain (1648x1776 buffers for each eye). </font><font style="vertical-align: inherit;">It runs in 0.12 ms on the NVIDIA GTX 980 and 0.08 ms on the AMD R9 290. If we compare with the generation time of only 1‚Äì4 mip levels (0.22 ms on NVIDIA, 0.25 ms AMD), then The solution with a computational shader turned out </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to be 87% faster with NVIDIA GPUs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">197% faster than AMD GPUs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In absolute terms, the acceleration is not so big, but every 0.1 ms is important, especially in VR :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494364/index.html">GDPR: Consent to the processing of personal data</a></li>
<li><a href="../en494366/index.html">Online mitaps for the whole week, starting from March 27 (on back, mobile, QA, PM and all)</a></li>
<li><a href="../en494370/index.html">Clean Architecture through the eyes of a Python developer</a></li>
<li><a href="../en494372/index.html">All-Russian Verification Software - An Inside View</a></li>
<li><a href="../en494374/index.html">Electric buses and their batteries: what is lithium titanate? (Part.1)</a></li>
<li><a href="../en494380/index.html">Introduction to Strategic Product Management</a></li>
<li><a href="../en494384/index.html">Functional survey</a></li>
<li><a href="../en494390/index.html">3D printing cut auto-tuning costs by half</a></li>
<li><a href="../en494394/index.html">Xia Peysu: mother of Chinese computer science</a></li>
<li><a href="../en494396/index.html">Welcome Mat - now also in Russian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>