<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏛️ 🈚️ 🐱 Dépendances JavaScript de Road to Hell 🎨 👨🏼‍🚀 ⛔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chaque projet JavaScript commence par de bonnes intentions, à savoir que ses créateurs se promettent de ne pas utiliser trop de packages NPM lors de s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dépendances JavaScript de Road to Hell</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/499668/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque projet JavaScript commence par de bonnes intentions, à savoir que ses créateurs se promettent de ne pas utiliser trop de packages NPM lors de son développement. Mais même si les développeurs font des efforts considérables pour tenir cette promesse, les packages NPM pénètrent progressivement leurs projets. La taille du fichier </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">augmente avec le temps. Et avec l' </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation des dépendances, une véritable horreur se produit, exprimée en ajouts et suppressions de packages, surtout perceptible avec le prochain PR ... </font><font style="vertical-align: inherit;">
"Tout va bien", explique le chef d'équipe. Le reste de l'équipe acquiesce d'un signe de tête. Que faire d'autre? Nous apprécions tous le fait que l'écosystème JavaScript est bel et bien vivant. Nous n'avons pas besoin de réinventer la roue à chaque fois et d'essayer de résoudre les problèmes qui ont déjà été résolus par la communauté open source.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/be/cf/ky/becfkyhkcfavrlygimyyrliz9t4.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que vous allez créer un blog et que vous souhaitiez utiliser Gatsby.js. </font><font style="vertical-align: inherit;">Essayez d'ajouter ce générateur de site en fonction de votre projet. </font><font style="vertical-align: inherit;">Maintenant, félicitations. </font><font style="vertical-align: inherit;">Votre projet venait d'avoir 19 000 dépendances supplémentaires. </font><font style="vertical-align: inherit;">C'est normal? </font><font style="vertical-align: inherit;">Dans quelle mesure un arbre de dépendance JavaScript peut-il devenir complexe? </font><font style="vertical-align: inherit;">Comment un arbre de dépendance se transforme-t-il en enfer? </font><font style="vertical-align: inherit;">Voyons cela.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'un package JavaScript?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NPM (Node Package Manager, Node Package Manager) stocke le plus grand registre de packages au monde. </font><font style="vertical-align: inherit;">Ce sont des packages JavaScript. </font><font style="vertical-align: inherit;">NPM est plus que RubyGems, PyPi et Maven réunis. </font><font style="vertical-align: inherit;">Cette conclusion peut être tirée sur la base de l'analyse des données du projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module Counts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui surveille le nombre de packages dans les registres populaires.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/d83/158/259d831584b0a9a5d1fd6226e3f799b0.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Données sur le nombre de packages dans les registres populaires</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vous pourriez penser que de très grandes quantités de code sont représentées sur ce graphique. </font><font style="vertical-align: inherit;">C'est comme ça. </font><font style="vertical-align: inherit;">Pour transformer un projet en package NPM, ce package doit avoir un fichier</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Un tel package peut être envoyé au registre NPM.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que package.json?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les tâches qu'il résout </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il répertorie les packages dont dépend votre projet (il s'agit d'une liste de dépendances de projet).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce document, en utilisant les règles de gestion de versions sémantique, les versions des packages de dépendances que votre projet peut utiliser sont définies.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il vous permet de reproduire l'environnement nécessaire au fonctionnement du package et, par conséquent, simplifie le transfert du projet à d'autres développeurs.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un fichier </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut être considéré comme un fichier </font></font><code>README</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pompé de stéroïdes. </font><font style="vertical-align: inherit;">Ici, vous pouvez décrire les dépendances de votre package, ici vous pouvez écrire des scripts qui sont exécutés pendant l'assemblage et le test du projet. </font><font style="vertical-align: inherit;">Le même fichier contient des informations sur la version du projet spécifiée par son développeur et une description du projet. </font><font style="vertical-align: inherit;">Nous sommes particulièrement intéressés par la possibilité </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de spécifier les dépendances du projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que le fait que les dépendances du projet soient indiquées dans ce fichier semble quelque peu alarmant. </font><font style="vertical-align: inherit;">Imaginez qu'il existe un package qui dépend d'un autre package, et cet autre package dépend d'un autre package. </font><font style="vertical-align: inherit;">Une telle chaîne de dépendances peut être arbitrairement longue. </font><font style="vertical-align: inherit;">Pour cette raison, l'installation du seul package, Gatsby.js, signifie équiper le projet de 19 000 dépendances supplémentaires.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types de dépendances dans package.json</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de mieux comprendre comment les listes de dépendances de projet augmentent au fil du temps, parlons des différents types de dépendances qu'un projet peut avoir. </font><font style="vertical-align: inherit;">A savoir, les </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sections suivantes peuvent être trouvées qui décrivent diverses dépendances:</font></font><br>
<br>
<ul>
<li><code>dependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce sont des dépendances ordinaires, dont la fonctionnalité est utilisée dans le projet, et qui sont accessibles à partir de son code.</font></font></li>
<li><code>devDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ce sont des dépendances de développement. </font><font style="vertical-align: inherit;">Par exemple, la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plus jolie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bibliothèque </font><font style="vertical-align: inherit;">utilisée pour formater le code.</font></font></li>
<li><code>peerDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - si des dépendances sont écrites dans cette section, le développeur du package informe ainsi celui qui va l'installer qu'il aura besoin d'une version spécifique du package spécifiée dans cette section.</font></font></li>
<li><code>optionalDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ils listent les dépendances optionnelles, telles que l'impossibilité d'installation qui ne violera pas le processus d'installation du package.</font></font></li>
<li><code>bundledDependencies</code> —    ,    .     ,    NPM,    ,             .</li>
</ul><br>
<h2><font color="#3AC1EF">   package-lock.json</font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous savons tous que le dossier </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, au cours des travaux sur le projet, subit constamment des modifications. Quelque chose en est supprimé, quelque chose y est ajouté. Cela est particulièrement visible lorsque vous visualisez PR contenant une version mise à jour de ce fichier. Nous le tenons souvent pour acquis. Un fichier est </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">généré automatiquement chaque fois qu'un fichier </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou un dossier </font><font style="vertical-align: inherit;">change </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cela vous permet de conserver le contenu de l'arborescence de dépendances exactement tel qu'il était lorsque vous avez installé les dépendances du projet. Cela permet, lors de l'installation du projet, de reproduire l'arborescence des dépendances. Cela résout le problème d'avoir différentes versions du même package de différents développeurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons un projet dont les dépendances incluent React. L'entrée correspondante est disponible sur </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si vous regardez le fichier</font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de ce projet, vous pouvez voir quelque chose comme ceci:</font></font><br>
<br>
<pre><code class="javascript hljs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"react"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"version"</span>: <span class="hljs-string">"16.13.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"resolved"</span>: <span class="hljs-string">"https://registry.npmjs.org/react/-/react-16.13.0.tgz"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"integrity"</span>: <span class="hljs-string">"sha512-TSavZz2iSLkq5/oiE7gnFzmURKZMltmi193rm5HEoUDAXpzT9Kzw6oNZnGoai/4+fUnm7FqS5dwgUL34TujcWQ=="</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"requires"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"loose-envify"</span>: <span class="hljs-string">"^1.1.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"object-assign"</span>: <span class="hljs-string">"^4.1.1"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"prop-types"</span>: <span class="hljs-string">"^15.6.2"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un fichier </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une grande liste de dépendances de projet. </font><font style="vertical-align: inherit;">Voici les versions de dépendance, les chemins (URI) vers les modules, les hachages utilisés pour vérifier l'intégrité du module et les packages nécessaires à ce module. </font><font style="vertical-align: inherit;">Si vous lisez ce fichier, vous pouvez trouver des enregistrements de tous les packages dont React a besoin. </font><font style="vertical-align: inherit;">C'est là que réside l'enfer des dépendances. </font><font style="vertical-align: inherit;">Tout ce dont le projet a besoin est décrit ici.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprendre les dépendances de Gatsby.js</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment se fait-il qu'ayant établi une seule dépendance, nous ajoutions jusqu'à 19 000 dépendances au projet? </font><font style="vertical-align: inherit;">Tout dépend des dépendances de dépendance. </font><font style="vertical-align: inherit;">C'est pourquoi nous avons ce que nous avons:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm install --save gatsby<font></font>
<font></font>
...<font></font>
<font></font>
+ gatsby@2.19.28<font></font>
added 1 package from 1 contributor, removed 9 packages, updated 10 packages and audited 19001 packages <span class="hljs-keyword">in</span> 40.382s
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous regardez </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dedans, vous ne pouvez trouver qu'une seule dépendance. Mais si vous le regardez </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il s'avère que devant nous se trouve un monstre de presque 14 kilo-octets. Une réponse plus détaillée sur ce que toutes les lignes de code qui tombent dans ce moyen </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut être trouvé dans le fichier </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le référentiel Gatsby.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il y a beaucoup de dépendances directes, à savoir, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selon les calculs de npm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 132. Si chacune de ces dépendances a au moins une autre dépendance, alors le nombre total de dépendances du projet doublera - et il aura 264 dépendances. Bien sûr, dans le monde réel, ce n'est pas le cas. Chaque dépendance de projet directe a plus d'une dépendance inhérente. Par conséquent, la liste des dépendances du projet est très longue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous allons nous intéresser au nombre de fois où la bibliothèque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lodash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est utilisée comme dépendance pour d'autres packages </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm ls lodash<font></font>
example-js-package@1.0.0<font></font>
└─┬ gatsby@2.19.28<font></font>
&nbsp;&nbsp;├─┬ @babel/core@7.8.6<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/generator@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/types@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @babel/traverse@7.8.6<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @typescript-eslint/parser@2.22.0<font></font>
&nbsp;&nbsp;│ └─┬ @typescript-eslint/typescript-estree@2.22.0<font></font>
&nbsp;&nbsp;│ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ babel-preset-gatsby@0.2.29<font></font>
&nbsp;&nbsp;│ └─┬ @babel/preset-env@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-block-scoping@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-classes@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-define-map@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-modules-amd@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-module-transforms@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; └─┬ @babel/plugin-transform-sticky-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; └─┬ @babel/helper-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, la plupart de ces dépendances sont représentées par la même version de lodash. </font><font style="vertical-align: inherit;">Et avec cette approche, il n'y </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aura qu'un seul dossier de bibliothèque lodash. </font><font style="vertical-align: inherit;">Certes, ce n'est généralement pas tout à fait le cas. </font><font style="vertical-align: inherit;">Parfois, différents packages nécessitent différentes versions du même package. </font><font style="vertical-align: inherit;">C'est pourquoi de nombreuses blagues sont apparues sur la taille énorme du dossier </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans notre cas, cependant, tout n'est pas si mal:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh node_modules<font></font>
200M&nbsp; &nbsp; node_modules<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
200 mégaoctets n'est pas si mal. </font><font style="vertical-align: inherit;">J'ai vu comment la taille de ce dossier atteint facilement 700 Mo. </font><font style="vertical-align: inherit;">Si vous souhaitez savoir quels modules occupent le plus d'espace, vous pouvez exécuter la commande suivante:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh ./node_modules/* | sort -nr | grep <span class="hljs-string">'\dM.*'</span><font></font>
&nbsp;17M&nbsp; &nbsp; ./node_modules/rxjs<font></font>
8.4M&nbsp; &nbsp; ./node_modules/@types<font></font>
7.4M&nbsp; &nbsp; ./node_modules/core-js<font></font>
6.8M&nbsp; &nbsp; ./node_modules/@babel<font></font>
5.4M&nbsp; &nbsp; ./node_modules/gatsby<font></font>
5.2M&nbsp; &nbsp; ./node_modules/eslint<font></font>
4.8M&nbsp; &nbsp; ./node_modules/lodash<font></font>
3.6M&nbsp; &nbsp; ./node_modules/graphql-compose<font></font>
3.6M&nbsp; &nbsp; ./node_modules/@typescript-eslint<font></font>
3.5M&nbsp; &nbsp; ./node_modules/webpack<font></font>
3.4M&nbsp; &nbsp; ./node_modules/moment<font></font>
3.3M&nbsp; &nbsp; ./node_modules/webpack-dev-server<font></font>
3.2M&nbsp; &nbsp; ./node_modules/caniuse-lite<font></font>
3.1M&nbsp; &nbsp; ./node_modules/graphql<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rxjs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un paquet insidieux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une commande simple qui permet de réduire la taille du dossier </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et de simplifier sa structure:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm dedup<font></font>
moved 1 package and audited 18701 packages <span class="hljs-keyword">in</span> 4.622s<font></font>
<font></font>
51 packages are looking <span class="hljs-keyword">for</span> funding<font></font>
&nbsp;&nbsp;run `npm fund` <span class="hljs-keyword">for</span> details<font></font>
<font></font>
found 0 vulnerabilities<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déduplication,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm essaie de simplifier la structure de l'arborescence de dépendances en recherchant les dépendances utilisées par d'autres dépendances et en les déplaçant afin qu'elles puissent être partagées. Cela s'applique à notre exemple lodash. De nombreux packages sont utilisés </font></font><code>lodash @4.17.15</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par conséquent, pour garantir leur opérabilité, il suffit d'installer cette version de la bibliothèque une seule fois. Bien sûr, c'est la situation dans laquelle nous nous trouvons depuis le tout début, uniquement en établissant des dépendances. Si dans le processus de travail sur un projet </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajouter de nouvelles dépendances, il est parfois recommandé de se souvenir de l'équipe </font></font><code>npm dedup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si vous utilisez le gestionnaire de paquets de fils, une commande similaire ressemble à la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déduplication de fils</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais, en fait, cela n'est pas nécessaire, car l'optimisation des dépendances est effectuée automatiquement lorsque la commande est exécutée </font></font><code>yarn install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisation des dépendances</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intéressé par une représentation graphique des dépendances de votre projet? </font><font style="vertical-align: inherit;">Si c'est le cas, vous pouvez créer une telle présentation à l'aide d'outils spéciaux. </font><font style="vertical-align: inherit;">Examinons certains d'entre eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui suit est un résultat de visualisation de dépendance obtenu en utilisant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm.anvaka.com/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfb/f5d/373/dfbf5d37377bd62f4ea5cf422de62c74.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisation des dépendances à l'aide de npm.anvaka.com</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vous pouvez voir ici les dépendances des dépendances du package de projet Gatsby.js. Le résultat est similaire à un énorme site Web. Le projet Gatsby.js a tellement de dépendances que ce «web» a presque «bloqué» mon navigateur.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maintenant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , si vous êtes intéressé, un lien vers ce diagramme. Il peut être présenté sous forme 3D.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une visualisation réalisée à l'aide de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm.broofa.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/285/cd6/c52/285cd6c52a00d9e87a7bc2095df6023f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un fragment d'une visualisation de dépendance faite en utilisant npm.broofa.com</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ceci est similaire à un organigramme. </font><font style="vertical-align: inherit;">Elle, pour Gatsby.js, s'avère très compliquée. </font><font style="vertical-align: inherit;">Vous pouvez y jeter un œil</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Éléments</font><font style="vertical-align: inherit;">circuit peuvent être colorés selon les estimations de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npms.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez télécharger votre propre fichier sur le site</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'outil</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Package Phobia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permet de déterminer l'espace dont il a besoin avant d'installer un package.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25c/d26/ae4/25cd26ae4fc708f0c6900c5ad3a5dead.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informations sur le package reçues à l'aide de Phobie du package</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vous pouvez découvrir ici la taille du package publié et la quantité d'espace disque nécessaire après l'installation.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion: une grande puissance s'accompagne d'une grande responsabilité</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fin de compte, je tiens à dire que JavaScript et NPM sont d'excellents outils. </font><font style="vertical-align: inherit;">La bonne chose est que les développeurs modernes ont la possibilité d'utiliser un énorme ensemble de dépendances. </font><font style="vertical-align: inherit;">L'exécution de la commande </font></font><code>npm install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour vous éviter d'écrire quelques lignes de code est si facile que nous oublions parfois les conséquences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que vous avez lu jusqu'à présent, vous devriez avoir une compréhension plus complète des fonctionnalités de l'arborescence des dépendances de npm-project. </font><font style="vertical-align: inherit;">Si vous ajoutez une bibliothèque au projet qui est très grande, ou si vous explorez simplement les dépendances de votre projet, vous pouvez toujours profiter de ce que nous avons discuté ici et analyser les dépendances. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Voulez-vous utiliser le moins de dépendances possible dans vos projets npm?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr499656/index.html">Simulation de régulateur de température PID</a></li>
<li><a href="../fr499658/index.html">Un ouvrier au lieu d'un testeur? Vaut-il la peine d'étudier le sélénium en 2020?</a></li>
<li><a href="../fr499662/index.html">Racine de confiance pour l'IoT et les autres tendances de sécurité IoT</a></li>
<li><a href="../fr499664/index.html">Portage d'API vers TypeScript comme solutionneur de problèmes</a></li>
<li><a href="../fr499666/index.html">PEP 572 (expressions d'affectation en python 3.8)</a></li>
<li><a href="../fr499670/index.html">Я перехожу на JavaScript</a></li>
<li><a href="../fr499674/index.html">Une autre étape vers les ordinateurs optiques</a></li>
<li><a href="../fr499676/index.html">Plus de 90 outils utiles pour Kubernetes: déploiement, gestion, surveillance, sécurité et plus</a></li>
<li><a href="../fr499680/index.html">Learning Kubernetes: Basic 14-16 May, Advanced 18-20 May</a></li>
<li><a href="../fr499682/index.html">Que puis-je obtenir au hackathon, à l'exception d'un prix en argent?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>