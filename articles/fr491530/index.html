<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ü üëå ‚¨úÔ∏è Encore une fois environ 433 MHz √©metteurs et r√©cepteurs üìπ ü§ôüèæ üë©üèº‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'ensemble le plus simple de r√©cepteur et d'√©metteur ISM 433 MHz a gagn√© une popularit√© bien m√©rit√©e parmi les amateurs d'√©lectronique. Les kits sont ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Encore une fois environ 433 MHz √©metteurs et r√©cepteurs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491530/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'ensemble le plus simple de r√©cepteur et d'√©metteur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 433 MHz </font><font style="vertical-align: inherit;">a </font><font style="vertical-align: inherit;">gagn√© une popularit√© bien m√©rit√©e parmi les amateurs d'√©lectronique. Les kits sont bon march√© (m√™me dans Chip-Deep, vous pouvez les acheter pour 300 roubles, et sur Ali, disent-ils, g√©n√©ralement pour une cinquantaine de dollars), ils sont simples et fiables. De plus (ce que vous ne soup√ßonnez probablement pas), il s'agit de la m√©thode d'√©change de donn√©es sans fil la plus longue et la plus p√©n√©trante - un signal √† une fr√©quence de 433 MHz passe beaucoup mieux √† travers des obstacles et fonctionne √† une distance plus √©loign√©e que dans la bande populaire de 2,4 GHz (433 MHz est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compl√®tement retard√© par un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mur d'un demi-m√®tre de b√©ton, et le Wi-Fi est d√©j√† en train de mourir de 10 centim√®tres). J'avoue que les modules </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MBee-868</font></a><font style="vertical-align: inherit;"> sont r√©cemment apparus</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equip√©s d'une antenne (directionnelle) appropri√©e, ils "tirent" plus loin, mais ils sont au moins un ordre de grandeur plus chers, plus difficiles √† connecter, n√©cessitent une gestion √©conome en √©nergie et une pr√©configuration. </font><font style="vertical-align: inherit;">Et en plus, la fr√©quence de 868 MHz traverse des obstacles deux fois plus mauvais (bien que, bien s√ªr, elle soit incomparablement meilleure que la fr√©quence de 2,4 GHz). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a04/2bb/c3c/a042bbc3ca312c739041b507e7ca4b5e.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup a √©t√© √©crit sur les √©metteurs et r√©cepteurs 433 MHz (y compris sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">concentrateur)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bien s√ªr. </font><font style="vertical-align: inherit;">Cependant, il semble que personne ne sache comment inclure correctement ce kit dans le circuit pour une raison √©trange. </font><font style="vertical-align: inherit;">Quand je lis encore une fois </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que le kit ¬´a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pris 8 m√®tres en ligne de mire, le 9√®me m√®tre n'a pas pu √™tre ma√Ætris√©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", Ma patience a cass√©. </font><font style="vertical-align: inherit;">Quels autres 8 m√®tres?! </font><font style="vertical-align: inherit;">√Ä 40-50 j'aurais cru, m√™me si en r√©alit√©, probablement, la gamme est encore plus grande.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que je r√©sous davantage le probl√®me de la cr√©ation d'une ligne de transfert de donn√©es arbitraires, et pas seulement le contr√¥le de prises intelligentes ou de mod√®les r√©duits de bateaux. Ma t√¢che est plus compliqu√©e, mais la distance de fonctionnement fiable est encore beaucoup plus grande. De plus, dans une telle t√¢che, il est important non seulement et non pas tant la distance √† l'int√©rieur de la ligne de vis√©e (elle ne peut servir qu'√† des fins de comparaison), mais la capacit√© de p√©n√©trer divers obstacles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai un tel kit qui fonctionne dans le pays √† une distance d'environ 25-30 m√®tres √† un angle aigu par rapport au mur en rondins, de sorte qu'environ un m√®tre (au total) de murs et de cloisons, partiellement prot√©g√©s par une feuille isolante, se trouve dans le chemin du signal. √Ä une distance beaucoup plus courte, presque directement derri√®re le mur, le WiFi perd d√©j√† compl√®tement le signal. En ville, le signal se termine d'un bout √† l'autre d'un appartement de trois pi√®ces en ville √† travers deux cloisons int√©rieures, ainsi que depuis le balcon, o√π en ligne droite entre l'√©metteur et le r√©cepteur au moins 80 centim√®tres de ma√ßonnerie et une cloison en pl√¢tre. Je n'ai pas utilis√© d'options de kit plus ch√®res mentionn√©es dans l'examen ci-dessus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un avantage suppl√©mentaire du kit est que, dans les pauses, l'√©metteur ne consomme rien, et sans modes de veille sp√©ciaux, simplement par le principe de son appareil (le courant de consommation au repos est comparable aux courants de fuite du collecteur d'un transistor verrouill√©, soit environ 100 nA). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons quels sont les pi√®ges.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion de l'√©metteur</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©metteur (il est appel√© FS1000A), comme nous le voyons sur son sch√©ma ci-dessous, est le g√©n√©rateur le plus simple bas√© sur un r√©sonateur SAW 433 MHz. </font><font style="vertical-align: inherit;">Le g√©n√©rateur est assembl√© sur le transistor Q1, et le transistor Q2, sur la base duquel des donn√©es num√©riques sont fournies, est simplement une cl√© qui relie le g√©n√©rateur √† l'alimentation (au bus GND) en pr√©sence d'un niveau √©lev√© (unit√© logique) √† l'entr√©e. </font><font style="vertical-align: inherit;">La puissance peut √™tre de 5 √† 12 volts et, selon les fabricants, plus la puissance est √©lev√©e, plus la connexion fonctionne.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a21/50c/737/a2150c737eb648ed465e060aa2d178ae.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas remarqu√© les avantages fondamentaux d'une meilleure nutrition dans le cadre de ma t√¢che. N√©anmoins, il ne faut pas n√©gliger le fait qu'il n'y a pas ici d'alimentation √©lectrique particuli√®re, et avec une tension accrue, l'appareil ne fonctionnera que mieux. Il est pratique de connecter l'√©metteur directement √† la tension d'un adaptateur 9-12 volts, d'une batterie ou d'un ensemble de 6 batteries (broche Vin Arduino). Avec une alimentation non stabilis√©e, qui peut d√©passer 12 volts (comme, par exemple, avec des batteries), je dissocie g√©n√©ralement l'√©metteur du circuit principal avec un stabilisateur 9 volts s√©par√© (vous pouvez utiliser le 78L09 le plus simple), et je ne vois aucune diff√©rence de fonctionnement entre les 9 et 12 volts. Avec Uno ou Nano, vous pouvez utiliser le stabilisateur int√©gr√© de 5 volts pour alimenter le contr√¥leur lui-m√™me et d'autres circuits (par exemple, des capteurs)et pour Mini (en particulier ses clones bon march√©), je vous conseille de mettre un stabilisateur s√©par√© de 5 volts, en le connectant √† la broche 5V.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que r√©cemment des √©metteurs sont apparus qui semblent quelque peu non standard (voir. Fig. Ci-dessous). Il s'est av√©r√© que l'absence d'un acc√©l√©rateur L1 (trois tours), dont il ne restait que des trous - une fiction, il a simplement √©t√© remplac√© par le composant SMD correspondant. Le pire dans cette option est diff√©rent: l'impression b√¢cl√©e peut √™tre trompeuse en ce qui concerne la connexion des sorties de donn√©es et de l'alimentation. La connexion correcte est indiqu√©e sur la figure, elle est la m√™me pour toutes les options:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/db4/cfc/e17/db4cfce176c768cc5f3504edfbf91513.png" width="250"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La chose la plus frappante √† ce sujet est que lorsque les donn√©es et la puissance sont m√©lang√©es, l'√©metteur continue de fonctionner sur de courtes distances! </font><font style="vertical-align: inherit;">Si vous regardez le circuit, vous comprendrez de quoi il s'agit: la base Q2 √† travers la r√©sistance est connect√©e √† l'alimentation, le transistor est toujours ouvert et n'affecte pas le fonctionnement du circuit. </font><font style="vertical-align: inherit;">Un niveau logique √©lev√© sur le bus d'alimentation alimente simplement le g√©n√©rateur au bon moment. </font><font style="vertical-align: inherit;">Les absurdit√©s commencent √† une certaine distance - il est clair que d'une conclusion logique, la source d'alimentation est mauvaise.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion r√©cepteur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'achat d'un r√©cepteur (il peut √™tre appel√© MX-RM-5V ou XD-RF-5V), faites attention √† la longueur des terminaux - je suis tomb√© sur un lot entier avec des broches raccourcies, ce qui a fait tomber le </font><font style="vertical-align: inherit;">r√©cepteur </font><font style="vertical-align: inherit;">du connecteur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> standard </font><font style="vertical-align: inherit;">√† la moindre distorsion et son Je devais m'attacher sp√©cifiquement au tableau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le circuit r√©cepteur est beaucoup plus compliqu√© (je ne le jouerai pas, mais vous pouvez le trouver, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Il doit recevoir et amplifier un signal haute fr√©quence, filtrer la fr√©quence de 433 MHz, isoler les salves et les convertir en niveaux logiques. Le r√©cepteur a une self de r√©glage (au milieu de la carte), mais sans instruments pr√©cis pour mesurer les caract√©ristiques amplitude-fr√©quence, je ne recommande pas de le tordre - tr√®s probablement, vous n'am√©liorerez rien, mais vous le g√¢terez seulement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que d√©j√† √† courte distance, le signal sera beaucoup moins d'interf√©rences, il est clair que nous devons traiter les interf√©rences sur tous les fronts: ainsi que les circuits et les m√©thodes logicielles. Les biblioth√®ques font la derni√®re chose pour nous, mais peu importe les math√©matiques utilis√©es dans le traitement logiciel, il est conseill√© de tout faire en premier afin que l'unit√© logique √† la sortie n'apparaisse que lorsqu'un signal utile √©clate et n'apparaisse pas en cas d'interf√©rence. En d'autres termes, il serait bien de se d√©saccorder au maximum √† l'avance contre les interf√©rences pendant la r√©ception.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode standard de r√©duction du bruit, connue √† mon √©poque pour chaque √©tudiant qui a assembl√© au moins une radio ou un amplificateur, est que pour les n≈ìuds sensibles aux interf√©rences, il est n√©cessaire de faire une alimentation s√©par√©e, isol√©e au maximum des autres circuits. Vous pouvez le faire de diff√©rentes mani√®res: une fois que vous avez install√© une diode Zener distincte, elles isolent d√©sormais souvent la puissance d'un n≈ìud probl√©matique avec un filtre LC (cela est recommand√©, par exemple, pour les ADC, voir les fiches techniques des contr√¥leurs AVR). Mais dans nos conditions, lorsque les composants modernes sont petits et bon march√©, il est plus facile de simplement mettre un stabilisateur s√©par√© du reste sur le r√©cepteur.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bd3/85b/94a/bd385b94af583fa8c188053297965c1b.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un stabilisateur, par exemple, du type LP2950-5.0 plus deux condensateurs n√©cessaires pour celui-ci dans l'option la moins ch√®re (lorsque les deux condensateurs sont en c√©ramique, dans la gamme 1-3 microfarads) ajouteront soixante maximum au co√ªt de votre circuit. Mais je pr√©f√®re ne pas √©conomiser: en sortie je mets une c√©ramique ordinaire, et en entr√©e je mets un √©lectrolyte (10-100 microfarads), en plus, √† l'√©tat solide (polym√®re) ou au tantale. Les condensateurs en c√©ramique peuvent √™tre supprim√©s √† la fois l√† et l√†, si la tension d'entr√©e de 7-12 volts provient de batteries-batteries ou d'un autre stabilisateur analogique. Les sources stabilis√©es puls√©es et les redresseurs non stabilis√©s les plus simples n√©cessitent un filtrage suppl√©mentaire. Vous pouvez utiliser un √©lectrolyte en aluminium bon march√© si vous mettez un microfarad en c√©ramique 0,1 parall√®le √† celui-ci,il est m√™me pr√©f√©rable de mettre une inductance s√©rie √† l'entr√©e de plusieurs fractions ou unit√©s de milligenri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le stabilisateur doit √™tre install√© directement pr√®s du r√©cepteur, la longueur des conducteurs doit √™tre minimale. Au lieu du LP2950, ‚Äã‚Äãvous pouvez prendre le LM2931 ou similaire avec une petite tension de travers√©e (cela est particuli√®rement important si le circuit est aliment√© par des piles - pour un LM78L05 ordinaire, la tension d'entr√©e doit √™tre d'au moins 7,5, et de pr√©f√©rence de 8 √† 9 volts).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compar√© au cas de l'alimentation du r√©cepteur directement depuis Arduino, comme recommand√© dans toutes les publications (je n'ai pas vu d'exceptions), vous serez √©tonn√© de l'effet obtenu - la port√©e et la capacit√© de p√©n√©trer √† travers les murs augmentent imm√©diatement de mani√®re significative. Le r√©cepteur, ainsi que le stabilisateur, peuvent √™tre plac√©s dans une petite bo√Æte s√©par√©e pour plus de commodit√©. Vous pouvez connecter sa sortie au contr√¥leur dans le corps principal avec n'importe quel fil √† trois fils (deux alimentations et un conducteur de signal) jusqu'√† 3 m√®tres de long, et peut-√™tre plus. C'est plus pratique car les antennes sont toujours n√©cessaires, et selon les r√®gles, ce sera mieux si elles sont parall√®les les unes aux autres dans l'espace, et les grands bo√Ætiers ne peuvent pas toujours √™tre plac√©s de sorte que les antennes d√©passent dans la bonne orientation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la version la plus simple, en tant qu'antennes, vous pouvez le faire avec des bouts de fil unipolaire d'une section d'au moins 0,5 mm et d'une longueur de 17 cm ¬± 1-3 mm. </font><font style="vertical-align: inherit;">N'utilisez pas de fil de montage toronn√©! </font><font style="vertical-align: inherit;">Des antennes spirales plus compactes sont en vente, mais je n'ai personnellement pas test√© leur efficacit√©. </font><font style="vertical-align: inherit;">La pointe de l'antenne de l'√©metteur et du r√©cepteur est scell√©e dans le trou correspondant dans le coin de la carte (ne vous y trompez pas dans la version am√©lior√©e de l'√©metteur - le mot ANT est √©galement hors de propos, voir fig. Ci-dessus).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©ration et traitement des donn√©es transmises</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est le deuxi√®me inconv√©nient majeur de la plupart des critiques sur notre sujet: les auteurs se limitent √† un probl√®me local, sans le formuler de mani√®re g√©n√©rale, comme le transfert de donn√©es arbitraires dans un seul package. Comme vous l'avez compris √† partir de la description ci-dessus, seule une simple s√©quence de bits peut √™tre transmise par notre ensemble. La biblioth√®que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualWire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> standard les </font><font style="vertical-align: inherit;">encode d'une mani√®re sp√©ciale (chaque t√©trade est cod√©e avec 6 bits, un en-t√™te de synchronisation est ajout√© en face et une somme de contr√¥le pour le paquet entier est ajout√©e) et transforme la sortie en une s√©quence d'octets plus famili√®re. Mais le programmeur doit d√©j√† s'en occuper seul.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous supposons que l'√©metteur et le r√©cepteur sont connect√©s √† l'Arduino. En plus de VirtualWire, en lien avec l'essor des ¬´maisons intelligentes¬ª, il y en a beaucoup plus, comme RC-Switch ou RemoteSwitch, mais ils se concentrent sur d'autres t√¢ches, et cela ne vaut clairement pas la peine de les utiliser pour transf√©rer des donn√©es arbitraires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La longueur maximale d'un seul message dans VirtualWire est de 27 octets (voir la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). La transmission d'un message complet (il est automatiquement compl√©t√© par une signature 0xb38, une valeur de longueur de message et une somme de contr√¥le) √† ma vitesse choisie de 1200 bps est de 0,35 seconde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus, par ailleurs, la vitesse de transmission s√©lectionn√©e, la port√©e de transmission sera moindre. D'apr√®s l'exp√©rience de l'utilisation du RS-232, on sait qu'avec une port√©e croissante, la vitesse de transmission autoris√©e diminue de fa√ßon exponentielle: √† une vitesse de 19200, une ligne non blind√©e parcourt 15 m√®tres, √† 9600 - 150 m√®tres et √† une vitesse de 1200 - plus d'un kilom√®tre. Il serait int√©ressant de d√©couvrir exp√©rimentalement la nature de cette d√©pendance pour notre cas, car beaucoup ici d√©pend des math√©matiques utilis√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'initialisation de l'√©metteur dans VirtualWire ressemble √† ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span><font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span>
  vw_set_tx_pin(<span class="hljs-number">10</span>);   <span class="hljs-comment">//   VirtualWire D10</span><font></font>
. . . . .<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous analyserons les principes de la g√©n√©ration de donn√©es √† l'aide d'un exemple sp√©cifique. Ayons un capteur de temp√©rature-humidit√© √† distance. Il donne des valeurs (variables de temp√©rature et d'humidit√©) sous la forme d'un nombre r√©el avec un signe (flottant). Pour faciliter la compr√©hension √† l'extr√©mit√© de r√©ception, nous allons tous r√©duire √† un entier positif avec le nombre de d√©cimales au moins 4, traduire les bits individuellement en caract√®res ASCII, transf√©rer la cha√Æne r√©sultante et effectuer des op√©rations inverses √† l'extr√©mit√© de r√©ception. Bien s√ªr, vous pouvez simplifier la t√¢che (par exemple, vous passer de la conversion en ASCII et raccourcir les nombres), mais sous cette forme, il s'av√®re √™tre le m√™me pour presque n'importe quel type de donn√©es num√©riques, ce qui simplifie le d√©sassemblage lors de la r√©ception. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En pratique, il est pratique d'utiliser le type String pour composer un message, quelque chose comme ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-comment">//    </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ledPin 13 <span class="hljs-comment">//  (D13,  19 ATmega) </span></span>
<span class="hljs-keyword">char</span> msg[<span class="hljs-number">13</span>];
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> tmpr=<span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> hum=<span class="hljs-number">0</span>;<font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  delay(<span class="hljs-number">1000</span>); <span class="hljs-comment">// 1 c</span>
<span class="hljs-keyword">float</span> temperature;
<span class="hljs-keyword">float</span> humidity;<font></font>
. . . . .  <span class="hljs-comment">//   temperature  humidity  </span>
<span class="hljs-comment">//       4 :</span>
  tmpr = temperature*<span class="hljs-number">10</span>+<span class="hljs-number">2731</span>; <span class="hljs-comment">//2731 =     </span>
<span class="hljs-comment">//    4 :</span>
  hum = humidity*<span class="hljs-number">10</span>+<span class="hljs-number">1000</span>; 
<span class="hljs-comment">//  :</span>
  digitalWrite (ledPin,HIGH); <span class="hljs-comment">//  ‚Äî  </span>
  String strMsg=<span class="hljs-string">"DAH"</span>; <span class="hljs-comment">// - </span>
  strMsg+=tmpr; <span class="hljs-comment">//  </span>
  strMsg+=hum; <span class="hljs-comment">// </span>
  strMsg.toCharArray(msg,<span class="hljs-number">12</span>); <span class="hljs-comment">//   , 12 ‚Äì  </span>
<span class="hljs-comment">//  :</span>
  vw_send((<span class="hljs-keyword">uint8_t</span> *)msg, <span class="hljs-built_in">strlen</span>(msg)); <span class="hljs-comment">//  </span>
  vw_wait_tx(); <span class="hljs-comment">//   </span>
  delay(<span class="hljs-number">500</span>); <span class="hljs-comment">// 500 </span>
  digitalWrite (ledPin, LOW); <span class="hljs-comment">//  ‚Äî  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous devez transf√©rer des nombres plus pr√©cis avec un grand nombre de chiffres, vous augmentez simplement la longueur du tableau msg. Les variables globales ¬´volatiles¬ª tmpr et hum sont n√©cessaires si vous faites la moyenne de plusieurs lectures, sinon elles peuvent √©galement √™tre d√©clar√©es locales dans la fonction loop (). Le message, comme vous le voyez, se compose des valeurs de temp√©rature et d'humidit√© converties, en cha√Ænes ASCII de quatre octets chacune, pr√©c√©d√©es d'une cha√Æne de trois caract√®res ¬´DAH¬ª (les caract√®res peuvent √™tre tout autre de la table ASCII). Il s'agit d'une signature qui vous permettra de distinguer ce message des autres possibles envoy√©s par des appareils similaires. Ne n√©gligez pas la signature, m√™me si vous pensez que d'autres appareils √† proximit√© de cette plage ne sont pas attendus, en m√™me temps, elle sert de garantie suppl√©mentaire de l'int√©grit√© des donn√©es re√ßues.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez √©galement que lors de la conversion d'une cha√Æne en un tableau, vous devez sp√©cifier un caract√®re de plus que la longueur totale du message (3 + 4 + 4 = 11), cela prend en compte le caract√®re z√©ro qui ferme la cha√Æne. </font><font style="vertical-align: inherit;">Et la taille du tableau msg [] doit √™tre sp√©cifi√©e avec une marge et peut √™tre quelconque, dans ce cas de 13 √† 27 octets. </font><font style="vertical-align: inherit;">Lors du transfert, il sera toujours envoy√© exactement autant que la fonction strlen (msg) renverra, soit 11 octets + un caract√®re nul. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la partie r√©ceptrice, le tableau r√©sultant de codes ASCII devra √™tre analys√©. </font><font style="vertical-align: inherit;">Mais vous devez d'abord l'accepter. </font><font style="vertical-align: inherit;">Pour initialiser la r√©ception, les actions suivantes sont effectu√©es:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span>
<span class="hljs-keyword">char</span> str[<span class="hljs-number">5</span>];     ASCII  
  <span class="hljs-keyword">uint8_t</span> buf [VW_MAX_MESSAGE_LEN];  <span class="hljs-comment">//    </span>
  <span class="hljs-keyword">uint8_t</span> buflen = VW_MAX_MESSAGE_LEN;  <span class="hljs-comment">// max   </span><font></font>
. . . . .<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_set_rx_pin(<span class="hljs-number">2</span>); <span class="hljs-comment">//D2   VirtualWire</span>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span><font></font>
. . . . .<font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, la technique d'analyse d'une ligne est la suivante:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_rx_start();  <span class="hljs-comment">//  </span>
  buflen = VW_MAX_MESSAGE_LEN; <span class="hljs-comment">//    </span>
 <span class="hljs-keyword">if</span> (vw_have_message()) { <span class="hljs-comment">// </span>
 <span class="hljs-keyword">if</span> (vw_get_message(buf, &amp;buflen)) <span class="hljs-comment">//   </span><font></font>
  {<font></font>
    vw_rx_stop(); <span class="hljs-comment">//   :</span>
        <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; i++)  <span class="hljs-comment">//    </span>
                str[i]= buf[i]; <span class="hljs-comment">// </span>
                str[<span class="hljs-number">3</span>]=<span class="hljs-string">'\0'</span>;
      <span class="hljs-keyword">if</span> ((str[<span class="hljs-number">0</span>]==<span class="hljs-string">'D'</span>)&amp;&amp;(str[<span class="hljs-number">1</span>]==<span class="hljs-string">'A'</span>)&amp;&amp;(str[<span class="hljs-number">2</span>]==<span class="hljs-string">'H'</span>)) {
<span class="hljs-comment">// ,  </span>
       <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">3</span>;i&lt;<span class="hljs-number">7</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-3</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> tmpr=atoi(str); <span class="hljs-comment">//   </span>
      tmpr=tmpr<span class="hljs-number">-2731</span>; <span class="hljs-comment">// 2731,     </span>
. . . . .<span class="hljs-comment">//    10    float,  </span>
. . . . . <span class="hljs-comment">//    -</span>
<span class="hljs-comment">// :</span>
      <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">7</span>;i&lt;<span class="hljs-number">11</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-7</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> hh = atoi(str); <span class="hljs-comment">//   </span>
      hh=(hh<span class="hljs-number">-1000</span>)/<span class="hljs-number">10</span>;
      <span class="hljs-keyword">if</span> (hh&gt;<span class="hljs-number">99</span>) hh=<span class="hljs-number">99</span>; <span class="hljs-comment">//   %,  </span>
. . . . . <span class="hljs-comment">// -</span>
   } <span class="hljs-comment">//end   DAT</span>
  } <span class="hljs-comment">//end  </span>
 } <span class="hljs-comment">// </span>
} <span class="hljs-comment">// end loop</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que vous avez maintenant moins de questions sur l'utilisation de ces appareils bon march√© et faciles √† utiliser.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr491518/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 501 (18/02/2020/24/02/2020)</a></li>
<li><a href="../fr491520/index.html">Convertir xls en xlsx et xml en C #</a></li>
<li><a href="../fr491522/index.html">Pourquoi les femmes vivent-elles plus longtemps</a></li>
<li><a href="../fr491524/index.html">Stas Afanasyev. Juno. Pipelines bas√©s sur io.Reader / io.Writer. Partie 2</a></li>
<li><a href="../fr491528/index.html">Mon exp√©rience a conduit 1000 interviews. Synopsis du rapport de Yegor Bugaenko</a></li>
<li><a href="../fr491532/index.html">Laravel + Docker + Gitlab. O√π commencer</a></li>
<li><a href="../fr491534/index.html">Un bref guide d'utilisation de GDB</a></li>
<li><a href="../fr491536/index.html">YouTube - Erreur. Veuillez r√©essayer plus tard. ID de lecture: <...></a></li>
<li><a href="../fr491538/index.html">Lemmes d'√©talement pour les langues r√©guli√®res et sans contexte</a></li>
<li><a href="../fr491540/index.html">R√©seaux pour un informaticien d√©butant. Base obligatoire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>