<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💃🏿 👨🏼‍🏫 😀 Instagramの顔駆動型ゲームマスク、または目をダブルクリック ☠️ 😵 😰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="なんてナンセンスだと思う。どんな意味のない単語のセットですか？しかし、悲しいかな、または歓声-そのような誰か、今日これはナンセンスではなく、現実です。この記事は、私がInstagramのために書いたゲームで、あなたの顔がコントローラーとして使用されます。むしろ、コントローラーだけでなく、頭全体がコン...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Instagramの顔駆動型ゲームマスク、または目をダブルクリック</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486498/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/qr/9p/o1/qr9po1b7d633kt3pmdsf2esb9io.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なんてナンセンスだと思う。どんな意味のない単語のセットですか？しかし、悲しいかな、または歓声-そのような誰か、今日これはナンセンスではなく、現実です。この記事は、私がInstagramのために書いたゲームで、あなたの顔がコントローラーとして使用されます。むしろ、コントローラーだけでなく、頭全体がコントローラーとして使用されます。競技場内を移動するには、頭を回したり傾けたりします。アクションを選択するには、口を開くか、目をダブルクリック（点滅）します。二重点滅はおそらくそれを呼ぶ価値があります...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ああ、勇敢な新しい世界！おそらく、未来のヒップスターは、軽量スペースカプセルの背後に美しいカラフルな煙を生成するスクリプトを開発するか、シェーダーを記述して、落下する雪片（Web 100.0）やフラクタルフォグ（WebGL 100.0）などのパーソナルテレポートの黒いゲートに興味深い視覚効果を与えます。私が将来どのようなナンセンスに対処できるか想像するだけの十分な想像力はありません。論理的に考えすぎてしまいます。しかし、約30年前、私たちは確かに、どんな状況下でも、今日はInstagramと呼ばれるソーシャルネットワークのマスクを作成することさえ考えていたでしょう。さらに、これらのマスクの中に本格的なゲームが表示されます。怖くて面白くなりました。全体として、恐ろしい面白いです。そして、あなたがすでに理解したように、私は抵抗することができず、そのようなゲームも書きました。もちろん、それを再生するには、AndroidまたはiOSのスマートフォンにフロントカメラとInstagramアプリケーションがインストールされている必要があります。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このゲームはチックタックトーです。</font><font style="vertical-align: inherit;">一般的に、これは私が人生で最初に作成したゲームの1つであり、おそらく最初のゲームでさえあります。今は覚えていません。</font><font style="vertical-align: inherit;">しかし、それをPascalで書き戻した後、その古いアルゴリズムをDelphiにドラッグしました。</font><font style="vertical-align: inherit;">その後、もちろん、ゲームはウェブ、私のウェブサイトにも表示されました。まあ、あなた自身の個人的な三目並べのないあなたの個人的なページのどこに...そして今、この壮大なゲームをInstagramに掲載する時が来ました。</font><font style="vertical-align: inherit;">一般的に、私がこのゲームで短剣またはタックトーであった場合（むしろ、おそらくつま先）、私は長くて興味深い人生について多くを語ることができました...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらはどのようなマスクですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめに-簡単な歴史的余談。 MSQRDセルフィーアプリケーションを開発したベラルーシのチームのおかげで、Instagramのマスクが登場しました。このアプリケーションがFacebookによって購入された後、企業内のチームはそのテクノロジーをFacebook製品に統合し続けました。そこで、拡張現実機能を提供するプラットフォーム、Spark ARがありました。 2019年8月、プラットフォームはベータ版のステータスを残し、FacebookとInstagramの拡張現実コンテンツを作成できるすべてのユーザーが利用できるようになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスクは、彼らの人相に面白い効果を与え、続いてソーシャルネットワークに自分撮りを配置するためのフィルターとして考えられました。仮面ゲームはあまり見当たりませんでした。ゆるい鳥のアナログであるフライングフェイスがあり、画面を横切って鳥が飛んでいます。障害物に衝突して、適切なタイミングで点滅するのを防ぐ必要があります。口から落ちてくる食べ物を上から下にキャッチするゲームも見ました。インベーダーのようなシューティングゲーム。そして、キャラクターが街の通りを走り、障害物を飛び越える3Dランナー。たぶん、さらにいくつかあります。一般的に、このトピックはかなり新しいものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテンツ作成プロセスは、Windows用に無料でダウンロードできるSpark AR Studio開発環境で行われます。また、AndrioidまたはiOSモバイルデバイスで作成したエフェクトをテストするために、Spark AR Playerアプリケーションをダウンロードする価値があります。これらのエフェクトは実際に意図されています。コンピューターへの接続は、少なくとも私の場合はAndroidスマートフォンの場合、USBケーブル経由です。 Facebook / sparkarhubコンポーネントを介してマスクをダウンロードし、モデレートに合格すると、すべてのInstagramユーザーがインターネットからあなたのマスク（またはゲーム）を利用できるようになります。マスクは直接リンクまたはInstagramの作成者のページから取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spark AR Studioでの作業方法を理解することはまったく難しいことではありません。</font><font style="vertical-align: inherit;">特にインターネットはこのトピックに関するレッスンでいっぱいなので、私はこれについて詳しく説明しません。</font><font style="vertical-align: inherit;">顔に何らかの静的スプライトを適用するだけでなく、いわゆるパッチを作成することとスクリプトを作成することを含む、多かれ少なかれインタラクティブなアプリケーションを開発する2つの方法があることにのみ注意します。</font><font style="vertical-align: inherit;">最初の方法は、3Dエディターでのマテリアルの操作に視覚的に似ており、2番目の方法は、専用のAPIを使用してJavaScriptでプログラミングするだけです。</font><font style="vertical-align: inherit;">2番目のオプションを選択しました。</font><font style="vertical-align: inherit;">ただし、両方の方法を組み合わせることを禁止する人はいません。スクリプトから、パッチで発生しているすべてにアクセスできる可能性があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフィックアート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、最初に、ゲームで使用されるグラフィック要素をいくつか作成するとよいでしょう。</font><font style="vertical-align: inherit;">お気に入りの3Dモデリングプログラムを開いて作成します。</font><font style="vertical-align: inherit;">私はBlenderを使用しています。</font><font style="vertical-align: inherit;">原則として、別々のスプライトを作成し、Spark ARを使用して動作のロジックを尋ねることができ、3Dエディターをまったく使用しません。</font><font style="vertical-align: inherit;">でも、十字やつま先の形をボリュームたっぷりにしようと思ったので、そういうエディターなしではできませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず最初に、2Dテクスチャを作成します。</font><font style="vertical-align: inherit;">すべてのテクスチャを1つのアトラスに結合します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9y/ii/n8/9yiin8wu1jf3emkzbnyjn88jmgq.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクスチャサテン</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、3Dモデルについて説明します。ゲームの3D空間として、2つの三角形の平面が使用され、その上にフィールドマーキングが引き伸ばされます（ここでは、テクスチャアトラスからの大きなメッシュの断片）。アトラス自体は透明なアルファチャネルを備えています。それぞれ2つの三角形で構成される9つの青い正方形がフィールドに挿入されます。また、3つのモデルには、青の9つに加えて、ゲームの開始時に非表示になる9つの緑と赤の正方形が同じ座標に含まれます。つまり、通常の状態では、フィールドのすべての四角の色は青であり、緑または赤は、それぞれ十字またはゼロを設定する位置を選択するためのカーソルとして使用されます。さらに、緑と赤は、各ラウンドの終わりに3つのセルの勝者の行を強調するために使用されます。もちろんそれで十分でしょう青の9つと緑と赤の3つだけの正方形を使用しますが、表示/非表示に加えて、それらに何らかの移動ロジックを設定する必要があります。空間の座標を操作せずにそれらを非表示にして表示するだけの方が簡単で、3Dモデルはそれをわずかにロードするように思えました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vy/fk/bs/vyfkbs_c_hezcstqfoebd2xyjoy.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">競技場</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ゲームでは、もちろん、9つのグループそれぞれの3つの正方形の位置は一致します。ここでは、3Dモデルが全体として何を構成しているかを明確に示すために、セルの1つにそれらを垂直方向に分散させました。ボックスには特定の方法で名前が付けられていることに注意してください（右側の図で）：b11からb33、g11からg33、r11からr33。各桁は1から3の範囲で変化します。つまり、文字は色を表します番号は行と列です。これは、スクリプトからの名前でボックス（メッシュ、3D用語では）にアクセスするために必要です。これにより、ボックスを非表示および表示するのに便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、十字とつま先自体のモデルを作成し、各セルにもペアで配置しました。</font><font style="vertical-align: inherit;">（明確にするために、彼はゼロの1つを上げました。）これまでのところ、テクスチャが「明るい」という事実を見てはいけません。</font><font style="vertical-align: inherit;">これは、UVスキャンを適用するために行ったものです。</font><font style="vertical-align: inherit;">次に、テクスチャアトラスで、フィギュアのテクスチャを、ゲーム自体で確認できる落ち着いたテクスチャに置き換えました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qq/qc/cp/qqqccp5siugamnwegcpegomgank.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームのピース</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最後に、ゲーム内でカーソルが移動する方向を示す4つの平らな矢印をモデル化しました。</font><font style="vertical-align: inherit;">1つのテクスチャをジオメトリに適用しました。スプライトシートでは、これはストローク内の白い三角形の矢印です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての3Dモデル（フィールド、シェイプ、矢印の3つ）をFBX形式にエクスポートします。これには、Spark AR Studioが必要です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spark AR Studioにインポート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、Spark AR Studioを起動し、そこに3Dモデルをインポートします。左下の[アセット]リストに表示されます。同時に、十字架とつま先の「入れ墨」の形をした戦争の絵の具で、テーマのあるマスクを自分で作成します。テクスチャマスクを作成する方法については、グローバルネットワークの何千ものレッスンから、またはプラットフォームの公式ドキュメントから学ぶことができます。これについては触れません。つまり、「ブランク」をダウンロードし、お気に入りのグラフィックエディタで開き、上に何かを描き、保存し、画像をSpark AR Studioにインポートして、マテリアルとテクスチャのパラメータを調整します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pv/-d/aw/pv-dawxo7-dqxkgd2rxga-umd7w.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アセットから上のシーンリストにモデルをドラッグします。さらに、それらを特定の順序でレンダリングする必要があります。最初にフィールド（field.fbx）、次に図のモデル（fieldxo.fbx）、最後に矢印（arrows.fbx）です。さらに、最下層にはfaceMeshを持つfaceTrackerもあります-これはあなたの顔のマスクです。おそらく任意の順序でモデルをステージに投げることができますが、私はすべてのマテリアル（図を除く）の深度テストと深度テストをオフにし、（マテリアルプロパティの）深度バッファに書き込むので、手動で設定した順序でレンダリングするようにします。マスク-フィールド-数字-矢印。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各レイヤーのマテリアルで、ブレンドモード=アルファを設定して、テクスチャで指定されている部分でオブジェクトが透明になるようにします。</font><font style="vertical-align: inherit;">そして、スムージングのためにテクスチャFiltering = Mediumを設定します。</font><font style="vertical-align: inherit;">（左側のリストからマテリアルまたはテクスチャを選択すると、それらに使用できるすべてのプロパティがウィンドウの右側に表示されます。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、（左下の[+アセットの追加]をクリックして）スクリプト要素をアセットに追加します。</font><font style="vertical-align: inherit;">また、3Dモデルのほかに、script.jsがリストに表示されます。クリックすると、スクリプトの外部テキストエディターが開きます。</font><font style="vertical-align: inherit;">エディターで保存すると、プログラムはSpark AR Studioで再起動します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラミング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトの冒頭で、このプロジェクトで必要なモジュールを接続します。</font><font style="vertical-align: inherit;">これは、シーン、フェイストラッキング、時間、サウンド、アニメーションを操作するためのモジュールです。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> Scene = <span class="hljs-built_in">require</span>(<span class="hljs-string">'Scene'</span>);
<span class="hljs-keyword">const</span> FaceTracking = <span class="hljs-built_in">require</span>(<span class="hljs-string">'FaceTracking'</span>);
<span class="hljs-keyword">const</span> Time = <span class="hljs-built_in">require</span>(<span class="hljs-string">'Time'</span>);
<span class="hljs-keyword">const</span> Audio = <span class="hljs-built_in">require</span>(<span class="hljs-string">'Audio'</span>);
<span class="hljs-keyword">const</span> Animation = <span class="hljs-built_in">require</span>(<span class="hljs-string">'Animation'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
三目並べをJavascriptに実装する方法はたくさんあります。</font><font style="vertical-align: inherit;">この記事は、特定のプログラミング言語でこのゲームを実装することについてではなく、人の助けを借りて管理することについてです。</font><font style="vertical-align: inherit;">原理が理解できるように、Spark ARシステムとの相互作用に固有の要点について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3Dモデル（メッシュ）の名前付きフラグメントへのアクセス。たとえば、競技場の1行2列目の青い正方形にアクセスします。</font></font><br>
<br>
<pre><code class="javascript hljs">Scene.root.find(<span class="hljs-string">'b12'</span>);</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（b12を思い出してください-これは、3Dエディターでこのメッシュを呼び出した方法です。）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この位置の十字へのアクセス：</font></font><br>
<br>
<pre><code class="javascript hljs">Scene.root.find(<span class="hljs-string">'x12'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つま先（o）を非表示にし、十字（x）を設定し、フィールド '32'（3行目、2列目）のセルを緑（g）で着色します。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// figure</span>
Scene.root.find(<span class="hljs-string">'o32'</span>).hidden = <span class="hljs-literal">true</span>;<font></font>
Scene.root.find(<span class="hljs-string">'x32'</span>).hidden = <span class="hljs-literal">false</span>;
<span class="hljs-comment">// background</span>
Scene.root.find(<span class="hljs-string">'b32'</span>).hidden = <span class="hljs-literal">true</span>;<font></font>
Scene.root.find(<span class="hljs-string">'g32'</span>).hidden = <span class="hljs-literal">false</span>;<font></font>
Scene.root.find(<span class="hljs-string">'r32'</span>).hidden = <span class="hljs-literal">true</span>;</code></pre><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tk/xg/bz/tkxgbzthiw7ubagtismtw7pmedk.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「32」フィールドに緑のバックライト付きの緑の十字架。フィールド</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を移動するために頭を回したり傾けたりするイベントに登録してください。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//vert: fov+ back-</span>
FaceTracking.face(<span class="hljs-number">0</span>).cameraTransform.rotationX.monitor().subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
	<span class="hljs-keyword">var</span> v = event.newValue;<font></font>
	...<font></font>
});<font></font>
<font></font>
<span class="hljs-comment">//hor: rt+ dn-</span>
FaceTracking.face(<span class="hljs-number">0</span>).cameraTransform.rotationY.monitor().subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
	<span class="hljs-keyword">var</span> v = event.newValue;<font></font>
	...<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここではすべてが非常に単純です。</font><font style="vertical-align: inherit;">イベントから頭の回転または傾斜の値（event.newValue）を取得し、それらが特定の範囲外であるかどうかを確認します。</font><font style="vertical-align: inherit;">ある場合は、カーソル（緑色のボックス）を視覚的に目的の方向に移動します。</font><font style="vertical-align: inherit;">頭の回転の負の値は、左への回転、正の-右への回転に対応します。</font><font style="vertical-align: inherit;">同様に、頭を前後に傾けて線に沿って移動します。</font><font style="vertical-align: inherit;">範囲全体は-1から+1までです。</font><font style="vertical-align: inherit;">したがって、カーソルの動きを実装して...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そしてそれは私に夜明けしました</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
選択した方法でフィールド上のカーソルを制御するのは不便であることに突然気づきました。1つのセルを移動するには頭を回してから、頭を元の位置に戻し、次のステップのためにもう一度回す必要があります。そして、フィールドの目的のセルにすぐに焦点を合わせるために、頭を横に向けたり前後に傾けたりする分数の値を使用しないのはなぜですか？つまり、見た目で、またはむしろ頭の方向で自分の位置をカーソルに示す方法です。そして、最初の方法は、首にとってあまりにもハードなトレーニングです。もちろん体育は良いですが、同じ程度ではありません。当然、ap.cur = {x：1、y：1}のどこかに現在の位置を記憶して、前の位置のカーソルを消去し、新しい位置の座標を保存します。これは、後で「クリック」に必要です。ところでカーソルの移動方向を示す視覚的な矢印は不要になりました。プロジェクトから1つの3Dモデル（arrows.fbx）をスローします。テクスチャから矢印の画像を消去することもできます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二重点滅？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、私たちは最も興味深いものに行きました。</font><font style="vertical-align: inherit;">目をダブルクリックします。</font><font style="vertical-align: inherit;">認めてください。記事の冒頭で知った瞬間からこれを実行したいと思いましたか？</font><font style="vertical-align: inherit;">これで、マウスが既に古くなっており、今日はダブル点滅がクリックに使用されていることを友達に伝えます！</font><font style="vertical-align: inherit;">二重点滅。</font><font style="vertical-align: inherit;">なぜダブルなの？</font><font style="vertical-align: inherit;">すべてが簡単です。1人の人が不本意に定期的に行うので、1回の瞬きでイベントを停止することはサディズムです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qb/ke/8j/qbke8jqkze91tmgkb2xrhxhjrbm.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spark ARでは、イベントleftEye.opennessとrightEye.opennessがあり、これらをサブスクライブすることで、event.newValueの各アイの開始値を0〜1の範囲で取得できます。0.1未満の値でアイを閉じたと見なします。</font><font style="vertical-align: inherit;">そして、まばたき処理関数をap.blink1（）と呼びます（apは名前空間であり、私にとってはより便利です）。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//leftEye</span>
FaceTracking.face(<span class="hljs-number">0</span>).leftEye.openness.monitor().subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
	<span class="hljs-keyword">if</span>  (event.newValue &lt; <span class="hljs-number">0.1</span>) {<font></font>
		ap.blink1();<font></font>
	};<font></font>
});<font></font>
<font></font>
<span class="hljs-comment">//leftEye</span>
FaceTracking.face(<span class="hljs-number">0</span>).rightEye.openness.monitor().subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
	<span class="hljs-keyword">if</span>  (event.newValue &lt; <span class="hljs-number">0.1</span>) {<font></font>
		ap.blink1();<font></font>
	};<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まばたき処理関数自体では、200ミリ秒のまばたきの最小間隔を定義します。これにより、この関数は両目でまばたきをするとすぐには2回機能しません。</font><font style="vertical-align: inherit;">明らかだと思います。</font><font style="vertical-align: inherit;">また、最大二重点滅時間を定義します-1秒。</font><font style="vertical-align: inherit;">この範囲に当てはめると、現在の位置に十字を表示するaction（）関数が機能します。</font><font style="vertical-align: inherit;">同時に、アクション（）をmouth.opennessイベントにハングアップさせます。これにより、プレーヤーは、クロスを2回点滅させるか、開口させるかを選択できます。</font></font><br>
<br>
<pre><code class="javascript hljs">blink1:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
	<span class="hljs-keyword">var</span> tmNew = <span class="hljs-built_in">Date</span>.now();
	<span class="hljs-keyword">if</span>  (tmNew - ap.blinkStart &gt; <span class="hljs-number">200</span>) {<font></font>
		ap.blinkCount++;<font></font>
		<span class="hljs-keyword">if</span>  (ap.blinkCount &gt; <span class="hljs-number">1</span>) {
			<span class="hljs-comment">//action</span>
			<span class="hljs-keyword">if</span> (tmNew - ap.blinkStart &lt; <span class="hljs-number">1000</span>) {<font></font>
				ap.action();<font></font>
			};<font></font>
			ap.blinkCount = <span class="hljs-number">0</span>;<font></font>
			ap.blinkStart = <span class="hljs-number">0</span>;<font></font>
		} <span class="hljs-keyword">else</span> {<font></font>
			ap.blinkStart = tmNew;<font></font>
		};<font></font>
	};<font></font>
},<font></font>
<font></font>
<span class="hljs-attr">action</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
	<span class="hljs-keyword">if</span>  (ap.fProc == <span class="hljs-literal">false</span>) {<font></font>
		ap.fProc = <span class="hljs-literal">true</span>;<font></font>
		xo.putx();<font></font>
	};<font></font>
},<font></font>
<font></font>
<span class="hljs-comment">//mouth</span>
FaceTracking.face(<span class="hljs-number">0</span>).mouth.openness.monitor().subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
	<span class="hljs-keyword">if</span>  (event.newValue &gt; <span class="hljs-number">0.2</span>) {<font></font>
		ap.action();<font></font>
	};<font></font>
});</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">音</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまな効果音サイトのロイヤリティフリーのセクションで見つけました。重要な詳細：Spark ARには、特定の形式、つまりM4A、モノラル、44.1 kHz、16ビットのサウンドファイルが必要です。 wavおよびmp3からm4aへのオンラインコンバーターは、グローバルネットワークに在庫があります。私は4つのイベントにサウンドを追加しました：移動、短剣を獲得、タックトーを獲得、ドロー。変換後のすべてのサウンドの合計ボリュームは105 Kbでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトでサウンドを使用するには、スクリプトのオーディオモジュールを接続し、必要な数のスピーカーをサウンドの数でシーンに追加し（Speaker0、Speaker1、Speaker2、Speaker3を取得）、Playback ControllersモジュールをAssetsに追加し、サウンドの数に応じて必要な数のaudioPlaybackControllerサブアイテムを作成します。各スピーカーにサウンドを添付します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zz/ib/s8/zzibs8wwtsk_0dzinsuzxu4klb4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、スクリプトからのサウンドを次のように再生できます（たとえば、クリックのサウンド）。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> audioClick = Audio.getPlaybackController(<span class="hljs-string">'audioPlaybackControllerClick'</span>);<font></font>
audioClick.reset();<font></font>
audioClick.setPlaying(<span class="hljs-literal">true</span>);</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終ビルド</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サポートされているすべてのモバイルデバイス（Android、iO）のビルドを作成するには、[ファイル]-&gt; [エクスポート]をクリックします。私の場合、すべての3Dモデルとテクスチャを備えた各モバイルプラットフォームのゲームのボリュームは約1 MBでした。次に、ブラウザーを介してFacebook / sparkarhubのSpark AR Hubにアクセスし、そこにエクスポートされたファイルをアップロードする必要があります。また、説明を入力し、キーワードを検索して、デモビデオをダウンロードする必要があります。さらに、それはInstagramカメラを通して電話で撮影されなければなりません。これを行うには、ハブにリンクを含む「カメラのプレビュー」セクションがあります。このリンクはモバイルデバイスで開くことができます。 Instagramアプリケーションが起動し、マスク（ゲーム）が開きます。リンクはテスト用にすべての友達に送信することもできます。友達はもちろん、Instagramアプリケーションがインストールされたスマートフォンを持っている必要があります。モデレートプロセスが終了するまで、マスクはすべてのユーザーに表示されることはなく、このリンクでのみ表示されるまで、マスクを効果リストに追加することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、モデレートプロセスには数日かかります（10営業日ほどかかる場合があります）。私が理解しているように、最初は効果がマシンテストにかけられます。少なくともデモビデオは確かです。送信の1秒後、モデレートに合格しなかったというメッセージを受け取ったからです。理由-ビデオにテキストが含まれています。一般的に、何らかの理由で、ルールが言うように、マスクされたテキストは基本的に歓迎されません。以前のようにスコアがプレイヤーの頭上に常にぶら下がらず、各ラウンドの最後にしか表示されないように、ゲームインターフェイスを再設計する必要がありました。そして、ビデオを再撮影してください。すべての変更を行った後、モデレートのためにゲームを再送信しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3日後、「カメラスタイル」セクションに移動した後、ゲームは承認されました。</font><font style="vertical-align: inherit;">正直なところ、どのセクションを最初に配置したのか覚えていません（そのセクション、つまりカテゴリを選択する必要がありました）。</font><font style="vertical-align: inherit;">Instagram用のゲームセクションがないため、これは明らかではありません。</font><font style="vertical-align: inherit;">しかし、さて、これで新しいゲームをどこに置くかがわかります。</font><font style="vertical-align: inherit;">ゲームが将来登場する場合、おそらくInstagramは新しいセクションを追加するはずです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instagramの作成者のプロフィールにアクセスして、以下のマスクのアイコン（2つのプラス記号の付いた絵文字）をクリックすると、マスクを試すことができます。</font><font style="vertical-align: inherit;">もちろん、マスクされたゲームにも同じことが言えます。</font><font style="vertical-align: inherit;">以前は、マスクのベータテスト中に、作者を購読することも必要でした。</font><font style="vertical-align: inherit;">しかし今、このルールはキャンセルされました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らはマスクを作成するためのお金を払っていませんし、有名な店でのアプリケーションのように、それらを販売できる有料のマスク店はありません。また、プロファイルで作成したマスクの配置に料金を支払う必要はありません。節度の通過を待つだけです。しかし、多くのブロガーや企業がブランドマスクの開発を自分たちで注文しています。もちろん、作成したマスクを試してゲームをプレイするようにサブスクライバーに依頼し、すべてをInstagramストーリーにブロードキャストすることができます。そのようなアクションは、特にゲームが興味深い場合、いわゆるバイラル効果を生み出す可能性があります。これは、アカウントの宣伝に役立ちます。しかし、今では誰もがマスクをするのが面倒ではありません。しかし、Instagramのマスクされたゲームのアイデアはまだかなり新しいものです。さらに、エントリーのしきい値が高くなり、競争が少なくなります。すべてのマスクメーカーが本格的なゲームを作成するためのプログラマーではないためです。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja486480/index.html">Waymo Robocars（Google）が米国のフェニックスでパッケージの配達を開始</a></li>
<li><a href="../ja486482/index.html">ユニークな顔：訪問者のカウント、部外者の検索、認識システムでの識別</a></li>
<li><a href="../ja486484/index.html">新規コロナウイルスnCOV / 2019-nCoV / NCP / COVID19：予測、統計、保護、ニュース[4回目の再版、改訂07.03]</a></li>
<li><a href="../ja486488/index.html">Sivelkiriyaオペレーティングシステム：概要</a></li>
<li><a href="../ja486492/index.html">iCloudフィッシング詐欺師とその居住地</a></li>
<li><a href="../ja486500/index.html">Webコンポーネントとオープンスタンダード</a></li>
<li><a href="../ja486506/index.html">問題＃30：ITトレーニング-主要企業の現在の問題と課題</a></li>
<li><a href="../ja486510/index.html">緊急終了前の例外情報の表示</a></li>
<li><a href="../ja486512/index.html">Windows ServerでスキャンするようにブラザーMFPを教える方法について簡単に</a></li>
<li><a href="../ja486514/index.html">週末の読書：サウンドカード、オープンサウンドライブラリ、オーディオソフトウェアのレプリカに関する10の資料</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>