<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚬 🎮 🦔 JavaScriptのバンドルとパフォーマンス：ベストプラクティス ✊🏾 🛣️ 🐩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="さて、10年の変わり目に、今は過去に正しかったと考えられていたものを批判的に再評価し、それが今日関連性を失っているかどうかを調べる時が来ました。昨日のベストプラクティスは、今日のアンチパターンになることもあります。 本日の翻訳を公開しているこの記事の著者は、Reactを例として作成した単純なHell...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>JavaScriptのバンドルとパフォーマンス：ベストプラクティス</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/483682/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、10年の変わり目に、今は過去に正しかったと考えられていたものを批判的に再評価し、それが今日関連性を失っているかどうかを調べる時が来ました。</font><font style="vertical-align: inherit;">昨日のベストプラクティスは、今日のアンチパターンになることもあります。</font><font style="vertical-align: inherit;">
本日の翻訳を公開しているこの記事の著者は、Reactを例として作成した単純なHello Worldアプリケーションを使用して、JavaScriptプロジェクトをバンドルする3つのアプローチを検討します。</font><font style="vertical-align: inherit;">彼が引用する例のいくつかには、</font><font style="vertical-align: inherit;">今日最も人気のあるツールのように思われる</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Webpack</font></a><font style="vertical-align: inherit;">などのモジュールビルダーの基本が含まれてい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/tp/h1/jh/tph1jh5adpkk21ojvgqsadxjga4.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチNo. 1：絶対にすべてがバンドルに組み込まれます（大きな糸の玉のように見えます）</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主なアイデア：このアプローチは使用しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチでは、モジュールビルダーを使用して、依存関係とアプリケーションコードなどの絶対にすべてのものをバンドルにパッケージ化します。出力は糸の大きなボールのようなものです。私の例では、これに</font></font><code>react</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>react-dom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、アプリケーション自体のコードが</font><font style="vertical-align: inherit;">含まれ</font><font style="vertical-align: inherit;">ます。すべてのプロジェクトコードを含む単一のバンドルがページに接続されています。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;!-- index.html --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"bundle.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTP / 2がリリースされる前は、このパターンを使用すると、ブラウザがページマテリアルをロードするときに実行するHTTPリクエストの数が減るため、ある程度は許容できると考えられていました。しかし、今日のほとんどのサイトがHTTP / 2を使用していることを考えると、このパターンはアンチパターンになっています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どうして？実際のところ、HTTP / 2を使用すると、多くのリクエストを実行しても、システムに以前と同じ負荷がかかりません。その結果、コードを単一の大きなバンドルにパックしても、プロジェクトに大きな利点はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチでは、ブラウザキャッシュの効率的な編成が複雑になります。</font><font style="vertical-align: inherit;">たとえば、単純なアプリケーションでコードを1行だけ変更すると、バンドルハッシュが変更され、すべてのプロジェクトコードを格納するキャッシュが無効になります。</font><font style="vertical-align: inherit;">その結果、このコードは前回の訪問時にダウンロードしたものと99％の違いはありませんが、すべてのリピーターはサイトコード全体を再度ダウンロードする必要があります。</font><font style="vertical-align: inherit;">ここでは、サーバーからクライアントに同じデータを繰り返し送信することによる、ネットワークリソースの不合理な使用に対処しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、HTTP / 2は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://caniuse.com/&amp;usg=ALkJrhiswigsm6Pfru6UukEc6Bvtx8H96Q#feat="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95％以上のクライアントで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サポートされ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://caniuse.com/&amp;usg=ALkJrhiswigsm6Pfru6UukEc6Bvtx8H96Q#feat="><font style="vertical-align: inherit;">ています</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">2019年、このプロトコルは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバー</font><font style="vertical-align: inherit;">に実装されました</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://almanac.httparchive.org/en/2019/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2019年のHTTP / 2の使用に関する詳細情報を確認できます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ2：プロジェクトコードとサードパーティライブラリのコードを別々にパッケージ化する（コードの分離）</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主なアイデア：このアプローチを使用してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のセクションで説明したことを考慮して、プロジェクトコードを依存関係コードから分離することにより、ブラウザーキャッシュの状況を改善しましょう。</font><font style="vertical-align: inherit;">これにより、上記の場合の問題が解決されます。プロジェクトコードをわずかに変更した後、更新を本番環境に投稿します。</font><font style="vertical-align: inherit;">これで、</font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクト自体のコードを格納</font><font style="vertical-align: inherit;">するバンドルのハッシュのみが変更され</font><font style="vertical-align: inherit;">、バンドルのハッシュ</font><font style="vertical-align: inherit;">は変更され</font><font style="vertical-align: inherit;">て</font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いません。</font><font style="vertical-align: inherit;">更新されたサイトに戻る訪問者は、この方法</font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">変更されたファイルのみをダウンロード</font><font style="vertical-align: inherit;">するため、ネットワークリソースを節約できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webpackについて話す場合、この戦略を実装するには、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">追加の設定</font></a><font style="vertical-align: inherit;">が必要になり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード分​​離について。</font><font style="vertical-align: inherit;">彼らの助けを借りて、依存コードがどこにあるのかをバンドル業者に知らせます。</font><font style="vertical-align: inherit;">このようなコードを検出する簡単で便利な方法は、</font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての依存関係コードがこのフォルダーに格納されている</font><font style="vertical-align: inherit;">ため、対応するファイルへのパスがあることです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプト接続コードは次のとおりです。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;!-- index.html --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vendor.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"index.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これは、どのHTTP / 2が使用されているかを操作するときに、ページをロードするためのウォーターフォールのタイムラインです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf5/d02/f85/bf5d02f8583eb58f1094dfaa592822e1.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウォーターフォールページの読み込みスケジュール</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは正しい方向へのステップです。しかし、引き続きバンドルを最適化できます。これらすべてについて考えると、一部のプロジェクトの依存関係は他のプロジェクトよりも変更頻度が少ないことがわかります。おそらく、彼らは変化に最も可能性があり、</font></font><code>react</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">かつ</font></font><code>react-dom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのライブラリが更新されると同時に、他が更新されます。その結果、これらの2つのライブラリは1つの論理フラグメントにグループ化でき、他の依存関係から分離できるため、</font></font><code>react</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font><font style="vertical-align: inherit;">より頻繁に変化します</font></font><code>react-dom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。このアイデアを実現すると、次のようになります。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;!-- index.html --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vendor.react.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vendor.others.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"index.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアの開発を続けると、1つのページだけを表示するためにWebサイトの訪問者がすべてのプロジェクトコードをダウンロードする必要がない場合があると判断できます。冬になると、私たちの一部は体重が増える傾向にあります。そのため</font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アプリケーションコードを含む</font><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">は時間とともに大きくなります。ある時点で、プロジェクトコードがさらに分離され、</font><font style="vertical-align: inherit;">個々のコンポーネントを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的にロードし</font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個々のモジュールの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">プリロードを</font></a><font style="vertical-align: inherit;">編成することさえ</font><font style="vertical-align: inherit;">正当に行われる</font><font style="vertical-align: inherit;">場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私には、このレベルのコード分離はまだかなりトリッキーに見えます。</font><font style="vertical-align: inherit;">それはまだ実験的技術のように見えます（そして、そのようなもので、微妙なエラーがよく現れる可能性があります）。</font><font style="vertical-align: inherit;">しかし、強力なコード分離がWeb開発業界の方向性であることは明らかです。</font><font style="vertical-align: inherit;">おそらくJavaScriptモジュールのブラウザーサポートが原因で、最終的にWebpackのようなバンドルを完全に破棄し、コードの個々のモジュールをクライアントに提供することができるようになります。</font><font style="vertical-align: inherit;">これらすべてが私たちを導くところを見るのは興味深いでしょう！</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ＃3：一部の依存関係のコードにパブリックCDNを使用する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主なアイデア：このアプローチは使用しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたがWeb開発に少し昔ながらの人（私のように）である場合は、</font></font><code>vendor.react</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「アプローチ2」で説明し</font><font style="vertical-align: inherit;">たファイルにページに接続できるかもしれないという内部的な感覚があるかもしれません</font><font style="vertical-align: inherit;">。パブリックCDNリソースの使用：</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;!-- index.html --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">crossorigin</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/react@16.12.0/umd/react.production.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">crossorigin</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/react-dom@16.12.0/umd/react-dom.production.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"index.[hash].min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチを使用する場合</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">コードをバンドルから除外する</font><font style="vertical-align: inherit;">必要</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があること</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をWebpackプロジェクトコレクター</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">に示す</font></a><font style="vertical-align: inherit;">必要があることに注意し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">
一見、これらはすべて正常に見えますが、このアプローチには、私が検討することを提案するいくつかの欠点があります。</font></font><code>react</code><font style="vertical-align: inherit;"></font><code>react-dom</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍マイナス1：同じ依存関係ファイルの異なるサイトを使用していますか？</font><font style="vertical-align: inherit;">もう違います…</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古い学校の開発者は、すべてのサイトが同じCDNリソースにリンクし、サイトと同じバージョンのReactを使用している場合、ブラウザーのキャッシュに既にReactコードがある場合にサイトの訪問者が、それをリロードする時間を無駄にしません。これにより、作業モードでサイトのページを表示する速度が大幅に向上します。はい、</font><font style="vertical-align: inherit;">このテーマに関するReactの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は有望に見えます。そのため、一部の開発者はこのパターンを使用しています。正しく？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前はこれでうまくいきましたが、最近のブラウザでは、セキュリティを強化するために、キャッシュを共有するメカニズムを実装するようになりました。理想的な条件下でも、2つのサイトが同じライブラリを使用し、同じCDNリンクを介してロードされると、コードはドメインごとに個別にダウンロードされ、プライバシー上の理由から、キャッシュはサンドボックスに置かれるという事実について話している特定のドメインに割り当てられます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それが判明し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このメカニズムは、すでにサファリ（どうやら、それは2013年から存在している？！）に実装されています。 Chrome 77の場合、キャッシュ共有を有効にするには、特別な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> キャッシュ共有が実装されるブラウザーの数が増えるにつれて、公的に利用可能なCDNの使用が減少すると合理的に想定されています。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍マイナス2：補助操作でのシステムリソースの浪費（ドメインごと）</font></font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここでは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、HTTPリクエストを送信する前であっても、ブラウザーがDNS名前解決、TCP接続、SSLハンドシェイクなどの多くの問題を解決する必要があるため、CDNを使用するとシステムの負荷が増加</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">する</font></a><font style="vertical-align: inherit;">という考えが表明されています。</font><font style="vertical-align: inherit;">サイトに接続するために、ブラウザはどのような場合でもこれらのアクションを実行する必要がありますが、CDNへの接続も強制される場合、これによりサイトの負荷が増加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のウォーターフォールグラフは、公的に入手可能なCDNリソースからスクリプトを使用するページをロードするプロセスを示しています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/3eb/c0a/7cd3ebc0aebe48e5819fc27993b016a0.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開されているCDNリソースを使用したページのウォーターフォールロードスケジュール。</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
赤い楕円は、リクエストの実行前に操作が発生した領域を示します。これは、単純なHello Worldアプリケーションでは少なすぎます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の簡単な例が進化し、成長するにつれて、自分のフォントをその中で使用したい時が来るでしょう。たとえば-Google Fontsから取得。そして、これは、フォントをダウンロードするために対応するドメインに接続する必要があるため、そのような遅延の数が増加するだけであることを意味します。ここで、サイトのすべてのリソースを独自のメインドメイン（もちろん、CloudflareまたはCloudfrontに基づくプロジェクトのCDNリソースの背後にあります）でホストするという考えは、非常に魅力的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例で、サイトのメインドメインから2つのReact依存関係のダウンロードに切り替えると、ページ読み込みのウ​​ォーターフォールスケジュールがはるかに正確になるという事実につながります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f32/82a/12e/f3282a12e8626574f5a13e9a10540417.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開されているCDNリソースを使用しないページのウォーターフォールロードスケジュール</font></font></font></i><br>
 <br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍マイナス3：異なるサイトで異なるバージョンの依存関係を使用する</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reactを使用して</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 32の最大のサイトの</font><font style="vertical-align: inherit;">
小さな調査</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">研究を</font></a><font style="vertical-align: inherit;">まとめました</font><font style="vertical-align: inherit;">。残念ながら、Reactをダウンロードするために公開されているCDNリソースを使用しているのは10％だけであることがわかりました。しかし、調査されたすべてのサイトが使用しているReactのバージョンを考えると、これは本当に重要ではないことがわかりました。理想的な世界では、ブラウザキャッシュの分離はなく、すべてのサイトを編成して、同じパブリックCDNから同じスクリプトバージョンを使用できます。実際には、さまざまなサイトで使用されているReactバージョンの分散は非常に強力です。これは、共有ブラウザーキャッシュの概念を破壊します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/876/fc9/4b0/876fc94b0752931da06e97f3132b3584.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なるサイトで使用されるReactのバージョン</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最初</font><i><font color="#999999"><font style="vertical-align: inherit;">にReactを使用する</font></font></i><font style="vertical-align: inherit;">人気のあるサイトを開き、次に別のサイトを開くと、これらのサイトの両方が同じバージョンのReactを使用する可能性は非常に小さいことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
調査の過程で、これらのReactサイトに関するさらに興味深い情報を見つけました。</font><font style="vertical-align: inherit;">おそらく、あなたにとっても興味深いものになるでしょう。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2/3サイトでは、コードのビルドにWebpackが使用されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトの87％はHTTP / 2を使用しており、平均58％を超えています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどのプロジェクト（約56％）は、フォント自体をホストしています。</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の実験のソースデータです。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍マイナス4：パフォーマンスの問題</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、今日公開されているCDNリソースを使用する人は、ページの読み込み速度に関する問題だけでなく、他のいくつかの問題にも直面しています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全上の問題。</font><font style="vertical-align: inherit;">ブラウザーでのキャッシュ共有の解決を目的としたもの以外の、一般に入手可能なCDNリソースの使用に関連するセキュリティの問題があります。</font><font style="vertical-align: inherit;">たとえば、ハッカーが公にアクセス可能なCDNリソースに侵入した場合、ハッカーは悪意のあるJavaScriptコードをライブラリに非常に慎重に挿入できます。</font><font style="vertical-align: inherit;">このようなコードは、クライアントで実行されるサイトコードのすべての権限を持ち、サイトにログインしたユーザーのデータを操作できます。</font></font></li>
<li>  .       ,   .  ,         CDN-      ,   CDN-          .       ,    (,   ).    —   -!</li>
<li>  .  ,    ,   ,   , , -      ,      ,       .   ,      JavaScript,          .</li>
</ul><br>
<h2><font color="#3AC1EF"></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
未来がアプローチ2にあることは明らかです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTP / 2を使用してサーバーの前で独自のCDNリソースをホストします（CloudflareやCloudfrontなど）。</font><font style="vertical-align: inherit;">ブラウザのキャッシュを効果的に使用するには、コードを小さなフラグメントに分割します。</font><font style="vertical-align: inherit;">ブラウザーがこのテクノロジーのサポートの実装を開始したため</font><font style="vertical-align: inherit;">、将来、サイトコードが分割されるフラグメントはさらに小さくなり、個々の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScriptモジュールの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズに達する可能性があり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webプロジェクトでコード分離テクノロジーを使用していますか？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483670/index.html">MACアドレスについて知りたいすべて</a></li>
<li><a href="../ja483674/index.html">バイナリニューラルネットワークの仕組みと、2020年に普及する理由</a></li>
<li><a href="../ja483676/index.html">エンドツーエンドのマーケティング分析システムの実装の有効性とコストの評価</a></li>
<li><a href="../ja483678/index.html">非常に高速なPythonプログラムの開発</a></li>
<li><a href="../ja483680/index.html">避けるべき一般的なプログラミングの欠陥</a></li>
<li><a href="../ja483684/index.html">PHPダイジェストNo. 171（2020年1月1〜13日）</a></li>
<li><a href="../ja483686/index.html">2020年に自分より上に成長したいWeb開発者のための32のヒント</a></li>
<li><a href="../ja483688/index.html">Node.jsの同時実行性が約30倍に増加</a></li>
<li><a href="../ja483698/index.html">LoRaWANが現代のモノのインターネットの構築にどのように役立つか</a></li>
<li><a href="../ja483700/index.html">今年の物理的な結果-2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>