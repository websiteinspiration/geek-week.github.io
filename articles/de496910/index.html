<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👋🏿 😿 😿 Erstellen und passen Sie Ihr CDN an ☁️ 👩‍👩‍👧‍👦 🍪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Content Delivery Networks (CDNs) werden auf Websites und in Anwendungen hauptsächlich verwendet, um das Laden statischer Elemente zu beschleunigen. Di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erstellen und passen Sie Ihr CDN an</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496910/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content Delivery Networks (CDNs) werden auf Websites und in Anwendungen hauptsächlich verwendet, um das Laden statischer Elemente zu beschleunigen. Dies geschieht durch das Zwischenspeichern von Dateien auf CDN-Servern in verschiedenen geografischen Regionen. Nachdem der Benutzer Daten über CDN angefordert hat, erhält er sie vom nächstgelegenen Server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Funktionsprinzip und die Funktionalität aller Content Delivery-Netzwerke sind ungefähr gleich. Nachdem der CDN-Server eine Anforderung zum Herunterladen einer Datei erhalten hat, nimmt er diese einmal vom ursprünglichen Server und gibt sie an den Benutzer weiter, wobei er sie für einen bestimmten Zeitraum zwischenspeichert. Alle nachfolgenden Anfragen werden aus dem Cache beantwortet. Alle CDNs bieten Optionen zum Vorladen von Dateien, zum Löschen des Caches, zum Festlegen der Aufbewahrungsdauer und vieles mehr.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es kommt vor, dass Sie aus dem einen oder anderen Grund Ihr eigenes Netzwerk für die Bereitstellung von Inhalten organisieren müssen und dann - lassen Sie sich von uns beim Bau eines weiteren Fahrrads unterstützen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/rw/ss/qfrwss0k86-bdbbbpztdh3d0nkq.jpeg"><br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infografik-Vektor erstellt von pikisuperstar - www.freepik.com</font></font></a></i></sup></font><a name="habracut"></a><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Ihr eigenes CDN benötigen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berücksichtigen Sie die Fälle, in denen das Starten eines eigenen CDN sinnvoll ist:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Geld sparen möchten und die laufenden Kosten selbst bei Verwendung kostengünstiger CDNs wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BunnyCDN</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mehrere hundert Dollar pro Monat </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;">betragen</font></b></a></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenn wir einen permanenten Cache oder einen Cache ohne Nachbarn auf dem Server und dem Kanal erhalten möchten</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der Region, die Sie benötigen, haben CDN-Dienste keine Präsenzpunkte</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle speziellen Einstellungen für die Bereitstellung von Inhalten sind erforderlich</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir möchten die Bereitstellung dynamischer Inhalte beschleunigen, indem wir näher an die Benutzer des Produktionsservers heranrücken</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es besteht die Sorge, dass ein CDN-Dienst eines Drittanbieters unrechtmäßig Informationen über das Benutzerverhalten sammelt oder verwendet (Hi-to-Dienste ohne GDPR-Konformität) oder andere illegale Handlungen ausführt</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den meisten anderen Fällen ist es ratsamer, vorhandene vorgefertigte Lösungen zu verwenden.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was du zum Laufen brauchst</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist wunderbar, wenn Sie ein eigenes autonomes System (AS) haben. </font><font style="vertical-align: inherit;">Damit können Sie mehreren Servern dieselbe IP zuweisen und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese Anweisung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf Netzwerkebene </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">befolgen</font></a><font style="vertical-align: inherit;"> , um Benutzer zum nächsten zu leiten. </font><font style="vertical-align: inherit;">Es ist erwähnenswert, dass es auch mit dem Adressblock / 24 möglich ist, ein Netzwerk für die Bereitstellung von Inhalten aufzubauen. </font><font style="vertical-align: inherit;">Bei einigen Serveranbietern können Sie ihnen eine Ankündigung zur Verwendung in allen Regionen zur Verfügung stellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie kein glücklicher Besitzer eines IP-Adressblocks sind, benötigen Sie zum Ausführen eines einfachen CDN Folgendes:</font></font><br>
<br>
<ul>
<li>   </li>
<li>     .     ,   </li>
<li>geoDNS .    ,   ,     </li>
</ul><br>
<br>
<h2>    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der Domainregistrierung ist alles einfach - registrieren Sie sich in jeder Zone bei jedem Registrar. Sie können auch eine Subdomain für ein CDN verwenden, z. B. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.namedomain.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In unserem Beispiel werden wir dies tatsächlich tun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bestellung von Servern sollte in den Regionen und Ländern gemietet werden, in denen sich Ihre Benutzergruppe befindet. Wenn das Projekt interkontinental ist, ist es bequem, Hosting-Anbieter auszuwählen, die Server auf der ganzen Welt sofort anbieten. Beispiele: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OVH</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaseweb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 TB</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für dedizierte Server, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vultr</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DigitalOcean</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die virtuelle Cloud *. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für unser privates CDN bestellen wir 3 virtuelle Server auf verschiedenen Kontinenten. Bei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vultr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf dem Server für </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 US-Dollar </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pro </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Monat erhalten</font></b><font style="vertical-align: inherit;"> wir </font><b><font style="vertical-align: inherit;">25 GB SSD-</font></b><font style="vertical-align: inherit;"> Speicherplatz und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 TB Datenverkehr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wählen Sie bei der Installation das neueste Debian aus. </font><font style="vertical-align: inherit;">Unsere Server: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/di/f1/jydif1phgm45zpwjbety-fw_d-g.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frankfurt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , IP: 199.247.18.199 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/wh/v1/ukwhv1lwwsr8snoiqc_yyzquo5s.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chicago</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , IP: 149.28.121.123 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/qk/6e/3fqk6endcgzeybs-yjlkkphep50.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singapur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , IP: 157.230.240.216 </font></font><br>
<br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Vultr und DigitalOcean versprechen Benutzern, die über die Links im Artikel registriert sind, unmittelbar nach dem Hinzufügen einer Zahlungsmethode ein Darlehen in Höhe von 100 USD. </font><font style="vertical-align: inherit;">Der Autor erhält auch ein kleines Kompliment, das für ihn jetzt sehr wichtig ist. </font><font style="vertical-align: inherit;">Bitte haben Sie Verständnis.</font></font></i></sup></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie geoDNS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein Benutzer auf eine CDN-Domäne oder Subdomäne zugreift und zu dem gewünschten (ihm am nächsten gelegenen) Server geleitet wird, benötigen wir einen DNS-Server mit der Funktion geoDNS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Prinzip und Verfahren von geoDNS lautet wie folgt:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definiert die IP des Clients, der die DNS-Anforderung gesendet hat, oder die IP des rekursiven DNS-Servers, der zur Verarbeitung der Clientanforderung verwendet wird. </font><font style="vertical-align: inherit;">Diese rekursiven Server sind normalerweise DNS-Anbieter.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Per IP kennt der Kunde sein Land oder seine Region. </font><font style="vertical-align: inherit;">Hierfür werden GeoIP-Basen verwendet, von denen es heute sehr viele gibt. </font><font style="vertical-align: inherit;">Es gibt einige gute </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kostenlose Optionen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängig vom Standort des Clients gibt er ihm die IP-Adresse des nächstgelegenen CDN-Servers.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DNS-Server mit der geoDNS-Funktion </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">selbst</font></a><font style="vertical-align: inherit;"> erstellen. </font><font style="vertical-align: inherit;">Es ist jedoch besser, vorgefertigte Lösungen mit einem Netzwerk von DNS-Servern auf der ganzen Welt und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anycast</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> out of the box zu verwenden:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DlouDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ab</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9,95 USD / Monat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , GeoDNS-Tarif, standardmäßig gibt es ein DNS-Failover</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zilore</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ab</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25 US-Dollar / Monat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , DNS-Failover aktiviert</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Route 53</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ab</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 35 USD / Monat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für</font><b><font style="vertical-align: inherit;"> 50 Mio.</font></b><font style="vertical-align: inherit;"> Netto-Geo-Anfragen. </font><font style="vertical-align: inherit;">DNS-Failover wird separat berechnet</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS leicht gemacht</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ab</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 125 US-Dollar / Monat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es gibt 10 DNS-Failover</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudflare</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Geolenkungsfunktion in Enterprise-Tarifen verfügbar</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Bestellung von geoDNS sollten Sie auf die Anzahl der im Tarif enthaltenen Anfragen achten und berücksichtigen, dass die tatsächliche Anzahl der Anrufe in die Domain die Erwartungen um ein Vielfaches übertreffen kann. Millionen von Spinnen, Scannern, Spammern und anderen bösen Geistern arbeiten unermüdlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fast alle DNS-Dienste enthalten ein für den Aufbau eines CDN-Dienstes unverzichtbares DNS-Failover. Mithilfe dieser Funktion können Sie die Überwachung Ihrer Server konfigurieren und in Abwesenheit von Lebenszeichen die nicht funktionierende Serveradresse in DNS-Antworten automatisch durch einen Sicherungsserver ersetzen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Erstellung unseres CDN verwenden wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClouDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , den GeoDNS-Tarif.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie Ihrem Konto eine neue DNS-Zone hinzu, die Ihre Domain angibt. </font><font style="vertical-align: inherit;">Wenn Sie das CDN auf einer Subdomain erstellen und die Hauptdomäne bereits verwendet wird, vergessen Sie nicht, unmittelbar nach dem Hinzufügen der Zone die vorhandenen funktionierenden DNS-Einträge hinzuzufügen. </font><font style="vertical-align: inherit;">Der nächste Schritt besteht darin, für die CDN-Domäne / Subdomäne mehrere A-Datensätze zu erstellen, von denen jeder auf die von uns festgelegte Region angewendet wird. </font><font style="vertical-align: inherit;">Sie können Kontinente oder Länder als Regionen angeben. Für die USA und Kanada sind Unterregionen verfügbar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserem Fall wird das CDN in der Subdomain </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in ausgelöst</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wenn Sie die Zone </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in hinzufügen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , erstellen Sie den ersten A-Datensatz für die Subdomain und leiten Sie ganz Nordamerika an den Server in Chicago weiter:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/z_/zt/0xz_ztazcrmz8wqlruylrz4iqh4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wiederholen Sie diesen Vorgang für andere Regionen, und denken Sie daran, einen Eintrag für die Standardregionen zu erstellen. </font><font style="vertical-align: inherit;">Hier ist das Ergebnis:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/js/zy/iojszykgez_pu7wf3mzd8lvmffa.jpeg" width="600"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der letzte Standarddatensatz im Screenshot bedeutet, dass alle unausgesprochenen Regionen (und dies sind Europa, Afrika, Satelliten-Internetnutzer usw.) an einen Server in Frankfurt gesendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit ist die grundlegende DNS-Konfiguration abgeschlossen. </font><font style="vertical-align: inherit;">Es bleibt, auf die Website des Domain-Registrars zu gehen und die aktuellen Domain-NS durch die von ClouDNS herausgegebenen zu ersetzen. </font><font style="vertical-align: inherit;">Und während NSs aktualisiert werden, bereiten wir den Server vor.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie SSL-Zertifikate</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser CDN funktioniert mit HTTPS. Wenn Sie also bereits SSL-Zertifikate für eine Domain oder Subdomain haben, laden Sie diese auf alle Server </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hoch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , z. B. im Verzeichnis </font><i><font style="vertical-align: inherit;">/ etc / ssl / yourdomain /</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn keine Zertifikate vorhanden sind, können Sie ein kostenloses Zertifikat von Let's Encrypt erhalten. Das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACME Shell-Skript ist dafür</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perfekt geeignet </font><font style="vertical-align: inherit;">. Der Client ist bequem und einfach zu konfigurieren und ermöglicht es Ihnen vor allem, die Domain / Subdomain für DNS über die API von ClouDNS zu validieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden acme.sh nur auf einem der Server installieren - European 199.247.18.199, von dem Zertifikate auf alle anderen kopiert werden. Gehen Sie zum Installieren wie folgt vor:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# wget -O - https://get.acme.sh | bash; source ~/.bashrc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der Installation des Skripts wird eine CRON-Aufgabe zur weiteren Erneuerung von Zertifikaten ohne unsere Teilnahme erstellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Domänenüberprüfung bei der Ausstellung eines Zertifikats erfolgt über DNS mithilfe der API. Daher müssen Sie im persönlichen ClouDNS-Konto im Menü Reseller-API eine neue Benutzer-API erstellen und ein Kennwort dafür festlegen. </font><font style="vertical-align: inherit;">Die resultierende Auth-ID mit dem Passwort wird in die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / .acme.sh / dnsapi / dns_cloudns.sh geschrieben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (nicht zu verwechseln mit der </font><i><font style="vertical-align: inherit;">Datei </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dns_clou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dns.sh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Hier sind die Zeilen zum Kommentieren und Bearbeiten:</font></font><br>
<br>
<pre><code class="plaintext hljs">CLOUDNS_AUTH_ID=&lt;auth-id&gt;<font></font>
CLOUDNS_AUTH_PASSWORD="&lt;&gt;"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt </font><b><font style="vertical-align: inherit;">bitten</font></b><font style="vertical-align: inherit;"> wir </font><b><font style="vertical-align: inherit;">um</font></b><font style="vertical-align: inherit;"> ein SSL-Zertifikat für </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></b><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# acme.sh --issue --dns dns_cloudns -d cdn.sayt.in --reloadcmd "service nginx reload"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den Parametern für die Zukunft haben wir einen Befehl angegeben, um die Webserverkonfiguration nach jeder Erneuerung der Gültigkeitsdauer des Zertifikats in der Zukunft automatisch neu zu laden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der gesamte Vorgang zum Erhalten eines Zertifikats kann bis zu 2 Minuten dauern. Unterbrechen Sie es nicht. </font><font style="vertical-align: inherit;">Wenn ein Domänenüberprüfungsfehler auftritt, führen Sie den Befehl erneut aus. </font><font style="vertical-align: inherit;">Am Ende werden wir sehen, wo die Zertifikate hochgeladen wurden: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l6/qv/16/l6qv16mchqhhaokxuvbwmnnw6xu.png" width="952"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Denken Sie daran, dass diese Pfade beim Kopieren des Zertifikats auf andere Server sowie in den Webservereinstellungen angegeben werden müssen. </font><font style="vertical-align: inherit;">Wir achten nicht auf den Fehler beim erneuten Laden von Nginx-Konfigurationsdateien - auf einem vollständig konfigurierten Server ist er beim Erneuern von Zertifikaten nicht vorhanden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Über SSL bleibt uns lediglich das Kopieren des empfangenen Zertifikats auf zwei andere Server, wobei der Pfad zu den Dateien gespeichert wird. </font><font style="vertical-align: inherit;">Erstellen Sie für jedes Verzeichnis die gleichen Verzeichnisse und erstellen Sie eine Kopie:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# mkdir -p /root/.acme.sh/cdn.sayt.in/<font></font>
root@cdn:~# scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit die Zertifikatserneuerung regelmäßig erfolgt, erstellen wir auf beiden Servern mit dem folgenden Befehl eine tägliche CRON-Task:</font></font><br>
<blockquote><code>scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/ &amp;&amp; service nginx reload</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall muss der Zugriff auf den Remote-Quellserver </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">über einen Schlüssel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konfiguriert </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">werden</font></a><font style="vertical-align: inherit;"> , d. H. </font><font style="vertical-align: inherit;">ohne ein Passwort einzugeben. </font><font style="vertical-align: inherit;">Vergiss nicht es zu tun.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und konfigurieren Sie Nginx</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um statischen Inhalt zurückzugeben, verwenden wir Nginx, das als Caching-Proxyserver konfiguriert ist. </font><font style="vertical-align: inherit;">Aktualisieren Sie die Liste der Pakete und installieren Sie sie auf allen drei Servern:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# apt update<font></font>
root@cdn:~# apt install nginx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie anstelle der Standardeinstellung die Konfiguration aus dem folgenden Spoiler:</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.conf</font></font></b><div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-attribute">user</span> www-data;
<span class="hljs-attribute">worker_processes</span> auto;
<span class="hljs-attribute">pid</span> /run/nginx.pid;<font></font>
<font></font>
<span class="hljs-section">events</span> {
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">4096</span>;
    <span class="hljs-attribute">multi_accept</span> <span class="hljs-literal">on</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-section">http</span> {
    <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nopush</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nodelay</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">types_hash_max_size</span> <span class="hljs-number">2048</span>;<font></font>
<font></font>
    <span class="hljs-attribute">include</span> /etc/nginx/mime.types;
    <span class="hljs-attribute">default_type</span> application/octet-stream;<font></font>
<font></font>
    <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;
    <span class="hljs-attribute">error_log</span> /var/log/nginx/error.log;<font></font>
<font></font>
    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">"msie6"</span>;
    <span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;
    <span class="hljs-attribute">gzip_proxied</span> any;
    <span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/javascript text/css application/json application/xml text/xml application/rss+xml;
    <span class="hljs-attribute">gunzip</span> <span class="hljs-literal">on</span>;            <font></font>
<font></font>
    <span class="hljs-attribute">proxy_temp_path</span>    /var/cache/tmp;
    <span class="hljs-attribute">proxy_cache_path</span>   /var/cache/cdn levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cdn:<span class="hljs-number">64m</span> max_size=<span class="hljs-number">20g</span> inactive=<span class="hljs-number">7d</span>;
    <span class="hljs-attribute">proxy_cache_bypass</span> <span class="hljs-variable">$http_x_update</span>;<font></font>
<font></font>
<span class="hljs-section">server</span> {
  <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;
  <span class="hljs-attribute">server_name</span> cdn.sayt.in;<font></font>
<font></font>
  <span class="hljs-attribute">ssl_certificate</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.cer;
  <span class="hljs-attribute">ssl_certificate_key</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.key;<font></font>
<font></font>
  <span class="hljs-attribute">location</span> / {
    <span class="hljs-attribute">proxy_cache</span> cdn;
    <span class="hljs-attribute">proxy_cache_key</span> <span class="hljs-variable">$uri</span><span class="hljs-variable">$is_args</span><span class="hljs-variable">$args</span>;
    <span class="hljs-attribute">proxy_cache_valid</span> <span class="hljs-number">90d</span>;
    <span class="hljs-attribute">proxy_pass</span> https://sayt.in;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie in der Konfiguration:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max_size</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Cache-Größe, die den verfügbaren Speicherplatz nicht überschreitet</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inaktiv</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Speicherzeit für zwischengespeicherte Daten, auf die niemand zugegriffen hat</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Pfade zu SSL-Zertifikat- und Schlüsseldateien</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Speicherzeit für zwischengespeicherte Daten</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_pass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die Adresse des ursprünglichen Servers, von dem das CDN Dateien zum Zwischenspeichern anfordert. </font><font style="vertical-align: inherit;">In unserem Beispiel ist dies </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen, ist alles einfach. </font><font style="vertical-align: inherit;">Komplexität kann nur beim Festlegen der Cache-Zeit aufgrund der Ähnlichkeit der </font><i><font style="vertical-align: inherit;">Anweisungen </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inaktiv</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid auftreten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir werden sie in unserem Beispiel analysieren. </font><i><font style="vertical-align: inherit;">Folgendes</font></i><font style="vertical-align: inherit;"> passiert mit </font><i><font style="vertical-align: inherit;">inactive </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 7d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid 90d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wird die Anforderung nicht innerhalb von 7 Tagen wiederholt, werden die Daten nach diesem Zeitraum aus dem Cache gelöscht</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die Anforderung mindestens alle 7 Tage wiederholt wird, gelten die Daten im Cache nach 90 Tagen als veraltet. Bei der nächsten Anforderung aktualisiert Nginx sie, indem sie vom ursprünglichen Server übernommen werden</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bearbeitung von nginx.conf abgeschlossen haben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , laden Sie die Konfiguration neu:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# service nginx reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser CDN ist komplett fertig. </font><font style="vertical-align: inherit;">Für 15 $ / Monat </font><font style="vertical-align: inherit;">Wir haben Präsenzpunkte auf drei Kontinenten und 3 TB Verkehr: 1 TB an jedem Standort.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überprüfen der Funktion von CDN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns die Pings zu unserem CDN von verschiedenen geografischen Standorten aus an. </font><font style="vertical-align: inherit;">Hierfür sind alle Ping-Dienste geeignet.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Startpunkt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wirt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durchschnittliche Zeit, ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deutschland Berlin</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niederlande, Amsterdam</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frankreich Paris</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Großbritannien, London</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kanada Toronto</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USA, San Francisco</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USA, Dallas</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USA, Chicago</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USA, New York</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singapur</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Japan Tokio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Australien, Sydney</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95,9</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ergebnisse sind gut. </font><font style="vertical-align: inherit;">Jetzt platzieren wir das Testbild </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test.jpg</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Stammverzeichnis der Hauptseite </font><font style="vertical-align: inherit;">und überprüfen die Geschwindigkeit des Downloads über CDN. </font><font style="vertical-align: inherit;">Kaum gesagt als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Inhalte werden schnell geliefert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden ein kleines Skript schreiben, falls wir den Cache auf dem CDN-Punkt leeren möchten.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">purge.sh</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging all cache"</span><font></font>
    rm -rf /var/cache/cdn/*<font></font>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging <span class="hljs-variable">$1</span>"</span>
    FILE=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | md5sum | awk <span class="hljs-string">'{print $1}'</span>`<font></font>
    FULLPATH=/var/cache/cdn/<span class="hljs-variable">${FILE:31:1}</span>/<span class="hljs-variable">${FILE:29:2}</span>/<span class="hljs-variable">${FILE}</span>
    rm -f <span class="hljs-string">"<span class="hljs-variable">${FULLPATH}</span>"</span>
<span class="hljs-keyword">fi</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den gesamten Cache zu löschen, führen Sie ihn einfach aus. Eine separate Datei kann folgendermaßen bereinigt werden:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# ./purge.sh /test.jpg</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstelle von Schlussfolgerungen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abschließend möchte ich einige nützliche Tipps geben, um sofort über den Rechen zu treten, was mir einmal den Kopf wund gemacht hat:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um die CDN-Fehlertoleranz zu erhöhen, wird empfohlen, DNS-Failover zu konfigurieren, um den A-Eintrag bei einem Serverausfall schnell zu ändern. </font><font style="vertical-align: inherit;">Dies erfolgt in der Systemsteuerung der DNS-Einträge der Domäne</font></font></li>
<li>           CDN,    .            CDN,      6-7 : ,   (),   (), , ,   </li>
<li>         CDN. ,          ,       -</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">  </a>,  ,           </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versuchen Sie, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pings von verschiedenen Orten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf Ihren Servern </font><font style="vertical-align: inherit;">zu überprüfen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">So können Sie die Regionen sehen, die den CDN-Punkten am nächsten liegen, und GeoDNS korrekt konfigurieren</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängig von den Aufgaben ist es nicht unangebracht, Nginx für bestimmte Caching-Anforderungen zu konfigurieren und die Belastung des Servers zu berücksichtigen. </font><font style="vertical-align: inherit;">Die Artikel über den Nginx-Cache - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die Beschleunigung der Arbeit unter hoher Last: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">hier</font></a><font style="vertical-align: inherit;"> haben mir sehr geholfen.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496886/index.html">Elon Musk enthüllte den Zweck der Kamera über dem Rückspiegel in Tesla Model 3</a></li>
<li><a href="../de496888/index.html">Startup verwendet AI, um nach Molekülen zu suchen, die bei der Bekämpfung des Coronavirus helfen</a></li>
<li><a href="../de496892/index.html">Alles Habr in einer Basis. Kommentare und Webanwendung</a></li>
<li><a href="../de496894/index.html">Perfekter Produktstau</a></li>
<li><a href="../de496900/index.html">Importieren Sie USRLE mit Apache NiFi. Schritt 1 - Dateien über HTTPS herunterladen</a></li>
<li><a href="../de496912/index.html">ThinkPad E480 Intel unter Windows VS ThinkPad E495 AMD unter Ubuntu Gibt es einen Unterschied?</a></li>
<li><a href="../de496914/index.html">Das kürzeste Dezimalprogramm</a></li>
<li><a href="../de496916/index.html">Fernunterricht, Verhandlung und Beratung - Teil 3: Yealink Meeting Server und 4 Sonderangebote</a></li>
<li><a href="../de496920/index.html">Mit ASP.NET Core und Arduino ein Smart Home erstellen</a></li>
<li><a href="../de496922/index.html">Leitfaden zur Reverse Client-Server-Apk am Beispiel des Jobs NeoQUEST-2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>