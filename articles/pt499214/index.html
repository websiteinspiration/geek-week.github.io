<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßóüèΩ ‚ò¢Ô∏è üï¥üèø Implantar o Hyperledger Fabric 1.4 na AWS üå∑ üéÖüèª üå•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Hyperledger Fabric √© uma plataforma de blockchain de c√≥digo aberto da Linux Foundation. Com ele, voc√™ pode criar aplicativos blockchain e controlar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Implantar o Hyperledger Fabric 1.4 na AWS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Hyperledger Fabric √© uma plataforma de blockchain de c√≥digo aberto da Linux Foundation. Com ele, voc√™ pode criar aplicativos blockchain e controlar o acesso e as permiss√µes de dados no blockchain. O Hyperledger Fabric deve ser usado se voc√™ deseja criar uma rede blockchain privada ou definir restri√ß√µes sobre quais transa√ß√µes cada lado pode ver. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na documenta√ß√£o do Hyperledger Fabric, a cria√ß√£o de uma rede blockchain em uma m√°quina usando o Docker √© bem planejada, onde cada membro da rede √© um cont√™iner separado. Mas o processo de configura√ß√£o de uma rede em v√°rias m√°quinas f√≠sicas ou virtuais n√£o √© descrito. Isso ser√° discutido neste artigo.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso aplicativo blockchain √© um servi√ßo para armazenar alguns dados m√©dicos de crian√ßas em idade escolar e pr√©-escolar. </font><font style="vertical-align: inherit;">Os dados devem permanecer inalterados. </font><font style="vertical-align: inherit;">Eles ser√£o apresentados na forma de informa√ß√µes sobre a vacina√ß√£o e a concord√¢ncia do paciente com um m√©dico espec√≠fico. </font><font style="vertical-align: inherit;">A rede incluir√° membros dos Pais (uma organiza√ß√£o que representa os interesses dos pais), Hospital (um hospital cujos pais pediatras podem entrar em um acordo para cuidar de seus filhos / filhos) e Jardim de Inf√¢ncia (um jardim de inf√¢ncia que pode solicitar relat√≥rios de sa√∫de e vacinas para ou outra crian√ßa no hospital).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blockchain gerenciado pela Amazon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A AWS tem um servi√ßo Amazon Managed Blockchain. </font><font style="vertical-align: inherit;">Ele permite implantar redes blockchain usando as interfaces de usu√°rio do console da AWS. </font><font style="vertical-align: inherit;">Mas, tendo adquirido alguma experi√™ncia trabalhando com o Amazon Managed Blockchain, tivemos que abandonar a ideia de usar o servi√ßo em projetos comerciais. </font><font style="vertical-align: inherit;">Havia v√°rias raz√µes para isso. </font><font style="vertical-align: inherit;">Os principais s√£o:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Somente a vers√£o do Hyperledger Fabric 1.2 estava dispon√≠vel no Amazon Managed Blockchain e, no momento em que este artigo foi escrito, a vers√£o 1.4 era usada para criar redes corporativas de blockchain. </font><font style="vertical-align: inherit;">Tamb√©m n√£o permite o uso de vers√µes modernas das ferramentas do SDK do Node.js.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Amazon Managed Blockchain n√£o suporta o banco de dados do CouchDB, dificultando a cria√ß√£o de aplicativos que indexam dados armazenados.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, nossa opini√£o √© que √© melhor usar servidores virtuais ou f√≠sicos para construir redes usando a estrutura Hyperledger Fabric.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre canais de aplicativos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Hyperledger Fabric tem o conceito de "canal". </font><font style="vertical-align: inherit;">Um canal √© uma sub-rede para realizar transa√ß√µes confidenciais. </font><font style="vertical-align: inherit;">Haver√° dois canais em nosso aplicativo.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hospital de pais". </font><font style="vertical-align: inherit;">Destina-se a transa√ß√µes entre membros de organiza√ß√µes de pais e hospitais: cria√ß√£o e modifica√ß√£o de registros m√©dicos, cria√ß√£o de um contrato com um pediatra e assinatura de um contrato de pediatra.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Paishospitalkindergarten." </font><font style="vertical-align: inherit;">Nesse canal, os membros dos pais e do hospital ir√£o interagir com os membros do jardim de inf√¢ncia. </font><font style="vertical-align: inherit;">Al√©m disso, os relat√≥rios ser√£o gerados com base nos dados dos registros m√©dicos.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ambiente de trabalho</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementaremos nossa rede blockchain usando o Docker Swarm - este √© o sistema nativo do Docker para implantar um cluster de host. Se voc√™ nunca trabalhou com o Docker (e especialmente com o Docker Swarm), verifique primeiro este produto e como orquestrar cont√™ineres usando o Docker Swarm. A </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documenta√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descreve os conceitos b√°sicos de trabalhar bem com essas ferramentas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toda a nossa rede estar√° localizada nos servidores AWS EC2. </font><font style="vertical-align: inherit;">As informa√ß√µes na rede blockchain ser√£o armazenadas no CouchDB. </font><font style="vertical-align: inherit;">O Hyperledger Fabric tamb√©m suporta o banco de dados LevelDB, mas o CouchDB, ao contr√°rio do √∫ltimo, possibilita pesquisar por qualquer crit√©rio em uma cole√ß√£o de documentos. </font><font style="vertical-align: inherit;">Tamb√©m usaremos a Autoridade de certifica√ß√£o de malha - este √© um componente modular para gerenciar identificadores de rede de todas as organiza√ß√µes e seus usu√°rios. </font><font style="vertical-align: inherit;">Ele fornece o registro dos participantes da rede e a emiss√£o de certificados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teremos quatro servidores EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pedido, banco de dados MySQL (para armazenar informa√ß√µes de aplicativos que n√£o se aplicam a registros m√©dicos)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organiza√ß√£o dos pais (Ponto0, Ponto1), CouchDB, Fabric-CA, CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organiza√ß√£o hospitalar (Par0, Par1), CouchDB, Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organiza√ß√£o do jardim de inf√¢ncia (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando servidores EC2 na AWS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos de servi√ßos t2.medium para funcionar. </font><font style="vertical-align: inherit;">Esse tipo de servidor EC2 possui poder de computa√ß√£o suficiente para instalar todo o software necess√°rio e funcionar com a ferramenta Hyperledger Fabric. </font><font style="vertical-align: inherit;">No grupo de seguran√ßa Configurar, defina Todo o tr√°fego e Origem - 0.0.0.0/0, :: / 0. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 1. </font><font style="vertical-align: inherit;">Configure o Grupo de seguran√ßa no painel da AWS. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos quatro servidores EC2:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, voc√™ ter√° seus pr√≥prios caminhos para os servidores EC2. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2. </font><font style="vertical-align: inherit;">Preparado para servidores EC2 operacionais.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalando o software de pr√©-requisito nos servidores EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, em cada servidor EC2, precisamos instalar o Docker e o Git. </font><font style="vertical-align: inherit;">Por conveni√™ncia, abra quatro abas no terminal. </font><font style="vertical-align: inherit;">Vamos para cada servi√ßo EC2 via SSH: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 1:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 2:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 3:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 4:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em cada terminal, execute os seguintes comandos:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos o Docker e o Git instalados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos clonar elementos de nossa rede do reposit√≥rio. </font><font style="vertical-align: inherit;">Para fazer isso, execute o comando em cada terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m precisamos clonar contratos inteligentes do reposit√≥rio que regular√£o os relacionamentos entre os participantes da rede. </font><font style="vertical-align: inherit;">Os contratos inteligentes s√£o escritos no idioma Golang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Executamos essas etapas em cada um dos quatro servidores:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No primeiro terminal, precisamos gerar arquivos e certificados de configura√ß√£o de canal para conectar organiza√ß√µes √† rede:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora copie as pastas de artefatos de canal e de configura√ß√£o de criptografia para os outros tr√™s hosts na pasta poc-network do diret√≥rio pai da rede. </font><font style="vertical-align: inherit;">Observa√ß√£o: ao copiar organiza√ß√µes para o servidor EC2, √© necess√°rio remover certificados de terceiros da pasta crypto-config / peerOrganizations que se relacionam ao trabalho de outras organiza√ß√µes. </font><font style="vertical-align: inherit;">Por exemplo, ao copiar para o host Pais, precisamos deixar a pasta parents.poc-network.com nessa pasta, mas exclua hospital.poc-network.com e kindergarten.poc-network.com.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma pilha de enxame do Docker</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que os cont√™ineres pertencentes a organiza√ß√µes diferentes e localizados em servidores EC2 diferentes possam acessar um ao outro, precisamos combin√°-los em uma pilha. </font><font style="vertical-align: inherit;">Vejamos nossa rede de arquivos / poc-network / docker-compose-general.yaml. </font><font style="vertical-align: inherit;">Ele cont√©m a configura√ß√£o de servi√ßos, indica em quais hosts um servi√ßo (chave </font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) espec√≠fico </font><font style="vertical-align: inherit;">ser√° implantado </font><font style="vertical-align: inherit;">, os aliases (chave </font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">s√£o indicados </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos inicializar o enxame no primeiro terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um token aparecer√° para conectar outro servidor EC2 √† pilha. </font><font style="vertical-align: inherit;">Algo como: </font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora podemos executar nos demais terminais:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma mensagem aparece no console:</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois que todos os tr√™s hosts estiverem conectados ao Swarm, podemos v√™-los no terminal do primeiro host executando o comando:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3. </font><font style="vertical-align: inherit;">Lista de servidores no Docker Swarm. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na pasta network / poc-network, h√° um arquivo .env.template no qual voc√™ precisa especificar um nome de host para cada um dos hosts: </font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para gerar um arquivo .env, √© necess√°rio executar o arquivo ./3_env_gen.sh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora crie uma rede com um driver </font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute o Swarm para criar uma pilha baseada no arquivo docker-compose-general.yaml:</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esse comando, tamb√©m definimos vari√°veis ‚Äã‚Äãde ambiente, descritas no arquivo .env e necess√°rias para que a rede funcione corretamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode executar o comando </font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no primeiro terminal. </font><font style="vertical-align: inherit;">Voc√™ ver√° uma lista de todos os servi√ßos em execu√ß√£o em todas as nossas inst√¢ncias do EC2.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4. </font><font style="vertical-align: inherit;">Lista de todos os servi√ßos que estavam em execu√ß√£o em todos os servidores EC2. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ v√™ a mesma coisa no seu terminal e na captura de tela, est√° tudo bem. </font><font style="vertical-align: inherit;">Agora execute nossa rede. </font><font style="vertical-align: inherit;">No segundo terminal, voc√™ deve inserir o cont√™iner da CLI (afinal, esse cont√™iner √© implantado no segundo host):</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O nome do cont√™iner pode ser visto executando o comando no terminal </font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No cont√™iner, executamos todos os nossos comandos do arquivo 4_create_channels.sh, copiando-os um a um no terminal. </font><font style="vertical-align: inherit;">Na pasta bin, temos os bin√°rios para criar a rede:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canal peer create - crie canais;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jun√ß√£o de canal de mesmo n√≠vel - associando um ponto a um canal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atualiza√ß√£o de canal de mesmo n√≠vel - atualizar configura√ß√µes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instala√ß√£o de chaincode de pares - instale o c√≥digo de c√≥digo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instale o c√≥digo de cadeia especificado na rede.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora voc√™ pode deixar o recipiente executando o comando </font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parents Back Application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o aplicativo no segundo host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m precisamos instalar o NodeJS e o gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m podemos inserir nosso banco de dados atrav√©s do administrador com os seguintes dados de autoriza√ß√£o: </font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(onde </font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o endere√ßo do primeiro servidor EC2 no qual o banco de dados est√° armazenado) </font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m √© necess√°rio conectar nosso aplicativo API ao banco de dados:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atribua o valor correto √† chave </font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nossa aplica√ß√£o de retorno preparou migra√ß√µes e sementes. </font><font style="vertical-align: inherit;">Voc√™ precisa execut√°-los:</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As tabelas devem aparecer no banco de dados. </font><font style="vertical-align: inherit;">E na tabela de organiza√ß√µes, veremos tr√™s linhas com nossas organiza√ß√µes - pais, hospital, jardim de inf√¢ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao gerar certificados desde o in√≠cio, recebemos arquivos para conectar-se √† rede para cada organiza√ß√£o no primeiro host. </font><font style="vertical-align: inherit;">Copie o arquivo connection-parents.json do primeiro host para o segundo. </font><font style="vertical-align: inherit;">Para fazer isso, abra outro terminal da pasta onde o nosso </font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° localizado e execute os comandos:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corre√ß√£o </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em constants.js (valor para o host atual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute nosso aplicativo no segundo terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo userGenerator.sh, atribua o </font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correto √† </font><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, voc√™ precisa executar o script que criar√° os usu√°rios da organiza√ß√£o Pais:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute o script para gerar registros m√©dicos:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dois cart√µes ser√£o criados no blockchain, que tamb√©m ser√£o gravados no banco de dados SQL na tabela de cart√µes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplica√ß√£o de volta ao hospital</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por analogia com o aplicativo anterior, precisamos colocar o arquivo para conectar-se √† rede no terceiro host. </font><font style="vertical-align: inherit;">Para fazer isso, no quinto terminal, execute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clonaremos nosso aplicativo no terceiro host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o NodeJS e o gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corre√ß√£o </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em constants.js (valor para o host atual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute nosso aplicativo no terceiro terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo userGenerator.sh, atribua o </font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correto √† </font><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, precisamos executar um script que crie usu√°rios da organiza√ß√£o do Hospital:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos um segundo usu√°rio na tabela Usu√°rios no banco de dados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jardim de inf√¢ncia aplica√ß√£o de volta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por analogia com o aplicativo anterior, precisamos colocar o arquivo para conectar-se √† rede no terceiro host. </font><font style="vertical-align: inherit;">Para fazer isso, no quinto terminal, execute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clonaremos nosso aplicativo no terceiro host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o NodeJS e o Gcc-c ++ (compilador):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corre√ß√£o </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em constants.js (valor para o host atual):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute nosso aplicativo no terceiro terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No arquivo userGenerator.sh, atribua o </font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor correto √† </font><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, precisamos executar um script que crie usu√°rios da organiza√ß√£o do Hospital:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora temos um terceiro usu√°rio na tabela Usu√°rios no banco de dados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instale o wkhtmltopdf no segundo, terceiro e quarto servidores EC2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O aplicativo posterior usa a biblioteca wkhtmltopdf para gerar um relat√≥rio em PDF sobre o status de sa√∫de da crian√ßa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Precisamos instalar a libpng - a biblioteca oficial para trabalhar com gr√°ficos raster no formato PNG. </font><font style="vertical-align: inherit;">A biblioteca √© independente da plataforma e consiste em fun√ß√µes escritas na linguagem C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira equipe instalar√° o wkhtmltox - a biblioteca LGPLv3 de c√≥digo aberto para renderizar HTML para PDF e v√°rios formatos de imagem usando o mecanismo de renderiza√ß√£o QtWebKit:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo bloco de comandos far√° o download e implantar√° a biblioteca libpng15:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O terceiro bloco de comandos √© necess√°rio para instalar o compilador:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ ainda precisa instalar o LibTIFF:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos testar:</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora voc√™ pode gerar e visualizar documentos PDF.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um pouco sobre o SDK do n√≥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As ferramentas NodeJS para trabalhar com a rede Hyperledger Fabric s√£o apresentadas na forma dos pacotes "fabric-ca-client -v 1.4.0" e "fabric-network" v 1.4.0 ". </font><font style="vertical-align: inherit;">Todos os servi√ßos do aplicativo back-end que interagem com a rede usando o SDK do N√≥ est√£o localizados na pasta Servi√ßos, na raiz do projeto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode ler sobre essas ferramentas e seus m√©todos na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documenta√ß√£o oficial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processos de neg√≥cios de aplicativos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, falaremos sobre como os membros da rede interagem entre si neste aplicativo. </font><font style="vertical-align: inherit;">Todos os processos s√£o descritos em um diagrama UML. </font><font style="vertical-align: inherit;">Vamos considerar cada um deles com mais detalhes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.5. Uma descri√ß√£o gr√°fica dos processos de neg√≥cios no aplicativo.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Portanto, existem v√°rias organiza√ß√µes na rede: pais, hospital e jardim de inf√¢ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um membro dos Pais cria registros eletr√¥nicos de sa√∫de para dois de seus filhos. Esses dados ser√£o armazenados (e complementados) na rede blockchain. Em seguida, os pais enviam uma solicita√ß√£o de acordo com o pediatra, que observar√° seus filhos at√© atingirem a idade adulta (no diagrama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√£o de acordo com um m√©dico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um membro da organiza√ß√£o do hospital assina um acordo (no diagrama - o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©dico assina um acordo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, os pais enviam uma solicita√ß√£o ao jardim de inf√¢ncia com uma solicita√ß√£o para matricular seu filho (no diagrama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√£o de jardim de inf√¢ncia para receber um filho</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 6. </font><font style="vertical-align: inherit;">Uma p√°gina com uma lista de institui√ß√µes de ensino dispon√≠veis na conta dos pais. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O jardim de inf√¢ncia v√™ a solicita√ß√£o na lista de novas solicita√ß√µes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 7. </font><font style="vertical-align: inherit;">Uma p√°gina com uma lista de pedidos de admiss√£o na conta pessoal da institui√ß√£o educacional. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O jardim de inf√¢ncia antes de decidir sobre a admiss√£o da crian√ßa deve garantir seu estado de sa√∫de satisfat√≥rio. </font><font style="vertical-align: inherit;">Para fazer isso, o jardim de inf√¢ncia envia uma solicita√ß√£o para a cl√≠nica em que essa crian√ßa √© observada (no diagrama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√£o de relat√≥rio de sa√∫de infantil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">O pedido ao pediatra √© executado automaticamente depois que o pedido de admiss√£o no jardim √© movido para a guia "Aceito".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 8. </font><font style="vertical-align: inherit;">Uma p√°gina com uma lista de pedidos aprovados para admiss√£o na conta pessoal da institui√ß√£o educacional. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pediatra v√™ a solicita√ß√£o e forma um relat√≥rio que cont√©m dados sobre a sa√∫de da crian√ßa (no diagrama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cria√ß√£o do relat√≥rio de sa√∫de infantil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 9. </font><font style="vertical-align: inherit;">Uma p√°gina com uma lista de aplicativos para criar um relat√≥rio sobre o estado de sa√∫de da crian√ßa na conta pessoal do hospital. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os pais veem que o pediatra gerou um relat√≥rio:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 10. </font><font style="vertical-align: inherit;">Uma p√°gina na conta pessoal dos pais, que exibe o status dos relat√≥rios sobre o status de sa√∫de da crian√ßa. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... e decide conceder acesso √† institui√ß√£o educacional pr√©-escolar para visualizar e fazer o download do relat√≥rio (no diagrama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√™ permiss√£o para visualizar o relat√≥rio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 11. </font><font style="vertical-align: inherit;">Uma janela pop-up para escolher uma institui√ß√£o educacional que pode visualizar o relat√≥rio m√©dico gerado. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pai clica em "Confirmar":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 12. </font><font style="vertical-align: inherit;">Notifica√ß√£o de que a institui√ß√£o educacional selecionada recebeu permiss√£o para visualizar o relat√≥rio m√©dico. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na lista de relat√≥rios no aplicativo da institui√ß√£o educacional, aparecem as informa√ß√µes de que o relat√≥rio foi gerado e est√° dispon√≠vel para visualiza√ß√£o e download em formato PDF.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 13. </font><font style="vertical-align: inherit;">Link para baixar o relat√≥rio em formato PDF na linha com o aplicativo aprovado. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° um relat√≥rio que voc√™ ver√° em uma nova guia no seu computador:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 14. </font><font style="vertical-align: inherit;">Um relat√≥rio de sa√∫de gerado por um funcion√°rio do hospital.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando registros m√©dicos e acordos com um pediatra, assinando um acordo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o aplicativo foi projetado mais para demonstrar a implanta√ß√£o da rede em servidores EC2 separados, executaremos alguns comandos a partir dos scripts preparados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro servidor EC2:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s nos conectamos anteriormente ao banco de dados. </font><font style="vertical-align: inherit;">Depois de executar o comando, voc√™ ver√° duas entradas na tabela Cart√µes. </font><font style="vertical-align: inherit;">Al√©m disso, as informa√ß√µes sobre os dados m√©dicos dessas duas crian√ßas foram registradas no blockchain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse servidor EC2, precisamos criar um contrato com um pediatra que observar√° as crian√ßas:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, este contrato deve ser assinado pelo usu√°rio que criamos para a organiza√ß√£o Hospital. </font><font style="vertical-align: inherit;">Executamos o comando a partir do segundo host:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso contrato √© assinado pelo m√©dico e podemos continuar trabalhando em nosso aplicativo. </font><font style="vertical-align: inherit;">Em seguida, precisamos instalar o aplicativo front-end no segundo, terceiro e quarto servidores EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS: Voc√™ pode encontrar todos os comandos para gerar usu√°rios, cart√µes, acordos e acordos de assinatura na pasta ~ / back / generators.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicativo para pais</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute no segundo host (onde a organiza√ß√£o Pais est√° localizada):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criamos o arquivo .env e especificamos o nome do host no qual nosso aplicativo front-end estar√° localizado:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio estabelecer as depend√™ncias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m deve criar o aplicativo e execut√°-lo na porta 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso aplicativo estar√° dispon√≠vel em: </font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde </font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o endere√ßo do segundo servidor EC2 no qual nosso aplicativo est√° localizado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senha: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â assim que o frontend ser√°. </font><font style="vertical-align: inherit;">Aqui voc√™ ver√° informa√ß√µes sobre os cart√µes m√©dicos que criamos no terminal:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 15. </font><font style="vertical-align: inherit;">Informa√ß√µes sobre os registros m√©dicos de crian√ßas na conta pessoal dos pais.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplica√ß√£o Hospital Frontend</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute no segundo host (onde a organiza√ß√£o do Hospital est√° localizada):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criamos o arquivo .env e especificamos o nome do host no qual nosso aplicativo front-end estar√° localizado:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio estabelecer as depend√™ncias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m deve criar o aplicativo e execut√°-lo na porta 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso aplicativo estar√° dispon√≠vel em: </font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde </font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o endere√ßo do terceiro servidor EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senha: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplica√ß√£o de front-end do jardim de inf√¢ncia</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute no segundo host (onde a organiza√ß√£o do jardim de inf√¢ncia est√° localizada):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criamos o arquivo .env e especificamos o nome do host no qual nosso aplicativo front-end estar√° localizado:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio estabelecer as depend√™ncias:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m deve criar o aplicativo e execut√°-lo na porta 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso aplicativo estar√° dispon√≠vel em: </font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde </font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o endere√ßo do quarto servidor EC2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senha: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinamos como implantar uma rede de aplicativos blockchain em v√°rios servidores virtuais ou f√≠sicos. </font><font style="vertical-align: inherit;">O artigo foi desenvolvido para familiariz√°-lo com os conceitos b√°sicos da tecnologia blockchain, conhecer o que s√£o contratos inteligentes e, pelo menos superficialmente, familiarizar-se com a estrutura Hyperledger Fabric e seu aplicativo padr√£o de amostras de tecido.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt499202/index.html">Opium.Fill - padroniza√ß√£o do esquema de cores atrav√©s dos olhos do programador</a></li>
<li><a href="../pt499206/index.html">Assistentes virtuais. Criando chatbots sem programa√ß√£o</a></li>
<li><a href="../pt499208/index.html">Eventos digitais em Moscou, de 27 de abril a 3 de maio</a></li>
<li><a href="../pt499210/index.html">Eventos digitais em S√£o Petersburgo, de 27 de abril a 3 de maio</a></li>
<li><a href="../pt499212/index.html">Semin√°rios semanais da IBM - abril de 2020</a></li>
<li><a href="../pt499216/index.html">Design no n√≠vel do sistema. Parte 2. Arquitetura Detalhada</a></li>
<li><a href="../pt499220/index.html">A transfer√™ncia de desenvolvedores para um site remoto devido ao coronav√≠rus aumentou a produtividade no Google e Microsoft</a></li>
<li><a href="../pt499224/index.html">√â hora de come√ßar a aprender direito</a></li>
<li><a href="../pt499226/index.html">Sem pandemia: como fazer um filme sobre criptomoeda por US $ 1000 e entrar na melhor distribui√ß√£o de filmes dos EUA</a></li>
<li><a href="../pt499230/index.html">Como criar um worm de conte√∫do saud√°vel: analisando o manual de 1910</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>