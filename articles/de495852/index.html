<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤰🏻 🙎🏽 ⏬ LDA auf LiveJournal-Artikeln + Visualisierung 🏇🏾 👦🏼 🧛🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sobald es interessant wurde, welche Themen die LDA (latente Platzierung von Dirichlet) auf den Materialien des "Live Journal" hervorheben würde. Wie s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>LDA auf LiveJournal-Artikeln + Visualisierung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495852/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobald es interessant wurde, welche Themen die LDA (latente Platzierung von Dirichlet) auf den Materialien des "Live Journal" hervorheben würde. Wie sie sagen, gibt es Interesse - kein Problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für den Anfang, ein wenig über die LDA an den Fingern, werden wir nicht auf mathematische Details eingehen (jeder Interessierte - liest). LDA - ist einer der häufigsten Algorithmen zur Modellierung von Themen. Jedes Dokument (sei es ein Artikel, ein Buch oder eine andere Quelle für Textdaten) ist eine Mischung aus Themen, und jedes Thema ist eine Mischung aus Wörtern. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/so/xn/yb/soxnybbxasatclgqktqkyyafhhu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild aus Wikipedia genommen</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Aufgabe der LDA besteht daher darin, Wortgruppen zu finden, die Themen aus einer Sammlung von Dokumenten bilden. Anhand der Themen können Sie dann Texte gruppieren oder einfach Schlüsselwörter hervorheben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ungefähr 1800 Artikel gingen von der LifeJournal-Website ein, alle wurden in das JSONL-Format konvertiert </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Ich werde die </font><font style="vertical-align: inherit;">ungereinigten </font><font style="vertical-align: inherit;">Artikel auf der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex-Festplatte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> belassen </font><font style="vertical-align: inherit;">. Wir werden die Daten </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">bereinigen</font></a><font style="vertical-align: inherit;"> und normalisieren: Kommentare wegwerfen, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Stoppwörter</font></a><font style="vertical-align: inherit;"> löschen (die Liste zusammen mit dem Quellcode ist auf </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">github</font></a><font style="vertical-align: inherit;"> verfügbar</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), wir werden alle Wörter in Kleinbuchstaben schreiben, wir werden Interpunktion und Wörter entfernen, die 3 Buchstaben oder weniger enthalten. </font><font style="vertical-align: inherit;">Eine der wichtigsten Vorverarbeitungsvorgänge: Das Löschen häufig vorkommender Wörter kann im Prinzip auf das Löschen nur von Stoppwörtern beschränkt werden. Häufig verwendete Wörter werden jedoch mit hoher Wahrscheinlichkeit in fast allen Themen enthalten sein. </font><font style="vertical-align: inherit;">In diesem Fall können solche Wörter nachbearbeitet und gelöscht werden. </font><font style="vertical-align: inherit;">Es ist deine Entscheidung.</font></font><br>
<br>
<pre><code class="python hljs">stop=open(<span class="hljs-string">'stop.txt'</span>)<font></font>
stop_words=[]<font></font>
<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> stop:<font></font>
    stop_words.append(line)<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(stop_words)):<font></font>
    stop_words[i]=stop_words[i][:<span class="hljs-number">-1</span>]
<span class="hljs-comment"># specific regular expresion for this texts </span>
texts=[re.split( <span class="hljs-string">r' [\w\.\&amp;\?!,_\-#)(:;*%$№"\@]* '</span> ,texts[i])[<span class="hljs-number">0</span>].replace(<span class="hljs-string">"\n"</span>,<span class="hljs-string">""</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(texts))]   
    <span class="hljs-comment"># remove punctuation</span>
texts=[test_re(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> texts]<font></font>
texts=[t.lower() <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> texts]
<span class="hljs-comment"># remove stop words</span>
texts = [[word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> document.split() <span class="hljs-keyword">if</span> word <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> stop_words] <span class="hljs-keyword">for</span> document <span class="hljs-keyword">in</span> texts]<font></font>
texts=[[word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> document <span class="hljs-keyword">if</span> len(word)&gt;=<span class="hljs-number">3</span>]<span class="hljs-keyword">for</span> document <span class="hljs-keyword">in</span> texts]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes bringen wir alle Wörter in die normale Form: Dazu verwenden wir die pymorphy2-Bibliothek, die über pip installiert werden kann.</font></font><br>
<br>
<pre><code class="python hljs">morph = pymorphy2.MorphAnalyzer()
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(texts)):
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(texts[i])):<font></font>
        texts[i][j] =  morph.parse(texts[i][j])[<span class="hljs-number">0</span>].normal_form</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, wir werden Informationen über die Form von Wörtern verlieren, aber in diesem Zusammenhang sind wir mehr an der Kompatibilität von Wörtern untereinander interessiert. Hier ist unsere Vorverarbeitung abgeschlossen, sie ist nicht abgeschlossen, aber es reicht aus, um zu sehen, wie der LDA-Algorithmus funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ferner kann der oben erwähnte Punkt im Prinzip weggelassen werden, aber meiner Meinung nach sind die Ergebnisse angemessener. Auch hier gilt der Schwellenwert. Sie entscheiden beispielsweise, dass Sie eine Funktion erstellen können, die von der durchschnittlichen Länge der Dokumente und ihrer Anzahl abhängt ::</font></font><br>
<br>
<pre><code class="python hljs">counter = collections.Counter()
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> texts:
    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> t:<font></font>
        counter[r]+=<span class="hljs-number">1</span>
limit = len(texts)/<span class="hljs-number">5</span>
too_common = [w <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> counter <span class="hljs-keyword">if</span> counter[w] &gt; limit]<font></font>
too_common=set(too_common)<font></font>
texts = [[word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> document <span class="hljs-keyword">if</span> word <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> too_common] <span class="hljs-keyword">for</span> document <span class="hljs-keyword">in</span> texts]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren wir direkt mit dem Training des Modells fort. Dazu müssen wir die Gensim-Bibliothek installieren, die ein paar coole Brötchen enthält. </font><font style="vertical-align: inherit;">Zuerst müssen Sie alle Wörter codieren, die Dictionary-Funktion erledigt dies für uns, dann ersetzen wir die Wörter durch ihre numerischen Äquivalente. </font><font style="vertical-align: inherit;">Die auskommentierte Version des LDA-Aufrufs ist länger, da sie nach jedem Dokument aktualisiert wird. Sie können mit den Einstellungen spielen und die entsprechende Option auswählen.</font></font><br>
<br>
<pre><code class="python hljs">texts=preposition_text_for_lda(my_r)<font></font>
dictionary = gensim.corpora.Dictionary(texts)<font></font>
corpus = [dictionary.doc2bow(text) <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> texts]
<span class="hljs-comment">#lda = gensim.models.ldamodel.LdaModel(corpus=corpus, id2word=dictionary, num_topics=10, update_every=1, chunksize=1, passes=1)</span>
lda = gensim.models.ldamodel.LdaModel(corpus=corpus, id2word=dictionary, num_topics=<span class="hljs-number">10</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Arbeit des Programms können die Themen mit dem Befehl angezeigt werden</font></font><br>
<br>
<pre><code class="python hljs">lda.show_topic(i,topn=<span class="hljs-number">30</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
, wobei i die Themennummer und topn die Anzahl der Wörter im anzuzeigenden Thema ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ein kleiner Bonus für die Visualisierung von Themen. Dazu müssen Sie die Wordcloud-Bibliothek installieren (ähnliche Dienstprogramme befinden sich auch in matplotlib). </font><font style="vertical-align: inherit;">Dieser Code visualisiert Themen und speichert sie im aktuellen Ordner.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> wordcloud <span class="hljs-keyword">import</span> WordCloud, STOPWORDS
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<font></font>
    a=lda.show_topic(i,topn=<span class="hljs-number">30</span>)<font></font>
    wordcloud = WordCloud(<font></font>
                          relative_scaling = <span class="hljs-number">1.0</span>,<font></font>
                          stopwords = too_common <span class="hljs-comment"># set or space-separated string</span><font></font>
                          ).generate_from_frequencies(dict(a))<font></font>
    wordcloud.to_file(<span class="hljs-string">'society'</span>+str(i)+<span class="hljs-string">'.png'</span>) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und zum Schluss noch ein paar Beispiele für die Themen, die ich bekommen habe: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/9f/r_/3f9fr_c5ta3bvodrtk2ugnaolo8.png"><br>
<br>
<img src="https://habrastorage.org/webt/jb/zi/32/jbzi32wizbdzbooiakzojxbo9d0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Experimentieren Sie und Sie können noch aussagekräftigere Ergebnisse erzielen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495820/index.html">Wir bringen die Schüler in 1 Tag nach udalenka</a></li>
<li><a href="../de495836/index.html">Digitale Veranstaltungen in St. Petersburg vom 6. bis 12. April</a></li>
<li><a href="../de495838/index.html">PHP Digest Nr. 177 (23. März - 6. April 2020)</a></li>
<li><a href="../de495844/index.html">Geschäfts- und Systemanalytiker. Was du wissen musst</a></li>
<li><a href="../de495850/index.html">Alltag von Scrum-Masters: Team- und Selbsttransformation</a></li>
<li><a href="../de495854/index.html">Wie kann man Covid und der Überwachung entkommen?</a></li>
<li><a href="../de495856/index.html">Intel DevCloud für oneAPI - ein Cloud-Service für Entwickler, die zu Hause sitzen</a></li>
<li><a href="../de495858/index.html">Fern und Selbstisolation: Weltraumerfahrung, um Erdbewohnern zu helfen</a></li>
<li><a href="../de495884/index.html">Zeitreihenvorhersage mit wiederkehrenden neuronalen Netzen</a></li>
<li><a href="../de495888/index.html">PyCon Russia hat die GFP für zukünftige Redner geöffnet. Teilnahmeformulare und erwartete Themen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>