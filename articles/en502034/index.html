<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🚒 🌐 👩‍🍳 Controlled and uncontrolled components in React don't have to be complicated 🤲🏼 💩 🧑🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr! I present to you the translation of the article "Controlled and uncontrolled form inputs in React don't have to be complicated" by Gosha ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Controlled and uncontrolled components in React don't have to be complicated</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502034/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello, Habr! I present to you the translation of the article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Controlled and uncontrolled form inputs in React don't have to be complicated"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by Gosha Arinich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may have seen many articles saying, “you should not use“ setState ”, while the documents claim that“ refs are bad. ”This is all very contradictory. Sometimes, it’s hard to figure out how to get things right, and what are the criteria for choosing between these methods. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So how do you make forms? After all, forms are central to many web applications. And yet, form processing in React is the cornerstone, isn't it? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, it's not so hard Let me show you the differences between these approaches, as well as when you should use each of them.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unmanaged components</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unmanaged components</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are like regular HTML forms:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Form</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{<font></font>
  render() {<font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
    );<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They remember everything that you typed. </font><font style="vertical-align: inherit;">Then you can get their value using ref. </font><font style="vertical-align: inherit;">For example, in the onClick handler:</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Form</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{<font></font>
  handleSubmitClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> name = <span class="hljs-keyword">this</span>._name.value;
    <span class="hljs-comment">// do something with `name`</span><font></font>
  }<font></font>
  render() {<font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{input</span> =&gt;</span> this._name = input} /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleSubmitClick}</span>&gt;</span>Sign up<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
    );<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In other words, you need to “pull” the values ​​out of the field when you need it. </font><font style="vertical-align: inherit;">This can be done when submitting the form. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the easiest way to implement forms. </font><font style="vertical-align: inherit;">Of course, there must be good reason for using it, namely: the simplest forms, either during the study of React. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, this method is not so flexible, so let's take a better look at managed components.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Managed Components:</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The managed component</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> accepts its current value as props, as well as a callback to change this value. </font><font style="vertical-align: inherit;">You can say that this is a more “reactive” way to control the component, however this does not mean that you should always use this method.</font></font><a name="habracut"></a><br>
<pre><code class="javascript hljs"><font></font>
&lt;input value={someValue} onChange={handleChange} /&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is all very good, but the value of the input form must exist in some state. </font><font style="vertical-align: inherit;">Typically, a component that renders an input form (i.e. a form) saves them in its state:</font></font><br>
<br>
<pre><code class="javascript hljs">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Form</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>();
    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,<font></font>
    };<font></font>
  }<font></font>
<font></font>
  handleNameChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">this</span>.setState({ <span class="hljs-attr">name</span>: event.target.value });<font></font>
  };<font></font>
<font></font>
  render() {<font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{this.state.name}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{this.handleNameChange}</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
    );<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Of course, it can be in the state of another component or even in a separate state store, for example, Redux). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each time you enter a new character, handleNameChange is called. </font><font style="vertical-align: inherit;">It takes the new value of the input form and writes it to state.</font></font><br>
<br>
<img src="https://d33wubrfki0l68.cloudfront.net/d92387dc57d2689c2b02e5f511b2b13c6b22433b/dbafb/assets/images/controlled-vs-uncontrolled/controlled-flow.png" alt="image"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It all starts with an empty line - '';</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You enter the letter 'a' and handleNameChange gets it and calls setState. </font><font style="vertical-align: inherit;">Then the input form is rendered again with the value 'a';</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You enter the letter 'b' and handleNameChange gets the value 'ab' and sets it to state. </font><font style="vertical-align: inherit;">The Opet input form is rendered, but now with the value 'ab'.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This stream seems to “push” changes into the form, which is why the component always has the current value of the input data, without requiring an explicit update request. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that your data (state) and user interface (input form) are always in sync. </font><font style="vertical-align: inherit;">State gives value to the form, while form changes the current state value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It also means that forms can respond immediately to changes, which in turn is necessary to:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quick feedback, such as validation;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disable a specific button until all form fields are valid;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enabling the processing of certain input field formats, such as credit card numbers.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if you do not need it and you think that unmanaged components are much simpler, then use them.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What makes a component “manageable”?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, there are other form elements, such as: checkboxes, radio, textarea and select. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A component becomes manageable when you set its value use props. </font><font style="vertical-align: inherit;">That's all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, each of the form elements has different ways of setting the value, so here is a small table for general understanding:</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Element</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Value</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Callback for change</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New value in callback</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><pre><code class="javascript hljs">&lt;input type=<span class="hljs-string">"text"</span> /&gt;</code></pre></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value = "string"</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onChange</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event.target.value</font></font></td>
</tr>
<tr>
<td><pre><code class="javascript hljs">&lt;input type=<span class="hljs-string">"checkbox"</span> /&gt;</code></pre></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checked = {boolean}</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onChange</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event.target.checked</font></font></td>
</tr>
<tr>
<td><pre><code class="javascript hljs">&lt;input type=<span class="hljs-string">"radio"</span> /&gt;</code></pre></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checked = {boolean}</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onChange</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event.target.checked</font></font></td>
</tr>
<tr>
<td><pre><code class="javascript hljs">&lt;textarea /&gt;</code></pre></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value = "string"</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onChange</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event.target.value</font></font></td>
</tr>
<tr>
<td><pre><code class="javascript hljs">&lt;select /&gt;</code></pre></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value = "option value"</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onChange</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event.target.value</font></font></td>
</tr>
</tbody>
</table></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">findings</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Both managed and unmanaged components have advantages and disadvantages. </font><font style="vertical-align: inherit;">Evaluate a specific situation and choose an approach - if this works for you, then why not take advantage of it? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If your form is incredibly simple in terms of interacting with the user interface, then unmanaged components are perfect for you. </font><font style="vertical-align: inherit;">You do not have to listen to what various articles say is bad. </font></font><br>
<br>
<img src="https://i.imgur.com/D5u8pqE.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, choosing a component type is not a decision that is made once and for all: you can always replace unmanaged components with managed ones. </font><font style="vertical-align: inherit;">The transition from one to another is not so difficult.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en502008/index.html">Programming to the masses</a></li>
<li><a href="../en502012/index.html">Azure for Everyone: Introductory Course</a></li>
<li><a href="../en502018/index.html">Podcast on the security of mobile devices and the development of protective solutions for them</a></li>
<li><a href="../en502028/index.html">Vanya goes to grandmother or dynamic JavaScript adaptive</a></li>
<li><a href="../en502030/index.html">Web Services in Oracle</a></li>
<li><a href="../en502038/index.html">Raising an atom, approach 2.0.1</a></li>
<li><a href="../en502040/index.html">About Phrasal Verbs-5 (up / down)</a></li>
<li><a href="../en502042/index.html">Interview with Analyst - Alexander Sibrikov, Product Manager at AppMetrica</a></li>
<li><a href="../en502046/index.html">Five years Rust</a></li>
<li><a href="../en502048/index.html">Complex behavior without neural networks and training. The philosophical basis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>