<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏫 👨🏿‍✈️ 👸🏻 他のVPNよりもIKEv2が好きな理由 ♨️ 🏜️ 🥜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="現在、周りの誰もがリモートの従業員のためにVPNをセットアップしています。最高のソリューションがすでにオペレーティングシステムに組み込まれている一方で、人々が巨大なバグのあるプログラムをインストールし、ある種の証明書を構成し、TUN / TAPドライバーをインストールし、多くの複雑な操作を行う様子を...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>他のVPNよりもIKEv2が好きな理由</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/498924/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/tv/jr/ggtvjr7iq-tknhzeiv-3cdogqw0.png"></div></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、周りの誰もがリモートの従業員のためにVPNをセットアップしています。最高のソリューションがすでにオペレーティングシステムに組み込まれている一方で、人々が巨大なバグのあるプログラムをインストールし、ある種の証明書を構成し、TUN / TAPドライバーをインストールし、多くの複雑な操作を行う様子を観察するのは私にとって苦痛です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IKEv2は、MicrosoftとCiscoが開発した最新のVPNプロトコルです。これは、Windows、macOS、iOSの新しいVPN接続にデフォルトで使用されます。ほとんどのVPNプロトコルよりも高速で安全であり、サードパーティのプログラムを使用せずに、クライアント側で2回のクリックで簡単に構成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPsec IKEv2は、サーバーの接続だけでなく、通常のVPNエンドユーザー接続にも最適だと思います。</font><font style="vertical-align: inherit;">この投稿では、OpenVPNの代わりに通常のホームユーザーにIPsec IKEv2を使用するように説得します。</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IKEv2の高速化</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが同じであれば、IKEv2は常にOpenVPNよりも高速になります。</font><font style="vertical-align: inherit;">これは、ルーターやシングルボードコンピュータなど、メモリが遅い低電力システムで特に顕著です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際のところ、IPsecはオペレーティングシステムのカーネルのコンテキストで動作し、OpenVPNはユーザー（ユーザー空間）のコンテキストで動作し、各パッケージの処理はカーネルプロセスとユーザープロセスの間でコンテキストを切り替えます。</font><font style="vertical-align: inherit;">これは、スループットと遅延の両方に影響します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uy/3-/46/uy3-46uxfp_8yy9hp2l314om5fq.png"><br>
<font color="999999"><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なるVPNプロトコルの遅延の比較。</font></font></sup></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上のスクリーンショットは、IPsecとOpenVPNの遅延の半分の違いを示しています。</font><font style="vertical-align: inherit;">もちろん、1msの違いは目視ではわかりませんが、システムに負荷がかかると、これらの値は大幅に変動する可能性があります。</font><font style="vertical-align: inherit;">さらに、実際の指標は特定のシステムの特性に強く依存するため、2つのプロトコルを比較する絶対的な数値は示しません。</font><font style="vertical-align: inherit;">VPNで音声とビデオを使用する場合、遅延は非常に重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の主観的な感情によると、Windows 10のIKEv2はOpenVPNよりも著しく応答性が高くなっています。</font><font style="vertical-align: inherit;">結局のところ、デスクトップコンピューターの実際の使用は、VPNプロトコルの模擬テストとは大きく異なります。</font><font style="vertical-align: inherit;">プロセッサとメモリの負荷は一定ではなく、ユーザーは要求の厳しいプログラムを実行できますが、これはすべてパフォーマンスに影響します。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成が容易なIKEv2</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての最新のオペレーティングシステム（Androidを除く）は、箱から出してすぐにIPsec IKEv2をサポートしています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、仮想TUN / TAPドライバーなど</font><b><font style="vertical-align: inherit;">をインストールする必要はありません</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">すべてのVPN管理は、システムメニューから行います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、クライアントの構成を次の3行に簡略化できます。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメイン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -IPsecの場合、SSL証明書が発行されるため、ドメインが必要です。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログインする</font></font></b></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワード</font></font></b></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書とキーを含むファイルをクライアントに転送する必要がなくなり、強制的にルート証明書をシステムストレージにインポートします。</font><font style="vertical-align: inherit;">ユーザー名とパスワードで十分であり、接続はHTTPSを使用するWebサイトと同じx.509証明書を使用するため、証明書を使用する場合、OpenVPNと同じくらい安全です。</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10でのセットアップ</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VPNセットアップウィザードは、WiFi接続メニューから呼び出されます。</font><font style="vertical-align: inherit;">資格のあるユーザーは、1つのウィンドウの設定を処理できます。</font><font style="vertical-align: inherit;">作成された接続は、WiFiネットワークのリストを含むメニューからアクティブ化されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ju/fm/cg/jufmcgkjprojhspfqnbxjacdhtw.png"><br>
<font color="999999"><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10で新しいIKEv2接続を構成するためのインターフェイス</font></font></sup></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MacOSのセットアップ</font></font></b>
                        <div class="spoiler_text"> macOS  IKEv2    10.11 (El Capitan).       . <br>
<br>
<img src="https://habrastorage.org/webt/f4/ad/hk/f4adhkw9swpneyfo0jn9jgro9s4.png" alt="image"><br>
<br>
  .        .<br>
<br>
<img src="https://habrastorage.org/webt/xc/ng/zq/xcngzqon0ilejqrl7hqla-8vbf4.png" alt="image"><br>
<br>
   ,    .     «Server Address»   IP- ,     «Remote ID»,       DNS-,      .<br>
<br>
<img src="https://habrastorage.org/webt/x4/c2/eq/x4c2eqk2waefy8woi_pnaa8o5uw.png" alt="image"><br>
<br>
       <b>/etc/ipsec.secrets</b><br>
<br>
<img src="https://habrastorage.org/webt/-p/gu/98/-pgu98eevkywzjzqjd7dfvq94zc.png" alt="image"><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOSのセットアップ</font></font></b>
                        <div class="spoiler_text"> iOS     ,       mobileconfig. <br>
<br>
      macOS:<br>
<br>
<b> -&gt; VPN -&gt;   VPN</b><br>
</div>
                    </div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IKEv2は安全です</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のステップで、接続を構成するにはログインとパスワードで十分であることがわかりました。しかし、クライアントはどのようにして、接続がタップされておらず、データが置き換えられておらず、サーバーが本当にそのサーバーであるかを確認できますか？これには、通常のSSL証明書が使用されます。これは、WebサイトやHTTPSで使用されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/21/rh/ka/21rhkapzsdz7of__ym8ea2fqshw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントはサーバーに安全なSSLトンネルをインストールし、ログインパスワードはすでにその内部に送信されています。デフォルトでは、WindowsおよびmacOSでは、mschapv2アルゴリズムがパスワードの送信に使用されます。したがって、SSL証明書を使用して、クライアントはサーバーの信頼性を検証し、サーバーはログイン/パスワードを使用してクライアントの信頼性を検証します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IKEv2サーバーは、たとえば人気のあるLet's EncryptのWebサーバーで同じ証明書を使用できます。これにより、証明書の管理が大幅に簡素化されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenVPNでも同じモデルが使用されており、必要に応じてLets Encryptの証明書を使用できますが、いずれの場合でも、管理者はVPNを構成するためにファイルをユーザーに転送する必要があります。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IKEv2サーバーの構成</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動インストールスクリプトまたは既製のコンテナーを使用すると、IKEv2サーバーを数分で展開できます。</font><font style="vertical-align: inherit;">ドッカーの使用はお勧めできません。そのネットワークサブシステムは、安価なVPSレートでIPsecのパフォーマンスを低下させるためです。</font><font style="vertical-align: inherit;">また、IKEv2サーバーを手動で構成することもできます。Habréには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Strongswanサーバー設定の例を含む</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も成功した自動</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトの1つを使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ますgithub.com/jawj/IKEv2-setup</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このスクリプトは、Lets Encryptからの証明書を使用し、有効な証明書を自動的に生成するため、優れています。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ1：サーバーの選択</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VPNサーバーを起動するには、VDSが必要です。</font><font style="vertical-align: inherit;">シングルプロセッサコアの最も単純な構成で十分です。</font><font style="vertical-align: inherit;">この例のスクリプトはUbuntu 18.04で最適にテストされているため、サーバーを作成するときに、このOSイメージを選択します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oy/uq/xq/oyuqxqe5ojckq6-rfdcmsbv9qps.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーのインストールが完了するのを待って、接続の詳細をコピーします。</font><font style="vertical-align: inherit;">rootパスワードはメールに送信されます。または、Webインターフェースを介して手動で設定することもできます。</font><font style="vertical-align: inherit;">次に、すべてのコマンドを入力します</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uv/ot/vm/uvotvmd9a_5l7l_g3bnnqkudxhc.png"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ2：Strongswanをインストールする</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSHクライアントで接続し、インストールスクリプトを実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#     IKEv2 </span><font></font>
wget https://raw.githubusercontent.com/jawj/IKEv2-setup/master/setup.sh<font></font>
chmod u+x setup.sh<font></font>
./setup.sh<font></font>
....<font></font>
<span class="hljs-comment">#      IP- </span>
<span class="hljs-comment">#   sslip.io     </span>
Hostname <span class="hljs-keyword">for</span> VPN: 123-45-67-89.sslip.io
<span class="hljs-comment">#   VPN</span><font></font>
VPN username: coolguy<font></font>
<span class="hljs-comment">#  </span><font></font>
VPN password (no quotes, please):<font></font>
....<font></font>
<span class="hljs-comment">#     SSH-,    .</span>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ3：クライアントのセットアップ</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力したVPNユーザーの詳細は、クライアントの構成に使用する必要があります。</font><font style="vertical-align: inherit;">[ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPNのホスト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名]に入力したドメイン名を正確に使用することが重要です</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ4：新しいユーザーを追加する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成済みのサーバーに新しいユーザーを追加するには、</font><b><font style="vertical-align: inherit;">/etc/ipsec.sectes</font></b><font style="vertical-align: inherit;">ファイルを編集します</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></b><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/ipsec.secrets</span>
123-45-67-89.sslip.io : RSA <span class="hljs-string">"privkey.pem"</span>
coolguy : EAP <span class="hljs-string">"C00lPassword"</span>
badguy : EAP <span class="hljs-string">"bAdP$<span class="hljs-variable">$word</span>"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーを追加</font><font style="vertical-align: inherit;">したら</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ipsec secretsコマンドを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行して、</font><font style="vertical-align: inherit;">Strongswanが構成を再度読み取るようにします。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IKEv2のユーザーエクスペリエンスを確認しました。</font><font style="vertical-align: inherit;">そのようなサーバーの管理は、OpenVPNよりも複雑ではなく、時にはさらに簡単です。</font><font style="vertical-align: inherit;">従業員のリモートアクセスのみを計画している場合は、必ずIKEv2に目を向けてください。</font><font style="vertical-align: inherit;">必要なものがすべてコンピューターに既にある場合は、ユーザーに不要なプログラムのインストールを強制しないでください。</font><font style="vertical-align: inherit;">それはより便利で、より安全で、はるかに進んでいます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja498912/index.html">Habrの危機対策セクション</a></li>
<li><a href="../ja498914/index.html">成長するAI-遺伝的アルゴリズム：はじめに</a></li>
<li><a href="../ja498918/index.html">あなたの発言は100％正しいですが、要点を逃しています</a></li>
<li><a href="../ja498920/index.html">支払いシステム。鎧と甲殻の競争</a></li>
<li><a href="../ja498922/index.html">複雑なプロジェクトを台無しにするエラー。Redmadrobotマネージャーのエクスペリエンス</a></li>
<li><a href="../ja498928/index.html">プリンター言語とテクノロジー</a></li>
<li><a href="../ja498930/index.html">チームリーダーになる必要がないのはなぜですか。</a></li>
<li><a href="../ja498932/index.html">DotNetRuチームの正しい翻訳の本「.NET for Professionals for Professionals」</a></li>
<li><a href="../ja498934/index.html">PHPを使用して1分に複数回c​​ronを実行する方法</a></li>
<li><a href="../ja498936/index.html">Cloudflare PHP APIバインディング</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>