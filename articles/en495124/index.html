<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßùüèΩ üóª üéÖüèª How to steal a Macbook üìÇ ü§† ü¶ã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="MacBooks were stolen from me several times, and Apple‚Äôs anti-theft tools like Find My Mac never helped me get my computer back. Are they really worthl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to steal a Macbook</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495124/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/cd/4n/8a/cd4n8ada0cmbsbsl46d1oqpzshk.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MacBooks were stolen from me several times, and Apple‚Äôs anti-theft tools like Find My Mac never helped me get my computer back. Are they really worthless? Can I trust FileVault's built-in encryption? How to increase the chances of getting the computer back? This article is the result of my suffering in futile attempts to return stolen computers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The article describes in detail the mechanisms of protection through the eyes of an attacker, in our case a thief. This gives you a better idea of ‚Äã‚Äãhow they work. The narrative in the article is on behalf of the thief - this is only an artistic device for a better understanding of the material. </font></font><br>
<br>
<font color="red"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention!</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The materials in the article are presented for informational purposes only. </font><font style="vertical-align: inherit;">All descriptions of fraudulent activities are staged and executed with the consent of laptop owners. </font><font style="vertical-align: inherit;">The author does not call for fraudulent actions, and the sole purpose of the article is to show how best to configure the system to protect your data.</font></font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foreword</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the screenshot below, one of several of my stolen laptops that remained buried in the iCloud panel. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i8/gm/38/i8gm38skst0f5pndf9txebxd2hy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The interface of the Find My Mac function in the iCloud control panel says that the lock functions will become available when the laptop connects to the Internet. </font><font style="vertical-align: inherit;">But that will never happen.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Every time I stole a MacBook, or I lost it with my bag, I realized the futility of Find My Mac. </font><font style="vertical-align: inherit;">After all, the laptop does not have a modem, and I can neither track its location nor delete data remotely. </font><font style="vertical-align: inherit;">For anti-theft functions to work, the thief must connect my laptop to the Internet. </font><font style="vertical-align: inherit;">But how will he do it if the account is locked with a password? </font><font style="vertical-align: inherit;">It turns out that even a person who wants to return a computer to me will not be able to do this if I do not write my contacts somewhere on the case in advance. </font><font style="vertical-align: inherit;">I am absolutely sure that in all cases of theft, my laptops were completely cleaned and sold to new owners who now use them without any problems without even suspecting that they were stolen.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPhones are better protected</font></font></font></h2><br>
<img width="600" src="https://habrastorage.org/webt/eg/hh/49/eghh49gvtto0tepj6zebavkqm3m.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An iPhone with up-to-date iOS cannot just be untied from iCloud. </font><font style="vertical-align: inherit;">(Image by Alexander Varakin)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Modern iPhones are quite well protected, they can‚Äôt just be untied from your iCloud account and sold on the radio market. </font><font style="vertical-align: inherit;">Therefore, there are whole fraudulent schemes for untying devices through phishing. </font><font style="vertical-align: inherit;">Good research by Anton</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bo0oM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about this phenomenon: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iCloud phishers and where they live</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Thieves are trying to log in to the victim‚Äôs iCloud account and unlock the phone. </font><font style="vertical-align: inherit;">Even if the thief managed to remove the SIM card and turn off WiFi before the owner could lock the phone, he still could not unlock it if authorization by fingerprint, face or PIN code was enabled. </font><font style="vertical-align: inherit;">And this is awesome. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is a lot of information about blocking iPhones, these mechanisms have been well studied. </font><font style="vertical-align: inherit;">But nobody discusses the same functions in macbooks; it seems as if they are not there. </font><font style="vertical-align: inherit;">Unfortunately, all MacBook models until 2018 (without the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chip </font><font style="vertical-align: inherit;">) are defenseless against thieves, and in any case they will be sold completely cleaned. </font><font style="vertical-align: inherit;">But at the same time, you can complicate the life of a thief as much as possible and protect your data.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 1: Stealing MacBook</font></font></font></h2><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/TJLjl0Lsz_Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a realistic test of all hypotheses, we need to steal a real MacBook. </font><font style="vertical-align: inherit;">Further narration I will lead on behalf of the thief. </font><font style="vertical-align: inherit;">In order to understand how the protection mechanisms work, you need to reproduce the real threat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">model</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">intruder model</font></a><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
According to the script from the video, I stole the included MacBook from the victim in a cafe. </font><font style="vertical-align: inherit;">At the time of the theft, I closed the lid, so that the laptop went into sleep mode and disconnected from WiFi. </font><font style="vertical-align: inherit;">This is an important point, as it reproduces the most popular scenario in which a laptop falls into the hands of a thief. </font><font style="vertical-align: inherit;">Most often, MacBook owners simply close the lid and put the laptop in the bag without turning off the computer. </font><font style="vertical-align: inherit;">All the times, when I lost my computer, he was in this state - he was sleeping in a backpack.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Find My - tracking devices without the Internet</font></font></font></h3><br>
<img src="https://habrastorage.org/webt/h1/w0/vk/h1w0vkv1zh3-3t1cpbeobugx6e0.jpeg"> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apple's New Geotracking Technology Without Internet</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Right after the theft, I run with my stolen MacBook armpit to my lab. Imagine that I am running faster than the victim and was able to hide. At the same time, actions take place in the city, and I run along a crowded street. What will the victim do at this moment? In a panic, he enters the FindMy application and will try to track the computer or block it. But you won‚Äôt be able to block or erase the data, because the laptop has no Internet connection. But it turns out to see the real coordinates of the laptop on the map, and this is amazing!</font></font><br>
<br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/we/ri/oa/werioaix9_rwlnsmugf9b0kwwcc.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 2019, Apple announced an updated FindMy application and a new way to track devices, in the settings it is called Offline Finding. Most Apple technology users are unaware of this feature. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The principle of operation is as follows: first you need to have at least two Apple devices tied to the same iCloud account. Both devices must have the current operating system, at least iOS 13 and macOS 10.15 (Catalina). If all conditions are met, both devices generate keys and exchange private parts (private key) with each other, so that each device can decrypt the messages of the other.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tj/8e/h4/tj8eh4uyrwgt4e_sunrx4btk69s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
According to Apple, these keys are stored only on devices and are not stored on the server. That is, you can use the function only from another device and not from icloud.com. This means that having lost both devices, on icloud.com you can only see online geolocation, which works only if the device has Internet access, but not offline finding.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x9/cw/rl/x9cwrlrcwzr5lyxadtqfvkd8krw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the device is without the Internet, for example, a phone without a SIM card or a MacBook without WiFi, it starts sending special packages via Bluetooth Low Energy with its public key. And any Apple device that is nearby, for example, a random passerby with an iPhone, having heard such a signal, will automatically take this key, encrypt it with its current coordinates and send them to the server. This does not require any action from the user, everything happens in the background while the phone is in a pocket with a locked screen. A kind of proprietary botnet with light notes of mesh-networks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On macOS, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / libexec / searchpartyuseragent</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> daemon is responsible for this function </font><font style="vertical-align: inherit;">. The keys are supposedly stored in the key holder under the name </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LocalBeaconStore ‚Üí LocalBeaconStoreKey</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It‚Äôs upsetting that BLE beacons are only sent when the system is on or in sleep mode, that is, to turn off such tracking, the thief just needs to hold down the shutdown button. </font><font style="vertical-align: inherit;">It would be great if this functionality worked directly on the Bluetooth / WiFi chip when there is standby power on the motherboard.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 2: Hiding - spoofing geotracking via a Bluetooth proxy</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Is it possible to trick the system and show the victim a fake address of his laptop? If the lost MacBook itself does not know its coordinates, but only sends a public key, then the device that received the signal adds the coordinates. So this scheme is vulnerable to spoofing! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ha/rw/ni/harwniuiqtb7yvwzu-f_nwtijtu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The BLE packet relay transmits all the heard signals to the remote transmitter.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the circuit with the repeater, the receiver listens to all signals from the victim and sends them over the Internet to the transmitter. Random passers-by who received the signal add their coordinates to it and send it to the server. I am sitting with the victim‚Äôs device in the basement, and the transmitter is at the other end of the city. Thus, the victim sees fake coordinates. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To build such a scheme, you will need two computers with BLE adapters connected to the same network and framework</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BtleJuice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The proprietary protocol FindMy has not yet been studied, the format of the BLE packets is unknown. </font><font style="vertical-align: inherit;">Even the exact intervals between beacon shipments and the conditions under which this function is activated are unknown. </font><font style="vertical-align: inherit;">An experimentally established interval of 10-20 minutes. </font><font style="vertical-align: inherit;">According to Apple, the private key changes regularly, but how often is unknown. </font><font style="vertical-align: inherit;">I invite everyone to participate in the reversal of the protocol. </font><font style="vertical-align: inherit;">Apple has a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">description of the cryptography</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used by FindMy. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> At the time of writing these lines, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a study of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cryptography used in FindMy </font><font style="vertical-align: inherit;">was </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">published</font></a><font style="vertical-align: inherit;"> , the author does not consider the technical implementation of the protocol, and I did not quite understand what the work was about.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To proxy requests to the transmitter, you need a server and will work with a minimal config, like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RUVDS for 130 rubles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">He has per-second tariffication and payment only for the resources used. </font><font style="vertical-align: inherit;">For habrayuzers, a 15% discount on the dontpanic promotional code works.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 3: stealing data from a laptop</font></font></font></h2><br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/qu/j-/ao/quj-ao96qzesjaabluh6cvczhuq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data on a disk can be much more valuable than the macbook itself. What if there are keys for bitcoin wallets, usernames, passwords, or intimate photos? Therefore, first try to read the data on the disk. We stole the laptop in the on state, but at the time of the theft, the cover was closed, and now it is locked with a user password. Most MacBook owners carry them in sleep mode, that is, they just close the lid. This is the most likely condition in which a thief will receive a computer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The easiest way to read data is to boot from a USB stick in Linux. But if FileVault is turned on in the system, then reading the data will not work, so rebooting is risky for us, because it is not known in advance whether encryption is enabled or not. While the computer is turned on, the file system is decrypted exactly, so you need to try to gain access without rebooting.</font></font><br>
<br>
<blockquote>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">DMA-</a>,    FileVault  .    ,  DMA-    Thunderbolt - IOMMU.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Thunderclap</a>     Thunderbolt-,   -   .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will not consider the option of brutal password from the user account, because it is not sports. </font><font style="vertical-align: inherit;">In addition, macOS adds a long delay before entering a new password after failed attempts. </font><font style="vertical-align: inherit;">For such an attack, you can use any hardware tools that allow you to emulate a HID keyboard, including raspberry pi or arduino. </font><font style="vertical-align: inherit;">The key point here will be the dictionary for selection. </font><font style="vertical-align: inherit;">I advise you to use a password with at least one special character and without dictionary words. </font><font style="vertical-align: inherit;">This is quite enough to defend against such a brutus.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connect a locked laptop to Wi-Fi</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
While the laptop is turned on and the file system is unlocked, try to knock on it on the network. Perhaps the victim has a network drive or some other services through which you can climb inside. Let's try to persuade the laptop to connect to our WiFi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xl/j3/vs/xlj3vsqwdnvict8fpcpk05kbis0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When devices scan WiFi networks, they also send out the names of networks they recently connected to in probe request packets. That is, while you are walking around the city, your phone or laptop sends out the name of your home WiFi network in the hope that it will answer it. As planned, this should speed up the connection to the network when it is nearby. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To find out which networks the victim‚Äôs laptop is ready to connect to, I put an external WiFi adapter next to him and close the lid of the impromptu Faraday cage. Now the adapter will hear the signals from the laptop well and not hear others.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We start monitor mode with a filter for one type of packet, because we want to see only sample requests.</font></font><br>
<br>
<pre><code class="bash">tcpdump -e -l -I -i en0 type mgt subtype probe-req<font></font>
<font></font>
BSSID:Broadcast DA:Broadcast SA:xx:xx:xx:xx:xx:xx  Probe Request (MGTS_GPON_1856)<font></font>
BSSID:Broadcast DA:Broadcast SA:xx:xx:xx:xx:xx:xx  Probe Request (MGTS_GPON_1856)<font></font>
BSSID:Broadcast DA:Broadcast SA:xx:xx:xx:xx:xx:xx  Probe Request (Onlime)<font></font>
BSSID:Broadcast DA:Broadcast SA:xx:xx:xx:xx:xx:xx  Probe Request (MT_FREE)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It can be seen that the laptop remembers several different networks, among which there are similar to home ones. </font><font style="vertical-align: inherit;">It is important to keep in mind that if a laptop remembers a network with a password, then it will not automatically connect to it if it suddenly appears without a password, but with the same name. </font><font style="vertical-align: inherit;">From these names, we can assume that the first two networks most likely had passwords, but the last one is the Moscow public transport network and it was apparently stored in the computer‚Äôs memory without a password.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This type of attack is quite ancient, but it still sometimes works. </font><font style="vertical-align: inherit;">There are automatic tools like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hostapd-karma</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that respond immediately to all network names.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to raise the access point with the name of the selected network, in our case MT_FREE, so that the laptop automatically connects to it. It should be borne in mind that if the laptop can get on the Internet, the owner can immediately block it and clean the disk. But you can‚Äôt completely disconnect the Internet, otherwise macOS can immediately disconnect from such a WiFi network, considering it broken. Therefore, it must have a working DHCP, DNS resolver and Internet via HTTP in order for the captive portal tests to work. It is enough to open only TCP port 80 on the Internet, and macOS will assume that the network is absolutely normal, while the iCloud anti-theft functions will not work.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the MacBook successfully connects to WiFi, we will only have to scan it over the network for open services, network ball, etc. </font><font style="vertical-align: inherit;">I will not tell you how to do this because it is beyond the scope of this article.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We must honestly admit that most users use the default settings and do not configure any additional network services, so the chance of success with such an attack is negligible. </font><font style="vertical-align: inherit;">But it was worth a try anyway, as this is the last available way to interact with a system that has a decrypted drive.</font></font></blockquote><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reboot into the unknown</font></font></font></h3><br>
<img src="https://habrastorage.org/webt/ik/_-/ks/ik_-ks2gn2vdbptatlrlek_zd5s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let me remind you that while the system was loaded, we had no way to find out if FileVault disk encryption was turned on. </font><font style="vertical-align: inherit;">To check this you need to restart the laptop. </font><font style="vertical-align: inherit;">This can be done only by holding the power button, as there is no power management menu on the screen of a locked session. </font><font style="vertical-align: inherit;">Further, there are two possible scenarios:</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileVault not configured</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Easy rink! </font><font style="vertical-align: inherit;">Just boot from the USB flash drive or remove the disk (on models until 2016) and all of our victim‚Äôs files are available in clear text. </font><font style="vertical-align: inherit;">On Linux, you need to get a little confused with the configuration of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuse-apfs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileVault Enabled</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first time you configure FileVault, it suggests downloading the drive encryption key in iCloud, and in theory a thief could attack the victim‚Äôs account, but we don‚Äôt consider phishing attacks in this article. </font><font style="vertical-align: inherit;">There are several tools for the FileVault brute: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commercial programs from Elcomsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and open source programs like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apfs2john</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for use with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">John The Ripper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely, an ordinary thief will not spend resources on the brutality of your disk, unless this is a targeted attack on data. </font><font style="vertical-align: inherit;">For simplicity, we assume that a non-dictionary password of 6-8 characters of different registers using special characters is invulnerable.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How it should work as planned by Apple</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a long time I couldn‚Äôt understand how exactly Apple represents the work of Find My Mac in real life, because if you follow the default recommendations when you first set up the system, the user will receive a computer with FileVault activated and the attacker will never be able to log in to knock on the Internet and activate all the traps .</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f57/fbb/506/f57fbb506220fe6d8d3247581006a28c.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only possible scenario is a guest account. </font><font style="vertical-align: inherit;">According to the idea, the thief after a reboot gets to the password entry screen to unlock the disk. </font><font style="vertical-align: inherit;">Without guessing the password, he selects the guest account and loads into Safari Only Mode. </font><font style="vertical-align: inherit;">This is a special mode of operation available only to the guest account. </font><font style="vertical-align: inherit;">It runs only one program - the Safari browser. </font><font style="vertical-align: inherit;">The fact is that when FileVault is activated, part of the disk remains unencrypted for the recovery partition. </font><font style="vertical-align: inherit;">It stores a minimal macOS image, from here Safari boots. </font><font style="vertical-align: inherit;">In this mode, the thief can connect to the Internet, and here the laptop will contact iCloud and will be able to execute remote orders of the owner.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 4: Sell MacBook</font></font></font></font><br>
</h2><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Working with NVRAM Variables</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the thief got or did not get access to the data and then he wants to sell the laptop in the secondary market. </font><font style="vertical-align: inherit;">To do this, he needs to untie the computer from iCloud accounts and reinstall the OS. </font><font style="vertical-align: inherit;">In addition to the operating system itself on the hard drive, the macbook has NVRAM variables stored on a USB flash drive in the motherboard. </font><font style="vertical-align: inherit;">This data survives after </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
reinstalling macOS. </font><font style="vertical-align: inherit;">They store a token by which the server recognizes the binding of the macbook to the iCloud account. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To work with variables from user space, there is the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvram</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utility </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Find My Mac Token Example</font></font></b><div class="spoiler_text"><pre><code class="bash">#  Find My Mac <font></font>
$ nvram fmm-mobileme-token-FMM<font></font>
<font></font>
fmm-mobileme-token-FMM bplist00%dc%01%02%03%04%05%06%07%08%09%0a%0b%0c%0d%0e%10%0d%11%0d%12%13%14%15%16%1d_%10%0funregisterState_%10%12enabledDataclassesYauthToken^disableContextVuserid]enableContextXusernameXpersonIDWaddTimeTguidXuserInfo_%10%13dataclassProperties%10%00%a1%0f_%10!com.apple.Dataclass.DeviceLocator_%10%ccEAADAAAABLwIAAAAAF6Jva4RDmqzLmljbG91ZC5hdXRovQA_OvlxQ5x0ULxeZIwLf9ZKD2GL8xWXoQiCKVs4tSztt-QZ2ZPlgZqpHekekaGd06Bm20kyU4m1ryRhBPR5DNSSbfzrKM_Ap0elpAitBDkGyHGjTe9c5WajVpfvWe_RGFhcamieaVhGQGzsiFGe11nt1PtCzA~~%11%01%f5_%10%11ivan@ivanov.comZ1253943158#A%d7%a2or%f3kP_%10$7C83E2DA-8A39-414E-B004-4DE79E4D35B3%d3%17%18%19%1a%1b%1c_%10%15InUseOwnerDisplayName_%10%13InUseOwnerFirstName_%10%12InUseOwnerLastName]ivan ivanovUivanWivanov%d1%0f%1e%d5%1f !"#$%25&amp;'(VapsEnvXhostname]idsIdentifierVscheme]authMechanismZProduction_%10%13p09-fmip.icloud.com_%10$0FFD23C3-F469-42C1-97E0-FD8EE1F80502UhttpsUtoken%00%08%00!%003%00H%00R%00a%00h%00v%00%7f%00%88%00%90%00%95%00%9e%00%b4%00%b6%00%b8%00%dc%01%ab%01%ae%01%c2%01%cd%01%d6%01%fd%02%04%02%1c%022%02G%02U%02[%02c%02f%02q%02x%02%81%02%8f%02%96%02%a4%02%af%02%c5%02%ec%02%f2%00%00%00%00%00%00%02%01%00%00%00%00%00%00%00)%00%00%00%00%00%00%00%00%00%00%00%00%00%00%02%f8<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, the official help for the nvram command hides some features. The manual from leaked CIA documents published on Wikileaks: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EFI Basics: NVRAM Variables</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> turned out to be much more useful </font><font style="vertical-align: inherit;">. It turns out that the utility can work directly with UEFI variables (efi vars). But the values ‚Äã‚Äãof most variables can only be changed with SIP (system integrity protection) disabled. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> My access to EFI variables through the nvram utility on macOS Catalina stopped working for me. The GUID, variable names, or program syntax may have changed. It is necessary to check the relevance of variables through the UEFI shell or Linux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To untie a stolen laptop, just clear the nvram variables and reinstall the OS. To reset nvram you need</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hold Command (‚åò) + Option + P + R when loading a laptop. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is enough to make the iCloud server no longer consider the device to belong to a specific iCloud account. </font><font style="vertical-align: inherit;">And although after resetting the nvram the serial number of the motherboard remains the same, iCloud will allow you to link the laptop to a new account.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Password on UEFI</font></font></font></h3><br>
<img width="500" src="https://habrastorage.org/webt/yr/do/ps/yrdopshalm6h-yflmccj3uidrim.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the previous steps, we booted from the USB flash drive (Option key at boot) and reset nvram. </font><font style="vertical-align: inherit;">But it turns out that all this can be disabled with a UEFI password. </font><font style="vertical-align: inherit;">By the way, few people even know about this among experienced users of poppies. </font><font style="vertical-align: inherit;">The installed password for the firmware prohibits such actions:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset NVRAM at boot time</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMC Reset</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select another boot method (Option key)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In all cases, a password will be requested. </font><font style="vertical-align: inherit;">That is, the thief will not be able to boot from the USB flash drive and will not be able to easily untie the computer from iloud, dropping the Find My Mac token from nvram. </font><font style="vertical-align: inherit;">It also does not work out easily reinstalling the OS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/2g/6g/vv2g6gl97knqw_0jrjajvnkixmi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can set a password for UEFI through Recovery Mode. </font><font style="vertical-align: inherit;">To do this, hold down CMD + R at the boot stage and select Startup Security Utility from the menu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But not everything is so rosy, the password on the UEFI does not protect. </font><font style="vertical-align: inherit;">On macbooks until 2019, UEFI firmware and NVRAM variables are stored on a regular SPI flash drive, to which you can connect with the programmer and change any data without authorization.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset UEFI Password</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On all MacBooks without a T2 chip, the firmware on the motherboard is in no way protected. It can be easily reflashed, including removing the password for UEFI. To do this, just connect the programmer to the debug connector on the motherboard and then you can work with the memory chip as with a regular flash drive. </font></font><br>
<br>
<img width="400" src="https://habrastorage.org/webt/pw/bh/kw/pwbhkws-uye_igppdmvrbmlcs74.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Universal cable for flash drive firmware for all models of macbooks</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
There is some confusion with these connectors, since they do not have a key, that is, they can be connected by different sides. On different models of macbooks, the connector is in different places, sometimes it is sometimes necessary to solder the power of the 3.3V flash drive separately. Therefore, sometimes you need to carefully study the circuit of a specific motherboard.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/ve/pt/jmveptpckft30t2yccbhf4pdplw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are also fully autonomous devices that find the desired offset in the firmware and pat it on the fly, disabling the UEFI password. </font><font style="vertical-align: inherit;">In some service centers, where they offer to get rid of the password on UEFI, they prefer to unsolder the memory chip and flash it in the clip of the programmer.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UEFI implants</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is a separate exotic - external boards with EEPROM, which are inserted immediately into the debug-connector. </font><font style="vertical-align: inherit;">Usually they are already flashed under the desired motherboard. </font><font style="vertical-align: inherit;">Immediately after installation, the computer starts to boot from this flash drive, ignoring the native one soldered to the motherboard. </font><font style="vertical-align: inherit;">In this case, the native flash drive can remain with the firmware password. </font><font style="vertical-align: inherit;">It is convenient to use such implants for experiments with UEFI patches, you can always roll back to your native firmware by simply pulling out the module.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/2b/hl/ui2bhlqhw1o7zyjgo03rul18zxu.jpeg"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phishing anti-theft system</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I was so upset by the uselessness of all Apple anti-theft systems that I decided to come up with my own. </font><font style="vertical-align: inherit;">This was before the announcement of the T2 chip, so it was impossible to rely on hardware protection, and I decided to simply deceive the thief so that he himself did everything that was required. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The scheme is as follows:</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the MacBook's disk, a small Linux partition is highlighted. </font><font style="vertical-align: inherit;">The modern kernel (efistub) can boot immediately without any intermediate bootloaders like refind. </font><font style="vertical-align: inherit;">I wrote about this in a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">in a single file for a Macbook. </font></a><font style="vertical-align: inherit;">By default, the laptop boots Linux, which launches the initial setup wizard disguised as macOS. </font><font style="vertical-align: inherit;">In the video, it is shown from 7:00.</font></font></li>
<li>   ,    macOS   ,       () ,     nvram:  macOS     .        ,   ,      .       ,   .     ,      .         .  ,      ,        . </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The setup wizard offers to perform the initial setup of the system and for this asks to connect to WiFi. </font><font style="vertical-align: inherit;">Then he draws the fake process of downloading something, and at that moment he taps onto the server and gives full access to the real owner.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The BSSID owner of WiFi access points finds the location of the laptop, can listen to sound from the microphone and watch the thief through the camera, etc. </font><font style="vertical-align: inherit;">While the setup wizard interface shows the fake update download process, the owner of the laptop is already traveling to the address.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, I did not finish the server part, but here are the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sources of the setup wizard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on Electron. </font><font style="vertical-align: inherit;">It looks, by the way, very believable, I would even be seduced. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demonstration on video:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/I3_XST3z4qo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">findings</font></font></font></h2><br>
<ul>
<li><b> FindMy  .</b>        .   ,    ,       . ,             . <b>     ,     !</b></li>
<li><b>   FileVault!</b>       .          .       ,          .   ,        ,        ,         ,     .   ,          ,    . </li>
<li>[]<b>   .</b>        UEFI,       Safari Only Mode.  ,        .</li>
<li><b>   UEFI.</b>         iCloud.    ,    ,    .</li>
<li><b>    T2.</b>   ,     2.      ,  EEPROM   .       .</li>
</ul><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/zg/zf/j2/zgzfj2gg1a2tn7leusfxt7qfmm4.png" width="780"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495112/index.html">Content-based tagging in the werf collector: why and how does it work?</a></li>
<li><a href="../en495114/index.html">Self-isolation: how likely is it to get coronavirus if you go for a walk</a></li>
<li><a href="../en495116/index.html">How to hide everything from nano to macro: scientists have developed the general principles of the "theory of invisibility"</a></li>
<li><a href="../en495118/index.html">Problems Using Doctrine ODM in Daemon Processes</a></li>
<li><a href="../en495120/index.html">It's time to rethink OpenBSD security</a></li>
<li><a href="../en495128/index.html">Does a human face VPN exist?</a></li>
<li><a href="../en495130/index.html">Sorting in Scala - an example on cats</a></li>
<li><a href="../en495138/index.html">How will society and technology change after the coronavirus. Expert Opinions</a></li>
<li><a href="../en495140/index.html">Top 10 memes of the past decade</a></li>
<li><a href="../en495146/index.html">Uninterrupted power supply of shopping centers or Shopping Must Go On</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>