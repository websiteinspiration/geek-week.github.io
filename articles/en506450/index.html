<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï≥Ô∏è ü•ü üçá Experience in using Rutoken technology for registering and authorizing users in the system (Part 1) üï∂Ô∏è üë®üèø‚Äçüíº üë®üèΩ‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon! I want to share my experience on this topic. 
 
 Rutoken is a hardware and software solution in the field of authentication, informati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Experience in using Rutoken technology for registering and authorizing users in the system (Part 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506450/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good afternoon! I want to share my experience on this topic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rutoken is a hardware and software solution in the field of authentication, information protection and electronic signature. In fact, this is such a flash drive that can store the authentication data that the user uses to enter the system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, Rutoken EDS 2.0 is used. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To work with this Rootoken, you need to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install the driver on windows</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For windows, installing only one driver provides the installation of everything that is needed for the OS to see your Rutoken and it is possible to work with it.</font></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rutoken can be interacted in a variety of ways. </font><font style="vertical-align: inherit;">You can access it from the server side of the application, or you can immediately from the client. </font><font style="vertical-align: inherit;">In this example, we will consider the interaction with Rutoken from the client part of the application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The client part of the application interacts with rutoken through the rutoken plugin. </font><font style="vertical-align: inherit;">This is a program that is installed separately on each browser. </font><font style="vertical-align: inherit;">For windows, you just need to download and install the plugin </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">located at this link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That‚Äôs it, now we can interact with Rutoken from the client part of the application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, the idea of ‚Äã‚Äãimplementing a user authorization algorithm in a system using the ch√§llange-response scheme is considered. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The essence of the idea is as follows:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The client sends an authorization request to the server.</font></font></li>
<li>         .</li>
<li>     32 .</li>
<li>     .</li>
<li>      .</li>
<li>  ,     .</li>
<li>   32      .</li>
<li>      ,       .</li>
<li>  ,    .</li>
</ol> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the above algorithm, there is such a thing as a certificate. In the framework of this example, you need to understand some cryptographic theory. On Habr√© there is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an excellent article on this subject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, we will use asymmetric encryption algorithms. To implement asymmetric algorithms, you must have a key pair and a certificate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A key pair consists of two parts: a private key and a public key. A private key, as its name implies, must be secret. We use it to decrypt information. You can give out the public key to anyone. This key is used to encrypt data. Thus, any user can encrypt data using a public key, but only the owner of the private key can decrypt this information.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A certificate is an electronic document that contains information about the user who owns the certificate, as well as a public key. </font><font style="vertical-align: inherit;">Having a certificate, the user can sign any data and send it to a server, which can verify this signature and decrypt the data.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to correctly sign a message with a certificate, you need to create it correctly. </font><font style="vertical-align: inherit;">To do this, a key pair is first created on Rutoken, and then a certificate must be attached to the public key of this key pair. </font><font style="vertical-align: inherit;">The certificate must have exactly the public key that is located on Rutoken, this is important. </font><font style="vertical-align: inherit;">If we simply create a key pair and a certificate immediately on the client side of the application, then how then can the server decrypt this encrypted message? </font><font style="vertical-align: inherit;">After all, he knows absolutely nothing about the key pair, nor about the certificate.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you dive deeper into this topic, you can find interesting information on the Internet. There are some certifying centers that we knowingly trust. These certification authorities can issue certificates to users; they install these certificates on their server. After that, when a client accesses this server, he sees this certificate and sees that it was issued by a certification authority, which means that this server can be trusted. More about how to set everything up correctly, the Internet is also full of information. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://howtodoinjava.com/spring-boot/spring-boot-ssl-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, you can start with this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we return to our task, then the solution seems obvious. </font><font style="vertical-align: inherit;">You need to somehow make your certification center. </font><font style="vertical-align: inherit;">But before that, you need to understand, and on the basis of which the certification center should issue a certificate to the user, because he does not know anything about him. </font><font style="vertical-align: inherit;">(For example, his name, surname, etc.) There is such a thing called a certificate request. </font><font style="vertical-align: inherit;">More information about this standard can be found, for example, on wikipedia </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ru.wikipedia.org/wiki/PKCS</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We will use version 1.7 - PKCS # 10. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us describe the algorithm for generating a certificate on Rutoken (primary source - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the client, create a key pair and save it to Rutoken. </font><font style="vertical-align: inherit;">(saving happens automatically)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We create a certificate request on the client.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From the client we send this request to the server.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upon receipt of a certificate request on the server, we issue a certificate with our certification authority.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We send this certificate to the client.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the client we save the certificate for Rutoken.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The certificate must be attached to the key pair that was created in the first step.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it becomes clear how the server can decrypt the client's signature, because he himself issued him a certificate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the next part, we will take a detailed look at how to set up your certification authority based on the full openSSL open source cryptographic library.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506414/index.html">Context Switching and a Simple Extrusion Scheduler for CortexM</a></li>
<li><a href="../en506432/index.html">How to make a custom web or mobile project from scratch: processes, rules and a little blood</a></li>
<li><a href="../en506438/index.html">About the translation of the words "choice" / "choose" without choose / choice / select</a></li>
<li><a href="../en506442/index.html">Tick ‚Äã‚ÄãTuck</a></li>
<li><a href="../en506444/index.html">Future challenges</a></li>
<li><a href="../en506452/index.html">How to protect your public site with ESNI</a></li>
<li><a href="../en506454/index.html">For what a bim-manager gets 100 thousand and how to become one</a></li>
<li><a href="../en506456/index.html">We receive and analyze the radio signal of the payment terminal using SDR</a></li>
<li><a href="../en506460/index.html">Differences of the male brain from the female: women code better?</a></li>
<li><a href="../en506462/index.html">Pushpools and tachers - how I tested everything I found</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>