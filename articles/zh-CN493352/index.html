<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑 🤶🏽 🚎 全天候在YouTube上广播您的视频 👨🏾‍🔬 🚏 🤟🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最近，作为一种爱好，我正在拍摄一位熟悉的心理学家关于视频的讲座。我将这些镜头安装并发布在我的网站上。一个月前，我想到了在YouTube 24/7全天候组织这些讲座的广播。一种专门用于个人成长的主题“渠道”。
 
 我知道如何进行正常广播。但是，如何使其成为视频文件的广播呢？她走路24/7，灵活，尽可...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>全天候在YouTube上广播您的视频</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493352/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近，作为一种爱好，我正在拍摄一位熟悉的心理学家关于视频的讲座。我将这些镜头安装并发布在我的网站上。一个月前，我想到了在YouTube 24/7全天候组织这些讲座的广播。一种专门用于个人成长的主题“渠道”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我知道如何进行正常广播。但是，如何使其成为视频文件的广播呢？她走路24/7，灵活，尽可能地自主，并且同时不依赖于我的家用计算机。这就是我必须找出的。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/vn/5u/tivn5utlpr-vmldtf9dh5hh7fku.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
找到解决方案花了几天时间。我研究了很多论坛和各种手册，没有它们，我的广播根本不会出现。现在，当恶作剧成功时，我感到有必要分享我的决定。所以这篇文章出现了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
简而言之，最终的解决方案如下：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS + ffmeg + bash脚本</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在剪辑中，我描述了所采取的步骤，并讨论了广播期间发现的“陷阱”。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1步-广播从哪里来？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从一开始，就有必要确定将在哪里进行广播，在哪里进行广播。首先想到的是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一台家用计算机</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。将视频收集到播放列表中，然后在任何视频播放器中播放。然后捕获屏幕图像并将其广播到YouTube。但是我几乎立即放弃了这个选择。要实现它，您需要保持家用计算机一直处于打开状态，这就是即使在晚上冷却器发出的噪音，也会增加能耗（每月增加100-150 kWh）。事实证明，在广播期间您将无法使用家用计算机。鼠标的任何移动都将在广播中可见。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后我开始着眼于</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">云服务</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我一直在寻找一种现成的服务，您可以在其中上传视频，或者插入YouTube视频的链接，然后将它们打包成一个不间断的广播。但是我没有找到合适的东西。也许我看上去很糟。唯一适用于该功能的是restream.io，该服务有助于在多个平台上同时广播。他们似乎可以上传视频。但是创建此服务是出于完全不同的目的，他们希望广播只能持续几个小时。我认为，如果通过这项服务有可能组织一个全天候的广播，那么每月的费用将达到数十甚至数百美元。但是我仍然想免费或以最少的资金来组织广播。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很明显，您需要广播</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一台单独的设备</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甚至一台单独的计算机。正在思考Raspberri Pi之类的东西。那又怎样他没有冷却器。我将视频记录在USB闪存驱动器上，并插入了以太网电缆，然后将其放置在一个僻静的地方，即正在广播。选项。但是我既没有董事会本身，也没有经验，所以我也拒绝了这种选择。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我遇到了一个讨论，他们讨论了如何创建</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己的服务器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">广播。这不是我想要的，但我抓住了主要思想-您可以使用服务器！在讨论中，他们建议使用一堆VPS + Nginx + OBS。很明显，这群适合我。唯一让我感到困惑的是，我从未管理过服务器，而在我看来，我专用的服务器既混乱又昂贵。我决定找出以最低配置租用服务器要花多少钱，这让我感到惊喜。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mu/v8/ms/muv8msmvpgnhzj9z04nuhv_y0-s.jpeg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
价格在白俄罗斯卢布，只是面包屑。为了理解，8白俄罗斯卢布约合3.5美元或240俄罗斯卢布。使用功能强大的24/7并能快速访问Internet的成熟计算机，使用一个月。出于某种原因，这一发现对我来说非常高兴，几天来，我像一个发现太空火箭的孩子一样非常高兴地走着：) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一下，我利用了Google应要求提供给我的第一个网站“ VPS出租”的好处。也许还有更多的预算解决方案，但是这个价格适合我，因此我没有进一步寻找。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建服务器时，可以选择将在其下运行的操作系统。</font><font style="vertical-align: inherit;">在列出的任何系统上，您都可以组织广播并根据自己的喜好和财务能力做出选择（他们要求为装有Windows的服务器收取额外费用）。</font><font style="vertical-align: inherit;">我选择了CentOS。</font><font style="vertical-align: inherit;">只是因为我曾经和她有一点经验。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/0a/wh/cv0awhhxim1w2fgglkrlupl5hgc.jpeg" alt="图片"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2步-服务器设置</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建服务器后，您需要做的第一件事就是通过SSH连接到它。</font><font style="vertical-align: inherit;">最初，我使用PuTTy，但是后来我开始使用在Google Chrome上运行的Secure Shell App。</font><font style="vertical-align: inherit;">因此事实证明对我来说更方便。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，我更改了主机名，在服务器上设置了时间同步，更新了系统，弄乱了iptables ...并且做了很多事情，但这不是因为有必要。</font><font style="vertical-align: inherit;">设置服务器对我来说很有趣，并且对我有用。</font><font style="vertical-align: inherit;">事实证明，我很喜欢:) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是需要执行以下步骤：</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接EPEL存储库。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提升FTP服务器（我选择了vsftp）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装ffmpeg。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我不会提供团队的详细信息，这是一个概念性的说明，目的是传达总体行动计划。如果您对任何步骤有任何困难，可以通过搜索引擎中的查询（例如“ CentOS connect EPEL”或“ CentOS FTP服务器安装”）迅速解决。在第一个链接中，您可以找到详细的分步说明。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，正如我先前所写，我需要一堆VPS + nginx + OBS。 VPS-准备就绪。但是，关于其余几点，这里开始出现问题。 OBS是一种广播程序，即Open Broadcaster Software。它仅适用于线程，即例如，它从网络摄像头获取图像并进行广播。或屏幕录像。或已经正在进行的广播重定向到另一个站点。而且我没有流，我只有制作流所需的一组视频文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他开始朝这个方向挖掘，遇到了ffmpeg。</font><font style="vertical-align: inherit;">FFmpeg是一组免费的开放源代码库，可让您记录，转换和传输各种格式的数字音频和视频记录。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我非常惊讶ffmpeg可以做什么。</font><font style="vertical-align: inherit;">如果需要，它将声音从视频中拉出。</font><font style="vertical-align: inherit;">如果需要，它将切出视频片段而不进行转码。</font><font style="vertical-align: inherit;">如果需要，它将从一种格式转换为另一种格式。</font><font style="vertical-align: inherit;">还有更多。</font><font style="vertical-align: inherit;">您可以为他指定文件为止，他会将其转换为流，然后将其传输到YouTube。</font><font style="vertical-align: inherit;">一切，链条已组装。</font><font style="vertical-align: inherit;">它只是为了细化细微差别。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第3步-广播设置</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们在YouTube上创建广播。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此阶段，我们只需要一个链接和一个翻译密钥。</font><font style="vertical-align: inherit;">在下面的屏幕截图中，它们以红色突出显示。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gr/a3/oo/gra3oogooafzdfjzhlqdqjjxr8o.jpeg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将视频文件上传到</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们计划广播</font><b><font style="vertical-align: inherit;">的服务器</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">实际上，仅在此阶段需要FTP。</font><font style="vertical-align: inherit;">如果您还有另一种方便的方式将文件上传到服务器，则可以省去FTP服务器。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们流到YouTube。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要开始广播，必须运行具有多个属性的ffmpeg。</font><font style="vertical-align: inherit;">这是我得到的最短命令：</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性解密</font></font></b><div class="spoiler_text"><code>-re</code> – ,      .<br>
<br>
<code>-i</code> – ,    . ,       ,    -.       ,  <code>/usr/media/lecture1.mp4</code>.<br>
<br>
<code>-f</code> –    .    ,  ffmpeg « »     mp4  flv.<br>
<br>
    ,     YouTube     .. ,     ,   ,       .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您正确执行了所有操作，则在运行此命令后，YouTube将看到传输的流。</font><font style="vertical-align: inherit;">要开始广播，您只需单击YouTube本身中的“开始广播”按钮。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4步-添加自治</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
恭喜你！现在您知道了如何从视频文件开始广播。但这还不足以实现全天候广播。重要的是，在第一个视频播放完之后，下一个视频将立即开始播放，并在显示所有视频后，重新开始播放。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我想出了以下选项：创建一个.sh文件，在其中为每个视频文件注册一个命令，最后指示重新启动同一脚本的命令。事实证明是一种递归：</font></font><br>
<br>
<pre><code class="bash hljs"> 1... (   lecture1.mp4)<font></font>
 2... (   lecture2.mp4)<font></font>
 3... (   lecture3.mp4)<font></font>
bash start.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是的，它奏效了。我对自己感到满意，开始了一次测试播音，然后入睡。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
早晨，我等着一个不愉快的惊喜。原来，广播只进行了几分钟，当我关闭计算机时，广播几乎立即结束。调查显示，以这种方式启动的命令是在服务器上授权用户时执行的。断开连接后，我启动的命令的执行就会中断。为防止这种情况发生，</font></font><code>bash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需在团队</font><font style="vertical-align: inherit;">之前</font><font style="vertical-align: inherit;">添加团队即可</font></font><code>nohup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这将使正在运行的进程无论您是否在场都可以运行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
脚本的最终最低版本如下所示：</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
ffmpeg -re -i lecture2.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
ffmpeg -re -i lecture3.mp4 -f flv rtmp://a.rtmp.youtube.com/live2/%_%<font></font>
nohup bash start.sh $</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其中start.sh是编写此脚本的文件。</font><font style="vertical-align: inherit;">并且此文件应与视频文件位于同一目录中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在末尾添加美元符号可让您在后台启动该过程，以便您可以继续使用控制台而不会中断广播。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从奖金中发现了以下面包：</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以手动切换文件的播放。</font><font style="vertical-align: inherit;">为此，您需要“杀死”当前正在运行的ffmpeg进程。</font><font style="vertical-align: inherit;">之后，将自动开始播放列表中的下一个文件。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在不停止广播的情况下将新视频添加到广播中。</font><font style="vertical-align: inherit;">只需将视频上传到服务器，在脚本中添加运行该文件的命令，然后保存即可。</font><font style="vertical-align: inherit;">就是这样。</font><font style="vertical-align: inherit;">在下一轮播放中，新文件将与旧文件一起广播。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5步-配置ffmpeg</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就此而言，原则上可以停止。但是我想让广播对观众更加友好。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
假设某人去广播，开始观看，他喜欢它，并且想从一开始就观看此演讲，而广播不包括倒带。要从一开始就观看讲座，一个人将需要访问我的网站并获取感兴趣的讲座的记录。以及如何理解他感兴趣的讲座？该站点有16堂讲座，而且每周只有一次。我认为，即使是我拍摄并编辑了所有这些讲座的我，也无法从随机片段中确定哪个讲座。因此，有必要指定每个讲座。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在编辑程序中将字幕添加到源视频文件的选项不适合我。</font><font style="vertical-align: inherit;">有必要确保使用原始文件。</font><font style="vertical-align: inherit;">为了支持我要求的广播，请尽可能少地移动身体。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明ffmpeg也可以帮助我。</font><font style="vertical-align: inherit;">它具有特殊的属性</font></font><code>-vf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，可让您在视频上方添加文字。</font><font style="vertical-align: inherit;">要将文本添加到视频，您需要在命令中添加以下片段：</font></font><br>
<br>
<pre><code class="bash hljs">-vf drawtext=<span class="hljs-string">"fontfile=OpenSans.ttf:text=' 13\:  .   ?':fontsize=26:fontcolor=white:borderw=1:bordercolor=black:x=40:y=670"</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数解码</font></font></b><div class="spoiler_text"><code>fontfile=</code> –    .       .          .        .<br>
<br>
<code>text=</code> – ,  ,     .<br>
<br>
<code>fontsize=</code> –    .<br>
<br>
<code>fontcolor=</code> –  .<br>
<br>
<code>borderw=</code> –       (         1 ).<br>
<br>
<code>bordercolor=</code> –  .<br>
<br>
<code>x=</code>  <code>y=</code> –  .  <code>0;0</code>     .      ,           1280720 .<br>
</div></div><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来像这样：</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/jf/1n/sh/jf1nshia1hbk30-pjd5y6mztga0.jpeg" alt="图片"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">步骤6-确定广播质量</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一切就绪，广播已准备就绪。 FFmpeg广播，播放文件，广播不需要我的在场。甚至每堂课都签名。看起来就是这样。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是另一个细微差别浮出水面-我选择了最低服务器配置，但它并没有阻止广播。服务器配置：1核（例如2.2 GHz），1 GB RAM，25 GB SSD。有足够的RAM，但是处理器几乎完全加载了100％的负载（有时甚至达到102-103％的负载）：这导致广播每隔几秒钟冻结一次。丑陋。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可能只需要具有两个内核的更昂贵的配置，好处是使用云技术时，只需按几个按钮即可更改服务器配置。</font><font style="vertical-align: inherit;">但是我想适应最小配置的功能。</font><font style="vertical-align: inherit;">我开始研究ffmpeg文档，是的，那里还有设置可让您调整系统负载。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以通过两种方式实现高图像质量：高处理器负载或大量外向流量。</font><font style="vertical-align: inherit;">事实证明，处理器承担的负载越多，通道所需的带宽就越少。</font><font style="vertical-align: inherit;">否则，您将无法负担沉重的处理器负载，但是您将需要一个带宽较大，流量较大的通道。</font><font style="vertical-align: inherit;">如果处理器和传出通道/流量的大小都有限制，那么您将不得不降低图像质量，以便广播顺利进行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的服务器有一个10 Mbps的通道。此宽度是直的，有边距。但是有流量限制-每月1 TB。因此，为了满足流量限制，我的输出流不应超过每秒300 Kb，即输出流的比特率应不超过2.5 Mbps。顺便说一下，YouTube只建议以这样的比特率广播。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ffmpeg使用不同的方法来调节系统上的负载。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写得很好</font><font style="vertical-align: inherit;">。我最终使用了两个属性：</font></font><code>-crf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>-preset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恒定速率因子（CRF）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-这是一个系数，您可以据此调整图像质量。</font><font style="vertical-align: inherit;">CRF的范围是0到51，其中0是源文件的质量，51是可能的最差质量。</font><font style="vertical-align: inherit;">建议使用从17到28的值，默认值为23.比率为17时，视频在视觉上与原始视频相同，但从技术上讲不是这样。</font><font style="vertical-align: inherit;">该文档还指出，取决于指定的CRF，最终视频的大小呈指数变化，即 </font><font style="vertical-align: inherit;">将系数增加6点将使输出视频的比特率翻倍。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果使用CRF，则可以选择输出图像的“权重”，然后使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预设（-preset）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，可以确定要加载多少处理器。</font><font style="vertical-align: inherit;">此属性的参数如下：</font></font><br>
<br>
<ul>
<li><code>ultrafast</code></li>
<li><code>superfast</code></li>
<li><code>veryfast</code></li>
<li><code>faster</code></li>
<li><code>fast</code></li>
<li><code>medium</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 默认值</font></font></li>
<li><code>slow</code></li>
<li><code>slower</code></li>
<li><code>veryslow</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指定的参数“越快”，处理器的负载就越高。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我首先选择了对我的处理器来说基本上“艰难”的预设，然后使用CRF对其负载进行了更精细的调整。</font><font style="vertical-align: inherit;">在我的情况下，预设出现了</font></font><code>fast</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，对于crf，我将值定为24。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就这样。</font><font style="vertical-align: inherit;">开始广播的最后命令是：</font></font><br>
<br>
<pre><code class="bash hljs">ffmpeg -re -i lecture1.mp4 -vf drawtext=<span class="hljs-string">"fontfile=OpenSans.ttf:text=' 1\:   ':fontsize=26:fontcolor=white:borderw=1:bordercolor=black:x=40:y=670"</span> -c:v libx264 -preset fast -crf 24 -g 3 -f flv rtmp://a.rtmp.youtube.com/live2/%_%</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里只有两个未描述的时刻：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1）</font></font><code>-c:v libx264</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-用于处理源文件的特定编解码器的指示。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）</font></font><code>-g 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-关键帧数量的明确指示。在这种情况下，表明每三帧应该是关键帧。标准值为5或8，但YouTube发誓，至少要问3。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">在这里</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
可以看到广播的质量是多少</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">服务器负载如下：</font></b><font style="vertical-align: inherit;"> 
根据监视数据，很明显，处理器负载在70％到95％之间变化，并且广播从未在一周内稳定在100％。因此，使用这些设置，处理器就足够了。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br>
<img src="https://habrastorage.org/webt/b5/3s/za/b53szauaywx3bdwoic-yebil1es.jpeg" alt="图片"><br>
<br>
<img src="https://habrastorage.org/webt/cq/jc/t4/cqjct4xhbz3zabriimgydbxvjaq.jpeg" alt="图片"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
加载磁盘时，我可以说几乎没有加载磁盘，常规的HDD应该足以进行广播。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是大量的外出流量困扰着我。事实证明，我的传出流范围为每秒450至650 KB。一个月的时间将约为1.8 TB。您可能必须购买流量或仍切换到双核配置，因为我不想降低图片质量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*** </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我要说的是，从头开始设置这样的广播大约需要1-2个小时。此外，大部分时间需要将视频上传到服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作为一种营销工具，这种广播的启动并未获得回报。也许，如果您结束观看，以便YouTube的算法选择此广播并在建议中积极展示，那么可能会有所帮助。以我为例，连续播放16天，已观看了58次。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那没问题。广播和谐地适合我网站的主页。事实证明，这是一种机会，可以使您快速确定讲师和讲座本身。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一会儿。广播不要侵犯任何人的版权，这一点很重要，否则它将被阻止。我很高兴自己的广播。我特别选择了免费使用的音乐插入物，内容的作者坐在附近的计算机上，使用该内容并不反对我:)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果您在背景中某处的背景中播放广播，或者在编辑过程中使用了自己喜欢的曲目，或者从流行音乐视频，系列或电影中拍摄了视频，那么广播的风险就很大。</font><font style="vertical-align: inherit;">同样重要的是，广播至少要承载最小的语义负载，否则可能会被视为垃圾邮件而被阻止。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*** </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是我的全部。</font><font style="vertical-align: inherit;">我希望本手册对某人有帮助。</font><font style="vertical-align: inherit;">好吧，如果您要添加一些内容-写，我会很乐意阅读本文的补充说明。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN493336/index.html">计算机科学中心如何翻译在线学习</a></li>
<li><a href="../zh-CN493340/index.html">使SIL功能在Jira中的版本之间可移植</a></li>
<li><a href="../zh-CN493342/index.html">NSPK如何为过渡到udalenka的基础设施做准备</a></li>
<li><a href="../zh-CN493346/index.html">我们设法将办公室转移到udalenka，您呢？</a></li>
<li><a href="../zh-CN493348/index.html">再次使“ udalenka”变得出色：如何通过四个阶段将整个公司转移到远程工作</a></li>
<li><a href="../zh-CN493356/index.html">视频@Databases聚会：DBMS安全性，物联网中的Tarantool，用于大数据分析的Greenplum</a></li>
<li><a href="../zh-CN493360/index.html">来自Algol的两个手指</a></li>
<li><a href="../zh-CN493362/index.html">技术支持“放在手提箱上”。我们如何在没有不必要的紧张的情况下进行远程工作并远程获得我们需要的服务</a></li>
<li><a href="../zh-CN493366/index.html">什么是Windows PowerShell？它吃什么？第3部分：将参数传递给脚本和函数，创建cmdlet</a></li>
<li><a href="../zh-CN493374/index.html">冠状病毒-实用技巧和理论知识</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>