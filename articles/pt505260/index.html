<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíï üåã üë©üèø‚Äç‚öñÔ∏è Medindo o atraso do teclado ao f√≥ton usando um sensor √≥ptico üôÖüèø üò¥ üèÇüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Para medir o tempo de resposta ou a lat√™ncia em computadores e interfaces, h√° muito tempo uso o aplicativo Is It Snappy com uma c√¢mera de alta velocid...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Medindo o atraso do teclado ao f√≥ton usando um sensor √≥ptico</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505260/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para medir o tempo de resposta ou a lat√™ncia em computadores e interfaces, h√° muito tempo uso o aplicativo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is It Snappy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com uma c√¢mera de alta velocidade do iPhone para contar quadros entre um pressionamento de tecla e uma altera√ß√£o na tela. No entanto, o problema √© determinar os quadros exatos para cronometrar a olho nu, o que √© irritante ao realizar muitos testes. Tamb√©m dificulta medir a variabilidade dos resultados. Eu j√° simplifiquei esses testes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adicionando um modo ao firmware do teclado que muda a cor do LED ap√≥s o envio do evento via USB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas isso apenas aumenta ligeiramente a velocidade e a precis√£o. Eu gostaria de algo melhor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o eu segui os passos do meu amigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rafa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e criou um testador de atraso de hardware, que envia eventos do teclado e, com a ajuda de um sensor √≥ptico, mede o tempo necess√°rio para alterar a tela! </font><font style="vertical-align: inherit;">Foi bastante f√°cil e, neste artigo, falarei sobre alguns dos resultados, bem como as dificuldades dos testes de atraso de alta qualidade e como fazer seu pr√≥prio testador.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu testador √© baseado em um sensor de luz com a Amazon. </font><font style="vertical-align: inherit;">Ele √© montado em um trip√© ajust√°vel conectado ao microcontrolador </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teensy LC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que pressiona 'a' e aguarda a altera√ß√£o do n√≠vel de luz, apaga a letra e continua a coletar amostras enquanto pressiona o bot√£o. </font><font style="vertical-align: inherit;">Com um breve toque de um bot√£o, ele exibe um belo histograma do atraso, que se parece com isso:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lat i = 60,3 +/- 9,3, a = 60, d = 59 (n = 65, q = 41) | </font><font style="vertical-align: inherit;">239_</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta linha mostra o atraso m√©dio das inser√ß√µes ( </font></font><code>i=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), exclus√µes ( </font></font><code>d=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e seus combinados ( </font></font><code>a=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), desvio padr√£o do tempo de inser√ß√£o ( </font></font><code>+/-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), o n√∫mero de medi√ß√µes ( </font></font><code>n=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e qualidade ( </font></font><code>q=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), bem como um pequeno ascii-histograma, em que cada s√≠mbolo representa um fragmento (intervalo ) em 10 ms, e os n√∫meros de 1 a 9 representam proporcionalmente o tamanho desse dep√≥sito. O s√≠mbolo </font></font><code>_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">significa um balde com pelo menos uma amostra, mas n√£o √© suficiente encher um nono balde; portanto, este √© um atraso com um pequeno n√∫mero de amostras aleat√≥rias. Veja como √© (nos monitores fotogr√°ficos estavam no modo retrato, mas todos os testes foram feitos no modo paisagem): </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/415/1f5/016/4151f5016c68014682c8e09eac08b240.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tamb√©m fiz isso para que pressionar o bot√£o novamente exibisse todos os resultados da medi√ß√£o, por exemplo,</font></font><code>[35, 35, 33, 44]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para que voc√™ possa gerar um gr√°fico:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/326/7b9/7ef/3267b97ef54e907c5d656dd0b7ae75d2.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitorar o tempo de resposta</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßarei com meu conjunto de resultados favorito:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto sublime, macOS, modo de tela cheia sem distra√ß√µes em dois monitores de 4k:</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 35,3 +/- 4,7, a = 36, d = 36 (n = 67, q = 99) | </font><font style="vertical-align: inherit;">193 </font><font style="vertical-align: inherit;">Dell P2415Q top</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 52,9 +/- 5,0, a = 53, d = 54 (n = 66, q = 45) | </font><font style="vertical-align: inherit;">_391 </font><font style="vertical-align: inherit;">Dell P2415Q inferior</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 65,1 +/- 5,0, a = 64, d = 63 (n = 109, q = 111) | </font><font style="vertical-align: inherit;">_292 </font><font style="vertical-align: inherit;">HP Z27 top</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 79,7 +/- 5,0, a = 80, d = 80 (n = 98, q = 114) | </font><font style="vertical-align: inherit;">89_ </font><font style="vertical-align: inherit;">HP Z27 inferior</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° algo para ver aqui:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de tudo, gosto que o formato de linha √∫nica de um histograma de largura fixa permita colocar todos os resultados lado a lado em um arquivo de texto e sinaliz√°-los para compara√ß√£o.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vemos a diferen√ßa esperada de 16 ms entre o tempo de resposta na parte superior e inferior da tela devido ao tempo de varredura das linhas para quadros a 60 Hz.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O desvio padr√£o n√£o √© muito diferente de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,6 ms</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de uma distribui√ß√£o uniforme de resultados com um tempo de atualiza√ß√£o de tela de 16 ms.</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O HP Z27 possui um tempo de resposta de aproximadamente 30 ms a mais que o Dell P2415Q! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E essa medida √© at√© o in√≠cio da exibi√ß√£o do s√≠mbolo. </font><font style="vertical-align: inherit;">Tenho certeza de que a tela cheia tamb√©m leva mais tempo no Z27. </font><font style="vertical-align: inherit;">Ou seja, no Z27 no editor Sublime, quase metade do atraso inteiro √© um atraso extra do monitor!</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as medidas no restante deste artigo foram feitas no meu Dell P2415Q. </font><font style="vertical-align: inherit;">Ambos os monitores t√™m um tempo de resposta "r√°pido", o Z27 possui uma configura√ß√£o de tempo de resposta ainda mais r√°pida, mas afeta apenas o tempo de transi√ß√£o do in√≠cio ao fim (tempo de transi√ß√£o) e introduz trilhas fantasmas feias, n√£o ajudando a reduzir o atraso inicial.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dificuldades de medi√ß√£o</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na maioria dos m√©todos conhecidos, medir a qualidade do atraso √© realmente mais dif√≠cil do que voc√™ pensa. </font><font style="vertical-align: inherit;">Para obter resultados realistas, esforcei-me mais do que a maioria dos experimentadores, mas tudo falhou pelas primeiras vezes, ent√£o tive que corrigir os erros.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medi√ß√£o de atraso de ponta a ponta real</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O principal motivo para usar um testador de hardware √© que existem muitos m√©todos incompletos e falsos para medir o atraso de ponta a ponta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existe um artigo bem conhecido e realmente excelente chamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Imprimimos com prazer"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com boa an√°lise e belos gr√°ficos. Ele compara o atraso de v√°rios editores de texto em diferentes sistemas operacionais. Mas o autor implementou medi√ß√µes simulando eventos de entrada e raspagem de tela usando APIs do sistema. Eu pr√≥prio n√£o fiz medi√ß√µes repetidas, portanto n√£o posso apontar nada especificamente errado, mas h√° muitos problemas em potencial com essa abordagem. Por exemplo, verificar o buffer de tela na CPU pode penalizar injustificadamente os aplicativos que s√£o renderizados na GPU, devido √†s c√≥pias do buffer da janela em alguns casos em que a captura pode funcionar. A simula√ß√£o da entrada pode ser diferente das teclas reais. Apesar disso, mesmo no caso de medi√ß√µes de alta qualidade e resultados objetivos (e n√£o podemos ter certeza disso sem verific√°-los no teste final),esses resultados n√£o informam o tempo total de resposta do in√≠cio ao fim, o que √© importante para uma experi√™ncia real.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polling USB de 1000 Hz</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das fontes de atraso que os usu√°rios experimentam, mas que meu testador n√£o mede, √© a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lat√™ncia do teclado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Muitos teclados podem dobrar o tempo de resposta que eu medi ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como o teclado anterior</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) devido a intervalos de pesquisa USB de 8 milissegundos, velocidade lenta de digitaliza√ß√£o da grade do teclado, firmware lento e design mec√¢nico controverso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar um testador de atraso com baixa dispers√£o para emular o teclado, voc√™ n√£o pode simplesmente usar qualquer microcontrolador - geralmente h√° uma pesquisa padr√£o com uma frequ√™ncia de 125 Hz. </font><font style="vertical-align: inherit;">Meu microcontrolador </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teensy LC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um dos poucos que usa 1000 Hz por padr√£o.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Garantindo um bom n√≠vel de sinal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No come√ßo, quando projetei meu testador para o tempo de resposta, n√£o medi a for√ßa do sinal. No final, fiquei confuso: na mesma aplica√ß√£o, na mesma tela em cen√°rios ligeiramente diferentes, foram obtidos resultados completamente diferentes. Fiz alguns testes e descobri que, √†s vezes, o sinal √© muito fraco em fontes pequenas com posicionamento inadequado dos sensores, portanto o sensor funciona apenas no final da sa√≠da do s√≠mbolo, embora deva funcionar no in√≠cio (essa √© a sua pr√≥pria escolha subjetiva dif√≠cil).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu sabia que o motivo deveria ser o tempo de uma transi√ß√£o completa do come√ßo ao fim da tela, porque mesmo antes de escrever o firmware, eu brincava com uma pesquisa simples do sensor √≥ptico a cada milissegundo, usando a plotadora Arduino para produzir os resultados. Basta digitar e excluir caracteres para observar o sinal. Voc√™ pode notar que em algumas combina√ß√µes do sensor √≥ptico e do monitor, a transi√ß√£o completa leva quase 100 ms. Mas a grava√ß√£o de v√≠deo com o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is It Snappy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√° a impress√£o de que a transi√ß√£o completa no monitor Z27 leva apenas cerca de 20 ms. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d32/500/02b/d3250002bac009103ed40a5c47cb56bc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para corre√ß√£o, adicionei uma medi√ß√£o da intensidade do sinal de pico a pico ap√≥s uma transi√ß√£o completa para verificar se obtive uma resolu√ß√£o de medi√ß√£o adequada para o meu limite em cinco etapas at√© o in√≠cio da transi√ß√£o. Este √© o n√∫mero que voc√™ v√™ depois</font></font><code>q=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como se viu, √© muito importante definir um tamanho de fonte grande e alto brilho da tela.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forte dispers√£o de pequenas diferen√ßas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â poss√≠vel que diferen√ßas aparentemente insignificantes no objeto de medi√ß√£o levem a s√©rias diferen√ßas de atraso. Por exemplo, eu queria ver se h√° uma diferen√ßa significativa entre o tempo de resposta do Sublime e do VSCode ao selecionar texto em um arquivo pequeno comparado a um arquivo grande com uma gram√°tica de sele√ß√£o complexa e um pop-up de preenchimento autom√°tico. Claro, h√° uma diferen√ßa. Mas quando notei alguma varia√ß√£o nos valores, executei mais alguns testes e descobri que o tempo de resposta √© muito diferente entre inserir 'a' em uma linha vazia e inserir 'a' ap√≥s o anterior 'a' ('aa'). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√£o os resultados da cria√ß√£o de uma nova linha ap√≥s a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3469¬™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> linha no arquivo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">parser.rs</font></a><font style="vertical-align: inherit;"> grande </font><font style="vertical-align: inherit;">com 6199 linhas. Todos os resultados s√£o obtidos ap√≥s um posicionamento semelhante do sensor mais pr√≥ximo da parte inferior do monitor da Dell.</font></font><br>
<br>
<pre>lat i= 40.2 +/-   4.1, a= 40, d= 39 (n= 38,q= 90) |  _89           | sublime small .txt<font></font>
<font></font>
lat i= 41.2 +/-   6.9, a= 41, d= 42 (n= 54,q= 92) |   992          | sublime aa parser.rs<font></font>
lat i= 43.6 +/-   6.1, a= 43, d= 42 (n= 48,q=100) |   492          |<font></font>
lat i= 52.2 +/-   6.0, a= 52, d= 52 (n= 26,q=100) |    49          |<font></font>
lat i= 44.3 +/-   5.6, a= 43, d= 42 (n= 45,q=100) |   391          |<font></font>
lat i= 42.7 +/-   7.6, a= 42, d= 42 (n= 46,q=100) |  _491          |<font></font>
<font></font>
lat i= 48.1 +/-   6.8, a= 49, d= 50 (n= 43,q= 89) |   269          | sublime a parser.rs<font></font>
lat i= 43.9 +/-   5.4, a= 48, d= 52 (n= 32,q= 97) |   197          |<font></font>
lat i= 47.8 +/-   8.4, a= 49, d= 49 (n= 29,q= 97) |   197_         |<font></font>
lat i= 46.1 +/-   6.8, a= 47, d= 49 (n= 42,q= 97) |   196_         |<font></font>
<font></font>
lat i= 63.3 +/-   9.3, a= 63, d= 62 (n= 68,q=118) |    _963__      | vscode aa parser.rs<font></font>
lat i= 63.6 +/-   7.6, a= 64, d= 65 (n= 71,q=139) |    _49__     _ |<font></font>
lat i= 62.3 +/-   6.3, a= 61, d= 59 (n= 52,q=132) |    _791        |<font></font>
lat i= 62.0 +/-   5.8, a= 61, d= 60 (n= 40,q=111) |    _49_        |<font></font>
lat i= 61.9 +/-   9.7, a= 62, d= 61 (n= 35,q=111) |     981_       |<font></font>
<font></font>
lat i= 53.1 +/-   7.7, a= 51, d= 49 (n= 54,q=116) |   _79__        | vscode a parser.rs<font></font>
lat i= 52.2 +/-   6.3, a= 52, d= 51 (n= 41,q=133) |    692         |<font></font>
lat i= 53.2 +/-   7.8, a= 52, d= 52 (n= 57,q=134) |    591_        |<font></font>
lat i= 52.1 +/-   7.1, a= 52, d= 52 (n= 55,q=134) |    591_        |</pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tirei muitas medidas em momentos diferentes e com pequenas varia√ß√µes para confirmar o efeito. Como voc√™ pode ver, existem algumas diferen√ßas entre as dimens√µes no mesmo cen√°rio, mas h√° muito mais varia√ß√µes entre simplesmente inserir 'a' e adicionar 'a' ap√≥s o existente 'a'. Observe a coluna </font></font><code>a=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que inclui os resultados de inser√ß√£o e exclus√£o, para que haja menos ru√≠do. Sublime insere o segundo caractere na sequ√™ncia 'aa' mais rapidamente que o primeiro e VSCode vice-versa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos dois editores, 'aa' faz com que a janela pop-up de preenchimento autom√°tico apare√ßa e desapare√ßa para selecionar uma op√ß√£o entre as duas listas e as letras 'a'. </font><font style="vertical-align: inherit;">Posso assumir que o Sublime √© mais lento no caso de 'a', porque abrir e fechar a janela de preenchimento autom√°tico pop-up leva algum tempo, mas n√£o tenho uma vers√£o clara do porqu√™ do VSCode ser mais lento no caso de 'aa' durante a inser√ß√£o e a exclus√£o.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rassynchron com atualiza√ß√£o de tela</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o notei que os desvios padr√£o eram suspeitosamente baixos. √Äs vezes, o desvio padr√£o foi de 1 ms, embora logicamente deva exceder 4,6 ms devido a intervalos de atualiza√ß√£o da tela de 16 ms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Olhei para o meu c√≥digo e percebi que as medidas eram sincronizadas acidentalmente com as atualiza√ß√µes da tela. Ap√≥s cada medi√ß√£o, o firmware aguardou exatamente 300 ms antes de digitar 'a' novamente ou excluir o caractere e fazer a pr√≥xima medi√ß√£o. Isso significa que os dados de entrada sempre foram enviados aproximadamente 300 ms ap√≥s a atualiza√ß√£o da tela, caindo de maneira est√°vel no mesmo intervalo de atualiza√ß√£o. Corrigi esse problema adicionando um atraso aleat√≥rio de 50 ms entre as medi√ß√µes, um tremor t√£o peculiar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basicamente, esse erro causava desvios muito baixos, mas poderia levar a valores m√©dios incorretos se o aplicativo ignorasse o prazo para renderiza√ß√£o quando o evento de entrada chegasse ao final do quadro. </font><font style="vertical-align: inherit;">Descobri isso durante o teste deste artigo e n√£o consegui mais repetir todos os testes anteriores; portanto, em alguns lugares, voc√™ pode observar alguns valores de desvio baixo. </font><font style="vertical-align: inherit;">Mas verifiquei novamente as m√©dias para testes importantes como Sublime e VSCode.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Editores de texto</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testei o tempo de resposta de v√°rios editores de texto no mesmo arquivo de texto sem formata√ß√£o. </font><font style="vertical-align: inherit;">Mas, como observei acima, os testes foram feitos antes da implementa√ß√£o do rassinhron com a atualiza√ß√£o da tela por tremula√ß√£o. </font><font style="vertical-align: inherit;">Testes repetidos foram realizados apenas para Sublime e VSCode.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lat i = 32,5 +/- 4,0, a = 34, d = 35 (n = 38, q = 78) | </font><font style="vertical-align: inherit;">9_ </font><font style="vertical-align: inherit;">texto sublime</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 33,4 +/- 1,4, a = 33, d = 33 (n = 68, q = 23) | </font><font style="vertical-align: inherit;">_9 </font><font style="vertical-align: inherit;">textedit</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 47,6 +/- 7,0, a = 47, d = 47 (n = 71, q = 130) | </font><font style="vertical-align: inherit;">219 </font><font style="vertical-align: inherit;">vscode</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 34,2 +/- 3,5, a = 34, d = 33 (n = 57, q = 37) | </font><font style="vertical-align: inherit;">9 _ | </font><font style="vertical-align: inherit;">entrada html chrome</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 33,2 +/- 1,1, a = 33, d = 33 (n = 55, q = 30) | </font><font style="vertical-align: inherit;">9 </font><font style="vertical-align: inherit;">estoque mac emacs</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 45,6 +/- 7,0, a = 43, d = 41 (n = 35, q = 56) | </font><font style="vertical-align: inherit;">992_ </font><font style="vertical-align: inherit;">√°tomo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 35,0 +/- 4,7, a = 35, d = 35 (n = 66, q = 11) | </font><font style="vertical-align: inherit;">9__ </font><font style="vertical-align: inherit;">XI</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dada a falta de tremula√ß√£o, com base nesses resultados, eu diria que todos os editores, exceto VSCode e Atom, funcionam igualmente bem. </font><font style="vertical-align: inherit;">E mesmo para esses dois, com digita√ß√£o normal, uma penalidade menor pelo tempo de resposta do que o habitual para um monitor ou teclado.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terminais</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m medi o atraso em diferentes terminais. </font><font style="vertical-align: inherit;">O terminal e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kitty da</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apple parecem ter </font><font style="vertical-align: inherit;">tempos de resposta ideais, enquanto o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iTerm2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alacritty</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parecem um pouco piores.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lat i = 53,1 +/- 6,6, a = 54, d = 55 (n = 53, q = 59) | </font><font style="vertical-align: inherit;">291 _ | </font><font style="vertical-align: inherit;">iterm2 gpu render</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 50,5 +/- 2,5, a = 50, d = 50 (n = 56, q = 59) | </font><font style="vertical-align: inherit;">19_ </font><font style="vertical-align: inherit;">iterm2 no gpu</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 35,8 +/- 7,0, a = 34, d = 33 (n = 73, q = 48) | </font><font style="vertical-align: inherit;">9___ </font><font style="vertical-align: inherit;">terminal de ma√ß√£</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 35,1 +/- 2,5, a = 34, d = 32 (n = 35, q = 52) | </font><font style="vertical-align: inherit;">9_ </font><font style="vertical-align: inherit;">terminal de ma√ß√£ vim</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 50,4 +/- 3,9, a = 50, d = 49 (n = 60, q = 269) | </font><font style="vertical-align: inherit;">_59 </font><font style="vertical-align: inherit;">sinceridade</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lat i = 36,1 +/- 5,6, a = 35, d = 34 (n = 78, q = 199) | </font><font style="vertical-align: inherit;">9__ </font><font style="vertical-align: inherit;">gatinha</font></font></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como fazer isso</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° a lista de pe√ßas que usei:</font></font><br>
<br>
<ul>
<li><b>$12</b>: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Teensy LC</a>     Teensy&nbsp;3+.   Arduino,  USB- Teensy     1000&nbsp; ( 1 ),      USB-      125&nbsp; ( 8&nbsp;     ). ,      1000&nbsp;.     ,     ,  Teensy&nbsp;3  .<br>
</li>
<li><b>$12</b>: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">  </a> (Amazon     ,    ).    ,           .<br>
</li>
<li><b>$13</b>: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a>         .<br>
</li>
<li>- /   <br>
</li>
<li>    , Teensy  <br>
</li>
<li>    ,     <br>
</li>
<li> USB micro-B   Teensy  </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O dispositivo pode ser montado de v√°rias maneiras. A conclus√£o √© que voc√™ s√≥ precisa conectar os tr√™s fios (3V, terra, sa√≠da anal√≥gica) do m√≥dulo do sensor √≥ptico aos pinos Teensy correspondentes (3V, terra e qualquer pino anal√≥gico). A maneira mais f√°cil de fazer isso, que nem sequer exige solda, se voc√™ comprou o Teensy com pinos pr√©-soldados, √© conectar tr√™s </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fios com jumpers m√£e-m√£e</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ent√£o voc√™ s√≥ precisa de algum tipo de op√ß√£o para executar o teste. Aqui, um pino no Teensy se conecta ao terra e o outro ao pino de E / S digital. Se voc√™ √© realmente pregui√ßoso, basta um toque de dois fios!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para garantir que o m√≥dulo do sensor √≥ptico veja apenas uma √°rea limitada da tela, envolvi-o em um pequeno cilindro de fita isolante - e cortei cuidadosamente a extremidade com uma tesoura. Acabou uma pequena janela redonda, que pode ser pressionada na tela com um trip√© para minimizar o ru√≠do externo e obter o sinal mais limpo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu j√° fiz uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caixa de pedal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com um Teensy LC e uma pequena placa interna, e ele tinha um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conector TRRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adicional na lateral </font><font style="vertical-align: inherit;">, que eu instalei especialmente, esperando por um projeto semelhante no futuro, onde ser√° necess√°rio. Portanto, restava soldar o sensor √≥ptico no cabo TRRS. Ent√£o voc√™ pode usar um dos meus pedais para controlar os testes!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tive sorte com a soldagem, porque em um projeto acabei de comprar canetas magn√©ticas, que tamb√©m podem ser usadas no processo de soldagem. Infelizmente, na verdade, n√£o tenho muitos peda√ßos grandes de metal nos quais possam ser presos, ent√£o, no final, peguei uma frigideira de ferro fundido para soldar e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meu cubo de tungst√™nio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para opera√ß√µes sobre a mesa </font><font style="vertical-align: inherit;">(verificou-se que era um pouco magnetizado).</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccf/ae5/836/ccfae58364a964a71628451dcb1e9feb.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sugiro que voc√™ mostre sua imagina√ß√£o e fa√ßa algo mais interessante do que apenas pendurar os fios de conex√£o. Para o meu pedal, comprei uma caixa de pl√°stico em uma loja de eletr√¥nicos local, fiz alguns furos nas laterais, inseri tomadas de √°udio e coloquei uma pequena placa de ensaio para reconfigurar as conex√µes. A Amazon possui toneladas de pedais para m√°quinas de tatuagem e pianos el√©tricos com tomadas de telefone de 1/4 ‚Äù, voc√™ pode escolher. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√£o os</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meus favoritos para o sil√™ncio e sensa√ß√µes t√°teis. Mas existem op√ß√µes mais baratas que podem n√£o ser confi√°veis, dif√≠ceis de pressionar ou desagrad√°veis ‚Äã‚Äãpara fazer barulho.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu n√£o recomendaria o uso do soquete TRRS para o m√≥dulo do sensor no meu exemplo. </font><font style="vertical-align: inherit;">Embora seja bom e compacto e haja muitos cabos dispon√≠veis, mais tarde ocorreu que, por causa disso, muitas conex√µes ficam em curto ao conectar e desconectar a energia. </font><font style="vertical-align: inherit;">Tentei minimizar isso separando a energia e o aterramento nas extremidades opostas da placa, mas aconselho que voc√™ pegue um cabo de algum tipo melhor, talvez um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telefone</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3d5/fce/cfd/3d5fcecfdc63a4901b487091142a09c1.jpg"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para determinar o in√≠cio e o final da sa√≠da do personagem na tela, n√£o tenho o firmware mais sofisticado, mas passei algum tempo configurando-o para funcionar bem e adicionando v√°rias fun√ß√µes, por isso recomendo come√ßar com ele. </font><font style="vertical-align: inherit;">Instale o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teensyduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e fa√ßa o download do meu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esbo√ßo do Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que funciona para o pedal - mas voc√™ pode comentar fragmentos desnecess√°rios e configur√°-lo para usar os contatos certos. </font><font style="vertical-align: inherit;">Depois, tudo √© simples - um toque longo no bot√£o inicia a medi√ß√£o e um toque breve exibe os resultados!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt505246/index.html">Produzimos a primeira parcela com o Upwork</a></li>
<li><a href="../pt505252/index.html">Projeto Avokado</a></li>
<li><a href="../pt505254/index.html">A√ß√∫car de cobra ou escreva seu intervalo em JavaScript</a></li>
<li><a href="../pt505256/index.html">Lan√ßamento bem sucedido. 39 desde o in√≠cio do ano. 14¬∫ dos EUA. Starlink SpaceX Satellites</a></li>
<li><a href="../pt505258/index.html">Odontologia: expectativa e realidade</a></li>
<li><a href="../pt505264/index.html">Como eu escrevi o analisador html em php, e o que veio dele. Parte um</a></li>
<li><a href="../pt505268/index.html">Experi√™ncia pessoal: do desenvolvedor front-end ao l√≠der</a></li>
<li><a href="../pt505274/index.html">Pecados mortais de seguran√ßa do site: o que aprendemos com as estat√≠sticas do scanner de vulnerabilidades do ano</a></li>
<li><a href="../pt505276/index.html">Como ensinamos o ABBYY FineReader PDF a editar par√°grafos inteiros</a></li>
<li><a href="../pt505278/index.html">39 abrevia√ß√µes em ingl√™s para comerciantes iniciantes e seoshnikov</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>