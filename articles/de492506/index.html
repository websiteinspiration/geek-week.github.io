<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😜 🚅 👩‍👩‍👦‍👦 3 Möglichkeiten, große Listen in Angular zu rendern 🤾🏻 🏓 👩🏽‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Jahr 2020 wurden Front-End-Frameworks besser, effizienter und schneller. Aber selbst in diesem Sinne kann das Rendern großer Listen ohne „Einfriere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>3 Möglichkeiten, große Listen in Angular zu rendern</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/492506/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Jahr 2020 wurden Front-End-Frameworks besser, effizienter und schneller. Aber selbst in diesem Sinne kann das Rendern großer Listen ohne „Einfrieren“ des Browsers selbst für die schnellsten vorhandenen Frameworks eine entmutigende Aufgabe sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist einer der Fälle, in denen "das Framework schnell und der Code langsam ist". </font><font style="vertical-align: inherit;">
Es gibt viele Ansätze, mit denen Sie eine große Anzahl von Elementen anzeigen können, ohne die Benutzerinteraktion mit der Webseite zu blockieren. </font><font style="vertical-align: inherit;">
Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, möchte die vorhandenen Methoden zur Anzeige großer Listen auf Webseiten untersuchen und über deren Anwendungsbereiche sprechen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ql/ap/04/qlap04o-7mdhzho6nedwbgz64gk.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl sich dieses Material an Angular richtet, gilt das, was hier diskutiert wird, für andere Frameworks und Projekte, die in reinem JavaScript geschrieben sind. </font><font style="vertical-align: inherit;">Insbesondere werden hier die folgenden Ansätze zum Rendern großer Listen betrachtet:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtuelles Scrollen (mit Angular CDK).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manuelles Rendern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progressives Rendern.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtuelles Scrollen</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Virtuelles Scrollen ist möglicherweise die effizienteste Methode, um mit großen Listen zu arbeiten. </font><font style="vertical-align: inherit;">Er hat zwar einige Nachteile. </font><font style="vertical-align: inherit;">Das virtuelle Scrollen ist dank des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angular CDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und anderer Plugins in jeder Komponente sehr einfach zu implementieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Idee hinter dem virtuellen Scrollen ist einfach, aber nicht immer leicht zu implementieren. </font><font style="vertical-align: inherit;">Die Quintessenz hier ist, dass wir einen Container und eine Liste von Elementen haben. </font><font style="vertical-align: inherit;">Ein Element wird nur gerendert, wenn es sich im sichtbaren Bereich des Containers befindet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden das Modul </font></font><code>scrolling</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aus dem Angular CDK verwenden, mit dem das virtuelle Scrollen organisiert werden soll. </font><font style="vertical-align: inherit;">Dazu müssen Sie zuerst das CDK installieren:</font></font><br>
<br>
<pre><code class="bash hljs">npm i @angular/cdk
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann müssen Sie das Modul importieren:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { ScrollingModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/cdk/scrolling'</span>;<font></font>
@NgModule({<font></font>
&nbsp;...<font></font>
&nbsp;imports: [ ScrollingModule, ...]<font></font>
})<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> </span>{}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach können Sie in den Komponenten Folgendes verwenden </font></font><code>cdk-virtual-scroll-viewport</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cdk-virtual-scroll-viewport</span> <span class="hljs-attr">itemSize</span>=<span class="hljs-string">"50"</span>&gt;</span>
&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> *<span class="hljs-attr">cdkVirtualFor</span>=<span class="hljs-string">"let item of items"</span>&gt;</span><font></font>
&nbsp;&nbsp;&nbsp;{{ item }}<font></font>
&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">cdk-virtual-scroll-viewport</span>&gt;</span>
</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ein Beispielprojekt, das diesen Ansatz zum Organisieren des virtuellen Bildlaufs verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, ermöglichen die Standard-Winkelmechanismen ohne große Schwierigkeiten beeindruckende Ergebnisse. Die Komponente im Beispiel rendert viele tausend Elemente ohne Probleme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das virtuelle Scrollen so gut ist und so einfach zu implementieren ist, stellt sich die Frage, warum Sie andere Möglichkeiten zum Rendern großer Listen untersuchen sollten. Diese Frage hat mich auch interessiert. Wie sich herausstellte, hat dieser Zustand mehrere Gründe:</font></font><br>
<br>
<ul>
<li>,      ,     .        ,     . ,      <code>Autocomplete</code> (    ).  , ,    ,   ,  .     —        .</li>
<li>      —    ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt einige Probleme mit der Zugänglichkeit und Benutzerfreundlichkeit des Inhalts einer Liste mit virtuellem Bildlauf. </font><font style="vertical-align: inherit;">Versteckte Elemente werden nicht gerendert. Dies bedeutet, dass sie für Bildschirmleser nicht verfügbar sind und mit Standardbrowsermechanismen nicht auf der Seite gefunden werden können.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Virtuelles Scrollen ist in einer Reihe von Situationen ideal (vorausgesetzt, es funktioniert):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Fall, wenn Sie Listen anzeigen möchten, deren Größe nicht im Voraus bekannt ist oder die sehr groß sein können (nach einer groben Schätzung Listen mit mehr als 5.000 Elementen, dies hängt jedoch stark von der Komplexität der einzelnen Elemente ab).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für den Fall, dass Sie endloses Scrollen organisieren müssen.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manuelles Rendern</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine der Möglichkeiten, mit Listen zu arbeiten, mit denen ich versucht habe, die Ausgabe einer großen Anzahl von Elementen zu beschleunigen, besteht darin, stattdessen das manuelle Rendern mit der Angular-API zu verwenden </font></font><code>*ngFor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine einfache Vorlage, die eine Schleife verwendet, die mit der Direktive * organisiert ist</font></font><code>ngFor</code><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&nbsp;
*<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let item of data; trackBy: trackById; let isEven = even; let isOdd = odd"</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">class</span>=<span class="hljs-string">"h-12"</span>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-400</span>]=<span class="hljs-string">"isEven"</span>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-500</span>]=<span class="hljs-string">"isOdd"</span>
&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4"</span>&gt;</span>{{ item.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4 rounded (click)="</span><span class="hljs-attr">remove</span>(<span class="hljs-attr">item</span>)"&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Renderleistung von 10.000 einfachen Elementen zu messen, habe ich einen Benchmark verwendet, der auf dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">js-Frameworks-Benchmark</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basiert </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst habe ich die Leistung einer Liste untersucht, die eine reguläre Schleife zur Ausgabe verwendet </font></font><code>*ngFor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Als Ergebnis stellte sich heraus, dass die Skripterstellung 1099 ms, das Rendern (Rendern) 1553 ms und das Malen (Malen) 3 ms dauerte.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bdc/65d/617/bdc65d6174798028877e98bdcc7830d8.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Studie zur Leistung der Liste, bei der * ngFor zum Anzeigen der Ausgabe verwendet wird. Listenelemente</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
können mithilfe der Angular-API manuell gerendert werden:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">ng-container</span> #<span class="hljs-attr">itemsContainer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ng-container</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ng-template</span> #<span class="hljs-attr">item</span> <span class="hljs-attr">let-item</span>=<span class="hljs-string">"item"</span> <span class="hljs-attr">let-isEven</span>=<span class="hljs-string">"isEven"</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"h-12 "</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-400</span>]=<span class="hljs-string">"isEven"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-500</span>]=<span class="hljs-string">"!isEven"</span>
&nbsp;&nbsp;&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4"</span>&gt;</span>{{ item.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4 rounded"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"remove(item)"</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ng-template</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns darüber sprechen, wie sich der Controller-Code geändert hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine Vorlage und einen Container deklariert:</font></font><br>
<br>
<pre><code class="html hljs xml">@ViewChild('itemsContainer', { read: ViewContainerRef }) container: ViewContainerRef;<font></font>
@ViewChild('item', { read: TemplateRef }) template: TemplateRef<span class="hljs-tag">&lt;<span class="hljs-name">any</span>&gt;</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Generieren von Daten rendern wir sie mit der </font></font><code>createEmbeddedView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entitätsmethode </font></font><code>ViewContainerRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml">private buildData(length: number) {<font></font>
&nbsp;&nbsp;const start = this.data.length;<font></font>
&nbsp;&nbsp;const end = start + length;<font></font>
<font></font>
&nbsp;&nbsp;for (let n = start; n <span class="hljs-tag">&lt;<span class="hljs-name">=</span> <span class="hljs-attr">end</span>; <span class="hljs-attr">n</span>++) {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">this.container.createEmbeddedView</span>(<span class="hljs-attr">this.template</span>, {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">item:</span> {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">id:</span> <span class="hljs-attr">n</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">label:</span> <span class="hljs-attr">Math.random</span>()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">isEven:</span> <span class="hljs-attr">n</span> % <span class="hljs-attr">2</span> === <span class="hljs-string">0</span>
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;}
}
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen wurden die Indikatoren, die die Leistung der Liste charakterisieren, leicht verbessert. </font><font style="vertical-align: inherit;">Das Ausführen des Codes dauerte nämlich 734 ms, das Rendern 1443 ms und das Zeichnen 2 ms.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a67/3dd/0c5/a673dd0c5ca9c97dc057124d056646e7.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie die Leistung einer Liste untersuchen, die die Angular-API zur Ausgabe von</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
True verwendet, bedeutet dies in der Praxis, dass die Liste immer noch extrem langsam ist. </font><font style="vertical-align: inherit;">Wenn Sie auf die entsprechende Schaltfläche klicken, friert der Browser einige Sekunden lang ein. </font><font style="vertical-align: inherit;">Wenn dies in der Produktion auftauchen würde, würde es den Benutzern definitiv nicht gefallen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht es aus (hier imitiere ich mit der Maus die Ladeanzeige).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f45/5a3/6bc/f455a36bc281147be801caed867b1f1f.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verlangsamen der Liste Um</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
die Leistung beim manuellen Rendern von Listen zu verbessern, werden wir versuchen, die progressive Rendering-Technologie anzuwenden.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progressives Rendern</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Idee des progressiven Renderns ist einfach. </font><font style="vertical-align: inherit;">Es besteht darin, eine Teilmenge von Elementen schrittweise zu rendern und das Rendern anderer Elemente in der Ereignisschleife zu verschieben. </font><font style="vertical-align: inherit;">Dadurch kann der Browser alle Elemente anzeigen, ohne "langsamer zu werden". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der folgende Code, der das progressive Rendern von Listen implementiert, ist sehr einfach:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf diese Weise </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erstellen wir zunächst alle 10 ms einen regulären Aufruf einer Funktion, die beim Aufruf 500 Elemente rendert.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem alle Elemente abgeleitet wurden, die wir anhand der Analyse des Index des aktuellen Elements ermitteln, stoppen wir den regulären Funktionsaufruf und unterbrechen den Zyklus.</font></font></li>
</ul><br>
<pre><code class="javascript hljs">private buildData(length: number) {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> ITEMS_RENDERED_AT_ONCE = <span class="hljs-number">500</span>;
&nbsp;&nbsp;<span class="hljs-keyword">const</span> INTERVAL_IN_MS = <span class="hljs-number">10</span>;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">0</span>;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> nextIndex = currentIndex + ITEMS_RENDERED_AT_ONCE;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n = currentIndex; n &lt;= nextIndex ; n++) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (n &gt;= length) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clearInterval(interval);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">break</span>;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> context = {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">item</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">id</span>: n,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">label</span>: <span class="hljs-built_in">Math</span>.random()<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">isEven</span>: n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">this</span>.container.createEmbeddedView(<span class="hljs-keyword">this</span>.template, context);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentIndex += ITEMS_RENDERED_AT_ONCE;<font></font>
&nbsp;&nbsp;}, INTERVAL_IN_MS);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass die Anzahl der Elemente, die pro Aufruf der übertragenen Funktion angezeigt werden </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sowie die Häufigkeit des Aufrufs dieser Funktion vollständig von den Umständen abhängen. Wenn beispielsweise die Elemente der angezeigten Liste sehr komplex sind, ist die Ausgabe von 500 solcher Elemente auf einmal unannehmbar langsam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Messung der Leistung dieser Lösung habe ich Ergebnisse erhalten, die schlechter aussehen als die, die ich zuvor erhalten habe. Codeausführung - 907 ms., Rendern - 2555 ms., Zeichnen - 16 ms.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8eb/91e/bdc/8eb91ebdce039a630cb7ff043afdcb38.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Untersuchung der Leistung einer Liste, deren Ausgabe progressives Rendern verwendet.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Benutzer, der mit einer solchen Liste arbeitet, wird jedoch eine viel angenehmere Erfahrung als zuvor erleben. </font><font style="vertical-align: inherit;">Obwohl sich die zum Rendern der Liste erforderliche Zeit erhöht hat, wird der Benutzer dies nicht bemerken. </font><font style="vertical-align: inherit;">Wir rendern auf einmal 500 Elemente. </font><font style="vertical-align: inherit;">In diesem Fall wird das Rendern außerhalb der Grenzen des Containers durchgeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier können einige Probleme auftreten, weil sich die Größe des Containers während des Renderns ändert oder sich die Position des Bildlaufs ändert. </font><font style="vertical-align: inherit;">In diesem Fall müssen Sie sich mit ähnlichen Problemen befassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht die Arbeit mit einer solchen Liste aus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d85/34a/33c/d8534a33c099a4f62a561802db2ff995.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste ist schnell</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manuelle und progressive Rendering-Techniken für große Listen sind in einigen Situationen sicherlich nützlich. </font><font style="vertical-align: inherit;">Ich habe sie in Fällen verwendet, in denen das virtuelle Scrollen aus irgendeinem Grund nicht zu mir passte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Anbetracht des oben Gesagten können wir sagen, dass virtuelles Scrollen, das auf der Grundlage einer guten Bibliothek wie dem Angular CDK erstellt wurde, die beste Möglichkeit ist, große Listen anzuzeigen. </font><font style="vertical-align: inherit;">Wenn das virtuelle Scrollen aus irgendeinem Grund nicht verwendet werden kann, hat der Entwickler andere Möglichkeiten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie geben Sie große Listen in Ihren Webprojekten aus?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de492492/index.html">NikiRobot - eine Weiterentwicklung der pädagogischen Robotik</a></li>
<li><a href="../de492496/index.html">Beispiel für ein Simple Notes SPA unter Mithril.js</a></li>
<li><a href="../de492500/index.html">Wissenschaftsgarage auf Russisch. Erleben Sie die Übersetzung einer amerikanischen Show</a></li>
<li><a href="../de492502/index.html">MIP * = RE: epochale Beweise aus dem Bereich der Informatik, die den Dominoeffekt in Physik und Mathematik verursacht haben</a></li>
<li><a href="../de492504/index.html">Was passiert, wenn ein JS-Modul zweimal importiert wird?</a></li>
<li><a href="../de492508/index.html">Buchen Sie Kubernetes für DevOps</a></li>
<li><a href="../de492510/index.html">ES6-Module im Browser: Sind sie bereit oder nicht?</a></li>
<li><a href="../de492512/index.html">CSS: Abenteuer im Land der Transluzenz</a></li>
<li><a href="../de492514/index.html">Wie kann ein rechtlich bedeutender elektronischer Dokumentenfluss von Gegenparteien in Russland und Kasachstan hergestellt werden?</a></li>
<li><a href="../de492518/index.html">Der Ausbruch von Viren erfordert Remote-Arbeit, dh das digitale Signieren von Dokumenten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>