<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧚🏾 👩🏾‍🔧 👨🏼‍🌾 We receive and analyze the radio signal of the payment terminal using SDR 👨‍💻 👨 👬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr. 
 
 Recently, I had the opportunity to test a payment terminal with the possibility of contactless payment. Well, since the payment is co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>We receive and analyze the radio signal of the payment terminal using SDR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506456/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello, Habr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recently, I had the opportunity to test a payment terminal with the possibility of contactless payment. </font><font style="vertical-align: inherit;">Well, since the payment is contactless, it means the signal is transmitted by radio, and of course, I could not give up the temptation to look with the SDR receiver what kind of data is transmitted and received during the payment. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/lx/nc/oflxncgb4c_qvhq6ptvxadvfyf8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photo (c) Verifone</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For those who are interested in how this works, a few details under the cut.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should be noted right away that I don’t have any official description of the protocol for exchanging a terminal with a card, such data is usually distributed only to partner companies after signing the NDA, but no one forbids us to listen to the broadcast and make any assumptions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So let's get started.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Signal spectrum</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's start with the simplest thing - start the receiver, turn on the terminal, make payment and see what is on the air. </font><font style="vertical-align: inherit;">The search for the signal turns out to be elementary, a huge peak is visible at a frequency of 13.56 MHz: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/-h/l7/wo-hl75zr6ratqupuvl9ohw8wsg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The signal level is not surprising, because it should be enough for inductive communication with a card that does not have its own power source. </font><font style="vertical-align: inherit;">As Google suggests, 13.56MHz is the standard frequency for RFID devices. </font><font style="vertical-align: inherit;">The symmetry of the signal suggests the possible use of AM modulation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now that the signal is found, it is easy to look at it in more detail and see the different phases of payment: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p8/c-/cp/p8c-cpgkrxw7rq-uhs4jt0ms_hi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider them in more detail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Idle mode</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this mode, the terminal does not radiate anything, only the logo of the bank or store is displayed on the screen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Payment request and card waiting</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The cashier initiates a payment for a certain amount. </font><font style="vertical-align: inherit;">At this point, the terminal enters the standby mode of payment. </font><font style="vertical-align: inherit;">Payment by card can be made either using a magnetic strip, or by inserting a card, or by the contactless method that interests us. </font><font style="vertical-align: inherit;">To determine when the card was brought to the terminal, a request is sent every 0.12s. </font><font style="vertical-align: inherit;">Short parcels in the form of vertical lines on the spectrum, in an enlarged form, look like this: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/bc/yv/hlbcyvjnx9wrtvr2d1n5bedlvdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is clearly seen that the data is repeated. </font><font style="vertical-align: inherit;">The data block (“by eye”, 24 or 32 bits) most likely contains a bit mask containing the card formats supported by this reader. </font><font style="vertical-align: inherit;">At least to other cards (for example, transport), the reader does not “respond”.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Data exchange with the card</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When a card is detected, its controller in response sends its data - probably the card number and service information. </font><font style="vertical-align: inherit;">There is no power supply in the card itself, so the response from it is very weak in power. </font><font style="vertical-align: inherit;">As you can see, for each terminal request, the card sends a response, the “radio” between them is quite active: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/vq/cs/msvqcsmzk4qkowdclpxauf9melg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The increased signal received from the card looks something like this:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vt/t4/lf/vtt4lfrsq2vh9glkdfwcxcxses8.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Card Verification</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the card data is received, the terminal probably checks the encryption keys on the card, the process takes about 0.6s. </font><font style="vertical-align: inherit;">The RFID module is currently disabled. </font><font style="vertical-align: inherit;">Perhaps the terminal is requesting card status online.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Pending card withdrawal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At that moment when the terminal read all the data and checked the card, the message “remove the card” is displayed on the screen, every 5ms the terminal checks whether the card is in place: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/vl/wp/bivlwp5c5uhb-etgpva3gfc0tfg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see the same messages, the card’s response is also visible. </font><font style="vertical-align: inherit;">In an enlarged view, you can show the moment the card stopped responding: the </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/rj/bh/jdrjbhqexfxncf0z3k5743rw8zq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
answer from the card itself, by the way, is quite simple and short, “by eye”, no more than 24 bits: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/b_/l_/n_b_l_8-zlnpokvhf98w0cpq5va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this the radio exchange ends, and with all the data received, the terminal sends a request for payment to jar. </font><font style="vertical-align: inherit;">A response comes from the bank, and if the payment is successful, we receive our goods.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, at the binary level, everything is quite simple. The RFID protocol uses conventional amplitude modulation, no rocket science. But of course, the main work is carried out at a logical level, checking the card and making a payment is a rather complicated process, which also involves encryption. For those who want to study the topic in more detail, you can find useful comments from users </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rizorko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lil_Toady</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in which you can find links to standards.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finally, you can answer the question that many are probably interested in: is it possible to covertly withdraw money from someone else's card at a great distance. Judging by the analysis of the radio signal, we can say that this is very unlikely. Firstly, the card itself does not have a built-in power supply - in order for its processor to work, the field strength should be </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quite</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big. The normal reading distance of the card is 2-3 cm, in order to increase it to at least 100 cm, the field strength should be in the third degree greater than this difference. The second point is receiving a response from the card - its signal is very weak, and it is also not easy to receive it at a great distance (plus do not forget that the wavelength with a frequency of 13 MHz is about 20 meters, and short antennas at such wavelengths are inefficient). Finally, do not forget about the organizational aspects - each payment terminal is linked to the bank account of a legal entity, and if there are complaints about debiting funds, this account can simply be blocked. The terminal itself, by the way, has a unique ID, and if it is constantly tied to different accounts, this will also be suspicious. In general, although theoretically remote reading of RFID may be possible,Judging by</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , there have been no real cases of such withdrawals. </font><font style="vertical-align: inherit;">And finally, the limit of contactless payments is very small, so the “profit” probably will not correspond to the risk and cost of the equipment.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506442/index.html">Tick ​​Tuck</a></li>
<li><a href="../en506444/index.html">Future challenges</a></li>
<li><a href="../en506450/index.html">Experience in using Rutoken technology for registering and authorizing users in the system (Part 1)</a></li>
<li><a href="../en506452/index.html">How to protect your public site with ESNI</a></li>
<li><a href="../en506454/index.html">For what a bim-manager gets 100 thousand and how to become one</a></li>
<li><a href="../en506460/index.html">Differences of the male brain from the female: women code better?</a></li>
<li><a href="../en506462/index.html">Pushpools and tachers - how I tested everything I found</a></li>
<li><a href="../en506472/index.html">Business protection for Internet entrepreneurs: where to open a company and account, what to look for</a></li>
<li><a href="../en506478/index.html">Installing and Configuring RTKRCV (RTKLIB) on Windows 10 Using WSL</a></li>
<li><a href="../en506480/index.html">2008 vs 2020: How investor behavior is changing during the crisis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>