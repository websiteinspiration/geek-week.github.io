<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍒 🌉 👩🏿‍🤝‍👩🏼 Automatisez les processus RH à l'aide de Microsoft Teams, PowerApps et Power Automate. Demandes de retrait d'employés 🤸🏽 👈🏽 🆕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journée à tous! Aujourd'hui, je voudrais partager un petit exemple d'automatisation du processus de création d'applications pour les nouveaux em...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Automatisez les processus RH à l'aide de Microsoft Teams, PowerApps et Power Automate. Demandes de retrait d'employés</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497488/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonne journée à tous! </font><font style="vertical-align: inherit;">Aujourd'hui, je voudrais partager un petit exemple d'automatisation du processus de création d'applications pour les nouveaux employés à l'aide de Microsoft SharePoint, PowerApps, Power Automate et Teams. </font><font style="vertical-align: inherit;">Lors de la mise en œuvre de ce processus, vous n'aurez pas besoin d'acheter des plans utilisateur PowerApps et Power Automate distincts, un abonnement Office365 E1 / E3 / E5 suffira. </font><font style="vertical-align: inherit;">Nous créerons des listes et des colonnes sur le site SharePoint, PowerApps vous aidera à créer le formulaire et Power Automate offrira la possibilité de personnaliser la logique des processus d'entreprise. </font><font style="vertical-align: inherit;">Le processus final est connecté à l'équipe MS Teams. </font><font style="vertical-align: inherit;">Ne perdons pas de temps et voyons ce qui se passe.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/by/t1/e-byt1bfrywvuok7gx25kggbvj8.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un premier temps, nous créons des listes et des détails. </font><font style="vertical-align: inherit;">Nous aurons besoin de listes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demandes de retrait d'employés</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Divisions</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HR par unité</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Administrateurs</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque liste jouera un rôle à l'avenir, et nous verrons laquelle. </font><font style="vertical-align: inherit;">Nous créons les détails et configurons le menu de navigation:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/jt/gh/hwjtghqjoqtymuuvhezpyvggsck.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Powerapps</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, créons un formulaire pour la liste des demandes de retrait des employés à l'aide de PowerApps. Dans le formulaire final, cela ressemblera à ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/zy/wo/2ezywokrmvzpfm_5vxbx1u4lzj8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le champ "Employé", les utilisateurs d'Office 365 sont sélectionnés dans la liste des utilisateurs, "Date de sortie" est indiqué dans le calendrier, "Département" est indiqué dans le répertoire des départements et "HR" est sélectionné dans le répertoire "RH par départements" : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/aj/e8/niaje8qtx9zko2sk9c6x2wx5g7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous devez vous assurer que la liste des RH disponibles pour la sélection est filtrée par l'unité indiquée sur le formulaire. Utilisez une formule pour filtrer les données dans PowerApps. Pour la propriété «Items» du champ «HR», nous écrivons: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qk/o-/p7/qko-p70_444xwyltuxby8fqduko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, sur le formulaire, vous pouvez effectuer de petits réglages pour la valeur par défaut du champ Statut. Pour la propriété "Default" du champ "Status", écrivez:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/zg/ic/b4zgic7k4bvev-uadqina0ni4ey.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le formulaire de création d'élément est ouvert, la valeur «Nouveau» sera écrite dans le champ Statut, sinon, la valeur de la colonne SharePoint pour l'élément actuel sera remplacée dans le champ d'état du formulaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des problèmes avec PowerApps est l'impossibilité de récupérer facilement les données des groupes SharePoint. À cet égard, il n'est pas possible de configurer facilement la visibilité / disponibilité des champs ou des objets du formulaire si vous souhaitez vous connecter à l'utilisateur qui rejoint le groupe SharePoint. Mais vous pouvez contourner ce problème. Surtout pour cela, nous avons créé à l'avance une liste d'administrateurs:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bn/3m/se/bn3mseql4chpxozeu_gbtacxyqy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette liste, il y a un champ «Employé» avec le type «Utilisateur ou groupe» affiché uniquement sur le formulaire et un champ «Nom» dans lequel le nom de l'employé sélectionné est écrit, affiché uniquement dans la vue de liste. Maintenant, faisons un petit tour dans PowerApps. Par exemple, vous pouvez configurer la disponibilité de n'importe quel champ à la condition que l'utilisateur actuel figure dans la liste Administrateurs. Nous trouvons la propriété «Mode d'affichage» du champ «Date de sortie» et écrivons: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/0m/8d/2e0m8dqb8ydddbxeod7zedmknui.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon cette formule, s'il y a au moins un employé dans la liste des administrateurs dont la connexion correspond à la connexion de l'utilisateur actuel, le champ sera disponible pour l'édition, sinon, pour la visualisation. Pour une plus grande fiabilité, nous mettons la connexion en minuscules, sinon il y a toutes sortes de cas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous avez peut-être remarqué qu'il y a un bouton «Actions sur demande» dans le titre du formulaire:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/0b/wc/wp0bwcymw4vo7wg_gkegu0qg50s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce bouton ira à un autre écran, où, pour plus de commodité, toutes les actions possibles sur l'application sont collectées: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/0s/wk/to0swknwraznhohevjatxjoh06y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir cliqué sur chaque bouton, une fenêtre supplémentaire d'actions est ouverte, par exemple, si l'action "Annuler la demande" est sélectionnée, une fenêtre supplémentaire s'ouvre avec la possibilité de saisir un commentaire: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cf/c8/wg/cfc8wgn2v64qdqq3-pugswtxmti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir cliqué sur le bouton «Confirmer», l'état de l'application change, et cela peut être fait même sans démarrer le flux Power Automate. Nous utiliserons la fonction «Patch» pour la propriété «OnSelect» du bouton: A l' </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/l4/yj/s5l4yjpdm_2uedemovmggtq9_8g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
aide de la fonction Patch, nous mettons à jour l'élément de liste d'application en le filtrant par l'identifiant de l'élément courant. Nous modifions la valeur du champ "Statut" et passons à l'écran principal. Pour les boutons d'action restants, la logique est similaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste à configurer le flux de négociation. </font><font style="vertical-align: inherit;">Faisons-le dans sa forme la plus simple.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisation de puissance</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre flux d'approbation démarre automatiquement lorsque vous créez une application. </font><font style="vertical-align: inherit;">Pendant la mise en œuvre, le statut de la demande sera modifié, le chef de division sera reçu et une notification de nouvelle demande sera envoyée au chef. </font><font style="vertical-align: inherit;">Pour déterminer le leader, nous avons un annuaire des «Départements»: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/vc/7h/sbvc7hsibhkxeyikwhsulhunmge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons un flux Power Automate: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/u9/i0/vxu9i0iosnwmf4qj331z1hxusli.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'exécution de ce flux, le chef de division reçoit une notification par mail sur la création d'une nouvelle application et peut cliquer sur le lien pour prendre une décision en cliquant sur le bouton: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/aa/q6/baaaq6wl23ypaz_bj_cbo2u6zfo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquer </font><font style="vertical-align: inherit;">sur le bouton </font><font style="vertical-align: inherit;">«Accepter» ou «Rejeter» déclenche également le fil de discussion Power Automate, qui modifie le statut de l'application et envoie un e-mail de notification à un spécialiste des ressources humaines: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/78/xh/qd/78xhqdkb6lulsmt-ah9ciq3bgls.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
le processus est prêt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et la touche finale est l'organisation de la collaboration avec ce processus. </font><font style="vertical-align: inherit;">Pour ce faire, nous connectons le processus à l'équipe MS Teams: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ky/v1/-v/kyv1-v3g_x_rzqpyz8dsgrfvnmy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
désormais, tous les membres de l'équipe MS Teams ont accès au processus de sortie des nouveaux employés sur un onglet distinct. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, la correspondance en plusieurs étapes peut être fournie dans la logique de flux, et il est également possible d'utiliser le composant Approbations pour attribuer des tâches Power Automate. </font><font style="vertical-align: inherit;">Vous pouvez également configurer des rapports et générer des notifications qui seront envoyées au chatbot Microsoft Teams. </font><font style="vertical-align: inherit;">Mais plus à ce sujet dans les articles suivants. </font><font style="vertical-align: inherit;">Merci de votre attention et bonne journée!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497478/index.html">Tutoriel de simulateur de réseau ns-3. Chapitre 4</a></li>
<li><a href="../fr497480/index.html">Conférences vidéo: Unix Way</a></li>
<li><a href="../fr497482/index.html">Authentification dans Kubernetes avec Dex: attachez LDAP</a></li>
<li><a href="../fr497484/index.html">Utilisation d'algorithmes ML pour classer des documents multipages: expérience VTB</a></li>
<li><a href="../fr497486/index.html">Division des données. année 2013. Rétrospective</a></li>
<li><a href="../fr497490/index.html">Difficultés de paternité des hippocampes: métamorphoses génétiques du système immunitaire</a></li>
<li><a href="../fr497492/index.html">Application sur TSD et communication avec 1C: Enterprise 8.3 via HTTP-Service. Partie 1.1 (description détaillée de l'API)</a></li>
<li><a href="../fr497504/index.html">Comment Quarkus intègre MicroProfile et Spring</a></li>
<li><a href="../fr497506/index.html">Créer une tâche pour une commande à distance sur Laravel</a></li>
<li><a href="../fr497508/index.html">Nous continuons à utiliser des modèles C ++ à plusieurs étages dans RESTinio: une alternative de type sûr au routeur express-js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>