<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👇🏼 🎾 👨🏽‍🎓 Chatixバックエンドでマルチユーザーチャットに反応する 🍺 🏥 👝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ここで、バックエンドがない場合、またはバックエンドの開発に時間をかけたくない場合に、チーム/ユーザー/友達のためにチャットを行う方法を示します。簡単なテキストチャットを行い、約1時間かかります。
 

バックエンドなしで動作するネットワークチャットを書くことはほとんど不可能です。それは何らかの形でな...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Chatixバックエンドでマルチユーザーチャットに反応する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474492/"><p><img src="https://habrastorage.org/getpro/habr/post_images/d7e/212/ac4/d7e212ac471c99b0cd61dd0e75aab281.png" alt="Chatixチャットルーム"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、バックエンドがない場合、またはバックエンドの開発に時間をかけたくない場合に、チーム/ユーザー/友達のためにチャットを行う方法を示します。</font><font style="vertical-align: inherit;">簡単なテキストチャットを行い、約1時間かかります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンドなしで動作するネットワークチャットを書くことはほとんど不可能です。それは何らかの形でなければなりません。</font><font style="vertical-align: inherit;">ChatixとそのJavaScript SDKを使用します。</font><font style="vertical-align: inherit;">ChatixとSDKはメッセージストレージとネットワークタスクに従事し、フロントエンドを扱います。</font></font></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既製のプロジェクトコードがGitHub </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Demoで</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">利用可能</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></p><a name="habracut"></a><br>
<h2 id="struktura-proekta"> </h2><br>
<ul>
<li>App (  ,    , ..        Redux  -  state manager)<br>
<ul>
<li>Header (     ,        )</li>
<li>LogoHeader</li>
<li>RoomTitle</li>
<li>Main</li>
<li>MemberList (  )<br>
<ul>
<li>MemberItem[]</li>
</ul></li>
<li>ChatField (       )<br>
<ul>
<li>MessageContainer</li>
<li>Message[] ( ;          )</li>
<li>SendMessageForm (     )</li>
</ul></li>
<li>ChatixSDK (headless      )</li>
</ul></li>
</ul><br>
<blockquote>    .       Redux      ,            App              .<br>
,     ,       App   <code>props</code>  : <code>App → Header → RoomTitle</code>.         SendMessageForm  App: <code>SendMessageForm → ChatField → Main → App</code>.</blockquote><p>       :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d1e/096/b73/d1e096b7349824c510542cc215ae437e.png" alt="chatix.io"></p><br>
<h2 id="vzaimodeystvie-mezhdu-komponentami">  </h2><br>
<p>                         . </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/fde/009/821/fde0098218938f714d32a58ad9776ec9.png" alt="コンポーネントの相互作用"></p><br>
<p>   ,      <code>App</code>,       (     <code>prop</code>       ),         <code>App</code>.       ( )   -,     .</p><br>
<h2 id="sozdanie-proekta"> </h2><br>
<h3 id="sozdaem-vizualnye-komponenty">  </h3><br>
<h4 id="shapka"></h4><br>
<ol>
<li><p>     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">create-react-app</a>.</p><br>
<pre><code class="plaintext hljs">npx create-react-app chatix-chatroom<font></font>
cd chatix-chatroom</code></pre><br>
<p>  </p><br>
<pre><code class="plaintext hljs">npm start</code></pre><br>
</li>
<li><p>   .<br>
    .     src c  <strong>components</strong>,     <strong>logo_header</strong>.        2  <strong>LogoHeader.js</strong>  <strong>LogoHeader.css</strong></p><br>
</li>
</ol><br>
<p><strong>LogoHeader.js</strong></p><br>
<pre><code class="plaintext hljs">import React from 'react'<font></font>
import logo from './chatix_logo.svg';<font></font>
import './LogoHeader.css';<font></font>
<font></font>
function LogoHeader(){<font></font>
    return (<font></font>
        &lt;div className="LogoHeader"&gt;<font></font>
            &lt;img src={logo} className="App-logo" alt="Chatix logo" /&gt;<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
}<font></font>
<font></font>
export default LogoHeader;</code></pre><br>
<p><strong>LogoHeader.css</strong></p><br>
<pre><code class="css hljs"><span class="hljs-selector-class">.LogoHeader</span>{
    <span class="hljs-attribute">flex-basis</span>: <span class="hljs-number">200px</span>;
    <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;<font></font>
}</code></pre><br>
<p>  ,          .</p><br>
<p>       ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></p><br>
<p>   -.     <strong>room-title</strong>     <strong>RoomTitle</strong>.         props,   <code>props.chatroomName</code>      .</p><br>
<p><strong>RoomTitle</strong></p><br>
<pre><code class="plaintext hljs">import React from 'react';<font></font>
import './RoomTitle.css';<font></font>
<font></font>
function RoomTitle(props){<font></font>
    return (<font></font>
        &lt;div className="RoomTitle"&gt;<font></font>
            &lt;h1&gt;{props.chatroomName}&lt;/h1&gt;<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
}<font></font>
<font></font>
export default RoomTitle;</code></pre><br>
<p>            -.         prop <code>chatroomName</code>.</p><br>
<p>        ( )     <strong>App</strong>.    e     <strong>Header</strong>   <strong>Header</strong>  <strong>RoomTitle</strong>.</p><br>
<p><strong>components\header\Header.js</strong></p><br>
<p><strong>Header.js</strong></p><br>
<pre><code class="plaintext hljs">import React from 'react';<font></font>
import './Header.css'<font></font>
import LogoHeader from '../logo_header/LogoHeader';<font></font>
import RoomTitle from '../room-title/RoomTitle';<font></font>
<font></font>
function Header(props) {<font></font>
    return (<font></font>
        &lt;header&gt;<font></font>
            &lt;LogoHeader/&gt;<font></font>
            &lt;RoomTitle chatroomName={props.chatroomName} /&gt;<font></font>
        &lt;/header&gt;<font></font>
    );<font></font>
}<font></font>
<font></font>
export default Header;</code></pre><br>
<p>   <strong>App.js</strong>      <strong>Header.js</strong>.<br>
       <strong>props</strong>    .<br>
       .              </p><br>
<pre><code class="plaintext hljs">import React from 'react';<font></font>
import './App.css';<font></font>
import Header from './components/header/Header';<font></font>
<font></font>
class App extends React.Component {<font></font>
    constructor(props){<font></font>
        super(props);<font></font>
        chatroomName: '-',<font></font>
        me: {<font></font>
            is_online: true,<font></font>
            name: "",<font></font>
            uuid: "98s7dfh9a8s7dhf"<font></font>
        }<font></font>
    }<font></font>
    render() {<font></font>
        return (<font></font>
          &lt;div className="App"&gt;<font></font>
            &lt;Header <font></font>
                chatroomName={this.state.chatroomName}<font></font>
                me={this.state.me}<font></font>
            /&gt;<font></font>
          &lt;/div&gt;<font></font>
        );<font></font>
    };<font></font>
}<font></font>
<font></font>
export default App;</code></pre><br>
<p>                        <strong>App</strong>.</p><br>
<p>      - <code>handleChangeName</code>     callback- <code>props.updateVisitor</code>        .</p><br>
<p><strong>Header.js</strong></p><br>
<pre><code class="plaintext hljs">function Header(props) {<font></font>
    const [name, setName] = useState(props.me.name ? props.me.name : props.me.uuid.substr(-10))<font></font>
<font></font>
    const handleChangeName = (e) =&gt; {<font></font>
        setName(e.target.value)<font></font>
        let visitor = {...props.me};<font></font>
        visitor.name = e.target.value;<font></font>
        props.updateVisitor(visitor)<font></font>
    }<font></font>
<font></font>
    return (<font></font>
        &lt;header&gt;<font></font>
            &lt;LogoHeader/&gt;<font></font>
            &lt;RoomTitle chatroomName={props.chatroomName}/&gt;<font></font>
            {<font></font>
                props.me ? <font></font>
                    &lt;input<font></font>
                        className='name-input'<font></font>
                        value={name}<font></font>
                        placeholder=' '<font></font>
                        onChange={(e) =&gt; handleChangeName(e)}<font></font>
                    /&gt;<font></font>
                : null<font></font>
            }<font></font>
        &lt;/header&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>   <strong>App</strong>   <code>props.updateVisitor</code>     .         ,          .</p><br>
<pre><code class="plaintext hljs">onUpdateVisitor = (visitor) =&gt; {<font></font>
    this.setState({me: visitor})<font></font>
 }</code></pre><br>
<p>,             .  </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/685/7ec/243/6857ec2435f476e8d6dad5201d7909a5.png" alt="チャットルームヘッダー"></p><br>
<h4 id="saydbar"></h4><br>
<p>    .<br>
        <strong>Main.js</strong>.<br>
  <strong>components\main\Main.js</strong>,       <strong>components\member-list\MemberList.js</strong>          <strong>components\member-item\MemberItem.js</strong>.</p><br>
<p>       3        .</p><br>
<p> ,    .<br>
      <strong>App</strong>      <strong>Main</strong>.      . </p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">class App extends React.Component {<font></font>
<font></font>
  constructor(props) {<font></font>
    super(props);<font></font>
    this.state = {<font></font>
      chatroomName: '-',<font></font>
      members: [<font></font>
        {<font></font>
          is_online: true,<font></font>
          name: "",<font></font>
          uuid: "98s7dfh9a8s7dhf"<font></font>
        },<font></font>
        {<font></font>
          is_online: true,<font></font>
          name: "",<font></font>
          uuid: "mnzxcv97zx6chvo"<font></font>
        },<font></font>
        {<font></font>
          is_online: false,<font></font>
          name: "",<font></font>
          uuid: "kjuhv987ashdfoua"<font></font>
        },<font></font>
        {<font></font>
          is_online: false,<font></font>
          name: "",<font></font>
          uuid: "jdhnf978WEHJSNDL"<font></font>
        },<font></font>
      ],<font></font>
      me: {<font></font>
        is_online: true,<font></font>
        name: "",<font></font>
        uuid: "98s7dfh9a8s7dhf"<font></font>
      }<font></font>
    };<font></font>
  }<font></font>
  render() {<font></font>
    return (<font></font>
      &lt;div className="App"&gt;<font></font>
        &lt;Header <font></font>
            chatroomName={this.state.chatroomName} <font></font>
            me={this.state.me}    <font></font>
        /&gt;<font></font>
        &lt;Main <font></font>
            members={this.state.members}<font></font>
            me={this.state.me}<font></font>
        /&gt;<font></font>
      &lt;/div&gt;<font></font>
    );<font></font>
  };<font></font>
}</code></pre><br>
<p>  <strong>Main</strong>   <strong>MemberList</strong>      .</p><br>
<p><strong>Main.js</strong></p><br>
<pre><code class="plaintext hljs">function Main(props) {<font></font>
    return(<font></font>
        &lt;section className="Main"&gt;<font></font>
            &lt;MemberList members={props.members} /&gt;<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>   <strong>MemberList</strong>            <strong>MemberItem</strong>      .</p><br>
<p><strong>MemberList.js</strong></p><br>
<pre><code class="plaintext hljs">function MemberList(props) {<font></font>
    const members = props.members.map((member) =&gt; <font></font>
        &lt;MemberItem key={member.uuid} member={member} /&gt;<font></font>
    );<font></font>
<font></font>
    return (<font></font>
        &lt;section className="MemberList"&gt;<font></font>
            {members}<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p> <strong>MemberItem</strong>       .        ,    ,    10  .     /       ,       "()".</p><br>
<pre><code class="plaintext hljs">function MemberItem(props) {<font></font>
<font></font>
    function getName(){<font></font>
        let name = ''<font></font>
        if (props.member.uuid === props.me.uuid) {<font></font>
            if(props.me.name) {<font></font>
                name = props.me.name<font></font>
            }<font></font>
            else {<font></font>
                name = props.me.uuid.substring(props.me.uuid.length-10, props.me.uuid.length);<font></font>
            }<font></font>
        }<font></font>
        else {<font></font>
            if(props.member.name){<font></font>
                name = props.member.name<font></font>
            }<font></font>
            else {<font></font>
                name = props.member.uuid.substring(props.member.uuid.length-10, props.member.uuid.length);<font></font>
            }<font></font>
        }<font></font>
        return name;<font></font>
    }<font></font>
<font></font>
    return(<font></font>
        &lt;div className="MemberItem"&gt;<font></font>
            &lt;img src={ icon } alt={ props.member.name }/&gt;<font></font>
            &lt;span&gt;<font></font>
                { getName() }<font></font>
                {<font></font>
                    props.member.uuid === props.me.uuid &amp;&amp; " () "<font></font>
                }<font></font>
            &lt;/span&gt;<font></font>
            {<font></font>
                props.member.is_online &amp;&amp; &lt;span className="online"&gt;•&lt;/span&gt;<font></font>
            }<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>.      </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/eba/512/a8b/eba512a8bca7de4b1487567775f7742b.png" alt="チャットルームヘッダー"></p><br>
<h4 id="spisok-soobscheniy-i-forma-otpravki">    </h4><br>
<p>      .<br>
     <strong>App</strong>    .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">this.state = {<font></font>
      chatroomName: '-',<font></font>
      messages: [<font></font>
        {<font></font>
          content: " 1",<font></font>
          sender_id: "mnzxcv97zx6chvo",<font></font>
          uuid: "dg897sdfg"<font></font>
        },<font></font>
        {<font></font>
          content: " 2",<font></font>
          sender_id: "98s7dfh9a8s7dhf",<font></font>
          uuid: "8723hernm"<font></font>
        },<font></font>
        {<font></font>
          content: "  ",<font></font>
          sender_id: "mnzxcv97zx6chvo",<font></font>
          uuid: "435nbcv98234"<font></font>
        }<font></font>
      ],<font></font>
      members: [<font></font>
        {<font></font>
          is_online: true,<font></font>
          name: "",<font></font>
          uuid: "98s7dfh9a8s7dhf"<font></font>
        },<font></font>
        {<font></font>
          is_online: true,<font></font>
          name: "",<font></font>
          uuid: "mnzxcv97zx6chvo"<font></font>
        },<font></font>
        {<font></font>
          is_online: false,<font></font>
          name: "",<font></font>
          uuid: "kjuhv987ashdfoua"<font></font>
        },<font></font>
        {<font></font>
          is_online: false,<font></font>
          name: "",<font></font>
          uuid: "jdhnf978WEHJSNDL"<font></font>
        },<font></font>
      ],<font></font>
      me: {<font></font>
        is_online: true,<font></font>
        name: "",<font></font>
        uuid: "98s7dfh9a8s7dhf"<font></font>
      }<font></font>
    };</code></pre><br>
<p>     <strong>Main</strong></p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs"> &lt;Main<font></font>
    members={this.state.members}<font></font>
    messages={this.state.messages}<font></font>
    me={this.state.me}<font></font>
/&gt;</code></pre><br>
<p>   <strong>conponents/chat-field/ChatField.js</strong><br>
   <strong>Main</strong>     .</p><br>
<p><strong>Main</strong></p><br>
<pre><code class="plaintext hljs">function Main(props) {<font></font>
    return(<font></font>
        &lt;section className="Main"&gt;<font></font>
            &lt;MemberList <font></font>
                me={props.me} <font></font>
                members={props.members} /&gt;<font></font>
            &lt;ChatField messages={props.messages} /&gt;<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>   <strong>conponents/message-container/MessageContainer.js</strong><br>
   <strong>ChatField</strong>       .</p><br>
<p><strong>ChatField</strong></p><br>
<pre><code class="plaintext hljs">function Main(props) {<font></font>
    return(<font></font>
        &lt;section className="Main"&gt;<font></font>
            &lt;MemberList <font></font>
                me={props.me} <font></font>
                members={props.members} /&gt;<font></font>
            &lt;ChatField messages={props.messages} /&gt;<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>               .<br>
   <strong>conponents/message/Message.js</strong>.      ,            .</p><br>
<p><strong>Message</strong></p><br>
<pre><code class="plaintext hljs">function Message(props) {<font></font>
<font></font>
    const getSenderName = () =&gt; {<font></font>
        if (props.sender) {<font></font>
            return props.sender.name ? props.sender.name : props.sender.uuid.substr(-10);<font></font>
        }<font></font>
        return "Unknown sender";<font></font>
    };<font></font>
<font></font>
    return(<font></font>
        &lt;div className="Message"&gt;<font></font>
            &lt;div className="message-sender-icon"&gt;<font></font>
                &lt;img src={icon} alt="visitor icon"/&gt;<font></font>
            &lt;/div&gt;<font></font>
            &lt;div className="message-bubble"&gt;<font></font>
                &lt;div className="message-sender-name"&gt;{getSenderName()}&lt;/div&gt;<font></font>
                &lt;div className="message-content"&gt;{props.message.content}&lt;/div&gt;<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>  <strong>MessageContainer</strong>          <strong>Message</strong>,     </p><br>
<p><strong>MessageContainer</strong></p><br>
<pre><code class="plaintext hljs">function MessageContainer(props) {<font></font>
     const messageList = props.messages.map(message =&gt; <font></font>
        &lt;Message <font></font>
            key={message.uuid}<font></font>
            sender={props.members.find((member) =&gt; member.uuid === message.sender_id)} <font></font>
            message={message} /&gt;<font></font>
        );<font></font>
<font></font>
    return (<font></font>
        &lt;section className="MessageContainer" ref={messagesContainer}&gt;<font></font>
            {messageList}<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>    :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/74d/cad/f22/74dcadf22a3086fa2d7182e1aa791cab.png" alt="チャットルームメッセージ"></p><br>
<p>        <strong>components/send-message-form/SendMessageForm.js</strong>.        .         ,       callback- <code>onSendNewMessage</code>       .  <code>onSendNewMessage</code>      <strong>App</strong>     props.</p><br>
<p><strong>SendMessageForm</strong></p><br>
<pre><code class="plaintext hljs">class SendMessageForm extends React.Component {<font></font>
    constructor(props) {<font></font>
        super(props);<font></font>
        this.state = {<font></font>
            message: ''<font></font>
        };<font></font>
    }<font></font>
<font></font>
    currentMessageChanged = (e) =&gt; {<font></font>
        this.setState({message: e.target.value });<font></font>
    }<font></font>
<font></font>
    sendMessageClicked = async (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        if (this.state.message.length &gt; 0) {<font></font>
            await this.props.onSendNewMessage(this.state.message);<font></font>
            this.setState({...this.state, ...{message : ''}});<font></font>
        }<font></font>
    }<font></font>
<font></font>
    render(){<font></font>
        return (<font></font>
            &lt;section className="SendMessageForm"&gt;<font></font>
                &lt;form&gt;<font></font>
                    &lt;input <font></font>
                        type="text" <font></font>
                        value={this.state.message} <font></font>
                        onChange={this.currentMessageChanged} <font></font>
                        placeholder="Type message to send"/&gt;<font></font>
                    &lt;button <font></font>
                        type="submit" <font></font>
                        onClick={this.sendMessageClicked}<font></font>
                    &gt;<font></font>
                        Send<font></font>
                    &lt;/button&gt;<font></font>
                &lt;/form&gt;<font></font>
            &lt;/section&gt;<font></font>
        );<font></font>
    }<font></font>
}</code></pre><br>
<p>   <strong>SendMessageForm</strong>  <strong>ChatField</strong>.</p><br>
<p><strong>ChatField</strong></p><br>
<pre><code class="plaintext hljs">function ChatField(props) {<font></font>
    return(<font></font>
        &lt;section className="ChatField"&gt;<font></font>
            &lt;MessageContainer <font></font>
                members={props.members}<font></font>
                messages={props.messages} <font></font>
            /&gt;<font></font>
            &lt;SendMessageForm onSendNewMessage={props.onSendNewMessage}/&gt;<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>  <strong>Main</strong>    <code>onSendNewMessage</code>  <strong>ChatField</strong>.</p><br>
<p><strong>Main</strong></p><br>
<pre><code class="plaintext hljs">&lt;ChatField<font></font>
    members={props.members}<font></font>
    messages={props.messages}<font></font>
    onSendNewMessage={props.onSendNewMessage} <font></font>
/&gt;</code></pre><br>
<p>     <strong>App</strong>     <strong>Main</strong>.</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">onSendNewMessage = async (message) =&gt; {<font></font>
    console.log(message)<font></font>
 }</code></pre><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">&lt;Main<font></font>
    members={this.state.members}<font></font>
    messages={this.state.messages}<font></font>
    onSendNewMessage={this.onSendNewMessage}<font></font>
    me={this.state.me}<font></font>
/&gt;</code></pre><br>
<p>.             <strong>App</strong>.<br>
    :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e53/89e/d31/e5389ed317bd0fb4bf87db34b05f57a6.png" alt="チャットルーム決勝"></p><br>
<p>,            ,      ,      ,     .</p><br>
<h4 id="podklyuchenie-bekenda"> </h4><br>
<p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">chatix-core</a>.</p><br>
<pre><code class="plaintext hljs">npm i chatix-core</code></pre><br>
<p>    <strong>chatix</strong>   -.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">chatix.io</a>  .<br>
       <strong>websiteId</strong>       .</p><br>
<p>   -     .</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/38b/26d/034/38b26d03464c1b236beff17c4118ba00.png" alt="チャットルームの作成"></p><br>
<p>              .<br>
<strong>components\chatix\ChatixSDK.js</strong></p><br>
<p>   <strong>ChatixCore</strong></p><br>
<pre><code class="plaintext hljs">import ChatixCore from 'chatix-core';</code></pre><br>
<p>  <strong>ChatixSDK</strong>    <strong>ChatixCore</strong>      <strong>websiteId</strong>.</p><br>
<pre><code class="plaintext hljs">const websiteId = "_WEBSITE_ID";<font></font>
this.sdk = new ChatixCore(websiteId);</code></pre><br>
<p>  <strong>this.sdk</strong>       -.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">chatix-core</a></p><br>
<p>            -.      <strong>start()</strong>  <strong>getChatroom()</strong>.</p><br>
<p>     -,          <strong>App</strong>.    <strong>App </strong> callback- <code>updateChatroomTitle(chatroom.title)</code>     <strong>ChatixSDK</strong>.</p><br>
<p><strong>ChatixSDK</strong></p><br>
<pre><code class="plaintext hljs">class ChatixSDK extends React.Component {<font></font>
    constructor(props){<font></font>
        super(props);<font></font>
        const websiteId = "_WEBSITE_ID";<font></font>
        this.chatroomId = "_CHATROOM_ID";<font></font>
        this.sdk = new ChatixCore(websiteId);<font></font>
        this.sdk.start()<font></font>
            .then( async () =&gt; {<font></font>
                try {<font></font>
                    // refresh information about chatroom and call passed handler<font></font>
                    const chatroom = await this.sdk.getChatroom(this.chatroomId);<font></font>
                    if (props.updateChatroomTitle) {<font></font>
                        props.updateChatroomTitle(chatroom.title);<font></font>
                    }<font></font>
                } catch (err) {<font></font>
                    console.error(err);<font></font>
                }<font></font>
            })<font></font>
            .catch((e) =&gt; {<font></font>
                console.error(e);<font></font>
            });<font></font>
    }<font></font>
    render(){<font></font>
        return null;<font></font>
    }<font></font>
}</code></pre><br>
<p><code>this.chatroomId</code>         -.</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/57d/309/a77/57d309a77bb226589ba225c52cfe37d6.png" alt="ChatroomID"></p><br>
<p>  <strong>App</strong>   <strong>ChatixSDK</strong>      <code>updateChatroomTitle</code>     .     <code>ref</code>-,       .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">this.chatixSDK = React.createRef();</code></pre><br>
<pre><code class="plaintext hljs">setChatroomTitle = (newName) =&gt; {<font></font>
    const newStateFragment = { chatroomName: newName};<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
};</code></pre><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">render() {<font></font>
    return (<font></font>
        &lt;div className="App"&gt;<font></font>
            &lt;Header <font></font>
                chatroomName={this.state.chatroomName}<font></font>
                me={this.state.me}<font></font>
                updateVisitor={this.onUpdateVisitor}<font></font>
            /&gt;<font></font>
            &lt;Main<font></font>
                members={this.state.members}<font></font>
                messages={this.state.messages}<font></font>
                onSendNewMessage={this.onSendNewMessage}<font></font>
                me={this.state.me}<font></font>
            /&gt;<font></font>
            &lt;ChatixSDK <font></font>
                ref={this.chatixSDK}<font></font>
                updateChatroomTitle={this.setChatroomTitle}<font></font>
            /&gt;<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
  };</code></pre><br>
<p>.           ,          <strong>App</strong>,         ,      .          .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">chatroomName: ''</code></pre><br>
<p>      .<br>
          ,    <strong>ChatixSDK</strong>   <code>this.sdk.start()</code>    - ,         ,   .</p><br>
<p><strong>ChatixSDK</strong></p><br>
<pre><code class="plaintext hljs">const myChatrooms = await this.sdk.getMyChatrooms();<font></font>
if (myChatrooms.filter(x =&gt; x.id===this.chatroomId).length === 0) {<font></font>
    await this.sdk.connectToChatroom(this.chatroomId);<font></font>
}</code></pre><br>
<p>          -,       .</p><br>
<p><strong>ChatixSDK</strong></p><br>
<pre><code class="plaintext hljs">// lets get all chatroom members using infinite loop with break on empty server response<font></font>
let membersPage = 1;<font></font>
let allChatroomMembers = [];<font></font>
while(true) {<font></font>
    let pagedMembers = await this.sdk.getChatroomMembers(this.chatroomId, membersPage++, 10);<font></font>
    allChatroomMembers = [...allChatroomMembers, ...pagedMembers];<font></font>
    if (pagedMembers.length === 0) {<font></font>
        break;<font></font>
    }<font></font>
}</code></pre><br>
<p>           ,     —  .        -      callback .</p><br>
<p><strong>ChatixSDK</strong></p><br>
<pre><code class="plaintext hljs">if (props.setChatroomMembers) {<font></font>
    props.setChatroomMembers(allChatroomMembers);<font></font>
}</code></pre><br>
<p>   <strong>App</strong>   callback  <code>setChatroomMembers</code>        \          state.</p><br>
<p><strong>App.js</strong></p><br>
<pre><code class="plaintext hljs">setChatroomMembers = (members) =&gt; {<font></font>
    members.sort(this.sortMembers);<font></font>
    const newStateFragment = { members: members};<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
}</code></pre><br>
<p>   <strong>sortMembers</strong>.        .</p><br>
<p><strong>App.js</strong></p><br>
<pre><code class="plaintext hljs">sortMembers(a, b) {<font></font>
    if (a.is_online === true &amp;&amp; b.is_online === false) {<font></font>
      return -1;<font></font>
    } else if (b.is_online === true &amp;&amp; a.is_online === false) {<font></font>
      return 1;<font></font>
    } else {<font></font>
      if (a.name &amp;&amp; b.name) {<font></font>
        if (a.name.toLocaleUpperCase() &gt; b.name.toLocaleUpperCase()) {<font></font>
          return 1;<font></font>
        } else if (a.name.toLocaleUpperCase() &lt; b.name.toLocaleUpperCase()) {<font></font>
          return -1;<font></font>
        }<font></font>
      } else if (a.name &amp;&amp; !b.name) {<font></font>
        return -1;<font></font>
      } else if (!a.name &amp;&amp; b.name) {<font></font>
        return 1;<font></font>
      } <font></font>
      if (a.uuid &gt; b.uuid) {<font></font>
        return -1;<font></font>
      } else {<font></font>
        return 1;<font></font>
      }<font></font>
    }<font></font>
  }</code></pre><br>
<p>   <strong>setChatroomMembers</strong>  <strong>ChatixSDK</strong>.</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">render() {<font></font>
    return (<font></font>
        &lt;div className="App"&gt;<font></font>
            &lt;Header <font></font>
                chatroomName={this.state.chatroomName}<font></font>
                me={this.state.me}<font></font>
                updateVisitor={this.onUpdateVisitor}<font></font>
            /&gt;<font></font>
            &lt;Main<font></font>
                members={this.state.members}<font></font>
                messages={this.state.messages}<font></font>
                onSendNewMessage={this.onSendNewMessage}<font></font>
                me={this.state.me}<font></font>
            /&gt;<font></font>
            &lt;ChatixSDK <font></font>
                ref={this.chatixSDK}<font></font>
                updateChatroomTitle={this.setChatroomTitle}<font></font>
                setChatroomMembers={this.setChatroomMembers}<font></font>
            /&gt;<font></font>
        &lt;/div&gt;<font></font>
    );<font></font>
  };</code></pre><br>
<p>                        <strong>App</strong>.          .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">members: []</code></pre><br>
<p>                   <strong>App</strong></p><br>
<p><strong>ChatixSDK</strong></p><br>
<pre><code class="plaintext hljs">// lets load 100 last messages from current chatroom<font></font>
const lastMessages = await this.sdk.getChatroomMessages(this.chatroomId, null, 100);<font></font>
if (props.setChatroomMessages) {<font></font>
    props.setChatroomMessages(lastMessages);<font></font>
}<font></font>
<font></font>
if (props.setMe) {<font></font>
    const me = this.sdk.getVisitor();<font></font>
    this.props.setMe(me);<font></font>
}</code></pre><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">&lt;ChatixSDK <font></font>
    ref={this.chatixSDK}<font></font>
    setMe={this.setMe}<font></font>
    updateChatroomTitle={this.setChatroomTitle}<font></font>
    setChatroomMembers={this.setChatroomMembers}<font></font>
    setChatroomMessages={this.setChatroomMessages}<font></font>
/&gt;</code></pre><br>
<p>   .</p><br>
<p>   <strong>App</strong>    <code>onSendNewMessage</code>      .        <code>sendChatroomMessage</code>     <strong>ChatixSDK</strong>.<br>
          ,          .   ,   <strong>chatixSDK</strong>       <code>this.chatixSDK</code>.</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">onSendNewMessage = async (message) =&gt; {<font></font>
    let receivedMsg = await this.chatixSDK.current.sendChatroomMessage(message);<font></font>
<font></font>
    const currentMessages = this.state.messages;<font></font>
    currentMessages.push(receivedMsg);<font></font>
    const newStateFragment = {messages: currentMessages};<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
  }</code></pre><br>
<p>       ,       .                . </p><br>
<p>    <strong>MessageContainer</strong>    <strong>useEffect</strong>      ,           <strong>scrollHeight</strong>          </p><br>
<pre><code class="plaintext hljs">function MessageContainer(props) {<font></font>
    const messagesContainer = React.createRef();<font></font>
<font></font>
    useEffect(() =&gt; {<font></font>
        messagesContainer.current.scrollTop = messagesContainer.current.scrollHeight<font></font>
    }, [props, messagesContainer]);<font></font>
<font></font>
    const messageList = props.messages.map(message =&gt; <font></font>
        &lt;Message <font></font>
            key={message.uuid}<font></font>
            sender={props.members.find((member) =&gt; member.uuid === message.sender_id)} <font></font>
            message={message} /&gt;<font></font>
        );<font></font>
<font></font>
    return (<font></font>
        &lt;section className="MessageContainer" ref={messagesContainer}&gt;<font></font>
            {messageList}<font></font>
        &lt;/section&gt;<font></font>
    );<font></font>
}</code></pre><br>
<p>     .                 <strong>App</strong>      .    .        <code>this.chatixSDK.current.updateVisitor(user)</code>,     .        ,     <code>this.state.me</code>    <code>this.state.members</code>        .            .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">onUpdateVisitor = (user) =&gt; {<font></font>
    this.chatixSDK.current.updateVisitor(user)<font></font>
    this.setMe(user)<font></font>
    let currentUser = this.state.members.find((member) =&gt; (member.uuid === user.uuid))<font></font>
    let currentUserIndex = this.state.members.indexOf(currentUser)<font></font>
    let newMembers = [...this.state.members]<font></font>
    newMembers[currentUserIndex] = user;<font></font>
    this.setState({<font></font>
      members: newMembers<font></font>
    })<font></font>
}</code></pre><br>
<p>       , /       .</p><br>
<p>    <strong>ChatixSDK.js</strong>      callback .            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">chatix-core</a>.</p><br>
<p>   <strong>onChatroomMessageReceived</strong>, <strong>onMemberConnectedToChatroom</strong>, <strong>onMemberDisconnectedFromChatroom</strong>  <strong>onApplyVisitorInfo</strong>.</p><br>
<p>        callback    <strong>App</strong>.</p><br>
<pre><code class="plaintext hljs">this.sdk.onChatroomMessageReceived = (chatroomId, message) =&gt; {<font></font>
    if (chatroomId === this.chatroomId) {<font></font>
        this.props.onNewMessageReceived(message);<font></font>
    }<font></font>
};<font></font>
this.sdk.onMemberConnectedToChatroom = (chatroomId, member) =&gt; {<font></font>
    if (chatroomId === this.chatroomId &amp;&amp; props.addChatroomMember) {<font></font>
        this.props.addChatroomMember(member);<font></font>
    }<font></font>
};<font></font>
this.sdk.onMemberDisconnectedFromChatroom = (chatroomId, member) =&gt; {<font></font>
    if (chatroomId === this.chatroomId &amp;&amp; props.removeChatroomMember) {<font></font>
        this.props.removeChatroomMember(member);<font></font>
    }<font></font>
};<font></font>
this.sdk.onApplyVisitorInfo = (visitor) =&gt; {<font></font>
    this.props.onMemberUpdated(visitor)<font></font>
}</code></pre><br>
<p>   <strong>App</strong>    .</p><br>
<p><strong>onNewMessageReceived(message)</strong><br>
          state   .          ,        .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">onNewMessageReceived = (message) =&gt; {<font></font>
    const currentMessages = this.state.messages;<font></font>
    currentMessages.push(message);<font></font>
    const newStateFragment = {messages: currentMessages};<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
  }</code></pre><br>
<p><strong>App</strong><br>
<strong>addChatroomMember(member)</strong><br>
           state     members.              .</p><br>
<p><strong>App</strong></p><br>
<pre><code class="plaintext hljs">addChatroomMember = (member) =&gt; {<font></font>
    const newStateFragment = {};<font></font>
    const currentMembers = this.state.members;<font></font>
    currentMembers.push(member);<font></font>
    currentMembers.sort(this.sortMembers);<font></font>
    newStateFragment.members = currentMembers;<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
  }</code></pre><br>
<p><strong>App</strong><br>
<strong>removeChatroomMember(memberId)</strong><br>
        state     <strong>members</strong>  <strong>state</strong>.</p><br>
<pre><code class="plaintext hljs">removeChatroomMember = (memberId) =&gt; {<font></font>
    const currentMembers = this.state.members;<font></font>
    const filteredMembers = currentMembers.filter(x=&gt; x.uuid !== memberId);<font></font>
    const newStateFragment = {members: filteredMembers};<font></font>
    this.setState({...this.state, ...newStateFragment});<font></font>
  }</code></pre><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onMemberUpdated（updatedMember）</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この関数は、情報とビジターを更新します。</font><font style="vertical-align: inherit;">たとえば、彼の名前またはステータスが変更された場合。</font><font style="vertical-align: inherit;">識別子でこの</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態の</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーを探し</font><font style="vertical-align: inherit;">、更新された</font><font style="vertical-align: inherit;">ユーザーに</font><font style="vertical-align: inherit;">置き換えます。</font></font></p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリ</font></font></strong></p><br>
<pre><code class="plaintext hljs">onMemberUpdated = (updatedMember) =&gt; {<font></font>
    let oldMember = this.state.members.find(member =&gt; member.uuid === updatedMember.uuid);<font></font>
    oldMember = this.state.members.indexOf(oldMember);<font></font>
    let newStateMembers = this.state.members;<font></font>
    newStateMembers[oldMember] = updatedMember;<font></font>
<font></font>
    this.setState({<font></font>
      members: newStateMembers<font></font>
    })<font></font>
}</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、それらすべてを</font><strong><font style="vertical-align: inherit;">ChatixSDKに</font></strong><font style="vertical-align: inherit;">転送します</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></strong></p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChatixSDK</font></font></strong></p><br>
<pre><code class="plaintext hljs">&lt;ChatixSDK <font></font>
    ref={this.chatixSDK}<font></font>
    setMe={this.setMe}<font></font>
    updateChatroomTitle={this.setChatroomTitle}<font></font>
    setChatroomMembers={this.setChatroomMembers}<font></font>
    addChatroomMember={this.addChatroomMember} <font></font>
    removeChatroomMember={this.removeChatroomMember}<font></font>
    setChatroomMessages={this.setChatroomMessages}<font></font>
    onNewMessageReceived={this.onNewMessageReceived}<font></font>
    onMemberUpdated={this.onMemberUpdated} <font></font>
/&gt;</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">できた！</font><font style="vertical-align: inherit;">メッセージの送受信、ユーザーのリストの表示、ユーザーの接続/切断への応答、情報の更新ができるチャットを作成しました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事を準備した </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アレクセイソ</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加資料：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chatix SDK（ドキュメント）</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chatix SDK（npm）</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192ポッドキャストリリースWeb標準</font></font></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja474478/index.html">「機械学習」のあらすじ。数学的統計。最尤法</a></li>
<li><a href="../ja474480/index.html">テクノロジーが子供時代になかった場合に、テクノロジーを正しく使用するように子供たちに教えるにはどうすればよいですか？</a></li>
<li><a href="../ja474484/index.html">モックは松葉杖ではなく、モックは仕様です</a></li>
<li><a href="../ja474488/index.html">DotNextとHolyJSの無料放送</a></li>
<li><a href="../ja474490/index.html">時が来ました：Coclean鼻吸引の概要</a></li>
<li><a href="../ja474494/index.html">Zabbix Summit 2019はどうでしたか</a></li>
<li><a href="../ja474496/index.html">HighLoad ++ 2019上のデータベース</a></li>
<li><a href="../ja474498/index.html">JavaFXチュートリアル：Hello World</a></li>
<li><a href="../ja474500/index.html">Grafanaのプラグイン開発：ぬいぐるみの歴史</a></li>
<li><a href="../ja474502/index.html">Joker 2019でのOdnoklassniki解析</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>