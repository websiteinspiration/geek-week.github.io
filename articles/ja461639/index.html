<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧟 🏅 👷🏼 あなたの方法、グラフ：良いネットワークグラフが見つからず、独自のグラフを作成した方法 🈳 🧕🏾 🔣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Group-IBの専門家は、フィッシング、ボットネット、詐欺的なトランザクション、および犯罪者のハッカーグループを含むケースを調査して、あらゆる種類の接続を識別するために長年にわたってグラフ分析を使用しています。異なるケースには、独自のデータ配列、独自の接続識別アルゴリズム、および特定のタスクに合わ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>あなたの方法、グラフ：良いネットワークグラフが見つからず、独自のグラフを作成した方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/461639/"><img src="https://habrastorage.org/webt/5w/z_/im/5wz_imjcrurw4gk_wubv6gqanig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Group-IBの専門家は、フィッシング、ボットネット、詐欺的なトランザクション、および犯罪者のハッカーグループを含むケースを調査して、あらゆる種類の接続を識別するために長年にわたってグラフ分析を使用しています。異なるケースには、独自のデータ配列、独自の接続識別アルゴリズム、および特定のタスクに合わせて調整されたインターフェイスがあります。これらのツールはすべてGroup-IBの内部開発であり、従業員のみが利用できました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークインフラストラクチャのグラフ分析（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークグラフ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）は、会社のすべてのパブリック製品に組み込まれた最初の内部ツールになりました。</font><font style="vertical-align: inherit;">独自のネットワークグラフを作成する前に、市場で同様の開発を多数分析したところ、自社のニーズを満たす単一の製品は見つかりませんでした。</font><font style="vertical-align: inherit;">この記事では、ネットワークグラフの作成方法、使用方法、および発生した問題について説明します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドミトリー・ボルコフ、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CTOグループIB、サイバーインテリジェンス責任者</font></font><a name="habracut"></a><br>
<br>
<h1><font color="#e63619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Group-IBネットワークグラフでできること</font></font></font></h1><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2003年にGroup-IBが設立されてから現在に至るまで、サイバー犯罪者の身元を明らかにし、責任を負わせ、責任を負わせることが私たちの仕事の主な優先事項でした。攻撃者のネットワークインフラストラクチャを分析せずにサイバー攻撃を調査することはできません。私たちの旅の最初の頃、​​犯罪者を特定するのに役立つ関係を見つけるのはかなり手間がかかりました：ドメイン名、IPアドレス、サーバーのデジタルフィンガープリントなどの情報。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの攻撃者は、ネットワーク上で可能な限り匿名で行動しようとします。しかし、すべての人々のように、彼らは間違いを犯します。この分析の主な目的は、調査中の実際のインシデントで使用されている悪意のあるインフラストラクチャと交差する攻撃者の「白」または「灰色」の歴史的プロジェクトを見つけることです。 「白いプロジェクト」を検出できる場合、攻撃者を見つけることは、通常、簡単な作業になります。 「グレイ」の場合、所有者が登録データを匿名化または非表示にしようとするため、検索にはより多くの時間と労力がかかりますが、可能性は十分に高いままです。原則として、攻撃者は犯罪活動の開始時に自分の安全性に注意を向けず、過ちを犯します。そのため、歴史に深く踏み込むことができるほど、調査が成功する可能性が高くなります。そのため、良い履歴を持つネットワークグラフは、この調査の非常に重要な要素です。簡単に言えば、企業が保有する履歴データが深いほど、そのグラフは優れています。 5年間のストーリーが条件付きで10の犯罪のうち1-2を解決するのに役立ち、15年間のストーリーが10の犯罪すべてを解決する機会を与えると仮定します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィッシングと詐欺の検出</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フィッシング、詐欺、または海賊版のリソースへの疑わしいリンクを取得するたびに、関連するネットワークリソースのグラフを自動的に作成し、見つかったすべてのホストで同様のコンテンツの存在を確認します。</font><font style="vertical-align: inherit;">これにより、アクティブだったが不明な古いフィッシングサイトと、将来の攻撃に備えたがまだ使用されていないまったく新しいフィッシングサイトの両方を見つけることができます。</font><font style="vertical-align: inherit;">5つのサイトしかないサーバー上にフィッシングサイトが見つかりました。</font><font style="vertical-align: inherit;">それぞれをチェックすることで、他のサイトでもフィッシングコンテンツを見つけます。つまり、1ではなく5をブロックできます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックエンド検索</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロセスは、悪意のあるサーバーが実際に配置されている場所を確立するために必要です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カードショップ、ハッキングフォーラム、多くのフィッシングリソース、その他の悪意のあるサーバーの99％が、独自のプロキシサーバーと正当なサービスのプロキシ（Cloudflareなど）の両方の背後に隠れています。実際のバックエンドについて知ることは調査にとって非常に重要です。サーバーを削除できるホスティングプロバイダーが判明し、他の悪意のあるプロジェクトとの接続を確立することが可能になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、IPアドレス11/11/11/11に解決する銀行カードデータを収集するフィッシングサイトと、IPアドレス22.22.22.22に解決するカードショップアドレスがあるとします。</font><font style="vertical-align: inherit;">分析中に、フィッシングサイトとカードショップの両方に共通のバックエンドIPアドレス（33.33.33.33など）があることが判明する場合があります。</font><font style="vertical-align: inherit;">この知識により、フィッシング攻撃と、おそらく銀行カードのデータを販売するカードショップとの間にリンクを構築できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベント相関</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃を制御するために、マルウェアとサーバーが異なる2つの異なるトリガー（IDSなど）がある場合、それらを2つの独立したイベントと見なします。</font><font style="vertical-align: inherit;">しかし、悪意のあるインフラストラクチャ間に適切な接続がある場合、これらは異なる攻撃ではなく、1つのより複雑なマルチステージ攻撃のステージであることが明らかになります。</font><font style="vertical-align: inherit;">そして、イベントの1つがすでに攻撃者のグループに起因している場合、2番目のイベントも同じグループに起因する可能性があります。</font><font style="vertical-align: inherit;">もちろん、帰属プロセスははるかに複雑なので、文章を単純な例として扱います。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">濃縮指標</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはサイバーセキュリティでグラフを使用するための最も一般的なシナリオなので、あまり注意を払いません。1つの指標を入力に与え、関連する指標の配列を出力で取得します。 </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パターン検出</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
効果的な狩猟にはパターン識別が不可欠です。</font><font style="vertical-align: inherit;">グラフを使用すると、関連する要素を見つけるだけでなく、特定のグループのハッカーに固有の一般的なプロパティを明らかにすることもできます。</font><font style="vertical-align: inherit;">このような独自の機能を知ることにより、準備段階でも、フィッシングメールやマルウェアなどの攻撃を確認する証拠がなくても、攻撃者のインフラストラクチャを認識することができます。</font></font><br>
<br>
<h1><font color="#e63619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ独自のネットワークグラフを作成したのですか？</font></font></font></h1> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既存の製品にはない機能を実行できる独自のツールを開発する必要があるという結論に至る前に、さまざまなサプライヤーのソリューションを検討したことを繰り返します。</font><font style="vertical-align: inherit;">それを作成するのに数年かかりましたが、その間に私たちはそれを複数回完全に変更しました。</font><font style="vertical-align: inherit;">しかし、開発期間が長いにも関わらず、要件を満たす単一の類似体はまだ見つかっていません。</font><font style="vertical-align: inherit;">独自の製品を使用して、既存のネットワークグラフで見つかったほとんどすべての問題を解決することができました。</font><font style="vertical-align: inherit;">以下では、これらの問題を詳細に検討します。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th width="350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題</font></font></th>
<th width="350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定</font></font></th>
</tr>
<tr>
<td>     : , passive DNS, passive SSL, DNS-,  ,    , ,      IP-. .      , ,    ,     .          :   passive SSL     ,   CA,        .       ,       .</td>
<td>     . ,     SSL-    ,       CA,      IPv4-.      IP,          :      example.com    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.example.com</a>      IP 1.1.1.1,     SSL-   443  IP,          .               ,      IP-      « ».       « »,       ,   ,             . </td>
</tr>
<tr>
<td>      . .       ,               . ..       , ,    IP-,      —       . </td>
<td>        ,    ,    ,     (,    ),     .      ,  ,     .</td>
</tr>
<tr>
<td>        . . ,          ( ,   «»).     ,  «»       ,                .      ,     ,    . </td>
<td>    . ..     ,       ,     — .    ,     .      ,       ,               (. ).</td>
</tr>
<tr>
<td>   —       . . , « » (  )   ,     10   500  .          500      ,      . , ,   IP-     .  ,            .  ,  ,    ,    IP-         ,      ,      . </td>
<td>         ,      . ,     example.com,     IP 11.11.11.11,    —  IP 22.22.22.22.  IP 11.11.11.11,   example.com,   example.ru,   IP 22.22.22.22  25   . ,   , ,  11.11.11.11 — ,  ,  ,    example.ru     example.com, ,   ,       ;   IP 22.22.22.22  shared hosting,         ,    , ,  -   25      (, example.net).    ,           ,       ,     ,     . ,        (50 ),     ,      (5  )      ()     (),           .                ,                .<br>
</td>
</tr>
<tr>
<td>    , . .   « »    ,         .   bulletproof-      ,      ,     /     .     ,    IP 11.11.11.11    C&amp;C   ,   2      Ransomware.   ,    ,   ,     -    ,      .       .</td>
<td>     .     ,   whois        ,      whois,   .       ,       ,   .  SSL-   ,     ,     .       ,     ,     SSL- ,        2010 .       ,         -.     ,             .        ,     . </td>
</tr>
<tr>
<td> . .        ,  whois      ,    ,      IP-. ,     ,    ,     ,   «»,         .</td>
<td>      ,    ,  ,  .  ,   ,      ,               ,      ,  ,  .     ,     .<br>
</td>
</tr>
</tbody></table></div><br>
<h1><font color="#e63619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフのしくみ</font></font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークグラフの使用を開始するには、検索ボックスにSSL証明書のドメイン、IPアドレス、電子メール、またはフィンガープリントを入力する必要があります。</font><font style="vertical-align: inherit;">アナリストが制御できる条件は、時間、ステップ深度、およびクリーニングの3つです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tc/dp/fy/tcdpfyhagm1jh52ksaklg5ohsko.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時間-悪意のある目的で検索アイテムが使用された日付または間隔。</font><font style="vertical-align: inherit;">このパラメーターを指定しない場合、システムはこのリソースの所有権の最後の間隔を判別します。</font><font style="vertical-align: inherit;">たとえば、7月11日、Esetは</font><font style="vertical-align: inherit;">Buhtrapがサイバースパイ活動にゼロデイエクスプロイトをどのように使用するかについての</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">公開しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">レポートの最後には、6つの指標があります。</font><font style="vertical-align: inherit;">その1つであるセキュアテレメトリ[。]ネットが7月16日に再登録されました。</font><font style="vertical-align: inherit;">したがって、7月16日以降にグラフを作成すると、無関係な結果が返されます。</font><font style="vertical-align: inherit;">ただし、このドメインがこの日付より前に使用されたことが示された場合、グラフは126の新しいドメインを取得し、69のIPアドレスはEsetレポートにリストされていません。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ukrfreshnews [。] com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unian-search [。] com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vesti-world [。]情報</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">runewsmeta [。] com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foxnewsmeta [。] biz</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sobesednik-meta [。] info</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rian-ua [。] net</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や。。など。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークインジケーターに加えて、このインフラストラクチャへのリンクを持つ悪意のあるファイルへのリンクと、Meterpreter、AZORultが使用されたことを示すタグをすぐに見つけます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すばらしいのは、この結果が1秒で得られ、データの分析に何日も費やす必要がないことです。</font><font style="vertical-align: inherit;">もちろん、このアプローチは、調査に必要な時間を数倍短縮することがありますが、これはしばしば重要です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/oi/an/h4oianoutpvnbrb2f3hhukxxtge.png"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフが構築されるステップ数または再帰の深さ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、深さは3です。これは、探している要素から直接関連するすべての要素が見つかり、新しい各要素から新しい接続が他の要素に構築され、最後の手順の新しい要素から新しい要素が存在することを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APTとゼロデイエクスプロイトに関連しない例を見てみましょう。最近、Habréで、暗号通貨に関連する詐欺の興味深い事例について説明しました。レポートはドメインについて言及しています。themcx[。] Coは、詐欺師が取引所と思われるMiner Coin Exchangeのサイトをホストするために使用し、トラフィックを引き付けるために電話検索[。] Xyzを使用しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この説明から、このスキームでは、トラフィックを不正なリソースに引き付けるのに十分な規模のインフラストラクチャが必要であることは明らかです。</font><font style="vertical-align: inherit;">4つのステップでグラフを作成して、このインフラストラクチャを確認することにしました。</font><font style="vertical-align: inherit;">出力は、230のドメインと39のIPアドレスを持つグラフでした。</font><font style="vertical-align: inherit;">次に、ドメインを2つのカテゴリに分類します。暗号通貨を操作するためのサービスと同様のものと、電話検証サービスを通じてトラフィックをキャッチするように設計されたものです。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th width="350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号通貨関連</font></font></th>
<th width="350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電話パンチングサービスに関連</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コインキーパー[。] cc </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">発信者レコード[。]サイト。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mcxwallet [。] co</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電話レコード[。]スペース </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btcnoise [。] com</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fone-uncover [。] xyz</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリプトマイナー[。]時計</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">number-uncover [。] info</font></font></td>
</tr>
</tbody></table></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/cj/ve/yqcjvezppd6oulazlfojthyfqwk.png"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリーニング </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、「グラフのクリア」オプションが有効になっており、無関係な要素はすべてグラフから削除されます。</font><font style="vertical-align: inherit;">ちなみに、これまでのすべての例で使用されていました。</font><font style="vertical-align: inherit;">私は自然な質問を予測します：重要な何かが消えないようにする方法？</font><font style="vertical-align: inherit;">私は答えます：手動でグラフを作成したいアナリストの場合、自動クリーニングをオフにして、ステップ数= 1を選択できます。次に、アナリストは必要な要素からグラフを完成させ、タスクに関係のない要素をグラフから削除できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに分析グラフでは、whois、DNS、および開いているポートとそれらで実行されているサービスの変更履歴が利用可能になります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/wd/yz/hcwdyzowhht2vljiyxzcspjdgaa.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィッシング詐欺</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、数年間、さまざまな地域のさまざまな銀行の顧客に対してフィッシング攻撃を行った1つのAPTグループの行動を調査しました。このグループの特徴は、実際の銀行の名前に非常に類似したドメインの登録であり、ほとんどのフィッシングサイトは同じデザインであり、違いは銀行の名前とロゴのみでした。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8b/6v/st/8b6vstloohn7p-vq4wqngh-_ara.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、自動化されたグラフ分析が非常に役立ちました。</font><font style="vertical-align: inherit;">ドメインの1つであるlloydsbnk-uk [。] Comを使用して、数秒で深さ3ステップのグラフを作成しました。これにより、2015年以降このグループで使用され、引き続き使用されている250を超える悪意のあるドメインが特定されました。</font><font style="vertical-align: inherit;">これらのドメインの一部はすでに銀行によって購入されていますが、過去の記録によると、これらのドメインは以前に攻撃者に登録されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
わかりやすくするために、この図は2ステップの深さのグラフを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注目に値するのは、すでに2019年に攻撃者が戦術を少し変更し、Webフィッシングをホストする銀行のドメインだけでなく、フィッシングメールを送信するさまざまなコンサルティング会社のドメインも登録し始めたことです。</font><font style="vertical-align: inherit;">たとえば、ドメインswift-department.com、saudconsultancy.com、vbgrigoryanpartners.com。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/vs/5s/kvvs5sma6yo7kym8lq3fomys67e.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コバルトギャング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2018年12月、銀行に対する標的型攻撃を専門とするコバルトハッカーグループが、カザフスタン国立銀行に代わってニュースレターを発行しました。 </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/gs/57/gqgs57x9zvmfioavsfo5u-04p1k.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手紙にはhXXpsへのリンクが含まれていました：//nationalbank.bz/Doc/Prikaz.doc。</font><font style="vertical-align: inherit;">ダウンロード可能なドキュメントには、PowerShellを開始するマクロが含まれており、hXXpからファイルをダウンロードして実行しようとします：//wateroilclub.com/file/dwm.exe in％Temp％\ einmrmdmy.exe。</font><font style="vertical-align: inherit;">ファイル％Temp％\ einmrmdmy.exe（別名dwm.exe）は、hXXpサーバーと対話するように構成されたCobIntステージャーです：//admvmsopp.com/rilruietguadvtoefmuy。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのフィッシングメールを受信し、悪意のあるファイルを完全に分析する機会がないと想像してください。</font><font style="vertical-align: inherit;">Nationalbank [。] Bzの悪意のあるドメインのグラフはすぐに他の悪意のあるドメインとのリンクを示し、それをグループに帰属させ、攻撃で使用されたファイルを示します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wa/yv/rg/wayvrgnysrvft9tjv8p_apiwis4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このグラフからIPアドレス46.173.219 [。] 152を取得し、1つのパスでグラフを作成し、クリーニングをオフにします。</font><font style="vertical-align: inherit;">40のドメインが関連付けられています。たとえば、bl0ckchain [。] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ug paypal.co.uk.qlg6 [。] Pw </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cryptoelips [。] Com </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドメイン名から判断すると、それらは詐欺的なスキームで使用されているようですが、クリーニングアルゴリズムはこれを認識しましたそれらは攻撃とは関係がなく、グラフに配置しなかったため、分析と帰属プロセスが大幅に簡略化されました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/he/au/mt/heaumtr6jhhfktfn6qgjttwkzt0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nationalbank [。] Bzを使用してグラフを再構築するが、グラフのクリーンアップアルゴリズムを無効にすると、500を超える要素がグラフに含まれ、そのほとんどはCobaltグループまたはその攻撃に関連しません。</font><font style="vertical-align: inherit;">このようなグラフの例を以下に示します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pz/kc/f4/pzkcf4fyxxhaqmem5jzwb9ituti.png"></div><br>
<h1><font color="#e63619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数年間の微調整、実際の調査でのテスト、脅威の調査、攻撃者の狩猟を経て、独自のツールを作成するだけでなく、社内の専門家の態度を変えることに成功しました。当初、技術専門家はグラフの作成プロセスを完全に制御したいと考えています。自動グラフ作成が長年の経験を持つ人よりもこれをうまく行うことができると彼らに納得させることは非常に困難でした。すべては、時間と、グラフから得られた結果の複数の「手動」チェックによって決定されました。現在、私たちの専門家はシステムを信頼するだけでなく、それによって得られた結果を日常業務にも使用しています。このテクノロジーは、各システムの内部で機能し、あらゆる種類の脅威をより適切に特定できるようにします。手動グラフ分析のインターフェースは、すべてのGroup-IB製品に組み込まれており、サイバー犯罪の可能性を大幅に拡大します。これは、お客様からのフィードバックによって確認されています。そして、今度は、グラフをデータで充実させ、人工知能を使用して最も正確なネットワークグラフのための新しいアルゴリズムに取り組み続けます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461625/index.html">モバイル開発者向けの興味深い資料の要約＃308（7月22〜28日）</a></li>
<li><a href="../ja461629/index.html">リモート作業を見つけるための12のステップ</a></li>
<li><a href="../ja461631/index.html">会社の内部ネットワークに侵入する17の方法</a></li>
<li><a href="../ja461633/index.html">7月29日から8月4日までのモスクワでのデジタルイベント</a></li>
<li><a href="../ja461637/index.html">サウジアラビアの王子は、人工雨、スマートシステム、遺伝子医学で未来の都市を建設する計画</a></li>
<li><a href="../ja461641/index.html">pwnable.kr 11-coin1、12-ブラックジャック、13-lottoによる問題解決。アプリケーションロジックのエラー</a></li>
<li><a href="../ja461643/index.html">どのようにしてアルファ銀行システム分析スクールに行きましたか？</a></li>
<li><a href="../ja461645/index.html">SwiftUIの紹介：TableViewを使用した単純なアプリケーションの作成</a></li>
<li><a href="../ja461647/index.html">最高の開発者が必要とする5つの重要な欠落スキル</a></li>
<li><a href="../ja461649/index.html">どうやって世界を救うの</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>