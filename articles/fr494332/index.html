<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤞🏾 👩🏻‍🚒 👨🏿‍🤝‍👨🏽 Menace cachée - Analyse de vulnérabilité à l'aide de News Graph 🍺 🍬 👨🏿‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque vous êtes confronté à une nouvelle vulnérabilité, quelle est la première pensée? Bien sûr, répondez le plus rapidement possible. Cependant, la...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Menace cachée - Analyse de vulnérabilité à l'aide de News Graph</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494332/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque vous êtes confronté à une nouvelle vulnérabilité, quelle est la première pensée? Bien sûr, répondez le plus rapidement possible. Cependant, la vitesse n'est qu'une des conditions d'une lutte efficace contre les menaces à la sécurité de l'information. En matière de sécurité d'entreprise, il est tout aussi important de déterminer avec précision à quoi vous devez répondre en premier. Une menace sous-estimée peut entraîner une perte grave ou une perte de bonne volonté. Mais si le nombre de vulnérabilités ne cesse de croître, comment évaluer rapidement leur importance et ne pas rater des détails importants? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ox/fc/y7/oxfcy7piopfljg5ltpypkr4vswe.png"><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dynamique de vulnérabilité par groupe CVSS (source - vulners.com)</font></font></b></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour classer les vulnérabilités selon divers critères, le Score CVSS (Common Vulnerability Scoring System) est traditionnellement utilisé, classant les vulnérabilités selon divers critères, de la complexité d'exploitation aux dommages causés et à d'autres paramètres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semblerait, pourquoi trouver autre chose - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais le score CVSS a un point faible - il est basé sur des estimations d'experts qui ne sont pas étayées par de vraies statistiques.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il serait beaucoup plus efficace d'offrir aux experts des cas déjà sélectionnés selon certains critères quantitatifs et de prendre des décisions sur la base de données vérifiées - mais où obtenir ces données et que faire ensuite? </font><font style="vertical-align: inherit;">Cela ressemble à une tâche inhabituelle et intéressante pour un centre de données - et c'est ce défi qui m'a inspiré, moi et l'équipe Vulners, pour un nouveau concept d'évaluation et de classification des vulnérabilités basé sur un graphique d'informations connexes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi des graphiques? </font><font style="vertical-align: inherit;">Dans le cas des réseaux sociaux et des médias, les méthodes graphiques ont longtemps été utilisées avec succès à diverses fins: de l'analyse de la distribution du contenu dans le flux d'actualités aux notes sur l'influence des auteurs TOP sur les opinions des lecteurs et le regroupement des réseaux sociaux par intérêt. </font><font style="vertical-align: inherit;">Toute vulnérabilité peut être représentée sous forme de graphique contenant des données - des informations sur les changements dans les logiciels ou le matériel et les effets qui en découlent.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos des données</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas eu à collecter manuellement des informations sur chaque mise à jour, tous les textes nécessaires ont été trouvés dans la base de données de vulnérabilité ouverte vulners.com. Visuellement, les données sont les suivantes: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yy/61/kiyy61iatkc5gizf-mgvjvhuemw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque vulnérabilité, en plus de son nom, sa date de publication et sa description, a une famille (NVD, scanner, exploit, etc.) qui lui a déjà été affectée (notation CVD (CVSS est utilisé ci-après) v2), ainsi que des liens vers des actualités associées.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous présentez schématiquement ces connexions sous la forme d'un graphique, une vulnérabilité ressemblera à ceci: le cercle orange indique la publication source ou parent, les cercles noirs indiquent les actualités sur lesquelles vous pouvez cliquer lorsque vous êtes sur la page parent et les cercles gris représentent les actualités associées, accessibles par Vous ne pouvez parcourir que toutes les publications indiquées par des cercles noirs. Chaque couleur des cercles est un nouveau niveau du graphique des informations connexes, de zéro - la vulnérabilité d'origine, au premier, au second, etc.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/zy/ec/ypzyec3jcmj-mzjwbxeedgmliz4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, lors de la visualisation d'une nouvelle, nous ne connaissons que le zéro et le premier niveau.Par conséquent, pour obtenir toutes les données, nous avons utilisé la méthode de parcourir le graphique en profondeur, ce qui nous a permis de démêler l'enchevêtrement des nouvelles du début aux nœuds connectés les plus récents (ci-après dénommé le nœud de graphique). À ce stade, des problèmes d'optimisation sont apparus - l'assemblage de graphiques pendant une longue période a pris beaucoup de temps et a dû être conjuré à la fois avec un script et une structure de données. Soit dit en passant, j'ai décidé d'emballer les données finales dans du parquet pour continuer à travailler avec eux en utilisant spark sql, ce qui a grandement facilité l'analyse initiale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À quoi ressemblent les données du graphique? La visualisation nous aidera à mieux comprendre leur nature. La figure 4 montre un graphique de la vulnérabilité connue mais peu dangereuse de Heartbleed (seulement 5 points sur 10 sur l'échelle cvss).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/it/wn/vy/itwnvyfq5jbjor_vh2k436o7sy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant ce magnifique «bouquet» de nouvelles et d'exploits connexes, où le point rouge est la vulnérabilité d'origine, nous comprenons que Heartbleed a été considérablement sous-estimé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant cet exemple, nous pouvons conclure que la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systémicité, la durée et d'autres paramètres de vulnérabilité sont assez bien estimés à l'aide de métriques de graphique. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici quelques exemples de paramètres de recherche qui ont servi de base à une classification alternative:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre de nœuds dans le graphique - est responsable de la "largeur" ​​de la vulnérabilité, de la taille d'une trace laissée dans divers systèmes,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre de sous-graphes (grands groupes d'actualités) - est responsable de la granularité du problème ou de la présence de grandes zones problématiques au sein de la vulnérabilité,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre d'exploits et de correctifs associés - parle de l'explosion des informations et du nombre de fois où elles ont dû être "traitées", </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre de types et de familles d'actualités uniques dans le graphique concerne la systématique, c'est-à-dire le nombre de sous-systèmes affectés par l'impact de la vulnérabilité,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la durée entre la première publication et le premier exploit, le temps entre la première publication et les dernières nouvelles connexes - sur la nature temporelle de la vulnérabilité, qu'elle s'étende avec une grande «queue» de conséquences ou qu'elle se développe et s'efface rapidement.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, ce ne sont pas toutes des mesures; sous le capot de la recherche, il y a maintenant environ 30 indicateurs qui complètent l'ensemble de base des critères CVSS, y compris l'augmentation moyenne entre les niveaux du graphique de vulnérabilité des nouvelles, le pourcentage d'exploits au premier niveau du graphique, et bien plus encore. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ouvrez la zone grise</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, un peu de science des données et de statistiques - après tout, les hypothèses doivent être confirmées sur les données, n'est-ce pas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'expérience avec une échelle alternative et de nouvelles métriques, des nouvelles publiées en janvier 2019 ont été sélectionnées. </font><font style="vertical-align: inherit;">C'est 2403 newsletters et environ 150 000 lignes dans la colonne des news. </font><font style="vertical-align: inherit;">Toutes les vulnérabilités des sources ont été divisées en trois groupes selon le score CVSS:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Élevé - à partir de 8 points inclus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moyen - de 6 inclus à 8 points.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faible - moins de 6 points.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, voyons comment le score CVSS est corrélé avec le nombre de nouvelles liées dans le graphique, le nombre de types de nouvelles et le nombre d'exploits: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/qe/c2/owqec2zfiw8zt-_dyvtnjtc8sde.png"><br>
<br>
<img src="https://habrastorage.org/webt/l1/p-/k5/l1p-k5un_rkbwfmfu080vqlmtvs.png"><br>
<br>
<img src="https://habrastorage.org/webt/zj/gl/fi/zjglfivtyxofhraa6jmm5owapbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans l'image idéale, nous aurions dû voir une séparation claire des métriques en trois clusters, mais cela ne s'est pas produit, ce qui a indiqué la présence possible d'une zone grise, quel score CVSS ne définit pas - tel est notre objectif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'étape logique suivante a été le regroupement des vulnérabilités en groupes homogènes et la construction d'une nouvelle échelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la première itération, un classificateur métrique simple et des k-moyennes ont été choisis et une nouvelle matrice d'estimations a été obtenue: les points initiaux (Moyen, Bas, Haut) se trouvent sur l'axe Y, le long du X, où 2 sont les plus grands dans les nouvelles mesures de vulnérabilité, 1 sont les nouvelles vulnérabilités, 0 sont les plus petits.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rg/jn/5h/rgjn5hjig6emomnhlmrqgntzhkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une zone marquée d'un ovale (classe de vulnérabilité 2 avec une note initiale faible et moyenne) - Vulnérabilités potentiellement sous-estimées. La séparation en nouvelles classes semble également plus claire, ce que nous visions: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/aq/to/ec/aqtoecqvgy2qyukjhf34ipd-auu.png"><br>
<br>
<img src="https://habrastorage.org/webt/xd/y2/sv/xdy2svwhc4krnisetvm1momhnxs.png"><br>
<br>
<img src="https://habrastorage.org/webt/ym/mm/a6/ymmma6_1e5jlvjvxbpzcmw32c68.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cependant, simplement faire confiance aux modèles est une mauvaise idée, en particulier en ce qui concerne le clustering non supervisé, où la bonne réponse n'est pas connue en principe, et vous ne pouvez vous fier qu'aux métriques de séparation des classes obtenues. . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et c'est là que nous avons besoin de connaissances d'experts - car pour un bon test et une bonne interprétation des résultats, une connaissance du domaine est nécessaire. Par conséquent, il est souhaitable de vérifier le modèle point par point, par exemple, en retirant quelques vulnérabilités pour une analyse détaillée.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous trouverez ci-dessous quelques échantillons lumineux de la zone grise qui ont un faible score CVSS, mais un score graphique élevé - ce qui signifie potentiellement nécessiter une priorité différente pour travailler avec eux. Voici à quoi ils ressemblent dans une représentation graphique: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-0555 (score CVSS 4.4, classe graphique 2 haut) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/-f/cw/cv/-fcwcvutdlxwbhr5vzssit9-sfo.png"><br>
<br>
<img src="https://habrastorage.org/webt/xd/sb/s8/xdsbs8dp50therk8skdlmirjo6s.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMB_NT_MS19_JAN_DOTNET.NASL (score CVSS 5.0, classe graphique 2 haut) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/qm/rw/wx/qmrwwxlbgojb4sbp8fwmv8mbyxy.png"><br>
<br>
<img src="https://habrastorage.org/webt/9k/zd/dc/9kzddcv5w5e8vaomjiyccipzys8.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-1653 (score CVSS 5.0, classe graphique) 2 - élevé) </font></font><br>
</b><br>
<img src="https://habrastorage.org/webt/jo/2u/b3/jo2ub3swkh-wqk55u0hvucfhbns.png"><br>
<br>
<img src="https://habrastorage.org/webt/uh/hq/ha/uhhqhadk3ozdud7tdpvw2toywxc.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RHSA-2019: 0130 (score CVSS 5.0, classe de graphique 2 - élevé)</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/jw/xv/l_/jwxvl_pzzvyy_tdxuwfy8pn5bwc.png"><br>
<br>
<img src="https://habrastorage.org/webt/nm/wr/iv/nmwriv0gehjf9mjz6zzoqxdcl6w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que le concept ait été confirmé par des statistiques et des vérifications ponctuelles, donc dans un avenir proche, nous voulons affiner et automatiser la collecte de métriques de graphique, et - peut-être - le classificateur lui-même. </font><font style="vertical-align: inherit;">Bien sûr, il y a encore beaucoup de travail à faire - de la collecte d'un grand nombre de nouveaux graphiques pendant des mois non couverts dans l'étude, mais cela ne fait qu'ajouter de l'enthousiasme, tout comme l'essentiel de la tâche. </font><font style="vertical-align: inherit;">En tant que scientifique des données, je peux dire que le travail sur cette étude a été une expérience incroyablement inspirante, à la fois en termes de sujet et de complexité - même un travail d'ingénierie préparatoire avec des données mal structurées était très intéressant.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">finalement</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment passer d'une évaluation d'expert à des chiffres réels et évaluer l'inestimable? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'étude, il est devenu clair que, tout d'abord, une approche critique est nécessaire non seulement pour toute métrique ou donnée, mais pour le processus dans son ensemble, car le monde est trop dynamique et change plus rapidement que les méthodologies et la documentation. Toujours évalué dans un sens - pourquoi ne pas essayer de changer l'angle de vue? Comme le montre notre exemple, même les hypothèses les plus inhabituelles peuvent être confirmées.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un rôle important est joué par la disponibilité des données pour les data-entistes - il vous permet de vérifier rapidement les hypothèses les plus audacieuses et de mieux comprendre l'essence de votre domaine dans toutes ses manifestations. </font><font style="vertical-align: inherit;">Par conséquent, si vous ne collectez pas ou ne supprimez pas encore de données «inutiles», pensez-y, il y a peut-être beaucoup de découvertes qui se cachent là. </font><font style="vertical-align: inherit;">Ce cas suggère que les données et la sécurité de l'information se complètent parfaitement.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494310/index.html">Numéro 34: Formation informatique - problèmes et défis actuels des grandes entreprises</a></li>
<li><a href="../fr494314/index.html">«Faire défiler les GOST ennuyeux ...» ou analyse des exigences lors du développement d'un pilote LED</a></li>
<li><a href="../fr494316/index.html">Analyseurs Pratt pour les nuls</a></li>
<li><a href="../fr494318/index.html">Comment obtenez-vous 1024 couleurs en CGA? Et y en a-t-il vraiment 1024?</a></li>
<li><a href="../fr494322/index.html">Concours: montrez votre bureau à domicile et gagnez PS4 *</a></li>
<li><a href="../fr494334/index.html">Applications Web progressives. Guide d'action</a></li>
<li><a href="../fr494336/index.html">Boîte à outils frontale: utilitaires et fonctionnalités utiles pour accélérer le développement</a></li>
<li><a href="../fr494338/index.html">Sauvegardes à partir de WAL-G. Qu'y a-t-il en 2019? Andrey Borodin</a></li>
<li><a href="../fr494340/index.html">Microservices - explosion combinatoire de versions</a></li>
<li><a href="../fr494342/index.html">Étude: la formation parfaite pour un professionnel de l'informatique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>