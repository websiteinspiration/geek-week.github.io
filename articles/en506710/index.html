<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèçÔ∏è ‚òùüèæ ‚ôíÔ∏è Manage multiple address books in the Zimbra Collaboration Suite Open-Source Edition üòï ‚òùüèø ü§∑üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The global address book in Zimbra OSE is implemented using a separate galsync system account, which is available on each Zimbra OSE mail domain. Infor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Manage multiple address books in the Zimbra Collaboration Suite Open-Source Edition</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/506710/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The global address book in Zimbra OSE is implemented using a separate galsync system account, which is available on each Zimbra OSE mail domain. Information about each user in the domain has been added to the contact list of this account, while domain users have access to this list of addresses and can use it to search for users and autocomplete when typing an email address.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This implementation of the global address book makes it possible to simplify the import of new data into it, but by default it works within only one domain. Large companies often use separate mail domains for different divisions or subsidiaries and often there is a need to have a common global address book, which would contain the mail addresses and user data of several or even all company domains.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/xi/ie/opxiieyaijocgswpkt2td6f4-u0.png" alt="image"><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to combine the contact lists of galsync accounts from different mail domains, you need to configure their synchronization. Using the msk.company.ru and spb.company.ru domains as examples, we‚Äôll configure a common address book for the company‚Äôs branches in Moscow and St. Petersburg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, the galsync account in Zimbra OSE domains has a suffix that is a random set of numbers and letters. This can make it difficult for us to work with it in the future, and therefore, first delete the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galsync.kf9song4@msk.company.ru</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> account </font><font style="vertical-align: inherit;">, and then create a new </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galsync @ msk company.ru</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using the following commands:</font></font><br>
<br>
<pre><code class="plaintext hljs">zmgsautil deleteAccount -a galsync.kf9song4@msk.company.ru<font></font>
zmgsautil createAccount -a galsync@msk.company.ru -n GAL --domain msk.company.ru -t zimbra -s mail.company.ru -f GAL</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We draw your attention to the fact that the galsync account should never be deleted in the same way as a regular account. This will cause Zimbra OSE to constantly report an error when trying to access a domain that was left without a galsync account. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, add a new SPB data source to the galsync account of the Moscow domain, the contacts from which will be automatically added to the _SPB contacts folder. This is done using the command </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmgsautil addDataSource -a galsync@msk.company.ru -n SPB --domain msk.company.ru -t ldap -f _SPB -p 1d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the source of information, specify the domain spb.company.ru and set a filter to search for contacts:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov mds galsync @ msk. = zimbraDistributionList) (! (zimbraHideInGAL = TRUE)))) 'zimbraGalSyncLdapSearchBase dc = spb, dc = company, dc = ru zimbraGalSyncLdapURL ldap: //192.168.0.15: 389</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it remains only to turn on the contact source added by us </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov mds galsync@msk.company.ru SPB zimbraDataSourceEnabled TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and force the first synchronization using the command </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmgsautil forceSync -a galsync@msk.company.ru -n SPB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To make sure that contacts synchronization between global address books works, you can check the contents of the _SPB folder that we just created&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmmailbox -z -m galsync@msk.company.ru gaf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">If everything is in order, it remains only to enter the command&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov md msk.company.ru zimbraGALMode both</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;and check how autocomplete works when dialing contacts from the St. Petersburg domain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the event that you need users of the spb.company.ru domain to also see users of the msk.company.ru domain, you will need to do the same, but swap the domains:</font></font><br>
<br>
<b><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmgsautil addDataSource -a galsync@spb.company.ru -n MSK --domain spb.company.ru -t ldap -f _MSK -p1d</font></font></li>
<li>zmprov mds galsync@spb.company.ru SPB zimbraGalSyncLdapBindDn $zimbra_ldap_userdn zimbraGalSyncLdapBindPassword $zimbra_ldap_password zimbraGalSyncLdapFilter '(|(&amp;(mail=*)(zimbraAccountStatus=active)(!(zimbraHideInGAL=TRUE)))(&amp;(mail=*)(objectClass=zimbraDistributionList)(!(zimbraHideInGAL=TRUE))))' zimbraGalSyncLdapSearchBase&nbsp;dc=msk,dc=company,dc=ru zimbraGalSyncLdapURL ldap://192.168.0.15:389</li>
<li>zmprov mds galsync@spb.company.ru MSK zimbraDataSourceEnabled TRUE</li>
<li>zmgsautil forceSync -a galsync@spb.company.ru -n MSKzmmailbox -z -m galsync@spb.company.ru gaf</li>
<li>zmprov md spb.company.ru zimbraGALMode both</li>
</ol></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The number of data sources in your galsync account is unlimited. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can add new contact sources for your galsync account in the administration console. However, in order to do this, you still have to work on the command line anyway. To, for example, add contacts from a branch in Kaluga to galsync of a Moscow domain, use the command&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmgsautil addDataSource -a galsync@msk.company.ru -n KLG --domain msk.company.ru -t ldap -f _KLG -p 1d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> add a KLG data source and a folder for them called _KLG.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/cb/w5/wbcbw5hkl0jlhblzzhjow6sg4wu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, in the admin console, go to Settings - Domains - configure GAL, select the KLG source in the global address book settings wizard that opens and enter all the necessary parameters into it, similar to those used in previous examples. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hz/2m/7u/hz2m7uz_n9oqktc_-lnamg7dv5m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also connect Active Directory as an external contact source. </font><font style="vertical-align: inherit;">This is done in the same way as in the case of regular LDAP: an AD data source is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">created</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><b><font style="vertical-align: inherit;">zmgsautil addDataSource -a galsync@msk.company.ru -n AD --domain msk.company.ru -t ldap -f _AD -p 1d</font></b><font style="vertical-align: inherit;"> , and then the search filter and data for autocomplete are indicated in the administration console.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For all questions related to the Zextras Suite, you can contact the representative of the company "Zextras" Ekaterina Triandafilidi by e-mail katerina@zextras.com</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506700/index.html">We configure GitHub Actions for Android with the subsequent deployment in PlayMarket</a></li>
<li><a href="../en506702/index.html">The most reliable HDDs according to Backblaze Q1 2020</a></li>
<li><a href="../en506704/index.html">Why write in PHP in 2020? Holivarim is an interactive podcast on Youtube this Thursday</a></li>
<li><a href="../en506706/index.html">The performance of modern Java when working with large amounts of data, part 1</a></li>
<li><a href="../en506708/index.html">VPN / Mikrotik two-factor authentication - simple and scalable</a></li>
<li><a href="../en506716/index.html">Multithreaded Linear List: Element Existence Problem, Productivity Improvement, and STL Relation</a></li>
<li><a href="../en506726/index.html">Experience in using Rutoken technology for registration and authorization of users in the system (part 2)</a></li>
<li><a href="../en506730/index.html">Snort or Suricata. Part 1: choose a free IDS / IPS to protect the corporate network</a></li>
<li><a href="../en506732/index.html">Organization-wide reuse of UI components</a></li>
<li><a href="../en506734/index.html">Transient calculations in electrical networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>