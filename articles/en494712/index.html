<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ó üë©üèæ‚Äç‚öñÔ∏è üç¨ 5 best practices for using React hooks in production üñ§ üßëüèø‚Äçü§ù‚Äçüßëüèæ ‚òÄÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the article, the translation of which we are publishing today, says that commercetools adopted React hooks at the beginning of 2019 - at...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>5 best practices for using React hooks in production</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/494712/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The author of the article, the translation of which we are publishing today, says that </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commercetools</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adopted </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React hooks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the beginning of 2019 - at the time they appeared in React 16.8.0. </font><font style="vertical-align: inherit;">Since then, the company's programmers have been constantly processing their code, translating it into hooks. </font><font style="vertical-align: inherit;">React hooks allow you to use component state and use other React features without using classes. </font><font style="vertical-align: inherit;">Using hooks, you can, when working with functional components, ‚Äúconnect‚Äù to the events of the component life cycle and respond to changes in their state.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/dp/fq/jr/dpfqjrae_1gxg8w2fhzc6izgffa.jpeg"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Briefly about the results of implementing hooks</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If in a nutshell to talk about what the hooks gave us, it turns out that they helped to simplify the code base by extracting the logic from the components and facilitating the composition of different capabilities. </font><font style="vertical-align: inherit;">Moreover, the use of hooks has led to the fact that we have learned a lot. </font><font style="vertical-align: inherit;">For example, to how to better structure your code through continuous improvement of existing functionality. </font><font style="vertical-align: inherit;">We are sure that we will learn many more interesting things while continuing to work with React hooks.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strengths of hook implementation</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what the introduction of hooks gave us:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Improving code readability. </font><font style="vertical-align: inherit;">This is possible thanks to the use of smaller component trees than before. </font><font style="vertical-align: inherit;">The creation of such component trees is facilitated by our desire to abandon rendering properties and higher-order components.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Improving code debugging capabilities. </font><font style="vertical-align: inherit;">We had at our disposal an improved visual representation of the code and additional debugging information provided by the React developer tools.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Improving the modularity of the project. </font><font style="vertical-align: inherit;">Due to the functional nature of hooks, the process of creating and applying logic suitable for repeated use has been simplified.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separation of responsibilities. </font><font style="vertical-align: inherit;">React components are responsible for the appearance of the interface elements, and hooks provide access to the encapsulated program logic.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we want to share our recommendations on the use of hooks in production.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Timely retrieve hooks from components and create custom hooks</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starting to use hooks in functional components is pretty easy. </font><font style="vertical-align: inherit;">For example, we quickly applied somewhere </font></font><code>React.useState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, somewhere - </font></font><code>React.useEffect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and continued to do our job. </font><font style="vertical-align: inherit;">This approach, however, does not allow to take full advantage of all the opportunities that hooks are capable of giving. </font><font style="vertical-align: inherit;">Presenting </font></font><code>React.useState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the form of a small </font></font><code>use&lt;StateName&gt;State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><code>React.useEffect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- in the form </font></font><code>use&lt;EffectName&gt;Effect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we were able to achieve the following:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Components are smaller than with regular hooks.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hooks can be reused in various components.</font></font></li>
<li>,         React,  ,    . ,   <code>State&lt;StateName&gt;</code>   <code>State</code>.        <code>React.useState</code>,     .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Retrieving hooks also contributes to the fact that reusable and shared logic is more visible in various parts of the application. Similar or duplicate logic is more difficult to notice if you only use hooks built into the component code. The resulting hooks can be small in size and contain very little code - like </font></font><code>useToggleState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. On the other hand, larger hooks, like </font></font><code>useProductFetcher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, can now include more functionality. Both of these helped us simplify the code base by reducing the size of React components.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following example creates a small React hook designed to control the selection of elements. </font><font style="vertical-align: inherit;">The benefits of encapsulating this functionality become apparent immediately after you realize how often such logic is used in the application. </font><font style="vertical-align: inherit;">For example, to select a set of orders from a list.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//  </span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Component</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> [selected, setSelected] = React.useState()
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> select = React.useCallback(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> setSelected(<span class="hljs-comment">/** ... */</span>), [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selected,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setSelect<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;])<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> <span class="hljs-attr">selectedIds</span>=<span class="hljs-string">{selected}</span> <span class="hljs-attr">onSelect</span>=<span class="hljs-string">{id</span> =&gt;</span> select(id)} /&gt;</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   </span><font></font>
<font></font>
<span class="hljs-keyword">const</span> useSelection = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> [selected, setSelected] = React.useState()
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> select = React.useCallback(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> setSelected(<span class="hljs-comment">/** ... */</span>), [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selected,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setSelect<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;])<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> [selected, select]<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Component</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> [selected, select] = useSelection()<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> <span class="hljs-attr">selectedIds</span>=<span class="hljs-string">{selected}</span> <span class="hljs-attr">onSelect</span>=<span class="hljs-string">{id</span> =&gt;</span> select(id)} /&gt;</span><font></font>
}<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. About the benefits of React.useDebugValue</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The standard </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React.useDebugValue</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hook </font><font style="vertical-align: inherit;">refers to the little-known React features. </font><font style="vertical-align: inherit;">This hook can help the developer during the debugging of the code; it can be useful for using it in hooks designed for sharing. </font><font style="vertical-align: inherit;">These are user hooks that are used in many components of the application. </font><font style="vertical-align: inherit;">However, it is </font></font><code>useDebugValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not recommended to use it in all user hooks, since the built-in hooks already log standard debug values.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine creating a custom hook designed to make a decision about the need to enable some feature of the application. </font><font style="vertical-align: inherit;">The application state data on which the decision is based can come from different sources. </font><font style="vertical-align: inherit;">They can be stored in a React context object, access to which is organized through </font></font><code>React.useContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to help the developer in debugging, while working with React developer tools, it may be useful to know about the analyzed flag name ( </font></font><code>flagName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and the variant of the flag value ( </font></font><code>flagVariation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">In this case, using a small hook can help us </font></font><code>React.useDebugValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFeatureToggle</span>(<span class="hljs-params">flagName, flagVariation = true</span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> flags = React.useContext(FlagsContext)
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> isFeatureEnabled = getIsFeatureEnabled(flagName, flagVariation)(flags)<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;React.useDebugValue({<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flagName,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flagVariation,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">isEnabled</span>: isFeatureEnabled<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;})<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> isFeatureEnabled<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, working with the tools of the React developer, we can see information about the option of the flag value, about the flag name, and whether or not the feature of interest to us is turned on.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a37/b3d/78c/a37b3d78c562b28184abd5d5a8fe1c93.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Working with React developer tools after applying the React.useDebugValue hook</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Note that in cases when user hooks use standard hooks like</font></font><code>React.useState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or</font></font><code>React.useRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, such hooks already log the corresponding status or ref-object data. </font><font style="vertical-align: inherit;">As a result, the use of view constructs here</font></font><code>React.useDebugValue({ state })</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is not particularly useful.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. The combination and composition of hooks</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When we began to implement hooks in our work and began to use more and more hooks in components, it quickly turned out that 5-10 hooks could be present in the same component. In this case, hooks of various types were used. For example, we could use 2-3 hooks </font></font><code>React.useState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then a hook </font></font><code>React.useContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(say, to get information about the active user), a hook </font></font><code>React.useEffect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and also hooks from other libraries, like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">react-router</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">react-intl</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above was repeated again and again, as a result, even very small components were not so compact. In order to avoid this, we began to extract these individual hooks into user hooks, the device of which depended on the component or some application capability.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine an application mechanism aimed at creating an order. </font><font style="vertical-align: inherit;">When developing this mechanism, many components were used, as well as hooks of various types. </font><font style="vertical-align: inherit;">These hooks can be combined as a custom hook, increasing the usability of the components. </font><font style="vertical-align: inherit;">Here is an example of combining a set of small hooks in one hook.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OrderCreate</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orderCreater,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orderFetcher,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationContext,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goToNextStep,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pendingOrder,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updatePendingChanges,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;revertPendingChanges<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;} = useOrderCreate()<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> (<span class="hljs-comment">/** ...children */</span>)<font></font>
}<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Comparison of React.useReducer and React.useState</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We often resorted to </font></font><code>React.useState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as a standard hook for working with the state of components. However, over time, the state of the component may need to be complicated, which depends on the new requirements for the component, like the presence of several values ‚Äã‚Äãin the state. In certain cases, use </font></font><code>React.useReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can help avoid the need to use multiple values ‚Äã‚Äãand simplify the logic of updating the state. Imagine state management when making HTTP requests and receiving responses. To do this, you may need to work with values ‚Äã‚Äãsuch as </font></font><code>isLoading</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Instead, the state can be controlled using a reducer, having at its disposal various actions to manage state changes. </font><font style="vertical-align: inherit;">This approach, ideally, encourages the developer to perceive the state of the interface in the form of a state machine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The reducer transmitted </font></font><code>React.useReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is similar to the reducers used in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , where the system receives the current state of the action and should return the next state. </font><font style="vertical-align: inherit;">The action contains information about its type, as well as data on the basis of which the next state is formed. </font><font style="vertical-align: inherit;">Here is an example of a simple reducer designed to control a certain counter:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> initialState = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> reducer = <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">switch</span> (action) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">case</span> <span class="hljs-string">'increment'</span>: <span class="hljs-keyword">return</span> state + <span class="hljs-number">1</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">case</span> <span class="hljs-string">'decrement'</span>: <span class="hljs-keyword">return</span> state - <span class="hljs-number">1</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">case</span> <span class="hljs-string">'reset'</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span>: <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Unexpected action'</span>);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This reducer can be tested in isolation and then used in the component using </font></font><code>React.useReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Component</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> [count, dispatch] = React.useReducer(reducer, initialState);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> (
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{count}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch('increment')}&gt;+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch('decrement')}&gt;-1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch('reset')}&gt;reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;);<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we can apply what we examined in the previous three sections, namely, we can extract everything into </font></font><code>useCounterReducer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This will improve the code by hiding action type information from a component that describes the appearance of an interface element. </font><font style="vertical-align: inherit;">As a result, this will help prevent leakage of implementation details into the component, and will also give us additional opportunities for debugging code. </font><font style="vertical-align: inherit;">Here's what the resulting custom hook and the component using it will look like:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> CounterActionTypes = {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">Increment</span>: <span class="hljs-string">'increment'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">Decrement</span>: <span class="hljs-string">'decrement'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">Reset</span>: <span class="hljs-string">'reset'</span>,<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> useCounterReducer = <span class="hljs-function">(<span class="hljs-params">initialState</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> [count, dispatch] = React.useReducer(reducer, initialState);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> increment = React.useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> dispatch(CounterActionTypes.Increment));
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> decrement = React.useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> dispatch(CounterActionTypes.Decrement));
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> reset = React.useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> dispatch(CounterActionTypes.Reset));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increment,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrement<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Component</span>(<span class="hljs-params"></span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> {count, increment} = useCounterReducer(<span class="hljs-number">0</span>);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> (
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{count}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;);<font></font>
};<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Gradual implementation of hooks</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first glance, the idea of ‚Äã‚Äãgradually introducing hooks may not seem entirely logical, but here I suggest that those who think so simply follow my reasoning. Over time, various patterns find application in the codebase. In our case, these patterns include higher-order components, rendering properties, and now hooks. When translating a project to a new pattern, developers do not seek to instantly rewrite all the code, which, in general, is almost impossible. As a result, you need to develop a plan for transferring the project to React hooks, which does not include major changes to the code. This task can be very difficult, since making changes to the code usually leads to an increase in its size and complexity. By introducing hooks, we strive to avoid this.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our codebase uses class-based components and functional components. Regardless of which component was used in a certain situation, we sought to share logic through React hooks. First, we implement the logic in hooks (or repeat the existing implementation of certain mechanisms in them), then create small components of a higher order, inside which these hooks are used. After that, these higher-order components are used to create class-based components. As a result, we have at our disposal logic located in one place, which can be used in components of various kinds. Here is an example of implementing hook functionality in components through higher order components.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> injectTracking = <span class="hljs-function">(<span class="hljs-params">propName = <span class="hljs-string">'tracking'</span></span>) =&gt;</span> <span class="hljs-function"><span class="hljs-params">WrappedComponent</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> WithTracking = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> tracking = useTracking();<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> trackingProp = {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[propName]: tracking,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} {<span class="hljs-attr">...trackingProp</span>} /&gt;</span></span>;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;};<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;WithTracking.displayName = wrapDisplayName(WrappedComponent, <span class="hljs-string">'withTracking'</span>);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> WithTracking;<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> injectTracking;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This shows the implementation of hook functionality </font></font><code>useTracking</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in a component </font></font><code>WrappedComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This, by the way, allowed us, among other things, to separate the tasks of implementing hooks and rewriting tests in the old parts of the system. </font><font style="vertical-align: inherit;">With this approach, we still have at our disposal mechanisms for using hooks in all parts of the code base.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here were some examples of how using React hooks improved our codebase. </font><font style="vertical-align: inherit;">We hope that hooks can benefit your project as well. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do you use React hooks?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494692/index.html">Painless injections with 4D needles</a></li>
<li><a href="../en494700/index.html">Scenarios of infection in specific cities based on the dataset of movement of people across Russia</a></li>
<li><a href="../en494702/index.html">The digest of fresh materials from the world of the front-end for the last week No. 408 (March 23 - 29, 2020)</a></li>
<li><a href="../en494704/index.html">CMI5, or Life after SCORM</a></li>
<li><a href="../en494710/index.html">Use of modern graphic formats in web projects</a></li>
<li><a href="../en494714/index.html">On the positive impact of variable fonts on web project performance</a></li>
<li><a href="../en494716/index.html">All about the auto keyword in CSS</a></li>
<li><a href="../en494718/index.html">News from the world of OpenStreetMap No. 504 (10.03.2020-16.03.2020)</a></li>
<li><a href="../en494720/index.html">My cheat sheet by pandas</a></li>
<li><a href="../en494722/index.html">The first preview version of Microsoft PowerShell 7.1 for Windows, Linux and macOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>