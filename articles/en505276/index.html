<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóëÔ∏è ‚úãüèº üë®‚Äçüë®‚Äçüë¶ How we taught ABBYY FineReader PDF to edit whole paragraphs üå≤ üïñ üë≥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we updated ABBYY FineReader 15 and released it under the brand name ABBYY FineReader PDF, because it combines all the tools for working with PDF...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How we taught ABBYY FineReader PDF to edit whole paragraphs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/abbyy/blog/505276/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/hq/-t/wt/hq-twtcok_jqneo-xxhjyh3nep8.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today we updated ABBYY FineReader 15 and released it under the brand name ABBYY FineReader PDF, because it combines all the tools for working with PDF. On this occasion, we publish the first post in a series of materials about the features of the program. In it we will talk about one interesting opportunity that has been in the program for several months, but perhaps not everyone knew about it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How long have you opened PDFs? We bet that recently. Most likely, on your computer there will definitely be a couple of scans, and maybe also a presentation layout, an analytical study or technical instruction. What tasks do these documents usually use? According </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the ABBYY survey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 62% of respondents look for information in PDF, 60% - copy the text from the document, and 52% - edit: make corrections to the file, correct errors and typos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Even now, not everyone knows that you can edit text in PDF. Yes, changing such files does not work like editing a regular text document. ABBYY FineReader PDF with a multifunctional text editor for working with PDF and scans allows you to quickly make changes directly to PDF, without the tedious conversion of the file to other formats. When editing text in PDF smoothly flows from line to line, as in MS Word. You can add or delete multiple words, change entire paragraphs, or even swap them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this post we will reveal the technical details of editing multi-line text fragments in FineReader: how we changed the program engine, how editing is arranged from the inside and how it looks for the user. Go!</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PDF format is used all over the world: its contents are equally displayed on any computers, smartphones and tablets with different operating systems. </font><font style="vertical-align: inherit;">It is convenient and helps to avoid embarrassing situations. </font><font style="vertical-align: inherit;">For example, when you wrote a text in MS Word, sent it to colleagues, and they open it with LibreOffice or Wordpad, </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and everything went</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and the fun begins. </font><font style="vertical-align: inherit;">PDF, of course, is more convenient in this regard, but with the text everything is complicated here. </font><font style="vertical-align: inherit;">70% of all existing PDF documents have text, and 30% do not, because they are images. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's talk first about the PDF, in which the text is. </font><font style="vertical-align: inherit;">To edit a PDF, you need to understand how the text is written in it. </font><font style="vertical-align: inherit;">Have you ever opened a PDF in notepad? </font><font style="vertical-align: inherit;">If yes, then you saw this:</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3g/03/it/3g03itpug3txytf6jvayroi2xhk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order for all this to be displayed clearly for the user, a lot of work needs to be done. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Task: understand pdf</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The content of each page in a PDF file is stored in the form of streams of commands for drawing a document - it can be text, images or vector graphics. The structure of the file is determined by PDF objects, for example, page, picture, comment (and paragraphs, lines of text and letters are just parts of the object). The character in the PDF is represented by a </font></font><abbr title="it is a code, or a set of commands for drawing a character"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glyph</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The way they are written is determined by the </font></font><abbr title="a glyph is part of the font, namely glyph parameters are written in the font"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">font</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Each character is stored separately: it has a font, the character code in the font and the coordinates of its location on the page. Where the glyphs are located is determined precisely by the flow of commands. In addition, letters are combined into text flows (text run), but they are not semantic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are no lines or paragraphs in PDF that are in text-format documents. </font><font style="vertical-align: inherit;">Even the order of the text is not always defined. </font><font style="vertical-align: inherit;">That is, you see the text, but in fact the text does not exist. </font><font style="vertical-align: inherit;">This is chaos from difficult to understand instructions (as in the image above) that need to be correctly displayed in specific places of the document, with appropriate formatting. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúWhat about the text?‚Äù </font><font style="vertical-align: inherit;">- you ask.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tn/63/xt/tn63xtmxaoyl8cmmdvr725ap2zo.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The text in PDF does exist, and it can even be edited. </font><font style="vertical-align: inherit;">To do this, we teach our technology to understand the structure of the text, for example, to identify and highlight lines. </font><font style="vertical-align: inherit;">We will tell you more about this.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDF libraries and how we changed them</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To make it possible to edit entire paragraphs, we drastically changed our internal subsystem (library), which we call PdfTools. It is engaged in the fact that it opens PDF files, parses the flow of commands (i.e., understands where the text is located, where the pictures are, and recreates the structure of the document) and helps users manipulate this data: read, change, save to PDF. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The PdfTools subsystem contains all the necessary tools to read the contents and wrap it in objects (page, picture, comment) that are convenient for the program to work with. Our products can already work with these objects, in particular ABBYY FineReader PDF and others. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As it was before.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In FineReader 14, we only knew how to edit text within a single line. </font><font style="vertical-align: inherit;">After editing, it was necessary to perform a ‚Äúrendering‚Äù - to place the glyphs in their new places.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, rendering is visualization. </font><font style="vertical-align: inherit;">But we put in this word a different concept - the location of objects in PDF in their places. </font><font style="vertical-align: inherit;">For PDF professionals, this is a visualization that no one else sees. </font><font style="vertical-align: inherit;">When we talk about visualization in the usual sense, we use the word "rasterization".</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The whole process was located in the PdfTools subsystem. She helped us put the contents of the PDF into lines and edit them. For example, you must put in the 5th place the glyph ‚ÄúA‚Äù. FineReader told the PdfTools subsystem that the fifth place was to put the glyph ‚ÄúA‚Äù with the specified size and font, and PdfTools inserted ‚ÄúA‚Äù and moved to the right place in the line all the glyphs that followed the letter ‚ÄúA‚Äù. Line-by-line editing is quite easy: the text simply shifted to the right or, for example, to the left, if it is written in Hebrew or Arabic. This allowed for minor corrections, for example, to correct a typo, but did not make it possible to make more global changes to the text of the PDF document. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What they decided to change.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When the multi-line editing task appeared, we realized that it would be problematic to do this within the framework of one PdfTools library. </font><font style="vertical-align: inherit;">We needed to learn how to automatically find larger fragments in the PDF text, for example, ‚Äúsee‚Äù paragraphs, understand where their boundaries are, what formatting the whole fragment of text should have, and what happens when switching from one line to another. </font><font style="vertical-align: inherit;">To determine all these parameters, we decided to use our other OCR technologies - Document Analysis (DA) and Synthesis, which can build the structure of the document, to solve this problem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Document Analysis and Synthesis</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To define blocks in the text, ABBYY FineReader PDF uses Document Analysis technology. </font><font style="vertical-align: inherit;">It allows you to find paragraphs, tables, pictures. </font><font style="vertical-align: inherit;">The program highlights the found blocks with small pale frames, so that it is more convenient for the user to make changes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6a/vu/yk/6avuykuqg4pa5xfvm3xrzt2n8kw.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we improved another subsystem of our program - Synthesis. </font><font style="vertical-align: inherit;">We already </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">told on Habr√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> why it is necessary. </font><font style="vertical-align: inherit;">In short, it determines the structure and all characteristics of the recognized text: what fonts and sizes are used, what type (bold, italic, underline), where headers, lists, indents and many other parameters that can be configured in the same MS Word. </font><font style="vertical-align: inherit;">We modified Synthesis so that when recognizing and re-creating the page, it is very accurate to restore the original parameters of the text.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Underlined Text Features</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is no text attribute such as underscore in PDF, which is familiar, for example, to MS Word users. </font><font style="vertical-align: inherit;">The underscore in PDF is a vector graphic that has nothing to do with text. </font><font style="vertical-align: inherit;">Without further development of the product, when editing the ‚Äúunderlined‚Äù text, the characters would move in the usual way, and the lines indicating the underscore would remain in place. </font><font style="vertical-align: inherit;">ABBYY FineReader PDF can define and edit underlined text in a way familiar to the user.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Editing tables in PDF</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Editing tables has also changed. </font><font style="vertical-align: inherit;">Previously, the program ‚Äúsaw‚Äù the table as separate lines, and edited it the same way. </font><font style="vertical-align: inherit;">Now, when working with tables, ABBYY FineReader PDF determines the contents of each cell, is able to extract text from them and work with it. </font><font style="vertical-align: inherit;">This is convenient when you need to fix a mistake in a digit, change the point to a semicolon and at the same time save the structure of the table, do it quickly and without converting the PDF document to other formats.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to edit a scan?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Multi-line editing is also available for scans. By the way, the user does not even need to think about whether the scan is in front of him or not. ABBYY FineReader PDF itself will determine this and start the necessary mechanisms. For example, a typo in the contract date, or the name of the counterparty has changed: it has become longer and should "flow" to the next line. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the program, the scan is first recognized, and then preparation for editing takes place. When the scan is recognized, the text is obtained not in our original document, but in its virtual ‚Äúdouble‚Äù. And it is in it that all editing operations take place.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the user has finished editing the document, the program automatically collects all changes from the page and replaces these fragments in the original document. </font><font style="vertical-align: inherit;">Our task is to embed the text back into the PDF document without damaging everything else that is already in it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Editing a scan allows you not to waste time converting a document to other formats and vice versa. </font><font style="vertical-align: inherit;">This is convenient when you need to quickly make a forgotten edit to a date or other piece of text.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_evqYK_ln00" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of multi-line editing. </font><font style="vertical-align: inherit;">The text is automatically redistributed across the lines as you add words and sentences within the paragraph.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead of a conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Correct a typo in the leaflet, swap text blocks in the instructions, change the whole paragraph in the scan of the contract or add a few new ones, correct the formatting of the entire text - all these tasks can now be solved:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quickly,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without document conversion,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">using one program.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can try it right now - download the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trial version of ABBYY FineReader PDF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for free. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the next post in a week we will talk about how ABBYY FineReader PDF was taught another interesting feature and what new functionality might come in handy for. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Write in the comments what other technological features of our program would you be interested to know?</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en505258/index.html">Dentistry: expectation and reality</a></li>
<li><a href="../en505260/index.html">Measuring the delay from the keyboard to the photon using an optical sensor</a></li>
<li><a href="../en505264/index.html">As I wrote the html parser in php, and what came of it. Part one</a></li>
<li><a href="../en505268/index.html">Personal experience: from frontend developer to leader</a></li>
<li><a href="../en505274/index.html">Deadly sins of site security: what we learned from the vulnerability scanner statistics for the year</a></li>
<li><a href="../en505278/index.html">39 abbreviations in English for beginner marketers and seoshnikov</a></li>
<li><a href="../en505280/index.html">Magento 2: Critical CSS</a></li>
<li><a href="../en505284/index.html">wxpython Availability is even more affordable.</a></li>
<li><a href="../en505286/index.html">20% of the population with PTSD (post-traumatic stress disorder) after self-isolation and quarantine?</a></li>
<li><a href="../en505292/index.html">DATA VAULT Data Showcases</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>