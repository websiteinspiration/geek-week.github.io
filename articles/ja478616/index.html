<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥤 👨🏻‍🎨 👩🏽‍🤝‍👨🏾 Windows UACは驚かずにはいられません、またはインサイダーを検出する方法 🙇🏻 🥃 🧔🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは！Windows UACテクノロジーの欠点については聞いたことがあると思いますが、比較的最近になって、不思議な脆弱性の詳細が明らかになりました。この脆弱性の悪用により、特権のないユーザーが特権を最大化できます。Jet CSIRTでは、ISの監視および対応チームにとって、特権エスカ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows UACは驚かずにはいられません、またはインサイダーを検出する方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/478616/"><img src="https://habrastorage.org/webt/nh/nt/_4/nhnt_4yjxezjq420zztdzp5axoq.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
みなさん、こんにちは！</font><font style="vertical-align: inherit;">Windows UACテクノロジーの欠点については聞いたことがあると思いますが、比較的最近になって、不思議な脆弱性の詳細が明らかになりました。この脆弱性の悪用により、特権のないユーザーが特権を最大化できます。</font><font style="vertical-align: inherit;">Jet CSIRTでは、ISの監視および対応チームにとって、特権エスカレーションクラスの脆弱性が特に重要であるため、このケースを無人で放置することはありませんでした。</font><font style="vertical-align: inherit;">カットの下-脆弱性の説明、検出および保護の方法。</font></font><br>
<a name="habracut"></a> <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脆弱性の詳細</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zero Day Initiativeチームの研究者Eduardo Braun Pradoが、</font><font style="vertical-align: inherit;">Windows特権ダイアログコンポーネントに、ユーザー特権の誤った処理に起因</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカル特権昇格の脆弱性を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">発見しました</font></a><font style="vertical-align: inherit;">。この脆弱性により、ユーザー権限が最大限のシステムに引き上げられ、Windowsのすべての保護メカニズムがバイパスされます。これは、Windows UACメカニズムが使用されている場合、ユーザーが管理者に代わってファイル起動ダイアログを開いてSecure Desktopコンポーネントを操作する場合に発生します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/cz/my/jaczmyiyjsaw7f7obeo3je8zkyk.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この脆弱性の本質は何ですか？実行可能ファイルの証明書には、Microsoft固有のオブジェクト識別子（OID）の形式のオプションの数値フィールド「Policy Identifier」が含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ps/hv/p-/pshvp-n-6jyyjewtck6c2tivnts.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヘッダーファイルWintrust.hは、このフィールドをSPC_SP_AGENCY_INFO_OBJIDとして定義します。その目的は十分に文書化されていませんが、証明書の詳細が表示されたウィンドウが開かれたときに分析される可能性が高いです。このフィールドが正しい形式で表示されると、[発行者]フィールドは、SpcSpAgencyInfo属性から取得した値を含むハイパーリンクとして表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/5k/vk/ie5kvki4nmwpsvfvd8brobo_0ke.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[発行者]フィールドのリンクをクリックすると、SYSTEM権限でInternet Explorerが開きます。その親プロセスは、confirm.exeプロセスです。また、最大の権限で実行され、そのコンテキストでUACダイアログが開始されます。これにより、継承されたシステム権限でブラウザメニューから任意のファイル（cmd.exe、powershell.exe）を実行することが可能になります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/yp/sv/ctypsvmt9ay1vbcfgjabn2l0kie.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
脆弱性の悪用を実証するためのPoC（ビデオは以下に示されています）として、研究者は、HTMLヘルプActiveXコントロールユーティリティの使用を提案しました。このユーティリティの証明書は、上記の機能を備えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、たとえば、PowershellコマンドレットSet-AuthenticodeSignatureを使用して、この方法で実行可能ファイルに署名することができます。まず、Windows SDKのmakecertユーティリティを使用して、自己署名ルート認証局証明書と最終的な証明書を作成する必要があります。手順は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここにあります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
脆弱性</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が</font></a><font style="vertical-align: inherit;">識別子を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取得CVE-2019-1388</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびCVSS 7.8。</font><font style="vertical-align: inherit;">Windows 7からWindows Server 2019までのすべてのOSバージョンがこの影響を受け、パッチをインストールすると、証明書の詳細の[発行者]フィールドがハイパーリンクとして表示されなくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動化の難しさが原因で、この脆弱性が大量に悪用されることはほとんどありません。</font><font style="vertical-align: inherit;">実際、それに基づく攻撃を実装するには、ユーザーは、実行可能ファイルの証明書を含むウィンドウを開くことから、Internet Explorerインターフェースを介してコマンドラインを起動することまで、多くのアクションを実行する必要があります。</font><font style="vertical-align: inherit;">したがって、最も可能性の高い攻撃シナリオは、内部侵入者のアクションに関連している可能性があります。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3BQKpPNlTSo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検出する方法</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows x64プラットフォームの脆弱性の悪用を検出するには、イベントのチェーンを監視するSIEMシステムのSIEMシステムで相関ルールを使用します（監視対象ノードで、まず適切なグループポリシーを使用してプロセス起動の監査を有効にするか、SysinternalsのSysmonユーティリティを使用する必要があります）。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SYSTEM特権でのconstent.exeプロセスの開始の検出（イベントコード</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4688</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセスC：\ Program Files \ iexplore.exeがシステム権限で開始されていることを検出します。ここで、consent.exeは親プロセスとして機能します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセスの開始を検出C：\ Program Files（x86）\ iexplore.exe with SYSTEM rights、C：\ Program Files \ iexplore.exeは親プロセスとして機能します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/p4/q7/5jp4q70y8mfcm2kwdwlhiv4lzsq.jpeg" alt="画像"><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> シェル（cmd.exe、powershell.exe）の起動をSYSTEM特権で検出します。ここで、C：\ Program Files（x86）\ iexplore.exeは親プロセスとして機能します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/x5/0k/hwx50kpkkfub0uq1vfqvviytda0.jpeg" alt="画像"><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセスID C：\ Program Files（x86）\ iexplore.exe from Claim 3、およびID C：\ Program Files（x86）\ iexplore.exe as the parent process as the前の段落は同じです。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FortiSIEM側で説明されている相関ルールの例を示します。</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件は、使用</font></font></u><br>
<br>
<img src="https://habrastorage.org/webt/k0/jf/_x/k0jf_x_igbxpiikqtgnfo9c_g8o.jpeg"><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consent.exeのために起動条件を詳述</font></font></u><br>
<br>
<img src="https://habrastorage.org/webt/zi/jw/sw/zijwswcxmqup72cesn_wezri07k.jpeg"><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始条件IEx64ディテ</font></font></u><br>
<br>
<img src="https://habrastorage.org/webt/vi/8t/n5/vi8tn54zoazua0cwd9oxmenn7vo.jpeg"><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始条件IEx86ディテール</font></font></u><br>
<br>
<img src="https://habrastorage.org/webt/6w/da/4z/6wda4ztn7kddaee-r7igitumutc.jpeg"><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たpowershell.exe、開始条件のCMD.EXEを詳述します</font></font></u><br>
<br>
<img src="https://habrastorage.org/webt/x5/pt/54/x5pt54rciu86rxxiaqgpvad92cu.jpeg"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FortiSIEM相関ルールソースコード</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">rules</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">DataRequest</span> <span class="hljs-attr">advanced</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">custId</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"Rule"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Name</span>&gt;</span>UAC Privilege Escalation through Secure Desktop<span class="hljs-tag">&lt;/<span class="hljs-name">Name</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Description</span>&gt;</span>   UAC Secure Desktop CVE-2019-1388<span class="hljs-tag">&lt;/<span class="hljs-name">Description</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Remediation</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">CustomerScope</span> <span class="hljs-attr">groupByEachCustomer</span>=<span class="hljs-string">"true"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Include</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">Include</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Exclude</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">CustomerScope</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">PatternClause</span> <span class="hljs-attr">window</span>=<span class="hljs-string">"300"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SubPattern</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"148021654"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Consent_Execution"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SingleEvtConstr</span>&gt;</span>eventType = "Win-Security-4688"  AND  procName CONTAIN "consent.exe"  AND  user IN ("","SYSTEM")<span class="hljs-tag">&lt;/<span class="hljs-name">SingleEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupEvtConstr</span>&gt;</span>COUNT(*) &gt;= 1<span class="hljs-tag">&lt;/<span class="hljs-name">GroupEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupByAttr</span>&gt;</span>user,procName<span class="hljs-tag">&lt;/<span class="hljs-name">GroupByAttr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">SubPattern</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Operator</span> <span class="hljs-attr">rank</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"FOLLOWED_BY"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SubPattern</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"148021655"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"IE_x64_Execution"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SingleEvtConstr</span>&gt;</span>eventType = "Win-Security-4688"  AND  procName REGEXP (".*Files\\\\Internet.*\\\\iexplore\\.exe$")  AND  parentProcName CONTAIN "consent.exe"  OR  user IN ("","SYSTEM")<span class="hljs-tag">&lt;/<span class="hljs-name">SingleEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupEvtConstr</span>&gt;</span>COUNT(*) &gt;= 1<span class="hljs-tag">&lt;/<span class="hljs-name">GroupEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupByAttr</span>&gt;</span>procId,user,parentProcName,procName<span class="hljs-tag">&lt;/<span class="hljs-name">GroupByAttr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">SubPattern</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Operator</span> <span class="hljs-attr">rank</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"FOLLOWED_BY"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SubPattern</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"148021664"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"IE_x86_Execution"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SingleEvtConstr</span>&gt;</span>eventId = 4688  AND  procName REGEXP (".*\\(x86\\)\\\\.*\\\\iexplore\\.exe$")  AND  parentProcName REGEXP (".*Files\\\\Internet.*\\\\iexplore\\.exe$")  AND  user IN ("","SYSTEM")<span class="hljs-tag">&lt;/<span class="hljs-name">SingleEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupEvtConstr</span>&gt;</span>COUNT(*) &gt;= 1<span class="hljs-tag">&lt;/<span class="hljs-name">GroupEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupByAttr</span>&gt;</span>procName,parentProcName,procId,user<span class="hljs-tag">&lt;/<span class="hljs-name">GroupByAttr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">SubPattern</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Operator</span> <span class="hljs-attr">rank</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"FOLLOWED_BY"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SubPattern</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"148021656"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Cmd_Execution"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">SingleEvtConstr</span>&gt;</span>eventType = "Win-Security-4688"  AND ( procName CONTAIN "cmd.exe"  OR  procName CONTAIN "powershell.exe" ) AND  parentProcName REGEXP (".*\\(x86\\)\\\\.*\\\\iexplore\\.exe$")  AND  user IN ("","SYSTEM")<span class="hljs-tag">&lt;/<span class="hljs-name">SingleEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupEvtConstr</span>&gt;</span>COUNT(*) &gt;= 1<span class="hljs-tag">&lt;/<span class="hljs-name">GroupEvtConstr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GroupByAttr</span>&gt;</span>user,parentProcName,procName,parentProcId<span class="hljs-tag">&lt;/<span class="hljs-name">GroupByAttr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">SubPattern</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">GlobalConstr</span>&gt;</span>IE_x86_Execution.procId = Cmd_Execution.parentProcId<span class="hljs-tag">&lt;/<span class="hljs-name">GlobalConstr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">PatternClause</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">IncidentDef</span> <span class="hljs-attr">eventType</span>=<span class="hljs-string">"UAC_Privilege_Escalation_through_Secure_Desktop"</span> <span class="hljs-attr">eventTypeGroup</span>=<span class="hljs-string">"PH_SYS_EVENT_PH_RULE_SEC"</span> <span class="hljs-attr">fireFreq</span>=<span class="hljs-string">"900"</span> <span class="hljs-attr">severity</span>=<span class="hljs-string">"7"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ArgList</span>&gt;</span>procName=Cmd_Execution.procName,parentProcName=Cmd_Execution.parentProcName,user=Cmd_Execution.user<span class="hljs-tag">&lt;/<span class="hljs-name">ArgList</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">IncidentDef</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">DynWatchListDef</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">userRoles</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">roles</span> <span class="hljs-attr">custId</span>=<span class="hljs-string">"0"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">roles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">userRoles</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">TriggerEventDisplay</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">AttrList</span>&gt;</span>phRecvTime,eventType,reptDevName,reptDevIpAddr,destIpAddr,destName,user,parentProcId,parentProcName,procId,procName,rawEventMsg<span class="hljs-tag">&lt;/<span class="hljs-name">AttrList</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">TriggerEventDisplay</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">DataRequest</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">rules</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
研究者フローリアン・ロス</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この脆弱性を悪用する試みを検出するためのシグマルールを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">投稿しました</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ただし、言語の制限により、ルールを使用すると、SYSTEM権限を持つInternet Explorerの起動イベントと親の承諾.exeプロセスのみを検出でき、その後のシェルの起動は検出されません。</font><font style="vertical-align: inherit;">上記の条件（1-5）で必要な一連のイベントをシグマツールを使用して追跡することはできないため、独自のルールを開発する必要がありました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分を守る方法</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.対応するOSバージョンの11月12日付けのMicrosoftパッチをインストールします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.この脆弱性を修正するパッチをインストールできない場合は、以下を使用する必要があります。</font></font><br>
<br>
<ul>
<li> AppLocker,     cmd.exe  powershell.exe   ,    «» (    ,   AppLocker,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">LOLBINS</a>); </li>
<li> host-based IPS     EPP, EDR (   ,   iexplore.exe   cmd.exe, powershell.exe).</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja478594/index.html">VFXデザイナーのために読むべき上位5冊の本</a></li>
<li><a href="../ja478596/index.html">PHP匿名関数：ブラックマジックセッションの公開</a></li>
<li><a href="../ja478602/index.html">UnityのMVCとスクリプト可能なオブジェクト。パート2</a></li>
<li><a href="../ja478604/index.html">労働者からPHPプログラマーまで。異常な開発経歴</a></li>
<li><a href="../ja478606/index.html">「おやすみ」-スマートガジェットが人々の睡眠を奪う方法</a></li>
<li><a href="../ja478618/index.html">魔法のPHPの学校</a></li>
<li><a href="../ja478620/index.html">FastAPIを試す必要があるのはなぜですか？</a></li>
<li><a href="../ja478622/index.html">A / Bテスト、パイプライン、小売：GeekBrainsとX5 Retail Groupのビッグデータに関するブランド四半期</a></li>
<li><a href="../ja478626/index.html">straceを使用したソフトウェア展開のデバッグ</a></li>
<li><a href="../ja478628/index.html">中国語の高いCRI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>