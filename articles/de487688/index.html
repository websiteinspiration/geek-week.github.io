<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏻 🔝 🙇🏿 Entwicklung einer interaktiven Coronavirus-Verbreitungskarte vom Typ 2019-nCoV in Python 👖 ☝🏿 🤴🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Coronavirus Typ 2019-nCoV verbreitet sich nach einem Ausbruch in der chinesischen Stadt Wuhan rasch auf der ganzen Welt. Zum Zeitpunkt des Schreib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Entwicklung einer interaktiven Coronavirus-Verbreitungskarte vom Typ 2019-nCoV in Python</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487688/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Coronavirus Typ 2019-nCoV verbreitet sich nach einem Ausbruch in der chinesischen Stadt Wuhan rasch auf der ganzen Welt. Zum Zeitpunkt des Schreibens des Originalartikels (30. Januar 2020) wurden mehr als 9.000 Infizierte und 213 Tote gemeldet. Bis heute (10. Februar 2020) wurden bereits 40.570 Infizierte gemeldet, 910 Menschen sind gestorben. Fälle von Coronavirus-Infektionen wurden in Frankreich, Australien, Russland, Japan, Singapur, Malaysia, Deutschland, Italien, Sri Lanka, Kambodscha, Nepal und vielen anderen Ländern festgestellt. Niemand weiß, wann der Virus gestoppt wird. In der Zwischenzeit wächst die Zahl der bestätigten Fälle von Coronavirus nur noch.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Autor des Artikels, den wir heute übersetzen, möchte darüber sprechen, wie mit Python eine einfache Anwendung erstellt werden kann, um die Ausbreitung von Coronavirus zu verfolgen. </font><font style="vertical-align: inherit;">Nach Abschluss der Arbeit an dieser Anwendung verfügt der Leser über eine HTML-Seite, auf der eine Karte der Ausbreitung des Virus und ein Schieberegler angezeigt werden, mit dem Sie das Datum auswählen können, bis zu dem die Daten auf der Karte angezeigt werden.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/3a0/01d/f473a001d45ecadc8bcdc1415c43e983.gif"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier wird eine interaktive Karte der Verbreitung von Coronavirus Typ 2019-nCoV-</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Technologien wie Python 3.7, Pandas, Plotly 4.1.0 und Jupyter Notebook verwendet.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliotheken importieren</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit dem Import in ein Projekt, das auf dem Jupyter Notebook, den Plotly- und Pandas-Bibliotheken basiert.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen Sie, den Code auszuführen, bevor Sie fortfahren. </font><font style="vertical-align: inherit;">Wenn Sie keine Fehlermeldungen gesehen haben, wurden alle erforderlichen Bibliotheken installiert und funktionieren ordnungsgemäß. </font><font style="vertical-align: inherit;">Wenn der Code nicht ausgeführt werden konnte, </font><font style="vertical-align: inherit;">lesen Sie die </font><font style="vertical-align: inherit;">offiziellen Seiten von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plotly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und lesen Sie die Referenz- und Installationsmaterialien für diese Bibliotheken. </font><font style="vertical-align: inherit;">Wenn auf Ihrer Hardware kein Jupyter Notebook-System ausgeführt wird, empfehle ich die Verwendung von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Colab</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , einer Cloud-basierten Plattform, mit der Sie mit Jupyter Notebook arbeiten können.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenverarbeitung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Daten, die wir hier verwenden, finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies ist eine freigegebene Tabelle mit Google-Dokumenten, die täglich aktualisiert wird. Vielen Dank an alle, die es auf dem Laufenden halten! Sie machen einen sehr notwendigen Job. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden die Daten mit der Pandas-Methode lesen </font></font><code>read_csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Bevor wir jedoch Daten aus der Tabelle über den Link laden, müssen wir mit diesem Link arbeiten. Jetzt sieht es so aus: </font><font style="vertical-align: inherit;">
Wir müssen das ausgewählte Fragment des Links ersetzen und den Link zu diesem Formular bringen: </font><font style="vertical-align: inherit;">
Im folgenden Code initialisieren wir die Variable, </font><font style="vertical-align: inherit;">indem </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">einen Link zu den Daten </font><font style="vertical-align: inherit;">schreiben </font><font style="vertical-align: inherit;">, die Daten mit der Methode lesen </font><font style="vertical-align: inherit;">und in leere Zellen schreiben, die </font><font style="vertical-align: inherit;">Werte </font><font style="vertical-align: inherit;">enthalten </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>edit#gid=0</b></code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>export?format=csv&amp;id</b></code><br>
<br><font style="vertical-align: inherit;"></font><code>url</code><font style="vertical-align: inherit;"></font><code>read_csv</code><font style="vertical-align: inherit;"></font><code>NaN</code><font style="vertical-align: inherit;"></font><code>0</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Phase der Arbeit ist es äußerst wichtig zu verstehen, wie die von uns verwendeten Datenstrukturen strukturiert sind, da dies bestimmt, welchen Ansatz für die Datenverarbeitung wir anwenden. Zeigen Sie die Daten mit dem Befehl an </font></font><code>data.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dies führt zur Ausgabe der ersten 5 Zeilen der Tabelle.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ac/130/bed/3ac130bed504767776a301ba85b377df.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ersten 5 Zeilen mit Coronavirus-Daten</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In der unteren linken Ecke sehen Sie Informationen, dass die Datentabelle 47 Spalten enthält. Hier sind die Namen der ersten fünf Spalten:</font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>location_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>latitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>longitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Andere Spalten sind Paare, deren Namen wie folgt aufgebaut sind:</font></font><code>confirmedcase_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>deaths_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die Gesamtzahl der Spalten in der Tabelle zum Zeitpunkt des Schreibens dieses Materials betrug 47. Dies bedeutet, dass mir Daten für 21 Tage zur Verfügung standen ((47-5) / 2 = 21). Wenn das Startdatum für die Datenerfassung der 10.01.2020 war, war das Enddatum der 30.01.2020.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Namen der ersten fünf Spalten der Tabelle ändern sich nicht, aber im Laufe der Zeit werden der Tabelle Spalten mit neuen Namen hinzugefügt. Unsere interaktive Karte gibt eine Visualisierung der Verbreitung des Coronavirus aus und kann den Tag angeben, an dem die Karte erstellt wird. Daher müssen wir den gesamten Datensatz trennen, indem wir für jeden Tag Informationen daraus auswählen und berücksichtigen, dass sich die ersten 5 Spalten der Tabelle nicht ändern und dass jeder Tag durch zwei Spalten beschrieben wird. Wenn Sie sich dann die Daten genauer ansehen, beispielsweise die Daten für den 10.01.2020, stellt sich heraus, dass viele Daten diesem Datum entsprechen. Tatsächlich wurde zu diesem Zeitpunkt der Nachweis von Coronavirus nur an einer Stelle bestätigt, die durch die entsprechende Nummer gekennzeichnet ist. Alle anderen Zeilen an diesem Datum enthalten nur Nullen. Das heisst,dass wir diese Linien vom Kartenerstellungsprozess ausschließen müssen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Prozess der Vorbereitung der Daten für die Visualisierung erfolgt in einem Zyklus.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während des Betriebs wird die Ausgabe jedes Datensatzes mit dem Scattergeo-Diagramm hinzugefügt </font></font><code>fig.add_trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zum Zeitpunkt des Schreibens werden die Daten, auf deren Grundlage die Bilder erstellt werden, durch 21 Objekte dargestellt. </font><font style="vertical-align: inherit;">Sie können dies mit dem Befehl überprüfen </font></font><code>fig.data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slider-Erstellung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier erstellen wir einen Schieberegler, mit dem die Auswahl der auf der Karte visualisierten Daten organisiert wird. </font><font style="vertical-align: inherit;">Hier ist der relevante Code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Schiebereglercode besteht aus zwei Hauptfragmenten. </font><font style="vertical-align: inherit;">Die erste ist eine Schleife, in der die Liste, </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die beim Verschieben des Schiebereglers verwendet wird, ausgefüllt wird. </font><font style="vertical-align: inherit;">Wenn Sie den Schieberegler bewegen, wird der entsprechende Datensatz angezeigt und die zuvor angezeigten Daten werden ausgeblendet. </font><font style="vertical-align: inherit;">Der zweite Teil des Codes ist die Aufnahme der zuvor erstellten Liste </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in das Schiebereglerobjekt. </font><font style="vertical-align: inherit;">Wenn sich der Schieberegler bewegt, wählt er das entsprechende Element aus </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordnen Sie die Ausgabe zu und speichern Sie sie als HTML-Datei</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun kommen wir zum letzten Teil des Materials. </font><font style="vertical-align: inherit;">Hier sprechen wir darüber, wie die Karte angezeigt und im HTML-Format gespeichert wird. </font><font style="vertical-align: inherit;">Hier ist der Code, der diese Operationen implementiert:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn eine Karte angezeigt wird, ist eine visuelle Darstellung des ersten Datensatzes sichtbar. </font><font style="vertical-align: inherit;">Dann aktualisieren wir den Inhalt der Karte entsprechend der Position des Schiebereglers. </font><font style="vertical-align: inherit;">Hier setzen wir den Kartentitel und passen seine Höhe an. </font><font style="vertical-align: inherit;">Im letzten Schritt zeigen wir die Karte mit der Methode </font></font><code>fig.show</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an und speichern sie dann mit der Methode in HTML </font></font><code>go_offline.plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vollständiger Projektcode</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier finden Sie den vollständigen Projektcode zum Erstellen einer Coronavirus-Verteilungskarte vom Typ 2019-nCoV. </font><font style="vertical-align: inherit;">Bitte beachten Sie, dass die letzte Zeile, die für das Speichern der HTML-Version der Karte verantwortlich ist, bearbeitet werden muss, wobei der dort angegebene Pfad durch den für Sie relevanten ersetzt wird.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
<span class="hljs-comment"># </span>
url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)<font></font>
<font></font>
<span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]<font></font>
<font></font>
<span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov_slider.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine Überprüfung eines Leitfadens zum Erstellen einer interaktiven Karte zur Visualisierung der Verbreitung des Coronavirus Typ 2019-nCoV abgeschlossen. Nachdem Sie dieses Material durchgearbeitet haben, haben Sie gelernt, wie Sie Daten aus den öffentlichen Tabellen von Google lesen, Daten mit Pandas verarbeiten und diese Daten mit dem Schieberegler und Plotly auf einer interaktiven Karte visualisieren. Das Ergebnis des Projekts als HTML-Seite kann hier heruntergeladen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die auf der Karte angezeigten Informationen hängen von der Datentabelle ab. </font><font style="vertical-align: inherit;">Jedes Mal, wenn der Projektcode ausgeführt wird, wird die Karte aktualisiert und es werden neue Daten aus der Tabelle darauf verfügbar. </font><font style="vertical-align: inherit;">Dies ist eine sehr einfache Karte. </font><font style="vertical-align: inherit;">Es gibt viele Möglichkeiten, dies zu verbessern. </font><font style="vertical-align: inherit;">Beispielsweise kann es durch zusätzliche Diagramme, einige zusammenfassende Daten usw. ergänzt werden. </font><font style="vertical-align: inherit;">Wenn Sie interessiert sind, können Sie all dies und noch viel mehr selbst tun. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für welche Aufgaben verwenden Sie die Jupyter Notebook-Technologie?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487676/index.html">Neuer ZX Spectrum Game Contest - Ihr Spiel 6</a></li>
<li><a href="../de487678/index.html">Randbemerkungen zur internationalen Konferenz PGConf.Russia 2020. Highlights und Folien</a></li>
<li><a href="../de487680/index.html">Vollständige Analyse der ShAD-2019-Prüfung</a></li>
<li><a href="../de487682/index.html">7 Empfehlungen zur Verbesserung der Zuverlässigkeit von JavaScript-Code</a></li>
<li><a href="../de487684/index.html">Entwicklung schnellerer Anwendungen auf Vue.js.</a></li>
<li><a href="../de487690/index.html">PHP Digest Nr. 173 (27. Januar - 10. Februar 2020)</a></li>
<li><a href="../de487694/index.html">Wie Yandex.Cloud von Virtual Private Cloud gehostet wird und wie unsere Benutzer uns bei der Implementierung nützlicher Funktionen helfen</a></li>
<li><a href="../de487696/index.html">Digitale Veranstaltungen in Moskau vom 10. bis 16. Februar</a></li>
<li><a href="../de487698/index.html">Digitale Veranstaltungen in St. Petersburg vom 10. bis 16. Februar</a></li>
<li><a href="../de487702/index.html">Eine Auswahl von Artikeln zum maschinellen Lernen: Fallstudien, Leitfäden und Forschungsergebnisse für Januar 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>