<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåú ü•¢ üö¥üèΩ Subtle thoughts on website architecture üò´ ‚ûó üî¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are in our WIT-e, of course, amblers. Own ERP-system (wrote about it here - How can we do without 1C? ), Its own CRM-system, its own M2M for commun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Subtle thoughts on website architecture</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490894/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are in our WIT-e, of course, amblers. Own ERP-system (wrote about it here - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How can we do without 1C?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Its own CRM-system, its own M2M for communication with distributors ("what other clever words and abbreviations do you know?"). And, of course, your approach to WWW, to remain within the framework of this 3-letter paradigm. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It all started with a love of Microsoft, and some of the early versions of the site back in the late 90s was made using ASP technology, and as a database under it lay a regular MS Access file. By the way, providers still offer hosting on the </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">good</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> old </font><font style="vertical-align: inherit;">ASP, 18 years after its upgrade to ASP.NET - here you have legacy systems in all its glory.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, this is quite convenient - since the internal database is also written in MS Access, the procedure for preparing data for the site was very simple, no re-translations from one data format to another (MySQL for example). Access supports an extension of the SQL language of the form ‚ÄúIN &lt;external database name&gt;‚Äù, which can be added after any DML instructions: INSERT, UPDATE, DELETE (here's another 3-letter abbreviation). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As this link grew, of course, it started shamelessly slowing down (plus those that happen are unclear when the mdb-file locks with the database lock down the whole site tightly). Translation of the site to ASP.NET did not fundamentally solve the problem, and it was also necessary to switch to MS SQL Server as a base, but then the process went in a different direction. Let's look at the problem of improving website performance from a slightly different perspective.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(By the way, my 1Gb.ru provider writes that ASP.NET is on average faster than the standard LAMP bundle (Linux / Apache / MySQL / PHP), which has become a revelation for me. But who can I trust here as it is not the operator of the whole thing? ) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disclaimer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - subsequent ideas represent, on the one hand, some theoretical construction elevated to absolute, which often means reduced to absurdity, on the other hand, concrete implementation, so it cannot be said that the author is in his fantasies and completely detached from reality. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question 1. Why should there be a database under the site?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, really, you all admire the speed of In-Memory Databases, right? So why go far, get yourself one right under your website. And even more. At initial initialization, load all the data into arrays available at the site level as a whole (Application object in ASP.NET, Global Variables in PHP, hereinafter everywhere), and instead of writing queries to the database, just loop through these arrays. Anything is suitable for the initial data loading - the same MS Access database, but at least text CSV files! - the operation is performed infrequently and its execution time does not play any role. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are questions, but we already have ready-made answers to them.</font></font><br>
<br>
<ol>
<li> ,  -    ,    ?   ‚Äì      (    ,     -),   ‚Äî   ,</li>
<li>    (    )    .            .    ‚Äì    (  )    ,    ?  ,           ‚Äì     /  ,       ‚Äì  ,   .           .   Catalog (   -!)  2  ‚Äì         : <br>
<br>
<img src="https://habrastorage.org/webt/ph/rz/g9/phrzg9jyqni1zxsumyhzrcucqgy.png"><br>
<br>
           MinIndex  MaxIndex. ,    -         (   ) ‚Äì         Parts     ID  Catalog,   ‚Äì          .<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that this idea can be continued further. In the same way that data is transferred from the database under the site to the data structure of the site itself, when generating a web page, the data it needs to be placed in its structure itself - that is, in JavaScript arrays. And there are no AJAXs, asynchrony, communication error handling, and more. And so it was done on our site on pages containing all kinds of configurators. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, unlike database files, the arrays in the memory of the web server (and the web browser too, albeit with reservations) occupy a size approximately equal to their binary representation, while an empty database with a single table in it already draws on many hundreds of kilobytes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Question 2. Why do I need to use scripts on a web server?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I bring a code fragment in several lines, deliberately simplified and in the craziest of programming languages ‚Äã‚Äã- VBA (except for 1C)</font></font><br>
<br>
<pre><code class="plaintext hljs">        Set IE = CreateObject("InternetExplorer.Application")<font></font>
<font></font>
        IE.Navigate "wit.ru"<font></font>
        While IE.ReadyState &lt; READYSTATE_COMPLETE<font></font>
        Wend<font></font>
<font></font>
        Set str = IE.Document.DocumentElement<font></font>
        HTML = str.innerhtml<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code does the following - runs the page through the once very popular browser of one well-known company, and saves the result of working out the server script as pure HTML. You guessed it, probably, what will be offered next? Quite right - it is quite possible to make a site as purely HTML in the old 90s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Again from 1GB.ru: ‚ÄúIIS very quickly and efficiently processes requests for static files‚Äù) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the same time, you may have to worry about transcoding addresses like </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
wit.ru/card.aspx?id=23&amp;prodid=1022985 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
into static web addresses webpages is also a well-known web server tune-up technology, originally invented for fooling search engines and web optimization.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here it is necessary, probably, to formulate the basic principle from which all the others are derived. </font><font style="vertical-align: inherit;">The more time and resources we spend on preparing data for the website, the easier it will be for him to display it and the faster he will be able to do it. </font><font style="vertical-align: inherit;">In this case, our back-end can work in continuous mode, spitting out ready data on the site with the frequency we need. </font><font style="vertical-align: inherit;">And this approach will work in all cases, except, of course, exchange summaries or windows of some Amazon or Alibaba, where the data changes every second.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I am aware that the problems in the article are too pointed and a non-standard solution is proposed. </font><font style="vertical-align: inherit;">I‚Äôll venture to suggest (this is not my topic at all) that such an approach could work for any embedded systems, where otherwise, on a weak computing device, you have to place a mini database engine and a script handler instead of the simplest web server (at the cost of more memory consumption - operational and constant).</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490882/index.html">Fix problems under Docker. It would seem, what does GIT have to do with it?</a></li>
<li><a href="../en490884/index.html">DEFCON Conference 27. Your car is my car. Part 1</a></li>
<li><a href="../en490888/index.html">Choosing gifts for fantastic women</a></li>
<li><a href="../en490890/index.html">Heroku and React: Deploy Your First App</a></li>
<li><a href="../en490892/index.html">How to generate keys and ads for Yandex and Google from a YML file for free</a></li>
<li><a href="../en490896/index.html">Principles of work for the children's intensive care unit in the form of a response to ‚ÄúProgrammer, the pack and John Steinbeck‚Äù or</a></li>
<li><a href="../en490906/index.html">Yandex rolled out a beta of an independent Aura - aura.top. Is it top?</a></li>
<li><a href="../en490908/index.html">Zone data storage</a></li>
<li><a href="../en490912/index.html">How we at Sportmaster chose a caching system. Part 1</a></li>
<li><a href="../en490916/index.html">Problems of interaction with external teams on large projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>