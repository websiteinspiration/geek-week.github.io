<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📉 🎭 🙇🏽 CSS Grid: Typing a responsive 20-line magazine layout 🥚 🚉 🛑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I worked on a modern implementation of a blog roll (a list of external useful / interesting blogs). The idea was to provide readers with a s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CSS Grid: Typing a responsive 20-line magazine layout</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/492760/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/vy/fm/invyfmr9wggf_x3z20znmwfyn8y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recently, I worked on a modern implementation of a blog roll (a list of external useful / interesting blogs). The idea was to provide readers with a selection of the latest posts on these blogs, packaged in a magazine layout, rather than a dry list of links in the sidebar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The easiest part of the task is to get a list of posts and their excerpts (excerpt - introductory text before the kat) from our favorite RSS feeds. To do this, we used the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feedzy lite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WordPress plugin </font><font style="vertical-align: inherit;">, which can aggregate several feeds into one list, sorted by time - the ideal solution in our case. The difficult part is to make everything beautiful.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The plugin’s standard list interface is probably tasteless, so I wanted to style it as a newspaper or magazine’s website with a mixture of large and small “selected” blocks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sounds like the perfect occasion to use CSS Grid! Create a Grid Layout for different layouts, say, one five-column and one three-column, and then switch between them using media queries on different screen sizes. Right? But do we really need these media queries, and all this trouble with defining control points, if you can just use the Grid parameter </font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which will make the adaptive grid for us? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This idea seemed tempting to me, but when I started adding elements spanning several columns of the grid ( </font></font><em><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spans</font></font></b></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), the grid began to creep out of the page on narrow screens. </font><font style="vertical-align: inherit;">Media queries seemed like the only solution. </font><font style="vertical-align: inherit;">But I found something better! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having studied a number of articles on CSS Grid, I found that they are mainly divided into two types:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to create an interesting layout with spans, but with a given number of columns.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to create an </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptive</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> layout on a Grid, but with columns of the same width (i.e. without spans).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I want the grid to implement both this and that: a fully adaptive layout using adaptively resizing multi-column elements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The beauty is that as soon as you begin to understand the limitations of adaptive grids and why and when spans break adaptability, it’s easy to create a magazine layout </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of several tens of lines of code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and one media query (or without them at all, if you want to limit the variety of spans). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a clear comparison of the RSS plugin from the box and the result of our work (clickable):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/vy/fm/invyfmr9wggf_x3z20znmwfyn8y.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a fully adaptive magazine layout with colored “selected” blocks that dynamically adapt to the layout depending on the number of columns. The page displays about 50 posts, but the layout code does not depend on the number of elements. You can easily increase the number of posts to 100 in the plugin settings, and the layout will remain interesting to the very bottom. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All this is achieved exclusively through CSS and using only one media query to display content in one column on the narrowest screens (less than 460 pixels). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What is most incredible, the entire layout took only 21 lines of CSS (not counting the general styles of the site). However, in order to achieve such flexibility using so little code, I had to dive deep into the darkest depths of the CSS Grid and learn how to get around some of its limitations.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code on which the entire layout rests is incredibly short, and all thanks to the splendor of the CSS Grid:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.archive</span> {
  <span class="hljs-attribute">display</span>: grid;
  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fit, minmax(<span class="hljs-number">210px</span>, <span class="hljs-number">1</span>fr));
  <span class="hljs-attribute">grid-gap</span>: <span class="hljs-number">32px</span>;
  <span class="hljs-attribute">grid-auto-flow</span>: dense;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/*    */</span>
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(31n</span> + 1) {
  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / -<span class="hljs-number">1</span>;<font></font>
}<font></font>
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(16n</span> + 2) {
  <span class="hljs-attribute">grid-column</span>: -<span class="hljs-number">3</span> / -<span class="hljs-number">1</span>;<font></font>
}<font></font>
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(16n</span> + 10) {
  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / -<span class="hljs-number">2</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/*     */</span>
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width:</span> <span class="hljs-number">459px</span>) {
  <span class="hljs-selector-class">.archive</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The technique described in this article can be safely used to stylize any dynamically generated content, whether it is the output of the widget of recent posts, archive pages or search results.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create adaptive mesh</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I created 17 elements to showcase the diversity of future content - headlines, pictures, and excerpts, and wrapped in </font></font><code>&lt;div&gt;&lt;/div&gt;</code><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"archive"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"article"</span>&gt;</span>
    <span class="hljs-comment">&lt;!--  --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span><font></font>
<font></font>
  <span class="hljs-comment">&lt;!--  16  --&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code for turning these elements into an adaptive grid is especially compact:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.archive</span> {
  <span class="hljs-comment">/*     - */</span>
  <span class="hljs-attribute">display</span>: grid;
  <span class="hljs-comment">/*        ,       180 . */</span>
  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fit, minmax(<span class="hljs-number">180px</span>, <span class="hljs-number">1</span>fr));
  <span class="hljs-comment">/*     */</span>
  <span class="hljs-attribute">grid-gap</span>: <span class="hljs-number">1em</span>;<font></font>
}<font></font>
</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ Demo on CodePen</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Note how the line height automatically adjusts to the highest block of content in the line. </font><font style="vertical-align: inherit;">If you change the width in the demo from the link above, you will see that the elements increase and decrease automatically and the number of columns changes from 1 to 5, respectively. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here in action, we see the CSS Grid magic called</font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This keyword works in conjunction with the function</font></font><code>minmax()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">applied to</font></font><code>grid-template-columns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How it works</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The five-column layout itself can be obtained like this:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.archive</span> {
  <span class="hljs-attribute">display</span>: grid;
  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">5</span>, <span class="hljs-number">1</span>fr);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, this creates a five-column layout that stretches and contracts at different screen widths, but always remains five-column, which leads to terribly narrow columns on small screens. The first thing that comes to mind is to write a bunch of media queries and redefine a grid with a different number of columns. That would work, but the keyword </font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does it all automatically. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To </font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use the function as we need </font></font><code>minmax()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Thus, we kind of tell the browser how much you can compress the columns, and how much to stretch. When one of the boundaries is reached, the number of columns increases or decreases, respectively.</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.archive</span> {
  <span class="hljs-attribute">grid-template-columns</span>: repeat (auto-fit, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">180px</span>, <span class="hljs-number">1</span>fr));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, the browser will try to accommodate as many columns as wide as 180 pixels wide. </font><font style="vertical-align: inherit;">If there is excess space, all columns will expand, dividing it among themselves equally. </font><font style="vertical-align: inherit;">This is what dictates the meaning </font></font><code>1fr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: to make the column sizes equal fractions ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> actions) of the available width. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you stretch the browser window, all the columns will grow equally with increasing free space. </font><font style="vertical-align: inherit;">As soon as the newfound space reaches 180 pixels, a new column appears in its place. </font><font style="vertical-align: inherit;">And if you reduce the browser window, everything happens the other way around, perfectly fitting the grid until it turns into a single-column layout. </font><font style="vertical-align: inherit;">Magic! </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ Video demo</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
And all this adaptability thanks to one line of code. </font><font style="vertical-align: inherit;">Well cool?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating spans with “autoflow: dense”</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, at the moment we already have an adaptive grid, that's just all of its elements - the same width. </font><font style="vertical-align: inherit;">The layout of a newspaper or magazine implies the presence of selected blocks, in this context, those that would cover two, three, or even all available columns. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create multi-column spans, we can use the property </font></font><code>grid-column: span</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in those elements that should occupy more space. </font><font style="vertical-align: inherit;">Suppose we want the third list item to be two columns wide:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(3)</span> {
  <span class="hljs-attribute">grid-column</span>: span <span class="hljs-number">2</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, after adding spans, a lot of problems may appear. </font><font style="vertical-align: inherit;">Firstly, holes can form in the grid in those cases when the wide element does not fit on its line and </font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transfers it to the following:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tg/xl/8i/tgxl8iziz5_tm6pnng4wpnbbghm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is easily fixed by adding a property </font></font><code>grid-auto-flow: dense</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the grid. </font><font style="vertical-align: inherit;">Due to this property, the browser understands that holes need to be filled with other elements. </font><font style="vertical-align: inherit;">This creates a flow around the wider elements narrower:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tt/j9/hn/ttj9hndgzfsxehzxw1iqdxz4fa4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note: the order of the elements is broken, now the fourth element is in front of the third. </font><font style="vertical-align: inherit;">As far as I know, this cannot be bypassed, this is one of the limitations of CSS Grid that must be accepted.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ways to identify spans</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several ways to specify the number of columns that an item should occupy. </font><font style="vertical-align: inherit;">It is easiest to apply </font></font><code>grid-columns: span [n]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to one of the elements, where </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the number of columns that the element will occupy. </font><font style="vertical-align: inherit;">The third element in our layout has a property registered </font></font><code>grid-column: span 2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which explains why its width is twice as large as other elements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To use other methods, you must </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">specify the grid lines</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The grid lines are numbered as follows:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xg/za/yn/xgzaynnxcflkzedtleek72epqcs.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grid lines can be indicated from left to right with positive numbers (for example, 1, 2, 3), or from right to left with negative numbers (-1, -2, -3). </font><font style="vertical-align: inherit;">They can be used to place elements in the grid using a property </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, like this:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.grid-item</span> {
  <span class="hljs-attribute">grid-column</span>: ( ) / ( );<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the grid lines expand our ability to define spans. </font><font style="vertical-align: inherit;">Flexibility is added by the ability to replace the initial or final value with a keyword </font></font><code>span</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">For example, the three-columned blue block in the example above can be created by applying any of these properties to the eighth grid element:</font></font><br>
<br>
<ul>
<li><code>grid-column: 3 / 6</code></li>
<li><code>grid-column: -4 / -1</code></li>
<li><code>grid-column: 3 / span 3</code></li>
<li><code>grid-column: -4 / span 3</code></li>
<li><code>grid-column: span 3 / -1</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In a non-adaptive grid (i.e., with a fixed number of columns), each of these properties gives the same result (as in the example with the blue block above). </font><font style="vertical-align: inherit;">But if the grid is adaptive and the number of columns changes, the difference becomes very noticeable. </font><font style="vertical-align: inherit;">Some spans break the layout with auto-wrap turned on, which makes it seem that these two solutions are incompatible. </font><font style="vertical-align: inherit;">Fortunately, some tricks will allow us to combine them safely. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But first, we need to understand the problem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Scrolling Issues</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are a few “featured items” created using the grid line method (clickable):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/nz/9m/uq/nz9muqk1spn-eujmvhwutl9rblm.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Over the entire width (five columns), everything looks good, but if you reduce the screen to a size at which there should be two columns, the layout breaks this way:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/oh/uu/bbohuutkvjhpbtv4ocjhmx0uodu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, our grid has lost its adaptability and, although the container has shrunk, the grid is trying to support all five columns. To do this, she continues to try the same column width and eventually goes beyond the boundaries of her container to the right. From this, horizontal scrolling appears. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why it happens? The problem is that the browser is trying to comply with our exact directions for the grid lines. At this width, the </font></font><code>auto-fit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grid should only display two columns, but our stack line numbering system contradicts this, referring specifically to the fifth line. This contradiction leads to disorder. To correctly display our implied two-column grid, only numbers 1, 2, 3 and -3, -2, -1 can be used, like this:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s3/7t/1q/s37t1qfemvneeuufd7jvsantkz4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But if one of the elements of our grid contains instructions </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outside these limits, say 4, 5 or -6, the browser receives ambiguous instructions. On the one hand, we ask you to automatically create flexible columns (which should - implicitly - remain two at this screen width). On the other hand, we explicitly referred to grid lines, which cannot exist in a two-column format. When there is a contradiction between implicit (automatic) columns and their explicitly defined number, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grid always prefers an explicit definition</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is how unwanted columns and horizontal overflow appear (what they call </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS data loss</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Spans, like grid line numbers, can create explicit column definitions. </font><font style="vertical-align: inherit;">grid-column: span 3 (the eighth grid element in the demo) forces the grid to explicitly have at least three columns, despite the fact that we want two implicit ones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It may seem that the only option is to use media queries to change the values </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the desired width ... but do not rush! </font><font style="vertical-align: inherit;">I thought so too at first. </font><font style="vertical-align: inherit;">But, after a little reflection and playing around with different settings, I found that there are some ways to get around this problem, thanks to which we still have only one media request for the narrowest devices.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As it turned out, the trick is to determine spans using only line numbers that are available for the narrowest grid of those planned for display. </font><font style="vertical-align: inherit;">In this case, we are talking about a two-column grid (recall, we use a media query for single-column display). </font><font style="vertical-align: inherit;">Thus, you can safely use the numbers 1, 2, 3 and their negative pairs without breaking the grid. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first I thought that I would limit myself to the width of the span in two columns using these combinations of numbers:</font></font><br>
<br>
<ul>
<li><code>grid column: span 2</code></li>
<li><code>grid-column: 1 /3</code></li>
<li><code>grid-column: -3 / -1</code></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m5/q5/q8/m5q5q8beij-uiipgfasj_cndegy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Which remain perfectly adaptable up to two speakers:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/ln/xb/m0lnxbx2i2axufbbyde7nusr-v4.png"></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although this works</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , from a design point of view this is a serious limitation, and not too bright. I wanted to make spans in the width of three, four or even five columns on wide screens. But how? My first thought was to return to media queries again (omg, it’s hard to get rid of old habits), but still I tried to avoid this approach and look at responsive design from a different angle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Looking again at the list of available numbers, I suddenly realized that positive and negative numbers in the initial and final values </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be combined, for example </font></font><code>1/-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>2/-2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It would seem nothing interesting. But it doesn’t seem like that anymore when you understand the position of the lines after changing the grid size: the spans change the width in accordance with the width of the screen. A whole bunch of new opportunities for adaptive spans opens, in particular, elements that cover a different number of columns with a change in the width of the screen, without any media queries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first example I discovered is </font></font><code>grid-column: 1/-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This property turns the element into a banner in full width, filling all columns from first to last, even when there is only one column! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using</font></font><code>grid-column: 1/-2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you can create a span "almost full width", which fills all the columns from left to right, except the last. In a two-column layout, such a span adaptively turns into an ordinary element in one column. Surprisingly, it works even when compressing the layout to one column. (It seems that the reason is that the grid will not reduce the element to zero width and therefore it remains the width of one column, as in the case with </font></font><code>grid-column: 1/1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) I assumed that it </font></font><code>grid-column: 2/-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should work the same way, only leave one column untouched on the left, and not on the right . It turned out to be almost right, when compressing the layout to one column, overflow still arises. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then I tried a combination</font></font><code>1/-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It worked well on wide screens - filling at least three columns - and on narrow ones - filling only one. I thought that with a two-column grid something strange would turn out, because since the first line of the grid is the same as the line under the number </font></font><code>-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. To my surprise, the item displays correctly in one column. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After numerous experiments, I found out that there are 11 suitable values </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from those available in a two-column grid. Three of them work even in a single-column layout. Seven others work correctly up to two columns, and for proper display in one column they will need only one media query. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the complete list:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_t/dv/bd/_tdvbd8_atfcs8y8us61wq3xzws.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demonstration of adaptive grid-column values ​​on different screen sizes in an auto-fit grid. </font><font style="vertical-align: inherit;">( </font></font><em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo</font></font></a></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, despite a rather limited subset of adaptive spans, there are many opportunities.</font></font><br>
<br>
<ul>
<li><code>2/-2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - An interesting combination, creates a centered span that works right down to the single-column grid!</font></font></li>
<li><code>3/-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - least useful as it leads to overflow even on two columns.</font></font></li>
<li><code>3/-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a pleasant surprise.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Due to the variety of values </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from this list, it is possible to create an interesting and fully responsive layout. </font><font style="vertical-align: inherit;">Using a single media query for the narrowest single-column display, we can manage ten different patterns </font></font><code>grid-column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That same media query is quite simple, even let's say straightforward. </font><font style="vertical-align: inherit;">In our example, he is responsible for switching the grid display to flexbox:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width:</span> <span class="hljs-number">680px</span>) {
  <span class="hljs-selector-class">.archive</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-selector-class">.article</span> {
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">2em</span>;<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the final grid, which, as you may have noticed, is fully responsive - from one to five columns (clickable):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/939/9aa/ad0/9399aaad0e89f01d46745aae0efaa928.gif"></div></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usage: nth-child () for repeating dynamic width</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To reduce my code to two dozen lines, I applied another trick. The selector </font></font><code>:nth-child(n)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allowed me to style a large number of elements at once. My whole idea with spans was to be applied to many posts in the feed so that selected blocks would appear on the page regularly. First, I wrote a comma-separated list of selectors with a clearly defined element number:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(2)</span>,
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(18)</span>,
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(34)</span>,
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(50)</span>  {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">64</span>,<span class="hljs-number">0.8</span>);
  <span class="hljs-attribute">grid-column</span>: -<span class="hljs-number">3</span> / -<span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In speed, I realized that this is a very time-consuming process, especially when you have to copy this entire list of conditions for each child element that needs to be changed inside the article - heading, links, etc. During prototyping, I was forced to manually change the numbers in each of these lists every time I wanted to play with the position of the spans. A boring and error-prone process. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was then that I realized that you can take advantage of the cool feature of the pseudo-selector </font></font><code>:nth-child</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: instead of an integer value, enter an expression, for example </font></font><code>:nth-child(2n+ 2)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which means every second child element. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is how I used </font></font><code>:nth-child([])</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to create a full-width blue block in my grid that appears at the top of the page and then halfway through the list:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(31n</span> + 1) {
  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / -<span class="hljs-number">1</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">11</span>, <span class="hljs-number">111</span>, <span class="hljs-number">222</span>, <span class="hljs-number">0.5</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A piece of code in brackets ( </font></font><code>31n + 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) is responsible for choosing the 1st, 32nd, 63rd, etc. child element. The browser starts the loop starting with n = 0 ( </font></font><code>31 * 0 + 1 = 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), then </font></font><code>n=1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>31 * 1 + 1 = 32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), and finally </font></font><code>n=2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>31 * 2 + 1 = 63</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). In the latter case, the browser understands that there is no 63rd child element, ignores the rule, stops the cycle and applies the rule to the 1st and 32nd elements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I’m doing something similar for the purple blocks that appear on the left or on the right throughout the page:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(16n</span> + 2) {
  <span class="hljs-attribute">grid-column</span>: -<span class="hljs-number">3</span> / -<span class="hljs-number">1</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">0.8</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(16n</span> + 10) {
  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / -<span class="hljs-number">2</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">0.8</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first selector is for the left purple blocks. The expression </font></font><code>16n + 2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is responsible for applying styles to every 16th grid element, starting with the second. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second selector is for the right purple blocks. The interval is the same ( </font></font><code>16n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), but the shift is different ( </font></font><code>10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). As a result, these blocks are regularly found on the right side of the grid, in elements numbered 10, 26, 42, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the visual styles of these elements, I used another trick to avoid code repeating. For common styles of purple blocks (for obvious </font></font><code>background-color</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, for example), you can use one selector:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span><span class="hljs-selector-pseudo">:nth-child(8n</span> + 2) {
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">0.8</span>);
  <span class="hljs-comment">/* Other shared syling */</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This selector will select items 2, 10, 18, 26, 34, 42, 50, and more. </font><font style="vertical-align: inherit;">In other words, he selects both left and right blocks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This works because </font></font><code>8n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- this is exactly half </font></font><code>16n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the shift difference in the two selectors is also 8.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Final word</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CSS Grid can now be used to create flexible, responsive meshes with minimal code. However, if you avoid the use of retrograde media queries, there are significant restrictions on the positioning of elements in the grid. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It would be very cool to be able to create spans that would not lead to horizontal scrolling and overflow on small screens. Now we can tell the browser: “Make an adaptive grid, please,” and it does it very well. But just add: “Oh, and this element of the grid is stretched into four columns, please,” - and he waves the handle to narrow screens, preferring the request for a four-column span, rather than an adaptive grid. It would be possible to make the grid do the opposite, for example like this:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span> {
  <span class="hljs-attribute">grid-column</span>: span <span class="hljs-number">3</span>, autofit;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another issue with responsive grids is the last line. </font><font style="vertical-align: inherit;">Changing the screen width can often cause it to be blank. </font><font style="vertical-align: inherit;">I tried for a long time to find a way to stretch the last element of the grid to the remaining columns (respectively, fill the row), but it seems to be impossible. </font><font style="vertical-align: inherit;">At least for now. </font><font style="vertical-align: inherit;">It would be nice to be able to set the initial position of the element with a keyword, like </font></font><code>auto</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as it were, saying “Fill the line to the end, starting from the left edge”. </font><font style="vertical-align: inherit;">Something like this:</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.article</span> {
  <span class="hljs-attribute">grid-column</span>: auto, -<span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... that would stretch the span on the left edge of the grid to the end of the line.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492744/index.html">Which system will be the loudest, and which will give “absolute” silence: two interesting scientific projects</a></li>
<li><a href="../en492746/index.html">How to avoid programming outrage? Integrator Tips</a></li>
<li><a href="../en492748/index.html">Profession DevOps-engineer: a view of the system administrator</a></li>
<li><a href="../en492754/index.html">Why JavaScript devours HTML: code examples</a></li>
<li><a href="../en492758/index.html">Podcasts for Developers</a></li>
<li><a href="../en492762/index.html">Investor alphabet: what is margin call and how to avoid it</a></li>
<li><a href="../en492766/index.html">We pump work with events in Angular</a></li>
<li><a href="../en492768/index.html">Greybox Fuzzing by the example of AFLSmart</a></li>
<li><a href="../en492770/index.html">Learning, Negotiating, Consulting Remotely - Part 1: Mind Server and its Free Version</a></li>
<li><a href="../en492772/index.html">How Amazon is trying to sue the most risky products on the site</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>