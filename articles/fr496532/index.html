<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📆 ⚗️ 👩🏿‍🎨 Nous vérifions nous-mêmes: comment déployer et administrer 1C: Flux de documents au sein de l'entreprise 1C 🧚🏾 🏗️ 🐅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chez 1C, nous utilisons largement nos propres développements pour organiser le travail de l'entreprise. En particulier, «1C: Gestion des documents 8» ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous vérifions nous-mêmes: comment déployer et administrer 1C: Flux de documents au sein de l'entreprise 1C</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/496532/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chez 1C, nous utilisons largement nos propres développements pour organiser le travail de l'entreprise. En particulier, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«1C: Gestion des documents 8»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En plus de la gestion des documents (comme son nom l'indique), il s'agit également d'un </font><font style="vertical-align: inherit;">système </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> moderne </font><font style="vertical-align: inherit;">(Enterprise Content Management - gestion de contenu d'entreprise) avec un large éventail de fonctionnalités - courrier, calendriers de travail des employés, organisation de l'accès partagé aux ressources (par exemple, réservation de salles de conférence), comptabilité heures de travail, forum d'entreprise et bien plus encore. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chez 1C, plus d'un millier d'employés utilisent des documents. La base de données est déjà devenue impressionnante (11 milliards d'enregistrements), ce qui signifie qu'elle nécessite une maintenance plus approfondie et un équipement plus puissant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment le travail de notre système est organisé, quelles difficultés nous rencontrons dans l'entretien de la base de données et comment nous les résolvons (nous utilisons MS SQL Server comme SGBD), nous décrirons dans l'article. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ceux qui ont lu pour la première fois les produits 1C. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1C: La gestion de documents est une solution applicative (configuration) mise en œuvre sur la base d'un framework de développement d'applications métiers - 1C: Plateforme d'entreprise.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/5a/ts/rb/5atsrbr1r_0dfqiyrdimcyze4by.png" alt="image"><br>
<br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«1C: Document Management 8» (sous forme abrégée - DO) vous permet d'automatiser le travail avec les documents dans l'entreprise. </font><font style="vertical-align: inherit;">L'un des principaux outils d'interaction avec les employés est le courrier électronique. </font><font style="vertical-align: inherit;">En plus du courrier, DO résout également d'autres tâches:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suivi du temps</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comptabilisation des absences</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demandes de coursiers / transport</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calendriers des employés</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrement de la correspondance</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contacts avec les employés (carnet d'adresses)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forum d'entreprise</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservation de chambre</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planification d'événements</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travail collectif avec des fichiers (avec conservation des versions de fichiers)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et etc. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Document Management, nous entrons le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client léger</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (application exécutable native) à partir de Windows, Linux, macOS, le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (à partir des navigateurs) et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client mobile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - selon la situation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et grâce à notre autre produit connecté à la gestion des documents - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le système d'interaction</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- directement dans la gestion des documents, nous obtenons la fonctionnalité de messagerie - chats, appels audio et vidéo (y compris les appels de groupe, qui est maintenant devenu particulièrement important, y compris à partir d'un client mobile), le partage rapide de fichiers ainsi que la possibilité d'écrire des robots de chat qui simplifient le travail avec le système. Un autre avantage de l'utilisation du système d'interaction (par rapport à d'autres messagers) est la possibilité de mener des discussions contextuelles liées à des objets spécifiques de la gestion de documents - documents, événements, etc. Autrement dit, le système d'interaction s'intègre profondément avec l'application cible et n'agit pas comme un «bouton séparé».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nombre de lettres dans notre DL a déjà dépassé 100 millions, et en général dans le SGBD - plus de 11 milliards d'enregistrements. </font><font style="vertical-align: inherit;">Au total, le système utilise près de 30 To de stockage: la base de données est de 7,5 To, les fichiers pour le travail collectif sont séparés et occupent encore 21 To. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous parlons de chiffres plus spécifiques, voici le nombre de lettres et de fichiers en ce moment:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lettres sortantes - 14,7 millions.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lettres entrantes - 85,4 millions</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versions de fichiers - 70,8 millions</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documents internes - 30,6 milliers</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans DO, il n'y a pas que du courrier et des fichiers. </font><font style="vertical-align: inherit;">Voici les nombres d'autres objets comptables:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réservation de salle de conférence - 52 126</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rapports hebdomadaires - 153940</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rapports quotidiens - 628 153</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Approbation de visa - 11,821</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documents entrants - 79 677</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documents sortants - 28 357</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrements d'événements dans les calendriers de travail des utilisateurs - 168 228</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demandes de coursiers - 21 883</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contreparties - 82029</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dossiers de travail avec les entrepreneurs - 45 632</font></font></li>
<li>   – 41 795</li>
<li> – 10 243</li>
<li> – 6 320</li>
<li>  – 245 980</li>
<li>   – 26 282</li>
<li>   – 891 095</li>
<li>- – 109 056.       – , , , ,   ..     ,  ,  ,  ,     .      ,  ,           .</li>
</ul><br>
<h2>      ?</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces chiffres indiquent une quantité impressionnante de tâches, nous avons donc été confrontés à la nécessité d'allouer un équipement assez productif aux besoins des filiales internes. </font><font style="vertical-align: inherit;">A ce jour, ses caractéristiques sont les suivantes: 38 cœurs, 240 Go de RAM, 26 To de disques. </font><font style="vertical-align: inherit;">Nous </font></font><br>
<img src="https://habrastorage.org/webt/lt/l1/8t/ltl18tfpfsmxrdo8drblk-04r2o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donnons la </font><font style="vertical-align: inherit;">table des serveurs: à </font><font style="vertical-align: inherit;">l'avenir, nous prévoyons d'augmenter la capacité de l'équipement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'en est-il du chargement du serveur?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'activité réseau n'a jamais été un problème pour nous ou nos clients. En règle générale, le point faible est le processeur et les disques, car tout le monde sait déjà comment faire face à un manque de mémoire. Voici des captures d'écran de nos serveurs de Resource Monitor, qui montrent que nous n'avons pas de charge terrible, c'est très modeste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, dans la capture d'écran ci-dessous, nous voyons un serveur SQL où le CPU est chargé à 23%. Et c'est un très bon indicateur (à titre de comparaison: si la charge approche 70%, alors, très probablement, les employés observeront des ralentissements assez importants). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/-w/oo/vz-woobphp0n1zll7bnpvwlxflk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxième capture d'écran montre le serveur d'applications sur lequel la plate-forme 1C: Enterprise s'exécute - elle ne sert que les sessions utilisateur. Ici, la charge du processeur est légèrement plus élevée - 38%, elle est lisse et calme. Il y a un chargement de disque, mais il est acceptable.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bz/qd/uv/bzqduvuuvjk4i0dchiimfrauum0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième capture d'écran montre un autre serveur 1C: Enterprise (c'est le deuxième, nous en avons deux dans le cluster). </font><font style="vertical-align: inherit;">Seul le précédent sert les utilisateurs, et les robots y travaillent. </font><font style="vertical-align: inherit;">Par exemple, ils reçoivent du courrier, acheminent des documents, échangent des données, considèrent les droits, etc. </font><font style="vertical-align: inherit;">Toutes ces activités d'arrière-plan effectuent environ 90 à 100 tâches d'arrière-plan. </font><font style="vertical-align: inherit;">Et ce serveur est très occupé - à 88%. </font><font style="vertical-align: inherit;">Mais cela n'affecte pas les gens, et cela implémente juste toute l'automatisation que la gestion de documents devrait faire.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fi/k7/o3/fik7o3yrdbucybkekjymjrgq1aa.png" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles sont les mesures pour déterminer les performances?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons intégré au BS un sous-système sérieux pour mesurer les indicateurs de performance et calculer diverses métriques. </font><font style="vertical-align: inherit;">Cela est nécessaire pour comprendre à l'heure actuelle et dans la perspective historique ce qui se passe dans le système, ce qui empire, ce qui s'améliore. </font><font style="vertical-align: inherit;">Des outils de surveillance - métriques et mesures du temps - sont inclus dans le package standard "1C: Document Management 8". </font><font style="vertical-align: inherit;">Les métriques nécessitent un réglage sur l'implémentation, mais le mécanisme lui-même est typique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les mesures sont des mesures de divers indicateurs commerciaux à certains moments (par exemple, le délai moyen de livraison du courrier au moment de 10 minutes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des mesures indique le nombre d'utilisateurs actifs dans la base de données. </font><font style="vertical-align: inherit;">En moyenne, il y en a 1000 à 1400 par jour. </font><font style="vertical-align: inherit;">Le graphique montre qu'au moment de la capture d'écran, il y avait 2144 utilisateurs actifs dans la base de données.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pr/ca/is/prcaismpjrysr1jm8pr3m77w4j8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a plus de 30 actions de ce type, la liste est sous la coupe.</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste</font></font></b><div class="spoiler_text"><ul>
<li>  </li>
<li>  </li>
<li> </li>
<li>  </li>
<li>  </li>
<li>  </li>
<li>   </li>
<li>  </li>
<li> </li>
<li> </li>
<li>  </li>
<li> </li>
<li> </li>
<li> </li>
<li>  </li>
<li> </li>
<li> </li>
<li> </li>
<li></li>
<li></li>
<li> </li>
<li></li>
<li>  </li>
<li> </li>
<li>  </li>
<li> </li>
<li>    </li>
<li>  </li>
<li>  </li>
<li></li>
<li> </li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'avant-dernière semaine, notre activité moyenne des utilisateurs a augmenté d'une fois et demie (le graphique apparaît en rouge) - ceci est dû à la transition de la plupart des employés vers le travail à distance (en lien avec des événements connus). De plus, le nombre d'utilisateurs actifs a augmenté de 3 fois (affiché en bleu sur l'écran), les employés ayant commencé à utiliser activement le mobile: chaque client mobile crée une connexion avec le serveur. Maintenant, en moyenne, pour chacun de nos employés, il y a 2 connexions au serveur.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_p/la/oy/_plaoyah-fhvkshuadl9ftidsty.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous, comme pour les administrateurs, c'est un signal que nous devons être plus attentifs aux problèmes de vitesse, pour voir si cela a empiré. Et nous le considérons d'autres manières. Par exemple, le temps de livraison du courrier pour le routage interne change (la capture d'écran ci-dessous montre le bleu). Nous voyons qu'il a bondi jusqu'à cette année, et maintenant il est stable - pour nous, c'est un indicateur que tout est en ordre avec le système. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/-j/es/ws-jes5n002oaglztg92x6rhc70.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre mesure appliquée pour nous est le temps d'attente moyen pour télécharger des lettres depuis le serveur de messagerie (indiqué en rouge sur la capture d'écran). En gros, combien de temps la lettre restera-t-elle sur Internet avant d'être envoyée à notre employé. La capture d'écran montre que cette heure n'a également pas changé récemment. Il y a des explosions distinctes - mais elles ne sont pas associées à des retards, mais au fait que du temps est perdu sur les serveurs de messagerie.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/tq/yk/e-tqykeehhyd-ztfieowpmodpro.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou, par exemple, une autre métrique (affichée en bleu dans la capture d'écran) - mise à jour des lettres dans un dossier. L'ouverture d'un dossier de messagerie est une opération très courante et doit être effectuée rapidement. Nous mesurons sa vitesse d'exécution. Cet indicateur est mesuré pour chaque client. Vous pouvez voir l'image globale de l'entreprise et la dynamique, par exemple, d'un employé individuel. La capture d'écran montre que jusqu'à cette année, la métrique était déséquilibrée, puis nous avons apporté un certain nombre d'améliorations, et maintenant cela ne va pas en empirant - un calendrier presque uniforme. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w-/ew/ay/w-eway3c2wyaubpqk1onjq4ptjm.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les métriques sont essentiellement un outil d’administrateur pour surveiller le système, pour répondre rapidement à tout changement dans le comportement du système. Sur une capture d'écran - mesures du DO interne pendant un an. Le saut dans les graphiques est dû au fait que nous avons été chargés de développer des filiales internes.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/pt/d1/fjptd1wgq42u1dpgl6p96cwuwv4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une liste de quelques mesures supplémentaires (sous la coupe).</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Métrique</font></font></b><div class="spoiler_text"><ul>
<li> </li>
<li> </li>
<li> </li>
<li> </li>
<li>  ()</li>
<li> </li>
<li>    </li>
<li> </li>
<li> </li>
<li>          10 </li>
<li>  :  </li>
<li>    </li>
<li> </li>
<li> </li>
<li>      </li>
<li>      ( )</li>
<li>      ( )</li>
<li>      ( )</li>
<li>      ( )</li>
<li>      ()</li>
<li>  </li>
<li>  </li>
<li>  «    »</li>
<li>    </li>
<li>   </li>
<li>    </li>
<li>   </li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre système effectue des mesures de plus de 150 indicateurs 24 heures sur 24, mais tous ne peuvent pas être surveillés rapidement. </font><font style="vertical-align: inherit;">Ils peuvent être utiles plus tard, dans une certaine perspective historique, et vous pouvez vous concentrer sur les plus importants pour les entreprises.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'une des implémentations, par exemple, seuls 5 indicateurs ont été sélectionnés. Le client s'est fixé pour objectif de faire un minimum d'indicateurs, mais en même temps de manière à couvrir les principaux scénarios de travail. Il serait injustifié d'inclure 150 indicateurs dans l'acte d'acceptation, car même au sein de l'entreprise, il est difficile de s'entendre sur les indicateurs jugés acceptables. Et ils connaissaient ces 5 indicateurs et les avaient déjà présentés au système avant le début du projet de mise en œuvre, y compris dans le dossier d'appel d'offres: temps d'ouverture de la carte pas plus de 3 secondes, temps d'exécution de la tâche avec un fichier pas plus de 5 secondes, etc. Dans nos filiales, il y avait précisément des mesures qui reflétaient très clairement la demande initiale des exigences du client.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous avons également une analyse de profil des mesures de performance. </font><font style="vertical-align: inherit;">Les indicateurs de performance sont la fixation de la durée de chaque opération effectuée (rédaction d'une lettre dans la base de données, envoi d'une lettre au serveur de messagerie, etc.). </font><font style="vertical-align: inherit;">Il est utilisé exclusivement par des spécialistes techniques. </font><font style="vertical-align: inherit;">Nous avons beaucoup d'indicateurs de performance dans notre programme. </font><font style="vertical-align: inherit;">Nous mesurons désormais environ 1 500 opérations clés, réparties par profil. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kp/kw/ht/kpkwhtmfno5e6log8ozegzltuie.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des profils les plus importants pour nous est la «Liste des indicateurs clés du courrier du point de vue des consommateurs». </font><font style="vertical-align: inherit;">Ce profil comprend, par exemple, les indicateurs suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution de commande: filtrer par balise</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ouverture d'un formulaire: formulaire de liste</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution des commandes: sélection par dossier</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afficher les lettres dans la zone de lecture</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrer une lettre dans votre dossier préféré</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher des lettres par détails</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer une lettre</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous voyons que la métrique d'un indicateur commercial est devenue trop grande (par exemple, les lettres d'un utilisateur spécifique ont commencé à arriver depuis très longtemps), nous commençons à comprendre, nous nous tournons vers la mesure du temps des opérations techniques. </font><font style="vertical-align: inherit;">Nous avons l'opération technique «Archivage des lettres sur le serveur de messagerie» - nous constatons l'excédent de temps pour cette opération pour la dernière période. </font><font style="vertical-align: inherit;">Cette opération, à son tour, se décompose en d'autres opérations - par exemple, l'établissement d'une connexion au serveur de messagerie. </font><font style="vertical-align: inherit;">Nous voyons que pour une raison quelconque, il est soudainement devenu très grand (nous avons toutes les mesures en un mois - nous pouvons comparer cela la semaine dernière 10 millisecondes, et maintenant 1000 millisecondes). </font><font style="vertical-align: inherit;">Et nous comprenons que quelque chose ici est cassé - nous devons le réparer.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment entretenons-nous une si grande base de données?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre DO interne est un exemple de projet très chargé et vraiment fonctionnel. </font><font style="vertical-align: inherit;">Parlons des caractéristiques techniques de sa base de données.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle est la durée de la restructuration de grandes tables de base de données?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur SQL nécessite une maintenance périodique, nettoyant les tables. </font><font style="vertical-align: inherit;">Dans le bon sens, cela devrait être fait au moins une fois par jour, et pour les tables très demandées - encore plus souvent. </font><font style="vertical-align: inherit;">Mais si la base est grande (et que notre nombre d'enregistrements a déjà dépassé 11 milliards), il n'est pas facile de s'en occuper. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons fait la restructuration des tables il y a 6 ans, mais cela a commencé à prendre tellement de temps que nous ne cadrions plus dans les intervalles nocturnes. </font><font style="vertical-align: inherit;">Et puisque ces opérations chargent fortement le serveur SQL, il ne peut pas fournir des services de qualité aux autres utilisateurs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, nous devons maintenant appliquer diverses astuces. Par exemple, nous ne pouvons pas effectuer ces procédures sur des ensembles de données complets. Vous devez recourir à la procédure Mettre à jour un échantillon de 500 000 lignes - cela prend 14 minutes. Il ne met pas à jour les statistiques pour toutes les données du tableau, mais sélectionne un demi-million de lignes et calcule à partir de celles-ci les statistiques qu'il utilise pour l'ensemble du tableau. Il s'agit d'une hypothèse, mais nous sommes obligés d'y aller, car pour un tableau particulier, la collecte de statistiques pour le milliard d'enregistrements entier sera inacceptablement longue. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dl/mq/9q/dlmq9qvlqsafte96p7yjhllxegm.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également optimisé d'autres opérations de maintenance en les rendant partielles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La maintenance d'un SGBD est généralement une tâche difficile. </font><font style="vertical-align: inherit;">Dans le cas d'une interaction active entre les employés, la base de données se développe rapidement, il devient de plus en plus difficile pour les administrateurs de la gérer - mise à jour des statistiques, défragmentation, indexation. </font><font style="vertical-align: inherit;">Ici, nous devons appliquer différentes stratégies, nous savons très bien comment procéder, nous avons de l'expérience, nous pouvons la partager.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment la sauvegarde est-elle implémentée avec de tels volumes?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une sauvegarde complète du SGBD est effectuée une fois par jour la nuit, de manière incrémentielle - toutes les heures. </font><font style="vertical-align: inherit;">En outre, un répertoire de fichiers est créé chaque jour et constitue une partie de la sauvegarde incrémentielle du stockage de fichiers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combien de temps dure une sauvegarde complète?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur un disque dur, une sauvegarde complète est effectuée en trois heures, partielle - en une heure. </font><font style="vertical-align: inherit;">Il faut plus de temps pour écrire sur la bande (un périphérique spécial qui effectue une copie de sauvegarde sur une cassette spéciale stockée à l'extérieur du bureau; une copie aliénable est effectuée sur la bande, qui sera enregistrée si, par exemple, le serveur est en panne). </font><font style="vertical-align: inherit;">La sauvegarde se fait exactement sur le même serveur, dont les paramètres étaient plus élevés - SQL-server avec 20% de charge processeur. </font><font style="vertical-align: inherit;">Au moment de la sauvegarde, bien sûr, le système devient bien pire, mais il est toujours opérationnel.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xq/sb/6j/xqsb6jqlw7y8fg5pgpwwhghhm74.png" alt="image"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y a-t-il une déduplication?</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">déduplication des</font></a><font style="vertical-align: inherit;"> fichiers, nous l'exécutons sur nous-mêmes, et bientôt il sera inclus dans la nouvelle version de Document Management. </font><font style="vertical-align: inherit;">Nous utilisons également le mécanisme de déduplication des contreparties. </font><font style="vertical-align: inherit;">Il n'y a pas de déduplication des enregistrements au niveau du SGBD, car cela n'est pas nécessaire. </font><font style="vertical-align: inherit;">La plateforme 1C: Enterprise stocke des objets dans le SGBD et seule la plateforme peut être responsable de leur cohérence.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existe-t-il des nœuds en lecture seule?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas de nœuds pour la lecture (nœuds système dédiés qui servent ceux qui ont besoin de recevoir des données de lecture). </font><font style="vertical-align: inherit;">DO n'est pas un système de comptabilité à mettre sur un nœud BI distinct, mais il existe un nœud distinct pour le service de développement, qui est échangé avec des messages au format JSON, et les temps de réplication typiques sont des unités et des dizaines de secondes. </font><font style="vertical-align: inherit;">Le nœud est encore petit, il compte environ 800 millions d'entrées, mais il croît rapidement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et les messages marqués pour suppression ne sont pas supprimés du tout?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pas encore. </font><font style="vertical-align: inherit;">Nous n'avons aucune tâche pour faciliter la base. </font><font style="vertical-align: inherit;">Il y a eu plusieurs cas assez graves où j'ai dû me tourner vers des lettres marquées pour suppression, dont 2009. </font><font style="vertical-align: inherit;">Par conséquent, pour l'instant, nous avons décidé de tout garder. </font><font style="vertical-align: inherit;">Mais lorsque le coût de cela deviendra injustifié, nous penserons à la suppression. </font><font style="vertical-align: inherit;">Mais, si vous devez supprimer une lettre distincte de la base de données avec les extrémités afin qu'il n'y ait aucune trace, cela peut être fait sur demande spéciale.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi le stocker? </font><font style="vertical-align: inherit;">Existe-t-il des statistiques sur l'accès aux anciens documents?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas de statistiques. </font><font style="vertical-align: inherit;">Plus précisément, il se présente sous la forme d'un journal utilisateur, mais il n'est pas stocké longtemps. </font><font style="vertical-align: inherit;">Les enregistrements de plus d'un an sont supprimés du protocole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y avait des situations où il fallait remonter l'ancienne correspondance d'il y a cinq ou même dix ans. </font><font style="vertical-align: inherit;">Et cela a toujours été fait non par simple curiosité, mais pour prendre des décisions commerciales complexes. </font><font style="vertical-align: inherit;">Il y a eu un cas où sans l'historique de la correspondance, la mauvaise décision commerciale serait prise.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment est l'examen de la valeur et de la destruction des documents selon la période de stockage?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les documents papier, cela se fait de la manière traditionnelle habituelle, comme tout le monde. </font><font style="vertical-align: inherit;">Pour l'électronique, nous ne le faisons pas - laissez-le être stocké. </font><font style="vertical-align: inherit;">Le sit est ici. </font><font style="vertical-align: inherit;">Il y a un avantage. </font><font style="vertical-align: inherit;">Tout est bien.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles sont les perspectives de développement?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, notre DO résout environ 30 problèmes internes, dont certains que nous avons énumérés au début de l'article. </font><font style="vertical-align: inherit;">DO est également utilisé pour préparer des conférences que nous organisons deux fois par an pour nos partenaires: l'ensemble du programme, tous les rapports, toutes les sections parallèles, les salles - tout cela est composé dans DO, puis il est téléchargé à partir de celui-ci, et un programme imprimé est créé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur le chemin de DO, il y a plusieurs autres tâches, en plus de celles qu'il résout déjà. </font><font style="vertical-align: inherit;">Il existe des tâches à l'échelle de l'entreprise, mais il existe des tâches uniques et rares qui ne sont nécessaires qu'à une unité particulière. </font><font style="vertical-align: inherit;">Il est nécessaire de les aider et, par conséquent, d'élargir la "géographie" de l'utilisation du système à l'intérieur de 1C - d'élargir la portée, de résoudre les tâches de tous les départements. </font><font style="vertical-align: inherit;">Ce serait le meilleur test de performance et de fiabilité. </font><font style="vertical-align: inherit;">J'aimerais voir le système fonctionner sur des milliards de documents, des pétaoctets d'informations.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496512/index.html"># 05 - Et un octet entier ne suffit pas ... | Manga</a></li>
<li><a href="../fr496514/index.html">Tunnel VPN IPsec IPIP entre la machine Linux et Mikrotik derrière le fournisseur NAT</a></li>
<li><a href="../fr496516/index.html">Bot télégramme en python vs COVID-19</a></li>
<li><a href="../fr496518/index.html">Comment sommes-nous arrivés à la télécommande</a></li>
<li><a href="../fr496528/index.html">La localisation d'un code QR est une tâche importante, sans raison, sans attention</a></li>
<li><a href="../fr496536/index.html">DeepCode: vue latérale</a></li>
<li><a href="../fr496538/index.html">Fractales en Python. Procédure pas à pas</a></li>
<li><a href="../fr496542/index.html">Le trafic Internet en Europe a augmenté une fois et demie. Les fournisseurs de backbone enregistrent les enregistrements de charge</a></li>
<li><a href="../fr496544/index.html">Hackathon en ligne de projets pour les indépendants: 500 mille roubles pour leurs idées et le soutien du Service fédéral des impôts</a></li>
<li><a href="../fr496546/index.html">Démarrage au sein de l'entreprise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>