<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏽 😵 ☯️ とげを自転車に投げつける、パート1：プラグインを使用してVisual Studioデバッガーをカスタマイズする基本を学ぶ ☄️ 👩🏿‍🏫 🙅🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Visual Studio 2012の革新の1つは、「Concord」と呼ばれる新しいカスタムデバッガーの登場です。そのコンポーネントシステムにより、VSIXプラグインはデバッガーの動作をカスタマイズし、必要に応じてデバッガーを使用できる新しい状況依存ツールを作成できます。そのAPIは、マネージ/ア...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>とげを自転車に投げつける、パート1：プラグインを使用してVisual Studioデバッガーをカスタマイズする基本を学ぶ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476298/"><img src="https://habrastorage.org/webt/kl/8o/1x/kl8o1xvmgggvg_ssk6tb72xz6se.png" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visual Studio 2012の革新の1つは、「Concord」と呼ばれる新しいカスタムデバッガーの登場です。そのコンポーネントシステムにより、VSIXプラグインはデバッガーの動作をカスタマイズし、必要に応じてデバッガーを使用できる新しい状況依存ツールを作成できます。そのAPIは、マネージ/アンマネージコード間のマーシャリング、リモート/ローカルデバッグプロセスとのシームレスな統合など、多くのQOL機能を提供します。実際、IDEで実行できるほとんどすべてのことは、プログラムでConcord APIを使用して実行できます。特定の変数の値をオンザフライで変更し、要求に応じて関数を呼び出します（または特にプログラムにそれらの呼び出しをスキップさせます！）、プラグインはPDB（！）、段階的なバイパス、さらにはコードの変更で検索できます！カットを開くまた、自転車製造の分野におけるこれらのあまり知られていない革新について学びます。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく最初から始めるべきでしょう。デバッガーは</font><font style="vertical-align: inherit;">、VSIXプラグインのマニフェストによって参照される</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vsdconfig</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">から情報を読み取ることにより、コンポーネントを検出し</font><font style="vertical-align: inherit;">ます。</font><i><font style="vertical-align: inherit;">でVsdconfig</font></i><font style="vertical-align: inherit;">ターン</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラグインコンポーネントによって実装されているインターフェイスとこれらのコンポーネントを見つける方法を示します（.dllファイルへのリンク。クラスを示します。ネイティブ実装の場合はCLSIDを示します。C＃で例を示します）。また、各コンポーネントの一意の識別子（GUID）とその「レベル」も示されます。レベルとは、プラグインが処理される順序、およびこの実装がロードされるプロセスのコンテキスト（IDEプロセスまたはデバッグされるアプリケーションのプロセス）を決定するものです。これは、一部の機能はIDEのコンテキストでのみ機能し、デバッグプロセスのコンテキストでのみ機能するためです。一部のAPI関数はあちこちで同じように機能します。そのため、デバッガの既存の要素に依存できるため、いくつかのコンポーネントには独自のレイアウト規則があります。固定レベルにあります。インシデントを回避するため、RTFM（https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.componentinterfaces?view=visualstudiosdk-2017）と独立した実験をお勧めします。何かが発生した場合は削除します（これもまた、このようなニュアンスに関連しています-場合によっては、アセンブリまたはタイプがロードされていない理由がはっきりしないこともあります。問題を安定して通知するログが表示される場所がまだ見つからないためです。エラー、たとえば、ターゲットプロセスにロードできない依存関係を参照すると、それは出力スタジオに表示されるか、表示されない可能性があります。注意して、頻繁にコミットしてください。visualstudio.debugger.componentinterfaces？view = visualstudiosdk-2017）および別のサンドボックスでの独立した実験。これは、何かが発生した場合に削除するのは残念ではありません（これも、このようなニュアンスが原因です）。 、問題を着実に通知するログが表示される場所を見つけることができなかったためです。たとえば、ターゲットプロセスにロードできない依存関係へのリンクに関連するエラーが出力スタジオに表示される場合があります。いいえ、注意してください。頻繁にコミットしてください。visualstudio.debugger.componentinterfaces？view = visualstudiosdk-2017）および別のサンドボックスでの独立した実験。これは、何かが発生した場合に削除するのは残念ではありません（これも、このようなニュアンスが原因です）。 、問題を着実に通知するログが表示される場所を見つけることができなかったためです。たとえば、ターゲットプロセスにロードできない依存関係へのリンクに関連するエラーが出力スタジオに表示される場合があります。いいえ、注意してください。頻繁にコミットしてください。問題を着実に示しているログがどこに現れるのか、私は見つけられなかったからです。たとえば、ターゲットプロセスにロードできない依存関係への参照に関連するエラーは、出力スタジオに表示される場合と表示されない場合があります。注意して、頻繁にコミットし、問題を着実に示しているログがどこに現れるのか、私は見つけられなかったからです。たとえば、ターゲットプロセスにロードできない依存関係への参照に関連するエラーは、出力スタジオに表示される場合と表示されない場合があります。注意して、頻繁にコミットし、</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">飲酒運転はしないでください</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レベルのリストは次のとおりです（RFTMの動作をコミットするときに読者がインシデントを起こさないように、テキストを英語で提供します）：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDEコンポーネントレベル（値&gt; 100,000）：</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成分</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントレベル</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AD7 AL</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,000,000,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分解プロバイダー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,998,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタッククエリ-コールスタックをクエリするコンポーネント</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,997,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタックプロバイダー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,996,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタックフィルター-スタックをフィルター処理して注釈を付けることができるレベル</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,995,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブレークポイントマネージャー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,994,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDE式の評価</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,992,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンボルスタックウォーカー-シンボルへのアクセスが必要なスタックウォーカー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,991,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDE SymbolProvider-残​​りのデバッガーにシンボル情報を提供するコンポーネント。</font><font style="vertical-align: inherit;">シンボルパスは、このレベルより下では使用しないでください。</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,999,000</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターゲットプロセスのコンポーネントのレベル（値&lt;99.999）：</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成分</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントレベル</font></font></th>
</tr>
<tr>
<td>Monitor Symbol Provider – Symbol providers when the symbolic state is built on the target computer (ex: interpreter, dynamically compiled/emitted code)</td>
<td>75,000</td>
</tr>
<tr>
<td>Breakpoint Condition Processor — This level is for processing breakpoint conditions such as condition expressions and hit counts. Below this point all physical breakpoint events will be visible regardless of whether or not they have false conditions.</td>
<td>70,000</td>
</tr>
<tr>
<td>Monitor Task Provider – This is the level for task data mining in the target process</td>
<td>65,500</td>
</tr>
<tr>
<td>Monitor Expression Evaluator</td>
<td>65,000</td>
</tr>
<tr>
<td>Monitor Coordination – Components which arbitrate between the various monitors for stepping, breakpoints by native address, stack walk, etc.</td>
<td>60,000</td>
</tr>
<tr>
<td>Monitor Stack Walkers</td>
<td>55,000</td>
</tr>
<tr>
<td>Custom Debug Monitor – Reserved for third party debug monitors which wish to make use of services provided by the standard debug monitors.</td>
<td>40,500</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランタイムデバッグモニター-マネージ/ネイティブ/スクリプトコードのデータ検査と実行制御を提供します</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本デバッグモニター</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,000</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベースデバッグモニターサービス-ベースデバッグモニター（例：プロセスの作成）と事前デバッグサービス（例：プロセスの列挙）にユーティリティサービスを提供します</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,000</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、順番に、プロジェクトを作成するプロセス。</font><font style="vertical-align: inherit;">重要なニュアンスがない場合は、このプロセスを最小限に説明するか、まったくスキップできますが、現実は完全に異なります。いくつかのライブラリ依存関係と、何らかの理由でVisualStudioに配布されていないが利用可能な構成ファイルを作成するためのツールが必要ですnugetでのみ。</font><font style="vertical-align: inherit;">実際、今、私たちは本質に移る必要があります。</font><font style="vertical-align: inherit;">プロジェクトの作成と設定のプロセスは、次のように構成されています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visual Studioを開きます。</font><font style="vertical-align: inherit;">私の場合、2017 Community Edition</font></font></li>
<li> VSIX Project (  <i>Visual C# -&gt; Extensibility</i>,   ).   «HelloVSIX» </li>
<li>   class library   ,    «DebuggeePlugin» </li>
<li>     «DebuggeePlugin»   «HelloVSIX» </li>
<li>     «Microsoft.VisualStudio.Debugger.Engine»   DebuggeePlugin </li>
<li>    «DebuggeePlugin»   nuget  Microsoft.VSSDK.Debugger.VSDConfigTool.      VSD- </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、プラグインに何か便利なことをさせる準備ができました。実行できる最も簡単なことをしましょう。ターゲットプロセスがエントリポイントに到達したときに、「Hello VSIX」と表示されるMessageBoxを表示します。これを行うには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDkmEntryPointNotification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスを実装するクラスを作成し、</font><font style="vertical-align: inherit;">いくつかの構成ファイルに入力する必要があります。 DkmEntryPointNotificationServiceという新しいパブリッククラスを追加し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDkmEntryPointNotification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスを継承して、</font><font style="vertical-align: inherit;">今のところデフォルトの実装のままにします。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> Microsoft.VisualStudio.Debugger;
<span class="hljs-keyword">using</span> Microsoft.VisualStudio.Debugger.ComponentInterfaces;
<span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> System.Threading.Tasks;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">DebuggeePlugin</span><font></font>
{<font></font>
    <span class="hljs-keyword">class</span> <span class="hljs-title">DkmEntryPointNotificationService</span> : <span class="hljs-title">IDkmEntryPointNotification</span><font></font>
    {<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnEntryPoint</span>(<span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException();<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイル「DkmEntryPointNotificationService.vsdconfigxml」を「DebuggeePlugin」プロジェクトに追加します。</font><font style="vertical-align: inherit;">Microsoft.VisualStudio.Debugger.ComponentInterfaces名前空間インターフェイスの実装を通じて通知を受け取る必要がある宣言されたクラスごとに、そのようなファイルが必要です。</font><font style="vertical-align: inherit;">ちなみに、このような複数のインターフェイスを1つのクラスに一度に実装することは可能です。</font><font style="vertical-align: inherit;">次に、「。vsdconfigxml」ファイルのビルドアクションを変更する必要があります。</font><font style="vertical-align: inherit;">これを行うには、プロジェクトファイルを手動で編集する必要があります（私は真剣に）。</font><font style="vertical-align: inherit;">DebuggeePluginプロジェクトをアンロードし、スタジオエディターで開きます。</font><font style="vertical-align: inherit;">次のXLMタグを見つける必要があります。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">None</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span> /&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このタグを独自のItemGroupに移動し、タイプをNoneからVsdConfigXmlFilesに変更します。</font></font><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">VsdConfigXmlFiles</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトを保存して再ロードできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、設定に移動します。</font><font style="vertical-align: inherit;">最初に行うこと：vsdconfig.xsdファイルがDebuggeePluginプロジェクトに追加されている場合は、削除する必要があります。</font><font style="vertical-align: inherit;">生のテキストを使用する方が簡単なので、今すぐ置き換えます。</font><font style="vertical-align: inherit;">DkmEntryPointNotificationService.vsdconfigxmlを開き、テキストを次のように置き換えます。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Configuration</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ManagedComponent</span>
    <span class="hljs-attr">ComponentId</span>=<span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span>
    <span class="hljs-attr">ComponentLevel</span>=<span class="hljs-string">"99950"</span>
    <span class="hljs-attr">AssemblyName</span>=<span class="hljs-string">"DebuggeePlugin"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Class</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Implements</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InterfaceGroup</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NoFilter</span>/&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Interface</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">"IDkmEntryPointNotification"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">InterfaceGroup</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Implements</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Class</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ManagedComponent</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Configuration</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなファイルでは、次のことを示す必要があります。 </font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComponentId-この値は、GUID生成ツール（ツール-&gt; CreateGUID）を使用して生成できます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ComponentLevelは、階層内のコンポーネントのレベルです。</font><font style="vertical-align: inherit;">上記の表とMSDNのヘルプ情報を参照して、必要な値の範囲を選択してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblyname-アセンブリの名前（ソリューションではありません！）。</font><font style="vertical-align: inherit;">この場合、DebuggeePluginがあります。</font></font></li>
<li> Class Name —     ,    .   , DebuggeePlugin.DkmEntryPointNotificationService</li>
<li>  InterfaceGroup —          .   InterfaceGroup    -     ,   , , ,    .    Interface   ,       IdkmEntryPointNotification.     ,  Interface   .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバッガからの通知を受け取るクラスごとに、そのようなファイルが必要であることを思い出してください。</font><font style="vertical-align: inherit;">しかし、楽しみはそれだけではありません。</font><font style="vertical-align: inherit;">その後、そのような各ファイルは、プロジェクトの出力ディレクトリにある.vsdconfigファイルにアセンブルされます。</font><font style="vertical-align: inherit;">また、プラグインマニフェストで参照する必要があります。</font><font style="vertical-align: inherit;">これは次のように行われます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 「.vsdconfigxml」ファイルを生成したら、ソリューションを1回収集する必要があります。そうしないと、プロジェクトの出力ディレクトリに.vsdconfigファイルがありません） </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> その後、source.extension.vsixmanifestファイルのテキストエディターを開き、次のコードをPackageManifest終了タグの前に追加します。 </font></font></li>
</ol><br>
<pre><code class="xml hljs"> <span class="hljs-tag">&lt;<span class="hljs-name">Assets</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Asset</span> <span class="hljs-attr">Type</span>=<span class="hljs-string">"DebuggerEngineExtension"</span> <span class="hljs-attr">d:Source</span>=<span class="hljs-string">"File"</span> <span class="hljs-attr">Path</span>=<span class="hljs-string">"DebuggeePlugin.vsdconfig"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Assets</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、完了したアクションの後に、「DebuggeePlugin.vsdconfig」ファイルがHelloVSIXプロジェクトに表示された場合、する必要があります</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">THEプロジェクトから削除</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、溶液を</font><font style="vertical-align: inherit;">しなければならない</font><font style="vertical-align: inherit;">、それ以外の場合は更新されません、もう一度収集します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
準備作業は終わりました！プラグインのデバッグを開始できます。これは、VisualStudioの試験的なインスタンスを開始することによって行われます（VSIXプロジェクトの場合、これはデフォルトのデバッグターゲットであるため、追加の手順は必要ありません）。実際、Debug-&gt; StartDebuggingをクリックすると、VisualStudioの実験的なインスタンスが表示されます。その中に、デフォルトで、プラグインがすでにインストールされているはずです。これは、[ツール]-&gt; [拡張機能と更新]メニューで確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDkmEntryPointNotificationインターフェイスを実装したため、VisualStudioの実験的なインスタンスでテストプロジェクトを作成する必要があります。</font><font style="vertical-align: inherit;">実際、新しいプロジェクトを作成し、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++-&gt; Console Applicationを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択します（次の例にはC ++の詳細が含まれているため、C ++を選択します）。これを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VSIXTestApp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">呼び</font></b><font style="vertical-align: inherit;">、何も変更せずに実行し、実験インスタンスが収集し、DebuggeePluginメソッド内で例外がスローされなくなったことを確認します。 DkmEntryPointNotificationService.OnEntryPoint。</font><font style="vertical-align: inherit;">いいね！</font><font style="vertical-align: inherit;">次に、MessageBoxを表示する必要があります。</font><font style="vertical-align: inherit;">これを行うには、DebuggeePluginプロジェクトに次の参照を追加する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft.VisualStudio.Shell.15.0 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft.VisualStudio.Shell.Interop </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft.VisualStudio.Shell.Interop.8.0 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft.VisualStudio.OLE.Interop </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DkmEntryPointNotificationService.csファイルの先頭に2つのusingを追加します。 </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> Microsoft.VisualStudio.Shell;
<span class="hljs-keyword">using</span> Microsoft.VisualStudio.Shell.Interop;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 そして、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DkmEntryPointNotificationService.OnEntryPoint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">VsShellUtilities.ShowMessageBox</font></a><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">への呼び出しを追加します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> Microsoft.VisualStudio.Debugger;
<span class="hljs-keyword">using</span> Microsoft.VisualStudio.Debugger.ComponentInterfaces;
<span class="hljs-keyword">using</span> Microsoft.VisualStudio.Shell;
<span class="hljs-keyword">using</span> Microsoft.VisualStudio.Shell.Interop;
<span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> System.Threading.Tasks;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">DebuggeePlugin</span><font></font>
{<font></font>
    <span class="hljs-keyword">class</span> <span class="hljs-title">DkmEntryPointNotificationService</span> : <span class="hljs-title">IDkmEntryPointNotification</span><font></font>
    {<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnEntryPoint</span>(<span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span>)</span><font></font>
        {<font></font>
            VsShellUtilities.ShowMessageBox(Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider, <span class="hljs-string">"Hello VSIX"</span>, <span class="hljs-string">"Hello VSIX"</span>, OLEMSGICON.OLEMSGICON_INFO, OLEMSGBUTTON.OLEMSGBUTTON_OK, OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST);<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再構築して、スタジオの実験的なインスタンスを起動し、テストプロジェクトを起動して、出来上がりです！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタジオのテストインスタンスがMessageBoxを作成したことがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2c/a7/fd/2ca7fdpdvkt3z_fscr76xskl7rk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、実際には何がメリットですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、結果の邪魔になるニュアンスのほとんどを考慮に入れて、Visual Studioデバッガーのプラグインを含むVSIXプロジェクトを設定する方法を学びました。</font><font style="vertical-align: inherit;">これは、より詳細な作業の開始点です。</font><font style="vertical-align: inherit;">次の記事では、もう1つの重要なポイントを示します。IDEとデバッグターゲットコンポーネント間の通信がどのように実行されるかです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concord APIの使用の詳細については、MSDNだけでなく、githubの次のMicrosoftリポジトリも参照できます</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。github.com </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">/microsoft</font></a><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">PTVS </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Microsoft/ConcordExtensibilitySamples</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja476288/index.html">2020年のフロントエンド開発の上位5 JSフレームワーク。パート2</a></li>
<li><a href="../ja476290/index.html">Expressでのエラー処理</a></li>
<li><a href="../ja476292/index.html">SVGまたはキャンバス？</a></li>
<li><a href="../ja476294/index.html">GFNの代替としての分散型ゲームネットワーク：ロシア連邦ですでに機能している、その方法と理由</a></li>
<li><a href="../ja476296/index.html">11月21日、製品エンジニアリングMeetUp：製品エンジニアとは誰ですか？</a></li>
<li><a href="../ja476300/index.html">トラム雑誌は、ロシアの子供たちの前衛の明るく点滅し、すぐに色あせた星です</a></li>
<li><a href="../ja476304/index.html">トップレベルシステムでのLinuxデバイスハードウェアドングル認証</a></li>
<li><a href="../ja476306/index.html">ボットの基本的な機能を作成するためのTelegramBotの手順。（パート1）</a></li>
<li><a href="../ja476310/index.html">人間の顔のCRM</a></li>
<li><a href="../ja476312/index.html">ReactまたはAngularまたはVue.js-何を選択しますか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>