<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèΩ ü•§ üç≠ M√©canique du langage des piles et des pointeurs üë®üèº‚Äç‚öñÔ∏è üéµ ü§ôüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©lude
 Il s'agit du premier des quatre articles de la s√©rie qui fournira un aper√ßu de la m√©canique et de la conception des pointeurs, des piles, des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>M√©canique du langage des piles et des pointeurs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496846/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©lude</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit du premier des quatre articles de la s√©rie qui fournira un aper√ßu de la m√©canique et de la conception des pointeurs, des piles, des tas, de l'analyse d'√©chappement et de la s√©mantique Go / pointeur. </font><font style="vertical-align: inherit;">Ce message concerne les piles et les pointeurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Table des mati√®res:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canique du langage sur les piles et les pointeurs</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canique du langage sur l'analyse d'√©vasion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traduction</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canique du langage sur le profilage de la m√©moire</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Philosophie de conception sur les donn√©es et la s√©mantique</font></font></a></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne vais pas dissimuler - les pointeurs sont difficiles √† comprendre. </font><font style="vertical-align: inherit;">S'ils sont mal utilis√©s, les pointeurs peuvent provoquer des erreurs d√©sagr√©ables et m√™me des probl√®mes de performances. </font><font style="vertical-align: inherit;">Cela est particuli√®rement vrai lors de l'√©criture de programmes comp√©titifs ou multithread. </font><font style="vertical-align: inherit;">Sans surprise, de nombreuses langues essaient de cacher des pointeurs aux programmeurs. </font><font style="vertical-align: inherit;">Cependant, si vous √©crivez dans Go, vous ne pouvez pas √©chapper aux pointeurs. </font><font style="vertical-align: inherit;">Sans une compr√©hension claire des pointeurs, il vous sera difficile d'√©crire du code propre, simple et efficace.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bordures de cadre</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fonctions sont ex√©cut√©es dans les limites des trames qui fournissent un espace m√©moire s√©par√© pour chaque fonction correspondante. Chaque trame permet √† la fonction de fonctionner dans son propre contexte et fournit √©galement un contr√¥le de flux. Une fonction a un acc√®s direct √† la m√©moire √† l'int√©rieur de son cadre via un pointeur, mais l'acc√®s √† la m√©moire √† l'ext√©rieur du cadre n√©cessite un acc√®s indirect. Pour qu'une fonction acc√®de √† la m√©moire en dehors de sa trame, cette m√©moire doit √™tre utilis√©e conjointement avec cette fonction. La m√©canique et les limites fix√©es par ces limites doivent √™tre comprises et √©tudi√©es en premier.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'une fonction est appel√©e, une transition entre deux trames se produit. Le code passe de la trame de la fonction appelante √† la trame de la fonction appel√©e. Si les donn√©es sont n√©cessaires pour appeler la fonction, ces donn√©es doivent √™tre transf√©r√©es d'une trame √† l'autre. Le transfert de donn√©es entre deux trames dans Go se fait "par valeur". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'avantage de la transmission de donn√©es ¬´par valeur¬ª est la lisibilit√©. La valeur que vous voyez dans l'appel de fonction est ce qui est copi√© et accept√© de l'autre c√¥t√©. C'est pourquoi j'associe ¬´passer par la valeur¬ª avec WYSIWYG, car ce que vous voyez est ce que vous obtenez. Tout cela vous permet d'√©crire du code qui ne cache pas le co√ªt de basculement entre deux fonctions. Cela aide √† maintenir un bon mod√®le mental de la fa√ßon dont chaque appel de fonction affectera le programme pendant la transition.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardez ce petit programme qui appelle une fonction en passant des donn√©es enti√®res "par valeur": </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 1:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">01</span> <span class="hljs-keyword">package</span> main
<span class="hljs-number">02</span>
<span class="hljs-number">03</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
<span class="hljs-number">04</span>
<span class="hljs-number">05</span>    <span class="hljs-comment">// Declare variable of type int with a value of 10.</span>
<span class="hljs-number">06</span>    count := <span class="hljs-number">10</span>
<span class="hljs-number">07</span>
<span class="hljs-number">08</span>    <span class="hljs-comment">// Display the "value of" and "address of" count.</span>
<span class="hljs-number">09</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>, count, <span class="hljs-string">"]\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)
<span class="hljs-number">10</span>
<span class="hljs-number">11</span>    <span class="hljs-comment">// Pass the "value of" the count.</span>
<span class="hljs-number">12</span>    increment(count)
<span class="hljs-number">13</span>
<span class="hljs-number">14</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>, count, <span class="hljs-string">"]\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)
<span class="hljs-number">15</span> }
<span class="hljs-number">16</span>
<span class="hljs-number">17</span> <span class="hljs-comment">//go:noinline</span>
<span class="hljs-number">18</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">increment</span><span class="hljs-params">(inc <span class="hljs-keyword">int</span>)</span></span> {
<span class="hljs-number">19</span>
<span class="hljs-number">20</span>    <span class="hljs-comment">// Increment the "value of" inc.</span>
<span class="hljs-number">21</span>    inc++
<span class="hljs-number">22</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"inc:\tValue Of["</span>, inc, <span class="hljs-string">"]\tAddr Of["</span>, &amp;inc, <span class="hljs-string">"]"</span>)
<span class="hljs-number">23</span> }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque votre programme Go d√©marre, le runtime cr√©e le programme principal pour commencer √† ex√©cuter tout le code, y compris le code √† l'int√©rieur de la fonction principale. Gorutin est le chemin d'ex√©cution qui s'int√®gre dans le thread du syst√®me d'exploitation, qui s'ex√©cute finalement sur un noyau. √Ä partir de la version 1.8, chaque goroutine est fourni avec un bloc initial de m√©moire continue de 2048 octets, qui forme l'espace de pile. Cette taille de pile initiale a chang√© au fil des ans et pourrait changer √† l'avenir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pile est importante car elle fournit un espace m√©moire physique pour les limites de trame qui sont donn√©es √† chaque fonction individuelle. Au moment o√π le goroutine principal ex√©cute la fonction principale du listing 1, la pile de programmes (√† un niveau tr√®s √©lev√©) ressemblera √† ceci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 1:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z4/7w/l0/z47wl0tm16nh5u-gf8u9m0kemba.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la figure 1, vous pouvez voir qu'une partie de la pile a √©t√© ¬´encadr√©e¬ª pour la fonction principale. </font><font style="vertical-align: inherit;">Cette section est appel√©e le " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cadre de pile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", et c'est ce cadre qui indique la limite de la fonction principale sur la pile. </font><font style="vertical-align: inherit;">Le cadre est d√©fini comme faisant partie du code qui s'ex√©cute lorsque la fonction est appel√©e. </font><font style="vertical-align: inherit;">Vous pouvez √©galement voir que la m√©moire de la variable count a √©t√© allou√©e √† 0x10429fa4 √† l'int√©rieur du cadre pour main. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un autre point int√©ressant, illustr√© sur la figure 1. Toute la m√©moire de pile sous la trame active n'est pas valide, mais la m√©moire de la trame active et au-dessus est valide. </font><font style="vertical-align: inherit;">Vous devez comprendre clairement la fronti√®re entre la partie valide et non valide de la pile.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresses</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables sont utilis√©es pour attribuer un nom √† un emplacement de m√©moire sp√©cifique pour am√©liorer la lisibilit√© du code et vous aider √† comprendre avec quelles donn√©es vous travaillez. </font><font style="vertical-align: inherit;">Si vous avez une variable, alors vous avez une valeur en m√©moire, et si vous avez une valeur en m√©moire, alors elle doit avoir une adresse. </font><font style="vertical-align: inherit;">Sur la ligne 09, la fonction principale appelle la fonction println int√©gr√©e pour afficher la "valeur" et l '"adresse" de la variable de comptage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 2:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">09</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>, count, <span class="hljs-string">"]\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de l'esperluette ¬´&amp;¬ª pour obtenir l'adresse de l'emplacement d'une variable n'est pas nouvelle, d'autres langues utilisent √©galement cet op√©rateur. </font><font style="vertical-align: inherit;">La sortie de la ligne 09 devrait ressembler √† la sortie ci-dessous si vous ex√©cutez du code sur une architecture 32 bits telle que Go Playground: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 3:</font></font><br>
<br>
<pre><code class="go hljs">count:  Value Of[ <span class="hljs-number">10</span> ]  Addr Of[ <span class="hljs-number">0x10429fa4</span> ]</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appel de fonction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, sur la ligne 12, la fonction principale appelle la fonction d'incr√©mentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 4:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">12</span>    increment(count)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faire un appel de fonction signifie que le programme doit cr√©er une nouvelle section de m√©moire sur la pile. Cependant, tout est un peu plus compliqu√©. Pour r√©ussir un appel de fonction, il est pr√©vu que les donn√©es soient transf√©r√©es √† travers la limite de trame et plac√©es dans une nouvelle trame pendant la transition. En particulier, une valeur enti√®re devrait √™tre copi√©e et transmise pendant l'appel. Vous pouvez voir cette exigence en regardant la d√©claration de la fonction d'incr√©mentation √† la ligne 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 5:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">18</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">increment</span><span class="hljs-params">(inc <span class="hljs-keyword">int</span>)</span></span> {</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous regardez √† nouveau l'appel √† la fonction d'incr√©mentation sur la ligne 12, vous verrez que le code passe la ¬´valeur¬ª du nombre de variables. Cette valeur sera copi√©e, transf√©r√©e et plac√©e dans un nouveau cadre pour la fonction d'incr√©mentation. N'oubliez pas que la fonction d'incr√©mentation ne peut lire et √©crire en m√©moire que dans sa propre trame, elle a donc besoin de la variable inc pour obtenir, stocker et acc√©der √† sa propre copie de la valeur de compteur transmise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juste avant que le code √† l'int√©rieur de la fonction d'incr√©mentation ne commence √† s'ex√©cuter, la pile du programme (√† un niveau tr√®s √©lev√©) ressemblera √† ceci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2g/jw/n9/2gjwn96mbhikaxys6ftv3cf4s14.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez voir qu'il y a maintenant deux images sur la pile - une pour le principal et une en dessous pour l'incr√©ment. </font><font style="vertical-align: inherit;">√Ä l'int√©rieur du cadre pour l'incr√©mentation, vous pouvez voir la variable inc contenant la valeur 10, qui a √©t√© copi√©e et transmise lors de l'appel de fonction. </font><font style="vertical-align: inherit;">L'adresse variable inc est 0x10429f98, et elle est moins en m√©moire car les trames sont pouss√©es sur la pile, qui ne sont que des d√©tails d'impl√©mentation qui ne veulent rien dire. </font><font style="vertical-align: inherit;">L'important est que le programme r√©cup√®re la valeur de comptage dans le cadre pour principal et place une copie de cette valeur dans le cadre pour augmenter √† l'aide de la variable inc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le reste du code √† l'int√©rieur incr√©mente incr√©mente et affiche la "valeur" et l '"adresse" de la variable inc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 6:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">21</span>    inc++
<span class="hljs-number">22</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"inc:\tValue Of["</span>, inc, <span class="hljs-string">"]\tAddr Of["</span>, &amp;inc, <span class="hljs-string">"]"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sortie de la ligne 22 dans la cour de r√©cr√©ation devrait ressembler √† ceci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 7:</font></font><br>
<br>
<pre><code class="go hljs">inc:    Value Of[ <span class="hljs-number">11</span> ]  Addr Of[ <span class="hljs-number">0x10429f98</span> ]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici √† quoi ressemble la pile apr√®s avoir ex√©cut√© les m√™mes lignes de code: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 3: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/59/1o/kv/591okvkseze5gjqum4k8hp-qv34.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir ex√©cut√© les lignes 21 et 22, la fonction d'incr√©mentation se termine et renvoie le contr√¥le √† la fonction principale. </font><font style="vertical-align: inherit;">Ensuite, la fonction principale affiche √† nouveau la "valeur" et l '"adresse" du nombre de variables locales sur la ligne 14. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 8:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">14</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>,count, <span class="hljs-string">"]\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sortie compl√®te du programme dans la cour de r√©cr√©ation devrait ressembler √† ceci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 9:</font></font><br>
<br>
<pre><code class="go hljs">count:  Value Of[ <span class="hljs-number">10</span> ]  Addr Of[ <span class="hljs-number">0x10429fa4</span> ]<font></font>
inc:    Value Of[ <span class="hljs-number">11</span> ]  Addr Of[ <span class="hljs-number">0x10429f98</span> ]<font></font>
count:  Value Of[ <span class="hljs-number">10</span> ]  Addr Of[ <span class="hljs-number">0x10429fa4</span> ]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La valeur de comptage dans la trame pour principal est la m√™me avant et apr√®s l'appel √† l'incr√©mentation.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retour des fonctions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'arrive-t-il r√©ellement √† la m√©moire de la pile lorsque la fonction se termine et que le contr√¥le revient √† la fonction appelante? La r√©ponse courte n'est rien. Voici √† quoi ressemble la pile apr√®s le retour de la fonction d'incr√©mentation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 4: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/ve/-n/qqve-nygmg0jnhsnwrubpchwfky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pile ressemble exactement √† la figure 3, sauf que la trame associ√©e √† la fonction d'incr√©mentation est d√©sormais consid√©r√©e comme une m√©moire non valide. Cela est d√ª au fait que le cadre principal est maintenant actif. La m√©moire cr√©√©e pour la fonction d'incr√©mentation est rest√©e intacte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'effacement de la trame m√©moire de la fonction de retour sera une perte de temps, car on ne sait pas si cette m√©moire sera √† nouveau n√©cessaire. </font><font style="vertical-align: inherit;">Le souvenir est donc rest√© tel qu'il √©tait. </font><font style="vertical-align: inherit;">Lors de chaque appel de fonction, lorsqu'une trame est prise, la m√©moire de pile de cette trame est effac√©e. </font><font style="vertical-align: inherit;">Cela se fait en initialisant toutes les valeurs qui correspondent au cadre. </font><font style="vertical-align: inherit;">√âtant donn√© que toutes les valeurs sont initialis√©es comme leur "valeur z√©ro", les piles sont correctement effac√©es √† chaque appel de fonction.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partage de valeur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et s'il √©tait important que la fonction d'incr√©mentation fonctionne directement avec la variable de comptage qui existe √† l'int√©rieur du cadre pour principal? </font><font style="vertical-align: inherit;">C'est ici que vient le temps des pointeurs. </font><font style="vertical-align: inherit;">Les pointeurs ont un objectif: partager une valeur avec une fonction afin que la fonction puisse lire et √©crire cette valeur, m√™me si la valeur n'existe pas directement dans son cadre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous ne pensez pas que vous devez ¬´partager¬ª la valeur, vous n'avez pas besoin d'utiliser un pointeur. </font><font style="vertical-align: inherit;">Lors de l'apprentissage des pointeurs, il est important de penser que l'utilisation d'un dictionnaire propre, et non d'op√©rateurs ou de syntaxe. </font><font style="vertical-align: inherit;">N'oubliez pas que les pointeurs sont destin√©s √† √™tre partag√©s et lorsque vous lisez le code, remplacez l'op√©rateur &amp; par l'expression ¬´partage¬ª.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types de pointeurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour chaque type que vous avez d√©clar√© ou qui a √©t√© d√©clar√© directement par la langue elle-m√™me, vous obtenez un type de pointeur gratuit que vous pouvez utiliser pour le partage. Il existe d√©j√† un type int√©gr√© appel√© int, il existe donc un type de pointeur nomm√© * int. Si vous d√©clarez un type nomm√© User, vous obtenez gratuitement un type de pointeur nomm√© * User. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les types de pointeurs ont deux caract√©ristiques identiques. Tout d'abord, ils commencent par le caract√®re *. Deuxi√®mement, ils ont tous la m√™me taille en m√©moire et une repr√©sentation occupant 4 ou 8 octets qui repr√©sentent l'adresse. Sur les architectures 32 bits (par exemple, dans la cour de r√©cr√©ation), les pointeurs n√©cessitent 4 octets de m√©moire et sur les architectures 64 bits (par exemple, votre ordinateur), ils n√©cessitent 8 octets de m√©moire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la sp√©cification, les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">types de pointeurs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont consid√©r√©s comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des litt√©raux de type</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui signifie qu'il s'agit de types sans nom compos√©s d'un type existant.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acc√®s m√©moire indirect</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardez ce petit programme qui fait un appel de fonction, en passant l'adresse "par valeur". </font><font style="vertical-align: inherit;">Cela s√©parera la variable de comptage du cadre de pile de main avec la fonction d'incr√©mentation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 10:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">01</span> <span class="hljs-keyword">package</span> main
<span class="hljs-number">02</span>
<span class="hljs-number">03</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
<span class="hljs-number">04</span>
<span class="hljs-number">05</span>    <span class="hljs-comment">// Declare variable of type int with a value of 10.</span>
<span class="hljs-number">06</span>    count := <span class="hljs-number">10</span>
<span class="hljs-number">07</span>
<span class="hljs-number">08</span>    <span class="hljs-comment">// Display the "value of" and "address of" count.</span>
<span class="hljs-number">09</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>, count, <span class="hljs-string">"]\t\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)
<span class="hljs-number">10</span>
<span class="hljs-number">11</span>    <span class="hljs-comment">// Pass the "address of" count.</span>
<span class="hljs-number">12</span>    increment(&amp;count)
<span class="hljs-number">13</span>
<span class="hljs-number">14</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"count:\tValue Of["</span>, count, <span class="hljs-string">"]\t\tAddr Of["</span>, &amp;count, <span class="hljs-string">"]"</span>)
<span class="hljs-number">15</span> }
<span class="hljs-number">16</span>
<span class="hljs-number">17</span> <span class="hljs-comment">//go:noinline</span>
<span class="hljs-number">18</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">increment</span><span class="hljs-params">(inc *<span class="hljs-keyword">int</span>)</span></span> {
<span class="hljs-number">19</span>
<span class="hljs-number">20</span>    <span class="hljs-comment">// Increment the "value of" count that the "pointer points to". (dereferencing)</span>
<span class="hljs-number">21</span>    *inc++
<span class="hljs-number">22</span>    <span class="hljs-built_in">println</span>(<span class="hljs-string">"inc:\tValue Of["</span>, inc, <span class="hljs-string">"]\tAddr Of["</span>, &amp;inc, <span class="hljs-string">"]\tValue Points To["</span>, *inc, <span class="hljs-string">"]"</span>)
<span class="hljs-number">23</span> }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois modifications int√©ressantes ont √©t√© apport√©es au programme d'origine. </font><font style="vertical-align: inherit;">Le premier changement est √† la ligne 12: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 11:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">12</span>    increment(&amp;count)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fois, √† la ligne 12, le code ne copie pas et transmet la "valeur" √† la variable de comptage, mais transmet son "adresse" au lieu de la variable de comptage. Vous pouvez maintenant dire: ¬´Je partage¬ª le nombre de variables avec l'incr√©ment de fonction. C'est ce que dit l'op√©rateur &amp; - ¬´partager¬ª. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sachez qu'il s'agit toujours de ¬´passage par valeur¬ª et que la seule diff√©rence est que la valeur que vous passez est l'adresse, pas l'entier. Les adresses sont √©galement des valeurs; c'est ce qui est copi√© et pass√© √† travers la bordure du cadre pour appeler la fonction. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que la valeur d'adresse est copi√©e et transmise, vous avez besoin d'une variable √† l'int√©rieur du cadre d'incr√©mentation pour obtenir et enregistrer cette adresse enti√®re. Une d√©claration de variable de pointeur entier est √† la ligne 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 12:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">18</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">increment</span><span class="hljs-params">(inc *<span class="hljs-keyword">int</span>)</span></span> {</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez transmis l'adresse de la valeur de type User, alors la variable devra √™tre d√©clar√©e comme * User. Malgr√© le fait que toutes les variables de pointeur stockent des valeurs d'adresse, aucune adresse ne peut leur √™tre transmise, uniquement les adresses associ√©es au type de pointeur. Le principe de base du partage d'une valeur est que la fonction de r√©ception doit lire ou √©crire sur cette valeur. Vous avez besoin d'informations sur le type de n'importe quelle valeur pour y lire et y √©crire. Le compilateur s'assurera que seules les valeurs associ√©es au type de pointeur correct sont utilis√©es avec cette fonction. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici √† quoi ressemble la pile apr√®s avoir appel√© la fonction d'incr√©mentation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 5:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/ak/zj/ukakzj1mpr_9m3thjmv2i04e_hw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La figure 5 montre √† quoi ressemble la pile lorsque le "passage par valeur" est effectu√© en utilisant l'adresse comme valeur. La variable de pointeur √† l'int√©rieur du cadre pour la fonction d'incr√©mentation pointe d√©sormais vers la variable de comptage, qui est situ√©e √† l'int√©rieur du cadre pour principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, en utilisant la variable pointeur, la fonction peut effectuer une op√©ration indirecte de lecture et de modification pour la variable count situ√©e √† l'int√©rieur du cadre pour main. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 13:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-number">21</span>    *inc++</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette fois, le caract√®re * agit comme un op√©rateur et est appliqu√© √† la variable pointeur. L'utilisation de * comme op√©rateur signifie "la valeur vers laquelle pointe le pointeur". Une variable pointeur fournit un acc√®s indirect √† la m√©moire en dehors du cadre de la fonction qui l'utilise. Parfois, cette lecture ou √©criture indirecte est appel√©e d√©r√©f√©rencement de pointeur. La fonction d'incr√©mentation doit toujours avoir une variable pointeur dans sa trame, qu'elle peut lire directement pour effectuer un acc√®s indirect. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La figure 6 montre √† quoi ressemble la pile apr√®s la ligne 21. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 6: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rn/ph/vi/rnphvi1x69rrhspljslmvxilauq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la sortie finale de ce programme: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Listing 14:</font></font><br>
<br>
<pre><code class="go hljs">count:  Value Of[ <span class="hljs-number">10</span> ]              Addr Of[ <span class="hljs-number">0x10429fa4</span> ]<font></font>
inc:    Value Of[ <span class="hljs-number">0x10429fa4</span> ]      Addr Of[ <span class="hljs-number">0x10429f98</span> ]   Value Points To[ <span class="hljs-number">11</span> ]<font></font>
count:  Value Of[ <span class="hljs-number">11</span> ]              Addr Of[ <span class="hljs-number">0x10429fa4</span> ]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez remarquer que la ¬´valeur¬ª de la variable de pointeur inc correspond √† ¬´l'adresse¬ª de la variable de comptage. </font><font style="vertical-align: inherit;">Cela √©tablit une relation de partage qui a permis un acc√®s indirect √† la m√©moire en dehors de la trame. </font><font style="vertical-align: inherit;">D√®s que la fonction d'incr√©mentation √©crit √† travers le pointeur, le changement est visible pour la fonction principale lorsque le contr√¥le lui est retourn√©.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les variables de pointeur ne sont pas sp√©ciales</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables de pointeur ne sont pas sp√©ciales car ce sont les m√™mes variables que toute autre variable. </font><font style="vertical-align: inherit;">Ils ont une allocation de m√©moire et contiennent du sens. </font><font style="vertical-align: inherit;">Il se trouve que toutes les variables de pointeur, quel que soit le type de valeur vers lequel elles peuvent pointer, ont toujours la m√™me taille et la m√™me pr√©sentation. </font><font style="vertical-align: inherit;">Ce qui peut √™tre d√©routant, c'est que le caract√®re * agit comme un op√©rateur dans le code et est utilis√© pour d√©clarer un type de pointeur. </font><font style="vertical-align: inherit;">Si vous pouvez distinguer une d√©claration de type d'une op√©ration de pointeur, cela peut aider √† √©liminer une certaine confusion.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce message d√©crit le but des pointeurs, le fonctionnement de la pile et la m√©canique des pointeurs dans Go. </font><font style="vertical-align: inherit;">Il s'agit de la premi√®re √©tape de la compr√©hension de la m√©canique, des principes de conception et des techniques d'utilisation n√©cessaires pour √©crire du code coh√©rent et lisible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au final, voici ce que vous avez appris:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fonctions sont ex√©cut√©es dans les limites de la trame, qui fournissent un espace m√©moire s√©par√© pour chaque fonction correspondante.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsqu'une fonction est appel√©e, une transition entre deux trames se produit.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'avantage de la transmission de donn√©es ¬´par valeur¬ª est la lisibilit√©.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La pile est importante car elle fournit un espace m√©moire physique pour les limites de trame qui sont donn√©es √† chaque fonction individuelle.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toute la m√©moire de la pile sous la trame active n'est pas valide, mais la m√©moire de la trame active et au-dessus est valide.</font></font></li>
<li>   ,         .</li>
<li>    ,   ,      .</li>
<li>    ‚Äî    ,        ,         .</li>
<li>   ,  ,   ,     ,      .</li>
<li>-          ,   .</li>
<li>-   - ,      ,     .     ,    .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496832/index.html">Visite photo: que font-ils dans le laboratoire de nanophotonique hybride et d'opto√©lectronique du New Physics Institute ITMO</a></li>
<li><a href="../fr496836/index.html">QSerializer: solution pour une s√©rialisation JSON / XML simple</a></li>
<li><a href="../fr496838/index.html">M√©thodologie de d√©ploiement de projet utilis√©e par Slack</a></li>
<li><a href="../fr496840/index.html">Musk pense que 12 000 satellites n'interf√©reront pas avec les astronomes. Son opinion n'est pas conforme au mod√®le</a></li>
<li><a href="../fr496842/index.html">Un mod√®le √©pid√©mique simple avec des outils de base Python</a></li>
<li><a href="../fr496848/index.html">Le condens√© de mat√©riaux int√©ressants pour le d√©veloppeur mobile # 340 (du 6 au 12 avril)</a></li>
<li><a href="../fr496850/index.html">Plugin Maven pour JPackage de Java 14</a></li>
<li><a href="../fr496852/index.html">Tri en douceur</a></li>
<li><a href="../fr496856/index.html">Maison intelligente sans t√©l√©commandes, mais avec un cube</a></li>
<li><a href="../fr496858/index.html">FOSS News n ¬∞ 11 - une revue des logiciels libres et open source du 6 au 12 avril 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>