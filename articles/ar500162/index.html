<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🎤 🚴 😍 بيثون رائع تعليمي معالجة البيانات الرياضية 🕴🏻 🖕🏾 🏁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="في العامين الماضيين في وقت فراغي كنت أقوم بممارسة الترياتلون. تحظى هذه الرياضة بشعبية كبيرة في العديد من دول العالم ، وخاصة في الولايات المتحدة الأمري...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>بيثون رائع تعليمي معالجة البيانات الرياضية</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500162/"><img src="https://habrastorage.org/webt/wd/xv/ft/wdxvftc1pifrlchwt7ddj8dxtos.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في العامين الماضيين في وقت فراغي كنت أقوم بممارسة الترياتلون. تحظى هذه الرياضة بشعبية كبيرة في العديد من دول العالم ، وخاصة في الولايات المتحدة الأمريكية وأستراليا وأوروبا. تكتسب حاليًا شعبية سريعة في روسيا ودول رابطة الدول المستقلة. إنه يتعلق بإشراك الهواة وليس المحترفين. على عكس مجرد السباحة في المسبح وركوب الدراجات والركض في الصباح ، تتضمن الترياتلون المشاركة في المسابقات والتحضير المنتظم لها ، حتى دون أن تكون محترفًا. بالتأكيد بين أصدقائك هناك بالفعل "رجل حديدي" واحد على الأقل أو شخص يخطط ليصبح واحدًا. ضخمة ، مجموعة متنوعة من المسافات والظروف ، ثلاث رياضات في واحدة - كل هذا لديه القدرة على تكوين كمية كبيرة من البيانات. في كل عام ، تجري عدة مئات من مسابقات الترياتلون في العالم ، حيث يشارك فيها مئات الآلاف من الأشخاص.تقام المسابقات من قبل العديد من المنظمين. كل منهم ، بالطبع ، ينشر النتائج في حد ذاته. ولكن بالنسبة للرياضيين من روسيا وبعض دول رابطة الدول المستقلة ، الفريق</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تجمع </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">tristats.ru</font></a><font style="vertical-align: inherit;"> جميع النتائج في مكان واحد - على موقعها الإلكتروني الذي يحمل نفس الاسم. هذا يجعل من السهل جدًا البحث عن النتائج ، سواء الخاصة بك أو أصدقائك ومنافسيك ، أو حتى أصنامك. ولكن بالنسبة لي ، فقد أعطت الفرصة أيضًا لتحليل عدد كبير من النتائج برمجيًا. النتائج المنشورة على trilife: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قراءة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان هذا هو أول مشروع لي من هذا النوع ، لأنني بدأت مؤخرًا فقط في إجراء تحليل البيانات من حيث المبدأ ، وكذلك استخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الثعبان</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">لذلك ، أود أن أخبركم عن التنفيذ الفني لهذا العمل ، خاصة أنه في هذه العملية ، ظهرت فروق دقيقة مختلفة ، تتطلب أحيانًا نهجًا خاصًا. </font><font style="vertical-align: inherit;">ستتمحور حول التخريد والتحليل وأنواع الصب والتنسيقات واستعادة البيانات غير المكتملة وإنشاء عينة تمثيلية والتصور والتحويل وحتى الحوسبة المتوازية.</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحول الحجم إلى حجم كبير ، لذلك قمت بتقسيم كل شيء إلى خمسة أجزاء حتى أتمكن من أخذ المعلومات وتذكر من أين أبدأ بعد الفاصل. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قبل المضي قدمًا ، من الأفضل أن تقرأ مقالتي أولاً بنتائج الدراسة ، لأنه هنا وصف المطبخ بشكل أساسي لإنشائه. </font><font style="vertical-align: inherit;">يستغرق 10-15 دقيقة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هل قرأت؟ </font><font style="vertical-align: inherit;">إذا دعنا نذهب!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجزء 1. الكشط والتحليل</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تعطى: موقع </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tristats.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . هناك نوعان من الجداول التي تهمنا. هذا في الواقع جدول ملخص لجميع الأجناس وبروتوكول لنتائج كل منها. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/m5/do/vpm5dopzyltw9iwcwdddcff2osw.png"><br>
<br>
<img src="https://habrastorage.org/webt/yf/ez/ve/yfezve61_ds1wsaiguh5tjpwd2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كانت المهمة الأولى هي الحصول على هذه البيانات برمجيًا وحفظها لمزيد من المعالجة. حدث ذلك أنني في ذلك الوقت كنت جديدًا في تقنيات الويب ، وبالتالي لم أكن أعرف على الفور كيفية القيام بذلك. لقد بدأت وفقًا لما عرفته - انظر إلى رمز الصفحة. يمكن القيام بذلك باستخدام زر الفأرة الأيمن أو مفتاح </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/43/wc/ex/43wcexjx3j9qfvjla_dubcsjgl0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحتوي القائمة في Chrome على خيارين: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عرض رمز الصفحة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وعرض </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الرمز</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ليس الانقسام الأكثر وضوحا. بطبيعة الحال ، يعطون نتائج مختلفة. تلك التي </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تعرض الرمز</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، إنها تمامًا مثل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - النص النصي المباشر </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بتنسيق html-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لما يتم عرضه في المتصفح هو عنصر حكيم. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/ow/wb/vvowwbmi5fdawtjbocfjo5zztm4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في المقابل ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عرض كود الصفحة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يعطي كود المصدر للصفحة. أيضًا </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ولكن لا توجد بيانات هناك ، فقط أسماء نصوص JS التي تفرغها. حسنا. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o4/k7/d5/o4k7d5k8zuu66hp43vegbix9hoc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن نحن بحاجة إلى فهم كيفية استخدام python لحفظ رمز كل صفحة كملف نصي منفصل. أحاول هذا:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
r = requests.get(url=<span class="hljs-string">'http://tristats.ru/'</span>)<font></font>
print(r.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وأحصل على ... كود المصدر. لكني أحتاج إلى نتيجة تنفيذها. بعد الدراسة والبحث والسؤال ، أدركت أنني بحاجة إلى أداة لأتمتة إجراءات المتصفح ، على سبيل المثال ، </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">السيلينيوم</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . وضعتها. وأيضًا </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChromeDriver</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> للعمل مع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Chrome</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ثم استخدمته على النحو التالي:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
print(driver.page_source)<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يعمل هذا الرمز على تشغيل نافذة متصفح وفتح صفحة فيه على عنوان URL المحدد. ونتيجة لذلك ، نحصل على </font><font style="vertical-align: inherit;">كود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بالفعل مع البيانات المطلوبة. ولكن هناك عقبة واحدة. والنتيجة 100 إدخال فقط ، ويبلغ إجمالي عدد السباقات 2000 تقريبًا. كيف ذلك؟ والحقيقة هي أنه في البداية يتم عرض أول 100 إدخال فقط في المتصفح ، وفقط إذا قمت بالتمرير إلى أسفل الصفحة تمامًا ، فسيتم تحميل المائة التالية ، وهكذا. لذلك ، من الضروري تنفيذ التمرير برمجياً. للقيام بذلك ، استخدم الأمر:</font></font><br>
<br>
<pre><code class="python hljs">driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع كل تمرير ، سنتحقق مما إذا كان رمز الصفحة المحملة قد تغير أم لا. </font><font style="vertical-align: inherit;">إذا لم تتغير ، فسنقوم بالتحقق عدة مرات من الموثوقية ، على سبيل المثال 10 ، ثم يتم تحميل الصفحة بأكملها ويمكنك التوقف. </font><font style="vertical-align: inherit;">بين المخطوطات ، نقوم بتعيين المهلة على ثانية واحدة بحيث يكون للصفحة وقت للتحميل. </font><font style="vertical-align: inherit;">(حتى لو لم يكن لديها الوقت ، لدينا احتياطي - تسع ثوان أخرى). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وسيبدو الرمز الكامل كما يلي:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.chrome.service <span class="hljs-keyword">import</span> Service
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
service = Service(<span class="hljs-string">r'C:\ChromeDriver\chromedriver.exe'</span>)<font></font>
service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
driver.get(<span class="hljs-string">'http://www.tristats.ru/'</span>)<font></font>
prev_html = <span class="hljs-string">''</span>
scroll_attempt = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> scroll_attempt &lt; <span class="hljs-number">10</span>:<font></font>
    driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> prev_html == driver.page_source:<font></font>
        scroll_attempt += <span class="hljs-number">1</span>
    <span class="hljs-keyword">else</span>:<font></font>
        prev_html = driver.page_source<font></font>
        scroll_attempt = <span class="hljs-number">0</span> <font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    f.write(prev_html)<font></font>
<font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذلك ، لدينا </font><font style="vertical-align: inherit;">ملف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مع جدول ملخص لجميع الأجناس. </font><font style="vertical-align: inherit;">بحاجة لتحليلها. </font><font style="vertical-align: inherit;">للقيام بذلك ، استخدم مكتبة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lxml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> html
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أولاً نجد جميع صفوف الجدول. </font><font style="vertical-align: inherit;">لتحديد علامة سلسلة ، ما عليك سوى إلقاء نظرة على </font><font style="vertical-align: inherit;">ملف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في محرر النصوص. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b2/j6/_8/b2j6_8isg6smzxbgkojrppfwif4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن أن يكون ، على سبيل المثال ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"tr ng-تكرار = 'r في racesData' class = 'ng-نطاق' '</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أو جزء لا يمكن العثور عليه في أي علامات.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    sum_html = f.read()<font></font>
<font></font>
tree = html.fromstring(sum_html)<font></font>
rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in racesData']"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم نبدأ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataframe pandas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وكل عنصر من كل صف من الجدول مكتوب على هذا dataframe.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
rs = pd.DataFrame(columns=[<span class="hljs-string">'date'</span>,<span class="hljs-string">'name'</span>,<span class="hljs-string">'link'</span>,<span class="hljs-string">'males'</span>,<span class="hljs-string">'females'</span>,<span class="hljs-string">'rus'</span>,<span class="hljs-string">'total'</span>], index=range(len(rows))) <span class="hljs-comment">#rs – races summary</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لمعرفة مكان إخفاء كل عنصر محدد ، ما عليك سوى إلقاء نظرة على </font><font style="vertical-align: inherit;">رمز </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لأحد عناصر </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">صفوفنا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في محرر النصوص نفسه.</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">ng-repeat</span>=<span class="hljs-string">"r in racesData"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-scope"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>2015-04-26<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/USA.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>Ironman Texas 70.3 2015<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=F"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>605<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-venus fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:Pink"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><font></font>
      /<font></font>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?sex=M"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>1539<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-mars fa-lg"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:LightBlue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/Images/flags/24/rus.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flag"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount == 0 --&gt;</span>
      <span class="hljs-comment">&lt;!-- ngIf: r.CountryCount &gt; 0 --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ng-if</span>=<span class="hljs-string">"r.CountryCount &gt; 0"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/rus/result/ironman/texas/half/2015?country=rus"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"_self"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ng-binding ng-scope"</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- end ngIf: r.CountryCount &gt; 0 --&gt;</span><font></font>
      / 2144<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أسهل طريقة للتنقل باستخدام رمز ثابت للأطفال هنا هي أنه لا يوجد الكثير منها. </font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
    rs.loc[i,<span class="hljs-string">'date'</span>] = rows[i].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'name'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'link'</span>] = rows[i].getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].attrib[<span class="hljs-string">'href'</span>].strip()<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">2</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = rows[i].getchildren()[<span class="hljs-number">2</span>].getchildren()[<span class="hljs-number">0</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].getchildren()[<span class="hljs-number">3</span>].text.strip()<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = rows[i].getchildren()[<span class="hljs-number">3</span>].text_content().split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">1</span>].strip()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ها هي النتيجة: </font><font style="vertical-align: inherit;">
حفظ إطار البيانات هذا في ملف. </font><font style="vertical-align: inherit;">يمكنني استخدام </font><i><font style="vertical-align: inherit;">المخلل</font></i><font style="vertical-align: inherit;"> ، ولكن يمكن أن يكون </font><i><font style="vertical-align: inherit;">CSV</font></i><font style="vertical-align: inherit;"> ، أو أي شيء آخر.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>0</td>
<td>2020-07-02</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>/rus/result/ironman/dubai-duathlon/half/2020</td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
</tr>
<tr>
<td>1</td>
<td>2020-02-07</td>
<td>Ironman Dubai 70.3 2020</td>
<td>/rus/result/ironman/dubai/half/2020</td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
</tr>
<tr>
<td>2</td>
<td>2020-01-29</td>
<td>Israman Half 2020</td>
<td>/rus/result/israman/israman/half/2020</td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
</tr>
<tr>
<td>3</td>
<td>2019-12-08</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>/rus/result/ironman/indian-wells-la-quinta/hal...</td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
</tr>
<tr>
<td>4</td>
<td>2019-12-07</td>
<td>Ironman Taupo 70.3 2019</td>
<td>/rus/result/ironman/taupo/half/2019</td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>1994-07-02</td>
<td>ITU European Championship Eichstatt Olympic 1994</td>
<td>/rus/result/itu/european-championship-eichstat...</td>
<td>61</td>
<td>0</td>
<td>2</td>
<td>61</td>
</tr>
<tr>
<td>1918</td>
<td>1993-09-04</td>
<td>Challenge Almere-Amsterdam Long 1993</td>
<td>/rus/result/challenge/almere-amsterdam/full/1993</td>
<td>795</td>
<td>32</td>
<td>1</td>
<td>827</td>
</tr>
<tr>
<td>1919</td>
<td>1993-07-04</td>
<td>ITU European Cup Echternach Olympic 1993</td>
<td>/rus/result/itu/european-cup-echternach/olympi...</td>
<td>60</td>
<td>0</td>
<td>2</td>
<td>60</td>
</tr>
<tr>
<td>1920</td>
<td>1992-09-12</td>
<td>ITU World Championship Huntsville Olympic 1992</td>
<td>/rus/result/itu/world-championship-huntsville/...</td>
<td>317</td>
<td>0</td>
<td>3</td>
<td>317</td>
</tr>
<tr>
<td>1921</td>
<td>1990-09-15</td>
<td>ITU World Championship Orlando Olympic 1990</td>
<td>/rus/result/itu/world-championship-orlando/oly...</td>
<td>286</td>
<td>0</td>
<td>5</td>
<td>28</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذه المرحلة ، تكون جميع البيانات من نوع سلسلة. </font><font style="vertical-align: inherit;">سنتحول لاحقًا. </font><font style="vertical-align: inherit;">أهم شيء نحتاجه الآن هو الروابط. </font><font style="vertical-align: inherit;">سنستخدمها لإلغاء بروتوكولات جميع الأجناس. </font><font style="vertical-align: inherit;">نصنعها في الصورة وشبه كيف تم إجراؤها للجدول المحوري. </font><font style="vertical-align: inherit;">في الدورة لجميع السباقات لكل منها ، سنفتح الصفحة حسب المرجع ، وننتقل ونحصل على رمز الصفحة. </font><font style="vertical-align: inherit;">في جدول الملخص لدينا معلومات عن العدد الإجمالي للمشاركين في السباق - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المجموع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، سنستخدمها لنفهم حتى النقطة التي تحتاجها لمتابعة التمرير. للقيام بذلك ، سنقوم مباشرة في عملية إلغاء كل صفحة بتحديد عدد السجلات في الجدول ومقارنتها بالقيمة المتوقعة للمجموع. بمجرد أن تكون متساوية ، ننتقل إلى النهاية ويمكنك الانتقال إلى السباق التالي. قمنا أيضًا بتعيين مهلة 60 ثانية. أكلنا خلال هذا الوقت ، لا نصل إلى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المجموع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، نذهب إلى السباق التالي. سيتم حفظ رمز الصفحة في ملف. سنحفظ ملفات جميع الأجناس في مجلد واحد ، ونطلق عليها اسم السباقات ، أي بالقيمة في عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الحدث</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في جدول الملخص. لتجنب تضارب الأسماء ، من الضروري أن يكون لجميع الأجناس أسماء مختلفة في الجدول المحوري. افحص هذا:</font></font><br>
<br>
<pre><code class="python hljs">df[df.duplicated(subset = <span class="hljs-string">'event'</span>, keep=<span class="hljs-literal">False</span>)]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>279</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حسنًا ، في جدول الملخص ، هناك تكرار ، علاوة على ذلك ، التواريخ وعدد المشاركين ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ذكور ، إناث ، روس ، إجمالي</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ، والروابط مختلفة. </font><font style="vertical-align: inherit;">تحتاج إلى التحقق من هذه البروتوكولات ، وهناك القليل منها ، حتى تتمكن من القيام بذلك يدويًا. </font><font style="vertical-align: inherit;">الآن جميع الأسماء فريدة من نوعها ، أطلقنا دورة تعدين كبيرة:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/a8/v7/n8/a8v7n8qoxbzobftxcm0knnvks6m.png"><br>
<br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>date</th>
<th>event</th>
<th>link</th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
</tr>
<tr>
<td>450</td>
<td>2018-07-15</td>
<td>A1  Sprint <u>7</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-07-15</td>
<td>43</td>
<td>15</td>
<td>47</td>
<td>58</td>
</tr>
<tr>
<td>483</td>
<td>2018-06-23</td>
<td>A1  Sprint <u>6</u> 2018</td>
<td>/rus/result/a1/cc/sprint/2018-06-23</td>
<td>61</td>
<td>15</td>
<td>76</td>
<td>76</td>
</tr>
<tr>
<td>670</td>
<td>2017-07-30</td>
<td>3Grom  Olympic <u>7</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-07-30</td>
<td>249</td>
<td>44</td>
<td>293</td>
<td>293</td>
</tr>
<tr>
<td>752</td>
<td>2017-06-11</td>
<td>3Grom  Olympic <u>6</u> 2017</td>
<td>/rus/result/3grom//olympic/2017-06-11</td>
<td>251</td>
<td>28</td>
<td>279</td>
<td>27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">service.start()<font></font>
driver = webdriver.Remote(service.service_url)<font></font>
timeout = <span class="hljs-number">60</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> df.iterrows():
    <span class="hljs-keyword">try</span>:<font></font>
        driver.get(<span class="hljs-string">'http://www.tristats.ru'</span> + row[<span class="hljs-string">'link'</span>])     <font></font>
        start = time.time()<font></font>
<font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
            driver.execute_script(<span class="hljs-string">"window.scrollTo(0, document.body.scrollHeight);"</span>)<font></font>
            time.sleep(<span class="hljs-number">1</span>)<font></font>
            race_html = driver.page_source<font></font>
            tree = html.fromstring(race_html)<font></font>
            race_rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
            <span class="hljs-keyword">if</span> len(race_rows) == int(row[<span class="hljs-string">'total'</span>]):
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> time.time() - start &gt; timeout:<font></font>
                print(<span class="hljs-string">'timeout'</span>)
                <span class="hljs-keyword">break</span><font></font>
<font></font>
        <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, row[<span class="hljs-string">'event'</span>] +  <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:<font></font>
            f.write(race_html)<font></font>
<font></font>
    <span class="hljs-keyword">except</span>:<font></font>
        traceback.print_exc()<font></font>
<font></font>
    time.sleep(<span class="hljs-number">1</span>)<font></font>
    <font></font>
driver.quit()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذه عملية طويلة. </font><font style="vertical-align: inherit;">ولكن عندما يتم إعداد كل شيء وتبدأ هذه الآلية الثقيلة في الدوران ، وإضافة ملفات البيانات واحدة تلو الأخرى ، يأتي الشعور بالإثارة اللطيفة. </font><font style="vertical-align: inherit;">يتم تحميل حوالي ثلاثة بروتوكولات فقط في الدقيقة ، ببطء شديد. </font><font style="vertical-align: inherit;">غادر لتدور ليلا. </font><font style="vertical-align: inherit;">استغرق حوالي 10 ساعات. </font><font style="vertical-align: inherit;">في الصباح ، تم تحميل معظم البروتوكولات. </font><font style="vertical-align: inherit;">كما يحدث عادة عند العمل مع شبكة ، يفشل عدد قليل. </font><font style="vertical-align: inherit;">استأنفها بسرعة بمحاولة ثانية.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/un/wi/el/unwielrqjzt6u6otf8sbwwjbq8q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، لدينا 1،922 ملفًا بسعة إجمالية تبلغ 3 غيغابايت تقريبًا. رائع! لكن التعامل مع ما يقرب من 300 سباق انتهى بمهلة. ما المشكلة؟ تحقق بشكل انتقائي ، وتبين أن القيمة الإجمالية من الجدول المحوري وعدد الإدخالات في بروتوكول السباق التي قمنا بفحصها قد لا تتوافق بالفعل. هذا أمر محزن لأنه لم يتضح سبب هذا التناقض. إما أن هذا يرجع إلى حقيقة أنه لن ينتهي الجميع ، أو نوع من الأخطاء في قاعدة البيانات. بشكل عام ، الإشارة الأولى لنقص البيانات. على أي حال ، نتحقق من تلك التي يكون فيها عدد الإدخالات 100 أو 0 ، هؤلاء هم أكثر المرشحين المشبوهة. كان هناك ثمانية منهم. قم بتنزيلها مرة أخرى تحت تحكم وثيق. بالمناسبة ، يوجد اثنان منهم في الواقع 100 إدخال.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، لدينا جميع البيانات. </font><font style="vertical-align: inherit;">ننتقل إلى التحليل. </font><font style="vertical-align: inherit;">مرة أخرى ، في دورة سنجري كل سباق ، ونقرأ الملف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ونحفظ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> المحتويات في </font><i><font style="vertical-align: inherit;">DataFrame من الباندا</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">سنقوم بدمج إطارات البيانات هذه في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إملاء</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حيث تكون أسماء الأجناس هي المفاتيح - أي أن قيم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الأحداث</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> من الجدول المحوري أو أسماء الملفات مع </font><font style="vertical-align: inherit;">كود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لصفحات السباق ، تتطابق.</font></font><br>
<br>
<pre><code class="python hljs">rd = {} <span class="hljs-comment">#rd – race details</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'event'</span>]:<font></font>
    place = []<font></font>
    ... sex = [], name=..., country, group, place_in_group, swim, t1, bike, t2, run<font></font>
    result = []<font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>)<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    rows = tree.findall(<span class="hljs-string">".//*[@ng-repeat='r in resultsData']"</span>)<font></font>
<font></font>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(rows)):<font></font>
        row = rows[j]<font></font>
        parts = row.text_content().split(<span class="hljs-string">'\n'</span>)<font></font>
        parts = [r.strip() <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> parts <span class="hljs-keyword">if</span> r.strip() != <span class="hljs-string">''</span>]<font></font>
        place.append(parts[<span class="hljs-number">0</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)]) &gt; <span class="hljs-number">0</span>:<font></font>
            sex.append([a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> row.findall(<span class="hljs-string">'.//i'</span>)][<span class="hljs-number">0</span>].attrib[<span class="hljs-string">'ng-if'</span>][<span class="hljs-number">10</span>:<span class="hljs-number">-1</span>])
        <span class="hljs-keyword">else</span>:<font></font>
            sex.append(<span class="hljs-string">''</span>)<font></font>
<font></font>
        name.append(parts[<span class="hljs-number">1</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> len(parts) &gt; <span class="hljs-number">10</span>:<font></font>
            country.append(parts[<span class="hljs-number">2</span>].strip())         <font></font>
            k=<span class="hljs-number">0</span>
        <span class="hljs-keyword">else</span>:<font></font>
            country.append(<span class="hljs-string">''</span>)<font></font>
            k=<span class="hljs-number">1</span><font></font>
<font></font>
        group.append(parts[<span class="hljs-number">3</span>-k])<font></font>
        ... place_in_group.append(...), swim.append ..., t1, bike, t2, run<font></font>
        result.append(parts[<span class="hljs-number">10</span>-k])<font></font>
<font></font>
    race = pd.DataFrame()<font></font>
    race[<span class="hljs-string">'place'</span>] = place<font></font>
    ... race[<span class="hljs-string">'sex'</span>] = sex, race[<span class="hljs-string">'name'</span>] = ..., <span class="hljs-string">'country'</span>, <span class="hljs-string">'group'</span>, <span class="hljs-string">'place_in_group'</span>, <span class="hljs-string">'swim'</span>, <span class="hljs-string">' t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>
    race[<span class="hljs-string">'result'</span>] = result<font></font>
<font></font>
    rd[e] = race<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Reed, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>1</td>
<td>24:34</td>
<td>1:07</td>
<td>2:13:46</td>
<td>1:49</td>
<td>1:23:17</td>
<td>4:04:33</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Van Berkel, Tim</td>
<td>AUS</td>
<td>MPRO</td>
<td>2</td>
<td>24:34</td>
<td>1:05</td>
<td>2:13:47</td>
<td>1:53</td>
<td>1:27:17</td>
<td>4:08:36</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Baldwin, Nicholas</td>
<td>SEY</td>
<td>MPRO</td>
<td>3</td>
<td>26:31</td>
<td>0:59</td>
<td>2:14:06</td>
<td>1:54</td>
<td>1:25:36</td>
<td>4:09:06</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Polizzi, Alexander</td>
<td>AUS</td>
<td>MPRO</td>
<td>4</td>
<td>23:21</td>
<td>1:12</td>
<td>2:14:53</td>
<td>1:54</td>
<td>1:31:16</td>
<td>4:12:36</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Chang, Chia-Hao</td>
<td>TWN</td>
<td>M18-24</td>
<td>1</td>
<td>25:18</td>
<td>1:34</td>
<td>2:23:38</td>
<td>2:13</td>
<td>1:29:01</td>
<td>4:21:44</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Rondy, Guillaume</td>
<td>FRA</td>
<td>M35-39</td>
<td>1</td>
<td>27:51</td>
<td>1:26</td>
<td>2:21:53</td>
<td>2:29</td>
<td>1:35:19</td>
<td>4:28:58</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>F</td>
<td>Steffen, Caroline</td>
<td>SUI</td>
<td>FPRO</td>
<td>1</td>
<td>26:52</td>
<td>1:01</td>
<td>2:24:54</td>
<td>2:10</td>
<td>1:34:17</td>
<td>4:29:14</td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Betten, Sam</td>
<td>AUS</td>
<td>MPRO</td>
<td>5</td>
<td>23:30</td>
<td>1:26</td>
<td>2:18:24</td>
<td>1:57</td>
<td>1:45:07</td>
<td>4:30:24</td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Gallot, Simon</td>
<td>FRA</td>
<td>M30-34</td>
<td>1</td>
<td>27:50</td>
<td>1:33</td>
<td>2:20:15</td>
<td>2:13</td>
<td>1:45:22</td>
<td>4:37:13</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>524</td>
<td>525</td>
<td>M</td>
<td>Santos, Alfredo</td>
<td>PHI</td>
<td>M65-69</td>
<td>2</td>
<td>50:42</td>
<td>4:23</td>
<td>3:52:10</td>
<td>10:32</td>
<td>3:36:11</td>
<td>8:33:58</td>
</tr>
<tr>
<td>525</td>
<td>526</td>
<td>F</td>
<td>Escober, Eula</td>
<td>PHI</td>
<td>F18-24</td>
<td>5</td>
<td>47:07</td>
<td>3:50</td>
<td>4:43:44</td>
<td>3:41</td>
<td>2:59:45</td>
<td>8:38:07</td>
</tr>
<tr>
<td>526</td>
<td>527</td>
<td>M</td>
<td>Belen, Virgilio Jr.</td>
<td>PHI</td>
<td>M45-49</td>
<td>76</td>
<td>47:05</td>
<td>5:49</td>
<td>3:48:18</td>
<td>11:21</td>
<td>3:46:06</td>
<td>8:38:39</td>
</tr>
<tr>
<td>527</td>
<td>528</td>
<td>M</td>
<td>Kunimoto, Kilhak</td>
<td>GUM</td>
<td>M70-74</td>
<td>2</td>
<td>40:32</td>
<td>2:50</td>
<td>3:53:37</td>
<td>6:45</td>
<td>4:01:36</td>
<td>8:45:20</td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td>Sumicad, Siegfred</td>
<td>PHI</td>
<td>M50-54</td>
<td>54</td>
<td>59:10</td>
<td>4:38</td>
<td>4:11:55</td>
<td>6:35</td>
<td>3:23:45</td>
<td>8:46:03</td>
</tr>
<tr>
<td>529</td>
<td>530</td>
<td>M</td>
<td>Gomez, Paul</td>
<td>PHI</td>
<td>M45-49</td>
<td>77</td>
<td>50:02</td>
<td>6:29</td>
<td>4:07:58</td>
<td>7:24</td>
<td>3:41:41</td>
<td>8:53:34</td>
</tr>
<tr>
<td>530</td>
<td>531</td>
<td>M</td>
<td>Ramos, John Raymund</td>
<td>PHI</td>
<td>M25-29</td>
<td>26</td>
<td>43:44</td>
<td>3:04</td>
<td>4:21:13</td>
<td>5:56</td>
<td>3:45:10</td>
<td>8:59:07</td>
</tr>
<tr>
<td>531</td>
<td>532</td>
<td>F</td>
<td>De Guzman, Clouie Anne</td>
<td>PHI</td>
<td>F30-34</td>
<td>9</td>
<td>52:29</td>
<td>3:16</td>
<td>4:03:02</td>
<td>7:01</td>
<td>3:56:39</td>
<td>9:02:27</td>
</tr>
<tr>
<td>532</td>
<td>533</td>
<td>F</td>
<td>Samson, Maria Dolores</td>
<td>PHI</td>
<td>F45-49</td>
<td>17</td>
<td>48:56</td>
<td>4:21</td>
<td>4:16:34</td>
<td>6:26</td>
<td>3:47:06</td>
<td>9:03:23</td>
</tr>
<tr>
<td>533</td>
<td>534</td>
<td>M</td>
<td>Salazar, Richard</td>
<td>PHI</td>
<td>M40-44</td>
<td>107</td>
<td>42:19</td>
<td>4:02</td>
<td>4:30:36</td>
<td>6:39</td>
<td>3:39:51</td>
<td>9:03:27</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالإضافة إلى الجدول الذي يتضمن نتائج المشاركين ، </font><font style="vertical-align: inherit;">يحتوي ملف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لكل سباق أيضًا على تاريخ المسابقة واسمها ومكانها. </font><font style="vertical-align: inherit;">التاريخ والاسم موجودان بالفعل في الجدول المحوري ، ولكن لا يوجد موقع. </font><font style="vertical-align: inherit;">نقرأ هذه المعلومات من </font><font style="vertical-align: inherit;">ملفات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html ونضيفها</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى عمود جديد في الجدول المحوري.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]       
    <span class="hljs-keyword">with</span> open(os.path.join(<span class="hljs-string">r'D:\tri\races'</span>, e + <span class="hljs-string">'.txt'</span>), <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        race_html = f.read()<font></font>
<font></font>
    tree = html.fromstring(race_html)<font></font>
    header_elem = [tb <span class="hljs-keyword">for</span> tb <span class="hljs-keyword">in</span> tree.findall(<span class="hljs-string">'.//tbody'</span>) <span class="hljs-keyword">if</span> tb.getchildren()[<span class="hljs-number">0</span>].getchildren()[<span class="hljs-number">0</span>].text == <span class="hljs-string">''</span>][<span class="hljs-number">0</span>]<font></font>
    location = header_elem.getchildren()[<span class="hljs-number">1</span>].getchildren()[<span class="hljs-number">1</span>].text.strip()<font></font>
    rs.loc[index, <span class="hljs-string">'loc'</span>] = location
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حفظ. </font><font style="vertical-align: inherit;">إلى ملف جديد.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(df,f)<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجزء 2. اكتب الصب والتنسيق</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، قمنا بتنزيل جميع البيانات ووضعناها في إطارات البيانات. </font><font style="vertical-align: inherit;">ومع ذلك ، فإن جميع القيم من نوع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ينطبق هذا على التاريخ ، وعلى النتائج ، والموقع ، وجميع المعلمات الأخرى. </font><font style="vertical-align: inherit;">يجب تحويل جميع المعلمات إلى الأنواع المناسبة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لنبدأ بالجدول المحوري.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>male</th>
<th>female</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td><u>Xiamen, China</u></td>
<td>897</td>
<td>170</td>
<td>14</td>
<td>1067</td>
<td>...</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td><u>...</u></td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التاريخ و الوقت</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الحدث</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في الموضع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">صلة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ستترك كما هي. </font><font style="vertical-align: inherit;">تحويل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التاريخ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تاريخ الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> كما يلي:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'date'</span>] = pd.to_datetime(rs[<span class="hljs-string">'date'</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الباقي يلقي إلى نوع صحيح:</font></font><br>
<br>
<pre><code class="python hljs">cols = [<span class="hljs-string">'males'</span>, <span class="hljs-string">'females'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'total'</span>]<font></font>
rs[cols] = rs[cols].astype(int)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كل شيء سار بسلاسة ، لم تنشأ أخطاء. </font><font style="vertical-align: inherit;">لذلك كل شيء على ما يرام - احفظ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\summary2.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rs, f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن سباقات الإطارات. </font><font style="vertical-align: inherit;">نظرًا لأن جميع السباقات أكثر ملاءمة وأسرع في المعالجة في وقت واحد ، وليست واحدة في كل مرة ، فسوف نجمعها في إطار بيانات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> واحد كبير </font><font style="vertical-align: inherit;">(قصير </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لجميع السجلات</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) باستخدام طريقة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">concat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd) 
</code></pre><br>
<i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يحتوي </font><i><font style="vertical-align: inherit;">ar</font></i><font style="vertical-align: inherit;"> على 1،416،365 إدخالات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن قم بتحويل المكان والمكان في المجموعة إلى قيمة صحيحة.</font></font><br>
<br>
<pre><code class="python hljs">ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]] = ar[[<span class="hljs-string">'place'</span>, <span class="hljs-string">'place in group'</span>]].astype(int))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، نعالج الأعمدة بقيم مؤقتة. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سنلقيها</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في النوع </font><i><font style="vertical-align: inherit;">Timedelta</font></i><font style="vertical-align: inherit;"> من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ولكن لكي ينجح التحويل ، تحتاج إلى إعداد البيانات بشكل صحيح. </font><font style="vertical-align: inherit;">يمكنك أن ترى أن بعض القيم التي تستغرق أقل من ساعة تذهب دون تحديد النصيحة ذاتها. </font><font style="vertical-align: inherit;">تحتاج لإضافته.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>29:03</u></td>
<td><u>2:50</u></td>
<td>2:09:17</td>
<td><u>1:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>29:00</u></td>
<td><u>2:40</u></td>
<td>2:07:01</td>
<td><u>1:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>27:34</u></td>
<td><u>2:09</u></td>
<td>2:12:13</td>
<td><u>1:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    strlen = ar[col].str.len()<font></font>
    ar.loc[strlen==<span class="hljs-number">5</span>, col] = <span class="hljs-string">'0:'</span> + ar.loc[strlen==<span class="hljs-number">5</span>, col]<font></font>
    ar.loc[strlen==<span class="hljs-number">4</span>, col] = <span class="hljs-string">'0:0'</span> + ar.loc[strlen==<span class="hljs-number">4</span>, col]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، لا تزال السلاسل المتبقية ، تبدو كما يلي: </font><font style="vertical-align: inherit;">التحويل إلى </font><i><font style="vertical-align: inherit;">Timedelta</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th><u>swim</u></th>
<th><u>t1</u></th>
<th>bike</th>
<th><u>t2</u></th>
<th>run</th>
<th>result</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Dejan Patrcevic</td>
<td>CRO</td>
<td>M40-44</td>
<td>1</td>
<td><u>0:29:03</u></td>
<td><u>0:02:50</u></td>
<td>2:09:17</td>
<td><u>0:01:37</u></td>
<td>1:22:06</td>
<td>4:04:51</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Lukas Krpec</td>
<td>CZE</td>
<td>M35-39</td>
<td>1</td>
<td><u>0:29:00</u></td>
<td><u>0:02:40</u></td>
<td>2:07:01</td>
<td><u>0:01:48</u></td>
<td>1:25:48</td>
<td>4:06:15</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Marin Koceic</td>
<td>CRO</td>
<td>M40-44</td>
<td>2</td>
<td><u>0:27:34</u></td>
<td><u>0:02:09</u></td>
<td>2:12:13</td>
<td><u>0:01:30</u></td>
<td>1:27:19</td>
<td>4:10:44</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> [<span class="hljs-string">'swim'</span>, <span class="hljs-string">'t1'</span>, <span class="hljs-string">'bike'</span>, <span class="hljs-string">'t2'</span>, <span class="hljs-string">'run'</span>, <span class="hljs-string">'result'</span>]:<font></font>
    ar[col] = pd.to_timedelta(ar[col])<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أرضية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
استمر. </font><font style="vertical-align: inherit;">تحقق من </font><font style="vertical-align: inherit;">وجود قيم </font><i><font style="vertical-align: inherit;">M</font></i><font style="vertical-align: inherit;"> و </font><i><font style="vertical-align: inherit;">F</font></i><font style="vertical-align: inherit;"> فقط في </font><font style="vertical-align: inherit;">عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجنس</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex'</span>].unique() 
</code></pre><br>
<code><b>Out:</b> ['M', 'F', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الواقع ، لا تزال هناك سلسلة فارغة ، أي لم يتم تحديد الجنس. </font><font style="vertical-align: inherit;">دعونا نرى كم عدد هذه الحالات:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]) 
</code></pre><br>
<code><b>Out:</b> 2538<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ليس الكثير جيد. </font><font style="vertical-align: inherit;">في المستقبل ، سنحاول تقليل هذه القيمة بشكل أكبر. </font><font style="vertical-align: inherit;">في هذه الأثناء ، اترك عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجنس</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> كما هو في شكل خطوط. </font><font style="vertical-align: inherit;">سنحفظ النتيجة قبل الانتقال إلى تحولات أكثر خطورة وخطورة. </font><font style="vertical-align: inherit;">من أجل الحفاظ على الاستمرارية بين الملفات ، نقوم بتحويل إطار البيانات المدمج </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى قاموس إطارات البيانات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> ar.index.get_level_values(<span class="hljs-number">0</span>).unique():<font></font>
    rd[event] = ar.loc[event]<font></font>
<font></font>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\details1.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
    pkl.dump(rd,f)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالمناسبة ، بسبب تحويل أنواع بعض الأعمدة ، انخفضت أحجام الملفات من 367 كيلوبايت إلى 295 كيلوبايت للجدول المحوري ومن 251 ميجابايت إلى 168 ميجابايت لبروتوكولات السباق. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الرقم الدولي</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن دعنا نرى البلد.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'country'</span>].unique()
</code></pre><br>
<code><b>Out:</b> ['CRO', 'CZE', 'SLO', 'SRB', 'BUL', 'SVK', 'SWE', 'BIH', 'POL', 'MK', 'ROU', 'GRE', 'FRA', 'HUN', 'NOR', 'AUT', 'MNE', 'GBR', 'RUS', 'UAE', 'USA', 'GER', 'URU', 'CRC', 'ITA', 'DEN', 'TUR', 'SUI', 'MEX', 'BLR', 'EST', 'NED', 'AUS', 'BGI', 'BEL', 'ESP', 'POR', 'UKR', 'CAN', 'IRL', 'JPN', 'HKG', 'JEY', 'SGP', 'BRA', 'QAT', 'LUX', 'RSA', 'NZL', 'LAT', 'PHI', 'KSA', 'SEY', 'MAS', 'OMA', 'ARG', 'ECU', 'THA', 'JOR', 'BRN', 'CIV', 'FIN', 'IRN', 'BER', 'LBA', 'KUW', 'LTU', 'SRI', 'HON', 'INA', 'LBN', 'PAN', 'EGY', 'MLT', 'WAL', 'ISL', 'CYP', 'DOM', 'IND', 'VIE', 'MRI', 'AZE', 'MLD', 'LIE', 'VEN', 'ALG', 'SYR', 'MAR', 'KZK', 'PER', 'COL', 'IRQ', 'PAK', 'CZK', 'KAZ', 'CHN', 'NEP', 'ISR', 'MKD', 'FRO', 'BAN', 'ARU', 'CPV', 'ALB', 'BIZ', 'TPE', 'KGZ', 'BNN', 'CUB', 'SNG', 'VTN', 'THI', 'PRG', 'KOR', 'RE', 'TW', 'VN', 'MOL', 'FRE', 'AND', 'MDV', 'GUA', 'MON', 'ARM', 'F.I.TRI.', 'BAHREIN', 'SUECIA', 'REPUBLICA CHECA', 'BRASIL', 'CHI', 'MDA', 'TUN', 'NDL', 'Danish(Dane)', 'Welsh', 'Austrian', 'Unknown', 'AFG', 'Argentinean', 'Pitcairn', 'South African', 'Greenland', 'ESTADOS UNIDOS', 'LUXEMBURGO', 'SUDAFRICA', 'NUEVA ZELANDA', 'RUMANIA', 'PM', 'BAH', 'LTV', 'ESA', 'LAB', 'GIB', 'GUT', 'SAR', 'ita', 'aut', 'ger', 'esp', 'gbr', 'hun', 'den', 'usa', 'sui', 'slo', 'cze', 'svk', 'fra', 'fin', 'isr', 'irn', 'irl', 'bel', 'ned', 'sco', 'pol', 'SMR', 'mex', 'STEEL T BG', 'KINO MANA', 'IVB', 'TCH', 'SCO', 'KEN', 'BAS', 'ZIM', 'Joe', 'PUR', 'SWZ', 'Mark', 'WLS', 'MYA', 'BOT', 'REU', 'NAM', 'NCL', 'BOL', 'GGY', 'ISV', 'TWN', 'GUM', 'FIJ', 'COK', 'NGR', 'IRI', 'GAB', 'ANT', 'GEO', 'COG', 'sue', 'SUD', 'BAR', 'CAY', 'BO', 'VE', 'AX', 'MD', 'PAR', 'UM', 'SEN', 'NIG', 'RWA', 'YEM', 'PLE', 'GHA', 'ITU', 'UZB', 'MGL', 'MAC', 'DMA', 'TAH', 'TTO', 'AHO', 'JAM', 'SKN', 'GRN', 'PRK', 'NFK', 'SOL', 'Sandy', 'SAM', 'PNG', 'SGS', 'Suchy, Jorg', 'SOG', 'GEQ', 'BVT', 'DJI', 'CHA', 'ANG', 'YUG', 'IOT', 'HAI', 'SJM', 'CUW', 'BHU', 'ERI', 'FLK', 'HMD', 'GUF', 'ESH', 'sandy', 'UMI', 'selsmark, 'Alise', 'Eddie', '31/3, Colin', 'CC', '', '', '', '', '', ' ', '', '', '', '-', '', 'GRL', 'UGA', 'VAT', 'ETH', 'ASA', 'PYF', 'ATA', 'ALA', 'MTQ', 'ZZ', 'CXR', 'AIA', 'TJK', 'GUY', 'KR', 'PF', 'BN', 'MO', 'LA', 'CAM', 'NCA', 'ZAM', 'MAD', 'TOG', 'VIR', 'ATF', 'VAN', 'SLE', 'GLP', 'SCG', 'LAO', 'IMN', 'BUR', 'IR', 'SY', 'CMR', 'GBS', 'SUR', 'MOZ', 'BLM', 'MSR', 'CAF', 'BEN', 'COD', 'CCK', 'TUV', 'TGA', 'GI', 'XKX', 'NRU', 'NC', 'LBR', 'TAN', 'VIN', 'SSD', 'GP', 'PS', 'IM', 'JE', '', 'MLI', 'FSM', 'LCA', 'GMB', 'MHL', 'NH', 'FL', 'CT', 'UT', 'AQ', 'Korea', 'Taiwan', 'NewCaledonia', 'Czech Republic', 'PLW', 'BRU', 'RUN', 'NIU', 'KIR', 'SOM', 'TKM', 'SPM', 'BDI', 'COM', 'TCA', 'SHN', 'DO2', 'DCF', 'PCN', 'MNP', 'MYT', 'SXM', 'MAF', 'GUI', 'AN', 'Slovak republic', 'Channel Islands', 'Reunion', 'Wales', 'Scotland', 'ica', 'WLF', 'D', 'F', 'I', 'B', 'L', 'E', 'A', 'S', 'N', 'H', 'R', 'NU', 'BES', 'Bavaria', 'TLS', 'J', 'TKL', 'Tirol"', 'P', '?????', 'EU', 'ES-IB', 'ES-CT', '', 'SOO', 'LZE', '', '', '', '', '', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
412 قيمة فريدة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بشكل أساسي ، يشار إلى البلد برمز إلكتروني مكون من ثلاثة أرقام في حالة الأحرف الكبيرة. </font><font style="vertical-align: inherit;">لكن على ما يبدو ، ليس دائمًا. </font><font style="vertical-align: inherit;">في الواقع ، هناك معيار دولي </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISO 3166</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حيث يتم تحديد الرموز المكونة من ثلاثة أرقام والرقمين لجميع البلدان ، بما في ذلك حتى تلك التي لم تعد موجودة. </font><font style="vertical-align: inherit;">بالنسبة إلى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">python ،</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكن العثور </font><font style="vertical-align: inherit;">على </font><font style="vertical-align: inherit;">أحد تطبيقات هذا المعيار في حزمة </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">وإليك كيف يعمل:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pycountry <span class="hljs-keyword">as</span> pyco<font></font>
<font></font>
pyco.countries.get(alpha_3 = <span class="hljs-string">'RUS'</span>)
</code></pre><br>
<code><b>Out:</b> Country(alpha_2='RU', alpha_3='RUS', name='Russian Federation', numeric='643')<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالتالي ، سوف نتحقق من جميع الرموز المكونة من ثلاثة أرقام ، مما يؤدي إلى الأحرف الكبيرة ، والتي تعطي استجابة في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">countries.get (...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">historical_countries.get (...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">valid_a3 = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ar[<span class="hljs-string">'country'</span>].unique() <span class="hljs-keyword">if</span> pyco.countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> pyco.historic_countries.get(alpha_3 = c.upper()) != <span class="hljs-literal">None</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان هناك 190 من أصل 412 منهم ، أي أقل من النصف. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالنسبة لـ 222 المتبقية (نشير إلى قائمتهم بواسطة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tofix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ، </font><i><font style="vertical-align: inherit;">سننشئ</font></i><font style="vertical-align: inherit;"> قاموس مطابقة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الإصلاح</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حيث سيكون المفتاح هو الاسم الأصلي ، وتكون القيمة هي رمز مكون من ثلاثة أرقام وفقًا لمعيار ISO.</font></font><br>
<br>
<pre><code class="python hljs">tofix = list(set(ar[<span class="hljs-string">'country'</span>].unique()) - set(valid_a3))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أولاً ، تحقق من الرموز المكونة من رقمين باستخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (alpha_2 = ...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، مما يؤدي إلى الأحرف الكبيرة:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix: <span class="hljs-comment">#icc -invalid country code</span>
    <span class="hljs-keyword">if</span> pyco.countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.historic_countries.get(alpha_2 = icc.upper()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.historic_countries.get(alpha_2 = icc.upper()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم الأسماء الكاملة من خلال </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycountry.countries.get (name = ...) ، pycountry.countries.get (common_name = ...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، مما يؤدي إلى النموذج </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str.title ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> pyco.countries.get(common_name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
        fix[icc] = pyco.countries.get(common_name = icc.title()).alpha_3<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> pyco.countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
            fix[icc] = pyco.countries.get(name = icc.title()).alpha_3<font></font>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> pyco.historic_countries.get(name = icc.title()) != <span class="hljs-literal">None</span>:<font></font>
                fix[icc] = pyco.historic_countries.get(name = icc.title()).alpha_3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالتالي ، قمنا بتقليل عدد القيم غير المعترف بها إلى 190. لا يزال كثيرًا جدًا: </font><font style="vertical-align: inherit;">
قد تلاحظ أنه لا يزال هناك العديد من الرموز المكونة من ثلاثة أرقام ، ولكن هذا ليس ISO. </font><font style="vertical-align: inherit;">ماذا بعد؟ </font><font style="vertical-align: inherit;">اتضح أن هناك معيار آخر - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">الأولمبية</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">لسوء الحظ ، لم يتم تضمين تنفيذه في pycountry وعليك البحث عن شيء آخر. </font><font style="vertical-align: inherit;">تم العثور على الحل في شكل </font><font style="vertical-align: inherit;">ملف </font><i><font style="vertical-align: inherit;">csv</font></i><font style="vertical-align: inherit;"> على </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">datahub.io</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">وضع محتويات هذا الملف في </font><i><font style="vertical-align: inherit;">DataFrame الباندا</font></i><font style="vertical-align: inherit;"> يسمى </font><i><font style="vertical-align: inherit;">قوات الدفاع المدني</font></i><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">ioc</font></i><font style="vertical-align: inherit;"> - اللجنة الأولمبية الدولية (IOC)</font></font><br>
<code>['URU', '', 'PAR', 'SUECIA', 'KUW', 'South African', '', 'Austrian', 'ISV', 'H', 'SCO', 'ES-CT', ', 'GUI', 'BOT', 'SEY', 'BIZ', 'LAB', 'PUR', ' ', 'Scotland', '', '', 'TCH', 'TGA', 'UT', 'BAH', 'GEQ', 'NEP', 'TAH', 'ica', 'FRE', 'E', 'TOG', 'MYA', '', 'Danish (Dane)', 'SAM', 'TPE', 'MON', 'ger', 'Unknown', 'sui', 'R', 'SUI', 'A', 'GRN', 'KZK', 'Wales', '', 'GBS', 'ESA', 'Bavaria', 'Czech Republic', '31/3, Colin', 'SOL', 'SKN', '', 'MGL', 'XKX', 'WLS', 'MOL', 'FIJ', 'CAY', 'ES-IB', 'BER', 'PLE', 'MRI', 'B', 'KSA', '', '', 'LAT', 'GRE', 'ARU', '', 'THI', 'NGR', 'MAD', 'SOG', 'MLD', '?????', 'AHO', 'sco', 'UAE', 'RUMANIA', 'CRO', 'RSA', 'NUEVA ZELANDA', 'KINO MANA', 'PHI', 'sue', 'Tirol"', 'IRI', 'POR', 'CZK', 'SAR', 'D', 'BRASIL', 'DCF', 'HAI', 'ned', 'N', 'BAHREIN', 'VTN', 'EU', 'CAM', 'Mark', 'BUL', 'Welsh', 'VIN', 'HON', 'ESTADOS UNIDOS', 'I', 'GUA', 'OMA', 'CRC', 'PRG', 'NIG', 'BHU', 'Joe', 'GER', 'RUN', 'ALG', '', 'Channel Islands', 'Reunion', 'REPUBLICA CHECA', 'slo', 'ANG', 'NewCaledonia', 'GUT', 'VIE', 'ASA', 'BAR', 'SRI', 'L', '', 'J', 'BAS', 'LUXEMBURGO', 'S', 'CHI', 'SNG', 'BNN', 'den', 'F.I.TRI.', 'STEEL T BG', 'NCA', 'Slovak republic', 'MAS', 'LZE', '-', 'F', 'BRU', '', 'LBA', 'NDL', 'DEN', 'IVB', 'BAN', 'Sandy', 'ZAM', 'sandy', 'Korea', 'SOO', 'BGI', '', 'LTV', 'selsmark, Alise', 'TAN', 'NED', '', 'Suchy, Jorg', 'SLO', 'SUDAFRICA', 'ZIM', 'Eddie', 'INA', '', 'SUD', 'VAN', 'FL', 'P', 'ITU', 'ZZ', 'Argentinean', 'CHA', 'DO2', 'WAL']<br>
</code><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>official name</th>
<th>short name</th>
<th>iso2</th>
<th><u>iso3</u></th>
<th><u>ioc</u></th>
</tr>
<tr>
<td>0</td>
<td>NaN</td>
<td>Taiwan</td>
<td>TW</td>
<td><u>TWN</u></td>
<td><u>TPE</u></td>
</tr>
<tr>
<td>1</td>
<td>Afghanistan</td>
<td>Afghanistan</td>
<td>AF</td>
<td><u>AFG</u></td>
<td><u>AFG</u></td>
</tr>
<tr>
<td>2</td>
<td>Albania</td>
<td>Albania</td>
<td>AL</td>
<td><u>ALB</u></td>
<td><u>ALB</u></td>
</tr>
<tr>
<td>3</td>
<td>Algeria</td>
<td>Algeria</td>
<td>DZ</td>
<td><u>DZA</u></td>
<td><u>ALG</u></td>
</tr>
<tr>
<td>4</td>
<td>American Samoa</td>
<td>American Samoa</td>
<td>AS</td>
<td><u>ASM</u></td>
<td><u>ASA</u></td>
</tr>
<tr>
<td>5</td>
<td>Andorra</td>
<td>Andorra</td>
<td>AD</td>
<td><u>AND</u></td>
<td><u>AND</u></td>
</tr>
<tr>
<td>6</td>
<td>Angola</td>
<td>Angola</td>
<td>AO</td>
<td><u>AGO</u></td>
<td><u>ANG</u></td>
</tr>
<tr>
<td>7</td>
<td>Anguilla</td>
<td>Anguilla</td>
<td>AI</td>
<td><u>AIA</u></td>
<td><u>AIA</u></td>
</tr>
<tr>
<td>8</td>
<td>Antarctica</td>
<td>Antarctica</td>
<td>AQ</td>
<td><u>ATA</u></td>
<td><u>NaN</u></td>
</tr>
<tr>
<td>9</td>
<td>Antigua and Barbuda</td>
<td>Antigua &amp; Barbuda</td>
<td>AG</td>
<td><u>ATG</u></td>
<td><u>ANT</u></td>
</tr>
<tr>
<td>10</td>
<td>Argentina</td>
<td>Argentina</td>
<td>AR</td>
<td><u>ARG</u></td>
<td><u>ARG</u></td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">len(([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>])]))
</code></pre><br>
<code><b>Out:</b> 82<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من بين الرموز الثلاثة المكونة من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tofix ، تم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> العثور على 82 بطاقة </font><i><font style="vertical-align: inherit;">IOC</font></i><font style="vertical-align: inherit;"> مقابلة. </font><font style="vertical-align: inherit;">أضفهم إلى قاموسنا المطابق.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> icc <span class="hljs-keyword">in</span> tofix:
    <span class="hljs-keyword">if</span> icc.upper() <span class="hljs-keyword">in</span> list(cdf[<span class="hljs-string">'ioc'</span>]):<font></font>
        ind = cdf[cdf[<span class="hljs-string">'ioc'</span>] == icc.upper()].index[<span class="hljs-number">0</span>]<font></font>
        fix[icc] = cdf.loc[ind, <span class="hljs-string">'iso3'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
108 القيم الخام المتبقية. </font><font style="vertical-align: inherit;">يتم إنهاءها يدويًا ، وأحيانًا تلجأ إلى Google للمساعدة. </font><font style="vertical-align: inherit;">
ولكن حتى التحكم اليدوي لا يحل المشكلة بالكامل. </font><font style="vertical-align: inherit;">لا تزال هناك 49 قيمة من المستحيل بالفعل تفسيرها. </font><font style="vertical-align: inherit;">ربما تكون معظم هذه القيم مجرد أخطاء في البيانات.</font></font><br>
<code>{'BGI': 'BRB', 'WAL': 'GBR', 'MLD': 'MDA', 'KZK': 'KAZ', 'CZK': 'CZE', 'BNN': 'BEN', 'SNG': 'SGP', 'VTN': 'VNM', 'THI': 'THA', 'PRG': 'PRT', 'MOL': 'MDA', 'FRE': 'FRA', 'F.I.TRI.': 'ITA', 'BAHREIN': 'BHR', 'SUECIA': 'SWE', 'REPUBLICA CHECA': 'CZE', 'BRASIL': 'BRA', 'NDL': 'NLD', 'Danish (Dane)': 'DNK', 'Welsh': 'GBR', 'Austrian': 'AUT', 'Argentinean': 'ARG', 'South African': 'ZAF', 'ESTADOS UNIDOS': 'USA', 'LUXEMBURGO': 'LUX', 'SUDAFRICA': 'ZAF', 'NUEVA ZELANDA': 'NZL', 'RUMANIA': 'ROU', 'sco': 'GBR', 'SCO': 'GBR', 'WLS': 'GBR', '': 'IND', '': 'IRL', '': 'ARM', '': 'BGR', '': 'SRB', ' ': 'BLR', '': 'GBR', '': 'FRA', '': 'HND', '-': 'CRI', '': 'AZE', 'Korea': 'KOR', 'NewCaledonia': 'FRA', 'Czech Republic': 'CZE', 'Slovak republic': 'SVK', 'Channel Islands': 'FRA', 'Reunion': 'FRA', 'Wales': 'GBR', 'Scotland': 'GBR', 'Bavaria': 'DEU', 'Tirol"': 'AUT', '': 'KGZ', '': 'BLR', '': 'BLR', '': 'BLR', '': 'RUS', '': 'BLR', '': 'RUS'}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">unfixed = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> tofix <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix.keys()]
</code></pre><br>
<code><b>Out:</b> ['', 'H', 'ES-CT', 'LAB', 'TCH', 'UT', 'TAH', 'ica', 'E', 'Unknown', 'R', 'A', '31/3, Colin', 'XKX', 'ES-IB','B','SOG','?????','KINO MANA','sue','SAR','D', 'DCF', 'N', 'EU', 'Mark', 'I', 'Joe', 'RUN', 'GUT', 'L', 'J', 'BAS', 'S', 'STEEL T BG', 'LZE', 'F', 'Sandy', 'DO2', 'sandy', 'SOO', 'LTV', 'selsmark, Alise', 'Suchy, Jorg' 'Eddie', 'FL', 'P', 'ITU', 'ZZ']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ستحتوي هذه المفاتيح على سلسلة فارغة في القاموس المطابق.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> unfixed:<font></font>
    fix[cc] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أخيرًا ، نضيف إلى رموز القاموس المتطابقة الصالحة ولكنها مكتوبة بأحرف صغيرة.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> valid_a3:
    <span class="hljs-keyword">if</span> cc.upper() != cc:<font></font>
        fix[cc] = cc.upper()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حان الوقت الآن لتطبيق البدائل الموجودة. </font><font style="vertical-align: inherit;">لحفظ البيانات الأولية لمزيد من المقارنة، نسخ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">البلاد</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> العمود </font><font style="vertical-align: inherit;">إلى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خام البلاد</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ثم ، باستخدام القاموس المطابق الذي تم إنشاؤه ، نقوم بتصحيح </font><font style="vertical-align: inherit;">القيم </font><font style="vertical-align: inherit;">في عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">البلد</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> التي لا تتوافق مع ISO.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> cc <span class="hljs-keyword">in</span> fix:<font></font>
    ind = ar[ar[<span class="hljs-string">'country'</span>] == cc].index<font></font>
    ar.loc[ind,<span class="hljs-string">'country'</span>] = fix[cc]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هنا ، بالطبع ، لا يمكن للمرء الاستغناء عن الرسم البياني ، الجدول يحتوي على مليون ونصف صف تقريبًا. </font><font style="vertical-align: inherit;">ولكن حسب القاموس نقوم بدورة ، ولكن كيف؟ </font><font style="vertical-align: inherit;">تحقق من عدد السجلات التي تم تغييرها:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 315955<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أي أكثر من 20٪ من الإجمالي. </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'country'</span>] != ar[<span class="hljs-string">'country raw'</span>]].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th><u>country raw</u></th>
</tr>
<tr>
<td>285</td>
<td>286</td>
<td>M</td>
<td>Albaek, Mads Orla</td>
<td><u>DNK</u></td>
<td>M30-34</td>
<td>63</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>1288</td>
<td>1289</td>
<td>M</td>
<td>Benthien, Andreas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>198</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>490</td>
<td>491</td>
<td>M</td>
<td>Lontok, Joselito</td>
<td><u>PHL</u></td>
<td>M50-54</td>
<td>18</td>
<td>...</td>
<td><u>PHI</u></td>
</tr>
<tr>
<td>145</td>
<td>146</td>
<td>M</td>
<td>Mathiasen, Keld</td>
<td><u>DNK</u></td>
<td>M45-49</td>
<td>16</td>
<td>...</td>
<td><u>DEN</u></td>
</tr>
<tr>
<td>445</td>
<td>446</td>
<td>M</td>
<td>Palm, Francois</td>
<td><u>ZAF</u></td>
<td>M25-29</td>
<td>48</td>
<td>...</td>
<td><u>RSA</u></td>
</tr>
<tr>
<td>152</td>
<td>153</td>
<td>M</td>
<td>Muller, Johannes</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>19</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>764</td>
<td>765</td>
<td>F</td>
<td>Woscher Sylvia</td>
<td><u>DEU</u></td>
<td>F55-59</td>
<td>8</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>2182</td>
<td>2183</td>
<td>M</td>
<td>Kojellis, Holger</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>258</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>1293</td>
<td>1294</td>
<td>M</td>
<td>Zweer, Waldemar</td>
<td><u>DEU</u></td>
<td>M25-29</td>
<td>117</td>
<td>...</td>
<td><u>GER</u></td>
</tr>
<tr>
<td>747</td>
<td>748</td>
<td>M</td>
<td>Petersen, Mathias</td>
<td><u>DNK</u></td>
<td>M25-29</td>
<td>79</td>
<td>...</td>
<td><u>DE</u></td>
</tr>
</tbody></table></div></code><br>
<pre><code class="python hljs">len(ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 3221<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا هو عدد السجلات بدون دولة أو مع دولة غير رسمية. </font><font style="vertical-align: inherit;">انخفض عدد البلدان الفريدة من 412 إلى 250. ها هي: </font><font style="vertical-align: inherit;">
الآن لا توجد انحرافات. </font><i><font style="vertical-align: inherit;">نحفظ</font></i><font style="vertical-align: inherit;"> النتيجة في ملف </font><i><font style="vertical-align: inherit;">details2.pkl</font></i><font style="vertical-align: inherit;"> جديد </font><font style="vertical-align: inherit;">، بعد تحويل إطار البيانات المدمج مرة أخرى إلى قاموس لإطارات البيانات ، كما حدث سابقًا.</font></font><br>
<code>['', 'ABW', 'AFG', 'AGO', 'AIA', 'ALA', 'ALB', 'AND', 'ANT', 'ARE', 'ARG', 'ARM', 'ASM', 'ATA', 'ATF', 'AUS', 'AUT', 'AZE', 'BDI', 'BEL', 'BEN', 'BES', 'BGD', 'BGR', 'BHR', 'BHS', 'BIH', 'BLM', 'BLR', 'BLZ', 'BMU', 'BOL', 'BRA', 'BRB', 'BRN', 'BTN', 'BUR', 'BVT', 'BWA', 'CAF', 'CAN', 'CCK', 'CHE', 'CHL', 'CHN', 'CIV', 'CMR', 'COD', 'COG', 'COK', 'COL', 'COM', 'CPV', 'CRI', 'CTE', 'CUB', 'CUW', 'CXR', 'CYM', 'CYP', 'CZE', 'DEU', 'DJI', 'DMA', 'DNK', 'DOM', 'DZA', 'ECU', 'EGY', 'ERI', 'ESH', 'ESP', 'EST', 'ETH', 'FIN', 'FJI', 'FLK', 'FRA', 'FRO', 'FSM', 'GAB', 'GBR', 'GEO', 'GGY', 'GHA', 'GIB', 'GIN', 'GLP', 'GMB', 'GNB', 'GNQ', 'GRC', 'GRD', 'GRL', 'GTM', 'GUF', 'GUM', 'GUY', 'HKG', 'HMD', 'HND', 'HRV', 'HTI', 'HUN', 'IDN', 'IMN', 'IND', 'IOT', 'IRL', 'IRN', 'IRQ', 'ISL', 'ISR', 'ITA', 'JAM', 'JEY', 'JOR', 'JPN', 'KAZ', 'KEN', 'KGZ', 'KHM', 'KIR', 'KNA', 'KOR', 'KWT', 'LAO', 'LBN', 'LBR', 'LBY', 'LCA', 'LIE', 'LKA', 'LTU', 'LUX', 'LVA', 'MAC', 'MAF', 'MAR', 'MCO', 'MDA', 'MDG', 'MDV', 'MEX', 'MHL', 'MKD', 'MLI', 'MLT', 'MMR', 'MNE', 'MNG', 'MNP', 'MOZ', 'MSR', 'MTQ', 'MUS', 'MYS', 'MYT', 'NAM', 'NCL', 'NER', 'NFK', 'NGA', 'NHB', 'NIC', 'NIU', 'NLD', 'NOR', 'NPL', 'NRU', 'NZL', 'OMN', 'PAK', 'PAN', 'PCN', 'PER', 'PHL', 'PLW', 'PNG', 'POL', 'PRI', 'PRK', 'PRT', 'PRY', 'PSE', 'PYF', 'QAT', 'REU', 'ROU', 'RUS', 'RWA', 'SAU', 'SCG', 'SDN', 'SEN', 'SGP', 'SGS', 'SHN', 'SJM', 'SLB', 'SLE', 'SLV', 'SMR', 'SOM', 'SPM', 'SRB', 'SSD', 'SUR', 'SVK', 'SVN', 'SWE', 'SWZ', 'SXM', 'SYC', 'SYR', 'TCA', 'TCD', 'TGO', 'THA', 'TJK', 'TKL', 'TKM', 'TLS', 'TON', 'TTO', 'TUN', 'TUR', 'TUV', 'TWN', 'TZA', 'UGA', 'UKR', 'UMI', 'URY', 'USA', 'UZB', 'VAT', 'VCT', 'VEN', 'VGB', 'VIR', 'VNM', 'VUT', 'WLF', 'WSM', 'YEM', 'YUG', 'ZAF', 'ZMB', 'ZWE']<br>
</code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">موقعك</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تذكر الآن أن ذكر البلدان موجود أيضًا في الجدول المحوري في العمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">كما أنه يحتاج إلى تقديم نظرة قياسية. فيما يلي قصة مختلفة قليلاً: لا يمكن رؤية رموز ISO أو الأولمبية. يتم وصف كل شيء في شكل حر إلى حد ما. يتم سرد المدينة والبلد والمكونات الأخرى للعنوان باستخدام فاصلة ، وترتيب عشوائي. في مكان ما في المقام الأول ، في مكان ما في الأخير. لن يساعد pycountry هنا. وهناك الكثير من السجلات - لسباق 1922 525 موقعًا فريدًا (في شكله الأصلي). </font><font style="vertical-align: inherit;">
ولكن هنا تم العثور على أداة مناسبة. هذا هو </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">geopy</font></a><font style="vertical-align: inherit;"> ، وهي </font><i><font style="vertical-align: inherit;">geolocator Nominatim</font></i><font style="vertical-align: inherit;"> . يعمل مثل هذا:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th><u>loc</u></th>
<th>males</th>
<th>females</th>
<th>rus</th>
<th>total</th>
<th>link</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>835</td>
<td>215</td>
<td>65</td>
<td>1050</td>
<td>…</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td><u>Dubai, United Arab Emirates</u></td>
<td>638</td>
<td>132</td>
<td>55</td>
<td>770</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td><u>Israel, Eilat</u></td>
<td>670</td>
<td>126</td>
<td>4</td>
<td>796</td>
<td>…</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td><u>Indian Wells/La Quinta, California, USA</u></td>
<td>1590</td>
<td>593</td>
<td>6</td>
<td>2183</td>
<td>…</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td><u>New Zealand</u></td>
<td>767</td>
<td>420</td>
<td>3</td>
<td>1187</td>
<td>…</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td><u>Manama, Bahrain</u></td>
<td>858</td>
<td>214</td>
<td>38</td>
<td>1072</td>
<td>…</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td><u>Busselton, Western Australia</u></td>
<td>940</td>
<td>229</td>
<td>1</td>
<td>1169</td>
<td>…</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td><u>Mar del Plata, Argentina</u></td>
<td>506</td>
<td>66</td>
<td>3</td>
<td>572</td>
<td>…</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td><u>Cozumel, Mexico</u></td>
<td>1158</td>
<td>395</td>
<td>12</td>
<td>1553</td>
<td>…</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td><u>Tempe, Arizona, USA</u></td>
<td>1697</td>
<td>633</td>
<td>3</td>
<td>2330</td>
<td>…</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> geopy.geocoders <span class="hljs-keyword">import</span> Nominatim<font></font>
<font></font>
geolocator = Nominatim(user_agent=<span class="hljs-string">'triathlon results researcher'</span>)<font></font>
geolocator.geocode(<span class="hljs-string">' , , '</span>, language=<span class="hljs-string">'en'</span>)
</code></pre><br>
<code><b>Out:</b> Location( ,  –  ,  , Altaysky District, Altai Krai, Siberian Federal District, Russia, (51.78897945, 85.73956296106752, 0.0))<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عند الطلب ، في شكل عشوائي ، يعطي إجابة منظمة - العنوان والإحداثيات. إذا قمت بتعيين اللغة ، كما هو الحال هنا - الإنجليزية ، فإن ما يمكنها - ستترجم. بادئ ذي بدء ، نحتاج إلى الاسم القياسي للدولة للترجمة اللاحقة إلى رمز ISO. يأخذ فقط المكان الأخير في خاصية </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العنوان</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . نظرًا لأن </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الموقع الجغرافي</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يرسل طلبًا إلى الخادم في كل مرة ، فإن هذه العملية ليست سريعة وتستغرق 500 دقيقة لـ 500 سجل. علاوة على ذلك ، يحدث أن الجواب لا يأتي. في هذه الحالة ، يساعد الطلب الثاني أحيانًا. في ردي الأول لم يصل إلى 130 طلبًا. تم معالجة معظمها بمحاولتين. ومع ذلك ، لم تتم معالجة 34 اسمًا حتى من خلال عدة محاولات أخرى. ها هم:</font></font><br>
<code>['Tongyeong, Korea, Korea, South', 'Constanta, Mamaia, Romania, Romania', 'Weihai, China, China', '. ,  .', 'Odaiba Marin Park, Tokyo, Japan, Japan', 'Sweden, Smaland, Kalmar', 'Cholpon-Ata city, Resort Center "Kapriz", Kyrgyzstan', 'Luxembourg, Region Moselle, Moselle', 'Chita Peninsula, Japan', 'Kraichgau Region, Germany', 'Jintang, Chengdu, Sichuan Province, China, China', 'Madrid, Spain, Spain', 'North American Pro Championship, St. George, Utah, USA', 'Milan Idroscalo Linate, Italy', 'Dexing, Jiangxi Province, China, China', 'Mooloolaba, Australia, Australia', 'Nathan Benderson Park (NBP), 5851 Nathan Benderson Circle, Sarasota, FL 34235., United States', 'Strathclyde Country Park, North Lanarkshire, Glasgow, Great Britain', 'Quijing, China', 'United States of America , Hawaii, Kohala Coast', 'Buffalo City, East London, South Africa', 'Spain, Vall de Cardener', ', .    ', 'Asian TriClub Championship, Hefei, China', 'Taizhou, Jiangsu Province, China, China', ', ,  «»', 'Buffalo, Gallagher Beach, Furhmann Blvd, United States', 'North American Pro Championship | St. George, Utah, USA', 'Weihai, Shandong, China, China', 'Tarzo - Revine Lago, Italy', 'Lausanee, Switzerland', 'Queenstown, New Zealand, New Zealand', 'Makuhari, Japan, Japan', 'Szombathlely, Hungary']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن ملاحظة أنه في كثير من البلدان هناك ذكر مزدوج للبلد ، وهذا يتدخل في الواقع. </font><font style="vertical-align: inherit;">بشكل عام ، كان علي معالجة هذه الأسماء المتبقية وتم الحصول على العناوين القياسية للجميع. </font><font style="vertical-align: inherit;">علاوة على ذلك ، من هذه العناوين ، اخترت دولة وكتبت هذه الدولة في عمود جديد في الجدول المحوري. </font><font style="vertical-align: inherit;">نظرًا لأن ، كما قلت ، فإن العمل مع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ليس سريعًا ، فقد قررت على الفور حفظ إحداثيات الموقع - خط العرض وخط الطول. </font><font style="vertical-align: inherit;">سيكونون في متناول اليد لاحقًا للتصور على الخريطة. </font><font style="vertical-align: inherit;">بعد ذلك ، باستخدام </font><i><font style="vertical-align: inherit;">pyco.countries.get (name = '...') ،</font></i><font style="vertical-align: inherit;"> بحث </font><i><font style="vertical-align: inherit;">Alpha_3</font></i><font style="vertical-align: inherit;"> عن البلد بالاسم وخصص رمزًا مكونًا من ثلاثة أرقام.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>United Arab Emirates</u></td>
<td><u>25.0657</u></td>
<td><u>55.1713</u></td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>Israel</u></td>
<td><u>29.5569</u></td>
<td><u>34.9498</u></td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>United States of America</u></td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>New Zealand</u></td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>Bahrain</u></td>
<td><u>26.2235</u></td>
<td><u>50.5822</u></td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>Australia</u></td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>Argentina</u></td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>Mexico</u></td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>United States of America</u></td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>China</u></td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>loc</th>
<th><u>country</u></th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Dubai Duathlon 70.3 2020</td>
<td>2020-07-02</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Dubai 70.3 2020</td>
<td>2020-02-07</td>
<td>Dubai, United Arab Emirates</td>
<td><u>ARE</u></td>
<td>25.0657</td>
<td>55.1713</td>
<td>...</td>
</tr>
<tr>
<td>2</td>
<td>Israman Half 2020</td>
<td>2020-01-29</td>
<td>Israel, Eilat</td>
<td><u>ISR</u></td>
<td>29.5569</td>
<td>34.9498</td>
<td>...</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>Indian Wells/La Quinta, California, USA</td>
<td><u>USA</u></td>
<td>33.7238</td>
<td>-116.305</td>
<td>...</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>New Zealand</td>
<td><u>NZL</u></td>
<td>-41.5001</td>
<td>172.834</td>
<td>...</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Bahrain 70.3 2019</td>
<td>2019-12-07</td>
<td>Manama, Bahrain</td>
<td><u>BHR</u></td>
<td>26.2235</td>
<td>50.5822</td>
<td>...</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>Busselton, Western Australia</td>
<td><u>AUS</u></td>
<td>-33.6445</td>
<td>115.349</td>
<td>...</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>Mar del Plata, Argentina</td>
<td><u>ARG</u></td>
<td>-37.9977</td>
<td>-57.5483</td>
<td>...</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>Cozumel, Mexico</td>
<td><u>MEX</u></td>
<td>20.4318</td>
<td>-86.9203</td>
<td>...</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>Tempe, Arizona, USA</td>
<td><u>USA</u></td>
<td>33.4255</td>
<td>-111.94</td>
<td>...</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>Xiamen, China</td>
<td><u>CHN</u></td>
<td>24.4758</td>
<td>118.075</td>
<td>...</td>
</tr>
</tbody></table></div></code><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مسافة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إجراء آخر مهم يجب القيام به على الطاولة المحورية هو تحديد المسافة لكل سباق. هذا مفيد لنا لحساب السرعات في المستقبل. في الترياتلون ، هناك أربع مسافات رئيسية - العدو ، والأوليمبية ، وشبه الحديد والحديد. يمكنك أن ترى أنه في أسماء السباقات عادة ما يكون هناك مؤشر على المسافة - هذه هي </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprint</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olympic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Half</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Full</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Words </font><font style="vertical-align: inherit;">. بالإضافة إلى ذلك ، لدى المنظمين المختلفين تعييناتهم الخاصة للمسافات. نصف الرجل الحديدي ، على سبيل المثال ، تم تعيينه على أنه </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">70.3</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - من خلال عدد الأميال في المسافة ، والأوليمبية - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5150</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بعدد الكيلومترات (51.5) ، ويمكن تعيين الحديد على أنه </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كامل</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أو بشكل عام ، لعدم وجود تفسير - على سبيل المثال ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ironman Arizona 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">الرجل الحديدي - إنه حديد! </font><font style="vertical-align: inherit;">في التحدي ، يتم تعيين المسافة الحديدية على أنها </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">طويلة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font><font style="vertical-align: inherit;">والمسافة </font><font style="vertical-align: inherit;">شبه </font><font style="vertical-align: inherit;">الحديدية على </font><font style="vertical-align: inherit;">أنها </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">متوسطة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">لدينا IronStar الروسي يعني كامل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ونصف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - من خلال عدد الكيلومترات ، ولكن عادة ما تكون الكلمات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Full</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Half موجودة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أيضًا. </font><font style="vertical-align: inherit;">الآن قم بتطبيق كل هذه المعرفة وقم بتمييز جميع السباقات وفقًا للكلمات الرئيسية الموجودة في الأسماء.</font></font><br>
<br>
<pre><code class="python hljs">sprints = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'sprint'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics1 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'olympic'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics2 = rs.loc[[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index <span class="hljs-keyword">if</span> <span class="hljs-string">'5150'</span> <span class="hljs-keyword">in</span> rs.loc[i, <span class="hljs-string">'event'</span>].lower()]]<font></font>
olympics = pd.concat([olympics1, olympics2])<font></font>
<span class="hljs-comment">#…   </span><font></font>
<font></font>
rsd = pd.concat([sprints, olympics, halfs, fulls]) <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rsd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، تبين أنه تم تسجيل 1 925 سجلًا ، أي ثلاثة أكثر من إجمالي عدد السباقات ، لذلك سقط بعضها تحت معيارين. </font><font style="vertical-align: inherit;">دعونا نلقي نظرة عليها:</font></font><br>
<br>
<pre><code class="python hljs">rsd[rsd.duplicated(keep=<span class="hljs-literal">False</span>)][<span class="hljs-string">'event'</span>].sort_index()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th><u>event</u></th>
<th>date</th>
<th>loc</th>
<th>country</th>
<th>latitude</th>
<th>longitude</th>
<th>...</th>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>38</td>
<td><u>Temiradam 113 Half 2019</u></td>
<td>2019-09-22</td>
<td>, </td>
<td>KAZ</td>
<td>43.6521</td>
<td>51.158</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>65</td>
<td><u>Triway Olympic Sprint 2019</u></td>
<td>2019-09-08</td>
<td>, --</td>
<td>RUS</td>
<td>47.2214</td>
<td>39.7114</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
<tr>
<td>82</td>
<td><u>Ironman Dun Laoghaire Full Swim 70.3 2019</u></td>
<td>2019-08-25</td>
<td>Ireland, Dun Laoghaire</td>
<td>IRL</td>
<td>53.2923</td>
<td>-6.13601</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالتاكيد هو. </font><font style="vertical-align: inherit;">في الزوج الأول باسم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temiradam 113 Half 2019 ،</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هناك ذكر </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">للنصف</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">113</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">لكن هذا ليس تناقضًا ، فقد تم تحديدهما على أنه نصفين. </font><font style="vertical-align: inherit;">التالي هو </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Triway Olympic Sprint 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يمكنك الحصول على حقا الخلط هنا - هناك </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاولمبية</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سبرينت</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يمكنك معرفة ذلك من خلال النظر إلى البروتوكول مع نتائج السباق. </font><font style="vertical-align: inherit;">أفضل وقت هو 1:09. </font><font style="vertical-align: inherit;">لذلك هذا هو العدو. </font><font style="vertical-align: inherit;">حذف هذا الإدخال من القائمة الأولمبية.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>1</td>
<td>00:12:21</td>
<td>00:00:31</td>
<td>00:34:13</td>
<td>00:00:25</td>
<td>00:21:49</td>
<td><u>01:09:19</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>2</td>
<td>00:12:21</td>
<td>00:00:28</td>
<td>00:34:15</td>
<td>00:00:26</td>
<td>00:23:07</td>
<td><u>01:10:38</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td> </td>
<td>RUS</td>
<td>M</td>
<td>3</td>
<td>00:14:20</td>
<td>00:00:37</td>
<td>00:35:48</td>
<td>00:00:34</td>
<td>00:22:16</td>
<td><u>01:13:35</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">olympics.drop(<span class="hljs-number">65</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
سنفعل نفس الشيء مع تقاطع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ironman Dun Laoghaire Full Swim 70.3 2019</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إليك أفضل وقت 4:00. </font><font style="vertical-align: inherit;">هذا نموذجي للنصف. </font><font style="vertical-align: inherit;">حذف السجل مع فهرس 85 من </font><i><font style="vertical-align: inherit;">الامتلاء</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>swim</th>
<th>t1</th>
<th>bike</th>
<th>t2</th>
<th>run</th>
<th><u>result</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Brownlee, Alistair</td>
<td>GBR</td>
<td>MPRO</td>
<td>1</td>
<td>00:23:19</td>
<td>00:02:18</td>
<td>02:21:19</td>
<td>00:01:55</td>
<td>01:11:42</td>
<td><u>04:00:33</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Smales, Elliot</td>
<td>GBR</td>
<td>MPRO</td>
<td>2</td>
<td>00:24:47</td>
<td>00:02:09</td>
<td>02:29:26</td>
<td>00:01:48</td>
<td>01:12:47</td>
<td><u>04:10:57</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Bowden, Adam</td>
<td>GBR</td>
<td>MPRO</td>
<td>3</td>
<td>00:23:24</td>
<td>00:02:18</td>
<td>02:32:09</td>
<td>00:02:06</td>
<td>01:13:49</td>
<td><u>04:13:46</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fulls.drop(<span class="hljs-number">85</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن سنكتب معلومات المسافة في إطار البيانات الرئيسي ونرى ما حدث:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'dist'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[sprints.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'sprint'</span>
rs.loc[olympics.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'olympic'</span>
rs.loc[halfs.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'half'</span>
rs.loc[fulls.index,<span class="hljs-string">'dist'</span>] = <span class="hljs-string">'full'</span><font></font>
<font></font>
rs.sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تحقق من عدم وجود إدخالات غير مغطاة:</font></font><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">''</span>])
</code></pre><br>
<code><b>Out:</b> 0<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وتحقق من مشاكلنا الغامضة:</font></font><br>
<br>
<pre><code class="python hljs">rs.loc[[<span class="hljs-number">38</span>,<span class="hljs-number">65</span>,<span class="hljs-number">82</span>],[<span class="hljs-string">'event'</span>,<span class="hljs-string">'dist'</span>]]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th><u>dist</u></th>
</tr>
<tr>
<td>38</td>
<td>Temiradam 113 Half 2019</td>
<td><u>half</u></td>
</tr>
<tr>
<td>65</td>
<td>Triway Olympic Sprint 2019</td>
<td><u>sprint</u></td>
</tr>
<tr>
<td>82</td>
<td>Ironman Dun Laoghaire Full Swim 70.3 2019</td>
<td><u>half</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كل شيء على ما يرام. </font><font style="vertical-align: inherit;">حفظ في ملف جديد:</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الفئات العمرية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن نعود إلى بروتوكولات السباق. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد قمنا بالفعل بتحليل جنس المشاركين وبلدهم ونتائجهم ، وأدخلناهم إلى نموذج قياسي. </font><font style="vertical-align: inherit;">لكن بقي عمودين آخرين - المجموعة ، وفي الواقع ، الاسم نفسه. </font><font style="vertical-align: inherit;">لنبدأ بالمجموعات. </font><font style="vertical-align: inherit;">في الترياتلون ، من المعتاد تقسيم المشاركين حسب الفئات العمرية. </font><font style="vertical-align: inherit;">غالباً ما تبرز مجموعة من المحترفين. </font><font style="vertical-align: inherit;">في الواقع ، تكون الإزاحة في كل مجموعة على حدة - يتم منح الأماكن الثلاثة الأولى في كل مجموعة. </font><font style="vertical-align: inherit;">في المجموعات ، يتم اختيار التأهيل للبطولات ، على سبيل المثال ، على Konu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قم بدمج جميع السجلات ومعرفة المجموعات الموجودة بشكل عام.</font></font><br>
<br>
<pre><code class="python hljs">rd = pkl.load(open(<span class="hljs-string">r'D:\tri\details2.pkl'</span>, <span class="hljs-string">'rb'</span>))<font></font>
ar = pd.concat(rd)<font></font>
ar[<span class="hljs-string">'group'</span>].unique()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح أن هناك عددًا هائلاً من المجموعات - 581. تبدو مائة مختارة عشوائيًا </font><font style="vertical-align: inherit;">
على النحو التالي: لنرى أيها أكثر عددًا:</font></font><br>
<code>['MSenior', 'FAmat.', 'M20', 'M65-59', 'F25-29', 'F18-22', 'M75-59', 'MPro', 'F24', 'MCORP M', 'F21-30', 'MSenior 4', 'M40-50', 'FAWAD', 'M16-29', 'MK40-49', 'F65-70', 'F65-70', 'M12-15', 'MK18-29', 'M50up', 'FSEMIFINAL 2 PRO', 'F16', 'MWhite', 'MOpen 25-29', 'F', 'MPT TRI-2', 'M16-24', 'FQUALIFIER 1 PRO', 'F15-17', 'FSEMIFINAL 2 JUNIOR', 'FOpen 60-64', 'M75-80', 'F60-69', 'FJUNIOR A', 'F17-18', 'FAWAD BLIND', 'M75-79', 'M18-29', 'MJUN19-23', 'M60-up', 'M70', 'MPTS5', 'F35-40', "M'S PT1", 'M50-54', 'F65-69', 'F17-20', 'MP4', 'M16-29', 'F18up', 'MJU', 'MPT4', 'MPT TRI-3', 'MU24-39', 'MK35-39', 'F18-20', "M'S", 'F50-55', 'M75-80', 'MXTRI', 'F40-45', 'MJUNIOR B', 'F15', 'F18-19', 'M20-29', 'MAWAD PC4', 'M30-37', 'F21-30', 'Mpro', 'MSEMIFINAL 1 JUNIOR', 'M25-34', 'MAmat.', 'FAWAD PC5', 'FA', 'F50-60', 'FSenior 1', 'M80-84', 'FK45-49', 'F75-79', 'M&lt;23', 'MPTS3', 'M70-75', 'M50-60', 'FQUALIFIER 3 PRO', 'M9', 'F31-40', 'MJUN16-19', 'F18-19', 'M PARA', 'F35-44', 'MParaathlete', 'F18-34', 'FA', 'FAWAD PC2', 'FAll Ages', 'M PARA', 'F31-40', 'MM85', 'M25-39']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group'</span>].value_counts()[:<span class="hljs-number">30</span>]
</code></pre><br>
<code><b>Out:</b><br>
M40-44 199157<br>
M35-39 183738<br>
M45-49 166796<br>
M30-34 154732<br>
M50-54 107307<br>
M25-29 88980<br>
M55-59 50659<br>
F40-44 48036<br>
F35-39 47414<br>
F30-34 45838<br>
F45-49 39618<br>
MPRO 38445<br>
F25-29 31718<br>
F50-54 26253<br>
M18-24 24534<br>
FPRO 23810<br>
M60-64 20773<br>
M 12799<br>
F55-59 12470<br>
M65-69 8039<br>
F18-24 7772<br>
MJUNIOR 6605<br>
F60-64 5067<br>
M20-24 4580<br>
FJUNIOR 4105<br>
M30-39 3964<br>
M40-49 3319<br>
F 3306<br>
M70-74 3072<br>
F20-24 2522<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكنك أن ترى أن هذه المجموعات هي خمس سنوات ، بشكل منفصل للرجال وبشكل منفصل للنساء ، وكذلك المجموعات المهنية </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPRO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا سيكون معيارنا:</font></font><br>
<br>
<pre><code class="python hljs">ag = [<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M18-24'</span>, <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'M55-59'</span>, <span class="hljs-string">'M60-64'</span>,  <span class="hljs-string">'M65-69'</span>, <span class="hljs-string">'M70-74'</span>, <span class="hljs-string">'M75-79'</span>, <span class="hljs-string">'M80-84'</span>, <span class="hljs-string">'M85-90'</span>, <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'F18-24'</span>, <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44'</span>,   <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'F65-69'</span>, <span class="hljs-string">'F70-74'</span>, <span class="hljs-string">'F75-79'</span>, <span class="hljs-string">'F80-84'</span>, <span class="hljs-string">'F85-90'</span>]
<span class="hljs-comment">#ag – age group</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تغطي هذه المجموعة ما يقرب من 95٪ من جميع اللمسات النهائية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالطبع ، لن نتمكن من جلب جميع المجموعات إلى هذا المعيار. </font><font style="vertical-align: inherit;">لكننا نبحث عن تلك التي تشبههم ونعطي جزءًا على الأقل. </font><font style="vertical-align: inherit;">أولاً ، سنقوم بإحضار الأحرف الكبيرة وإزالة المسافات. </font><font style="vertical-align: inherit;">إليك ما حدث: قم </font><font style="vertical-align: inherit;">
بتحويلها إلى معاييرنا القياسية.</font></font><br>
<code>['F25-29F', 'F30-34F', 'F30-34-34', 'F35-39F', 'F40-44F', 'F45-49F', 'F50-54F', 'F55-59F', 'FAG:FPRO', 'FK30-34', 'FK35-39', 'FK40-44', 'FK45-49', 'FOPEN50-54', 'FOPEN60-64', 'MAG:MPRO', 'MK30-34', 'MK30-39', 'MK35-39', 'MK40-44', 'MK40-49', 'MK50-59', 'M40-44', 'MM85-89', 'MOPEN25-29', 'MOPEN30-34', 'MOPEN35-39', 'MOPEN40-44', 'MOPEN45-49', 'MOPEN50-54', 'MOPEN70-74', 'MPRO:', 'MPROM', 'M0-44"']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">fix = { <span class="hljs-string">'F25-29F'</span>: <span class="hljs-string">'F25-29'</span>, <span class="hljs-string">'F30-34F'</span> : <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F30-34-34'</span>: <span class="hljs-string">'F30-34'</span>, <span class="hljs-string">'F35-39F'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'F40-44F'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'F45-49F'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'F50-54F'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'F55-59F'</span>: <span class="hljs-string">'F55-59'</span>, <span class="hljs-string">'FAG:FPRO'</span>: <span class="hljs-string">'FPRO'</span>, <span class="hljs-string">'FK30-34'</span>: <span class="hljs-string">'F30-34'</span>,      <span class="hljs-string">'FK35-39'</span>: <span class="hljs-string">'F35-39'</span>, <span class="hljs-string">'FK40-44'</span>: <span class="hljs-string">'F40-44'</span>, <span class="hljs-string">'FK45-49'</span>: <span class="hljs-string">'F45-49'</span>, <span class="hljs-string">'FOPEN50-54'</span>: <span class="hljs-string">'F50-54'</span>, <span class="hljs-string">'FOPEN60-64'</span>: <span class="hljs-string">'F60-64'</span>, <span class="hljs-string">'MAG:MPRO'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MK30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MK30-39'</span>: <span class="hljs-string">'M30-39'</span>, <span class="hljs-string">'MK35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MK40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MK40-49'</span>: <span class="hljs-string">'M40-49'</span>, <span class="hljs-string">'MK50-59'</span>: <span class="hljs-string">'M50-59'</span>, <span class="hljs-string">'M40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MM85-89'</span>: <span class="hljs-string">'M85-89'</span>, <span class="hljs-string">'MOPEN25-29'</span>: <span class="hljs-string">'M25-29'</span>, <span class="hljs-string">'MOPEN30-34'</span>: <span class="hljs-string">'M30-34'</span>, <span class="hljs-string">'MOPEN35-39'</span>: <span class="hljs-string">'M35-39'</span>, <span class="hljs-string">'MOPEN40-44'</span>: <span class="hljs-string">'M40-44'</span>, <span class="hljs-string">'MOPEN45-49'</span>: <span class="hljs-string">'M45-49'</span>, <span class="hljs-string">'MOPEN50-54'</span>: <span class="hljs-string">'M50-54'</span>, <span class="hljs-string">'MOPEN70-74'</span>: <span class="hljs-string">'M70- 74'</span>, <span class="hljs-string">'MPRO:'</span> :<span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'MPROM'</span>: <span class="hljs-string">'MPRO'</span>, <span class="hljs-string">'M0-44"'</span> : <span class="hljs-string">'M40-44'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن نقوم بتطبيق تحويلنا على إطار البيانات الرئيسي </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ولكن أولاً نحفظ قيم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المجموعة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الأصلية </font><font style="vertical-align: inherit;">في العمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الخام</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الجديد </font><i><font style="vertical-align: inherit;">للمجموعة</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'group raw'</span>] = ar[<span class="hljs-string">'group'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المجموعة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font><font style="vertical-align: inherit;">نترك فقط تلك القيم التي تتوافق مع معاييرنا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن يمكننا أن نقدر جهودنا:</font></font><br>
<br>
<pre><code class="python hljs">len(ar[(ar[<span class="hljs-string">'group'</span>] != ar[<span class="hljs-string">'group raw'</span>])&amp;(ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)])
</code></pre><br>
<code><b>Out:</b> 273<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
فقط قليلا على مستوى مليون ونصف. </font><font style="vertical-align: inherit;">لكنك لن تعرف حتى تحاول. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الشكل 10 المحدد على </font><font style="vertical-align: inherit;">النحو التالي </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">احفظ الإصدار الجديد من إطار البيانات ، بعد تحويله مرة أخرى إلى القاموس </font><i><font style="vertical-align: inherit;">rd</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
</tr>
<tr>
<td>...</td>
<td>566</td>
<td>M</td>
<td>Vladimir Kozar</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>8</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>8</td>
<td>M</td>
<td>HANNES COOL</td>
<td>BEL</td>
<td><u>MPRO</u></td>
<td>11</td>
<td>...</td>
<td>BEL</td>
<td><u>MPRO M</u></td>
</tr>
<tr>
<td>...</td>
<td>445</td>
<td>F</td>
<td>Ileana Sodani</td>
<td>USA</td>
<td><u>F45-49</u></td>
<td>4</td>
<td>...</td>
<td>USA</td>
<td><u>F45-49 F</u></td>
</tr>
<tr>
<td>...</td>
<td>227</td>
<td>F</td>
<td>JARLINSKA Bozena</td>
<td>POL</td>
<td><u>F45-49</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK45-49</u></td>
</tr>
<tr>
<td>...</td>
<td>440</td>
<td>F</td>
<td>Celine Orrigoni</td>
<td>FRA</td>
<td><u>F40-44</u></td>
<td>6</td>
<td>...</td>
<td>FRA</td>
<td><u>F40-44 F</u></td>
</tr>
<tr>
<td>...</td>
<td>325</td>
<td>M</td>
<td>Vladimir Eckert</td>
<td>SVK</td>
<td><u>M40-44</u></td>
<td>6</td>
<td>...</td>
<td>SVK</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>139</td>
<td>F</td>
<td>ATRASZKIEWICZ Magda</td>
<td>POL</td>
<td><u>F40-44</u></td>
<td>2</td>
<td>...</td>
<td>POL</td>
<td><u>FK40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>18</td>
<td>M</td>
<td>Marijn de Jonge</td>
<td>NLD</td>
<td><u>MPRO</u></td>
<td>18</td>
<td>...</td>
<td>NED</td>
<td><u>Mpro</u></td>
</tr>
<tr>
<td>...</td>
<td>574</td>
<td>M</td>
<td>Luca Andalo</td>
<td>ITA</td>
<td><u>M40-44</u></td>
<td>9</td>
<td>...</td>
<td>ITA</td>
<td><u>MOpen 40-44</u></td>
</tr>
<tr>
<td>...</td>
<td>67</td>
<td>M</td>
<td>URBANKIEWICZ Aleksandra</td>
<td>POL</td>
<td><u>M35-39</u></td>
<td>1</td>
<td>...</td>
<td>POL</td>
<td><u>MK35-39</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details3.pkl'</span>, <span class="hljs-string">'wb'</span>))</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن دعنا نعتني بالأسماء. </font><font style="vertical-align: inherit;">دعونا نرى بشكل انتقائي 100 اسم من أعراق مختلفة:</font></font><br>
<br>
<pre><code class="python hljs">list(ar[<span class="hljs-string">'name'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out: </b>['Case, Christine', 'Van der westhuizen, Wouter', 'Grace, Scott', 'Sader, Markus', 'Schuller, Gunnar', 'Juul-Andersen, Jeppe', 'Nelson, Matthew', '  ', 'Westman, Pehr', 'Becker, Christoph', 'Bolton, Jarrad', 'Coto, Ricardo', 'Davies, Luke', 'Daniltchev, Alexandre', 'Escobar Labastida, Emmanuelle', 'Idzikowski, Jacek', 'Fairaislova Iveta', 'Fisher, Kulani', 'Didenko, Viktor', 'Osborne, Jane', 'Kadralinov, Zhalgas', 'Perkins, Chad', 'Caddell, Martha', 'Lynaire PARISH', 'Busing, Lynn', 'Nikitin, Evgeny', 'ANSON MONZON, ROBERTO', 'Kaub, Bernd', 'Bank, Morten', 'Kennedy, Ian', 'Kahl, Stephen', 'Vossough, Andreas', 'Gale, Karen', 'Mullally, Kristin', 'Alex FRASER', 'Dierkes, Manuela', 'Gillett, David', 'Green, Erica', 'Cunnew, Elliott', 'Sukk, Gaspar', 'Markina Veronika', 'Thomas KVARICS', 'Wu, Lewen', 'Van Enk, W.J.J', 'Escobar, Rosario', 'Healey, Pat', 'Scheef, Heike', 'Ancheta, Marlon', 'Heck, Andreas', 'Vargas Iii, Raul', 'Seferoglou, Maria', 'chris GUZMAN', 'Casey, Timothy', 'Olshanikov Konstantin', 'Rasmus Nerrand', 'Lehmann Bence', 'Amacker, Kirby', 'Parks, Chris', 'Tom, Troy', 'Karlsson, Ulf', 'Halfkann, Dorothee', 'Szabo, Gergely', 'Antipov Mikhail', 'Von Alvensleben, Alvo', 'Gruber, Peter', 'Leblanc, Jean-Philippe', 'Bouchard, Jean-Francois', 'Marchiotto MASSIMO', 'Green, Molly', 'Alder, Christoph', 'Morris, Huw', 'Deceur, Marc', 'Queenan, Derek', 'Krause, Carolin', 'Cockings, Antony', 'Ziehmer Chris', 'Stiene, John', 'Chmet Daniela', 'Chris RIORDAN', 'Wintle, Mel', ' ', 'GASPARINI CHRISTIAN', 'Westbrook, Christohper', 'Martens, Wim', 'Papson, Chris', 'Burdess, Shaun', 'Proctor, Shane', 'Cruzinha, Pedro', 'Hamard, Jacques', 'Petersen, Brett', 'Sahyoun, Sebastien', "O'Connell, Keith", 'Symoshenko, Zhan', 'Luternauer, Jan', 'Coronado, Basil', 'Smith, Alex', 'Dittberner, Felix', 'N?sman, Henrik', 'King, Malisa', 'PUHLMANN Andre']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
انها معقدة. هناك مجموعة متنوعة من الخيارات للإدخالات: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم الأول اسم العائلة ، الاسم الأخير الاسم الأول ، الاسم الأخير ، الاسم الأول ، الاسم الأخير ، الاسم الأول</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، إلخ. أي ترتيب مختلف ، تسجيل مختلف ، في مكان ما يوجد فاصل - فاصلة. هناك أيضًا العديد من البروتوكولات التي يذهب فيها السيريلية. لا يوجد أيضًا تجانس ، ويمكن العثور على هذه التنسيقات: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"اسم العائلة الاسم الأول" ، "الاسم الأول اسم العائلة" ، "الاسم الأول الاسم الأوسط الاسم الأخير" ، "الاسم الأخير الاسم الأول الاسم الأوسط"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. على الرغم من أنه في الواقع ، تم العثور على الاسم الأوسط أيضًا في الهجاء اللاتيني. وهنا ، بالمناسبة ، تنشأ مشكلة أخرى - الترجمة الصوتية. وتجدر الإشارة أيضًا إلى أنه حتى في حالة عدم وجود اسم وسط ، فقد لا يقتصر السجل على كلمتين. على سبيل المثال ، بالنسبة إلى اللاتينيين ، يتكون الاسم بالإضافة إلى اللقب عادة من ثلاث أو أربع كلمات. يمتلك الهولنديون البادئة فان والصينيون والكوريون لديهم أسماء مركبة تتكون عادة من ثلاث كلمات. بشكل عام ، تحتاج إلى الكشف عن هذا التوبيخ بالكامل وتوحيده إلى أقصى حد. كقاعدة عامة ، في تنسيق واحد ، يكون تنسيق الاسم هو نفسه للجميع ، ولكن حتى هنا توجد أخطاء لن نتعامل معها. لنبدأ بتخزين القيم الموجودة في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> العمود الجديد </font><i><font style="vertical-align: inherit;">الخام</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name raw'</span>] = ar[<span class="hljs-string">'name'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الغالبية العظمى من البروتوكولات مكتوبة باللاتينية ، لذا فإن أول شيء أود القيام به هو التحويل الصوتي. </font><font style="vertical-align: inherit;">دعونا نرى ما هي الأحرف التي يمكن تضمينها في اسم المشارك.</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out: </b>[' ', '!', '"', '#', '&amp;', "'", '(', ')', '*', '+', ',', '-', '.', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '?', '@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\', ']', '^', '_', '`', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '|', '\x7f', '\xa0', '¤', '¦', '§', '', '«', '\xad', '', '°', '±', 'µ', '¶', '·', '»', '', 'І', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'є', 'і', 'ў', '–', '—', '‘', '’', '‚', '“', '”', '„', '†', '‡', '…', '‰', '›', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ما هو موجود فقط! </font><font style="vertical-align: inherit;">بالإضافة إلى الأحرف والمسافات الفعلية ، لا تزال هناك مجموعة من الشخصيات الغريبة المختلفة. </font><font style="vertical-align: inherit;">من هذه ، يمكن اعتبار الفترة "." ، والواصلة "-" والفاصلة العليا "" صالحة ، وهذا غير موجود عن طريق الخطأ. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، لوحظ أنه في العديد من الأسماء والألقاب الألمانية والنرويجية توجد علامة استفهام "؟". </font><font style="vertical-align: inherit;">يبدو أنهم يستبدلون الحروف من الأبجدية اللاتينية الموسعة - "؟" ، "أ" ، "س" ، "ش" ،؟ </font><font style="vertical-align: inherit;">وغيرها: فيما يلي أمثلة: </font><font style="vertical-align: inherit;">
الفاصلة ، على الرغم من أنها تحدث في كثير من الأحيان ، هي مجرد فاصل تم اعتماده في أعراق معينة ، لذلك ستقع أيضًا في فئة غير مقبولة. </font><font style="vertical-align: inherit;">يجب ألا تظهر الأرقام في الأسماء أيضًا.</font></font><br>
<code>Pierre-Alexandre Petit, Jean-louis Lafontaine, Faris Al-Sultan, Jean-Francois Evrard, Paul O'Mahony, Aidan O'Farrell, John O'Neill, Nick D'Alton, Ward D'Hulster, Hans P.J. Cami, Luis E. Benavides, Maximo Jr. Rueda, Prof. Dr. Tim-Nicolas Korf, Dr. Boris Scharlowsk, Eberhard Gro?mann, Magdalena Wei?, Gro?er Axel, Meyer-Szary Krystian, Morten Halkj?r, RASMUSSEN S?ren Balle<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">bs = [s <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" . - ' ? ,"</span>)] <span class="hljs-comment">#bs – bad symbols</span><font></font>
<font></font>
bs<font></font>
</code></pre><br>
<code><b>Out: </b>['!', '"', '#', '&amp;', '(', ')', '*', '+', '/', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '&gt;', '@', '[', '\\', ']', '^', '_', '`', '|', '\x7f', '\xa0', '¤', '¦', '§', '', '«', '\xad', '', '°', '±', '¶', '·', '»', '–', '—', '‘', '’', '‚', '“', '”', '„', '†', '‡', '…', '‰', '›', '']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
سنقوم بإزالة جميع هذه الأحرف مؤقتًا لمعرفة عدد الإدخالات الموجودة:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> bs:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)<font></font>
<font></font>
corr = ar[ar[<span class="hljs-string">'name'</span>] != ar[<span class="hljs-string">'name raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك 2184 مثل هذه السجلات ، أي 0.15 ٪ فقط من العدد الإجمالي - قليل جدًا. </font><font style="vertical-align: inherit;">دعونا نلقي نظرة على 100 منهم:</font></font><br>
<br>
<pre><code class="python hljs">list(corr[<span class="hljs-string">'name raw'</span>].sample(<span class="hljs-number">100</span>))
</code></pre><br>
<code><b>Out:</b> ['Scha¶ffl, Ga?nter', 'Howard, Brian &amp;', 'Chapiewski, Guilherme (Gc)', 'Derkach 1svd_mail_ru', 'Parker H1 Lauren', 'Leal le?n, Yaneri', 'TencA, David', 'Cortas La?pez, Alejandro', 'Strid, Bja¶rn', '(Crutchfield) Horan, Katie', 'Vigneron, Jean-Michel.Vigneron@gmail.Com', '\xa0', 'Telahr, J†rgen', 'St”rmer, Melanie', 'Nagai B1 Keiji', 'Rinc?n, Mariano', 'Arkalaki, Angela (Evangelia)', 'Barbaro B1 Bonin Anna G:Charlotte', 'Ra?esch, Ja¶rg', "CAVAZZI NICCOLO\\'", 'D„nzel, Thomas', 'Ziska, Steffen (Gerhard)', 'Kobilica B1 Alen', 'Mittelholcz, Bala', 'Jimanez Aguilar, Juan Antonio', 'Achenza H1 Giovanni', 'Reppe H2 Christiane', 'Filipovic B2 Lazar', 'Machuca Ka?hnel, Ruban Alejandro', 'Gellert (Silberprinz), Christian', 'Smith (Guide), Matt', 'Lenatz H1 Benjamin', 'Da¶llinger, Christian', 'Mc Carthy B1 Patrick Donnacha G:Bryan', 'Fa¶llmer, Chris', 'Warner (Rivera), Lisa', 'Wang, Ruijia (Ray)', 'Mc Carthy B1 Donnacha', 'Jones, Nige (Paddy)', 'Sch”ler, Christoph', '\xa0', 'Holthaus, Adelhard (Allard)', 'Mi;Arro, Ana', 'Dr: Koch Stefan', '\xa0', '\xa0', 'Ziska, Steffen (Gerhard)', 'Albarraca\xadn Gonza?lez, Juan Francisco', 'Ha¶fling, Imke', 'Johnston, Eddie (Edwin)', 'Mulcahy, Bob (James)', 'Gottschalk, Bj”rn', '\xa0', 'Gretsch H2 Kendall', 'Scorse, Christopher (Chris)', 'Kiel‚basa, Pawel', 'Kalan, Magnus', 'Roderick "eric" SIMBULAN', 'Russell;, Mark', 'ROPES AND GRAY TEAM 3', 'Andrade, H?¦CTOR DANIEL', 'Landmann H2 Joshua', 'Reyes Rodra\xadguez, Aithami', 'Ziska, Steffen (Gerhard)', 'Ziska, Steffen (Gerhard)', 'Heuza, Pierre', 'Snyder B1 Riley Brad G:Colin', 'Feldmann, Ja¶rg', 'Beveridge H1 Nic', 'FAGES`, perrine', 'Frank", Dieter', 'Saarema¤el, Indrek', 'Betancort Morales, Arida–y', 'Ridderberg, Marie_Louise', '\xa0', 'Ka¶nig, Johannes', 'W Van(der Klugt', 'Ziska, Steffen (Gerhard)', 'Johnson, Nick26', 'Heinz JOHNER03', 'Ga¶rg, Andra', 'Maruo B2 Atsuko', 'Moral Pedrero H1 Eva Maria', '\xa0', 'MATUS SANTIAGO Osc1r', 'Stenbrink, Bja¶rn', 'Wangkhan, Sm1.Thaworn', 'Pullerits, Ta¶nu', 'Clausner, 8588294149', 'Castro Miranda, Josa Ignacio', 'La¶fgren, Pontuz', 'Brown, Jann ( Janine )', 'Ziska, Steffen (Gerhard)', 'Koay, Sa¶ren', 'Ba¶hm, Heiko', 'Oleksiuk B2 Vita', 'G Van(de Grift', 'Scha¶neborn, Guido', 'Mandez, A?lvaro', 'Garca\xada Fla?rez, Daniel']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ونتيجة لذلك ، بعد الكثير من البحث ، تقرر: استبدال جميع الأحرف الأبجدية ، بالإضافة إلى مسافة ، واصلة ، فاصلة عليا وعلامة استفهام ، بفاصلة ، نقطة ورمز \ xa0 ومسافات ، واستبدال جميع الأحرف الأخرى بسلسلة فارغة ، أي حذف فقط.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name raw'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> symbols:
    <span class="hljs-keyword">if</span> s.isalpha() <span class="hljs-keyword">or</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">" - ? '"</span>:        
        <span class="hljs-keyword">continue</span>        
    <span class="hljs-keyword">if</span> s <span class="hljs-keyword">in</span> <span class="hljs-string">".,\xa0"</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">' '</span>)       
    <span class="hljs-keyword">else</span>:<font></font>
        ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, <span class="hljs-string">''</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم تخلص من المساحات الإضافية:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str.join(<span class="hljs-string">' '</span>)<font></font>
ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.strip() <span class="hljs-comment">#   </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نرى ما حدث:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[corr.index].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>63</td>
<td>64</td>
<td>M</td>
<td><u>Curzillat B MARANO Annouck GJulie</u></td>
<td>FRA</td>
<td>...</td>
<td><u>Curzillat B1 MARANO Annouck G:Julie</u></td>
</tr>
<tr>
<td>425</td>
<td>426</td>
<td>M</td>
<td><u>Naranjo Quintero Cndido</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Naranjo Quintero, C‡ndido</u></td>
</tr>
<tr>
<td>1347</td>
<td>1348</td>
<td>F</td>
<td><u>Chang Margaret Peggy</u></td>
<td>USA</td>
<td>...</td>
<td><u>Chang, Margaret (Peggy)</u></td>
</tr>
<tr>
<td>790</td>
<td>791</td>
<td>M</td>
<td><u>Gonzalez Ruben</u></td>
<td>PRI</td>
<td>...</td>
<td><u>Gonzalez`, Ruben</u></td>
</tr>
<tr>
<td>1562</td>
<td>1563</td>
<td>M</td>
<td><u>Garcia Hernandez Elias</u></td>
<td>MEX</td>
<td>...</td>
<td><u>Garcia Hernandez/, Elias</u></td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Reppe H Christiane</u></td>
<td>DEU</td>
<td>...</td>
<td><u>Reppe H2 Christiane</u></td>
</tr>
<tr>
<td>528</td>
<td>529</td>
<td>M</td>
<td><u>Ho Shihken</u></td>
<td>TWN</td>
<td>...</td>
<td><u>Ho, Shih—ken</u></td>
</tr>
<tr>
<td>819</td>
<td>820</td>
<td>M</td>
<td><u>Elmously A R Abdelrahman</u></td>
<td>EGY</td>
<td>...</td>
<td><u>Elmously, A.R. (Abdelrahman)</u></td>
</tr>
<tr>
<td>249</td>
<td>250</td>
<td>F</td>
<td><u>boyer Isabelle</u></td>
<td>THA</td>
<td>...</td>
<td><u>`boyer, Isabelle</u></td>
</tr>
<tr>
<td>744</td>
<td>745</td>
<td>M</td>
<td><u>Garcaa Morales Pedro Luciano</u></td>
<td>ESP</td>
<td>...</td>
<td><u>Garca¬a Morales, Pedro Luciano</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ولوحظ أيضًا أن هناك أسماء تتكون بالكامل من علامات الاستفهام.</font></font><br>
<br>
<pre><code class="python hljs">qmon = ar[(ar[<span class="hljs-string">'name'</span>].str.replace(<span class="hljs-string">'?'</span>, <span class="hljs-string">''</span>).str.strip() == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>]!=<span class="hljs-string">''</span>)] <span class="hljs-comment">#qmon – question mark only names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 3429 منهم ، ويشبه ذلك: </font><font style="vertical-align: inherit;">هدفنا من جعل الأسماء على نفس المستوى هو جعل نفس الأسماء تبدو متشابهة ، ولكن مختلفة بطرق مختلفة. </font><font style="vertical-align: inherit;">في حالة الأسماء التي تتكون من علامات استفهام فقط ، فإنها تختلف فقط في عدد الأحرف ، ولكن هذا لا يعطي الثقة الكاملة في أن الأسماء التي تحمل نفس الرقم هي نفسها حقًا. </font><font style="vertical-align: inherit;">لذلك ، نستبدلهم جميعًا بسلسلة فارغة ولن يتم النظر فيها في المستقبل.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>place in group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>818</td>
<td>819</td>
<td>M</td>
<td><u>???? ???</u></td>
<td>JPN</td>
<td>M45-49</td>
<td>177</td>
<td>...</td>
<td>JPN</td>
<td>M45-49</td>
<td><u>????, ???</u></td>
</tr>
<tr>
<td>1101</td>
<td>1102</td>
<td>M</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>M50-54</td>
<td>159</td>
<td>...</td>
<td>JPN</td>
<td>M50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>162</td>
<td>163</td>
<td>M</td>
<td><u>? ??</u></td>
<td>CHN</td>
<td>M30-34</td>
<td>22</td>
<td>...</td>
<td>CHN</td>
<td>M30-34</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>1271</td>
<td>1272</td>
<td>F</td>
<td><u>???? ????</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>15</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>????, ????</u></td>
</tr>
<tr>
<td>552</td>
<td>553</td>
<td>M</td>
<td><u>??? ??</u></td>
<td>JPN</td>
<td>M25-29</td>
<td>30</td>
<td>...</td>
<td>JPN</td>
<td>M25-29</td>
<td><u>???, ??</u></td>
</tr>
<tr>
<td>423</td>
<td>424</td>
<td>M</td>
<td><u>??? ????</u></td>
<td>JPN</td>
<td>M55-59</td>
<td>24</td>
<td>...</td>
<td>JPN</td>
<td>M55-59</td>
<td><u>???, ????</u></td>
</tr>
<tr>
<td>936</td>
<td>937</td>
<td>F</td>
<td><u>?? ??</u></td>
<td>JPN</td>
<td>F50-54</td>
<td>7</td>
<td>...</td>
<td>JPN</td>
<td>F50-54</td>
<td><u>??, ??</u></td>
</tr>
<tr>
<td>244</td>
<td>245</td>
<td>M</td>
<td><u>? ??</u></td>
<td>KOR</td>
<td>M50-54</td>
<td>30</td>
<td>...</td>
<td>KOR</td>
<td>M50-54</td>
<td><u>?, ??</u></td>
</tr>
<tr>
<td>627</td>
<td>628</td>
<td>M</td>
<td><u>? ?</u></td>
<td>CHN</td>
<td>M40-44</td>
<td>94</td>
<td>...</td>
<td>CHN</td>
<td>M40-44</td>
<td><u>?, ?</u></td>
</tr>
<tr>
<td>194</td>
<td>195</td>
<td>M</td>
<td><u>?????? ?????</u></td>
<td>RUS</td>
<td></td>
<td>188</td>
<td>...</td>
<td>RUS</td>
<td>M</td>
<td><u>?????? ?????</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[qmon.index, <span class="hljs-string">'name'</span>] = <span class="hljs-string">''</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
العدد الإجمالي للإدخالات حيث يكون الاسم هو السلسلة الفارغة 3454. ليس كثيرًا - سننجو. </font><font style="vertical-align: inherit;">الآن بعد أن تخلصنا من الشخصيات غير الضرورية ، يمكننا المضي قدمًا في التحويل الصوتي. </font><font style="vertical-align: inherit;">للقيام بذلك ، قم أولاً بإحضار كل شيء إلى أحرف صغيرة حتى لا تقوم بعمل مزدوج.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.lower()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، قم بإنشاء قاموس:</font></font><br>
<br>
<pre><code class="python hljs">trans = {<span class="hljs-string">''</span>:<span class="hljs-string">'a'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'b'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'v'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'g'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'d'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'zh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'z'</span>,  <span class="hljs-string">''</span>:<span class="hljs-string">'i'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'k'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'l'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'m'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'n'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'o'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'p'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'r'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'s'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'t'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'u'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'f'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'kh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ts'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'sh'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'shch'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'y'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">''</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'yu'</span>, <span class="hljs-string">''</span>:<span class="hljs-string">'ya'</span>, <span class="hljs-string">'є'</span>:<span class="hljs-string">'e'</span>, <span class="hljs-string">'і'</span>: <span class="hljs-string">'i'</span>,<span class="hljs-string">'ў'</span>:<span class="hljs-string">'w'</span>,<span class="hljs-string">'µ'</span>:<span class="hljs-string">'m'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كما تضمن أيضًا رسائل من ما يسمى الأبجدية السيريلية الممتدة - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"є" و "і" و "ў"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، والتي تُستخدم باللغتين البيلاروسية والأوكرانية ، بالإضافة إلى الحرف اليوناني </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"µ"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">تطبيق التحول:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> trans:<font></font>
    ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.replace(s, trans[s])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، من الأحرف الصغيرة العاملة ، سنترجم كل شيء إلى التنسيق المألوف ، حيث يبدأ الاسم الأول والأخير بحرف كبير:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'name'</span>] = ar[<span class="hljs-string">'name'</span>].str.title()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نرى ما حدث.</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'name raw'</span>].str.lower().str[<span class="hljs-number">0</span>].isin(trans.keys())].sample(<span class="hljs-number">10</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>...</th>
<th>country raw</th>
<th>name raw</th>
</tr>
<tr>
<td>99</td>
<td>100</td>
<td>M</td>
<td><u>Nikolay Golovkin</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>95</td>
<td>96</td>
<td>M</td>
<td><u>Maksim Vasilevich Chubakov</u></td>
<td>...</td>
<td>RUS</td>
<td>  </td>
</tr>
<tr>
<td>325</td>
<td>326</td>
<td>F</td>
<td><u>Ganieva Aygul</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>661</td>
<td>662</td>
<td>M</td>
<td><u>Maksut Nizamutdinov</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>356</td>
<td>357</td>
<td>F</td>
<td><u>Kolobanova Svetlana</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>117</td>
<td>118</td>
<td>M</td>
<td><u>Guskov Vladislav</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>351</td>
<td>352</td>
<td>M</td>
<td><u>Kolesnikov Dmitriy</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>92</td>
<td>93</td>
<td>M</td>
<td><u>Kuznetsov Oleg</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>50</td>
<td>51</td>
<td>M</td>
<td><u>Khoraykin Maksim</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Brylev Aleksey</u></td>
<td>...</td>
<td>RUS</td>
<td> </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أخيرًا ، تحقق من الأحرف الفريدة:</font></font><br>
<br>
<pre><code class="python hljs">set( <span class="hljs-string">''</span>.join(ar[<span class="hljs-string">'name'</span>].unique()))
</code></pre><br>
<code><b>Out:</b> [' ', "'", '-', '?', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كله صحيح. </font><font style="vertical-align: inherit;">ونتيجة لذلك ، أثرت التصحيحات على 1،253،882 أو 89 ٪ من السجلات ، وانخفض عدد الأسماء الفريدة من 660،207 إلى 599،186 ، أي بنسبة 61 ألفًا أو ما يقرب من 10 ٪. </font><font style="vertical-align: inherit;">رائع! </font><font style="vertical-align: inherit;">حفظ إلى ملف جديد ، بعد ترجمة اتحاد سجلات ar مرة أخرى إلى قاموس بروتوكول </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details4.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن نحن بحاجة إلى استعادة النظام. أي أن جميع السجلات ستبدو - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم الأول اسم العائلة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أو </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم العائلة الاسم الأول</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . أيهما سيتم تحديده. صحيح ، بالإضافة إلى الاسم واللقب ، تحتوي بعض البروتوكولات أيضًا على الأسماء الوسطى. وقد يحدث أن يتم كتابة نفس الشخص بشكل مختلف في بروتوكولات مختلفة - في مكان ما باسم وسط ، في مكان ما بدون. سيتداخل ذلك مع هويته ، لذا حاول إزالة الاسم الأوسط. عادة ما يكون للرعاية الأبوية للرجال نهاية </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"hiv"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وبالنسبة للنساء - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . لكن هناك استثناءات. على سبيل المثال - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilyich ، Ilyinichna ، Nikitich ، Nikitichna</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. صحيح أن هناك استثناءات قليلة جدًا. كما ذكرنا سابقًا ، يمكن اعتبار تنسيق الأسماء في بروتوكول واحد دائمًا. لذلك ، للتخلص من علم الأبناء ، تحتاج إلى العثور على السباق الذي هم فيه. للقيام بذلك ، ابحث عن إجمالي عدد الأجزاء </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vich"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في </font><i><font style="vertical-align: inherit;">اسم</font></i><font style="vertical-align: inherit;"> العمود</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ومقارنتها بالعدد الإجمالي للإدخالات في كل بروتوكول. إذا كانت هذه الأرقام قريبة ، فهناك اسم الأوسط ، وإلا لا. من غير المعقول أن نبحث عن الامتثال الصارم ، حتى في السباقات حيث يتم تسجيل الأسماء الوسطى ، على سبيل المثال ، يمكن للأجانب المشاركة ، وسيتم تسجيلهم بدونه. يحدث أيضًا أن المشارك نسيت أو لم يرغب في الإشارة إلى اسمه الأوسط. من ناحية أخرى ، هناك أيضًا ألقاب تنتهي بـ "vich" ، وهناك الكثير منها في بيلاروسيا وبلدان أخرى بلغات المجموعة السلافية. بالإضافة إلى ذلك ، قمنا بعمل تحويل صوتي. كان من الممكن إجراء هذا التحليل قبل التحويل الصوتي ، ولكن بعد ذلك هناك فرصة لتفويت بروتوكول فيه أسماء متوسطة ، ولكن في البداية كان بالفعل في اللاتينية. لذلك كل شيء على ما يرام. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سنبحث</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> عن جميع البروتوكولات التي يوجد فيها عدد الأجزاء </font><i><font style="vertical-align: inherit;">"vich"</font></i><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"vna"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في العمود</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم هو</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أكثر من 50٪ من إجمالي عدد الإدخالات في البروتوكول.</font></font><br>
<br>
<pre><code class="python hljs">wp = {} <span class="hljs-comment">#wp – with patronymic </span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    nvich = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vich'</span>) <font></font>
    nvna = (<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name'</span>])).count(<span class="hljs-string">'vna'</span>)
    <span class="hljs-keyword">if</span> nvich + nvna &gt; <span class="hljs-number">0.5</span>*len(rd[e]):<font></font>
        wp[e] = rd[e]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 29 بروتوكولًا ، أحدها هو: </font><font style="vertical-align: inherit;">ومن المثير للاهتمام أنه إذا أخذنا 20٪ أو العكس بالعكس 70٪ ، فلن تتغير النتيجة ، سيظل هناك 29 ، لذا قمنا بالاختيار الصحيح. </font><font style="vertical-align: inherit;">وفقًا لذلك ، أقل من 20٪ - تأثير الألقاب ، أكثر من 70٪ - تأثير السجلات الفردية بدون أسماء وسط. </font><font style="vertical-align: inherit;">بعد فحص البلاد بمساعدة طاولة محورية ، اتضح أن 25 منهم كانوا في روسيا ، و 4 في أبخازيا. </font><font style="vertical-align: inherit;">
الانتقال. </font><font style="vertical-align: inherit;">سنقوم فقط بمعالجة السجلات التي تحتوي على ثلاثة مكونات ، وهي تلك التي يوجد فيها (من المفترض) اللقب والاسم والاسم الأوسط.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Yaroslav <u>Stanislavovich</u> Pavlishchev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Vladimir <u>Vasilevich</u> Perezhigin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Vladislav <u>Evgenevich</u> Litvinchuk</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td>Sergey <u>Gennadevich</u> Gavrilenko</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Ivan <u>Markovich</u> Markin</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Nikolay <u>Evgenevich</u> Sokolov</td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Aram <u>Pavlovich</u> Kukhtiev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Andrey <u>Anatolevich</u> Andreev</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Denis <u>Valerevich</u> Bulgakov</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Aleksandr <u>Ivanovich</u> Kuts</td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sum_n3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name of 3 words</span>
sum_nnot3w = <span class="hljs-number">0</span> <span class="hljs-comment"># sum name not of 3 words</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp: <font></font>
    sum_n3w += len([n <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> wp[e][<span class="hljs-string">'name'</span>] <span class="hljs-keyword">if</span> len(n.split()) == <span class="hljs-number">3</span>])<font></font>
    sum_nnot3w += len(wp[e]) - n3w<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
غالبية هذه السجلات هي 86٪. </font><font style="vertical-align: inherit;">الآن تلك التي تنقسم فيها المكونات الثلاثة إلى أعمدة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name0 ، name1 ، name2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind3 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rd[e].index <span class="hljs-keyword">if</span> len(rd[e].loc[i,<span class="hljs-string">'name'</span>].split()) == <span class="hljs-number">3</span>]<font></font>
    rd[e][<span class="hljs-string">'name0'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name1'</span>] = <span class="hljs-string">''</span>
    rd[e][<span class="hljs-string">'name2'</span>] = <span class="hljs-string">''</span>
    rd[e].loc[ind3, <span class="hljs-string">'name0'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">0</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name1'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">1</span>]<font></font>
    rd[e].loc[ind3, <span class="hljs-string">'name2'</span>] = rd[e].loc[ind3,<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك ما يبدو عليه أحد البروتوكولات: </font><font style="vertical-align: inherit;">هنا ، على وجه الخصوص ، من الواضح أن تسجيل المكونين لم تتم معالجته. </font><font style="vertical-align: inherit;">الآن ، لكل بروتوكول ، تحتاج إلى تحديد العمود الذي له اسم الأوسط. </font><font style="vertical-align: inherit;">هناك </font><i><font style="vertical-align: inherit;">خياران</font></i><font style="vertical-align: inherit;"> فقط - </font><i><font style="vertical-align: inherit;">name1 ، name2</font></i><font style="vertical-align: inherit;"> ، لأنه لا يمكن أن يكون في المقام الأول. </font><font style="vertical-align: inherit;">بمجرد تحديد ذلك ، سنقوم بجمع اسم جديد بالفعل بدونه.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th><u>name0</u></th>
<th><u>name1</u></th>
<th><u>name2</u></th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Lekomtsev Denis Nikolaevich</td>
<td><u>Lekomtsev</u></td>
<td><u>Denis</u></td>
<td><u>Nikolaevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Ivanov Andrey Aleksandrovich</td>
<td><u>Ivanov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Ivanov Evgeniy Vasilevich</td>
<td><u>Ivanov</u></td>
<td><u>Evgeniy</u></td>
<td><u>Vasilevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Setepov Vladislav</td>
<td></td>
<td></td>
<td></td>
<td>...</td>
<td> </td>
</tr>
<tr>
<td>4</td>
<td>Mishanin Sergey Yurevich</td>
<td><u>Mishanin</u></td>
<td><u>Sergey</u></td>
<td><u>Yurevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Baranov Andrey Aleksandrovich</td>
<td><u>Baranov</u></td>
<td><u>Andrey</u></td>
<td><u>Aleksandrovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Nakaryakov Dmitriy Valerevich</td>
<td><u>Nakaryakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valerevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Tretyakov Dmitriy Valentinovich</td>
<td><u>Tretyakov</u></td>
<td><u>Dmitriy</u></td>
<td><u>Valentinovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Kuznetsov Stanislav Vladimirovich</td>
<td><u>Kuznetsov</u></td>
<td><u>Stanislav</u></td>
<td><u>Vladimirovich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Dubrovin Maksim Sergeevich</td>
<td><u>Dubrovin</u></td>
<td><u>Maksim</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Karpov Anatoliy Sergeevich</td>
<td><u>Karpov</u></td>
<td><u>Anatoliy</u></td>
<td><u>Sergeevich</u></td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:    <font></font>
    n1=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name1'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
    n2=(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vich'</span>)+(<span class="hljs-string">''</span>.join(rd[e][<span class="hljs-string">'name2'</span>])).count(<span class="hljs-string">'vna'</span>)<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (n1 &gt; n2):<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name2'</span>]
    <span class="hljs-keyword">else</span>:<font></font>
        rd[e][<span class="hljs-string">'new name'</span>] = rd[e][<span class="hljs-string">'name0'</span>] + <span class="hljs-string">' '</span> + rd[e][<span class="hljs-string">'name1'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>name</th>
<th>name0</th>
<th>name1</th>
<th>name2</th>
<th><u>new name</u></th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>Gorik Pavel Vladimirovich</td>
<td>Gorik</td>
<td>Pavel</td>
<td>Vladimirovich</td>
<td><u>Gorik Pavel</u></td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>Korobov Oleg Anatolevich</td>
<td>Korobov</td>
<td>Oleg</td>
<td>Anatolevich</td>
<td><u>Korobov Oleg</u></td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>Pavlishchev Yaroslav Stanislavovich</td>
<td>Pavlishchev</td>
<td>Yaroslav</td>
<td>Stanislavovich</td>
<td><u>Pavlishchev Yaroslav</u></td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>Fedorov Nikolay Nikolaevich</td>
<td>Fedorov</td>
<td>Nikolay</td>
<td>Nikolaevich</td>
<td><u>Fedorov Nikolay</u></td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>Medvedev Andrey Aleksandrovich</td>
<td>Medvedev</td>
<td>Andrey</td>
<td>Aleksandrovich</td>
<td><u>Medvedev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>Popov Sergey Eduardovich</td>
<td>Popov</td>
<td>Sergey</td>
<td>Eduardovich</td>
<td><u>Popov Sergey</u></td>
<td>  </td>
</tr>
<tr>
<td>6</td>
<td>Dumchev Andrey Viktorovich</td>
<td>Dumchev</td>
<td>Andrey</td>
<td>Viktorovich</td>
<td><u>Dumchev Andrey</u></td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>Trusov Mikhail Vladimirovich</td>
<td>Trusov</td>
<td>Mikhail</td>
<td>Vladimirovich</td>
<td><u>Trusov Mikhail</u></td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>Demichev Yuriy Anatolevich</td>
<td>Demichev</td>
<td>Yuriy</td>
<td>Anatolevich</td>
<td><u>Demichev Yuriy</u></td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>Pushkin Boris Sergeevich</td>
<td>Pushkin</td>
<td>Boris</td>
<td>Sergeevich</td>
<td><u>Pushkin Boris</u></td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>Lando Aleksandr Borisovich</td>
<td>Lando</td>
<td>Aleksandr</td>
<td>Borisovich</td>
<td><u>Lando Aleksandr</u></td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الآن، تعيين بعناية الاسم الجديد للعمود الرئيسي </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حيث أنها ليست فارغة، وحذف الأعمدة المساعدة.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> wp:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'new name'</span>].str.strip() != <span class="hljs-string">''</span>].index<font></font>
    rd[e].loc[ind, <span class="hljs-string">'name'</span>] = rd[e].loc[ind, <span class="hljs-string">'new name'</span>]<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'name0'</span>,<span class="hljs-string">'name1'</span>,<span class="hljs-string">'name2'</span>,<span class="hljs-string">'new name'</span>])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>...</th>
<th>name raw</th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td><u>Yaroslav Pavlishchev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td><u>Vladimir Perezhigin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td><u>Vladislav Litvinchuk</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>M</td>
<td><u>Sergey Gavrilenko</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td><u>Ivan Markin</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td><u>Nikolay Sokolov</u></td>
<td>RUS</td>
<td>...</td>
<td>Nikolay Evgenevich Sokolov</td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td><u>Aram Kukhtiev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td><u>Andrey Andreev</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td><u>Denis Bulgakov</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td><u>Aleksandr Kuts</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td><u>Aleksandr Lando</u></td>
<td>RUS</td>
<td>...</td>
<td>  </td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هذا كل شيء. </font><font style="vertical-align: inherit;">قمنا بتحرير 2035 إدخالات. </font><font style="vertical-align: inherit;">ليس سيئا. </font><font style="vertical-align: inherit;">تم الحفظ.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details5.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحتاج الآن إلى إحضار الأسماء إلى نفس الترتيب. </font><font style="vertical-align: inherit;">أي أنه من الضروري في جميع البروتوكولات أن يكون الاسم متبوعًا أولاً بالاسم الأخير ، أو العكس بالعكس - أولاً الاسم الأخير ، ثم الاسم الأول ، أيضًا في جميع البروتوكولات. </font><font style="vertical-align: inherit;">يعتمد على المزيد ، الآن سنكتشف. </font><font style="vertical-align: inherit;">الوضع معقد قليلاً بسبب حقيقة أن الاسم الكامل يمكن أن يتكون من أكثر من كلمتين ، حتى بعد إزالة الاسم الأوسط.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'nwin'</span>] = ar[<span class="hljs-string">'name'</span>].str.count(<span class="hljs-string">' '</span>) + <span class="hljs-number">1</span> <span class="hljs-comment"># nwin – number of words in name</span>
ar.loc[ar[<span class="hljs-string">'name'</span>] == <span class="hljs-string">''</span>,<span class="hljs-string">'nwin'</span>] = <span class="hljs-number">0</span>
<span class="hljs-number">100</span>*ar[<span class="hljs-string">'nwin'</span>].value_counts()/len(ar)
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عدد الكلمات في الاسم عدد السجلات حصة السجلات (٪) </font><font style="vertical-align: inherit;">بالطبع ، الغالبية العظمى (91٪) كلمتان - مجرد اسم ولقب. </font><font style="vertical-align: inherit;">لكن الإدخالات التي تحتوي على ثلاث وأربع كلمات هي أيضًا كثيرة جدًا. </font><font style="vertical-align: inherit;">دعونا نلقي نظرة على جنسية مثل هذه السجلات:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>   </th>
<th> </th>
<th>  (%)</th>
</tr>
<tr>
<td>2</td>
<td>1285270</td>
<td>90.74426</td>
</tr>
<tr>
<td>3</td>
<td>102220</td>
<td>7.217066</td>
</tr>
<tr>
<td>4</td>
<td>22420</td>
<td>1.582925</td>
</tr>
<tr>
<td>0</td>
<td>3454</td>
<td>0.243864</td>
</tr>
<tr>
<td>5</td>
<td>2385</td>
<td>0.168389</td>
</tr>
<tr>
<td>6</td>
<td>469</td>
<td>0.033113</td>
</tr>
<tr>
<td>1</td>
<td>80</td>
<td>0.005648</td>
</tr>
<tr>
<td>7</td>
<td>57</td>
<td>0.004024</td>
</tr>
<tr>
<td>8</td>
<td>5</td>
<td>0.000353</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>0.000282</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>0.000071</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'nwin'</span>] &gt;= <span class="hljs-number">3</span>][<span class="hljs-string">'country'</span>].value_counts()[:<span class="hljs-number">12</span>]
</code></pre><br>
<code><b>Out: </b><br>
ESP 28435<br>
MEX 10561<br>
USA 7608<br>
DNK 7178<br>
BRA 6321<br>
NLD 5748<br>
DEU 4310<br>
PHL 3941<br>
ZAF 3862<br>
ITA 3691<br>
BEL 3596<br>
FRA 3323<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، في المقام الأول إسبانيا ، في المرتبة الثانية - المكسيك ، بلد من أصل إسباني ، أبعد من الولايات المتحدة ، حيث يوجد أيضًا تاريخًا الكثير من اللاتينيين. البرازيل والفلبين أيضا أسماء الإسبانية (والبرتغالية). الدنمارك وهولندا وألمانيا وجنوب إفريقيا وإيطاليا وبلجيكا وفرنسا هي مسألة أخرى ، فهناك ببساطة نوع من البادئة لللقب ، وبالتالي هناك أكثر من كلمتين. في جميع هذه الحالات ، ومع ذلك ، عادة ما يتكون الاسم نفسه من كلمة واحدة ، والاسم الأخير لكلمتين ، ثلاثة. بالطبع ، هناك استثناءات لهذه القاعدة ، لكننا لن نعالجها بعد الآن. أولاً ، لكل بروتوكول ، تحتاج إلى تحديد نوع النظام: اسم اللقب أو العكس. كيف افعلها؟ حدثت لي الفكرة التالية: أولاً ، عادةً ما يكون تنوع الألقاب أكبر بكثير من تنوع الأسماء. يجب أن يكون الأمر كذلك حتى في إطار بروتوكول واحد. ثانيا،عادة ما يكون طول الاسم أقل من طول اللقب (حتى بالنسبة للألقاب غير المركبة). سنستخدم مجموعة من هذه المعايير لتحديد الترتيب الأولي.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حدد الكلمات الأولى والأخيرة بالاسم الكامل:</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'new name'</span>] = ar[<span class="hljs-string">'name'</span>]<font></font>
ind = ar[ar[<span class="hljs-string">'nwin'</span>] &lt; <span class="hljs-number">2</span>].index<font></font>
ar.loc[ind, <span class="hljs-string">'new name'</span>] = <span class="hljs-string">'. .'</span> <span class="hljs-comment">#  ,   str.split()   </span>
ar[<span class="hljs-string">'wfin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#fwin  – first word in name</span>
ar[<span class="hljs-string">'lwin'</span>] = ar[<span class="hljs-string">'new name'</span>].str.split().str[<span class="hljs-number">-1</span>]<span class="hljs-comment">#lfin – last word in name</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قم بتحويل إطار بيانات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> المدمج </font><font style="vertical-align: inherit;">مرة أخرى إلى القاموس </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بحيث تقع الأعمدة الجديدة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nwin، ns0، ns</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في إطار البيانات لكل سباق. </font><font style="vertical-align: inherit;">بعد ذلك ، نحدد عدد البروتوكولات بالترتيب </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> First </font><i><font style="vertical-align: inherit;">Name Last Name"</font></i><font style="vertical-align: inherit;"> وعدد البروتوكولات بالترتيب العكسي وفقًا لمعيارنا. </font><font style="vertical-align: inherit;">سننظر فقط في الإدخالات حيث يتكون الاسم الكامل من كلمتين. </font><font style="vertical-align: inherit;">في نفس الوقت ، احفظ الاسم (الاسم الأول) في عمود جديد:</font></font><br>
<br>
<pre><code class="python hljs">name_surname = {}<font></font>
surname_name = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    d = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] == <span class="hljs-number">2</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &lt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &lt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        name_surname[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'fwin'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(d[<span class="hljs-string">'fwin'</span>].unique()) &gt; len(d[<span class="hljs-string">'lwin'</span>].unique()) <span class="hljs-keyword">and</span> len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'fwin'</span>])) &gt; len(<span class="hljs-string">''</span>.join(d[<span class="hljs-string">'lwin'</span>])):<font></font>
        surname_name[e] = d<font></font>
        rd[e][<span class="hljs-string">'first name'</span>] = rd[e][<span class="hljs-string">'lwin'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح ما يلي: ترتيب </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الأول </font><i><font style="vertical-align: inherit;">اسم العائلة</font></i><font style="vertical-align: inherit;"> - 244 بروتوكول ، ترتيب </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم الأخير</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أولاً - 1508 بروتوكول. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وفقًا لذلك ، سنؤدي إلى التنسيق الأكثر شيوعًا. </font><font style="vertical-align: inherit;">اتضح أن المبلغ أقل من المبلغ الإجمالي ، لأننا تحققنا من استيفاء معيارين في نفس الوقت ، وحتى مع عدم المساواة الصارمة. </font><font style="vertical-align: inherit;">هناك بروتوكولات يتم فيها تحقيق معيار واحد فقط ، أو أنه ممكن ، ولكن من غير المحتمل أن تحدث المساواة. </font><font style="vertical-align: inherit;">ولكن هذا غير مهم على الإطلاق حيث يتم تعريف التنسيق. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، بافتراض أننا حددنا الطلب بدقة عالية بما فيه الكفاية ، مع عدم نسيان أنه ليس دقيقًا بنسبة 100٪ ، سنستخدم هذه المعلومات. </font><font style="vertical-align: inherit;">اعثر على الأسماء الأكثر شهرة من عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم الأول</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">vc = ar[<span class="hljs-string">'first name'</span>].value_counts()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
خذ أولئك الذين التقوا أكثر من مائة مرة:</font></font><br>
<br>
<pre><code class="python hljs">pfn=vc[vc&gt;<span class="hljs-number">100</span>] <span class="hljs-comment">#pfn – popular first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان هناك 1673 منهم ، وإليك المئات منها مرتبة بترتيب تنازلي للشعبية: </font><font style="vertical-align: inherit;">
الآن ، وباستخدام هذه القائمة ، سنجري جميع البروتوكولات ونقارن حيث يوجد المزيد من التطابقات - في الكلمة الأولى من الاسم أو في الأخيرة. سننظر فقط في الأسماء المكونة من كلمتين. إذا كان هناك المزيد من التطابقات مع الكلمة الأخيرة ، فإن الترتيب صحيح ، إذا كان مع الكلمة الأولى ، فهذا يعني العكس. علاوة على ذلك ، نحن هنا أكثر ثقة بالفعل ، لذا يمكنك استخدام هذه المعرفة ، وسنضيف قائمة بأسماء بروتوكولهم التالي إلى القائمة الأولية للأسماء الشائعة مع كل تمريرة. نقوم بفرز البروتوكولات مسبقًا حسب تكرار ظهور الأسماء من القائمة الأولية من أجل تجنب الأخطاء العشوائية وإعداد قائمة أكثر شمولاً لتلك البروتوكولات التي يوجد بها عدد قليل من التطابقات والتي سيتم معالجتها بالقرب من نهاية الدورة.</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Patrick', 'Scott', 'Kevin', 'Stefan', 'Jason', 'Eric', 'Christopher', 'Alexander', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Andrea', 'Jonathan', 'Markus', 'Marco', 'Adam', 'Ryan', 'Jan', 'Tom', 'Marc', 'Carlos', 'Jennifer', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Sarah', 'Alex', 'Jose', 'Andrey', 'Benjamin', 'Sebastian', 'Ian', 'Anthony', 'Ben', 'Oliver', 'Antonio', 'Ivan', 'Sean', 'Manuel', 'Matthias', 'Nicolas', 'Dan', 'Craig', 'Dmitriy', 'Laura', 'Luis', 'Lisa', 'Kim', 'Anna', 'Nick', 'Rob', 'Maria', 'Greg', 'Aleksey', 'Javier', 'Michelle', 'Andre', 'Mario', 'Joseph', 'Christoph', 'Justin', 'Jim', 'Gary', 'Erik', 'Andy', 'Joe', 'Alberto', 'Roberto', 'Jens', 'Tobias', 'Lee', 'Nicholas', 'Dave', 'Tony', 'Olivier', 'Philippe']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">sbpn = pd.DataFrame(columns = [<span class="hljs-string">'event'</span>, <span class="hljs-string">'num pop names'</span>], index=range(len(rd))) <span class="hljs-comment"># sbpn - sorted by popular names</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = list(rd.keys())[i]<font></font>
    sbpn.loc[i, <span class="hljs-string">'event'</span>] = e<font></font>
    sbpn.loc[i, <span class="hljs-string">'num pop names'</span>] = len(set(pfn).intersection(rd[e][<span class="hljs-string">'first name'</span>]))<font></font>
<font></font>
sbnp=sbnp.sort_values(by = <span class="hljs-string">'num pop names'</span>,ascending=<span class="hljs-literal">False</span>)<font></font>
sbnp = sbnp.reset_index(drop=<span class="hljs-literal">True</span>) 
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>num pop names</th>
</tr>
<tr>
<td>0</td>
<td>Ironman World Championship 70.3 2016</td>
<td>811</td>
</tr>
<tr>
<td>1</td>
<td>Ironman World Championship 2019</td>
<td>781</td>
</tr>
<tr>
<td>2</td>
<td>Ironman World Championship 70.3 2015</td>
<td>778</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mallorca 70.3 2014</td>
<td>776</td>
</tr>
<tr>
<td>4</td>
<td>Ironman World Championship 2018</td>
<td>766</td>
</tr>
<tr>
<td>5</td>
<td>Challenge Roth Long 2019</td>
<td>759</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>1917</td>
<td>Challenge Gran Canaria Olympic 2019</td>
<td>0</td>
</tr>
<tr>
<td>1918</td>
<td>Challenge Gran Canaria Middle 2017</td>
<td>0</td>
</tr>
<tr>
<td>1919</td>
<td>Challenge Forte Village-Sardinia Sprint 2017</td>
<td>0</td>
</tr>
<tr>
<td>1920</td>
<td>ITU European Cup Kuopio Sprint 2007</td>
<td>0</td>
</tr>
<tr>
<td>1921</td>
<td>ITU World Cup Madeira Olympic 2002</td>
<td>0</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">tofix = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(rd)):<font></font>
    e = sbpn.loc[i, <span class="hljs-string">'event'</span>]<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(set(list(rd[e][<span class="hljs-string">'fwin'</span>])).intersection(pfn)) &gt; len(set(list(rd[e][<span class="hljs-string">'lwin'</span>])).intersection(pfn)):<font></font>
        tofix.append(e)<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'fwin'</span>])))
    <span class="hljs-keyword">else</span>:<font></font>
        pfn = list(set(pfn + list(rd[e][<span class="hljs-string">'lwin'</span>])))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان هناك 235 بروتوكولات. وهذا هو ، تقريبًا نفس ما حدث في التقريب الأول (244). للتأكد ، نظرت بشكل انتقائي في السجلات الثلاثة الأولى من كل منها ، وتأكدت من أن كل شيء كان صحيحًا. تحقق أيضًا من أن المرحلة الأولى من التصنيف أعطت 36 إدخالًا كاذبًا من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم اسم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الفصل </font><i><font style="vertical-align: inherit;">الدراسي واثنين</font></i><font style="vertical-align: inherit;"> خطأ من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم اسم</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الفصل </font><i><font style="vertical-align: inherit;">الدراسي</font></i><font style="vertical-align: inherit;"> . نظرت إلى السجلات الثلاثة الأولى من كل منها ، والواقع أن المرحلة الثانية عملت بشكل مثالي. الآن ، في الواقع ، يبقى إصلاح تلك البروتوكولات حيث تم العثور على ترتيب خاطئ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> tofix:<font></font>
    ind = rd[e][rd[e][<span class="hljs-string">'nwin'</span>] &gt; <span class="hljs-number">1</span>].index<font></font>
    rd[e].loc[ind,<span class="hljs-string">'name'</span>] = rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">1</span>] + <span class="hljs-string">' '</span> +                   rd[e].loc[ind,<span class="hljs-string">'name'</span>].str.split(n=<span class="hljs-number">1</span>).str[<span class="hljs-number">0</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هنا في الانقسام ، حددنا عدد القطع باستخدام المعلمة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">المنطق هو: الاسم كلمة واحدة ، الأولى في الاسم الكامل. </font><font style="vertical-align: inherit;">كل شيء آخر هو لقب (قد يتكون من عدة كلمات). </font><font style="vertical-align: inherit;">فقط قم بتبديلها. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن نتخلص من الأعمدة غير الضرورية ونوفر:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd:<font></font>
    rd[e] = rd[e].drop(columns = [<span class="hljs-string">'new name'</span>, <span class="hljs-string">'first name'</span>, <span class="hljs-string">'fwin'</span>,<span class="hljs-string">'lwin'</span>, <span class="hljs-string">'nwin'</span>])<font></font>
<font></font>
pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحقق من النتيجة. </font><font style="vertical-align: inherit;">عشرات السجلات الثابتة العشوائية: </font><font style="vertical-align: inherit;">تم </font><font style="vertical-align: inherit;">إصلاح </font><font style="vertical-align: inherit;">ما مجموعه 108 ألف سجل. </font><font style="vertical-align: inherit;">وانخفض عدد الأسماء الكاملة الفريدة من 598 إلى 547 ألفًا. </font><font style="vertical-align: inherit;">غرامة! </font><font style="vertical-align: inherit;">مع الانتهاء من التنسيق.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th><u>name</u></th>
<th>country</th>
<th>group</th>
<th>...</th>
<th><u>name raw</u></th>
</tr>
<tr>
<td>188</td>
<td>189</td>
<td>M</td>
<td><u>Azhel Dmitriy</u></td>
<td>BLR</td>
<td></td>
<td>...</td>
<td><u> </u></td>
</tr>
<tr>
<td>96</td>
<td>97</td>
<td>M</td>
<td><u>Bostina Cristian</u></td>
<td>ROU</td>
<td></td>
<td>...</td>
<td><u>Cristian Bostina</u></td>
</tr>
<tr>
<td>1757</td>
<td>1758</td>
<td>M</td>
<td><u>Lowe Jonathan</u></td>
<td>AUS</td>
<td>M30-34</td>
<td>...</td>
<td><u>Jonathan LOWE</u></td>
</tr>
<tr>
<td>599</td>
<td>600</td>
<td>M</td>
<td><u>Baerwald Manuel</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Manuel BAERWALD</u></td>
</tr>
<tr>
<td>657</td>
<td>658</td>
<td>M</td>
<td><u>Krumdieck Ralf</u></td>
<td>DEU</td>
<td></td>
<td>...</td>
<td><u>Ralf KRUMDIECK</u></td>
</tr>
<tr>
<td>354</td>
<td>355</td>
<td>F</td>
<td><u>Knapp Samantha</u></td>
<td>USA</td>
<td>F30-34</td>
<td>...</td>
<td><u>Samantha Knapp</u></td>
</tr>
<tr>
<td>375</td>
<td>376</td>
<td>M</td>
<td><u>Rintalaulaja Mika</u></td>
<td>FIN</td>
<td>M40-44</td>
<td>...</td>
<td><u>Mika Rintalaulaja</u></td>
</tr>
<tr>
<td>1304</td>
<td>1305</td>
<td>M</td>
<td><u>Dee Jim</u></td>
<td>USA</td>
<td>M50-54</td>
<td>...</td>
<td><u>Jim DEE</u></td>
</tr>
<tr>
<td>178</td>
<td>179</td>
<td>M</td>
<td><u>Halibert Greg</u></td>
<td>FRA</td>
<td></td>
<td>...</td>
<td><u>GREG HALIBERT</u></td>
</tr>
<tr>
<td>2740</td>
<td>2741</td>
<td>F</td>
<td><u>Comia Marissa</u></td>
<td>USA</td>
<td>F45-49</td>
<td>...</td>
<td><u>Marissa COMIA</u></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجزء 3. استعادة البيانات غير مكتملة</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
انتقل الآن إلى استعادة البيانات المفقودة. </font><font style="vertical-align: inherit;">وهناك مثل هذا.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بلد</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لنبدأ بالبلد. </font><font style="vertical-align: inherit;">البحث عن جميع السجلات التي لم يُشر فيها البلد:</font></font><br>
<br>
<pre><code class="python hljs">arnc = ar[ar[<span class="hljs-string">'country'</span>] == <span class="hljs-string">''</span>] <span class="hljs-comment">#arnc – all records with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
منهم 3221 منهم 10 عشوائية:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><br>
<br>
<pre><code class="python hljs">nnc = arnc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nnc - names with no country</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عدد الأسماء الفريدة بين السجلات بدون بلد هو 0551. لنرى ما إذا كان يمكن تقليل هذا الرقم. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
والحقيقة هي أنه في نادٍ ما يقتصر الأشخاص في الترياثلون على سباق واحد فقط ، وعادة ما يشاركون في المسابقات بشكل دوري ، عدة مرات في الموسم ، من سنة إلى أخرى ، يتدربون باستمرار. </font><font style="vertical-align: inherit;">لذلك ، بالنسبة للعديد من الأسماء في البيانات ، هناك على الأرجح أكثر من سجل واحد. </font><font style="vertical-align: inherit;">لاستعادة معلومات حول البلد ، حاول العثور على سجلات بنفس الاسم من بين تلك التي يشار إليها البلد.</font></font><br>
<br>
<pre><code class="python hljs">arwc = ar[ar[<span class="hljs-string">'country'</span>] != <span class="hljs-string">''</span>] <span class="hljs-comment">#arwc – all records with country</span>
nwc = arwc[<span class="hljs-string">'name'</span>].unique() <span class="hljs-comment">#nwc – names with country</span>
tofix = set(nnc).intersection(nwc)</code></pre><br>
<code><b>Out:</b> ['Kleber-Schad Ute Cathrin', 'Sellner Peter', 'Pfeiffer Christian', 'Scholl Thomas', 'Petersohn Sandra', 'Marchand Kurt', 'Janneck Britta', 'Angheben Riccardo', 'Thiele Yvonne', 'Kie?Wetter Martin', 'Schymik Gerhard', 'Clark Donald', 'Berod Brigitte', 'Theile Markus', 'Giuliattini Burbui Margherita', 'Wehrum Alexander', 'Kenny Oisin', 'Schwieger Peter', 'Grosse Bianca', 'Schafter Carsten', 'Breck Dirk', 'Mautes Christoph', 'Herrmann Andreas', 'Gilbert Kai', 'Steger Peter', 'Jirouskova Jana', 'Jehrke Michael', 'Valentine David', 'Reis Michael', 'Wanka Michael', 'Schomburg Jonas', 'Giehl Caprice', 'Zinser Carsten', 'Schumann Marcus', 'Magoni Livio', 'Lauden Yann', 'Mayer Dieter', 'Krisa Stefan', 'Haberecht Bernd', 'Schneider Achim', 'Gibanel Curto Antonio', 'Miranda Antonio', 'Juarez Pedro', 'Prelle Gerrit', 'Wuste Kay', 'Bullock Graeme', 'Hahner Martin', 'Kahl Maik', 'Schubnell Frank', 'Hastenteufel Marco', …]<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كان هناك 2236 منهم ، أي ما يقرب من ثلاثة أرباع. </font><font style="vertical-align: inherit;">الآن ، لكل اسم من هذه القائمة ، تحتاج إلى تحديد البلد من خلال السجلات التي توجد فيها. </font><font style="vertical-align: inherit;">ولكن يحدث أن الاسم نفسه موجود في العديد من السجلات وفي بلدان مختلفة. </font><font style="vertical-align: inherit;">هذا إما يحمل الاسم نفسه ، أو ربما انتقل الشخص. </font><font style="vertical-align: inherit;">لذلك ، نقوم أولاً بمعالجة تلك التي يكون فيها كل شيء فريدًا.</font></font><br>
<br>
<pre><code class="python hljs">fix = {}<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> tofix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n] <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> len(nr[<span class="hljs-string">'country'</span>].unique()) == <span class="hljs-number">1</span>:<font></font>
        fix[n] = nr[<span class="hljs-string">'country'</span>].iloc[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
صنع في حلقة. </font><font style="vertical-align: inherit;">ولكن ، بصراحة ، يعمل لمدة طويلة - حوالي ثلاث دقائق. </font><font style="vertical-align: inherit;">إذا كان هناك ترتيب بمزيد من الإدخالات ، فربما يتعين عليك التوصل إلى تنفيذ متجه. </font><font style="vertical-align: inherit;">كان هناك 2،013 إدخال ، أو 90 ٪ من الإمكانات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الأسماء التي قد تظهر بلدان مختلفة في سجلات مختلفة ، تأخذ البلد الذي يحدث في أغلب الأحيان.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> n <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> fix:<font></font>
    nr = arwc[arwc[<span class="hljs-string">'name'</span>] == n]<font></font>
    vc = nr[<span class="hljs-string">'country'</span>].value_counts()    <font></font>
	<font></font>
    <span class="hljs-keyword">if</span> vc[<span class="hljs-number">0</span>] &gt; vc[<span class="hljs-number">1</span>]:<font></font>
        fix[n] = vc.index[<span class="hljs-number">0</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالتالي ، تم العثور على تطابقات لـ 2،208 اسمًا ، أو 99٪ من جميع الأسماء المحتملة. </font><font style="vertical-align: inherit;">
نطبق هذه المراسلات:</font></font><br>
<code>{'Kleber-Schad Ute Cathrin': 'DEU', 'Sellner Peter': 'AUT', 'Pfeiffer Christian': 'AUT', 'Scholl Thomas': 'DEU', 'Petersohn Sandra': 'DEU', 'Marchand Kurt': 'BEL', 'Janneck Britta': 'DEU', 'Angheben Riccardo': 'ITA', 'Thiele Yvonne': 'DEU', 'Kie?Wetter Martin': 'DEU', 'Clark Donald': 'GBR', 'Berod Brigitte': 'FRA', 'Theile Markus': 'DEU', 'Giuliattini Burbui Margherita': 'ITA', 'Wehrum Alexander': 'DEU', 'Kenny Oisin': 'IRL', 'Schwieger Peter': 'DEU', 'Schafter Carsten': 'DEU', 'Breck Dirk': 'DEU', 'Mautes Christoph': 'DEU', 'Herrmann Andreas': 'DEU', 'Gilbert Kai': 'DEU', 'Steger Peter': 'AUT', 'Jirouskova Jana': 'CZE', 'Jehrke Michael': 'DEU', 'Wanka Michael': 'DEU', 'Giehl Caprice': 'DEU', 'Zinser Carsten': 'DEU', 'Schumann Marcus': 'DEU', 'Magoni Livio': 'ITA', 'Lauden Yann': 'FRA', 'Mayer Dieter': 'DEU', 'Krisa Stefan': 'DEU', 'Haberecht Bernd': 'DEU', 'Schneider Achim': 'DEU', 'Gibanel Curto Antonio': 'ESP', 'Juarez Pedro': 'ESP', 'Prelle Gerrit': 'DEU', 'Wuste Kay': 'DEU', 'Bullock Graeme': 'GBR', 'Hahner Martin': 'DEU', 'Kahl Maik': 'DEU', 'Schubnell Frank': 'DEU', 'Hastenteufel Marco': 'DEU', 'Tedde Roberto': 'ITA', 'Minervini Domenico': 'ITA', 'Respondek Markus': 'DEU', 'Kramer Arne': 'DEU', 'Schreck Alex': 'DEU', 'Bichler Matthias': 'DEU', …}<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> fix:<font></font>
    ind = arnc[arnc[<span class="hljs-string">'name'</span>] == n].index<font></font>
    ar.loc[ind, <span class="hljs-string">'country'</span>] = fix[n]</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th><u>country</u></th>
<th>group</th>
<th>...</th>
<th>country raw</th>
</tr>
<tr>
<td>...</td>
<td>1633</td>
<td>M</td>
<td>Guerrero Pla Angel</td>
<td><u>ESP</u></td>
<td>M30-34</td>
<td>...</td>
<td>E</td>
</tr>
<tr>
<td>...</td>
<td>258</td>
<td>M</td>
<td>Bellm Mathias</td>
<td><u>DEU</u></td>
<td>M35-39</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>655</td>
<td>M</td>
<td>Moratto Alessio</td>
<td><u>ITA</u></td>
<td>M40-44</td>
<td>...</td>
<td>I</td>
</tr>
<tr>
<td>...</td>
<td>1317</td>
<td>M</td>
<td>Solari Jean-Jacques</td>
<td><u>PYF</u></td>
<td>M50-54</td>
<td>...</td>
<td>TAH</td>
</tr>
<tr>
<td>...</td>
<td>1311</td>
<td>F</td>
<td>Duranel Isabelle</td>
<td><u>FRA</u></td>
<td>F40-44</td>
<td>...</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1012</td>
<td>M</td>
<td>Endler Maximilian</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>284</td>
<td>M</td>
<td>Schreiner Jorg</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>14</td>
<td>M</td>
<td>Butturini Jacopo</td>
<td><u>HRV</u></td>
<td></td>
<td>...</td>
<td>ITU</td>
</tr>
<tr>
<td>...</td>
<td>204</td>
<td>M</td>
<td>Lindner Thomas</td>
<td><u>DEU</u></td>
<td>M40-44</td>
<td>...</td>
<td>D</td>
</tr>
<tr>
<td>...</td>
<td>1168</td>
<td>M</td>
<td>Gramke Peter</td>
<td><u>DEU</u></td>
<td>M45-49</td>
<td>...</td>
<td>D</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بعد تصحيحاتنا ، انخفض عدد السجلات بدون دولة إلى 909 ، أي أكثر من ثلاث مرات. </font><font style="vertical-align: inherit;">على الرغم من أن العدد الإجمالي لـ 2،208 ليس كبيرًا جدًا على خلفية مليون ونصف ، إلا أنه لا يزال لطيفًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وعلاوة على ذلك، كالعادة، نترجم جنبا إلى جنب إطار بيانات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مرة أخرى في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الثالثة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> القاموس </font><font style="vertical-align: inherit;">وحفظه.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details7.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أرضية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كما هو الحال في البلدان ، هناك سجلات لا يشار فيها إلى جنس المشارك. </font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 2538 منهم ، قليل نسبياً ، ولكن مرة أخرى سنحاول أن نجعل أقل. </font><font style="vertical-align: inherit;">احفظ القيم الأصلية في عمود جديد.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'sex raw'</span>] =ar[<span class="hljs-string">'sex'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
على عكس البلدان التي استرجعنا فيها معلومات بالاسم من البروتوكولات الأخرى ، كل شيء أكثر تعقيدًا هنا. </font><font style="vertical-align: inherit;">والحقيقة هي أن البيانات مليئة بالأخطاء وهناك العديد من الأسماء (مجموع 2101) التي تم العثور عليها بعلامات لكلا الجنسين.</font></font><br>
<br>
<pre><code class="python hljs">arws = ar[(ar[<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)] <span class="hljs-comment">#arws – all records with sex</span>
snds = arws[arws.duplicated(subset=<span class="hljs-string">'name'</span>,keep=<span class="hljs-literal">False</span>)]<span class="hljs-comment">#snds–single name different sex</span>
snds = snds.drop_duplicates(subset=[<span class="hljs-string">'name'</span>,<span class="hljs-string">'sex'</span>], keep = <span class="hljs-string">'first'</span>)<font></font>
snds = snds.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
snds = snds[snds.duplicated(subset = <span class="hljs-string">'name'</span>, keep=<span class="hljs-literal">False</span>)]<font></font>
<font></font>
snds</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th><u>name</u></th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>428</td>
<td><u>F</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>718</td>
<td><u>M</u></td>
<td><u>Aagaard Ida</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td></td>
<td>740</td>
<td><u>M</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>M50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>M50-54</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>520</td>
<td><u>F</u></td>
<td><u>Aarekol Tove Aase</u></td>
<td>NOR</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>NOR</td>
<td>F50-54</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>665</td>
<td><u>F</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>F40-44</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1591</td>
<td><u>M</u></td>
<td><u>Aaroy Torunn</u></td>
<td>NOR</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>NOR</td>
<td>M40-44</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>70</td>
<td><u>M</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>ARG</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1258</td>
<td><u>F</u></td>
<td><u>Aberg Cobo Dolores</u></td>
<td>ARG</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ARG</td>
<td>F30-34</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1909</td>
<td><u>F</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>F35-39</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>340</td>
<td><u>M</u></td>
<td><u>Aboulfaida Zineb</u></td>
<td>MAR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>MAR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>AUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>38</td>
<td><u>M</u></td>
<td><u>Abram Felicity</u></td>
<td>AUS</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>134</td>
<td><u>M</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>323</td>
<td><u>F</u></td>
<td><u>Abramowski Jannicke</u></td>
<td>DEU</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>GER</td>
<td>F25-29</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>21</td>
<td><u>M</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>177</td>
<td><u>F</u></td>
<td><u>Abrosimova Anastasia</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>188</td>
<td><u>M</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td><u>Abysova Irina</u></td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>312</td>
<td><u>M</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>FJUNIOR</u></td>
<td>...</td>
<td>PUR</td>
<td>FJUNIOR</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>294</td>
<td><u>F</u></td>
<td><u>Acaron Fabiola</u></td>
<td>PRI</td>
<td><u>F45-49</u></td>
<td>...</td>
<td>PUR</td>
<td>F45-49</td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>1500</td>
<td><u>M</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>749</td>
<td><u>F</u></td>
<td><u>Achampong Benjamin</u></td>
<td>GBR</td>
<td><u>M35-39</u></td>
<td>...</td>
<td>GBR</td>
<td>M35-39</td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نعم ، من حيث المبدأ ، هناك أسماء للجنسين (أو مخنثين) ، أي تلك المستخدمة لتسمية كل من الأولاد والبنات. بالنسبة للرياضيين الآسيويين ، يصعب تحديد الجنس بالاسم - ربما ليس لدي ما يكفي من المعرفة. ومع ذلك ، من الصعب تصديق أن اسم إيرينا أو أناستاسيا ينتمي إلى رجل ، وكان بنيامين يسمى امرأة. بالإضافة إلى ذلك ، اكتشفت في وقت ما أن هناك عددًا كبيرًا من البروتوكولات التي يتم فيها تمييز جميع المشاركين بنوع واحد.</font></font><br>
<br>
<pre><code class="python hljs">rss = [rd[e] <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rd <span class="hljs-keyword">if</span> len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] != <span class="hljs-string">''</span>][<span class="hljs-string">'sex'</span>].unique()) == <span class="hljs-number">1</span>] <span class="hljs-comment">#rss – races with single sex</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 633 منهم ، يبدو أن هذا ممكن تمامًا ، مجرد بروتوكول منفصل للنساء ، بشكل منفصل للرجال. لكن الحقيقة هي أن جميع هذه البروتوكولات تقريبًا تحتوي على فئات عمرية من كلا الجنسين (تبدأ الفئات العمرية للذكور بالحرف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، الإناث - بالحرف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). على سبيل المثال: من </font><font style="vertical-align: inherit;">المتوقع أن يبدأ اسم الفئة العمرية بالحرف </font><i><font style="vertical-align: inherit;">M</font></i><font style="vertical-align: inherit;"> للرجال والحرف </font><i><font style="vertical-align: inherit;">F</font></i><font style="vertical-align: inherit;"> للنساء. في المثالين السابقين ، على الرغم من الأخطاء في عمود </font><i><font style="vertical-align: inherit;">الجنس</font></i></font><br>
<br>
<code>'ITU World Cup Tiszaujvaros Olympic 2002'<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>name raw</th>
</tr>
<tr>
<td>76</td>
<td><u>M</u></td>
<td>Dederko Ewa</td>
<td>POL</td>
<td>FPRO</td>
<td>...</td>
<td>POL</td>
<td><u>FPRO</u></td>
<td>Dederko Ewa</td>
</tr>
<tr>
<td>84</td>
<td><u>M</u></td>
<td>Chenevier Giunia</td>
<td>ITA</td>
<td>FPRO</td>
<td>...</td>
<td>ITA</td>
<td><u>FPRO</u></td>
<td>Chenevier Giunia</td>
</tr>
<tr>
<td>36</td>
<td><u>M</u></td>
<td>O'Grady Graham</td>
<td>NZL</td>
<td>MPRO</td>
<td>...</td>
<td>NZL</td>
<td><u>MPRO</u></td>
<td>O'Grady Graham</td>
</tr>
<tr>
<td>23</td>
<td><u>M</u></td>
<td>Danek Michal</td>
<td>CZE</td>
<td>MPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>MPRO</u></td>
<td>Danek Michal</td>
</tr>
<tr>
<td>74</td>
<td><u>M</u></td>
<td>Peon Carole</td>
<td>FRA</td>
<td>FPRO</td>
<td>...</td>
<td>FRA</td>
<td><u>FPRO</u></td>
<td>Peon Carole</td>
</tr>
<tr>
<td>48</td>
<td><u>M</u></td>
<td>Hechenblaickner Daniel</td>
<td>AUT</td>
<td>MPRO</td>
<td>...</td>
<td>AUT</td>
<td><u>MPRO</u></td>
<td>Hechenblaickner Daniel</td>
</tr>
<tr>
<td>70</td>
<td><u>M</u></td>
<td>Blatchford Liz</td>
<td>GBR</td>
<td>FPRO</td>
<td>...</td>
<td>GBR</td>
<td><u>FPRO</u></td>
<td>Blatchford Liz</td>
</tr>
<tr>
<td>1</td>
<td><u>M</u></td>
<td>Walton Craig</td>
<td>AUS</td>
<td>MPRO</td>
<td>...</td>
<td>AUS</td>
<td><u>MPRO</u></td>
<td>Walton Craig</td>
</tr>
<tr>
<td>20</td>
<td><u>M</u></td>
<td>Hobor Peter</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Hobor Peter</td>
</tr>
<tr>
<td>56</td>
<td><u>M</u></td>
<td>Kaldau Szabolcs</td>
<td>HUN</td>
<td>MPRO</td>
<td>...</td>
<td>HUN</td>
<td><u>MPRO</u></td>
<td>Kaldau Szabolcs</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، لا يزال يبدو أن اسم المجموعة يصف جنس العضو بشكل صحيح. </font><font style="vertical-align: inherit;">استنادًا إلى العديد من أمثلة الأمثلة ، نفترض أن المجموعة مُشار إليها بشكل صحيح ، وقد يُشار إلى الجنس بشكل خاطئ. </font><font style="vertical-align: inherit;">ابحث عن جميع الإدخالات حيث لا يتطابق الحرف الأول في اسم المجموعة مع الجنس. </font><font style="vertical-align: inherit;">سنأخذ الاسم الأولي لمجموعة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المجموعة الخام</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حيث أنه خلال التوحيد القياسي تركت العديد من السجلات بدون مجموعة ، لكننا الآن بحاجة فقط إلى الحرف الأول ، لذا فإن المعيار ليس مهمًا.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'grflc'</span>] = ar[<span class="hljs-string">'group raw'</span>].str.upper().str[<span class="hljs-number">0</span>] <span class="hljs-comment">#grflc – group raw first letter capital</span>
grncs = ar[(ar[<span class="hljs-string">'grflc'</span>].isin([<span class="hljs-string">'M'</span>,<span class="hljs-string">'F'</span>]))&amp;(ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'grflc'</span>])] <span class="hljs-comment">#grncs – group raw not consistent with sex</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك 26 161 مثل هذه السجلات. </font><font style="vertical-align: inherit;">حسنًا ، دعنا نصحح الجنس وفقًا لاسم الفئة العمرية:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[grncs.index, <span class="hljs-string">'sex'</span>] = grncs[<span class="hljs-string">'grflc'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نلقي نظرة على النتيجة: </font><font style="vertical-align: inherit;">جيد. </font><font style="vertical-align: inherit;">كم عدد السجلات المتبقية الآن بدون جنس؟</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>59</td>
<td><u>F</u></td>
<td>Ueda Ai</td>
<td>JPN</td>
<td>FPRO</td>
<td>...</td>
<td>JPN</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>50</td>
<td><u>F</u></td>
<td>Zemanova Lenka</td>
<td>CZE</td>
<td>FPRO</td>
<td>...</td>
<td>CZE</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>83</td>
<td><u>F</u></td>
<td>Spearing Kyleigh</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>63</td>
<td><u>F</u></td>
<td>Abysova Irina</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>57</td>
<td><u>F</u></td>
<td>Knapp Anja</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>68</td>
<td><u>M</u></td>
<td>Matthews Andrew</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>46</td>
<td><u>F</u></td>
<td>Rappaport Summer</td>
<td>USA</td>
<td>FPRO</td>
<td>...</td>
<td>USA</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>60</td>
<td><u>F</u></td>
<td>Reid Aileen</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td><u>FPRO</u></td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>142</td>
<td><u>F</u></td>
<td>Mcdowall Edwina</td>
<td>GBR</td>
<td>F45-49</td>
<td>...</td>
<td>GBR</td>
<td><u>F45-49</u></td>
<td></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>141</td>
<td><u>M</u></td>
<td>O'Bray Luke</td>
<td>GBR</td>
<td>M30-34</td>
<td>...</td>
<td>GBR</td>
<td><u>M30-34</u></td>
<td></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[(ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">''</span>)&amp;(ar[<span class="hljs-string">'name'</span>] != <span class="hljs-string">''</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اتضح بالضبط واحد! </font><font style="vertical-align: inherit;">
حسنًا ، لم يتم تحديد المجموعة حقًا ، ولكن ، على ما يبدو ، هذه امرأة. Emily هو اسم أنثى ، إلى جانب هذه المشاركة (أو التي تحمل اسمها) التي انتهت قبل عام ، وفي هذا البروتوكول يشار إلى الجنس والمجموعة. </font><font style="vertical-align: inherit;">
قم بالاستعادة هنا يدويًا وانتقل.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>London Triathlon Olympic 2019</td>
<td>672</td>
<td></td>
<td>Stather Emily</td>
<td>GBR</td>
<td></td>
<td>...</td>
<td>GBR</td>
<td><u>unknown</u></td>
<td></td>
<td>U</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>Ironman Staffordshire 70.3 2018</td>
<td>1859</td>
<td><u>F</u></td>
<td>Stather Emily</td>
<td>GBR</td>
<td><u>F40-44</u></td>
<td>...</td>
<td>GBR</td>
<td>F40-44</td>
<td><u>F</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن جميع السجلات مع الجنس. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* بشكل عام ، بالطبع ، من الخطأ القيام بذلك - مع الجري المتكرر ، إذا تغير شيء ما في السلسلة من قبل ، على سبيل المثال ، في تحويل الاسم ، فقد يكون هناك أكثر من سجل واحد بدون جنس ، ولن يكون جميعهم من الإناث ، سيحدث خطأ. لذلك ، يجب عليك إما إدراج منطق ثقيل للبحث عن مشارك بنفس الاسم والجنس في البروتوكولات الأخرى ، مثل استعادة بلد ما ، واختباره بطريقة أو بأخرى ، أو حتى لا يعقد الأمر بشكل غير ضروري ، أضف إلى هذا المنطق التحقق من وجود سجل واحد فقط والاسم على هذا النحو ، أو خلاف ذلك ، من خلال استبعاد استثناء من شأنه إيقاف الكمبيوتر المحمول بأكمله ، يمكنك ملاحظة انحراف عن الخطة والتدخل.</font></font></i><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> len(arns) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> arns[<span class="hljs-string">'name'</span>].iloc[<span class="hljs-number">0</span>] == <span class="hljs-string">'Stather Emily'</span>:<font></font>
    ar.loc[arns.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">'Different scenario!'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يبدو أن هذا يمكن أن يهدأ. </font><font style="vertical-align: inherit;">لكن الحقيقة هي أن التصحيحات تستند إلى افتراض أن المجموعة يشار إليها بشكل صحيح. </font><font style="vertical-align: inherit;">وهو كذلك بالفعل. </font><font style="vertical-align: inherit;">تقريبا دائما. </font><font style="vertical-align: inherit;">تقريبا. </font><font style="vertical-align: inherit;">ومع ذلك ، تم ملاحظة العديد من التناقضات عن طريق الخطأ ، لذلك الآن دعونا نحاول تحديدها جميعًا ، جيدًا أو قدر الإمكان. </font><font style="vertical-align: inherit;">كما ذكرنا من قبل ، في المثال الأول ، كان على وجه التحديد حقيقة أن الجنس لا يتوافق مع الاسم على أساس أفكاره الخاصة حول أسماء الذكور والإناث التي تحرسنا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
البحث عن جميع الأسماء في سجلات الذكور والإناث. </font><font style="vertical-align: inherit;">هنا ، يُفهم الاسم على أنه الاسم ، وليس الاسم الكامل ، أي بدون اسم ، ما يسمى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم الأول</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> باللغة الإنجليزية </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'fn'</span>] = ar[<span class="hljs-string">'name'</span>].str.split().str[<span class="hljs-number">-1</span>] <span class="hljs-comment">#fn – first name</span>
mfn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#mfn – male first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتم سرد ما مجموعه 32508 أسماء الذكور. </font><font style="vertical-align: inherit;">فيما يلي أكثر 50 شركة شعبية:</font></font><br>
<code>['Michael', 'David', 'Thomas', 'John', 'Daniel', 'Mark', 'Peter', 'Paul', 'Christian', 'Robert', 'Martin', 'James', 'Andrew', 'Chris', 'Richard', 'Andreas', 'Matthew', 'Brian', 'Kevin', 'Patrick', 'Scott', 'Stefan', 'Jason', 'Eric', 'Alexander', 'Christopher', 'Simon', 'Mike', 'Tim', 'Frank', 'Stephen', 'Steve', 'Jonathan', 'Marco', 'Markus', 'Adam', 'Ryan', 'Tom', 'Jan', 'Marc', 'Carlos', 'Matt', 'Steven', 'Jeff', 'Sergey', 'William', 'Aleksandr', 'Andrey', 'Benjamin', 'Jose']<br>
</code><br>
<br>
<pre><code class="python hljs">ffn = list(ar[ar[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].unique()) <span class="hljs-comment">#ffn – female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عدد أقل من النساء - 14 423 الأكثر شيوعًا: </font><font style="vertical-align: inherit;">
جيد ، يبدو أنه يبدو منطقيًا. </font><font style="vertical-align: inherit;">دعونا نرى ما إذا كانت هناك تقاطعات.</font></font><br>
<code>['Jennifer', 'Sarah', 'Laura', 'Lisa', 'Anna', 'Michelle', 'Maria', 'Andrea', 'Nicole', 'Jessica', 'Julie', 'Elizabeth', 'Stephanie', 'Karen', 'Christine', 'Amy', 'Rebecca', 'Susan', 'Rachel', 'Anne', 'Heather', 'Kelly', 'Barbara', 'Claudia', 'Amanda', 'Sandra', 'Julia', 'Lauren', 'Melissa', 'Emma', 'Sara', 'Katie', 'Melanie', 'Kim', 'Caroline', 'Erin', 'Kate', 'Linda', 'Mary', 'Alexandra', 'Christina', 'Emily', 'Angela', 'Catherine', 'Claire', 'Elena', 'Patricia', 'Charlotte', 'Megan', 'Daniela']<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">mffn = set(mfn).intersection(ffn) <span class="hljs-comment">#mffn – male-female first names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد. </font><font style="vertical-align: inherit;">وهناك 2811 منهم دعنا ننظر إليهم عن كثب. </font><font style="vertical-align: inherit;">بادئ ذي بدء ، نجد عدد السجلات التي تحمل هذه الأسماء:</font></font><br>
<br>
<pre><code class="python hljs">armfn = ar[ar[<span class="hljs-string">'fn'</span>].isin(mffn)] <span class="hljs-comment">#armfn – all records with male-female names</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 725 562 هذا نصف! </font><font style="vertical-align: inherit;">انه رائع! </font><font style="vertical-align: inherit;">يوجد ما يقرب من 37000 اسم فريد ، ولكن نصف السجلات بها 2800 اسمًا. لنر ما هي هذه الأسماء ، وهي الأكثر شيوعًا. </font><font style="vertical-align: inherit;">للقيام بذلك ، قم بإنشاء إطار بيانات جديد حيث ستكون هذه الأسماء مؤشرات:</font></font><br>
<br>
<pre><code class="python hljs">df = pd.DataFrame(armfn[<span class="hljs-string">'fn'</span>].value_counts())<font></font>
df = df.rename(columns={<span class="hljs-string">'fn'</span>:<span class="hljs-string">'total'</span>})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحن نحسب عدد السجلات من الذكور والإناث مع كل منها.</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'M'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>][<span class="hljs-string">'fn'</span>].value_counts()<font></font>
df[<span class="hljs-string">'F'</span>] = armfn[armfn[<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>][<span class="hljs-string">'fn'</span>].value_counts()
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لذلك ... يبدو مريبا. </font><font style="vertical-align: inherit;">على حد علمي ، كل هذه الأسماء ذكورية. </font><font style="vertical-align: inherit;">ولكن مع كل واحد منهم هناك كمية صغيرة من السجلات النسائية. </font><font style="vertical-align: inherit;">ربما تكون هذه أخطاء بيانات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نلقي نظرة على أسماء الإناث.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values(by = <span class="hljs-string">'F'</span>, ascending=<span class="hljs-literal">False</span>)
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نفسه. تقريبا. تبرز </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أندريا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وهو بالفعل اسم مخنث ، وأقل بقليل من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ماريا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، لسبب ما. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الواقع ، لا تنس أننا نبحث عن بيانات من أشخاص من دول مختلفة جدًا ، يمكن للمرء أن يقول ، حول العالم. في الثقافات المختلفة ، يمكن استخدام نفس الاسم بطرق مختلفة تمامًا. هنا مثال. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كارين</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هي واحدة من أسماء الإناث الأكثر شعبية من قائمتنا ، ولكن من ناحية أخرى هناك اسم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كارين</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، والذي سيتم كتابته بالترجمة بنفس الطريقة ، ولكنه مخصص حصريًا للرجال. لحسن الحظ ، هناك حزمة تحملها كل هذه الحكمة العالمية. يطلق عليه اسم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تخمين الجنس</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يعمل مثل هذا:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> gender_guesser.detector <span class="hljs-keyword">as</span> gg<font></font>
<font></font>
d = gg.Detector()<font></font>
d.get_gender(<span class="hljs-string">u'Oleg'</span>)</code></pre><br>
<code><b>Out:</b> 'male'<br>
</code><br>
<br>
<pre><code class="python hljs">d.get_gender(<span class="hljs-string">u'Evgeniya'</span>)
</code></pre><br>
<code><b>Out:</b> 'female'<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كل شيء على ما يرام. </font><font style="vertical-align: inherit;">ولكن إذا تحققت من اسم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أندريا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، فإنه يعطي أيضًا </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أنثى</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وهذا ليس صحيحًا تمامًا. </font><font style="vertical-align: inherit;">صحيح ، هناك مخرج. </font><font style="vertical-align: inherit;">إذا نظرت إلى خاصية </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أسماء</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الكاشف ، فإن كل الغموض يصبح مرئيًا هناك.</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Andrea'</span>]
</code></pre><br>
<code><b>Out: </b>{'female': ' 4 4 3 4788 64 579 34 1 7 ',<br>
 'mostly_female': '5 6 7 ',<br>
 'male': ' 7 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نعم ، هذا هو ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_gender</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمنحك الخيار الأكثر احتمالًا ، ولكن في الواقع يمكن أن يكون أكثر تعقيدًا. </font><font style="vertical-align: inherit;">تحقق من الأسماء الأخرى:</font></font><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Maria'</span>]
</code></pre><br>
<code><b>Out:</b> {'female': '686 6 A 85986 A BA 3B98A75457 6 ',<br>
 'mostly_female': ' BBC A 678A9 '}<br>
</code><br>
<br>
<pre><code class="python hljs">d.names[<span class="hljs-string">'Oleg'</span>]
</code></pre><br>
<code><b>Out:</b> {'male': ' 6 2 99894737 3 '}<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أي أن قائمة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أسماء</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> كل اسم تقابل واحدًا أو أكثر من أزواج القيمة الرئيسية ، حيث المفتاح - هو الجنس: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ذكر ، أنثى ، معظمهم من الذكور ، معظمهم من الإناث ، وأندي ،</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> والقيمة - قائمة قيم البلد المقابل: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1،2،3 ... .. 9ABC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">البلدان هي:</font></font><br>
<br>
<pre><code class="python hljs">d.COUNTRIES</code></pre><br>
<code><b>Out:</b> ['great_britain', 'ireland', 'usa', 'italy', 'malta', 'portugal', 'spain', 'france', 'belgium', 'luxembourg', 'the_netherlands', 'east_frisia', 'germany', 'austria', 'swiss', 'iceland', 'denmark', 'norway', 'sweden', 'finland', 'estonia', 'latvia', 'lithuania', 'poland', 'czech_republic', 'slovakia', 'hungary', 'romania', 'bulgaria', 'bosniaand', 'croatia', 'kosovo', 'macedonia', 'montenegro', 'serbia', 'slovenia', 'albania', 'greece', 'russia', 'belarus', 'moldova', 'ukraine', 'armenia', 'azerbaijan', 'georgia', 'the_stans', 'turkey', 'arabia', 'israel', 'china', 'india', 'japan', 'korea', 'vietnam', 'other_countries']<br>
</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لم أفهم تمامًا ما تعنيه المعاني الأبجدية الرقمية أو غيابها في القائمة على وجه التحديد. </font><font style="vertical-align: inherit;">لكن هذا لم يكن مهمًا ، لأنني قررت أن أقتصر فقط على استخدام تلك الأسماء التي لها تفسير واضح. </font><font style="vertical-align: inherit;">أي أنه يوجد زوج واحد فقط من القيمة الرئيسية والمفتاح إما </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ذكر</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أو </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أنثى</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">لكل اسم من dataframe لدينا ، اكتب تفسيره لمحاكي </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجنس</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df.index:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'M'</span>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
            df.loc[n, <span class="hljs-string">'sex from gg'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تبين 1150 اسما. </font><font style="vertical-align: inherit;">فيما يلي الأكثر شيوعًا التي تمت مناقشتها أعلاه: </font><font style="vertical-align: inherit;">حسنًا ، ليس سيئًا. </font><font style="vertical-align: inherit;">الآن قم بتطبيق هذا المنطق على جميع السجلات.</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Michael</td>
<td>20648</td>
<td>20638</td>
<td>10</td>
<td>M</td>
</tr>
<tr>
<td>David</td>
<td>18493</td>
<td>18485</td>
<td>8</td>
<td>M</td>
</tr>
<tr>
<td>Thomas</td>
<td>12746</td>
<td>12740</td>
<td>6</td>
<td>M</td>
</tr>
<tr>
<td>John</td>
<td>11634</td>
<td>11632</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Daniel</td>
<td>11045</td>
<td>11041</td>
<td>4</td>
<td>M</td>
</tr>
<tr>
<td>Mark</td>
<td>10968</td>
<td>10965</td>
<td>3</td>
<td>M</td>
</tr>
<tr>
<td>Peter</td>
<td>10692</td>
<td>10691</td>
<td>1</td>
<td>M</td>
</tr>
<tr>
<td>Paul</td>
<td>9616</td>
<td>9614</td>
<td>2</td>
<td>M</td>
</tr>
<tr>
<td>Christian</td>
<td>8863</td>
<td>8859</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>Robert</td>
<td>8666</td>
<td>8664</td>
<td>2</td>
<td>M</td>
</tr>
</tbody></table></div></code><br>
 <code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>total</th>
<th>M</th>
<th>F</th>
<th>sex from gg</th>
</tr>
<tr>
<td>Jennifer</td>
<td>3652</td>
<td>3</td>
<td>3649</td>
<td>F</td>
</tr>
<tr>
<td>Sarah</td>
<td>3288</td>
<td>4</td>
<td>3284</td>
<td>F</td>
</tr>
<tr>
<td>Laura</td>
<td>2636</td>
<td>3</td>
<td>2633</td>
<td>F</td>
</tr>
<tr>
<td>Lisa</td>
<td>2618</td>
<td>2</td>
<td>2616</td>
<td>F</td>
</tr>
<tr>
<td>Anna</td>
<td>2563</td>
<td>10</td>
<td>2553</td>
<td>F</td>
</tr>
<tr>
<td>Michelle</td>
<td>2373</td>
<td>1</td>
<td>2372</td>
<td>F</td>
</tr>
<tr>
<td>Maria</td>
<td>2555</td>
<td>386</td>
<td>2169</td>
<td></td>
</tr>
<tr>
<td>Andrea</td>
<td>4323</td>
<td>2235</td>
<td>2088</td>
<td></td>
</tr>
<tr>
<td>Nicole</td>
<td>2025</td>
<td>6</td>
<td>2019</td>
<td>F</td>
</tr>
<tr>
<td>Julie</td>
<td>1938</td>
<td>2</td>
<td>1936</td>
<td></td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">all_names = ar[<span class="hljs-string">'fn'</span>].unique()<font></font>
<font></font>
male_names = []<font></font>
female_names = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> all_names:
    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> list(d.names.keys()):<font></font>
        options = list(d.names[n].keys())<font></font>
        <span class="hljs-keyword">if</span> len(options) == <span class="hljs-number">1</span>:
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'male'</span>:<font></font>
                male_names.append(n)<font></font>
            <span class="hljs-keyword">if</span> options[<span class="hljs-number">0</span>] == <span class="hljs-string">'female'</span>:<font></font>
                female_names.append(n)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
العثور على 7 091 أسماء ذكور و 0554 أنثى. </font><font style="vertical-align: inherit;">تطبيق التحول:</font></font><br>
<br>
<pre><code class="python hljs">tofixm = ar[ar[<span class="hljs-string">'fn'</span>].isin(male_names)]<font></font>
ar.loc[tofixm.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'M'</span>
tofixf = ar[ar[<span class="hljs-string">'fn'</span>].isin(female_names)]<font></font>
ar.loc[tofixf.index, <span class="hljs-string">'sex'</span>] = <span class="hljs-string">'F'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ننظر إلى النتيجة:</font></font><br>
<br>
<pre><code class="python hljs">ar[ar[<span class="hljs-string">'sex'</span>]!=ar[<span class="hljs-string">'sex raw'</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تصحيح إدخالات 30،352 (مع التصحيح باسم المجموعة). </font><font style="vertical-align: inherit;">كالعادة ، 10 عشوائية: </font><font style="vertical-align: inherit;">الآن بعد أن تأكدنا من أننا حددنا الجنس بشكل صحيح ، سنقوم أيضًا بجعل المجموعات القياسية في خط. </font><font style="vertical-align: inherit;">دعونا نرى أين لا تتطابق:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>...</th>
<th>country raw</th>
<th>group raw</th>
<th><u>sex raw</u></th>
<th>grflc</th>
</tr>
<tr>
<td>...</td>
<td>37</td>
<td><u>F</u></td>
<td>Pilz Christiane</td>
<td>DEU</td>
<td>FPRO</td>
<td>...</td>
<td>GER</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>92</td>
<td><u>F</u></td>
<td>Brault Sarah-Anne</td>
<td>CAN</td>
<td>FPRO</td>
<td>...</td>
<td>CAN</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>96</td>
<td><u>F</u></td>
<td>Murphy Susanna</td>
<td>IRL</td>
<td>FPRO</td>
<td>...</td>
<td>IRL</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>105</td>
<td><u>F</u></td>
<td>Spoelder Romy</td>
<td>NLD</td>
<td></td>
<td>...</td>
<td>NED</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>424</td>
<td><u>M</u></td>
<td>Watson Tom</td>
<td>GBR</td>
<td>M40-44</td>
<td>...</td>
<td>GBR</td>
<td>M40-44</td>
<td><u>F</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>81</td>
<td><u>F</u></td>
<td>Morel Charlotte</td>
<td>FRA</td>
<td></td>
<td>...</td>
<td>FRA</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>65</td>
<td><u>F</u></td>
<td>Selekhova Olga</td>
<td>RUS</td>
<td></td>
<td>...</td>
<td>RUS</td>
<td>FU23</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>166</td>
<td><u>F</u></td>
<td>Keat Rebekah</td>
<td>AUS</td>
<td></td>
<td>...</td>
<td>AUS</td>
<td>FJUNIOR</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>119</td>
<td><u>F</u></td>
<td>Eim Nina</td>
<td>DEU</td>
<td></td>
<td>...</td>
<td>GER</td>
<td>FQUAL…</td>
<td><u>M</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>73</td>
<td><u>F</u></td>
<td>Sukhoruchenkova Evgenia</td>
<td>RUS</td>
<td>FPRO</td>
<td>...</td>
<td>RUS</td>
<td>FPRO</td>
<td><u>M</u></td>
<td>F</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar[<span class="hljs-string">'gfl'</span>] = ar[<span class="hljs-string">'group'</span>].str[<span class="hljs-number">0</span>]<font></font>
gncws = ar[(ar[<span class="hljs-string">'sex'</span>] != ar[<span class="hljs-string">'gfl'</span>]) &amp; (ar[<span class="hljs-string">'group'</span>]!=<span class="hljs-string">''</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4،248 إدخالات. </font><font style="vertical-align: inherit;">يستبدل الحرف الأول:</font></font><br>
<br>
<pre><code class="python hljs">ar.loc[gncws.index, <span class="hljs-string">'group'</span>] = ar.loc[gncws.index, <span class="hljs-string">'sex'</span>] + ar.loc[gncws.index, <span class="hljs-string">'group'</span>].str[<span class="hljs-number">1</span>:].index, <span class="hljs-string">'sex'</span>]
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th><u>sex</u></th>
<th>name</th>
<th>country</th>
<th><u>group</u></th>
<th>...</th>
<th>country raw</th>
<th><u>group raw</u></th>
<th>sex raw</th>
</tr>
<tr>
<td>...</td>
<td>803</td>
<td><u>F</u></td>
<td>Kenney Joelle</td>
<td>USA</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>USA</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1432</td>
<td><u>M</u></td>
<td>Holmberg Henriette Gorm</td>
<td>DNK</td>
<td><u>M45-49</u></td>
<td>...</td>
<td>DEN</td>
<td><u>F45-49</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>503</td>
<td><u>M</u></td>
<td>Tai Oy Leen</td>
<td>MYS</td>
<td><u>M40-44</u></td>
<td>...</td>
<td>MAS</td>
<td><u>F40-44</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>236</td>
<td><u>F</u></td>
<td>Dissanayake Aruna</td>
<td>LKA</td>
<td><u>F25-29</u></td>
<td>...</td>
<td>SRI</td>
<td><u>M25-29</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1349</td>
<td><u>F</u></td>
<td>Delos Reyes Joshua Rafaelle</td>
<td>PHL</td>
<td><u>F18-24</u></td>
<td>...</td>
<td>PHI</td>
<td><u>M18-24</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>543</td>
<td><u>F</u></td>
<td>Vandekendelaere Janique</td>
<td>BEL</td>
<td><u>F50-54</u></td>
<td>...</td>
<td>BEL</td>
<td><u>M50-54</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1029</td>
<td><u>M</u></td>
<td>Provost Shaun</td>
<td>USA</td>
<td><u>M25-29</u></td>
<td>...</td>
<td>USA</td>
<td><u>F25-29</u></td>
<td>F</td>
</tr>
<tr>
<td>...</td>
<td>303</td>
<td><u>F</u></td>
<td>Torrens Vadell Macia</td>
<td>ESP</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>ESP</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>1338</td>
<td><u>F</u></td>
<td>Suarez Renan</td>
<td>BOL</td>
<td><u>F35-39</u></td>
<td>...</td>
<td>BOL</td>
<td><u>M35-39</u></td>
<td>M</td>
</tr>
<tr>
<td>...</td>
<td>502</td>
<td><u>F</u></td>
<td>Everlo Linda</td>
<td>NLD</td>
<td><u>F30-34</u></td>
<td>...</td>
<td>NED</td>
<td><u>M30-34</u></td>
<td>M</td>
</tr>
</tbody></table></div></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ربما ، في مكان ما اتضح أن التصحيحات غير صحيحة ، ولكن الجميع يعتقدون في وقت مبكر أنهم قاموا بعمل جيد أكثر من الأذى. </font><font style="vertical-align: inherit;">للإحصاءات ، هذا مهم. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا مع استعادة الجنس. </font><font style="vertical-align: inherit;">نقوم بحذف أعمدة العمل ، وترجمتها إلى القاموس وحفظها.</font></font><br>
<br>
<pre><code class="python hljs">pkl.dump(rd, open(<span class="hljs-string">r'D:\tri\details8.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا كل شيء ، مع استعادة البيانات غير المكتملة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تحديث النشرة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يبقى تحديث الجدول الموجز ببيانات محدثة حول عدد الرجال والنساء ، إلخ. </font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'total raw'</span>] = rs[<span class="hljs-string">'total'</span>]<font></font>
rs[<span class="hljs-string">'males raw'</span>] = rs[<span class="hljs-string">'males'</span>]<font></font>
rs[<span class="hljs-string">'females raw'</span>] = rs[<span class="hljs-string">'females'</span>]<font></font>
rs[<span class="hljs-string">'rus raw'</span>] = rs[<span class="hljs-string">'rus'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rs.index:<font></font>
    e = rs.loc[i,<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[i,<span class="hljs-string">'total'</span>] = len(rd[e])<font></font>
    rs.loc[i,<span class="hljs-string">'males'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'M'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'females'</span>] = len(rd[e][rd[e][<span class="hljs-string">'sex'</span>] == <span class="hljs-string">'F'</span>])<font></font>
    rs.loc[i,<span class="hljs-string">'rus'</span>] = len(rd[e][rd[e][<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>])<font></font>
<font></font>
len(rs[rs[<span class="hljs-string">'total'</span>] != rs[<span class="hljs-string">'total raw'</span>]])</code></pre><br>
<code><b>Out:</b> 288<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'males'</span>] != rs[<span class="hljs-string">'males raw'</span>]])
</code></pre><br>
<code><b>Out:</b>962<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'females'</span>] != rs[<span class="hljs-string">'females raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 836<br>
</code><br>
<br>
<pre><code class="python hljs">len(rs[rs[<span class="hljs-string">'rus'</span>] != rs[<span class="hljs-string">'rus raw'</span>]])
</code></pre><br>
<code><b>Out:</b> 8<br>
</code><br>
<br>
<pre><code class="python hljs">pkl.dump(rs, open(<span class="hljs-string">r'D:\tri\summary6.pkl'</span>, <span class="hljs-string">'wb'</span>))
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجزء 4. أخذ العينات</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن الترياتلون تحظى بشعبية كبيرة. </font><font style="vertical-align: inherit;">خلال الموسم ، هناك العديد من المسابقات المفتوحة التي يشارك فيها عدد كبير من الرياضيين ، وخاصة الهواة. </font><font style="vertical-align: inherit;">ولكنها لم تكن كذلك دائما. </font><font style="vertical-align: inherit;">هناك سجلات في بياناتنا منذ عام 1990. </font><font style="vertical-align: inherit;">بالتمرير عبر tristats.ru ، لاحظت أن هناك المزيد من السباقات في السنوات الأخيرة ، وعدد قليل جدًا في الأول. </font><font style="vertical-align: inherit;">ولكن الآن بعد أن تم إعداد بياناتنا ، يمكنك الاطلاع عليها عن كثب.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فترة عشر سنوات</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
احسب عدد السباقات والانهاءات في كل عام:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'year'</span>] = pd.DatetimeIndex(rs[<span class="hljs-string">'date'</span>]).year<font></font>
years = range(rs[<span class="hljs-string">'year'</span>].min(),rs[<span class="hljs-string">'year'</span>].max())<font></font>
rsy = pd.DataFrame(columns = [<span class="hljs-string">'races'</span>, <span class="hljs-string">'finishers'</span>, <span class="hljs-string">'rus'</span>, <span class="hljs-string">'RUS'</span>], index = years) <span class="hljs-comment">#rsy – races summary by year</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> rsy.index:<font></font>
    rsy.loc[y,<span class="hljs-string">'races'</span>] = len(rs[rs[<span class="hljs-string">'year'</span>] == y])<font></font>
    rsy.loc[y,<span class="hljs-string">'finishers'</span>] = sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'total'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'rus'</span>] =  sum(rs[rs[<span class="hljs-string">'year'</span>] == y][<span class="hljs-string">'rus'</span>])<font></font>
    rsy.loc[y,<span class="hljs-string">'RUS'</span>] = len(rs[(rs[<span class="hljs-string">'year'</span>] == y)&amp;(rs[<span class="hljs-string">'country'</span>] == <span class="hljs-string">'RUS'</span>)])
</code></pre><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>year</th>
<th>races</th>
<th>finishers</th>
<th>rus</th>
<th>RUS</th>
</tr>
<tr>
<td>1990</td>
<td>1</td>
<td>286</td>
<td>5</td>
<td>0</td>
</tr>
<tr>
<td>1991</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1992</td>
<td>1</td>
<td>317</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1993</td>
<td>2</td>
<td>887</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1994</td>
<td>2</td>
<td>128</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>1995</td>
<td>3</td>
<td>731</td>
<td>7</td>
<td>0</td>
</tr>
<tr>
<td>1996</td>
<td>3</td>
<td>776</td>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>1997</td>
<td>3</td>
<td>403</td>
<td>11</td>
<td>0</td>
</tr>
<tr>
<td>1998</td>
<td>4</td>
<td>583</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>1999</td>
<td>10</td>
<td>1106</td>
<td>26</td>
<td>0</td>
</tr>
<tr>
<td>2000</td>
<td>10</td>
<td>1231</td>
<td>29</td>
<td>0</td>
</tr>
<tr>
<td>2001</td>
<td>11</td>
<td>1992</td>
<td>32</td>
<td>0</td>
</tr>
<tr>
<td>2002</td>
<td>21</td>
<td>2249</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>2003</td>
<td>30</td>
<td>3152</td>
<td>158</td>
<td>0</td>
</tr>
<tr>
<td>2004</td>
<td>19</td>
<td>5488</td>
<td>128</td>
<td>1</td>
</tr>
<tr>
<td>2005</td>
<td>16</td>
<td>3024</td>
<td>244</td>
<td>1</td>
</tr>
<tr>
<td>2006</td>
<td>29</td>
<td>6210</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2007</td>
<td>44</td>
<td>12153</td>
<td>444</td>
<td>1</td>
</tr>
<tr>
<td>2008</td>
<td>43</td>
<td>13830</td>
<td>369</td>
<td>1</td>
</tr>
<tr>
<td>2009</td>
<td>49</td>
<td>27047</td>
<td>478</td>
<td>1</td>
</tr>
<tr>
<td>2010</td>
<td>47</td>
<td>26528</td>
<td>366</td>
<td>1</td>
</tr>
<tr>
<td>2011</td>
<td>77</td>
<td>45412</td>
<td>848</td>
<td>5</td>
</tr>
<tr>
<td>2012</td>
<td>96</td>
<td>75590</td>
<td>1055</td>
<td>4</td>
</tr>
<tr>
<td>2013</td>
<td>98</td>
<td>86617</td>
<td>2165</td>
<td>9</td>
</tr>
<tr>
<td>2014</td>
<td>135</td>
<td>138018</td>
<td>3188</td>
<td>11</td>
</tr>
<tr>
<td>2015</td>
<td>164</td>
<td>172375</td>
<td>4846</td>
<td>15</td>
</tr>
<tr>
<td>2016</td>
<td>192</td>
<td>178630</td>
<td>7541</td>
<td>27</td>
</tr>
<tr>
<td>2017</td>
<td>238</td>
<td>185473</td>
<td>8825</td>
<td>42</td>
</tr>
<tr>
<td>2018</td>
<td>278</td>
<td>203031</td>
<td>10954</td>
<td>54</td>
</tr>
<tr>
<td>2019</td>
<td>293</td>
<td>220901</td>
<td>13354</td>
<td>59</td>
</tr>
</tbody></table></div></code><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RUS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - سباق في روسيا. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">روس</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - اللمسات الأخيرة من روسيا. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك ما يبدو عليه على الرسم البياني:</font></font><br>
<img src="https://habrastorage.org/webt/nx/yg/4s/nxyg4syvd0x-0f16nxl1ucvhyma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن ملاحظة أن عدد السباقات والمشاركين في بداية الفترة وفي النهاية هو ببساطة لا يقاس. تبدأ الزيادة الكبيرة في إجمالي عدد السباقات في عام 2011 ، بينما يزداد عدد السباقات في روسيا أيضًا. علاوة على ذلك ، يمكن ملاحظة زيادة في عدد المشاركين في عام 2009. قد يشير هذا إلى زيادة الاهتمام بين المشاركين ، أي زيادة الطلب ، وبعد ذلك بعامين زاد العرض ، أي عدد مرات البدء. ومع ذلك ، لا تنس أن البيانات قد لا تكون كاملة وبعضها ، وربما العديد من السباقات مفقودة. بما في ذلك حقيقة أن مشروع جمع هذه البيانات بدأ فقط في عام 2010 ، والذي يمكن أن يفسر أيضًا قفزة كبيرة في الرسم البياني في هذه اللحظة بالذات. بما في ذلك ، لمزيد من التحليل ، قررت أن يستغرق السنوات العشر الماضية. هذه فترة طويلة إلى حد ما ،من أجل تتبع أي اتجاهات على مدى عدة سنوات ، في حين أنها قصيرة بما يكفي لعدم الوصول إلى هناك ، بشكل رئيسي المسابقات المهنية من 90s وأوائل 2000s.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'year'</span>]&gt;=<span class="hljs-number">2010</span>)&amp;(rs[<span class="hljs-string">'year'</span>]&lt;= <span class="hljs-number">2019</span>)]
</code></pre><br>
<img src="https://habrastorage.org/webt/ck/p4/qf/ckp4qfjucrjhl7kvu-0fyv_ilbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالمناسبة ، انخفض 84٪ من السباقات و 94٪ من الإنهاءات خلال الفترة المحددة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يبدأ الهواة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، فإن الغالبية العظمى من المشاركين في البداية المختارة هم رياضيون هواة ، لذا يمكن الحصول على إحصائيات جيدة منهم. بصراحة ، كان هذا الأمر محل اهتمام رئيسي بالنسبة لي ، لأنني أشارك في مثل هذه البدايات ، ولكن في المستوى بعيدًا جدًا عن أبطال الألعاب الأولمبية. ومع ذلك ، من الواضح أن المسابقات المهنية جرت أيضًا في الفترة المختارة. لكي لا يتم مزج مؤشرات سباقات الهواة والمحترفين ، تقرر حذف هذا الأخير من الاعتبار. كيفية التعرف عليهم؟ بالسرعة. نحسبها. في إحدى المراحل الأولية لإعداد البيانات ، حددنا بالفعل نوع المسافة التي كانت في كل سباق - العدو ، الأولمبي ، النصف ، الحديد. لكل واحد منهم ، تم تحديد المسافة المقطوعة للمراحل بوضوح - السباحة وركوب الدراجات والجري. هذا هو 0.75 + 20 + 5 للسباق ، 1.5 + 40 + 10 للأولمبياد ، 1.9 + 90 + 21.1 للنصف و 3.8 + 180 + 42.2 للحديد. بالطبع ، في الواقع ، بالنسبة لأي نوع ، يمكن أن تختلف الأرقام الحقيقية من سباق إلى آخر مشروطًا بنسبة تصل إلى واحد بالمائة ، ولكن لا توجد معلومات حول هذا ، لذلك سنفترض أن كل شيء كان دقيقًا.</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'km'</span>] = <span class="hljs-string">''</span><font></font>
<font></font>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'sprint'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">0.75</span>+<span class="hljs-number">20</span>+<span class="hljs-number">5</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'olympic'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.5</span>+<span class="hljs-number">40</span>+<span class="hljs-number">10</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'half'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">1.9</span>+<span class="hljs-number">90</span>+<span class="hljs-number">21.1</span>
rs.loc[rs[<span class="hljs-string">'dist'</span>] == <span class="hljs-string">'full'</span>, <span class="hljs-string">'km'</span>] = <span class="hljs-number">3.8</span>+<span class="hljs-number">180</span>+<span class="hljs-number">42.2</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحسب متوسط ​​السرعات القصوى لكل سباق. </font><font style="vertical-align: inherit;">الحد الأقصى هنا يشير إلى متوسط ​​سرعة الرياضي الذي فاز بالمركز الأول.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'th'</span>] = pd.TimedeltaIndex(rd[e][<span class="hljs-string">'result'</span>]).seconds/<span class="hljs-number">3600</span>
    rd[e][<span class="hljs-string">'v'</span>] = rs.loc[i, <span class="hljs-string">'km'</span>] / rd[e][<span class="hljs-string">'th'</span>]<font></font>
<font></font>
<span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rs.loc[index,<span class="hljs-string">'vmax'</span>] = rd[e][<span class="hljs-string">'v'</span>].max()<font></font>
    rs.loc[index,<span class="hljs-string">'vavg'</span>] = rd[e][<span class="hljs-string">'v'</span>].mean()
</code></pre><br>
<img src="https://habrastorage.org/webt/81/6k/pe/816kpel94nzs-hsp9dphfdhtq3g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، يمكنك أن ترى أن معظم السرعات التي تم تجميعها في أكوام ما بين حوالي 15 كم / ساعة و 30 كم / ساعة ، ولكن هناك عدد معين من القيم "الكونية" تمامًا. </font><font style="vertical-align: inherit;">فرز حسب متوسط ​​السرعة ونرى كم منهم:</font></font><br>
<br>
<pre><code class="python hljs">rs = rs.sort_values(by=<span class="hljs-string">'vavg'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/aa/wi/ws/aawiwsx0kcmhzyq3y3ezcm_fy0o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هنا قمنا بتغيير المقياس ويمكننا تقدير النطاق بشكل أكثر دقة. بالنسبة للسرعات المتوسطة ، فهي تتراوح من حوالي 17 كم / ساعة إلى 27 كم / ساعة ، كحد أقصى - من 18 كم / ساعة إلى 32 كم / ساعة. بالإضافة إلى وجود "ذيول" بسرعات منخفضة جدًا وعالية جدًا. من المحتمل أن تتوافق السرعات المنخفضة مع المنافسات الشديدة مثل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norseman</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ويمكن أن تكون </font><font style="vertical-align: inherit;">السرعات </font><font style="vertical-align: inherit;">العالية في حالة السباحة الملغاة ، حيث كان هناك عداء سريع ، أو ببساطة بيانات خاطئة. نقطة أخرى مهمة هي الخطوة السلسة في منطقة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1200</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> على طول المحور </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، وقيم أعلى لمتوسط ​​السرعة بعده. </font><font style="vertical-align: inherit;">هناك يمكنك أن ترى اختلافًا أقل بكثير بين المتوسط ​​والسرعة القصوى مقارنة بالثلثي الأول من الرسم البياني. </font><font style="vertical-align: inherit;">على ما يبدو ، هذه منافسة مهنية. </font><font style="vertical-align: inherit;">لتمييزها بشكل أكثر وضوحًا ، نحسب نسبة السرعة القصوى إلى المتوسط. </font><font style="vertical-align: inherit;">في المسابقات المهنية حيث لا يوجد أشخاص عشوائيين ولدى جميع المشاركين مستوى عالٍ جدًا من اللياقة البدنية ، يجب أن تكون هذه النسبة ضئيلة.</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'vmdbva'</span>] = rs[<span class="hljs-string">'vmax'</span>]/rs[<span class="hljs-string">'vavg'</span>] <span class="hljs-comment">#vmdbva - v max divided by v avg</span>
rs = rs.sort_values(by=<span class="hljs-string">'vmdbva'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/li/cv/pr/licvprwpcx3zlws5pjufo0dxhcm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
على هذا الرسم البياني ، يبرز الربع الأول بوضوح شديد: نسبة السرعة القصوى إلى المتوسط ​​صغيرة ، متوسط ​​السرعة العالية ، عدد قليل من المشاركين. </font><font style="vertical-align: inherit;">هذه مسابقة مهنية. </font><font style="vertical-align: inherit;">الخطوة على المنحنى الأخضر في مكان ما حول 1.2. </font><font style="vertical-align: inherit;">سنترك السجلات فقط مع نسبة نسبة أكبر من 1.2 في عينتنا.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[rs[<span class="hljs-string">'vmdbva'</span>] &gt; <span class="hljs-number">1.2</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نقوم أيضًا بإزالة السجلات بسرعات منخفضة وعالية غير معتادة. </font><font style="vertical-align: inherit;">في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ما هي "الأرقام القياسية" العالمية الثلاثية لكل مسافة؟ </font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نشر أوقات قياسية لتمرير مسافات مختلفة لعام 2019. </font><font style="vertical-align: inherit;">إذا كنت تحسبها بسرعات متوسطة ، يمكنك أن ترى أنه لا يمكن أن يكون أعلى من 33 كم / ساعة حتى الأسرع. </font><font style="vertical-align: inherit;">لذلك سنأخذ في الاعتبار البروتوكولات التي تكون فيها متوسط ​​السرعات أعلى ، غير صالحة ، وإزالتها من الاعتبار.</font></font><br>
<br>
<pre><code class="python hljs">rs = rs[(rs[<span class="hljs-string">'vavg'</span>] &gt; <span class="hljs-number">17</span>)&amp;(rs[<span class="hljs-string">'vmax'</span>] &lt; <span class="hljs-number">33</span>)]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك ما تبقى: </font></font><br>
<img src="https://habrastorage.org/webt/t1/dk/_p/t1dk_pixaznwxlfsunkxpx5yfum.png"><br>
<img src="https://habrastorage.org/webt/qk/9u/4a/qk9u4anxmpnwehsdhckfn64ucvw.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن كل شيء يبدو متجانسًا تمامًا ولا يثير أسئلة. </font><font style="vertical-align: inherit;">نتيجة لكل هذا التحديد ، فقدنا 777 من بروتوكولات 1922 ، أو 40٪. </font><font style="vertical-align: inherit;">في الوقت نفسه ، لم ينخفض ​​إجمالي عدد اللمسات النهائية كثيرًا - فقط 13 ٪. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، هناك 1145 سباقا متبقيا مع 1،231،772 نهائي. </font><font style="vertical-align: inherit;">أصبحت هذه العينة مادة لتحليلي وتصوري.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجزء 5. التحليل والتصور</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذا العمل ، كان التحليل والتصور الصحيح أبسط الأجزاء. </font><font style="vertical-align: inherit;">رأس جبل الجليد ، والذي كان الجزء تحت الماء هو مجرد إعداد البيانات. </font><font style="vertical-align: inherit;">كان التحليل ، في الواقع ، عملية حسابية بسيطة على </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سلسلة الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وحساب المتوسطات ، والتصفية - كل هذا يتم عن طريق أدوات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الابتدائية </font><i><font style="vertical-align: inherit;">والشفرة</font></i><font style="vertical-align: inherit;"> أعلاه مليئة بالأمثلة. </font><font style="vertical-align: inherit;">في المقابل ، تم عمل التصور بشكل أساسي باستخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الأكثر </font><i><font style="vertical-align: inherit;">القياسية</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">تستخدم </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مؤامرة ، بار ، فطيرة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ولكن في بعض الأماكن ، كان عليّ أن العبث بتوقيعات المحاور ، في حالة التواريخ والرسوم التوضيحية ، ولكن هذا ليس شيئًا يعتمد على وصف مفصل هنا. </font><font style="vertical-align: inherit;">الشيء الوحيد الذي يستحق الحديث عنه هو عرض البيانات الجغرافية. </font><font style="vertical-align: inherit;">على الأقل ليس كذلك</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ماتبلوتليب</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">البيانات الجغرافية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لكل سباق لدينا معلومات حول المكان. </font><font style="vertical-align: inherit;">في البداية ، باستخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geopy ،</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> قمنا بحساب الإحداثيات لكل موقع. </font><font style="vertical-align: inherit;">تقام العديد من السباقات سنويا في نفس المكان. </font><font style="vertical-align: inherit;">
أداة سهلة الاستخدام للغاية لعرض البيانات الجغرافية في </font><i><font style="vertical-align: inherit;">الثعبان</font></i><font style="vertical-align: inherit;"> هي </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;">folium</font></i></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">وإليك كيف يعمل:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>event</th>
<th>date</th>
<th>country</th>
<th><u>latitude</u></th>
<th><u>longitude</u></th>
<th>loc</th>
<th>…</th>
</tr>
<tr>
<td>0</td>
<td>Ironman Indian Wells La Quinta 70.3 2019</td>
<td>2019-12-08</td>
<td>USA</td>
<td><u>33.7238</u></td>
<td><u>-116.305</u></td>
<td>Indian Wells/La Quinta, California, USA</td>
<td>…</td>
</tr>
<tr>
<td>1</td>
<td>Ironman Taupo 70.3 2019</td>
<td>2019-12-07</td>
<td>NZL</td>
<td><u>-41.5001</u></td>
<td><u>172.834</u></td>
<td>New Zealand</td>
<td>…</td>
</tr>
<tr>
<td>2</td>
<td>Ironman Western Australia 2019</td>
<td>2019-12-01</td>
<td>AUS</td>
<td><u>-33.6445</u></td>
<td><u>115.349</u></td>
<td>Busselton, Western Australia</td>
<td>…</td>
</tr>
<tr>
<td>3</td>
<td>Ironman Mar del Plata 2019</td>
<td>2019-12-01</td>
<td>ARG</td>
<td><u>-37.9977</u></td>
<td><u>-57.5483</u></td>
<td>Mar del Plata, Argentina</td>
<td>…</td>
</tr>
<tr>
<td>4</td>
<td>Ironman Cozumel 2019</td>
<td>2019-11-24</td>
<td>MEX</td>
<td><u>20.4318</u></td>
<td><u>-86.9203</u></td>
<td>Cozumel, Mexico</td>
<td>…</td>
</tr>
<tr>
<td>5</td>
<td>Ironman Arizona 2019</td>
<td>2019-11-24</td>
<td>USA</td>
<td><u>33.4255</u></td>
<td><u>-111.94</u></td>
<td>Tempe, Arizona, USA</td>
<td>…</td>
</tr>
<tr>
<td>6</td>
<td>Ironman Xiamen 70.3 2019</td>
<td>2019-11-10</td>
<td>CHN</td>
<td><u>24.4758</u></td>
<td><u>118.075</u></td>
<td>Xiamen, China</td>
<td>…</td>
</tr>
<tr>
<td>7</td>
<td>Ironman Turkey 70.3 2019</td>
<td>2019-11-03</td>
<td>TUR</td>
<td><u>36.8633</u></td>
<td><u>31.0578</u></td>
<td>Belek, Antalya, Turkey</td>
<td>…</td>
</tr>
<tr>
<td>8</td>
<td>Ironman Florida 2019</td>
<td>2019-11-02</td>
<td>USA</td>
<td><u>30.1766</u></td>
<td><u>-85.8055</u></td>
<td>Panama City Beach, Florida, USA</td>
<td>…</td>
</tr>
<tr>
<td>9</td>
<td>Ironman Marrakech 70.3 2019</td>
<td>2019-10-27</td>
<td>MAR</td>
<td><u>31.6258</u></td>
<td><u>-7.98916</u></td>
<td>Marrakech, Morocco</td>
<td>…</td>
</tr>
<tr>
<td>10</td>
<td>Ironman Waco 70.3 2019</td>
<td>2019-10-27</td>
<td>USA</td>
<td><u>31.5493</u></td>
<td><u>-97.1467</u></td>
<td>Waco, Texas, USA</td>
<td>…</td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"></font></i></a><font style="vertical-align: inherit;"></font><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> folium<font></font>
<font></font>
m = folium.Map() <font></font>
folium.Marker([<span class="hljs-string">'55.7522200'</span>, <span class="hljs-string">'37.6155600'</span>], popup=<span class="hljs-string">''</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ونحصل على خريطة تفاعلية مباشرة في كمبيوتر محمول المشتري. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/hp/fs/jchpfspvaahnnbvwtgwx2wqkppu.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، لبياناتنا. </font><font style="vertical-align: inherit;">أولاً ، سنبدأ عمودًا جديدًا من مجموعة إحداثياتنا:</font></font><br>
<br>
<pre><code class="python hljs">rs[<span class="hljs-string">'coords'</span>] = rs[<span class="hljs-string">'latitude'</span>].astype(str) + <span class="hljs-string">', '</span> + rs[<span class="hljs-string">'longitude'</span>].astype(str)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إحداثيات فريدة من </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">احداثيات</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هي 291. ومواقع فريدة من نوعها </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في الموضع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هم 324، مما يعني أن بعض الأسماء مختلفة قليلا، بينما في الوقت نفسه أنها تتوافق مع نفس النقطة. </font><font style="vertical-align: inherit;">هذا ليس مخيفًا ، سننظر في التفرد من خلال </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الحبال</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">نحن نحسب عدد الأحداث التي مرت طوال الوقت في كل موقع (بإحداثيات فريدة):</font></font><br>
<br>
<pre><code class="python hljs">vc = rs[<span class="hljs-string">'coords'</span>].value_counts()<font></font>
<font></font>
vc</code></pre><br>
<code><b>Out:</b><br>
43.7009358, 7.2683912 22<br>
43.5854823, 39.723109 20<br>
29.03970805, -13.636291 16<br>
47.3723941, 8.5423328 16<br>
59.3110918, 24.420907 15<br>
51.0834196, 10.4234469 15<br>
54.7585694, 38.8818137 14<br>
20.4317585, -86.9202745 13<br>
52.3727598, 4.8936041 12<br>
41.6132925, 2.6576102 12<br>
... ...<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن قم بإنشاء خريطة ، وإضافة علامات عليها في شكل دوائر ، والتي يعتمد نصف قطرها على عدد الأحداث التي تقام على الموقع. </font><font style="vertical-align: inherit;">أضف علامات باسم الموقع إلى العلامات.</font></font><br>
<br>
<pre><code class="python hljs">m = folium.Map(location=[<span class="hljs-number">25</span>,<span class="hljs-number">10</span>], zoom_start=<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> rs[<span class="hljs-string">'coords'</span>].unique():<font></font>
    row = [r[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> rs.iterrows() <span class="hljs-keyword">if</span> r[<span class="hljs-number">1</span>][<span class="hljs-string">'coords'</span>] == c][<span class="hljs-number">0</span>]    <font></font>
    folium.Circle([row[<span class="hljs-string">'latitude'</span>], row[<span class="hljs-string">'longitude'</span>]], <font></font>
					popup=(row[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'\n('</span>+str(vc[c])+<span class="hljs-string">' races)'</span>), <font></font>
					radius = <span class="hljs-number">10000</span>*int(vc[c]), <font></font>
					color=<span class="hljs-string">'darkorange'</span>, <font></font>
					fill=<span class="hljs-literal">True</span>, <font></font>
					stroke=<span class="hljs-literal">True</span>, <font></font>
					weight=<span class="hljs-number">1</span>).add_to(m)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
منجز. </font><font style="vertical-align: inherit;">يمكنك رؤية النتيجة:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ch/d4/gj/chd4gj0qbyjrzyjikpmslgesw0i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تقدم المشاركين</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الواقع ، بالإضافة إلى التوجيه ، كان العمل على جدول زمني آخر غير تافه أيضًا. هذا هو أحدث رسم بياني لتقدم المشاركين. ها هي: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/rf/ca/jq/rfcajquw4qluhsw9wuhicbgk7rm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعنا نحللها ، وفي نفس الوقت سأعطي كود العرض ، كمثال على استخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs">fig = plt.figure()<font></font>
fig.set_size_inches(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>)<font></font>
<font></font>
ax = fig.add_axes([<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>])<font></font>
<font></font>
b = ax.bar(exp,numrecs, color = <span class="hljs-string">'navajowhite'</span>)<font></font>
<font></font>
ax1 = ax.twinx()<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)<font></font>
	<font></font>
p, = ax1.plot(exp, vpm, <span class="hljs-string">'o-'</span>,markersize=<span class="hljs-number">8</span>, linewidth=<span class="hljs-number">2</span>, color=<span class="hljs-string">'C0'</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp)):
    <span class="hljs-keyword">if</span> i &lt; len(exp)<span class="hljs-number">-1</span> <span class="hljs-keyword">and</span> (vpm[i] &lt; vpm[i+<span class="hljs-number">1</span>]):<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]<span class="hljs-number">-0.2</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        ax1.text(x = exp[i]+<span class="hljs-number">0.1</span>, y = vpm[i]+<span class="hljs-number">0.1</span>, s = <span class="hljs-string">'{0:3.1f}%'</span>.format(vpm[i]),size=<span class="hljs-number">12</span>)<font></font>
<font></font>
ax.legend((b,p), (<span class="hljs-string">' '</span>, <span class="hljs-string">''</span>),loc=<span class="hljs-string">'center right'</span>)<font></font>
ax.set_xlabel(<span class="hljs-string">'   '</span>)<font></font>
ax.set_ylabel(<span class="hljs-string">''</span>)<font></font>
ax1.set_ylabel(<span class="hljs-string">'%     '</span>)<font></font>
ax.set_xticks(np.arange(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>, step=<span class="hljs-number">1</span>))<font></font>
ax.set_yticks(np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">230000</span>, step=<span class="hljs-number">25000</span>))<font></font>
ax1.set_ylim(<span class="hljs-number">97.5</span>,<span class="hljs-number">103.5</span>)<font></font>
ax.yaxis.set_label_position(<span class="hljs-string">"right"</span>)<font></font>
ax.yaxis.tick_right()<font></font>
ax1.yaxis.set_label_position(<span class="hljs-string">"left"</span>)<font></font>
ax1.yaxis.tick_left()      <font></font>
<font></font>
plt.show()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن حول كيفية حساب البيانات له. </font><font style="vertical-align: inherit;">أولاً ، كان عليك اختيار أسماء المشاركين الذين أنهوا على الأقل في سباقين ، وفي سنوات تقويمية مختلفة ، وفي الوقت نفسه ليسوا محترفين. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أولاً ، لكل بروتوكول ، املأ عمودًا جديدًا يسمى </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التاريخ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، والذي سيشير إلى تاريخ السباق. </font><font style="vertical-align: inherit;">وسوف نحتاج أيضا بعد عام من هذا التاريخ، وسوف نبذل عمود </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العام</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">نظرًا لأننا سنقوم بتحليل سرعة كل رياضي بالنسبة لمتوسط ​​السرعة في السباق ، فإننا نحسب هذه السرعة على الفور في العمود الجديد </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vproc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - السرعة كنسبة مئوية من المتوسط.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> index, row <span class="hljs-keyword">in</span> rs.iterrows():<font></font>
    e = row[<span class="hljs-string">'event'</span>]<font></font>
    rd[e][<span class="hljs-string">'date'</span>] = row[<span class="hljs-string">'date'</span>]<font></font>
    rd[e][<span class="hljs-string">'year'</span>] = row[<span class="hljs-string">'year'</span>]<font></font>
    rd[e][<span class="hljs-string">'vproc'</span>] = <span class="hljs-number">100</span> * rd[e][<span class="hljs-string">'v'</span>] / rd[e][<span class="hljs-string">'v'</span>].mean()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إليك ما تبدو عليه البروتوكولات الآن: </font><font style="vertical-align: inherit;">
بعد ذلك ، اجمع جميع البروتوكولات في إطار بيانات واحد.</font></font><br>
<code>'   Sprint 2019'</code><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>...</th>
<th>th</th>
<th>v</th>
<th><u>date</u></th>
<th><u>year</u></th>
<th><u>vproc</u></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>M</td>
<td>Shalev Aleksey</td>
<td>RUS</td>
<td>...</td>
<td>1.161944</td>
<td>22.161128</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>130.666668</u></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>M</td>
<td>Nikolaev Artem</td>
<td>RUS</td>
<td>...</td>
<td>1.228611</td>
<td>20.958625</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>123.576458</u></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>M</td>
<td>Kuchierskiy Aleksandr</td>
<td>RUS</td>
<td>...</td>
<td>1.255556</td>
<td>20.508850</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>120.924485</u></td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>F</td>
<td>Korchagina Mariya</td>
<td>RUS</td>
<td>...</td>
<td>1.297222</td>
<td>19.850107</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>117.040401</u></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>M</td>
<td>Solodov Ivan</td>
<td>RUS</td>
<td>...</td>
<td>1.298056</td>
<td>19.837364</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.965263</u></td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>M</td>
<td>Bukin Sergey</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>6</td>
<td>7</td>
<td>M</td>
<td>Lavrentev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.300278</td>
<td>19.803461</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>116.765365</u></td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>M</td>
<td>Dolgov Petr</td>
<td>RUS</td>
<td>...</td>
<td>1.321667</td>
<td>19.482976</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>114.875719</u></td>
</tr>
<tr>
<td>8</td>
<td>9</td>
<td>M</td>
<td>Bezruchenko Mikhailn</td>
<td>RUS</td>
<td>...</td>
<td>1.345000</td>
<td>19.144981</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>112.882832</u></td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>M</td>
<td>Ryazantsev Dmitriy</td>
<td>RUS</td>
<td>...</td>
<td>1.359444</td>
<td>18.941561</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>111.683423</u></td>
</tr>
<tr>
<td>10</td>
<td>11</td>
<td>M</td>
<td>Ibragimov Ramil</td>
<td>RUS</td>
<td>...</td>
<td>1.376389</td>
<td>18.708375</td>
<td><u>2019-09-14</u></td>
<td><u>2019</u></td>
<td><u>110.308511</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">ar = pd.concat(rd)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لكل مشارك ، سنترك إدخال واحد فقط في كل سنة تقويمية:</font></font><br>
<br>
<pre><code class="python hljs">ar1 = ar.drop_duplicates(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'year'</span>], keep=<span class="hljs-string">'first'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، من جميع الأسماء الفريدة لهذه الإدخالات ، نجد تلك التي تحدث مرتين على الأقل:</font></font><br>
<br>
<pre><code class="python hljs">nvc = ar1[<span class="hljs-string">'name'</span>].value_counts()<font></font>
names = list(nvc[nvc &gt; <span class="hljs-number">1</span>].index)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يوجد 219،890 منهم دعنا نزيل أسماء الرياضيين المحترفين من هذه القائمة:</font></font><br>
<br>
<pre><code class="python hljs">pro_names = ar[ar[<span class="hljs-string">'group'</span>].isin([<span class="hljs-string">'MPRO'</span>,<span class="hljs-string">'FPRO'</span>])][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(pro_names))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وكذلك أسماء الرياضيين الذين بدأوا في الأداء قبل عام 2010. </font><font style="vertical-align: inherit;">للقيام بذلك ، قم بتحميل البيانات التي تم حفظها قبل أخذ عينات على مدى السنوات العشر الماضية. </font><font style="vertical-align: inherit;">ضعهم في كائنات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rsa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ملخص الأجناس كلها) و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (تفاصيل السباق كلها).</font></font><br>
<br>
<pre><code class="python hljs">rdo = {} <font></font>
<font></font>
<span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> rda:    
    <span class="hljs-keyword">if</span> rsa[rsa[<span class="hljs-string">'event'</span>] == e][<span class="hljs-string">'year'</span>].iloc[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">2010</span>:<font></font>
        rdo[e] = rda[e]<font></font>
<font></font>
aro = pd.concat(rdo)<font></font>
old_names = aro[<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(old_names))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وأخيرًا ، نجد أسماء تحدث أكثر من مرة في نفس اليوم. </font><font style="vertical-align: inherit;">وبالتالي ، فإننا نقلل من وجود الاسماء الكاملة في عينتنا.</font></font><br>
<br>
<pre><code class="python hljs">namesakes = ar[ar.duplicated(subset = [<span class="hljs-string">'name'</span>,<span class="hljs-string">'date'</span>], keep = <span class="hljs-literal">False</span>)][<span class="hljs-string">'name'</span>].unique()<font></font>
names = list(set(names) - set(namesakes))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذن هناك 198،075 اسم متبقي. </font><font style="vertical-align: inherit;">من مجموعة البيانات بأكملها ، نختار فقط السجلات التي تحتوي على الأسماء:</font></font><br>
<br>
<pre><code class="python hljs">ars = ar[ar[<span class="hljs-string">'name'</span>].isin(names)] <span class="hljs-comment">#ars – all recrds selected</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، لكل سجل ، تحتاج إلى تحديد العام الذي تقابله في مهنة الرياضي - الأول أو الثاني أو الثالث أو العاشر. </font><font style="vertical-align: inherit;">نقوم بعمل حلقة بكل الأسماء وحسابها.</font></font><br>
<br>
<pre><code class="python hljs">ars[<span class="hljs-string">'exp'</span>] = <span class="hljs-string">''</span> <span class="hljs-comment">#exp – experience, counted in years of racing, starts from 1.</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:    <font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
    yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min() <span class="hljs-comment">#yos – year of start</span>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span> 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
فيما يلي مثال على ما حدث: على </font><font style="vertical-align: inherit;">
ما يبدو ، لا تزال الأسماء نفسها قائمة. </font><font style="vertical-align: inherit;">هذا أمر متوقع ، لكنه ليس مخيفًا ، لأننا سنحسب متوسط ​​كل شيء ، ولا ينبغي أن يكون هناك الكثير. </font><font style="vertical-align: inherit;">بعد ذلك ، نبني مصفوفات للرسم البياني:</font></font><br>
<code><div class="scrollable-table"><table>
<tbody><tr>
<th>event</th>
<th>place</th>
<th>sex</th>
<th>name</th>
<th>country</th>
<th>group</th>
<th>…</th>
<th>th</th>
<th>v</th>
<th>date</th>
<th><u>year</u></th>
<th>vproc</th>
<th><u>exp</u></th>
</tr>
<tr>
<td>…</td>
<td>633</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>5.356111</td>
<td>21.097397</td>
<td>2014-08-31</td>
<td><u>2014</u></td>
<td>106.036879</td>
<td><u>1</u></td>
</tr>
<tr>
<td>…</td>
<td>302</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>11.236389</td>
<td>20.113223</td>
<td>2015-08-30</td>
<td><u>2015</u></td>
<td>108.231254</td>
<td><u>2</u></td>
</tr>
<tr>
<td>…</td>
<td>522</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>10.402778</td>
<td>21.724967</td>
<td>2016-07-17</td>
<td><u>2016</u></td>
<td>111.265107</td>
<td><u>3</u></td>
</tr>
<tr>
<td>…</td>
<td>25</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>10.910833</td>
<td>20.713358</td>
<td>2017-09-23</td>
<td><u>2017</u></td>
<td>112.953644</td>
<td><u>4</u></td>
</tr>
<tr>
<td>…</td>
<td>23</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>4.700000</td>
<td>24.042553</td>
<td>2017-06-03</td>
<td><u>2017</u></td>
<td>120.565211</td>
<td><u>4</u></td>
</tr>
<tr>
<td>…</td>
<td>42</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M40-44</td>
<td>…</td>
<td>4.599167</td>
<td>24.569668</td>
<td>2018-06-17</td>
<td><u>2018</u></td>
<td>124.579862</td>
<td><u>5</u></td>
</tr>
<tr>
<td>…</td>
<td>90</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>NOR</td>
<td></td>
<td>…</td>
<td>14.069167</td>
<td>16.063496</td>
<td>2018-08-04</td>
<td><u>2018</u></td>
<td>100.001834</td>
<td><u>5</u></td>
</tr>
<tr>
<td>…</td>
<td>86</td>
<td>M</td>
<td>Golovin Sergey</td>
<td>RUS</td>
<td>M45-49</td>
<td>…</td>
<td>9.820556</td>
<td>23.012955</td>
<td>2019-08-03</td>
<td><u>2019</u></td>
<td>118.375766</td>
<td><u>6</u></td>
</tr>
</tbody></table></div></code><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">exp = [] <font></font>
vpm = [] <span class="hljs-comment">#vpm – v proc mean</span>
numrecs = [] <span class="hljs-comment">#number of records</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'exp'</span>].min(), ars[<span class="hljs-string">'exp'</span>].max() + <span class="hljs-number">1</span>): <font></font>
    exp.append(x)<font></font>
    vpm.append(ars[ars[<span class="hljs-string">'exp'</span>] == x][<span class="hljs-string">'vproc'</span>].mean())<font></font>
    numrecs.append(len(ars[ars[<span class="hljs-string">'exp'</span>] == x]))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا كل شيء ، هناك أساس: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c4/_p/u6/c4_pu61ixkiscputxq1qhfm84eg.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، لتزيينه بنقاط تتوافق مع نتائج محددة ، سنختار 1000 اسم عشوائي وننشئ صفائف مع النتائج الخاصة بها.</font></font><br>
<br>
<pre><code class="python hljs">names_samp = random.sample(names,<span class="hljs-number">1000</span>)<font></font>
ars_samp = ars[ars[<span class="hljs-string">'name'</span>].isin(names_samp)]<font></font>
<font></font>
ars_samp = ars_samp.reset_index(drop = <span class="hljs-literal">True</span>)<font></font>
exp_samp = []<font></font>
vproc_samp = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names_samp:<font></font>
    nr = ars_samp[ars_samp[<span class="hljs-string">'name'</span>] == n]<font></font>
    nr = nr.sort_values(<span class="hljs-string">'exp'</span>)<font></font>
    exp_samp.append(list(nr[<span class="hljs-string">'exp'</span>]))<font></font>
    vproc_samp.append(list(nr[<span class="hljs-string">'vproc'</span>]))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أضف حلقة لبناء الرسوم البيانية من هذه العينة العشوائية.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(exp_samp)):<font></font>
    ax1.plot(exp_samp[i], vproc_samp[i], <span class="hljs-string">'.'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن كل شيء جاهز: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/0h/ee/uj0hee9v0tujesawdjz41fmfp0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بشكل عام ، ليس صعبًا. ولكن هناك مشكلة واحدة. لحساب </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إكسب</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> خبرة </font><font style="vertical-align: inherit;">في الدورة، وجميع الأسماء، والتي هي تقريبا 200 ألف، واتخاذ ثماني ساعات. اضطررت إلى تصحيح الخوارزمية على عينات صغيرة ، ثم إجراء العملية الحسابية ليلا. من حيث المبدأ ، يمكن القيام بذلك مرة واحدة ، ولكن إذا وجدت نوعًا من الخطأ أو تريد تغيير شيء ما ، وتحتاج إلى إعادة سرده مرة أخرى ، فإنه يبدأ في الضغط. وهكذا ، عندما كنت سأنشر تقريرًا في المساء ، اتضح أنه من الضروري إعادة سرد كل شيء مرة أخرى. لم يكن الانتظار حتى الصباح جزءًا من خططي ، وبدأت أبحث عن طريقة لجعل الحساب أسرع. قررت موازية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وجدت في مكان ما طريقة للقيام بذلك مع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المعالجة المتعددة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">من أجل العمل على Windows ، كنا بحاجة إلى وضع المنطق الرئيسي لكل مهمة متوازية في </font><font style="vertical-align: inherit;">ملف </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> منفصل </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pickle <span class="hljs-keyword">as</span> pkl<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">worker</span>(<span class="hljs-params">args</span>):</span>
    names = args[<span class="hljs-number">0</span>]<font></font>
    ars=args[<span class="hljs-number">1</span>]<font></font>
    num=args[<span class="hljs-number">2</span>]<font></font>
    ars = ars.sort_values(by=<span class="hljs-string">'name'</span>)<font></font>
    ars = ars.reset_index(drop=<span class="hljs-literal">True</span>)  <font></font>
<font></font>
    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> names:   <font></font>
        ind = ars[ars[<span class="hljs-string">'name'</span>] == n].index <font></font>
        yos = ars.loc[ind, <span class="hljs-string">'year'</span>].min()<font></font>
        ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind, <span class="hljs-string">'year'</span>] - yos + <span class="hljs-number">1</span>                      <font></font>
<font></font>
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span> + str(num) + <span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:<font></font>
        pkl.dump(ars,f)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتم نقل الإجراء إلى جزء من أسماء </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الأسماء</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، الجزء datafreyma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فقط مع هذه الأسماء ، والرقم التسلسلي للمهام المتوازية - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">num</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">تتم كتابة الحسابات في إطار البيانات ، وفي النهاية ، تتم كتابة إطار البيانات في الملف. </font><font style="vertical-align: inherit;">في الكمبيوتر المحمول الذي يستدعي هذا </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العامل</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، نقوم بإعداد الحجج وفقًا لذلك:</font></font><br>
<br>
<pre><code class="python hljs">num_proc = <span class="hljs-number">8</span> <span class="hljs-comment">#number of processors</span><font></font>
args = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):<font></font>
    step = int(len(names_samp)/num_proc) + <span class="hljs-number">1</span>
    names_i = names_samp[i*step:min((i+<span class="hljs-number">1</span>)*step, len(names_samp))]<font></font>
    ars_i = ars[ars[<span class="hljs-string">'name'</span>].isin(names_i)]<font></font>
    args.append([names_i, ars_i, i])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نبدأ الحوسبة المتوازية:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool
<span class="hljs-keyword">import</span> workers<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ ==  <span class="hljs-string">'__main__'</span>:     <font></font>
    p=Pool(processes = num_proc)<font></font>
    p.map(workers.worker,args)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وفي النهاية نقرأ النتائج من الملفات ونجمع القطع مرة أخرى في إطار البيانات بالكامل:</font></font><br>
<br>
<pre><code class="python hljs">ars=pd.DataFrame(columns = ars.columns)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_proc):
    <span class="hljs-keyword">with</span> open(<span class="hljs-string">r'D:\tri\par\prog'</span>+str(i)+<span class="hljs-string">'.pkl'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:    <font></font>
        arsi = pkl.load(f)<font></font>
        print(len(arsi))<font></font>
        ars = pd.concat([ars, arsi])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وبالتالي ، كان من الممكن الحصول على تسارع 40 مرة ، وبدلاً من 8 ساعات لإكمال الحساب في 11 دقيقة ونشر تقرير في ذلك المساء. في الوقت نفسه ، تعلمت كيفية موازاة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الثعبان</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، أعتقد أنه سيكون مفيدًا. هنا ، تحول التسارع إلى أكثر من 8 أضعاف عدد النوى ، نظرًا لأن كل مهمة تستخدم إطار بيانات صغيرًا ، مما يجعل البحث أسرع. من حيث المبدأ ، يمكن تسريع الحسابات المتسلسلة بهذه الطريقة ، ولكن السؤال هو ، كيف تخمن؟ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع ذلك ، لم أستطع الهدوء ، وحتى بعد النشر كنت أفكر باستمرار في كيفية إجراء الحساب باستخدام المتجه ، أي العمليات على أعمدة كاملة من إطار </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بيانات سلسلة الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">هذه الحسابات هي ترتيب حجم أسرع من أي دورات متوازية ، حتى على الكتلة الفائقة. </font><font style="vertical-align: inherit;">وخرج. </font><font style="vertical-align: inherit;">اتضح أنه لكل اسم للعثور على عام بداية المهنة ، من الضروري على العكس - لكل عام للعثور على المشاركين الذين بدأوا فيه. </font><font style="vertical-align: inherit;">للقيام بذلك ، يجب عليك أولاً تحديد جميع الأسماء للسنة الأولى من نموذجنا ، وهذا هو عام 2010. وبناءً على ذلك ، نقوم بمعالجة جميع السجلات بهذه الأسماء باستخدام هذا العام. </font><font style="vertical-align: inherit;">بعد ذلك ، نأخذ العام المقبل - 2011. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
مرة أخرى نجد جميع الأسماء التي تحتوي على إدخالات هذا العام ، لكننا نأخذ منها فقط الأسماء غير المجهزة ، أي تلك التي لم يتم الوفاء بها في عام 2010 وتتم معالجتها باستخدامها في عام 2011. </font><font style="vertical-align: inherit;">وهكذا بالنسبة لبقية العام. </font><font style="vertical-align: inherit;">نفس الدورة ، ولكن ليس مائتي ألف تكرار ، ولكن تسعة في المجموع.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(ars[<span class="hljs-string">'year'</span>].min(),ars[<span class="hljs-string">'year'</span>].max()):<font></font>
    arsynp = ars[(ars[<span class="hljs-string">'exp'</span>] == <span class="hljs-string">''</span>) &amp; (ars[<span class="hljs-string">'year'</span>] == y)] <span class="hljs-comment">#arsynp - all records selected for year not processed</span>
    namesy = arsynp[<span class="hljs-string">'name'</span>].unique()<font></font>
    ind = ars[ars[<span class="hljs-string">'name'</span>].isin(namesy)].index<font></font>
    ars.loc[ind, <span class="hljs-string">'exp'</span>] = ars.loc[ind,<span class="hljs-string">'year'</span>] - y + <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تنجز هذه الدورة في بضع ثوانٍ فقط. </font><font style="vertical-align: inherit;">وتبين أن الرمز أكثر إيجازًا بكثير.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استنتاج</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، أخيرًا ، تم إنجاز الكثير من العمل. بالنسبة لي ، كان هذا ، في الواقع ، أول مشروع من نوعه. عندما أخذتها ، كان الهدف الرئيسي هو التدرب على استخدام الثعبان ومكتباته. هذه المهمة أكثر من أن تكتمل. وكانت النتائج نفسها قابلة للعرض. ما هي النتائج التي استخلصتها لنفسي عند الانتهاء؟ </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أولاً:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> البيانات غير كاملة. ربما يكون هذا صحيحًا لأي مهمة تحليل تقريبًا. حتى إذا كانت منظمة تمامًا ، وغالبًا ما يحدث ذلك بشكل مختلف ، فأنت بحاجة إلى الاستعداد للتعامل معها قبل البدء في حساب الخصائص والبحث عن الاتجاهات - العثور على الأخطاء ، والقيم المتطرفة ، والانحرافات عن المعايير ، وما إلى ذلك. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ثانيًا:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أي مهمة لها حل. هذا أشبه بالشعار ، لكنه في كثير من الأحيان. الأمر فقط أن هذا الحل قد لا يكون واضحًا جدًا ولا يكمن في البيانات نفسها ، ولكن خارج الصندوق ، إذا جاز التعبير. كمثال - معالجة أسماء المشاركين الموصوفة أعلاه ، أو كشط موقع الويب. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ثالثا:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> معرفة المجال أمر حاسم. سيجعل هذا من الممكن إعداد البيانات بشكل أفضل ، وإزالة البيانات غير الصحيحة أو غير القياسية الواضحة ، وتجنب أخطاء التفسير ، واستخدام المعلومات غير الموجودة في البيانات ، على سبيل المثال ، المسافات في هذا المشروع ، وتقديم النتائج في النموذج المقبول في المجتمع ، مع تجنب الاستنتاجات الغبية غير الصحيحة. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابعاً:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> العمل في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الثعبان</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هناك مجموعة غنية من الأدوات. في بعض الأحيان يبدو أنه يجدر التفكير في شيء ما ، تبدأ في البحث - إنه موجود بالفعل. هذا رائع! شكرًا جزيلاً للمبدعين على هذه المساهمة ، خاصةً للأدوات التي جاءت في متناول اليد هنا: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">السيلينيوم من</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أجل الكشط ، pycountry لتحديد رمز البلد وفقًا لمعيار ISO ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رموز البلد (datahub)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> للرموز الأولمبية ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geopy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لتحديد الإحداثيات في العنوان ، </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">folium</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - لتصور البيانات الجغرافية وتخمين </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجنس</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - لتحليل الأسماء </font><i><font style="vertical-align: inherit;">والمعالجة </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المتعددة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - للحوسبة المتوازية و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">numpy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وبالطبع </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - دون أن يكون هناك مكان للذهاب إليه.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خامساً:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> التوجه إلى كل شيء. من المهم للغاية أن تكون قادرًا على استخدام أدوات </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الباندا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> المدمجة </font><font style="vertical-align: inherit;">، فهي فعالة للغاية. أفترض ، في معظم الحالات ، عندما يتم قياس عدد السجلات بدءًا من عشرات الآلاف ، تصبح هذه المهارة ضرورية ببساطة. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">السادس:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">معالجة البيانات فكرة سيئة. من الضروري محاولة تقليل أي تدخل يدوي - أولاً ، لا يتم قياسه ، أي عندما تزيد كمية البيانات عدة مرات ، سيزداد وقت المعالجة اليدوية إلى قيم غير مقبولة ، وثانيًا ، سيكون هناك تكرار متكرر - ستنسى شيئًا ، سترتكب خطأ في مكان ما . كل شيء برمجي فقط ، إذا كان هناك شيء خارج المعيار العام لحل البرنامج ، حسنًا ، لا بأس ، يمكنك التضحية بجزء من البيانات ، فسيظل هناك المزيد من الإيجابيات. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سابعا:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يجب حفظ الكود في حالة صالحة للعمل. يبدو أنه يمكن أن يكون أكثر وضوحا! في الواقع ، عندما يتعلق الأمر بالتعليمات البرمجية الخاصة بك ، والتي تهدف إلى نشر نتائج هذا الرمز ، فكل شيء ليس صارمًا هنا. لقد عملت في Jupiter Notebooks ، وهذه البيئة ، في رأيي ، لا تحتاج إلى إنشاء منتجات برمجية متكاملة. تم تكوينه لإطلاق كل سطر على حدة ، وهذا له مزاياه - إنه سريع: التطوير والتصحيح والتنفيذ في نفس الوقت. ولكن غالبًا ما يكون الإغراء هو مجرد تعديل سطر ما والحصول بسرعة على نتيجة جديدة ، بدلاً من التكرار أو الالتفاف في </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الدفاع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. بالطبع ، يجب تجنب مثل هذا الإغراء. يجب أن يسعى المرء للحصول على رمز جيد ، حتى "لنفسه" ، على الأقل لأنه حتى في عمل تحليلي واحد ، يتم الإطلاق عدة مرات ، ومن المؤكد أن استثمار الوقت في البداية سيؤتي ثماره في المستقبل. ويمكنك إضافة اختبارات ، حتى على أجهزة الكمبيوتر المحمولة ، في شكل تدقيق للمعلمات الهامة ورمي الاستثناءات - إنها مفيدة جدًا. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ثامناً:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وفر أكثر. في كل خطوة ، قمت بحفظ نسخة جديدة من الملف. في المجموع ، تبين أنها حوالي 10. هذا أمر مريح ، لأنه عندما يتم اكتشاف خطأ ، فإنه يساعد على التحديد السريع في أي مرحلة حدث. بالإضافة إلى ذلك ، قمت بحفظ بيانات المصدر في الأعمدة المميزة بعلامة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خام</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - وهذا يسمح لك بالتحقق من النتيجة بسرعة ورؤية التناقض. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تاسع:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">من الضروري قياس استثمار الوقت والنتيجة. في بعض الأماكن ، استغرقت وقتًا طويلاً جدًا لاستعادة البيانات ، والتي تشكل جزءًا من نسبة مئوية من الإجمالي. في الواقع ، هذا لا معنى له ، كان عليك فقط التخلص منهم ، وهذا كل شيء. وسأفعل ذلك إذا كان مشروعًا تجاريًا ، وليس تدريبًا ذاتيًا. هذا سيسمح لك بالحصول على النتيجة بشكل أسرع. يعمل مبدأ باريتو هنا - يتم تحقيق 80 ٪ من النتيجة في 20 ٪ من الوقت. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وآخر واحد:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العمل في مثل هذه المشاريع يوسع الآفاق بشكل كبير. </font><font style="vertical-align: inherit;">عن طيب خاطر ، تتعلم شيئًا جديدًا - على سبيل المثال ، أسماء دول غريبة - مثل جزر بيتكيرن ، أن رمز ISO لسويسرا هو CHE ، من اللاتينية "Confoederatio Helvetica" ، ما هو الاسم الإسباني ، حسنًا ، في الواقع عن الترياتلون نفسه - السجلات ، أصحابها ، أماكن السباقات ، تاريخ الأحداث وما إلى ذلك. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ربما يكفي. </font><font style="vertical-align: inherit;">هذا كل شئ. </font><font style="vertical-align: inherit;">شكرا لكل من قرأ حتى النهاية!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar500150/index.html">ROS والشبكة العصبية متسول الروبوت</a></li>
<li><a href="../ar500152/index.html">كيف قمت بدمج POS-terminal و FR IKKM-Touch في 1C: enterprise</a></li>
<li><a href="../ar500154/index.html">التعلم الآلي السري. مكتبة PySyft</a></li>
<li><a href="../ar500158/index.html">تفاعل SwiftUI مع Redux</a></li>
<li><a href="../ar500160/index.html">العناصر البصرية</a></li>
<li><a href="../ar500164/index.html">مدرس: تكاليف المهنة</a></li>
<li><a href="../ar500170/index.html">البرنامج التعليمي لمحاكاة الشبكات NS-3. الفصل 6</a></li>
<li><a href="../ar500178/index.html">ترجمة كتاب أندرو أون ، شغف التعلم الآلي ، الفصول 38 و 39</a></li>
<li><a href="../ar500184/index.html">ديفيد أوبراين (Xirus): المقاييس! المقاييس! المقاييس! الجزء 2</a></li>
<li><a href="../ar500186/index.html">HackTheBox. تجول في OpenAdmin. RCE في OpenNetAdmin و GTFOBins في النانو</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>