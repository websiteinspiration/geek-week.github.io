<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🐆 🏇🏽 Postgres-Tuesday＃5：「PostgreSQLとKubernetes。CI / CD。テスト自動化» 🤘🏾 🎌 ☺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="昨年の終わりに、ロシアのPostgreSQLコミュニティ#RuPostgresの別のライブブロードキャストが行われ、その共同創設者であるニコライサモクヴァロフ氏は、KubernetesのコンテキストでこのDBMSについてFlantaテクニカルディレクターのDmitry Stolyarovと話しました...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Postgres-Tuesday＃5：「PostgreSQLとKubernetes。CI / CD。テスト自動化»</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/479438/"><img src="https://habrastorage.org/webt/qm/rm/ln/qmrmlnm8gjj_8gih4dzhy2ybrvy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
昨年の終わりに、ロシアのPostgreSQLコミュニティ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#RuPostgresの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別のライブブロードキャストが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">行われ</font></a><font style="vertical-align: inherit;">、その共同創設者であるニコライサモクヴァロフ氏は、KubernetesのコンテキストでこのDBMSについてFlantaテクニカルディレクターのDmitry Stolyarovと話しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このディスカッションの本文の筆記録を投稿し</font><font style="vertical-align: inherit;">ており</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コミュニティのYouTubeチャンネルに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全な動画が投稿さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">れ</font></a><font style="vertical-align: inherit;">てい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><a name="habracut"></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/qXc9VTr4TFc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースとKubernetes</font></font></h2><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：今日は、VACUUMとCHECKPOINTについては触れません。 Kubernetesについてお話します。あなたには長年の経験があることを知っています。私はあなたのビデオを見て、いくつかの作品をレビューさえしました...さっそく始めましょう：K8sでPostgresまたはMySQLを使用する理由</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：この質問に対する答えは1つではありません。しかし、一般的には、それは単純さと利便性...の可能性です。結局のところ、誰もがマネージドサービスを望んでいます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RDSが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好きなの</font><font style="vertical-align: inherit;">は、自宅だけですか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい：RDSを好きになるには、どこでも。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：「どこでも」は良い点です。大企業では、すべてが異なる場所にあります。そして、なぜそれが大企業の場合、既成のソリューションを採用しないのですか？たとえば、Nutanixは独自の開発を行っており、他の企業（VMware ...）も同じ「RDS、自宅のみ」を持っています。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、特定の条件下でのみ機能する単一の実装について話しています。そして、Kubernetesについて話している場合、非常に多様なインフラストラクチャがあります（K8の場合もあります）。実際、これはクラウドへのAPIの標準です... </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：また、無料です！</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これはそれほど重要ではありません。無料は、市場の非常に大きなセグメントにとって重要ではありません。もう1つ重要なのは、おそらく「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースとKubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">というレポートを思い出したでしょう</font><font style="vertical-align: inherit;">か。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：彼は非常にあいまいに知覚されていることに気づきました。 「みんな、すべてのデータベースはKubernetesに行きました！」と思っている人もいれば、すべてひどい自転車だと思っている人もいました。そして、私は別のことをまとめて言いたかったのです。「何が起こっているのか、何が問題であり、どのように解決できるのか見てください。さて、Kubernetesに拠点を置きますか？製造？まあ、あなたが愛する場合にのみ...特定のことをしています。しかし、開発者にとって、私はそれをお勧めすると言えます。環境の作成/削除のダイナミズムは、開発者にとって非常に重要です。」</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS：開発者とは、製品ではないすべての環境を意味しますか？ステージング、QA ... </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：パフォーマンススタンドについて話している場合、要件は特定であるため、おそらくまだありません。ステージングが非常に大きなデータベースを必要とする特殊なケースについて話している場合、おそらくそれほどでもないでしょう...これが静的環境であり、長寿命である場合、K8にベースを配置することの利点は何ですか？</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：なし。しかし、静的な環境はどこにありますか？静的環境は明日時代遅れです。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ステージングは​​静的にすることができます。私たちはクライアントを持っています... </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい、私も持っています。大きな問題は、ベースが10 TBでステージングが200 GBの場合です... </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私はとてもクールなケースを持っています！ステージングには、修正される製品ベースがあります。また、「本番環境にロールアウトする」というボタンが用意されています。これらの変更-デルタ-は本番環境に追加されます（APIによって単純に同期されているようです）。これは非常にエキゾチックなオプションです。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NA</font></font></b>:     ,    RDS'    Heroku  —   2-3- , —       .       80 ,     .     ,   3  ,    .    .  ,    prod   staging —     .      ,        .  ,      ,    Kubernetes.   ,   prod'    ?</i><br>
<br>
<b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：prodには小さな拠点があります。数十ギガバイトのボリュームと重要ではないサービスについて話しているので、レプリカを作成するのが面倒なので（そのような必要はありません）。また、Kubernetesの下には通常のストレージがあります。このデータベースは仮想マシンで動作しました-条件付きでVMwareのストレージ上で。これを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置し、</font><font style="vertical-align: inherit;">マシン間で転送できるようになりました。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：このサイズのベース（最大100 GB）は、適切なディスク上にあり、適切なネットワークがあれば、数分で展開できます。毎秒1 GBの速度はもう珍しくありません。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい、線形操作の場合、これは問題ではありません。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：わかりました、私たちは製品についてのみ考えるべきです。また、非本番環境向けのKubernetesを検討する場合、どのようにすればよいでしょうか？ザランドで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らはオペレーター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ていて</font></a><font style="vertical-align: inherit;">、Crunchy </font><font style="vertical-align: inherit;">で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソーイング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ていて、</font></a><font style="vertical-align: inherit;">他にもいくつかのオプションがあります。そして、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnGres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。これはスペインの親友Alvaroです。基本的には、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">だけ</font><font style="vertical-align: inherit;">でなく、ディストリビューション全体（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StackGres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を作成します。この</font><font style="vertical-align: inherit;">ディストリビューション</font><font style="vertical-align: inherit;">では、Postgres自体に加えて、バックアップ、エンボイプロキシをプッシュすることも決定しました... </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：何のための特使？ Postgresトラフィックバランシングは正確ですか？</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい。つまり、Linuxディストリビューションとカーネルを使用する場合、通常のPostgreSQLがカーネルであり、クラウドフレンドリーでKubernetesで回転するディストリビューションを作成したいと考えています。コンポーネント（バックアップなど）をドッキングしてデバッグするため、適切に機能します。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">： とてもかっこいい！本質的には、管理されたPostgresを作成するためのソフトウェアです。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Linuxディストリビューションには永遠の問題があります。すべてのハードウェアがサポートされるようにドライバーを作成する方法です。そして、彼らはKubernetesで働くという考えを持っています。 Zalandoオペレーターで最近AWSで目玉を見たことがあり、これはあまり良くありません。特定のインフラストラクチャーとの関係はないはずです。その場合、何が重要なのでしょうか。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：特にZalandoがどのような状況で関与したのかはわかりませんが、Kubernetesでは、ストレージは一般的な方法でディスクバックアップを削除できないように作成されています。最近標準に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">-CSI仕様の</font></a><font style="vertical-align: inherit;">最新バージョン</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-スナップショットの可能性を作りましたが、それはどこに実装されていますか？正直なところ、それはまだ生のままです... AWS、GCE、Azure、vSphereの上にCSIを試していますが、まだ準備ができていないことがわかるように、少し使用し始めています。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：そのため、インフラストラクチャと連携する必要がある場合があります。これはまだ初期段階だと思います-成長の問題。質問：K8​​sでPgSQLを試したい初心者に何を勧めますか？多分どのオペレーター？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：問題は、Postgresが3％であることです。 Kubernetesにはさまざまなソフトウェアの非常に大きなリストがまだありますが、すべてをリストすることはしません。たとえば、Elasticsearch。オペレーターはたくさんあります：積極的に開発している会社もあれば、開発していない会社もあります。私たち自身のために、私たちは彼を真剣に受け止めるために、オペレーターにあるべき要件を作りました。オペレーターはKubernetes専用であり、「Amazonの条件の下で何かを行うオペレーター」ではありません。実際、単一のオペレーターを非常に広く（=ほとんどすべてのお客様に）使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">します-Redis </font></font></a> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（すぐにそれについての記事を公開します）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、MySQLについてもですか？私はPerconaを知っています...彼らは現在MySQL、MongoDB、およびPostgresに関与しているため、何らかのユニバーサルギャッシュ（すべてのデータベース、すべてのクラウドプロバイダー）を持つ必要があります。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQLのステートメントを確認する時間がありませんでした。私たちにとって、これは現在の主な焦点ではありません。 MySQLはスタンドアロンで正常に動作します。なぜデータベースを起動できるだけなのか... DockerコンテナをPostrgesで起動することも、簡単な方法で起動することもできます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これも問題でした。一般的にオペレーターなし？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい、100％でオペレーターなしでPostgreSQLを起動しています。</font><font style="vertical-align: inherit;">これまでのところ。</font><font style="vertical-align: inherit;">私たちは、Prometheus、Redisの演算子を積極的に使用しています。</font><font style="vertical-align: inherit;">Elasticsearchのオペレーターを探す計画があります。Kubernetesのケースの100％にインストールしたいので、最も燃えます。</font><font style="vertical-align: inherit;">MongoDBが常にKubernetesにもインストールされるようにしたいのと同じです。</font><font style="vertical-align: inherit;">特定のウィッシュリストがここに表示されます-これらのケースでは何かができるという感じがあります。</font><font style="vertical-align: inherit;">そして、Postgresについては、私たちは見さえしませんでした。</font><font style="vertical-align: inherit;">もちろん、私たちはさまざまなオプションの存在について知っていますが、実際にはスタンドアロンです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesでのデータベースのテスト</font></font></h2><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：テストのトピックに移りましょう。データベースの変更をロールアウトする方法-DevOpsパースペクティブの観点から。マイクロサービス、多くのデータベースがあり、いつでもどこかで何かが変化しています。すべてのものがDBMSの観点から正しい順序になるように、通常のCI / CDを保証する方法。あなたのアプローチは何ですか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：答えは1つではありません。いくつかのオプションがあります。 1つ目は、展開するベースのサイズです。あなたは、開発とステージで製品データベースのコピーを保持することに対して、企業は異なる態度を持っているとあなた自身は言いました。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：GDPRに関しては、ますます注意が払われていると思います。ヨーロッパでは、すでに問題が解決し始めていると言えます。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、多くの場合、本番環境をダンプして難読化するソフトウェアを作成できます。 prod'ovyeデータ（スナップショット、ダンプ、バイナリコピー...）が判明しますが、それらは匿名です。代わりに、生成スクリプトが存在する場合があります。フィクスチャまたは大規模なデータベースを生成する単なるスクリプトにすることができます。問題は何ですか：基本的なイメージが作成されるのにどれくらい時間がかかりますか？また、適切な環境に展開するのにどのくらいの時間がかかりますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキームに到達しました。クライアントにフィクスチャデータセット（データベースの最小バージョン）がある場合、デフォルトでそれらを使用します。レビュー環境について話している場合、ブランチを作成したときに、アプリケーションインスタンスをデプロイしました-そこに小さなデータベースを展開しています。しかし、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">オプション</font></a><font style="vertical-align: inherit;">はうまくいきました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダンプを1日に1回（夜間）本番環境から削除し、それに基づいて、これらのロードされたデータを含むPostgreSQLおよびMySQLを含むDockerコンテナーを収集します。このイメージからベースを50回展開する必要がある場合、これは非常に単純かつ迅速に行われます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：単純なコピー？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：データはDockerイメージに直接保存されます。それら。 100 GBですが、既製のイメージがあります。 Dockerのレイヤーのおかげで、このイメージを必要なだけ何度でもすばやくデプロイできます。メソッドはばかげていますが、それはかなりうまくいきます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：さらに、テストすると、Docker内で直接変更されますよね？ Docker内のコピーオンライト-破棄して再度実行します。すべて問題ありません。クラス！そして、あなたはすでにそれをmightとmainで使用していますか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：長い間。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私たちは非常によく似たことをします。 Dockerのコピーオンライトではなく、他のものを使用しているだけです。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：彼はジェネリックではありません。そして、Docker'nyはどこでも動作します。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：理論的にはそうです。しかし、そこにもモジュールがあります。さまざまなモジュールを作成し、さまざまなファイルシステムで作業できます。なんという瞬間でしょう。 Postgresからは、これらすべてを異なって見ています。今、私はDockerの側から見て、すべてがあなたのために働くことがわかりました。しかし、データベースが1 TBなどの巨大な場合、これはすべて長くなります。夜間の操作とDockerのすべてのものの両方...そして、Dockerに5 TBのものがあるとしたら...それともすべて正常ですか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：それはどのような違いを</font><b><font style="vertical-align: inherit;">もたらし</font></b><font style="vertical-align: inherit;">ますか？それはブロブであり、ビットとバイトだけです。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：違いはこれです。これはダンプと復元によって行われますか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：全く必要ありません。この画像を生成する方法は異なる場合があります。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：一部のクライアントについては、定期的に基本的なイメージを生成する代わりに、常に最新の状態に保つようにしています。これは基本的にレプリカですが、データはマスターから直接受信されるのではなく、アーカイブを介して受信されます。 WALが毎日ロールされるバイナリアーカイブ、バックアップもそこで削除されます...これらのWALは、少し遅れて（文字どおり1〜2秒）ベースイメージに飛行します。なんらかの方法でクローンを作成します。現在、デフォルトでZFSが使用されています。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、ZFSでは、ノードは1つに制限されます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい。しかし、ZFSには不思議な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信機能</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。スナップショットを送信できます（実際にはまだテストしていませんが、...）2つの差分を送信できます</font></font><code>PGDATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。実際、そのようなタスクのために特に考慮しなかった別のツールがあります。 PostgreSQLには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_rewindがあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これは「スマート」なrsyncとして機能し、確認する必要のない多くのことをスキップします。 2つのサーバー間で迅速な同期を実行し、まったく同じ方法で巻き戻します。</font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、私たちは、あなたが言ったのと同じことを実行できるツールを作成するために、このより多くのDBA'noy側で試行しています：1つのベースがありますが、ほぼ同時に50回テストしたいと考えています。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：50回は、50個のスポットインスタンスを注文する必要があることを意味します。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：いいえ、すべて1台のマシンで行っています。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、この1つのベースがたとえばテラバイトである場合、50回展開するにはどうすればよいでしょうか。おそらく、条件付きで256 GBのRAMが必要ですか？</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい、時々大量のメモリが必要になります-これは正常です。しかし、そのような人生の例です。本番マシンでは、96コアと600 GB。同時に、32個のコアがデータベースに使用され（16個のコアが使用されることもあります）、100〜120 GBのメモリが使用されます。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：そして50枚のコピーが入りますか？</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：したがって、コピーは1つしかなく、コピーオンライト（ZFS'ny）が機能します...詳細は後で説明します。</font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、10 TBのベースがあります。彼らはそのためのディスクを作成しましたが、ZFSはそのパーセントサイズをまだ30〜40だけ絞りました。負荷テストは行わないため、正確な応答時間は重要ではありません。最大で2倍遅くなるようにしてください-それで問題ありません。</font></font></i><br>
<br>
<i>   , QA, DBA  ..    1-2 . ,    - .     10  —   1  Postgres', 1 .   — , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">autovacuum</a>  ,    .    16-32 ,   10    ,   .</i><br>
<br>
<i>  <code>PGDATA</code> ,  ,    Postgres   .   : , , 10 Postgres' .   ?  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">shared_buffers</a>, ,  25%. ,  200 .      ,    .</i><br>
<br>
<i>   -  ,    :   shared_buffers  2 .  PostgreSQL  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">effective_cache_size</a>,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.      0,5 .    ,      :   ,    .</i><br>
<br>
<i>,    - ,     —  ,      production.     (),  ,    ,    (  JOIN'  ..)    ,   production.          .</i><br>
<br>
<b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：いくつか問題があると思いませんか？ 1つ目は、PostgreSQLでのみ機能するソリューションです。このアプローチは非常にプライベートであり、一般的ではありません。 2番目-Kubernetes（およびクラウドが現在進んでいるところ）には多数のノードが含まれ、これらのノードは一時的なものです。そして、あなたの場合、それはステートフルで永続的なノードです。これらは私と矛盾しています。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：まず、私は同意します。これは純粋にPostgresの話です。いくつかの直接IOとほぼすべてのメモリ用のバッファプールがある場合、このアプローチは機能しません-異なる計画があるでしょう。ただし、現時点ではPostgresとのみ連携しており、他のユーザーについては考えていません。</font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesについて。あなた自身はどこにでも、私たちには根強い基盤があると言っています。インスタンスがクラッシュした場合、主なことはディスクを保存することです。ここでは、Kubernetesにプラットフォーム全体があり、Postgresを備えたコンポーネントは別のものです（いつかそこにあるでしょう）。したがって、すべてがそうです。インスタンスは落ちましたが、PVを保存し、何も起こらなかったかのように、別の（新しい）インスタンスに接続しただけです。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私の観点から、Kubernetesでポッドを作成します。 K8s-elastic：コンポーネントは必要に応じて独自に注文されます。タスクは、単純にポッドを作成し、Xリソースが必要であると言って、K8がそれを理解することです。しかしKubernetesにおけるストレージのサポートはまだ不安定です：で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.17</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（本リリースは、リリースされた</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">週間</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前）、これらの機能は、ベータ版になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6か月または1年が経過します。多かれ少なかれ安定するか、少なくとも宣言されます。</font><font style="vertical-align: inherit;">次に、スナップショットとサイズ変更の可能性により、問題が完全に解決されます。</font><font style="vertical-align: inherit;">基地があるから。</font><font style="vertical-align: inherit;">はい、それほど高速ではないかもしれませんが、速度は「内部」に依存します。実装によっては、ディスクサブシステムのレベルでコピーおよびコピーオンライトが可能なためです。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：すべてのエンジン（Amazon、Google ...）がこのバージョンのサポートを開始することも必要です。これにはしばらく時間がかかります。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：今のところ、使用していません。</font><font style="vertical-align: inherit;">私たちのものを使用しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesでの地域開発</font></font></h2><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：1台のマシンですべてのポッドを上げて、そのような小さなテストを行う必要があるときに、そのようなウィッシュリストに遭遇しましたか？概念実証をすばやく得るには、アプリケーションをKubernetesで動作させ、多数のマシンを割り当てないでください。ミニクベはありますか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：このケース-1つのノードでの展開-はローカル開発のみに関するものであるように思えます。またはそのようなパターンのいくつかの症状。あり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Minikubeが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k3sは</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> KIND</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Kubernetes IN Dockerを使用します。今、彼らは彼とテストのために働き始めました。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私はこれがすべてのポッドを1つのDockerイメージにラップする試みだと思っていました。</font><font style="vertical-align: inherit;">しかし、これは別のことについてであることが判明しました。</font><font style="vertical-align: inherit;">とにかく、Dockerには、個別のコンテナーと個別のポッドがあります。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい。</font><font style="vertical-align: inherit;">そして、そこにはかなり面白い模倣が行われますが、要点は...展開ツール</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werfがあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">その中でモードを作りたい-条件付きで</font></font><code>werf up</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：「ローカルのKubernetesを育てて」</font><font style="vertical-align: inherit;">そして、そこで条件付きを実行します</font></font><code>werf follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その後、開発者はIDEで編集できるようになり、変更を確認してイメージを再構築し、ローカルK8に再構築するプロセスがシステムで起動されます。</font><font style="vertical-align: inherit;">ですから、地域開発の問題を解決したいと思っています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K8の現実におけるスナップショットとデータベースのクローン作成</font></font></h2><br>
<i><b></b>:    copy-on-write.  ,      .   -. ,  GCP:         .   .         —      ,   ,      .    () —  ,  'provision'  .  ,     .</i><br>
<br>
<i>   ,  , ,      Docker'     ZFS, btrfs   LVM… —            .               ,   (   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">lazy load'</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多分時計）。</font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに、このデータを1〜2秒で取得し、テストを実行して破棄することができます。これらのスナップショットは、さまざまな問題を解決します。前者の場合-スケーリングして新しいレプリカを取得するため、そして後者の場合-テスト用。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：同意しない。通常、ボリュームのクローン作成はクラウドのタスクです。私はそれらの実装を監視しませんでしたが、ハードウェアでどのように実行するかを知っています。私たちにはCephがあります。その中には、物理​​ボリューム（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RBD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クローン</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">作成</font></i><font style="vertical-align: inherit;">し、数十ミリ秒で同じ特性、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IOPS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの</font><font style="vertical-align: inherit;">2番目のボリュームを取得する</font><font style="vertical-align: inherit;">ように指示</font><font style="vertical-align: inherit;">でき</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。内部にはトリッキーなコピーオンライトがあることを理解する必要があります。なぜクラウドは同じことをしないのですか？私は彼らがこれをやろうとしている何らかの方法であることを確信しています。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：しかし、インスタンスの起動、Dockerのそこへの移動などには数秒から数十秒かかります。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：なぜインスタンス全体を上げる必要があるのですか？しかし、32コア、16のインスタンスがあります...そして、それは何らかの形でそれに適合します-たとえば、4。 5番目を注文すると、インスタンスが上昇し、その後削除されます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい、興味深いことに、Kubernetesには別の話があります。私たちのデータベースはK8ではなく、1つのインスタンスです。しかし、数テラバイトのデータベースのクローン作成には2秒もかかりません。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：いいね。しかし、私の最初のメッセージは、これは一般的な解決策ではないということです。はい、すばらしいですが、Postgresのみが適切で、1つのノードでのみ使用できます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これはPostgresだけでなく、これらの計画は、前述のように、その方法でのみ機能します。しかし、計画に煩わされず、機能テストのためにすべてのデータが必要な場合、これはどのDBMSにも適しています。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：何年も前に、LVMスナップショットでこれを行いました。これは定番です。このアプローチは非常に積極的に使用されています。ステートフルなノードだけが苦痛です。それらを落としてはならないので、常にそれらについて覚えておいてください... </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ここで、何らかのハイブリッドの可能性が見えますか？ステートフルはある種のポッドであるとしましょう。それは複数の人々（多くのテスター）のために機能します。ボリュームは1つですが、ファイルシステムのおかげで、クローンはローカルにあります。ポッドが落下してもディスクは残ります。ポッドは上昇し、すべてのクローンに関する情報を考慮してすべてを取得し、「ここにこれらのポートにクローンがあり、さらに操作を開始します」と言います。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：技術的には、これはKubernetes内では1つのポッドであり、その中で多くのPostgresを実行していることを意味します。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：はい。彼には制限があります。たとえば、同時に働く人は10人までです。 20が必要な場合-そのような2番目のポッドを実行します。完全に現実的にそれを複製し、2番目の完全なボリュームを受け取ったら、同じ10個の「薄い」複製ができます。そのような機会を見ませんか？</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ここにセキュリティの問題を追加する必要があります。このような組織のオプションは、ファイルシステムで非標準の操作を実行できるため、このポッドが高い機能を備えていることを意味します。 -すべてが「正常に機能する」。サイズが変更され、複製されます...ボリュームがあります-「それに基づいて新しいボリュームを作成します」-1秒半後には必要なものが得られます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私は、何テラバイトも1秒半とは信じていません。</font><font style="vertical-align: inherit;">Cephでは、自分でそれを行い、雲について話します。</font><font style="vertical-align: inherit;">EC2でクラウドに移動し、数テラバイトのEBSボリュームのクローンを作成して、パフォーマンスを確認します。</font><font style="vertical-align: inherit;">数秒はかかりません。</font><font style="vertical-align: inherit;">彼らがそのような指標に達したとき、私は非常に興味があります。</font><font style="vertical-align: inherit;">あなたが何を話しているのか理解しましたが、私は同意しません。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：わかりました、しかし私は中期的に、短期ではなくそれを言いました。</font><font style="vertical-align: inherit;">数年間。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZalandoのPostgreSQL用Proオペレーター</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このミーティングの最中に、PostgreSQLオペレーターの歴史について語ったZalandoの元開発者であるAlexey Klyukinも彼女に加わりました：</font></font><br>
<br>
<blockquote>,     :  Postgres,  Kubernetes.       Zalando  2017- ,    ,    ,    .     Kubernetes,   ,     ,    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Kelsey Hightower</a>,  K8s,   :<br>
<br>
<i>«  managed-   ,     Kubernetes.   K8s , ,  ,   ,     -».</i><br>
<br>
   ,  ,   ,   Postgres  Kubernetes.       — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Patroni</a>.   failover  PostgreSQL,  , ..  etcd, consul  ZooKeeper      .  ,    ,  , ,   ,      —   ,     , —    split brain'. ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Docker-</a>  .<br>
<br>
,   auto failover         -  .       PaaS (Platform-as-a-Service).  Open Source',    ,    .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">STUPS</a>.<br>
<br>
  Kubernetes'  . ,    , K8s  ,   ,   production  .  , -, 2015  2016 .  2017-  Kubernetes  -  —    .<br>
<br>
     Docker-.  PaaS,   Docker.     K8s?      ?  ,      ,        — «», —   «».<br>
<br>
      AWS.     ,   AWS…<br>
<br>
   -  Kubernetes,  ,  K8s —   work in progress.   ,     .        Kubernetes,           ,     — , ,    . ,  ,   ,      …<br>
<br>
,    ,    Postgres,      (   — EBS,     AWS).   ,  -    resize: ,   EBS — 100 ,    ,    EBS  200 . ? ,   dump/restore   ,      .<br>
<br>
   resize,     EBS'         .    ,      Kubernetes'    API   resize'.     AWS,     API.<br>
<br>
         .    ,       AWS,        .  ,  Open Source-:  -      API —  .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">GitHub</a>, pull- —  Zalando         .  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Summer of Codeおよび他のいくつかの同様の取り組みで。</font><font style="vertical-align: inherit;">ザランドは非常に積極的に取り組んでいます。</font></font><br>
</blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSボーナス！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLとKubernetesのトピックに興味がある場合は、先週、次のPostgresが開催され、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZalandoのAlexander KukushkinがNikolaiと</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">話し合ったことにも注目し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">それからのビデオは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PPS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのブログも読んでください：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースとKubernetes（レビューとビデオレポート）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KusnetesへのCassandraの移行：機能とソリューション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">障害物のないMongoDBからKubernetesへの移行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesへの妨げのないRabbitMQの移行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。」</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479422/index.html">[ビデオアニメーション]有線の世界：海底ケーブルのネットワークが35年間で地球をどのように包囲してきたか</a></li>
<li><a href="../ja479426/index.html">セキュリティウィーク50：ConfluenceおよびLinuxでの中間者攻撃</a></li>
<li><a href="../ja479428/index.html">12月9日から15日までのモスクワでのデジタルイベント</a></li>
<li><a href="../ja479430/index.html">12月9〜15日のサンクトペテルブルクでのデジタルイベント</a></li>
<li><a href="../ja479432/index.html">Yandex.Maps：私はカードコントローラに行きました-私はすぐにユーザーの位置を取得しました（大丈夫、今は真剣に）</a></li>
<li><a href="../ja479442/index.html">Alexey Savvateev：社会分割のゲーム理論モデル（+ nginx調査）</a></li>
<li><a href="../ja479446/index.html">車はすでにテストを読んでいる人よりも先です。しかし、彼らは彼らが読んだものを理解していますか？</a></li>
<li><a href="../ja479450/index.html">AppCode 2019.3：より速く動作し、Swiftをよりよく理解し、Mac Catalystについて理解し、アセンブリメッセージを便利に表示します</a></li>
<li><a href="../ja479452/index.html">ドメインネームシステムの開発方法：ARPANET時代</a></li>
<li><a href="../ja479458/index.html">サーバールームの美しさまたは実用性</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>