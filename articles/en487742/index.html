<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèæ üí™üèæ üéâ Arbitrage Trading (Bellman-Ford Algorithm) üóìÔ∏è üé™ üë≤üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trading on the exchange is usually associated with risks. This is absolutely true for most trading strategies. The success of trade in these cases is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arbitrage Trading (Bellman-Ford Algorithm)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487742/"><img src="https://habrastorage.org/webt/kz/ba/aw/kzbaawpwmooth9c6xfhx6lfpxns.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trading on the exchange is usually associated with risks. </font><font style="vertical-align: inherit;">This is absolutely true for most trading strategies. </font><font style="vertical-align: inherit;">The success of trade in these cases is determined solely by the ability to correctly assess risks and manage them. </font><font style="vertical-align: inherit;">But not all trading strategies are. </font><font style="vertical-align: inherit;">There are risk-free strategies, which include, in particular, arbitration. </font><font style="vertical-align: inherit;">This article will explain what arbitration is and how to implement it using such a classical graph algorithm as the Bellman-Ford algorithm.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is arbitration?</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbitration</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a few logically related transactions aimed at profit from the difference in prices for the same or related assets at the same time in different markets (spatial arbitration), or in the same market at different points in time (temporary arbitration) . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a simple example, consider spatial arbitrage. In New York and London, deals can be made to buy dollars for euros and euros for dollars. In New York, this can be done at the rate of 4 dollars for 3 euros, and in London - at the rate of 5 dollars for 3 euros. This difference in rates opens up the possibility of spatial arbitration.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/ov/ly/geovlyungqgulaydt3rtrjzmkd8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With 4 dollars, in New York you can buy 3 euros. After that, in London, buy for these 3 euros 5 dollars. As you can see, such a simple sequence of transactions brings 1 dollar profit for every 4 dollars invested. Accordingly, if initially there is $ 4 million, then the profit will already be in a million.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the exchange rates (we do not consider the spread) for the same currency pair differ, the sequence of transactions required to implement the arbitrage strategy is very simple. </font><font style="vertical-align: inherit;">If the exchange rate for one currency pair is fixed, but several currency pairs are traded in parallel, arbitration is also possible, but the sequence of transactions will already be nontrivial. </font><font style="vertical-align: inherit;">For example, you can buy 4 euros for 5 dollars, 3 pounds for 4 euros, and then 6 dollars for 3 pounds. </font><font style="vertical-align: inherit;">The profit from such a sequence of transactions will be $ 1 for every 5 dollars invested. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9e/nd/yh/9endyhnxk1jmbo5ba8hlyajwseu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hundreds of currency pairs can be traded on the exchange, and exchange rates are constantly changing. </font><font style="vertical-align: inherit;">It is already impossible to understand what sequence of transactions will bring profit without an algorithmic solution.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transition to the algorithmic problem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine potential currency exchange transactions in an algorithmic form, namely in the form of a graph. The vertices in this graph represent currencies, and the edges are potential trades. The length of the rib corresponds to the exchange rate at which the transaction can be concluded.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ci/ne/tj/cinetjkda4mcofldh3ps80ben1y.png" width="50%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next question is how to find a sequence of transactions in such a column that will bring profit. Obviously, since at the beginning of the sequence and at the end it must be the same currency, the sequence must correspond to the cycle in the given graph. Next, you need to determine how the exchange rate between the two currencies is calculated if they are not exchanged directly, but through a certain third currency (or an arbitrary number of intermediate operations). Everything here is also quite simple. Such an exchange rate will be calculated as the product of the exchange rates of intermediate transactions. A profitable sequence of transactions becomes if this product takes a value less than one. In other words, if a unit of currency can be bought less than a unit of the same currency.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/77/vc/cr/77vccrb8qh4lsivbjwc0zvqjlis.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classical graph algorithms are poorly suited for working with product of edge lengths. </font><font style="vertical-align: inherit;">Such algorithms are mainly geared towards finding a path that is defined as the sum of these lengths. </font><font style="vertical-align: inherit;">However, to circumvent this limitation, there is a mathematical way to go from a product to a sum. </font><font style="vertical-align: inherit;">This way is logarithm. </font><font style="vertical-align: inherit;">If the product appears under the logarithm, then such a logarithm can be converted into the sum of the logarithms. </font><font style="vertical-align: inherit;">On the right side of this equation, the desired number is less than one, which means that the logarithm of this number should be less than zero.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s3/zm/m2/s3zmm2iszdtfgxqtuali7o5bqes.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4i/dd/zs/4iddzs5lxuah4pz6wwfbclu7pu4.png" width="50%"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dx/0q/i-/dx0qi-utvocjilv95msyhwzng1y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such a simple mathematical trick allows you to move from searching for a cycle whose product of edge lengths is less than one to finding a cycle whose sum of edge lengths is less than zero. </font><font style="vertical-align: inherit;">Such a task already looks more solvable by classical graph algorithms, and more precisely the Bellman-Ford algorithm.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bellman - Ford Algorithm</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bellman ‚Äì Ford</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algorithm </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">is</font></a><font style="vertical-align: inherit;"> usually used to find the distance from a given vertex to all other vertices of a graph, however, its modification also allows finding cycles of negative length. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The basic operation of this algorithm is </font><font style="vertical-align: inherit;">edge </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relaxation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The essence of this operation is as follows. </font><font style="vertical-align: inherit;">Suppose there is an edge</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.073ex" height="2.384ex" viewBox="0 -755.5 6059 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5629" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and also the previously calculated preliminary values ‚Äã‚Äãof distances to the peaks are known </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.009ex" viewBox="0 -755.5 429.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">To perform edge relaxation, it is necessary to calculate what the distance to the top would be</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.009ex" viewBox="0 -755.5 429.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if the path went through the top </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and rib </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.073ex" height="2.384ex" viewBox="0 -755.5 6059 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5629" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> a \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This distance is calculated as the sum of the distance to the top.</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and rib lengths </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.073ex" height="2.384ex" viewBox="0 -755.5 6059 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5629" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> a \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Further, if this distance is less than the current preliminary distance to</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then this is the very distance to </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corresponds and takes a new, just calculated, value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The rest of the algorithm is also uncomplicated. </font><font style="vertical-align: inherit;">Necessary</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> N </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> times (</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> N </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is the number of vertices of the graph) bypass the list of edges, applying a relaxation operation for each round. </font><font style="vertical-align: inherit;">The complexity of the algorithm is obtained</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo>&amp;#x2217;</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.701ex" height="2.009ex" viewBox="0 -755.5 2884.9 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMAIN-2217" x="1110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4D" x="1833" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>‚àó</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> N * M </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Where </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> N </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the number of vertices, and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.009ex" viewBox="0 -755.5 1051.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-15"> M </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- number of ribs). </font><font style="vertical-align: inherit;">For a graph without negative cycles, further edge relaxation will not lead to a change in the distance to the vertices. </font><font style="vertical-align: inherit;">At the same time, for a graph containing a negative cycle, relaxation will reduce the distance to the vertices and after</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> N </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detours. </font><font style="vertical-align: inherit;">This property can be used to find the desired cycle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following small implementation of the algorithm described above on Kotlin should help those who are more familiar with sorting out code.</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findNegativeCycle</span><span class="hljs-params">(nodes: <span class="hljs-type">Int</span>, edges: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">Edge</span>&gt;, source: <span class="hljs-type">Int</span>)</span></span>: List&lt;<span class="hljs-built_in">Int</span>&gt;? {
    <span class="hljs-comment">// Initialize distances and prev arrays. All distances but the distance to</span>
    <span class="hljs-comment">// the source node are infinite, distance to the source node is zero.</span>
    <span class="hljs-keyword">val</span> distances = DoubleArray(nodes) { <span class="hljs-keyword">if</span> (it == source) <span class="hljs-number">0.0</span> <span class="hljs-keyword">else</span> INFINITY }
    <span class="hljs-keyword">val</span> prev = IntArray(nodes) { -<span class="hljs-number">1</span> }<font></font>
<font></font>
    <span class="hljs-comment">// Relax all edges N times where N is the number of nodes.</span><font></font>
    repeat(nodes) {<font></font>
        edges.forEach { it.relax(distances, prev) }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// Try to relax at least one more edge. If it's possible memorize the node,</span>
    <span class="hljs-comment">// otherwise return from the method.</span>
    <span class="hljs-keyword">val</span> firstRelaxedEdge = edges.firstOrNull { it.relax(distances, prev) }
    <span class="hljs-keyword">var</span> node = firstRelaxedEdge?.to ?: <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><font></font>
<font></font>
    <span class="hljs-comment">// Step back N times where N is the number of nodes. As a result, the node will</span>
    <span class="hljs-comment">// be in the loop for sure.</span><font></font>
    repeat(nodes) {<font></font>
        node = prev[node]<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// Recover the loop by the node that is inside it and prev links.</span>
    <span class="hljs-keyword">val</span> lastNode = node
    <span class="hljs-keyword">return</span> buildList {
        <span class="hljs-keyword">do</span> {<font></font>
            add(node)<font></font>
            node = prev[node]<font></font>
        } <span class="hljs-keyword">while</span> (node != lastNode)<font></font>
<font></font>
        reverse()<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// Edge DTO with implemented relaxation operation.</span>
<span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Edge</span></span>(<span class="hljs-keyword">val</span> from: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> to: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> length: <span class="hljs-built_in">Double</span>) {<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">relax</span><span class="hljs-params">(distances: <span class="hljs-type">DoubleArray</span>, prev: <span class="hljs-type">IntArray</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">if</span> (distances[from] + length &gt;= distances[to]) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><font></font>
        }<font></font>
<font></font>
        distances[to] = distances[from] + length<font></font>
        prev[to] = from<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us examine an example with a small graph, which includes a cycle of negative length. For the algorithm to work, it is necessary for each vertex to maintain the current known distance to it, as well as a link to its previous vertex. The reference to the previous vertex in this case is determined by the successful relaxation of the rib. If the relaxation operation was successful, and the distance to the vertex was updated, then the link to the previous vertex of this vertex is also updated and takes the value of the source vertex of the specified edge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, first you need to initialize the vertices by setting the distance to all the vertices except the initial equal infinity. For the initial vertex, a distance of zero is set.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/6s/uo/pu6suoqkqyyerkmyewvj98y5yjo.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first round of all the ribs follows and their relaxation is performed. </font><font style="vertical-align: inherit;">Almost all relaxation do not give any result, except rib relaxation</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.073ex" height="2.384ex" viewBox="0 -755.5 6059 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5629" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-17"> a \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Relaxation of this rib allows you to update the distance to</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.009ex" viewBox="0 -755.5 429.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-18"> b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fe/_w/fy/fe_wfy6gspvn50o7_bavjjyofqi.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is followed by the second round of all edges of the graph and the corresponding relaxation. </font><font style="vertical-align: inherit;">This time, the result is relaxation of the ribs.</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.85ex" height="2.384ex" viewBox="0 -755.5 5963 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="5529" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> b \ rightarrow c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.059ex" height="2.384ex" viewBox="0 -755.5 6053 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="5529" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-20"> b \ rightarrow d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The distances to the peaks are updated.</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-21"> c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.009ex" viewBox="0 -755.5 523.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-22"> d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It should be noted here that the result depends on the order in which the edges are traversed.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wo/ic/ow/woicowjcjmsdfcadgevfrwnmqgq.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the third round of ribs, it is possible to successfully relax already three ribs, namely the ribs </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.152ex" height="2.384ex" viewBox="0 -755.5 6093 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1997" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4853" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="5569" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> s \ rightarrow d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.145ex" height="2.384ex" viewBox="0 -755.5 6090 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-65" x="5623" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-24"> d \ rightarrow e </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.059ex" height="2.384ex" viewBox="0 -755.5 6053 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5623" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-25"> d \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In this case, when the ribs are relaxed</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.152ex" height="2.384ex" viewBox="0 -755.5 6093 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1997" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4853" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="5569" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-26"> s \ rightarrow d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.059ex" height="2.384ex" viewBox="0 -755.5 6053 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5623" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-27"> d \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> already recorded distances to </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.009ex" viewBox="0 -755.5 523.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.009ex" viewBox="0 -755.5 429.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-29"> b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as corresponding links to previous vertices.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/09/hy/ea/09hyea_7-to__men0sxtbguxdzi.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the fourth round, rib relaxation operations are successfully completed. </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.85ex" height="2.384ex" viewBox="0 -755.5 5963 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="5529" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> b \ rightarrow c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.073ex" height="2.384ex" viewBox="0 -755.5 6059 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="5529" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-31"> b \ rightarrow a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In this case, already recorded values ‚Äã‚Äãof distances to the peaks are again updated.</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.509ex" viewBox="0 -540.2 529.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-32"> a </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-33"> c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as the corresponding links to previous vertices.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/q_/eh/roq_ehywkuqoenngzpoia5bxgjq.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fifth round is the last. </font><font style="vertical-align: inherit;">Ribs relax during this walk</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.152ex" height="2.384ex" viewBox="0 -755.5 6093 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1997" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4853" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="5569" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-34"> s \ rightarrow d </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.059ex" height="2.384ex" viewBox="0 -755.5 6053 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="5623" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-35"> d \ rightarrow b </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.145ex" height="2.384ex" viewBox="0 -755.5 6090 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="2051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-65" x="5623" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-36"> d \ rightarrow e </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Here you can see that the presence of a cycle of negative length already makes certain adjustments to the values ‚Äã‚Äãof distances to the peaks.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uy/a4/uc/uya4ucizg9qerxe1qpsze6fsi88.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After this tour, if the graph did not contain a cycle of negative length, the algorithm would be completed, since the relaxation of any edge would not have made any changes. </font><font style="vertical-align: inherit;">However, for this graph, due to the presence of a cycle of negative length, one can still find an edge whose relaxation will update the distance to one of the vertices.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/6i/e3/rm6ie33py8hohorp8p5zroljbsk.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An edge whose relaxation updates the distance to the summit is found. </font><font style="vertical-align: inherit;">This confirms the presence of a cycle of negative length. </font><font style="vertical-align: inherit;">Now you need to find this cycle itself. </font><font style="vertical-align: inherit;">It is important that the vertex, the distance to which is now updated, can be both inside the cycle and outside it. </font><font style="vertical-align: inherit;">In the example, this is the top</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.509ex" viewBox="0 -540.2 466.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-65" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-37"> e </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and she is out of cycle. </font><font style="vertical-align: inherit;">Next, you need to refer to the links to the previous vertices, which were carefully updated at all steps of the algorithm. </font><font style="vertical-align: inherit;">To be guaranteed to get into the cycle, you must step back on</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.009ex" viewBox="0 -755.5 888.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-38"> N </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peaks using these links. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, the transitions will be as follows:</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="65.752ex" height="2.384ex" viewBox="0 -755.5 28310 1026.6" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="1168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="1513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="1994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="2570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="2932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="3913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="4364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="4850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="5566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="6340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="6791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="7137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="7617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="8194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="8555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="9085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="9536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="9988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="10473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="11190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="11873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="12325" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="12670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="13151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="13727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="14089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="14618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="15070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="15521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="16007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-62" x="16723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="17403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="17854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="18200" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="18680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="19257" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="19618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="20148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="20599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="21051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="21536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-64" x="22253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="23026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-69" x="23478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-67" x="23823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-68" x="24304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-74" x="24880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-61" x="25242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="25771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-72" x="26223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-6F" x="26674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-77" x="27160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="27876" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>b</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-39"> e \ rightarrow d \ rightarrow c \ rightarrow b \ rightarrow d \ rightarrow c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">So the top is located</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-40"> c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which is guaranteed to lie in a cycle of negative length. </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/m_/jj/mvm_jj72g6wtxkeu1ejv7ojaeoi.png" width="75%"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further, a matter of technology. </font><font style="vertical-align: inherit;">To return the desired cycle, you need to iterate again using the links to the previous vertices until the vertex meets again</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-41"> c </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This will mean that the cycle has closed. </font><font style="vertical-align: inherit;">All that remains is to reverse the order, since the iteration was reversed during iterations over links to previous vertices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above algorithm assumes the presence of some initial vertex from which the distances are calculated. </font><font style="vertical-align: inherit;">The presence of such a vertex is not necessary for the algorithm to work, but it was introduced to a greater extent to match the original Bellman - Ford algorithm. </font><font style="vertical-align: inherit;">If the subject of interest is a cycle of negative length, then we can assume that all the vertices of a given graph are initial. </font><font style="vertical-align: inherit;">In other words, that the distance to all the vertices is initially zero.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the Bellman-Ford algorithm in the arbitrage trading problem is an excellent example of how classical algorithms can solve real business problems, in particular, in the financial sphere. </font><font style="vertical-align: inherit;">Asymptotic complexity of the algorithm, equal to</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>N</mi><mn>3</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.177ex" height="2.384ex" viewBox="0 -916.9 1368 1026.6" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/487742/&amp;usg=ALkJrhjXOUVCsGUjYux20i62wsRiVM9Z2w#MJMAIN-33" x="1292" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>N</mi><mn>3</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-42"> N ^ 3 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for a fully connected graph, it may turn out to be quite large. </font><font style="vertical-align: inherit;">This really needs to be remembered. </font><font style="vertical-align: inherit;">However, in many cases, such as currency exchange, this complexity does not create any problems due to the relatively small </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">number of nodes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the graph.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487728/index.html">@Pythonetc compilation, January 2020</a></li>
<li><a href="../en487730/index.html">Natural Language Processing. Results 2019 and trends for 2020</a></li>
<li><a href="../en487734/index.html">Speeding up Entity Framework Core</a></li>
<li><a href="../en487738/index.html">Schema animation in SCADA</a></li>
<li><a href="../en487740/index.html">Assembling a portable magnetometer</a></li>
<li><a href="../en487744/index.html">FARO Introduces FOCUS S 70 Laser 3D Scanner</a></li>
<li><a href="../en487746/index.html">Eternal</a></li>
<li><a href="../en487748/index.html">$ 3 hardware encryption key - is this possible?</a></li>
<li><a href="../en487750/index.html">Some subtleties of injection collections in Spring</a></li>
<li><a href="../en487752/index.html">Optimize storage: a case of unification and lower cost of ownership</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>