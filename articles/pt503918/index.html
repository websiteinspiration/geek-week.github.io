<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÆ üë©üèæ‚ÄçüöÄ ‚ò¢Ô∏è Gerenciando pacotes com m√≥dulos Go: um guia pragm√°tico üë©‚Äçüéì ‚óΩÔ∏è üò∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° a todos. Antecipando o in√≠cio do curso Golang Developer, preparamos outra tradu√ß√£o interessante para voc√™.
 
 
 Os m√≥dulos s√£o uma maneira de lida...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Gerenciando pacotes com m√≥dulos Go: um guia pragm√°tico</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/503918/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ol√° a todos. </font><font style="vertical-align: inherit;">Antecipando o in√≠cio do curso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Golang Developer,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> preparamos outra tradu√ß√£o interessante para voc√™.</font></font></b></i><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os m√≥dulos s√£o uma maneira de lidar com depend√™ncias no Go. Inicialmente apresentados como um experimento, os m√≥dulos devem ser introduzidos no campo como um novo padr√£o para gerenciar pacotes da vers√£o 1.13. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acho esse t√≥pico incomum o suficiente para iniciantes vindos de outros idiomas e, por isso, decidi coletar algumas id√©ias e dicas aqui para ajudar outras pessoas como eu a ter uma id√©ia do gerenciamento de pacotes no Go. Come√ßaremos com uma introdu√ß√£o geral e passaremos para os aspectos menos √≥bvios, incluindo o uso da pasta vendor, o uso de m√≥dulos com o Docker no desenvolvimento, as depend√™ncias de ferramentas etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ j√° conhece os m√≥dulos Go e conhece o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como as costas da sua m√£o, este artigo provavelmente n√£o ser√° muito √∫til para voc√™. </font><font style="vertical-align: inherit;">Por√©m, quanto ao resto, ele pode economizar v√°rias horas de tentativa e erro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, se voc√™ estiver a caminho, entre e aproveite o passeio.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/tr/d9/eq/trd9eqcuki5uwi4w5b2gexcp8q4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Come√ßo r√°pido</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o controle de vers√£o j√° estiver integrado ao seu projeto, voc√™ pode simplesmente executar</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou especifique o caminho para o m√≥dulo manualmente. </font><font style="vertical-align: inherit;">√â algo como um nome, URL e caminho de importa√ß√£o para o seu pacote:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod init github.com/you/hello</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso criar√° um arquivo </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que tamb√©m define os requisitos e o lochit do projeto, dependendo da vers√£o correta (como uma analogia para voc√™, como √© </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combinada em um √∫nico arquivo):</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para adicionar uma nova depend√™ncia ao seu projeto: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que, embora voc√™ n√£o possa especificar um intervalo de vers√µes com go get, o que voc√™ define aqui n√£o √© uma vers√£o espec√≠fica, mas uma vers√£o m√≠nima. </font><font style="vertical-align: inherit;">Como veremos mais adiante, existe uma maneira de atualizar as depend√™ncias normalmente de acordo com sempre.</font></font></i><br>
<br>
<pre><code class="go hljs"># use Git tags
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@v4<span class="hljs-number">.0</span><span class="hljs-number">.1</span><font></font>
# or Git branch name<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@master<font></font>
# or Git commit hash<font></font>
<span class="hljs-keyword">go</span> get github.com/<span class="hljs-keyword">go</span>-chi/chi@<span class="hljs-number">08</span>c92af</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, nosso arquivo √© </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o seguinte:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible <span class="hljs-comment">// indirect</span></code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O sufixo √© </font></font><code>+incompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adicionado a todos os pacotes que ainda n√£o est√£o configurados para os m√≥dulos Go ou violam suas regras de controle de vers√£o. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como n√£o importamos este pacote em nenhum lugar do nosso projeto, ele foi marcado como </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Podemos arrumar isso com o seguinte comando:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod tidy</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependendo do estado atual do seu reposit√≥rio, ele excluir√° um m√≥dulo n√£o utilizado ou excluir√° um coment√°rio </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se alguma depend√™ncia por si s√≥ n√£o tiver </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(por exemplo, ainda n√£o estiver configurada para m√≥dulos), todas as depend√™ncias ser√£o gravadas no arquivo pai </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(como op√ß√£o, seu arquivo </font></font><code>go.mod)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juntamente com um coment√°rio </font></font><code>// indirect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para indicar que n√£o s√£o de importa√ß√£o direta Em seu</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
plano global, o objetivo </font></font><code>go mod tidy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m √© adicionar as depend√™ncias necess√°rias para outras combina√ß√µes de SO, arquiteturas e tags de compila√ß√£o. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execute-o antes de cada vers√£o.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Certifique-se de criar um arquivo ap√≥s adicionar a depend√™ncia</font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Voc√™ pode pensar que este √© um arquivo de bloqueio. </font><font style="vertical-align: inherit;">Mas, na verdade, ele </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j√° fornece informa√ß√µes suficientes para compila√ß√µes 100% reproduz√≠veis. </font><font style="vertical-align: inherit;">O arquivo </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© criado para fins de verifica√ß√£o: cont√©m as somas de verifica√ß√£o criptogr√°ficas esperadas do conte√∫do de vers√µes individuais do m√≥dulo. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em parte porque n√£o √© </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um arquivo de bloqueio, ele salva as somas de verifica√ß√£o escritas para a vers√£o do m√≥dulo, mesmo depois que voc√™ para de us√°-lo. </font><font style="vertical-align: inherit;">Isso permite que voc√™ verifique as somas de verifica√ß√£o se continuar usando-o posteriormente, o que fornece seguran√ßa adicional.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_5/j8/vi/_5j8vigrklvhkwaucssmy7zaf88.png"><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Mkcert acabou de migrar para os m√≥dulos (com fornecedor / para compatibilidade com vers√µes anteriores) e tudo correu bem </font></font></i> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/FiloSottile/mkcert/commit/26ac5f35395fb9cba3805faf1a5a04d260271291</font></font></a><br>
<br>
<pre><code class="go hljs">$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod init<font></font>
$ GO111MODULE=on go1<span class="hljs-number">.11</span>rc1 mod vendor<font></font>
$ git add <span class="hljs-keyword">go</span>.mod <span class="hljs-keyword">go</span>.sum vendor<font></font>
$ git rm Gopkg.lock Gopkg.toml Makefile</code></pre><br>
<img src="https://habrastorage.org/webt/kt/ch/ro/ktchrocah4xszqqrfkqtug3qzty.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQ: Devo cometer </font></font><code>go.sum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no git? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A: Definitivamente sim. </font><font style="vertical-align: inherit;">Com isso, os propriet√°rios de suas fontes n√£o precisam confiar em outros reposit√≥rios do GitHub e propriet√°rios de caminhos de importa√ß√£o personalizados. </font><font style="vertical-align: inherit;">J√° a caminho de n√≥s, algo melhor, mas por enquanto esse √© o mesmo modelo dos hashes nos arquivos de bloqueio.</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os comandos </font></font><code>go build</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>go test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carregar√£o automaticamente todas as depend√™ncias ausentes, embora voc√™ possa fazer isso explicitamente com a ajuda de </font></font><code>go mod download</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preencher previamente os caches locais que podem ser √∫teis para o IC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padr√£o, todos os nossos pacotes de todos os projetos s√£o carregados para o diret√≥rio </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Discutiremos isso com mais detalhes posteriormente.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizando vers√µes do pacote</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode usar </font></font><code>go get -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanto </font></font><code>go get -u=patch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para atualizar depend√™ncias para a √∫ltima vers√£o menor ou remendo, respectivamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas voc√™ n√£o pode atualizar para vers√µes principais como essa. </font><font style="vertical-align: inherit;">O c√≥digo inclu√≠do nos m√≥dulos Go deve cumprir tecnicamente as seguintes regras:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine semver (tag de exemplo VCS v1.2.3).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se o m√≥dulo for da vers√£o v2 ou superior, a vers√£o principal do m√≥dulo dever√° ser inclu√≠da </font></font><code>/vN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no final do caminho do m√≥dulo usado no arquivo </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e no caminho de importa√ß√£o do pacote:</font></font></li>
</ul><br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> <span class="hljs-string">"github.com/you/hello/v2"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparentemente, isso √© feito para que diferentes vers√µes dos pacotes possam ser importadas em um assembly (consulte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o problema de depend√™ncia de diamante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em poucas palavras, o Go espera que voc√™ seja muito cuidadoso ao apresentar as principais vers√µes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Substituindo M√≥dulos Importados</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode especificar o m√≥dulo necess√°rio para sua pr√≥pria bifurca√ß√£o ou at√© o caminho local para o arquivo usando a diretiva </font></font><code>replace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -replace github.com/<span class="hljs-keyword">go</span>-chi/chi=./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultado:</font></font><br>
<br>
<pre><code class="go hljs">module github.com/you/hello
<span class="hljs-keyword">go</span> <span class="hljs-number">1.12</span>
require github.com/<span class="hljs-keyword">go</span>-chi/chi v4<span class="hljs-number">.0</span><span class="hljs-number">.2</span>+incompatible<font></font>
replace github.com/<span class="hljs-keyword">go</span>-chi/chi =&gt; ./packages/chi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode excluir a linha manualmente ou executar:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod edit -dropreplace github.com/<span class="hljs-keyword">go</span>-chi/chi</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de Depend√™ncias do Projeto </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Historicamente, todo o c√≥digo Go foi armazenado em um reposit√≥rio mono gigante, porque √© assim que o Google organiza sua base de c√≥digos e isso afeta o design da linguagem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os m√≥dulos Go s√£o um desvio dessa abordagem. Voc√™ n√£o precisa mais manter todos os seus projetos </font></font><code>$GOPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, tecnicamente todas as suas depend√™ncias baixadas ainda s√£o inseridas </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se voc√™ usar cont√™ineres do Docker para desenvolvimento local, isso pode ser um problema, pois as depend√™ncias s√£o armazenadas fora do projeto. Por padr√£o, eles simplesmente n√£o s√£o vis√≠veis no seu IDE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ye/2c/_o/ye2c_o9jcsodsrhdekb4djz7lve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso geralmente n√£o √© um problema para outros idiomas, mas foi o que encontrei pela primeira vez ao trabalhar com a base de c√≥digo Go. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Felizmente, existem v√°rias maneiras (n√£o documentadas) de resolver esse problema.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√£o 1. Instale o GOPATH dentro do diret√≥rio do projeto.</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä primeira vista, isso pode parecer contra-intuitivo, mas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se voc√™ executar o Go a partir de um cont√™iner</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , poder√° substituir o GOPATH para que aponte para o diret√≥rio do projeto para que os pacotes fiquem acess√≠veis a partir do host:</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    environment:<font></font>
      #        - /code/.<span class="hljs-keyword">go</span>/pkg/mod<font></font>
      - GOPATH=/code/.<span class="hljs-keyword">go</span><font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os IDEs populares devem poder instalar o GOPATH no n√≠vel do projeto (espa√ßo de trabalho): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_t/jz/d_/_tjzd_trva2fekp6vmt5ewc_xke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica desvantagem dessa abordagem √© a falta de intera√ß√£o com o tempo de execu√ß√£o do Go no computador host. </font><font style="vertical-align: inherit;">Voc√™ deve executar todos os comandos Go dentro do cont√™iner.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√£o 2: vendendo suas depend√™ncias</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra maneira √© copiar as depend√™ncias do seu projeto para uma pasta </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve-se observar imediatamente: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√ÉO permitimos que o</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Go fa√ßa o upload direto de materiais para a pasta do fornecedor: isso n√£o √© poss√≠vel com os m√≥dulos. </font><font style="vertical-align: inherit;">Simplesmente copiamos pacotes j√° baixados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, se voc√™ desatar as suas depend√™ncias, como no exemplo acima, limpe </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e tente adicionar v√°rias novas depend√™ncias ao seu projeto, voc√™ ver√° o seguinte:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Go reconstruir√° o cache de download de todos os pacotes de software </font></font><code>$GOPATH/pkg/mod/cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos os m√≥dulos carregados ser√£o copiados para </font></font><code>$GOPATH/pkg/mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E, finalmente, o Go copiar√° esses m√≥dulos para uma </font></font><code>vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pasta, excluindo exemplos, testes e alguns outros arquivos dos quais voc√™ n√£o depende diretamente.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, faltam muitas coisas nessa pasta de fornecedor rec√©m-criada: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rj/w-/lt/rjw-ltm1y1s8jwia34bfars6ngw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um arquivo t√≠pico do Docker Compose se parece com isso (observe as liga√ß√µes do volume):</font></font><br>
<br>
<pre><code class="go hljs">version: <span class="hljs-string">'3.7'</span><font></font>
<font></font>
services:<font></font>
  app:<font></font>
    command: tail -f /dev/null<font></font>
    image: golang:<span class="hljs-number">1.12</span><span class="hljs-number">.6</span>-stretch<font></font>
    ports:<font></font>
      - <span class="hljs-number">8000</span>:<span class="hljs-number">8000</span><font></font>
    volumes:<font></font>
     #    <span class="hljs-keyword">go</span>,           <font></font>
      - modules:/<span class="hljs-keyword">go</span>/pkg/mod/cache<font></font>
      - ./:/code:cached<font></font>
    working_dir: /code <font></font>
<font></font>
volumes:<font></font>
  modules:<font></font>
    driver: local</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por favor, note que eu N√ÉO coloque essa pasta de fornecedores em quadrinhos no sistema de controle de vers√£o ou n√£o a usarei na produ√ß√£o. </font><font style="vertical-align: inherit;">Este √© um script de desenvolvimento estritamente local, que geralmente pode ser encontrado em outros idiomas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, quando leio </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coment√°rios de alguns mantenedores do Go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e algumas ofertas relacionadas a vendas parciais (?), Tenho a impress√£o de que esse recurso foi originalmente destinado n√£o a esse caso de usu√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comentaristas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do reddit me ajudou a esclarecer isso:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geralmente, as pessoas vendem suas depend√™ncias por motivos como o desejo de ter assemblies restritos sem acesso √† rede, al√©m da disponibilidade de uma c√≥pia de depend√™ncias prontas no caso de uma falha ou reposit√≥rio do github desaparecer, e a capacidade de auditar com mais facilidade as altera√ß√µes de depend√™ncia usando as ferramentas VCS padr√£o, etc. .</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sim, ele n√£o se parece com nada do fato de que eu poderia estar interessado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acordo com o comando Ir, voc√™ pode facilmente ativar a venda, definindo uma vari√°vel de ambiente </font></font><code>GOFLAGS=-mod=vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Eu n√£o recomendo fazer isso. O uso de sinalizadores simplesmente ser√° interrompido </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem fornecer outros benef√≠cios ao seu fluxo de trabalho di√°rio: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/ul/uw/dfuluwbr13eacullfzphguhrbeo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, o √∫nico local necess√°rio para ativar a venda √© o seu IDE:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/x2/pz/jvx2pzgtrx5wcfmlum4s5hheorw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s algumas tentativas e erros, criei o procedimento a seguir para adicionar depend√™ncias de fornecedores nessa abordagem.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 1. Requisito</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode exigir uma depend√™ncia com </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> get github.com/rs/zerolog@v1<span class="hljs-number">.14</span><span class="hljs-number">.3</span></code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 2. Importar</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, importe-o em algum lugar do seu c√≥digo:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">import</span> (<font></font>
   _ <span class="hljs-string">"github.com/rs/zerolog"</span>
)</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 3. Venda</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por fim, reabra suas depend√™ncias:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">go</span> mod vendor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existe uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposta pendente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para permitir que o fornecedor de mod go aceite determinados modelos de m√≥dulo que podem (ou n√£o) resolver alguns dos problemas associados a esse fluxo de trabalho. </font></font><br>
<br>
<code>go mod vendor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j√° requer importa√ß√µes perdidas automaticamente, portanto, a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etapa 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© opcional neste fluxo de trabalho (se voc√™ n√£o desejar especificar restri√ß√µes de vers√£o). No entanto, sem a etapa 2, ele n√£o receber√° o pacote baixado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa abordagem funciona melhor com o sistema host, mas √© bastante confusa quando se trata de editar suas depend√™ncias.</font></font><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pessoalmente, acho que redefinir o GOPATH √© uma abordagem mais limpa, pois n√£o sacrifica a funcionalidade </font></font><code>go get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">No entanto, eu queria mostrar as duas estrat√©gias, porque a pasta do fornecedor pode ser mais familiar para pessoas provenientes de outros idiomas, como PHP, Ruby, Javascript, etc. Como voc√™ pode ver na fraude descrita neste artigo, esta n√£o √© uma escolha particularmente boa para o Go.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depend√™ncias da ferramenta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez seja necess√°rio instalar algumas ferramentas baseadas em Go que n√£o s√£o importadas, mas usadas como parte do ambiente de desenvolvimento do projeto. </font><font style="vertical-align: inherit;">Um exemplo simples dessa ferramenta √© o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompileDaemon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que pode monitorar seu c√≥digo em busca de altera√ß√µes e reiniciar seu aplicativo. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abordagem </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">oficialmente recomendada</font></a><font style="vertical-align: inherit;"> √© adicionar um </font></font><code>tools.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo (o nome n√£o importa) com o seguinte conte√∫do:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// +build tools</span>
<span class="hljs-keyword">package</span> tools
<span class="hljs-keyword">import</span> (<font></font>
_ <span class="hljs-string">"github.com/githubnemo/CompileDaemon"</span>
)</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A limita√ß√£o </font></font><code>// +build tools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impede que seus assemblies regulares realmente importem sua ferramenta.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A express√£o import permite que os comandos go gravem com precis√£o as informa√ß√µes da vers√£o de suas ferramentas no arquivo do </font></font><code>go.mod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√≥dulo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o √© s√≥ isso. </font><font style="vertical-align: inherit;">Espero que voc√™ n√£o fique t√£o confuso quanto eu quando comecei a usar os m√≥dulos Go. </font><font style="vertical-align: inherit;">Voc√™ pode visitar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki Go Modules</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para obter mais detalhes.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entre no curso.</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt503904/index.html">O mundo en mundos, ou matem√°tica para as humanidades</a></li>
<li><a href="../pt503906/index.html">LabVIEW NXG - Tipos de dados simples e coer√ß√£o de tipos</a></li>
<li><a href="../pt503908/index.html">Ligue para bibliotecas compartilhadas do Similink</a></li>
<li><a href="../pt503910/index.html">Experi√™ncias com pessoas que foram para "udalenka"</a></li>
<li><a href="../pt503916/index.html">Aprendendo a negociar na bolsa. Parte um: configurando um ambiente de teste</a></li>
<li><a href="../pt503920/index.html">Como testamos os sistemas de microfone no STM32: a experi√™ncia dos desenvolvedores de dispositivos Yandex</a></li>
<li><a href="../pt503922/index.html">Por que a UE erradica paredes de biscoitos</a></li>
<li><a href="../pt503924/index.html">Vis√£o geral do scanner 3D intraoral Medit i500</a></li>
<li><a href="../pt503926/index.html">Quem √© quem no ecossistema de pagamentos 2020. Parte 2</a></li>
<li><a href="../pt503928/index.html">Irriga√ß√£o por aerossol VS: qual √© melhor e h√° alguma diferen√ßa?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>