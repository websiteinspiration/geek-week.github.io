<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’ â˜¸ï¸ ğŸ•ï¸ ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œçš„æ—¶é—´åºåˆ—é¢„æµ‹ ğŸ§“ğŸ½ â— ğŸ¤ª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æ™®éè‡ªæˆ‘éš”ç¦»çš„èƒŒæ™¯ä¸‹è¿›è¡Œè¿œç¨‹æ“ä½œä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„åæœã€‚å’Œæƒ…æ„Ÿå€¦æ€ -ä¸ç®¡èµ°åˆ°å“ªé‡Œï¼Œå®ƒæ¯•ç«Ÿç¦»å±‹é¡¶éƒ½ä¸è¿œã€‚åœ¨è¿™æ–¹é¢ï¼Œä»–å’Œè®¸å¤šäººä¸€æ ·ï¼Œè¯•å›¾é€šè¿‡åˆ†é…æ—¶é—´å®‰æ’å…¶ä»–è¯¾ç¨‹æ¥â€œé•‡å®šâ€è‡ªå·±ï¼Œå¹¶å¼€å§‹å°†æœ€æœ‰è¶£çš„æ–‡ç« ä»è‹±è¯­ç¿»è¯‘æˆä¿„è¯­ï¼šâ€œæ‚¨å°†æœºå™¨å­¦ä¹ å¸¦ç»™å¤§ä¼—ï¼â€ã€‚å¦‚æœæ‚¨å¯¹ä¿„è¯­è¯»è€…æœ‰å…³äºè¯­ä¹‰å†…å®¹å’Œæ­¤æ–‡æœ¬ç¿»è¯‘çš„å»ºè®®ï¼Œè¯·å‚åŠ è®¨è®ºã€‚...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œçš„æ—¶é—´åºåˆ—é¢„æµ‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495884/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ™®éè‡ªæˆ‘éš”ç¦»çš„èƒŒæ™¯ä¸‹è¿›è¡Œè¿œç¨‹æ“ä½œä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„åæœã€‚å’Œæƒ…æ„Ÿå€¦æ€ -ä¸ç®¡èµ°åˆ°å“ªé‡Œï¼Œå®ƒæ¯•ç«Ÿç¦»å±‹é¡¶éƒ½ä¸è¿œã€‚åœ¨è¿™æ–¹é¢ï¼Œä»–å’Œè®¸å¤šäººä¸€æ ·ï¼Œè¯•å›¾é€šè¿‡åˆ†é…æ—¶é—´å®‰æ’å…¶ä»–è¯¾ç¨‹æ¥â€œé•‡å®šâ€è‡ªå·±ï¼Œå¹¶å¼€å§‹å°†æœ€æœ‰è¶£çš„æ–‡ç« ä»è‹±è¯­ç¿»è¯‘æˆä¿„è¯­ï¼šâ€œæ‚¨å°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœºå™¨å­¦ä¹ </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸¦ç»™å¤§ä¼—ï¼â€ã€‚å¦‚æœæ‚¨å¯¹ä¿„è¯­è¯»è€…æœ‰å…³äºè¯­ä¹‰å†…å®¹å’Œæ­¤æ–‡æœ¬ç¿»è¯‘çš„å»ºè®®ï¼Œè¯·å‚åŠ è®¨è®ºã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3d7/fe4/946/3d7fe49466cad76814b37e73ec1bc49a.jpg" alt="å›¾ç‰‡"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œè¿™æ˜¯</font><font style="vertical-align: inherit;">æ¥è‡ªtensorflowæ‰‹å†Œéƒ¨åˆ†</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¶é—´åºåˆ—é¢„æµ‹</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡µé¢çš„ç¿»è¯‘</font><font style="vertical-align: inherit;">ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æˆ‘æ‰€æ·»åŠ çš„å†…å®¹ä»¥åŠç¿»è¯‘æ’å›¾æ—¨åœ¨å¸®åŠ©ç†è§£MLå’Œè®¡é‡ç»æµå­¦ä¸­æœ€æœ‰è¶£çš„é¢†åŸŸä¹‹ä¸€ï¼Œå³é¢„æµ‹æ—¶é—´åºåˆ—ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¿»è¯‘å‰çš„å°ä»‹ç»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ‰‹å†Œæ˜¯å¯¹åŸºäºä¸€ç»´æ—¶é—´åºåˆ—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå•å˜é‡æ—¶é—´åºåˆ—ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œå¤šå…ƒæ—¶é—´åºåˆ—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå¤šå˜é‡æ—¶é—´åºåˆ—ï¼‰çš„</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ°”æ¸©é¢„æµ‹çš„æè¿°</font><font style="vertical-align: inherit;">ã€‚å¯¹äºæ¯ä¸ªéƒ¨åˆ†ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¾“å…¥æ•°æ®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº”è¯¥åšç›¸åº”çš„å‡†å¤‡ã€‚è€ƒè™‘åˆ°æœ¬æŒ‡å—ä¸­è€ƒè™‘çš„æ°”è±¡æ•°æ®é›†ï¼Œåˆ†ç¦»å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8fa/31a/a75/8fa31aa7531d8589dcee2ae93454a430.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºæœ‰å…³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å–</font><font style="vertical-align: inherit;">ä»€ä¹ˆå’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å–</font><font style="vertical-align: inherit;">ä»€ä¹ˆçš„é—®é¢˜</font><font style="vertical-align: inherit;">ï¼Œå³å¦‚ä½•ä¸ºæœ‰ç›‘ç£è®­ç»ƒçš„è¯¾ç¨‹å‡†å¤‡æ•°æ®çš„é—®é¢˜ï¼Œä»ä»¥ä¸‹æ’å›¾ä¸­å°†æ˜¾è€Œæ˜“è§ã€‚æˆ‘åªæ³¨æ„åˆ°ç”¨äºä¸€ç»´å’Œå¤šç»´æ—¶é—´åºåˆ—çš„ç›®æ ‡å‘é‡ï¼ˆYï¼‰çš„å½¢æˆæ˜¯ç›¸åŒçš„ï¼šç›®æ ‡å‘é‡æ˜¯æ ¹æ®ç¬¦å·</font><i><font style="vertical-align: inherit;">Tï¼ˆdegCï¼‰è¿›è¡Œ</font></i><font style="vertical-align: inherit;">ç¼–è¯‘çš„</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆæ°”æ¸©ï¼‰ã€‚å®ƒä»¬ä¹‹é—´çš„å·®å¼‚è¢«â€œåŸ‹æ²¡â€åœ¨å½¢æˆä¸€ç»„è¾“å…¥åˆ°æ¨¡å‹è¾“å…¥çš„ç‰¹å¾ä¸­ï¼šå¯¹äºé¢„æµ‹æœªæ¥æ¸©åº¦çš„ä¸€ç»´æ—¶é—´åºåˆ—ï¼Œè¾“å…¥çŸ¢é‡ï¼ˆXï¼‰åŒ…å«ä¸€ä¸ªç‰¹å¾ï¼šå®é™…ä¸Šæ˜¯æ°”æ¸©ï¼›å¹¶ä¸”å¯¹äºå¤šç»´-å¤§äºä¸€ä¸ªï¼šé™¤äº†ç©ºæ°”æ¸©åº¦å¤–ï¼Œåœ¨æœ¬æŒ‡å—çš„ç¤ºä¾‹ä¸­è¿˜ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pï¼ˆmbarï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå¤§æ°”å‹ï¼‰å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rhoï¼ˆg / m ** 3ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆæ¹¿åº¦ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œä»ä½¿ç”¨å¤šç»´è¾“å…¥çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªæ¸©åº¦é¢„æµ‹çš„ä¾‹å­çœ‹èµ·æ¥å¾ˆæµ…ï¼Œä»¤äººä¿¡æœï¼šå¯¹äºæ¸©åº¦é¢„æµ‹ï¼Œæœ€ç›¸å…³çš„ç¬¦å·æ˜¯æ¸©åº¦ã€‚ä½†æ˜¯ï¼Œç»å¯¹ä¸æ˜¯è¿™æ ·ï¼šä¸ºäº†å¯¹ç©ºæ°”æ¸©åº¦è¿›è¡Œå®šæ€§é¢„æµ‹ï¼Œå¿…é¡»è€ƒè™‘è®¸å¤šå› ç´ ï¼ŒåŒ…æ‹¬åœ°çƒè¡¨é¢çš„ç©ºæ°”æ‘©æ“¦ç­‰ã€‚å¦å¤–ï¼Œåœ¨å®è·µä¸­ï¼Œæœ‰äº›äº‹æƒ…è¿œéæ˜¾è€Œæ˜“è§ï¼Œç›®æ ‡å‘é‡å¯èƒ½æ˜¯å¤§æ‚çƒ©ï¼ˆæˆ–ç½—å®‹æ±¤ï¼‰çš„å½¢å¼ã€‚åœ¨è¿™æ–¹é¢ï¼Œæ¢ç´¢æ€§çš„æ•°æ®åˆ†æä»¥åŠä¸ºåç»­å½¢æˆå¤šç»´è¾“å…¥è€Œé€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾æ˜¯å”¯ä¸€æ­£ç¡®çš„å†³å®šã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œä¸‹é¢ä»‹ç»äº†æ‰‹å†Œçš„ç¿»è¯‘ã€‚é™„åŠ æ–‡æœ¬å°†ä»¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–œä½“æ˜¾ç¤º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¶é—´åºåˆ—é¢„æµ‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æŒ‡å—æ˜¯ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNSï¼Œæ¥è‡ªè‹±è¯­</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€’å½’ç¥ç»ç½‘ç»œï¼ŒRNN</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰çš„</font><font style="vertical-align: inherit;">æ—¶é—´åºåˆ—é¢„æµ‹çš„ç®€ä»‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç¬¬ä¸€éƒ¨åˆ†æè¿°åŸºäºä¸€ç»´æ—¶é—´åºåˆ—çš„æ°”æ¸©é¢„æµ‹ï¼Œç¬¬äºŒéƒ¨åˆ†åŸºäºå¤šç»´æ—¶é—´åºåˆ—ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-keyword">import</span> matplotlib <span class="hljs-keyword">as</span> mpl
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
mpl.rcParams[<span class="hljs-string">'figure.figsize'</span>] = (<span class="hljs-number">8</span>, <span class="hljs-number">6</span>)<font></font>
mpl.rcParams[<span class="hljs-string">'axes.grid'</span>] = <span class="hljs-literal">False</span>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç»„æ°”è±¡æ•°æ®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ç”Ÿç‰©åœ°çƒåŒ–å­¦ç ”ç©¶æ‰€çš„</font></a><font style="vertical-align: inherit;">æ°´æ–‡</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">æ°”è±¡å°ä¸Š</font></a><font style="vertical-align: inherit;">è®°å½•</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çš„äººå·¥ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æ°”è±¡æ•°æ®æ—¶é—´åºåˆ—çš„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰ç¤ºä¾‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ä»¥ </font><font style="vertical-align: inherit;">é©¬å…‹æ–¯Â·æ™®æœ—å…‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤æ•°æ®é›†åŒ…æ‹¬è‡ª2003å¹´ä»¥æ¥æ¯10åˆ†é’Ÿè¿›è¡Œçš„14ç§ä¸åŒæ°”è±¡æŒ‡æ ‡çš„æµ‹é‡ï¼ˆä¾‹å¦‚æ°”æ¸©ï¼Œå¤§æ°”å‹ï¼Œæ¹¿åº¦ï¼‰ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†èŠ‚çœæ—¶é—´å’Œå†…å­˜ä½¿ç”¨é‡ï¼Œæœ¬æ‰‹å†Œå°†ä½¿ç”¨2009å¹´è‡³2016å¹´çš„æ•°æ®ã€‚</font><font style="vertical-align: inherit;">æ•°æ®é›†çš„è¿™ä¸€éƒ¨åˆ†æ˜¯ç”±FranÃ§oisCholletä¸ºä»–çš„ä¹¦ã€Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonæ·±åº¦å­¦ä¹ ã€‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†å¤‡çš„</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">zip_path = tf.keras.utils.get_file(<font></font>
    origin=<span class="hljs-string">'https://storage.googleapis.com/tensorflow/tf-keras-datasets/jena_climate_2009_2016.csv.zip'</span>,<font></font>
    fname=<span class="hljs-string">'jena_climate_2009_2016.csv.zip'</span>,<font></font>
    extract=<span class="hljs-literal">True</span>)<font></font>
csv_path, _ = os.path.splitext(zip_path)<font></font>
</code></pre><br>
<pre><code class="python hljs">df = pd.read_csv(csv_path)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æœ‰ä»€ä¹ˆã€‚</font></font><br>
<br>
<pre><code class="python hljs">df.head()
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d5d/bfa/539/d5dbfa539de3da5ca04103b2db380a70.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§‚å¯Ÿè®°å½•å‘¨æœŸä¸º10åˆ†é’Ÿçš„äº‹å®å¯ä»¥é€šè¿‡ä¸Šè¡¨éªŒè¯ã€‚å› æ­¤ï¼Œåœ¨ä¸€å°æ—¶å†…æ‚¨å°†è·å¾—6ä¸ªè§‚æµ‹å€¼ã€‚åè¿‡æ¥ï¼Œæ¯å¤©ä¼šæ”¶é›†144ä¸ªï¼ˆ6x24ï¼‰è§‚æµ‹å€¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡è®¾æ‚¨è¦é¢„æµ‹æ¸©åº¦ï¼Œè¯¥æ¸©åº¦å°†åœ¨æœªæ¥6å°æ—¶å†…å‡ºç°ã€‚æ‚¨æ ¹æ®ä¸€å®šæ—¶æœŸå†…çš„æ•°æ®è¿›è¡Œæ­¤é¢„æµ‹ï¼šä¾‹å¦‚ï¼Œæ‚¨å†³å®šä½¿ç”¨5å¤©çš„è§‚å¯Ÿæ—¶é—´ã€‚å› æ­¤ï¼Œè¦è®­ç»ƒæ¨¡å‹ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªåŒ…å«æœ€å720ä¸ªï¼ˆ5x144ï¼‰è§‚æµ‹å€¼çš„æ—¶é—´é—´éš”ï¼ˆç”±äºå¯èƒ½æœ‰ä¸åŒçš„é…ç½®ï¼Œå› æ­¤è¯¥æ•°æ®é›†æ˜¯è¿›è¡Œå®éªŒçš„è‰¯å¥½åŸºç¡€ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹é¢çš„å‡½æ•°è¿”å›ä¸Šè¿°è®­ç»ƒæ¨¡å‹çš„æ—¶é—´é—´éš”ã€‚äº‰è®º</font></font><code>history_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-è¿™æ˜¯æœ€åä¸€ä¸ªæ—¶é—´é—´éš”çš„å¤§å°ï¼Œ</font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ä¸€ä¸ªå‚æ•°ï¼Œç¡®å®šæ¨¡å‹åº”è¯¥å­¦ä¼šé¢„æµ‹çš„æœªæ¥æ—¶é—´ã€‚</font><font style="vertical-align: inherit;">æ¢å¥è¯è¯´ï¼Œ</font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯éœ€è¦é¢„æµ‹çš„ç›®æ ‡å‘é‡ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">univariate_data</span>(<span class="hljs-params">dataset, start_index, end_index, history_size, target_size</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i)<font></font>
    <span class="hljs-comment"># Reshape data from (history_size,) to (history_size, 1)</span>
    data.append(np.reshape(dataset[indices], (history_size, <span class="hljs-number">1</span>)))<font></font>
    labels.append(dataset[i+target_size])<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬æ‰‹å†Œçš„ä¸¤ä¸ªéƒ¨åˆ†ä¸­ï¼Œå‰300,000è¡Œæ•°æ®éƒ½å°†ç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œå…¶ä½™çš„è¡Œå°†ç”¨äºéªŒè¯ï¼ˆéªŒè¯ï¼‰æ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸ¹è®­æ•°æ®é‡çº¦ä¸º2100å¤©ã€‚</font></font><br>
<br>
<pre><code class="python hljs">TRAIN_SPLIT = <span class="hljs-number">300000</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºç¡®ä¿ç»“æœå¯é‡å¤ï¼Œè®¾ç½®äº†ç§å­åŠŸèƒ½ã€‚</font></font><br>
<br>
<pre><code class="python hljs">tf.random.set_seed(<span class="hljs-number">13</span>)
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬1éƒ¨åˆ†ã€‚åŸºäºä¸€ç»´æ—¶é—´åºåˆ—çš„é¢„æµ‹</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæ‚¨å°†ä»…ä½¿ç”¨ä¸€ä¸ªå±æ€§ï¼ˆæ¸©åº¦ï¼‰è®­ç»ƒæ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">ç»è¿‡è®­ç»ƒçš„æ¨¡å‹å°†ç”¨äºé¢„æµ‹æœªæ¥çš„æ¸©åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬ä»…ä»æ•°æ®é›†ä¸­æå–æ¸©åº¦ã€‚</font></font><br>
<br>
<pre><code class="python hljs">uni_data = df[<span class="hljs-string">'T (degC)'</span>]<font></font>
uni_data.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
uni_data.head()<font></font>
</code></pre><br>
<code>Date Time<br>
01.01.2009 00:10:00 -8.02<br>
01.01.2009 00:20:00 -8.41<br>
01.01.2009 00:30:00 -8.51<br>
01.01.2009 00:40:00 -8.31<br>
01.01.2009 00:50:00 -8.27<br>
Name: T (degC), dtype: float64<br>
</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›æ•°æ®å¦‚ä½•éšæ—¶é—´å˜åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs">uni_data.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/208/b35/242/208b35242d3ce1ed30bd25d12d956703.jpg" alt="å›¾ç‰‡"><br>
<br>
<pre><code class="python hljs">uni_data = uni_data.values
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è®­ç»ƒäººå·¥ç¥ç»ç½‘ç»œï¼ˆä»¥ä¸‹ç®€ç§°ANNï¼‰ä¹‹å‰ï¼Œé‡è¦çš„ä¸€æ­¥æ˜¯æ•°æ®ç¼©æ”¾ã€‚</font><font style="vertical-align: inherit;">è¿›è¡Œç¼©æ”¾çš„å¸¸è§æ–¹æ³•ä¹‹ä¸€æ˜¯æ ‡å‡†åŒ–ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardization</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œæ–¹æ³•æ˜¯å‡å»å¹³å‡å€¼å¹¶é™¤ä»¥æ¯ä¸ªç‰¹æ€§çš„æ ‡å‡†åå·®ã€‚</font><font style="vertical-align: inherit;">æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å°†</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">tf.keras.utils.normalize</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ç¼©æ”¾åˆ°[0,1]èŒƒå›´</font><font style="vertical-align: inherit;">çš„æ–¹æ³•</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šåªèƒ½ä½¿ç”¨åŸ¹è®­æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs">uni_train_mean = uni_data[:TRAIN_SPLIT].mean()<font></font>
uni_train_std = uni_data[:TRAIN_SPLIT].std()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æ‰§è¡Œæ•°æ®æ ‡å‡†åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs">uni_data = (uni_data-uni_train_mean)/uni_train_std
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä¸€ç»´è¾“å…¥ä¸ºæ¨¡å‹å‡†å¤‡æ•°æ®ã€‚</font><font style="vertical-align: inherit;">è®°å½•çš„æœ€å20ä¸ªæ¸©åº¦è§‚æµ‹å€¼å°†è¾“å…¥åˆ°æ¨¡å‹çš„å…¥å£ï¼Œå¹¶ä¸”å¿…é¡»è®­ç»ƒæ¨¡å‹ä»¥é¢„æµ‹ä¸‹ä¸€æ­¥çš„æ¸©åº¦ã€‚</font></font><br>
<br>
<pre><code class="python hljs">univariate_past_history = <span class="hljs-number">20</span>
univariate_future_target = <span class="hljs-number">0</span><font></font>
<font></font>
x_train_uni, y_train_uni = univariate_data(uni_data, <span class="hljs-number">0</span>, TRAIN_SPLIT,<font></font>
                                           univariate_past_history,<font></font>
                                           univariate_future_target)<font></font>
x_val_uni, y_val_uni = univariate_data(uni_data, TRAIN_SPLIT, <span class="hljs-literal">None</span>,<font></font>
                                       univariate_past_history,<font></font>
                                       univariate_future_target)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡½æ•°åº”ç”¨çš„ç»“æœ</font></font><code>univariate_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history'</span>)
<span class="hljs-keyword">print</span> (x_train_uni[<span class="hljs-number">0</span>])
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict'</span>)
<span class="hljs-keyword">print</span> (y_train_uni[<span class="hljs-number">0</span>])
</code></pre><br>
<code>Single window of past history<br>
[[-1.99766294]<br>
 [-2.04281897]<br>
 [-2.05439744]<br>
 [-2.0312405 ]<br>
 [-2.02660912]<br>
 [-2.00113649]<br>
 [-1.95134907]<br>
 [-1.95134907]<br>
 [-1.98492663]<br>
 [-2.04513467]<br>
 [-2.08334362]<br>
 [-2.09723778]<br>
 [-2.09376424]<br>
 [-2.09144854]<br>
 [-2.07176515]<br>
 [-2.07176515]<br>
 [-2.07639653]<br>
 [-2.08913285]<br>
 [-2.09260639]<br>
 [-2.10418486]]<br>
<br>
Target temperature to predict<br>
-2.1041848598100876<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦å¤–ï¼šä¸‹å›¾ç¤ºæ„æ€§åœ°æ˜¾ç¤ºäº†ä¸ºå…·æœ‰ä¸€ç»´è¾“å…¥çš„æ¨¡å‹å‡†å¤‡æ•°æ®ï¼ˆä¸ºæ–¹ä¾¿èµ·è§ï¼Œåœ¨æ­¤å›¾å’Œåç»­å›¾ä¸­ï¼Œæ•°æ®åœ¨æ ‡å‡†åŒ–ä¹‹å‰ä»¥â€œåŸå§‹â€å½¢å¼æ˜¾ç¤ºï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰â€œæ—¥æœŸæ—¶é—´â€å±æ€§ä½œä¸ºç´¢å¼•ï¼‰ï¼š</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fa0/d0f/530/fa0d0f530b3496324425eeb5e52baff7.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç°åœ¨ï¼Œæ•°æ®ç»è¿‡é€‚å½“å‡†å¤‡ï¼Œè¯·è€ƒè™‘ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ã€‚</font><font style="vertical-align: inherit;">ä¼ è¾“åˆ°ANNçš„ä¿¡æ¯ä»¥è“è‰²çªå‡ºæ˜¾ç¤ºï¼Œçº¢å‰è¡¨ç¤ºANNåº”è¯¥é¢„æµ‹çš„æœªæ¥å€¼ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_time_steps</span>(<span class="hljs-params">length</span>):</span>
  <span class="hljs-keyword">return</span> list(range(-length, <span class="hljs-number">0</span>))
</code></pre><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_plot</span>(<span class="hljs-params">plot_data, delta, title</span>):</span>
  labels = [<span class="hljs-string">'History'</span>, <span class="hljs-string">'True Future'</span>, <span class="hljs-string">'Model Prediction'</span>]<font></font>
  marker = [<span class="hljs-string">'.-'</span>, <span class="hljs-string">'rx'</span>, <span class="hljs-string">'go'</span>]<font></font>
  time_steps = create_time_steps(plot_data[<span class="hljs-number">0</span>].shape[<span class="hljs-number">0</span>])
  <span class="hljs-keyword">if</span> delta:<font></font>
    future = delta<font></font>
  <span class="hljs-keyword">else</span>:<font></font>
    future = <span class="hljs-number">0</span><font></font>
<font></font>
  plt.title(title)<font></font>
  <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> enumerate(plot_data):
    <span class="hljs-keyword">if</span> i:<font></font>
      plt.plot(future, plot_data[i], marker[i], markersize=<span class="hljs-number">10</span>,<font></font>
               label=labels[i])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      plt.plot(time_steps, plot_data[i].flatten(), marker[i], label=labels[i])<font></font>
  plt.legend()<font></font>
  plt.xlim([time_steps[<span class="hljs-number">0</span>], (future+<span class="hljs-number">5</span>)*<span class="hljs-number">2</span>])<font></font>
  plt.xlabel(<span class="hljs-string">'Time-Step'</span>)
  <span class="hljs-keyword">return</span> plt
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Sample Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/589/38c/574/58938c5740abfb08ed0074a1233f512f.jpg" alt="å›¾ç‰‡"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºæœ¬è§£å†³æ–¹æ¡ˆï¼ˆä¸æ¶‰åŠæœºå™¨å­¦ä¹ ï¼‰</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨å¼€å§‹æ¨¡å‹è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬å°†å®‰è£…ä¸€ä¸ªç®€å•çš„åŸºæœ¬è§£å†³æ–¹æ¡ˆï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºçº¿</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚å®ƒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼šå¯¹äºç»™å®šçš„è¾“å…¥å‘é‡ï¼ŒåŸºæœ¬æ±‚è§£æ–¹æ³•â€œæ‰«æâ€æ•´ä¸ªå†å²è®°å½•ï¼Œå¹¶é¢„æµ‹ä¸‹ä¸€ä¸ªå€¼ä½œä¸ºæœ€å20ä¸ªè§‚å¯Ÿå€¼çš„å¹³å‡å€¼ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baseline</span>(<span class="hljs-params">history</span>):</span>
  <span class="hljs-keyword">return</span> np.mean(history)
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>], baseline(x_train_uni[<span class="hljs-number">0</span>])], <span class="hljs-number">0</span>,
           <span class="hljs-string">'Baseline Prediction Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/bed/941/0ef/bed9410ef6b96ad25ab68a0a3ebac05a.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œè¶…è¶Šâ€œå¹³å‡â€çš„ç»“æœã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€’å½’ç¥ç»ç½‘ç»œ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNSï¼‰æ˜¯ä¸€ç§éå¸¸é€‚åˆè§£å†³æ—¶é—´åºåˆ—é—®é¢˜çš„ANNã€‚ RNSé€æ­¥å¤„ç†æ•°æ®çš„æ—¶é—´åºåˆ—ï¼Œå¯¹æ•°æ®å…ƒç´ è¿›è¡Œæ’åºï¼Œå¹¶ä¿ç•™é€šè¿‡å¤„ç†ä¹‹å‰çš„å…ƒç´ è€Œè·å¾—çš„å†…éƒ¨çŠ¶æ€ã€‚æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡å—ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°æœ‰å…³RNSçš„æ›´å¤šä¿¡æ¯</font><font style="vertical-align: inherit;">ã€‚æœ¬æŒ‡å—å°†ä½¿ç”¨ç§°ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é•¿æœŸçŸ­æ—¶è®°å¿†ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LSTM</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">çš„RNCä¸“é—¨å±‚</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿›ä¸€æ­¥ä½¿ç”¨</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">tf.data</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éšæœºæ’­æ”¾ï¼Œæ‰¹å¤„ç†å’Œç¼“å­˜æ•°æ®é›†ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¥å……ï¼š</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´å¤šå…³äº</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tensorflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡µé¢ä¸Šçš„éšæœºï¼Œæ‰¹å¤„ç†å’Œç¼“å­˜æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼š</font></font></i><br>
<br>
<pre><code class="python hljs">BATCH_SIZE = <span class="hljs-number">256</span>
BUFFER_SIZE = <span class="hljs-number">10000</span><font></font>
<font></font>
train_univariate = tf.data.Dataset.from_tensor_slices((x_train_uni, y_train_uni))<font></font>
train_univariate = train_univariate.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_univariate = tf.data.Dataset.from_tensor_slices((x_val_uni, y_val_uni))<font></font>
val_univariate = val_univariate.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹å¯è§†åŒ–æ•ˆæœåº”å¸®åŠ©æ‚¨äº†è§£æ‰¹å¤„ç†åæ•°æ®çš„å¤–è§‚ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/002/e4b/3ed/002e4b3ed48fa5d17f34ccee2cbfc40d.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯ä»¥çœ‹å‡ºï¼ŒLSTMéœ€è¦æŸç§å½¢å¼çš„æ•°æ®è¾“å…¥ï¼Œå¹¶æä¾›ç»™å®ƒã€‚</font></font><br>
<br>
<pre><code class="python hljs">simple_lstm_model = tf.keras.models.Sequential([<font></font>
    tf.keras.layers.LSTM(<span class="hljs-number">8</span>, input_shape=x_train_uni.shape[<span class="hljs-number">-2</span>:]),<font></font>
    tf.keras.layers.Dense(<span class="hljs-number">1</span>)<font></font>
])<font></font>
<font></font>
simple_lstm_model.compile(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥æ¨¡å‹è¾“å‡ºã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">1</span>):<font></font>
    print(simple_lstm_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦å¤–ï¼š</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬æ¥è¯´ï¼ŒRNSä¸åºåˆ—ä¸€èµ·ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">è¿™æ„å‘³ç€æä¾›ç»™æ¨¡å‹è¾“å…¥çš„æ•°æ®åº”å…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š</font></font><br>
<br>
<code>[,  , - ]</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…·æœ‰ä¸€ç»´è¾“å…¥çš„æ¨¡å‹çš„è®­ç»ƒæ•°æ®çš„å½¢å¼</font><font style="vertical-align: inherit;">åº”å…·æœ‰</font><font style="vertical-align: inherit;">ä»¥ä¸‹å½¢å¼ï¼š</font></font></i><br>
<br>
<code>print(x_train_uni.shape)<br>
(299980, 20, 1)</code><br>
<cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç ”ç©¶æ¨¡å‹ã€‚</font><font style="vertical-align: inherit;">ç”±äºæ•°æ®é›†å¾ˆå¤§ï¼Œå¹¶ä¸”ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæ¯ä¸ªå†å…ƒå°†ä»…æ‰§è¡Œ200æ­¥ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">steps_per_epoch = 200</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œè€Œä¸æ˜¯é€šå¸¸çš„å®Œæ•´è®­ç»ƒæ•°æ®ã€‚</font></font><br>
<br>
<pre><code class="python hljs">EVALUATION_INTERVAL = <span class="hljs-number">200</span>
EPOCHS = <span class="hljs-number">10</span><font></font>
<font></font>
simple_lstm_model.fit(train_univariate, epochs=EPOCHS,<font></font>
                      steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                      validation_data=val_univariate, validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 2s 11ms/step - loss: 0.4075 - val_loss: 0.1351<br>
Epoch 2/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.1118 - val_loss: 0.0360<br>
Epoch 3/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0490 - val_loss: 0.0289<br>
Epoch 4/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0444 - val_loss: 0.0257<br>
Epoch 5/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0299 - val_loss: 0.0235<br>
Epoch 6/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0317 - val_loss: 0.0224<br>
Epoch 7/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0287 - val_loss: 0.0206<br>
Epoch 8/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0263 - val_loss: 0.0200<br>
Epoch 9/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0254 - val_loss: 0.0182<br>
Epoch 10/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0228 - val_loss: 0.0174<br>
</code><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ç®€å•çš„LSTMæ¨¡å‹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
è¿›è¡Œ</font><b><font style="vertical-align: inherit;">é¢„æµ‹</font></b><font style="vertical-align: inherit;">åœ¨å®Œæˆ</font><b><font style="vertical-align: inherit;">ç®€å•çš„LSTMæ¨¡å‹</font></b><font style="vertical-align: inherit;">å‡†å¤‡ä¹‹åï¼Œæˆ‘ä»¬å°†è¿›è¡Œä¸€äº›é¢„æµ‹ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    simple_lstm_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Simple LSTM model'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf8/0f6/810/cf80f681038da62889884ae5de86722d.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒçœ‹èµ·æ¥æ¯”åŸºæœ¬æ°´å¹³æ›´å¥½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æ‚¨å·²ç»ç†Ÿæ‚‰äº†åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬ç»§ç»­ç¬¬äºŒéƒ¨åˆ†ï¼Œå®ƒæè¿°äº†ä½¿ç”¨å¤šç»´æ—¶é—´åºåˆ—ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬2éƒ¨åˆ†ï¼šå¤šç»´æ—¶é—´åºåˆ—é¢„æµ‹</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚å‰æ‰€è¿°ï¼ŒåŸå§‹æ•°æ®é›†åŒ…å«14ç§ä¸åŒçš„æ°”è±¡æŒ‡æ ‡ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†ç®€å•å’Œæ–¹ä¾¿èµ·è§ï¼Œåœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ä»…è€ƒè™‘äº†å…¶ä¸­ä¸‰ä¸ª-ç©ºæ°”æ¸©åº¦ï¼Œå¤§æ°”å‹å’Œç©ºæ°”å¯†åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ä½¿ç”¨æ›´å¤šåŠŸèƒ½ï¼Œå¿…é¡»å°†å…¶åç§°æ·»åŠ åˆ°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feature_considered</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ—è¡¨ä¸­</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="python hljs">features_considered = [<span class="hljs-string">'p (mbar)'</span>, <span class="hljs-string">'T (degC)'</span>, <span class="hljs-string">'rho (g/m**3)'</span>]
</code></pre><br>
<pre><code class="python hljs">features = df[features_considered]<font></font>
features.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
features.head()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/1f8/589/b51/1f8589b51d64dcd9ba10e5f072df503e.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›æŒ‡æ ‡å¦‚ä½•éšæ—¶é—´å˜åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs">features.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/7be/266/b59/7be266b59f38be1e4c365ee8562dffcd.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å’Œä»¥å‰ä¸€æ ·ï¼Œç¬¬ä¸€æ­¥æ˜¯é€šè¿‡è®¡ç®—è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼å’Œæ ‡å‡†åå·®æ¥æ ‡å‡†åŒ–æ•°æ®é›†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">dataset = features.values<font></font>
data_mean = dataset[:TRAIN_SPLIT].mean(axis=<span class="hljs-number">0</span>)<font></font>
data_std = dataset[:TRAIN_SPLIT].std(axis=<span class="hljs-number">0</span>)
</code></pre><br>
<pre><code class="python hljs">dataset = (dataset-data_mean)/data_std
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦å¤–ï¼š</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ‰‹å†Œä¸­ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥è®¨è®ºç‚¹å’ŒåŒºé—´é¢„æµ‹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº•çº¿å¦‚ä¸‹ã€‚å¦‚æœæ‚¨éœ€è¦æ¨¡å‹æ¥é¢„æµ‹å°†æ¥çš„ä¸€ä¸ªå€¼ï¼ˆä¾‹å¦‚ï¼Œ12å°æ—¶åçš„æ¸©åº¦å€¼ï¼‰ï¼ˆå•æ­¥/å•æ­¥æ¨¡å‹ï¼‰ï¼Œåˆ™å¿…é¡»å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œä½¿å…¶å°†æ¥åªèƒ½é¢„æµ‹ä¸€ä¸ªå€¼ã€‚å¦‚æœä»»åŠ¡æ˜¯é¢„æµ‹æœªæ¥çš„å€¼èŒƒå›´ï¼ˆä¾‹å¦‚æœªæ¥12å°æ—¶çš„æ¯å°æ—¶æ¸©åº¦ï¼‰ï¼ˆå¤šæ­¥æ¨¡å‹ï¼‰ï¼Œåˆ™è¿˜åº”è®­ç»ƒè¯¥æ¨¡å‹ä»¥é¢„æµ‹å°†æ¥çš„å€¼èŒƒå›´ã€‚</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/906/953/08e/90695308e69c21c37e772d98553209a4.png" alt="å›¾ç‰‡"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‚¹é¢„æµ‹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ¨¡å‹åŸºäºä¸€äº›å¯ç”¨å†å²è®°å½•æ¥é¢„æµ‹å°†æ¥çš„ä¸€ä¸ªå€¼ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹é¢çš„å‡½æ•°æ‰§è¡Œç»„ç»‡æ—¶é—´é—´éš”çš„ç›¸åŒä»»åŠ¡ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œçš„å‡½æ•°åŸºäºç»™å®šçš„æ­¥é•¿é€‰æ‹©æœ€æ–°çš„è§‚æµ‹å€¼ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multivariate_data</span>(<span class="hljs-params">dataset, target, start_index, end_index, history_size,
                      target_size, step, single_step=False</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i, step)<font></font>
    data.append(dataset[indices])<font></font>
<font></font>
    <span class="hljs-keyword">if</span> single_step:<font></font>
      labels.append(target[i+target_size])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      labels.append(target[i:i+target_size])<font></font>
<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬æŒ‡å—ä¸­ï¼ŒANNä¼šå¤„ç†æœ€è¿‘äº”ï¼ˆ5ï¼‰å¤©çš„æ•°æ®ï¼Œå³720ä¸ªè§‚æµ‹å€¼ï¼ˆ6x24x5ï¼‰ã€‚</font><font style="vertical-align: inherit;">å‡è®¾æ•°æ®é€‰æ‹©ä¸æ˜¯æ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œæ˜¯æ¯å°æ—¶è¿›è¡Œä¸€æ¬¡ï¼šåœ¨60åˆ†é’Ÿä¹‹å†…ï¼Œé¢„è®¡ä¸ä¼šå‡ºç°æ€¥å‰§å˜åŒ–ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæœ€è¿‘äº”å¤©çš„å†å²åŒ…æ‹¬120ä¸ªè§‚æµ‹å€¼ï¼ˆ720/6ï¼‰ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæ‰§è¡Œæ–‘ç‚¹é¢„æµ‹çš„æ¨¡å‹ï¼Œç›®æ ‡æ˜¯åœ¨å°†æ¥çš„12å°æ—¶åè¯»å–æ¸©åº¦ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›®æ ‡å‘é‡å°†æ˜¯72æ¬¡ï¼ˆ12x6ï¼‰è§‚æµ‹åçš„æ¸©åº¦ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·å‚é˜…ä»¥ä¸‹é™„åŠ å†…å®¹-è¿‘ä¼¼è½¬æ¢å™¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="python hljs">past_history = <span class="hljs-number">720</span>
future_target = <span class="hljs-number">72</span>
STEP = <span class="hljs-number">6</span><font></font>
<font></font>
x_train_single, y_train_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                   TRAIN_SPLIT, past_history,<font></font>
                                                   future_target, STEP,<font></font>
                                                   single_step=<span class="hljs-literal">True</span>)<font></font>
x_val_single, y_val_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                               TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                               future_target, STEP,<font></font>
                                               single_step=<span class="hljs-literal">True</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥æ—¶é—´é—´éš”ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_single[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
</code><br>
<pre><code class="python hljs">train_data_single = tf.data.Dataset.from_tensor_slices((x_train_single, y_train_single))<font></font>
train_data_single = train_data_single.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_single = tf.data.Dataset.from_tensor_slices((x_val_single, y_val_single))<font></font>
val_data_single = val_data_single.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<pre><code class="python hljs">single_step_model = tf.keras.models.Sequential()<font></font>
single_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                           input_shape=x_train_single.shape[<span class="hljs-number">-2</span>:]))<font></font>
single_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">1</span>))<font></font>
<font></font>
single_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†åœ¨è®­ç»ƒå’ŒéªŒè¯é˜¶æ®µæ£€æŸ¥æ ·æœ¬å¹¶å¾—å‡ºæŸè€—æ›²çº¿ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">1</span>):<font></font>
  print(single_step_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<pre><code class="python hljs">single_step_history = single_step_model.fit(train_data_single, epochs=EPOCHS,<font></font>
                                            steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                            validation_data=val_data_single,<font></font>
                                            validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 4s 18ms/step - loss: 0.3090 - val_loss: 0.2646<br>
Epoch 2/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2624 - val_loss: 0.2435<br>
Epoch 3/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2616 - val_loss: 0.2472<br>
Epoch 4/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2567 - val_loss: 0.2442<br>
Epoch 5/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2263 - val_loss: 0.2346<br>
Epoch 6/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2416 - val_loss: 0.2643<br>
Epoch 7/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2411 - val_loss: 0.2577<br>
Epoch 8/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2410 - val_loss: 0.2388<br>
Epoch 9/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2447 - val_loss: 0.2485<br>
Epoch 10/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2388 - val_loss: 0.2422<br>
</code><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_train_history</span>(<span class="hljs-params">history, title</span>):</span>
  loss = history.history[<span class="hljs-string">'loss'</span>]<font></font>
  val_loss = history.history[<span class="hljs-string">'val_loss'</span>]<font></font>
<font></font>
  epochs = range(len(loss))<font></font>
<font></font>
  plt.figure()<font></font>
<font></font>
  plt.plot(epochs, loss, <span class="hljs-string">'b'</span>, label=<span class="hljs-string">'Training loss'</span>)<font></font>
  plt.plot(epochs, val_loss, <span class="hljs-string">'r'</span>, label=<span class="hljs-string">'Validation loss'</span>)<font></font>
  plt.title(title)<font></font>
  plt.legend()<font></font>
<font></font>
  plt.show()<font></font>
</code></pre><br>
<pre><code class="python hljs">plot_train_history(single_step_history,
                   <span class="hljs-string">'Single Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/baa/481/4df/baa4814df5d278c7be5a4daf629ec8e0.jpg" alt="å›¾ç‰‡"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦å¤–ï¼š</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹å›¾ç¤ºæ„æ€§åœ°æ˜¾ç¤ºäº†å…·æœ‰å¤šç»´è¾“å…¥æ‰§è¡Œç‚¹é¢„æµ‹çš„æ¨¡å‹çš„æ•°æ®å‡†å¤‡ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†æ–¹ä¾¿èµ·è§å’Œæ›´ç›´è§‚åœ°è¡¨ç¤ºæ•°æ®å‡†å¤‡ï¼Œè‡ªå˜é‡</font></font><code>STEP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸º1ã€‚è¯·æ³¨æ„ï¼Œåœ¨ç»™å®šçš„ç”Ÿæˆå™¨å‡½æ•°ä¸­ï¼Œè‡ª</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font></font><code>STEP </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»…ç”¨äºå½¢æˆå†å²</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œä¸ç”¨äºç›®æ ‡å‘é‡ã€‚</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bfd/c0b/ef1/bfdc0bef1203da6840adcb4311455645.png" alt="å›¾ç‰‡"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒ</font></font><code>x_train_single</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…·æœ‰çš„å½¢å¼</font></font><code>(299280, 720, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ä¸ºæ—¶</font></font><code>STEP=6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¯¥è¡¨å•å°†é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š</font></font><code>(299280, 120, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶ä¸”å‡½æ•°çš„é€Ÿåº¦å°†æ˜¾ç€æé«˜ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œæ‚¨éœ€è¦æ„Ÿè°¢ç¨‹åºå‘˜ï¼šæ‰‹å†Œä¸­ä»‹ç»çš„ç”Ÿæˆå™¨åœ¨å†…å­˜æ¶ˆè€—æ–¹é¢éå¸¸ç¹çã€‚</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰§è¡Œç‚¹é¢„æµ‹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨å·²ç»å¯¹æ¨¡å‹è¿›è¡Œäº†è®­ç»ƒï¼Œæˆ‘ä»¬å°†æ‰§è¡Œå‡ ä¸ªæµ‹è¯•é¢„æµ‹ã€‚æ¯å°æ—¶é€‰æ‹©ä¸€æ¬¡ï¼ˆæ—¶é—´é—´éš”= 120ï¼‰æœ€è¿‘5å¤©è§‚å¯Ÿåˆ°çš„3ä¸ªä¿¡å·çš„å†å²è®°å½•è¢«è¾“å…¥åˆ°æ¨¡å‹è¾“å…¥ä¸­ã€‚ç”±äºæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä»…é¢„æµ‹æ¸©åº¦ï¼Œå› æ­¤è¿‡å»çš„æ¸©åº¦å€¼ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†å²è®°å½•</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">åœ¨å›¾è¡¨ä¸Šä»¥è“è‰²æ˜¾ç¤º</font><font style="vertical-align: inherit;">ã€‚é¢„æµ‹æ˜¯åœ¨æœªæ¥åŠå¤©è¿›è¡Œçš„ï¼ˆå› æ­¤ï¼Œå†å²è®°å½•ä¸é¢„æµ‹å€¼ä¹‹é—´å­˜åœ¨å·®è·ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>][:, <span class="hljs-number">1</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    single_step_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">12</span>,
                   <span class="hljs-string">'Single Step Prediction'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/6ac/a5b/ce3/6aca5bce3fef9de56f1fac299da5527c.jpg" alt="å›¾ç‰‡"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—´éš”é¢„æµ‹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ¹æ®ä¸€äº›å¯ç”¨çš„å†å²è®°å½•ï¼Œè®­ç»ƒæ¨¡å‹ä»¥é¢„æµ‹æœªæ¥å€¼çš„é—´éš”ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œä¸ä»…é¢„æµ‹æœªæ¥ä¸€ä¸ªå€¼çš„æ¨¡å‹ç›¸åï¼Œè¯¥æ¨¡å‹é¢„æµ‹æœªæ¥çš„ä¸€ç³»åˆ—å€¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡è®¾ä¸æ‰§è¡Œç‚¹é¢„æµ‹çš„æ¨¡å‹ä¸€æ ·ï¼Œå¯¹äºæ‰§è¡Œé—´éš”é¢„æµ‹çš„æ¨¡å‹ï¼Œè®­ç»ƒæ•°æ®æ˜¯æœ€è¿‘äº”å¤©ï¼ˆ720/6ï¼‰çš„æ¯å°æ—¶æµ‹é‡å€¼ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»è®­ç»ƒæ¨¡å‹ä»¥é¢„æµ‹æ¥ä¸‹æ¥12å°æ—¶çš„æ¸©åº¦ã€‚</font><font style="vertical-align: inherit;">ç”±äºæ¯10åˆ†é’Ÿè®°å½•ä¸€æ¬¡è§‚å¯Ÿï¼Œå› æ­¤æ¨¡å‹çš„è¾“å‡ºåº”åŒ…å«72ä¸ªé¢„æµ‹ã€‚</font><font style="vertical-align: inherit;">è¦å®Œæˆæ­¤ä»»åŠ¡ï¼Œæœ‰å¿…è¦å†æ¬¡å‡†å¤‡æ•°æ®é›†ï¼Œä½†è¦ä½¿ç”¨ä¸åŒçš„ç›®æ ‡é—´éš”ã€‚</font></font><br>
<br>
<pre><code class="python hljs">future_target = <span class="hljs-number">72</span>
x_train_multi, y_train_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                 TRAIN_SPLIT, past_history,<font></font>
                                                 future_target, STEP)<font></font>
x_val_multi, y_val_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                             TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                             future_target, STEP)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥é€‰æ‹©ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_multi[<span class="hljs-number">0</span>].shape))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict : {}'</span>.format(y_train_multi[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
<br>
Target temperature to predict : (72,)<br>
</code><br>
<pre><code class="python hljs">train_data_multi = tf.data.Dataset.from_tensor_slices((x_train_multi, y_train_multi))<font></font>
train_data_multi = train_data_multi.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_multi = tf.data.Dataset.from_tensor_slices((x_val_multi, y_val_multi))<font></font>
val_data_multi = val_data_multi.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦å¤–ï¼šä¸‹å›¾æ˜¾ç¤ºäº†â€œé—´éš”æ¨¡å‹â€ä¸â€œç‚¹æ¨¡å‹â€çš„ç›®æ ‡çŸ¢é‡çš„å½¢æˆå·®å¼‚ã€‚</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/190/5c6/845/1905c6845d2746a1f0bc6ae88f913b99.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†å‡†å¤‡å¯è§†åŒ–ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multi_step_plot</span>(<span class="hljs-params">history, true_future, prediction</span>):</span>
  plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))<font></font>
  num_in = create_time_steps(len(history))<font></font>
  num_out = len(true_future)<font></font>
<font></font>
  plt.plot(num_in, np.array(history[:, <span class="hljs-number">1</span>]), label=<span class="hljs-string">'History'</span>)<font></font>
  plt.plot(np.arange(num_out)/STEP, np.array(true_future), <span class="hljs-string">'bo'</span>,<font></font>
           label=<span class="hljs-string">'True Future'</span>)
  <span class="hljs-keyword">if</span> prediction.any():<font></font>
    plt.plot(np.arange(num_out)/STEP, np.array(prediction), <span class="hljs-string">'ro'</span>,<font></font>
             label=<span class="hljs-string">'Predicted Future'</span>)<font></font>
  plt.legend(loc=<span class="hljs-string">'upper left'</span>)<font></font>
  plt.show()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ­¤å›¾å’Œåç»­ç±»ä¼¼çš„å›¾è¡¨ä¸Šï¼Œå†å²è®°å½•å’Œå°†æ¥çš„æ•°æ®æŒ‰å°æ—¶æ’åˆ—ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> train_data_multi.take(<span class="hljs-number">1</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], np.array([<span class="hljs-number">0</span>]))
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/245/beb/236/245beb236bc1f87f2d611ce8d2c0bc81.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæ­¤ä»»åŠ¡æ¯”ä¸Šä¸€ä¸ªä»»åŠ¡å¤æ‚ä¸€äº›ï¼Œå› æ­¤è¯¥æ¨¡å‹å°†ç”±ä¸¤ä¸ªLSTMå±‚ç»„æˆã€‚</font><font style="vertical-align: inherit;">æœ€åï¼Œç”±äºæ‰§è¡Œäº†72ä¸ªé¢„æµ‹ï¼Œå› æ­¤è¾“å‡ºå±‚å…·æœ‰72ä¸ªç¥ç»å…ƒã€‚</font></font><br>
<br>
<pre><code class="python hljs">multi_step_model = tf.keras.models.Sequential()<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                          return_sequences=<span class="hljs-literal">True</span>,<font></font>
                                          input_shape=x_train_multi.shape[<span class="hljs-number">-2</span>:]))<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">16</span>, activation=<span class="hljs-string">'relu'</span>))<font></font>
multi_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">72</span>))<font></font>
<font></font>
multi_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(clipvalue=<span class="hljs-number">1.0</span>), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†åœ¨è®­ç»ƒå’ŒéªŒè¯é˜¶æ®µæ£€æŸ¥æ ·æœ¬å¹¶å¾—å‡ºæŸè€—æ›²çº¿ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">1</span>):
  <span class="hljs-keyword">print</span> (multi_step_model.predict(x).shape)
</code></pre><br>
<code>(256, 72)<br>
</code><br>
<pre><code class="python hljs">multi_step_history = multi_step_model.fit(train_data_multi, epochs=EPOCHS,<font></font>
                                          steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                          validation_data=val_data_multi,<font></font>
                                          validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 21s 103ms/step - loss: 0.4952 - val_loss: 0.3008<br>
Epoch 2/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3474 - val_loss: 0.2898<br>
Epoch 3/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3325 - val_loss: 0.2541<br>
Epoch 4/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.2425 - val_loss: 0.2066<br>
Epoch 5/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1963 - val_loss: 0.1995<br>
Epoch 6/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.2056 - val_loss: 0.2119<br>
Epoch 7/10<br>
200/200 [==============================] - 18s 91ms/step - loss: 0.1978 - val_loss: 0.2079<br>
Epoch 8/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1957 - val_loss: 0.2033<br>
Epoch 9/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.1977 - val_loss: 0.1860<br>
Epoch 10/10<br>
200/200 [==============================] - 18s 88ms/step - loss: 0.1904 - val_loss: 0.1863<br>
</code><br>
<pre><code class="python hljs">plot_train_history(multi_step_history, <span class="hljs-string">'Multi-Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/479/600/430/4796004305bd5b839ead7c35120ddc69.png" alt="å›¾ç‰‡"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰§è¡Œé—´éš”é¢„æµ‹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å› æ­¤ï¼Œè®©æˆ‘ä»¬æ‰¾å‡ºè®­ç»ƒæœ‰ç´ çš„</font><b><font style="vertical-align: inherit;">äººå·¥</font></b><font style="vertical-align: inherit;">ç¥ç»ç½‘ç»œå¦‚ä½•æˆåŠŸåº”å¯¹æœªæ¥æ¸©åº¦å€¼çš„é¢„æµ‹ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">3</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], multi_step_model.predict(x)[<span class="hljs-number">0</span>])
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/a3a/2fa/3cd/a3a2fa3cd17ec79c04d9ab44a3d3ad2c.jpg" alt="å›¾ç‰‡"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹ä¸€æ­¥</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æŒ‡å—æ˜¯ä½¿ç”¨RNSè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹çš„ç®€è¦ä»‹ç»ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°è¯•é¢„æµ‹è‚¡ç¥¨å¸‚åœºå¹¶æˆä¸ºäº¿ä¸‡å¯Œç¿</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆæœ€åˆå°±æ˜¯è¿™æ ·ï¼šï¼‰ã€‚ - æ³¨æ„è¯‘è€…ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦å¤–ï¼Œæ‚¨å¯ä»¥ç¼–å†™è‡ªå·±çš„ç”Ÿæˆå™¨æ¥å‡†å¤‡æ•°æ®ï¼Œè€Œä¸æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uni / multivariate_dataå‡½æ•°</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»¥ä¾¿æ›´æœ‰æ•ˆåœ°ä½¿ç”¨å†…å­˜ã€‚æ‚¨è¿˜å¯ä»¥ç†Ÿæ‚‰â€œ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¶é—´åºåˆ—çª—å£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€çš„å·¥ä½œï¼Œå¹¶å°†å…¶æ€æƒ³å¼•å…¥æœ¬æŒ‡å—ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†è¿›ä¸€æ­¥ç†è§£ï¼Œå»ºè®®æ‚¨é˜…è¯»</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Šä½¿ç”¨Scikit-Learnï¼ŒKeraså’ŒTensorFlowçš„åº”ç”¨æœºå™¨å­¦ä¹ ã€‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆAurelien Geronï¼Œç¬¬äºŒç‰ˆï¼‰å’Œæœ¬ä¹¦çš„ç¬¬6ç« ç¬¬15ç« ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ Pythonæ·±åº¦å­¦ä¹ â€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆFrancois Schollï¼‰ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åè¡¥å……</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æ‚¨å¾…åœ¨å®¶é‡Œæ—¶ï¼Œä¸ä»…è¦æ³¨æ„èº«ä½“å¥åº·ï¼Œè¿˜è¦å¯¹è¢«æˆªæ–­çš„æ•°æ®é›†æ‰§è¡Œæœ¬æ‰‹å†Œä¸­çš„ç¤ºä¾‹ï¼Œä»¥æ€œæ‚¯è®¡ç®—æœºã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œè€ƒè™‘åˆ°70x30çš„æ¯”ä¾‹ï¼ˆè®­ç»ƒ/æµ‹è¯•ï¼‰ï¼Œæ‚¨å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼š</font></font></i><br>
<br>
<pre><code class="python hljs">dataset = features[<span class="hljs-number">300000</span>:].values<font></font>
TRAIN_SPLIT = <span class="hljs-number">85000</span></code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN495858/index.html">è¿œç¨‹ä¸è‡ªæˆ‘éš”ç¦»ï¼šå¤ªç©ºç»éªŒå¸®åŠ©åœ°çƒäºº</a></li>
<li><a href="../zh-CN495862/index.html">å¯ä¿¡ç±»å‹-ä¸€ç§ä¿æŠ¤Webåº”ç”¨ç¨‹åºä»£ç å…å—XSSæ”»å‡»çš„æ–°æ–¹æ³•</a></li>
<li><a href="../zh-CN495870/index.html">åœ¨ç¹å¿™çš„é¡¹ç›®ä¸­ä¸Cephåˆä½œçš„æç¤ºå’ŒæŠ€å·§</a></li>
<li><a href="../zh-CN495880/index.html">è¯¥ä¹¦â€œå¤´å…ˆã€‚å­¦ä¹ å›´æ£‹Â»</a></li>
<li><a href="../zh-CN495882/index.html">2020å¹´3æœˆ9ç§æœ€ä½³å¼€æºèµ„æº</a></li>
<li><a href="../zh-CN495888/index.html">PyConä¿„ç½—æ–¯å·²ç»ä¸ºæœªæ¥çš„æ¼”è®²è€…å¼€æ”¾äº†CFPã€‚å‚ä¸è¡¨æ ¼å’Œé¢„æœŸä¸»é¢˜</a></li>
<li><a href="../zh-CN495890/index.html">åœ¨Docker Swarmä¸­é…ç½®Nginx / LetsEncryptæ†ç»‘è½¯ä»¶</a></li>
<li><a href="../zh-CN495892/index.html">ä½ çœŸçš„çŸ¥é“ä»€ä¹ˆæ˜¯æ•°ç»„å—ï¼Ÿ</a></li>
<li><a href="../zh-CN495894/index.html">JavaScriptæ€§èƒ½è¯„ä¼°</a></li>
<li><a href="../zh-CN495896/index.html">ä½¿ç”¨å£°éŸ³åŒ…ï¼šReactåº”ç”¨ç¨‹åºä¸­çš„å£°éŸ³æ•ˆæœ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>