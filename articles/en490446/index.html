<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìì üòØ üåë Controlling the network with the Raspberry Pi üë©üèª‚ÄçüöÄ üëåüèΩ üë®üèæ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr! I present to you heed translation of an article from APC magazine. 
 
 
 
 Network security is essential to ensure the integrity of your ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Controlling the network with the Raspberry Pi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490446/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello, Habr! </font><font style="vertical-align: inherit;">I present to you heed translation of an article from APC magazine. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rz/3x/pr/rz3xpr3gcbhn4bm9_fokig8xqfq.png" alt="image"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network security is essential to ensure the integrity of your data and hardware. </font><font style="vertical-align: inherit;">Undoubtedly, a firewall on the router and software protection tools are necessary, however, to know more about what is happening on the network, you need to have a tool to monitor and control it.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It may seem that a network monitoring tool that sends signals to a computer about an attempted hack is just an element of the plot of a science fiction film, but such a tool does occur in reality. In essence, this means that you can quickly find out when devices located within your network were disconnected from the Internet (for example, applications for smart home or the Internet of things) and detect an unauthorized connection to your router or network hardware. All you need is a Raspberry Pi single board computer and Nagios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nagios, like the Raspberry Pi single-board computer, is available in several versions. For ease of understanding, two options for installing the program will be considered here: creating a disk image and manual installation on the current OS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NEMS (Nagios Enterprise Monitoring Server) is the Nagios enterprise monitoring server, it is installed on the Raspberry Pi and is available at: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit.ly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lxf253nems. It will require a memory card with a capacity of at least 16 GB, but it is best to choose 32 GB. It is recommended to use the Raspberry Pi 3B + for operation, although any version other than the Raspberry Pi1 Model A and the Raspberry Pi Compute Module is suitable. Note that the NEMS package can only be downloaded via BitTorrent. However, other Nagios disk images are freely available. After downloading the package, use the tool to create a disk image and write IMG files to the SD card.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once NEMS is ready to run on a single board computer, connect the Raspberry Pi to the router via an Ethernet cable. Although the server can work via Wi-Fi, Ethernet is still a more reliable means for monitoring the network. Insert the SD card, launch the Raspberry Pi and wait for the NEMS setup to complete. The process will automatically resize the file system, so the initial download will take longer than usual. Using the Secure Shell Protocol (SSH), connect to NEMS using </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nemsadmin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as your username and password. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then enter the command:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo nems-init</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, the installation of NEMS will begin. </font><font style="vertical-align: inherit;">At this stage, you will need to perform regional settings, select the encoding method, create an account and add an e-mail address to which notifications will come. </font><font style="vertical-align: inherit;">To do this, open the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nems.local</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> link in the browser on your desktop </font><font style="vertical-align: inherit;">(or use the IP address of the Raspberry Pi) to start the configuration. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual installation</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Alternatively, you can install Nagios manually on any Raspberry Pi operating system, such as Raspbian. </font><font style="vertical-align: inherit;">For best results, start with a clean OS installation, then start an SSH session. </font><font style="vertical-align: inherit;">To do this, first upgrade the databases:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo apt update &amp;&amp; sudo apt upgrade</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reboot device:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then install Nagios:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo apt install nagios3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wait for the dialog box to create an administrator account, create and write down the password, because you will need it later. This process does not take much time. After that, you will access Nagios from another device through the IP address </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.168.1.10/nagios3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Use the nagiosadmin username and password created earlier when required. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network Monitoring</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/sa/zz/_o/sazz_odur9uxtznzmmvdu7pe3fo.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
After installing Nagios on the Raspberry Pi, you will get a continuous monitoring system ready to run. It remains only to customize it to your needs. If the program was installed manually, the host is configured through the terminal. To do this, create a configuration file. For example, let's call it </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitor.cfg</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo nano /etc/nagios3/ conf.d/monitor.cfg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add the details of the device you want to track to it. </font><font style="vertical-align: inherit;">Let's say you have a Minecraft server on a Raspberry Pi. </font><font style="vertical-align: inherit;">Enter the following commands:</font></font><br>
<br>
<pre><code class="plaintext hljs">define host {  <font></font>
use      generic-host<font></font>
 host_name   minecraft <font></font>
 alias     minecraft  <font></font>
address    192.168.1.22<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generic-host</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command </font><font style="vertical-align: inherit;">here is a template. </font><font style="vertical-align: inherit;">It can be found in the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generic-host_nagios2.cfg folder</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Templates are used to save time when creating an installation for a monitoring session on the device. </font><font style="vertical-align: inherit;">To do this, you only need to create multiple entries based on the given definition and change the host_name (name of the computing node), alias (additional name), and address (IP address) of the device you want to monitor. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Press Ctrl-X to save the changes and exit, then restart Nagios:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo service nagios3 reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If there are problems during the configuration process, you need to check the server for errors using the command:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo /usr/sbin/nagios3 -v / etc/nagios3/nagios.cfg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
She will check the correctness of the configuration files. After that, do not forget to restart Nagios. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typically, network monitoring is done through a browser. A tab can be left open indefinitely. Remote monitoring can also be started on the Raspberry Pi desktop via VNC (Remote Computer Management System). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the terminal, Nagios is configured through a web browser. You only need to open the setup menu and the NEMS configurator, and then add the node description with the same credentials that were required for manual installation, and the necessary notifications.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use the Reports menu section to monitor Nagios. </font><font style="vertical-align: inherit;">The external part of the program can be presented in two versions: the modernized Adagios user interface and the Nagios Core interface created several years ago. </font><font style="vertical-align: inherit;">Both are fully operational. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nagios features are great, so it‚Äôs worth the time to familiarize yourself with the program‚Äôs functionality, add devices, check network activity logs, enable visualization, etc. If you use NEMS, you can easily configure the host through the browser interface way. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's it - your Raspberry Pi with Nagios installed is ready for network monitoring. </font><font style="vertical-align: inherit;">It will work in the background and will notify you of any problem with the connection of equipment and suspicious activity within your network.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490430/index.html">On the way to plotting</a></li>
<li><a href="../en490434/index.html">How to build a Tier IV data center according to the N + 1 scheme</a></li>
<li><a href="../en490436/index.html">Total control or free schedule? Introduction to Corporate Mobility</a></li>
<li><a href="../en490438/index.html">Wikipedia does not yet know about their work</a></li>
<li><a href="../en490440/index.html">Tarantool: history of search acceleration in 1C</a></li>
<li><a href="../en490450/index.html">From the life of a programmer: An irrational approach</a></li>
<li><a href="../en490454/index.html">Julia and cellular automata</a></li>
<li><a href="../en490456/index.html">Writing a babel Plugin, Walkthrough</a></li>
<li><a href="../en490458/index.html">Haskell and C ++ were compared, and jump and cmov were compared</a></li>
<li><a href="../en490460/index.html">LED costume</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>