<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåú üîí üßîüèª Cr√©ation de liaisons Python pour les biblioth√®ques C / C ++ √† l'aide de SIP. Partie 1 üê± üìá üë©‚Äçüë©‚Äçüëß‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parfois, en travaillant sur un projet en Python, on souhaite utiliser une biblioth√®que qui n'est pas √©crite en Python, mais, par exemple, en C ou C ++...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cr√©ation de liaisons Python pour les biblioth√®ques C / C ++ √† l'aide de SIP. Partie 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495480/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parfois, en travaillant sur un projet en Python, on souhaite utiliser une biblioth√®que qui n'est pas √©crite en Python, mais, par exemple, en C ou C ++. Les raisons peuvent √™tre diff√©rentes. Premi√®rement, Python est un langage merveilleux, mais dans certaines situations, il n'est pas assez rapide. Et si vous voyez que les performances sont limit√©es par les fonctionnalit√©s du langage Python, alors il est logique d'√©crire une partie du programme dans un autre langage (dans cet article, nous parlerons de C et C ++), d'organiser cette partie du programme en tant que biblioth√®que, de cr√©er des liaisons Python (liaisons Python) par dessus et utiliser le module ainsi obtenu comme une biblioth√®que Python normale. Deuxi√®mement, une situation se produit souvent lorsque vous savez qu'il existe une biblioth√®que qui r√©sout le probl√®me requis, mais, malheureusement, cette biblioth√®que n'est pas √©crite en Python, mais dans le m√™me C ou C ++.Dans ce cas, nous pouvons √©galement cr√©er une liaison Python sur la biblioth√®que et l'utiliser sans penser au fait que la biblioth√®que n'a pas √©t√© √©crite √† l'origine en Python.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe diff√©rents outils pour cr√©er des liaisons Python, allant de celles de niveau inf√©rieur comme l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Python / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† celles de niveau sup√©rieur comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWIG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'avais pas pour objectif de comparer diff√©rentes fa√ßons de cr√©er des liaisons Python, mais je voudrais parler des bases de l'utilisation d'un seul outil, √† savoir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Initialement, SIP a √©t√© con√ßu pour cr√©er une liaison autour de la biblioth√®que Qt - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et est √©galement utilis√© pour d√©velopper d'autres grandes biblioth√®ques Python, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wxPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, gcc sera utilis√© comme compilateur pour C, et g ++ sera utilis√© comme compilateur C ++. </font><font style="vertical-align: inherit;">Tous les exemples ont √©t√© test√©s sous Arch Linux et Python 3.8. </font><font style="vertical-align: inherit;">Afin de ne pas compliquer les exemples, le sujet de la compilation pour diff√©rents syst√®mes d'exploitation et l'utilisation de diff√©rents compilateurs (par exemple, Visual Studio) n'est pas inclus dans la port√©e de cet article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez t√©l√©charger tous les exemples de cet article depuis le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©f√©rentiel sur github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©f√©rentiel avec les sources SIP est situ√© sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.riverbankcomputing.com/hg/sip/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mercurial est utilis√© comme syst√®me de contr√¥le de version pour SIP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Faire une liaison sur une biblioth√®que en C</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √âcrire une biblioth√®que en C</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet exemple se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la source, mais dans cet article, nous supposerons que nous faisons tout √† partir de z√©ro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par un exemple simple. </font><font style="vertical-align: inherit;">Tout d'abord, nous allons cr√©er une biblioth√®que C simple, que nous ex√©cuterons ensuite √† partir d'un script Python. </font><font style="vertical-align: inherit;">Que notre biblioth√®que soit la seule fonction</font></font><br>
<br>
<pre><code class="plaintext hljs">int foo(char*);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
qui prendra une cha√Æne et retournera sa longueur multipli√©e par 2. Le </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fichier d'en-t√™te </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut ressembler, par exemple, √† ceci:</font></font><br>
<br>
<pre><code class="plaintext hljs">#ifndef FOO_LIB<font></font>
#define FOO_LIB<font></font>
<font></font>
int foo(char* str);<font></font>
<font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le fichier avec l'impl√©mentation de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;string.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int foo(char* str) {<font></font>
	return strlen(str) * 2;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour tester la fonctionnalit√© de la biblioth√®que, nous allons √©crire un simple programme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;stdio.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int main(int argc, char* argv[]) {<font></font>
	char* str = "0123456789";<font></font>
	printf("%d\n", foo(str));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour plus de pr√©cision, cr√©ez un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makefile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=gcc<font></font>
CFLAGS=-c<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
	$(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.c<font></font>
	$(CC) $(CFLAGS) main.c -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.c<font></font>
	$(CC) $(CFLAGS) foo.c -o $(DIR_OUT)/foo.o<font></font>
	ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
	mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
	rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laissez toutes les sources de la biblioth√®que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se </font><i><font style="vertical-align: inherit;">trouver</font></i><font style="vertical-align: inherit;"> dans un sous-dossier de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le dossier source:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îî‚îÄ‚îÄ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et compilons les sources en utilisant la commande</font></font><br>
<br>
<pre><code class="bash hljs">make
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant la compilation, le texte sera affich√©.</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©sultat de la compilation sera plac√© dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† l'int√©rieur du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îú‚îÄ‚îÄ principal</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ‚îî‚îÄ‚îÄ Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons compil√© une biblioth√®que de liens statiques et un programme qui l'utilise sous le nom </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Apr√®s la compilation, vous pouvez v√©rifier que le programme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©marre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faisons une liaison Python sur la biblioth√®que foo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bases SIP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord installer SIP. </font><font style="vertical-align: inherit;">Cela se fait de mani√®re standard, comme avec toutes les autres biblioth√®ques utilisant pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user sip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, si vous travaillez dans un environnement virtuel, le param√®tre --user, indiquant que la biblioth√®que SIP doit √™tre install√©e dans le dossier utilisateur et non globalement dans le syst√®me, ne doit pas √™tre sp√©cifi√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que devons-nous faire pour que la biblioth√®que foo puisse √™tre appel√©e √† partir du code Python? Au minimum, vous devez cr√©er deux fichiers: l'un au format TOML et nommez-le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et le second est un fichier avec l'extension .sip. Traitons chacun d'eux s√©quentiellement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons nous mettre d'accord sur la structure de la source. A l' </font><font style="vertical-align: inherit;">int√©rieur du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dossier est le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dossier </font><font style="vertical-align: inherit;">, qui contient la source pour la biblioth√®que. Apr√®s la compilation </font><font style="vertical-align: inherit;">, le dossier </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> est cr√©√© </font><font style="vertical-align: inherit;">dans le </font><font style="vertical-align: inherit;">dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui contiendra tous les fichiers compil√©s. </font><font style="vertical-align: inherit;">Plus tard, nous ajouterons la possibilit√© pour l'utilisateur de sp√©cifier les chemins d'acc√®s aux fichiers d'en-t√™te et d'objet de la biblioth√®que via la ligne de commande. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fichiers requis pour SIP seront situ√©s dans le m√™me dossier que le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyproject.toml</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est pas une invention des d√©veloppeurs SIP, mais le format de description de projet Python d√©crit dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 517 ¬´Un format ind√©pendant du syst√®me de construction pour les arborescences sources¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518 ¬´Sp√©cification des exigences minimales du syst√®me de construction pour les projets Python¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il s'agit d'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier TOML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peut √™tre consid√©r√© comme une version plus avanc√©e du format ini, dans lequel les param√®tres sont stock√©s sous la forme de "cl√© = valeur", et les param√®tres peuvent √™tre localis√©s non seulement dans des sections comme [foo], appel√©es tables en termes TOML, mais et dans les sous-sections du formulaire [foo.bar.spam]. Les param√®tres peuvent contenir non seulement des cha√Ænes, mais √©galement des listes, des nombres et des valeurs bool√©ennes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce fichier est cens√© d√©crire tout ce qui est n√©cessaire pour construire un package Python, et pas n√©cessairement en utilisant SIP. </font><font style="vertical-align: inherit;">Cependant, comme nous le verrons un peu plus tard, dans certains cas, ce fichier ne sera pas suffisant, et en plus il faudra cr√©er un petit script Python. </font><font style="vertical-align: inherit;">Mais parlons de tout dans l'ordre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une description compl√®te de tous les param√®tres possibles du fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> li√©s √† SIP se trouve sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la page de documentation SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour notre exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cr√©ez le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fichier </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> au m√™me niveau que le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ principal</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le contenu de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera le suivant:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[build-system]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (¬´table¬ª en termes TOML) est standard et est d√©crite dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il contient deux param√®tres:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requiert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une liste des packages n√©cessaires pour construire notre package. </font><font style="vertical-align: inherit;">Le format de description de la d√©pendance du package est d√©crit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp√©cification de d√©pendance PEP 508 pour les packages logiciels Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans ce cas, nous n'avons besoin que de la version 5.x du package SIP.</font></font></li>
<li><i>build-backend</i> ,        .  ,          Python-,    .        ,   ,    SIP,     ¬´sipbuild.api¬ª.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'autres param√®tres sont d√©crits dans les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sections [tool.sip. *]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La section </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient des informations g√©n√©rales sur le paquet: le nom du paquet √† construire (notre paquet s'appellera </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais ne confondez pas ce nom avec le nom du module, que nous importerons plus tard dans Python), le num√©ro de version du paquet (dans notre cas num√©ro de version ¬´0.1¬ª) et licence (par exemple, ¬´ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬ª). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus important du point de vue de l'assemblage est d√©crit dans les [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez le nom du package dans l'en-t√™te de section. </font><font style="vertical-align: inherit;">Nous avons ajout√© deux param√®tres √† cette section:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">headers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une liste des fichiers d'en-t√™te n√©cessaires pour utiliser la biblioth√®que foo.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioth√®ques</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une liste de fichiers objets compil√©s pour la liaison statique.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le chemin o√π chercher des fichiers d' en- </font><font style="vertical-align: inherit;">t√™te suppl√©mentaires en </font><font style="vertical-align: inherit;">plus de </font><font style="vertical-align: inherit;">ceux qui sont attach√©s au compilateur C. Dans ce cas, o√π chercher le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fichier </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioth√®que-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le chemin o√π rechercher des fichiers objets suppl√©mentaires en plus de ceux qui sont attach√©s au compilateur C. Dans ce cas, il s'agit du dossier dans lequel le fichier de biblioth√®que compil√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo est cr√©√©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc cr√©√© le premier fichier n√©cessaire pour SIP. </font><font style="vertical-align: inherit;">Nous passons maintenant √† la cr√©ation du prochain fichier qui d√©crira le contenu du futur module Python.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyfoo.sip</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le m√™me dossier que le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ principal</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un fichier avec l'extension .sip d√©crit l'interface de la biblioth√®que source, qui sera convertie en module en Python. </font><font style="vertical-align: inherit;">Ce fichier a son propre format, que nous allons maintenant consid√©rer, et ressemble au fichier d'en-t√™te C / C ++ avec un balisage suppl√©mentaire, ce qui devrait aider SIP √† cr√©er un module Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre exemple, ce fichier doit s'appeler </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car auparavant, dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous avons cr√©√© le [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]. Dans le cas g√©n√©ral, il peut y avoir plusieurs partitions de ce type et, par cons√©quent, il doit y avoir plusieurs fichiers * .sip. Mais si nous avons plusieurs fichiers SIP, alors c'est un cas particulier du point de vue de SIP, et nous ne le consid√©rerons pas dans cet article. Veuillez noter que dans le cas g√©n√©ral, le nom du fichier .sip (et, par cons√©quent, le nom de la section) peut ne pas co√Øncider avec le nom du package sp√©cifi√© dans le param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la section </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de notre exemple:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo, language=<span class="hljs-string">"C"</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes qui commencent par le caract√®re "%" sont appel√©es directives. Ils devraient indiquer √† SIP comment assembler et styliser correctement le module Python. Une liste compl√®te des directives est d√©crite sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cette page de documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Certaines directives ont des param√®tres suppl√©mentaires. Les param√®tres peuvent ne pas √™tre requis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple, nous utilisons deux directives; nous d√©couvrirons d'autres directives dans les exemples suivants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commence par la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module (name = foo, language = ‚ÄúC‚Äù)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Veuillez noter que </font><font style="vertical-align: inherit;">nous avons sp√©cifi√© la </font><font style="vertical-align: inherit;">valeur du premier param√®tre ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nom</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) sans guillemets, et la valeur du deuxi√®me param√®tre ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) avec des guillemets, comme des cha√Ænes en C / C ++. </font><font style="vertical-align: inherit;">Il s'agit d'une exigence de cette directive, comme d√©crit dans la documentation de la directive </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">seul le param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est requis </font><font style="vertical-align: inherit;">, ce qui d√©finit le nom du module Python √† partir duquel nous importerons la fonction de biblioth√®que. </font><font style="vertical-align: inherit;">Dans ce cas, le module s'appelle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il contiendra la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donc apr√®s assemblage et installation nous l'importerons en utilisant le code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pourrions rendre ce module imbriqu√© dans un autre module en rempla√ßant cette ligne, par exemple, par ceci:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo.bar, language=<span class="hljs-string">"C"</span>)<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, importez la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo devrait</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √™tre comme suit:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo.bar <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le param√®tre </font><font style="vertical-align: inherit;">de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique la langue dans laquelle la biblioth√®que source est √©crite. </font><font style="vertical-align: inherit;">La valeur de ce param√®tre peut √™tre ¬´C¬ª ou ¬´C ++¬ª. </font><font style="vertical-align: inherit;">Si ce param√®tre n'est pas sp√©cifi√©, SIP supposera que la biblioth√®que est √©crite en C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardez maintenant la derni√®re ligne du fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une description de l'interface de la fonction de la biblioth√®que que nous voulons mettre dans le module Python. </font><font style="vertical-align: inherit;">Sur la base de cette d√©claration, sip cr√©era une fonction Python. </font><font style="vertical-align: inherit;">Je pense que tout devrait √™tre clair ici.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous collectons et v√©rifions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, tout est pr√™t pour construire un paquet Python avec une liaison pour une biblioth√®que C. Tout d'abord, vous devez construire la biblioth√®que elle-m√™me. </font><font style="vertical-align: inherit;">Acc√©dez au </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dossier pyfoo_c_01 / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d√©marrez la g√©n√©ration √† l'aide de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">$ make<font></font>
<font></font>
mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout s'est bien pass√©, le </font><font style="vertical-align: inherit;">dossier </font><i><font style="vertical-align: inherit;">bin</font></i><font style="vertical-align: inherit;"> sera cr√©√© </font><font style="vertical-align: inherit;">√† l'int√©rieur du </font><font style="vertical-align: inherit;">dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans lequel, entre autres fichiers, il y aura une biblioth√®que </font><i><font style="vertical-align: inherit;">libfoo.a</font></i><font style="vertical-align: inherit;"> compil√©e </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Permettez-moi de vous rappeler qu'ici, afin de ne pas √™tre distrait du sujet principal, nous ne parlons que de construire sous Linux en utilisant gcc. </font><font style="vertical-align: inherit;">
Retournez dans le dossier </font><i><font style="vertical-align: inherit;">pyfoo_c_01</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il est maintenant temps de d√©couvrir les √©quipes SIP. </font><font style="vertical-align: inherit;">Apr√®s l'installation de SIP, les commandes de ligne de commande suivantes seront disponibles ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">page de documentation</font></a><font style="vertical-align: inherit;"> ):</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cr√©e un fichier objet d'extension Python.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cr√©e un fichier objet d'extension Python et l'installe.</font></font></li>
<li><i>sip-sdist</i>.      .tar.gz,      pip.</li>
<li><i>sip-wheel</i>.     wheel (   .whl).</li>
<li><i>sip-module</i>.  ,      ,   SIP.  ,    ,    .         ,       standalone project,      ,     ,     ,    .</li>
<li><i>sip-distinfo</i>.     <i>.dist-info</i>,       wheel.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces commandes doivent √™tre ex√©cut√©es √† partir du dossier o√π se trouve le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, pour mieux comprendre le fonctionnement de SIP, ex√©cutez la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , avec l'option </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--verbose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour une sortie plus d√©taill√©e sur la console, et voyez ce qui se passe pendant le processus de construction. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build --verbose</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ces liaisons seront construites: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G√©n√©ration des liaisons pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilation du module 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
construction de l'extension 'foo' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cr√©ation de build </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cr√©ation de build / temp.linux-x86_64-3.8</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c sipfoocmodule.c -o build / temp.linux-x86_64-3.8 / sipfoocmodule.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Dans la fonction </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">sipfoocmodule .c: 29: 22: avertissement: d√©claration de fonction implicite ¬´foo¬ª [-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c array.c -o build / temp.linux-x86_64-3.8 / array.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno -used-result -Wsign -comparer -DNDEBUG -g -fwrapv -O3 -Mur -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fno-s√©mantique-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c bool.cpp -o build / temp.linux-x86_64-3.8 / bool.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c objmap.c -o build / temp.linux-x86_64-3.8 / objmap.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign -comparer -DNDEBUG -g -fwrapv -O3 -Mur -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fno-s√©mantique-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c qtlib.c -o build / temp.linux-x86_64-3.8 / qtlib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c int_convertors.c -o build / temp.linux-x86_64-3.8 / int_convertors.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non utilis√©-r√©sultat -Wsign -comparer -DNDEBUG -g -fwrapv -O3 -Mur -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fno-s√©mantique-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c voidptr.c -o build / temp.linux-x86_64-3.8 / voidptr.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c apiversions.c -o build / temp.linux-x86_64-3.8 / apiversions.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign -comparer -DNDEBUG -g -fwrapv -O3 -Mur -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fno-s√©mantique-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c descriptors.c -o build / temp.linux-x86_64-3.8 / descriptors.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-non-result-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c threads.c -o build / temp.linux-x86_64-3.8 / </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
threads.o gcc -pthread -Wno-non utilis√©-result -Wsign -comparer -DNDEBUG -g -fwrapv -O3 -Mur -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fno-s√©mantique-interposition -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -march = x86-64 -mtune = g√©n√©rique -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c siplib.c -o build / temp.linux-x86_64-3.8 / siplib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dans la fonction "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: avertissement: "st" peut √™tre utilis√© sans initialisation dans cette fonction [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: remarque: "st" a √©t√© d√©clar√© ici </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dans la fonction "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: avertissement: "propri√©taire" peut √™tre utilis√© sans initialisation dans cette fonction [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * propri√©taire = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g ++ -pthread -shared -Wl, -O1, - sort-common, - as-needed, -z, relro, -z, now -fno-semantic-interposition -Wl, -O1, - sort-common, --as-needed, -z, relro, -z, now build / temp.linux-x86_64-3.8 / sipfoocmodule.o build / temp.linux-x86_64-3.8 / array.o build / temp.linux-x86_64-3.8 /bool.o build / temp.linux-x86_64-3.8 / objmap.o build / temp.linux-x86_64-3.8 / qtlib.o build / temp.linux-x86_64-3.8 / int_convertors.o build / temp.linux-x86_64 -3.8 / voidptr.o build / temp.linux-x86_64-3.8 / apiversions.o build / temp.linux-x86_64-3.8 / descriptors.o build / temp.linux-x86_64-3.8 / threads.o build / temp.linux -x86_64-3.8 / siplib.o -L ../../ foo / bin -L / usr / lib -lfoo -o / home / jenyay / projects / soft / sip-examples / pyfoo_c_01 / build / foo / foo. cpython-38-x86_64-linux-gnu.so </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet a √©t√© construit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous n'entrerons pas en profondeur dans le travail de SIP, mais il ressort de la sortie que certaines sources sont en train de compiler. </font><font style="vertical-align: inherit;">Ces sources peuvent √™tre vues dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cr√©√© par cette commande </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ construire</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ apiversions.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ array.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ array.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bool.cpp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ construire</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ temp.linux-x86_64-3.8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ apiversions.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ array.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ bool.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ descriptors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ int_convertors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ objmap.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ qtlib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ sipfoocmodule.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ siplib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ threads.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ voidptr.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ descriptors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.cpython-38-x86_64-linux-gnu.so</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ int_convertors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ objmap.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ qtlib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sipAPIfoo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sipfoocmodule.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sip.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ sipint.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ siplib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ threads.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ voidptr.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ foo.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ principal</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îú‚îÄ‚îÄ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îÇ ‚îî‚îÄ‚îÄ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îú‚îÄ‚îÄ pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚îî‚îÄ‚îÄ pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des sources auxiliaires sont apparues </font><font style="vertical-align: inherit;">
dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par curiosit√©, regardons le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocmodule.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car il concerne directement le module </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui sera cr√©√©:</font></font><br>
<br>
<pre><code class="plaintext hljs">/*<font></font>
 * Module code.<font></font>
 *<font></font>
 * Generated by SIP 5.1.1<font></font>
 */<font></font>
<font></font>
#include "sipAPIfoo.h"<font></font>
<font></font>
/* Define the strings used by this module. */<font></font>
const char sipStrings_foo[] = {<font></font>
    'f', 'o', 'o', 0,<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_foo, "foo(str) -&gt; int");<font></font>
<font></font>
static PyObject *func_foo(PyObject *sipSelf,PyObject *sipArgs)<font></font>
{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        char* a0;<font></font>
<font></font>
        if (sipParseArgs(&amp;sipParseErr, sipArgs, "s", &amp;a0))<font></font>
        {<font></font>
            int sipRes;<font></font>
<font></font>
            sipRes = foo(a0);<font></font>
<font></font>
            return PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    /* Raise an exception if the arguments couldn't be parsed. */<font></font>
    sipNoFunction(sipParseErr, sipName_foo, doc_foo);<font></font>
<font></font>
    return SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
/* This defines this module. */<font></font>
sipExportedModuleDef sipModuleAPI_foo = {<font></font>
    0,<font></font>
    SIP_ABI_MINOR_VERSION,<font></font>
    sipNameNr_foo,<font></font>
    0,<font></font>
    sipStrings_foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
            SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
<font></font>
/* The SIP API and the APIs of any imported modules. */<font></font>
const sipAPIDef *sipAPI_foo;<font></font>
<font></font>
/* The Python module initialisation function. */<font></font>
#if defined(SIP_STATIC_MODULE)<font></font>
PyObject *PyInit_foo(void)<font></font>
#else<font></font>
PyMODINIT_FUNC PyInit_foo(void)<font></font>
#endif<font></font>
{<font></font>
    static PyMethodDef sip_methods[] = {<font></font>
        {sipName_foo, func_foo, METH_VARARGS, doc_foo},<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, 0, SIP_NULLPTR}<font></font>
    };<font></font>
<font></font>
    static PyModuleDef sip_module_def = {<font></font>
        PyModuleDef_HEAD_INIT,<font></font>
        "foo",<font></font>
        SIP_NULLPTR,<font></font>
        -1,<font></font>
        sip_methods,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    };<font></font>
<font></font>
    PyObject *sipModule, *sipModuleDict;<font></font>
    /* Initialise the module and get it's dictionary. */<font></font>
    if ((sipModule = PyModule_Create(&amp;sip_module_def)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    sipModuleDict = PyModule_GetDict(sipModule);<font></font>
<font></font>
    if ((sipAPI_foo = sip_init_library(sipModuleDict)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    /* Export the module and publish it's API. */<font></font>
    if (sipExportModule(&amp;sipModuleAPI_foo, SIP_ABI_MAJOR_VERSION, SIP_ABI_MINOR_VERSION, 0) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
    /* Initialise the module now all its dependencies have been set up. */<font></font>
    if (sipInitModule(&amp;sipModuleAPI_foo,sipModuleDict) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
<font></font>
    return sipModule;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez travaill√© avec l'API Python / C, vous verrez des fonctions famili√®res. Portez une attention particuli√®re √† la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">func_foo √†</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de la ligne 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la suite de la compilation de ces sources, le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / foo.cpython-38-x86_64-linux-gnu.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera cr√©√© </font><font style="vertical-align: inherit;">et contient l'extension Python, qui doit encore √™tre install√©e correctement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de compiler l'extension et de l'installer imm√©diatement, vous pouvez utiliser la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais nous ne l'utilisons pas, car par d√©faut, il essaie d'installer l'extension Python cr√©√©e globalement dans le syst√®me. Cette commande a un param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--target-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, avec lequel vous pouvez sp√©cifier le chemin o√π vous souhaitez installer l'extension, mais nous ferons mieux d'utiliser d'autres outils qui cr√©ent des packages, qui peuvent ensuite √™tre install√©s √† l'aide de pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, utilisez la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Son utilisation est tr√®s simple:</font></font><br>
<br>
<pre><code class="bash hljs">$ sip-sdist<font></font>
<font></font>
The sdist has been built.<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1.tar.gz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera cr√©√© </font><font style="vertical-align: inherit;">, qui peut √™tre install√© √† l'aide de la commande:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user pyfoo-0.1.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, les informations suivantes seront affich√©es et le package sera install√©:</font></font><br>
<br>
<pre><code class="plaintext hljs">Processing ./pyfoo-0.1.tar.gz<font></font>
  Installing build dependencies ... done<font></font>
  Getting requirements to build wheel ... done<font></font>
    Preparing wheel metadata ... done<font></font>
Building wheels for collected packages: pyfoo<font></font>
  Building wheel for pyfoo (PEP 517) ... done<font></font>
  Created wheel for pyfoo: filename=pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl size=337289 sha256=762fc578...<font></font>
  Stored in directory: /home/jenyay/.cache/pip/wheels/54/dc/d8/cc534fff...<font></font>
Successfully built pyfoo<font></font>
Installing collected packages: pyfoo<font></font>
  Attempting uninstall: pyfoo<font></font>
    Found existing installation: pyfoo 0.1<font></font>
    Uninstalling pyfoo-0.1:<font></font>
      Successfully uninstalled pyfoo-0.1<font></font>
Successfully installed pyfoo-0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assurons-nous que nous avons r√©ussi √† cr√©er une liaison Python. </font><font style="vertical-align: inherit;">Nous d√©marrons Python et essayons d'appeler la fonction. </font><font style="vertical-align: inherit;">Permettez-moi de vous rappeler que selon nos param√®tres, le paquet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient le module </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'123456'</span>)
<span class="hljs-number">12</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter qu'en tant que param√®tre de la fonction, nous transmettons non seulement une cha√Æne, mais une cha√Æne d'octets b'123456 '- un analogue direct de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en C. Un peu plus tard, nous ajouterons la conversion de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et vice versa. Le r√©sultat √©tait attendu. Permettez-moi de vous rappeler que la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renvoie la double taille d'un tableau de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui lui est pass√©e en param√®tre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de passer une </font><font style="vertical-align: inherit;">cha√Æne Python r√©guli√®re </font><font style="vertical-align: inherit;">√† la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au lieu d'une liste d'octets.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'123456'</span>)<font></font>
<font></font>
Traceback (most recent call last):<font></font>
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
TypeError: foo(str): argument <span class="hljs-number">1</span> has unexpected type <span class="hljs-string">'str'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La liaison cr√©√©e n'a pas pu convertir la cha√Æne en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; nous verrons comment lui apprendre comment proc√©der dans la section suivante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√©licitations, nous avons cr√©√© la premi√®re liaison sur une biblioth√®que √©crite en C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quittez l'interpr√©teur Python et assemblez l'assemblage au format roue. Comme vous le savez sans doute, wheel est un format de package relativement nouveau qui a √©t√© utilis√© universellement r√©cemment. Le format est d√©crit dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 427, ¬´The Wheel Binary Package Format 1.0¬ª,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mais une description des caract√©ristiques du format de roue est un sujet digne d'un grand article s√©par√©. Il est important pour nous que l'utilisateur puisse facilement installer le package au format roue √† l'aide de pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un package au format roue n'est pas plus compliqu√© qu'un package au format sdist. Pour ce faire, dans le dossier contenant le fichier</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit ex√©cuter la commande</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir ex√©cut√© cette commande, le processus de g√©n√©ration sera affich√© et il peut y avoir des avertissements du compilateur: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ sip-wheel </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces liaisons seront construites: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G√©n√©ration des liaisons pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilation du module 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: Dans la fonction </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo: sipfoocmodule.c: 29:22: avertissement: d√©claration de fonction implicite de la fonction foo [-Wimplicit-function-declaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dans la fonction "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: avertissement: "st" peut √™tre utilis√© sans initialisation dans cette fonction [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~~~~~~~~~~~~~~~~~~~~~~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 10671: 19: remarque: "st" a √©t√© d√©clar√© ici</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: Dans la fonction "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: avertissement: "propri√©taire" peut √™tre utilis√© sans initialisation dans cette fonction [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * propri√©taire = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~ ^ ~ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La roue a √©t√© construite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque l'assemblage est termin√© (notre petit projet se compile rapidement), un fichier avec le nom </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou similaire </font><font style="vertical-align: inherit;">appara√Ætra dans le dossier du projet </font><font style="vertical-align: inherit;">. Le nom du fichier g√©n√©r√© peut diff√©rer selon votre syst√®me d'exploitation et la version de Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous pouvons installer ce package en utilisant pip:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'option </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--upgrade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est utilis√©e </font><i><font style="vertical-align: inherit;">ici</font></i><font style="vertical-align: inherit;"> afin que pip remplace le module pyfoo install√© pr√©c√©demment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, le module </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le paquet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peuvent √™tre utilis√©s, comme indiqu√© ci-dessus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ajouter des r√®gles de conversion √† char *</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section pr√©c√©dente, nous avons rencontr√© un probl√®me selon lequel la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><font style="vertical-align: inherit;">peut accepter qu'un ensemble d'octets, mais pas de cha√Ænes. Nous allons maintenant corriger cette lacune. Pour ce faire, nous utiliserons un autre outil SIP - les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">annotations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les annotations sont utilis√©es dans les fichiers .sip et sont appliqu√©es √† certains √©l√©ments de code: fonctions, classes, arguments de fonction, exceptions, variables, etc. Les annotations sont √©crites entre des barres obliques: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ annotation /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une annotation peut fonctionner comme un indicateur, qui peut √™tre dans l'√©tat d√©fini ou non d√©fini, par exemple: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ReleaseGIL /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou certaines annotations doivent √™tre affect√©es √† certaines valeurs, par exemple: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Encoding = "UTF-8" /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si plusieurs annotations doivent √™tre appliqu√©es √† un objet, elles sont s√©par√©es par des virgules dans des barres obliques: / annotation_1, annotation_2 /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'exemple suivant, qui se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ajoutez une </font><font style="vertical-align: inherit;">fonction de param√®tre d'annotation de </font><font style="vertical-align: inherit;">fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
<font></font>
int foo(char* /Encoding="UTF-8"/);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique dans quel encodage la cha√Æne √† passer √† la fonction doit √™tre encod√©e. Les valeurs de cette annotation peuvent √™tre: ASCII, Latin-1, UTF-8 ou None. Si l'annotation d' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encodage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est </font><font style="vertical-align: inherit;">pas sp√©cifi√©e ou √©gale √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le param√®tre d'une telle fonction n'est soumis √† aucun encodage et est transmis √† la fonction telle quelle, mais dans ce cas, le param√®tre en code Python doit √™tre de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octets</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-√†-dire un tableau d'octets, comme nous l'avons vu dans l'exemple pr√©c√©dent. Si le codage est sp√©cifi√©, ce param√®tre peut √™tre une cha√Æne (tapez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Python). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> annotation d' </font><i><font style="vertical-align: inherit;">encodage</font></i><font style="vertical-align: inherit;"> ne peut √™tre appliqu√©e qu'aux param√®tres de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V√©rifions comment la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonction </font><font style="vertical-align: inherit;">du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le module </font><font style="vertical-align: inherit;">fonctionne maintenant </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pour ce faire, comme pr√©c√©demment, vous devez d'abord compiler la biblioth√®que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font><font style="vertical-align: inherit;">appelant </font><font style="vertical-align: inherit;">la commande </font><i><font style="vertical-align: inherit;">make</font></i><font style="vertical-align: inherit;"> dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis </font><font style="vertical-align: inherit;">appeler la commande, par exemple, </font><i><font style="vertical-align: inherit;">sip-wheel, √†</font></i><font style="vertical-align: inherit;"> partir du dossier d'exemple </font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le fichier </font><i><font style="vertical-align: inherit;">pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;"> ou avec un nom similaire </font><font style="vertical-align: inherit;">sera cr√©√© </font><font style="vertical-align: inherit;">, qui peut √™tre d√©fini √† l'aide de la commande:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout s'est bien pass√©, d√©marrez l'interpr√©teur Python et essayez d'appeler la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec un argument de cha√Æne:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">''</span>)
<span class="hljs-number">24</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous nous assurons que l'utilisation d' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octets</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est toujours possible. Apr√®s cela, nous nous assurons que maintenant nous pouvons √©galement passer </font><font style="vertical-align: inherit;">des arguments de cha√Æne </font><font style="vertical-align: inherit;">√† la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Notez que la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour un argument de cha√Æne avec des lettres russes a renvoy√© une valeur deux fois plus grande que pour une cha√Æne contenant uniquement des lettres latines. Cela est arriv√© parce que la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne compte pas la longueur de la cha√Æne en caract√®res (et la double), mais la longueur du tableau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et comme en UTF-8, le codage des lettres russes occupe 2 octets, puis la taille du tableau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apr√®s la conversion de Les cha√Ænes Python se sont av√©r√©es √™tre deux fois plus longues. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien! Nous avons r√©solu le probl√®me avec l'argument de fonction</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais que se passe-t-il si nous avons des dizaines ou des centaines de ces fonctions dans notre biblioth√®que, devrez-vous sp√©cifier l'encodage des param√®tres pour chacune d'entre elles? Souvent, l'encodage utilis√© dans un programme est le m√™me, et il n'y a aucune raison pour que diff√©rentes fonctions indiquent des encodages diff√©rents. Dans ce cas, il est possible de sp√©cifier un encodage par d√©faut dans SIP, et si pour une fonction un encodage est n√©cessaire pour un autre, alors il peut √™tre red√©fini en utilisant l'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©finir l'encodage des param√®tres de fonction par d√©faut, la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><i><font style="vertical-align: inherit;">utilis√©e</font></i><font style="vertical-align: inherit;"> . Son utilisation est illustr√©e dans l'exemple situ√© dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de profiter de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , changez le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, son contenu est maintenant le suivant:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
%DefaultEncoding "UTF-8"<font></font>
<font></font>
int foo(char*);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, si l'argument est une fonction de type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font><font style="vertical-align: inherit;">S'il </font><font style="vertical-align: inherit;">n'y a pas d'annotation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors l'encodage est tir√© de la directive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et si ce n'est pas le cas, alors la conversion n'est pas effectu√©e, et pour tous les param√®tres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font><font style="vertical-align: inherit;">il faut transf√©rer non pas des lignes, mais des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octets</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03 est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collect√© et v√©rifi√© de la m√™me mani√®re qu'un exemple du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref sur project.py. </font><font style="vertical-align: inherit;">Automatisez l'assemblage</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'√† pr√©sent, nous avons utilis√© deux fichiers utilitaires pour cr√©er une liaison Python - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous allons maintenant nous familiariser avec un autre de ces fichiers, qui devrait s'appeler </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Avec ce script, nous pouvons influencer le processus de construction de notre package. Faisons l'automatisation de la construction. Afin de collecter les exemples </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des sections pr√©c√©dentes, vous deviez d'abord aller dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y compiler √† l'aide de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , retourner dans le dossier o√π se trouve le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puis commencer √† construire le package √† l'aide de l'un des commandes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, notre objectif est de nous assurer que lors de l'ex√©cution des commandes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l'assemblage de la biblioth√®que C </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est d√©marr√© en premier </font><font style="vertical-align: inherit;">, puis la commande elle-m√™me est d√©j√† lanc√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple cr√©√© dans cette section se trouve dans le dossier </font><font style="vertical-align: inherit;">source </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour modifier le processus de g√©n√©ration, nous pouvons </font><font style="vertical-align: inherit;">d√©clarer une classe </font><font style="vertical-align: inherit;">dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (le nom de fichier doit √™tre juste celui) qui est d√©riv√©e de la classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cette classe poss√®de des m√©thodes que nous pouvons remplacer par nous-m√™mes. </font><font style="vertical-align: inherit;">Actuellement, nous nous int√©ressons aux m√©thodes suivantes:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construire</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Appel√© lors de l'appel √† la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Appel√© lorsque la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande sip-sdist est appel√©e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Appel√© lorsque la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP-Wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est appel√©e </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Appel√© lorsque la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est invoqu√©e </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, nous pouvons red√©finir le comportement de ces commandes. </font><font style="vertical-align: inherit;">√Ä strictement parler, les m√©thodes r√©pertori√©es sont d√©clar√©es dans la classe abstraite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.AbstractProject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √† partir de laquelle la classe d√©riv√©e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est cr√©√©e </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez un fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec le contenu suivant:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©clar√© la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d√©riv√©e de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et y </font><i><font style="vertical-align: inherit;">avons d√©fini les </font></i><i><font style="vertical-align: inherit;">m√©thodes </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans toutes ces m√©thodes, nous appelons les m√©thodes du m√™me nom √† partir de la classe de base, avant d'appeler la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_build_foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui d√©marre l'ex√©cution de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez que les </font><i><font style="vertical-align: inherit;">m√©thodes </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doivent renvoyer le nom du fichier qu'elles ont cr√©√©. Ceci n'est pas √©crit dans la documentation, mais est indiqu√© dans les sources SIP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous n'avons pas besoin d'ex√©cuter la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manuellement pour construire la biblioth√®que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cela se fera automatiquement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous </font><font style="vertical-align: inherit;">ex√©cutez </font><font style="vertical-align: inherit;">maintenant </font><font style="vertical-align: inherit;">la commande </font><i><font style="vertical-align: inherit;">sip-wheel</font></i><font style="vertical-align: inherit;"> dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un fichier est cr√©√© avec le nom pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl ou similaire selon votre syst√®me d'exploitation et la version de Python. </font><font style="vertical-align: inherit;">
Ce package peut √™tre install√© √† l'aide de la commande:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, vous pouvez vous assurer que la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonction </font><font style="vertical-align: inherit;">du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le module </font><font style="vertical-align: inherit;">fonctionne toujours.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ajouter des options de ligne de commande √† construire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple suivant se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le package a un num√©ro de version de 0,5 (voir les param√®tres dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Cet exemple est bas√© sur un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemple de la documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec quelques corrections. Dans cet exemple, nous allons refaire notre fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ajouter de nouvelles options de ligne de commande pour la build. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans nos exemples, nous construisons une biblioth√®que tr√®s simple </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et dans les projets r√©els, la biblioth√®que peut √™tre assez volumineuse et il ne sera alors pas judicieux de l'inclure dans le code source du projet de liaison Python. Permettez-moi de vous rappeler que SIP a √©t√© cr√©√© √† l'origine pour cr√©er une liaison pour une biblioth√®que aussi √©norme que Qt. Vous pouvez, bien s√ªr, affirmer que les sous-modules de git peuvent aider √† organiser la source, mais ce n'est pas le but. Supposons que la biblioth√®que ne se trouve pas dans le dossier avec la source de liaison. Dans ce cas, la question se pose: o√π le collecteur SIP doit-il rechercher l'en-t√™te de biblioth√®que et les fichiers objets? Dans ce cas, diff√©rents utilisateurs peuvent avoir leurs propres fa√ßons de placer la biblioth√®que. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©soudre ce probl√®me, nous allons ajouter deux nouvelles options de ligne de commande au syst√®me de construction, avec lesquelles vous pouvez sp√©cifier le chemin d'acc√®s au fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-include-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et au fichier objet de la biblioth√®que (param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-library-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). De plus, nous supposerons que si ces param√®tres ne sont pas sp√©cifi√©s, la biblioth√®que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est toujours localis√©e avec les sources de liaison. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons recr√©er le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et y d√©clarer une classe d√©riv√©e de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Examinons d'abord la nouvelle version du fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis </font><font style="vertical-align: inherit;">voyons </font><font style="vertical-align: inherit;">comment cela fonctionne.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Option, Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-string">"""        
       foo.
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""     . """</span><font></font>
<font></font>
        tools = [<span class="hljs-string">'build'</span>, <span class="hljs-string">'install'</span>, <span class="hljs-string">'sdist'</span>, <span class="hljs-string">'wheel'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   .</span><font></font>
        options = super().get_options()<font></font>
<font></font>
        <span class="hljs-comment">#   </span>
        inc_dir_option = Option(<span class="hljs-string">'foo_include_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing foo.h"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo'</span>),<font></font>
                                tools=tools)<font></font>
        options.append(inc_dir_option)<font></font>
<font></font>
        lib_dir_option = Option(<span class="hljs-string">'foo_library_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing the foo library"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo/bin'</span>),<font></font>
                                tools=tools)<font></font>
<font></font>
        options.append(lib_dir_option)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""    . """</span><font></font>
<font></font>
        <span class="hljs-comment">#     </span><font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
        <span class="hljs-comment">#  ,         </span><font></font>
        self.foo_include_dir = os.path.abspath(self.foo_include_dir)<font></font>
        self.foo_library_dir = os.path.abspath(self.foo_library_dir)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""   . """</span><font></font>
<font></font>
        <span class="hljs-comment">#   pyfoo</span>
        <span class="hljs-comment"># (  pyproject.toml  [tool.sip.bindings.pyfoo])</span>
        foo_bindings = self.bindings[<span class="hljs-string">'pyfoo'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   include_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_include_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.include_dirs = [self.foo_include_dir]<font></font>
<font></font>
        <span class="hljs-comment">#   library_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_library_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.library_dirs = [self.foo_library_dir]<font></font>
<font></font>
        super().update(tool)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √† nouveau cr√©√© la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d√©riv√©e de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans cet exemple, l'assemblage automatique de la biblioth√®que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est d√©sactiv√© </font><font style="vertical-align: inherit;">, car il est d√©sormais suppos√© qu'il peut se trouver √† un autre endroit et au moment de la cr√©ation de la liaison, les fichiers d'en-t√™te et d'objet doivent √™tre pr√™ts. </font><font style="vertical-align: inherit;">Trois m√©thodes sont red√©finis </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise √† </font><font style="vertical-align: inherit;">jour</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Consid√©rez-les plus attentivement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cette m√©thode doit renvoyer une liste d'instances de la classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Option</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Chaque √©l√©ment de liste est une option de ligne de commande. Dans la m√©thode remplac√©e, nous obtenons la liste des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par d√©faut (la variable </font><i><font style="vertical-align: inherit;">options</font></i><font style="vertical-align: inherit;"> ) en appelant la m√©thode de classe de base du m√™me nom, puis cr√©ons deux nouvelles options ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) et les ajoutons √† la liste, puis </font><i><font style="vertical-align: inherit;">renvoyons</font></i><font style="vertical-align: inherit;"> cette liste √† partir de la fonction. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le constructeur de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> accepte un param√®tre obligatoire (nom de l'option) et un nombre suffisamment important de param√®tres facultatifs qui d√©crivent le type de valeur pour ce param√®tre, la valeur par d√©faut, la description du param√®tre et quelques autres. Cet exemple utilise les options suivantes pour le constructeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><i>help</i>   ,   ,     <i>sip-wheel -h</i></li>
<li><i>metavar</i> ‚Äî  ,    ,       .     <i>metavar</i>  ¬´DIR¬ª,   ,     ‚Äî .</li>
<li><i>default</i> ‚Äî     .    ,          ,   <i>foo</i>   ,      (    ).</li>
<li><i>tools</i> ‚Äî  ,        .        <i>sip-build</i>, <i>sip-install</i>, <i>sip-sdist</i>  <i>sip-wheel</i>,  tools = ['build', 'install', 'sdist', 'wheel'].</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> surcharg√©e </font><i><font style="vertical-align: inherit;">suivante est</font></i><font style="vertical-align: inherit;"> con√ßue pour d√©finir des valeurs de param√®tre que l'utilisateur peut transmettre via la ligne de commande. La m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la classe de base cr√©e une </font><font style="vertical-align: inherit;">variable (membre de classe) </font><font style="vertical-align: inherit;">pour chaque param√®tre de ligne de commande cr√©√© dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il est donc important d'appeler la m√©thode de classe de base du m√™me nom avant d'utiliser les variables cr√©√©es afin que toutes les variables cr√©√©es √† l'aide des param√®tres de ligne de commande soient cr√©√©es et initialis√©es avec des valeurs par d√©faut . Apr√®s cela, dans notre exemple, les variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;"> seront cr√©√©es</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si l'utilisateur n'a pas sp√©cifi√© les param√®tres de ligne de commande correspondants, il prendra alors les valeurs par d√©faut en fonction des param√®tres du constructeur de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par d√©faut</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Si le param√®tre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par d√©faut</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est </font><font style="vertical-align: inherit;">pas d√©fini, en fonction du type de la valeur de param√®tre attendue, il sera initialis√© soit Aucun, soit une liste vide, ou 0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">nous nous</font></i><font style="vertical-align: inherit;"> assurons que les chemins dans les variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir sont</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toujours absolus. Cela est n√©cessaire pour qu'il ne d√©pende pas de ce que sera le dossier de travail au moment du d√©marrage de l'assemblage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La derni√®re m√©thode surcharg√©e de cette classe est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cette m√©thode est appel√©e lorsqu'il est n√©cessaire d'appliquer au projet les modifications apport√©es auparavant. Par exemple, modifiez ou ajoutez les param√®tres sp√©cifi√©s dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans les exemples pr√©c√©dents, nous avons d√©fini les chemins d'acc√®s aux fichiers d'en-t√™te et d'objet √† l'aide des param√®tres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">respectivement, dans la section </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.bindings.pyfoo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Maintenant, nous allons d√©finir ces param√®tres √† partir du script </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donc dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">nous </font><font style="vertical-align: inherit;">supprimerons ces param√®tres:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.3"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise √† </font><font style="vertical-align: inherit;">jour</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous du dictionnaire </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.bindings</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> clavet√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gat exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Bindings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le nom de la cl√© correspond aux [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] du fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et l'instance de classe ainsi obtenue d√©crit les param√®tres d√©crits dans cette section. Ensuite, les membres de cette classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (les noms des membres correspondent aux param√®tres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec un trait d'union remplac√© par des traits de soulignement) re√ßoivent des listes contenant les chemins stock√©s dans les membres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans cet exemple, pour plus de pr√©cision, nous v√©rifions que les valeurs </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><i><font style="vertical-align: inherit;">sont</font></i><font style="vertical-align: inherit;"> pas √©gales √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais dans cet exemple, cette condition est toujours remplie car les param√®tres de ligne de commande que nous avons cr√©√©s ont des valeurs par d√©faut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, nous avons pr√©par√© les fichiers de configuration afin que lors de l'assemblage, il soit possible d'indiquer les chemins d'acc√®s aux fichiers d'en-t√™te et d'objet. V√©rifions ce qui s'est pass√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, assurez-vous que les valeurs par d√©faut fonctionnent. Pour ce faire, acc√©dez au dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05 / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><i><font style="vertical-align: inherit;">cr√©ez</font></i><font style="vertical-align: inherit;"> la biblioth√®que √† l'aide de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car nous avons d√©sactiv√© la g√©n√©ration automatique de biblioth√®que dans cet exemple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, allez dans le dossier</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ex√©cutez la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">√Ä la suite de cette commande, le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier pyfoo-0.5-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou avec un nom similaire </font><font style="vertical-align: inherit;">sera cr√©√© </font><font style="vertical-align: inherit;">. </font><i><font style="vertical-align: inherit;">D√©placez</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
maintenant le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quelque part en dehors du dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ex√©cutez √† nouveau la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Par cons√©quent, nous obtenons l'erreur attendue informant que nous n'avons pas de fichier de biblioth√®que d'objets:</font></font><br>
<br>
<pre><code class="plaintext hljs">usr/bin/ld:   -lfoo<font></font>
collect2: :  ld     1<font></font>
sip-wheel: Unable to compile the 'foo' module: command 'g++' failed with exit status 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, ex√©cutez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel en</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant la nouvelle option de ligne de commande:</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel --foo-include-dir <span class="hljs-string">".../foo"</span> --foo-library-dir <span class="hljs-string">".../foo/bin"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu des points de suspension, vous devez sp√©cifier le chemin d'acc√®s au dossier dans lequel vous avez d√©plac√© le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec la biblioth√®que assembl√©e. </font><font style="vertical-align: inherit;">Par cons√©quent, l'assembly doit r√©ussir √† cr√©er le fichier .whl. </font><font style="vertical-align: inherit;">Le module cr√©√© peut √™tre install√© et test√© de la m√™me mani√®re que dans les sections pr√©c√©dentes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V√©rifiez l'ordre des m√©thodes d'appel √† partir de project.py</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple suivant, que nous consid√©rerons, sera tr√®s simple; il montrera l'ordre d'appeler les m√©thodes de la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que nous avons surcharg√©es dans les sections pr√©c√©dentes. Cela peut √™tre utile pour comprendre quand les variables peuvent √™tre initialis√©es. Cet exemple se trouve dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du r√©f√©rentiel source. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'essence de cet exemple est de </font><font style="vertical-align: inherit;">surcharger toutes les m√©thodes que nous avons utilis√©es auparavant </font><font style="vertical-align: inherit;">dans la classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui se trouve dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et de leur ajouter des appels √† la fonction d' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impression</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui afficheraient le nom de la m√©thode dans laquelle il se trouve:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'get_options()'</span>)<font></font>
        options = super().get_options()<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_user_defaults()'</span>)<font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_nonuser_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_nonuser_defaults()'</span>)<font></font>
        super().apply_nonuser_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'update()'</span>)<font></font>
        super().update(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'build()'</span>)<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span>
        print(<span class="hljs-string">'build_sdist()'</span>)
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span>
        print(<span class="hljs-string">'build_wheel()'</span>)
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'install()'</span>)<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lecteurs attentifs doivent noter qu'en plus des m√©thodes pr√©c√©demment utilis√©es, la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont nous n'avons pas parl√© auparavant </font><font style="vertical-align: inherit;">, est surcharg√©e dans cet exemple </font><font style="vertical-align: inherit;">. Cette m√©thode recommande de d√©finir des valeurs par d√©faut pour toutes les variables qui ne peuvent pas √™tre modifi√©es via les param√®tres de ligne de commande. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renvoyez le chemin explicite vers la biblioth√®que:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.4"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que le projet r√©ussisse, vous devez aller dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et y construire la biblioth√®que √† l'aide de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ensuite, retournez dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ex√©cutez, par exemple, la commande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par cons√©quent, si vous ignorez les avertissements du compilateur, le texte suivant s'affiche: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ces liaisons seront cr√©√©es: pyfoo. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
G√©n√©ration des liaisons pyfoo ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compilation du module 'foo' ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La roue a √©t√© construite.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des lignes en gras sont affich√©es qui sont sorties de notre fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ainsi, nous voyons que la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appel√©e plusieurs fois, et cela doit √™tre pris en compte si vous allez initialiser une variable membre de la classe d√©riv√©e de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'est pas le meilleur endroit pour cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est √©galement utile de se rappeler que la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appel√©e avant la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-√†-dire dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">il est</font></i><font style="vertical-align: inherit;"> d√©j√† possible d'utiliser des variables dont les valeurs sont d√©finies dans la m√©thode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, la m√©thode de </font><i><font style="vertical-align: inherit;">mise √† jour</font></i><font style="vertical-align: inherit;"> est appel√©e</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et √† la toute fin, la m√©thode directement responsable de l'assemblage, dans notre cas, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclusion de la premi√®re partie</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons commenc√© √† √©tudier l'outil SIP con√ßu pour cr√©er des liaisons Python pour des biblioth√®ques √©crites en C ou C ++. Dans cette premi√®re partie de l'article, nous avons examin√© les bases de l'utilisation de SIP en utilisant l'exemple de cr√©ation d'une liaison Python pour une biblioth√®que tr√®s simple √©crite en C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©termin√© les fichiers que vous devez cr√©er pour travailler avec SIP. Le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient des informations sur le package (nom, num√©ro de version, licence et chemins d'acc√®s aux fichiers d'en-t√™te et d'objet). En utilisant le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">vous pouvez influencer le processus de construction du package Python, par exemple, commencer √† construire la biblioth√®que C ou laisser l'utilisateur sp√©cifier l'emplacement des fichiers d'en-t√™te et d'objet de la biblioth√®que. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©crit l'interface du module Python listant les fonctions et classes qui seront contenues dans le module. </font><font style="vertical-align: inherit;">Des directives et des annotations sont utilis√©es </font><font style="vertical-align: inherit;">pour d√©crire l'interface dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* .sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la deuxi√®me partie de l'article, nous allons cr√©er une liaison sur une biblioth√®que orient√©e objet √©crite en C ++, et sur son exemple, nous √©tudierons des techniques qui seront utiles pour d√©crire l'interface des classes C ++, et en m√™me temps nous traiterons de nouvelles directives et annotations pour nous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä suivre.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©f√©rences</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemples pour cet article</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page d'accueil SIP</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation pour SIP</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495468/index.html">Algorithme de reconnaissance des √©tiquettes de prix qui fonctionne m√™me sur les terminaux de collecte de donn√©es</a></li>
<li><a href="../fr495472/index.html">Le passage au v√©g√©tarisme n'emp√™chera pas les gens d'√™tre infect√©s par des maladies comme COVID-19</a></li>
<li><a href="../fr495474/index.html">DataGrip 2020.1: lancement des configurations, exportation vers Excel, r√©sultats dans l'√©diteur et plus</a></li>
<li><a href="../fr495476/index.html">Pourquoi le succ√®s d'Atari DeepMind AI est d√©cevant</a></li>
<li><a href="../fr495478/index.html">Testeur de donn√©es grandes et petites: tendances, th√©orie, mon histoire</a></li>
<li><a href="../fr495484/index.html">Comment les pipelines Unix sont impl√©ment√©s</a></li>
<li><a href="../fr495486/index.html">Nouvelles menaces pour les donn√©es confidentielles: r√©sultats de l'enqu√™te mondiale Acronis</a></li>
<li><a href="../fr495490/index.html">Section des tests et de l'assurance qualit√© lors de la conf√©rence DUMP 2020. √Ä quoi s'attendre cette ann√©e? Spoiler: une paire d'analg√©siques et de cerises</a></li>
<li><a href="../fr495492/index.html">Fonctionnalit√©s de sortie du jeu iOS Unreal Engine 4</a></li>
<li><a href="../fr495494/index.html">Cr√©ation d'un planificateur de kube suppl√©mentaire avec un ensemble personnalis√© de r√®gles de planification</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>