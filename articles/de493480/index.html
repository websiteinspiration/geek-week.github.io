<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥚 ⛹🏽 🍖 Architektur für Anfänger oder warum Sie keine Flagge in den Schwertkämpfer einfügen müssen 😣 👩‍❤️‍💋‍👨 ✊🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anmerkung:
 
 

1. Ein Beispiel für die Implementierung neuer Funktionen in der Klasse durch Hinzufügen eines "Flags".
2. Auswirkungen.
3. Alternative...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Architektur für Anfänger oder warum Sie keine Flagge in den Schwertkämpfer einfügen müssen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493480/"><img src="https://habrastorage.org/webt/9s/96/tv/9s96tvz6feehvgoiz_gmwdoktl8.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmerkung:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel für die Implementierung neuer Funktionen in der Klasse durch Hinzufügen eines "Flags".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auswirkungen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alternativer Ansatz und Vergleich der Ergebnisse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie vermeide ich die Situation: „Architektonischer Overkill“?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Moment, in dem die Zeit kommt, alles zu ändern.</font></font></li>
</ol></blockquote><br>
<a name="habracut"></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bevor Sie beginnen, ein paar Anmerkungen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist eine Geschichte über Softwarearchitektur - in dem Sinne, wie Onkel Bob sie verwendet. </font><font style="vertical-align: inherit;">Ja, dieses.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle Zeichen, ihre Namen und ihr Code im Artikel sind fiktiv, alle Übereinstimmungen mit der Realität sind zufällig.</font></font></li>
</ul></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, ich bin ein gewöhnlicher Programmierer-Programmierer in einem Projekt. </font><font style="vertical-align: inherit;">Das Projekt ist ein Spiel, in dem ein einzelner Held (auch bekannt als Held) entlang einer perfekt horizontalen Linie von links nach rechts verläuft. </font><font style="vertical-align: inherit;">Monster stören diese wunderbare Reise. </font><font style="vertical-align: inherit;">Auf Befehl des Benutzers schneidet der Held sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einem Schwert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Kohl und bläst nicht in den Schnurrbart. </font><font style="vertical-align: inherit;">Das Projekt hat bereits 100.000 Zeilen und "Sie benötigen mehr </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen mit</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktionen!" </font><font style="vertical-align: inherit;">Schauen wir uns unseren Helden an:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//   1</span><font></font>
    }<font></font>
    <span class="hljs-comment">//   </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, mein persönlicher Teamleiter Vasily kann auch in den Urlaub fahren. </font><font style="vertical-align: inherit;">Plötzlich. </font><font style="vertical-align: inherit;">Wer hätte das gedacht? </font><font style="vertical-align: inherit;">Weiter entwickelt sich die Situation auf normale Weise: Eine Eule fliegt ein und fordert erst gestern dringend auf, vor Spielbeginn eine Wahl treffen zu können: mit einem Schläger oder einem Schwert für den Helden zu spielen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es muss sehr schnell sein. </font><font style="vertical-align: inherit;">Und ja, natürlich war er selbst mehr als Jahre lang Programmierer, als ich laufen kann, also weiß er, dass die Aufgabe fünf Minuten dauert. </font><font style="vertical-align: inherit;">Aber sei es, schätze für 2 Stunden. </font><font style="vertical-align: inherit;">Sie müssen nur ein Kontrollkästchen und if-chik hinzufügen. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis: if-chik im Wert @! ^% $ # @ ^% &amp; @! 11 $ ist # $% @ ^% &amp;! @ !!! </font><font style="vertical-align: inherit;">in &amp;! ^% # $ ^%! 1 if-chic! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meine Gedanken: „Ha! </font><font style="vertical-align: inherit;">Zwei Stunden! </font><font style="vertical-align: inherit;">Erledigt! ":</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">WeaponTypes</span> </span>{
        <span class="hljs-keyword">case</span> sword:
        <span class="hljs-keyword">case</span> club:<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-keyword">var</span> weaponType: <span class="hljs-type">WeaponTypes?</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> weaponType = weaponType <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">assertionFailure</span>()
            <span class="hljs-keyword">return</span>	<font></font>
        }<font></font>
        <span class="hljs-comment">//  : switch  Swift  if- -    !</span>
        <span class="hljs-keyword">switch</span> (weaponType) {
            <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//     </span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-comment">//  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie in meiner Entscheidung herausgefunden haben, dann leider: Ich habe zwei Neuigkeiten für Sie:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als ob gut: Wir liefern beide. </font><font style="vertical-align: inherit;">Wir liefern - vom Wort liefern Wert oder vom Wort lustiger (durch Tränen) Code.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und der schlechte: ohne Vasily das Kapets-Projekt.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also was ist passiert? </font><font style="vertical-align: inherit;">Es scheint bisher nichts zu sein. </font><font style="vertical-align: inherit;">Aber mal sehen, was als nächstes passiert (während wir alles tun, um Vasily im Urlaub zu halten). </font><font style="vertical-align: inherit;">Und dann wird es Folgendes geben: Die QS-Abteilung wird auf das Gewicht unseres Helden achten. </font><font style="vertical-align: inherit;">Und nein, das liegt nicht daran, dass der Held eine Diät machen muss, sondern hier ist der Grund:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + swordWeight<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe vergessen, die Gewichtsberechnung zu korrigieren. </font><font style="vertical-align: inherit;">Na denkst du, Fehler, mit wem passiert das nicht ?! </font><font style="vertical-align: inherit;">Slap-Bloop, Fick-Tibidoch, fertig:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">//   guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + clubWeight<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber schnell behoben! </font><font style="vertical-align: inherit;">Der Held springt jetzt unter Berücksichtigung des Gewichts, aber. </font><font style="vertical-align: inherit;">Ergebnisorientierte Arbeit! </font><font style="vertical-align: inherit;">Dies ist nicht für Sie, um Navels, architektonische Astronauten zu betrachten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, wirklich, dann hat er ein bisschen mehr korrigiert. </font><font style="vertical-align: inherit;">In der Zauberliste musste ich Folgendes tun:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//   guard let weaponType </span>
    <span class="hljs-comment">// ,   let spellsWithoutWeapon: [Spells]</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword:
            <span class="hljs-comment">//  let swordSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + swordSpells
	<span class="hljs-keyword">case</span> .club:
            <span class="hljs-comment">//  let clubSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + clubSpells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann kam Petja und brach alles. </font><font style="vertical-align: inherit;">Nun, die Wahrheit ist, wir haben so einen Juni im Projekt. </font><font style="vertical-align: inherit;">Unaufmerksam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er musste nur das Konzept der „Waffenstufe“ zu den Formeln hinzufügen, um die Stärke des Schlags und das Gewicht des Helden zu berechnen. </font><font style="vertical-align: inherit;">Und Petja hat einen von vier Fällen verpasst. </font><font style="vertical-align: inherit;">Aber nichts! </font><font style="vertical-align: inherit;">Ich habe alles korrigiert:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//guard let weaponType</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//        weaponGrade</span>
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//        weaponGrade</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">// guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight / grade
	<span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + pow(clubWeight, <span class="hljs-number">1</span> / grade)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//     , ! </span>
    <span class="hljs-comment">// ,     .    ,    ,   .   !</span>
}</code></pre><br>
<img src="https://habrastorage.org/webt/aw/ev/fo/awevfo6jjlysv_8l9wq-dl9npkw.png" height="80" width="80" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unnötig zu sagen, wann (plötzlich!) Es notwendig war, eine Bogen- / Aktualisierungsformel hinzuzufügen, gab es wieder vergessene Fälle, Fehler und das war alles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was schief gelaufen ist? </font><font style="vertical-align: inherit;">Wo habe ich mich geirrt und was (außer den Freunden) hat Wassili gesagt, als er aus dem Urlaub zurückkam? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier kann man die Geschichte nicht weiter lesen, sondern zum Beispiel an das Ewige denken, an die Architektur. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und mit denen, die sich noch zum Lesen entschlossen haben, fahren wir fort. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns also die Klassiker an:</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorzeitige Optimierung ist die Wurzel allen Übels!</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und ... äh ... das ist es nicht. </font><font style="vertical-align: inherit;">Hier ist die Sache: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In OOP-Sprachen (wie zum Beispiel Swift) gibt es drei Hauptmöglichkeiten, um die Fähigkeiten einer Klasse zu erweitern:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der erste Weg ist "naiv". </font><font style="vertical-align: inherit;">Wir haben ihn gerade gesehen. </font><font style="vertical-align: inherit;">Kontrollkästchen hinzufügen. </font><font style="vertical-align: inherit;">Verantwortung hinzufügen. </font><font style="vertical-align: inherit;">Schwellungsklasse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der zweite Weg ist die Vererbung. </font><font style="vertical-align: inherit;">Jeder kennt einen leistungsstarken Mechanismus zur Wiederverwendung von Code. </font><font style="vertical-align: inherit;">Man könnte zum Beispiel:</font></font><br>
 <ul>
<li><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erbe den neuen Helden mit dem Bogen und den Helden von Dubina vom Helden (der ein Schwert hält, aber dies spiegelt sich jetzt nicht im Namen der Heldenklasse wider). </font><font style="vertical-align: inherit;">Und dann überschreiben Sie in den Erben die geänderten Methoden. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Weg ist sehr schlecht (vertrau mir einfach).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Machen Sie die Basisklasse (oder das Protokoll) zu einem Helden und entfernen Sie alle Merkmale, die mit einem bestimmten Waffentyp verbunden sind, als Erben </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: Held mit </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schwert: Held, </font><font style="vertical-align: inherit;">Held mit </font><font style="vertical-align: inherit;">Bogen: Held, Held mit </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dubina: Held. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist besser, aber die Namen dieser Klassen selbst sehen uns irgendwie unzufrieden, heftig und gleichzeitig traurig und ratlos an. </font><font style="vertical-align: inherit;">Wenn sie jemanden so nicht ansehen, werde ich versuchen, einen weiteren Artikel zu schreiben, in dem sie zusätzlich zu dem langweiligen männlichen Helden ...</font></font><img src="https://habrastorage.org/webt/7i/7w/l7/7i7wl7kxg1ol1mmtplsfv-h7i4w.png" height="80" width="80"></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der dritte Weg ist die Trennung der Verantwortung durch Abhängigkeitsinjektion. </font><font style="vertical-align: inherit;">Es kann sich um eine Abhängigkeit handeln, die durch ein Protokoll geschlossen wird, oder um eine Schließung (als ob sie durch eine Signatur geschlossen wäre). </font><font style="vertical-align: inherit;">Die Hauptsache ist, dass die Umsetzung neuer Verantwortlichkeiten die Hauptklasse verlassen sollte.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie kann das in unserem Fall aussehen? </font><font style="vertical-align: inherit;">Zum Beispiel so (Entscheidung von Vasily):</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-keyword">let</span> weapon: <span class="hljs-type">Weapon</span> <span class="hljs-comment">//   , ..    </span><font></font>
<font></font>
    <span class="hljs-keyword">init</span> (<span class="hljs-number">_</span> weapon: <span class="hljs-type">Weapon</span>) { <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">self</span>.weapon = weapon<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {<font></font>
        weapon.strike()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + weapon.weight<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> spellsWithoutWeapon + weapon.spells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was musst du so sein? </font><font style="vertical-align: inherit;">Ninjutsu - Protokoll:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {<span class="hljs-keyword">get</span>}
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {<span class="hljs-keyword">get</span>}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel für die Protokollimplementierung:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>: <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ebenso sind Schwertklassen geschrieben für: Club, Bow, Pike usw. </font><font style="vertical-align: inherit;">"Es ist leicht zu erkennen" (c), dass in der neuen Architektur der gesamte Code, der für jeden bestimmten Waffentyp gilt, in der entsprechenden Klasse zusammengefasst ist und nicht gemäß dem Helden zusammen mit anderen Waffentypen verbreitet wird. </font><font style="vertical-align: inherit;">Dies erleichtert das Lesen und Verstehen des Helden und einer bestimmten Waffe. </font><font style="vertical-align: inherit;">Aufgrund der Anforderungen des auferlegten Protokolls ist es außerdem viel einfacher, alle Methoden zu verfolgen, die beim Hinzufügen eines neuen Waffentyps oder beim Hinzufügen einer neuen Funktion zu einer Waffe implementiert werden müssen (z. B. kann eine Waffe eine Preisberechnungsmethode haben). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier können Sie sehen, dass die Abhängigkeitsinjektion die Erstellung von Hero-Klassenobjekten erschwert hat. </font><font style="vertical-align: inherit;">Was früher einfach gemacht wurde:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> lastHero = <span class="hljs-type">Hero</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt hat es sich in eine Reihe von Anweisungen verwandelt, die überall dort dupliziert werden, wo es notwendig ist, einen Helden zu erstellen. </font><font style="vertical-align: inherit;">Vasily kümmerte sich jedoch darum:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSwordsman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> { <span class="hljs-comment">// ,  static -  </span>
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Sword</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeClubman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> {
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Club</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist klar , </font><font style="vertical-align: inherit;">dass Vasily , </font><font style="vertical-align: inherit;">um zu schwitzen hatte den Haufen zu zerstreuen , </font><font style="vertical-align: inherit;">das wurde </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aufgetürmt</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von Petya entworfen (und mir). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn man sich die letzte Lösung ansieht, kann natürlich der folgende Gedanke auftauchen:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, es stellte sich heraus, Normen. </font><font style="vertical-align: inherit;">Es ist bequem zu lesen und zu erweitern, aber sind all diese Fabriken / Protokolle / Abhängigkeiten eine Menge Overhead? </font><font style="vertical-align: inherit;">Ein Code, der keine Funktionen enthält, sondern nur zum Organisieren des Codes vorhanden ist. </font><font style="vertical-align: inherit;">"Code zum Organisieren des Codes", mgm. </font><font style="vertical-align: inherit;">Ist es wirklich notwendig, diesen Garten immer und überall einzuzäunen?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine ehrliche Antwort auf die erste Frage wäre:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ja, dies ist ein Overhead für Funktionen, die Unternehmen so sehr lieben. </font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und zur Frage „wann?“ </font><font style="vertical-align: inherit;">Antwortbereich:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Philosophie des Schwertkämpfers oder "Wann mussten Sie regieren?"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Anfang war ein Schwertkämpfer. </font><font style="vertical-align: inherit;">Im Sinne des alten Codes war dies ganz normal. </font><font style="vertical-align: inherit;">Solange es einen Helden und eine Waffe gab, musste man nicht zwischen ihnen unterscheiden - trotzdem gab es nichts anderes für den Helden. </font><font style="vertical-align: inherit;">Und der monolithische Code bestätigte diese Tatsache mit seinem Text. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schwertkämpfer - es klingt nicht einmal so schlecht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wozu führten die ersten „naiven“ Änderungen? </font><font style="vertical-align: inherit;">Was führte die Hinzufügung des if-chik dazu? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Hinzufügen eines If-Chic führte zu ... einer Mutante! </font><font style="vertical-align: inherit;">Mutante, d.h. </font><font style="vertical-align: inherit;">veränderliches Objekt, das zwischen einem „Menschen“ und einem „menschlichen Dubin“ mutieren kann. </font><font style="vertical-align: inherit;">Wenn Sie gleichzeitig einen kleinen Fehler bei der Implementierung der Mutante machen, entsteht der Zustand von „Human-Medullin“. </font><font style="vertical-align: inherit;">Nicht so! </font><font style="vertical-align: inherit;">Es besteht überhaupt keine Notwendigkeit für "menschliches Dubin". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist notwendig:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mann + Schwertabhängigkeit (Notwendigkeit eines Schwertes);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mann + Sucht nach einem Verein (Notwendigkeit eines Vereins).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nicht jede Sucht ist böse! </font><font style="vertical-align: inherit;">Diese Alkoholsucht ist böse und das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokoll</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist gut. </font><font style="vertical-align: inherit;">Ja, sogar die Abhängigkeit vom Objekt ist besser als „menschlicher Dubin“! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wann ist die Mutation aufgetreten? </font><font style="vertical-align: inherit;">Die Umwandlung in eine Mutante erfolgte zum Zeitpunkt des Hinzufügens der Flagge: Der monolithische Code blieb monolithisch, aber als die Flagge geändert (mutiert) wurde, begann sich das Verhalten desselben Objekts signifikant zu ändern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vasily würde zwei Stadien der Mutation herausgreifen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinzufügen eines Flags und des allerersten "if" (oder "switch" oder eines anderen Verzweigungsmechanismus) zum Flag. </font><font style="vertical-align: inherit;">Die Situation ist bedrohlich, aber erträglich: Der Held wird mit radioaktivem Abfall übergossen, aber er überwindet ihn.</font></font></li>
<li>     «if»   ,     . .    —   . ,    -  - .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der betrachteten Situation ist es daher sinnvoll, die Architektur zu erstellen, um das Auftreten technischer Schulden zu verhindern, bevor die erste Stufe im schlimmsten Fall die zweite durchlaufen wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was genau hat Vasily getan, um eine Mutante zu behandeln? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus technischer Sicht - verwendetes Injection Dependency Closed Protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus philosophisch geteilter Verantwortung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Merkmale der Arbeit der Klasse, die untereinander ausgetauscht werden können (was bedeutet, dass sie alternativ zueinander sind), wurden abhängig vom Helden entfernt. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine neue, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alternative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktionalität - die Umsetzung der Arbeit des Schwertes, die Umsetzung der Arbeit des Clubs - unterschied sich nach ihrem Erscheinen voneinander und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterscheidet sich</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von den anderen nach wie vor</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kein alternativer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Heldencode. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So erschien bereits im "naiven" Code</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> etwas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Neues</font><i><font style="vertical-align: inherit;"> , das sich</font></i><font style="vertical-align: inherit;"> in seinem alternativen Verhalten von dem unbestrittenen Teil des Helden unterschied. </font><font style="vertical-align: inherit;">So erschien im „naiven“ Code eine implizite Beschreibung neuer</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Geschäftseinheiten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ein Schwert und ein Knüppel</font><font style="vertical-align: inherit;">, die nach Angaben des Helden verteilt waren</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um die Arbeit mit neuen</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Geschäftsentitäten zu vereinfachen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wurde es erforderlich, sie als separate</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Codeentitäten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit eigenen</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Namen zu unterscheiden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es gab also eine Aufteilung der Verantwortung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS TL; DR;</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sehen Sie die Flagge?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sei ein Mann, verdammt! </font><font style="vertical-align: inherit;">Lösche es!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suchtinjektion</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gewinn! 11</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493458/index.html">Befreie dein Android - Alaverdi</a></li>
<li><a href="../de493462/index.html">Ultraschallbad. Teil 2</a></li>
<li><a href="../de493468/index.html">Hab keine Angst tief zu atmen</a></li>
<li><a href="../de493470/index.html">Wissenschaftler finden neue Kleinplaneten außerhalb von Neptun</a></li>
<li><a href="../de493478/index.html">Hack The Box - Walkthrough Forest. AS-REP-Röst-, DCSync- und Pass-The-Hash-Angriffe</a></li>
<li><a href="../de493482/index.html">Lernen Sie die kybernetische Schildkröte kennen, den Vorgänger von Roomba</a></li>
<li><a href="../de493484/index.html">Ihr C # ist bereits "funktionsfähig", lassen Sie es einfach.</a></li>
<li><a href="../de493486/index.html">Die interessantesten Automobil-Startups 2019-2020</a></li>
<li><a href="../de493488/index.html">Einheit + Git = Freundschaft: Teil 1 Gentleman-Set</a></li>
<li><a href="../de493496/index.html">ReactJS. Warnung: Es kann keine Aktualisierung des Reaktionsstatus für eine nicht gemountete Komponente durchgeführt werden. Dies ist ein No-Op, aber es zeigt ein Memo an</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>