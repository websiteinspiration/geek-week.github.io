<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏼 🤘🏾 🧔🏽 L'histoire d'un interrupteur 📘 🌞 💆🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans notre agrégation LAN, il y avait six paires de commutateurs Arista DCS-7050CX3-32S et une paire de commutateurs Brocade VDX 6940-36Q. Ce n'est pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>L'histoire d'un interrupteur</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/498368/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/y6/hn/ng/y6hnnglhd7cga9rdsoloimhiism.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre agrégation LAN, il y avait six paires de commutateurs Arista DCS-7050CX3-32S et une paire de commutateurs Brocade VDX 6940-36Q. </font><font style="vertical-align: inherit;">Ce n'est pas que les commutateurs Brocade sur ce réseau ont exercé une grande pression sur nous, ils travaillent et remplissent leurs fonctions, mais nous préparions l'automatisation complète de certaines actions, et nous n'avions pas ces capacités sur ces commutateurs. </font><font style="vertical-align: inherit;">Je voulais également passer des interfaces 40GE à la possibilité d'utiliser 100GE pour faire une réserve pour les 2-3 prochaines années. </font><font style="vertical-align: inherit;">Nous avons donc décidé d'échanger Brocade contre Arista.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces commutateurs sont des commutateurs d'agrégation LAN pour chaque centre de données. </font><font style="vertical-align: inherit;">Les commutateurs de distribution (le deuxième niveau d'agrégation) leur sont directement connectés, qui sont déjà assemblés en eux-mêmes Commutateurs LAN haut de gamme dans des racks de serveurs.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/wr/_k/mn/wr_kmn_mxcbk5pzlszif5fwpmmy.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque serveur est inclus dans un ou deux commutateurs d'accès. Les commutateurs d'accès sont connectés à une paire de commutateurs de distribution (deux commutateurs de distribution et deux liaisons physiques du commutateur d'accès à différents commutateurs de distribution sont utilisés pour la redondance). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque serveur peut être utilisé par son client, donc un VLAN distinct est alloué au client. Le même VLAN est ensuite attribué à un autre serveur de ce client dans n'importe quel rack. Le centre de données se compose de plusieurs lignes de ce type (POD), chaque ligne de racks possède ses propres commutateurs de distribution. Ces commutateurs de distribution sont ensuite connectés aux commutateurs d'agrégation.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/2p/r5/oc2pr5parnr_c3-m4s1fswgxlcm.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les clients peuvent commander un serveur dans n'importe quelle ligne, il est impossible de prévoir à l'avance que le serveur sera alloué ou installé dans une ligne particulière dans un rack particulier.Par conséquent, il y a environ 2500 VLAN dans chaque centre de données sur des commutateurs d'agrégation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipement pour DCI (Data-Center Interconnect) se connecte aux commutateurs d'agrégation. Il peut être utilisé pour la connectivité L2 (une paire de commutateurs formant un tunnel VXLAN vers un autre centre de données) et pour la connectivité L3 (deux routeurs MPLS).</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/eh/2a/pg/eh2apgb0jx6excyolzu7hlqwwiy.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai déjà écrit, afin d'unifier les processus d'automatisation de la configuration des services sur les équipements d'un même centre de données, il a fallu remplacer les commutateurs d'agrégation centralisés. </font><font style="vertical-align: inherit;">Nous avons installé de nouveaux commutateurs à côté des commutateurs existants, les avons combinés en une paire MLAG et avons commencé à nous préparer pour le travail. </font><font style="vertical-align: inherit;">Ils ont été immédiatement connectés aux commutateurs d'agrégation existants, de sorte qu'ils avaient un domaine L2 commun sur tous les VLAN clients.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Détails du circuit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par spécificité, nous appellerons les anciens commutateurs d'agrégation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les nouveaux - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Imaginez que dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POD 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POD 4,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> il existe des serveurs d'un client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le VLAN du client est indiqué en bleu. Ce client utilise le service de connectivité L2 avec un autre centre de données, de sorte que son VLAN est servi sur une paire de commutateurs VXLAN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> place les serveurs dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POD 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POD 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous désignons le VLAN du client comme vert foncé. Ce client utilise également le service de connectivité avec un autre centre de données, mais L3, de sorte que son VLAN est servi sur une paire de routeurs L3VPN.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/pl/tx/8t/pltx8tm018xdgys6sbk08dng6_w.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons besoin des VLAN clients pour comprendre à quelles étapes du travail de remplacement ce qui se passe, où la coupure de communication se produit et quelle peut être sa durée. </font><font style="vertical-align: inherit;">Le protocole STP n'est pas utilisé dans ce schéma, car la largeur de l'arborescence dans ce cas est grande et la convergence du protocole croît de façon exponentielle à partir du nombre d'appareils et de liens entre eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les appareils connectés par des liaisons doubles forment une pile, une paire MLAG ou une usine VCS-Ethernet. </font><font style="vertical-align: inherit;">Ces technologies ne sont pas utilisées pour une paire de routeurs L3VPN, car il n'y a pas besoin de redondance L2, il suffit qu'ils aient une connectivité L2 entre eux via des commutateurs d'agrégation.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Options d'implémentation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En analysant les options pour d'autres événements, nous avons réalisé qu'il existe plusieurs façons de réaliser ces travaux. </font><font style="vertical-align: inherit;">D'une interruption globale sur l'ensemble du réseau local à de petites interruptions littérales de 1 à 2 secondes dans certaines parties du réseau.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réseau, debout! </font><font style="vertical-align: inherit;">Commutateurs, remplacez!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La façon la </font><font style="vertical-align: inherit;">plus simple - est, bien sûr, annoncent un lien de rupture dans tous les </font><font style="vertical-align: inherit;">POD mondiaux et tous les </font><font style="vertical-align: inherit;">services DCI et passer tous les liens du commutateur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les commutateurs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/oe/ru/gj/oerugjzsi4pdh1lqcnu5bxyzlra.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de la rupture, dont nous ne pouvons garantir le temps (oui, nous connaissons le nombre de liens, mais nous ne savons pas combien de fois quelque chose va mal - d'un cordon de raccordement cassé ou d'un connecteur endommagé à un port ou un dysfonctionnement de l'émetteur-récepteur), nous ne pouvons toujours pas pour prévoir à l'avance si la longueur des cordons de brassage, DAC, AOC, connectés aux anciens commutateurs A, est suffisante pour les atteindre, bien que se trouvant à côté d'eux, mais toujours légèrement séparés, les nouveaux commutateurs N, et si les mêmes émetteurs-récepteurs fonctionneront / DAC / AOC des commutateurs Brocade dans les commutateurs Arista.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et tout cela dans des conditions de forte pression des clients et du support technique ("Natasha, lève-toi! Natasha, tout ne fonctionne pas là-bas! Natasha, nous avons déjà écrit le support technique, honnêtement, honnêtement! Natasha, ils ont déjà tout lâché là-bas! Natasha, mais combien n'a pas ça va marcher? Natasha, et quand ça marche?! "). </font><font style="vertical-align: inherit;">Même malgré une interruption annoncée au préalable et une notification aux clients, un afflux d'appels à un tel moment est garanti.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attendez, 1-2-3-4!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et sinon pour déclarer une rupture globale, mais pour annoncer une série de petites ruptures de communication sur les services POD et DCI. </font><font style="vertical-align: inherit;">Lors de la première interruption, </font><font style="vertical-align: inherit;">ne </font><font style="vertical-align: inherit;">commutez </font><font style="vertical-align: inherit;">que les </font><font style="vertical-align: inherit;">commutateurs </font><b><font style="vertical-align: inherit;">POD 1 à </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans le second - après quelques jours - </font><b><font style="vertical-align: inherit;">POD 2</font></b><font style="vertical-align: inherit;"> , puis après quelques jours </font><b><font style="vertical-align: inherit;">POD 3</font></b><font style="vertical-align: inherit;"> , puis </font><b><font style="vertical-align: inherit;">POD 4 ... [N]</font></b><font style="vertical-align: inherit;"> , puis les commutateurs VXLAN, puis les routeurs L3VPN.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/1n/8o/dg1n8oei0wx04clgnk2a0emzu-o.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec une telle organisation de changement de travail, nous réduisons la complexité du travail ponctuel et augmentons notre temps pour résoudre les problèmes en cas de problème soudain. La connectivité du POD 1 après la commutation avec d'autres POD et DCI n'est pas perdue. Mais le travail lui-même est retardé pendant longtemps, pendant le temps de ce travail dans le centre de données, un ingénieur est tenu d'effectuer physiquement la commutation, et pendant le travail (et ce travail est généralement effectué la nuit, de 2 à 5 heures du matin), la présence d'un ingénieur réseau en ligne est assez élevée qualifications. Mais nous obtenons de courtes pauses dans la communication, en règle générale, le travail peut être effectué dans l'intervalle d'une demi-heure avec une pause pouvant aller jusqu'à 2 minutes (en pratique, souvent 20-30 secondes avec le comportement attendu de l'équipement). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'exemple ci-dessus, client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous devrez avertir du travail avec une interruption des communications au moins trois fois - la première fois pour effectuer un travail sur un POD, dans lequel l'un de ses serveurs est situé, la deuxième fois - sur le deuxième et la troisième fois - lors du changement d'équipement pour les services DCI.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Changement de canaux de communication agrégés</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi parlons-nous du comportement attendu de l'équipement et comment les canaux agrégés peuvent-ils commuter avec une minimisation des interruptions de communication? </font><font style="vertical-align: inherit;">Imaginez l'image suivante:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/s0/g5/4b/s0g54bkj-ujiumk0egmyp7ookv0.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'une part, le lien est les commutateurs de distribution POD - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ils forment une paire MLAG (pile, usine VCS, paire vPC), d'autre part deux liens - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - sont inclus dans l'ancienne paire MLAG commutateur agrégation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Du côté des commutateurs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constituaient une interface agrégée appelée </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port-canal A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , du côté des commutateurs d'agrégation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une interface agrégée appelée </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port D-canal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les interfaces agrégées utilisent LACP dans leur travail, c'est-à-dire que les commutateurs des deux côtés échangent régulièrement des paquets LACPDU sur les deux liaisons pour s'assurer que les liaisons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ouvriers;</font></font></li>
<li>       .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'échange de paquets dans un paquet, la valeur d' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID système</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est transmise </font><font style="vertical-align: inherit;">, ce qui indique le périphérique sur lequel ces liens sont inclus. Pour une paire MLAG (pile, usine, etc.), la valeur de system-id pour les périphériques formant l'interface agrégée est la même. Le commutateur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> envoie un </font><b><font style="vertical-align: inherit;">système ID-D de</font></b><font style="vertical-align: inherit;"> valeur de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liaison 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et le commutateur </font><b><font style="vertical-align: inherit;">D2</font></b><font style="vertical-align: inherit;"> envoie un </font><b><font style="vertical-align: inherit;">système ID-D de</font></b><font style="vertical-align: inherit;"> valeur de </font><b><font style="vertical-align: inherit;">liaison 2</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Les commutateurs </font><b><font style="vertical-align: inherit;">A1</font></b><font style="vertical-align: inherit;"> et </font><b><font style="vertical-align: inherit;">A2</font></b><font style="vertical-align: inherit;"> analysent les paquets LACPDU reçus sur la même interface Po D et vérifient que l'ID système en eux correspond. Si l'ID système reçu par un lien diffère soudainement </font><b><font style="vertical-align: inherit;">de la valeur de travail actuelle</font></b></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce lien est supprimé de l'interface agrégée jusqu'à ce que la situation soit corrigée. </font><font style="vertical-align: inherit;">Maintenant , </font><font style="vertical-align: inherit;">nous passons à côté </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la valeur actuelle du système-id LACP-partenaire - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et les </font><font style="vertical-align: inherit;">commutateurs du côté </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - la valeur du </font><font style="vertical-align: inherit;">système actuel de id LACP-partenaire - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous devez changer l'interface agrégée, nous pouvons procéder de deux manières différentes:</font></font></b></blockquote><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Méthode 1 - Simple</font></font></b>
                        <div class="spoiler_text"><b>     A</b>.      .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/4x/y3/1f/4xy31fons85dmc1xqmyoatx3cok.jpeg"></div></a><br>
       <b>N</b>,       LACP,   <b>Po D</b>   <b>N</b>      <b>system-id N</b>.<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/9o/-x/d2/9o-xd2p6oyk3x_yxroz_tlh6hbc.jpeg"></div></a><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Méthode 2 - Minimisez la pause</font></font></b>
                        <div class="spoiler_text"><b>   2  Link 2</b>.     <b></b>  <b>D</b>       ,      .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/hw/u-/zy/hwu-zy2rypxofaqv9llskenulbm.jpeg"></div></a><br>
<b> Link 2   N2</b>.   <b>N</b>     <b>Po DN</b>,   <b>N2</b>    LACPDU <b>system-id N</b>.       ,   <b>N2</b>    ,   <b>Link 2</b>,       <b>Up</b>,     LACPDU      .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/cw/cy/st/cwcysth25wi_quoldhjghlysgx8.jpeg"></div></a><br>
  ,   <b>D2</b>    <b>Po A</b>   <b>Link 2   system-id N,      system-id A</b>,    <b>D</b>  <b>Link 2</b>     <b>Po A</b>.  <b>N</b>    <b>Link 2</b>  ,          LACP-  <b>D2</b>.     <b>Link 2</b>  .<br>
<br>
<b>    Link 1   A1</b>,     <b></b>  <b>D</b>   .  ,    <b>D</b>     system-id   <b>Po A</b>.<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/me/uw/8u/meuw8uq0g5lglbxkt6qwbdiodtg.jpeg"></div></a><br>
   <b>D</b>  <b>N</b>    system-id <b>A-N</b>   <b>Po A</b>  <b>Po DN</b>,        <b>Link 2</b>.     ,  ,  2 .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/rj/zs/ai/rjzsai50lw8dbbxbk0ntlicofoa.jpeg"></div></a><br>
<b>     Link 1   N1</b>,       <b>Po A</b>  <b>Po DN</b>.           system-id    ,    .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/8_/3c/vd8_3cszxwsxtwdcrewohql3arg.jpeg"></div></a><br>
</div>
                    </div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liens supplémentaires</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais la commutation peut se faire sans la présence d'un ingénieur au moment de la commutation. </font><font style="vertical-align: inherit;">Pour ce faire, nous avons besoin d' effectuer une </font><font style="vertical-align: inherit;">pré-lay liens supplémentaires entre les </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commutateurs de distribution </font><font style="vertical-align: inherit;">et les nouveaux </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commutateurs d'agrégation </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/du/sb/3h/dusb3hcwgnj_rt8kgkusiitltdk.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous établissons de nouveaux liens entre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commutateurs d' </font><font style="vertical-align: inherit;">agrégation </font><font style="vertical-align: inherit;">et tous les commutateurs de distribution POD. Cela nécessite l' </font><font style="vertical-align: inherit;">ordre et la </font><font style="vertical-align: inherit;">pose des câbles de raccordement supplémentaires et installer des </font><font style="vertical-align: inherit;">émetteurs - </font><font style="vertical-align: inherit;">récepteurs supplémentaires dans les </font><font style="vertical-align: inherit;">deux </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous pouvons le faire parce que nous </font><font style="vertical-align: inherit;">avons des ports libres </font><font style="vertical-align: inherit;">dans les commutateurs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">chaque POD (ou nous les libérons d'abord). </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En conséquence, chaque POD est physiquement connecté par deux liaisons aux anciens commutateurs A et aux nouveaux commutateurs N.</font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/32/wj/m-/32wjm-s5ehe6o1vlkvtrhcpn_mq.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deux interfaces agrégées sont formées </font><font style="vertical-align: inherit;">
sur le commutateur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Po A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec les liaisons </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Po N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec les liaisons </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link N1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link N2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . À ce stade, nous vérifions la connexion correcte des interfaces et des liaisons, les niveaux de signaux optiques aux deux extrémités des liaisons (via les informations DDM des commutateurs), nous pouvons même vérifier la capacité de travail de la liaison sous charge ou surveiller l'état des signaux optiques et les températures de l'émetteur-récepteur pendant quelques jours. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le trafic est toujours transmis via l' </font><font style="vertical-align: inherit;">interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Po A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tandis que l'interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Po N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">exempte de trafic. Les paramètres sur les interfaces sont approximativement les suivants:</font></font><br>
<br>
<pre><code class="plaintext hljs">Interface Port-channel A<font></font>
Switchport mode trunk<font></font>
Switchport allowed vlan C1, C2<font></font>
<font></font>
Interface Port-channel N<font></font>
Switchport mode trunk<font></font>
Switchport allowed vlan none</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les commutateurs D, en règle générale, prennent en charge le changement de configuration de session; ces modèles de commutateur qui ont cette fonctionnalité sont utilisés. Nous pouvons donc modifier les paramètres des interfaces Po A et Po N en une seule fois:</font></font><br>
<br>
<pre><code class="plaintext hljs">Configure session<font></font>
Interface Port-channel A<font></font>
Switchport allowed vlan none<font></font>
Interface Port-channel N<font></font>
Switchport allowed vlan C1, C2<font></font>
Commit</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le changement de configuration se produira assez rapidement, et la pause ne sera, en pratique, pas plus de 5 secondes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette méthode nous permet d'effectuer à l'avance tous les travaux préparatoires, d'effectuer toutes les vérifications nécessaires, de coordonner le travail avec les participants au processus, de prévoir en détail les actions pour la production de travaux, sans travail créatif, lorsque «tout s'est mal passé», et d'avoir en main un plan de retour à la configuration précédente. </font><font style="vertical-align: inherit;">Le travail sur ce plan est effectué par un ingénieur réseau sans la présence d'un centre de données sur site de l'ingénieur qui effectue physiquement la commutation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui est plus important avec cette méthode de commutation - tous les nouveaux liens sont déjà préréglés pour la surveillance. </font><font style="vertical-align: inherit;">Erreurs, inclusion de liens dans l'unité, chargement des liens - toutes les informations nécessaires sont déjà dans le système de surveillance, et elles sont déjà dessinées sur les cartes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jour J</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cosse</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons choisi le moins douloureux pour les clients et le moins enclin au commutateur "quelque chose s'est mal passé" avec des liens supplémentaires. </font><font style="vertical-align: inherit;">Donc, pendant quelques nuits, nous avons commuté tous les POD vers les nouveaux commutateurs d'agrégation.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/lm/c0/oa/lmc0oafevg5twt9amzd2thudqgm.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il reste à changer d'équipement fournissant des services DCI.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L2</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas d'équipements fournissant une connectivité L2, nous n'avons pas pu effectuer de travaux similaires avec des liaisons supplémentaires. </font><font style="vertical-align: inherit;">Il y a au moins deux raisons à cela:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manque de ports libres de la vitesse requise sur les commutateurs VXLAN.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manque de fonctionnalités pour les modifications de configuration de session sur les commutateurs VXLAN.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous n'avons pas changé les liens «un à la fois» avec une interruption uniquement pendant la durée de l'approbation d'une nouvelle paire d'ID système, car nous n'avions pas 100% de confiance que la procédure serait correcte, et un test en laboratoire a montré que, dans le cas si «quelque chose ne va pas», nous obtenons toujours une coupure de connexion, et le pire n'est pas seulement pour les clients qui ont une connectivité L2 avec d'autres centres de données, mais pour tous les clients de ce centre de données en général.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons effectué un travail de propagande sur la commutation des canaux L2 à l'avance, de sorte que le nombre de clients concernés par les travaux sur les commutateurs VXLAN était déjà plusieurs fois inférieur à il y a un an. </font><font style="vertical-align: inherit;">En conséquence, nous avons décidé d'interrompre la communication sur le service de connectivité L2, à condition de maintenir le fonctionnement normal des services de réseau local dans un centre de données. </font><font style="vertical-align: inherit;">De plus, le SLA de ce service prévoit la possibilité de travaux planifiés avec interruption.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi avons-nous recommandé à tout le monde de passer à l'utilisation de L3VPN lors de l'organisation des services DCI? L'une des raisons est la possibilité de travailler sur l'un des routeurs qui fournissent ce service, simplement avec une réduction du niveau de redondance à N + 0, sans interruption de communication. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinez de plus près le système de prestation de services. Dans ce service, le segment L2 passe des serveurs clients uniquement aux routeurs Selectel L3VPN. Sur les routeurs, le réseau client est terminé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque serveur client, par exemple, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le diagramme ci-dessus, a ses propres adresses IP privées - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0.0.2/24 pour le serveur S2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0.0.3/24 pour le serveur S3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Adresses </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0.0.252/24</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0.0.253/24</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attribué par Selectel aux routeurs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , respectivement. </font><font style="vertical-align: inherit;">L'adresse IP </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0.0.254/24 est une adresse VIP VRRP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur les routeurs Selectel.</font></font><br>
<br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">savoir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus sur le service L3VPN </font><font style="vertical-align: inherit;">sur notre blog.</font></font></b></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'au moment de la commutation, tout ressemblait approximativement au schéma:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/lu/z9/_l/luz9_l1950pk5r3vr5hrn-tdnss.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deux routeurs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ont été connectés à l'ancienne agrégation du commutateur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le maître pour les adresses VIP VRRP 10.0.0.254 est le routeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il a une priorité définie sur cette adresse supérieure à celle du routeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="plaintext hljs">unit 1006 {<font></font>
    description C2;<font></font>
    vlan-id 1006;<font></font>
    family inet {       <font></font>
        address 10.0.0.252/24 {<font></font>
            vrrp-group 1 {<font></font>
                priority 200;<font></font>
                virtual-address 10.100.0.254;<font></font>
                preempt {<font></font>
                    hold-time 120;<font></font>
                }<font></font>
                accept-data;<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur S2 utilise la passerelle 10.0.0.254 pour communiquer avec les serveurs d'autres emplacements. </font><font style="vertical-align: inherit;">Ainsi, la déconnexion du routeur L3VPN-2 du réseau (bien sûr, si vous le déconnectez d'abord du domaine MPLS) n'affecte pas la connectivité des serveurs clients. </font><font style="vertical-align: inherit;">À ce stade, le niveau de redondance du circuit diminue simplement.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/gj/oi/sk/gjoiskqum4kmknfm8u36cf5v44w.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, nous pouvons reconnecter en toute sécurité le routeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à la paire de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commutateurs </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Disposez les liens, changez les émetteurs-récepteurs. </font><font style="vertical-align: inherit;">Les interfaces logiques du routeur, dont dépend le travail des services clients, jusqu'à la confirmation que tout fonctionne comme il se doit, sont désactivées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir vérifié les liens, les émetteurs-récepteurs, les niveaux de signal, les niveaux d'erreur sur les interfaces, le routeur se met en service, mais est déjà connecté à une nouvelle paire de commutateurs.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/jb/dh/cs/jbdhcsuakuma1fofufzc-pp0poy.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous diminuons la priorité VRRP du routeur L3VPN-1, et l'adresse VIP 10.0.0.254 se déplace vers le routeur L3VPN-2. </font><font style="vertical-align: inherit;">Ces travaux sont également effectués sans interruption de communication.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/ix/uq/lq/ixuqlq5wx5veluojqgpwfy8yewu.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transfert adresse VIP au routeur 10.0.0.254 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permet de désactiver le routeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3VPN-1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sans interruption de contact pour le client et le </font><font style="vertical-align: inherit;">connecter à une nouvelle paire de commutateurs d' </font><font style="vertical-align: inherit;">agrégation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/lx/vo/jv/lxvojv_hiozuurqfsyonclwjez4.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que ce soit pour renvoyer VRRP VIP au routeur L3VPN-1 est une autre question, et si vous revenez, cela se fait sans interruption.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après toutes ces étapes, nous avons vraiment remplacé les commutateurs d'agrégation dans l'un de nos centres de données, tout en minimisant les interruptions pour nos clients.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/d1/jx/fwd1jxarjvfl1agcko-4fhezx7s.jpeg"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne reste plus qu'à démanteler. </font><font style="vertical-align: inherit;">Démontage d'anciens commutateurs, démantèlement d'anciennes liaisons entre les commutateurs A et D, démontage des émetteurs-récepteurs de ces liaisons, correction de la surveillance, fixation des schémas de réseau dans la documentation et la surveillance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons utiliser des commutateurs, des émetteurs-récepteurs, des cordons de raccordement, AOC, DAC après la commutation, dans d'autres projets ou toute autre commutation similaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Natasha, nous avons tout changé!"</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr498354/index.html">Comment traduire «liste de souhaits» en «matériel» ou semi-semi-mobile semi-idéal</a></li>
<li><a href="../fr498358/index.html">Apprenez le français ou comment obtenir un adaptateur universel à partir d'un scanner de diagnostic PSA</a></li>
<li><a href="../fr498360/index.html">Évaluation des métriques de charge du serveur intégré</a></li>
<li><a href="../fr498362/index.html">Kingston conserve son leadership dans les livraisons de SSD: comment faire?</a></li>
<li><a href="../fr498366/index.html">Quels algorithmes les développeurs Yandex implémentent-ils chaque jour</a></li>
<li><a href="../fr498370/index.html">SAP UI5 et Windows de confirmation: encore une fois sur le contexte</a></li>
<li><a href="../fr498372/index.html">Tutoriel de simulateur de réseau ns-3. Chapitre 5</a></li>
<li><a href="../fr498374/index.html">GPU Computing - Pourquoi, quand et comment. Plus quelques tests</a></li>
<li><a href="../fr498378/index.html">Annonce de l'école du soir de Slurm par Agile</a></li>
<li><a href="../fr498380/index.html">La fenêtre d'Overton en action: comment une pandémie est utilisée pour limiter notre liberté</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>