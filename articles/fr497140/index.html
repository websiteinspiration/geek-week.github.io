<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå™Ô∏è üë¶üèæ üß£ D√©cryptage des donn√©es dans le bus CAN VW Polo berline üë®üèª‚Äçüîß üé´ ü•™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous parlerons des m√©thodes de d√©cryptage des donn√©es du bus CAN en utilisant l'exemple d'une voiture VW Polo Sedan 2019. Sur Internet, c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>D√©cryptage des donn√©es dans le bus CAN VW Polo berline</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497140/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aujourd'hui, nous parlerons des m√©thodes de d√©cryptage des donn√©es du bus CAN en utilisant l'exemple d'une voiture VW Polo Sedan 2019. </font><font style="vertical-align: inherit;">Sur Internet, ces articles sont souvent appel√©s CAN Bus Hacks, mais je n'aime pas ce nom. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'article d√©crit les m√©thodes de recherche des donn√©es n√©cessaires dans le bus CAN de la voiture, des exemples d'application de ces techniques sur la VW Polo Sedan. </font><font style="vertical-align: inherit;">Le Vega MTX est utilis√© comme √©quipement pour la connexion √† un bus CAN. </font><font style="vertical-align: inherit;">Parlons un peu plus de t√©l√©matique. </font><font style="vertical-align: inherit;">Sous la coupe beaucoup de photos sur le sujet, plusieurs gifs et vid√©os.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelques mots sur vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m'appelle Alexey Fokin, en ce moment je travaille pour Vega Absolute</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vega_absolute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Le bureau central de Novossibirsk, mais je travaille √† Moscou. Une de nos directions est la t√©l√©matique. Nous fabriquons des √©quipements pour suivre les v√©hicules commerciaux, le covoiturage, les taxis, etc. Mon travail consiste √† collecter des donn√©es sur les voitures et √† les transformer en param√®tres pour notre √©quipement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant √† la voiture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion au bus CAN s'est faite √† deux endroits: derri√®re le tableau de bord (bus √† 500 Kbit / s) et derri√®re la radio (100 Kbit / s). Il existe √©galement une connexion redondante - la connexion au connecteur OBDII directement sur le connecteur (500 Kbit / s). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les outils utilis√©s: Unit√© de surveillance de v√©hicule Vega MTX √©quip√©e d'un scanner CAN. Pour le configurer sur un PC, le programme Configurator 1.27.14.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous trouverez plus d'informations sur la connexion √† une voiture et au MTX dans la vid√©o √† la fin de l'article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois connect√© √† tous les bus CAN, nous verrons l'image suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z4/j3/ad/z4j3ad0zxuso-cm1kzaa1omjpp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce flux de donn√©es, vous devez trouver les bits et octets qui sont responsables des param√®tres dont nous avons besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La capture d'√©cran ci-dessous montre combien de capteurs sont actuellement enregistr√©s dans le bloc t√©l√©matique, et ce n'est pas une liste compl√®te. Vous pouvez aller encore plus loin et rechercher encore plus de capteurs. Certains de ces capteurs envoient en temps r√©el des relev√©s au serveur, ce qui vous permet de voir √† tout moment l'√©tat de votre voiture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La t√©l√©matique est un sujet pour un article s√©par√©, nous ne nous attarderons donc pas l√†-dessus en d√©tail.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/qr/_p/kzqr_pzavnxnqpai7jt42tsvrwa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La question se pose imm√©diatement - pourquoi dois-je rechercher des donn√©es dans un flux si je peux les voir via ELM327 ou d'autres appareils de diagnostic? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La question ici est de savoir pourquoi nous avons besoin de ces donn√©es. Dans notre cas, nous avons besoin des donn√©es pour la t√©l√©matique, et afin de ne pas interf√©rer avec le fonctionnement du bus CAN et de ne pas lui envoyer de donn√©es, nous les recherchons dans le flux. Le Vega MTX dispose d'un mode sp√©cial pour travailler avec le bus CAN - le mode ¬´√©coute¬ª. Le mode parle de lui-m√™me, l'√©quipement n'√©coute que le bus et ne lui envoie rien, minimisant ainsi tout impact sur le syst√®me de voiture ordinaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, un capteur pour ouvrir une porte. Si nous lui demandons une demande, nous ne pouvons le faire qu'avec le contact. Une fois le contact coup√© et le bus CAN endormi, ce capteur ne sera plus disponible. Si nous trouvons ce capteur dans le flux CAN, nous le verrons tout le temps lorsque le bus CAN fonctionne. Et, lorsque vous ouvrez la porte, CAN se r√©veille automatiquement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il faut √©galement comprendre que tous les exemples ci-dessous ne concernent que la Polo Sedan connect. Dans d'autres, l'√©quipement ne peut avoir aucun des capteurs r√©pertori√©s, mais pour d'autres marques et mod√®les de voitures, les donn√©es seront sous des ID compl√®tement diff√©rents.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'attire votre attention sur le fait que par d√©faut dans le configurateur il y a un affichage des valeurs au format HEX. </font><font style="vertical-align: inherit;">√Ä l'avenir, nous devrons traduire les donn√©es du format HEX en valeurs d√©cimales plus d'une fois. </font><font style="vertical-align: inherit;">La fa√ßon la plus simple de le faire est d'utiliser l'application Calculatrice int√©gr√©e √† Windows 10. </font><font style="vertical-align: inherit;">Nous le traduisons en mode ¬´programmeur¬ª et nous avons le choix dans quel syst√®me num√©rique pour saisir les donn√©es, et ils sont dupliqu√©s dans d'autres syst√®mes num√©riques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par la m√©thode de recherche, je divise tous les capteurs de la voiture en plusieurs types:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs binaires. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs √† changement rapide. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs de temp√©rature. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kilom√©trage en voiture.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs de niveau. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs d'indication</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs avec demandes. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant aux m√©thodes avec lesquelles vous pouvez trouver chaque type de capteur. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Capteurs binaires</font></font></b></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par les capteurs binaires les plus simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces capteurs incluent les capteurs de porte, les ceintures de s√©curit√©, le frein (si les feux de freinage sont allum√©s), le frein √† main, les boutons sont enfonc√©s, etc. </font><font style="vertical-align: inherit;">Leur valeur est plac√©e sur 1 bit, c'est-√†-dire qu'elle peut √™tre 0 (la porte est ferm√©e) ou 1 (la porte est ouverte). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les trouver est simple, mais n√©cessite des soins. </font><font style="vertical-align: inherit;">Pour rechercher une porte conducteur, ouvrez / fermez la porte et regardez ce qui change dans le bus CAN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le configurateur met en √©vidence en rouge les donn√©es dans lesquelles des modifications ont √©t√© apport√©es au cours des derni√®res secondes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/8x/jp/zf8xjpvzhahuxhbdadj6tsmmtum.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, la porte conducteur est responsable du bit z√©ro du premier octet du message avec l'ID 470. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me octet se trouvent les capteurs de toutes les autres portes + capteur de coffre.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Capteurs √† changement rapide</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les capteurs √† changement rapide sont similaires aux capteurs binaires, seule leur valeur est sup√©rieure √† 1 bit. Nous pouvons agir sur ces capteurs et voir imm√©diatement les changements dans le bus CAN. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces capteurs incluent la plupart des capteurs de position: position de la p√©dale d'acc√©l√©rateur, position du verre, position de la transmission automatique, position de la cl√© de contact. En plus de ceux-ci, ce sont des capteurs de vitesse, de r√©volutions, des capteurs d'acc√©l√©ration du volant, d'acc√©l√©ration de la p√©dale d'acc√©l√©rateur, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, nous traiterons des capteurs de position en utilisant l'exemple du capteur de position de la p√©dale d'acc√©l√©rateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, on √©teint la voiture, on met le contact et, sans d√©marrer le moteur, on appuie sur la p√©dale d'acc√©l√©rateur et on surveille le changement dans le bus CAN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En r√®gle g√©n√©rale, lorsque la p√©dale d'acc√©l√©rateur est rel√¢ch√©e, la valeur de ce capteur est 0 et, lorsque vous appuyez sur la p√©dale d'acc√©l√©rateur, elle augmente jusqu'√† une certaine valeur. Nous voyons un tel param√®tre dans le premier CAN de l'ID 280. Le cinqui√®me octet passe de 0 (la p√©dale est rel√¢ch√©e) √† FA (la p√©dale est enfonc√©e ¬´au sol¬ª). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous traduisons FA de HEX en DEC, nous obtenons alors le nombre 250. Par cons√©quent, pour obtenir la p√©dale d'acc√©l√©rateur enfonc√©e en pourcentage (de 0 √† 100), nous devons multiplier notre valeur par 0,4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant aux capteurs qui ne correspondent pas √† un octet, par exemple, au r√©gime moteur. Nous augmentons et diminuons progressivement le r√©gime moteur, tout en observant les changements dans le bus CAN. Les r√©gimes du moteur ont le m√™me ID que la p√©dale d'acc√©l√©rateur.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir travaill√© avec la p√©dale d'acc√©l√©rateur, vous pouvez comprendre que les donn√©es ici sont dans l'ordre inverse. Autrement dit, la partie la plus ancienne se trouve dans le 3e octet (compter les octets √† partir de z√©ro) et la plus jeune dans le deuxi√®me octet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez transf√©rer les donn√©es de HEX vers DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/ev/zh/ohevzhgaspocuc3h3mp1o3z8ciw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons √©valuer les r√©volutions r√©elles par le tachym√®tre ou par des instruments de diagnostic. Dans mon cas, l'aiguille √©tait √† environ 1600 tr / min sur le tachym√®tre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous divisons les donn√©es de CAN au format d√©cimal (6508) par le r√©gime moteur du tachym√®tre (1600), nous obtenons 4,0675. √âtant donn√© l'erreur de d√©terminer les r√©volutions √† l'≈ìil, arrondissez le diviseur √† 4. Apr√®s cela, vous devez v√©rifier les lectures √† plusieurs points. Pour ce faire, r√©glez le r√©gime moteur √† diff√©rentes vitesses et v√©rifiez-les avec les donn√©es du bus CAN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le configurateur, vous pouvez remplacer tous les coefficients dans les param√®tres du capteur et observer les changements de vitesse en temps r√©el. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, un grand nombre de capteurs sont recherch√©s: forces de freinage, position du volant, acc√©l√©ration du volant, vitesse du v√©hicule, etc.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Capteurs de temp√©rature</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il √©tait tr√®s difficile de trouver la temp√©rature dans Polo Sedan. Pour commencer, un octet a √©t√© trouv√©, qui a lentement chang√© vers le haut lorsque la voiture a √©t√© chauff√©e. Apr√®s cela, la recherche des coefficients n√©cessaires a commenc√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connectons les diagnostics, s√©lectionnons la temp√©rature du moteur et comparons les lectures du bus CAN et les donn√©es des diagnostics. Nous construisons une table de correspondance et s√©lectionnons les coefficients. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la suite de la s√©lection des coefficients, une formule de calcul de la temp√©rature est apparue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
XX * 0,75 - 48 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o√π XX est la valeur de 1 octet de l'ID 288 dans le DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/vj/nf/hyvjnf90gsz8naskw2ep1q7ifsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la formule, on peut calculer que la capture d'√©cran avait une temp√©rature de </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
179 * 0,75 - 48 = 86,25 ¬∞ C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o√π 179 est le nombre d√©cimal B3 du premier octet de l'ID 288.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais c'est un cas difficile, dans de nombreuses voitures, la temp√©rature est beaucoup plus facile √† trouver. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme il est difficile de transmettre un nombre n√©gatif dans le bus, les fabricants acceptent la valeur -40 ¬∞ C, -48 ¬∞ C ou -58 ¬∞ C comme 0 mesure. Par cons√©quent, nous connectons les diagnostics et voyons quelle est la temp√©rature actuelle. Ajoutez 40 (48 ou 58) √† cela et traduisez-le en HEX. Nous recherchons le nombre r√©sultant dans le flux. Nous attendons que la temp√©rature de la machine change d'un degr√© et v√©rifions la valeur trouv√©e. Si sa valeur a √©galement augment√© de 1, c'est le capteur dont nous avons besoin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de ne pas confondre les valeurs du bus CAN avec les valeurs des requ√™tes de diagnostic. Si vous recherchez simultan√©ment des relev√©s sur le bus et que l'outil de diagnostic est connect√©, les r√©ponses aux demandes de diagnostic appara√Ætront √©galement dans le bus. Ils peuvent √™tre identifi√©s par ID. Habituellement, tout ce qui d√©passe 700 ID sont des demandes de diagnostic et des r√©ponses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, la temp√©rature du liquide de refroidissement peut toujours √™tre demand√©e, cette m√©thode sera d√©crite ci-dessous dans la section sur les capteurs avec des demandes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez utiliser une autre m√©thode pour rechercher la temp√©rature: physiquement, nous trouvons le capteur de temp√©rature du liquide de refroidissement (DTOZH) sur le moteur, l'√©teignons et connectons une r√©sistance variable au c√¢blage de la voiture. Ensuite, en faisant tourner la r√©sistance et en suivant le bus CAN selon la m√©thode de recherche de donn√©es changeant rapidement, vous pouvez trouver les relev√©s de temp√©rature du moteur.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En pratique, je n'ai pas utilis√© cette m√©thode, car ALT √©tait toujours soit dans le flux, soit ils demandaient √† la machine une demande. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Kilom√©trage en voiture</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des param√®tres les plus importants pour la t√©l√©matique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord √©valuer la taille que nous recherchons. </font><font style="vertical-align: inherit;">Si vous prenez 2 octets (16 bits) de donn√©es, le nombre maximal FF FF = 65 535 pourra y entrer. La voiture peut clairement parcourir plus de 65 000, ce qui signifie que le v√©hicule doit avoir un minimum de 24 bits. </font><font style="vertical-align: inherit;">Il y aura d√©j√† 16 millions de kilom√®tres., Ce qui est clairement suffisant pour une course. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais l√† encore, dans diff√©rentes voitures de diff√©rentes mani√®res. </font><font style="vertical-align: inherit;">Dans Polo Sedan, le kilom√©trage est √©crit en km, dans certains fran√ßais il est transmis avec une pr√©cision de 100 m√®tres. </font><font style="vertical-align: inherit;">alors le nombre peut occuper 32 bits et plus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus loin pour la recherche, vous devez prendre le kilom√©trage du tableau de bord de la voiture et le transf√©rer vers HEX.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_g/y1/s6/_gy1s64ytgtjtxrkpxqccunxe2w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, c'est 5732 km. Nous le traduisons en HEX et obtenons 16 64. Ensuite, recherchez, vous devez trouver la ligne o√π cette combinaison se produira. Vous devez rechercher par un octet, c'est-√†-dire d'abord rechercher 16, puis dans les options trouv√©es, regardez s'il y a aussi le nombre 64 √† c√¥t√© du nombre 16. Le nombre 64 peut √™tre √† gauche ou √† droite du nombre 16. √âtant donn√© que le kilom√©trage dans cette voiture n'est pas grand, puis tr√®s probablement, √† c√¥t√© du nombre 64, il sera √©galement 00. Dans le configurateur, il existe une recherche pratique (CTRL + F), si vous utilisez un autre outil, vous devrez rechercher manuellement ces donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, le kilom√©trage a √©t√© trouv√© en 520 ID </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/qs/0l/ktqs0lxxwbl7frstr8vjz9qvc54.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
00 16 64 = 5732 km. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour v√©rifier, il est conseill√© de parcourir encore quelques kilom√®tres et de v√©rifier la valeur du capteur trouv√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la m√™me mani√®re, le kilom√©trage est recherch√© avant de faire le plein. </font><font style="vertical-align: inherit;">Dans cette voiture, le tableau de bord ne transf√®re pas le kilom√©trage √† la station-service au pneu, il est donc fait sur demande.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Capteurs de niveau</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxi√®me capteur le plus important pour la t√©l√©matique est le capteur de niveau de carburant. Vous pouvez le trouver soit dans le flux, ce qui est pr√©f√©rable, soit sur demande (moins pr√©f√©rable, mais dans certaines voitures, cela ne fonctionnera pas diff√©remment). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord trouver les relev√©s de niveau de carburant dans l'outil de diagnostic. Mon niveau de carburant a √©t√© trouv√© dans le combin√© d'instruments (bloc 17). Dans le combin√© d'instruments, les relev√©s du capteur de niveau sont en litres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, la voiture a 21 litres de carburant. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/r-/rq/t6r-rq-pcbo-urm-pmfurhg7iwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous traduisons 21 de DEC en HEX et obtenons le nombre 15. En recherchant, nous essayons de le trouver. Le flux contient le num√©ro donn√© dans l'ID 320. Si le num√©ro n'est pas trouv√©, vous devez essayer de rechercher une ou plusieurs valeurs. Dans certaines voitures, le carburant est livr√© avec une pr√©cision d'un demi-litre, vous devez donc rechercher une valeur 2 fois plus grande.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l-/mn/tw/l-mntw35tvcsswdhb_kh8sicrb4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois le niveau de carburant trouv√©, il est n√©cessaire de verser quelques litres de carburant dans la voiture et de regarder le r√©sultat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement d√©monter le r√©servoir d'essence, retirer le FLS du r√©servoir et le d√©placer, en suivant les lectures du bus CAN. Ou retirez le connecteur du FLS et connectez-y une r√©sistance variable. En le faisant tourner et en suivant les changements, vous pouvez trouver le capteur de niveau de carburant. Si vous d√©cidez de d√©monter, le niveau de carburant doit √™tre recherch√© par la m√©thode de recherche de capteurs √† changement rapide. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, lors de la recherche, les donn√©es dont l'ID est sup√©rieur √† 700 ne doivent pas √™tre prises en compte. Il s'agit de requ√™tes de diagnostic. Apr√®s avoir d√©connect√© l'√©quipement de diagnostic, ces donn√©es dispara√Ætront. Nous traiterons les demandes plus en d√©tail ci-dessous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, la r√©ponse aux demandes de l'√©quipement de diagnostic pour le niveau de carburant du tableau de bord ressemble √† ceci.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, le niveau de carburant (en pourcentage) peut √™tre trouv√© dans les requ√™tes OBDII standard, mais sur le groupe VAG, elles ne montrent pas toujours les donn√©es correctes. </font><font style="vertical-align: inherit;">Sur les Skoda Rapid et Skoda Oktavia avec un r√©servoir plein, les diagnostics montrent un niveau de carburant de 85%.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/bc/hg/cpbchg8ntk3n1qjolnygoq5zr_c.png"><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Capteurs d'indication</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les capteurs d'indication sont tr√®s similaires aux capteurs binaires et doivent √™tre recherch√©s par la m√™me m√©thode. Ces capteurs incluent une vari√©t√© d'ic√¥nes sur le tableau de bord. Par exemple, l'√©tat de l'ic√¥ne Check Engine se trouve dans le premier octet de l'ID 480. Lorsque le contact est mis sur ce capteur 2C. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/sx/de/8rsxdelhyjgtedcykc0f4utt71s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le d√©marrage, lorsque l'ic√¥ne Check Engine (CE) s'√©teint, il y aura 00 dans ce capteur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/uq/su/8ruqsurccmkip9yhssm-8flrp00.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, la question reste, quel bit est responsable de l'ic√¥ne CE. Nous traduisons 2C en BIN et obtenons le num√©ro 0010 1100. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, copiez l'ID 480 entier, changez le premier octet en 2C (0010 1100) et essayez d'envoyer ce paquet √† la voiture. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, l'envoi de donn√©es √† la voiture n'est pas toujours s√ªr, vous pouvez casser quelque chose ou liquider le kilom√©trage. </font><font style="vertical-align: inherit;">Il vaut la peine de recourir √† cette m√©thode uniquement si le capteur n'a pas pu √™tre trouv√© en recherchant des capteurs binaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans mon cas, j'ai envoy√© vers une voiture liquid√©e (ce qui n'est pas recommand√©) et mon ic√¥ne CE et EPC clignote sur mon rangement. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/ci/gb/fjcigbvg8hop-hhliayqzsz81fy.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous envoyons au lieu de 2C (0010 1100) 08 (0000 1000). </font><font style="vertical-align: inherit;">Le CE bien rang√© clignote. </font><font style="vertical-align: inherit;">Par cons√©quent, 3 bits sont responsables de cette ic√¥ne. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kl/tl/up/kltlupgvkuuktk8bxujsft2shb8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous envoyez 04 (0000 0100), l'ic√¥ne EPC clignote.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Capteurs avec demandes</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les donn√©es ne peuvent pas √™tre trouv√©es dans le flux. Par exemple, dans un VW Transporter T4 diesel, il n'y a pas de temp√©rature du moteur dans le flux. Elle n'est pas en ordre. Par cons√©quent, vous devez interroger la voiture sur ces param√®tres. Il en va de m√™me pour le niveau de carburant sur le Rio \ Solaris. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple, essayons de demander le niveau de carburant de la Polo Sedan. Nous allons au bloc 17, comme nous l'avons fait dans le paragraphe sur la recherche du niveau de carburant, et demandons au tableau de bord. Apr√®s avoir analys√© les demandes, nous voyons que le diagnostic demande le niveau de carburant avec la commande suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p4/xo/qg/p4xoqgno99-xktykwtl5gagpo1y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et en r√©ponse, cela lui vient: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, copiez l'ID 714, d√©sactivez l'outil de diagnostic et essayez d'envoyer une demande √† la voiture. Si l'ID 77E re√ßoit la m√™me r√©ponse que lors de la connexion des diagnostics, alors nous avons re√ßu un paquet avec un niveau de carburant (4 octets. HEX 15 = DEC 21) 21 litres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vega MTX dispose d'outils int√©gr√©s pour travailler avec des capteurs avec des requ√™tes. Vous pouvez y configurer l'envoi de demandes apr√®s la mise du contact √† un certain intervalle ou sous certaines conditions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci se termine par la m√©thodologie de recherche de donn√©es dans le bus CAN. Si quelqu'un d'autre conna√Æt les m√©thodes pour trouver les donn√©es n√©cessaires sur le bus CAN ou partager son exp√©rience, je les √©couterai avec plaisir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant d'√©crire cet article, j'ai fait une vid√©o sur ce sujet. La vid√©o contient plus d'informations sur la connexion au bus CAN du v√©hicule, en collaboration avec le configurateur et le serveur de fichiers</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DkdOdCKI9HQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien vers le configurateur</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le serveur a des param√®tres pour certaines voitures, camions et machines agricoles. </font><font style="vertical-align: inherit;">Tous les fichiers sont crypt√©s, vous pouvez voir quels capteurs sont visibles dans le CAN du v√©hicule. </font><font style="vertical-align: inherit;">Une fois connect√©, les valeurs du capteur seront visibles, mais cela ne fonctionnera pas pour voir les adresses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä suivre.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497116/index.html">La fin des camions sans pilote de Starsky Robotics</a></li>
<li><a href="../fr497118/index.html">[Pr√©vision] Tous les camions sans pilote prendront-ils fin ou seulement Starsky Robotics?</a></li>
<li><a href="../fr497126/index.html">Techniques de notation et de hi√©rarchisation des arri√©r√©s</a></li>
<li><a href="../fr497132/index.html">Initiative #SaveFirst pour soutenir des projets socialement importants</a></li>
<li><a href="../fr497136/index.html">¬´Save Concord¬ª ou un rapport des tests du syst√®me radar russe pour rechercher des objets √©trangers sur la piste</a></li>
<li><a href="../fr497142/index.html">Comment nous avons ajout√© la prise en charge Harmony OS √† l'application inDriver Android</a></li>
<li><a href="../fr497144/index.html">Coin par coin: utilisation du virus PIV5 pour cr√©er un vaccin contre le MERS-CoV et √©ventuellement contre le SRAS-CoV-2</a></li>
<li><a href="../fr497146/index.html">Cryptographie appliqu√©e. Comment nous avons restaur√© des bitcoins pour 300 mille dollars</a></li>
<li><a href="../fr497148/index.html">Cr√©ation d'une application de bureau √† l'aide de Golang et Fyne</a></li>
<li><a href="../fr497152/index.html">O√π vit le c≈ìur du produit: mesures pour mesurer le bonheur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>