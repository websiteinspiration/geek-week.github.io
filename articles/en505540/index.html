<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëâüèº üò£ üòÅ React Native architecture redesigned in 2020 üë©üèº‚Äçüíª üß• üëâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The React Native (RN) framework appeared in 2015. It is designed to develop cross-platform mobile applications using the React library. These applicat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>React Native architecture redesigned in 2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/505540/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The React Native (RN) framework appeared in 2015. It is designed to develop cross-platform mobile applications using the React library. These applications support the native capabilities of the platforms for which they are created. The original React Native architecture had certain flaws. But despite this, RN received good community support, its popularity was gradually growing, not least - thanks to React's high profile reputation.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/ka/ai/2b/kaai2bun5gnxmt-soerdq3iyzj8.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The React Native architecture project was talked about in 2018. </font><font style="vertical-align: inherit;">This work is done by the Facebook team. </font><font style="vertical-align: inherit;">The purpose of redesigning is to make the framework more stable, and to solve the most common problems that have accumulated in RN over the years of development. </font><font style="vertical-align: inherit;">The material, the translation of which we are publishing today, is devoted to considering how the processing of the RN architecture can improve application performance and the speed of programmers.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Old architecture</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
React Native is an example of a solution that can be called platform independent. </font><font style="vertical-align: inherit;">As a result, it turns out that the main goal of the framework is to allow developers to write JavaScript code using React mechanisms. </font><font style="vertical-align: inherit;">The goal of React Native is to transform the tree of React components into something that will work on various mobile platforms. </font><font style="vertical-align: inherit;">This means the following:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correct interface formation.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Providing access to the native capabilities of various platforms.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typically, in Android / iOS ecosystems, the mechanism used to accomplish these tasks looks something like the following figure.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eb7/270/553/eb7270553b52c21de9acda19fe7b7891.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existing React Native Architecture ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In each React Native application, the following three threads execute in parallel:</font></font><br>
<br>
<ul>
<li> JS.  ‚Äî ,       JavaScript-.       .  Metro   JS-   ,    JSX-  TS-.      JavaScriptCore,       .</li>
<li> Native.     .     JavaScript- ,         .       . , Native UI,       . , Native Modules,      ,    .       .  , ,  React Native  Bluetooth-,    ,    ,  ,   ,  .</li>
<li> Shadow.      .    Yoga,    Facebook.     ,     .     ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To organize the interaction between JS and Native threads, the Bridge module is used. This module is written in C ++ and is based on an asynchronous queue. When a bridge receives data from one of the parties, it serializes this data, converting it to a string form, and passes it through the queue. When the data arrives at its destination, it is deserialized. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that all threads rely on asynchronous JSON messages sent across the bridge. Each party sends these messages, expecting (but not having a guarantee) that sometime in the future, these messages will be answered. With this data exchange scheme, there is a risk of communication channel overload.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is an example that is usually given to illustrate how such a data exchange scheme can cause problems with application performance. Suppose an application user scrolls a huge list. When the onScroll event occurs in the native environment, information is asynchronously passed to the JavaScript environment. But native mechanisms do not wait until the JavaScript part of the application does its job and reports to them about it. Because of this, there is a delay, expressed in the appearance in the list, before displaying its contents, empty space.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Similarly, before the results of the recalculation of the layout reach the screen, the system has to perform several data exchange sessions. </font><font style="vertical-align: inherit;">So, before the layout data gets into the native environment, they need to be processed in Yoga. </font><font style="vertical-align: inherit;">And this, of course, means that such data also has to be transmitted through the bridge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, sending JSON data using asynchronous mechanisms, as well as serializing and deserializing this data, cause performance problems. </font><font style="vertical-align: inherit;">This mechanism is imperfect. </font><font style="vertical-align: inherit;">But how else can you interact between native mechanisms and JavaScript? </font><font style="vertical-align: inherit;">You can answer this question using JSI technology.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New architecture</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the redesign of the React Native architecture, the bridge functions are phased out, replaced by a new mechanism called the JavaScript Interface (JSI). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using JSI opens up some great improvements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first such improvement is that the JS bundle no longer relies on JSC. In other words, the JSC engine can now be easily replaced with something else, quite possibly featuring a higher performance. For example - to the V8 engine.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second improvement is what underlies the new React Native architecture. It lies in the fact that, thanks to the use of JSI, in JavaScript you can store links to C ++ - objects (Host Objects) and call methods of these objects. As a result, it turns out that the JavaScript part of the application and the native mechanisms will know more about each other than before. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In other words, JSI allows for full interaction between all threads. By using the shared ownership concept, JavaScript code can run native methods directly from the JS stream. There is no need to use JSON to transfer data. This allows you to get rid of problems specific to the use of the bridge related to possible queue overflow and asynchronous data transfer.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/34e/2fa/1bd/34e2fa1bdca25d1f878ee5295033dab2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New React Native Architecture ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In addition to the fact that the above scheme significantly improves the interaction between different threads, the new architecture also allows direct control of native modules. </font><font style="vertical-align: inherit;">This means that native modules can be used then, then they are needed, and not to initialize them all when the application starts. </font><font style="vertical-align: inherit;">This leads to a serious increase in application startup speed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This new mechanism may open the way to the development of new projects capable of what was not available to old RN applications. </font><font style="vertical-align: inherit;">The fact is that now at our disposal was the power of C ++. </font><font style="vertical-align: inherit;">This means that on the basis of React Native, it will now be possible to create much more varieties of applications than before.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Over the years of development, a lot of things have accumulated in the React Native infrastructure that today can be considered obsolete and unused. The desire of RN developers to remove from it unnecessary and improve the ability to support it, leads to the removal of some of its capabilities. For example, we are talking about the fact that its kernel modules, such as Webview and AsyncStorage, are gradually being removed from the framework and made out as repositories developed by the React Native community. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to the new compact core and the impressive mechanisms of interaction between JavaScript code and native code, the redesign of the React Native architecture should lead to the fact that RN-applications will become more productive, and that they will be faster and more convenient to develop.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
React Native restructuring is expected to complete in Q4 2020. </font><font style="vertical-align: inherit;">I am delighted with the perspectives on application performance and usability that come with the redesign of the RN architecture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you use React Native, tell us about the shortcomings of this framework you have encountered.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/gu/ab/cg/guabcgmwuqoopx1ar80sjpz6keq.png"></a> <br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/de/0y/l-/de0yl-6ppopvisr_a80b4yuhjj8.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en505522/index.html">Monetization in online games: how to use someone else's experience for your own needs</a></li>
<li><a href="../en505528/index.html">The most important thing in Wi-Fi 6. No, seriously</a></li>
<li><a href="../en505530/index.html">Google makes its processor, and AMD is preparing to destroy Qualcomm</a></li>
<li><a href="../en505532/index.html">Telegram channels about game development: part 2</a></li>
<li><a href="../en505536/index.html">How to cook call tracking: Cyan experience</a></li>
<li><a href="../en505546/index.html">Flutter and desktop development</a></li>
<li><a href="../en505548/index.html">Without registration and SMS: ‚Äúsocially significant‚Äù sites and a list of the Ministry of Digital Affairs</a></li>
<li><a href="../en505554/index.html">At the Competition ‚ÄúYoung Technicians and Inventors‚Äù real young inventors are not needed</a></li>
<li><a href="../en505556/index.html">Apple tracks looted iPhones and gives police looters</a></li>
<li><a href="../en505558/index.html">Amazon DeepLens Deep Learning Camera. Unpacking, connecting and deploying a project</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>