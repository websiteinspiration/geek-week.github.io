<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“± ğŸ‘‚ğŸ¼ ğŸ‘©ğŸ¾ ÙƒÙŠØºÙˆÙ†Øº Ø§Ù„ØµÙ„Ø¨ Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ© Ø£Ùˆ Ù„Ù…Ø§Ø°Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ÙˆÙ„Ø¯ Ù‡Ù†Ø¯Ø³ÙŠ ğŸ˜ ğŸ§‘ ğŸ‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ù‡Ù„ ØªØ¨Ø¯Ùˆ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ù„Ø±Ù…ÙˆØ² Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±Ø§Ø¦Ø· ØºÙŠØ± ÙˆØ§Ù‚Ø¹ÙŠØ© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ÙƒØŸ Ø¹Ù„Ø§ÙˆØ© Ø¹Ù„Ù‰ Ø°Ù„Ùƒ ØŒ Ø³ØªØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ùˆ QGIS Ùˆ Python Ù„Ø¬Ø¹Ù„ Ù…ÙƒÙŠÙØ§ØªÙƒ Ù‡ÙŠ Ø§Ù„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ÙƒÙŠØºÙˆÙ†Øº Ø§Ù„ØµÙ„Ø¨ Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ© Ø£Ùˆ Ù„Ù…Ø§Ø°Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ÙˆÙ„Ø¯ Ù‡Ù†Ø¯Ø³ÙŠ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504986/"><p><img src="https://habrastorage.org/getpro/habr/post_images/070/b4a/b4d/070b4ab4d68fa8fa7238acdc2d7567a0.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ù‡Ù„ ØªØ¨Ø¯Ùˆ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ù„Ø±Ù…ÙˆØ² Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±Ø§Ø¦Ø· ØºÙŠØ± ÙˆØ§Ù‚Ø¹ÙŠØ© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ÙƒØŸ </font><font style="vertical-align: inherit;">Ø¹Ù„Ø§ÙˆØ© Ø¹Ù„Ù‰ Ø°Ù„Ùƒ ØŒ Ø³ØªØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ùˆ QGIS Ùˆ Python Ù„Ø¬Ø¹Ù„ Ù…ÙƒÙŠÙØ§ØªÙƒ Ù‡ÙŠ Ø§Ù„Ø£ÙØ¶Ù„.</font></font></p><a name="habracut"></a><br>
<h1 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</font></font></h1><br>
<p> !   ,    ,    ,   , ,    QGIS  Python  PyQt.  ,   ,      ()      .           QGIS    ,    <strong>geometry generator</strong> â€”  .                 .             ,      .</p><br>
<h1 id="a-zachem-ono-nado">  Â«Â» ?</h1><br>
<p>QGIS     MVC      .   ,  .. ,   Model-Based  PyQt  .         ,    .    ,      .</p><br>
<p>       QGIS:</p><br>
<p><img src="https://habrastorage.org/webt/nz/m5/rs/nzm5rswhv7f0bo5b4ehqzlbzupk.png" alt="Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¹ÙŠÙ†Ø© Ù„Ù„Ù†Ù‚Ø·Ø© ÙˆØ§Ù„Ø®Ø· ÙˆØ§Ù„Ù…Ø¶Ù„Ø¹"></p><br>
<p>      ?</p><br>
<p>     99%  . !     ,       (, ),       (, ),         ,     .</p><br>
<p>,       :</p><br>
<p><img src="https://habrastorage.org/webt/dg/ek/mw/dgekmwb9lbfg6yv8v9vfvzgkomu.png"></p><br>
<p>  Â«Â»       :</p><br>
<p><img src="https://habrastorage.org/webt/td/vp/_c/tdvp_cxxniah6msvxpaomoe1h7y.png" alt="&quot;Ø£Ø³Ù†Ø§Ù†&quot;"></p><br>
<p>     .       ,     ,  ,  (       ).         QGIS  Python.</p><br>
<h2 id="liricheskoe-zamechanie"> </h2><br>
<p> , , -,    ,  <strong>,    ,         (!)         ,   ,   </strong>!        ,      .</p><br>
<h2 id="dopuscheniya"></h2><br>
<ul>
<li>     QGIS  3.10.6  Ubuntu 18.04.</li>
<li>   Â«Â»   UTM  37N,               . </li>
<li>    GitHub   .</li>
<li> Â«Â»     ,     .</li>
<li> , ,          ,   .</li>
</ul><br>
<h2 id="tipy-geometrii-geometry-generator">  geometry generator</h2><br>
<p>   â€”    .<br>
    ,   : /, /, /. ,  ,     ,     ,     .   :  ,  ,         .</p><br>
<h2 id="kak-gotovit"> Â«Â»?</h2><br>
<p> ,        ,    <strong></strong>  (expression),    .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Expressions</a>,    Python    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Expressions, Filtering and Calculating Values</a>.</p><br>
<p> , ,   .   â€”   ,   .       Python,       .       QGIS.      , a        .</p><br>
<p>      :      .  -     ,     .</p><br>
<p>     ,    ,      QGIS, ,  ,  ,    .&nbsp;.     .</p><br>
<h2 id="tochki-v-">  ...</h2><br>
<p>   ,         .</p><br>
<p>,     ( ,    ),   ,         ,           ,  ,  ,   :</p><br>
<p><img src="https://habrastorage.org/webt/nt/yi/zg/ntyizgzyexsp8syw3ep_a99zq58.png" alt="ÙƒØ§Ø¦Ù† ÙˆØ§Ø­Ø¯ Ø¨Ø£Ù†Ù…Ø§Ø· Ù…Ø®ØªÙ„ÙØ©."></p><br>
<p>    : ,   ,   ; ,  ,         â€” ,  .      <strong>points</strong>.</p><br>
<p>      <code>geometry_n()</code>,        :</p><br>
<pre><code class="lua hljs">geometry_n($geometry, <span class="hljs-number">1</span>)</code></pre><br>
<p> <code>$geometry</code> â€”   ,       .</p><br>
<p>    ,      :</p><br>
<pre><code class="lua hljs"><span class="hljs-keyword">if</span>(<font></font>
    @geometry_part_num &gt; <span class="hljs-number">1</span>, <span class="hljs-comment">--     </span>
    geometry_n($geometry,  @geometry_part_num ), <span class="hljs-comment">--   </span><font></font>
    NULL<font></font>
)</code></pre><br>
<p>   , <code>if()</code>â€”  .   2  <code>@geometry_part_num</code>,    ,      (      <code>@</code>).      <code>NULL</code>            .    ,         ,  ,    .</p><br>
<p>    â€” ,       :</p><br>
<pre><code class="lua hljs"><span class="hljs-keyword">if</span>(<font></font>
    @geometry_part_num &gt; <span class="hljs-number">1</span>, <span class="hljs-comment">--       </span><font></font>
    with_variable(<font></font>
        <span class="hljs-string">'inputs'</span>,<font></font>
        array(<font></font>
            <span class="hljs-number">10000</span>, <span class="hljs-comment">--        </span>
            length( <span class="hljs-comment">--       </span><font></font>
                make_line(<font></font>
                    start_point($geometry),<font></font>
                    geometry_n($geometry, @geometry_part_num)<font></font>
                )<font></font>
            ),<font></font>
            azimuth( <span class="hljs-comment">--       </span><font></font>
                geometry_n($geometry, @geometry_part_num),<font></font>
                start_point($geometry)<font></font>
            )<font></font>
        ),<font></font>
        <span class="hljs-keyword">if</span>(<font></font>
            @inputs[<span class="hljs-number">0</span>] &lt; @inputs[<span class="hljs-number">1</span>], <span class="hljs-comment">--    </span><font></font>
            make_line(<font></font>
                geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span><font></font>
                project(<font></font>
                    geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span>
                    @inputs[<span class="hljs-number">1</span>] - @inputs[<span class="hljs-number">0</span>], <span class="hljs-comment">--  </span>
                    @inputs[<span class="hljs-number">2</span>] <span class="hljs-comment">-- </span><font></font>
                )<font></font>
            ),<font></font>
            NULL <span class="hljs-comment">--     ,   .</span><font></font>
        )<font></font>
    ),<font></font>
    NULL<font></font>
)</code></pre><br>
<p>   .   ,      ,    ,           <code>NULL</code>. </p><br>
<p>       â€”     .         ,        .         ,        .  ,             .</p><br>
<p>     <code>with_variable()</code>,      :  ,  , .     ,   -    ,     <code>with_variable</code>,    .     .</p><br>
<p>      â€”     <code>inputs</code>    <code>array()</code> â€”    0.    â€”    ,      .     â€”       ,        :</p><br>
<pre><code class="lua hljs">...<font></font>
length( <span class="hljs-comment">--       </span><font></font>
    make_line(<font></font>
        start_point($geometry),<font></font>
        geometry_n($geometry, @geometry_part_num)<font></font>
    )<font></font>
),<font></font>
azimuth( <span class="hljs-comment">--       </span><font></font>
    geometry_n($geometry, @geometry_part_num),<font></font>
    start_point($geometry)<font></font>
)<font></font>
...</code></pre><br>
<p>     <code>length()</code>,   ,   <code>make_line()</code>       â€” <code>start_point($geometry)</code>,   (    ).  <code>azimuth()</code>        ,    !</p><br>
<p>   ,   .    <code>if()</code>  ,          ,    .      <code>@inputs</code>    ,  ,  Â«Â»   <code>NULL</code>.</p><br>
<p>    :</p><br>
<pre><code class="lua hljs">...<font></font>
make_line(<font></font>
    geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--     </span><font></font>
    project(<font></font>
        geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span>
        @inputs[<span class="hljs-number">1</span>] - @inputs[<span class="hljs-number">0</span>], <span class="hljs-comment">--  </span>
        @inputs[<span class="hljs-number">2</span>] <span class="hljs-comment">-- </span><font></font>
    )<font></font>
)<font></font>
...</code></pre><br>
<p>    <code>project()</code>,   ,         .      ,     .</p><br>
<h2 id="dopolnyaem-horoshee"> </h2><br>
<p>          ,      Klas Karlsson,  QGIS.     ,    ,  ,       ,  :</p><br>
<p><img src="https://habrastorage.org/webt/dh/qm/fp/dhqmfp-7oy2buplka-yktz80wto.png" alt="Ø·Ø±ÙŠÙ‚"></p><br>
<p>    ,   . ,      WKT    ,     ,      Â«||Â»,      .     ,   ,     .    :</p><br>
<ul>
<li>     ,         ;</li>
<li>   ,       .</li>
</ul><br>
<p> ( <strong>lines1</strong>).   ,      :</p><br>
<ul>
<li>     (           ).</li>
<li> .</li>
</ul><br>
<p>   :</p><br>
<pre><code class="lua hljs">collect_geometries(<font></font>
    array_foreach(<font></font>
        generate_series(<span class="hljs-number">1</span>, num_points($geometry)),<font></font>
        point_n($geometry, @element)<font></font>
    )<font></font>
)</code></pre><br>
<p> Â«Â» .        .      <code>generate_series()</code>,   ()   1  <code>num_points($geometry)</code>, .&nbsp;.      .         <code>array_foreach()</code>.  <code>array_foreach</code>  ,     <code>point_n($geometry, @element)</code>, .&nbsp;.     (<code>point_n()</code> â€”      ), <code>@element</code> â€”        .     ,        .         â€” ,   <code>collect_geometries()</code>.       (  ).</p><br>
<p>  .         Â«/Â».    :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'minimal_length'</span>,  <span class="hljs-comment">--  ,     </span>
    <span class="hljs-number">7000.0</span>,<font></font>
    collect_geometries(  <span class="hljs-comment">--  </span><font></font>
        array_foreach(<font></font>
            generate_series(<span class="hljs-number">1</span>, num_points($geometry) - <span class="hljs-number">1</span>),  <span class="hljs-comment">--   </span><font></font>
            with_variable(<font></font>
                <span class="hljs-string">'inputs'</span>,<font></font>
                array(<font></font>
                    azimuth( <span class="hljs-comment">--      </span><font></font>
                        point_n($geometry, @element),<font></font>
                        point_n($geometry, @element + <span class="hljs-number">1</span>)<font></font>
                    ),<font></font>
                    length( <span class="hljs-comment">--      </span><font></font>
                        make_line(<font></font>
                            point_n($geometry, @element),<font></font>
                            point_n($geometry, @element + <span class="hljs-number">1</span>)<font></font>
                        )<font></font>
                    )<font></font>
                ),<font></font>
                <span class="hljs-keyword">if</span>(<font></font>
                    @inputs[<span class="hljs-number">1</span>] - @minimal_length * <span class="hljs-number">2</span> &gt; <span class="hljs-number">0</span>,  <span class="hljs-comment">-- .  </span>
                    line_substring( <span class="hljs-comment">--     </span><font></font>
                        make_line(<font></font>
                            point_n($geometry, @element),<font></font>
                            point_n($geometry, @element+<span class="hljs-number">1</span>)<font></font>
                        ),<font></font>
                        @minimal_length, @inputs[<span class="hljs-number">1</span>] - @minimal_length<font></font>
                    ),<font></font>
                    geom_from_wkt(<span class="hljs-string">'LINESTRING EMPTY'</span>) <span class="hljs-comment">--  </span><font></font>
                )<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>      ,    .                <code>@minimal_length</code>.       <code>collect_geometries</code>  ,     <code>array_foreach</code>     ,  .   ,    ,       <code>@inputs</code>:          .</p><br>
<p>   .     ,       <code>@minimal_length</code> (   ).     ,    ,     <strong>  </strong>:</p><br>
<pre><code class="lua hljs">geom_from_wkt(<span class="hljs-string">'LINESTRING EMPTY'</span>)</code></pre><br>
<p>,       ,       <code>NULL</code>,     .      ,     .       WKT  Â«LINESTRING EMPTYÂ»,    WKT    QGIS    <code>geom_from_wkt()</code>.</p><br>
<p>   .          <code>line_subtring()</code>,       .         ,                    .</p><br>
<h2 id="linii-v-poligony">  </h2><br>
<p>        ?       ,    ,  .     (.  <strong>lines2</strong>).</p><br>
<p>  ,     <code>buffer()</code>,     :    ,               1. ..    :</p><br>
<p><img src="https://habrastorage.org/webt/qx/md/_u/qxmd_uapra_v94as_8zwxp_lz6s.png"></p><br>
<p>       ,    .</p><br>
<p><img src="https://habrastorage.org/webt/iv/2c/ef/iv2cef47_pfu5aymfmjt192i8iy.png"></p><br>
<p> ,    ,   ,     .    ,     .           ,       .  :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'distance'</span>,
    <span class="hljs-number">4000</span>, <span class="hljs-comment">--  </span><font></font>
    with_variable(<font></font>
        <span class="hljs-string">'offset_lines'</span>, <span class="hljs-comment">--     </span><font></font>
        array(<font></font>
            extend(<font></font>
                offset_curve($geometry, @distance, join:=<span class="hljs-number">2</span>),<font></font>
                @distance, @distance<font></font>
            ),<font></font>
            extend(<font></font>
                offset_curve($geometry, -@distance, join:=<span class="hljs-number">2</span>),<font></font>
                @distance, @distance<font></font>
            )<font></font>
        ),<font></font>
        collect_geometries(<font></font>
            @offset_lines[<span class="hljs-number">0</span>], <span class="hljs-comment">--  1</span>
            @offset_lines[<span class="hljs-number">1</span>], <span class="hljs-comment">--  2</span>
            make_line( <span class="hljs-comment">--     1   2</span>
                start_point(@offset_lines[<span class="hljs-number">0</span>]),<font></font>
                start_point(@offset_lines[<span class="hljs-number">1</span>])<font></font>
            ),<font></font>
            make_line( <span class="hljs-comment">--     1   2</span>
                end_point(@offset_lines[<span class="hljs-number">0</span>]),<font></font>
                end_point(@offset_lines[<span class="hljs-number">1</span>])<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>,   <code>with_variable</code>, , ,    .    .   <code>@offset_lines</code>   ,  ,  (    <code>offset_curve()</code>),        <code>extend()</code>.      ,   â€”  <code>start_point()</code>    â€”  <code>end_point()</code>.</p><br>
<h2 id="pervyy--poshel-vtoroy--poshel"> â€” ,  â€” </h2><br>
<p>    ,      ,   .     (.  <strong>lines3</strong>).      ,    :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'lines'</span>,<font></font>
    segments_to_lines($geometry),<font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            generate_series(<span class="hljs-number">2</span>, num_geometries(@<span class="hljs-built_in">lines</span>), <span class="hljs-number">2</span>),<font></font>
            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p> <code>segments_to_lines()</code>    ,        â€”  ,  .      ,          <code>generate_series</code>.   :</p><br>
<p><img src="https://habrastorage.org/webt/vm/b_/ui/vmb_uiguoulfsqxf8kx6fxnhns4.png"></p><br>
<h2 id="krestiki"></h2><br>
<p>  .  ,         ( <strong>poly2</strong>).</p><br>
<p><img src="https://habrastorage.org/webt/eu/5a/mn/eu5amnxzyzgue-ji3ll3yt3ii6i.png"></p><br>
<p>       Â«/Â»   :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'points_num'</span>,
    <span class="hljs-comment">--     </span>
    num_points($geometry) - <span class="hljs-number">1</span>, <span class="hljs-comment">-- </span><font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            <span class="hljs-comment">--     </span>
            generate_series(<span class="hljs-number">1</span>, round(@points_num / <span class="hljs-number">2.0</span>)),<font></font>
            make_line(<font></font>
                point_n( <span class="hljs-comment">--  </span><font></font>
                    $geometry,<font></font>
                    @element<font></font>
                ), <font></font>
                point_n( <span class="hljs-comment">--  </span><font></font>
                    $geometry,<font></font>
                    @element + <span class="hljs-built_in">floor</span>(@points_num / <span class="hljs-number">2.0</span>)<font></font>
                )<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>    Â«Â»   ,   <code>generate_series()</code>        .        .</p><br>
<h2 id="zvezdochki"></h2><br>
<p> ,   ( <strong>poly3</strong>):<br>
<img src="https://habrastorage.org/webt/3n/uz/fy/3nuzfydrnxb84cymt1jjdhfvlsk.png"></p><br>
<p> :</p><br>
<pre><code class="lua hljs">collect_geometries(<font></font>
    array_foreach(<font></font>
        generate_series(<span class="hljs-number">1</span>, num_points($geometry) - <span class="hljs-number">1</span>),<font></font>
        make_line(<font></font>
            centroid($geometry),<font></font>
            point_n($geometry, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p> ,   <code>centroid()</code>,     ,        ,      .</p><br>
<h2 id="poligon-v-liniyu">  </h2><br>
<p>                 â€”  <strong>poly4</strong>.  ,     ,      Â«Â»,      . Â«Â»  â€”   , ,   <em></em>  ,  .     :</p><br>
<p><img src="https://habrastorage.org/webt/g6/e3/cs/g6e3cs0j0m-h-zhlshdcnm-dp5m.png"></p><br>
<p>     ,           , .&nbsp;.       .       ,  :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'lines'</span>,<font></font>
    segments_to_lines($geometry), <span class="hljs-comment">--    </span><font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            segments_between_sides_nums( <span class="hljs-comment">--   Python</span><font></font>
                array_foreach(<font></font>
                    generate_series(<span class="hljs-number">1</span>, num_geometries(@<span class="hljs-built_in">lines</span>)),
                    <span class="hljs-comment">--   [ ,  ]</span><font></font>
                    array(<font></font>
                        @element,<font></font>
                        length(<font></font>
                            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
                        )<font></font>
                    )<font></font>
                )<font></font>
            ),<font></font>
            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>   ,               .         ,   ,             .</p><br>
<p>        <code>segments_between_sides_num()</code>.      QGIS      Python ( <strong>custom.py</strong>     <strong>~/.local/share/QGIS/QGIS3/profiles/default/python/expressions</strong>):</p><br>
<pre><code class="python hljs"><span class="hljs-meta">@qgsfunction(args="auto", group="")</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">segments_between_sides_nums</span>(<span class="hljs-params">sides, feature, parent</span>):</span>
    <span class="hljs-string">"""
            
    .
    sides -     ( ,  )
    """</span>
    sorted_sides = sorted(sides, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">return</span> list(range(int(sorted_sides[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) + <span class="hljs-number">1</span>, int(sorted_sides[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])))</code></pre><br>
<p>   Python         , ..    (   ),       .</p><br>
<p>    .  ,      Python?</p><br>
<h2 id="naivnyy-benchmarking"> </h2><br>
<p>   ,    :  QGIS     Python?        .   ,          .</p><br>
<p><strong> </strong></p><br>
<ul>
<li> <strong>test_poly</strong>  100000 ,        3  20.</li>
</ul><br>
<p>     <strong>create_poly_lyr.py</strong>,        (   ).</p><br>
<p><strong></strong></p><br>
<ul>
<li>      ,            ,      Â«<strong></strong>Â».      ,          (     ).</li>
</ul><br>
<p>    Python,       QGIS,         Python.   <strong>expression_benchmarking.py</strong>:</p><br>
<pre><code class="python hljs">EXPRESSION = <span class="hljs-string">"""
collect_geometries(
    array_foreach(
        generate_series(1, num_points($geometry)),
        make_line(
            centroid($geometry),
            point_n($geometry, @element)
        )
    )
)
"""</span><font></font>
â€¦<font></font>
<span class="hljs-keyword">for</span> counter, poly <span class="hljs-keyword">in</span> enumerate(lyr_polys.getFeatures()):<font></font>
    exp = QgsExpression(EXPRESSION)<font></font>
    context = QgsExpressionContext()<font></font>
    context.setFeature(poly)<font></font>
    star = exp.evaluate(context)</code></pre><br>
<p>  <strong>python_benchmarking.py</strong>:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> counter, poly <span class="hljs-keyword">in</span> enumerate(lyr_polys.getFeatures()):<font></font>
    centroid = QgsPoint(poly.geometry().centroid().asPoint())<font></font>
    star = QgsMultiLineString()<font></font>
    <span class="hljs-keyword">for</span> vertex <span class="hljs-keyword">in</span> poly.geometry().vertices():<font></font>
        line = QgsLineString(centroid, vertex)<font></font>
        star.addGeometry(line)</code></pre><br>
<p><strong></strong><br>
<img src="https://habrastorage.org/webt/bo/xe/f1/boxef1u9kphkummosqk_m2t6p-4.png"></p><br>
<p>      Python  <strong>5,3</strong> ,    <strong>23,16</strong> . Python       <strong>4,5</strong> .    , ,  ,    .</p><br>
<h3 id="interpretaciya-rezultatov"> </h3><br>
<p><strong> :</strong></p><br>
<ul>
<li> .   Â«Â»   ,  ,      Â«- 1Â»    ,   Python,    .</li>
<li>    QGIS, .&nbsp;.    ,       .</li>
</ul><br>
<p><strong> :</strong></p><br>
<ul>
<li>       Python.</li>
<li>   .</li>
</ul><br>
<p><strong> Python:</strong></p><br>
<ul>
<li>         .</li>
<li>  Python.</li>
</ul><br>
<p><strong> Python:</strong></p><br>
<ul>
<li>  () *.py   .</li>
<li>  Python    ,     .</li>
<li>    Python,     ,          (  Windows).</li>
</ul><br>
<p>   ,         QGIS       .  ,   ,  , ,       .          ,     Â«Â»    Python.</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>     ?  .</p><br>
<p> :     WGS84 (/),   â€” .     ,         ,          .          ,  . ,     :</p><br>
<p><img src="https://habrastorage.org/webt/h1/i6/jb/h1i6jbxfnnvxd3und1nlso-ajjm.png" alt="Ø§Ù„Ø¹Ø§Ø²Ù„Ø© Ø¨Ø§Ù„Ø¯Ø±Ø¬Ø§Øª"></p><br>
<p>  : ,  ,    .       ,     .    <strong>poly3</strong>   Â«Â»   :</p><br>
<p><img src="https://habrastorage.org/webt/fb/ef/qr/fbefqrimeuzwhm3d5r3wn01gmri.png" alt="Ù…Ø¶Ù„Ø¹ Ø§Ù„Ø­ÙØ±Ø©"></p><br>
<p>  ,    .</p><br>
<p>    ,          ,       /? ,        :</p><br>
<p><img src="https://habrastorage.org/webt/_j/dz/gl/_jdzglxcy8-9hhrx_i16hhjxequ.png" alt="Ø§Ù„ÙÙ‚Ø³ Ø§Ù„Ù…ÙˆØ§Ø²ÙŠ"></p><br>
<p>       Â«Â»     ,         ?   ,       ,  .</p><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Â«Â»</a>,     ?</p><br>
<p> ,      ,     .         ,     ,           .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ØªÙˆÙØ± Ø§Ù„Ù…ÙˆÙ„Ø¯Ø§Øª Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø© ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ ØŒ ÙˆØ¨Ø´ÙƒÙ„ Ø£Ø¯Ù‚ ØŒ Ø§Ù„Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Ù…Ø­Ø¯ÙˆØ¯Ø© ÙÙ‚Ø· Ø¨Ø§Ù„Ø£Ø¯Ø§Ø¡ ØŒ ÙˆÙ‡ÙŠ Ø£Ø¯Ø§Ø© Ù„Ø§ ØºÙ†Ù‰ Ø¹Ù†Ù‡Ø§ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù„Ø§Ù…Ø§Øª ØªÙ‚Ù„ÙŠØ¯ÙŠØ© Ù…Ø¹Ù‚Ø¯Ø© Ø­Ù‚Ù‹Ø§.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø¢Ù…Ù„ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ù…ÙÙŠØ¯Ø© ØŒ ÙˆÙ‚Ø¯ Ù†Ø¹ØªØ¨Ø± Ø­Ø§Ù„Ø§Øª Ù…Ø¹Ù‚Ø¯Ø© ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©. </font><font style="vertical-align: inherit;">Ø´ÙƒØ±Ø§ Ù„Ù„Ø§Ù†ØªØ¨Ø§Ù‡.</font></font></p><br>
<h2 id="ssylki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø¯Ù„ÙŠÙ„ Ø³Ø±ÙŠØ¹ Ù„Ø·Ø¨Ù‚Ø§Øª Ø±Ù…Ø² Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø£Ù†Ù…Ø§Ø· Ù†Ù‡Ø± Ø£ÙØ¶Ù„ Ù…Ø¹ Ø®Ø·ÙˆØ· Ù…Ø¯Ø¨Ø¨Ø©</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ù…ÙˆÙ„Ø¯Ø§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© FOSS4G / QGIS</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø£Ù…Ø«Ù„Ø© QGIS Geometry Generator</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ù‚Ù†Ø§Ø© ÙƒÙ„Ø§Ø³ ÙƒØ§Ø±Ù„Ø³ÙˆÙ† Ù…ÙˆÙ„Ø¯Ø§Øª ÙÙŠØ¯ÙŠÙˆ 0010 Ùˆ 0012</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ØªØ¹Ø§Ø¨ÙŠØ± Ø§Ù„Ø±Ø³Ù…ÙŠØ©</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„Ø±Ø³Ù…ÙŠ ÙÙŠ PyQGIS</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ù…Ø³ØªÙˆØ¯Ø¹ Ø¨Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¹ Ø£Ù…Ø«Ù„Ø©</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar504966/index.html">5 Ù…Ø·Ø¨Ø§Øª Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</a></li>
<li><a href="../ar504968/index.html">Ø­Ø¯Ø« Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†</a></li>
<li><a href="../ar504972/index.html">Ø£ÙŠÙ† ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ ØªÙ‚Ù†ÙŠØ§Øª Big Data Ø§Ù„ÙŠÙˆÙ…ØŸ</a></li>
<li><a href="../ar504976/index.html">Ø§Ù„Ù…Ø´Ø§Ø© Ù…Ù‚Ø§Ø¨Ù„ Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ¨Ø­ Ø§Ù„Ù…Ø³ØªÙ‚Ù„ ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</a></li>
<li><a href="../ar504980/index.html">Ù…Ù…Ø§Ø±Ø³Ø© Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø¯ÙˆÙ„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ Ù…Ù† ÙƒÙ†Ø¯Ø§ ÙˆØ§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ</a></li>
<li><a href="../ar504988/index.html">Ù…Ù‚Ø§Ø¨Ù„Ø© Ù…Ø¹ Ù…Ø­Ù„Ù„ - Ø¯ÙŠÙ†ÙŠØ³ Ø³ÙˆØ¨ÙˆÙ„ÙŠÙ ØŒ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬ ØŒ Ø±Ø¦ÙŠØ³ ØªØ­Ù„ÙŠÙ„Ø§Øª B2B Skyeng</a></li>
<li><a href="../ar504996/index.html">BazarBackdoor: Ù†Ù‚Ø·Ø© Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</a></li>
<li><a href="../ar505016/index.html">Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ: Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a></li>
<li><a href="../ar505018/index.html">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø³ÙŠÙ„ÙŠÙ†ÙŠÙˆÙ…: Ø§Ù„Ø­Ù„Ù‚Ø§Øª 1 - 2</a></li>
<li><a href="../ar505024/index.html">YouTrack Ø§Ù„Ø¢Ù† Ù…Ø¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>