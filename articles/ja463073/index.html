<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏽‍🤝‍🧑🏻 🍓 👟 QUICの実際：Uberがパフォーマンスを最適化するためにどのように実装したか ❕ 👩🏿‍🎨 🐌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QUICプロトコルは非常に興味深いので、私たちはそれについて書くのが大好きです。しかし、以前のQUICに関する出版物がより歴史的なもの（ご希望の場合は地元の歴史）の特徴と資料である場合は、本日、異なる解釈を発表できることを嬉しく思います。2019年のプロトコルの実際の適用について話します。そして、そ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>QUICの実際：Uberがパフォーマンスを最適化するためにどのように実装したか</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/463073/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QUICプロトコルは非常に興味深いので、私たちはそれについて書くのが大好きです。</font><font style="vertical-align: inherit;">しかし、以前のQUICに関する出版物がより歴史的なもの（ご希望の場合は地元の歴史）の特徴と資料である場合は、本日、異なる解釈を発表できることを嬉しく思います。2019年のプロトコルの実際の適用について話します。</font><font style="vertical-align: inherit;">そして、それは条件付きガレージに基づいた小さなインフラストラクチャではなく、ほぼ世界中で機能するUberに関するものです。</font><font style="vertical-align: inherit;">同社のエンジニアはどのようにしてQUICを本番環境で使用することを決定しましたか？</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写真はクリック可能です。</font><font style="vertical-align: inherit;">読書を楽しむ！</font></font></blockquote><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/t-/vf/ou/t-vfouxapcoi45iq_uugxs3-4lo.png"></div><br>
</a><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uberは世界規模、つまり600のプレゼンス都市であり、それぞれのアプリケーションは、4,500を超える携帯電話会社の無線インターネットに完全に依存しています。ユーザーは、アプリケーションが高速であるだけでなくリアルタイムで動作することを期待しています。これを保証するには、Uberアプリケーションに低遅延と非常に信頼性の高い接続が必要です。悲しいかな、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタック</font><font style="vertical-align: inherit;">は、動的で損失が発生しやすいワイヤレスネットワークではうまく機能しません。この場合、パフォーマンスの低下はオペレーティングシステムのカーネルでのTCP実装に直接関連していることがわかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するために、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">QUIC</font></a><font style="vertical-align: inherit;">を適用しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、チャネル多重化を備えた最新のプロトコル。トランスポートプロトコルのパフォーマンスをより詳細に制御できます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IETF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワーキンググループは現在、</font><font style="vertical-align: inherit;">QUICを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として標準化してい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳細なテストの結果、アプリケーションにQUICを実装すると、TCPに比べて「テール」遅延が少なくなるという結論に達しました。</font><font style="vertical-align: inherit;">ドライバーアプリケーションと乗客アプリケーションの例では、HTTPSトラフィックの範囲が10〜30％減少しました。</font><font style="vertical-align: inherit;">QUICにより、カスタムパッケージをエンドツーエンドで制御することもできました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、QUICをサポートするスタックを使用してUberアプリケーション用にTCPを最適化する経験を共有します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジーの最後の言葉：TCP</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日、TCPはインターネットでHTTPSトラフィックを配信するために最も使用されているトランスポートプロトコルです。 TCPは信頼性の高いバイトストリームを提供するため、ネットワークの輻輳やリンク層の損失に対処できます。 HTTPSトラフィックにTCPが広く使用されている理由は、前者（ほとんどすべてのOSにTCPが含まれています）の普及、ほとんどのインフラストラクチャ（たとえば、ロードバランサー、HTTPSプロキシ、CDN）での可用性、およびほとんどのプラットフォームとネットワーク。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのユーザーは外出先でアプリケーションを使用しており、TCPテール遅延はHTTPSトラフィックのリアルタイム要件とはかけ離れています。簡単に言えば、世界中のユーザーがこれに直面しています-図1は、大都市での遅延を示しています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/z1/4r/dr/z14rdrs2ba8rzmrb8akbtadvqxy.png"></div></a><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図1.「テール」遅延の大きさは、Uberが存在する主要都市で異なります。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インドやブラジルのネットワークでは、米国やイギリスよりも遅延が多いという事実にもかかわらず、テール遅延は平均遅延よりもはるかに大きくなっています。</font><font style="vertical-align: inherit;">そして、これはアメリカとイギリスにも当てはまります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無線によるTCPパフォーマンス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TCPは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有線</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク</font><font style="vertical-align: inherit;">用に作成されました</font><font style="vertical-align: inherit;">。つまり、十分に予測可能なリンクに重点が置かれています。ただし、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワイヤレス</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークには独自の特性と問題があります。まず、ワイヤレスネットワークは、干渉や信号の減衰による損失の影響を受けやすくなっています。たとえば、Wi-Fiネットワークはマイクロ波、Bluetooth、その他の電波に敏感です。セルラーネットワークでは、</font><font style="vertical-align: inherit;">オブジェクトや建物による信号の反射/吸収、および</font><font style="vertical-align: inherit;">隣接</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">するセルタワー</font></a><font style="vertical-align: inherit;">からの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">干渉</font></a><font style="vertical-align: inherit;">による</font><font style="vertical-align: inherit;">信号損失（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パス損失</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">発生</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">ます。これにより</font><font style="vertical-align: inherit;">、有線接続と比較して、</font><font style="vertical-align: inherit;">より重大（4〜10倍）およびさまざまな</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">往復遅延（RTT）</font></a><font style="vertical-align: inherit;">とパケット損失が発生します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
帯域幅の変動と損失に対処するために、セルラーネットワークは通常、トラフィックのバーストに大きなバッファーを使用します。これにより、優先度が高くなり、遅延が長くなる可能性があります。多くの場合、TCPはこのようなシーケンスをタイムアウトの増加による損失として扱います。そのため、TCPはリレーする傾向があり、それによってバッファがいっぱいになります。この問題は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bufferbloat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">過度のネットワークバッファリング、バッファ</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">スウェル</font></a><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">として知られており</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現代のインターネットの</font><font style="vertical-align: inherit;">非常に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">深刻な問題です</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、セルラーネットワークのパフォーマンスは、キャリア、地域、および時間によって異なります。図2では、2キロ圏内のセルを介したHTTPSトラフィックの遅延の中央値を収集しました。インドのデリーにある最大の2つの携帯電話会社のデータが収集されます。ご覧のとおり、パフォーマンスはセルごとに異なります。また、あるオペレーターのパフォーマンスは、2番目のオペレーターのパフォーマンスとは異なります。これは、時間と場所を考慮したネットワークエントリパターン、ユーザーの移動性、およびタワーの密度とネットワークタイプの比率（LTE、3Gなど）を考慮したネットワークインフラストラクチャなどの要因の影響を受けます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/ln/vz/ya/lnvzyai54p_xde2mfcr50ddoopa.png"></div></a><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2.半径2 kmの例の遅延。</font><font style="vertical-align: inherit;">インド、デリー。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、セルラーネットワークのパフォーマンスは、時間とともに変化します。</font><font style="vertical-align: inherit;">図3は、曜日ごとの遅延の中央値を示しています。</font><font style="vertical-align: inherit;">また、1日と1時間以内という小さなスケールでの違いも確認しました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/xu/oo/u_/xuoou_03qrdllnyebxvrpiwa1iy.png"></div></a><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.テールの遅延は、同じオペレーターでも、日によって大きく異なる可能性があります。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記すべてが原因で、ワイヤレスネットワークではTCPパフォーマンスが非効率であるという事実につながります。</font><font style="vertical-align: inherit;">ただし、TCPの代替案を探す前に、次の点を正確に理解する必要がありました。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションのテーリング遅延の主な原因はTCPですか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新のネットワークには、大きく多様な往復遅延（RTT）がありますか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTTとTCPのパフォーマンス低下の影響は何ですか？</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPパフォーマンス分析</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TCPパフォーマンスの分析方法を理解するために、TCPが送信者から受信者にデータを転送する方法を簡単に思い出してみましょう。まず、送信者は3ウェイ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハンドシェイクを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行してTCP接続を確立します</font><font style="vertical-align: inherit;">。送信者はSYNパケットを送信し、受信者からのSYN-ACKパケットを待ってから、ACKパケットを送信します。追加の2番目と3番目のパスは、TCP接続の作成に進みます。受信者は、信頼できる配信を保証するために、各パケットの受信（ACK）を確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パケットまたはACKが失われた場合、送信者はタイムアウト（RTO、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再送信タイムアウト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">後に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">再送信し</font></a><font style="vertical-align: inherit;">ます。 RTOは、送信者と受信者の間の予想されるRTT遅延など、さまざまな要因に基づいて動的に計算されます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/-w/nf/g8/-wnfg8rew9-lbfsaxfw6k9fnnxi.png"></div></a><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図4. TCP / TLSパケット交換には、再送信メカニズムが含まれています。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私たちのアプリケーションでTCPがどのように機能するかを判断する</font><font style="vertical-align: inherit;">ために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tcpdump</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">TCPパケットを</font><font style="vertical-align: inherit;">1週間</font><font style="vertical-align: inherit;">監視し</font><font style="vertical-align: inherit;">、インド国境サーバーからの戦闘トラフィック</font><font style="vertical-align: inherit;">を監視し</font><font style="vertical-align: inherit;">ました。次に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tcptrace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してTCP接続を分析しました</font><font style="vertical-align: inherit;">。さらに、エミュレートされたトラフィックをテストサーバーに送信し、実際のトラフィックをできるだけ模倣するAndroidアプリケーションを作成しました。このアプリケーションを搭載したスマートフォンは、数日間ログを収集した複数の従業員に配布されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
両方の実験の結果は互いに一致していた。</font><font style="vertical-align: inherit;">高いRTT遅延が発生しました。</font><font style="vertical-align: inherit;">テール値は中央値のほぼ6倍でした。</font><font style="vertical-align: inherit;">遅延の算術平均値-1秒以上。</font><font style="vertical-align: inherit;">多くの接続で損失が発生し、TCPがすべてのパケットの3.5％を再送信しました。</font><font style="vertical-align: inherit;">空港や駅などの混雑した地域では、7％の損失が見られました。</font><font style="vertical-align: inherit;">このような結果は、セルラーネットワークで使用される</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高度な再送信方式が</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トランスポート損失を大幅に削減する</font><font style="vertical-align: inherit;">という従来の知識に疑問を投げかけ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">以下は、「シミュレータ」アプリケーションのテスト結果です。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク指標</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価値観</font></font></th>
</tr>
<tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTT、ミリ秒[50％、75％、95％、99％]</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[350、425、725、2300]</font></font></td>
</tr>
<tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTTの不一致、秒</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">約1.2秒</font></font></td>
</tr>
<tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不安定な接続でのパケット損失</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平均で3.5％（混雑している地域では7％）</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの接続のほぼ半分は、少なくとも1つのパケット損失があり、そのほとんどはSYNおよびSYN-ACKパケットでした。ほとんどのTCP実装は、SYNパケットに1秒のRTO値を使用します。これは、後続の損失に対して指数関数的に増加します。 TCPは接続を確立するためにより多くの時間を必要とするため、アプリケーションの読み込み時間は増加する可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データパケットの場合、ワイヤレスネットワークで一時的な損失が発生すると、RTOが高くなると、ネットワークの有効利用率が大幅に低下します。平均再送信時間は約1秒で、テール遅延は約30秒です。 TCPレベルでのこのような大きな遅延により、HTTPSのタイムアウトと再試行が発生し、レイテンシとネットワークの非効率性がさらに増加し​​ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
測定されたRTTの75パーセンタイルは約425ミリ秒でしたが、TCPの75パーセンタイルはほぼ3秒でした。</font><font style="vertical-align: inherit;">これは、データを正常に送信するために、TCPがTCPに7〜10パスを強制することを示唆しています。</font><font style="vertical-align: inherit;">これは、非効率的なRTO計算、</font><font style="vertical-align: inherit;">ウィンドウ内の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後のパケットの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失にTCPが迅速に応答できないこと</font><font style="vertical-align: inherit;">、およびネットワークの輻輳によるワイヤレスの損失と損失を区別しない輻輳制御アルゴリズムの非効率性が原因である可能性があります。</font><font style="vertical-align: inherit;">以下は、TCP損失テストの結果です。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPパケット損失統計</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">少なくとも1つのパケット損失がある接続の割合</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">45％</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続の確立中に失われた接続の割合</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30％</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ交換中に接続が失われた割合</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">76％</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再送信遅延の分布、秒[50％、75％、95％、99％]</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1、2.8、15、28]</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのパケットまたはTCPセグメントの再送信の配信</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1、3、6、7]</font></font></td>
</tr>
</tbody></table></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QUICアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
QUICはもともとGoogleによって設計されたもので、UDP上で実行されるマルチスレッド化された最新のトランスポートプロトコルです。</font><font style="vertical-align: inherit;">現在、QUICは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">標準化</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">段階にあります</font></a><font style="vertical-align: inherit;">（QUICには2つのバージョンがあり、好奇心旺盛な人</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はリンクをたどることができます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ほぼ</font></a><font style="vertical-align: inherit;">翻訳者です）。</font><font style="vertical-align: inherit;">図5に示すように、QUICはHTTP / 3でホストされています（実際には、QUICの上にあるHTTP / 2-これはHTTP / 3であり、現在、大幅に標準化されています）。</font><font style="vertical-align: inherit;">UDPを使用してパケットを形成し、HTTPSレイヤーとTCPレイヤーを部分的に置き換えます。</font><font style="vertical-align: inherit;">TLSはQUICに完全に統合されているため、QUICは安全なデータ転送のみをサポートします。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/y4/an/qg/y4anqgxplkww-bc3thmjykbdg2i.png"></div><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図5：QUICはHTTP / 3で動作し、以前はHTTP / 2で動作していたTLSを置き換えます。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下に、QUICを使用してTCPを強化することを確信させた理由をリストします。</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-RTT接続セットアップ。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QUICを使用すると、以前の接続からの承認を再利用できるため、セキュリティハンドシェイクの数を減らすことができます。</font><font style="vertical-align: inherit;">将来、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS1.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は0-RTTをサポートしますが、3方向のTCPハンドシェイクが引き続き必要になります。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HoLブロッキングの克服。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 2は、クライアントごとに1つのTCP接続を使用してパフォーマンスを向上させますが、これによりHoL（行頭）ブロックが発生する可能性があります。</font><font style="vertical-align: inherit;">QUICは多重化を簡素化し、互いに独立してアプリケーションにリクエストを配信します。</font></font></li>
<li><b> .</b> QUIC    ,      ,   ,     (   RTT).  TCP-   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CUBIC</a>,     ,   .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">BBR</a>,       . QUIC   BBR        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</li>
<li><b> .</b> QUIC   TLP (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">tail loss probe</a>)     RTO –     .     TCP. TLP      ( ,   ),    .       ,  Uber   ,    ,       .</li>
<li><b> ACK.</b>        ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>    . ACK-         ACK   .   ,  QUIC    RTT. ACK  QUIC   256  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">NACK</a>,              .  ACK (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SACK</a>)  TCP       .</li>
<li><b> .</b>  QUIC    64- ID,      IP-,    ID     IP-,  .       ,     Wi-Fi   .</li>
</ul><br>
<h2> QUIC</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
QUICを選択する前に、問題を解決する別の方法を検討しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、TPC PoP（Points of Presence）を導入して、ユーザーに近いTCP接続を確立しようとしました。基本的に、PoPはセルラーネットワークに近いモバイルデバイスとのTCP接続を終了し、トラフィックを元のインフラストラクチャにプロキシします。 TCPを近づけると、RTTが削減される可能性があり、動的なワイヤレス環境に対するTCPの応答性が向上することを確認できます。ただし、私たちの実験では、RTTと損失の大部分はセルラーネットワークに起因するものであり、PoPを使用してもパフォーマンスが大幅に向上することはありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、TCPパラメータの調整についても検討しました。異種のエッジサーバーでTCPスタックを構成するのは困難でした。TCPは、OSのバージョンが異なると、実装が異なるためです。これを実装してさまざまなネットワーク構成をテストすることは困難でした。権限がないため、モバイルデバイスで直接TCPを構成することはできませんでした。さらに重要なことに、0-RTTとの接続や拡張RTT予測などのチップはプロトコルアーキテクチャにとって重要であるため、TCPを構成するだけでは大きなメリットを得ることができません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、ビデオストリーミングのトラブルシューティングを行ういくつかのUDPベースのプロトコルを評価しました。これらのプロトコルが私たちのケースで役立つかどうかを調べたかったのです。</font><font style="vertical-align: inherit;">悲しいかな、彼らは多くのセキュリティ設定を欠いており、メタデータと制御情報のために追加のTCP接続も必要でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの調査によると、セキュリティとパフォーマンスの両方を考慮しながら、QUICがインターネットトラフィックの問題を解決できるほぼ唯一のプロトコルです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラットフォームへのQUIC統合</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
QUICを正常に統合し、通信状態が悪いときにアプリケーションのパフォーマンスを向上させるために、古いスタック（HTTP / 2 over TLS / TCP）をQUICプロトコルに置き換えました。私たちは、使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cronet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークライブラリ</font><font style="vertical-align: inherit;">から</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クロムプロジェクト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gQUIC -プロトコルの元、Googleのバージョンが含まれています、。この実装は、最新のIETF仕様に準拠するように常に改善されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、AndroidアプリにCronetを統合してQUICサポートを追加しました。統合は、移行コストを最小限に抑えるような方法で行われました。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://square.github.io/ok"><font style="vertical-align: inherit;">OkHttp</font></a><font style="vertical-align: inherit;">ライブラリを使用していた古いネットワークスタックを完全に置き換えるのではなく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://square.github.io/ok"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、OkHttp APIフレームワークの下にCronetを統合しました。</font><font style="vertical-align: inherit;">このように統合すること</font><font style="vertical-align: inherit;">で、APIレベルでの</font><font style="vertical-align: inherit;">ネットワーク呼び出し（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retrofitが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">変更を回避</font><font style="vertical-align: inherit;">しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Androidデバイスへのアプローチと同様に、iOSのUberアプリケーションに</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Cronet</font></a><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">実装</font></a><font style="vertical-align: inherit;">し、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">NSURLProtocol</font></a><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">してネットワーク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からのHTTPトラフィックをインターセプト</font><font style="vertical-align: inherit;">し</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">iOS Foundationによって提供されるこの抽象化は、プロトコル固有のURLデータを処理し、大幅な移行コストなしでCronetをiOSアプリに統合できるようにします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Cloud BalancerでQuicが完了しました</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックエンド側では、QUICターミネーションは</font><font style="vertical-align: inherit;">、応答で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alt-svc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダー</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">してQUICをサポート</font><font style="vertical-align: inherit;">するGoogle Cloud Load Balancingインフラストラクチャによって提供され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">通常、バランサーは各HTTPリクエストにalt-svcヘッダーを追加し、ドメインのQUICサポートを既に検証しています。</font><font style="vertical-align: inherit;">Cronetクライアントは、このヘッダーを含むHTTP応答を受信すると、このドメインへの後続のHTTP要求にQUICを使用します。</font><font style="vertical-align: inherit;">バランサーがQUICを完了するとすぐに、インフラストラクチャはHTTP2 / TCPを介してこのアクションを明示的にデータセンターに送信します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンス：結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
優れた性能は、より良いプロトコルを探す主な理由です。</font><font style="vertical-align: inherit;">まず、</font><font style="vertical-align: inherit;">QUICがさまざまなネットワークプロファイルでどのように動作するかを確認するために</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークエミュレーション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付きのスタンドを作成しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">実際のネットワークでのQUICの動作をテストするために、乗客のアプリケーションでのHTTP呼び出しに非常に類似したエミュレートされたネットワークトラフィックを使用して、ニューデリー周辺を実験しました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実験1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験用インベントリ：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidテストデバイスでOkHttpスタックとCronetスタックを使用して、TCPおよびQUICを介してHTTPSトラフィックをそれぞれ開始することを確認します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じタイプのHTTPSヘッダーを応答で送信し、クライアントデバイスをロードしてそれらから要求を受信するJavaベースのエミュレーションサーバー。</font></font></li>
<li> ,      ,   TCP  QUIC-.       TCP      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">NGINX</a>,        QUIC.      QUIC ,    QUIC  Chromium  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>     .</li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/vp/qt/sx/vpqtsxbastzm3um6hjwcdz2giv8.png" width="49%"></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/qc/ti/vz/qctivzpddsppzzfxhfqbkgzopyk.png" width="49%"></a><br>
<font color="grey"> 6.     TCP vs QUIC   Android-  OkHttp  Cronet,        .</font><br>
<br>
<h3> 2</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googleが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://cloud.google.com/blog/products/gcp/introducing-quic-support-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Cloud Load Balancing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">QUICを利用できるようにしたとき</font><font style="vertical-align: inherit;">、同じインベントリを使用しましたが、NGINXの代わりにGoogleバランサーを使用して、デバイスからのTCPおよびQUIC接続を完了し、HTTPSトラフィックをエミュレーションサーバーに転送しました。 。</font><font style="vertical-align: inherit;">バランサーは世界中に分散していますが、デバイスに最も近いPoPサーバーを使用しています（ジオロケーションのおかげです）。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/bl/ec/v-/blecv-4m260dn8_ufg9d0tuq5e4.png"></div></a><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図7. 2番目の実験では、TCP完了遅延とQUICを比較する必要がありました。GoogleCloudを使用した場合とクラウドプロキシを使用した場合です。</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、いくつかの啓示が待っていました。</font></font><br>
<ul>
<li><b>  PoP   TCP.</b>     TCP-      ,    RTT,    TCP.    QUIC   ,     TCP      ( 10-30 ).</li>
<li><b>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  (hops)</a>.</b>   QUIC-     (   50  ),   ,     – 15%-    20%-   99   TCP.    ,      –    (bottleneck)   .</li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ne/co/7c/neco7cpjmlkjsp0uxdnwfez9cuk.png" width="49%"></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/zd/gl/2d/zdgl2d_tftg33ztgy_t90ikfcui.png" width="49%"></a><br>
<font color="grey"> 8.    ,  QUIC   TCP.</font><br>
<br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験から発想を得て、AndroidおよびiOSアプリケーションにQUICサポートを実装しました。</font><font style="vertical-align: inherit;">A / Bテストを実施して、Uberが運営されている都市でのQUICの影響を判断しました。</font><font style="vertical-align: inherit;">一般的に、通信事業者やネットワークタイプだけでなく、地域全体でテール遅延が大幅に減少しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下のグラフは、マクロ領域とさまざまなタイプのネットワーク（LTE、3G、2G）のテールの改善率（95および99パーセンタイル）を示しています。</font><font color="grey"><font style="vertical-align: inherit;">図9.戦闘テストでは、QUICは遅延でTCPよりも優れていました。</font></font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/-7/p7/11/-7p711t91dffb4aoecw6f_woexw.png" width="49%"></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/oo/q4/gr/ooq4grp5mldwwmiyxyy8poqyqug.png" width="49%"></a><br>
<font color="grey"><font style="vertical-align: inherit;"></font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">転送のみ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらくこれはほんの始まりに過ぎません。本番環境でQUICをロールアウトすると、安定したネットワークと不安定なネットワークの両方でアプリケーションのパフォーマンスを向上させる大きなチャンスが生まれました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カバレッジの増加</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際のトラフィックのプロトコルパフォーマンスを分析したところ、セッションの約80％が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストに</font><font style="vertical-align: inherit;">QUICを正常に使用しているの</font><font style="vertical-align: inherit;">に対し、セッションの15％はQUICとTCPの組み合わせを使用していることがわかりました。</font><font style="vertical-align: inherit;">実際のUDP障害と悪いネットワーク状態を区別できないため、CronetライブラリがタイムアウトによってTCPに戻るため、この組み合わせが出現したと想定しています。</font><font style="vertical-align: inherit;">現在、QUICの後続の実装に取り​​組んでいるため、この問題の解決策を探しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QUIC最適化</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モバイルアプリケーションからのトラフィックは遅延の影響を受けますが、帯域幅の影響を受けません。</font><font style="vertical-align: inherit;">また、当社のアプリケーションは主に携帯電話ネットワークで使用されています。</font><font style="vertical-align: inherit;">実験に基づいて、TCPとQUICを完了するためにプロキシを使用することがユーザーに近い場合でも、テール遅延は依然として大きいです。</font><font style="vertical-align: inherit;">輻輳管理を改善し、QUIC損失回復アルゴリズムの効率を高める方法を積極的に探しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらおよびその他のいくつかの改善により、ネットワークや地域に関係なくユーザーエクスペリエンスを改善し、便利でシームレスなパッケージトランスポートを世界中でより利用しやすくする予定です。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja463061/index.html">Figmaでレイアウトを準備するためのルール</a></li>
<li><a href="../ja463063/index.html">Goのインターフェースを扱います</a></li>
<li><a href="../ja463067/index.html">まずはフロント、次にバック（いつか）</a></li>
<li><a href="../ja463069/index.html">React Basic Animated Guide</a></li>
<li><a href="../ja463071/index.html">インターネットの停止はどのような影響がありますか？</a></li>
<li><a href="../ja463075/index.html">新しいオープンソースライセンス</a></li>
<li><a href="../ja463083/index.html">iPhoneバックアップの保護</a></li>
<li><a href="../ja463085/index.html">ケージリモートファイルアクセスシステム</a></li>
<li><a href="../ja463089/index.html">ローコードプラットフォームを使用した機械設計者向けの企業検索システムの実装</a></li>
<li><a href="../ja463095/index.html">なぜSQLではないのですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>