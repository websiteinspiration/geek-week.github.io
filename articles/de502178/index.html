<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍍 👩🏻‍🌾 🚺 OVirt in 2 Stunden. Teil 3. Erweiterte Einstellungen 📥 🙆🏿 🚭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden einige optionale, aber nützliche Einstellungen vorgestellt:
 
 

- Verwendung zusätzlicher Namen für den Manager ;
- Verbindu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OVirt in 2 Stunden. Teil 3. Erweiterte Einstellungen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502178/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Artikel werden einige optionale, aber nützliche Einstellungen vorgestellt:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwendung zusätzlicher Namen für den Manager</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbindungsauthentifizierung über das Verzeichnis Active</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mutlipathing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Energieverwaltung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ersetzen von SSL-Zertifikaten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archivierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Management-Schnittstelle (Cockpit)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die VLANs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spezifisch für HPE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel ist eine Fortsetzung, siehe oVirt in 2 Stunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einführung</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation des Managers (Ovirt-Engine) und der Hypervisoren (Hosts) </font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erweiterte Einstellungen - Wir sind da</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundoperationen</font></font></a></li>
</ol><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusätzliche Managereinstellungen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Einfachheit halber liefern wir zusätzliche Pakete:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install bash-completion vim</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die automatische Vervollständigung zu aktivieren, sollten die Bash-Vervollständigungsbefehle auf Bash umgeschaltet werden.</font></font><br>
<br>
<a name="add-fqdn"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinzufügen zusätzlicher DNS-Namen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist erforderlich, wenn Sie über einen alternativen Namen (CNAME, Alias ​​oder nur einen Kurznamen ohne Domain-Suffix) eine Verbindung zum Manager herstellen müssen. </font><font style="vertical-align: inherit;">Aus Sicherheitsgründen erlaubt der Manager Verbindungen nur unter Verwendung der zulässigen Namensliste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine Konfigurationsdatei:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/engine.conf.d/99-custom-sso-setup.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
den folgenden Inhalt:</font></font><br>
<br>
<pre><code class="cmake hljs">SSO_ALTERNATE_ENGINE_FQDNS=<span class="hljs-string">"ovirt.example.com some.alias.example.com ovirt"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und starten Sie den Manager neu:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl restart ovirt-engine</code></pre><br>
<a name="ad-auth"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie die Authentifizierung über AD</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oVirt verfügt über eine integrierte Benutzerbasis, es werden jedoch auch externe LDAP-Anbieter unterstützt, einschließlich </font><font style="vertical-align: inherit;">ANZEIGE. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einfachste Weg für eine typische Konfiguration besteht darin, den Assistenten zu starten und den Manager neu zu starten:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install ovirt-engine-extension-aaa-ldap-setup<font></font>
$ sudo ovirt-engine-extension-aaa-ldap-setup<font></font>
$ sudo systemctl restart ovirt-engine</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel eines Assistenten</font></font></b>
                        <div class="spoiler_text">$ <b>sudo ovirt-engine-extension-aaa-ldap-setup</b><br>
Available LDAP implementations:<br>
…<br>
 3 — Active Directory<br>
…<br>
 Please select: <b>3</b><br>
 Please enter Active Directory Forest name: <b>example.com<br>
</b><br>
 Please select protocol to use (startTLS, ldaps, plain) <b>[startTLS]</b>: <br>
 Please select method to obtain PEM encoded CA certificate (File, URL, Inline, System, Insecure): <b>URL</b><br>
 URL: <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">wwwca.example.com/myRootCA.pem</a></b><br>
 Enter search user DN (for example uid=username,dc=example,dc=com or leave empty for anonymous): <b>CN=oVirt-Engine,CN=Users,DC=example,DC=com</b><br>
 Enter search user password: <b>*password*</b><br>
[ INFO ] Attempting to bind using 'CN=oVirt-Engine,CN=Users,DC=example,DC=com'<br>
 Are you going to use Single Sign-On for Virtual Machines (Yes, No) <b>[Yes]</b>: <br>
 Please specify profile name that will be visible to users <b>[example.com]</b>: <br>
 Please provide credentials to test login flow:<br>
 Enter user name: <b>someAnyUser</b><br>
 Enter user password: <br>
…<br>
[ INFO ] Login sequence executed successfully<br>
…<br>
 Select test sequence to execute (Done, Abort, Login, Search) <b>[Done]</b>: <br>
[ INFO ] Stage: Transaction setup<br>
…<br>
 CONFIGURATION SUMMARY<br>
…<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verwendung des Assistenten ist in den meisten Fällen geeignet. </font><font style="vertical-align: inherit;">Bei komplexen Konfigurationen sind die Einstellungen manuell. </font><font style="vertical-align: inherit;">Weitere Informationen finden Sie in der Dokumentation zu oVirt, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzern und Rollen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nach erfolgreicher Verbindung von Engine zu AD wird im Verbindungsfenster und auf der Registerkarte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berechtigungen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für </font><font style="vertical-align: inherit;">Systemobjekte ein zusätzliches Profil angezeigt </font><font style="vertical-align: inherit;">- die Möglichkeit, Benutzern und AD-Gruppen Berechtigungen zu erteilen. </font><font style="vertical-align: inherit;">Es ist zu beachten, dass das externe Verzeichnis der Benutzer und Gruppen nicht nur AD, sondern auch IPA, eDirectory usw. sein kann.</font></font><br>
<br>
<a name="mpath"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multipathing</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einer Produktionsumgebung muss das Speichersystem über mehrere unabhängige mehrere E / A-Pfade mit dem Host verbunden sein. </font><font style="vertical-align: inherit;">In der Regel gibt es in CentOS (und damit in oVirt) keine Probleme beim Erstellen mehrerer Gerätepfade (find_multipaths yes). </font><font style="vertical-align: inherit;">Zusätzliche Einstellungen für FCoE sind in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2 beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es lohnt sich, die Empfehlung des Herstellers von Speichersystemen zu beachten. Viele empfehlen die Verwendung der Round-Robin-Richtlinie. Standardmäßig wird in Enterprise Linux 7 der Dienst Linux verwendet.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zum Beispiel 3PAR</font></font></b>
                        <div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">HPE 3PAR Red Hat Enterprise Linux, CentOS Linux, Oracle Linux, and OracleVM Server Implementation Guide</a> EL   Host  Generic-ALUA Persona 2,     /etc/multipath.conf   :<br>
<br>
<pre><code class="plaintext hljs">defaults {<font></font>
           polling_interval      10<font></font>
           user_friendly_names   no<font></font>
           find_multipaths       yes<font></font>
          }<font></font>
devices {<font></font>
          device {<font></font>
                   vendor                   "3PARdata"<font></font>
                   product                  "VV"<font></font>
                   path_grouping_policy     group_by_prio<font></font>
                   path_selector            "round-robin 0"<font></font>
                   path_checker             tur<font></font>
                   features                 "0"<font></font>
                   hardware_handler         "1 alua"<font></font>
                   prio                     alua<font></font>
                   failback                 immediate<font></font>
                   rr_weight                uniform<font></font>
                   no_path_retry            18<font></font>
                   rr_min_io_rq             1<font></font>
                   detect_prio              yes<font></font>
                   fast_io_fail_tmo         10<font></font>
                   dev_loss_tmo             "infinity"<font></font>
                 }<font></font>
}</code></pre><br>
     :<br>
<br>
<pre><code class="bash hljs">systemctl restart multipathd</code></pre><br>
<img src="https://habrastorage.org/webt/ez/1c/fs/ez1cfs3-mar5uivpfekvtgomway.png"><br>
<i>. 1 —   -  .</i><br>
<br>
<img src="https://habrastorage.org/webt/j_/6r/ll/j_6rll3gmnpqzwhwz_uffranfgo.png"><br>
<i>. 2 —   -   .</i><br>
</div>
                    </div><br>
<a name="pwr-mgmt"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power Management Setup</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ermöglicht es Ihnen beispielsweise, einen Hardware-Reset des Computers durchzuführen, wenn die Engine längere Zeit keine Antwort vom Host erhalten kann. </font><font style="vertical-align: inherit;">Implementiert über den Fence Agent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berechnen -&gt; Hosts -&gt; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HOST</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Bearbeiten -&gt; Energieverwaltung, aktivieren Sie dann "Energieverwaltung aktivieren" und fügen Sie den Agenten hinzu - "Zaunagent hinzufügen" -&gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir geben den Typ (zum Beispiel muss ilo4 für iLO5 angegeben werden), den Namen / die Adresse der ipmi-Schnittstelle sowie den Benutzernamen / das Passwort an. </font><font style="vertical-align: inherit;">Es wird empfohlen, einen separaten Benutzer (z. B. oVirt-PM) zu erstellen und ihm im Fall von iLO die folgenden Berechtigungen zu erteilen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmeldung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote-Konsole</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtuelle Stromversorgung und Zurücksetzen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtuelle Medien</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie die iLO-Einstellungen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzerkonten verwalten</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fragen Sie nicht warum, es wird empirisch gewählt. </font><font style="vertical-align: inherit;">Der Konsolen-Fencing-Agent erfordert kleinere Rechte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Einrichten von Zugriffssteuerungslisten sollte berücksichtigt werden, dass der Agent nicht auf der Engine ausgeführt wird, sondern auf dem "benachbarten" Host (dem sogenannten Power Management Proxy). Wenn also nur ein Knoten im Cluster vorhanden ist, funktioniert die Energieverwaltung </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="ssl-cert"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL-Setup</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die vollständigen offiziellen Anweisungen finden Sie in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anhang D: oVirt und SSL - Ersetzen des oVirt Engine SSL / TLS-Zertifikats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Zertifikat kann entweder von unserer Unternehmenszertifizierungsstelle oder von einer externen kommerziellen Zertifizierungsstelle stammen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wichtiger Hinweis: Das Zertifikat ist für die Verbindung mit dem Manager vorgesehen. Es hat keine Auswirkungen auf die Interaktion zwischen Engine und Knoten. Es werden selbstsignierte Zertifikate verwendet, die von Engine ausgestellt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bedarf:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zertifikat der ausstellenden Zertifizierungsstelle im PEM-Format mit der gesamten Kette zur Stammzertifizierungsstelle (vom untergeordneten Aussteller am Anfang bis zur Stammzertifizierungsstelle am Ende);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von der ausstellenden Zertifizierungsstelle ausgestelltes Apache-Zertifikat (ergänzt durch die gesamte CA-Zertifikatkette)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">privater Schlüssel für Apache, kein Passwort.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, unsere Zertifizierungsstelle für Veröffentlichungen führt CentOS mit dem Namen subca.example.com aus, und die Anforderungen, Schlüssel und Zertifikate befinden sich im Verzeichnis / etc / pki / tls /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir führen Backups durch und erstellen ein temporäres Verzeichnis:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/pki/ovirt-engine/keys/apache.key.nopass /etc/pki/ovirt-engine/keys/apache.key.nopass.`date +%F`<font></font>
$ sudo cp /etc/pki/ovirt-engine/certs/apache.cer /etc/pki/ovirt-engine/certs/apache.cer.`date +%F`<font></font>
$ sudo mkdir /opt/certs<font></font>
$ sudo chown mgmt.mgmt /opt/certs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie Zertifikate herunter, führen Sie sie von unserer Workstation aus oder übertragen Sie sie auf eine andere bequeme Weise:</font></font><br>
<br>
<pre><code class="bash hljs">[myuser@mydesktop] $ scp -3 causer@subca.example.com:/etc/pki/tls/cachain.pem mgmt@ovirt.example.com:/opt/certs<font></font>
[myuser@mydesktop] $ scp -3 causer@subca.example.com:/etc/pki/tls/private/ovirt.key mgmt@ovirt.example.com:/opt/certs<font></font>
[myuser@mydesktop] $ scp -3 causer@subca.example.com/etc/pki/tls/certs/ovirt.crt mgmt@ovirt.example.com:/opt/certs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis sollten Sie alle 3 Dateien sehen:</font></font><br>
<br>
<pre><code class="bash hljs">$ ls /opt/certs<font></font>
cachain.pem  ovirt.crt  ovirt.key</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation des Zertifikats</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir kopieren Dateien und aktualisieren Vertrauenslisten:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cp /opt/certs/cachain.pem /etc/pki/ca-trust/<span class="hljs-built_in">source</span>/anchors<font></font>
$ sudo update-ca-trust<font></font>
$ sudo rm /etc/pki/ovirt-engine/apache-ca.pem<font></font>
$ sudo cp /opt/certs/cachain.pem /etc/pki/ovirt-engine/apache-ca.pem<font></font>
$ sudo cp /opt/certs/ovirt03.key /etc/pki/ovirt-engine/keys/apache.key.nopass<font></font>
$ sudo cp /opt/certs/ovirt03.crt /etc/pki/ovirt-engine/certs/apache.cer<font></font>
$ sudo systemctl restart httpd.service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konfigurationsdateien hinzufügen / aktualisieren:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/engine.conf.d/99-custom-truststore.conf</code></pre><br>
<pre><code class="plaintext hljs">ENGINE_HTTPS_PKI_TRUST_STORE="/etc/pki/java/cacerts"<font></font>
ENGINE_HTTPS_PKI_TRUST_STORE_PASSWORD=""</code></pre><br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/ovirt-websocket-proxy.conf.d/10-setup.conf</code></pre><br>
<pre><code class="plaintext hljs">SSL_CERTIFICATE=/etc/pki/ovirt-engine/certs/apache.cer<font></font>
SSL_KEY=/etc/pki/ovirt-engine/keys/apache.key.nopass</code></pre><br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf</code></pre><br>
<pre><code class="plaintext hljs"># Key file for SSL connections<font></font>
ssl_key_file = /etc/pki/ovirt-engine/keys/apache.key.nopass<font></font>
# Certificate file for SSL connections<font></font>
ssl_cert_file = /etc/pki/ovirt-engine/certs/apache.cer</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes starten wir alle betroffenen Dienste neu:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl restart ovirt-provider-ovn.service<font></font>
$ sudo systemctl restart ovirt-imageio-proxy<font></font>
$ sudo systemctl restart ovirt-websocket-proxy<font></font>
$ sudo systemctl restart ovirt-engine.service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erledigt! </font><font style="vertical-align: inherit;">Es ist Zeit, eine Verbindung zum Manager herzustellen und zu überprüfen, ob die Verbindung durch ein signiertes SSL-Zertifikat geschützt ist.</font></font><br>
<br>
<a name="backup-mgr"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archivierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wo ohne sie! </font><font style="vertical-align: inherit;">In diesem Abschnitt werden wir die Managerarchivierung erläutern. Die VM-Archivierung ist ein separates Problem. </font><font style="vertical-align: inherit;">Wir werden einmal am Tag Archivkopien erstellen und diese auf NFS ablegen, beispielsweise auf demselben System, auf dem wir die ISO-Images platziert haben - mynfs01.example.com:/exports/ovirt-backup. </font><font style="vertical-align: inherit;">Es wird nicht empfohlen, Archive auf demselben Computer zu speichern, auf dem Engine ausgeführt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installieren und aktivieren Sie Autofs:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install autofs<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> autofs<font></font>
$ sudo systemctl start autofs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie ein Skript:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/cron.daily/make.oVirt.backup.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
den folgenden Inhalt:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash
</span>
datetime=`date +<span class="hljs-string">"%F.%R"</span>`<font></font>
backupdir=<span class="hljs-string">"/net/mynfs01.example.com/exports/ovirt-backup"</span>
filename=<span class="hljs-string">"<span class="hljs-variable">$backupdir</span>/`hostname --short`.`date +"</span>%F.%R<span class="hljs-string">"`"</span>
engine-backup --mode=backup --scope=all --file=<span class="hljs-variable">$filename</span>.data --<span class="hljs-built_in">log</span>=<span class="hljs-variable">$filename</span>.<span class="hljs-built_in">log</span>
<span class="hljs-comment">#uncomment next line for autodelete files older 30 days </span>
<span class="hljs-comment">#find $backupdir -type f -mtime +30 -exec rm -f {} \;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir machen die Datei ausführbar:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo chmod a+x /etc/cron.daily/make.oVirt.backup.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt erhalten wir jede Nacht das Archiv mit den Managereinstellungen.</font></font><br>
<br>
<a name="cockpit"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Verwaltungsschnittstelle</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cockpit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine moderne Verwaltungsschnittstelle für Linux-Systeme. </font><font style="vertical-align: inherit;">In diesem Fall spielt es eine Rolle in der Nähe der ESXi-Weboberfläche. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/587/d56/5c8/587d565c8e0250045773c2772b3fb112.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. </font><font style="vertical-align: inherit;">3 - Aussehen des Panels. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es lässt sich sehr einfach installieren, Sie benötigen Cockpit-Pakete und das Cockpit-Ovirt-Dashboard-Plugin:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install cockpit cockpit-ovirt-dashboard -y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cockpit einschalten:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl <span class="hljs-built_in">enable</span> --now cockpit.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Firewall-Setup:</font></font><br>
<br>
<pre><code class="bash hljs">sudo firewall-cmd --add-service=cockpit<font></font>
sudo firewall-cmd --add-service=cockpit --permanent</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können Sie eine Verbindung zum Host herstellen: https: // [Host-IP oder FQDN]: 9090</font></font><br>
<br>
<a name="vlans"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VLANs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weitere Informationen zu Netzwerken finden Sie in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt viele Möglichkeiten, hier beschreiben wir die Verbindung von virtuellen Netzwerken. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um andere Subnetze zu verbinden, müssen diese zuerst in der Konfiguration beschrieben werden: Netzwerk -&gt; Netzwerke -&gt; Neu, hier ist nur der Name ein Pflichtfeld; Das Kontrollkästchen VM-Netzwerk, mit dem Computer dieses Netzwerk verwenden können, ist aktiviert. Um das Tag zu verbinden, aktivieren Sie die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option VLAN-Tagging</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aktivieren </font><font style="vertical-align: inherit;">, geben Sie die VLAN-Nummer ein und klicken Sie auf OK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie nun zu Compute -&gt; Hosts -&gt; kvmNN -&gt; Network Interfaces -&gt; Setup Host Networks Hosts. Ziehen Sie das hinzugefügte Netzwerk von der rechten Seite der nicht zugewiesenen logischen Netzwerke nach links in den zugewiesenen logischen Netzwerken: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/kn/wn/wqknwnvkf13ojuxjidpxuc6s9fq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abb. 4 - bevor Sie ein Netzwerk hinzufügen. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/2j/ei/gc/2jeigcdyhds6kfqqrvs-2gtt4zk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. 5 - nach dem Hinzufügen eines Netzwerks.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um mehrere Netzwerke in großen Mengen mit dem Host zu verbinden, ist es zweckmäßig, ihnen beim Erstellen von Netzwerken eine Bezeichnung zuzuweisen und Netzwerke nach Bezeichnung hinzuzufügen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem das Netzwerk erstellt wurde, werden die Hosts in den Status "Nicht betriebsbereit" versetzt, bis das Netzwerk allen Knoten des Clusters hinzugefügt wird. </font><font style="vertical-align: inherit;">Dieses Verhalten wird durch das Flag Alle erforderlich auf der Registerkarte Cluster beim Erstellen eines neuen Netzwerks verursacht. </font><font style="vertical-align: inherit;">Wenn das Netzwerk nicht auf allen Knoten des Clusters benötigt wird, kann dieses Symptom deaktiviert werden. Wenn das Netzwerk zum Host hinzugefügt wird, befindet es sich rechts im Abschnitt Nicht erforderlich, und Sie können auswählen, ob eine Verbindung zu einem bestimmten Host hergestellt werden soll. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/10/ey/zr10eyeksh3-j_kqd1ezkcgytnw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. </font><font style="vertical-align: inherit;">6 - Auswahl eines Zeichens einer Netzwerkanforderung.</font></font></i><br>
<br>
<a name="hpe"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HPE-spezifisch</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fast alle Hersteller verfügen über Werkzeuge, die die Benutzerfreundlichkeit ihrer Produkte verbessern. </font><font style="vertical-align: inherit;">Anhand des HPE-Beispiels sind AMS (Agentless Management Service, amsd für iLO5, hp-ams für iLO4) und SSA (Smart Storage Administrator, Arbeiten mit einem Festplattencontroller) usw. hilfreich.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbinden Sie das HPE Repository</font></font></b>
                        <div class="spoiler_text">     HPE:<br>
<br>
<pre><code class="bash hljs">$ sudo rpm --import https://downloads.linux.hpe.com/SDR/hpePublicKey2048_key1.pub<font></font>
$ sudo vim /etc/yum.repos.d/mcp.repo</code></pre><br>
 :<br>
<br>
<pre><code class="plaintext hljs">[mcp]<font></font>
name=Management Component Pack<font></font>
baseurl=http://downloads.linux.hpe.com/repo/mcp/centos/$releasever/$basearch/current/<font></font>
enabled=1<font></font>
gpgkey=file:///etc/pki/rpm-gpg/GPG-KEY-mcp<font></font>
<font></font>
[spp]<font></font>
name=Service Pack for ProLiant<font></font>
baseurl=http://downloads.linux.hpe.com/SDR/repo/spp/RHEL/$releasever/$basearch/current/<font></font>
enabled=1<font></font>
gpgkey=file:///etc/pki/rpm-gpg/GPG-KEY-mcp</code></pre><br>
       ():<br>
<br>
<pre><code class="bash hljs">$ sudo yum --disablerepo=<span class="hljs-string">"*"</span> --enablerepo=<span class="hljs-string">"mcp"</span> list available<font></font>
$ yum info amsd</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installation und Start:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install amsd ssacli<font></font>
$ sudo systemctl start amsd</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel für ein Festplattencontroller-Dienstprogramm</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/6_/bh/qw/6_bhqwnjgtqbx7eugqzur06mxxo.png"><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles für jetzt. </font><font style="vertical-align: inherit;">In den folgenden Artikeln möchte ich einige grundlegende Vorgänge und Anwendungen erläutern. </font><font style="vertical-align: inherit;">Zum Beispiel, wie man VDI in oVirt macht.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502156/index.html">Rambler gegen NGINX Fall: Kriminelle Risiken der Digitalisierung Roundtable 16. Mai</a></li>
<li><a href="../de502158/index.html">So organisieren Sie Tests, um Produktfreigaben zu beschleunigen und zu stabilisieren. Teil 2</a></li>
<li><a href="../de502160/index.html">Die Entwicklung von benutzerdefinierten mobilen Apps ist kostengünstig: Realität oder Illusion</a></li>
<li><a href="../de502166/index.html">Ghosts Windows 3.1</a></li>
<li><a href="../de502176/index.html">Los: JSON-Deserialisierung mit falscher Eingabe oder Umgehen von API-Entwicklerfehlern</a></li>
<li><a href="../de502180/index.html">Der Tag, an dem der Umfang verschwand. Sicherheitslösungen von Microsoft und Partnern</a></li>
<li><a href="../de502182/index.html">Nochmals zu MikroTik oder dem lang erwarteten SOCKS5</a></li>
<li><a href="../de502186/index.html">Webinar. Informationssicherheit: SOC in Quarantäne</a></li>
<li><a href="../de502200/index.html">Entropie: Wie Entscheidungsbäume Entscheidungen treffen</a></li>
<li><a href="../de502202/index.html">Die Entwicklung unbemannter Technologie im Schienenverkehr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>