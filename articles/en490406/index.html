<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öìÔ∏è üçë üçó Inexpressibly attractive: how we created a haniot that cannot be exposed üõ°Ô∏è üëï üë©üèø‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antivirus companies, information security experts, and simply enthusiasts put bait systems on the Internet - hanipots to ‚Äúcatch live bait‚Äù of a fresh ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Inexpressibly attractive: how we created a haniot that cannot be exposed</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antivirus companies, information security experts, and simply enthusiasts put bait systems on the Internet - hanipots to ‚Äúcatch live bait‚Äù of a fresh virus or to identify unusual hacker tactics. </font><font style="vertical-align: inherit;">Hanipots are so common that cybercriminals have developed a kind of immunity: they quickly reveal that they have a trap in front of them and simply ignore it. </font><font style="vertical-align: inherit;">To explore the tactics of modern hackers, we created a realistic haniot, which for seven months lived on the Internet, attracting a variety of attacks. </font><font style="vertical-align: inherit;">We described how it was in our study, ‚Äú </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù. </font><font style="vertical-align: inherit;">Some facts from the study are in this post.</font></font></i><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanipot development: checklist</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main task in creating our super trap was to prevent us from being exposed by hackers who showed interest in it. </font><font style="vertical-align: inherit;">To do this, I had to do a lot of work:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create a realistic legend about the company, including the name and photo of employees, phone numbers and e-mails.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To invent and implement a model of industrial infrastructure that corresponds to the legend of our company. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decide which network services will be available outside, but not get involved in opening vulnerable ports so that it does not look like a trap for coots. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organize the appearance of leakage of information about the vulnerable system and disseminate this information among potential attackers.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implement discreet surveillance of hackers in the trap infrastructure. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now, first things first.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating a legend</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cybercriminals are already accustomed to the fact that they encounter a lot of manipulations, so the most advanced part of them conducts an in-depth study of each vulnerable system to make sure that this is not a trap. For the same reason, we strove to achieve not only the realism of the hanipot in terms of design and technical aspects, but also to create the appearance of a real company. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Putting ourselves in the place of a hypothetical kulhaker, we developed a verification algorithm that would distinguish a real system from a trap. It included searching for company IP addresses in reputation systems, reverse researching the history of IP addresses, searching for names and keywords related to the company, as well as its counterparties and many other things. As a result, the legend turned out to be quite convincing and attractive.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We decided to position the trap factory as a small industrial prototyping boutique, working for very large anonymous clients from the military and aviation segment. This eliminated the legal difficulties associated with using an existing brand. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we had to come up with a vision, mission and name of the organization. We decided that our company would be a startup with a small number of employees, each of which is a founder. This added credibility to the legend of the specialization of our business, which allows it to work with delicate projects for large and important customers. We wanted our company to look weak in terms of cybersecurity, but at the same time it was obvious that we were working with important assets in target systems.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot of MeTech Hanipot site. Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We chose the word MeTech as the company name. The site was made on the basis of a free template. Images were taken from photo banks, using the most unpopular and refined to make them less recognizable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We wanted the company to look real, so we had to add employees with professional skills corresponding to the profile of the business. We came up with names and personalities for them, and then tried to select images from photo banks according to their ethnicity. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="image"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot of MeTech Hanipot site. Source: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order not to reveal us, we were looking for good quality group photos from which we could choose the faces we needed. </font><font style="vertical-align: inherit;">However, then we abandoned this option, as a potential cracker could take advantage of reverse image search and find that our ‚Äúemployees‚Äù live in only photo banks. </font><font style="vertical-align: inherit;">In the end, we took advantage of photographs of nonexistent people created using neural networks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The employee profiles published on the site contained important information about their technical skills, but we avoided the instructions of specific educational institutions and cities. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create mailboxes, we used the server of the hosting provider, and then rented several phone numbers in the USA and combined them into a virtual telephone exchange with a voice menu and an answering machine.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanipot Infrastructure</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To avoid being exposed, we decided to use a combination of real industrial equipment, physical computers, and secure virtual machines. </font><font style="vertical-align: inherit;">Looking ahead, we say that we checked the result of our efforts using the Shodan search engine, and he showed that the hanipot looks like a real industrial system. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result of scanning a hanipot using Shodan. </font><font style="vertical-align: inherit;">Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We used four PLCs as the hardware for our trap:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">two AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These PLCs were selected for their popularity in the global market for control systems. </font><font style="vertical-align: inherit;">And each of these controllers uses its own protocol, which allows us to check which of the PLCs will attack more often and whether they will interest anyone in principle. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The equipment of our "factory" trap. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We did not just put pieces of iron and connected them to the Internet. </font><font style="vertical-align: inherit;">We programmed each controller to perform tasks, among which were</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mixing</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">burner and conveyor belt control,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">palletizing using a robotic arm.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And to make the production process realistic, we programmed the logic to randomly change feedback parameters, simulate starting and stopping engines, turning the burner on and off. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our factory had three virtual computers and one physical. The virtual machines were used to control the plant, the palletizing robot, and as the automated workplace of the PLC software engineer. The physical computer worked as a file server.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to monitoring attacks on the PLC, we wanted to monitor the status of programs downloaded to our devices. To do this, we created an interface that allowed us to quickly determine how the states of our virtual actuators and installations were modified. Already at the planning stage, we found that it is much easier to implement this with the help of a control program than through direct programming of the controller logic. We opened access to the device management interface of our hanipot via VNC without a password.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Industrial robots are a key component of modern smart manufacturing. In this regard, we decided to add a robot and AWP to control it in the equipment of our factory-trap. To make the "factory" more realistic, we installed real software on the AWP control, which engineers use to graphically program the robot logic. Well, since industrial robots are usually located in an isolated internal network, we decided to leave unprotected VNC access only to the workstation management. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RobotStudio environment with a 3D model of our robot. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On a virtual machine with a robot control workstation, we installed the RobotStudio programming environment from ABB Robotics. </font><font style="vertical-align: inherit;">Having set up RobotStudio, we opened in it a simulation file with our robot so that its 3D image was visible on the screen. </font><font style="vertical-align: inherit;">As a result, Shodan and other search engines, having discovered an unprotected VNC server, will receive this image from the screen and show it to those who are looking for industrial robots with open access to control. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The meaning of such attention to detail was to create an attractive and most realistic goal for attackers who, having discovered it, would return to it again and again.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWP Engineer</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To program the PLC logic, we added an engineering computer to the infrastructure. </font><font style="vertical-align: inherit;">Industrial software for PLC programming was installed on it:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIA Portal for Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix for Allen-Bradley controller,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One for Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We decided that the engineering workstation would not be accessible outside the network. </font><font style="vertical-align: inherit;">Instead, we set the same password for the administrator account on it as on the workstations of the robot control and workstations of the factory accessible from the Internet. </font><font style="vertical-align: inherit;">This configuration is quite common in many companies. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, in spite of all our efforts, not a single attacker reached the engineer‚Äôs AWP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File server</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We needed it as a decoy for intruders and as a means of backing up our own ‚Äúwork‚Äù in a trap factory. This allowed us to share files with our haniot using USB devices, without leaving traces in the network trap. As the OS for the file server, we installed Windows 7 Pro, in which we made a shared folder accessible for reading and writing to anyone. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first, we did not make any hierarchy of folders and documents on the file server. However, then it turned out that the attackers were actively studying this folder, so we decided to fill it with various files. To do this, we wrote a python script that created a file of random size with one of the specified extensions, forming a name based on the dictionary. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A script for generating attractive file names. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After running the script, we got the desired result in the form of a folder filled with files with very interesting names. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result of the script. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoring environment</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having spent so much effort on creating a realistic company, we simply could not afford to inject ourselves into the environment for monitoring our ‚Äúvisitors‚Äù. We had to get all the data in real time so that the attackers did not notice that they were being watched. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We implemented this using four USB-Ethernet adapters, four SharkTap Ethernet-couplers, Raspberry Pi 3 and a large external drive. The scheme of our network looked like this: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scheme of a hanipot network with monitoring equipment. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We arranged three SharkTap taps to monitor all external traffic to PLCs that are accessible only from the internal network. The fourth SharkTap tracked the traffic of guests of the vulnerable virtual machine.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharkTap Ethernet coupler and Sierra Wireless AirLink RV50 Router. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi carried out daily capture of traffic. </font><font style="vertical-align: inherit;">We established an Internet connection using the Sierra Wireless AirLink RV50 cellular router, often used in industrial enterprises. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, this router did not allow selective blocking of attacks that did not meet our plans, so we added the Cisco ASA 5505 firewall in a transparent mode to the network to perform blocking with minimal impact on the network.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traffic analysis</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark and tcpdump are appropriate for quickly resolving current issues, but in our case their capabilities were not enough, since we had a lot of gigabytes of traffic, which were analyzed by several people. </font><font style="vertical-align: inherit;">We used the open-source analyzer Moloch developed by AOL. </font><font style="vertical-align: inherit;">In terms of functionality, it is comparable to Wireshark, but it has more features for collaboration, description and tagging of packages, export and other tasks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since we did not want to process the collected data on the hanipot computers, PCAP dumps were exported every day to the AWS repository, from where we already imported them to the machine with Moloch.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screen recording </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To document the actions of crackers in our hanipot, we wrote a script that took screenshots of the virtual machine at a given interval and, comparing with the previous screenshot, determined whether something was happening there or not. </font><font style="vertical-align: inherit;">When activity was detected, the script included a screen recording. </font><font style="vertical-align: inherit;">This approach has proven to be the most effective. </font><font style="vertical-align: inherit;">We also tried to analyze the VNC traffic from the PCAP dump in order to understand what changes occurred in the system, but in the end, the screen recording we implemented turned out to be simpler and more visual.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoring VNC Sessions</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For this, we used Chaosreader and VNCLogger. </font><font style="vertical-align: inherit;">Both utilities extract keystrokes from the PCAP dump, but VNCLogger handles keys like Backspace, Enter, Ctrl more correctly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger has two drawbacks. </font><font style="vertical-align: inherit;">First: it can only extract keys by ‚Äúlistening‚Äù to traffic on the interface, so we had to simulate a VNC session for it using tcpreplay. </font><font style="vertical-align: inherit;">The second drawback of VNCLogger is common with Chaosreader: they both do not show the contents of the clipboard. </font><font style="vertical-align: inherit;">To do this, I had to use Wireshark.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lure hackers</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We created a hanipot to be attacked. </font><font style="vertical-align: inherit;">To achieve this, we staged an information leak designed to attract the attention of potential crackers. </font><font style="vertical-align: inherit;">The following ports were opened on the hanipot: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="image"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The RDP port had to be closed shortly after the start of work, because due to the huge amount of scanning traffic in our network, there were performance problems. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNC-terminals first worked in the "view only" mode without a password, and then we "mistakenly" switched them to full access mode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To attract the attackers, we posted two posts with leaked information about the available industrial system on PasteBin. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One of the posts posted on PasteBin to attract attacks. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attacks</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Hanipot lived online for about seven months. The first attack occurred a month after the release of the Hanipot online. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
There was a lot of traffic from scanners from well-known companies - ip-ip, Rapid, Shadow Server, Shodan, ZoomEye and others. There were so many of them that we had to exclude their IP addresses from analysis: 610 out of 9452 or 6.45% of all unique IP addresses belonged to completely legitimate scanners. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fraudsters</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
One of the biggest risks we had to face was the use of our system for criminal purposes: to buy smartphones through a subscriber‚Äôs account, cash out airline miles with gift cards and other types of fraud </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Miners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the first visitors to our system turned out to be a miner. He uploaded Monero mining software to it. He would not have been able to earn much on our specific system due to low productivity. However, if we combine the efforts of several tens or even hundreds of such systems, it could turn out quite well. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extortionists</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the operation of the hanipot, we twice encountered real ransomware viruses. In the first case, it was Crysis. Its operators logged on to the system through VNC, but then installed TeamViewer and already performed further actions with it. After waiting for a ransomware message demanding a ransom of $ 10,000 in BTC, we entered into correspondence with the criminals, asking them to decrypt one of the files for us. They fulfilled the request and repeated the ransom demand. We managed to bargain up to 6 thousand dollars, after which we simply reloaded the system on a virtual machine, because we got all the necessary information. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second ransomware was Phobos. The hacker who installed it for an hour looked through the file system of the hanipot and scanned the network, and then still installed the ransomware.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The third ransomware attack turned out to be fake. </font><font style="vertical-align: inherit;">An unknown "hacker" downloaded the haha.bat file to our system, after which we watched for some time how he was trying to make it work. </font><font style="vertical-align: inherit;">One attempt was to rename haha.bat to haha.rnsmwr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúHacker" increases the harmfulness of the bat-file, changing its extension to .rnsmwr. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
When the batch file finally started to run, the hacker edited it, increasing the ransom from $ 200 to $ 750. </font><font style="vertical-align: inherit;">After that, he ‚Äúencrypted‚Äù all the files, left a ransomware message on the desktop and disappeared, changing the passwords on our VNC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After a couple of days, the hacker returned and to remind himself, he launched a batch file, which opened many windows with a porn site. </font><font style="vertical-align: inherit;">Apparently, in this way he tried to draw attention to his demand.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the study, it turned out that as soon as information about the vulnerability was published, the hanipot attracted attention, and the activity grew day by day. In order for the trap to attract attention, we had to admit many security breaches of our fictional company. Unfortunately, this situation is far from rare among many real companies that do not have full-time IT and information security personnel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the general case, organizations should use the principle of least privilege, while we have implemented the exact opposite to attract intruders. And the longer we watched the attacks, the more sophisticated they became compared to standard penetration testing methods.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And most importantly: all these attacks would fail if adequate security measures were implemented when setting up the network. </font><font style="vertical-align: inherit;">Organizations must ensure that their equipment and industrial infrastructure components are not accessible from the Internet, as we specifically did in our trap. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although we did not record a single attack on the engineer‚Äôs workstation, despite using the same local administrator password on all computers, we should avoid this practice in order to minimize the possibility of intruders. </font><font style="vertical-align: inherit;">Indeed, poor security serves as an additional invitation to attack industrial systems that have long been of interest to cybercriminals.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490392/index.html">Catchain: TON Blockchain Consensus Algorithm</a></li>
<li><a href="../en490394/index.html">Commodore Amiga 500+: let no one go offended</a></li>
<li><a href="../en490398/index.html">Red Hogwarts. Officers, or Why a historian is like a detective</a></li>
<li><a href="../en490400/index.html">Using the OpenCV library to recognize elliptical arcs in 2D sections of 3D point clouds</a></li>
<li><a href="../en490404/index.html">Why and how 5G will change everything: technology, phased implementation and element base for subscriber equipment</a></li>
<li><a href="../en490408/index.html">FreeBSD: –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ GNU/Linux</a></li>
<li><a href="../en490410/index.html">Live and artificial neurons connected via the Internet</a></li>
<li><a href="../en490412/index.html">Maybe we should calm down a bit with JavaScript?</a></li>
<li><a href="../en490416/index.html">Computer Science Club Lecture Video</a></li>
<li><a href="../en490418/index.html">Millennials and Generation Alpha VS Higher Education</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>