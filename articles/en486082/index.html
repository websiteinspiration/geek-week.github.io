<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóúÔ∏è üëãüèø ü§öüèº Dagaz: The Sum of Technology ü§∞üèΩ üö£üèΩ üôéüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, technologies are of interest to me, so to speak, out of necessity: because every civilization includes both that which society aspired to and that...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dagaz: The Sum of Technology</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486082/"><img align="left" src="https://habrastorage.org/webt/it/hf/a5/ithfa5igeohyiayejgri7s5tcey.png"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;So, technologies are of interest to me, so to speak, out of necessity: because every civilization includes both that which society aspired to and that which no one intended. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sometimes, and quite often, the path of technology was opened by chance: once they searched for a philosopher's stone, but found porcelain.</font></font></i>&nbsp;<br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Stanislav Lem.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
From the very beginning of the</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it was clear that a high-quality AI is vital for me! It‚Äôs boring to play with yourself, but the module for playing on the network - it is not known when it will be. I tried to write bots myself, but they all worked either badly or badly and slowly. In the end, I was tired of doing this amateur activity and found a chess</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the quality of the game which completely suited me. </font><font style="vertical-align: inherit;">But there was a problem. </font><font style="vertical-align: inherit;">I needed not only Chess. </font><font style="vertical-align: inherit;">This article is devoted to how I struggled with this.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you look at the source code of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Garbochess-JS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (by the way, on the </font></font><abbr title="A picture to attract attention"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KDPV</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> photo of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Greta Garbo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the famous actress, after whom the project got its name), you can notice that the beauty of the source code is the last of what interested its author. </font><font style="vertical-align: inherit;">The text contains global variables and other cute little things, conscientiously ported from the original </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">draft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For me, the biggest problem was that the algorithm itself is in no way separated from exclusively chess specifics, such as position estimation, heuristics, etc. </font><font style="vertical-align: inherit;">For this reason alone, the code had to be completely rewritten. </font><font style="vertical-align: inherit;">It was a lot of work (and it is still ongoing), but today there are already some successes that I can share.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-b/pu/a_/-bpua_octpkv3-rkwy4eebl1azg.png"></div></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A little bit about performance</font></font></b><div class="spoiler_text">       .    ,   ,      ,      .       ,    ,     .         .<br>
<br>
     ,          (,         ).  ,   ¬´¬ª,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> url</a>,     ,     .        . <br>
<br>
    .    .  .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may notice that although this game (which was invented by Robert Price in 2001) is similar to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chess</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the original Garbochess could hardly cope with it. This is a good illustration of the task that stood before me. I should separate </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algorithm for</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> finding the best course, with all </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that is specific to particular games. In order to be able to use it in different games, of course. Why else? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, I started with something much less complicated (but already at this stage the first difficulties arose). Pawns here move according to the usual rules (but without jumping the first move and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taking on the aisle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Transforming any shape completes the game. The inability to move means defeat.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/un/qg/pi/unqgpi7ygj24c3l50atyultko9e.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Difficulties, of course, arose due to the fact that Garbochess is aimed exclusively at chess. When the king is under the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stalemate</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the process of finding a move ends naturally. It remains only to check under the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shah</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> whether the king, to determine the outcome of the game is complete. In the "Pawn War" there is another conclusion related to the transformation of one of the pieces.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The bot, in these cases, cheerfully continued to search through the options, despite the fact that the game had already ended. </font><font style="vertical-align: inherit;">I quite easily defeated this by banning the further generation of moves after reaching the goal of the game. </font><font style="vertical-align: inherit;">Another difference was that the lack of opportunity to move in this game is always a defeat. </font><font style="vertical-align: inherit;">There are simply no kings in the game, there is no need to check whether they are under the check. </font><font style="vertical-align: inherit;">We managed to cope with it even easier. </font><font style="vertical-align: inherit;">Next in line were large forms.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/b0/ud/oo/b0udoorjf5ejijatjq6y5qkee8w.png"></div></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is worth making a small theoretical digression</font></font></b><div class="spoiler_text">    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Garbochess</a>.       "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">--</a>".    ,    ‚Äî    ,    ,      .   ,       ,  . <br>
<br>
     ,    ,    ,     ,  ,  ,     .    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> </a>.    ,       ,   .<br>
<br>
 ,            ( , )   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> </a>.           -  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">-</a>   !   ,   Garbochess  .  -       !<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this point, performance problems started. The fact is that you can‚Äôt just go down to a certain level and evaluate the position there! It may happen, for example, that we end the search by taking the queen with the pawn, not paying attention to the fact that the queen can be taken with the next move, with far from the best outcome for us. Before evaluating something, it is necessary to ‚Äúlose‚Äù to the end all forced moves, which include any captures, as well as any moves in situations where the king is under the check.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That was the problem. </font><font style="vertical-align: inherit;">The fact is that all checks for the allotted time were performed in that part of the code that was about "alpha-beta clipping", and not that of replay. </font><font style="vertical-align: inherit;">There are games in which such an after-game is capable of taking monstrously branched forms. </font><font style="vertical-align: inherit;">There the program execution was dying. </font><font style="vertical-align: inherit;">At the same time, it was impossible to simply add a time check to ‚Äúplay out‚Äù, because as a result, everything would end there, possibly before reaching really good moves. </font><font style="vertical-align: inherit;">I had to somehow limit this matter (with a loss in the quality of the game, of course).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another reason for the freezes was that my model was very slow</font></font></b><div class="spoiler_text">  , ,    ,  Garbochess.  ,    ,     !      ,     JavaScript      ,   ,     .<br>
<br>
<div class="spoiler"><b class="spoiler_title"> ,    - </b><div class="spoiler_text"><pre><code class="javascript hljs">Dagaz.Model.BuildDesign = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">design</span>) </span>{<font></font>
    design.addDirection(<span class="hljs-string">"w"</span>);  <span class="hljs-comment">// 0</span>
    design.addDirection(<span class="hljs-string">"e"</span>);  <span class="hljs-comment">// 1</span>
    design.addDirection(<span class="hljs-string">"s"</span>);  <span class="hljs-comment">// 2</span>
    design.addDirection(<span class="hljs-string">"ne"</span>); <span class="hljs-comment">// 3</span>
    design.addDirection(<span class="hljs-string">"n"</span>);  <span class="hljs-comment">// 4</span>
    design.addDirection(<span class="hljs-string">"se"</span>); <span class="hljs-comment">// 5</span>
    design.addDirection(<span class="hljs-string">"sw"</span>); <span class="hljs-comment">// 6</span>
    design.addDirection(<span class="hljs-string">"nw"</span>); <span class="hljs-comment">// 7</span><font></font>
<font></font>
    design.addPlayer(<span class="hljs-string">"White"</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]);<font></font>
    design.addPlayer(<span class="hljs-string">"Black"</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>]);<font></font>
<font></font>
    design.addPosition(<span class="hljs-string">"a8"</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]);<font></font>
    ...<font></font>
    design.addPosition(<span class="hljs-string">"h1"</span>, [<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-9</span>]);<font></font>
    ...<font></font>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">24</span>);	<span class="hljs-comment">// from</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.PARAM,	<span class="hljs-number">0</span>);	<span class="hljs-comment">// $1</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">22</span>);	<span class="hljs-comment">// navigate</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">1</span>);	<span class="hljs-comment">// empty?</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">20</span>);	<span class="hljs-comment">// verify</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.IN_ZONE,	<span class="hljs-number">0</span>);	<span class="hljs-comment">// last-rank</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">0</span>);	<span class="hljs-comment">// not</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.IF,	<span class="hljs-number">4</span>);<font></font>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.PROMOTE,	<span class="hljs-number">4</span>);	<span class="hljs-comment">// Queen</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">25</span>);	<span class="hljs-comment">// to</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.JUMP,	<span class="hljs-number">2</span>);<font></font>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">25</span>);	<span class="hljs-comment">// to</span>
    design.addCommand(<span class="hljs-number">0</span>, ZRF.FUNCTION,	<span class="hljs-number">28</span>);	<span class="hljs-comment">// end</span><font></font>
<font></font>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">24</span>);	<span class="hljs-comment">// from</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.PARAM,	<span class="hljs-number">0</span>);	<span class="hljs-comment">// $1</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">22</span>);	<span class="hljs-comment">// navigate</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">1</span>);	<span class="hljs-comment">// empty?</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">20</span>);	<span class="hljs-comment">// verify</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.IN_ZONE,	<span class="hljs-number">1</span>);	<span class="hljs-comment">// third-rank</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">20</span>);	<span class="hljs-comment">// verify</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.PARAM,	<span class="hljs-number">1</span>);	<span class="hljs-comment">// $2</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">22</span>);	<span class="hljs-comment">// navigate</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">1</span>);	<span class="hljs-comment">// empty?</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">20</span>);	<span class="hljs-comment">// verify</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">25</span>);	<span class="hljs-comment">// to</span>
    design.addCommand(<span class="hljs-number">1</span>, ZRF.FUNCTION,	<span class="hljs-number">28</span>);	<span class="hljs-comment">// end</span><font></font>
    ...<font></font>
    design.addPiece(<span class="hljs-string">"Pawn"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">800</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, [<span class="hljs-number">4</span>], <span class="hljs-number">1</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">4</span>], <span class="hljs-number">1</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">7</span>], <span class="hljs-number">1</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>], <span class="hljs-number">1</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>], <span class="hljs-number">1</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>], <span class="hljs-number">1</span>);<font></font>
    ...<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Pawn"</span>, <span class="hljs-number">48</span>);<font></font>
    ...<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"King"</span>, <span class="hljs-number">4</span>);<font></font>
}<font></font>
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">     </b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">var</span> step = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; !ctx.isFriend()) {<font></font>
        ctx.end();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> pawnShift = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; ctx.isEmpty()) {
        <span class="hljs-keyword">if</span> (ctx.inZone(<span class="hljs-number">0</span>)) {<font></font>
            ctx.promote(<span class="hljs-number">4</span>);<font></font>
        }    <font></font>
        ctx.end();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> pawnLeap = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; ctx.isEnemy()) {
        <span class="hljs-keyword">if</span> (ctx.inZone(<span class="hljs-number">0</span>)) {<font></font>
            ctx.promote(<span class="hljs-number">4</span>);<font></font>
        }    <font></font>
        ctx.end();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> pawnJump = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; <font></font>
        ctx.isEmpty() &amp;&amp; <font></font>
        ctx.inZone(<span class="hljs-number">1</span>) &amp;&amp; <font></font>
        ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; <font></font>
        ctx.isEmpty()) {<font></font>
        ctx.end();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> enPassant = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
        ctx.isEnemy() &amp;&amp;<font></font>
        ctx.isPiece(<span class="hljs-number">0</span>)) {<font></font>
        ctx.capture();<font></font>
        <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">1</span>)) {<font></font>
            ctx.put();<font></font>
            <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">1</span>) &amp;&amp;<font></font>
                ctx.isLastFrom()) {<font></font>
                ctx.end();<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> jump = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp; <font></font>
        ctx.go(params, <span class="hljs-number">1</span>) &amp;&amp; <font></font>
       !ctx.isFriend()) {<font></font>
        ctx.end();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> slide = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">while</span> (ctx.go(params, <span class="hljs-number">0</span>)) {
        <span class="hljs-keyword">if</span> (ctx.isFriend()) <span class="hljs-keyword">break</span>;<font></font>
        ctx.end();<font></font>
        <span class="hljs-keyword">if</span> (!ctx.isEmpty()) <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> O_O = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
        ctx.isEmpty() &amp;&amp;<font></font>
        ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
        ctx.isEmpty()) {<font></font>
        ctx.put();<font></font>
        <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
            ctx.isFriend() &amp;&amp;<font></font>
            ctx.isPiece(<span class="hljs-number">1</span>)) {<font></font>
            ctx.take();<font></font>
            <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">1</span>) &amp;&amp;<font></font>
                ctx.go(params, <span class="hljs-number">1</span>)) {<font></font>
                ctx.end();<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> O_O_O = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ctx, params</span>) </span>{
    <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
        ctx.isEmpty() &amp;&amp;<font></font>
        ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
        ctx.isEmpty()) {<font></font>
        ctx.put();<font></font>
        <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
            ctx.isEmpty() &amp;&amp;<font></font>
            ctx.go(params, <span class="hljs-number">0</span>) &amp;&amp;<font></font>
            ctx.isFriend() &amp;&amp;<font></font>
            ctx.isPiece(<span class="hljs-number">1</span>)) {<font></font>
            ctx.take();<font></font>
            <span class="hljs-keyword">if</span> (ctx.go(params, <span class="hljs-number">1</span>) &amp;&amp;<font></font>
                ctx.go(params, <span class="hljs-number">1</span>) &amp;&amp;<font></font>
                ctx.go(params, <span class="hljs-number">1</span>)) {<font></font>
                ctx.end();<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
games.model.BuildDesign = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">design</span>) </span>{<font></font>
    design.addDirection(<span class="hljs-string">"w"</span>);  <span class="hljs-comment">// 0</span>
    design.addDirection(<span class="hljs-string">"e"</span>);  <span class="hljs-comment">// 1</span>
    design.addDirection(<span class="hljs-string">"s"</span>);  <span class="hljs-comment">// 2</span>
    design.addDirection(<span class="hljs-string">"ne"</span>); <span class="hljs-comment">// 3</span>
    design.addDirection(<span class="hljs-string">"n"</span>);  <span class="hljs-comment">// 4</span>
    design.addDirection(<span class="hljs-string">"se"</span>); <span class="hljs-comment">// 5</span>
    design.addDirection(<span class="hljs-string">"sw"</span>); <span class="hljs-comment">// 6</span>
    design.addDirection(<span class="hljs-string">"nw"</span>); <span class="hljs-comment">// 7</span><font></font>
<font></font>
    design.addPlayer(<span class="hljs-string">"White"</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]);<font></font>
    design.addPlayer(<span class="hljs-string">"Black"</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>]);<font></font>
<font></font>
    design.addPosition(<span class="hljs-string">"a8"</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]);<font></font>
    ...<font></font>
    design.addPosition(<span class="hljs-string">"h1"</span>, [<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-9</span>]);<font></font>
    ...<font></font>
    design.addPiece(<span class="hljs-string">"Pawn"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, pawnShift, [<span class="hljs-number">4</span>], <span class="hljs-number">0</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, pawnJump, [<span class="hljs-number">4</span>], <span class="hljs-number">0</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, pawnLeap, [<span class="hljs-number">7</span>], <span class="hljs-number">0</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, pawnLeap, [<span class="hljs-number">3</span>], <span class="hljs-number">0</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, enPassant, [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>], <span class="hljs-number">0</span>);<font></font>
    design.addMove(<span class="hljs-number">0</span>, enPassant, [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>], <span class="hljs-number">0</span>);<font></font>
    ...<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Pawn"</span>, [<span class="hljs-string">"a2"</span>, <span class="hljs-string">"b2"</span>, <span class="hljs-string">"c2"</span>, <span class="hljs-string">"d2"</span>, <span class="hljs-string">"e2"</span>, <span class="hljs-string">"f2"</span>, <span class="hljs-string">"g2"</span>, <span class="hljs-string">"h2"</span>]);<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Rook"</span>, [<span class="hljs-string">"a1"</span>, <span class="hljs-string">"h1"</span>]);<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Knight"</span>, [<span class="hljs-string">"b1"</span>, <span class="hljs-string">"g1"</span>]);<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Bishop"</span>, [<span class="hljs-string">"c1"</span>, <span class="hljs-string">"f1"</span>]);<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"Queen"</span>, [<span class="hljs-string">"d1"</span>]);<font></font>
    design.setup(<span class="hljs-string">"White"</span>, <span class="hljs-string">"King"</span>, [<span class="hljs-string">"e1"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"Pawn"</span>, [<span class="hljs-string">"a7"</span>, <span class="hljs-string">"b7"</span>, <span class="hljs-string">"c7"</span>, <span class="hljs-string">"d7"</span>, <span class="hljs-string">"e7"</span>, <span class="hljs-string">"f7"</span>, <span class="hljs-string">"g7"</span>, <span class="hljs-string">"h7"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"Rook"</span>, [<span class="hljs-string">"a8"</span>, <span class="hljs-string">"h8"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"Knight"</span>, [<span class="hljs-string">"b8"</span>, <span class="hljs-string">"g8"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"Bishop"</span>, [<span class="hljs-string">"c8"</span>, <span class="hljs-string">"f8"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"Queen"</span>, [<span class="hljs-string">"d8"</span>]);<font></font>
    design.setup(<span class="hljs-string">"Black"</span>, <span class="hljs-string">"King"</span>, [<span class="hljs-string">"e8"</span>]);<font></font>
}<font></font>
</code></pre></div></div><br>
,     !  ,    ,    .  ,    ,     .   , ,    .   !<br>
<br>
        ,         .    128 .   ,  ,      .     ,     .  ,       (,     ,        ).<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is worth noting that the issue of performance is not always an acute issue. </font><font style="vertical-align: inherit;">There are games that are objectively difficult for people to play. </font><font style="vertical-align: inherit;">The use of algorithms in such games that do not miss a single opportunity leads to completely killer results:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/pr/fd/3cprfdtb6poyqttqgk9biipojxe.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We take all the balls in one of the two holes on our side and sow one at a time in the following holes, counterclockwise. </font><font style="vertical-align: inherit;">Who first ran out of all the balls - he lost. </font><font style="vertical-align: inherit;">The irony is that if the first player does everything right - he (in most cases) wins. </font><font style="vertical-align: inherit;">In terms of computing, this is a very simple game, but it‚Äôs difficult for a person to play it. </font><font style="vertical-align: inherit;">Less extreme examples can be given:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cu/wr/xo/cuwrxolrdcdbvvqgcwsns_lbffe.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> even more interesting! </font><font style="vertical-align: inherit;">However, in this game, a person already quite easily wins. </font><font style="vertical-align: inherit;">If he knows the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rules</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and doesn't yawn, of course. </font><font style="vertical-align: inherit;">In general, in the chess world, there are quite a few different mini-games. </font><font style="vertical-align: inherit;">And with them the current implementation of the bot is already quite coping.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The new bot also has disadvantages, of course</font></font></b><div class="spoiler_text">,    ,   .       (  )         .  , .     ,        .           .       - .<br>
<br>
,     ! --   ,         .    ,         ,   . ,       . <br>
<br>
 ,       . ,    ,      (,   ).   ,   ,      (   ‚Äî     ).   ¬´¬ª    "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> </a>" (       ,    ).   ,   .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But, in general, I am quite pleased with the (intermediate) results. </font><font style="vertical-align: inherit;">There is still work to do. </font><font style="vertical-align: inherit;">So far, I have connected far from all Garbochess optimizations. </font><font style="vertical-align: inherit;">And the question </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of position evaluation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a topic for a separate big conversation. </font><font style="vertical-align: inherit;">All these are the fruits of the long collective work of many, many smart people. </font><font style="vertical-align: inherit;">I am very grateful to all of them for this work. </font><font style="vertical-align: inherit;">I myself would not have thought of much of all this.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/en486082/">https://habr.com/ru/post/en486082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486066/index.html">In the access area. Find the distance from a point to an area and reduce reverse geocoding requests</a></li>
<li><a href="../en486070/index.html">ACL switches in detail</a></li>
<li><a href="../en486072/index.html">SQL HowTo: write a while-loop directly in the query, or "Elementary three-way"</a></li>
<li><a href="../en486076/index.html">From Ground to FPV Quadcopter: Introduction</a></li>
<li><a href="../en486080/index.html">Let me introduce: Veeam Availability Suite v10</a></li>
<li><a href="../en486084/index.html">Replacing smaller disks with larger disks in Linux</a></li>
<li><a href="../en486092/index.html">Marina Alex, CEO of University of Business Agility: ‚ÄúAgile is out of IT. Agile - More Than IT ‚Äù</a></li>
<li><a href="../en486094/index.html">House Democrat Fights Silicon Valley</a></li>
<li><a href="../en486098/index.html">How tech debt kills your projects</a></li>
<li><a href="../en486100/index.html">How to create a decentralized application that scales? Use less blockchain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>