<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüëß üå®Ô∏è ü§ù Caract√©ristiques de l'assemblage et de la livraison d'applications iOS üßñüèº üíß üåà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, Maxim Shestakov, ing√©nieur DevOps au studio Plarium Krasnodar, partage son exp√©rience dans la cr√©ation et la livraison d'application...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Caract√©ristiques de l'assemblage et de la livraison d'applications iOS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plarium/blog/490698/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet article, Maxim Shestakov, ing√©nieur DevOps au studio Plarium Krasnodar, partage son exp√©rience dans la cr√©ation et la livraison d'applications iOS aux utilisateurs qui se sont accumul√©es pendant le d√©bogage CI / CD.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/eq/j8/lseqj8pl9g9h1yrdm-h-ekpzuno.jpeg"><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entra√Ænement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout le monde connect√© au d√©veloppement d'applications pour les appareils Apple a d√©j√† r√©ussi √† appr√©cier la convivialit√© controvers√©e de l'infrastructure. </font><font style="vertical-align: inherit;">Les difficult√©s sont partout: du menu du profil d√©veloppeur aux outils de d√©bogage et d'assemblage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a beaucoup d'articles sur les bases sur le net, nous allons donc essayer de mettre en √©vidence l'essentiel. </font><font style="vertical-align: inherit;">Voici ce dont vous avez besoin pour cr√©er avec succ√®s l'application:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compte d√©veloppeur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√©riph√©rique bas√© sur macOS agissant comme un serveur de g√©n√©ration;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certificat de d√©veloppeur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> g√©n√©r√© </font><font style="vertical-align: inherit;">, qui sera ensuite utilis√© pour signer l'application;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application cr√©√©e avec un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unique </font><font style="vertical-align: inherit;">(l'importance de l'identifiant de bundle doit √™tre not√©e, car l'utilisation de l'ID g√©n√©rique rend impossible l'utilisation de nombreuses fonctions de l'application, par exemple: domaines associ√©s, notifications push, connexion Apple et autres);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">profil de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signature d'application.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le certificat de d√©veloppeur doit √™tre g√©n√©r√© via le trousseau sur n'importe quel appareil macOS. </font><font style="vertical-align: inherit;">Le type de certificat est tr√®s important. </font><font style="vertical-align: inherit;">Selon l'environnement d'application (Dev, QA, Staging, Production), il sera diff√©rent (D√©veloppement ou Distribution), ainsi que le type de profil de signature d'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les principaux types de profils:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppement - con√ßu pour signer la demande de l'√©quipe de d√©veloppement, en utilisant le certificat de d√©veloppement (nom du formulaire iPhone Developer: XXXXX);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ad Hoc - con√ßu pour la signature d'une application de test et la v√©rification interne par le service AQ, le certificat de distribution du d√©veloppeur est utilis√© (nom du type de distribution iPhone: XXXXX);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">App Store - version de publication pour les tests externes via TestFlight et t√©l√©chargement sur l'App Store, en utilisant le certificat de distribution du d√©veloppeur.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la g√©n√©ration de profils de d√©veloppement et ad hoc, une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste des appareils</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur lesquels vous pouvez installer la build est </font><font style="vertical-align: inherit;">√©galement indiqu√©e </font><font style="vertical-align: inherit;">, ce qui vous permet de restreindre davantage l'acc√®s pour les utilisateurs. </font><font style="vertical-align: inherit;">Le profil de l'App Store n'a pas de liste d'appareils, car TestFlight est responsable du contr√¥le d'acc√®s pendant les tests b√™ta ferm√©s, qui seront discut√©s plus tard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour plus de clart√©, vous pouvez pr√©senter le profil de d√©veloppeur sous la forme d'une tablette ci-dessous. </font><font style="vertical-align: inherit;">Il est plus facile de comprendre les param√®tres dont nous avons besoin pour l'assemblage et o√π les obtenir.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qd/dt/u9/qddtu9hfklorm9kmotcctpr-hoc.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembl√©e</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour faciliter la s√©paration des assemblys par projet et environnement, nous utilisons les noms des profils de vue </font></font><code>${ProjectName}_${Instance}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-√†-dire le nom du projet + l'instance (d√©pend de l'environnement d'application: Dev, QA, GD, Staging, Live, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'importation sur un serveur de build, le profil change son nom en un ID unique et se d√©place vers le dossier </font></font><code>/Users/$Username/Library/MobileDevice/Provisioning Profiles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(o√π il </font></font><code>$Username</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correspond au nom du compte d'utilisateur du serveur de build). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux fa√ßons de cr√©er le fichier * .ipa - obsol√®te (PackageApplication) et moderne (en cr√©ant XcAchive et en exportant). </font><font style="vertical-align: inherit;">La premi√®re m√©thode est consid√©r√©e comme obsol√®te, car √† partir de la version 8.3, le module d'empaquetage de fichiers d'application a √©t√© supprim√© de la distribution Xcode. </font><font style="vertical-align: inherit;">Pour l'utiliser, vous devez copier le module de l'ancien Xcode (version 8.2 et ant√©rieure) dans le dossier: </font></font><br>
<code>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/ </code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis ex√©cutez la commande:</font></font><br>
<br>
<pre><code class="bash hljs">chmod +x /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/*</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez collecter le fichier * .app de l'application:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-workspace <span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName</span>.xcworkspace \<font></font>
-scheme <span class="hljs-variable">$SchemeName</span> \<font></font>
-sdk iphoneos \<font></font>
build \<font></font>
-configuration Release \<font></font>
-derivedDataPath build \<font></font>
CODE_SIGN_IDENTITY=‚Äù<span class="hljs-variable">$DevAccName</span>‚Äù\<font></font>
PROVISIONING_PROFILE=‚Äù<span class="hljs-variable">$ProfileId</span>‚Äù<font></font>
DEPLOYMENT_POSTPROCESSING=YES \<font></font>
SKIP_INSTALL=YES \<font></font>
ENABLE_BITCODE=NO<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O√π: </font></font><br>
<br>
<code>-workspace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- chemin d'acc√®s au fichier de projet. </font></font><br>
<br>
<code>-scheme</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- circuit utilis√© sp√©cifi√© dans le projet. </font></font><br>
<br>
<code>-derivedDataPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- le chemin pour d√©charger l'application assembl√©e (* .app). </font></font><br>
<br>
<code>CODE_SIGN_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- le nom du compte d√©veloppeur qui peut √™tre v√©rifi√© dans le trousseau (d√©veloppeur iPhone: XXXX XXXXXXX, sans TeamID entre parenth√®ses). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pm/lk/fe/pmlkfeglfyjjkdndrmzvtzr8bsu.jpeg"><br>
<br>
<code>PROVISIONING_PROFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- L'ID de profil pour signer l'application, qui peut √™tre obtenu avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> <span class="hljs-string">"/Users/<span class="hljs-variable">$Username</span>/Library/MobileDevice/Provisioning Profiles/"</span> &amp;&amp; find *.mobileprovision -<span class="hljs-built_in">type</span> f | xargs grep -li <span class="hljs-string">"&gt;<span class="hljs-variable">${ProjectName}</span>_<span class="hljs-variable">${Instance}</span>&lt;"</span> | sed -e <span class="hljs-string">'s/.mobileprovision//'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'application utilise un profil suppl√©mentaire (par exemple, pour les notifications push), </font></font><code>PROVISIONING_PROFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indiquez √† la </font><font style="vertical-align: inherit;">place </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">APP_PROFILE=‚Äù<span class="hljs-variable">$AppProfile</span>‚Äù \<font></font>
EXTENSION_PROFILE=‚Äù<span class="hljs-variable">$ExtProfile</span>‚Äù \</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le fichier * .app r√©sultant doit √™tre empaquet√© dans * .ipa. </font><font style="vertical-align: inherit;">Pour ce faire, vous pouvez utiliser une commande du formulaire:</font></font><br>
<br>
<pre><code class="bash hljs">/usr/bin/xcrun --sdk iphoneos PackageApplication \<font></font>
-v $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/build/Build/Products/Release-iphoneos"</span> -name <span class="hljs-string">"*.app"</span>) \<font></font>
-o <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName_</span><span class="hljs-variable">$Instance</span>.ipa"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, cette m√©thode est consid√©r√©e comme obsol√®te du point de vue d'Apple. </font><font style="vertical-align: inherit;">Il est pertinent d'obtenir * .ipa en exportant √† partir des archives de l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord collecter l'archive avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-workspace <span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName</span>.xcworkspace \<font></font>
-scheme <span class="hljs-variable">$SchemeName</span> \<font></font>
-sdk iphoneos \<font></font>
-configuration Release \<font></font>
archive \<font></font>
-archivePath <span class="hljs-variable">$ProjectDir</span>/build/<span class="hljs-variable">$ProjectName</span>.xcarchive \<font></font>
CODE_SIGN_IDENTITY=‚Äù<span class="hljs-variable">$DevAccName</span>‚Äù \<font></font>
PROVISIONING_PROFILE=‚Äù<span class="hljs-variable">$ProfileId</span>‚Äù<font></font>
ENABLE_BITCODE=NO \<font></font>
SYNCHRONOUS_SYMBOL_PROCESSING=FALSE</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les diff√©rences r√©sident dans la m√©thode d'assemblage et l'option </font></font><code>SYNCHRONOUS_SYMBOL_PROCESSING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui d√©sactive le d√©chargement des caract√®res pendant l'assemblage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons g√©n√©rer un fichier avec les param√®tres d'exportation:</font></font><br>
<br>
<pre><code class="bash hljs">ExportSettings=<span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/exportOptions.plist"</span><font></font>
<font></font>
cat &lt;&lt; EOF &gt; <span class="hljs-variable">$ExportSettings</span>
&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;<font></font>
&lt;!DOCTYPE plist PUBLIC <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;<font></font>
&lt;plist version=<span class="hljs-string">"1.0"</span>&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;compileBitcode&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;uploadBitcode&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;uploadSymbols&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;method&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$Method</span>&lt;/string&gt;<font></font>
&lt;key&gt;provisioningProfiles&lt;/key&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;<span class="hljs-variable">$BundleID</span>&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ProfileId</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;key&gt;signingCertificate&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$DevAccName</span>&lt;/string&gt;<font></font>
&lt;key&gt;signingStyle&lt;/key&gt;<font></font>
&lt;string&gt;manual&lt;/string&gt;<font></font>
&lt;key&gt;stripSwiftSymbols&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">true</span>/&gt;<font></font>
&lt;key&gt;teamID&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$TeamID</span>&lt;/string&gt;<font></font>
&lt;key&gt;thinning&lt;/key&gt;<font></font>
&lt;string&gt;&lt;none&gt;&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/plist&gt;<font></font>
EOF<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O√π: </font></font><br>
<br>
<code>$Method</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- la m√©thode de livraison correspond au type de profil de signature d'application, c'est-√†-dire que pour le d√©veloppement, la valeur sera le d√©veloppement, pour Ad Hoc - ad-hoc et pour l'App Store - app-store. </font></font><br>
<br>
<code>$BundleID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- L'ID d'application sp√©cifi√© dans les param√®tres de l'application. </font><font style="vertical-align: inherit;">Vous pouvez v√©rifier avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">defaults <span class="hljs-built_in">read</span> <span class="hljs-variable">$ProjectDir</span>/Info CFBundleIdentifier</code></pre><br>
<code>$DevAccName  $ProfileId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- les param√®tres du nom du d√©veloppeur et de l'ID du profil de signature qui ont √©t√© utilis√©s pr√©c√©demment et doivent correspondre aux valeurs des param√®tres d'exportation. </font></font><br>
<br>
<code>$TeamID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ID √† dix chiffres entre parenth√®ses apr√®s le nom du d√©veloppeur, exemple: iPhone Developer: ....... (XXXXXXXXXX); </font><font style="vertical-align: inherit;">peut v√©rifier dans le trousseau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, en utilisant la commande d'exportation, nous obtenons le fichier * .ipa n√©cessaire:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-exportArchive \<font></font>
-archivePath <span class="hljs-variable">$ProjectDir</span>/build/<span class="hljs-variable">$ProjectName</span>.xcarchive \<font></font>
-exportPath <span class="hljs-variable">$ProjectDir</span> \<font></font>
-exportOptionsPlist <span class="hljs-variable">$ExportSettings</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Livraison</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier assembl√© doit maintenant √™tre remis √† l'utilisateur final, c'est-√†-dire install√© sur l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la distribution des versions de d√©veloppement et ad hoc, il existe de nombreux services comme HockeyApp, AppBlade et d'autres, mais dans cet article, nous parlerons d'un serveur autonome pour la distribution d'applications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'installation de l'application pour iOS se d√©roule en 2 √©tapes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtention du manifeste d'installation de l'application via le service Items.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation du fichier * .ipa selon les informations sp√©cifi√©es dans le manifeste via HTTPS.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, pour commencer, nous devons g√©n√©rer le manifeste d'installation (type de fichier * .plist) avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">cat &lt;&lt; EOF &gt; <span class="hljs-variable">$manifest</span>
&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;<font></font>
&lt;!DOCTYPE plist PUBLIC <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;<font></font>
&lt;plist version=<span class="hljs-string">"1.0"</span>&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;items&lt;/key&gt;<font></font>
&lt;array&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;assets&lt;/key&gt;<font></font>
&lt;array&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;kind&lt;/key&gt;<font></font>
&lt;string&gt;software-package&lt;/string&gt;<font></font>
&lt;key&gt;url&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ipaUrl</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/array&gt;<font></font>
&lt;key&gt;metadata&lt;/key&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;bundle-identifier&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$BundleID</span>&lt;/string&gt;<font></font>
&lt;key&gt;bundle-version&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$AppVersion</span>&lt;/string&gt;<font></font>
&lt;key&gt;kind&lt;/key&gt;<font></font>
&lt;string&gt;software&lt;/string&gt;<font></font>
&lt;key&gt;title&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ProjectName_</span><span class="hljs-variable">$Instance</span>&lt;/string&gt;<font></font>
&lt;key&gt;subtitle&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$Instance</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/array&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/plist&gt;<font></font>
EOF</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, le manifeste contient presque tous les param√®tres impliqu√©s dans l'assemblage de l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La version de l'application ( </font></font><code>$AppVersion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) peut √™tre v√©rifi√©e avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">defaults <span class="hljs-built_in">read</span> <span class="hljs-variable">$ProjectDir</span>/Info CFBundleVersion</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le param√®tre </font></font><code>$ipaUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contient un lien direct pour t√©l√©charger le fichier * .ipa. </font><font style="vertical-align: inherit;">√Ä partir de la septi√®me version d'iOS, l'application doit √™tre install√©e via HTTPS. </font><font style="vertical-align: inherit;">Dans la huiti√®me version, le format du manifeste a l√©g√®rement chang√©: les blocs avec les param√®tres des ic√¥nes d'application du formulaire ont √©t√© supprim√©s</font></font><br>
<br>
<pre><code class="bash hljs">&lt;images&gt;<font></font>
   &lt;image&gt;...&lt;/image&gt;<font></font>
&lt;/images&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, pour installer l'application, une simple page html avec un lien du formulaire suffit:</font></font><br>
<br>
<pre><code class="bash hljs">itms-services://?action=download-manifest&amp;url=https://<span class="hljs-variable">$ServerUrl</span>/<span class="hljs-variable">$ProjectName</span>/<span class="hljs-variable">$Instance</span>/iOS/<span class="hljs-variable">$AppVersion</span>/manifest.plist</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les besoins des services de d√©veloppement et de test, Plarium a cr√©√© son application d'installation de build, qui nous donne:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autonomie et ind√©pendance,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contr√¥le d'acc√®s centralis√© et installation s√©curis√©e des applications via des liens "temporaires", cr√©√©s dynamiquement,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionnalit√© extensible (c'est-√†-dire que l'√©quipe de d√©veloppement, si n√©cessaire, peut int√©grer les fonctions manquantes dans une application existante).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essai</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous allons parler des tests d'applications </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©liminaires √† l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aide de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">TestFlight</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les conditions pr√©alables au t√©l√©chargement sont le type de profil de signature App Store et la pr√©sence de cl√©s API g√©n√©r√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs fa√ßons de t√©l√©charger l'application:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via Xcode (Organisateur),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† travers altool,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via Application Loader pour les anciennes versions de Xcode (maintenant Transporter).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le chargement automatique, altool est utilis√©, qui a √©galement deux m√©thodes d'autorisation:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mot de passe sp√©cifique √† l'application,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cl√© API</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est pr√©f√©rable de t√©l√©charger l'application √† l'aide de la cl√© API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir la cl√© API, suivez le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et g√©n√©rez la cl√©. </font><font style="vertical-align: inherit;">En plus de la cl√© elle-m√™me au format * .p8, nous aurons besoin de deux param√®tres: IssuerID et KeyID. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7j/el/tr/7jeltrm88wb-m74uokirbdw59xs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous importons la cl√© t√©l√©charg√©e sur le serveur de build:</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p ~/.appstoreconnect/private_keys<font></font>
mv ~/Downloads/AuthKey_<span class="hljs-variable">${KeyID}</span>.p8 ~/.appstoreconnect/private_keys/</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de charger l'application dans TestFlight, vous devez valider l'application, faites-le avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool \<font></font>
--validate-app \<font></font>
-t ios \<font></font>
-f $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>"</span> -name <span class="hljs-string">"*.ipa"</span>) \<font></font>
--apiKey ‚Äú<span class="hljs-variable">$KeyID</span>‚Äù \<font></font>
--apiIssuer ‚Äú<span class="hljs-variable">$IssuerID</span>‚Äù </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O√π </font></font><code>apiKey</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>apiIssuer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avoir des valeurs de champ √† partir de la page de g√©n√©ration de cl√© API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, une fois la validation r√©ussie, nous chargeons l'application avec une commande </font></font><code>--upload-app</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec les m√™mes param√®tres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'application sera test√©e par Apple dans un d√©lai d'un √† deux jours et sera ensuite mise √† la disposition des testeurs externes: des liens e-mail leur seront envoy√©s pour l'installation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre fa√ßon de t√©l√©charger l'application via altool est d'utiliser le mot de passe sp√©cifique √† l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir le mot de passe sp√©cifique √† l'application, vous devez suivre le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le g√©n√©rer dans la section S√©curit√©. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k6/3k/lk/k63klknhpg0dtwoukakdzmn02om.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, cr√©ez un enregistrement de serveur de g√©n√©ration dans le trousseau avec ce mot de passe. </font><font style="vertical-align: inherit;">√Ä partir de la version 11 de Xcode, cela peut √™tre fait avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool --store-password-in-keychain-item <span class="hljs-string">"Altool"</span> -u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> -p <span class="hljs-variable">$AppPswd</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O√π: </font></font><br>
<br>
<code>$DeveloperName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le nom du compte d√©veloppeur iOS utilis√© pour se connecter aux services Apple. </font></font><br>
<br>
<code>$AppPswd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- mot de passe sp√©cifique √† l'application g√©n√©r√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous obtenons la valeur du param√®tre asc-provider et v√©rifions le succ√®s de l'importation du mot de passe avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool --list-providers -u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> -p <span class="hljs-string">"@keychain:Altool"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons la conclusion:</font></font><br>
<br>
<pre><code class="bash hljs">Provider listing:<font></font>
- Long Name - - Short Name -<font></font>
XXXXXXX        XXXXXXXXX</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, la valeur souhait√©e du nom court (fournisseur asc) correspond au param√®tre $ TeamID que nous avons utilis√© lors de la cr√©ation de l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour valider et charger l'application dans TestFlight, utilisez la commande:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool \<font></font>
--(validate|upload)-app \  <font></font>
-f $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>"</span> -name <span class="hljs-string">"*.ipa"</span>) \<font></font>
-u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> \<font></font>
-p <span class="hljs-string">"@keychain:Altool"</span> \</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que valeur de param√®tre, </font></font><code>-p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous pouvez prendre la valeur </font></font><code>$AppPswd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous forme non chiffr√©e (explicite). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, comme d√©j√† mentionn√©, du point de vue de l'op√©rabilit√©, il est pr√©f√©rable de s√©lectionner la cl√© API pour l'autorisation altool, car divers probl√®mes sont rencontr√©s dans diff√©rentes versions de Xcode (il ne voit pas le trousseau, les erreurs d'autorisation lors du d√©chargement, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, c'est tout. </font><font style="vertical-align: inherit;">Je souhaite √† tous ceux qui sont impliqu√©s dans des versions r√©ussies et des versions sans probl√®me sur l'App Store.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490684/index.html">S√©lection de c√¢bles pour c√¢blage structur√©</a></li>
<li><a href="../fr490686/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 500 (11.02.2020-17.02.2020)</a></li>
<li><a href="../fr490690/index.html">Nous cr√©ons le r√©pertoire d'adresses WEB de PHP + LDAP</a></li>
<li><a href="../fr490694/index.html">Principaux commentaires dans le code source</a></li>
<li><a href="../fr490696/index.html">Fonctionnement de Mail for Business - Boutiques en ligne et principaux exp√©diteurs</a></li>
<li><a href="../fr490700/index.html">Cours de traitement du langage naturel</a></li>
<li><a href="../fr490704/index.html">Mod√®les japonais et californiens Kano</a></li>
<li><a href="../fr490708/index.html">Finnair airlines Finnair: comment l'√©quipage s'entra√Æne et un peu sur l'int√©rieur de la cuisine</a></li>
<li><a href="../fr490714/index.html">Comment obtenir 100 000 par code. Guide du d√©butant complet</a></li>
<li><a href="../fr490716/index.html">Comment assurer un fonctionnement de haute qualit√© du r√©seau local d'une petite entreprise?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>