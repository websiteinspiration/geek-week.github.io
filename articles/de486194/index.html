<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💪🏽 👇🏾 💵 Informationen zu Backups in Proxmox VE 🤦 🌊 📛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In dem Artikel „Die Magie der Virtualisierung: Ein Einführungskurs in Proxmox VE“ haben wir erfolgreich einen Hypervisor auf dem Server installiert, d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Informationen zu Backups in Proxmox VE</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/486194/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wt/vx/xu/wtvxxuyee73gugficymc7t4x0zm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dem Artikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Die Magie der Virtualisierung: Ein Einführungskurs in Proxmox VE“ haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir erfolgreich einen Hypervisor auf dem Server installiert, den Speicher damit verbunden </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> uns um die grundlegende Sicherheit gekümmert und sogar die erste virtuelle Maschine erstellt. Jetzt sehen wir uns an, wie Sie die grundlegendsten Aufgaben implementieren, die Sie ausführen müssen, um die Dienste im Fehlerfall immer wiederherstellen zu können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit den etablierten Proxmox-Tools können Sie nicht nur Daten sichern, sondern auch vorkonfigurierte Images von Betriebssystemen für eine schnelle Bereitstellung erstellen. Dies hilft nicht nur bei Bedarf, in wenigen Sekunden einen neuen Server für einen Dienst zu erstellen, sondern reduziert auch Ausfallzeiten auf ein Minimum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden nicht über die Notwendigkeit sprechen, Backups zu erstellen, da dies offensichtlich ist und seit langem ein Axiom ist. </font><font style="vertical-align: inherit;">Lassen Sie uns auf einige nicht offensichtliche Dinge und Merkmale eingehen.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Überlegen Sie zunächst, wie die Daten während des Sicherungsvorgangs gespeichert werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherungsalgorithmen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst verfügt Proxmox über ein gutes Personal-Toolkit zum Erstellen von Backups virtueller Maschinen. </font><font style="vertical-align: inherit;">Sie können auf einfache Weise alle Daten der virtuellen Maschine speichern und unterstützen zwei Komprimierungsmechanismen sowie drei Methoden zum Erstellen dieser Kopien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untersuchen wir zunächst die Komprimierungsmechanismen:</font></font><br>
<br>
<ol>
<li><b> LZO</b>.     ,     90- .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> (  Proxmox  lzop).        . ,   ,     ,        .</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimieren des GZIP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mit diesem Algorithmus wird das Backup im laufenden Betrieb mit dem Dienstprogramm GNU Zip komprimiert, das den leistungsstarken Deflate-Algorithmus von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phil Katz verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Das Hauptaugenmerk liegt auf der maximalen Datenkomprimierung, wodurch der für Backups belegte Speicherplatz reduziert wird. </font><font style="vertical-align: inherit;">Der Hauptunterschied zu LZO besteht darin, dass die Komprimierungs- / Dekomprimierungsverfahren ziemlich viel Zeit in Anspruch nehmen.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archivierungsmodi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proxmox bietet dem Systemadministrator drei Sicherungsmethoden zur Auswahl. </font><font style="vertical-align: inherit;">Mit ihnen können Sie das erforderliche Problem lösen, indem Sie die Priorität zwischen der Notwendigkeit von Ausfallzeiten und der Zuverlässigkeit der Sicherung bestimmen:</font></font><br>
<br>
<ol>
<li><b> Snapshot ()</b>.       Live backup,          .       VM,       —    -         .  ,   ,      .     ,     ,    .</li>
<li><b> Suspend ()</b>.    «»  ,     .     ,        ,     . ,        ,    /  ,      . ,       .              .</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stoppmodus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die zuverlässigste Sicherungsmethode, die jedoch ein vollständiges Herunterfahren der virtuellen Maschine erfordert. </font><font style="vertical-align: inherit;">Ein Befehl wird zum normalen Herunterfahren gesendet. Nach dem Stoppen wird eine Sicherung durchgeführt und anschließend ein Befehl zum Einschalten der virtuellen Maschine ausgegeben. </font><font style="vertical-align: inherit;">Die Anzahl der Fehler bei diesem Ansatz ist minimal und wird meistens auf Null reduziert. </font><font style="vertical-align: inherit;">Auf diese Weise erstellte Backups werden fast immer korrekt bereitgestellt.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Führen Sie den Sicherungsvorgang durch</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sichern:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir gehen zur notwendigen virtuellen Maschine über.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservierungspunkt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klicken Sie auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reservieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es öffnet sich ein Fenster, in dem Sie die Optionen für die zukünftige Sicherung auswählen können.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/et/gn/fu/etgnfuz7yjw9dohf4ktcvphtxry.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Speicher geben wir den an, den wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im vorherigen Teil verbunden haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klicken Sie nach Auswahl der Parameter auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sichern</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und warten Sie, bis das Backup erstellt wurde. </font><font style="vertical-align: inherit;">Dies wird durch die Aufschrift </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TASK OK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angezeigt </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u-/8i/pc/u-8ipc1amu1z51u4ibgh9tjxs-o.png"></div><br>
</li>
</ol><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt erstellte Archive mit Backups virtueller Maschinen können vom Server heruntergeladen werden. </font><font style="vertical-align: inherit;">Die einfachste und gebräuchlichste Art zu kopieren ist SFTP. </font><font style="vertical-align: inherit;">Verwenden Sie dazu den beliebten plattformübergreifenden FTP-Client FileZilla, der mit dem SFTP-Protokoll arbeiten kann.</font></font><br>
<br>
<ol>
<li>  <b></b>  IP-   ,   <b> </b>  root,   <b></b> — ,     ,    <b></b>  «22» (   ,     SSH-).</li>
<li>  <b> </b> ,      ,        ,   .</li>
<li>   <b>/mnt/storage</b>.         «dump».    :<ul>
<li><b>vzdump-qemu-_--.vma.gz</b>     GZIP;</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vzdump-qemu-machine-number-date-time.vma.lzo,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wenn die LZO-Methode ausgewählt ist.</font></font></li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird empfohlen, Backups sofort vom Server herunterzuladen und an einem sicheren Ort zu speichern, z. B. in unserem Cloud-Speicher. </font><font style="vertical-align: inherit;">Wenn Sie eine Datei mit der Auflösung vma entpacken, dem gleichnamigen Dienstprogramm, das im Lieferumfang von Proxmox enthalten ist, befinden sich Dateien mit den Erweiterungen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Diese Dateien enthalten Folgendes:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raw-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Disk-Image;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - VM Konfiguration;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fw</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Firewall-Einstellungen.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von der Sicherung wiederherstellen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie die Situation, in der die virtuelle Maschine versehentlich gelöscht wurde und eine Notfallwiederherstellung aus der Sicherung erforderlich ist:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Öffnen Sie den Speicher, auf dem sich das Backup befindet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie zur Registerkarte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhalt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie die gewünschte Kopie aus und klicken Sie auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiederherstellen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bg/ou/ts/bgoutsyb4clkt_qx4xy88avgtqq.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir geben den Zielspeicher und die ID an, die der Maschine nach Abschluss des Vorgangs zugewiesen werden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klicken Sie auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiederherstellen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald die Wiederherstellung abgeschlossen ist, wird die VM in der Liste der verfügbaren VMs angezeigt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klonen von virtuellen Maschinen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, ein Unternehmen muss Änderungen an einem kritischen Service vornehmen. </font><font style="vertical-align: inherit;">Eine solche Änderung wird implementiert, indem viele Änderungen an den Konfigurationsdateien vorgenommen werden. </font><font style="vertical-align: inherit;">Das Ergebnis ist unvorhersehbar und jeder Fehler kann zu einem Servicefehler führen. </font><font style="vertical-align: inherit;">Um zu verhindern, dass sich ein solches Experiment auf einen laufenden Server auswirkt, wird empfohlen, die virtuelle Maschine zu klonen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Klonmechanismus erstellt eine exakte Kopie des virtuellen Servers, mit dem Änderungen vorgenommen werden können, ohne den Betrieb des Hauptdienstes zu beeinträchtigen. Wenn die Änderungen erfolgreich angewendet wurden, wird die neue VM gestartet und die alte heruntergefahren. In diesem Prozess gibt es eine Funktion, an die man sich immer erinnern sollte. Auf dem geklonten Computer entspricht die IP-Adresse genau der Quell-VM, dh beim Start tritt ein Adresskonflikt auf.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden Ihnen sagen, wie Sie eine solche Situation vermeiden können. Unmittelbar vor dem Klonen sollten Sie Änderungen an der Netzwerkkonfiguration vornehmen. Dazu müssen Sie die IP-Adresse vorübergehend ändern, den Netzwerkdienst jedoch nicht neu starten. Nach dem Klonen auf dem Hauptcomputer sollten Sie die Einstellungen zurückgeben und auf dem geklonten Computer eine andere IP-Adresse angeben. Somit erhalten wir zwei Kopien desselben Servers an unterschiedlichen Adressen. Dadurch wird schnell ein neuer Dienst eingeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es sich bei diesem Dienst um einen Webserver handelt, müssen Sie nur den A-Eintrag Ihres DNS-Anbieters ändern. Danach werden Clientanforderungen für diesen Domänennamen bereits an die Adresse der geklonten virtuellen Maschine gesendet.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Übrigens bietet Selectel allen Kunden den Service, eine beliebige Anzahl von Domains kostenlos auf NS-Servern zu platzieren. </font><font style="vertical-align: inherit;">Die Datensatzverwaltung erfolgt sowohl über unser Control Panel als auch über eine spezielle API. </font><font style="vertical-align: inherit;">Lesen Sie mehr darüber </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in unserer Wissensdatenbank</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Klonen einer VM in Proxmox ist eine sehr einfache Aufgabe. </font><font style="vertical-align: inherit;">Um es auszuführen, müssen Sie die folgenden Schritte ausführen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geh zu dem Auto, das wir brauchen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie aus dem Menü </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mehr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> klicken Sie auf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klonen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie im folgenden Fenster den Parameter Name ein.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3n/on/wn/3nonwng-06gxpllialr7u_9ck2m.png"></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klonen Sie durch Drücken der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klontaste</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesem Tool können Sie eine Kopie einer virtuellen Maschine nicht nur auf dem lokalen Server erstellen. </font><font style="vertical-align: inherit;">Wenn mehrere Virtualisierungsserver zu einem Cluster zusammengefasst sind, können Sie mit diesem Tool die erstellte Kopie sofort auf den gewünschten physischen Server verschieben. </font><font style="vertical-align: inherit;">Eine nützliche Funktion ist die Auswahl des Festplattenspeichers (Parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zielspeicher</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), was sehr praktisch ist, wenn eine virtuelle Maschine von einem physischen Medium auf ein anderes verschoben wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtuelle Laufwerksformate</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden Ihnen mehr über die in Proxmox verwendeten Laufwerksformate erzählen:</font></font><br>
<br>
<ol>
<li><b>RAW</b>.     .       «  »    .    ,       mount   linux-.      «» ,        .<br>
<br>
     ,        ,             RAW (        ).</li>
<li><b>QEMU image format (qcow2)</b>. ,       .    ,             . ,    40  ,      2 ,         VM.        .<br>
<br>
       :        ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  nbd</a>,     <b>qemu-nbd</b>,            .       ,   ,       .<br>
<br>
 ,    -      ,           .        ,     RAW.</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VMware-Image-Format (vmdk)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dieses Format stammt ursprünglich aus dem VMware vSphere-Hypervisor und wurde aus Kompatibilitätsgründen in Proxmox enthalten. </font><font style="vertical-align: inherit;">Sie können eine virtuelle VMware-Maschine auf die Proxmox-Infrastruktur migrieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die fortlaufende Verwendung von vmdk wird nicht empfohlen. Dieses Format ist das langsamste in Proxmox, daher ist es nur für die Migration geeignet, nicht mehr. </font><font style="vertical-align: inherit;">Wahrscheinlich wird dieses Manko in absehbarer Zeit beseitigt.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten Sie mit Disk-Images</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Proxmox ist ein sehr praktisches Dienstprogramm namens </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qemu-img enthalten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Eine seiner Funktionen ist das Konvertieren von Images virtueller Festplatten. </font><font style="vertical-align: inherit;">Um es zu verwenden, öffnen Sie einfach die Hypervisor-Konsole und führen Sie den Befehl im folgenden Format aus:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img convert -f vmdk test.vmdk -O qcow2 test.qcow2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im obigen Beispiel wird das VMDK-Image des virtuellen VMware-Laufwerks mit dem Namen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qcow2-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Format konvertiert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist ein sehr nützlicher Befehl, wenn Sie einen Fehler bei der anfänglichen Formatauswahl korrigieren müssen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit demselben Befehl können Sie das gewünschte Bild mit dem Argument </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erzwingen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img create -f raw test.raw 40G</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit einem solchen Befehl wird ein Testbild im </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAW-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Format </font><font style="vertical-align: inherit;">mit einer Größe von 40 GB erstellt. </font><font style="vertical-align: inherit;">Jetzt ist es für die Verbindung mit einer der virtuellen Maschinen geeignet.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ändern Sie die Größe einer virtuellen Festplatte</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abschließend zeigen wir, wie Sie die Größe eines Disk-Images erhöhen können, wenn aus irgendeinem Grund der Speicherplatz nicht mehr ausreicht. </font><font style="vertical-align: inherit;">Verwenden Sie dazu das Argument resize:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img resize -f raw test.raw 80G</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt hat unser Image die Größe von 80 GB. </font><font style="vertical-align: inherit;">Sie können detaillierte Informationen zum Bild mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Info-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Argument anzeigen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">qemu-img info test.raw</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie nicht, dass die Image-Erweiterung selbst die Partition nicht automatisch vergrößert, sondern lediglich den verfügbaren freien Speicherplatz hinzufügt. </font><font style="vertical-align: inherit;">Verwenden Sie den Befehl, um den Abschnitt zu vergrößern:</font></font><br>
<br>
<pre><code class="plaintext hljs">resize2fs /dev/sda1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ dev / sda1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die gewünschte Partition.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backups automatisieren</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die manuelle Methode zum Erstellen von Backups ist eine sehr zeitaufwändige Aufgabe und nimmt viel Zeit in Anspruch. </font><font style="vertical-align: inherit;">Daher enthält Proxmox VE ein Tool für automatische geplante Sicherungen. </font><font style="vertical-align: inherit;">Überlegen Sie, wie das geht:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Öffnen Sie über die Weboberfläche des Hypervisors das Element </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datencenter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wählen Sie den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservierungspunkt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klicken Sie auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinzufügen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir legen die Parameter für den Scheduler fest.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5d/a0/tu/5da0tunglle5mwsvudggbwjyuhc.png"></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivieren Sie das Kontrollkästchen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivieren</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern Sie die Änderungen über die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt startet der Scheduler das Sicherungsprogramm automatisch zum genau angegebenen Zeitpunkt, basierend auf dem angegebenen Zeitplan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben regelmäßige Methoden zur Sicherung und Wiederherstellung virtueller Maschinen in Betracht gezogen. Durch ihre Verwendung können Sie alle Daten problemlos speichern und im Notfall dringend wiederherstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist natürlich nicht die einzige Möglichkeit, wichtige Daten zu speichern. Es gibt viele Tools, z. B. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duplicity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit denen Sie vollständige und inkrementelle Kopien des Inhalts virtueller Server auf Linux-Basis erstellen können.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Sicherungsvorgänge ausführen, sollten Sie immer berücksichtigen, dass diese das Festplattensubsystem aktiv laden. </font><font style="vertical-align: inherit;">In diesem Zusammenhang wird empfohlen, diese Verfahren zu Zeiten minimaler Belastung durchzuführen, um Verzögerungen bei der Ausführung von E / A-Vorgängen innerhalb der Maschinen zu vermeiden. </font><font style="vertical-align: inherit;">Sie können den Status von Verzögerungen beim Festplattenbetrieb direkt über die Weboberfläche des Hypervisors überwachen (Parameter E / A-Verzögerung).</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de486194/">https://habr.com/ru/post/de486194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de486184/index.html">So nutzen Sie die Suche effektiv</a></li>
<li><a href="../de486186/index.html">Katastrophale Wolke: Wie es funktioniert</a></li>
<li><a href="../de486188/index.html">Einführung in das PostgreSQL-Wal-G-Backup-System</a></li>
<li><a href="../de486190/index.html">Unsere Erfahrung bei der Entwicklung eines CSI-Treibers in Kubernetes für Yandex.Cloud</a></li>
<li><a href="../de486192/index.html">Cyber-Betrüger hacken Mobilfunkbetreiber, um die Telefonnummern von Abonnenten zu ermitteln</a></li>
<li><a href="../de486198/index.html">Reden ist schwer. Essays zur Kommunikation mit Nicht-Programmierern</a></li>
<li><a href="../de486200/index.html">Docker-Tipps: Reinigen Sie Ihre Maschine von Junk</a></li>
<li><a href="../de486202/index.html">Alpine sammelt Docker-Builds unter Python 50-mal langsamer und Bilder 2-mal schwerer</a></li>
<li><a href="../de486204/index.html">Beruf: Systemadministrator</a></li>
<li><a href="../de486206/index.html">Welche Arten von Betrug habe ich bei freiberuflichen Tätigkeiten und beim Outsourcing festgestellt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>