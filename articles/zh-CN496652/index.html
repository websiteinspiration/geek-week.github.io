<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¸ğŸ¼ ğŸšˆ ğŸ’° å¦‚ä½•ä½¿ç”¨Pusherå‘Laravelæ·»åŠ å®æ—¶é€šçŸ¥ ğŸ’º ğŸ¥ˆ ğŸ•¹ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç‰¹åˆ«ä¸ºâ€œ Framework Laravelâ€è¯¾ç¨‹çš„å­¦ç”Ÿå‡†å¤‡äº†è¿™ç¯‡æ–‡ç« çš„ç¿»è¯‘ã€‚
 
 
 
 ç°ä»£çš„Webç”¨æˆ·å¸Œæœ›äº†è§£åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚æ‚¨å¯èƒ½ä¸æƒ³æˆä¸ºä¸€ä¸ªç”šè‡³æ²¡æœ‰é€šçŸ¥ä¸‹æ‹‰åˆ—è¡¨çš„ç½‘ç«™ï¼Œç°åœ¨ä¸ä»…å¯ä»¥åœ¨æ‰€æœ‰ç¤¾äº¤ç½‘ç«™ä¸Šæ‰¾åˆ°è¿™äº›é€šçŸ¥ï¼Œè€Œä¸”å¦‚ä»Šåœ¨å‡ ä¹æ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥æ‰¾åˆ°ã€‚
 
 å¹¸è¿çš„æ˜¯ï¼Œä½¿ç”¨Larave...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•ä½¿ç”¨Pusherå‘Laravelæ·»åŠ å®æ—¶é€šçŸ¥</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/496652/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰¹åˆ«ä¸º</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ Framework Laravelâ€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¾ç¨‹çš„å­¦ç”Ÿå‡†å¤‡äº†è¿™ç¯‡æ–‡ç« çš„ç¿»è¯‘</font><font style="vertical-align: inherit;">ã€‚</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/sm/tj/qn/smtjqnftoocvtc4fzn0gm6ttfje.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°ä»£çš„Webç”¨æˆ·å¸Œæœ›äº†è§£åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯èƒ½ä¸æƒ³æˆä¸ºä¸€ä¸ªç”šè‡³æ²¡æœ‰é€šçŸ¥ä¸‹æ‹‰åˆ—è¡¨çš„ç½‘ç«™ï¼Œç°åœ¨ä¸ä»…å¯ä»¥åœ¨æ‰€æœ‰ç¤¾äº¤ç½‘ç«™ä¸Šæ‰¾åˆ°è¿™äº›é€šçŸ¥ï¼Œè€Œä¸”å¦‚ä»Šåœ¨å‡ ä¹æ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥æ‰¾åˆ°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¸è¿çš„æ˜¯ï¼Œä½¿ç”¨Laravelå’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusherï¼Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤åŠŸèƒ½</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">çš„</font></a><font style="vertical-align: inherit;">å®ç°éå¸¸ç®€å•ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®æ—¶é€šçŸ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æä¾›ç§¯æçš„ç”¨æˆ·ä½“éªŒï¼Œåº”å®æ—¶æ˜¾ç¤ºé€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">ä¸€ç§æ–¹æ³•æ˜¯å®šæœŸå‘æœåŠ¡å™¨å‘é€AJAXè¯·æ±‚å¹¶æ¥æ”¶æœ€æ–°çš„é€šçŸ¥ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨WebSocketçš„åŠŸèƒ½å¹¶åœ¨å‘é€é€šçŸ¥æ—¶æ¥æ”¶é€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">è¿™æ­£æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­å®ç°çš„ã€‚</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¨æ†</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusheræ˜¯ä¸€ç§WebæœåŠ¡ï¼Œç”¨äºé€šè¿‡WebSocketå°†å®æ—¶åŒå‘åŠŸèƒ½é›†æˆåˆ°Webå’Œç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒæœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„APIï¼Œä½†æ˜¯æˆ‘ä»¬å°†é€šè¿‡Laravel Broadcastingå’ŒLaravel Echoä½¿å®ƒä½¿ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å‘ç°æœ‰åšå®¢æ·»åŠ å®æ—¶é€šçŸ¥ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆå§‹åŒ–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬å…‹éš†ä¸€ä¸ªç®€å•çš„Laravelåšå®¢ï¼š</font></font><br>
<br>
<pre><code class="php hljs">git <span class="hljs-keyword">clone</span>   https:<span class="hljs-comment">//github.com/marslan-ali/laravel-blog</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬å°†åˆ›å»ºMySQLæ•°æ®åº“å¹¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä»¥ä½¿åº”ç”¨ç¨‹åºå¯ä»¥è®¿é—®æ•°æ®åº“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬æ‹·è´</font></font><code>env.example</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸­</font></font><code>.env</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ›´æ–°ä¸æ•°æ®åº“ç›¸å…³çš„å˜é‡ã€‚</font></font><br>
<br>
<pre><code class="php hljs">cp .env.example .envDB_HOST=localhost<font></font>
DB_DATABASE=homestead<font></font>
DB_USERNAME=homestead<font></font>
DB_PASSWORD=secret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…é¡¹ç›®ä¾èµ–é¡¹</font></font><br>
<br>
<pre><code class="plaintext hljs">composer install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶è¿è¡Œmigration and populateå‘½ä»¤ä»¥ä½¿ç”¨ä¸€äº›æ•°æ®å¡«å……æ•°æ®åº“ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">php artisan migrate --seed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœè¿è¡Œè¯¥åº”ç”¨ç¨‹åºå¹¶è½¬åˆ°</font></font><code>/posts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„å¸–å­åˆ—è¡¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥åº”ç”¨ç¨‹åºï¼Œæ³¨å†Œç”¨æˆ·å¹¶åˆ›å»ºä¸€äº›æ¶ˆæ¯ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯éå¸¸é€‚åˆæ¼”ç¤ºã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¢é˜…ç”¨æˆ·</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¸Œæœ›ç»™ç”¨æˆ·æä¾›å½¼æ­¤è®¢é˜…çš„æœºä¼šï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»åœ¨ç”¨æˆ·ä¹‹é—´å»ºç«‹å¤šå¯¹å¤šå…³ç³»ä»¥å®ç°è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°†ç”¨æˆ·é“¾æ¥åˆ°ç”¨æˆ·çš„æ•°æ®é€è§†è¡¨ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è¿›è¡Œæ–°çš„è¿ç§»</font></font><code>followers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:migration create_followers_table --create=followers</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬éœ€è¦åœ¨æ­¤è¿ç§»ä¸­æ·»åŠ å‡ ä¸ªå­—æ®µï¼š</font></font><code>user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£è¡¨è®¢é˜…çš„ç”¨æˆ·ï¼Œä»¥åŠ</font></font><code>follows_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£è¡¨ä»–ä»¬è®¢é˜…çš„ç”¨æˆ·</font><font style="vertical-align: inherit;">çš„å­—æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ–°è¿ç§»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    Schema::create(<span class="hljs-string">'followers'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
        $table-&gt;increments(<span class="hljs-string">'id'</span>);<font></font>
        $table-&gt;integer(<span class="hljs-string">'user_id'</span>)-&gt;index();<font></font>
        $table-&gt;integer(<span class="hljs-string">'follows_id'</span>)-&gt;index();<font></font>
        $table-&gt;timestamps();<font></font>
    });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­åˆ›å»ºè¡¨ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan migrate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬å‘æ¨¡å‹æ·»åŠ å…³ç³»æ–¹æ³•</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Authenticatable</span>
</span>{
    <span class="hljs-comment">// ...</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">followers</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;belongsToMany(<span class="hljs-built_in">self</span>::class, <span class="hljs-string">'followers'</span>, <span class="hljs-string">'follows_id'</span>, <span class="hljs-string">'user_id'</span>)<font></font>
                    -&gt;withTimestamps();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follows</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;belongsToMany(<span class="hljs-built_in">self</span>::class, <span class="hljs-string">'followers'</span>, <span class="hljs-string">'user_id'</span>, <span class="hljs-string">'follows_id'</span>)<font></font>
                    -&gt;withTimestamps();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œè¯¥æ¨¡å‹</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…·æœ‰å¿…è¦çš„å…³ç³»ï¼Œå®ƒ</font></font><code>followers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›ç”¨æˆ·çš„æ‰€æœ‰è®¢æˆ·ï¼Œå¹¶</font></font><code>follows</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›ç”¨æˆ·å·²é¢„è®¢çš„æ‰€æœ‰è®¢æˆ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†éœ€è¦ä¸€äº›è¾…åŠ©åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å…è®¸ç”¨æˆ·è®¢é˜…å…¶ä»–ç”¨æˆ·- </font></font><code>follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶æ£€æŸ¥è¯¥ç”¨æˆ·æ˜¯å¦è®¢é˜…äº†ç‰¹å®šç”¨æˆ·- </font></font><code>isFollowing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Authenticatable</span>
</span>{
    <span class="hljs-comment">// ...</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">$userId</span>) 
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;attach($userId);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unfollow</span>(<span class="hljs-params">$userId</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;detach($userId);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFollowing</span>(<span class="hljs-params">$userId</span>) 
    </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">boolean</span>) <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;where(<span class="hljs-string">'follows_id'</span>, $userId)-&gt;first([<span class="hljs-string">'id'</span>]);<font></font>
    }<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç²¾ç»†ã€‚</font><font style="vertical-align: inherit;">å‡†å¤‡å¥½æ¨¡å‹åï¼Œæ‚¨éœ€è¦åˆ—å‡ºç”¨æˆ·åˆ—è¡¨ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨æˆ·åˆ—è¡¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä»ç¡®å®šå¿…è¦çš„è·¯çº¿å¼€å§‹ã€‚</font></font><br>
<br>
<pre><code class="php hljs">/...<font></font>
Route::group([<span class="hljs-string">'middleware'</span> =&gt; <span class="hljs-string">'auth'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<font></font>
    Route::get(<span class="hljs-string">'users'</span>, <span class="hljs-string">'UsersController@index'</span>)-&gt;name(<span class="hljs-string">'users'</span>);<font></font>
    Route::post(<span class="hljs-string">'users/{user}/follow'</span>, <span class="hljs-string">'UsersController@follow'</span>)-&gt;name(<span class="hljs-string">'follow'</span>);<font></font>
    Route::delete(<span class="hljs-string">'users/{user}/unfollow'</span>, <span class="hljs-string">'UsersController@unfollow'</span>)-&gt;name(<span class="hljs-string">'unfollow'</span>);<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åæ˜¯æ—¶å€™ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°çš„æ§åˆ¶å™¨äº†ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:controller UsersController</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªæ–¹æ³•</font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">User</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">//..</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        $users = User::where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'!='</span>, auth()-&gt;user()-&gt;id)-&gt;get();
        <span class="hljs-keyword">return</span> view(<span class="hljs-string">'users.index'</span>, compact(<span class="hljs-string">'users'</span>));<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ–¹æ³•éœ€è¦ä»‹ç»ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè§†å›¾</font></font><code>users.index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹æ ‡è®°ï¼š</font></font><br>
<br>
<pre><code class="php hljs">@<span class="hljs-keyword">extends</span>(<span class="hljs-string">'layouts.app'</span>)<font></font>
<font></font>
@section(<span class="hljs-string">'content'</span>)<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">container</span>"&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-<span class="hljs-title">offset</span>-2 <span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-8"&gt;

            &lt;!-- <span class="hljs-title">Following</span> --&gt;
            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span> <span class="hljs-title">panel</span>-<span class="hljs-title">default</span>"&gt;
                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">heading</span>"&gt;
                    <span class="hljs-title">All</span> <span class="hljs-title">Users</span>
                &lt;/<span class="hljs-title">div</span>&gt;

                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">body</span>"&gt;
                    &lt;<span class="hljs-title">table</span> <span class="hljs-title">class</span>="<span class="hljs-title">table</span> <span class="hljs-title">table</span>-<span class="hljs-title">striped</span> <span class="hljs-title">task</span>-<span class="hljs-title">table</span>"&gt;
                        &lt;<span class="hljs-title">thead</span>&gt;
                        &lt;<span class="hljs-title">th</span>&gt;<span class="hljs-title">User</span>&lt;/<span class="hljs-title">th</span>&gt;
                        &lt;<span class="hljs-title">th</span>&gt; &lt;/<span class="hljs-title">th</span>&gt;
                        &lt;/<span class="hljs-title">thead</span>&gt;
                        &lt;<span class="hljs-title">tbody</span>&gt;
                        @<span class="hljs-title">foreach</span> ($<span class="hljs-title">users</span> <span class="hljs-title">as</span> $<span class="hljs-title">user</span>)
                            &lt;<span class="hljs-title">tr</span>&gt;
                                &lt;<span class="hljs-title">td</span> <span class="hljs-title">clphpass</span>="<span class="hljs-title">table</span>-<span class="hljs-title">text</span>"&gt;&lt;<span class="hljs-title">div</span>&gt;</span>{{ $user-&gt;name }}&lt;/div&gt;&lt;/td&gt;<font></font>
                                @<span class="hljs-keyword">if</span> (auth()-&gt;user()-&gt;isFollowing($user-&gt;id))<font></font>
                                    &lt;td&gt;<font></font>
                                        &lt;form action=<span class="hljs-string">"{{route('unfollow', ['id' =&gt; $user-&gt;id])}}"</span> method=<span class="hljs-string">"POST"</span>&gt;<font></font>
                                            {{ csrf_field() }}<font></font>
                                            {{ method_field(<span class="hljs-string">'DELETE'</span>) }}<font></font>
<font></font>
                                            &lt;button type=<span class="hljs-string">"submit"</span> id=<span class="hljs-string">"delete-follow-{{ $user-&gt;id }}"</span> <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">btn</span> <span class="hljs-title">btn</span>-<span class="hljs-title">danger</span>"&gt;
                                                &lt;<span class="hljs-title">i</span> <span class="hljs-title">class</span>="<span class="hljs-title">fa</span> <span class="hljs-title">fa</span>-<span class="hljs-title">btn</span> <span class="hljs-title">fa</span>-<span class="hljs-title">trash</span>"&gt;&lt;/<span class="hljs-title">i</span>&gt;<span class="hljs-title">Unfollow</span>
                                            &lt;/<span class="hljs-title">button</span>&gt;
                                        &lt;/<span class="hljs-title">form</span>&gt;
                                    &lt;/<span class="hljs-title">td</span>&gt;
                                @<span class="hljs-title">else</span>
                                    &lt;<span class="hljs-title">td</span>&gt;
                                        &lt;<span class="hljs-title">form</span> <span class="hljs-title">action</span>="</span>{{route(<span class="hljs-string">'follow'</span>, [<span class="hljs-string">'id'</span> =&gt; $user-&gt;id])}}<span class="hljs-string">" method="</span>POST<span class="hljs-string">"&gt;
                                            {{ csrf_field() }}

                                            &lt;button type="</span>submit<span class="hljs-string">" id="</span>follow-user-{{ $user-&gt;id }}<span class="hljs-string">" class="</span>btn btn-success<span class="hljs-string">"&gt;
                                                &lt;i class="</span>fa fa-btn fa-user<span class="hljs-string">"&gt;&lt;/i&gt;Follow
                                            &lt;/button&gt;
                                        &lt;/form&gt;
                                    &lt;/td&gt;
                                @endif
                            &lt;/tr&gt;
                        @endforeach
                        &lt;/tbody&gt;
                    &lt;/table&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
@endsection</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥è®¿é—®è¯¥é¡µé¢</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³æ³¨å’Œå–æ¶ˆå…³æ³¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font></font><code>UsersController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼ºå°‘çš„æ–¹æ³•</font></font><code>follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font><font style="vertical-align: inherit;">æ–¹æ³•ä¸Š</font></font><code>unfollow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å®ç°å®ƒä»¬ä»¥å®Œæˆè¿™ä¸€éƒ¨åˆ†ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">//...</span></code></pre><br>
<pre><code class="php hljs">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span> ($follower-&gt;id == $user-&gt;id) {
            <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You can't follow yourself"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span>(!$follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;follow($user-&gt;id);<font></font>
<font></font>
            <span class="hljs-comment">//  </span>
            $user-&gt;notify(<span class="hljs-keyword">new</span> UserFollowed($follower));<font></font>
<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are now friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You are already following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unfollow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span>($follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;unfollow($user-&gt;id);<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are no longer friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You are not following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å·²ç»å®Œæˆäº†æ­¤åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢ä¸Šè®¢é˜…ç”¨æˆ·å¹¶å–æ¶ˆè®¢é˜…</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥äº‹é¡¹</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laravelæä¾›äº†ä¸€ä¸ªç”¨äºé€šè¿‡å¤šä¸ªæ¸ é“å‘é€é€šçŸ¥çš„APIã€‚</font><font style="vertical-align: inherit;">å¯ä»¥ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‘é€ç”µå­é‚®ä»¶ï¼ŒSMSï¼ŒWebé€šçŸ¥å’Œä»»ä½•å…¶ä»–ç±»å‹çš„é€šçŸ¥</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†æœ‰ä¸¤ç§ç±»å‹çš„é€šçŸ¥ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¢é˜…é€šçŸ¥ï¼šå½“å¦ä¸€ä¸ªç”¨æˆ·è®¢é˜…æ—¶å‘é€ç»™ç”¨æˆ·</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸–å­é€šçŸ¥ï¼šå‘å¸ƒæ–°å¸–å­æ—¶å‘é€ç»™è¯¥ç”¨æˆ·çš„è®¢é˜…è€…ã€‚</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¢é˜…é€šçŸ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨å·¥åŒ å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºé€šçŸ¥ç”Ÿæˆè¿ç§»ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan notifications:table</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬è¿›è¡Œè¿ç§»å¹¶åˆ›å»ºæ­¤è¡¨ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan migrate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä»è®¢é˜…é€šçŸ¥å¼€å§‹ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºé€šçŸ¥ç±»ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:notification UserFollowed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬ä¿®æ”¹åˆšåˆšåˆ›å»ºçš„é€šçŸ¥ç±»æ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFollowed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">Queueable</span>;<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> $follower;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">User $follower</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follower = $follower;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>];<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDatabase</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'follower_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;id,
            <span class="hljs-string">'follower_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;name,<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨è¿™å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å®ç°å¾ˆå¤šç›®æ ‡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ±‚åœ¨</font></font><code>$follower</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆæ­¤é€šçŸ¥æ—¶å®ç°</font><font style="vertical-align: inherit;">å®ä¾‹</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨è¯¥æ–¹æ³•</font></font><code>via</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬å‘Šè¯‰Laravelé€šè¿‡é€šé“å‘é€æ­¤é€šçŸ¥</font></font><code>database</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å½“Laravelé‡åˆ°æ­¤é—®é¢˜æ—¶ï¼Œå®ƒå°†åœ¨é€šçŸ¥è¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ¡ç›®ã€‚</font></font><br>
<br>
<code>user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶</font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥è¢«è‡ªåŠ¨è®¾ç½®ï¼Œå†åŠ ä¸Šæˆ‘ä»¬èƒ½å¤Ÿæ‰©å¤§ä¸å…¶ä»–æ•°æ®çš„é€šçŸ¥ã€‚è¿™å°±æ˜¯å®ƒçš„ç”¨é€”</font></font><code>toDatabase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¿”å›çš„æ•°ç»„å°†æ·»åŠ åˆ°</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥</font><font style="vertical-align: inherit;">å­—æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œæ„Ÿè°¢å®æ–½</font></font><code>ShouldQueue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ŒLaravelä¼šè‡ªåŠ¨å°†æ­¤é€šçŸ¥æ”¾ç½®åœ¨åå°è¿è¡Œçš„é˜Ÿåˆ—ä¸­ï¼Œè¿™å°†åŠ å¿«å“åº”é€Ÿåº¦ã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºç¨åä½¿ç”¨Pusheræ—¶å°†æ·»åŠ HTTPè°ƒç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªç”¨æˆ·è®¢é˜…é€šçŸ¥ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">UserFollowed</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span> ( ! $follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;follow($user-&gt;id);<font></font>
<font></font>
            <span class="hljs-comment">//  ,   </span>
            $user-&gt;notify(<span class="hljs-keyword">new</span> UserFollowed($follower));<font></font>
<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are now friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are already following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯ä»¥ä¸ºUseræ¨¡å‹è°ƒç”¨notifyæ–¹æ³•ï¼Œå› ä¸ºå®ƒå·²ç»ä½¿ç”¨äº†Notifiableç‰¹å¾ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨è¦é€šçŸ¥çš„ä»»ä½•æ¨¡å‹éƒ½åº”ä½¿ç”¨å®ƒæ¥è®¿é—®notifyæ–¹æ³•ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å°†é€šçŸ¥æ ‡è®°ä¸ºå·²è¯»</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é€šçŸ¥å°†åŒ…å«ä¸€äº›ä¿¡æ¯å’Œèµ„æºé“¾æ¥ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼šå½“ç”¨æˆ·æ”¶åˆ°æœ‰å…³æ–°æ¶ˆæ¯çš„é€šçŸ¥æ—¶ï¼Œè¯¥é€šçŸ¥åº”åŒ…å«å†…å®¹ä¸°å¯Œçš„æ–‡æœ¬ï¼Œåœ¨æŒ‰ä¸‹è¯¥æ¶ˆæ¯æ—¶å°†ç”¨æˆ·é‡å®šå‘åˆ°è¯¥æ¶ˆæ¯å¹¶æ ‡è®°ä¸ºå·²è¯»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå›¾å±‚ï¼Œè¯¥å›¾å±‚å°†æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å­˜åœ¨äº‹ä»¶</font></font><code>?read=notification_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å°†å…¶æ ‡è®°ä¸ºå·²è¯»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºè¯¥å±‚ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:middleware MarkNotificationAsRead</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œå°†è¿™æ®µä»£ç æ”¾åœ¨</font></font><code>handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interlayer </font><font style="vertical-align: inherit;">æ–¹æ³•ä¸­</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MarkNotificationAsRead</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">$request, <span class="hljs-built_in">Closure</span> $next</span>)
    </span>{
        <span class="hljs-keyword">if</span>($request-&gt;has(<span class="hljs-string">'read'</span>)) {<font></font>
            $notification = $request-&gt;user()-&gt;notifications()-&gt;where(<span class="hljs-string">'id'</span>, $request-&gt;read)-&gt;first();
            <span class="hljs-keyword">if</span>($notification) {<font></font>
                $notification-&gt;markAsRead();<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> $next($request);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†é’ˆå¯¹æ¯ä¸ªè¯·æ±‚æ‰§è¡Œæˆ‘ä»¬çš„å›¾å±‚ï¼Œæˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°ä¸­</font></font><code>$middlewareGroups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Kernel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpKernel</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">protected</span> $middlewareGroups = [
        <span class="hljs-string">'web'</span> =&gt; [
            <span class="hljs-comment">//...</span><font></font>
            \App\Http\Middleware\MarkNotificationAsRead::class,<font></font>
        ],<font></font>
        <span class="hljs-comment">// ...</span><font></font>
    ];<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹åï¼Œè®©æˆ‘ä»¬æ˜¾ç¤ºé€šçŸ¥ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¾ç¤ºé€šçŸ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬éœ€è¦ä½¿ç”¨AJAXæ˜¾ç¤ºé€šçŸ¥åˆ—è¡¨ï¼Œç„¶åä½¿ç”¨Pusherå®æ—¶æ›´æ–°é€šçŸ¥åˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆï¼Œè®©æˆ‘ä»¬</font></font><code>notifications</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæ§åˆ¶å™¨</font><font style="vertical-align: inherit;">æ·»åŠ ä¸€ä¸ªæ–¹æ³•</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notifications</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> auth()-&gt;user()-&gt;unreadNotifications()-&gt;limit(<span class="hljs-number">5</span>)-&gt;get()-&gt;toArray();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤ä»£ç å°†è¿”å›æœ€å5æ¡æœªè¯»çš„é€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€æ¡è·¯ç”±å³å¯è®¿é—®å®ƒã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
Route::group([ <span class="hljs-string">'middleware'</span> =&gt; <span class="hljs-string">'auth'</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// ...</span>
    Route::get(<span class="hljs-string">'/notifications'</span>, <span class="hljs-string">'UsersController@notifications'</span>);<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œåœ¨æ ‡é¢˜ä¸­æ·»åŠ ä¸€ä¸ªç”¨äºé€šçŸ¥çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚</font></font><br>
<br>
<pre><code class="php hljs">&lt;head&gt;<font></font>
    &lt;!-- <span class="hljs-comment">// ... // --&gt;</span><font></font>
    &lt;!-- Scripts --&gt;<font></font>
    &lt;script&gt;<font></font>
        window.Laravel = <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> json_encode([
            <span class="hljs-string">'csrfToken'</span> =&gt; csrf_token(),<font></font>
        ]); <span class="hljs-meta">?&gt;</span><font></font>
    &lt;/script&gt;<font></font>
    &lt;!--   id     JavaScript --&gt;<font></font>
    @<span class="hljs-keyword">if</span>(!auth()-&gt;guest())<font></font>
        &lt;script&gt;<font></font>
            window.Laravel.userId = <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> auth()-&gt;user()-&gt;id; <span class="hljs-meta">?&gt;</span><font></font>
        &lt;/script&gt;<font></font>
    @<span class="hljs-keyword">endif</span><font></font>
&lt;/head&gt;<font></font>
&lt;body&gt;<font></font>
    &lt;!-- <span class="hljs-comment">// ... // --&gt;</span>
    @<span class="hljs-keyword">if</span> (Auth::guest())<font></font>
        &lt;li&gt;&lt;a href=<span class="hljs-string">"{{ url('/login') }}"</span>&gt;Login&lt;/a&gt;&lt;/li&gt;<font></font>
        &lt;li&gt;&lt;a href=<span class="hljs-string">"{{ url('/register') }}"</span>&gt;Register&lt;/a&gt;&lt;/li&gt;<font></font>
    @<span class="hljs-keyword">else</span>
        &lt;!-- <span class="hljs-comment">// add this dropdown // --&gt;</span>
        &lt;li <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">dropdown</span>"&gt;
            &lt;<span class="hljs-title">a</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">toggle</span>" <span class="hljs-title">id</span>="<span class="hljs-title">notifications</span>" <span class="hljs-title">data</span>-<span class="hljs-title">toggle</span>="<span class="hljs-title">dropdown</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">haspopup</span>="<span class="hljs-title">true</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">expanded</span>="<span class="hljs-title">true</span>"&gt;
                &lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>="<span class="hljs-title">glyphicon</span> <span class="hljs-title">glyphicon</span>-<span class="hljs-title">user</span>"&gt;&lt;/<span class="hljs-title">span</span>&gt;
            &lt;/<span class="hljs-title">a</span>&gt;
            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">menu</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">labelledby</span>="<span class="hljs-title">notificationsMenu</span>" <span class="hljs-title">id</span>="<span class="hljs-title">notificationsMenu</span>"&gt;
                &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">header</span>"&gt;<span class="hljs-title">No</span> <span class="hljs-title">notifications</span>&lt;/<span class="hljs-title">li</span>&gt;
            &lt;/<span class="hljs-title">ul</span>&gt;
        &lt;/<span class="hljs-title">li</span>&gt;
&lt;!-- // ... // --&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è¿˜å‘</font></font><code>window.Laravel.userId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è„šæœ¬</font><font style="vertical-align: inherit;">æ·»åŠ äº†å…¨å±€å˜é‡</font><font style="vertical-align: inherit;">ä»¥è·å–å½“å‰ç”¨æˆ·IDã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScriptå’ŒSASS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä½¿ç”¨Laravel Mixæ¥ç¼–è¯‘JavaScriptå’ŒSASSã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…npmè½¯ä»¶åŒ…ã€‚</font></font><br>
<br>
<pre><code class="php hljs">npm install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è®©æˆ‘ä»¬å°†æ­¤ä»£ç æ·»åŠ åˆ°</font></font><code>app.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>._ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash'</span>);
<span class="hljs-built_in">window</span>.$ = <span class="hljs-built_in">window</span>.jQuery = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">'bootstrap-sass'</span>);
<span class="hljs-keyword">var</span> notifications = [];
<span class="hljs-keyword">const</span> NOTIFICATION_TYPES = {
    <span class="hljs-attr">follow</span>: <span class="hljs-string">'App\\Notifications\\UserFollowed'</span>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™åªæ˜¯åˆå§‹åŒ–ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä½¿ç”¨é€šçŸ¥æ¥å­˜å‚¨æ‰€æœ‰é€šçŸ¥å¯¹è±¡ï¼Œæ— è®ºå®ƒä»¬æ˜¯é€šè¿‡AJAXè¿˜æ˜¯Pusheræ£€ç´¢çš„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œå®ƒ</font></font><code>NOTIFICATION_TYPES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒ…å«é€šçŸ¥ç±»å‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡AJAXè·å¾—ï¼ˆâ€œ GETâ€ï¼‰é€šçŸ¥ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// ,      </span>
    <span class="hljs-keyword">if</span>(Laravel.userId) {<font></font>
        $.get(<span class="hljs-string">'/notifications'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{<font></font>
            addNotifications(data, <span class="hljs-string">"#notifications"</span>);<font></font>
        });<font></font>
    }<font></font>
});<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addNotifications</span>(<span class="hljs-params">newNotifications, target</span>) </span>{<font></font>
    notifications = _.concat(notifications, newNotifications);<font></font>
    <span class="hljs-comment">//    5 </span>
    notifications.slice(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);<font></font>
    showNotifications(notifications, target);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæœ‰äº†æ­¤ä»£ç ï¼Œæˆ‘ä»¬ä»APIæ”¶åˆ°äº†æœ€æ–°çš„é€šçŸ¥ï¼Œå¹¶å°†å®ƒä»¬æ”¾åœ¨äº†ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨ä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å†…éƒ¨ï¼Œ</font></font><code>addNotifications</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lodash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†ç°æœ‰é€šçŸ¥ä¸æ–°é€šçŸ¥ç»“åˆåœ¨ä¸€èµ·</font><font style="vertical-align: inherit;">ï¼Œå¹¶åªå–æœ€å5æ¡ï¼Œè¿™å°†æ˜¾ç¤ºå‡ºæ¥ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›å…¶ä»–åŠŸèƒ½æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showNotifications</span>(<span class="hljs-params">notifications, target</span>) </span>{
    <span class="hljs-keyword">if</span>(notifications.length) {
        <span class="hljs-keyword">var</span> htmlElements = notifications.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">notification</span>) </span>{
            <span class="hljs-keyword">return</span> makeNotification(notification);<font></font>
        });<font></font>
        $(target + <span class="hljs-string">'Menu'</span>).html(htmlElements.join(<span class="hljs-string">''</span>));<font></font>
        $(target).addClass(<span class="hljs-string">'has-notifications'</span>)<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        $(target + <span class="hljs-string">'Menu'</span>).html(<span class="hljs-string">'&lt;li class="dropdown-header"&gt;No notifications&lt;/li&gt;'</span>);<font></font>
        $(target).removeClass(<span class="hljs-string">'has-notifications'</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤åŠŸèƒ½åˆ›å»ºä¸€è¡Œæ‰€æœ‰é€šçŸ¥ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæœªæ”¶åˆ°ä»»ä½•é€šçŸ¥ï¼Œåˆ™ä»…æ˜¾ç¤ºâ€œæ— é€šçŸ¥â€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒè¿˜å‘ä¸‹æ‹‰æŒ‰é’®æ·»åŠ äº†ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ä»…åœ¨æœ‰é€šçŸ¥æ—¶æ›´æ”¹é¢œè‰²ã€‚</font><font style="vertical-align: inherit;">æœ‰ç‚¹åƒGithubé€šçŸ¥ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œä¸€äº›å¸®åŠ©ç¨‹åºåŠŸèƒ½ç”¨äºåˆ›å»ºé€šçŸ¥å­—ç¬¦ä¸²ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = routeNotification(notification);
    <span class="hljs-keyword">var</span> notificationText = makeNotificationText(notification);
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;li&gt;&lt;a href="'</span> + to + <span class="hljs-string">'"&gt;'</span> + notificationText + <span class="hljs-string">'&lt;/a&gt;&lt;/li&gt;'</span>;<font></font>
}<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">routeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = <span class="hljs-string">'?read='</span> + notification.id;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {<font></font>
        to = <span class="hljs-string">'users'</span> + to;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/'</span> + to;<font></font>
}<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotificationText</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {
        <span class="hljs-keyword">const</span> name = notification.data.follower_name;<font></font>
        text += <span class="hljs-string">'&lt;strong&gt;'</span> + name + <span class="hljs-string">'&lt;/strong&gt; followed you'</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> text;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„æ–‡ä»¶ä¸­</font></font><code>app.scss</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//... </span>
<span class="hljs-comment">#notifications.has-notifications {</span>
  color: <span class="hljs-comment">#bf5329</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ç¼–è¯‘èµ„äº§ï¼š</font></font><br>
<br>
<pre><code class="php hljs">npm run dev</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œå¦‚æœæ‚¨å°è¯•è®¢é˜…ç”¨æˆ·ï¼Œåˆ™è¯¥ç”¨æˆ·å°†æ”¶åˆ°é€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">å½“ä»–å•å‡»å®ƒæ—¶ï¼Œä»–å°†è¢«é‡å®šå‘åˆ°</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œé€šçŸ¥æœ¬èº«ä¹Ÿæ¶ˆå¤±äº†ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°å¸–é€šçŸ¥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ç”¨æˆ·å‘å¸ƒæ–°å¸–å­æ—¶ï¼Œæˆ‘ä»¬å°†é€šçŸ¥è®¢é˜…è€…ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªé€šçŸ¥ç±»å¼€å§‹ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:notification NewPost</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä¿®æ”¹ç”Ÿæˆçš„ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ..</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">User</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewArticle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">// ..</span>
    <span class="hljs-keyword">protected</span> $following;
    <span class="hljs-keyword">protected</span> $post;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">User $following, Post $post</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;following = $following;
        <span class="hljs-keyword">$this</span>-&gt;post = $post;<font></font>
    }<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>];<font></font>
    }<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDatabase</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'following_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;id,
            <span class="hljs-string">'following_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;name,
            <span class="hljs-string">'post_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;post-&gt;id,<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å‘é€é€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å–œæ¬¢ä½¿ç”¨é›„è¾©çš„è§‚å¯Ÿè€…ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä¸ºPoståˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œå¹¶ç›‘å¬å…¶äº‹ä»¶ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼š</font></font><code>app/Observers/PostObserver.php</code><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Observers</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">NewPost</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostObserver</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">created</span>(<span class="hljs-params">Post $post</span>)
    </span>{<font></font>
        $user = $post-&gt;user;<font></font>
        <span class="hljs-keyword">foreach</span> ($user-&gt;followers <span class="hljs-keyword">as</span> $follower) {<font></font>
            $follower-&gt;notify(<span class="hljs-keyword">new</span> NewPost($user, $post));<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶ååœ¨</font></font><code>AppServiceProvider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹ä½ç½®</font><font style="vertical-align: inherit;">æ³¨å†Œè§‚å¯Ÿè€…</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Observers</span>\<span class="hljs-title">PostObserver</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppServiceProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceProvider</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boot</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Post::observe(PostObserver::class);<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬åªéœ€è¦æ ¼å¼åŒ–æ¶ˆæ¯ä»¥åœ¨JSä¸­æ˜¾ç¤ºï¼š</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">const</span> NOTIFICATION_TYPES = {
    <span class="hljs-attr">follow</span>: <span class="hljs-string">'App\\Notifications\\UserFollowed'</span>,
    <span class="hljs-attr">newPost</span>: <span class="hljs-string">'App\\Notifications\\NewPost'</span><font></font>
};<font></font>
<span class="hljs-comment">//...</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">routeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = <span class="hljs-string">`?read=<span class="hljs-subst">${notification.id}</span>`</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {<font></font>
        to = <span class="hljs-string">'users'</span> + to;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.newPost) {
        <span class="hljs-keyword">const</span> postId = notification.data.post_id;<font></font>
        to = <span class="hljs-string">`posts/<span class="hljs-subst">${postId}</span>`</span> + to;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/'</span> + to;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotificationText</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {
        <span class="hljs-keyword">const</span> name = notification.data.follower_name;<font></font>
        text += <span class="hljs-string">`&lt;strong&gt;<span class="hljs-subst">${name}</span>&lt;/strong&gt; followed you`</span>;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.newPost) {
        <span class="hljs-keyword">const</span> name = notification.data.following_name;<font></font>
        text += <span class="hljs-string">`&lt;strong&gt;<span class="hljs-subst">${name}</span>&lt;/strong&gt; published a post`</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> text;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ï¼</font><font style="vertical-align: inherit;">é€šçŸ¥ç”¨æˆ·è®¢é˜…å’Œæ–°å¸–å­ï¼</font><font style="vertical-align: inherit;">è‡ªå·±å°è¯•ï¼</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨Pusherå®æ—¶é€€å‡º</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯æ—¶å€™ä½¿ç”¨Pusheré€šè¿‡Webå¥—æ¥å­—æ¥æ”¶å®æ—¶é€šçŸ¥äº†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pusher.comä¸Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨å†Œå…è´¹çš„Pusherå¸æˆ·</font><font style="vertical-align: inherit;">å¹¶åˆ›å»ºä¸€ä¸ªæ–°åº”ç”¨ã€‚</font></font><br>
<br>
<pre><code class="php hljs">...<font></font>
BROADCAST_DRIVER=pusher<font></font>
PUSHER_KEY=<font></font>
PUSHER_SECRET=<font></font>
PUSHER_APP_ID=</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨é…ç½®æ–‡ä»¶ä¸­ä¸ºæ‚¨çš„å¸æˆ·è®¾ç½®å‚æ•°</font></font><code>broadcasting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
    <span class="hljs-string">'connections'</span> =&gt; [
            <span class="hljs-string">'pusher'</span> =&gt; [
                <span class="hljs-comment">//...</span>
                <span class="hljs-string">'options'</span> =&gt; [
                    <span class="hljs-string">'cluster'</span> =&gt; <span class="hljs-string">'eu'</span>,
                    <span class="hljs-string">'encrypted'</span> =&gt; <span class="hljs-literal">true</span><font></font>
                ],<font></font>
            ],<font></font>
    <span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åæˆ‘ä»¬å°†</font></font><code>App\Providers\BroadcastServiceProvider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ•°ç»„ä¸­</font><font style="vertical-align: inherit;">æ³¨å†Œ</font></font><code>providers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-string">'providers'</span> =&gt; [
    <span class="hljs-comment">// ...</span><font></font>
    App\Providers\BroadcastServiceProvider<font></font>
    <span class="hljs-comment">//...</span><font></font>
],<font></font>
<span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬éœ€è¦ä»Puâ€‹â€‹sherå®‰è£…PHP SDKå’ŒLaravel Echoï¼š</font></font><br>
<br>
<pre><code class="php hljs">composer <span class="hljs-keyword">require</span> pusher/pusher-php-server<font></font>
npm install --save laravel-<span class="hljs-keyword">echo</span> pusher-js</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬éœ€è¦è®¾ç½®å¹¿æ’­é€šçŸ¥æ•°æ®ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä¿®æ”¹é€šçŸ¥</font></font><code>UserFollowed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFollowed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">// ..</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>, <span class="hljs-string">'broadcast'</span>];<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;id,
            <span class="hljs-string">'read_at'</span> =&gt; <span class="hljs-literal">null</span>,
            <span class="hljs-string">'data'</span> =&gt; [
                <span class="hljs-string">'follower_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;id,
                <span class="hljs-string">'follower_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;name,<font></font>
            ],<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å’Œ</font></font><code>NewPost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewPost</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>, <span class="hljs-string">'broadcast'</span>];<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;id,
            <span class="hljs-string">'read_at'</span> =&gt; <span class="hljs-literal">null</span>,
            <span class="hljs-string">'data'</span> =&gt; [
                <span class="hljs-string">'following_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;id,
                <span class="hljs-string">'following_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;name,
                <span class="hljs-string">'post_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;post-&gt;id,<font></font>
            ],<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬éœ€è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯æ›´æ–°æˆ‘ä»¬çš„JSã€‚</font><font style="vertical-align: inherit;">æ‰“å¼€</font></font><code>app.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-built_in">window</span>.Pusher = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pusher-js'</span>);
<span class="hljs-keyword">import</span> Echo <span class="hljs-keyword">from</span> <span class="hljs-string">"laravel-echo"</span>;
<span class="hljs-built_in">window</span>.Echo = <span class="hljs-keyword">new</span> Echo({
    <span class="hljs-attr">broadcaster</span>: <span class="hljs-string">'pusher'</span>,
    <span class="hljs-attr">key</span>: <span class="hljs-string">'your-pusher-key'</span>,
    <span class="hljs-attr">cluster</span>: <span class="hljs-string">'eu'</span>,
    <span class="hljs-attr">encrypted</span>: <span class="hljs-literal">true</span><font></font>
});<font></font>
<span class="hljs-keyword">var</span> notifications = [];
<span class="hljs-comment">//...</span>
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span>(Laravel.userId) {
        <span class="hljs-comment">//...</span>
        <span class="hljs-built_in">window</span>.Echo.private(<span class="hljs-string">`App.User.<span class="hljs-subst">${Laravel.userId}</span>`</span>)<font></font>
            .notification(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> {<font></font>
                addNotifications([notification], <span class="hljs-string">'#notifications'</span>);<font></font>
            });<font></font>
    }<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»…æ­¤è€Œå·²ã€‚</font><font style="vertical-align: inherit;">é€šçŸ¥æ˜¯å®æ—¶æ·»åŠ çš„ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºï¼Œå¹¶æŸ¥çœ‹é€šçŸ¥çš„æ›´æ–°æ–¹å¼ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pusherå…·æœ‰éå¸¸äººæ€§åŒ–çš„APIï¼Œå®ƒä½¿å®æ—¶äº‹ä»¶çš„å®ç°å˜å¾—å¼‚å¸¸ç®€å•ã€‚</font><font style="vertical-align: inherit;">ç»“åˆLaravelé€šçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªåœ°æ–¹é€šè¿‡å¤šä¸ªæ¸ é“ï¼ˆç”µå­é‚®ä»¶ï¼ŒSMSï¼ŒSlackç­‰ï¼‰å‘é€é€šçŸ¥ã€‚</font><font style="vertical-align: inherit;">åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†åœ¨ä¸€ä¸ªç®€å•åšå®¢ä¸­è·Ÿè¸ªç”¨æˆ·æ´»åŠ¨çš„åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨ä¸Šè¿°å·¥å…·å¯¹å…¶è¿›è¡Œäº†æ”¹è¿›ï¼Œä»¥è·å¾—ä¸€äº›æµç•…çš„å®æ—¶åŠŸèƒ½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pusherå’ŒLaravelå…·æœ‰æ›´å¤šé€šçŸ¥ï¼šä¸²è”æœåŠ¡å¯è®©æ‚¨å°†å‘å¸ƒ/è®¢é˜…æ¶ˆæ¯å®æ—¶å‘é€åˆ°æµè§ˆå™¨ï¼Œç§»åŠ¨ç”µè¯å’ŒIOTè®¾å¤‡ã€‚</font><font style="vertical-align: inherit;">è¿˜æœ‰ä¸€ä¸ªç”¨äºè·å–åœ¨çº¿/ç¦»çº¿ç”¨æˆ·çŠ¶æ€çš„APIã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯·å‚é˜…ä»–ä»¬çš„æ–‡æ¡£ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusheræ–‡æ¡£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusheræ•™ç¨‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laravelæ–‡æ¡£</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œä»¥äº†è§£æœ‰å…³å…¶ä½¿ç”¨å’ŒçœŸæ­£æ½œåŠ›çš„æ›´å¤šä¿¡æ¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨æœ‰ä»»ä½•æ„è§ï¼Œé—®é¢˜æˆ–å»ºè®®ï¼Œè¯·éšæ—¶åœ¨ä¸‹é¢çš„è¯„è®ºä¸­åˆ†äº«ï¼</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†è§£æœ‰å…³è¯¥è¯¾ç¨‹çš„æ›´å¤šä¿¡æ¯ã€‚</font></font><br>
</a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496634/index.html">ç”³è¯·å­¦æ ¡21</a></li>
<li><a href="../zh-CN496638/index.html">Fï¼ƒï¼Œè¿æ¥å›¾åƒç»„ä»¶çš„æ ‡è®°ç®—æ³•</a></li>
<li><a href="../zh-CN496640/index.html">Covid-19ï¼šä¿„ç½—æ–¯çš„ä¸šåŠ¡å°†ä¼šå‘ç”Ÿä»€ä¹ˆ[ä»¥åŠä»€ä¹ˆæ—¶å€™ç»“æŸ]</a></li>
<li><a href="../zh-CN496642/index.html">ç°ä»£é™æ€å’Œæ—‹è½¬å¼UPSçš„æ¯”è¾ƒã€‚é™æ€UPSæ˜¯å¦å·²è¾¾åˆ°æé™ï¼Ÿ</a></li>
<li><a href="../zh-CN496650/index.html">FarSee-Netæ–‡ç« è¯„è®º-å®æ—¶è¯­ä¹‰åˆ†å‰²çš„æ–°æ–¹æ³•</a></li>
<li><a href="../zh-CN496654/index.html">ç¬¬35æœŸï¼šITåŸ¹è®­-é¢†å…ˆå…¬å¸çš„å½“å‰é—®é¢˜å’ŒæŒ‘æˆ˜</a></li>
<li><a href="../zh-CN496664/index.html">ä¸åŒçš„å·¥ä½œï¼Œé»‘è‰²ï¼Œç™½è‰²ï¼Œçº¢è‰²</a></li>
<li><a href="../zh-CN496666/index.html">æˆ‘ä»¬ç ”ç©¶äº†Mediastreamer2 VoIPå¼•æ“ã€‚ç¬¬8éƒ¨åˆ†</a></li>
<li><a href="../zh-CN496670/index.html">å¤§æµè¡Œåç¤¾ä¼šä¼šæ”¹å˜å—ï¼Ÿ</a></li>
<li><a href="../zh-CN496672/index.html">ä½¿ç”¨IDA FREEå’Œå…¶ä»–å…è´¹å·¥å…·è¿›è¡Œå¼€å‘å’Œé€†å‘ä»‹ç»ã€‚ç¬¬2ç« </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>