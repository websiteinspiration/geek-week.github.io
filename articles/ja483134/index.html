<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📍 👏🏽 🐗 二要素認証テストと可能な回避策 🍨 🧛🏿 🌤️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="情報セキュリティの複雑な科学を理解し始める前から、2FA認証はアカウントを保護するための保証された方法であり、「これらのハッカー」は、たとえば、私の内部通貨を引き出してゲームアカウントのキャラクターの服を購入することはできないようです。しかし、時間の経過とともに、2要素認証システムに多数の脆弱性が存...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>二要素認証テストと可能な回避策</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483134/"><img src="https://habrastorage.org/webt/g8/rq/pf/g8rqpf1rdulkehqbd2aromukw5q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報セキュリティの複雑な科学を理解し始める前から、2FA認証はアカウントを保護するための保証された方法であり、「これらのハッカー」は、たとえば、私の内部通貨を引き出してゲームアカウントのキャラクターの服を購入することはできないようです。しかし、時間の経過とともに、2要素認証システムに多数の脆弱性が存在する可能性があることが実験的に証明されています。&nbsp;</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単に言えば、2要素認証は、セキュリティを強化するために生成されたコードを入力し、移動中または開始前に条件付きハッカーのホイールにスティックを投げ込むことによるアクションの確認です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを使用した検証システムは非常に普及しており、さまざまなサイトのどこでも使用されており、プライマリログインとセカンダリログインの両方に接続できます。ただし、これはアプリケーションに限定されるものではありません。開発者は、パスワード回復機能の確認、登録/サブスクリプションの確認、金融取引の追加確認、パスワード変更、個人データの変更を添付します。また、2FAは時々、ログアウト後のタイミングの壁として使用され、パスワードやその他の確認方法としては使用されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、2FAの脆弱性とその悪用をテストする方法と、特定の種類の攻撃に対する既存の保護を回避するための可能なオプションを収集しました。</font><font style="vertical-align: inherit;">2FAに該当する脆弱性のチェックのリストを見てみましょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.レート制限の欠如</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レートリミットアルゴリズムは、ユーザーセッション（またはIPアドレス）の試行または速度を制限できるかどうか、およびこれが発生する状況をテストするために使用されます。ユーザーが一定期間内に多数のリクエストを完了した場合、Webアプリケーションは429コード（多くのリクエスト）で応答するか、エラーを表示せずにレート制限を適用できます。レート制限がないことは、通常の列挙中に試行回数や速度に制限がないことを意味します。セッション/トークンの有効期間内にコードを何度でも（任意の速度で）反復できます。</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、「サイレント」レート制限に対処する必要があります。エラーがなく、後続のリクエストで本文/ HTTPコードが変更されない場合は、早すぎることに満足している必要があります。まず、有効なコードを使用して攻撃の最終結果を確認する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.レート制限はありますが、回避できます</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前に会わなければならなかったケース：</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）一定の速度に達した後、詰まりのない流れの速度を制限する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、セキュリティ研究者は5つ以上のスレッドを使用してコードをピックアップし、攻撃を高速化しようとします（Burp Intruderでは、デフォルトのスレッド数は遅延なしで5です）。ただし、バスティングからのセキュリティシステムまたは通常のロードバランサーがこの単一の要素にしか対応できない場合があります。 5スレッドでブルートフォースを実行しようとしている場合は、数を1に減らしてから、1秒の遅延で1に減らす必要があります。以前、私はそのような動作を観察することができて幸運でした。そのような操作の助けを借りて、コードの選択が成功し、それがアカウント乗っ取りにつながりました。 2FAコードに特定の有効期限がない場合、並べ替えるのに多くの時間があります。有効期間が存在する場合、攻撃の成功は減少しますが、脆弱性の潜在的な危険は依然として存在します。まだ正しいコードに入る可能性があるので。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）生成されたOTPコードは変更されません</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、Google Authenticatorのように絶えず変化するコードには適用されませんが、SMS、メール、またはメッセンジャーを介して直接受信される静的なコードにのみ適用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このバイパスの本質は、同じOTPコードが絶え間なく送信されるか、しばらくの間（たとえば5分間）送信されることです。これは、この間ずっと有効です。</font><font style="vertical-align: inherit;">また、サイレントレート制限が発生しないようにすることも重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レポートの例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hackerone.com/reports/420163</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションが001から999までのランダムコードを生成して電話に送信するとします。「再送信」機能が有効になっている場合、10分以内に同じコードが取得されます。ただし、レート制限はリクエストにバインドされているため、リクエストトークンごとの試行回数が制限されます。絶えず新しいコードをリクエストし、新しいリクエストトークンを生成し、それを後続のリクエストに適用し（burpスイートでgrep-matchを使用するか、独自のスクリプトを使用）、001から999までの範囲のブルートフォースを実行します。したがって、常に新しいリクエストトークンを使用します正しいコードは変更されず、一定期間静的であるため、正常に選択されます。この攻撃の制限は、長い番号、または確認コードとしての文字と数字の混合です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この状況は推奨されません。ランダムに生成されるため、生成されたコードがリストのこの部分に含まれる可能性があるため、リストの少なくとも一部を整理する必要があります。</font><font style="vertical-align: inherit;">試すときはランダムに頼る必要がありますが、それでも正しい組み合わせに入る可能性があります。これは明らかに修正する必要がある脆弱性を証明します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3）コードを更新するときにrate-limit-aをリセットします。</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コード検証リクエストにはレート制限が存在しますが、コードを再送信する機能をアクティブ化した後、それはリセットされ、コードのブルートフォースを継続することができます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レポートの例：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">//hackerone.com/reports/149598、-</font></a><font style="vertical-align: inherit;">理論; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hackerone.com/reports/205000</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、以前のレポートに基づく実践的なエクスプロイト。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4）IPアドレスを変更してレート制限を回避する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのロックは、IPからの要求の受信制限に基づいており、要求の実行時に特定の試行回数のしきい値に達しています。</font><font style="vertical-align: inherit;">IPアドレスが変更された場合、この制限を回避する機会があります。</font><font style="vertical-align: inherit;">この方法を確認するには、プロキシサーバー/ VPNを使用してIPを変更し、ブロッキングがIPに依存しているかどうかを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPを変更する方法：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Burp Suite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/RhinoSecurityLabs/IPRotate_Burp_Extensionの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IP Rotatorアドオンを使用した攻撃でプロキシを使用できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私の意見では、これは最良の選択です。無制限のブルートフォース試行と42xエラーや中断なしのブルートフォース攻撃を可能にするIPアドレスを提供するからです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">良いオプションは、プロキシ要求モジュールを備えたpythonスクリプトかもしれませんが、最初に、どこかに多数の有効なプロキシを取得する必要があります。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPローテーションツールはAWS IPアドレスを使用してリクエストを送信するため、WebアプリケーションがCloudFlareファイアウォールの背後にある場合、すべてのリクエストがブロックされます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5b/ep/c4/5bepc4djncwcbel-6gxkjfzh1ro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、元のウェブサーバーのIPをさらに検出するか、AWS IPアドレスに関係のないメソッドを見つける必要があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5）サイトにはX-Forwarded-Forのサポートが含まれています</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み込みヘッダーX-Forwarded-Forを使用してIPを変更できます。</font><font style="vertical-align: inherit;">アプリケーションにこのヘッダーの組み込み処理がある場合は、X-Forwarded-For：desired_IPを送信してIPを置き換え、追加のプロキシを使用せずに制限をバイパスします。</font><font style="vertical-align: inherit;">X-Forwarded-Forからリクエストが送信されるたびに、Webサーバーは、IPアドレスがヘッダーを介して送信された値と一致すると見なします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このトピックに関する材料：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hackerone.com/reports/225897 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">medium.com/@arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.別のアカウントのセッションからのリクエストの一部を置き換えることにより、2faをバイパスします</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リクエスト内のコードを確認するために特定の値を持つパラメーターが送信される場合は、リクエストから別のアカウントに値を送信してみてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、OTPコードを送信すると、コードの送信に関連付けられているフォームID、ユーザーID、またはCookieがチェックされます。</font><font style="vertical-align: inherit;">コード検証をバイパスするアカウント（アカウント1）のパラメーターのデータを完全に異なるアカウント（アカウント2）のセッションに適用すると、コードを受け取って2番目のアカウントに入力し、最初のアカウントの保護をバイパスできます。</font><font style="vertical-align: inherit;">ページをリロードすると、2FAが消えます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.「記憶機能」を使用して2FAをバイパスする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2FA承認をサポートする多くのサイトには、「記憶」機能があります。</font><font style="vertical-align: inherit;">ユーザーが以降のログインで2FAコードを入力したくない場合に便利です。</font><font style="vertical-align: inherit;">2FAが「記憶」される方法を特定することが重要です。</font><font style="vertical-align: inherit;">Cookie、セッション/ローカルストレージの値、またはIPアドレスに2FAをアタッチするだけの場合があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）Cookieを使用して2FAが添付されている場合、Cookieの値は推測できないものにする必要があります</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、Cookieがアカウントごとに増加する一連の数値で構成されている場合、Cookieの値にブルートフォース攻撃を適用して2FAをバイパスすることは十分に可能です。</font><font style="vertical-align: inherit;">開発者は、Cookieを（キーセッションCookieおよびCSRFトークンとともに）HttpOnly属性とともに提供する必要があります。これにより、XSSを使用して盗まれたり、2FAをバイパスするために使用されたりすることはありません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）2FAがIPアドレスに接続されている場合は、それを交換してみることができます</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法を特定するには、2FAメモリー機能を使用してアカウントにログインし、別のブラウザーまたは現在のブラウザーのシークレットモードに切り替えて、再度ログインしてみます。 2FAがまったく要求されない場合、2FAがIPアドレスにアタッチされています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPアドレスを置き換えるには、ログインとパスワードを入力する段階でX-Forwarded-Forヘッダーを使用できます（Webアプリケーションでサポートされている場合）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このヘッダーを使用すると、アカウント設定に「IPアドレスホワイトリスト」機能が存在する場合、それをバイパスすることもできます。</font><font style="vertical-align: inherit;">追加のアカウント保護として2FAと組み合わせて使用​​できます。または、IPアドレスがホワイトリストと一致する場合（ユーザーの同意がある場合）は2FAも要求されない場合があります。</font><font style="vertical-align: inherit;">したがって、2FAをIPアドレスに付加しなくても、関連する保護方法を回避することで2FAを回避できる場合があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、2FAをIPアドレスに接続することは、完全に安全な保護方法ではありません。同じネットワーク上にいる場合、静的IPアドレスを使用して同じVPN /インターネットサービスプロバイダーに接続すると、2FAがバイパスされる可能性があるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分自身を保護する最も安全な方法は、2FAをまったく覚えていないことで、ユーザビリティが損なわれることです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. 2FA入力ページの不適切なアクセス制御バグ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2FAを入力するためのダイアログページが、パラメータ付きのURLとして表示される場合があります。</font><font style="vertical-align: inherit;">URLにパラメーターがあり、ページの生成に使用されたものと一致しないCookieが含まれているページや、Cookieがまったくないページへのアクセスは安全ではありません。</font><font style="vertical-align: inherit;">しかし、開発者がリスクを受け入れることを決定した場合は、いくつかの重要なポイントを通過する必要があります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクは2FA入力で期限切れになりますか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクが検索エンジンで索引付けされているかどうか。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンクの寿命が長い場合、または検索エンジンに2FA入力用の有効なリンクが含まれている場合/リンクにインデックスを付けることができる場合（robots.txt /メタタグにルールがない場合）、2FA入力ページで2FAバイパスメカニズムを使用する可能性があります。ログインとパスワードを完全にバイパスし、他の誰かのアカウントにアクセスする。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. 2FAページの個人データの不適切な検閲</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページでOTPコードを送信する場合、検閲は電子メール、電話番号、ニックネームなどの個人データを保護するために使用されます。ただし、このデータは、APIエンドポイントや、2FAの段階で十分な権限を持つその他のリクエストで完全に開示できます。最初はこのデータがわからなかった場合、たとえば、電話番号を知らずにログインのみを入力した場合、これは情報開示の脆弱性と見なされます。電話番号やメールを知ることは、その後のフィッシング攻撃やブルートフォース攻撃に利用される可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Credentials Stuffingを使用して脆弱性を悪用する例。パブリックドメインに、サイトAのログインとパスワードを含むデータベースがあるとします。攻撃者は、サイトBにあるこのデータベースのデータを使用できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まず、パスワードの登録/回復で「アカウント列挙」バグを使用して、サイトBのデータベースにユーザーが存在するかどうかを確認します。</font><font style="vertical-align: inherit;">通常、多くのサイトはこれを脆弱性と見なしておらず、リスクを冒しています。</font><font style="vertical-align: inherit;">「脆弱性」は、サイトへのユーザー登録の事実に関するエラーの存在にあります。</font><font style="vertical-align: inherit;">理想的には、パスワード回復ページの安全なメッセージは次のとおりです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mh/qe/mh/mhqemhmykfiy5pcl-35konzb0dm.png"><br>
<br>
<img src="https://habrastorage.org/webt/ha/uu/ze/hauuzewqlj9escx9nc8fslz4a0o.png"></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者は既存のユーザーのデータベースを入手した後、これらのアカウントにパスワードを適用します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2FAに遭遇すると、行き詰まります。</font><font style="vertical-align: inherit;">ただし、ユーザーデータの検閲が不十分な場合は、データベースに個人データを追加できます（元のデータベースになかった場合）。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.特定の状況で2FAを無視する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アカウントへの自動ログインにつながるいくつかのアクションを実行すると、2FAが要求されない場合があります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）パスワードの回復時に2FAを無視する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのサービスは、パスワードの回復手順を完了すると、自動的にアカウントにログインします。</font><font style="vertical-align: inherit;">アカウントへのアクセスは即座に提供されるため、2FAアカウントにログインすると、そのアカウントは無視され、完全に無視されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近送信した同様のハッカーロンレポートの影響：</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者が被害者のメールにアクセスできる場合（フィッシング、ブルートフォース攻撃、資格情報の詰め込みなどを使用してアカウントをハッキングできる）、2FAをバイパスできますが、この場合、2FAがアカウントを保護する必要があります。</font><font style="vertical-align: inherit;">現時点では、2FAの場合、Google認証システムコードまたはバックアップコードのチェックはありますが、メールのコードはチェックされていないため、このバイパスは理にかなっています。</font></font></blockquote><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）ソーシャルネットワーク経由でログインするときに2FAを無視する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーアカウントにソーシャルネットワークを接続して、アカウントにすばやくログインすると同時に2FAを設定できます。</font><font style="vertical-align: inherit;">ソーシャルネットワーク経由でアカウントにログインする場合、2FAは無視できます。</font><font style="vertical-align: inherit;">被害者のメールがハッキングされた場合、ソーシャルネットワークアカウントのパスワードを回復し（許可されている場合）、2FAを入力せずにサービスに入ることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レポートの1つの影響：</font></font><br>
<blockquote><ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前に送信されたOAuthの誤った構成＃577468など、他の多くの脆弱性がアカウントを完全にキャプチャし、2FAを克服します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者がユーザーの電子メールに侵入した場合、ソーシャルネットワークアカウントへのアクセスを回復し、追加の確認なしでアカウントにログインしようとする可能性があります。</font></font></li>
<li>      ,              ,   2FA   /.</li>
</ol></blockquote><h4>3)  2FA     </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者は多くの場合、特定の機能をテストするために、Webアプリケーションのステージングバージョンをドメイン/サブドメインに追加します。興味深いことに、ユーザー名とパスワードを使用してログインした場合、2FAは要求されません。おそらく、開発者は、2FAの保護がない、2FA自体が無効になっている、またはテストのために意図的に無効にされている古いバージョンのアプリケーションを使用しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に他の脆弱性を確認することもできます-実稼働バージョンのデータベースにメールが存在するステージングサーバーに新しいユーザーを登録すると、実稼働の個人データが提供されます。パスワードの回復などの重要な機能にレート制限がない。最新の脆弱性の例は、15,000ドルのFacebookバグで、これにより、beta.facebook.comのブルートフォースパスワード回復コードを使用してアカウントをハッキングすることができました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4）クロスプラットフォームの場合は2FAを無視する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モバイルまたはデスクトップバージョンでの2FAの実装は、アプリケーションのWebバージョンと異なる場合があります。</font><font style="vertical-align: inherit;">2FAはWebバージョンよりも弱いか、完全に存在しない可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. 2FAを無効にする場合、現在のコードは要求されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2FAを無効にするときに、Google認証システムアプリケーションからの現在のコード、メール/電話からのコードなど、追加の確認が要求されない場合、この場合、特定のリスクがあります。</font><font style="vertical-align: inherit;">クリーンなリクエストでは、CSRF攻撃の可能性があります。</font><font style="vertical-align: inherit;">CSRF保護のバイパスベクトルが検出された場合（存在する場合）、2FAを無効にできます。</font><font style="vertical-align: inherit;">クリックジャッキングの脆弱性も使用できます-疑いを持たないユーザーが数回クリックすると、2FAが切断されます。</font><font style="vertical-align: inherit;">以前のコードの検証は、潜在的なCSRF / XSS /クリックジャッキング攻撃、およびCORSの設定ミスを考慮して、追加の2FA保護を追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
hackerone.comの例を紹介します。1つのフォームで2FAをオフにすると、2つの変数を同時に入力する必要があります。Googleの認証アプリケーションとパスワードを含む現在のコードです。</font><font style="vertical-align: inherit;">これが最善かつ推奨される防御策です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wg/hh/jz/wghhjzf5sdotqin6knlde5i4g5q.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.以前に作成されたセッションは、2FAのアクティブ化後も有効のままです</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2FAが有効になっている場合、同じアカウントでの並列セッションが終了し、同じ2FA入力ダイアログが表示され、パスワードが変更された場合と同じです。</font><font style="vertical-align: inherit;">アカウントが危険にさらされており、被害者の最初の反応が2FAの組み込みである場合、攻撃者のセッションは無効になり、次のログインとパスワードには2FAが必要になります。</font><font style="vertical-align: inherit;">全体として、これは従うべきベストプラクティスです。</font><font style="vertical-align: inherit;">暗号通貨交換が同様の保護をどのように追加するかに気づきます。</font><font style="vertical-align: inherit;">HackerOneのサンプルレポートは</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 https://hackerone.com/reports/534450です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.アカウントにレート制限がない</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2FAは、ユーザーの個人アカウントのさまざまな機能に実装して、セキュリティを強化できます。</font><font style="vertical-align: inherit;">これは、電子メールアドレス、パスワードの変更、金融取引のコード変更の確認などです。</font><font style="vertical-align: inherit;">アカウントへのrate-limit-aの存在は、アカウント入力時の2FAでのrate-limit-aの存在とは異なる場合があります。</font><font style="vertical-align: inherit;">入り口で「厳格な」レート制限が設定されているときに、私のアカウントで2FAコードを自由に選択できる場合に、私はよく似たケースに遭遇しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者が最初に不正なデータ変更に対する保護を追加した場合、この保護はすべての可能なバイパスによってサポートおよび修正される必要があります。</font><font style="vertical-align: inherit;">バイパスが見つかった場合、これは、開発者によって実装されたセキュリティ機能のバイパスの脆弱性と見なされます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. APIバージョンの操作</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webアプリケーションのリクエストに/ v * /のようなものが表示される場合（*は数字）、APIの古いバージョンに切り替えることができる可能性があります。古いバージョンのAPIでは、保護が弱いか、まったく保護されていない場合があります。これはかなりまれなことであり、開発者が本番環境/ステージング環境で古いバージョンのAPIを削除し忘れた場合に発生します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、/ endpoint / api / v4 / loginは、ユーザー名とパスワードを確認してログインリクエストを実行します。アカウントに2FAが存在する場合、このリクエストの後に/エンドポイント/ api / v4 / 2fa_checkが続く必要があります。 2FAより前のAPIバージョンを置き換えると、場合によってはそれを回避できます。 /エンドポイント/ api / v3 /ログインは/エンドポイント/ v3 / login_successful？コード=ランダムにつながる可能性があります。このバージョンのAPIでは2FAが単に実装されていないため、2fa_checkを無視します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;別の例-リクエスト/エンドポイント/ api / v4 / 2fa_checkにはレート制限がありますが、/エンドポイント/ api / v3 / 2fa_checkを使用すると、制限なしでコードを反復できます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11.バックアップコードのリクエストにおける不適切なアクセス制御</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックアップコードは、2FAが有効になった直後に生成され、1つのリクエストで使用できます。</font><font style="vertical-align: inherit;">要求に対する後続の各呼び出しの後、コードは新しいコードによって生成されるか、変更されないままであることができます（静的コード）。</font><font style="vertical-align: inherit;">CORSの設定ミス/ XSSの脆弱性、およびバックアップコード表示エンドポイントの応答リクエストからバックアップコードを「プル」できる他のバグがある場合、ユーザー名とパスワードがわかっている場合、攻撃者はコードを盗み、2FAをバイパスする可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、2faはアカウントを保護するための最も信頼できる方法の1つです。ただし、もちろん、開発者がWebアプリケーションのすべてのユーザーの現在の2FAコードを管理パネルに保存している場合を除きます。これは私の慣例です。また、一部の企業の開発者は独自の2FAコードを生成するためのアプリケーションを作成します（例：Salesforce、Valve）。また、セキュリティが不十分なため、他の認証アプリケーションの使用からの独立性が強調されているため、攻撃者は2FAをバイパスするための追加のエントリポイントを提供します。この保護の適用範囲は非常に広く、2FA保護をバイパスしたい人に、より多くの機会、創造性のためのスペースを与え、2FAバイパスのバリエーションの数を増やします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この情報が、情報セキュリティ研究者、バグバウンティハンター、および開発者が開発中のサービスの脆弱性の数を最小限に抑えるのに役立つことを願っています。</font><font style="vertical-align: inherit;">おげんきで！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483120/index.html">楕円投影でカードを接続する方法（これが提供されていない場合）</a></li>
<li><a href="../ja483124/index.html">近い将来最も大きなガジェット（スマートフォンではない）</a></li>
<li><a href="../ja483126/index.html">極低温暴露により、損傷した電気自動車バッテリーの安全な輸送を確保できます</a></li>
<li><a href="../ja483130/index.html">スーツケースのロックのコードを忘れた場合はどうすればよいですか？</a></li>
<li><a href="../ja483132/index.html">望遠鏡の設計と製造</a></li>
<li><a href="../ja483136/index.html">購入前の中古MacBookの確認-チェックリスト</a></li>
<li><a href="../ja483140/index.html">ポリゴン別世界：Amiga 500</a></li>
<li><a href="../ja483142/index.html">Quake 3をRustに移植する</a></li>
<li><a href="../ja483144/index.html">科学者He Jiankuiはヒーローであり、犯罪者ではありません</a></li>
<li><a href="../ja483146/index.html">DEFCON 27 Conference。Kraken WiFiワイヤレスハッキングツール</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>