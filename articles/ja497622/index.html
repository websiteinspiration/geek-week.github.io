<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐁 🕰️ 🐭 蛍光画像からの自動COVID-19検出器 🤲🏽 😎 ♠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="このガイドでは、Keras、TensorFlow、およびディープラーニングを使用して、特別に選択されたデータセットでCOVID-19を自動的に検出する方法を学習します。
 
 現在、世界中のほとんどの人と同じように、私はCOVID-19について心から心配しています。私は自分の健康を常に分析し始めてお...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>蛍光画像からの自動COVID-19検出器</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドでは、Keras、TensorFlow、およびディープラーニングを使用して、特別に選択されたデータセットでCOVID-19を自動的に検出する方法を学習します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、世界中のほとんどの人と同じように、私はCOVID-19について心から心配しています。</font><font style="vertical-align: inherit;">私は自分の健康を常に分析し始めており、すでに感染していると疑っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私がこれについて心配すればするほど、実際の症状と心気症の痛みを伴う組み合わせが現れます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">朝目が覚めて少し圧倒されました。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベッドから出たとき、私はすでに鼻から漏れていました（ただし</font><font style="vertical-align: inherit;">、鼻水がCOVID-19の症状ではない</font><font style="vertical-align: inherit;">ことが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在わかっ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ています）。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼はナプキンを取るためにトイレに着いたが、咳もした。</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初はこれをあまり重視しませんでした。花粉症で、東海岸の暖かい気候のため、今年の初めに春が訪れました。ほとんどの場合、私のアレルギーが発生しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、症状は一日中改善しませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、私はここに座って、口の中に温度計を置いてこのマニュアルを書いています。見下ろすと37.4°Cが表示されます。温度は通常の36.3°Cよりも高くなっています。37.2°Cを超えるものはすべて、すでにわずかな熱を考慮しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
咳と少し熱？それはCOVID-19かもしれません...または単に私のアレルギーです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストなしで見つけることは不可能であり、この「無知」こそが、この状況を精神的バランスにとって危険なものにしているのです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人々にとって、未知のものほどひどいものはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての恐れにもかかわらず、私はそれらを合理的な方法で取り除こうとします。私は30歳以上で、体調は良好です。免疫システムは非常に強力です。検疫に行き（念のため）、休憩して通常どおり回復します。 COVID-19は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の個人的な</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康状態</font><font style="vertical-align: inherit;">に関して私を怖がらせません</font><font style="vertical-align: inherit;">（少なくとも私は自分に言い続けます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
でも、慢性疾患の人や老人ホームや病院にいる​​人など、年配の親戚が心配です。それらは脆弱であり、この感染により我々がそれらを失うと本当に悲しいでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
怠惰で座り、弱点に負けないようにするために（アレルギー、COVID-19、または単に不安）、私は自分ができることをすることに決めました-</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを記述して実験を行い、実際のアプリケーションでコンピュータービジョンとディープラーニングを使用する方法を他の人に教えることで、マシンビジョンとディープラーニングのコミュニティ全体に貢献します</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、正直なところ、これは私がこれまで書いた中で最も科学的な記事ではありません。</font><font style="vertical-align: inherit;">実際、ほとんどありません。</font><font style="vertical-align: inherit;">使用される方法とデータセットは公開に値しません。</font><font style="vertical-align: inherit;">しかし、彼らは手助けをしたい人のための出発点になることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私は自分の力ですべてをしたいです。</font><font style="vertical-align: inherit;">この記事は、困難な時代を精神的に克服し、同時に同様の状況にある人々を助けるための私の方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご理解いただければ幸いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日のレッスンでは、次のことを行います。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19が陽性である患者のフルオログラムから一連のオープンデータを収集します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康な患者のフルオログラムのコレクションを収集します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成したセットの画像からCOVID-19を自動的に検出するように畳み込みニューラルネットワークをトレーニングします。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教育的な観点から得られた結果を評価します。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
免責事項：私はすでにほのめかしましたが、私はそれを率直に言います。</font><font style="vertical-align: inherit;">この記事の方法と手法は、教育目的のみを目的としています。</font><font style="vertical-align: inherit;">これは実際の科学的研究ではなく、ジャーナルにも掲載されません。</font><font style="vertical-align: inherit;">この記事は、（1）コンピュータビジョン/ディープラーニングに興味があり、実用的な方法を使用して学習したい読者、および（2）時事問題に関心のある読者を対象としています。</font><font style="vertical-align: inherit;">これに正確に関連していることをお願いします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フルオログラムのCOVID-19</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の部分では、胸部X線写真でCOVID-19を検出する方法について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、データセットを検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、KerasとTensorFlowを使用してディープラーニングモデルをトレーニングし、画像データセットにCOVID-19を定義する方法を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の仕事は、あなたにインスピレーションを与え、コンピュータビジョン/ディープラーニングを研究し、この知識を医療分野に適用することが世界に大きな影響を与える可能性があることを示すことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単に言えば、医学に貢献するために医学の学位は必要ありません。医師やヘルスケアプロバイダーと緊密に連携するディープラーニングスペシャリストは、複雑な問題を解決し、命を救い、世界をより良い場所にすることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドが、まさにそれを実行するためのきっかけとなることを願っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これらすべてが述べ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">られて</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いるにもかかわらず</font><font style="vertical-align: inherit;">、科学雑誌や専門家の評価システムは</font><font style="vertical-align: inherit;">、COVID-19の疑わしい品質の予測モデルを</font><i><font style="vertical-align: inherit;">備えた</font></i><font style="vertical-align: inherit;">資料で</font><i><font style="vertical-align: inherit;">圧倒されてい</font></i><font style="vertical-align: inherit;">ます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事からコード/モデルを取得しないでください。ジャーナルに送信したり、科学サイトのパブリックドメインに配置したりしないでください。ノイズを追加するだけです。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さらに、この記事（またはインターネットからの他のCOVID-19記事）を自分の研究で使用する場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測レポートモデルの作成に関するTRIPODルールを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確認してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらくご存知のとおり、医療におけるAIの使用は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に現実的な結果をもたらし</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。医療専門家との綿密な協議の後にのみ、そのようなモデルを公開または使用してください。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 1. COVID-19の検査が陽性である患者のフルオログラムの例。このような画像でKerasとTensorFlowを使用すると、COVID-19を検出するように分類子をトレーニングできます。COVID-19</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
テストは現在見つけるのが難しく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、単純に十分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">はなく、十分に</font></a><font style="vertical-align: inherit;">速くすることができず、パニックを引き起こします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パニックがある場合、いくつかの卑劣な人々は、このとを活用する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">販売偽の検査キットのCOVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソーシャルネットワークやインスタントメッセンジャーで犠牲者を見つけます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19テストキットの数は限られているので、他の診断方法に頼る必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
医師は、肺炎、肺炎、膿瘍、および/またはリンパ節腫大を診断するために、胸部X線（一般にフルオログラムと呼ばれます）に頼ることがよくあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19は気道の上皮を攻撃し、X線は患者の肺の状態を調べるのに役立ちます。 X線装置はほとんどの病院に設置されているため、特別なテストキットなしでフルオログラフィーを使用してCOVID-19をテストするのが合理的です。欠点は、そのような分析には放射線医学の専門家が必要であり、かなりの時間がかかることです。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、自動化システムの開発は、世界中の医療従事者にとって貴重な時間を節約するうえで非常に貴重です。</font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最近のいくつかの出版物では、コンピューター断層撮影がCOVID-19の診断に適していると示唆していますが、このレッスンでは、フルオログラムのみを扱います。</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセット</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">2.左側は陽性サンプル（感染した患者から）で、右側は陰性です。</font><font style="vertical-align: inherit;">これらの画像は、疾患の存在を自動的に予測するモデルをトレーニングするために使用されます。</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
データセットは</font><font style="vertical-align: inherit;">、モントリオール大学の大学院生である</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって編集され</font><font style="vertical-align: inherit;">ました。</font><font style="vertical-align: inherit;">3月初旬、COVID-19、MERS、SARS、SARSの患者のフルオログラムの収集を開始し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">リポジトリに公開しました</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リポジトリからファイルをダウンロード</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して、それが示されている場所から行を選択する</font><font style="vertical-align: inherit;">必要</font><font style="vertical-align: inherit;">があります</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19の肯定的な結果。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">肺のタイプ「後部前部」（PA）。</font><font style="vertical-align: inherit;">私が理解している限り、これは「健全な」イメージで使用されるイメージのタイプです。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19の陽性症例で合計25のフルオログラムが見つかりました（図2、左）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
健康な患者には、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuggleデータセット（肺炎）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用し、</font><font style="vertical-align: inherit;">健康な患者の画像を25枚選択しました（図2右）。</font><font style="vertical-align: inherit;">このデータセットには多くの問題、つまりノイズが多い/正しくないラベルがありますが、COVID-19自動検出器の概念的なチェックには役立ちます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトの構造</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のWebサイトの[ダウンロード]セクションで、メールアドレスを入力して、このプロジェクトのコード、スクリプト、その他のファイルを含むアーカイブへのリンクを見つけることができます。</font><font style="vertical-align: inherit;">ファイルを抽出すると、ディレクトリ構造が表示されます。</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [25 entries]<font></font>
│   └── normal [25 entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フルオログラムは、</font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つのデータクラスがディレクトリ</font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とに</font><font style="vertical-align: inherit;">分割されているディレクトリに</font><font style="vertical-align: inherit;">あり</font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
両方のスクリプトはデータセットを構築するために提示されていますが、今日は考慮しません。</font><font style="vertical-align: inherit;">代わりに、</font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19検出器を教える</font><font style="vertical-align: inherit;">スクリプト</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">検討</font><font style="vertical-align: inherit;">してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
畳み込みニューラルネットワークの設定に移りましょう。</font><font style="vertical-align: inherit;">ファイル</font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">開き、</font><font style="vertical-align: inherit;">次のコードを貼り付けます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスクリプトでは、TensorFlow 2.0とKerasの多数のディープラーニングライブラリを使用しています。</font><font style="vertical-align: inherit;">さらに、</font><font style="vertical-align: inherit;">機械学習用の標準Pythonライブラリである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">グラフ化用の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">画像の読み込みと処理用の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow 2.0（適切なscikit-learn、OpenCV、およびmatplotlibライブラリを含む）をインストールするには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOSの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手順に従ってください</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、コマンドライン引数を分析し、ハイパーパラメーターを初期化します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドライン引数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：入力データセットへのパス</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学習履歴の終了スケジュールへのオプションのパス。</font><font style="vertical-align: inherit;">特に指定がない限り、デフォルトは</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：出力モデルへのオプションのパス。</font><font style="vertical-align: inherit;">デフォルト</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の行は、初期学習速度、元号の数、およびパケットサイズのハイパーパラメータを初期化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、フルオログラムをダウンロードして前処理する準備ができました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データを読み込むために、カタログ内の画像へのすべてのパスをキャプチャします</font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次に、それぞれについて</font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスからクラスラベル（</font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を取得します</font><font style="vertical-align: inherit;">。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それをロード</font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して前処理し、RGBに変換し、224×224ピクセルにサイズ変更して、ニューラルネットワークで使用できるようにします。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とを</font><font style="vertical-align: inherit;">更新しています</font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ピクセル強度を範囲[0、1]にスケーリングし、データとラベルをNumPy配列形式に変換します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニング/テストのためにデータをセットに分割して</font><font style="vertical-align: inherit;">直接エンコードを実行し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接エンコードとは、データが次の形式に変換されることを意味します。</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンコードされた各ラベルは、 'hot'（1）または 'not'（0）の2つの要素を持つ配列で構成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、次の行でデータを分離し、80％をトレーニングに、20％をテストに残します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルが一般化されていることを確認するために、画像を時計回りまたは反時計回りにランダムに15度回転するように画像を設定して、データの拡張を実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の3行は、データ拡張ジェネレーターオブジェクトを初期化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VGGNetモデルを初期化し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微調整し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の2行は、完全に接続されたレイヤー（FC）に触れることなく、以前にImageNetでトレーニングされた重みを持つVGG16ネットワークのインスタンスを作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、layers </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">構成される、完全に接続された新しいレイヤーを構築し、</font><font style="vertical-align: inherit;">VGG16の上に追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、VGG16 </font><font style="vertical-align: inherit;">の重み</font><font style="vertical-align: inherit;">を固定するため</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">トレーニングされるの</font><font style="vertical-align: inherit;">はFCレイヤー</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のみ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。これでセットアップは完了です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、COVID-19のディープラーニングモデルをコンパイルしてトレーニングする準備ができました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の行は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学習速度</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">下げる</font></a><font style="vertical-align: inherit;">オプション</font><font style="vertical-align: inherit;">とオプティマイザ</font><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">使用</font></a><font style="vertical-align: inherit;">してニューラルネットワークをコンパイルします</font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは2つのクラスの問題であることから</font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クロスエントロピーではなく</font><font style="vertical-align: inherit;">損失を使用します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
学習プロセスを開始するには、Kerasでfit_generator </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を呼び出し、フルオロ</font><font style="vertical-align: inherit;">グラムをデータ拡張オブジェクトに渡します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルを評価します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
評価するには、まずテストセットで予測を行い、予測インデックスを保持します。</font><font style="vertical-align: inherit;">次に、scikit-learnを使用して分類レポートを作成して表示します。このような補助機能があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、さらなる統計評価のために不正確さの行列を計算します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、次のことを行います。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不正確なマトリックスを生成します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その助けを借りて、これらのすべてのメトリックを印刷することにより、精度、感度、および特異度を計算します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自己テストのために、トレーニングの精度と損失の履歴を含むグラフを生成し、グラフィックファイルに出力します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、分類子モデル</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をディスクに</font><font style="vertical-align: inherit;">保存します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検出器トレーニング</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のソースとスクリプトを含むアーカイブからすべてのファイルをダウンロードした後、コンソールを開き、次のコマンドを実行して検出器をトレーニングします。</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">透視検査の結果によるCOVID-19の自動診断</font></font></h2><br>
<i><b>  :</b>      ,  «»   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の結果からわかるように、当社の自動検出器は、既存のサンプルのセットで約90〜92％の精度を備えています。</font><font style="vertical-align: inherit;">この評価は、画像分析のみに基づいています。</font><font style="vertical-align: inherit;">トレーニング中、地理的な場所、人口密度などのデータは使用されませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感度は100％、特異度は80％でした</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">真に感染した患者は、症例の100％で認識されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康な患者は80％の確率で健康であると認識されます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニング履歴グラフが示すように、</font><font style="vertical-align: inherit;">データセットが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に限られて</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いる</font><i><font style="vertical-align: inherit;">に</font></i><font style="vertical-align: inherit;">もかかわらず、ネットワークは再トレーニングされていません。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの健康な人々が本当に感染した患者を隔離する。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特に感染症の場合、医療アプリケーションに関しては、感度と特異性のバランスをとることは非常に困難です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンピュータビジョンと医学における深い教育に関しては、予測モデルが非常に現実的な結果をもたらす可能性があることを常に覚えておく必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しになりますが、これらの結果は教育目的でのみ収集されます。</font><font style="vertical-align: inherit;">この記事とそれに付随する結果は、科学雑誌への掲載を目的としたものではなく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、予測レポートモデルの作成に関するTRIPODルールに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準拠</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">して</font></a><font style="vertical-align: inherit;">いません</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制限、改善、および将来の作業</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 4.現在、人工知能（AI）スペシャリストとディープラーニングスペシャリストは、画像（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像ソース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">でのCOVID-19自動検出システムの効果的なトレーニングのための品質データの不足に悩まされてい</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ます。このようなシステムを作成する上での主な制限の1つはデータです。 COVID-19検出器をトレーニングするのに十分な（信頼できる）データがないだけです。病院はCOVID-19患者で混雑していますが、その権利とプライバシーを考えると、</font><font style="vertical-align: inherit;">高品質の医療画像セットをタイムリーに収集することは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに困難</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">なり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今後12か月から18か月で問題は解決すると思いますが、今のところ問題はありません。時間とリソースの制限を考慮して、COVID-19との戦いでコンピュータービジョンとディープラーニングを使用することに関心のある人のためのガイドをまとめるために、最善を尽くしました（現在の精神的および身体的状態を考慮して）。しかし、私は医療専門家ではないことを思い出させてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
真のCOVID-19検出器は、経験豊富なディープラーニングプラクティショナーと協力して訓練を受けた医療専門家による厳密なテストを受ける必要があります。もちろん、ここで説明する方法は実際の使用には適しておらず、教育目的のみを目的としています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、このモデルが実際に「学習」するのは何なのか疑問に思う必要があります。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私が言ったように</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先週</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">のGrad-CAMガイドによる</font></a><font style="vertical-align: inherit;">と、モデルがCOVID-19とは関係なく、単に2つのデータセット間の変動（つまり、COVID-19がある患者とない患者の間）のパターンを研究するモデルである可能性があります。結果を確認するには、徹底的なテストと専門家の支援が必要です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に、将来の（そして最良の）検出器はマルチモーダルになります。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ここでは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像（X線など）</font><i><font style="vertical-align: inherit;">のみを</font></i><font style="vertical-align: inherit;">考慮し</font><font style="vertical-align: inherit;">ます。最高のCOVID-19自動検出器は、患者のバイタルサイン、人口密度、地理的位置などの画像に限らず、複数のデータソースを使用する必要があります。通常、このタイプのアプリケーションには画像だけでは十分ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドが、コンピュータービジョンとディープラーニングを使用してCOVID-19を自動的に検出することに関心のある人にとっての出発点として役立つことを願っています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次は何ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンピュータービジョンとディープラーニングの使用方法について詳しく学ぶことができるように、私は通常、私のブログの記事を私の本またはコースの1つからの推薦で終わらせています。</font><font style="vertical-align: inherit;">コロナウイルスの深刻さに敬意を表して、私はこれを行うつもりはありません-今は時間でも場所でもありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代わりに、私たちは今、非常に恐ろしい人生の期間にいると言います。</font><font style="vertical-align: inherit;">季節のように、すべてが通過しますが、今のところ、あなたはしゃがんで寒い冬に備える必要があります-最悪の事態はまだ到来していない可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyImageSearchの読者から、家に夢中になるのではなく、コンピュータビジョンやディープラーニングを研究するためにこのダウンタイムを利用したいという手紙をいくつか受け取りました。</font><font style="vertical-align: inherit;">これは有用な考えです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドでは、KerasとTensorFlowを使用して、フルオログラムセットでCOVID-19自動検出器をトレーニングする方法を学びました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19の高品質なピアレビュー済みの画像データセットは（まだ）ないため</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、GitHub上のJoseph Cohenのリポジトリである</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、私たちが持っているものを使用する必要がありました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コーエンデータセットから25枚の画像を選択し、後方-前方（PA）ビューと確定診断のみを選択しました。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、健康な患者の25枚の画像が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaggleフルオログラフィー画像（肺炎）のデータセット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から選択されまし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">た</font></a><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KerasとTensorFlowを使用して、COVID-19検出器をトレーニングしました。これにより、テストセット（限定されたデータセットの場合）で90〜92％の精度、100％の感度、および80％の特異性が示されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されているCOVID-19検出器は教育目的のみを目的としていることに注意してください。</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja497612/index.html">市場の見えない手が私を遠く離れた場所に移した物語</a></li>
<li><a href="../ja497614/index.html">思考実験、パラドックス、論理の境界//運命＃2</a></li>
<li><a href="../ja497616/index.html">オープンソース、カンファレンス、YiiについてのAlexander Makarov（Yii）へのインタビュー</a></li>
<li><a href="../ja497618/index.html">安全性の高いリモートアクセスの概念の実装</a></li>
<li><a href="../ja497620/index.html">Chrome電報アラートプラグインの作成</a></li>
<li><a href="../ja497624/index.html">デジタルバンキングキャンパス-インターンシッププログラムの結果</a></li>
<li><a href="../ja497628/index.html">小さなスクリプトまたは1つのプルリクエストの履歴で多くの時間を殺す方法</a></li>
<li><a href="../ja497632/index.html">Web HighLoad-何万ものドメインのトラフィックを管理する方法</a></li>
<li><a href="../ja497634/index.html">レインボーカラーリングは数学者の親友です</a></li>
<li><a href="../ja497636/index.html">コンピューティング能力の欠如が世界大戦の海戦にどのように影響したか</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>