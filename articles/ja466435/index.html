<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙌🏾 👶🏽 🦆 Cisco 200-125 CCNA v3.0のトレーニング。42日目。VLAN間ルーティングとSVI 👩🏽‍🎨 ⚗️ 👨🏻‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日は、VLAN間ルーティングと仮想SVIスイッチインターフェイスについて説明します。 ICND1コースでは、これらのトピックにすでに慣れているので、これらについてさらに詳しく説明します。これらのトピックは、ICND2のセクション2.0、ルーティングテクノロジー、サブセクション2.1aおよび2.1b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cisco 200-125 CCNA v3.0のトレーニング。42日目。VLAN間ルーティングとSVI</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/466435/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日は、VLAN間ルーティングと仮想SVIスイッチインターフェイスについて説明します。 ICND1コースでは、これらのトピックにすでに慣れているので、これらについてさらに詳しく説明します。これらのトピックは、ICND2のセクション2.0、ルーティングテクノロジー、サブセクション2.1aおよび2.1bで説明されています。最初に、構成、検証、およびVLAN間ルーティングの問題を確認し、次に、Router-on-a-Stick（ROAS）ネットワークアーキテクチャの概念とSVIスイッチインターフェイスを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パケットトレーサープログラムに移り、SVIスイッチの仮想インターフェイスが何であるかを考えてみましょう。この図は、販売部門とマーケティング部門の2つのネットワークを示しています。それぞれに独自のスイッチがあります。デフォルトでは、コンピュータはデフォルトのVLAN1を介してスイッチに接続されているため、問題なく相互に通信できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/gp/ym/dfgpymzyjf8ai0gpqna6iezvqwk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、営業部門のコンピューター＃1がマーケティング部門のコンピューター＃1に接続する場合、ネットワークが接続されていないため、これを行うことができません。技術的には、両方のスイッチをケーブルで接続できますが、コンピューターはIPアドレスの範囲が異なる192.168.10.0/24と192.168.20.0/24の異なるネットワークの一部であるため、通信できません。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第3レベルのOSIのスイッチデバイスとルーターの間に配置し、スイッチとルーターをケーブルで接続すると、これら2つのネットワーク間の通信を確立できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gf/lk/ia/gflkiawp5nctwcrocn1m7atuzk0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、オフィスでは2つのネットワークに2つの異なるスイッチはありません。これは、主にCiscoスイッチが非常に高価であるため、24ポートと48ポートの1つのスイッチを管理する必要があるためです。 48ポートのスイッチがあるとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wv/8l/fg/wv8lfgunfgblsrsdpwqmhxmlnoo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なるVLANを作成します。図のポートの色が気にならないように、黒で描きます。青いネットワークはVLAN10、赤いネットワークはVLAN20です。これを行うと、スイッチはOSIレベル2デバイスであるため、異なるネットワークのコンピューターは互いに通信できなくなります。相互接続するには、レベル3のデバイスが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題はルーターを使用して解決できます。ルーターの1つのポートは青いVLAN10ネットワークのポートの1つに接続され、もう1つのポートは赤いVLAN20ネットワークのポートの1つに接続されます。この場合、このルーターを介して、異なるネットワークのコンピューター間の通信を簡単に整理できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zb/em/wn/zbemwnondyrrqvdtdpco0dhhl-g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスキームでは、ルーターインターフェイスを不合理に使用しているため、Router-on-a-Stickと呼ばれる別の相互接続方法を使用する方がはるかに効率的です。後で戻ってきますが、ここではSVIスイッチの仮想インターフェイスについて検討します。ご存知のように、スイッチには「そのままの状態で」VLAN1にデフォルトで設定されたすべてのポートがあり、スイッチにはこれらのネットワーク用の仮想インターフェース、つまりVLAN1インターフェースがあります。仮想インターフェースとは何ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワーク管理者としてスイッチを構成する場合は、スイッチのコンソールポートにケーブルで接続するコンピューターを使用します。問題は、コンソールを使用するには、ケーブルの長さ以下の距離でスイッチの隣にいる必要があることです。あなたが大規模なネットワーク管理者であり、デバイスをリモートで構成したいとします。ただし、スイッチはネットワークの第2レベルのデバイスであるため、IPアドレスを持つことはできません。また、スイッチの物理インターフェイスにIPアドレスを割り当てることができないため、ネットワーク経由でアクセスする方法はありません。この問題はどのように解決できますか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、VLAN1の仮想インターフェイスを作成し、IPアドレス192.168.1.1またはその他のアドレスを割り当てる必要があります。次に、IPアドレスが192.168.1.10の筆者が描いたネットワーク管理者のコンピュータは、TelnetまたはSSH経由でスイッチを使用してこの仮想インターフェイスに接続できます。この機能は、デフォルトでVLAN1に存在します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e9/ra/mp/e9rampetqlahniqxfzfljf9wyhs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、青色のネットワークのPC1はVLAN10に属し、仮想インターフェイスはVLAN1に属しているため、別のネットワークに属しているため、コンピューターはVLAN1インターフェイスと通信できません。この場合、VLAN10の仮想インターフェイスを作成し、VLAN20に同じインターフェイスを作成できます。次に、青いネットワークのコンピューターPC1と赤いネットワークのコンピューターPC1は、仮想インターフェイスを介してスイッチとリモート通信できます。これを行うには、アドレス範囲VLAN10とVLAN20のこれらのインターフェイスにIPアドレスを割り当てる必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、スイッチへのデバイスのリモートアクセスを提供するには、このデバイスが属しているのと同じVLAN番号で仮想インターフェイスを作成する必要があります。たとえば、VLAN20からコンピューターの仮想インターフェイスVLAN20を作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VLANの説明では、OSIモデルのレイヤー2とレイヤー3について説明します。それらの違いを理解するために、Packet Tracerを使用します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/8t/sf/pc8tsfbggxpcmkkq0uon_imdlue.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レベル2のデバイス（スイッチ）をホストし、いくつかのエンドユーザーPCを追加します。左側のPC0はVLAN10にあり、右側のPC1はVLAN20にあります。次に、コンピュータをスイッチに接続してネットワークを作成します。両方のコンピューターには独自のIPアドレスが必要なので、ネットワーク設定に進み、PC0にアドレス198.168.10.1とサブネットマスク255.255.255.0を割り当てます。ここではゲートウェイを使用しないので、デフォルト設定のままにします。 PC1でも同じことを行い、アドレス198.168.20.1とサブネットマスク255.255.255.0を割り当てます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今私はPC0からアドレス198.168.20.1のコンピュータにpingしています。前のレッスンから、これが機能しないことを知っておく必要があります。両方のPCがスイッチVLAN1のデフォルトのインターフェイスに接続されているという事実にもかかわらず、ネットワークアドレスの異なる範囲に属するIPアドレスを持っているため、それらはまだ通信できません-VLAN10の範囲は192.168.10.0/0で、VLAN20の範囲は192.168.20.0です。 / 0。つまり、物理的にコンピュータは互いに通信できますが、論理的には通信できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スイッチコンソールに入り、VLAN設定を変更します。これを行うには、f0 / 1インターフェイスを呼び出して、switchport mode accessコマンドとswitchport access vlan10コマンドを入力します。その後、そのようなネットワークが存在せず、作成されるというメッセージが表示されます。次に、show vlan briefコマンドを入力すると、VLAN10ネットワークが作成されたことがわかります。次に、show ip interface briefコマンドを入力すると、インターフェイスのリストの最後に、デフォルトで仮想インターフェイスVLAN1があることがわかります。これはSVIです。彼は管理上ダウン状態にあります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、VLAN10の仮想インターフェイスを作成してみましょう。スイッチにVLAN10ネットワークがなかったために作成されたことがわかります。これはOSIモデルの第2レベルです。 VLAN10の仮想インターフェイスはレベル3であり、それを作成するにはint vlan10コマンドを使用する必要があります。その後、システムは、VLAN10インターフェースの線形プロトコルもオンになっている間、VLAN10インターフェースが状態を「オン」に変更したというメッセージを表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
show int briefコマンドを再入力した場合、作成されたVLAN10インターフェイスが作成されたことが明らかであり、これはアップ状態です。 SVIを作成すると、デフォルトでは「オン」の状態になります。 VLAN1のインターフェースはデフォルトで無効になっていますが、別の仮想VLANインターフェースを作成すると、オン状態になります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xr/ic/yl/xricylmwm336r4_v_sw-y05sclg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、VLANデータベースにはVLAN20がないため、int vlan 20コマンドで作成しますこのインターフェイスのサブコマンドモードにいることがわかります。このSVIを無効にするには、shutdownコマンドを入力します。有効状態のままにしたい場合は、no shutと書き込みます。インターフェースのリストをもう一度見てみましょう。ご覧のとおり、VLAN20ネットワークが自動的に作成されています。以前に作成されたVLAN10はアップ状態であり、問​​題はありません。しかし、今、VLAN20を作成すると、切断された状態で表示されました。これは一種の問題なので、なぜそれとそれに対応するプロトコルがダウン状態にあるのかを理解する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VLAN20ネットワークがないため、VLAN20インターフェイスが無効になっていることがわかります。したがって、インターフェース設定を終了して、このネットワークを作成しましょう。 OSIモデルの構造レベル3の要素を作成するときは、int vlan 20コマンドを使用し、レベル2構造要素を作成するには、vlan 20コマンドだけを使用することに注意してください。このネットワークを作成した後、システムは、VLAN20インターフェイスの状態がアップに変わったことを示すメッセージを表示します。また、システムがSwitch（config）＃ではなくSwitch（config-vlan）＃のようなサブコマンドのレベルでヒントを発行することもわかります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成したネットワークの名前を変更してみましょう。 VLAN10ネットワークを作成する場合、システムはデフォルトで同じ名前-VLAN0010を付けます。変更する場合は、name SALESコマンドを使用します。次に、show vlan briefコマンドを使用して、VLANデータベースを調べ、VLAN20がSALESネットワークに変わったことを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェイスのリストを見ると、VLANデータベースにこのインターフェイスに対応するネットワークが含まれているため、VLAN20インターフェイスの状態がUpに変化したことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、このポートのプロトコルはまだ非アクティブであり、ダウン状態であることがわかります。これは、VLAN20ネットワークのトラフィックを「認識」しないためです。なぜ彼はこのトラフィックを見ないのですか？ VLAN20ネットワークに接続されているポートがないためです。そのため、作業用ポートを接続する必要があります。この場合、デバイスを接続するf0 / 1およびf0 / 2ポートのみがアクティブになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1q/ra/te/1qrateol8sltkg469nmalbiruiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、int f0 / 2コマンドを使用して、このインターフェイスのサブコマンドモードに入り、switchport mode accessおよびswitchport access vlan20コマンドを入力します。その後、システムは、VLAN20インターフェイスラインプロトコルの状態がアップに変化したことを報告します。同じことがshow int briefコマンドでも確認できます。両方の要素とインターフェイス、およびそのプロトコルが有効な状態です。したがって、無効になっているVLANインターフェースに問題がある場合は、まず、VLANのデータベースを調べて、このインターフェースと一致するネットワークがあることを確認してください。プロトコルが無効になっている場合は、ネットワークにアクティブなトラフィックがあること、つまり、このネットワークに接続されているポートがあることを確認してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スイッチの他のインターフェース（f0 / 5など）を見ると、このインターフェースでトラフィックが観測されていないため、このインターフェースのプロトコルがダウン状態であることがわかります。デフォルトでは、ポートに接続されているデバイスがない場合、ポートは無効になっており、このポートにはトラフィックがないため、プロトコルはアクティブではありません。したがって、SVIがダウン状態であることがわかった場合は、まず上記のことを確認する必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これでコンピューターにIPアドレスが割り当てられ、スイッチのポートが構成されたので、PC0 pingがPC1に渡されるかどうかを確認します。もちろん、デバイスがまだ異なるVLAN10ネットワークとVLAN20ネットワークにあるため、適切なコンピューターにpingすることはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するために、IPアドレスを割り当てることができる回路にデバイスを配置します-ルーター、そのインターフェイスの1つをスイッチポートf0 / 3にケーブルで接続し、他のルーターインターフェイスをf0 / 4ポートに2つ目のケーブルで接続します。これは、このような場合の標準的な接続です。一方のインターフェイスをVLAN10に接続し、もう一方のインターフェイスをVLAN20に接続すると、すべてが機能します。時間を無駄にしないために、ルーターのポートにIPアドレスを割り当てて事前に構成しました。これを確認するには、ルーターのコンソールの設定に移動し、コマンドshow ip int briefを入力します。次に、コマンドconfig terminal、int f0 / 3、switchport mode access、switchport access vlan 10を入力して、必要な変更を行います。同じように、f0 / 4インターフェイスをVLAN20ネットワークで動作するように構成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pingが成功するか確認してみましょう。スイッチポートがトラフィックスキップの準備完了状態になるまで時間がかかることがわかります-オレンジ色のマーカーがすぐに緑色に変わります。 PC0コマンドラインでping 192.168.20.1と入力しましたが、pingが再び失敗します。その理由は、コンピューターのネットワーク設定でゲートウェイを作成しなかったためです。したがって、設定パネルに移動して、最初のコンピューター192.168.10.10と2番目のコンピューターのゲートウェイアドレスを指定します-192.168.20.10。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qk/xz/me/qkxzme8udtdgopncrtuz_bfmu8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、pingは成功し、PC0とPC1は相互に通信できるようになります。ただし、前述したように、このようなネットワークトポロジでは、ルーターのポートの機能が無駄になります。通常、ルーターにはポートが2つしかないため、このように使用することは犯罪です。ルーターの機能をより効果的に使用するには、Router-on-s-Stick、または「スティック上のルーター、フラッシュドライブ上のルーター」の概念。前のスライドの1つに戻りましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sp/9c/hc/sp9chcaueg3swye8nwdjsfiehds.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OSIモデルの第3レベルで作業している場合、構成コマンドのキーワードは「インターフェース」になります。システムをインターフェイスサブコマンドモードにします。このモードでは、no shutdownまたはshutdown設定を指定し、show ip interface briefコマンドを使用してインターフェイス設定の結果を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レベル2で作業し、スイッチの場合はVLANデータベースに過ぎない場合、仮想ネットワーク設定を入力するコマンドには、キーワード「interface」が含まれていませんが、「vlan」という単語で始まり、対応する番号が付いていますネットワーク、たとえば、vlan10。サブコマンドモードに入った後、nameコマンドVLAN10で作成したネットワークに名前を付けることができます。 show vlan briefコマンドを使用して、設定を確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのネットワーク間のルーティングを確実にするために、すでに述べたように、これらのネットワークのスイッチを、外部ネットワーク（インターネット）に接続されているルーターに接続します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/81/ei/wq81eiwsldjufkfj_mn9nf8dut4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスキームを使用すると、コンピューター1はインターネットにアクセスしたり、別のネットワーク上のコンピューターと通信したりできます。つまり、2つの異なるスイッチがあり、それぞれが独自のネットワークに対応している場合、それらの間の通信には、OSIモデルの第3レベルのデバイスが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前述のように、通常、オフィスでは1つのスイッチが使用され、VLANを使用して半分に分割されています。この図では、青色の販売と赤色のマーケティングという2つの異なるVLANを指定しています。この方法を使用するには、2つの異なるルーターインターフェイスまたは1つのf0 / 0インターフェイスを使用できます。図では、ルーターとスイッチの間の青い列です。この概念はサブインターフェースと呼ばれます-f0 / 0.10インターフェースは青いネットワークにサービスを提供するために割り当てられ、f0 / 0.20は赤いネットワークに割り当てられます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e3/wg/s7/e3wgs7t7m8s11tk0hmyabgyrsv4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この青いものすべてがスイッチf0 / 1の1つのインターフェースに接続され、青いVLANのコンピューターがインターフェースf0 / 2およびf0 / 3に接続され、赤いネットワークのコンピューターがf0 / 4およびf0 / 5に接続されているとします。この場合、f0 / 1はトランクポートである必要があり、VLANとVLAN20からのすべてのトラフィックがルーターに送信される必要があるため、スイッチとルーター間にトランクを作成する必要があります。この場合、使用できるルーターインターフェイスは1つだけで、2つのサブインターフェイス、またはサブインターフェイスに分割されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブインターフェイスは、物理インターフェイスの指定にドットを追加して、仮想的にルータに作成されます。 f0 / 0.10サブインターフェースに、VLAN10アドレス範囲からIPアドレスを割り当て、f0 / 0.20はVLAN20ネットワークアドレス範囲からIPアドレスを取得します。サブインターフェース指定のドットの後の番号は、VLAN番号と一致する必要がないことに注意してください。この概念を理解しやすくするために、一致する数字を使用します。そのため、試験である種の問題についての質問に遭遇し、それがVLAN番号とサブインターフェイスの不一致が原因であると思われる場合、ネットワーク番号が一致する必要があると教えられたので、あなたは間違っているでしょう！繰り返しますが、サブインターフェースと対応するVLANの数が一致していない可能性があります。これは正常な状態であるため、問題の原因はこれにありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、青いネットワークのコンピューター＃1がトラフィックを送信すると、スイッチのトランクポートに到達します。ここで、.1qプロトコルを使用してカプセル化されます。つまり、VLAN10タグを受信し、トランクを介してルーターに送信されます。 VLAN20トラフィックは同じ方法でタグ付けされます。しかし、問題はデフォルトでルータが.1q言語を理解しないことです。したがって、ルータの設定に進み、カプセル化で.1qを使用することをサブインターフェイスに通知する必要があります。これを行った後、VLAN10およびVLAN20ネットワークの対応するアドレス範囲からIPアドレスを割り当てます。これを行うとすぐに、ネットワーク間の通信が確立されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
先に作成したSVIを最初に削除し、グローバルスイッチ構成モードに入り、no int vlan 10およびno int vlan 20コマンドを適用するパケットトレーサーに移りましょう。その後、インターフェイスのリストを見ると、VLAN10およびVLAN20インターフェイスが消えていることがわかります。 OSIモデルの第2レベルでは、これらのネットワークを使用するため、これらのネットワークはVLANデータベースに残っていますが、対応する仮想インターフェイスがありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スイッチf0 / 0のポートを1つだけ使用するため、スイッチとルーターを接続している2本のケーブルを取り外し、スイッチとルーターを1本のケーブルで接続します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s9/mm/ty/s9mmtyamqn-sf-jb1bk_d6n0tdq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ルーターの設定に移動し、f0 / 0インターフェイスを選択して、no ip addressコマンド（IPアドレスなし）を入力します。インターフェイスのリストを表示すると、FastEthernet0 / 0インターフェイスとVlan1インターフェイスのIPアドレスが割り当てられておらず、FastEthernet0 / 1インターフェイスにIPアドレス192.168.20.10が使用されていることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/iz/og/gjizog_0wuadcf617dceupnaade.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「スティック上のルーター」方式を使用するには、物理​​インターフェイスがシャットダウンモードでない必要があります。ご覧のとおり、FastEthernet0 / 0は手動アップモードになっているため、問題ありません。これは、Router-on-s-Stickを使用する前に確認する必要がある最初のことです。2つ目は、このインターフェースにIPアドレスがないことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、int f0 / 0と入力してインターフェイスのサブコマンドモードに入り、サブインターフェイス.10を作成するためにコマンドf0 / 0.10を入力します。インターフェイスのリストを見ると、システムが新しい仮想インターフェイスFastEthernet0 / 0.10を作成しており、これがオン状態になっていることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ug/rs/oy/ugrsoyfd-abo7yzblfem-llzmb0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前のピリオドは、それが物理インターフェースではなく仮想インターフェースであることを示しています。次に、グローバル設定モードに戻り、サブインターフェイスf0 / 0.20を作成します。次に、int f0 / 0.10コマンドを使用して、新しいサブインターフェイスf0 / 0.10の設定に移りましょう。コマンドラインプロンプトがルーターサブコマンド（config-subif）＃の形式になっていることがわかります。これで、ip address 192.168.10.10 255.255.255.0コマンドを使用して、このインターフェースにIPアドレスを割り当てることができます。 [Enter]を押すと、「サブインターフェイスLANのIPルーティングの構成は、このインターフェイスがIEEE 802.10、802.1q、またはISL vLANの一部として既に構成されている場合にのみ可能です」というメッセージが表示されます。したがって、特定のVLANに.1qプロトコルを使用してカプセル化を使用するコマンドを入力する必要があります。この場合、encapsulation dot1Q 10と入力します。10はVLANの番号です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/us/c7/omusc7o_mydv1t5iqywmscxek60.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、目的のIPアドレスを入力すると、システムがそれを受け入れます。 f0 / 0.20インターフェースについても同じことを行います-カプセル化パラメーターを設定し、この仮想インターフェースにIPアドレス192.168.20.10を割り当てます。このIPアドレスがすでにf0 / 1インターフェイスに割り当てられていることを忘れたので、このインターフェイスの設定に移動して、IPアドレスを入力しません。その後のみ、f0 / 0.20インターフェイスに戻り、このアドレスを割り当てると、システムがそれを受け入れます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、PC0ネットワーク設定に戻り、pingがPC1に渡されるかどうかを確認します。ただし、トランクスイッチルーターを作成するのを忘れたので、作成しましょう。スイッチの設定に入り、int f0 / 3と入力して、switchport mode trunkコマンドを入力します。したがって、トランクを構成し、VLAN10とVLAN20にそれぞれ関連付けられたルーターの2つのサブインターフェイスを作成しました。 2台目のコンピューターにpingを実行すると、ご覧のようにpingが通過するので、すべてが正常に機能します。私たちは、Router-on-a-Stickと呼ばれるものを行いました。ルータの1つのトランクインターフェイスと2つのサブインターフェイス、およびルーティングされたトラフィックをカプセル化するメカニズムがあります。ご覧のとおり、これは非常に単純です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトのVLAN1を使用してケーブルでスイッチに接続されている別のコンピューターがあるとします。このネットワークは、トランクに対して「ネイティブ」です。このコンピューターにIPアドレス192.168.30.1、サブネットマスク255.255.255.0、ゲートウェイアドレス192.168.30.10を割り当てます。 VLAN1が所有するこのPC2がVLAN10からコンピューターに接続しようとするとどうなりますか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/la/ge/_e/lage_e7xfreaxgjnfjb9ma_ab-s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはネイティブVLANにあるため、タグなしのトラフィックをトランク経由で送信し、ルーターはそれにどのように応答しますか？結局のところ、サブインターフェースは2つしかありません-1つはVLAN10用、もう1つはVLAN20用です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pz/oj/up/pzojuplzc-d_b1hy-0dhy-m_xhi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するには2つの方法があります。 1つ目は、ルーターのグローバル設定に移動し、コマンドint f0 / 0を入力することです。次に、コマンドip address 192.168.30.10 255.255.255.0を入力します。つまり、この物理インターフェイスにIPアドレスを割り当てます。 PC2からのトラフィックがルーターに到着すると、VLANタグなしでトラフィックが送信されます。これは、f0 / 0インターフェイスにアドレスを割り当て、リクエストに応答できるようになったためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PC2から192.168.10.1でpingを実行して、これを確認してみましょう。論理的にタグ付けされていないトラフィックは、スイッチからルーターに送られ、スイッチを介してPC0コンピューターに送信されます。 pingがパスしないことがわかります。理由を調べてみましょう。スイッチの設定に移動し、インターフェイスのリストを確認してエラーを見つけます。PC2が現在接続されているFa0 / 4インターフェイスがVLAN 20 SALES販売ネットワークに割り当てられています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f3/t-/2y/f3t-2yzbnzlg0jt5ewlgpyduudw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このエラーを修正するには、int f0 / 4、switchport mode accessおよびswitchport access vlan 1コマンドを入力します。PC0コンピューターに再度pingを実行します。最初の試行は失敗します。新しいスイッチ設定が入力されるのを待たずに、急いでpingを送信したためです。強制しますが、2回目の試行は成功し、PC2トラフィックが宛先に到着します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、ネイティブVLANを使用する場合は、物理インターフェイスにIPアドレスを割り当てる必要があります。これを実行したくない場合-今私はf0 / 0インターフェイスのIPアドレスを削除しています-2番目の方法を試すことができます。これは、別の論理インターフェース、またはサブインターフェースf0 / 0.30を作成することから成ります。作成後、.1qプロトコルを使用してencapsulationコマンドを入力し、コマンドに「native」という単語を追加します：encapsulation dot1Q 1 native。このコマンドを入力すると、ルーターはネイティブVLANがこのインターフェイスに接続されていることを認識するため、トラフィックはタグなしで到着します。その後、このサブインターフェイスにIPアドレス192.168.30.10 255.255.255.0を割り当て、no shutdownコマンドを追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何をしたか確認してみましょう。 PC2のコマンドラインでping 192.168.10.1と入力すると、ご覧のとおり、すべて正常に動作します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、プレゼンテーションから戻りましょう。レイヤ3ネットワークデバイスの使用に基づく、大規模なネットワーク開発で使用される別のルーティング方法があります。この図は、OSIモデルの第3レベルのスイッチであるスイッチを示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k3/2p/is/k32pisnmdl-kmjnaidfcpacxtdw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第3レベルのスイッチは、異なるVLANを接続するためにルーターを使用する必要はありません。もちろん、インターネットやその他の外部ネットワークにアクセスする場合はルーターが必要ですが、VLAN間通信にはレベル3スイッチを使用します。これにより、ネットワーク間でパケットがルーティングされます。論理的には、第3レベルのスイッチは、物理的な第2レベルのスイッチと第3レベルのソフトウェアルーターを組み合わせたものです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の図では、点線で示されています。わかりやすくするために、2つの物理スイッチと1つのソフトウェアである仮想ルーターという3つの個別のデバイスを示しました。 VLAN10とVLAN20の両方のスイッチは、SVIを介してこの内部ルーターに接続されています。このスキームでは、同じVLANにあるコンピューターは問題なく相互に通信し、必要に応じて別のVLANにあるコンピューターに接続し、内部スイッチルーターを使用します。これを行うには、SVIを構成し、対応するVLANのアドレス範囲からこれらのインターフェイスにIPアドレスを割り当てる必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nb/3f/fx/nb3ffx8m-jzciutqgpurd5zsqza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
物理ルーターを使用する場合、SVIは必要ないため、前のケースでは削除しました。 ROASを整理するためのSVIを作成する必要性について説明するビデオがネットワーク上に多数ありますが、それは正しくありません。レベル3スイッチの場合、SVIを作成する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Packet Tracerに戻る。既存のケーブルを外して、ネットワークトポロジにCiscoレイヤー3管理スイッチを追加します。その後、対応するVLANのインターフェイスを構成します。VLAN10の場合はポートf0 / 1、VLAN20の場合はポートf0 / 2で、システムが対応するネットワークを作成します。 。別のネットワーク、PC2のVLAN1は、デフォルトですでに存在しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f4/wx/c4/f4wxc474bwjd_ozhdhtwziztxtu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェイスのリストを見ると、管理上のダウン状態にあるVLAN1のSVIが1つあることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはレベル3のスイッチなので、ルーティングモードが使用できるかどうかを確認する必要があります。この場合のように、show ip routeコマンドを入力しても何も表示されない場合、IPルーティングはまだ使用できません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dy/kc/5l/dykc5lba_x3itqmqokxx04e6zug.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、スイッチのグローバルコンフィギュレーションモードに切り替えてip routingコマンドを入力すると、この機能が使用可能になります。 show ip routコマンドを使用すると、コンピューターVLAN10およびVLAN20との通信用のSVIを作成していないため、ここにパラメーターがないことがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/nw/un/yrnwunrbm8cvh05hpvhn-bikova.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、Packet Tracerに戻ってSVIを作成しましょう。グローバルコンフィギュレーションモードに入り、int vlan 10と入力してから、IPアドレス192.168.10.10 255.255.255.0を入力し、シャットダウンしません。インターフェイスのリストを見ると、このIPアドレスを持つデバイスがVLAN10経由でスイッチに直接接続されていることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、int vlan 20、IPアドレス192.168.20.10 255.255.255.0と入力し、シャットダウンコマンドを順番に入力しません。 PC0からPC1に192.168.20.1でpingを実行できるかどうかを確認してみましょう。ご覧のとおり、第3レベルのスイッチがVLAN間インターネットワークトラフィックをルーティングできるようになったため、VLAN10パケットはスイッチを通過してVLAN20ネットワークに入ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VLAN1からのトラフィックルーティングを提供する場合は、スイッチ設定に移動してint vlan 1を入力する必要がありますが、shutdownコマンドを実行し、IPアドレス192.168.30.10 255.255.255.0コマンドを使用してこのインターフェイスにIPアドレスを割り当て、no shutdownコマンドを追加します。その後、PC2にpingを実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
外部ネットワークにアクセスしたい場合、上記のルーターがインターネットに接続されているとすると、スイッチとルーター間の接続は別のVLANに属している必要があります。この場合、スイッチポートf0 / 4はVLAN40の一部になるはずです。この場合、f0 / 4インターフェイスには、VLAN40ネットワークアドレス範囲からIPアドレスが割り当てられます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ju/vs/5z/juvs5zhe5kefbf-astocgzygffw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のレベルのスイッチとルーター間の接続はトランクではなく、アクセスポートを介して行われ、別のVLANである必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Inter-VLANは、ROASスキームまたはCiscoレイヤー3スイッチを使用する2つの方法で編成できます。 2番目のケースではSVIを構成する必要があり、最初のケースではこれは必要ないことを覚えておいてください。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z7WM7wFTWrs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。私たちの記事は好きですか？もっと面白い資料を見たいですか？注文またはお友達にそれを推奨することで私たちをサポートしてください、私たちがあなたの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために発明したエントリーレベルのサーバーのユニークなアナログのHabrユーザーのための30％割引：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS（KVM）E5-2650 v4（6コア）10GB DDR4 240GB SSD 1Gbpsの真実20ドルまたはサーバーを分割する方法？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは、</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199ドルから、インテルTetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2台</font></a></b><font style="vertical-align: inherit;">だけ持ってい</font><b><font style="vertical-align: inherit;">ます！</font></b><b><b><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></b></b><font style="vertical-align: inherit;">について読む</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   .  c   Dell R730xd 5-2650 v4  9000   ?</a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja466425/index.html">Cisco 200-125 CCNA v3.0のトレーニング。37日目。STP：ルートブリッジの選択、PortFastおよびBPDUガード機能。パート2</a></li>
<li><a href="../ja466427/index.html">Cisco 200-125 CCNA v3.0のトレーニング。38日目。OSIレイヤー2のEtherChannelプロトコル</a></li>
<li><a href="../ja466429/index.html">Cisco 200-125 CCNA v3.0のトレーニング。39日目。スイッチシャーシのスタックと集約</a></li>
<li><a href="../ja466431/index.html">Cisco 200-125 CCNA v3.0のトレーニング。40日目。802.1X標準およびAAAプロトコルファミリ</a></li>
<li><a href="../ja466433/index.html">Cisco 200-125 CCNA v3.0のトレーニング。41日目。DHCPスヌーピングとデフォルト以外のネイティブVLAN</a></li>
<li><a href="../ja466437/index.html">Cisco 200-125 CCNA v3.0のトレーニング。43日目。ルーティングプロトコルの距離ベクトルとリンク状態</a></li>
<li><a href="../ja466439/index.html">自分で確認してください。ChGKに回答できる質問はいくつですか。</a></li>
<li><a href="../ja466441/index.html">Pythonバギーコード：開発者が犯す最も一般的な10の間違い</a></li>
<li><a href="../ja466443/index.html">ShIoTinyと世界：最小のアナログセンサーまたはADC</a></li>
<li><a href="../ja466445/index.html">ドメイン間の信頼間の攻撃</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>