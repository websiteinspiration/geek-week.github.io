<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí≥ üçß ü¶â The band suppression algorithm in the image as a tool for improving the quality of tomographic reconstruction üë©üèΩ‚Äçüè≠ üåã üåØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let us return to the tomography, which we pay great attention to at Smart Engines . Today we will talk about the algorithm for reducing the severity o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>The band suppression algorithm in the image as a tool for improving the quality of tomographic reconstruction</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/smartengines/blog/503656/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let us return to the tomography, which we </font><font style="vertical-align: inherit;">pay great attention to </font><font style="vertical-align: inherit;">at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Smart Engines</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Today we will talk about the algorithm for reducing the severity of the bands in the image. The bands on the tomographic synogram would not interfere with anyone, because the synograms are not presented to doctors or other users of the tomographs, but these bands lead to the appearance of concentric circles on the reconstructed images (on the left in the figure). The main instrument for controlling stripes in the proposed algorithm is the operation of guided filtering. We will tell you how to build a leading image for a synogram, calculate the corrected synogram and use it in the tomographic reconstruction procedure to get a restored image without ring artifacts (on the right in the figure).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lj/du/vj/ljduvjikywh-ligiwl6hxqn-pos.png"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This text is initiated by the dialogue that arose after our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">last publication</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on tomography. The comment was reproached that rings were visible on the reconstructed image. Indeed, such ring distortions (ring artifacts) often arise in tomographic reconstructions around the center of rotation of the source-object-detector system. In this article we will talk about the reasons for the appearance of such rings and how we fight with them.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In tomographic installations, there is often a highlighted point relative to which something rotates: either the object mounted in the holder on the goniometer rotates, and the source and detector are stationary; or a source-detector system rotates around a selected point. These are two fundamentally different approaches to organizing the procedure for collecting tomographic projections; there are problems in both cases. So where do the ring-type artifacts come from in the reconstructed image and how to reduce their severity? The result of the reconstruction (horizontal section of a porous object with artifacts in the form of concentric circles) is shown in Fig. 1.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1h/q0/hz/1hq0hzsgj4kz4t34mxf5hthk_0g.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1 The result of reconstruction without applying the ring suppression procedure [1]</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the method of X-ray tomography, a set of projections measured at different angles is used to restore the spatial distribution of the coefficient or the ‚Äúeffective‚Äù attenuation coefficient of the probe radiation. A tomographic projection is an image in each pixel of which contains the result of measuring the radiation intensity by one detector cell. For clarity, we will consider reconstruction of not a whole object, but only one of its sections (see Fig. 1). For such a reconstruction, we do not need to use the registered projection of the image as a whole, but rather take the same line of the detector from each angular projection (see Fig. 2)</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/bh/ix/kubhixcwxunrc-ajzfm6kf9zrj8.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">2 Tomographic projection. </font><font style="vertical-align: inherit;">The horizontal section participating in the construction of the synogram is highlighted in red.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We</font><i><font color="#999999"><font style="vertical-align: inherit;"> will</font></font></i><font style="vertical-align: inherit;"> construct a new image - the synogram, collecting the corresponding lines of all the angular projections (Fig. 3). </font><font style="vertical-align: inherit;">The i-th line of the received image corresponds to the i-th projection angle. </font><font style="vertical-align: inherit;">Those. </font><font style="vertical-align: inherit;">each column contains measurements of the same cell corresponding to different projection angles. </font><font style="vertical-align: inherit;">A synogram of such an image is not called randomly. </font><font style="vertical-align: inherit;">It is easy to see that in the central region it consists of sinusoids.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/33/zt/lt/33ztltuavfqfuxrqrp5x7ojjq5s.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">3 Section of a synogram collected from lines of tomographic projections</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the image, especially on the bright left and right edges, where there is no shadow of the object, vertical stripes are visible. The presence of vertical stripes in the synogram is the reason for the appearance of concentric circles in the reconstructed image. There may be several reasons for the appearance of vertical stripes. The different response of the detector cells to the same incoming signal is one of them. Detector manufacturers are trying to compensate for this effect when the detector is launched on the market. Periodically updated, the so-called pixel map can compensate for the degradation that occurs during the life cycle of the device. Its creation is a costly procedure, since it requires a calibrated source. Those. either the user must have his own such source, or forced to contact the company,providing this kind of service. An alternative is to use vertical strip suppression algorithms. The second possible source of the appearance of bands on the synogram is the stitching of image areas. The fact is that the imaged object does not always fit entirely in the field of view of the detector. Mankind is inexorably moving towards increasing the spatial resolution of the tomography method. I would like to tomograph large objects, for example, a human head (a vertical size of several tens of centimeters), with a NANOMETER resolution. It is easy to calculate how many pixels a matrix must have in order to register the desired projection. Now they are trying to solve the problem by stitching together the registered sections of the parts of the object, shot with overlap. When stitching, similar artifacts occur. Another source of bands is the instability of the beam itself, i.e.change in beam intensity from projection to projection. Whatever the reason for the appearance of vertical stripes, during reconstruction they generate ring artifacts, which are usually removed by post-processing of the reconstructed images. We will fight with rings by filtering vertical stripes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of the algorithm and experiments</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the reconstruction does not receive the result from the detector, but is normalized to an empty beam and the logarithmized image (Fig. 4), it is this algorithm that is input to the algorithm described below.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6o/kv/wj/6okvwjercitqipqkdt5rmvca5j4.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">4 The result of the logarithm normalized to an empty bundle of a synogram</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the method of suppressing vertical stripes, the Guided Filtering algorithm (Fig. 5 [2]) is used as the main tool.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r6/d9/kr/r6d9krau_wwzli6bz1_d34qf5me.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/_r/9h/sp_r9hurrofgte88zvl0ut5ma4y.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">5 Schematic diagram of filtering [2]</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The basis of guided</font><i><font color="#999999"><font style="vertical-align: inherit;"> filtering</font></font></i><font style="vertical-align: inherit;"> is the presence of master and slave images. </font><font style="vertical-align: inherit;">We want to build a leading image on which the sinusoids will be shown well, and the severity of the vertical stripes will weaken. </font><font style="vertical-align: inherit;">The first step is to calculate the derivative in the horizontal direction (Fig. 6), i.e. </font><font style="vertical-align: inherit;">in the direction perpendicular to the direction of the stripes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ms/7z/h_/ms7zh_husfiwcliyztk13swzruu.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">6 Horizontal derivative of the prologarithmic synogram</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In an enlarged section of the image (Fig. 7), the noise caused by the instability of the beam during measurement appears as discontinuities in the vertical bands.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ww/ho/gb/wwhogbs7ys7xalsptcwgfzjai8y.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">7 Enlarged section of the image fig. </font><font style="vertical-align: inherit;">6</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For each column, we perform the one-dimensional convolution operation to reduce the contribution of the high-frequency noise component (Fig. 8).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/al/m0/lq/alm0lqgnncoxfacf_dlpi9uffm0.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">8 Convolution result</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
An enlarged section is shown in Fig. </font><font style="vertical-align: inherit;">9.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yl/r-/rb/ylr-rbign2hwwsulrmni77tlpsi.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">9 Enlarged section of the image</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
However, we are still on the way to construct the leading image. </font><font style="vertical-align: inherit;">We apply the cumulative summation operation line by line to the image presented in Fig. </font><font style="vertical-align: inherit;">8. The result led us out of the space of derivatives, preserving the low-frequency dependences (Fig. 10).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dl/ok/h_/dlokh_pzw2lchzb8bfenhudypay.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">10 The result of line-by-line application of the cumulative summation operation</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Subtract the result from the logarithmic synogram, completing the process of constructing the leading image (Fig. 11). </font><font style="vertical-align: inherit;">It remains for us to perform the filtering operation (Fig. 5).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ut/ey/ii/uteyiiu88_xy4sm1gklzkrp0g0m.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">11 Leading image</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The result of the operation with the window (9.1) and E = 0.00001 is shown in Fig. </font><font style="vertical-align: inherit;">12.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9v/_0/2u/9v_02unkpxthalmmdjz61vxoofm.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">12 Result of a performed filtering operation</font></font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bm/jy/pj/bmjypjlpbqn4lvhqc8i09rrutls.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">13 Difference between the input image and the filtering result</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. </font><font style="vertical-align: inherit;">Figure 14 shows the results of tomographic reconstruction using unfiltered (left) and filtered (right) projections.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/pd/0f/oxpd0fgf52dkjbgnudh6t18mf3k.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">13 Results of tomographic reconstruction</font></font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We described the suppression algorithm on the synograms of vertical bands, the presence of which leads to the appearance of concentric circles in the reconstructed images. </font><font style="vertical-align: inherit;">Everyone who has to work with tomographic images knows about this pain. </font><font style="vertical-align: inherit;">An analysis of the dynamics of the severity of the circles in the reconstructed image helps to choose the optimal values ‚Äã‚Äãof the algorithm parameters. </font><font style="vertical-align: inherit;">In conclusion, we want to note that the algorithm will be useful to everyone who suffers from the presence of stripes on the images. </font><font style="vertical-align: inherit;">The direction of the bands does not play a decisive role, because it is enough to rotate the image and apply our algorithm to obtain an image with a significantly reduced degree of expression of the bands. </font><font style="vertical-align: inherit;">Thank you for the attention.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List of sources used</font></font></b>
                        <div class="spoiler_text">1. .. , .. , ..   .           . //  . 2019, .19, . 2, . 1-9.<br>
2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">kaiminghe.com/eccv10/eccv10ppt.pdf</a><br>
</div>
                    </div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503642/index.html">How to get on LinkedIn, Facebook, Google in Silicon Valley</a></li>
<li><a href="../en503648/index.html">What does the output of "ss -s" mean</a></li>
<li><a href="../en503650/index.html">VKCup 2020 Stage I. A Long Way</a></li>
<li><a href="../en503652/index.html">Digital events in Moscow from May 25 to May 31</a></li>
<li><a href="../en503654/index.html">Web service that allows users to independently maintain a culture of communication online</a></li>
<li><a href="../en503660/index.html">Test projects without pain. Yandex Report</a></li>
<li><a href="../en503662/index.html">NEW - VoIP Phone Snom D335</a></li>
<li><a href="../en503666/index.html">Startup and Business Course Translation from Stanford University. Lecture number 1. How to start a startup</a></li>
<li><a href="../en503668/index.html">Circle Squared: Visual Evidence</a></li>
<li><a href="../en503670/index.html">Does Mac OS slow down? - Catalina checks any unsigned code over the Internet at startup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>