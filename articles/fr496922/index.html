<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚ÄçüöÄ „Ä∞Ô∏è üöÇ Guide sur l'apk client-serveur inverse sur l'exemple du job NeoQUEST-2020 üëÜüèΩ üé¶ üôéüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous avons un programme riche (encore, tant de domaines de la cybers√©curit√© √† la fois!): Envisagez de d√©compiler une application Android,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Guide sur l'apk client-serveur inverse sur l'exemple du job NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/496922/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f0/7j/vf/f07jvfe9r6534tbgp9bwdruryvy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, nous avons un programme riche (encore, tant de domaines de la cybers√©curit√© √† la fois!): Envisagez de d√©compiler une application Android, d'intercepter le trafic pour obtenir des URL, de reconstruire apk sans code source, de travailler avec des cryptanalystes et bien plus encore :) </font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon la l√©gende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le h√©ros a trouv√© de vieilles pi√®ces de robot qui devaient √™tre utilis√©es pour obtenir la cl√©. </font><font style="vertical-align: inherit;">Commen√ßons!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Apk Reversim</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, devant nous, nous avons r√©ussi √† extraire un robot semi-d√©mont√© - une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application apk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui devrait en quelque sorte nous aider √† obtenir la cl√©. Faisons le plus √©vident: ex√©cutez apk et regardez ses fonctionnalit√©s. L'interface d'application plus que minimaliste ne laisse aucun doute - il s'agit d'un client de fichier FileDroid personnalis√© qui vous permet de t√©l√©charger un fichier √† partir d'un serveur distant. D'accord, √ßa a l'air facile. Nous connectons le t√©l√©phone √† Internet, essayons de t√©l√©charger (imm√©diatement key.txt - et si?) - sans succ√®s, le fichier est manquant sur le serveur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/kf/z3/b4kfz3wd44ev6ckfy664ba0ugho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons √† l'√©v√©nement suivant en termes de complexit√© - nous d√©compilons </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">apk en</font></a><font style="vertical-align: inherit;"> utilisant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JADX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et analyser le code source de l'application, qui, heureusement, n'est pas du tout obscurci. Notre t√¢che actuelle consiste √† comprendre quels fichiers le serveur distant propose au t√©l√©chargement et √† s√©lectionner celui avec la cl√© qu'ils contiennent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous commen√ßons par la classe com.ctf.filedroid.MainActivity, qui contient la m√©thode onClick (), qui est la plus int√©ressante pour nous, dans laquelle le clic sur le bouton ¬´T√©l√©charger¬ª est trait√©. Dans cette m√©thode, la classe ConnectionHandler est appel√©e deux fois: d'abord, la m√©thode ConnectionHandler.getToken () est appel√©e, et ensuite seulement, ConnectionHandler.getEncryptedFile (), qui transmet le nom du fichier demand√© par l'utilisateur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m5/66/by/m566byk1sozhodekerf1ggpf1hc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, c'est-√†-dire que nous avons d'abord besoin d'un jeton! Nous examinerons un peu plus le processus d'obtention.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode ConnectionHandler.getToken () prend deux lignes d'entr√©e, puis envoie une demande GET, en passant ces lignes comme param√®tres ¬´crc¬ª et ¬´sign¬ª. En r√©ponse, le serveur envoie les donn√©es au format JSON, √† partir desquelles notre application extrait le jeton d'acc√®s et l'utilise pour t√©l√©charger le fichier. Bien s√ªr, tout cela est bien, mais que sont ¬´crc¬ª et ¬´signe¬ª? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/gy/lg/yngylgy7dstfocghhk0w_eufgcg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre cela, nous allons plus loin vers la classe Checks, fournissant gentiment les m√©thodes badHash () et badSign (). Le premier calcule la somme de contr√¥le √† partir de classes.dex et resources.arsc, concat√®ne ces deux valeurs et l'encapsule dans Base64 (faites attention √† l'indicateur 10 = NO_WRAP | URL_SAFE, cela vous sera utile). Et qu'en est-il de la deuxi√®me m√©thode? Et il fait de m√™me avec l'empreinte SHA-256 de la signature de l'application. Eh, il semble que FileDroid ne soit pas vraiment impatient d'√™tre reconstruit :(</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/yj/xo/ljyjxoxvrlc8q3pjfxyrerya5ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, disons que nous avons re√ßu le jeton. Et apr√®s? Nous le transmettons √† l'entr√©e de la m√©thode ConnectionHandler.getEncryptedFile (), qui ajoute le nom du fichier demand√© au token et g√©n√®re une autre requ√™te GET, cette fois avec les param√®tres ¬´token¬ª et ¬´file¬ª. Le serveur en r√©ponse (√† en juger par le nom de la m√©thode) envoie un fichier crypt√©, qui est stock√© sur / sdcard /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, pour r√©sumer un peu le sous-total: nous avons deux nouvelles, et ... les deux sont mauvaises. Premi√®rement, FileDroid ne supporte pas vraiment notre z√®le pour la modification d'apk (la somme de contr√¥le et la signature sont v√©rifi√©es), et deuxi√®mement, le fichier re√ßu du serveur promet d'√™tre crypt√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, nous allons r√©soudre les probl√®mes √† mesure qu'ils deviennent disponibles, et maintenant notre principal probl√®me est que nous ne savons toujours pas quel fichier nous devons t√©l√©charger. Cependant, en √©tudiant la classe ConnectionHandler, nous ne pouvions pas nous emp√™cher de remarquer que juste entre les m√©thodes getToken () et getEncryptedFile (), les d√©veloppeurs FileDroid ont oubli√© une autre m√©thode tr√®s s√©duisante appel√©e le nom getListing (). Donc, le serveur prend en charge une telle fonctionnalit√© ... Il semble que c'est ce dont vous avez besoin!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fk/xz/v1/fkxzv1ac9ictxo7gy67ku_u44nq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir la liste, nous aurons besoin du ¬´crc¬ª et du ¬´signe¬ª bien connus - pas un probl√®me, nous savons d√©j√† d'o√π ils viennent. </font><font style="vertical-align: inherit;">Nous lisons les valeurs, envoyons une requ√™te GET et ... Alors, arr√™tez. </font><font style="vertical-align: inherit;">O√π allons-nous envoyer la demande GET? </font><font style="vertical-align: inherit;">Ce serait bien d'obtenir d'abord l'URL du serveur distant. </font><font style="vertical-align: inherit;">Eh, nous revenons √† MainActivity.onClick () et voyons comment les arguments netPath sont g√©n√©r√©s pour appeler les m√©thodes getToken () et getEncryptedFile ():</font></font><br>
<br>
<pre><code class="coffeescript hljs">Method getSecureMethod = <font></font>
wat.class.getDeclaredMethod("getSecure", <span class="hljs-keyword">new</span> Class[]{String.class});<font></font>
<font></font>
// . . .<font></font>
<font></font>
// netPath --&gt; ConnectionHandler.getToken()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"fnks"})<font></font>
<font></font>
// netPath --&gt; ConnectionHandler. getEncryptedFile()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"qdkm"})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'√©tranges combinaisons de lettres ¬´fnks¬ª et ¬´qdmk¬ª nous obligent √† nous tourner vers le r√©sultat de la d√©compilation de la m√©thode wat.getSecure (). </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoiler: JADX a ce r√©sultat comme √ßa. </font></font></s><br>
<br>
<img src="https://habrastorage.org/webt/-r/ih/gi/-rihgizr3f3kvj0uge_1ekoaxsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En y regardant de plus pr√®s, il devient clair que tout ce contenu peu agr√©able de la m√©thode peut √™tre remplac√© par le bo√Ætier de commutation habituel de ce type:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-regexp">//</span> . . .
<span class="hljs-keyword">switch</span>(CODE)<font></font>
{<font></font>
    case ¬´qdkm¬ª: <font></font>
        r<span class="hljs-number">.2</span> = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case ¬´tkog¬ª: <font></font>
        r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case ¬´fnks¬ª: <font></font>
        String r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">0</span>);
	<span class="hljs-keyword">break</span>;<font></font>
}<font></font>
java.lang.StringBuilder r1 = <span class="hljs-keyword">new</span> java.lang.StringBuilder <font></font>
r1.&lt;init&gt;(r2) <font></font>
java.lang.String r0 = r1.toString() <font></font>
java.lang.String r1 = radon(r0)<font></font>
<span class="hljs-keyword">return</span> r1 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que ¬´fnks¬ª et ¬´qdmk¬ª sont d√©j√† utilis√©s pour obtenir un jeton et t√©l√©charger un fichier, ¬´tkog¬ª devrait donner l'URL requise pour demander une liste des fichiers disponibles sur le serveur. </font><font style="vertical-align: inherit;">Il semble qu'il y ait un espoir d'obtenir le chemin requis √† moindre co√ªt ... Tout d'abord, voyons comment les URL sont stock√©es dans l'application. </font><font style="vertical-align: inherit;">Nous ouvrons la fonction com.ctf.filedroid.x37AtsW8g.rlieh786d () et voyons que chaque URL est enregistr√©e en tant que tableau d'octets cod√©s, et la fonction elle-m√™me forme une cha√Æne √† partir de ces octets et la renvoie. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/4e/xz/yt4exza37qeytal-i9snbrlo4co.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien. </font><font style="vertical-align: inherit;">Mais ensuite la ligne est pass√©e √† la fonction com.ctf.filedroid.wat.radon (), dont l'impl√©mentation est soumise √† la biblioth√®que native libae3d8oe1.so. </font><font style="vertical-align: inherit;">Bras invers√©64? </font><font style="vertical-align: inherit;">Bien essay√©, FileDroid, mais reviens une autre fois?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Obtenez les URL du serveur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons d'approcher de l'autre c√¥t√©: pour intercepter le trafic, obtenir des URL en texte clair (et en bonus, √©galement des valeurs de contr√¥le et de signature!), Les faire correspondre aux tableaux d'octets de com.ctf.filedroid.x37AtsW8g.rlieh786d () - cela peut Le chiffrement s'av√®re-t-il √™tre le chiffrement Caesar ou XOR habituel? .. Il ne sera alors pas difficile de restaurer la troisi√®me URL et d'effectuer la liste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour rediriger le trafic, vous pouvez utiliser n'importe quel proxy pratique ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">violoneux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BURP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc.). Nous configurons le transfert sur un appareil mobile, installons le certificat appropri√©, v√©rifions que l'interception est r√©ussie et lan√ßons FileFroid. Nous essayons de t√©l√©charger un fichier arbitraire et ... voir "NetworkError". Cette erreur a √©t√© provoqu√©e par la pr√©sence d'√©pinglage de certificat (voir m√©thode com.ctf.filedroid.ConnectionHandler.sendRequest): le client de fichier v√©rifie que le certificat ¬´c√¢bl√©¬ª dans l'application correspond au serveur avec lequel il interagit. Maintenant, il est clair pourquoi l'int√©grit√© des ressources d'application est contr√¥l√©e! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8y/su/ya/8ysuya2vqxuwxdzrmt9xsuajq7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, dans le trafic intercept√©, nous pouvons voir au moins le nom de domaine du serveur auquel acc√®de le client de fichiers, ce qui signifie que l'espoir de d√©crypter les URL demeure!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/2w/8l/im2w8l7u7b0optrada1cuhbxcge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revenons √† la fonction com.ctf.filedroid.x37AtsW8g.rlieh786d () et notons que les premi√®res dizaines d'octets co√Øncident dans tous les tableaux:</font></font><br>
<br>
<pre><code class="coffeescript hljs">cArr[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'i'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . ., <span class="hljs-string">'='</span>};
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, le dernier octet du troisi√®me tableau indique qu'il n'√©tait pas sans base64. </font><font style="vertical-align: inherit;">Essayons de d√©coder et de piquer les octets r√©sultants avec une partie connue de l'URL: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8o/mh/1m/8omh1mtmtqzkcdy7mpqyemyiuzw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
il semble que personne n'ait jamais √©t√© aussi heureux avec ARMag3dd0n! </font><font style="vertical-align: inherit;">La chose est petite: d√©codez s√©quentiellement les URL base64 et xorim avec la cl√© trouv√©e. </font><font style="vertical-align: inherit;">Mais ... et si ce n'√©tait pas XOR, mais un chiffrement de permutation fait par vous-m√™me, que vous ne pouvez pas ramasser m√™me avec cent tentatives?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Reconstruisez apk avec Frida</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cadre de cet article, nous envisagerons une m√©thode de solution plus indolore (et, √† notre avis, plus belle) - en utilisant le cadre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui nous permettra d'ex√©cuter des m√©thodes d'application apk arbitraires avec les arguments dont nous avons besoin au moment de l'ex√©cution. </font><font style="vertical-align: inherit;">Pour ce faire, vous avez besoin d'un t√©l√©phone avec des droits root ou d'un √©mulateur. </font><font style="vertical-align: inherit;">Nous supposons le plan d'action suivant:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation des composants Frida sur un PC et un t√©l√©phone de test.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©cup√©rez les URL correspondant au jeton ou aux demandes de liste et t√©l√©chargez le fichier (en utilisant Frida).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©cup√©ration de la somme de contr√¥le et des valeurs de signature de l'application d'origine.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenir une liste des fichiers stock√©s sur le serveur et identifier le fichier souhait√©.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez et d√©chiffrez le fichier.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous clarifierons la relation entre le t√©l√©phone root√© et l'apk. Nous installons l'application, l'ex√©cutons, mais le client de fichiers ne veut pas d√©marrer compl√®tement, il clignote et se ferme uniquement. Nous v√©rifions les messages via logcat - oui, c'est vrai, FileDroid sent d√©j√† que quelque chose ne va pas et r√©siste comme il peut. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/8s/2b/vn8s2bzyijssy664hsdgcxqnawc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nous tournons √† nouveau vers la classe MainActivity et constatons que la m√©thode doChecks () est appel√©e dans onCreate (), et elle affiche les erreurs suivantes dans le journal: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/xl/i6/wsxli6hxrjmgqnnkuh6b5a7h8my.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, onResume () v√©rifie √©galement si le port typique de Frida est ouvert: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-k/df/kv/-kdfkvyea8g0p6y-dkwxpk3flo4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
notre client de fichier est un peu intol√©rant au d√©bogage, root et Frida lui-m√™me. Une telle opposition n'est absolument pas incluse dans nos plans, nous obtenons donc le code smali de l'application en utilisant l'utilitaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apktool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ouvrez le fichier MainActivity.smali dans n'importe quel √©diteur de texte, trouvez la m√©thode onCreate () et transformez l'appel doChecks () en commentaire inoffensif: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z6/r2/ra/z6r2rautxzhef-0prc9odxmj2ek.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous privons la m√©thode suicide () de la possibilit√© de vraiment fermer l'application: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/ti/q6/iutiq6k6idg5_6h7wd1he2mjyem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, reconstruisons notre application l√©g√®rement am√©lior√©e √† l'aide d'apktool et signez lui en ex√©cutant les commandes suivantes (vous pouvez avoir besoin des droits d'administrateur):</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> <span class="hljs-string">"C:\Program Files\Java\jdk-14\bin"</span>
.\keytool -genkey -v -keystore filedroid.keystore -<span class="hljs-built_in">alias</span> filedroid_alias -keyalg RSA -keysize 2048 -validity 10000<font></font>
.\jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore  filedroid.keystore filedroid_patched.apk filedroid_alias<font></font>
.\jarsigner -verify -verbose -certs filedroid_patched.apk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous r√©installons l'application sur le t√©l√©phone, l'ex√©cutons - hourra, le t√©l√©chargement se passe sans incident, le journal est propre! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qm/u4/k2/qmu4k2ta7zji47msjnyhhq8ibqi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous proc√©dons √† l'installation du framework Frida sur un PC et un appareil mobile:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo pip3 install frida-tools<font></font>
$ wget https://github.com/frida/frida/releases/download/$(frida --version)/frida-server-$(frida --version)-android-arm.xz<font></font>
$ unxz frida-server-$(frida --version)-android-arm.xz<font></font>
$ adb push frida-server-$(frida --version)-android-arm /data/<span class="hljs-built_in">local</span>/tmp/frida-server
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lancez le serveur Frida Framework sur un appareil mobile:</font></font><br>
<br>
<pre><code class="bash hljs">$ adb shell su - <span class="hljs-string">"chmod 755 /data/local/tmp/frida-server"</span>
$ adb shell su - <span class="hljs-string">"/data/local/tmp/frida-server &amp;"</span>  
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pr√©parons un simple script get-urls.js qui appellera wat.getSecure () pour tous les serveurs de requ√™tes pris en charge:</font></font><br>
<br>
<pre><code class="actionscript hljs">Java.perform(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> 
</span>{
     <span class="hljs-keyword">const</span> wat = Java.use(<span class="hljs-string">'com.ctf.filedroid.wat'</span>);<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"fnks"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"qdmk"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"tkog"</span>));<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous lan√ßons FileDroid sur l'appareil mobile et ¬´nous accrochons¬ª avec notre script au processus correspondant: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/ir/if/pcirifn_grrejaapwi7s-7hg-xe.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Obtenez la liste des fichiers sur le serveur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, le serveur distant est devenu un peu plus proche de nous! </font><font style="vertical-align: inherit;">Nous savons maintenant que le serveur prend en charge les demandes des mani√®res suivantes:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depositedroid.neoquest.ru/api/verifyme?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depositedroid.neoquest.ru/api/list_post_apocalyptic_collection?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depositedroid.neoquest.ru/api/file?file=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {file} &amp; token = {token}</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin d'obtenir une liste des fichiers disponibles, il reste √† calculer la somme de contr√¥le et les valeurs de signature de l'application d'origine, puis √† les encoder en base64. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tel script en python3 vous permettra de faire ceci:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Divulgacher</font></font></b>
                        <div class="spoiler_text"><pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> binascii
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> asn1crypto <span class="hljs-keyword">import</span> cms, x509
<span class="hljs-keyword">from</span> zipfile <span class="hljs-keyword">import</span> ZipFile<font></font>
<font></font>
<font></font>
def get_info(apk):<font></font>
    with ZipFile(apk, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> zipObj:<font></font>
        classes = zipObj.read(<span class="hljs-string">"classes.dex"</span>)<font></font>
        resources = zipObj.read(<span class="hljs-string">"resources.arsc"</span>)<font></font>
        cert = zipObj.read(<span class="hljs-string">"META-INF/CERT.RSA"</span>)<font></font>
        crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
        <span class="hljs-keyword">return</span> get_full_crc(classes, resources).decode(<span class="hljs-string">"utf-8"</span>), get_sign(cert).decode(<span class="hljs-string">"utf-8"</span>)<font></font>
<font></font>
<font></font>
def get_crc(file):<font></font>
    crc = binascii.crc32(file) &amp; <span class="hljs-number">0xffffffff</span>
    <span class="hljs-keyword">return</span> crc<font></font>
<font></font>
<font></font>
def get_full_crc(classes, resources):<font></font>
    crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(bytes(crc, <span class="hljs-string">"utf-8"</span>))<font></font>
<font></font>
<font></font>
def get_sign(file):<font></font>
    pkcs7 = cms.ContentInfo.load(file)<font></font>
    data = pkcs7[<span class="hljs-string">'content'</span>][<span class="hljs-string">'certificates'</span>][<span class="hljs-number">0</span>].chosen.dump()<font></font>
    sha256 = hashlib.sha256()<font></font>
    sha256.update(data)<font></font>
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(sha256.digest())  <font></font>
<font></font>
get_info(<span class="hljs-string">'filedroid.apk'</span>)
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement manuellement. Nous consid√©rons CRC32 de classes.dex et resources.arsc comme n'importe quel outil pratique (par exemple, pour Linux - l'utilitaire crc32 standard), nous obtenons respectivement les valeurs 1276945813 et 2814166583, les concat√©nons (12769458132814166583 sortira) et encodons en base64, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/ba/km/wbbakmhm-8jmtyyudjhofelaz8s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin d'effectuer une proc√©dure similaire pour signer l'application, dans la fen√™tre JADX, acc√©dez √† la section ¬´Signature APK¬ª, copiez la valeur ¬´SHA-256 Fingerprint¬ª et codez-la dans base64 sous la forme d'un tableau d'octets: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/s9/zg/wxs9zgvtahyytsnvxis-k8lq8wg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans l'apk d'origine, le codage base64 est effectu√© avec le drapeau URL_SAFE, c'est-√†-dire </font><font style="vertical-align: inherit;">au lieu des caract√®res ¬´+¬ª et ¬´/¬ª, ¬´-¬ª et ¬´_¬ª sont respectivement utilis√©s. </font><font style="vertical-align: inherit;">Il est n√©cessaire de s'assurer que cela sera √©galement observ√© avec l'auto-codage. </font><font style="vertical-align: inherit;">Pour ce faire, lors du codage en ligne, vous pouvez remplacer l'alphabet utilis√© par "ABCDEFGHIJKLMNOPQRSTUVWXYZabcde fghijklmnopqrstuvwxyz0123456789 + /" par "ABCDEFGHIJKLMNOPQRSTUVWXYZabc script64 √† l'aide de 64 script.jp64.jp64cjc64 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, nous avons tous les ingr√©dients pour r√©ussir √† lister les fichiers:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depositedroid.neoquest.ru/api/list_post_apocalyptic_collection?crc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crc: MTI3Njk0NTgxMzI4MTQxNjY1ODM =</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signe: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY =</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ex√©cutons la demande GET - et applaudissons, notre liste! </font><font style="vertical-align: inherit;">De plus, le nom d'un des fichiers parle de lui-m√™me - "open-if-you-want-to-escape" - il semble que nous en ayons besoin. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/k4/vz/bkk4vzawktgg1ilhn1x06q90ahq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous demandons un jeton d'acc√®s unique et t√©l√©chargeons le fichier:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/verifyme'</span>, <font></font>
    		params={    <span class="hljs-string">'crc'</span>: <span class="hljs-string">'MTI3Njk0NTgxMzI4MTQxNjY1ODM='</span>, 
<span class="hljs-string">'sign'</span>: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY=},<font></font>
verify=False)<font></font>
    <font></font>
token = response.json()[<span class="hljs-string">'token'</span>]
<span class="hljs-built_in">print</span>(token)<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/file'</span>, <font></font>
params={<span class="hljs-string">'token'</span>: token, <span class="hljs-string">'file'</span>: <span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>}, verify=False)<font></font>
<font></font>
with open(<span class="hljs-string">"0p3n1fuw4nt2esk4p3.jpg"</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> fd:<font></font>
        fd.write(response.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ouvrons le fichier t√©l√©charg√© et rappelons une petite circonstance que nous avons laiss√©e pour plus tard:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/dc/rz/ktdcrzjrng635moxnmt5_phu2nu.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Ajoutez une pinc√©e de cryptographie ...</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh, trop t√¥t, nous avons mis FileDroid hors tension. Revenons √† JADX et voyons si les d√©veloppeurs de clients de fichiers nous ont laiss√© quelque chose d'utile. Oui, c'est le cas lorsque le nettoyage de code n'est clairement pas populaire: la m√©thode decryptFile () inutilis√©e attend tranquillement notre attention dans la classe ConnectionHandler. Ce que nous avons? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cryptage en </font><font style="vertical-align: inherit;">mode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AES de </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la CBC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sinhroposylka occupe les 16 premiers octets ... Paresse - le moteur du progr√®s, il vaut mieux utiliser √† nouveau Frida et d√©chiffrer notre 0p3n1fuw4nt2esk4p3.jpg sans effort. Mais passez simplement la cl√© de cryptage? Il n'y a pas beaucoup d'options, mais √©tant donn√© la pr√©sence d'une autre m√©thode savePlainFile (fichier String, Token String) ¬´oubli√©e¬ª, le choix est √©vident. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pr√©parez le script decrypt.js suivant (en tant que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeton</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indiquer la valeur r√©elle, par exemple, 'HoHknc572mVpZESSQN1Xa7S9zOidxX1PMbykdoM1EXI ='):</font></font><br>
<br>
<pre><code class="coffeescript hljs">Java.perform(function () {<font></font>
    const JavaString = Java.use(<span class="hljs-string">'java.lang.String'</span>);<font></font>
    const file_name = JavaString.$<span class="hljs-keyword">new</span>(<span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>);<font></font>
    const ConnectionHandler = Java.use(<span class="hljs-string">'com.ctf.filedroid.ConnectionHandler'</span>);<font></font>
    const result = ConnectionHandler.savePlainFile(file_name, &lt;token&gt;);<font></font>
    <span class="hljs-built_in">console</span>.log(result);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous mettons le fichier crypt√© 0p3n1fuw4nt2esk4p3.jpg sur / sdcard /, ex√©cutons FileDroid et injectons le script decrypt.js √† l'aide de Frida. </font><font style="vertical-align: inherit;">Une fois le script ex√©cut√©, le fichier plainfile.jpg appara√Ætra sur / sdcard /. </font><font style="vertical-align: inherit;">Nous l'ouvrons et ... juste r√©solu! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fb/3-/ah/fb3-ahlzcqlnfjsromkmbz9eil0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette t√¢che difficile n√©cessitait que les participants aient √† la fois des connaissances et des comp√©tences dans plusieurs domaines de la s√©curit√© de l'information, et nous sommes heureux que la plupart des concurrents y aient r√©ussi! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous esp√©rons que ceux qui n'ont pas eu suffisamment de temps ou de connaissances avant de recevoir la cl√© r√©ussiront d√©sormais des t√¢ches similaires dans n'importe quel CTF :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496910/index.html">Cr√©ez et personnalisez votre CDN</a></li>
<li><a href="../fr496912/index.html">ThinkPad E480 Intel sous Windows VS ThinkPad E495 AMD sur Ubuntu y a-t-il une diff√©rence?</a></li>
<li><a href="../fr496914/index.html">Le programme d√©cimal le plus court</a></li>
<li><a href="../fr496916/index.html">Enseignement, n√©gociation et consultation √† distance - Partie 3: Serveur de r√©union Yealink et 4 offres sp√©ciales</a></li>
<li><a href="../fr496920/index.html">Faire une maison intelligente avec ASP.NET Core et Arduino</a></li>
<li><a href="../fr496924/index.html">Routage des composants Web</a></li>
<li><a href="../fr496936/index.html">Cryptons les certificats SSL avec cert-manager dans Kubernetes</a></li>
<li><a href="../fr496938/index.html">Supercalculateurs, s√©quen√ßage du g√©nome et perspectives de vaincre le coronavirus</a></li>
<li><a href="../fr496940/index.html">Comment les ing√©nieurs de GM testent l'√©lectronique</a></li>
<li><a href="../fr496942/index.html">√âv√©nements num√©riques √† Moscou du 13 au 19 avril</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>