<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¶ üëâüèΩ üí± Implementation of algorithmic theory of games in Python with Nashpy ü§ôüèæ üéÑ üöµüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Game theory is a method of studying strategic situations where the results depend not only on your actions, but also on what others will do. 
 
 What ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Implementation of algorithmic theory of games in Python with Nashpy</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/leader-id/blog/486942/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Game theory is a method of studying strategic situations where the results depend not only on your actions, but also on what others will do. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What is a strategic situation? Recall the types of market structures: there is perfect competition when all companies are pricing, that is, they do not need to worry about a pricing strategy, and there is a monopoly when there is only one company on the market that sets its prices. So: everything between perfect competition and a monopoly is a strategic situation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algorithmic game theory is at the junction of game theory and computer science and aims to study and create algorithms for strategies. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/rg/qx/tprgqxrdoiwdsvifyam0fzrl6qs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Under the cat, a short story about how you can use the theory of games in Python using the Nashpy library.</font></font><br>
<br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the Editor: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why did we suddenly remember about game theory? </font><font style="vertical-align: inherit;">Everything is simple - continuously upgrading our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">platform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with 900 thousand participants, we are constantly faced with situations where various strategies need to be developed. </font><font style="vertical-align: inherit;">For example, on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NTI experts </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">portal</font></a><font style="vertical-align: inherit;"> : whether to confirm everyone in a row or, conversely, not to confirm anyone, but only ask for confirmation. </font><font style="vertical-align: inherit;">Another example: In Boiling Points, a struggle for resources is regularly observed, and there are dilemmas - do we ask all the equipment at once, write real numbers to the number of participants, or overstate? </font><font style="vertical-align: inherit;">Moreover, the solution of these issues should be carried out with the maximum benefit for all.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nashpy</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the name suggests, the library provides algorithmic capabilities to achieve Nash equilibrium - a set of strategies for two players, when each of them chooses the most optimal version of their behavior based on a similar setting for the second player. </font><font style="vertical-align: inherit;">Remotely, it resembles the win-win principle, but with an orientation to minimal losses in any situation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To understand this concept, let us turn to the popular model ‚Äú </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prisoner Dilemma</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To surrender or not to surrender</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are two players (prisoners) who must decide whether to cooperate with each other without giving another name during interrogation by the police. The usefulness of this behavior will be estimated at three points for each player, if both choose this path. The starting point here is the punishment: if the players give each other out, they can be charged with ‚Äúconspiracy action,‚Äù that is, ‚Äúbanditry,‚Äù and the punishment for them in this case will be more severe than if they acted separately. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If one player passes the other (provided that he does not pass), the utility for him will be four points, for the other player - zero points. If the prisoners surrender each other, the usefulness will be one point per brother.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To make it easier to imagine this set of options, put them on the plate, where in the cells, indicate the number of points for each prisoner, depending on the choice made: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f5d/8b9/4aa/f5d8b94aa4ad756d07b87ff3c433bb65.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1 - player 1, P2 - player 2, C - cooperation, NC - one player passed another</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the end, the best option for both is to hand over each other. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why won't the prisoners collaborate? </font><font style="vertical-align: inherit;">Consider the strategy of player 1 (P1):</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if player 2 (P2) decides to cooperate with P1, the best strategy for P1 is to turn in player P2, since 4&gt; 3</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if P2 decides to turn in P1, then P1 is more profitable to turn in to play P2, since 1&gt; 0</font></font><br>
</li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the winning strategy for P1 is (NC; NC), which is also true for P2. </font><font style="vertical-align: inherit;">Thus, the Nash equilibrium will be the strategy (NC; NC) when the players P1 and P2 surrender each other to the police.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We transfer the theory to Python</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First you need to install the module. </font><font style="vertical-align: inherit;">This can be done by the team </font></font><code>pip install nashpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">through the Jupyter console. </font><font style="vertical-align: inherit;">At the end of the installation, you can begin to set the game conditions. </font><font style="vertical-align: inherit;">For two players with a non-zero result (which is the default value in Nashpy), you need to create two matrices that reflect the game situations for each player. </font><font style="vertical-align: inherit;">For example, for player 1, the matrix will look like this:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NC</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NC </font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For player 2, like this:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NC</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NC </font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's reproduce this in Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> nashpy <span class="hljs-keyword">as</span> nash
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> ns<font></font>
P1=np.array([[<span class="hljs-number">3</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">1</span>]])<font></font>
P2=np.array([[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]])<font></font>
prisoner_dilemma=nash.Game(P1,P2)<font></font>
<font></font>
prisoner_dilemma</code></pre><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c71/83b/23b/c7183b23bd73af6c5eb61836ba4bc72f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Looking at these plates, we can get an estimate of the usefulness of the interaction of players. That is, if P1 does not give P2, and P2 gives P1, then the utility values ‚Äã‚Äãwill be (0, 4). We can get the same thing with matrix calculations in Nashphy. We take a vector of actions as a sigma (we have two of them: to collaborate or hand in another prisoner), where the value 0 is assigned to all cells except the one where the action takes place. Then, for player 1, the usefulness of the action will be calculated as: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7d/1x/jq/7d1xjqt_t3m32dghrm6f3lb9ivi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For player 2: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jt/p8/vo/jtp8vogp_msappemnqyyoct9mho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Applying the formula to the scenario, when player 1 has chosen a strategy for cooperation with another player, and player 2 has decided to hand over player 1, we get: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/07c/847/710/07c8477107df3dd85834f9b4624ddc9b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check with Nashpy: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ea9/8e2/b9a/ea98e2b9a84a46202abfcc48919195c6.png"><br>
<br>
<img src="https://habrastorage.org/webt/jk/1x/en/jk1xen3cfbsuailmz_dyhxbvxmi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Find out if it finds an algorithm Nash equilibrium, which, as we have already found out, is (NC; NC):</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b39/914/74a/b3991474a19677745e807f875f8ae0f1.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b0c/fea/11c/b0cfea11cfb0969aa01fd140eac6285c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the Nash equilibrium consists of two vectors, each of which reflects the actions of one player: for player 1, this is [0; </font><font style="vertical-align: inherit;">1], where 1 in the second field means that player 1 decided to turn in player 2. We see a similar picture for the second player.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS what can be read on</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Game Theory (Avinash Dixit and Barry Neilbuff) is a fairly recent publication from the MYTH Publishing House. </font><font style="vertical-align: inherit;">In the book, with examples from cinema, sports, politics and history, the authors show how almost all companies and people are involved in interactions that are described by game theory.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conflict Strategy (Thomas Schelling). </font><font style="vertical-align: inherit;">The book is devoted to the study of the general logic of behavior of participants in conflict situations - game theory. </font><font style="vertical-align: inherit;">Released in 1960, it became a fundamental contribution to this science, laying the foundations of the theory of strategic behavior.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rock, Paper, Scissors: Game Theory in Everyday Life (Len Fisher) is another book about the science of collaboration. </font><font style="vertical-align: inherit;">Fisher shows how game theory has helped biologists understand the evolution of collaboration in nature, and how we could apply it in our society.</font></font><br>
</li>
</ol></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/en486942/">https://habr.com/ru/post/en486942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486928/index.html">How to raise your server on docker based RaspberryPI</a></li>
<li><a href="../en486930/index.html">A selection of entertaining statistical facts # 4</a></li>
<li><a href="../en486932/index.html">Cybernetics in the USSR: from pseudoscience to a panacea</a></li>
<li><a href="../en486934/index.html">We are testing an inexpensive industrial LED lamp TL-PROM-50-5K with honest features</a></li>
<li><a href="../en486938/index.html">Understanding the machine learning model that breaks CAPTCHA</a></li>
<li><a href="../en486944/index.html">Hewlett Packard Enterprise Webinars | February-April 2020</a></li>
<li><a href="../en486946/index.html">do {Yoga} while (backache)</a></li>
<li><a href="../en486948/index.html">How to choose an editor, and why choose NeoVim?</a></li>
<li><a href="../en486950/index.html">Antiquities: the merciless upgrade of the 386th computer</a></li>
<li><a href="../en486962/index.html">HSE Game Development Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>