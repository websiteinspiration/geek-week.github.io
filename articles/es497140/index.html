<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üâê üîñ üñ≤Ô∏è Descifrado de datos en el bus CAN VW Polo sed√°n ‚òØÔ∏è üçµ üï∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy hablaremos sobre los m√©todos para descifrar los datos del bus CAN utilizando el ejemplo de un auto VW Polo Sedan 2019. En Internet, estos art√≠culo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Descifrado de datos en el bus CAN VW Polo sed√°n</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497140/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hoy hablaremos sobre los m√©todos para descifrar los datos del bus CAN utilizando el ejemplo de un auto VW Polo Sedan 2019. </font><font style="vertical-align: inherit;">En Internet, estos art√≠culos a menudo se llaman CAN Bus Hacks, pero no me gusta este nombre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El art√≠culo describe los m√©todos para encontrar los datos necesarios en el bus CAN del autom√≥vil, ejemplos de la aplicaci√≥n de estas t√©cnicas en el VW Polo Sedan. </font><font style="vertical-align: inherit;">Vega MTX se utiliza como equipo para conectarse a un bus CAN. </font><font style="vertical-align: inherit;">Hablemos un poco m√°s sobre telem√°tica. </font><font style="vertical-align: inherit;">Debajo del corte muchas fotos sobre el tema, varios gifs y videos.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unas pocas palabras acerca de ti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mi nombre es Alexey Fokin, en este momento trabajo para Vega Absolute</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vega_absolute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. La oficina central en Novosibirsk, pero yo trabajo en Mosc√∫. Una de nuestras direcciones es la telem√°tica. Fabricamos equipos para el seguimiento de veh√≠culos comerciales, veh√≠culos compartidos, taxis, etc. Mi trabajo es recopilar datos de autom√≥viles y convertirlos en configuraciones para nuestros equipos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora al auto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conexi√≥n al bus CAN se realiz√≥ en dos lugares: detr√°s del tablero de instrumentos (bus de 500 Kbit / s) y detr√°s de la radio (100 Kbit / s). Tambi√©n hay una conexi√≥n redundante: la conexi√≥n al conector OBDII directamente en el conector (500 Kbit / s). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De las herramientas utilizadas: Unidad de monitoreo de veh√≠culos Vega MTX equipada con un esc√°ner CAN. Para configurarlo en una PC, el programa Configurator 1.27.14.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede encontrar m√°s informaci√≥n sobre c√≥mo conectarse a un autom√≥vil y MTX en el video al final del art√≠culo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando est√© conectado a todos los buses CAN, veremos la siguiente imagen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z4/j3/ad/z4j3ad0zxuso-cm1kzaa1omjpp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este flujo de datos, necesita encontrar los bits y bytes que son responsables de los par√°metros que necesitamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La captura de pantalla siguiente muestra cu√°ntos sensores est√°n actualmente registrados en el bloque telem√°tico, y esta no es una lista completa. Puede profundizar a√∫n m√°s y buscar a√∫n m√°s sensores. Algunos de estos sensores en tiempo real env√≠an lecturas al servidor, lo que le permite ver el estado de su autom√≥vil en cualquier momento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La telem√°tica es un tema para un art√≠culo separado, por lo que no nos detendremos en esto aqu√≠ en detalle.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/qr/_p/kzqr_pzavnxnqpai7jt42tsvrwa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pregunta surge de inmediato: ¬øpor qu√© necesito buscar datos en una secuencia si puedo verlos a trav√©s de ELM327 u otros dispositivos de diagn√≥stico? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pregunta aqu√≠ es por qu√© necesitamos estos datos. En nuestro caso, necesitamos los datos para telem√°tica, y para no interferir con el funcionamiento del bus CAN y no enviarle ning√∫n dato, los buscamos en la transmisi√≥n. Vega MTX tiene un modo especial para trabajar con el bus CAN: el modo de "escucha". El modo habla por s√≠ solo, el equipo solo escucha el autob√∫s y no le env√≠a nada, lo que minimiza cualquier impacto en el sistema normal del autom√≥vil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, un sensor para abrir una puerta. Si le hacemos una solicitud, entonces solo podemos hacer esto con la ignici√≥n encendida. Despu√©s de apagar el encendido y el bus CAN se duerme, este sensor no estar√° disponible para nosotros. Si encontramos este sensor en la transmisi√≥n CAN, lo veremos todo el tiempo cuando el bus CAN est√© funcionando. Y, cuando abre la puerta, CAN se activar√° autom√°ticamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debe entenderse que todos los ejemplos a continuaci√≥n solo son relevantes para la conexi√≥n Polo Sedan. En otros, el equipo puede no tener ninguno de los sensores enumerados, pero para otras marcas y modelos de autom√≥viles, los datos estar√°n en identificaciones completamente diferentes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le llamo la atenci√≥n sobre el hecho de que, por defecto, en el Configurador hay una visualizaci√≥n de valores en formato HEX. </font><font style="vertical-align: inherit;">En el futuro, tendremos que traducir datos del formato HEX a valores decimales m√°s de una vez. </font><font style="vertical-align: inherit;">La forma m√°s f√°cil de hacer esto es usar la aplicaci√≥n Calculadora integrada en Windows 10. </font><font style="vertical-align: inherit;">Lo traducimos al modo "programador" y tenemos la opci√≥n de elegir en qu√© sistema num√©rico ingresar datos, y se duplican en otros sistemas num√©ricos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mediante el m√©todo de b√∫squeda, divido todos los sensores del autom√≥vil en varios tipos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensores binarios. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambio r√°pido de sensores. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensores de temperatura. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kilometraje del coche.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensores de nivel. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensores de indicaci√≥n</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensores con peticiones. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora pasemos a los m√©todos con los que puede encontrar cada tipo de sensor. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Sensores binarios</font></font></b></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comencemos con los sensores binarios m√°s simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estos sensores incluyen sensores de puerta, cinturones de seguridad, freno (si las luces de freno est√°n encendidas), freno de mano, botones presionados, etc. </font><font style="vertical-align: inherit;">Su valor se coloca en 1 bit, es decir, puede ser 0 (la puerta est√° cerrada) o 1 (la puerta est√° abierta). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrarlos es simple, pero requiere cuidado. </font><font style="vertical-align: inherit;">Para buscar la puerta del conductor, abra / cierre la puerta y observe los cambios en el bus CAN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El configurador resalta en rojo aquellos datos en los que ha habido cambios en los √∫ltimos segundos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/8x/jp/zf8xjpvzhahuxhbdadj6tsmmtum.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, la puerta del conductor es responsable del bit cero del primer byte del mensaje con ID 470. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el mismo byte est√°n los sensores de todas las otras puertas + sensor de maletero.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Cambio r√°pido de sensores</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los sensores que cambian r√°pidamente son similares a los sensores binarios, solo su valor es m√°s de 1 bit. Podemos actuar sobre estos sensores e inmediatamente ver cambios en el bus CAN. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estos sensores incluyen la mayor√≠a de los sensores de posici√≥n: posici√≥n del pedal del acelerador, posici√≥n del vidrio, posici√≥n de la transmisi√≥n autom√°tica, posici√≥n de la llave de encendido. Adem√°s de estos, estos son sensores de velocidad, revoluciones, sensores de aceleraci√≥n del volante, aceleraci√≥n del acelerador, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para empezar, trataremos los sensores de posici√≥n utilizando el ejemplo del sensor de posici√≥n del pedal del acelerador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, apagamos el autom√≥vil, activamos el encendido y, sin arrancar el motor, presionamos el pedal del acelerador y monitoreamos el cambio en el bus CAN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como regla general, cuando se suelta el pedal del acelerador, el valor de este sensor es 0 y, al presionar el pedal del acelerador, aumenta a alg√∫n valor. Vemos dicho par√°metro en el primer CAN en ID 280. El quinto byte cambia de 0 (se suelta el pedal) a FA (el pedal se presiona "al piso"). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si transferimos FA de HEX a DEC, entonces obtenemos el n√∫mero 250. Por lo tanto, para presionar el pedal del acelerador en porcentaje (de 0 a 100), necesitamos multiplicar nuestro valor por 0.4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora pasemos a los sensores que no caben en un byte, por ejemplo, a la velocidad del motor. Gradualmente aumentamos y disminuimos la velocidad del motor, mientras observamos los cambios en el bus CAN. Las revoluciones del motor est√°n en la misma identificaci√≥n que el pedal del acelerador.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de haber trabajado con el acelerador, puede comprender que los datos aqu√≠ est√°n en el orden inverso. Es decir, la parte m√°s antigua est√° en el tercer byte (cuenta bytes desde cero), y la m√°s joven en el segundo byte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debe transferir los datos de HEX a DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/ev/zh/ohevzhgaspocuc3h3mp1o3z8ciw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debemos evaluar las revoluciones reales con el tac√≥metro o con instrumentos de diagn√≥stico. En mi caso, la aguja estaba a aproximadamente 1600 rpm en el tac√≥metro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, dividimos los datos de CAN en formato decimal (6508) por la velocidad del motor desde el tac√≥metro (1600), obtenemos 4.0675. Dado el error en la determinaci√≥n de las revoluciones a simple vista, redondee el divisor a 4. Despu√©s de esto, debe verificar las lecturas en varios puntos. Para hacer esto, configure la velocidad del motor a diferentes velocidades y verif√≠quelas con los datos del bus CAN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el configurador, puede sustituir todos los coeficientes en la configuraci√≥n del sensor y observar los cambios de velocidad en tiempo real. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, se busca una gran cantidad de sensores: fuerzas de frenado, posici√≥n del volante, aceleraci√≥n del volante, velocidad del veh√≠culo, etc.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. sensores de temperatura</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fue muy dif√≠cil encontrar la temperatura en Polo Sedan. Para empezar, se encontr√≥ un byte, que cambi√≥ lentamente hacia arriba cuando el autom√≥vil se calent√≥. Despu√©s de eso, comenz√≥ la b√∫squeda de los coeficientes necesarios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectamos los diagn√≥sticos, seleccionamos la temperatura del motor y comparamos las lecturas del bus CAN y los datos de los diagn√≥sticos. Construimos una tabla de correspondencia y seleccionamos los coeficientes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de la selecci√≥n de coeficientes, apareci√≥ una f√≥rmula para calcular la temperatura. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
XX * 0.75 - 48 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donde XX es el valor de 1 byte de ID 288 en el DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/vj/nf/hyvjnf90gsz8naskw2ep1q7ifsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seg√∫n la f√≥rmula, se puede calcular que la captura de pantalla ten√≠a una temperatura de </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
179 * 0.75 - 48 = 86.25 ¬∞ C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donde 179 es el n√∫mero decimal B3 del primer byte de ID 288.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero este es un caso dif√≠cil, en muchos autom√≥viles la temperatura es mucho m√°s f√°cil de encontrar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que es dif√≠cil transmitir un n√∫mero negativo en el bus, los fabricantes aceptan el valor -40 ¬∞ C, -48 ¬∞ C o -58 ¬∞ C como 0 mediciones. Por lo tanto, conectamos los diagn√≥sticos y vemos cu√°l es la temperatura ahora. Agregue 40 (48 o 58) a esto y traduzca a HEX. Estamos buscando el n√∫mero resultante en la transmisi√≥n. Estamos esperando que la temperatura de la m√°quina cambie un grado y verifiquemos con el valor encontrado. Si su valor tambi√©n aument√≥ en 1, entonces este es el sensor que necesitamos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es importante no confundir los valores del bus CAN con los valores de las consultas de diagn√≥stico. Si busca simult√°neamente lecturas en el bus y la herramienta de diagn√≥stico est√° conectada, las respuestas a las solicitudes de diagn√≥stico tambi√©n aparecer√°n en el bus. Se pueden identificar por identificaci√≥n. Por lo general, todo lo que supera las 700 ID son solicitudes y respuestas de diagn√≥stico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, la temperatura del refrigerante siempre se puede hacer una solicitud, sobre este m√©todo se describir√° a continuaci√≥n en la secci√≥n sobre sensores con solicitudes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede usar otro m√©todo para buscar temperatura: f√≠sicamente encontramos el sensor de temperatura del refrigerante (DTOZH) en el motor, lo apagamos y conectamos una resistencia variable al cableado del autom√≥vil. Luego, girando la resistencia y siguiendo el bus CAN de acuerdo con el m√©todo de b√∫squeda de datos que cambian r√°pidamente, puede encontrar las lecturas de temperatura del motor.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la pr√°ctica, no utilic√© este m√©todo, ya que ALT siempre estaba en la transmisi√≥n o ped√≠an una solicitud a la m√°quina. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. kilometraje del coche</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uno de los par√°metros m√°s importantes para la telem√°tica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero debe evaluar qu√© tama√±o estamos buscando para un n√∫mero. </font><font style="vertical-align: inherit;">Si toma 2 bytes (16 bits) de datos, entonces el n√∫mero m√°ximo FF FF = 65,535 encajar√° en ellos. El autom√≥vil puede viajar claramente m√°s de 65 mil, lo que significa que el veh√≠culo debe tener un m√≠nimo de 24 bits de largo. </font><font style="vertical-align: inherit;">Ya caben 16 millones de km., Lo cual es claramente suficiente para una carrera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, de nuevo, en diferentes autos de diferentes maneras. </font><font style="vertical-align: inherit;">En Polo Sedan, el kilometraje se escribe en km, en algunos franceses se transmite con una precisi√≥n de 100 metros. </font><font style="vertical-align: inherit;">entonces el n√∫mero puede ocupar 32 y m√°s bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de la b√∫squeda, debe tomar el kilometraje del tablero del autom√≥vil y transferirlo a HEX.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_g/y1/s6/_gy1s64ytgtjtxrkpxqccunxe2w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, son 5732 km. Lo traducimos a HEX y obtenemos 16 64. A continuaci√≥n, busque para encontrar la l√≠nea donde se producir√° esta combinaci√≥n. Debe buscar por un byte, es decir, primero buscar 16, luego en las opciones encontradas, ver si tambi√©n est√° el n√∫mero 64 al lado del n√∫mero 16. El n√∫mero 64 puede estar a la izquierda o a la derecha del n√∫mero 16. Dado que el millaje en este autom√≥vil no es grande, lo m√°s probable, al lado del n√∫mero 64 tambi√©n ser√° 00. En el Configurador hay una b√∫squeda conveniente (CTRL + F), si usa otra herramienta, deber√° buscar manualmente estos datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, el kilometraje se encontr√≥ en 520 ID </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/qs/0l/ktqs0lxxwbl7frstr8vjz9qvc54.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
00 16 64 = 5732 km. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar, es recomendable conducir unos pocos kil√≥metros m√°s y verificar el valor del sensor encontrado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Del mismo modo, se busca el kilometraje antes de repostar. </font><font style="vertical-align: inherit;">En este autom√≥vil, el tablero no transfiere el kilometraje a la estaci√≥n de servicio al neum√°tico, por lo que se realiza a pedido.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Sensores de nivel</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo sensor m√°s importante para la telem√°tica es el sensor de nivel de combustible. Puede encontrarlo en la transmisi√≥n, que es preferible, o por solicitud (menos preferible, pero en algunos autom√≥viles no funcionar√° de manera diferente). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero necesita encontrar las lecturas de nivel de combustible en la herramienta de diagn√≥stico. Mi nivel de combustible se encontr√≥ en el grupo de instrumentos (bloque 17). En el grupo de instrumentos, las lecturas del sensor de nivel est√°n en litros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora el auto tiene 21 litros de combustible. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/r-/rq/t6r-rq-pcbo-urm-pmfurhg7iwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Traducimos 21 de DEC a HEX y obtenemos el n√∫mero 15. Al buscar, tratamos de encontrarlo. La secuencia contiene el n√∫mero dado en ID 320. Si no se encuentra el n√∫mero, entonces debe intentar buscar valores uno o m√°s. En algunos autom√≥viles, el combustible viene con una precisi√≥n de medio litro, por lo que debe buscar un valor 2 veces mayor.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l-/mn/tw/l-mntw35tvcsswdhb_kh8sicrb4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez que se encuentra el nivel de combustible, es necesario verter unos pocos litros de combustible en el autom√≥vil y ver el resultado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n puede desmontar el tanque de gasolina, extraer el FLS del tanque y moverlo, siguiendo las lecturas del bus CAN. O retire el conector del FLS y conecte una resistencia variable all√≠. Gir√°ndolo y siguiendo los cambios puede encontrar el sensor de nivel de combustible. Si decide desmontar, el nivel de combustible debe buscarse mediante el m√©todo de b√∫squeda de sensores que cambian r√°pidamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, al buscar, no se deben tener en cuenta los datos con ID superiores a 700. Estas son consultas de diagn√≥stico. Despu√©s de desconectar el equipo de diagn√≥stico, estos datos desaparecer√°n. Trataremos las solicitudes con m√°s detalle a continuaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, la respuesta a las consultas del equipo de diagn√≥stico del nivel de combustible desde el tablero se ve as√≠.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, el nivel de combustible (en porcentaje) se puede encontrar en consultas OBDII est√°ndar, pero en el grupo VAG no siempre muestran los datos correctos. </font><font style="vertical-align: inherit;">En el Skoda Rapid y Skoda Oktavia con el tanque lleno, los diagn√≥sticos muestran un nivel de combustible del 85%.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/bc/hg/cpbchg8ntk3n1qjolnygoq5zr_c.png"><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Sensores de indicaci√≥n</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los sensores de indicaci√≥n son muy similares a los sensores binarios, y deben buscarse por el mismo m√©todo. Estos sensores incluyen una variedad de √≠conos en el tablero. Por ejemplo, el estado del icono Check Engine est√° en el primer byte de ID 480. Cuando se activa el encendido en este sensor 2C. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/sx/de/8rsxdelhyjgtedcykc0f4utt71s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de comenzar, cuando se apaga el √≠cono Check Engine (CE), habr√° un 00 en este sensor. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/uq/su/8ruqsurccmkip9yhssm-8flrp00.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora queda la pregunta, qu√© bit es responsable del √≠cono CE. Traducimos 2C a BIN y obtenemos el n√∫mero 0010 1100. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, copie la ID 480 completa, cambie el primer byte a 2C (0010 1100) e intente enviar este paquete al autom√≥vil. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Atenci√≥n!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, enviar datos al autom√≥vil no siempre es seguro, puede romper algo o aumentar el kilometraje. </font><font style="vertical-align: inherit;">Vale la pena recurrir a este m√©todo solo si no se puede encontrar el sensor buscando sensores binarios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En mi caso, envi√© a un autom√≥vil arrollado (que no se recomienda) y mi √≠cono CE y EPC parpadea en mi orden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/ci/gb/fjcigbvg8hop-hhliayqzsz81fy.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego enviamos en lugar de 2C (0010 1100) 08 (0000 1000). </font><font style="vertical-align: inherit;">En ordenado CE parpadea. </font><font style="vertical-align: inherit;">Por lo tanto, 3 bits son responsables de este icono. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kl/tl/up/kltlupgvkuuktk8bxujsft2shb8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si env√≠a 04 (0000 0100), el √≠cono EPC parpadea.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Sensores con peticiones</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No todos los datos se pueden encontrar en la secuencia. Por ejemplo, en un VW Transporter T4 diesel no hay temperatura del motor en la corriente. Ella no est√° ordenada. Por lo tanto, debe preguntarle al autom√≥vil sobre estos par√°metros. Lo mismo se aplica al nivel de combustible en Rio \ Solaris. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este ejemplo, intentemos preguntar el nivel de combustible del Polo Sedan. Vamos al bloque 17, como hicimos en el p√°rrafo sobre la b√∫squeda del nivel de combustible, y preguntamos al tablero. Despu√©s de analizar las solicitudes, vemos que el diagn√≥stico solicita el nivel de combustible con el siguiente comando: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p4/xo/qg/p4xoqgno99-xktykwtl5gagpo1y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en respuesta se trata de ella: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, copie la ID 714, apague la herramienta de diagn√≥stico e intente enviar una solicitud al autom√≥vil. Si el ID 77E recibe la misma respuesta que cuando se conect√≥ el diagn√≥stico, recibimos un paquete con un nivel de combustible (4 bytes. HEX 15 = DEC 21) 21 litros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vega MTX tiene herramientas integradas para trabajar con sensores con consultas. All√≠ puede configurar que las solicitudes se env√≠en despu√©s de que se active el encendido en un intervalo determinado o bajo ciertas condiciones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto concluye con la metodolog√≠a para buscar datos en el bus CAN. Si alguien m√°s sabe qu√© m√©todos encontrar los datos necesarios en el bus CAN o compartir su experiencia, entonces los escuchar√© con gusto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de escribir este art√≠culo, hice un video sobre este tema. El video contiene m√°s informaci√≥n sobre la conexi√≥n al bus CAN del veh√≠culo, trabajando con el Configurador y el servidor de archivos</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DkdOdCKI9HQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enlace al Configurador</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El servidor tiene configuraciones para algunos autom√≥viles, camiones y maquinaria agr√≠cola. </font><font style="vertical-align: inherit;">Todos los archivos est√°n encriptados, puede ver qu√© sensores son visibles en el CAN del veh√≠culo. </font><font style="vertical-align: inherit;">Cuando est√© conectado, los valores del sensor ser√°n visibles, pero no funcionar√° para ver las direcciones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Continuar√°.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es497116/index.html">Los camiones no tripulados de Starsky Robotics llegan a su fin</a></li>
<li><a href="../es497118/index.html">[Pron√≥stico] ¬øTerminar√°n todos los camiones no tripulados o solo Starsky Robotics?</a></li>
<li><a href="../es497126/index.html">T√©cnicas de puntuaci√≥n y priorizaci√≥n de pedidos acumulados</a></li>
<li><a href="../es497132/index.html">#SaveFirst Initiative para apoyar proyectos socialmente importantes</a></li>
<li><a href="../es497136/index.html">"Save Concord" o un informe de las pruebas del sistema de radar ruso para buscar objetos extra√±os en la pista</a></li>
<li><a href="../es497142/index.html">C√≥mo agregamos compatibilidad con Harmony OS a la aplicaci√≥n inDriver para Android</a></li>
<li><a href="../es497144/index.html">Cu√±a por cu√±a: uso del virus PIV5 para crear una vacuna contra MERS-CoV y posiblemente contra SARS-CoV-2</a></li>
<li><a href="../es497146/index.html">Criptograf√≠a aplicada. C√≥mo restauramos bitcoins por 300 mil d√≥lares</a></li>
<li><a href="../es497148/index.html">Crear una aplicaci√≥n de escritorio usando Golang y Fyne</a></li>
<li><a href="../es497152/index.html">Donde vive el coraz√≥n del producto: m√©tricas para medir la felicidad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>