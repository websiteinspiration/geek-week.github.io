<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐓 🐢 👩🏻‍🚀 最新のWindows 10アプリケーションでの2000年のスタイルのファジング 🤰🏾 💇 🖕🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="図。 1.あざがありますが、壊れていません。最近Githubでコードが公開された Windows電卓は、ハングせず、2000年に開発されたウィンドウメッセージのファザーに対抗しない、テスト済みの2つのアプリケーションの1つであることが判明しました。ファジングアーティファクトを表示するためにウィンドウ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最新のWindows 10アプリケーションでの2000年のスタイルのファジング</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451816/"><img src="https://habrastorage.org/getpro/habr/post_images/cb6/3b4/ca2/cb63b4ca2a435ac151253934fcb775b6.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 1.あざがありますが、壊れていません。最近</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でコードが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">公開された</font></a><font style="vertical-align: inherit;"> Windows電卓は、</font><font style="vertical-align: inherit;">ハングせず、2000年に開発されたウィンドウメッセージのファザーに対抗しない、テスト済みの2つのアプリケーションの1つであることが判明しました。ファジングアーティファクトを表示するためにウィンドウサイズが特別に拡大されました。</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
現代のシステムで古代のファジング方法をテストするための取り組みの第2部です。見逃した方は、こちらが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のパート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。今回は、2000年に発表されたJustin ForresterとBarton Millerによる記事「ランダムテストを使用したWindows NTアプリケーションの信頼性の実証的調査」（別名「NTファジングレポート」）からWindows 10ファジング手法を試します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
研究者は、Windows NTの以前のバージョンの33のアプリケーションとWindows 2000の以前のバージョンをテストして、歪んだウィンドウメッセージやランダムなマウスとキーボードイベントの影響を受けやすいかどうかを調べました。</font><font style="vertical-align: inherit;">ミラー博士がファザーコードを公開して以来</font><font style="vertical-align: inherit;">、元の作者</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とまったく同じツール</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して最新のWindowsアプリケーションのバグを発見しました。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果はほぼ同じです。19年前に、テストされたアプリケーションの100％がクラッシュするか、歪んだウィンドウメッセージが発生したときにクラッシュしました。</font><font style="vertical-align: inherit;">今日、同じファザーがテストしたアプリケーションの93％を落とした、または吊り下げました。</font><font style="vertical-align: inherit;">私たちの旧友の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電卓</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を含めて、たった2つしか立っていません</font><font style="vertical-align: inherit;">でした（図1）。</font><font style="vertical-align: inherit;">また、Windowsでバグ（セキュリティ上の問題ではない）が見つかりました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windowsの簡単な紹介</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、ウィンドウメッセージとは何ですか。なぜそれらはプログラムをクラッシュさせるのでしょうか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows GUIアプリケーションは、イベント駆動型です：マウスの動き、ボタンのクリック、キーストロークなど。イベント駆動型アプリケーションは、イベントを受け取るまで何もしません。イベントが受信されると、アプリケーションはそのイベントに基づいてアクションを実行し、他のイベントを予期します。聞き覚えがある？このアーキテクチャ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、node.jsなどのプラットフォームでセカンドライフを受けました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウメッセージは、Windowsイベント通知メソッド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。それぞれに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、特定のイベントに関連付けられ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">数値コードがあります</font></a><font style="vertical-align: inherit;">。各メッセージには1つまたは複数のパラメーターがあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、慣例によりlParamおよびwParamと呼ばれ</font></a><font style="vertical-align: inherit;">ます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">イベントに関するより詳細な情報を定義します。</font><font style="vertical-align: inherit;">そのような情報の例は、マウスの動きの座標、どのキーが押されたか、どのテキストがウィンドウに表示されるかです。</font><font style="vertical-align: inherit;">これらのメッセージは、プログラム自体、オペレーティングシステム、またはその他のプログラムによって送信されます。</font><font style="vertical-align: inherit;">それらはいつでもどの順序でも到着でき、受信側のアプリケーションで処理する必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全への影響</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Vistaより前は、特権の低いプロセスが特権の高いプロセスにメッセージを送信できました。</font><font style="vertical-align: inherit;">メッセージの正しい組み合わせを使用して、そのプロセスでコードを実行できます。</font><font style="vertical-align: inherit;">Vistaでは、これらの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「破壊的な攻撃」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">し、別のセッションでシステムサービスを分離すること</font><font style="vertical-align: inherit;">によって、主に防御され</font><font style="vertical-align: inherit;">ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィンドウメッセージの処理が不適切であっても、2つの理由で最新のWindowsシステムのセキュリティに影響を与えることはほとんどありません。まず、ウィンドウメッセージをネットワーク経由で送信できません。次に、アプリケーションをクラッシュさせたり、同じ特権レベルでコードを実行したりすることは、攻撃者にとってあまり役に立ちません。おそらく、NTファジングレポートの作成者には明らかでした。安全性についての記述はありませんが、ウィンドウメッセージの処理に失敗した場合は、厳密なテストが行​​われていないことを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じ特権でコードを実行すると、セキュリティが侵害される可能性があるいくつかの領域があります。</font><font style="vertical-align: inherit;">一部のアプリケーションは、さまざまなセキュリティプリミティブを組み合わせて、元々オペレーティングシステムにはなかった人工的な特権レベルを作成します。</font><font style="vertical-align: inherit;">典型的な例は、ブラウザーでレンダリングするためのサンドボックスです。</font><font style="vertical-align: inherit;">ブラウザの製造元はこれらの問題をよく認識しており、それら</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に対処するための措置を講じています</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">別の例は、ウイルス対策製品です。</font><font style="vertical-align: inherit;">そこで、コントロールパネルは通常の権限で動作しますが、他のウイルス対策モジュールから分離されています。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト方法</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストスイートのすべてのアプリケーションをファジングするために、最初のNTレポートで説明されているのと同じ基本コードとファジング手法を使用しました。</font><font style="vertical-align: inherit;">特に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SendMessage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モード</font><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostMessage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モードの</font><font style="vertical-align: inherit;">両方</font><font style="vertical-align: inherit;">で、fazzerは42のシードを持つ500,000メッセージの3回の反復と、1,337シードを持つ500,000メッセージの3回の反復を使用しました。</font><font style="vertical-align: inherit;">結果は、各メソッドを1回だけ繰り返した後に現れました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時間の制約とウィンドウメッセージのみに集中したいという願望のため、ランダムなマウスとキーボードの入力を見逃しました。</font><font style="vertical-align: inherit;">また、テストを繰り返して結果を確認したい方にもお勧めします。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">水中の岩</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows 10のファザーについては、2つの小さな変更を加える必要がありました。まず、64ビットプラットフォームに適合させます。 2番目の変更により、fuzzerはコマンドライン引数を使用して特定のウィンドウハンドルを選択できました。特定の記述子のファジングは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユニバーサルWindowsプラットフォーム（UWP）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションのファジングに対する迅速な修正です</font><font style="vertical-align: inherit;">。元のプログラムは特定のプロセスに属するファジングウィンドウに焦点を当てていましたが、すべてのUWPアプリケーションは同じプロセスを通じてユーザーインターフェイスを表示します（図2）。つまり、ファザーをメインのUWPアプリケーションウィンドウに移動できません。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a4f/7e8/8fb/a4f7e88fbbd79bdb92b2de8f1c48697a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 2. UWPプラットフォームでは、すべてのアプリケーションが1つのプロセス（</font></font><code>ApplicationFrameHost.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">これらのアプリケーションのためにファジングすると、元のfazzer NTを変更して、特定のウィンドウハンドルにそれを指示していた</font></font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
値がランダム化された入力引数の二つの主要な発生源のために選ばれた：修正fazzeraは重大な欠点を明らかにすると</font></font><code>lParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><code>wParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のために</font></font><code>SendMessage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>PostMessage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、16ビット整数に制限されています。</font><font style="vertical-align: inherit;">どちらの引数も、32ビットWindowsでは32ビット、64ビットWindowsでは64ビットです。</font></font><code>Fuzz.cpp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値が設定さ</font><font style="vertical-align: inherit;">れている</font><font style="vertical-align: inherit;">場所で</font><font style="vertical-align: inherit;">問題が発生し</font></font><code>lParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>wParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cpp hljs">     wParam = (UINT) rand();<font></font>
     lParam = (LONG) rand();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rand（）関数は、[0、2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]の</font><font style="vertical-align: inherit;">範囲の数値を返し</font><font style="vertical-align: inherit;">ます。これにより、テストされた値のセットが大幅に制限されます。</font><font style="vertical-align: inherit;">結果を元の作業と正確に一致させるために、テスト中にこのエラーを意図的に保存しました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストされたアプリケーション</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のNTレポートでは、33のプログラムがテストされました。</font><font style="vertical-align: inherit;">テストに使用される各プログラムのバージョンは1つだけなので、28しかありません。</font><font style="vertical-align: inherit;">Windowsソフトウェアエコシステムは2000年以降大幅に変化しましたが、驚くほど多くは変わっていません。</font><font style="vertical-align: inherit;">Microsoft Officeスイートには、元のテストと同じプログラムが含まれています。</font><font style="vertical-align: inherit;">Netscape CommunicatorはFirefoxに進化しました。</font><font style="vertical-align: inherit;">Adobe AcrobatはAdobe Readerに名前が変更されましたが、まだ有効です。</font><font style="vertical-align: inherit;">Winampも2018年に新しいリリースをリリースしました。これにより、元のレポートとの公平な比較が可能になります。</font><font style="vertical-align: inherit;">ただし、一部の古いプログラムを置き換える必要がありました。</font><font style="vertical-align: inherit;">変更のリストとそれらの理由については、以下を参照してください。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDプレーヤー⇨Windows Media Player：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CDプレーヤーの機能が新しいプログラムに含まれています。</font></font><br>
</li>
<li><b>Eudora ⇨ Windows Mail:</b>  Qualcomm   ,    .  Eudora   ,      Windows  .<br>
</li>
<li><b>Command AntiVirus ⇨ Avast Free Edition:</b> Command AntiVirus   .    Avast     .<br>
</li>
<li><b>GSView ⇨ Photos:</b>  GSView   .       Windows  .<br>
</li>
<li><b>JavaWorkshop ⇨ IDE NetBeans:</b> IDE JavaWorkshop   . NetBeans    ,    ,   .<br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セキュアCRT⇨BitVise SSH：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セキュアCRTは引き続き存在しますが、試用版をダウンロードするには非常に長いWebフォームが必要です。</font><font style="vertical-align: inherit;">BitVise SSHはクイックブートを提供しました。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telnet⇨Putty：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TelnetアプリケーションはWindowsにも存在しますが、現在はコンソールアプリケーションです。</font><font style="vertical-align: inherit;">GUIをファジングするために、Windows用の人気のあるオープンソースターミナルエミュレータであるPuttyに置き換えました。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フリーセルとソリティア</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、Windows App Storeアプリケーションカタログ</font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoftソリティアコレクション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で見つかりました</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションの特定のバージョンが結果テーブルに表示されます。</font><font style="vertical-align: inherit;">すべてのファジングは64ビットシステムのWindows 10 Proバージョン1809（ビルド17763.253）で実行されました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のレポートで述べたように、結果はセキュリティの脆弱性としてではなく、ソフトウェアの信頼性と品質の指標として見なされるべきです。</font></font><br>
<br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「最後に、私たちの結果は、ソフトウェアの信頼性の相対的な改善を判断するための定量的な出発点を形成します。」</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Justin ForresterとBarton Millerによる「ランダムテストを使用したWindows NTアプリケーションの信頼性に関する実証的研究」から</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状況は改善しているものの、数値は特に有望ではありません。</font><font style="vertical-align: inherit;">最初のNTレポートでは、すべてのアプリケーションがクラッシュするか、ファジングでハングしました。</font><font style="vertical-align: inherit;">現在、2つのプログラム：電卓とアバストアンチウイルスは、ウィンドウメッセージの段階的変化に耐え、悪影響はありませんでした。</font><font style="vertical-align: inherit;">誤ったウィンドウメッセージへのアプローチについてアバストチームとWindows電卓チームを称賛します。</font><font style="vertical-align: inherit;">電卓チームは、ソースコードを開き、高品質のUWPアプリケーションを作成する方法を示すことで、さらなる尊敬を得ています。</font><font style="vertical-align: inherit;">ファジングの結果と使用されているソフトウェアの特定のバージョンについては、表1を参照してください。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody>
<tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バージョン</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージを送る</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポストメッセージ</font></font></b></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoftアクセス</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1901</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adobe Reader DC</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019.010.20098</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電卓</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1812.10048.0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウズメディアプレイヤー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.0.17763.292</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビジュアルスタジオコード</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.30.2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アバスト無料</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.2.2364</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windowsメール</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16005.11231.20182.0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エクセル</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1901</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></td>
</tr>
<tr>
<td>Adobe FrameMaker</td>
<td>15.0.2.503</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Freecell</td>
<td>4.3.2112.0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>GhostScript</td>
<td>9.26</td>
<td></td>
<td>ok</td>
</tr>
<tr>
<td>Photos</td>
<td>2019.18114.17710.0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>GNU Emacs</td>
<td>26.1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>IE Edge</td>
<td>44.17763.1.0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>NetBeans</td>
<td>10</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Firefox</td>
<td>64.0.2</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Notepad</td>
<td>1809</td>
<td></td>
<td>ok</td>
</tr>
<tr>
<td>Paint</td>
<td>1809</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Paint Shop Pro 2019</td>
<td>21.1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Powerpoint</td>
<td>1901</td>
<td></td>
<td>ok</td>
</tr>
<tr>
<td>Bitvise SSH</td>
<td>8.23</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Solitaire</td>
<td>4.3.2112.0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Putty</td>
<td>0.70</td>
<td></td>
<td></td>
</tr>
<tr>
<td>VS Community 2017</td>
<td>15.9.5</td>
<td></td>
<td></td>
</tr>
<tr>
<td>WinAmp 5.8</td>
<td>5.8 Build 3660</td>
<td></td>
<td>ok</td>
</tr>
<tr>
<td>Word</td>
<td>1901</td>
<td></td>
<td>ok</td>
</tr>
<tr>
<td>Wordpad</td>
<td>1809</td>
<td></td>
<td></td>
</tr>
<tr>
<td>WS_FTP</td>
<td>12.7.0.1903</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div><i><font color="gray"> 1.      Windows&nbsp;10.  19     -     </font></i> <br>
<br>
<h1>  Windows?</h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、好奇心が広まり、1つの例外を設けなければなりませんでした。いくつかの無関係なアプリケーションが1つの一般的な問題に見舞われたようです。デバッグにより、問題はメッセージにあることがわかりました</font></font><code>WM_DEVICECHANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ファザーがこのメッセージを送信したとき、最も単純なアプリケーションでさえクラッシュしまし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た-Windows APIの公式の例であるHelloWorld</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（図3）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/e6b/74b/cae/e6b74bcae36402b21b948256fe726315.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 3. fuzzerからウィンドウメッセージを受信すると、32ビットのHelloWorld.exeがクラッシュします。プログラムは完全に単純なので、これは起こらないはずです。問題はWindowsのどこかにあることがわかっていますが</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、HelloWorldの崩壊後、問題は32ビットアプリケーションのみに影響し、64ビットアプリケーションには影響しないことにすぐに気付きました。いくつかの簡単なデバッグでは、クラッシュが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wow64win.dll、64ビット用の32ビットアプリケーション互換性レイヤー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。問題の表面的な（そしておそらく正しくない）分析により、関数</font></font><code>wow64win.dll!whcbfnINDEVICECHANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はwParamを</font></font><code>DEV_BROADCAST_HANDLE64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲットプログラム内の</font><font style="vertical-align: inherit;">構造体へのポインターと見なすと</font><font style="vertical-align: inherit;">結論付けることができます</font><font style="vertical-align: inherit;">。関数は、この構造</font></font><code>DEV_BROADCAST_HANDLE32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を32ビットアプリケーションとの互換性のための</font><font style="vertical-align: inherit;">構造に変換し</font><font style="vertical-align: inherit;">ます。このエラーは</font></font><code>wParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ファザーによって生成され</font><font style="vertical-align: inherit;">た値</font><font style="vertical-align: inherit;">が無効なメモリを示している</font><font style="vertical-align: inherit;">ために</font><font style="vertical-align: inherit;">発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
処理</font></font><code>wParam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカルポインターであることは悪い考えですが、おそらく、リムーバブルデバイス通知がレガシー32ビットWindowsアプリケーションで機能するように意図的に設計したのです。</font><font style="vertical-align: inherit;">しかし、問題なく別のアプリケーションをクラッシュさせることができるのはまだ間違っています。</font><font style="vertical-align: inherit;">セキュリティの境界は越えていませんが、MSRCに問題を報告しました。</font><font style="vertical-align: inherit;">彼らはエラーがセキュリティ問題ではないことを確認しました。</font><font style="vertical-align: inherit;">Windowsの将来のバージョンでは、この一般的に受け入れられている奇妙な問題が修正されることを期待しています。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィンドウメッセージは過小評価され、Windowsプログラムへの信頼できない入力として無視されることがよくあります。</font><font style="vertical-align: inherit;">オープンソースウィンドウメッセージの最初のファザーが表示されてから19年経っても、同じプログラムを起動すると、テスト済みアプリケーションの93％がフリーズまたはクラッシュします。</font><font style="vertical-align: inherit;">しかし、一部のアプリケーションがこれらの歪んだ入力に適切に対処することは励みになります。つまり、一部の組織には、そのようなエラーを回避するためのフレームワークと制度的知識があることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ファザーはさまざまな方法で改善できますが、最も単純な方法でさえ、93％のアプリケーションがクラッシュしました。</font><font style="vertical-align: inherit;">おそらく、場合によっては、ウィンドウメッセージが実際のセキュリティの最前線を越えることもあります。</font><font style="vertical-align: inherit;">この領域を探索する場合は、調査結果を共有してください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja451800/index.html">簡単なソナーモデムを作る</a></li>
<li><a href="../ja451802/index.html">.Net Community RaiffeisenbankがUPD mitap Broadcastに招待</a></li>
<li><a href="../ja451806/index.html">iOSダイジェストNo. 5（4月27日-5月16日）</a></li>
<li><a href="../ja451812/index.html">現在、優れた開発者は、ビューとサブスクライバーによって評価されています-これは悪いことです</a></li>
<li><a href="../ja451814/index.html">内部でのRBKmoney支払い-支払いプラットフォームインフラストラクチャ</a></li>
<li><a href="../ja451818/index.html">ルークかそうでないか-それが問題だ</a></li>
<li><a href="../ja451820/index.html">テーマ別Habramitap＃1：バックエンド開発</a></li>
<li><a href="../ja451822/index.html">採用と関与：双方からの質問に答える</a></li>
<li><a href="../ja451826/index.html">マーケティングの不合理性を高める：実証済みの事例</a></li>
<li><a href="../ja451828/index.html">インターネット上で見つけることができないGoogle I / O 2019の主な秘密</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>