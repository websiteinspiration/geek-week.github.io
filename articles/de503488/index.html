<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘🏼 🌸 🤛🏽 Best Practices von Kubernetes. Richtig Beenden Deaktivieren 🧔🏿 👎🏻 🍢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Best Practices von Kubernetes. Erstellen kleiner Container 
 Best Practices für Kubernetes. Kubernetes-Organisation mit dem Kubernetes 
 Best Practice...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Best Practices von Kubernetes. Richtig Beenden Deaktivieren</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/503488/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices von Kubernetes. Erstellen kleiner Container </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices für Kubernetes. Kubernetes-Organisation mit dem Kubernetes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices-Namespace. Kubernetes-Lebensfähigkeitstest mit Bereitschafts- und Lebendigkeitstests Kubernetes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices. Konfigurieren von Anforderungen und Ressourcenlimits</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/tm/pw/un/tmpwunqsjdjy_abzbl8c0t-exzo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ein wichtiger Punkt beim Betrieb verteilter Systeme ist die Behandlung von Fehlern. Kubernetes hilft dabei, indem es Controller verwendet, die den Status Ihres Systems überwachen und Dienste neu starten, die nicht mehr funktionieren. Kubernetes kann Ihre Anwendungen jedoch zwangsweise herunterfahren, um die allgemeine Systemlebensfähigkeit sicherzustellen. In dieser Reihe werden wir untersuchen, wie Sie Kubernetes dabei unterstützen können, seine Arbeit effizienter zu erledigen und Ausfallzeiten von Anwendungen zu reduzieren.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor der Verwendung von Containern wurden die meisten Anwendungen auf virtuellen oder physischen Maschinen ausgeführt. Wenn die Anwendung abstürzte oder abstürzte, dauerte es lange, bis die laufende Aufgabe entfernt und das Programm erneut heruntergeladen wurde. Im schlimmsten Fall musste jemand dieses Problem nachts manuell lösen, zum ungünstigsten Zeitpunkt. Wenn nur 1-2 Arbeitsmaschinen eine wichtige Aufgabe ausführten, war eine solche Fehlfunktion völlig inakzeptabel. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstatt manuell neu zu starten, wurde daher die Überwachung auf Prozessebene verwendet, um die Anwendung im Falle einer abnormalen Beendigung automatisch neu zu starten. Wenn das Programm abstürzt, erfasst der Überwachungsprozess den Exit-Code und startet den Server neu. Mit dem Aufkommen von Systemen wie Kubernetes wurde diese Art der Systemfehlerreaktion einfach in die Infrastruktur integriert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes verwendet die Ereignisschleife "Beobachten - Unterschiede festschreiben - Aktionen festschreiben", um sicherzustellen, dass die Ressourcen auf dem Weg von den Containern zu den Knoten selbst betriebsbereit bleiben. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6n/rw/f9/6nrwf9r4k54zb99ghrykicqtc78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies bedeutet, dass Sie die Prozessüberwachung nicht mehr manuell starten müssen. Wenn eine Ressource den Health Check nicht besteht, stellt Kubernetes einfach automatisch einen Ersatz bereit. Kubernetes überwacht nicht nur Ihre Anwendungsabstürze. Es kann mehr Kopien der Anwendung erstellen, um auf mehreren Computern zu arbeiten, die Anwendung zu aktualisieren oder gleichzeitig mehrere Versionen Ihrer Anwendung auszuführen.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher gibt es viele Gründe, warum Kubernetes einen vollkommen gesunden Container unterbrechen kann. Wenn Sie beispielsweise Ihre Bereitstellung aktualisieren, stoppt Kubernetes langsam alte Pods, während neue gestartet werden. Wenn Sie einen Knoten trennen, beendet Kubernetes alle Herde in diesem Knoten. Wenn dem Knoten die Ressourcen ausgehen, deaktiviert Kubernetes alle Pods, um diese Ressourcen freizugeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher ist es sehr wichtig, dass Ihre Anwendung mit minimalen Auswirkungen auf den Endbenutzer und minimaler Wiederherstellungszeit nicht mehr funktioniert. Dies bedeutet, dass vor dem Trennen der Verbindung alle zu speichernden Daten gespeichert, alle Netzwerkverbindungen geschlossen, die verbleibenden Arbeiten abgeschlossen und Zeit für andere dringende Aufgaben bleibt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Praxis bedeutet dies, dass Ihre Anwendung in der Lage sein sollte, die SIGTERM-Nachricht zu verarbeiten - das Prozessbeendigungssignal, das das Standardsignal für das Kill-Dienstprogramm im Betriebssystem der Unix-Familie ist. Nach Erhalt dieser Nachricht sollte die Anwendung die Verbindung trennen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Kubernetes beschlossen hatte, den Pod fertigzustellen, fand eine ganze Reihe von Veranstaltungen statt. Schauen wir uns jeden Schritt an, den Kubernetes unternimmt, wenn ein Container oder eine Feuerstelle fertig ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir möchten einen der Herde fertigstellen. Zu diesem Zeitpunkt wird kein neuer Verkehr mehr empfangen - Container, die im Kamin arbeiten, sind nicht betroffen, aber der gesamte neue Verkehr wird blockiert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/go/iq/swgoiqnkzgrbf1g9ikbyc7kq6ym.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns den preStop-Hook an - dies ist ein spezieller Befehl oder eine HTTP-Anforderung, die an Container im Herd gesendet wird. Wenn sich Ihre Anwendung beim Empfang von SIGTERM nicht richtig ausschaltet, können Sie preStop verwenden, um das Programm korrekt zu beenden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rc/rk/a-/rcrka-cajxoq76gtcdaopdabeak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die meisten Programme, die ein SIGTERM-Signal empfangen, schließen ihre Arbeit korrekt ab. Wenn Sie jedoch Code von Drittanbietern oder ein System verwenden, das Sie nicht vollständig steuern können, ist der preStop-Hook eine hervorragende Möglichkeit, ein ordnungsgemäßes Herunterfahren zu bewirken, ohne die Anwendung zu ändern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Ausführen dieses Hooks sendet Kubernetes ein SIGTERM-Signal an die Container im Herd, das sie darüber informiert, dass sie bald getrennt werden. Nachdem Sie dieses Signal erhalten haben, fährt Ihr Code mit dem Herunterfahren fort. Dieser Prozess kann das Beenden langlebiger Verbindungen umfassen, z. B. das Herstellen einer Verbindung zu einer Datenbank oder einem WebSocket-Stream, das Speichern des aktuellen Status und dergleichen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selbst wenn Sie den preStop-Hook verwenden, ist es sehr wichtig zu überprüfen, was genau mit Ihrer Anwendung passiert, wenn Sie ihr ein SIGTERM-Signal senden, und wie es sich so verhält, dass Ereignisse oder Änderungen im Systembetrieb, die durch das Herunterfahren des Herdes verursacht werden, Sie nicht überraschen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt wartet Kubernetes, bevor weitere Maßnahmen ergriffen werden, auf eine bestimmte Zeit, die als terminierungGracePeriodSecond bezeichnet wird, oder auf die Zeitspanne, in der das Gerät ordnungsgemäß heruntergefahren wird, wenn es ein SIGTERM-Signal empfängt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_9/uq/gj/_9uqgjt61tblfxn6kgbrjnh3zs8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardmäßig beträgt dieser Zeitraum 30 Sekunden. Es ist wichtig zu beachten, dass es parallel zum PreStop-Hook und zum SIGTERM-Signal dauert. Kubernetes wartet nicht auf das Ende des PreStop-Hooks und von SIGTERM. Wenn Ihre Anwendung vor Ablauf der TerminationGracePeriod beendet wird, fährt Kubernetes sofort mit dem nächsten Schritt fort. Stellen Sie daher sicher, dass der Wert dieser Zeitspanne in Sekunden nicht kürzer ist als die Zeit, die der Herd benötigt, um ordnungsgemäß auszuschalten. Wenn er 30 Sekunden überschreitet, erhöhen Sie die Zeitspanne auf den gewünschten Wert in YAML. Im obigen Beispiel sind es 60er Jahre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und schließlich der letzte Schritt: Wenn die Container nach Ablauf der TerminationGracePeriod weiterhin funktionieren, senden sie ein SIGKILL-Signal und werden gewaltsam gelöscht. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt bereinigt Kubernetes auch alle anderen Pod-Objekte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/zp/t9/ptzpt92xzjuszc3tw0mwhgbp80m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetes schaltet Herde aus vielen Gründen aus. Stellen Sie daher sicher, dass Ihre Anwendung in jedem Fall korrekt ausgefüllt wird, um einen stabilen Betrieb des Dienstes zu gewährleisten. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices von Kubernetes. </font><font style="vertical-align: inherit;">Zuordnung externer Dienste</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z_l_kE1MDTc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen Werbung :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihren Aufenthalt bei uns. Gefällt dir unser Artikel? Möchten Sie weitere interessante Materialien sehen? Unterstützen Sie uns, indem Sie eine Bestellung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aufgeben</font></a><font style="vertical-align: inherit;"> oder Ihren Freunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud-basiertes VPS für Entwickler ab 4,99 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen </font><font style="vertical-align: inherit;">, ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzigartiges Analogon von Einstiegsservern, das von uns für Sie erfunden wurde: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ganze Wahrheit über VPS (KVM) E5-2697 v3 (6 Kerne) 10 GB DDR4 480 GB SSD 1 Gbit / s ab 19 $ oder wie teilt man den Server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2-mal günstiger im Equinix Tier IV-Rechenzentrum in Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nur wir haben </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV von 199 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Niederlanden!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lesen Sie mehr über</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Aufbau eines Infrastrukturgebäudes. </font><font style="vertical-align: inherit;">Klasse C mit Dell R730xd E5-2650 v4-Servern für 9.000 Euro für einen Cent?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503472/index.html">Bargeldloses Bezahlen, Podcasts und künstliches Fleisch: Was andere Unternehmen mit der Coronavirus-Krise gut bewältigen</a></li>
<li><a href="../de503474/index.html">Meine Anwendungsentwicklungserfahrung als PM</a></li>
<li><a href="../de503476/index.html">Nehmen Sie Video-UI-Autotests auf, die in kopflosem Chrome funktionieren</a></li>
<li><a href="../de503480/index.html">Bis zu 40 Tausend: Über 10 Vinyl Player-Bewertungen</a></li>
<li><a href="../de503486/index.html">Wie viele Anweisungen in x86?</a></li>
<li><a href="../de503490/index.html">Vergleich russischer Rap-Szenen mit R- und Text Mining-Techniken. Noize Mc, Oxxxymiron, Onkel Zhenya. Episode 2</a></li>
<li><a href="../de503494/index.html">Zusammenbau eines DIY-Gateways für ZigBee-Geräte</a></li>
<li><a href="../de503504/index.html">Das erfolgreichste und skandalöseste Data Science-Projekt: Cambridge Analytica</a></li>
<li><a href="../de503508/index.html">Schulen, Lehrer, Schüler, ihre Noten und Bewertungen</a></li>
<li><a href="../de503518/index.html">Neomorphismus mit SwiftUI. Teil 2: Was kann mit Barrierefreiheit gemacht werden?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>