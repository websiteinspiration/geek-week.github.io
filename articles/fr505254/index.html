<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤧 🌟 🍝 Sucre de serpent ou écrivez votre gamme en JavaScript 🎟️ 🔶 🤘🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beaucoup de gens aiment Python ... Les débutants sont admirés par l'absence de points-virgules, et les plus avancés bénéficient d'une réelle simplicit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sucre de serpent ou écrivez votre gamme en JavaScript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505254/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beaucoup de gens aiment Python ... Les débutants sont admirés par l'absence de points-virgules, et les plus avancés bénéficient d'une réelle simplicité. Aujourd'hui, nous allons parler de la façon d'implémenter en JavaScript un semblant de la simplicité même de Python, et en particulier de la fonction de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En Python, la fonction de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut être itérée ou, par exemple, convertie en une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tableaux </font><b><font style="vertical-align: inherit;">(plage (début, fin))</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais la question est, est-il possible pour JavaScript de créer quelque chose de similaire et en même temps de rendre la solution native et simple? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première chose qui me vient à l'esprit est d'écrire une classe similaire:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">range</span>(<span class="hljs-params">from, to, step = <span class="hljs-number">1</span></span>)</span>{
    <span class="hljs-keyword">this</span>.current = <span class="hljs-keyword">from</span>
    <span class="hljs-keyword">this</span>.to = to
    <span class="hljs-keyword">this</span>.step = step<font></font>
<font></font>
    <span class="hljs-keyword">this</span>.next = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">this</span>.current++ % to<font></font>
}<font></font>
</code></pre><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, j'ai écrit que la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prochaine</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valeur renvoyée est coupée, mais c'est aussi un problème qui doit être résolu - résoudre une erreur lors du passage au maximum ou faire autre chose? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, une telle solution n'ajoutera pas du tout de commodité et il sera plus facile d'écrire une norme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">car</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , par exemple, vous pouvez ajouter la fonction de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et après chaque itération vérifier si nous sommes partis à l'étranger, mais cette solution n'a pas de sens à développer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ES6 introduit un nouveau type de données primitif, Symbol. Il nous ouvre les portes de la métaprogrammation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour résoudre notre problème avec la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plage,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous utiliserons </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symbol.iterator</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il permet de créer un objet itérateur à l'aide d'un protocole spécifique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour qu'un objet devienne un itérateur, vous devez y définir la fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Symbol.iterator] ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais comme nous voulons créer une fonction commune, pas une classe, nous aurons une fonction qui retourne un objet itérateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici à quoi ça ressemble:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">range</span>(<span class="hljs-params">from, to, step = <span class="hljs-number">1</span></span>)</span>{
    <span class="hljs-keyword">return</span> {<font></font>
        [<span class="hljs-built_in">Symbol</span>.iterator](){
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">current</span>: <span class="hljs-keyword">from</span>,
                <span class="hljs-attr">to</span>: to,
                <span class="hljs-attr">from</span>: <span class="hljs-keyword">from</span>,<font></font>
                step,<font></font>
                next(){<font></font>
                    <span class="hljs-keyword">const</span> it = { <span class="hljs-attr">done</span>: <span class="hljs-keyword">this</span>.current &gt;= <span class="hljs-keyword">this</span>.to, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.current }
                    <span class="hljs-keyword">this</span>.current += <span class="hljs-keyword">this</span>.step
                    <span class="hljs-keyword">return</span> it<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que ce passe-t-il? </font><font style="vertical-align: inherit;">Nous avons une fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">range</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , elle retourne tout de même notre objet itérateur, dans lequel la fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Symbol.iterator] ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retourne un objet. </font><font style="vertical-align: inherit;">La chose la plus importante est que cet objet contient la fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivante</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">sinon l'objet ne sera pas itérable et une erreur apparaîtra lors de la tentative d'utilisation. </font><font style="vertical-align: inherit;">La fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivante</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devrait (!) Renvoyer un objet avec les propriétés </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">done</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , où </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">done</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (bool) signale la fin de l'itération, et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient la valeur actuelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, tout fonctionne, et vous pouvez déjà écrire quelque chose de type python:</font></font><br>
<br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>))
        <span class="hljs-built_in">console</span>.log(i)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conclusion:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0</span>
<span class="hljs-number">2</span>
<span class="hljs-number">4</span>
<span class="hljs-number">6</span>
<span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pourrions nous arrêter ici ... Mais vous pouvez écrire une solution plus élégante en utilisant les fonctions du générateur:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">range</span>(<span class="hljs-params">from, to, step = <span class="hljs-number">1</span></span>)</span>{
    <span class="hljs-keyword">return</span> {<font></font>
        *[<span class="hljs-built_in">Symbol</span>.iterator](){
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> val = <span class="hljs-keyword">from</span>; val &lt; to; val += step){
                <span class="hljs-keyword">yield</span> val;<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un avantage supplémentaire sera le fait que nous avons d'autres opportunités pour les itérateurs. </font><font style="vertical-align: inherit;">Par exemple, vous pouvez très facilement convertir notre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gamme</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en tableau:</font></font><br>
<br>
<pre><code class="javascript hljs">[...range(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>)]
<span class="hljs-comment">// [ 0, 2, 4, 6, 8 ]</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conclusion, je tiens à dire que j'avais initialement prévu d'écrire un article avec une liste d'implémentations similaires d'analogies, mais rien d'autre ne m'est venu à l'esprit. </font><font style="vertical-align: inherit;">Et, si tout à coup, des idées surgissent, alors je continuerai comme un cycle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne chance</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr505218/index.html">Réunion de sécurité en ligne</a></li>
<li><a href="../fr505220/index.html">Conseils pour choisir un amplificateur de signal cellulaire 2G / 3G / 4G / 5G</a></li>
<li><a href="../fr505226/index.html">Superposez une texture 2D sur un objet 3D à l'aide de p5.js (partie 1 - création d'un motif)</a></li>
<li><a href="../fr505246/index.html">Imprimer la première tranche avec Upwork</a></li>
<li><a href="../fr505252/index.html">Projet Avokado</a></li>
<li><a href="../fr505256/index.html">Lancement réussi. 39e depuis le début de l'année. 14e des États-Unis. Satellites Starlink SpaceX</a></li>
<li><a href="../fr505258/index.html">Dentisterie: attente et réalité</a></li>
<li><a href="../fr505260/index.html">Mesurer le retard du clavier au photon à l'aide d'un capteur optique</a></li>
<li><a href="../fr505264/index.html">Comme j'ai écrit l'analyseur html en php, et ce qui en est sorti. Partie un</a></li>
<li><a href="../fr505268/index.html">Expérience personnelle: du développeur frontend au leader</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>