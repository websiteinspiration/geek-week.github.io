<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóùÔ∏è ü§ûüèª üé¶ Everything you need to know about caching ‚õÖÔ∏è ‚úçüèæ üéæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 
 
 I present to you the translation of the article "Everything you need to know about Caching - System Design" by Animesh Gaitonde.
 
 Intr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Everything you need to know about caching</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504786/"><img src="https://habrastorage.org/webt/yb/dy/sz/ybdyszmr39n1ymqep4omiofuhfy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Good day. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I present to you the translation of the article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Everything you need to know about Caching - System Design"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by Animesh Gaitonde.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Have you noticed that when browsing a webpage with a poor Internet connection, text is loaded before high-quality images? However, when you visit the same page again, it loads much faster. When you visit a new site, it takes much longer to download it than to download frequently visited sites such as Facebook or Amazon. Do you know why this is happening? It's all about caching.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bc/uo/xx/bcuoxxd5lqtpswaic_oncu82tlc.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is what my Instagram page looks like when connected slowly. As you can see, the text is displayed while the images have not yet loaded. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is very important to provide the best experience using the application to retain and engage users. In a modern world where the spirit of competition reigns, business suffers greatly due to poor user experience. Imagine that you are watching your favorite series or streaming video on a website, but the video is constantly stopped for additional loading (buffering). How long will you endure such an ‚Äúattitude‚Äù and will you return to such a site?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Caching works on the principle of "localization of links." </font><font style="vertical-align: inherit;">The cache is a local data warehouse to speed up information retrieval and data recovery. </font><font style="vertical-align: inherit;">The main purpose of the cache is to reduce the delay in reading data and increase the throughput of the application. </font><font style="vertical-align: inherit;">Let's look at some real life examples.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache usage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose you cook dinner every day. </font><font style="vertical-align: inherit;">For cooking, you need various ingredients, vegetables, spices, etc. </font><font style="vertical-align: inherit;">However, do you go to the store every day for this? </font><font style="vertical-align: inherit;">This can be quite burdensome and time consuming. </font><font style="vertical-align: inherit;">Of course, the first thing you look into the closet in the kitchen or refrigerator. </font><font style="vertical-align: inherit;">This helps to avoid an unnecessary trip to the supermarket. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mg/y6/i6/mgy6i6dasy2xuqop18mtldzoqpq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Your refrigerator is a kind of cache for vegetables. </font><font style="vertical-align: inherit;">The obvious advantage of this cache is a significant saving in dinner preparation time.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How does the cache work?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Server applications typically store data in a database. When a client requests data, the application sends a request to the database, receives data from there and sends it to the client. The database server is offline and can be located on a different computer than the computer on which the application server is located. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5f/qg/e4/5fqge4lmt8q5yigsx4kj5gmqksw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reading data from the database is a very slow process, because you need to send a request and perform I / O to get data from the file system. If the data is stored in the cache, the read operation will be very fast. When a client repeatedly requests the same data, it makes sense to return data from the cache instead of the database.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example: if a tweet is viral, all clients will request data for the same tweet. </font><font style="vertical-align: inherit;">Because Twitter has millions of users, using a cache avoids millions of database queries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the cache reduces the load on the database. </font><font style="vertical-align: inherit;">If the requested data is in the cache, the database request will be redirected (intercepted). </font><font style="vertical-align: inherit;">You can draw some analogy with a hash table that stores key-value pairs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following diagram shows the process of reading data from the cache:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u4/4x/6a/u44x6annynx7u794dgoq-0a6s-g.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Key cache concepts</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time to Live (TTL)</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These are limits on the amount of data that can be stored in the cache. </font><font style="vertical-align: inherit;">You must delete entries in the cache that the application server no longer needs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the case of Netflix, the server will cache the most viewed or popular shows. </font><font style="vertical-align: inherit;">There is no need to cache shows that no one is watching. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example: caching the Paper House series is more rational than the Indiana Jones movie.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delete policy</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At some point, the cache is full. </font><font style="vertical-align: inherit;">Hence the need arises to delete old (irrelevant) data and replace it with new (relevant) information. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several policies for clearing the cache, such as "old (least recently used)" (Least Recently Used, LRU), "rarely requested (least used)" (Least Frequently Used, LFU), "last (most recently used)" ( Most Recently Used, MRU). </font><font style="vertical-align: inherit;">These policies delete data from the cache according to a specific principle.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Old</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data that has not been requested for a long time is deleted from the cache. </font><font style="vertical-align: inherit;">As soon as the cache is full, old data is deleted, new data is added. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose Facebook caches celebrity photos. </font><font style="vertical-align: inherit;">Analysis of subscriber requests indicates the relevance of new photos. </font><font style="vertical-align: inherit;">When the cache is full, the oldest photo will be deleted from it.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rarely requested</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The LFU tracks the frequency or number of data requests. </font><font style="vertical-align: inherit;">When the cache size approaches the threshold value, the most rarely requested data will be deleted. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When we enter the text, the phone begins to offer various options for ending the word, one of which can be selected instead of the full set (completion). </font><font style="vertical-align: inherit;">Smartphone software caches the most frequently typed words. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rl/vi/r8/rlvir8pfmzflt3mri6oauh81nmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rarely typed words are subsequently deleted from this cache. </font><font style="vertical-align: inherit;">In the above example, if you use the words ‚Äúfeature‚Äù, ‚Äúfeatures‚Äù, ‚Äúfeather‚Äù, etc., after some time the phone will stop offering you ‚Äúfeat‚Äù, since it will be removed from the cache.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Last</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this policy, the latest data is subject to deletion, preference is given to older data stored in the cache. </font><font style="vertical-align: inherit;">This strategy is used if the data acquisition template is such that the user is least interested in retrieving the latest data. </font><font style="vertical-align: inherit;">Consider an example. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_y/r7/dw/_yr7dwecmhrodbvoellhw14qvau.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dating applications such as Tinder usually cache all potential partners (potential matches or preferences) of the user. </font><font style="vertical-align: inherit;">When a user flips through a feed by moving a specific profile of a potential partner left or right, the application should no longer recommend this profile to him. </font><font style="vertical-align: inherit;">If this happens, it will lead to a bad user experience. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, there is a need to delete the latest data. </font><font style="vertical-align: inherit;">The application should delete the profiles viewed from the cache.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache types</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache Recording</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the name implies, the data is written first to the cache, then to the database. </font><font style="vertical-align: inherit;">This ensures data consistency in the cache and database. </font><font style="vertical-align: inherit;">Each read of data from the cache corresponds to the most recent record. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ji/ih/ix/jiihixkutm0lpxxdrff0l3q4tby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The disadvantage of this approach is the increase in recording time. </font><font style="vertical-align: inherit;">It is not suitable for heavily loaded systems with frequent data write operations. </font><font style="vertical-align: inherit;">However, it is great for applications that often re-read data stored in the database. </font><font style="vertical-align: inherit;">Slow writing is offset by fast reading and consistency.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache entry</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An alternative to the first approach is to write data to the cache and add a note about data changes for their subsequent update to the database. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/co/td/_l/cotd_ldfasg4f4xhgyzl4of1ncw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using periodic asynchronous operations, you can read updated data in the cache and make changes to the corresponding data in the database. This approach does not increase the read / write operations. The only drawback here is the delay in synchronization between the cache and the database. This can lead to the fact that applications that rely on the database as a source of truth will read outdated data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Youtube, for example, uses this approach to store information about the number of views of a particular video. Updating the database for each view of the viral video will be very expensive. The best solution is to write data to the cache and then synchronize with the database.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cache Bypass Record</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Several server applications do not often reread the latest data. </font><font style="vertical-align: inherit;">In this case, a cache bypass entry is used. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/d0/6p/7wd06ph2okntw0mjrqpwyet_ptw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this approach, the database is updated without a cache. </font><font style="vertical-align: inherit;">This avoids loading unclaimed data into the cache. </font><font style="vertical-align: inherit;">However, if the application still requests the latest data that is not in the cache, this will lead to the loading of such data from the database with all the ensuing consequences.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Distributed Cache Usage Examples</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
List of open cache projects:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redis</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memcached</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voltdb</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aerospike dbs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache ignite</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504772/index.html">Digital events in Moscow from June 1 to 7</a></li>
<li><a href="../en504774/index.html">Survey of IT executives about changing needs for IT services</a></li>
<li><a href="../en504776/index.html">Writing a game engine in your first year: easy! (Almost)</a></li>
<li><a href="../en504780/index.html">NSA, Ghidra and Unicorns</a></li>
<li><a href="../en504784/index.html">Sectigo's AddTrust root certificate expired on May 30, 2020, which caused problems in OpenSSL 1.0.x and GnuTLS clients</a></li>
<li><a href="../en504790/index.html">A selection of articles on machine learning: cases, guides and studies for May 2020</a></li>
<li><a href="../en504792/index.html">Duty boarding house. How NSPK saved its duty room from a coronavirus</a></li>
<li><a href="../en504796/index.html">Udalenka is cool. Maybe stay forever?</a></li>
<li><a href="../en504798/index.html">Artificial Intelligence Watch Complaints</a></li>
<li><a href="../en504800/index.html">dracut + systemd + LUKS + usbflash = auto unlock</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>