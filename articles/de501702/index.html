<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♾ 👩🏿 🕓 Visualisierung von Versprechen und Async / Await ✌🏼 🧕🏿 🖐🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, Freunde! 
 
 Ich präsentiere Ihnen die Übersetzung des Artikels "JavaScript Visualized: Promises & Async / Await" von Lydia Hallie. 
 
 Sin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Visualisierung von Versprechen und Async / Await</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501702/"><img src="https://habrastorage.org/webt/bu/rt/-e/burt-epjeqoebt-fjzxyhekod2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Guten Tag, Freunde! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich präsentiere Ihnen die Übersetzung des Artikels </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"JavaScript Visualized: Promises &amp; Async / Await"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von Lydia Hallie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sind Sie auf JavaScript-Code gestoßen, der ... nicht wie erwartet funktioniert? </font><font style="vertical-align: inherit;">Wenn Funktionen in einer beliebigen, unvorhersehbaren Reihenfolge oder mit Verzögerung ausgeführt werden. </font><font style="vertical-align: inherit;">Eine der Hauptaufgaben von Versprechungen ist die Rationalisierung der Ausführung von Funktionen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meine unersättliche Neugier und schlaflosen Nächte haben sich voll ausgezahlt - dank ihnen habe ich mehrere Animationen erstellt. </font><font style="vertical-align: inherit;">Es ist Zeit, über Versprechen zu sprechen: wie sie funktionieren, warum sie verwendet werden sollten und wie es gemacht wird.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einführung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Schreiben von JS-Code müssen wir uns häufig mit Aufgaben befassen, die von anderen Aufgaben abhängen. Angenommen, wir möchten ein Bild abrufen, komprimieren, einen Filter darauf anwenden und es speichern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst müssen wir uns ein Bild machen. Verwenden Sie dazu die Funktion </font></font><code>getImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nach dem Laden des Bildes übergeben wir es an die Funktion </font></font><code>resizeImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nach dem Komprimieren des Bildes wenden wir mithilfe der Funktion einen Filter darauf an </font></font><code>applyFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nach der Komprimierung und Anwendung des Filters speichern wir das Bild und informieren den Benutzer über den Erfolg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten wir Folgendes:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/sf/kq/vysfkqrpan_45kt7zkasehy14m4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hmm ... Hast du etwas bemerkt? </font><font style="vertical-align: inherit;">Trotz der Tatsache, dass alles funktioniert, sieht es nicht gut aus. </font><font style="vertical-align: inherit;">Wir erhalten viele verschachtelte Rückruffunktionen, die von früheren Rückrufen abhängen. </font><font style="vertical-align: inherit;">Dies wird als Callback-Hölle bezeichnet und macht es sehr schwierig, Code zu lesen und zu warten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Glück haben wir heute Versprechen.</font></font><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versprechenssyntax</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versprechen wurden in ES6 eingeführt. </font><font style="vertical-align: inherit;">In vielen Handbüchern können Sie Folgendes lesen:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Versprechen (Versprechen) ist ein Wert, der in Zukunft erfüllt oder abgelehnt wird.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja ... so lala Erklärung. </font><font style="vertical-align: inherit;">Zu einer Zeit hielt ich Versprechen für etwas Seltsames, Unbestimmtes, eine Art Magie. </font><font style="vertical-align: inherit;">Was sind sie wirklich? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir können ein Versprechen mit einem Konstruktor erstellen </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der eine Rückruffunktion als Argument verwendet. </font><font style="vertical-align: inherit;">Cool, lass uns versuchen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yx/or/hu/yxorhuwt-ogj2_grnqpexlducek.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warte, was kommt hier zurück? </font></font><br>
<br>
<code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist ein Objekt, das status ( </font></font><code>[[PromiseStatus]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) und value ( </font></font><code>[[PromiseValue]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) enthält. </font><font style="vertical-align: inherit;">In dem obigen Beispiel wird der Wert </font></font><code>[[PromiseStatus]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist </font></font><code>pending</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und der Wert der Verheißung ist </font></font><code>undefined</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keine Sorge, Sie müssen nicht mit diesem Objekt interagieren, Sie können nicht einmal auf die Eigenschaften </font></font><code>[[PromiseStatus]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">zugreifen </font></font><code>[[PromiseValue]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Diese Eigenschaften sind jedoch sehr wichtig, wenn Sie mit Versprechungen arbeiten.</font></font><br>
<br>
<code>PromiseStatus</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder der Status eines Versprechens kann einen von drei Werten annehmen:</font></font><br>
<br>
<ul>
<li><code>fulfilled</code>:   <code>resolved</code> ().   ,  </li>
<li><code>rejected</code>:   <code>rejected</code> ().  - </li>
<li><code>pending</code>:       ,  <code>pending</code> (,    )</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klingt gut, aber wann erhält ein Versprechen den angegebenen Status? Und warum ist Status wichtig? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im obigen Beispiel übergeben wir eine </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einfache Rückruffunktion an den </font><font style="vertical-align: inherit;">Konstruktor </font></font><code>() =&gt; {}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Funktion akzeptiert tatsächlich zwei Argumente. Der Wert des ersten Arguments, normalerweise aufgerufen </font></font><code>resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>res</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ist die Methode, die aufgerufen wird, wenn das Versprechen ausgeführt wird. Der Wert des zweiten Arguments, normalerweise aufgerufen </font></font><code>reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>rej</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ist die Methode, die aufgerufen wird, wenn das Versprechen abgelehnt wird, wenn etwas schief gelaufen ist. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ph/ev/5o/phev5oy-unumotchrvnwquasnas.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was beim Aufrufen der Methoden an die Konsole ausgegeben wird </font></font><code>resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0o/oc/jr/0oocjrmqi757q-x4decxez9rana.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cool! Jetzt wissen wir, wie wir Status </font></font><code>pending</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Bedeutung </font><font style="vertical-align: inherit;">loswerden können </font></font><code>undefined</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Der Status der Versprechen beim Aufruf der Methode </font></font><code>resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist </font></font><code>fulfilled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, wenn </font></font><code>reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font><code>rejected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>[[PromiseValue]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder der Wert des Versprechens ist der Wert, den wir an die Methoden </font></font><code>resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als Argument übergeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unterhaltsame Tatsache: Jake Archibald wies nach dem Lesen dieses Artikels auf einen Fehler in Chrome hin, der stattdessen </font></font><code>fulfilled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zurückkehrte </font></font><code>resolved</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wv/zd/6y/wvzd6y2g_mz5act3lvnpjkacebm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, jetzt wissen wir, wie man mit dem Objekt arbeitet </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aber wofür wird es verwendet? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Einleitung habe ich ein Beispiel gegeben, in dem wir ein Bild erhalten, es komprimieren, einen Filter darauf anwenden und es speichern. Dann endete alles mit der Hölle des Rückrufs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Glücklicherweise helfen Versprechen, damit umzugehen. Wir schreiben den Code so um, dass jede Funktion ein Versprechen zurückgibt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Bild geladen wurde, halten wir ein Versprechen. Andernfalls lehnen Sie das Versprechen ab, wenn ein Fehler auftritt:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/7w/s3/ci7ws3oh1myicklbwzotn0ge1ge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was passiert, wenn dieser Code im Terminal ausgeführt wird: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/vx/01/kfvx01bguyyok5fdwcgnsr2qzfk.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cool! </font><font style="vertical-align: inherit;">Promis kehrt erwartungsgemäß mit analysierten ("analysierten") Daten zurück. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber ... was kommt als nächstes? </font><font style="vertical-align: inherit;">Wir interessieren uns nicht für das Thema Promis, wir interessieren uns für dessen Daten. </font><font style="vertical-align: inherit;">Es gibt 3 integrierte Methoden, um einen Promise-Wert zu erhalten:</font></font><br>
<br>
<ul>
<li><code>.then()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: nach Erfüllung eines Versprechens angerufen</font></font></li>
<li><code>.catch()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: nach der Ablehnung des Versprechens angerufen</font></font></li>
<li><code>.finally()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: immer aufgerufen, sowohl nach Ausführung als auch nach Ablehnung eines Versprechens</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/jm/kx/bl/jmkxblijk89jgqpte14xgimhp4q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Methode </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">übernimmt den an die Methode übergebenen Wert </font></font><code>resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o5/tb/xo/o5tbxoro5xa0cfx80ijumefdg_e.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Methode </font></font><code>.catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">übernimmt den an die Methode übergebenen Wert </font></font><code>reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8i/6p/vm/8i6pvmsr8uyhrmrlqlfry3o2fzo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich haben wir den gewünschten Wert erhalten. Mit diesem Wert können wir alles machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir von der Erfüllung oder Ablehnung eines Versprechens überzeugt sind, können Sie </font></font><code>Promise.resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entweder </font></font><code>Promise.reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem entsprechenden Wert </font><font style="vertical-align: inherit;">schreiben </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/oz/3h/nioz3hmwq-ercnvsi8xc4isphtk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist die Syntax, die in den folgenden Beispielen verwendet wird.</font></font><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Ergebnis </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist der Wert des Versprechens (d. H. Diese Methode gibt auch das Versprechen zurück). </font><font style="vertical-align: inherit;">Dies bedeutet, dass wir so viel </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie nötig verwenden können: Das Ergebnis des vorherigen </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird als Argument an das nächste übergeben </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/6_/z_/ga6_z_34tprviih5r2yf1afyaoe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In können </font></font><code>getImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir mehrere verwenden </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um das verarbeitete Bild zur nächsten Funktion zu übertragen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6t/va/8w/6tva8wgrrpmr3yk1h131dhaxcmq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Syntax sieht viel besser aus als die Leiter der verschachtelten Rückruffunktionen.</font></font><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrotasks und (Makro-) Tasks</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun wissen wir, wie man Versprechen schafft und Werte daraus extrahiert. Fügen Sie unserem Skript Code hinzu und führen Sie ihn erneut aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/47/pd/id/47pdidukvud0u2p8eibdk3ytmiu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst wird er in der Konsole angezeigt </font></font><code>Start!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dies ist normal, da wir die erste Codezeile haben </font></font><code>console.log('Start!')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Der zweite Wert, der auf der Konsole angezeigt wird </font></font><code>End!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ist nicht der Wert des abgeschlossenen Versprechens. Der Wert des Versprechens wird zuletzt angezeigt. Warum ist das geschehen? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen wir die Kraft der Versprechen. Obwohl JS Single-Threaded ist, können wir den Code asynchron machen mit </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wo sonst könnten wir asynchrones Verhalten beobachten? Einige im Browser integrierte Methoden, z. B. </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, können Asynchronität simulieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recht </font><font style="vertical-align: inherit;">In der Ereignisschleife (Ereignisschleife) gibt es zwei Arten von Warteschlangen: die Warteschlange von (Makro-) Aufgaben oder nur Aufgaben ((Makro-) Aufgabenwarteschlange, Aufgabenwarteschlange) und die Warteschlange von Mikrotasks oder nur Mikrotasks (Mikrotask-Warteschlange, Mikrotasks). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was gilt für jeden von ihnen? </font><font style="vertical-align: inherit;">Kurz gesagt:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Makroaufgaben: setTimeout, setInterval, setImmediate</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrotasks: process.nextTick, Promise callback, queueMicrotask</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der Liste der Mikrotasks. </font><font style="vertical-align: inherit;">Wenn die </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methode ausgeführt und aufgerufen wird </font></font><code>then()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>catch()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>finally()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird die Rückruffunktion mit der Methode zur Mikrotask-Warteschlange hinzugefügt. </font><font style="vertical-align: inherit;">Dies bedeutet, dass der Rückruf mit der Methode nicht sofort ausgeführt wird, wodurch JS-Code asynchron wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wann ist die Methode </font></font><code>then()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>catch()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>finally()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird sie durchgeführt? </font><font style="vertical-align: inherit;">Aufgaben in der Ereignisschleife haben folgende Priorität:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zunächst werden die Funktionen im Aufrufstapel ausgeführt. </font><font style="vertical-align: inherit;">Die von diesen Funktionen zurückgegebenen Werte werden vom Stapel entfernt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem der Stapel freigegeben wurde, werden Mikrotasks nacheinander platziert und ausgeführt (Mikrotasks können andere Mikrotasks zurückgeben, wodurch ein endloser Zyklus von Mikrotasks entsteht).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem der Stapel und die Mikrotask-Warteschlange freigegeben wurden, sucht die Ereignisschleife nach Makros. </font><font style="vertical-align: inherit;">Makroaufgaben werden auf den Stapel verschoben, ausgeführt und gelöscht.</font></font></li>
</ol><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie ein Beispiel:</font></font><br>
<br>
<ul>
<li><code>Task1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Eine Funktion, die dem Stapel sofort hinzugefügt wird, z. B. durch einen Aufruf von Code.</font></font></li>
<li><code>Task2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Mikrozadachi Beispiel </font></font><code>then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promi oder Aufgabe hinzugefügt über </font></font><code>queueMicrotask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><code>Task5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Task6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Makroaufgaben zum Beispiel </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder</font></font><code>setImmediate</code></li>
</ul><br>
<img src="https://habrastorage.org/webt/xl/hp/gl/xlhpgltjfi-dxo70zyuqjimbzzu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst </font></font><code>Task1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt einen Wert und wird aus dem Stapel entfernt. Dann sucht die Engine in der entsprechenden Warteschlange nach Mikrotasks. Nach dem Hinzufügen und anschließenden Entfernen von Mikrotasks zum Stapel sucht die Engine nach Makro-Tasks, die ebenfalls zum Stack hinzugefügt und nach Rückgabe der Werte von diesem entfernt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Genug Worte. Schreiben wir den Code. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_h/oj/ee/_hojeek-qp4i0v1fatji5qxyd4m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Code haben wir eine Makroaufgabe </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und eine Mikroaufgabe </font></font><code>.then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Führen Sie den Code aus und sehen Sie, was in der Konsole angezeigt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hinweis: in dem obigen Beispiel verwende ich Methoden wie </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>Promise.resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Alle diese Methoden sind intern, sodass sie nicht im Stack-Trace angezeigt werden. Seien Sie nicht überrascht, wenn Sie sie nicht in den Tools zur Fehlerbehebung des Browsers finden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der ersten Zeile haben wir</font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Es wird dem Stapel hinzugefügt und in der Konsole angezeigt </font></font><code>Start!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Danach wird diese Methode vom Stapel entfernt und die Engine analysiert den Code weiter. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/ss/nu/pcssnuqx9bbmlywvd6zearuoaqu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Motor erreicht </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, was dem Stapel hinzugefügt wird. Diese Methode ist eine integrierte Browsermethode: Ihre Rückruffunktion ( </font></font><code>() =&gt; console.log('In timeout')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) wird der Web-API hinzugefügt und ist vorhanden, bevor der Timer ausgelöst wird. Trotz der Tatsache, dass der Timer-Zähler 0 ist, wird der Rückruf immer noch zuerst in der WebAPI und dann in der Warteschlange für Makroaufgaben platziert: </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Dies ist eine Makroaufgabe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/yq/yw/9tyqywfouzwyjiks-b41l5vtxq4.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes erreicht der Motor die Methode </font></font><code>Promise.resolve()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Methode wird dem Stapel hinzugefügt und dann mit einem Wert ausgeführt </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sein Rückruf </font></font><code>then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird in die Mikrotask-Warteschlange gestellt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/mi/np/acminp3ylrdseonspqvm_m_nq44.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich erreicht der Motor die zweite Methode </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Es wird sofort auf den Stapel geschoben und an die Konsole ausgegeben</font></font><code>End!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird die Methode vom Stapel entfernt und die Engine fährt fort. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/76/wt/z0/76wtz0lpgee1nuob0vz2coji-fw.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Engine "sieht", dass der Stapel leer ist. </font><font style="vertical-align: inherit;">Überprüfen der Aufgabenwarteschlange. </font><font style="vertical-align: inherit;">Es befindet sich dort </font></font><code>then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wird es auf den Stapel geschoben, wird der Wert des Versprechens auf der Konsole angezeigt: in diesem Fall eine Zeichenfolge </font></font><code>Promise!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1n/5u/05/1n5u05wug2yzg2hqfftf2lilaci.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Engine sieht, dass der Stapel leer ist. </font><font style="vertical-align: inherit;">Er "schaut" in die Warteschlange der Mikrotasks. </font><font style="vertical-align: inherit;">Sie ist auch leer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist Zeit, die Makro-Task-Warteschlange zu überprüfen: Sie ist da </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es wird auf den Stapel geschoben und gibt eine Methode zurück </font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Eine Zeichenfolge wird an die Konsole ausgegeben </font></font><code>'In timeout!'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird vom Stapel entfernt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6v/42/lo/6v42lobbr5hkg5y4tvrt5rapwio.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erledigt. </font><font style="vertical-align: inherit;">Jetzt passte alles zusammen, oder?</font></font><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Async / warten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ES7 führte eine neue Methode zum Arbeiten mit asynchronem Code in JS ein. Mit Hilfe der Schlüsselwörter </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir können eine asynchrone Funktion erstellen , </font><font style="vertical-align: inherit;">die implizit ein Versprechen zurückgibt. Aber ... wie machen wir das? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuvor haben wir erläutert, wie ein Objekt explizit erstellt wird </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: using </font></font><code>new Promise(() =&gt; {})</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Promise.resolve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>Promise.reject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stattdessen können wir eine asynchrone Funktion erstellen, die implizit das angegebene Objekt zurückgibt. Dies bedeutet, dass wir nicht mehr manuell erstellen müssen </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/me/py/py/mepypyet9xa6eky4slldnhflprs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Tatsache, dass eine asynchrone Funktion implizit ein Versprechen zurückgibt, ist natürlich großartig, aber die Leistungsfähigkeit dieser Funktion wird bei Verwendung eines Schlüsselworts voll zum Ausdruck gebracht </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lässt die asynchrone Funktion warten, bis das Versprechen (sein Wert) abgeschlossen ist. Um den Wert des durchgeführten Versprechens zu erhalten, müssen wir der Variablen den erwarteten (erwarteten) Wert des Versprechens zuweisen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass wir die Ausführung einer asynchronen Funktion verzögern können? Großartig, aber ... was bedeutet das? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was passiert, wenn Sie den folgenden Code ausführen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vh/wt/o0/vhwto0gbbpku7nehrlg5fe1nsni.gif"><br>
<br>
<hr><br>
<img src="https://habrastorage.org/webt/tk/zo/nx/tkzonxqy0rpal2gsghjjok33elg.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst sieht der Motor </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Methode wird auf den Stapel geschoben und auf der Konsole angezeigt </font></font><code>Before function!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/7u/k4/hr7uk471lkclnrkq6j4reflsaem.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann wird die asynchrone Funktion aufgerufen </font></font><code>myFunc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ihr Code wird ausgeführt. In der ersten Zeile dieses Codes rufen wir die zweite </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einer Zeile auf </font></font><code>'In function!'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Methode wird dem Stapel hinzugefügt, ihr Wert wird auf der Konsole angezeigt und vom Stapel entfernt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x8/0k/bq/x80kbq_ivdjxkn5otwj7iraowiu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Funktionscode wird als nächstes ausgeführt. In der zweiten Zeile haben wir ein Schlüsselwort </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste, was hier passiert, ist die Ausführung des erwarteten Werts: in diesem Fall die Funktion </font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Es wird auf den Stapel geschoben und gibt ein Versprechen zurück. Nachdem das Versprechen erfüllt wurde und die Funktion </font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Wert zurückgegeben hat, sieht der Motor </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach wird die Ausführung der asynchronen Funktion verzögert. Die Ausführung des Funktionskörpers wird angehalten, der verbleibende Code wird als Mikrotask ausgeführt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nq/iz/w6/nqizw6g6lhqkheesua-yai1etwy.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem die Ausführung der asynchronen Funktion verzögert wurde, kehrt die Engine zur Ausführung des Codes in einem globalen Kontext zurück. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/ad/ea/e-adeazwnxkl63oawcydpapig1a.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem der gesamte Code in einem globalen Kontext ausgeführt wurde, sucht die Ereignisschleife nach Mikrotasks und erkennt diese </font></font><code>myFunc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>myFunc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf den Stapel geschoben und ausgeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Variable </font></font><code>res</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erhält den Wert des ausgeführten Versprechens, das von der Funktion zurückgegeben wird </font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wir rufen </font></font><code>console.log</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Wert der Variablen auf </font></font><code>res</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><code>One!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in diesem Fall </font><font style="vertical-align: inherit;">eine Zeichenfolge </font><font style="vertical-align: inherit;">. </font></font><code>One!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es wird in der Konsole angezeigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erledigt. Beachten Sie den Unterschied zwischen der asynchronen Funktion und der </font></font><code>then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promis- </font><font style="vertical-align: inherit;">Methode </font><font style="vertical-align: inherit;">? Stichwort</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verschiebt die Ausführung einer asynchronen Funktion. </font><font style="vertical-align: inherit;">Wenn wir verwenden würden </font></font><code>then</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, würde der Promise-Körper weiterlaufen.</font></font><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich als ziemlich ausführlich heraus. </font><font style="vertical-align: inherit;">Machen Sie sich keine Sorgen, wenn Sie sich bei der Arbeit mit Versprechungen unsicher fühlen. </font><font style="vertical-align: inherit;">Es dauert einige Zeit, bis man sich an sie gewöhnt hat. </font><font style="vertical-align: inherit;">Dies gilt für alle Techniken zum Arbeiten mit asynchronem Code in JS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Siehe auch </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Visualisierung der Arbeit von Service - </font><font style="vertical-align: inherit;">Mitarbeitern</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">“ </font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihre Zeit. </font><font style="vertical-align: inherit;">Ich hoffe es wurde gut angelegt.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501684/index.html">Kreuzgang -> einfache OTP-Clusterverwaltung</a></li>
<li><a href="../de501688/index.html">Zusätzliche SSR-Leistung mit Nuxt Fullstack-Server (Teil 2)</a></li>
<li><a href="../de501690/index.html">Wer ist ein DevOps-Ingenieur, was macht er, wie viel verdient er und wie wird er einer?</a></li>
<li><a href="../de501696/index.html">Dashboard Postgresql Übersicht für postgres_exporter (Prometheus)</a></li>
<li><a href="../de501698/index.html">Wir haben die Zeit für die Entwicklung eines neuen Szenarios für die Veröffentlichung einer Anzeige von 6 Tagen auf 42 Sekunden verkürzt</a></li>
<li><a href="../de501704/index.html">Geht das Projekt auf eine neue Ebene? Testen erforderlich</a></li>
<li><a href="../de501706/index.html">Wie erstelle ich einen guten Kurzbericht?</a></li>
<li><a href="../de501708/index.html">Anpassung offener und geschlossener Gläser an eine Halbmaske und eines hausgemachten Verschlusses für offene Gläser</a></li>
<li><a href="../de501710/index.html">Für welche Nischen ist die Krise 2020 die beste Zeit für Entwicklung</a></li>
<li><a href="../de501712/index.html">Apropos Tests: einige Geschichten und eine Umfrage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>