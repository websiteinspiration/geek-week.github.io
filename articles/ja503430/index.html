<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–Œï¸ ğŸ‘¼ğŸ¿ ğŸ¤³ğŸ¿ MSãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€HAProxyãŠã‚ˆã³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¨æ¸¬ ğŸ˜Ÿ ğŸšµ âœŠğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã‚ˆã†çš†ï¼
 
 è‡ªå®…ã‹ã‚‰ã‚ªãƒ•ã‚£ã‚¹ã®è·å ´ã«æ¥ç¶šã™ã‚‹æ–¹æ³•ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ãã‚Œã‚‰ã®1ã¤ã¯ã€Microsoftãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯RDP over HTTPã§ã™ã€‚ RDGWè‡ªä½“ã®æ§‹æˆã«ã¤ã„ã¦ã¯è§¦ã‚ŒãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ãªãœãã‚ŒãŒè‰¯ã„ã®ã‹æ‚ªã„ã®ã‹ã«ã¤ã„ã¦ã¯è­°è«–ã—ãŸãã‚ã‚Šã¾ã›...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MSãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€HAProxyãŠã‚ˆã³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¨æ¸¬</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503430/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆã†çš†ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡ªå®…ã‹ã‚‰ã‚ªãƒ•ã‚£ã‚¹ã®è·å ´ã«æ¥ç¶šã™ã‚‹æ–¹æ³•ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ãã‚Œã‚‰ã®1ã¤ã¯ã€Microsoftãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯RDP over HTTPã§ã™ã€‚ RDGWè‡ªä½“ã®æ§‹æˆã«ã¤ã„ã¦ã¯è§¦ã‚ŒãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ãªãœãã‚ŒãŒè‰¯ã„ã®ã‹æ‚ªã„ã®ã‹ã«ã¤ã„ã¦ã¯è­°è«–ã—ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ãƒªãƒ¢ãƒ¼ãƒˆã‚¢ã‚¯ã‚»ã‚¹ãƒ„ãƒ¼ãƒ«ã®1ã¤ã¨ã—ã¦æ‰±ã„ã¾ã—ã‚‡ã†ã€‚ RDGWã‚µãƒ¼ãƒãƒ¼ã‚’æ‚ªè³ªãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ä¿è­·ã™ã‚‹ã“ã¨ã«ã¤ã„ã¦ãŠè©±ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ RDGWã‚µãƒ¼ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ã€ã™ãã«ä¿è­·ã€ç‰¹ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ã«å¤¢ä¸­ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã‚Œã‚’è¡Œã†æ–¹æ³•ã«é–¢ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®è¨˜äº‹ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸã“ã¨ã«é©šãã¾ã—ãŸã€‚ã¾ã‚ã€ã‚ãªãŸã¯ãã‚Œã‚’è‡ªåˆ†ã§ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RDGWè‡ªä½“ã¯ä¿è­·ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã¯ã„ã€è£¸ã®</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ãƒ¼ãƒ«</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ç™½ã„ãƒãƒƒãƒˆã§</font><font style="vertical-align: inherit;">å…¬é–‹ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã€å•é¡Œãªã</font><font style="vertical-align: inherit;">æ©Ÿèƒ½ã—ã¾ã™ã€‚ã—ã‹ã—ã€é©åˆ‡ãªç®¡ç†è€…ã¾ãŸã¯IB'shnikã¯ã“ã‚Œã‹ã‚‰è½ã¡ç€ãã¾ã›ã‚“ã€‚ã•ã‚‰ã«ã€æ€ æ…¢ãªå¾“æ¥­å“¡ãŒè‡ªå®…ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§ä¼æ¥­ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¦šãˆã¦ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã«ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹çŠ¶æ³ã‚’å›é¿ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å†…éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã‚’å¤–éƒ¨ç’°å¢ƒã‹ã‚‰ä¿è­·ã™ã‚‹è‰¯ã„æ–¹æ³•ã¯ã€ã•ã¾ã–ã¾ãªãƒ—ãƒ­ã‚­ã‚·ã€å…¬é–‹ã‚·ã‚¹ãƒ†ãƒ ã€ãŠã‚ˆã³ãã®ä»–ã®WAFã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ RDGWã¯ã™ã¹ã¦åŒã˜httpã§ã‚ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚ãã‚Œã‹ã‚‰ã€å†…éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã®é–“ã«å°‚ç”¨ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç›´æ¥è¨­ç½®ã™ã‚‹ã‚ˆã†ã«é ¼ã¿ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ãƒ¼ãƒ«ãªF5ã€A10ã€Netscalerï¼ˆADCï¼‰ãŒã‚ã‚‹ã“ã¨ã¯çŸ¥ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚·ã‚¹ãƒ†ãƒ ã®ã„ãšã‚Œã‹ã®ç®¡ç†è€…ã¨ã—ã¦ã€ã“ã‚Œã‚‰ã®ã‚·ã‚¹ãƒ†ãƒ ã®ç ´å£Šã«å¯¾ã™ã‚‹ä¿è­·ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã ã¨è¨€ã„ã¾ã™ã€‚ãã—ã¦ã€ã¯ã„ã€ã“ã‚Œã‚‰ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€é€”ä¸­ã§ã®åˆæˆæ´ªæ°´ã‹ã‚‰ã‚ãªãŸã‚’å®ˆã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ã™ã¹ã¦ã®ä¼æ¥­ãŒãã®ã‚ˆã†ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è³¼å…¥ã™ã‚‹ï¼ˆãã—ã¦ãã®ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ ã®ç®¡ç†è€…ã‚’è¦‹ã¤ã‘ã‚‹ï¼‰ã“ã¨ãŒã§ãã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¡æ–™ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«ç„¡æ–™ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®HAProxyã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ Debian 10ã§haproxy 1.8.19ã®å®‰å®šã—ãŸãƒªãƒã‚¸ãƒˆãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ†ã‚¹ãƒˆã—ã¾ã—ãŸã€‚ã¾ãŸã€ãƒ†ã‚¹ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.0.xxã‚’ç¢ºèªã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
debianè‡ªä½“ã®è¨­å®šã¯ã€ã“ã®è¨˜äº‹ã®ç¯„å›²ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚ç°¡å˜ã«è¨€ã†ã¨ã€ç™½ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã¯443ãƒãƒ¼ãƒˆã‚’é™¤ãã™ã¹ã¦ã‚’é–‰ã˜ã€ç°è‰²ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã¯-ãŸã¨ãˆã°ã€ãƒãƒªã‚·ãƒ¼ã«å¾“ã£ã¦ã€22ãƒãƒ¼ãƒˆã‚’é™¤ãã™ã¹ã¦ã‚’é–‰ã˜ã¾ã™ã€‚ä½œæ¥­ã«å¿…è¦ãªã‚‚ã®ã ã‘ã‚’é–‹ãã¾ã™ï¼ˆãŸã¨ãˆã°ã€VRIPãªã©ã®VRRPï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã«ã€haproxyã‚’SSLãƒ–ãƒªãƒƒã‚¸ãƒ¢ãƒ¼ãƒ‰ï¼ˆåˆ¥åãƒ¢ãƒ¼ãƒ‰httpï¼‰ã«æ§‹æˆã—ã€ãƒ­ã‚®ãƒ³ã‚°ã‚’ã‚ªãƒ³ã«ã—ã¦ã€RDPå†…ã®å†…å®¹ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚ã„ã‚ã°ã€çœŸã‚“ä¸­ã‚’ç™»ã‚Šã¾ã—ãŸã€‚ãã®ãŸã‚ã€RDGatewayã®æ§‹æˆã«é–¢ã™ã‚‹ã€Œã™ã¹ã¦ã€ã®è¨˜äº‹ã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹/ RDWebãƒ‘ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ /rpc/rpcproxy.dllã¨/ remoteDesktopGateway /ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆã€æ¨™æº–ã®GET / POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ä½¿ç”¨ã•ã‚Œãšã€ç‹¬è‡ªã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¿ã‚¤ãƒ—ã¯RDG_IN_DATAã€RDG_OUT_DATAã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤šãã¯ãªã„ãŒã€å°‘ãªãã¨ã‚‚ä½•ã‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mstscã‚’é–‹å§‹ã—ã€ã‚µãƒ¼ãƒãƒ¼ã«ç§»å‹•ã—ã¦ã€ãƒ­ã‚°ã«4ã¤ã®401ã‚¨ãƒ©ãƒ¼ï¼ˆç„¡è¨±å¯ï¼‰ã‚’è¡¨ç¤ºã—ã€ãƒ­ã‚°ã‚¤ãƒ³/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€å›ç­”200ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é›»æºã‚’ã‚ªãƒ•ã«ã—ã¦ã€ã‚‚ã†ä¸€åº¦é–‹å§‹ã™ã‚‹ã¨ã€ãƒ­ã‚°ã«åŒã˜4ã¤ã®401ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚é–“é•ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼å/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€4ã¤è¡¨ç¤ºã•ã‚Œã¾ã™ã‚¨ãƒ©ãƒ¼401ã€‚å¿…è¦ãªã‚‚ã®ã€‚ã“ã‚Œã¯ç§ãŸã¡ãŒã‚­ãƒ£ãƒƒãƒã™ã‚‹ã‚‚ã®ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ­ã‚°ã‚¤ãƒ³URLã‚’ç‰¹å®šã§ããªã‹ã£ãŸãŸã‚ã€haproxyã§401ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã™ã‚‹æ–¹æ³•ãŒã‚ã‹ã‚‰ãªã„ãŸã‚ã€ã™ã¹ã¦ã®4xxã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¾ã™ï¼ˆå®Ÿéš›ã«ã¯ã‚­ãƒ£ãƒƒãƒã›ãšã€ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã™ï¼‰ã€‚ã¾ãŸã€å•é¡Œã‚’è§£æ±ºã—ã¦ã†ã‚Œã—ã„ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¿è­·ã®æœ¬è³ªã¯ã€å˜ä½æ™‚é–“ã‚ãŸã‚Šã®ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®ï¼‰4xxã‚¨ãƒ©ãƒ¼ã®æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã€ãã‚ŒãŒæŒ‡å®šã•ã‚ŒãŸåˆ¶é™ã‚’è¶…ãˆã‚‹å ´åˆã€æŒ‡å®šã•ã‚ŒãŸæ™‚é–“ã®é–“ã€ã“ã®IPã‹ã‚‰ã®ã™ã¹ã¦ã®æ¥ç¶šã‚’ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ï¼‰æ‹’å¦ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŠ€è¡“çš„ã«ã¯ã€ã“ã‚Œã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ã§ã¯ãªãã€4xxã‚¨ãƒ©ãƒ¼ä¿è­·ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€å­˜åœ¨ã—ãªã„URLï¼ˆ404ï¼‰ã‚’é »ç¹ã«è¦æ±‚ã™ã‚‹å ´åˆã€ä¿è­·ã‚‚æ©Ÿèƒ½ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ã‚‚ç°¡å˜ã§æœ€ã‚‚åŠ¹æœçš„ãªæ–¹æ³•ã¯ã€ä½™åˆ†ãªä½•ã‹ãŒç¾ã‚ŒãŸå ´åˆã«ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚«ã‚¦ãƒ³ãƒˆã—ã¦æ‰“ã¡æ¶ˆã™ã“ã¨ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/desktop.example.com.pem<font></font>
    mode http<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    mode http<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-comment"># , , 1000 ,   15 ,  -    10 </span>
    stick-table <span class="hljs-built_in">type</span> string len 128 size 1k expire 15s store http_err_rate(10s)
    <span class="hljs-comment"># ip</span><font></font>
    http-request track-sc0 src<font></font>
    <span class="hljs-comment">#  http  429,    10   4 </span>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> { sc_http_err_rate(0) gt 4 }<font></font>
	<font></font>
	...<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‰¯ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€è¤‡é›‘ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’æ•°ãˆã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã¯æ”»æ’ƒè€…ã«å¯¾ã—ã¦å¤±ç¤¼ãªè¡Œå‹•ã‚’ã¨ã‚Šã¾ã™ã€‚æ”»æ’ƒè€…ã¸ã®tcpæ¥ç¶šã‚’ç ´æ£„ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/ertelecom_ru_2020_06_11.pem<font></font>
    mode http<font></font>
    ...<font></font>
    <span class="hljs-comment">#  ip , 1000 ,   15 ,    </span>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0
    <span class="hljs-comment"># </span><font></font>
    tcp-request connection track-sc0 src<font></font>
    <span class="hljs-comment"># tcp ,    &gt;0</span>
    tcp-request connection reject <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
	<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    mode http<font></font>
    ...<font></font>
	<font></font>
    <span class="hljs-comment">#  ip , 1000 ,   15 ,  -   10 </span>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)
    <span class="hljs-comment"># ,  -   10   8</span><font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    <span class="hljs-comment">#     ( )</span><font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    <span class="hljs-comment">#  </span><font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    <span class="hljs-comment"># </span><font></font>
    tcp-request content track-sc1 src<font></font>
    <span class="hljs-comment">#, ,  </span>
    tcp-request content reject <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser
    <span class="hljs-comment">#,   </span>
    tcp-request content accept <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
	<font></font>
    ...<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒã˜ã“ã¨ã§ã™ãŒã€ä¸å¯§ã«ã€ã‚¨ãƒ©ãƒ¼http 429ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤šã™ãã¾ã™ï¼‰ã‚’è¿”ã—ã¾ã™</font></font><br>
<br>
<pre><code class="bash hljs">frontend fe_rdp_tsc<font></font>
    ...<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0<font></font>
    http-request track-sc0 src<font></font>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
    ...<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    ...<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)<font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    http-request track-sc1 src<font></font>
    http-request allow <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
    http-request deny deny_status 429 <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser<font></font>
    ...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒã‚§ãƒƒã‚¯ï¼šmstscã‚’å®Ÿè¡Œã—ã€ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™ã€‚ 3å›ç›®ã®è©¦è¡Œã®å¾Œã€10ç§’ã§ã‚­ãƒƒã‚¯ã—ã€mstscãŒã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¾ã™ã€‚ãƒ­ã‚°ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§£èª¬ç§ã¯haproxyãƒã‚¹ã‚¿ãƒ¼ã‹ã‚‰é ãé›¢ã‚Œã¦ã„ã¾ã™ã€‚ãŸã¨ãˆã°ã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{sc_http_err_rateï¼ˆ0ï¼‰gt 4}ã‚’</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨ã™ã‚‹ã¨ã€å‹•ä½œã™ã‚‹å‰ã«ç´„10å€‹ã®ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹å ´åˆ</font><font style="vertical-align: inherit;">ã€ãªãœ</font><font style="vertical-align: inherit;">http-request deny deny_status 429ãªã®ã‹</font><font style="vertical-align: inherit;">ã‚ã‹ã‚Šã¾ã›ã‚“</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®ç•ªå·ä»˜ã‘ã«å›°æƒ‘ã—ã¦ã„ã¾ã™ã€‚ãƒãƒ—ãƒ­ã‚¯ã‚·ãƒ¼ã®é”äººã‚ˆã€ã‚ãªãŸãŒç§ã‚’è£œã£ã¦ãã‚Œã¦ã€ç§ã‚’è¨‚æ­£ã—ã¦ã€ã‚‚ã£ã¨ä¸Šæ‰‹ããªã‚Œã°ã†ã‚Œã—ã„ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¡ãƒ³ãƒˆã§ã¯ã€RDã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä¿è­·ã™ã‚‹ä»–ã®æ–¹æ³•ã‚’æŠ•ã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å‹‰å¼·ã™ã‚‹ã®ã¯èˆˆå‘³æ·±ã„ã§ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windowsãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆmstscï¼‰ã«ã¤ã„ã¦ã¯ã€TLS1.2ï¼ˆå°‘ãªãã¨ã‚‚Windows 7ã§ã¯ï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ã“ã¨ã¯æ³¨ç›®ã«å€¤ã™ã‚‹ãŸã‚ã€TLS1ã‚’é›¢ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ç¾åœ¨ã®æš—å·ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ã®ã§ã€å¤ã„ã‚‚ã®ã‚‚æ®‹ã•ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äººã®ãŸã‚ã«</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ä½•ã‹ã‚’ç†è§£ã—ã¦ã„ãªã„</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã ã‘ã§å­¦ç¿’ã—ã€ã™ã§ã«ã‚ˆãã‚„ã‚ŠãŸã„ã€ç§ã¯ã€å…¨ä½“ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haproxy.conf</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">global
        <span class="hljs-built_in">log</span> /dev/<span class="hljs-built_in">log</span>    local0
        <span class="hljs-built_in">log</span> /dev/<span class="hljs-built_in">log</span>    local1 notice<font></font>
        chroot /var/lib/haproxy<font></font>
        stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners<font></font>
        stats timeout 30s<font></font>
        user haproxy<font></font>
        group haproxy<font></font>
        daemon<font></font>
<font></font>
        <span class="hljs-comment"># Default SSL material locations</span><font></font>
        ca-base /etc/ssl/certs<font></font>
        crt-base /etc/ssl/private<font></font>
<font></font>
        <span class="hljs-comment"># See: https://ssl-config.mozilla.org/#server=haproxy&amp;server-version=2.0.3&amp;config=intermediate</span>
        <span class="hljs-comment">#ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE</span><font></font>
-RSA-AES256-GCM-SHA384<font></font>
        ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS<font></font>
        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256<font></font>
        <span class="hljs-comment">#ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets</span><font></font>
        ssl-default-bind-options no-sslv3<font></font>
        ssl-server-verify none<font></font>
<font></font>
<font></font>
defaults<font></font>
        <span class="hljs-built_in">log</span>     global<font></font>
        mode    http<font></font>
        option  httplog<font></font>
        option  dontlognull<font></font>
        timeout connect 5000<font></font>
        timeout client  15m<font></font>
        timeout server  15m<font></font>
        errorfile 400 /etc/haproxy/errors/400.http<font></font>
        errorfile 403 /etc/haproxy/errors/403.http<font></font>
        errorfile 408 /etc/haproxy/errors/408.http<font></font>
        errorfile 500 /etc/haproxy/errors/500.http<font></font>
        errorfile 502 /etc/haproxy/errors/502.http<font></font>
        errorfile 503 /etc/haproxy/errors/503.http<font></font>
        errorfile 504 /etc/haproxy/errors/504.http<font></font>
<font></font>
<font></font>
frontend fe_rdp_tsc<font></font>
    <span class="hljs-built_in">bind</span> *:443 ssl crt /etc/haproxy/cert/dektop.example.com.pem<font></font>
    mode http<font></font>
    capture request header Host len 32<font></font>
    <span class="hljs-built_in">log</span> global<font></font>
    option httplog<font></font>
    timeout client 300s<font></font>
    maxconn 1000<font></font>
<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store gpc0<font></font>
    tcp-request connection track-sc0 src<font></font>
    tcp-request connection reject <span class="hljs-keyword">if</span> { sc0_get_gpc0 gt 0 }<font></font>
<font></font>
    acl rdweb_domain hdr(host) -i beg dektop.example.com<font></font>
    http-request deny deny_status 400 <span class="hljs-keyword">if</span> !rdweb_domain<font></font>
    default_backend be_rdp_tsc<font></font>
<font></font>
<font></font>
backend be_rdp_tsc<font></font>
    balance <span class="hljs-built_in">source</span><font></font>
    mode http<font></font>
    <span class="hljs-built_in">log</span> global<font></font>
<font></font>
    stick-table <span class="hljs-built_in">type</span> ip size 1k expire 15s store http_err_rate(10s)<font></font>
    acl errors_too_fast sc1_http_err_rate gt 8<font></font>
    acl mark_as_abuser sc0_inc_gpc0(fe_rdp_tsc) gt 0<font></font>
    acl clear_as_abuser sc0_clr_gpc0(fe_rdp_tsc) ge 0<font></font>
    tcp-request content track-sc1 src<font></font>
    tcp-request content reject <span class="hljs-keyword">if</span> errors_too_fast mark_as_abuser<font></font>
    tcp-request content accept <span class="hljs-keyword">if</span> !errors_too_fast clear_as_abuser<font></font>
<font></font>
    option forwardfor<font></font>
    http-request add-header X-CLIENT-IP %[src]<font></font>
<font></font>
    option httpchk GET /<font></font>
    cookie RDPWEB insert nocache<font></font>
    default-server inter 3s    rise 2  fall 3<font></font>
    server rdgw01 192.168.1.33:443 maxconn 1000 weight 10 ssl check cookie rdgw01<font></font>
    server rdgw02 192.168.2.33:443 maxconn 1000 weight 10 ssl check cookie rdgw02<font></font>
<font></font>
<font></font>
frontend fe_stats<font></font>
    mode http<font></font>
    <span class="hljs-built_in">bind</span> *:8080<font></font>
    acl ip_allow_admin src 192.168.66.66<font></font>
    stats <span class="hljs-built_in">enable</span><font></font>
    stats uri /stats<font></font>
    stats refresh 30s<font></font>
    <span class="hljs-comment">#stats admin if LOCALHOST</span>
    stats admin <span class="hljs-keyword">if</span> ip_allow_admin
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãªãœãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«2ã¤ã®ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚‹ã®ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãƒˆãƒ¬ãƒ©ãƒ³ã‚¹ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ã§ã™ã€‚</font><font style="vertical-align: inherit;">Haproxyã¯ã€ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ›ãƒ¯ã‚¤ãƒˆIPã§ã‚‚2ã¤å®Ÿè¡Œã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚½ãƒ¼ã‚¹ï¼šã€Œ2ã¤ã®ã‚®ã‚°ã€2ã¤ã®ã‚³ã‚¢ã€ã‚²ãƒ¼ãƒ ç”¨PCã€ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¦ã‚£ã‚­ãƒšãƒ‡ã‚£ã‚¢ã«</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆã‚Œã°</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã€</font></a><font style="vertical-align: inherit;">ã“ã‚Œã§ååˆ†ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªãƒ³ã‚¯ï¼š</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAProxyã‹ã‚‰ã®rdp-gatewayã®æ§‹æˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ãƒƒã‚­ãƒ³ã‚°</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã«</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">æ‚©ã¾ã•</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚Œã¦ã„ãŸå”¯ä¸€ã®è¨˜äº‹</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja503412/index.html">Project Loomï¼šJavaä»®æƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã¯é–“è¿‘ã§ã™</a></li>
<li><a href="../ja503414/index.html">ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒãƒƒã‚¯ã—ã¾ã™ã€‚ã‚¦ã‚©ãƒ¼ã‚¯ã‚¹ãƒ«ãƒ¼ãƒ­ãƒ¼ãƒ—ã€‚PWNã€‚pwntoolsã‚’ä½¿ç”¨ã—ã¦æ–‡å­—åˆ—ã¨ROPã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹</a></li>
<li><a href="../ja503420/index.html">ãã‚Œã‚’ã‚ˆã‚Šæ—©ãé€£æƒ³åŒ–ã—ã¾ã™ï¼ˆPyMorphy2ã€PyMystem3ãŠã‚ˆã³ã„ãã¤ã‹ã®é­”æ³•ï¼‰</a></li>
<li><a href="../ja503426/index.html">44.2 Tb / sãƒ•ã‚¡ã‚¤ãƒãƒ¼-ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja503428/index.html">æµ·å¤–ã§ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«æ›¸ã‹ã‚ŒãŸè‹±èªã‚’æ”¹å–„ã™ã‚‹æ–¹æ³•ï¼šLinguixãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</a></li>
<li><a href="../ja503432/index.html">C ++ã®ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰TCP / IPã‚µãƒ¼ãƒãƒ¼</a></li>
<li><a href="../ja503434/index.html">iPhone SEï¼šç‰‡ç›®ç‹ï¼Ÿ</a></li>
<li><a href="../ja503436/index.html">IPhotoãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ›‡ã‚Šã®Yandex.Diskã‚’æ˜Ÿã‚„æ£˜ã‹ã‚‰é€šã‚ŠæŠœã‘ã‚‹é“</a></li>
<li><a href="../ja503442/index.html">æ–°ã—ã„çŸ¥è­˜ã‚’å¾—ãŸå¾Œã€æ•°å­¦è€…ã¯ãã‚Œã‚’ç†è§£ã—ã‚ˆã†ã¨ã—ã¾ã™</a></li>
<li><a href="../ja503446/index.html">2020å¹´ã«ãƒã‚¤ãƒªã‚¹ã‚¯ã‚«ãƒ†ã‚´ãƒªã®éå±…ä½ä¼æ¥­ã®éŠ€è¡Œå£åº§ã‚’ã©ã“ã§é–‹è¨­ã§ãã¾ã™ã‹ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>