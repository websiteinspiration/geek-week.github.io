<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📑 🕶️ 👨🏽‍⚖️ キャッシング。パート2：リリースの60日前 🤳🏾 🔛 🤵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは！企業での取り組みを推進する方法についてはすでに書いた。より正確には、これがどのように（ときには）成功し、どのような困難が発生する可能性があるか：熊手回顧展。自作のソリューションが有料のソリューションよりも優れていること、そしてキャッシングシステムの選択方法。パート1。
 
 今日私は続け...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>キャッシング。パート2：リリースの60日前</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sportmaster_lab/blog/504400/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！</font><font style="vertical-align: inherit;">企業での取り組みを推進する方法についてはすでに書いた。</font><font style="vertical-align: inherit;">より正確には、これがどのように（ときには）成功し、どのような困難が発生する可能性があるか：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熊手回顧展。</font><font style="vertical-align: inherit;">自作のソリューションが有料のソリューションよりも優れている</font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こと、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">キャッシングシステムの選択方法。</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">パート1</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日私は続けて、そのプロジェクトの心理的に最もストレスの多い瞬間について話したいと思います。それについて最初の2つの記事-プロジェクトの結果がチームの技術的スキルによってそれほどではなく、彼らの計算への自信と最後まで進んでいく意欲が決定されたときです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は言わなければなりません-プロジェクトをこのような激しい瞬間に持っていくと思います-それ</font><font style="vertical-align: inherit;">はこの問題からプロジェクトを引き延ばすことによってどんな英雄よりもlshaya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はるかに使用された間違い</font><font style="vertical-align: inherit;">です...</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私はこの経験を隠さず、喜んでそれを共有します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確に問題のある領域は成長ポイントです</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大の問題は、予期しないところから正確に「到達」する</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのポイントの組み合わせ-ただ、「突然の溝を稼ぐ方法」の素晴らしい経験を共有することをあなたに義務付けます。</font><font style="vertical-align: inherit;">ただし、同様の状況はSportmaster社では例外的です。</font><font style="vertical-align: inherit;">つまり、この状況が再び発生する可能性があります-現在の責任の計画と定義-完全に異なるレベルで。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから、準備ができていれば、導入は十分であるようです-猫へようこそ。</font></font><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/sa/3o/8k/sa3o8kskmgz_ptdsflpadmiycra.png"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2017年6月 </font><font style="vertical-align: inherit;">管理パネルを変更しています。</font><font style="vertical-align: inherit;">管理パネルは、Webインターフェースのフォームとテーブルのセットだけではありません。入力された値は、サードパーティのシステムから取得した他の何十ものデータと結合する必要があります。</font><font style="vertical-align: inherit;">さらに、どういうわけか変換して、最終的には消費者に送信します（その主なものはSportmasterのElasticSearchサイトです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な問題は、変換して送信することです。</font><font style="vertical-align: inherit;">つまり：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれが100Kbのjson形式のデータを提供する必要があり、一部は10MBのポップアップが表示されます（在庫と店舗への商品の配送基準をスキャンします）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネストの任意のレベルの再帰的なアタッチメントを持つ構造を持つjsonがあります（たとえば、メニュー項目内のメニュー、メニュー項目が再び存在するなど）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後のステートメントは承認されず、常に変更されます（たとえば、モデルによる商品の操作は、カラーモデルによる操作のアプローチに置き換えられます）。</font><font style="vertical-align: inherit;">常に-これは週に数回であり、ピークの率は1週間に1日2回です。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の2つのポイントが純粋に技術的であり、タスク自体によって決定される場合、当然、3番目のポイントでは、組織的に対処する必要があります。</font><font style="vertical-align: inherit;">しかし、現実の世界は理想とはほど遠いので、私たちは自分の持っているもので作業します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、Webフォームとそのオブジェクトをサーバー側ですばやくリベットする方法を見つけました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チームの1人がプロの「フォームスラップ」の役割に任命され、準備されたWebコンポーネントを使用して、アナリストがこのUIの図面を修正するよりも早くUIのデモを展開しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、変換のスキームを変更するために、ここで複雑さが生じました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、通常の方法でSQLクエリをOracleに変換しました。チームにはDBスペシャリストがいました。リクエストが2ページの連続したsql-textである瞬間まで続きました。私は何度も続けることができましたが、変更がアナリストから来たとき-客観的に、最も難しいことは、変更を行う場所を見つけることでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナリストはスキームにルールを表明しましたが、コードから切り離されたもの（visio / draw.io / gliffyの何か）で描かれていましたが</font><i><font style="vertical-align: inherit;">、そう</font></i><font style="vertical-align: inherit;">でし</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た。</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ETLシステムの四角や矢印に似ています（たとえば、当時スポーツマスターのWebサイトにデータを提供するために使用されていたPentaho Kettleなど）。ここで、SQLクエリではなく、ETLスキーマがあるとします。その場合、ステートメントとソリューションはトポロジ的に同じように表現されます。つまり、コードの編集にはステートメントの編集と同じくらいの時間がかかる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ETLシステムでは別の問題があります。同じPentaho Kettle-複数のソースから接着されたすべてのデータを書き留めるためにElasticSearchで新しいインデックスを作成する必要がある場合に最適です（注：実際にはPentaho Kettleです-JavaScriptを使用しないため、うまく機能しません）コンシューマーがデータにアクセスするためのJavaクラスに関連付けられている-このため、後で必要なpojoオブジェクトに変換できないものを書くことができますが、これは記事のメインコースとは別のトピックです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、管理パネルでユーザーが1つのドキュメントの1つのフィールドを修正したらどうしますか？この変更をSportmasterのElasticSearch Webサイトに配信するには、更新されたものを含め、このタイプのすべてのドキュメントを入力するための新しいインデックスを作成しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力データの1つのオブジェクトが変更されたとき</font><font style="vertical-align: inherit;">に、対応する出力ドキュメントについて</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のみ、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトのElasticSearchに更新</font><i><font style="vertical-align: inherit;">を</font></i><font style="vertical-align: inherit;">送信したいと考えました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、入力ドキュメント自体ですが、結局のところ、変換スキームによれば、結合によって別のタイプのドキュメントに添付できます！そのため、変換スキームを分析し、ソース内のデータの変更によって影響を受ける出力ドキュメントを計算する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するための箱入り製品の検索は何にもつながりませんでした。見つかりません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、彼らが発見を絶望したとき、彼らはそれを理解しましたが、それは内部でどのように機能するべきですか、そしてこれはどのように行うことができますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイデアはすぐに思いつきました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最終的なETLを構成要素に分解でき、それぞれが有限のセット（たとえば、フィルター、結合など）からの特定のタイプを持つ場合、おそらく、元のノードに対応する特別なノードの同じ最終的なセットを作成するだけで十分ですが、データそのものではなく、変更によって機能するという違いはありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常に詳細に、実装の例と重要なポイントを使用して、私たちのソリューション-別の記事で取り上げたいと思います。サポートする立場に対処するには、これには真剣な没頭、抽象的に考え、まだ明らかにされていないものに依存する能力が必要です。確かに、それは数学的な観点から正確に興味深いものであり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技術的な</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細に</font><font style="vertical-align: inherit;">興味があるHabrovitesにとってのみ興味深いものです</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、7種類のノードを記述した数学的モデルを作成し、このシステムが完全であること、つまりこれらの7種類のノードとそれらの間の接続を使用していることを示しただけで、データ変換スキームを表現できます。</font><font style="vertical-align: inherit;">実装は、キーごとに（つまり、キーごとに、追加の条件なしで）データを取得および記録するアクティブな使用に基づいています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、私たちのソリューションは、すべての導入上の困難に関して強みを持っていました：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データはjsonの形式で提供する必要があります-&gt;私たちはpojoオブジェクト（そのような指定が使用されていた時間を誰かが見つけられなかった場合は、プレーンな古いjavaオブジェクト）で作業します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネストの任意のレベルの再帰的な埋め込みを持つ構造を持つjsonがあります-&gt;もう一度、pojo（主なことはループがないことですが、ネストのレベルの数は重要ではありません。再帰を通じてJavaで簡単に処理できます）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的なステートメントは常に変化します-&gt;優れています。これは、アナリストが（図で）作成した実験よりも早く変換スキームを変更しているためです。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
危険な瞬間のうち、1つだけ-私たちは自分でソリューションをゼロから作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、トラップは間もなく登場しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別な瞬間N1。</font><font style="vertical-align: inherit;">トラップ。</font><font style="vertical-align: inherit;">「まあまあ」</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組織的な性質のもう1つの驚きは、開発と同時にメインマスターリポジトリが新しいバージョンに移行し、このリポジトリがデータを提供する形式が変更されたことです。そして、私たちのシステムが古いストレージではなく、新しいストレージですぐに機能するようになればいいのですが。しかし、新しいストレージはまだ準備ができていません。しかし、その後、データ構造は既知であり、少量の関連データが注がれるデモスタンドを提供できます。行っている？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでの製品アプローチでは、バリューサプライストリームを操作するときに、すべてのオプティミストに明確な警告が出されます。ブロッカーが存在する-&gt;タスクが機能しない、期間。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、その後、そのような依存は疑いを引き起こさなかった。実際、プロトタイプのデルタプロセッサ-デルタデータを処理するシステム（出力データの変化が入力データの変化への応答として変換スキームを使用して計算されるときの数学的モデルの実装）の成功から、私たちは幸福でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての変換スキームのうち、1つが最も重要でした。回路自体が最大かつ最も複雑であるという事実に加えて、この回路に従って実行される変換には厳密な要件がありました。これは、全量のデータの実行に対する時間制限です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、変換は15分で実行され、1秒ではありません。主な入力は、550万レコードのテーブルです。開発段階では、テーブルはまだ入力されていません。より正確には、1万行の小さなテストデータセットで満たされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、始めましょう。最初の実装では、DeltaプロセッサはHashMapをKey-Valueストレージとして機能しました（覚えておきましょう。キーごとに多くのオブジェクトを読み書きする必要があります）。もちろん、本番ボリュームでは、すべての中間オブジェクトがメモリに収まらないため、HashMapの代わりにHazelcastに切り替えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜHazelcastなのか-この製品はよく知られているため、Sportmasterのサイトのバックエンドで使用されました。さらに、これは分散システムであり、私たちが思ったように-友人がパフォーマンスに問題を起こした場合-いくつかのマシンにインスタンスを追加すると、問題が解決します。極端な場合-ダース車。水平スケーリングとすべてのもの。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、ターゲットを絞った変換のために、Deltaプロセッサをリリースしています。ほぼ瞬時に機能します。これは理解できます-データは550万ではなく1万なので、測定された時間に550を掛けると、約2分の結果が得られます。いいね！実際には-勝利！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、プロジェクト作業の最初の段階でした。アーキテクチャを決定し、仮説を確認し（仮説を確認するテストを実施）、パイロットソリューションを垂直に統合する必要があるときだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストは優れた結果を示したので、つまり、すべての仮説を確認し、すぐにパイロットを方向転換しました。垂直方向に統合された「スケルトン」を組み合わせて小さな機能を実現しました。そして、彼らはメインのコーディングを始めました-「スケルトンを肉で満たす」。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何がうまくそして激しく従事したか。その美しい日まで</font><font style="vertical-align: inherit;">、データの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全な</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セットが</font><font style="vertical-align: inherit;">マスターストアにアップロードされました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このセットでテストを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2分後は動作しませんでした。 5、10、15分後も私は働きませんでした。つまり、それらは必要なフレームワークに適合しませんでした。しかし、それが実現しない場合は、何かを詳細に調整して適合させる必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、テストは1時間後には機能しませんでした。そして2時間後も彼が働くことへの希望がありました、そして私たちは何を引き締めるべきかを探します。希望の残りは5時間後でもありました。しかし、10時間後、彼らが家に帰ったとき、テストはまだうまくいきませんでした-もう希望はありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、翌日彼らがオフィスに来たとき、テストは依然として熱心に作業を続けていたことでした。その結果、30時間スクロールし、待たずにオフになりました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大災害！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は十分に迅速に特定されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hazelcast-少量のデータで作業している場合-実際にメモリ内のすべてをスクロールしました。</font><font style="vertical-align: inherit;">しかし、データをディスクにダンプする必要があったとき-パフォーマンスは数千回低下しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラミングとは、当局や完成品を届ける義務がなければ、退屈で無味な職業です。</font><font style="vertical-align: inherit;">つまり、文字通り1日後、完全なデータセットを受け取った後、生産量のテストがどのように合格したかについてのレポートを当局に提出する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは非常に深刻で難しい選択です。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「現状のまま」と言う=プロジェクトを中止する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「好きなように」と言う=リスクを冒す、おそらく、問題を修正できるかどうかは不明</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合にどのような感情が発生するかを理解するには、アイデアに完全に投資し、半年の計画を実現し、同僚が膨大な問題を解決するのに役立つ製品を作成するしかありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、あなたの最愛の創造物を放棄することは非常に困難です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはすべての人々の特徴です-私たちは多くの努力をしたことを愛しています。したがって、批判を聞くのは困難です。フィードバックを適切に認識するように意識的に努力する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、Key-Valueストレージとして使用できる非常に多くの異なるシステムがまだ存在すると判断しました。Hazelcastが適合しない場合、何かが確実に機能します。</font><font style="vertical-align: inherit;">つまり、彼らはチャンスを取ることにしました。</font><font style="vertical-align: inherit;">私たちの正当化のために、それはまだ「血の締め切り」ではなかったと言えます-一般に、バックアップソリューションに「移行」するための時間の余裕がまだありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その上司との会議で、私たちのマネージャーは「テストはシステムが生産量で安定して動作し、クラッシュしないことを示しました」と述べました。</font><font style="vertical-align: inherit;">実際、システムは安定して動作しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リリースまで</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別な瞬間N2。</font><font style="vertical-align: inherit;">罠ではなく、発見ではありません。</font><font style="vertical-align: inherit;">"少ないほうがいいですね"</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Key-Valueデータウェアハウスの役割を持つHazelcastの代替品を見つけるために、すべての候補のリストを作成しました-31製品のリストを取得しました。これが、グーグルで友達から見つけたすべてです。さらに、Googleは学生の学期末レポートなど、絶対にわいせつなオプションをいくつか提供しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
候補者をより速くテストするために、起動後数分で適切なボリュームでパフォーマンスを示す小さなテストを準備しました。そして彼らは作業を並列化しました-誰もがリストから次のシステムを選び、構成し、テストを実行し、次を取りました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らはすぐに働き、1日にいくつかのシステムをスナップしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
18日制で、これは無意味だと判明。私たちの負荷プロファイルの下で-これらのシステムはどれもシャープにされていません。使いやすくするためのラッフルとカーティがたくさんあり、水平スケーリングの多くの美しいアプローチがありますが、これでは利益が得られません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
_fast_がディスク上のオブジェクトにキーを保存し、キーをすばやく読み取るシステムが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もしそうなら、これをどのように実装できるかのアルゴリズムの概要を説明します。一般に、それはかなり実現可能であるように見えます。同時に次の場合：a）ディスクを占有するデータの量を犠牲にします。b）各テーブルのデータの量と特性サイズのおおよその見積もりがあります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタイルのあるものは、マージンのあるオブジェクトに（ディスク上に）メモリを割り当てます。次に、インデックステーブルを使用します...</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまで来られなかったのはラッキーでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
救いはRocksDBの形でやって来ました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはFacebookの製品で、バイトの配列をすばやく読み取ってディスクに保存するように設計されています。同時に、ファイルへのアクセスは、Key-Valueストレージと同様のインターフェースを介して提供されます。実際、キーはバイトの配列であり、値はバイトの配列です。この作業を迅速かつ確実に行うために最適化されています。すべて。あなたがより美しく、ハイレベルなものが必要な場合-あなた自身の上にねじ込みます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まさに私たちが必要とするものです！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keys-Valueストレージの役割を果たしたRocksDBは、ターゲットテストインジケーターを5時間のレベルに引き上げました。</font><font style="vertical-align: inherit;">15分とは程遠かったですが、大事なことはやっていました。</font><font style="vertical-align: inherit;">主なことは、何が起こっているのかを理解すること、ディスクへの書き込みが可能な限り速く、不可能ではないことを理解することでした。</font><font style="vertical-align: inherit;">SSDでは、洗練されたテストで、RocksDBは400Mb /秒を圧迫しましたが、それで十分でした。</font><font style="vertical-align: inherit;">遅延-バインディングコード内のどこかで。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、私たち</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のコード、これは我々がそれを処理できることを意味します。</font><font style="vertical-align: inherit;">分解してみましょうが、私たちはそれを処理できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別な瞬間N3。</font><font style="vertical-align: inherit;">サポート。</font><font style="vertical-align: inherit;">「理論計算」</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムと入力があります。入力データの範囲を取得し、システムが実行する必要のあるアクションの数、これらのアクションがJVMの実行時コストでどのように表現されるか（変数への値の割り当て、メソッドの入力、オブジェクトの作成、バイト配列のコピーなど）、およびへの呼び出し回数を計算しますRocksDBを開催する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計算によると、彼らは2分を満たす必要があることがわかりました（およそ、HashMapのテストが最初に示したように、これは単なる偶然です-それ以来アルゴリズムが変更されました）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでも、テストは5時間実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日</font><font style="vertical-align: inherit;">の発売前</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは特別な日付です-現在、折りたたむことは不可能です-バックアップオプションに切り替える時間はありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、この日、プロジェクトマネージャーは当局に呼び出されます。問題は同じです-時間があります、すべて大丈夫ですか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ip/ci/ps/ipcipst6tfldoo7vmigaxcmsmta.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがこの状況を説明する最良の方法です-この記事の拡張カバー画像。つまり、ボスは、タイトルにレンダリングされた画像のその部分を示しています。しかし、実際には-そのように。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、実際には-私たちはまったく面白くありませんでした。そして、「すべてがクールです！」 -これは、自己習得に非常に強いスキルを持つ人のみが可能です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者を信じ、信頼してくれたことに対する、マネージャーへの大きな尊敬の念。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本当に、本当に利用可能なコード-5時間を示しています。理論的な計算-2分を示します。これはどうして信じられますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、モデルが明確に定式化されていて、カウント方法が理解可能であり、代入する値も理解可能である場合は、可能です。つまり、実際には実行に時間がかかるということは、実際に実行されるのは、そこで実行することを期待しているコードではないということです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
中心的なタスクは、コードで「バラスト」を見つけることです。つまり、最終的なデータを作成するメインストリームに加えて、いくつかのアクションが実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
急いで。ユニットテスト、機能構成、機能の断片化、および実行に費やされた時間の不均衡な場所のローカライズ。多くのことが行われました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その過程で、本気で引き締まるような場所を作りました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、シリアル化。</font><font style="vertical-align: inherit;">最初に標準のjava.ioを使用しました。</font><font style="vertical-align: inherit;">ただし、Cryoを固定すると、シリアル化速度が2.5倍になり、シリアル化されたデータの量が3分の1に減少します（つまり、IOは3分の1になり、主なリソースを消費します）。</font><font style="vertical-align: inherit;">しかし、より詳細には、これは別の技術記事のトピックです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、要点、または「象が隠れた場所」-私は1つの段落で説明しようとします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特記事項4.解決策を見つけるためのレセプション。</font><font style="vertical-align: inherit;">「問題=ソリューション」</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーで取得/設定する場合-計算では1つの操作として実行され、キー+オブジェクト値（もちろん、シリアル化された形式）に等しいボリュームのIOに影響します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、get / setを呼び出すオブジェクト自体がMapである場合はどうでしょうか。これは、ディスクからget / setによって取得することもできます。この場合、IOはどのくらい行われますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計算では、この機能は考慮されていません。つまり、キー+オブジェクト値の1 IOと見なされていました。しかし、実際には？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、Key-Valueストレージでは、key-1によって、タイプMapのobj-1オブジェクトがあり、特定のobj-2オブジェクトをkey-2キーの下に格納する必要があります。ここでは、操作にはkey-2 + obj-2のIOが必要になると考えました。しかし実際には、obj-1を検討し、それを操作してIOに送信する必要があります：key-1 + obj-1。また、オブジェクトが1000個あるマップの場合、IO消費は約1000倍になります。そして、もし10,000個のオブジェクトなら…それが彼らが「バラスト」を得た方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題が特定された場合、解決策は通常明白です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの場合、これはネストされたマップ内の操作のための特別な構造になっています。</font><font style="vertical-align: inherit;">つまり、このようなKey-Valueは、get / setで一度に2つのキーを取得し、順番に適用する必要があります。key-1、key-2-つまり、最初のレベルとネストされたレベルのキーです。</font><font style="vertical-align: inherit;">そのような構造を実装する方法-私は喜んで詳細に説明しますが、もう一度、別の技術記事で説明します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、このエピソードから、私はそのような機能を強調して宣伝します。非常に詳細な問題は良い解決策です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完了</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、組織上のポイントと発生する可能性のあるトラップを示しました。</font><font style="vertical-align: inherit;">このようなトラップは、「横から」または時間の経過とともに非常にはっきりと表示されますが、最初にその隣にいるときに簡単に侵入できます。</font><font style="vertical-align: inherit;">私は誰かがそのような説明を覚えていることを望みます、そして適切な瞬間にリマインダーが機能することを望みます </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、最も重要なことは、すべてがプロセスについて、心理的な瞬間について、組織的な瞬間について語られていることです。</font><font style="vertical-align: inherit;">これで、システムが作成されたタスクと条件がわかりました。</font><font style="vertical-align: inherit;">さて、あなたはシステムについて技術的な側面から伝えることができ、またそうすべきです-これはどのような数学モデルであり、私たちが行ったコードのどのトリック、そして私たちが考えた革新的なソリューションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これについては次の記事で説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それまでの間、Happy New Code！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja504382/index.html">私（PhD Neurobiology）が6か月でデータサイエンティストになった経緯</a></li>
<li><a href="../ja504384/index.html">TypeScriptをReactプロジェクトに徐々に導入する</a></li>
<li><a href="../ja504386/index.html">Vassbotn H.クラス仮想変数</a></li>
<li><a href="../ja504390/index.html">werfを使用した分散CI / CDの編成</a></li>
<li><a href="../ja504392/index.html">手書きのパスポートを認識するために必要なプログラマと単語は何人ですか。</a></li>
<li><a href="../ja504402/index.html">5月29日Javaダイジェスト</a></li>
<li><a href="../ja504408/index.html">UI自動テスト用のセレン化されたシンプルで便利なテストフレームワークテンプレート</a></li>
<li><a href="../ja504412/index.html">オンラインプログラミングチャンピオンシップ「モスクワトレーニングのオープンファイナル」</a></li>
<li><a href="../ja504414/index.html">Как Microsoft убила AppGet</a></li>
<li><a href="../ja504416/index.html">3D ML。パート2：3D MLタスクの損失関数</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>