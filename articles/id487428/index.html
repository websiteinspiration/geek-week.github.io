<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŠ ğŸ‘©â€ğŸ‘§â€ğŸ‘§ ğŸ§“ğŸ¼ Di bawah tenda klien bot Yandex.Music ğŸ¸ ğŸ¬ ğŸ¥–</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="pengantar
 Halo, Habr! Sekali lagi, saya dengan artikel kedua yang mempengaruhi API Yandex.Music. Kasus ini direncanakan dan disebutkan dalam artikel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Di bawah tenda klien bot Yandex.Music</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487428/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halo, Habr! </font><font style="vertical-align: inherit;">Sekali lagi, saya dengan artikel kedua yang mempengaruhi API Yandex.Music. </font><font style="vertical-align: inherit;">Kasus ini direncanakan dan disebutkan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel pertama</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tangan terulur, selesai. </font><font style="vertical-align: inherit;">Hari ini saya akan berbicara tentang hal-hal menarik, menurut saya, momen yang hadir dalam basis kode bot Telegram saya, yang memposisikan dirinya sebagai klien musik yang lengkap. </font><font style="vertical-align: inherit;">Kami juga akan menyentuh API pengenalan musik Yandex. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum memulai cerita selangkah demi selangkah dari implementasi suatu hal tertentu, akan bermanfaat untuk memiliki gagasan tentang bot itu sendiri dan kemampuan fungsionalnya.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo video klien</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/YOw9hs8tFg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian utama saya akan berbicara tentang hal berikut:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masuk ke akun Anda melalui situs di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halaman GitHub</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (mengapa dan mengapa).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format data, kemasannya, dan digunakan dalam data tombol.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perbarui perutean, versi data, konteks melempar ke penangan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jasa:</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reload layanan di Telegram.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layanan "langganan" untuk menerima trek dengan mengirimkan status unduhan.</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementasi caching query yang paling sederhana dan paling elegan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan trek melalui pesan suara dan bagaimana umumnya muncul di bot.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan kecil.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda tertarik pada setidaknya satu poin - selamat datang ke kucing.</font></font><br>
<img src="https://habrastorage.org/webt/uv/4s/a3/uv4sa3pslohuzlmuzrjzteju2dk.png"><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot bekerja dengan pengguna yang telah masuk ke akun mereka, tetapi tidak. </font><font style="vertical-align: inherit;">Semuanya berputar di sekitar empat kelas utama layanan: album, artis, daftar putar, dan trek. </font><font style="vertical-align: inherit;">Semua data entitas didukung, ada pagination dengan pemilihan halaman. </font><font style="vertical-align: inherit;">Untuk berinteraksi dengan mereka, pengguna yang berwenang dapat menggunakan menu pribadi mereka, yang meliputi: daftar putar cerdas, daftar putar "Saya suka" dan daftar putar mereka sendiri. </font><font style="vertical-align: inherit;">Untuk pengguna yang tidak sah, pencarian tersedia - mengirim permintaan pencarian sebagai pesan biasa. </font><font style="vertical-align: inherit;">Sekarang hanya ada daftar kering dari apa lagi yang ada: menerima trek dan objek lain melalui tautan langsung, menerima lirik, kemampuan untuk menyukai / tidak menyukai trek dan artis, melihat trek yang sama, mengenali trek melalui pesan suara dan banyak lagi.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian utama</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Masuk ke akun</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awalnya, bot tidak direncanakan untuk bekerja tanpa otorisasi, oleh karena itu, bahkan selama desain, diputuskan bagaimana otorisasi harus terjadi - melalui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">situs webnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Argumen utama adalah keamanan dan transparansi. Dalam kasus apa pun tidak ingin menerima login dan kata sandi pengguna dalam pesan yang jelas. Dan otorisasi dari komputer pengguna adalah dasar. Oleh karena itu, sebuah situs ditulis untuk otorisasi pada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bereaksi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini adalah bentuk otorisasi dengan pengalihan kembali ke bot. Sepotong dengan otorisasi dan pemrosesan captcha diambil dari perpustakaan dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan ditulis ulang dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk otorisasi, token OAuth yang diterima digunakan, yang ditransfer kembali ke bot melalui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan dalam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tautan terakhir untuk pengalihan terlihat seperti ini: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/music_yandex_bot?start={oauth_token}</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Saya menginginkan yang terbaik, tetapi para pengguna tidak memiliki kepercayaan. Hanya setiap pengguna kesepuluh yang diotorisasi (pada saat itu wajib). Karena itu, dengan pembaruan berikut, saya harus menjelaskan mengapa Anda harus percaya. Semua item tentang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , secara eksklusif tentang permintaan dari sisi klien dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode sumber terbuka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diterbitkan di situs untuk otorisasi dan digandakan dalam pesan selamat datang di bot. Menjadi lebih baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga, di antara faktor-faktor dari otorisasi yang rendah, tidak dapat diaksesnya mirror untuk t.me di Rusia ternyata dan mendukung hanya pengguna dengan berlangganan (lebih lanjut tentang ini dalam catatan, paragraf 7).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Item pertama diselesaikan menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URI</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tg: //</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), dan dalam keadaan darurat, sudah ada tautan ke mirror (jika pengalihan otomatis tidak berfungsi, dan tombol tidak membantu), dan yang kedua lagi di item 7.</font></font><br>
<img src="https://habrastorage.org/webt/ez/2_/0j/ez2_0japfosbu9k4bjelikl8x-i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Format data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk bot ini, saya memutuskan untuk pertama kalinya menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NoSQL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DB - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dipahami: ketika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menanamkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dokumen, kapan tidak. Suka bekerja dengan mongoengine. Tetapi saya benar-benar tidak ingin menyimpan semua data tombol di rumah, dan klien hanya memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rekaman dalam database. Saya takut dengan jumlah data, tetapi saya ingin mengambil server Mongo gratis dengan batas 512 MB untuk penyimpanan data. Menghasilkan rekaman yang indah jika data cocok dengan beberapa tombol dan untuk membersihkan yang sudah usang jauh lebih sulit daripada menyimpan semua yang ada di tombol itu sendiri. Setelah menganalisis ukuran data yang akan disimpan, saya menyimpulkan bahwa itu cocok. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, saya hanya menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tapi dia dengan cepat menolaknya ketika dia berlari ke batas. Di Telegram, isi data tombol hanya bisa tidak lebih dari 64 byte di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTF-8</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, dengan </font><font style="vertical-align: inherit;">permintaan </font><font style="vertical-align: inherit;">teman, saya mulai melihat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">struct</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jadi jenis pertanyaan lahir, format primitif, pengemasan dan pembongkaran. Sekarang digunakan di bot benar-benar di mana-mana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formatnya sangat sederhana. Byte pertama adalah tipe, byte kedua adalah versi. Yang lainnya adalah data untuk jenis tertentu. Jenis disimpan sebagai Enum, memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang merupakan byte pertama. Selain </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , setiap jenis memiliki format untuk mengemas dan membongkar data. Misalnya: ketik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHOW_TRACK_MENU</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format siapa yang memiliki nilai "s?", di mana "s" adalah pengidentifikasi unik trek, dan "?" - Apakah trek memiliki teks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada trek digunakan tipe string karena: pertama, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trek dapat merupakan gabungan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan album </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trek melalui titik dua, dan kedua, itu mungkin </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Trek dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - trek yang dimuat sendiri, hanya tersedia untuk pengguna yang mengunduhnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena data tidak selalu sesuai dengan format, misalnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trek yang </font><font style="vertical-align: inherit;">sama </font><font style="vertical-align: inherit;">dapat diwakili hanya dengan angka, sebelum pengemasannya harus dilemparkan ke dalam jenis untuk format. Dalam hal ini, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Oleh karena itu, di dalam kelas terdapat metode yang menormalkan data yang ditransfer untuk pengemasan, agar tidak melakukannya sendiri saat meneruskan ke konstruktor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
String bersifat swasembada dan dapat menunjukkan panjangnya saat pengemasan dan memperhitungkan panjang ini saat membongkar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dukungan untuk versi yang lebih lama tidak direncanakan, jadi pengecualian dilemparkan jika versi tidak cocok. </font><font style="vertical-align: inherit;">Saat memproses pembaruan, yang akan saya bahas pada paragraf berikutnya, logika yang diperlukan disebut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena Telegram makan secara eksklusif </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTF-8</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , data yang dikemas dikodekan dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base85</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ya, saya kehilangan kecepatan di sini dan menyimpan ukuran terkecil tanpa menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base64</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi mengingat data kecil, saya menganggap menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base85 yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sesuai.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber. </font><font style="vertical-align: inherit;">File callback_data.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> struct
<span class="hljs-keyword">import</span> base64<font></font>
<font></font>
<span class="hljs-keyword">from</span> ext.query_types <span class="hljs-keyword">import</span> QueryType<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BadDataVersion</span>(<span class="hljs-params">Exception</span>):</span>
    <span class="hljs-keyword">pass</span><font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallbackData</span>:</span>
    ACTUAL_VERSION = <span class="hljs-number">7</span>
    BASE_FORMAT = <span class="hljs-string">'&lt;BB'</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, type_: QueryType, data=None, version=None</span>):</span><font></font>
        self.type = type_<font></font>
        self.version = version <span class="hljs-keyword">or</span> CallbackData.ACTUAL_VERSION<font></font>
        self.data = data<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> isinstance(self.data, list):<font></font>
            self.data = [self.data]<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            self.data = self._normalize_data_to_format(self.data)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f'&lt;CallbackData&gt; Type: <span class="hljs-subst">{self.type}</span> Version: <span class="hljs-subst">{self.version}</span> Data: <span class="hljs-subst">{self.data}</span>'</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_normalize_data_to_format</span>(<span class="hljs-params">self, data, bytes_object=False</span>):</span><font></font>
        normalized_data = data.copy()<font></font>
        <span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> enumerate(self.type.format):<font></font>
            cast = str<font></font>
            <span class="hljs-keyword">if</span> c.lower() <span class="hljs-keyword">in</span> <span class="hljs-string">'bhilqn'</span>:<font></font>
                cast = int<font></font>
            <span class="hljs-keyword">elif</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">'efd'</span>:<font></font>
                cast = float<font></font>
            <span class="hljs-keyword">elif</span> c == <span class="hljs-string">'?'</span>:<font></font>
                cast = bool<font></font>
<font></font>
            casted = cast(data[i])<font></font>
            <span class="hljs-keyword">if</span> bytes_object <span class="hljs-keyword">and</span> cast == str:<font></font>
                casted = casted.encode(<span class="hljs-string">'utf-8'</span>)<font></font>
            normalized_data[i] = casted<font></font>
<font></font>
        <span class="hljs-keyword">return</span> normalized_data<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode_type</span>(<span class="hljs-params">callback_data</span>):</span>
        decoded = base64.b85decode(callback_data.encode(<span class="hljs-string">'utf-8'</span>))<font></font>
        type_, version = struct.unpack(CallbackData.BASE_FORMAT, decoded[:<span class="hljs-number">2</span>])<font></font>
<font></font>
        <span class="hljs-keyword">if</span> CallbackData.ACTUAL_VERSION != version:
            <span class="hljs-keyword">raise</span> BadDataVersion()<font></font>
<font></font>
        <span class="hljs-keyword">return</span> QueryType(type_), version, decoded<font></font>
<font></font>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>(<span class="hljs-params">cls, type_, version, decoded</span>):</span>
        start, data = <span class="hljs-number">2</span>, []<font></font>
<font></font>
        <span class="hljs-keyword">if</span> start &lt; len(decoded):<font></font>
            format_iter = iter(type_.format)<font></font>
<font></font>
            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                <span class="hljs-keyword">if</span> start &gt;= len(decoded):
                    <span class="hljs-keyword">break</span><font></font>
<font></font>
                format_ = next(format_iter, type_.format[<span class="hljs-number">-1</span>])<font></font>
<font></font>
                decode_str = format_ <span class="hljs-keyword">in</span> <span class="hljs-string">'ps'</span>
                <span class="hljs-keyword">if</span> decode_str:
                    <span class="hljs-comment"># struct.calcsize('b') = 1</span>
                    length = list(struct.unpack(<span class="hljs-string">'b'</span>, decoded[start: start + <span class="hljs-number">1</span>]))[<span class="hljs-number">0</span>]<font></font>
                    start += <span class="hljs-number">1</span><font></font>
<font></font>
                    format_ = <span class="hljs-string">f'<span class="hljs-subst">{length}</span><span class="hljs-subst">{format_}</span>'</span><font></font>
<font></font>
                step = struct.calcsize(format_)<font></font>
<font></font>
                unpacked = list(struct.unpack(<span class="hljs-string">f'<span class="hljs-subst">{format_}</span>'</span>, decoded[start: start + step]))
                <span class="hljs-keyword">if</span> decode_str:<font></font>
                    unpacked[<span class="hljs-number">0</span>] = unpacked[<span class="hljs-number">0</span>].decode(<span class="hljs-string">'UTF-8'</span>)<font></font>
<font></font>
                data += unpacked<font></font>
                start += step<font></font>
<font></font>
        <span class="hljs-keyword">return</span> cls(type_, data <span class="hljs-keyword">if</span> data <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>, version)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span>(<span class="hljs-params">self</span>):</span><font></font>
        encode = struct.pack(self.BASE_FORMAT, self.type.value, self.version)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> self.data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            format_iter = iter(self.type.format)<font></font>
            normalized_data = self._normalize_data_to_format(self.data, bytes_object=<span class="hljs-literal">True</span>)<font></font>
<font></font>
            <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> normalized_data:<font></font>
                format_ = next(format_iter, self.type.format[<span class="hljs-number">-1</span>])<font></font>
<font></font>
                <span class="hljs-keyword">if</span> format_ <span class="hljs-keyword">in</span> <span class="hljs-string">'ps'</span>:
                    <span class="hljs-comment">#        .  'b'  </span>
                    <span class="hljs-comment"># -      ,    &gt; 36 </span>
                    encode += struct.pack(<span class="hljs-string">'b'</span>, len(data))<font></font>
                    encode += struct.pack(<span class="hljs-string">f'<span class="hljs-subst">{len(data)}</span><span class="hljs-subst">{format_}</span>'</span>, data)
                <span class="hljs-keyword">else</span>:<font></font>
                    encode += struct.pack(<span class="hljs-string">f'<span class="hljs-subst">{format_}</span>'</span>, data)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> base64.b85encode(encode).decode(<span class="hljs-string">'utf-8'</span>)<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Pembaruan dan konteks perutean</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proyek ini menggunakan pustaka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">python-telegram-bot</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk bekerja dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Bot Telegram</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Itu sudah memiliki sistem untuk mendaftarkan penangan untuk jenis pembaruan tertentu yang telah tiba, filter untuk ekspresi reguler, perintah, dan sebagainya. </font><font style="vertical-align: inherit;">Tetapi, mengingat format data dan tipe saya sendiri, saya harus mewarisi dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TelegramHandler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan mengimplementasikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembaruan dan konteks diteruskan ke setiap penangan melalui argumen. </font><font style="vertical-align: inherit;">Dalam hal ini, saya memiliki konteks sendiri dan di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler'e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sedang dibentuk, dan ini adalah: menerima dan / atau menambahkan pengguna ke database, memeriksa relevansi token untuk mendapatkan akses ke musik, menginisialisasi klien Yandex.Music, tergantung pada status otorisasi dan ketersediaan langganan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih jauh dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler'a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya </font><i><font style="vertical-align: inherit;">ada</font></i><font style="vertical-align: inherit;"> penangan yang lebih spesifik, misalnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CallbackQueryHandler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dengannya, pawang terdaftar untuk jenis pembaruan tertentu (tipe saya, dengan format data). Untuk memeriksa apakah pembaruan ini cocok untuk penangan saat ini, tidak semua data dibongkar, tetapi hanya dua byte pertama. Pada tahap ini, kebutuhan untuk meluncurkan panggilan balik diverifikasi. Hanya jika meluncurkan panggilan balik diperlukan - data benar-benar dibongkar dan ditransfer sebagai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kwargs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke penangan akhir. </font><font style="vertical-align: inherit;">Segera ada pengiriman data analitik ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ChatBase</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Registrasi dilakukan secara berurutan, dan prioritasnya lebih tinggi untuk siapa yang akan didaftarkan lebih awal (pada kenyataannya, seperti dalam </font><font style="vertical-align: inherit;">rute </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan dalam proyek lain). </font><font style="vertical-align: inherit;">Oleh karena itu, mendaftarkan penangan untuk versi usang adalah yang pertama di antara penangan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CallBackQuery</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Logika pemrosesan versi yang lama adalah sederhana - beri tahu pengguna tentang ini dan kirim data yang diperbarui, jika mungkin.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Layanan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua layanan diinisialisasi ketika bot diluncurkan dalam satu kelas kontrol, yang kemudian digunakan secara universal di mana saja di bot ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DJ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap layanan memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadPoolExecutor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sendiri </font><font style="vertical-align: inherit;">dengan sejumlah pekerja tertentu yang menjadi tugasnya.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memuat ulang trek di Telegram</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ini, layanan ini belum ditulis ulang untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bot Pengguna</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk memotong batas pada ukuran file yang diunduh di Telegram. Ternyata, di Yandex.Music ada file yang lebih besar dari 50 mb - podcast. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layanan memeriksa ukuran file dan, jika kelebihan, melemparkan peringatan kepada pengguna. Berkat sistem caching yang dijelaskan dalam paragraf 5, ini memeriksa ketersediaan dan penerimaan lirik. Lagu-lagu juga di-cache. Hash file disimpan dalam database. Jika ada, audio dengan cache yang dikenal sedang dikirim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan tidak adanya file dalam database, tautan langsung diterima dari Yandex.Music. Meskipun saat ini, pengguna tidak memiliki kemampuan untuk mengubah pengaturan kualitas, tetapi semua diatur ke nilai standar. File dicari oleh bitrate dan codec dari pengaturan pengguna.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File dan sampulnya diunduh sebagai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempfile.TentaraFile ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , setelah itu mereka diunggah ke Telegram. </font><font style="vertical-align: inherit;">Patut dicatat bahwa TG tidak selalu dengan benar mengenali durasi trek, tetapi saya biasanya diam tentang artis dan judulnya. </font><font style="vertical-align: inherit;">Oleh karena itu, data ini diambil dari Yandex, untungnya, dimungkinkan untuk mengirimkannya ke troli. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika file audio dikirim oleh layanan ini, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selesai_callback ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">, menandakan layanan dengan berlangganan tentang akhir pengunduhan.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layanan berlangganan untuk menerima trek dan mengirim status unduhan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trek tidak dimuat secara instan. Mungkin saja beberapa pengguna meminta trek yang sama. Dalam hal ini, pengguna yang meminta trek terlebih dahulu adalah penggagas dan pemilik trek. Saat memuat ulang lebih dari satu detik, status unduhan dimulai: "Pengguna mengirim pesan suara". Pengguna lain yang meminta trek yang sama adalah pelanggan tetap. Mereka, seperti pemiliknya, dikirim status unduhan sekali setiap ~ 4 detik sehingga pesan tidak mengganggu (status hang selama 5 detik). Segera setelah unduhan trek untuk pemilik selesai, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selesai_callback ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">dari layanan di atas. Setelah itu, semua pelanggan dihapus dari daftar status dan menerima trek yang diunduh.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam solusi arsitektur, pemilik trek juga pelanggan, tetapi dengan tanda tertentu, karena cara pengiriman trek berbeda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Caching kueri</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang kita ingat dari artikel terakhir saya, permintaan ke Yandex.Music API sangat berat. Daftar trek bisa 3 atau 5 mb. Apalagi hanya ada banyak permintaan. Dengan setiap pemrosesan pembaruan, setidaknya 2 permintaan dikirim ke Yandex: untuk menginisialisasi klien dan untuk tindakan tertentu. Di beberapa tempat, untuk mengumpulkan informasi yang cukup (misalnya, untuk daftar putar), Anda perlu membuat permintaan daftar putar, untuk menerima treknya, untuk informasi dari halaman arahan (jika ini adalah daftar putar yang cerdas), dan jangan lupa tentang inisialisasi klien. Secara umum, horor yang tenang dalam hal jumlah permintaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menginginkan sesuatu yang sangat universal, dan tidak membuat penyimpanan apa pun untuk objek tertentu, klien yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena perpustakaan memungkinkan Anda untuk menentukan contoh Anda sendiri untuk eksekusi permintaan, di atas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permintaan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lalu saya manfaatkan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intinya sederhana. Kelas cache itu sendiri adalah singleton. Hanya memiliki dua parameter: masa pakai cache, ukuran. Ketika permintaan dieksekusi, pembungkus dipanggil. Dia ditimpa. Memeriksa cache terjadi dengan hash args dan quarts yang dibekukan. Cache punya waktu untuk ditambahkan. Saat memeriksa kebutuhan memperbarui data, baik data dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LimitedSizeDict diperoleh,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau permintaan nyata dibuat dan ditambahkan ke cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa permintaan tidak dapat di-cache, misalnya, pengaturan suka / tidak suka. Jika pengguna menekan urutan berikut: suka, tidak suka, suka, maka pada akhirnya suka tidak akan dikirimkan. Untuk kasus seperti itu, saat mengirim permintaan, Anda harus memberikan argumen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use_cache</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan nilai yang sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">False</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sebenarnya, ini adalah satu-satunya tempat di mana cache tidak digunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berkat ini, saya membuat permintaan paling berani sehingga mereka di-cache. </font><font style="vertical-align: inherit;">Saya tidak mencoba memecahnya menjadi kecil dan hanya diperlukan untuk halaman saat ini. </font><font style="vertical-align: inherit;">Saya mengambil semuanya sekaligus, dan ketika berpindah antar halaman saya memiliki kecepatan switching yang sangat besar (dibandingkan dengan pendekatan yang lama). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi saya, kelas permintaan cache ternyata indah dan hanya terintegrasi.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> copy
<span class="hljs-keyword">import</span> time<font></font>
<font></font>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Union
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> OrderedDict<font></font>
<font></font>
<span class="hljs-keyword">import</span> requests<font></font>
<font></font>
<span class="hljs-keyword">from</span> yandex_music.utils.request <span class="hljs-keyword">import</span> Request <span class="hljs-keyword">as</span> YandexMusicRequest<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LimitedSizeDict</span>(<span class="hljs-params">OrderedDict</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span>
        self.size_limit = kwargs.pop(<span class="hljs-string">"size_limit"</span>, <span class="hljs-literal">None</span>)<font></font>
        OrderedDict.__init__(self, *args, **kwargs)<font></font>
        self._check_size_limit()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__setitem__</span>(<span class="hljs-params">self, key, value</span>):</span><font></font>
        OrderedDict.__setitem__(self, key, value)<font></font>
        self._check_size_limit()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_check_size_limit</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">if</span> self.size_limit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">while</span> len(self) &gt; self.size_limit:<font></font>
                self.popitem(last=<span class="hljs-literal">False</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CachedItem</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, response: requests.Response</span>):</span><font></font>
        self.timestamp = time.time()<font></font>
        self.response = response<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cache</span>:</span>
    __singleton: <span class="hljs-string">'Cache'</span> = <span class="hljs-literal">None</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, lifetime: Union[str, int], size: Union[str, int]</span>):</span><font></font>
        Cache.__singleton = self<font></font>
<font></font>
        self.lifetime = int(lifetime) * <span class="hljs-number">60</span><font></font>
        self.size = int(size)<font></font>
<font></font>
        self.storage: LimitedSizeDict = LimitedSizeDict(size_limit=int(size))<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> self.storage[hash_].response<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, response: requests.Response, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
        self.storage.update({hash_: CachedItem(response)})<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">need_to_fetch</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span><font></font>
        hash_ = Cache.get_hash(*args, **kwargs)<font></font>
        cached_item = self.storage.get(hash_)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cached_item:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> time.time() - cached_item.timestamp &gt; self.lifetime:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_instance</span>(<span class="hljs-params">cls</span>) -&gt; 'Cache':</span>
        <span class="hljs-keyword">if</span> cls.__singleton <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> cls.__singleton
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">f'<span class="hljs-subst">{cls.__name__}</span> not initialized'</span>)<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">freeze_dict</span>(<span class="hljs-params">d: dict</span>) -&gt; Union[frozenset, tuple, dict]:</span>
        <span class="hljs-keyword">if</span> isinstance(d, dict):
            <span class="hljs-keyword">return</span> frozenset((key, Cache.freeze_dict(value)) <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> d.items())
        <span class="hljs-keyword">elif</span> isinstance(d, list):
            <span class="hljs-keyword">return</span> tuple(Cache.freeze_dict(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> d)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> d<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params">*args, **kwargs</span>):</span>
        <span class="hljs-keyword">return</span> hash((args, Cache.freeze_dict(kwargs)))<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Request</span>(<span class="hljs-params">YandexMusicRequest</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_request_wrapper</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span>
        use_cache = kwargs.get(<span class="hljs-string">'use_cache'</span>, <span class="hljs-literal">True</span>)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-string">'use_cache'</span> <span class="hljs-keyword">in</span> kwargs:<font></font>
            kwargs.pop(<span class="hljs-string">'use_cache'</span>)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> use_cache:<font></font>
            response = super()._request_wrapper(*args, **copy.deepcopy(kwargs))<font></font>
        <span class="hljs-keyword">elif</span> use_cache <span class="hljs-keyword">and</span> Cache.get_instance().need_to_fetch(*args, **kwargs):<font></font>
            response = super()._request_wrapper(*args, **copy.deepcopy(kwargs))<font></font>
            Cache.get_instance().update(response, *args, **kwargs)<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            response = Cache.get_instance().get(*args, **kwargs)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> response<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Lacak pengenalan melalui pesan suara</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, tidak ada pemikiran untuk menambahkan ini ke bot, tetapi situasi yang menarik terjadi. Bot memiliki obrolan (ini ditunjukkan dalam deskripsi bot). Setelah beberapa waktu, saya perhatikan bahwa orang masuk ke dalamnya dan mengirim pesan suara dengan musik. Pada awalnya, saya pikir itu adalah jenis spam baru sehingga seseorang mengotak dan bercanda. Tapi, ketika sudah ada 10 orang seperti itu dan semua orang melakukan hal yang sama, teman saya (yang sama disarankan oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">struct</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) menyarankan agar pengguna mengendarai Yandex.Music mencari bot resmi untuk mengenali musik dari Yandex, mereka melihat ruang obrolan di sana dan mengirim pesan suara dengan serius! Itu hanya asumsi yang cemerlang dan benar. Lalu aku bercanda mengatakan bahwa sudah waktunya untuk membuat pengakuan dan menambahkan bot ke obrolan. Untuk bersenang-senang ... Setelah beberapa saat, ini selesai!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang tentang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Baru-baru ini, Yandex semakin banyak menggunakan soket web. Saya bertemu penggunaannya dalam pengelolaan i.module dan i.station. Layanan pengenalan musik juga berfungsi. Saya melemparkan solusi kerja minimum di bot saya, tetapi saya tidak menambahkan implementasinya ke perpustakaan. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terletak di alamat berikut: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wss: //voiceservices.yandex.net/uni.ws</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kami hanya membutuhkan dua pesan - otorisasi dan permintaan untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dikenali</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex sendiri, dalam aplikasi resminya, mengirim file pendek dalam satu atau tiga detik. Sebagai tanggapan, Anda bisa mendapatkan kebutuhan untuk mengirim lebih banyak data atau hasilnya - ditemukan atau tidak. Jika hasilnya ditemukan, maka ID trek akan dikembalikan. </font><font style="vertical-align: inherit;">File </font><i><font style="vertical-align: inherit;">.Ogg</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
dikirim </font><font style="vertical-align: inherit;">bersama</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ENCODER = SpeechKit Mobile SDK v3.28.0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Saya tidak memeriksa cara kerjanya dengan encoders lain, saya hanya mengubahnya dalam file yang direkam oleh Telegram. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika membalikkan dengan soket web, terkadang keajaiban terjadi. </font><font style="vertical-align: inherit;">Kadang-kadang saya tidak dapat menemukan trek, tetapi ketika saya mengubah bahasa dalam pesan dengan permintaan pengenalan, saya melakukannya. </font><font style="vertical-align: inherit;">Atau pada awalnya ditemukan, dan kemudian berhenti, meskipun file tersebut sama. </font><font style="vertical-align: inherit;">Saya pikir bahasa trek diatur oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SpeechKit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mereka </font><font style="vertical-align: inherit;">pada klien. </font><font style="vertical-align: inherit;">Tidak memiliki kesempatan untuk melakukannya sendiri, saya melakukan pencarian dengan kekerasan.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementasi pengenalan suara buatan saya dengan pesan suara dari Telegram</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> uuid<font></font>
<font></font>
<span class="hljs-keyword">import</span> lomond<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_auth_data</span>():</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"event"</span>: {
            <span class="hljs-string">"header"</span>: {
                <span class="hljs-string">"messageId"</span>: str(uuid.uuid4()),
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"SynchronizeState"</span>,
                <span class="hljs-string">"namespace"</span>: <span class="hljs-string">"System"</span><font></font>
            },<font></font>
            <span class="hljs-string">"payload"</span>: {
                <span class="hljs-string">"accept_invalid_auth"</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">"auth_token"</span>: <span class="hljs-string">"5983ba91-339e-443c-8452-390fe7d9d308"</span>,
                <span class="hljs-string">"uuid"</span>: str(uuid.uuid4()).replace(<span class="hljs-string">'-'</span>, <span class="hljs-string">''</span>),<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_asr_data</span>():</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"event"</span>: {
            <span class="hljs-string">"header"</span>: {
                <span class="hljs-string">"messageId"</span>: str(uuid.uuid4()),
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"Recognize"</span>,
                <span class="hljs-string">"namespace"</span>: <span class="hljs-string">"ASR"</span>,
                <span class="hljs-string">"streamId"</span>: <span class="hljs-number">1</span><font></font>
            },<font></font>
            <span class="hljs-string">"payload"</span>: {
                <span class="hljs-string">"advancedASROptions"</span>: {
                    <span class="hljs-string">"manual_punctuation"</span>: <span class="hljs-literal">False</span>,
                    <span class="hljs-string">"partial_results"</span>: <span class="hljs-literal">False</span><font></font>
                },<font></font>
                <span class="hljs-string">"disableAntimatNormalizer"</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">"format"</span>: <span class="hljs-string">"audio/opus"</span>,
                <span class="hljs-string">"music_request2"</span>: {
                    <span class="hljs-string">"headers"</span>: {
                        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"audio/opus"</span><font></font>
                    }<font></font>
                },<font></font>
                <span class="hljs-string">"punctuation"</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">"tags"</span>: <span class="hljs-string">"PASS_AUDIO;"</span>,
                <span class="hljs-string">"topic"</span>: <span class="hljs-string">"queries"</span><font></font>
            }<font></font>
        }<font></font>
    }<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Recognition</span>:</span>
    URI = <span class="hljs-string">'wss://voiceservices.yandex.net/uni.ws'</span>
    LANGS = [<span class="hljs-string">''</span>, <span class="hljs-string">'ru-RU'</span>, <span class="hljs-string">'en-US'</span>]<font></font>
    POLL_DELAY = <span class="hljs-number">0.3</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, binary_data, status_msg</span>):</span><font></font>
        self.status_msg = status_msg<font></font>
        self.websocket = lomond.WebSocket(self.URI)<font></font>
        self.chunks = self.get_chunks_and_replace_encoder(binary_data)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_track_id</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">for</span> lang <span class="hljs-keyword">in</span> Recognition.LANGS:<font></font>
            asr_data = get_asr_data()<font></font>
            <span class="hljs-keyword">if</span> lang:<font></font>
                asr_data[<span class="hljs-string">'event'</span>][<span class="hljs-string">'payload'</span>].update({<span class="hljs-string">'lang'</span>: lang})<font></font>
                self.status_msg.edit_text(<span class="hljs-string">f'     <span class="hljs-subst">{lang}</span>...'</span>)
            <span class="hljs-keyword">else</span>:<font></font>
                self.status_msg.edit_text(<span class="hljs-string">f'      ...'</span>)<font></font>
<font></font>
            <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> self.websocket.connect(poll=self.POLL_DELAY):
                <span class="hljs-keyword">if</span> msg.name == <span class="hljs-string">'ready'</span>:<font></font>
                    self.websocket.send_json(get_auth_data())<font></font>
                    self.websocket.send_json(asr_data)<font></font>
<font></font>
                    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> self.chunks:<font></font>
                        self.websocket.send_binary(chunk)<font></font>
<font></font>
                <span class="hljs-keyword">if</span> msg.name == <span class="hljs-string">'text'</span>:<font></font>
                    response = msg.json.get(<span class="hljs-string">'directive'</span>)<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> self.is_valid_response(response):<font></font>
                        self.websocket.close()<font></font>
<font></font>
                        <span class="hljs-keyword">return</span> self.parse_track_id(response)
                    <span class="hljs-keyword">elif</span> self.is_fatal_error(response):<font></font>
                        self.websocket.close()<font></font>
<font></font>
                        <span class="hljs-keyword">break</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_valid_response</span>(<span class="hljs-params">self, response</span>):</span>
        <span class="hljs-keyword">if</span> response.get(<span class="hljs-string">'header'</span>, {}).get(<span class="hljs-string">'name'</span>) == <span class="hljs-string">'MusicResult'</span> <span class="hljs-keyword">and</span> \<font></font>
                response.get(<span class="hljs-string">'payload'</span>, {}).get(<span class="hljs-string">'result'</span>) == <span class="hljs-string">'success'</span>:<font></font>
            self.status_msg.edit_text(<span class="hljs-string">f' ,  !'</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_fatal_error</span>(<span class="hljs-params">response</span>):</span>
        <span class="hljs-keyword">if</span> response.get(<span class="hljs-string">'header'</span>, {}).get(<span class="hljs-string">'name'</span>) == <span class="hljs-string">'MusicResult'</span> <span class="hljs-keyword">and</span> \<font></font>
                response.get(<span class="hljs-string">'payload'</span>, {}).get(<span class="hljs-string">'result'</span>) == <span class="hljs-string">'music'</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_track_id</span>(<span class="hljs-params">response</span>):</span>
        <span class="hljs-keyword">return</span> response[<span class="hljs-string">'payload'</span>][<span class="hljs-string">'data'</span>][<span class="hljs-string">'match'</span>][<span class="hljs-string">'id'</span>]<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chunks_and_replace_encoder</span>(<span class="hljs-params">binary_data</span>):</span><font></font>
        chunks = []<font></font>
<font></font>
        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> binary_data.split(<span class="hljs-string">b'OggS'</span>)[<span class="hljs-number">1</span>:]:
            <span class="hljs-keyword">if</span> <span class="hljs-string">b'OpusTags'</span> <span class="hljs-keyword">in</span> chunk:<font></font>
                pos = chunk.index(<span class="hljs-string">b'OpusTags'</span>) + <span class="hljs-number">12</span><font></font>
                size = len(chunk)<font></font>
                chunk = chunk[:pos] + <span class="hljs-string">b'#\x00\x00\x00\x00ENCODER=SpeechKit Mobile SDK v3.28.0'</span>
                chunk += <span class="hljs-string">b"\x00"</span> * (size - len(chunk))<font></font>
<font></font>
            chunks.append(<span class="hljs-string">b'\x00\x00\x00\x01OggS'</span> + chunk)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> chunks<font></font>
<font></font>
</code></pre><br>
     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"> </a>.<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Catatan kecil</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, hanya pengguna dengan langganan yang dapat menggunakan bot karena fakta bahwa layanan dapat digunakan di sejumlah negara terbatas (tanpa berlangganan), dan server dengan bot tersebut berada di Eropa. Masalahnya diselesaikan dengan menggunakan proxy untuk mengeksekusi permintaan dari pengguna tanpa berlangganan. Server proxy terletak di Moskow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada pilihan halaman, tetapi dibatasi hingga 100 (tidak ada tombol lagi yang dapat ditambahkan, pembatasan Telegram). Beberapa permintaan halaman umum memiliki lebih banyak halaman.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pencarian Yandex, jumlah elemen pada halaman tersebut di-hardcode. Berapa banyak trek, berapa banyak daftar putar. Kadang-kadang ini bahkan tidak sesuai dengan jumlah data yang ditampilkan di bagian depan. Ada perubahan halaman, jumlah elemen mengambang. Karena itu, di bot itu juga melompat, yang tidak terlalu indah. Dan untuk menggabungkan paginator mereka dengan miliknya - sesuatu seperti itu. Di tempat lain di mana dimungkinkan untuk meminta sejumlah elemen per halaman, semuanya sempurna. Pesan suara setelah menerapkan pencarian di bot adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/MarshalC/416</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat meneruskan audio di Telegram, penulis hilang dan ditugaskan ke orang yang membuat penerusan. Karena itu, semua trek dikirim dengan tanda tangan dari nama pengguna bot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pesan suara dengan semua yang saya temui setelah implementasi radio di perpustakaan - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/MarshalC/422</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(tentang rantai lintasan, melaluinya dengan mengirimkan tumpukan umpan balik, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_id</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari kenyataan bahwa ini adalah artikel lain tentang bot Telegram, Anda membacanya sampai di sini, kemungkinan besar karena Anda tertarik pada salah satu item dalam pemotongan dan ini luar biasa, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terima kasih banyak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, saya tidak membuka kode sumber bot sepenuhnya (karena di beberapa tempat saya perlu refactor). </font><font style="vertical-align: inherit;">Banyak yang telah dijelaskan dalam artikel ini, tetapi beberapa aspek, misalnya, dengan keyboard virtual dan generasinya tidak terpengaruh. </font><font style="vertical-align: inherit;">Sebagian besar, apa yang tidak ada dalam artikel hanya bekerja dengan perpustakaan saya, tidak ada yang menarik.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kelas-kelas di mana semuanya berputar, saya tunjukkan dalam bentuk di mana mereka sekarang. Saya akui ada bug, tetapi semuanya bekerja untuk waktu yang lama. Di beberapa tempat saya suka kode saya, di beberapa tempat saya tidak - dan ini normal. Jangan lupa bahwa bekerja dengan WS untuk pengakuan adalah solusi pada lutut. Siap membaca kritik beralasan dalam komentar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun bot itu direncanakan bahkan ketika saya mulai menulis perpustakaan, maka saya menolak ide ini, tetapi, ternyata, saya kembali (itu membosankan). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandex.Music Bot - proyek yang membuktikan kesesuaian menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perpustakaan untuk bekerja dengan API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam proyek.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Banyak terima kasih kepada Ibu, Yana, Sana'a, Glory. </font><font style="vertical-align: inherit;">Seseorang untuk mengoreksi kesalahan, beberapa untuk petunjuk, yang tanpanya beberapa poin dalam artikel ini mungkin tidak ada, dan untuk beberapa hanya untuk mengevaluasi artikel sebelum publikasi. </font><font style="vertical-align: inherit;">Arthur untuk picci untuk artikel, Lyod untuk logo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang saya punya masalah akut dengan distribusi setelah belajar. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda siap menelepon saya - beri tahu saya ke mana harus mengirim CV, wawancarai saya. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua kontak saya ada di profil. </font><font style="vertical-align: inherit;">Waktu sedang menyala, saya harap untuk Anda. </font><font style="vertical-align: inherit;">Menurut undang-undang, saya hanya bisa berolahraga di Republik Belarus. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PPS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini adalah artikel kedua dari tiga, tetapi tanpa ide sedikit pun saya akan punya waktu untuk melakukan proyek lain tentang topik ini dan apakah itu diperlukan. </font><font style="vertical-align: inherit;">Saya akan mengungkapkan topiknya kepada publik - klien lintas platform Yandex.Music.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487418/index.html">Apa itu SAP?</a></li>
<li><a href="../id487420/index.html">Sound War Z. Menguji speaker dan headphone MusicDealer</a></li>
<li><a href="../id487422/index.html">Tanggung Jawab Administrator Salesforce: Apa yang Harus Dilakukan dan Kapan</a></li>
<li><a href="../id487424/index.html">Bagaimana skala dari 1 hingga 100.000 pengguna</a></li>
<li><a href="../id487426/index.html">Fleksibilitas menentukan kesuksesan.</a></li>
<li><a href="../id487430/index.html">Keterampilan apa yang dibutuhkan untuk membuat aplikasi iOS? Laporan Yandex</a></li>
<li><a href="../id487432/index.html">Mengikuti jejak DevConf dan CfgMgmtCamp atau apa yang dapat Anda pelajari dengan mengunjungi pembicara di 2 konferensi internasional dalam 2 minggu.</a></li>
<li><a href="../id487438/index.html">Bagaimana cara membuat perusahaan IT dari awal - tanpa pengalaman dalam bidang ini dan keterampilan pemrograman?</a></li>
<li><a href="../id487444/index.html">â€œSambil minum kopi, ditagih dan menerima dorongan pembayaranâ€ - inovasi yang memungkinkan Anda menjalankan bisnis 24/7</a></li>
<li><a href="../id487446/index.html">Bisakah perusahaan â€œmemilikiâ€ warna?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>