<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйтАНЁЯСжтАНЁЯСж ЁЯСиЁЯП┐тАНЁЯФз ЁЯОг рдЯреНрд░реЙрд▓реА рд░реЛрдмреЛрдЯ 2.0ред рднрд╛рдЧ 2. rviz рдФрд░ рдмрд┐рдирд╛ рдкреНрд░рдмрдВрдзрдиред rviz рдореЗрдВ рд╕реМрдВрджрд░реНрдп рдХреЗ рддрддреНрд╡ ЁЯСйЁЯП╛тАНЁЯдЭтАНЁЯСйЁЯП╝ ЁЯСиЁЯП╛тАНЁЯОУ ЁЯСЙЁЯП╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╕реНрд╡рд╛рдпрддреНрдд рд╣реЛрдо рдХреИрд░рд┐рдЬ 2.0 рдкрд░ рдЖрдЦрд┐рд░реА рд▓реЗрдЦ рдореЗрдВ , рд╣рдо рдПрдХ рдмрдЬрдЯ рд░реЛрдмреЛрдЯ рдХреЗ рдУрдбреЛрдореАрдЯрд░ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ, рд╕реНрд▓реИрдо рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдПрдХ рдХрд┐рдлрд╛рдпрддреА...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдЯреНрд░реЙрд▓реА рд░реЛрдмреЛрдЯ 2.0ред рднрд╛рдЧ 2. rviz рдФрд░ рдмрд┐рдирд╛ рдкреНрд░рдмрдВрдзрдиред rviz рдореЗрдВ рд╕реМрдВрджрд░реНрдп рдХреЗ рддрддреНрд╡</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502508/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрд╡рд╛рдпрддреНрдд рд╣реЛрдо рдХреИрд░рд┐рдЬ 2.0 рдкрд░ </font><font style="vertical-align: inherit;">рдЖрдЦрд┐рд░реА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦ рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рд╣рдо рдПрдХ рдмрдЬрдЯ рд░реЛрдмреЛрдЯ рдХреЗ рдУрдбреЛрдореАрдЯрд░ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ, рд╕реНрд▓реИрдо рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдПрдХ рдХрд┐рдлрд╛рдпрддреА рд▓рд┐рдбрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡реАрдХрд╛рд░реНрдп 2 рдбреА рдХрдорд░реЗ рдХреЗ рдирдХреНрд╢реЗ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рддреЗ рд╕рдордп рдЕрдиреНрдп рдореБрджреНрджреЛрдВ рдХреЛ рд╕реНрдкрд╖реНрдЯ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдмрд╛рд░, рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╕реНрд╡рд╛рдпрддреНрдд рдиреЗрд╡рд┐рдЧреЗрд╢рди rviz рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ, рд╣рдо рдЙрди рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдЖрдкрдХреЛ рд░рд╛рдЗрдЬрд╝ рдЫреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрд░рд╡реАрдЬрд╝ рдХреЗ рдХреБрдЫ "рд╕реМрдВрджрд░реНрдп рддрддреНрд╡реЛрдВ" рдкрд░ рднреА рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬреЛ рдЖрд░рдУрдПрд╕ рд░реЛрдмреЛрдЯрд┐рдХреНрд╕ рдХреЗ рд▓рд┐рдП рдЬреАрд╡рди рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рддреЗ рд╣реИрдВред</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3c1/e03/2dd/3c1e032ddbd49f6df72e4fe6fba41644.gif" alt="рдЫрд╡рд┐"><br>
<a name="habracut"></a> <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд▓рд┐рдП рдЕрднреНрдпрд╛рд╕ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░реЛрдмреЛрдЯ рдХрд╛ рдХрд╛рд░реНрдп</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдмрд┐рдВрджреБ рдП рд╕реЗ рдмрд┐рдВрджреБ рдмреА рддрдХ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдпрд╛рддреНрд░рд╛ рдХрд░рдирд╛, рдпрд╛ рдмреЗрд╣рддрд░, рддреБрд░рдВрдд рдХрдИ рдмрд┐рдВрджреБрдУрдВ рддрдХ рдмреАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд▓рд┐рдиреЛрд░реЛрдмреЛрдЯ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ (рдиреЛрдбреНрд╕) рдЬрд┐рд╕рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ, рд░реЛрдмреЛрдЯ рдкрд░ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЬреЛ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рджреГрд╢реНрдп рд╣реЛрдЧрд╛ред рдПрдХ рдмрд╛рд╣рд░реА рдкреАрд╕реА рд╕реЗ, рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди (рдмрд╛рдж рдореЗрдВ "рдкреАрд╕реА" рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ)ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХрд╛рд░реНрдЯ рдкрд░ рдореМрдЬреВрдж рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реЗ, рдЬрд┐рд╕рдХрд╛ рджрд┐рд▓ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдИ 3 рдмреА рд╕рд┐рдВрдЧрд▓-рдмреЛрд░реНрдб рд╣реИ, рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рдЙрдмрдВрдЯреВ 16.04, рдЖрд░рдУрдПрд╕ рдХрд╛рдЗрдиреЗрдЯрд┐рдХ, рдкреАрд╕реА рдкрд░: рдЙрдмрдВрдЯреВ 18.04, рдЖрд░рдУрдПрд╕ рдореЗрд▓реЛрдбрд┐рдХред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЖрдк рдХрд╣реАрдВ рдЬрд╛рдПрдВ, рдЖрдкрдХреЛ рд░реЛрдмреЛрдЯ рдХреЗ рдЖрдпрд╛рдореЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ - рд▓рдВрдмрд╛рдИ рдФрд░ рдЪреМрдбрд╝рд╛рдИред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬреИрд╕рд╛ рдХрд┐ </font><font style="vertical-align: inherit;">рдкрд░рд┐рдпреЛрдЬрдирд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреГрд╖реНрда</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рд╣реИ</font></a><font style="vertical-align: inherit;"> , рдЖрдкрдХреЛ рдЙрдЪрд┐рдд рдорд╛рди рджрд░реНрдЬ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/param/navigation<font></font>
nano costmap_common_params.yaml<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд╣реА рдкрджрдЪрд┐рд╣реНрди рдкреИрд░рд╛рдореАрдЯрд░:</font></font><br>
<br>
<pre><code class="bash hljs">footprint: [[-x, -y], [-x, y], [x, y], [x, -y]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╣рд╛рдВ рд░реЛрдмреЛрдЯ рдХреА x = рд▓рдВрдмрд╛рдИ / y рдФрд░ рдЪреМрдбрд╝рд╛рдИ = 2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рд░реЛрдмреЛрдЯ рдХреЗ рд▓рд┐рдП, рдЖрдк рдПрдХ urdf рдореЙрдбрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░реЛрдмреЛрдЯ рдХрд╛рд░реНрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рдкрд┐рдЫрд▓реА </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдкрд░рд┐рдпреЛрдЬрдирд╛</font></a><font style="vertical-align: inherit;"> рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ рдРрд╕рд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЛ рдЕрдзрд┐рдХ рдиреБрдХрд╕рд╛рди рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рд░реЛрдмреЛрдЯ рдХреЗ рдореЙрдбрд▓ рдХреЗ рдмрдЬрд╛рдп, "рдЯреАрдПрдл рдПрдХреНрд╕рд┐рд╕" рдирдХреНрд╢реЗ рдкрд░ рдпрд╛рддреНрд░рд╛ рдХрд░реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдХреИрд╕реЗ рдирдХреНрд╢реЗ рдкрд░ рд░реЛрдмреЛрдЯ рдХреЗ рджреГрд╢реНрдп рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝рд╛ рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ urdf рдореЙрдбрд▓ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдореЗрдВ рд╕рдордп рдмрд░реНрдмрд╛рдж рди рдХрд░реЗрдВ, рд╣рдо рдЖрдЧреЗ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдПрдХ рд╡рд╛рддрд╛рд╡рд░рдг рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд░реЛрдмреЛрдЯ рдкрд░, рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯрд░реНрдорд┐рдирд▓реЛрдВ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot bringup.launch<font></font>
roslaunch linorobot navigate.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреАрд╕реА рдкрд░, rviz рд╡рд┐рдЬрд╝реБрдЕрд▓ рд╢реЗрд▓ рдЪрд▓рд╛рдПрдВ:</font></font><br>
<pre><code class="bash hljs">roscd lino_visualize/rviz<font></font>
rviz -d navigate.rviz<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реЛ рдЧрдпрд╛, рддреЛ рдкреАрд╕реА рдкрд░ рдЖрдк rviz рдореЗрдВ рд░реЛрдмреЛрдЯ рдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b_/9f/p-/b_9fp-u8g8w-hjpblp-phfjlebq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TF axes rviz рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ рд░рд╣реЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА Poligon рд╡рд┐рдХрд▓реНрдк рднреА рд╣реИ, рдЬрд┐рд╕реЗ рдбрд┐рд╕реНрдкреНрд▓реЗ рдкреИрдирд▓ рдкрд░ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдмрд╣реБрднреБрдЬ - рдпреЗ рд╢реБрд░реБрдЖрдд рдореЗрдВ рдкреЗрд╢ рдХрд┐рдП рдЧрдП рд░реЛрдмреЛрдЯ рдХреЗ рдХреЗрд╡рд▓ рдкреИрд░реЛрдВ рдХреЗ рдЖрдХрд╛рд░ рд╣реИрдВ, рдЬреЛ рдЖрдкрдХреЛ рд░реЛрдмреЛрдЯ рдХреЗ рдЖрдпрд╛рдореЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред * TF рдЕрдХреНрд╖ рдЪрд┐рддреНрд░ рдореЗрдВ рдЕрдХреНрд╖реЛрдВ рд╕реЗ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ: TF-map - map рдФрд░ TF-base-link - рд░реЛрдмреЛрдЯ рд╣реА, рд╢реЗрд╖ рдЕрдХреНрд╖реЛрдВ рдХреЛ rviz рдореЗрдВ рдореМрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рд╡рд┐рд▓рдп рди рд╣реЛред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓рд┐рдбрд╛рд░ рд╕реЗ рдбреЗрдЯрд╛ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рджреАрд╡рд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдереЛрдбрд╝рд╛ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рд░реЛрдмреЛрдЯ рд╕реНрдерд╛рдиреАрдпрдХреГрдд рдирд╣реАрдВ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдЖрдк рдЗрд╕ рд╕реНрдерд┐рддрд┐ рд╕реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдЖрдк "2d рдкреЛрдЬ рдЕрдиреБрдорд╛рди" рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдзреЗ rviz рдореЗрдВ рд╢реБрд░реБрдЖрддреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдХреЗ рднреА рдЗрд╕рдХреА рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zk/z6/rc/zkz6rccts3id2z7n0gpxdg6gtbk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рдирдХреНрд╢реЗ рдкрд░ rviz рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╡рд┐рдВрдбреЛ рдореЗрдВ, рдПрдХ рд╣рд░реЗ рд░рдВрдЧ рдХреЗ рддреАрд░ рдХреЗ рд╕рд╛рде рд░реЛрдмреЛрдЯ рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд╛рди рдФрд░ рджрд┐рд╢рд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВ- рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдореБрджреНрд░рд╛ (рдЖрдк рдХрдИ рдмрд╛рд░ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ww/pm/1c/wwpm1c_aajdcjcaqglvt5mhlf9q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрдкрд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдзрд╛рд░_рд▓рд┐рдВрдХ рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдереЛрдбрд╝рд╛ рд╕рд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рдЬрд╛рдПрдЧрд╛: рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рд╕рд╛рде рд▓рд┐рдбрд╛рд░ </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/tu/-l/lstu-lbjdmh95vblibcsjnlffti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗ рд╕реАрдорд╛рдУрдВ рдХреЗ рд╕рдВрдпреЛрдЧ рдХреА рдкреВрд░реНрдг рд╕рдЯреАрдХрддрд╛ рдЬрдм рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрд░реВрд░рдд рд╣реИ, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рддреЛ рдЕрдкрдиреЗ рдЖрдк рд╣реА рд╕рдм рдХреБрдЫ рд╕рд╣реА рдХрд░ рджреЗрдЧрд╛ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реИрд╕реЗ рднреА рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░, рдЖрд░рд╡реАрдЬрд╝ рдХреЛ рд╢реБрд░реБрдЖрддреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдбрд╛рд▓ рджреЗрдВ, рдЕрдЧрд░ рдЬрдореАрди рдкрд░ рд░реЛрдмреЛрдЯ рдПрдХ рд╣реА рдЬрдЧрд╣ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рддреЛ-рдЗрддрдирд╛ рдХрдмреНрдЬрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрд░рдУрдПрд╕ рдореЗрдВ рд╡рд┐рд╖рдпреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рд╕реЗрд╡рд╛рдПрдВ рднреА рд╣реИрдВ), рдЬрдм рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ "рдореИрдк рдкрд░ рд░реЛрдмреЛрдЯ рдХрд╛ рд╕реНрдерд╛рди" рдкрдврд╝реЗрдЧрд╛, рдлрд┐рд░ рд╣рдо рдЗрд╕ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреАрд╕реА рдкрд░ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ (рдпрд╣ рдХрд┐рд╕ рдЬрдЧрд╣ рдореЗрдВ рд╣реИ рдЗрд╕рд╕реЗ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛)</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_pose.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#! /usr/bin/env python</span>
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">from</span> std_srvs.srv <span class="hljs-keyword">import</span> Empty, EmptyResponse <span class="hljs-comment"># Import the service message python classes generated from Empty.srv.</span>
<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> PoseWithCovarianceStamped, Pose<font></font>
robot_pose = Pose()<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">service_callback</span>(<span class="hljs-params">request</span>):</span>
    <span class="hljs-keyword">print</span> (<span class="hljs-string">"Robot Pose:"</span>)
    <span class="hljs-keyword">print</span> (robot_pose)
    <span class="hljs-keyword">return</span> EmptyResponse() <span class="hljs-comment"># the service Response class, in this case EmptyResponse    </span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sub_callback</span>(<span class="hljs-params">msg</span>):</span>
    <span class="hljs-keyword">global</span> robot_pose<font></font>
    robot_pose = msg.pose.pose   <font></font>
rospy.init_node(<span class="hljs-string">'service_server'</span>) <font></font>
my_service = rospy.Service(<span class="hljs-string">'/get_pose_service'</span>, Empty , service_callback) <span class="hljs-comment"># create the Service called get_pose_service with the defined callback</span>
sub_pose = rospy.Subscriber(<span class="hljs-string">'/amcl_pose'</span>, PoseWithCovarianceStamped, sub_callback)<font></font>
rospy.spin() <span class="hljs-comment"># mantain the service open.</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЯрд░реНрдорд┐рдирд▓ рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреБрдЫ рднреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдирд╣реАрдВ рдХрд░рддреА рд╣реИ рдФрд░ рдЪреБрдкрдЪрд╛рдк рдЗрд╕рдХреЗ рдПрдХреНрд╕реЗрд╕ рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЪреВрдБрдХрд┐ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдордиреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд░реЛрдмреЛрдЯ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рд╣реИ, рдЖрдк рд╣рдорд╛рд░реА рдирдИ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдЯрд░реНрдорд┐рдирд▓ рдХреЛ рдмрдВрдж рдХрд┐рдП рдмрд┐рдирд╛ (рдЬреИрд╕реЗ рдиреЛрдбреНрд╕ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЧрдП рдЯрд░реНрдорд┐рдирд▓), рджреВрд╕рд░реЗ рдЯрд░реНрдорд┐рдирд▓ рдореЗрдВ рд╣рдо рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="bash hljs">rosservice call /get_pose_service
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдЯрд░реНрдорд┐рдирд▓ рдореЗрдВ рдЕрдиреБрд░реЛрдз рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, get_pose.py рд░реЛрдмреЛрдЯ рдХреА рд╕реНрдерд┐рддрд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/np/_x/zvnp_xpbeckxu9wvu3uz-myojye.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрди рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЛ рд╕рд╣реЗрдЬреЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд░реЛрдмреЛрдЯ рдкрд░ amcl рдиреЛрдб рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рддрд╛рдХрд┐ рд░реЛрдмреЛрдЯ рд╣рд░ рдмрд╛рд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдерд┐рддрд┐ рд╕реЗ рд╢реБрд░реВ рд╣реЛ:</font></font><br>
<br>
<pre><code class="bash hljs">nano linorobot/launch/include/amcl.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреЛрдбрд╝рдирд╛ </font></font><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдкрджрдВрдбреЛрдВ</font></font></b>
                        <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"initial_pose_x"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0.548767569629"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"initial_pose_y"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0.218281839179"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"initial_pose_z"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0.0"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"initial_orientation_z"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0.128591756735"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"initial_orientation_w"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0.991697615254"</span>/&gt;</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкрд░, рд░реЛрдмреЛрдЯ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕реНрдерд┐рддрд┐ рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ rviz рдореЗрдВ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t_/e7/ja/t_e7jaubijay2gjiqhtfbde3vss.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢реБрд░реБрдЖрдд рдореЗрдВ рджрд┐рдП рдЧрдП рд░реЛрдмреЛрдЯ рдФрд░ рдкреАрд╕реА рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░реЗрдВ рдФрд░ rviz рдореЗрдВ рд░реЛрдмреЛрдЯ рдХреЛ рджреЗрдЦреЗрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд░реЛрдмреЛрдЯ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП тАЬ2D NAV GoalтАЭ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдБ рднреА рдЖрддреНрдорд╛ рдЪрд╛рд╣реЗрдЧреА: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/59/qc/cc/59qcccgwhvmk2-k1vrrqoyte9lo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд░реЛрдмреЛрдЯ рди рдХреЗрд╡рд▓ рдпрд╛рддреНрд░рд╛ рдХреА рджреВрд░реА рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛ рднреА рдмрддрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдордиреЗ рдереЛрдбрд╝рд╛ рдЖрдЧреЗ рдмрдврд╝рд╛рдпрд╛, рдЪрд╛рд░реЛрдВ рдУрд░ рдореБрдбрд╝ рдЧрдпрд╛ рдФрд░ рд╡рд╛рдкрд╕ рдЪрд▓рд╛ рдЧрдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rviz рдореЗрдВ, рдкрд░рд┐рдЪрд┐рдд "рд╣рд░реЗ рддреАрд░" рдПрдордХреНрд▓ рдХрдг рдЭреБрдВрдб рднреА рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ, рдЬреЛ рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐, рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдЕрдиреБрд╕рд╛рд░, рд░реЛрдмреЛрдЯ рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИред рдпрд╛рддреНрд░рд╛ рдХреЗ рдмрд╛рдж, рдЙрдирдХреА рдПрдХрд╛рдЧреНрд░рддрд╛ рд░реЛрдмреЛрдЯ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд╛рди рдкрд░ рдкрд╣реБрдВрдЪ рдЬрд╛рддреА рд╣реИ, рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдШрдЯ рдЬрд╛рддреА рд╣реИред рд░реЛрдмреЛрдЯ рддреЗрдЬреА рд╕реЗ рдкрд░реНрдпрд╛рдкреНрдд рдпрд╛рддреНрд░рд╛ рдХрд░рддрд╛ рд╣реИ - 0.3 рдореАрдЯрд░ / рд╕реЗрдХрдВрдб, рдЗрд╕рд▓рд┐рдП рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рд░реЛрдмреЛрдЯ рдХреЛ рд╕реНрдерд╛рдиреАрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕рдордп рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"2D NAV рд▓рдХреНрд╖реНрдп" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ rviz рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдирд╛ рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд░реЛрдмреЛрдЯ рдХрд┐рддрдиреА рджреВрд░ рдФрд░ рдХрд┐рд╕ рджрд┐рд╢рд╛ рдореЗрдВ рдпрд╛рддреНрд░рд╛ рдХрд░реЗрдЧрд╛, рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕рд╕реЗ рднреА рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ рдХрд┐ рд░рд╡реАрдЬрд╝ рдореЗрдВ рдСрдкрд░реЗрдЯрд░ рдХреА рднрд╛рдЧреАрджрд╛рд░реА рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдпрд╛рддреНрд░рд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рд╣рдо рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд░реБрдЪрд┐ рдХреЗ рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рд╣рдо рдЬрд╛рдПрдВрдЧреЗред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, "2D NAV Goal" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд╡рд╛рдВрдЫрд┐рдд рдмрд┐рдВрджреБрдУрдВ рдкрд░ рд░реЛрдмреЛрдЯ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВред рдЗрди рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдпрд╣ get_pose.py рд╕реЗрд╡рд╛ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ред рдЕрдЧрд▓рд╛, рд╕рднреА рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдпрд╛рддреНрд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рджрд┐рдП рдЬрд╛рдПрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд░реБрдЪрд┐ рдХреЗ рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ рд░реЛрдмреЛрдЯ рдХреЛ рд╕рд┐рд░реНрдл рдЕрдкрдиреА рдмрд╛рд╣реЛрдВ рдореЗрдВ рдХреНрдпреЛрдВ рдирд╣реАрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВ? рдмрд╛рдд "Amcl рдХрдг рдЭреБрдВрдб" рд╣реИ, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдмрдирд╛рддрд╛ рд╣реИред рднрд▓реЗ рд╣реА рд░реЛрдмреЛрдЯ рд░реБрдЪрд┐ рдХреЗ рдмрд┐рдВрджреБ рдкрд░ рд╣реИ, рдФрд░ рдЗрд╕рдХреА рд╕реНрдерд┐рддрд┐ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ рд╣реИ, рдЗрд╕рдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╕реНрд╡рдпрдВ рд░реБрдЪрд┐ рдХреЗ рдмрд┐рдВрджреБ рдХреЗ рдЖрд╕рдкрд╛рд╕ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ "рдЫрд┐рдбрд╝рдХрд╛рд╡" рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдЕрднреА рднреА рдЬрд╛рдирд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рдХреЛрдбрдирд╛рдо "рдЧрд▓рд┐рдпрд╛рд░реЗ" рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j8/wu/d3/j8wud3xde2uvln0kxars2rb6hqe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рд░реЛрдмреЛрдЯ рдкрд╣рд▓реЗ рд╕реЗ рдмрдирд╛рдИ рдЧрдИ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рдВрдЫрд┐рдд рдмрд┐рдВрджреБ рдкрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдореБрджреНрд░рд╛ рдХреЛ рдмрдЪрд╛рдПрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="bash hljs">rosservice call /get_pose_service
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛ - "рдкреНрд░рд╡реЗрд╢ рджреНрд╡рд╛рд░": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vr/ni/yo/vrniyo_esbuuzo4iqljqmjr84xi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ - "рд░рд╕реЛрдИ": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/d0/68/zf/d068zft3bm_odnx6d4yjuwbu8kq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдпрд╛рддреНрд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдордп рдЖ рдЧрдпрд╛ рд╣реИ -</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MoveTBtoGoalPoints.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">import</span> actionlib
<span class="hljs-comment"># Use the actionlib package for client and server</span>
<span class="hljs-keyword">from</span> move_base_msgs.msg <span class="hljs-keyword">import</span> MoveBaseAction, MoveBaseGoal
<span class="hljs-comment"># Define Goal Points and orientations for TurtleBot in a list</span>
<span class="hljs-string">"""
pose x,y,x; orientation: x,y,z,w
"""</span>
GoalPoints = [ [(<span class="hljs-number">5.31514576482</span>, <span class="hljs-number">1.36578380326</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">-0.498454937648</span>, <span class="hljs-number">0.866915610157</span>)], <span class="hljs-comment">#corridor</span>
		[(<span class="hljs-number">5.77521810772</span>, <span class="hljs-number">-1.2464049907</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>,  <span class="hljs-number">-0.959487358308</span>, <span class="hljs-number">0.281751680114</span>)], <span class="hljs-comment">#prixozaya</span>
		[(<span class="hljs-number">2.14926455346</span>, <span class="hljs-number">-2.7055208156</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>,  <span class="hljs-number">-0.99147032254</span>, <span class="hljs-number">0.130332649487</span>)]] <span class="hljs-comment">#kitchen</span>
<span class="hljs-comment"># The function assign_goal initializes goal_pose variable as a MoveBaseGoal action type.</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">assign_goal</span>(<span class="hljs-params">pose</span>):</span><font></font>
    goal_pose = MoveBaseGoal()<font></font>
    goal_pose.target_pose.header.frame_id = <span class="hljs-string">'map'</span>
    goal_pose.target_pose.pose.position.x = pose[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<font></font>
    goal_pose.target_pose.pose.position.y = pose[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<font></font>
    goal_pose.target_pose.pose.position.z = pose[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<font></font>
    goal_pose.target_pose.pose.orientation.x = pose[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]<font></font>
    goal_pose.target_pose.pose.orientation.y = pose[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]<font></font>
    goal_pose.target_pose.pose.orientation.z = pose[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]<font></font>
    goal_pose.target_pose.pose.orientation.w = pose[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>]<font></font>
 <font></font>
    <span class="hljs-keyword">return</span> goal_pose
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    rospy.init_node(<span class="hljs-string">'MoveTBtoGoalPoints'</span>)
    <span class="hljs-comment"># Create a SimpleActionClient of a move_base action type and wait for server.</span>
    client = actionlib.SimpleActionClient(<span class="hljs-string">'move_base'</span>, MoveBaseAction)<font></font>
    client.wait_for_server()<font></font>
    <span class="hljs-comment"># for each goal point in the list, call the action server and move to goal</span>
    <span class="hljs-keyword">for</span> TBpose <span class="hljs-keyword">in</span> GoalPoints:<font></font>
        TBgoal = assign_goal(TBpose)<font></font>
        <span class="hljs-comment"># For each goal point assign pose</span><font></font>
        client.send_goal(TBgoal)<font></font>
        client.wait_for_result()<font></font>
        <span class="hljs-comment"># print the results to the screen</span>
        <span class="hljs-comment">#if(client.get_state() == GoalStatus.SUCCEEDED):</span>
        <span class="hljs-comment">#    rospy.loginfo("success")</span>
        <span class="hljs-comment">#else:        </span>
        <span class="hljs-comment">#   rospy.loginfo("failed")</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* рд▓рдХреНрд╖реНрдп рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ, рд╣рдо рдпрд╛рддреНрд░рд╛ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдкрд╣рд▓реЗ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗред рдХреЛрдб рдореЗрдВ рдПрдХ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреИрд░рд╛рдореАрдЯрд░ рдЪрд▓рддреЗ рд╣реИрдВ: pose x, y, x; рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕: x, y, z, w - [(5.31514576482, 1.36578380326, 0.0), (0.0, 0.0, -0.498454937648, 0.866915610157)] </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд░реЛрдмреЛрдЯ рдФрд░ рдкреАрд╕реА рдкрд░ рдкрд╣рд▓реЗ рд╕реЗ рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЧрдП рдиреЛрдбреНрд╕ рдХреЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ MoveBBtoGoalPoints.py рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдБ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dw/pa/am/dwpaamsd3ltexeajath9fhxowxs.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк </font><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдо </font><font style="vertical-align: inherit;">рджреЗрдЦреЗрдВрдЧреЗред , рд░реЛрдмреЛрдЯ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рджрд╛рд▓рд╛рди рдореЗрдВ рдЪрд▓рд╛ рдЧрдпрд╛ рдФрд░ рд░рд╕реЛрдИ рдХреЗ рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдЦреБрдж рдХреЛ рджрд░реНрдкрдг рдореЗрдВ рджреЗрдЦрд╛ рдФрд░ рдлрдВрд╕ рдЧрдпрд╛ред рджрд░реНрдкрдгреЛрдВ рдХреЗ рд╕рд╛рде рдорд┐рд▓рддреЗ рд╕рдордп рд▓рд┐рдбрд╛рд░ рдХреЗ рд╕рд╛рде, рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ рдРрд╕рд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджрд░реНрдкрдг рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рдордзреНрдпрд╡рд░реНрддреА рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рд░реЛрдмреЛрдЯ рдХреА рдЧрддрд┐ рдХреЛ рдХрдо рдХрд░рдирд╛, рдорд╛рд░реНрдЧ рдХреЗ рдХрд┐рдирд╛рд░реЗ рджрд░реНрдкрдг рдкрд░ рдПрдХ рдЕрдкрд╛рд░рджрд░реНрд╢реА рдЯреЗрдк рдЫрдбрд╝реА рдХрд░рдирд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдпреЗ рдЕрдЧрд▓реЗ рдЪрд░рдг рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрдм рд╣рдо рдкреВрд░реА рд╣реЛ рдЪреБрдХреА рд░рд╛рдЗрдлрд▓ рдХреА рдорджрдж рд╕реЗ рдФрд░ рдЙрд╕рдХреЗ рдмрд┐рдирд╛ рдмрд┐рдВрджреБ A рд╕реЗ рдмрд┐рдВрджреБ B рддрдХ рдпрд╛рддреНрд░рд╛ рдХреЗ рдХрд╛рд░реНрдп рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗред рдЕрдм, рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╣рдореЗрдВ рдмрд╛рд╣рд░реА рдкреАрд╕реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╛рддреНрд░рд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣рдореЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд╡рд╛рдВрдЫрд┐рдд рдмрд┐рдВрджреБрдУрдВ рдкрд░ рд▓реЗ рдЬрд╛рддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдЪрд▓реЛ rviz рдХреЗ рд╕рд╛рде рдкреАрд╕реА рдХреЛ рдЫреЛрдбрд╝рдиреЗ рдХреА рдЬрд▓реНрджрдмрд╛рдЬреА рди рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рд▓рд┐рдиреЛрд░реЛрдмреЛрдЯ рдкреНрд░реЛрдЬреЗрдХреНрдЯ "рдмреЙрдХреНрд╕ рд╕реЗ рдмрд╛рд╣рд░" рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╕реНрдЯреИрдХ рдкрд░ "рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХрд╛рдо" рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдЖрдкрддреНрддрд┐ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ - рдореБрдЭреЗ рдХрд╣рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐, рд╕реНрд╡рд╛рдпрддреНрдд рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╣рд╛рдБ рд╣реИ, рд░реЛрдмреЛрдЯ рдиреЗ n рдХрджрдо рдЖрдЧреЗ, рдмрдЧрд╝рд▓ рдореЗрдВ, рдкреАрдЫреЗ рдХреА рддрд░рдл рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рджрд░реНрдкрдг рдореЗрдВ рднреА рдЪрд▓рд╛рдИ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдареАрдХ рд╣реИ, рдЬреЛ рдХрд┐ ROS рдХреЗ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХреБрдЫ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рдЗрди рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рджреЗрдЦреЗрдВред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдХреБрдЫ рдЧреИрд░-рдЬрд┐рдореНрдореЗрджрд╛рд░ рдирд╛рдЧрд░рд┐рдХ рдиреЗ рд░реЛрдмреЛрдЯ рдХреЗ рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдПрдХ рдирд┐рд░реНрдЬреАрд╡ рд╡рд╕реНрддреБ рдЫреЛрдбрд╝ рджреАред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдЗрдЯрдо рдЙрд╕ рдирдХреНрд╢реЗ рдкрд░ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рд▓рд┐рдП рд░реЛрдмреЛрдЯ рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tv/6w/qs/tv6wqskrwnnbckeqldhlav9cdhe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреНрдпрд╛ рд╣реЛрдЧрд╛? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рджреЗрдЦреЗрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qx/dt/b6/qxdtb6nv92prvbtipav6h8kv79s.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд▓рд┐рдбрд╛рд░ рдиреЗ рдПрдХ рдмрд╛рдзрд╛ рджреЗрдЦреА, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдиреЗ рдЗрд╕реЗ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдФрд░ рдПрдХ рдЪрдХреНрдХрд░ рдХрд╛ рдЖрджреЗрд╢ рджрд┐рдпрд╛ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, rviz рдореЗрдВ рдХреБрдЫ рд╕реБрдВрджрд░рддрд╛ рдЬреЛрдбрд╝реЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rviz рд╡рд┐рдЬрд╝реБрдЕрд▓ рдПрдбрд┐рдЯрд░ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ rviz рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп рдХрд╛рдлреА рджрд┐рд▓рдЪрд╕реНрдк рдмрд┐рдВрджреБ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреЗ рд╕рд╛рде рднрдВрдбрд╛рд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╣реИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╣рдорд╛рд░реЗ рдкреАрд╕реА рдкрд░ рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="bash hljs">roscd; <span class="hljs-built_in">cd</span> ../src;<font></font>
catkin_create_pkg my_rviz_markers rospy<font></font>
<span class="hljs-built_in">cd</span> my_rviz_markers/
<span class="hljs-built_in">cd</span> src<font></font>
git <span class="hljs-built_in">clone</span> https://github.com/jsk-ros-pkg/jsk_visualization<font></font>
git <span class="hljs-built_in">clone</span> https://github.com/ClementLeBihan/rviz_layer
<span class="hljs-built_in">cd</span> ..<font></font>
rosdep install --from-paths -y -r src<font></font>
<span class="hljs-built_in">cd</span> ~/linorobot_ws/<font></font>
catkin_make<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rviz рдореЗрдВ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдмрд╛рдж, рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд▓рдЧрдЗрдиреНрд╕ рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдЗрдХрдиреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/pm/tb/lgpmtbn86bdy-uygi-66wsdws4e.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_rviz_markers / рдирдореВрдиреЗ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pictogram_array_objects_demo.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">from</span> jsk_rviz_plugins.msg <span class="hljs-keyword">import</span> Pictogram, PictogramArray
<span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> random, choice<font></font>
rospy.init_node(<span class="hljs-string">"pictogram_object_demo_node"</span>)<font></font>
p = rospy.Publisher(<span class="hljs-string">"/pictogram_array"</span>, PictogramArray,  queue_size=<span class="hljs-number">1</span>)<font></font>
<font></font>
r = rospy.Rate(<span class="hljs-number">1</span>)<font></font>
actions = [Pictogram.JUMP, Pictogram.JUMP_ONCE, Pictogram.ADD, <font></font>
           Pictogram.ROTATE_X, Pictogram.ROTATE_Y, Pictogram.ROTATE_Z]<font></font>
pictograms = [<span class="hljs-string">"home"</span>,<span class="hljs-string">"fa-robot"</span>]<font></font>
object_frames = [<span class="hljs-string">"map"</span>,<span class="hljs-string">"base_link"</span>]<font></font>
<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> rospy.is_shutdown():<font></font>
    <font></font>
    arr = PictogramArray()<font></font>
    arr.header.frame_id = <span class="hljs-string">"/map"</span><font></font>
    arr.header.stamp = rospy.Time.now()<font></font>
    <span class="hljs-keyword">for</span> index, character <span class="hljs-keyword">in</span> enumerate(pictograms):<font></font>
        msg = Pictogram()<font></font>
        msg.header.frame_id = object_frames[index]<font></font>
        msg.action = actions[<span class="hljs-number">2</span>]<font></font>
        msg.header.stamp = rospy.Time.now()<font></font>
        msg.pose.position.x = <span class="hljs-number">0</span>
        msg.pose.position.y = <span class="hljs-number">0</span>
        msg.pose.position.z = <span class="hljs-number">0.5</span>
        <span class="hljs-comment"># It has to be like this to have them vertically orient the icons.</span>
        msg.pose.orientation.w = <span class="hljs-number">0.7</span>
        msg.pose.orientation.x = <span class="hljs-number">0</span>
        msg.pose.orientation.y = <span class="hljs-number">-0.7</span>
        msg.pose.orientation.z = <span class="hljs-number">0</span>
        msg.size = <span class="hljs-number">0.5</span>
        msg.color.r = <span class="hljs-number">25</span> / <span class="hljs-number">255.0</span>
        msg.color.g = <span class="hljs-number">255</span> / <span class="hljs-number">255.0</span>
        msg.color.b = <span class="hljs-number">240</span> / <span class="hljs-number">255.0</span>
        msg.color.a = <span class="hljs-number">1.0</span><font></font>
        msg.character = character<font></font>
        arr.pictograms.append(msg)<font></font>
    p.publish(arr)<font></font>
    r.sleep()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрд▓реЛ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдмрдирд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="bash hljs">sudo chmod +x pictogram_array_objects_demo.py
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My_rviz_markers / рд▓реЙрдиреНрдЪ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдиреНрдЪ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">launch</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">node</span> <span class="hljs-attr">pkg</span>=<span class="hljs-string">"my_rviz_markers"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"pictogram_array_objects_demo.py"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"pictogram_array_objects_demo"</span> &lt;/<span class="hljs-attr">node</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">launch</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ (рдЗрд╕ рд╕рдордп рдЕрдиреНрдп рд╕рднреА рдиреЛрдбреНрд╕ рдХреЛ рднреА рдХрд╛рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП): </font></font><br>
<br>
<pre><code class="bash hljs">roslaunch my_rviz_markers pictogram_array_objects_demo.launch
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рд░реНрдХрд░ рдХреЛ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд░рдЦреЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд╛рд░реНрдХрд░ рдпрд╣ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрджрдЧрд╛рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдмрд┐рдВрджреБ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рдХрд╣рд╛рдВ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХреА рддрд░рд╣, my_rviz_markers / рдирдореВрдиреЗ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic_marker.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span><font></font>
<font></font>
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">from</span> visualization_msgs.msg <span class="hljs-keyword">import</span> Marker
<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> Point<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MarkerBasics</span>(<span class="hljs-params">object</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        self.marker_objectlisher = rospy.Publisher(<span class="hljs-string">'/marker_basic'</span>, Marker, queue_size=<span class="hljs-number">1</span>)<font></font>
        self.rate = rospy.Rate(<span class="hljs-number">1</span>)<font></font>
        self.init_marker(index=<span class="hljs-number">0</span>,z_val=<span class="hljs-number">0</span>)<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init_marker</span>(<span class="hljs-params">self,index=<span class="hljs-number">0</span>, z_val=<span class="hljs-number">0</span></span>):</span><font></font>
        self.marker_object = Marker()<font></font>
        self.marker_object.header.frame_id = <span class="hljs-string">"/map"</span><font></font>
        self.marker_object.header.stamp    = rospy.get_rostime()<font></font>
        self.marker_object.ns = <span class="hljs-string">"start"</span><font></font>
        self.marker_object.id = index<font></font>
        self.marker_object.type = Marker.SPHERE<font></font>
        self.marker_object.action = Marker.ADD<font></font>
<font></font>
        my_point = Point()<font></font>
        my_point.z = z_val<font></font>
        <span class="hljs-comment">#self.marker_object.pose.position = my_point</span>
        self.marker_object.pose.position.x = <span class="hljs-number">5.31514576482</span>
        self.marker_object.pose.position.y = <span class="hljs-number">1.36578380326</span> 
        self.marker_object.pose.orientation.x = <span class="hljs-number">0</span>
        self.marker_object.pose.orientation.y = <span class="hljs-number">0</span>
        self.marker_object.pose.orientation.z = <span class="hljs-number">-0.498454937648</span>
        self.marker_object.pose.orientation.w = <span class="hljs-number">0.866915610157</span>
        self.marker_object.scale.x = <span class="hljs-number">0.2</span>
        self.marker_object.scale.y = <span class="hljs-number">0.2</span>
        self.marker_object.scale.z = <span class="hljs-number">0.2</span><font></font>
    <font></font>
        self.marker_object.color.r = <span class="hljs-number">0.0</span>
        self.marker_object.color.g = <span class="hljs-number">0.0</span>
        self.marker_object.color.b = <span class="hljs-number">1.0</span>
        <span class="hljs-comment"># This has to be, otherwise it will be transparent</span>
        self.marker_object.color.a = <span class="hljs-number">1.0</span><font></font>
<font></font>
        <span class="hljs-comment"># If we want it for ever, 0, otherwise seconds before desapearing</span>
        self.marker_object.lifetime = rospy.Duration(<span class="hljs-number">0</span>)<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> rospy.is_shutdown():<font></font>
            self.marker_objectlisher.publish(self.marker_object)<font></font>
            self.rate.sleep()<font></font>
   <font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    rospy.init_node(<span class="hljs-string">'marker_basic_node'</span>, anonymous=<span class="hljs-literal">True</span>)<font></font>
    markerbasics_object = MarkerBasics()<font></font>
    <span class="hljs-keyword">try</span>:<font></font>
        markerbasics_object.start()<font></font>
    <span class="hljs-keyword">except</span> rospy.ROSInterruptException:
        <span class="hljs-keyword">pass</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My_rviz_markers / рд▓реЙрдиреНрдЪ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдиреНрдЪ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic_marker.launch</font></font></b>
                        <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">launch</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">node</span> <span class="hljs-attr">pkg</span>=<span class="hljs-string">"my_rviz_markers"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"basic_marker.py"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"basic_marker"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">launch</span>&gt;</span></code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daud:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch my_rviz_markers basic_marker.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rviz рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/ci/yi/pbciyiiovbi8eo_kotdwzpqje9o.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдЬреЛрдбрд╝реЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреЛ рджреЛ рдлрд╝реНрд░реЗрдореЛрдВ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдФрд░ рдХреЛрдг рджрд┐рдЦрд╛рдПрдЧрд╛: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wh/9s/xp/wh9sxpxllgndhu1xaeu4oe-ekuk.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_rviz_markers / рд▓реЙрдиреНрдЪ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдиреНрдЪ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">overlay_meny_my.launch overlay_menu_my.launch</font></font></b>
                        <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">launch</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">node</span> <span class="hljs-attr">pkg</span>=<span class="hljs-string">"my_rviz_markers"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"haro_overlay_complete_demo.py"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"overlay_menu"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">launch</span>&gt;</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My_rviz_markers / рдирдореВрдиреЗ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haro_overlay_complete_demo.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span><font></font>
<font></font>
<span class="hljs-keyword">from</span> jsk_rviz_plugins.msg <span class="hljs-keyword">import</span> OverlayText, OverlayMenu
<span class="hljs-keyword">from</span> std_msgs.msg <span class="hljs-keyword">import</span> ColorRGBA, Float32
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> Twist<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HaroOverlay</span>(<span class="hljs-params">object</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><font></font>
        <font></font>
        self.text_pub = rospy.Publisher(<span class="hljs-string">"/text_sample"</span>, OverlayText, queue_size=<span class="hljs-number">1</span>)<font></font>
        <font></font>
        self.plot_value_pub = rospy.Publisher(<span class="hljs-string">"/plot_value_sample"</span>, Float32, queue_size=<span class="hljs-number">1</span>)<font></font>
        self.piechart_value_pub = rospy.Publisher(<span class="hljs-string">"/piechart_value_sample"</span>, Float32, queue_size=<span class="hljs-number">1</span>)<font></font>
        self.menu_publisher = rospy.Publisher(<span class="hljs-string">"/test_menu"</span>, OverlayMenu, queue_size=<span class="hljs-number">1</span>)<font></font>
        self.plot_value = <span class="hljs-number">0</span>
        self.piechart_value = <span class="hljs-number">0</span>
        self.max_distance_from_object = <span class="hljs-number">10.0</span><font></font>
        <font></font>
        self.subs = rospy.Subscriber(<span class="hljs-string">"/haro_base_link_to_person_standing_tf_translation"</span>, Twist, self.twist_callback)<font></font>
        <font></font>
        self.counter = <span class="hljs-number">0</span>
        self.rate = rospy.Rate(<span class="hljs-number">100</span>)<font></font>
        self.overlaytext = self.update_overlaytext()<font></font>
        self.menu = self.update_overlay_menu()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">twist_callback</span>(<span class="hljs-params">self, msg</span>):</span><font></font>
        self.plot_value = msg.linear.x<font></font>
        self.piechart_value = msg.angular.z<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_overlaytext</span>(<span class="hljs-params">self, number=<span class="hljs-number">1.23</span>, number2=<span class="hljs-number">20</span></span>):</span>  <font></font>
        <font></font>
        text = OverlayText()<font></font>
        text.width = <span class="hljs-number">200</span>
        text.height = <span class="hljs-number">400</span>
        text.left = <span class="hljs-number">10</span>
        text.top = <span class="hljs-number">10</span>
        text.text_size = <span class="hljs-number">12</span>
        text.line_width = <span class="hljs-number">2</span>
        text.font = <span class="hljs-string">"DejaVu Sans Mono"</span>
        text.text = <span class="hljs-string">"""Distance=  %s.
        Angle=%s.
        Counter = &lt;span style="color: green;"&gt;%d.&lt;/span&gt;
        """</span> % (str(number), str(number2) ,self.counter)<font></font>
        text.fg_color = ColorRGBA(<span class="hljs-number">25</span> / <span class="hljs-number">255.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">240.0</span> / <span class="hljs-number">255.0</span>, <span class="hljs-number">1.0</span>)<font></font>
        text.bg_color = ColorRGBA(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.2</span>)<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> text<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_overlay_textonly</span>(<span class="hljs-params">self, new_text</span>):</span><font></font>
        self.overlaytext.text = new_text<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_overlay_menu</span>(<span class="hljs-params">self</span>):</span><font></font>
        menu = OverlayMenu()<font></font>
        menu.title = <span class="hljs-string">"HaroSystemMode"</span>
        menu.menus = [<span class="hljs-string">"Sleep"</span>, <span class="hljs-string">"Searching"</span>, <span class="hljs-string">"MovingInCircles"</span>,<span class="hljs-string">"Waiting"</span>]<font></font>
        <font></font>
        menu.current_index = self.counter % len(menu.menus)<font></font>
        <span class="hljs-keyword">return</span> menu<font></font>
        <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_overlay_menu_haro_tf</span>(<span class="hljs-params">self</span>):</span><font></font>
        menu = OverlayMenu()<font></font>
        menu.title = <span class="hljs-string">"HaroDistanceFromPerson"</span>
        menu.menus = [<span class="hljs-string">"FarAway"</span>, <span class="hljs-string">"CloseBy"</span>, <span class="hljs-string">"Target"</span>, <span class="hljs-string">"OtherWayRound"</span>]<font></font>
        <font></font>
        fraction = <span class="hljs-number">10.0</span><font></font>
        <font></font>
        <span class="hljs-keyword">if</span> self.piechart_value &lt; (math.pi/fraction):
            <span class="hljs-keyword">if</span> self.plot_value &gt;= self.max_distance_from_object:<font></font>
                index = <span class="hljs-number">0</span>
            <span class="hljs-keyword">elif</span> self.plot_value &gt;= (self.max_distance_from_object/ fraction) <span class="hljs-keyword">and</span> self.plot_value &lt; self.max_distance_from_object:<font></font>
                index = <span class="hljs-number">1</span>
            <span class="hljs-keyword">elif</span> self.plot_value &lt; (self.max_distance_from_object/fraction):<font></font>
                index = <span class="hljs-number">2</span><font></font>
            <font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            index = <span class="hljs-number">3</span><font></font>
            <font></font>
        menu.current_index = index<font></font>
            <font></font>
        <span class="hljs-keyword">return</span> menu<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_dummy_demo</span>(<span class="hljs-params">self</span>):</span><font></font>
        <font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> rospy.is_shutdown():<font></font>
            self.overlaytext = self.update_overlaytext()<font></font>
            self.menu = self.update_overlay_menu()<font></font>
            <font></font>
            <span class="hljs-keyword">if</span> self.counter % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<font></font>
                self.menu.action = OverlayMenu.ACTION_CLOSE<font></font>
            <font></font>
            self.text_pub.publish(self.overlaytext)<font></font>
            <span class="hljs-comment"># If values are very high it autoadjusts so be careful</span>
            self.value_pub.publish(math.cos(self.counter * math.pi * <span class="hljs-number">2</span> / <span class="hljs-number">1000</span>))<font></font>
            self.menu_publisher.publish(self.menu)<font></font>
            <font></font>
            self.rate.sleep()<font></font>
            self.counter += <span class="hljs-number">1</span><font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_harodistance_demo</span>(<span class="hljs-params">self</span>):</span><font></font>
        <font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> rospy.is_shutdown():<font></font>
            self.overlaytext = self.update_overlaytext(number=self.plot_value, number2=self.piechart_value)<font></font>
            self.menu = self.update_overlay_menu_haro_tf()<font></font>
            <font></font>
            self.text_pub.publish(self.overlaytext)<font></font>
            <font></font>
            self.plot_value_pub.publish(self.plot_value)<font></font>
            self.piechart_value_pub.publish(self.piechart_value)<font></font>
            <font></font>
            self.menu_publisher.publish(self.menu)<font></font>
            <font></font>
            self.rate.sleep()<font></font>
            self.counter += <span class="hljs-number">1</span><font></font>
  <font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dummy_overlay_demo</span>():</span>
    rospy.init_node(<span class="hljs-string">'distance_overlay_demo_node'</span>, anonymous=<span class="hljs-literal">True</span>)<font></font>
    haro_overlay_object = HaroOverlay()<font></font>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment">#haro_overlay_object.start_dummy_demo()</span><font></font>
        haro_overlay_object.start_harodistance_demo()<font></font>
    <span class="hljs-keyword">except</span> rospy.ROSInterruptException:
        <span class="hljs-keyword">pass</span><font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    dummy_overlay_demo()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреВрд╕рд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ </font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tf_haro_to_object_listener.py</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/env python</span>
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> rospy
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> tf
<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> Twist, Vector3<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    rospy.init_node(<span class="hljs-string">'tf_listener_haro_to_person'</span>)<font></font>
<font></font>
    listener = tf.TransformListener()<font></font>
<font></font>
    <span class="hljs-keyword">if</span> len(sys.argv) &lt; <span class="hljs-number">3</span>:<font></font>
        print(<span class="hljs-string">"usage: tf_haro_to_object_listener.py parent child"</span>)
    <span class="hljs-keyword">else</span>:<font></font>
        follower_model_name = sys.argv[<span class="hljs-number">1</span>]<font></font>
        model_to_be_followed_name = sys.argv[<span class="hljs-number">2</span>]<font></font>
        <font></font>
        topic_to_publish_name = <span class="hljs-string">"/"</span>+str(follower_model_name)+<span class="hljs-string">"_to_"</span>+str(model_to_be_followed_name)+<span class="hljs-string">"_tf_translation"</span>
        <span class="hljs-comment"># We will publish a Twist message but it's positional data not speed, just reusing an existing structure.</span>
        tf_translation = rospy.Publisher(topic_to_publish_name, Twist ,queue_size=<span class="hljs-number">1</span>)<font></font>
        <font></font>
        rate = rospy.Rate(<span class="hljs-number">10.0</span>)<font></font>
        ctrl_c = <span class="hljs-literal">False</span><font></font>
        <font></font>
        follower_model_frame = <span class="hljs-string">"/"</span>+follower_model_name<font></font>
        model_to_be_followed_frame = <span class="hljs-string">"/"</span>+model_to_be_followed_name<font></font>
        <font></font>
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdownhook</span>():</span>
            <span class="hljs-comment"># works better than the rospy.is_shut_down()</span>
            <span class="hljs-keyword">global</span> ctrl_c<font></font>
            ctrl_c = <span class="hljs-literal">True</span><font></font>
<font></font>
        rospy.on_shutdown(shutdownhook)<font></font>
        <font></font>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> ctrl_c:
            <span class="hljs-keyword">try</span>:<font></font>
                (trans,rot) = listener.lookupTransform(follower_model_frame, model_to_be_followed_frame, rospy.Time(<span class="hljs-number">0</span>))<font></font>
                translation_object = Vector3()<font></font>
                translation_object.x = trans[<span class="hljs-number">0</span>]<font></font>
                translation_object.y = trans[<span class="hljs-number">1</span>]<font></font>
                translation_object.z = trans[<span class="hljs-number">2</span>]<font></font>
                <font></font>
                angular = math.atan2(translation_object.y, translation_object.x)<font></font>
                linear = math.sqrt(translation_object.x ** <span class="hljs-number">2</span> + translation_object.y ** <span class="hljs-number">2</span>)<font></font>
                cmd = Twist()<font></font>
                cmd.linear.x = linear<font></font>
                cmd.angular.z = angular<font></font>
                tf_translation.publish(cmd)<font></font>
                <font></font>
            <span class="hljs-keyword">except</span> (tf.LookupException, tf.ConnectivityException, tf.ExtrapolationException):
                <span class="hljs-keyword">continue</span><font></font>
            rate.sleep()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЗрд╕ рддрд░рд╣ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ (рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЕрдиреНрдп рд╕рднреА рдореБрдЦреНрдп рдиреЛрдбреНрд╕ рдФрд░ rviz рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЪрд▓ рд░рд╣реЗ рд╣реИрдВ):</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot overlay_meny_my.launch<font></font>
python tf_haro_to_object_listener.py base_link map<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ base_link рдлреНрд░реЗрдо рдХреЗ рдХреЛрдг рдФрд░ рджреВрд░реА рдХреЛ рджреЗрдЦреЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╛рд░реА рд░рд╣рддреА рд╣реИред</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi502494/index.html">рдПрдХ рдмреНрд▓реИрдХ рдлреНрд░рд╛рдЗрдбреЗ рдХреА 7 рдЧрд▓рддрд┐рдпрд╛рдБ рдФрд░ рдореИрдЧреЗрдВрдЯреЛ рдХреНрд▓рд╛рдЙрдб рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ - рд╡реАрдбрд┐рдпреЛ</a></li>
<li><a href="../hi502496/index.html">ActiveX рд╕рд░реНрд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реИрдм рд╡реНрдпреВ VI PHP рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╕рд╛рди рд╡реЗрдм рдПрдХреНрд╕реЗрд╕</a></li>
<li><a href="../hi502498/index.html">C # рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рд╕реБрдзрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрднреНрдпрд╛рд╕</a></li>
<li><a href="../hi502500/index.html">рдПрдХ рдкрд╛рд╕рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░ рдХрд╛ рд╡рд┐рдХрд╛рд╕: рдкреНрд▓рд╛рдИрд╡реБрдб рд╢рд┐рд▓реНрдк рд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╡реНрдпрд╡рд╕рд╛рдп рддрдХ</a></li>
<li><a href="../hi502504/index.html">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдВрдХ рдХреЛ рдШреЗрд░реЗрдВ</a></li>
<li><a href="../hi502510/index.html">рдмрд╛рджрд▓ рдореЗрдВ рдХреНрдпрд╛ рдмрдЪрд╛</a></li>
<li><a href="../hi502512/index.html">рд╕реЛрдлреЗ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреА рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдХреЗ рдкрд░рд┐рдгрд╛рдо: рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдкреНрд░рд╣рд╛рд░ рдХреЗ рдирд┐рдпрдо</a></li>
<li><a href="../hi502518/index.html">рдкреЗрдбрд╝ рдкрд░ рдХреИрд╕реЗ рдЪрдврд╝реЗрдВрдЧреЗ</a></li>
<li><a href="../hi502520/index.html">рдЙрддреНрдкрд╛рдж рдПрдирд╛рд▓рд┐рдЯрд┐рдХреНрд╕ рдкрд░ рдорд┐рдЯрдк рд░рд┐рдкреЛрд░реНрдЯ рдХреА рд╡реАрдбрд┐рдпреЛ рд░рд┐рдкреЛрд░реНрдЯ</a></li>
<li><a href="../hi502554/index.html">рд╕рдВрдХрдЯ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреЗ рд░рд╛рд╕реНрддреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдордзреНрдп рд╕реВрдЪрдирд╛ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>