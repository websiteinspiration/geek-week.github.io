<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌂 👧🏽 🕺🏻 eBayがWebAssemblyでバーコードスキャナーを実行した方法 ☄️ 🙆🏿 🤫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="発表以来、WebAssemblyテクノロジーはすぐにフロントエンド開発者の注目を集めています。ウェブコミュニティは、ブラウザでJavaScript以外の言語で書かれたコードを実行するというアイデアを熱心に受け入れました。主なことは、WebAssemblyがJavaScriptよりもはるかに高い速度を...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>eBayがWebAssemblyでバーコードスキャナーを実行した方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453712/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">発表以来、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebAssembly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジーは</font><font style="vertical-align: inherit;">すぐにフロントエンド開発者の注目を集めています。ウェブコミュニティは、ブラウザでJavaScript以外の言語で書かれたコードを実行するというアイデアを熱心に受け入れました。主なことは、WebAssemblyがJavaScriptよりもはるかに高い速度を保証することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのエンジニアは、規格の開発を綿密に追跡しました。すべての主要なブラウザーにWebAssembly 1.0サポートが実装されるとすぐに、開発者たちはすぐにそれを試してみたかったのです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、問題がありました。が、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くのアプリケーション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebAssemblyのメリットはありますが、eコマースにおけるテクノロジーの範囲は未だに原始的です。</font><font style="vertical-align: inherit;">その使用の正しいバージョンをすぐに見つけることができませんでした。</font><font style="vertical-align: inherit;">いくつかの提案がありましたが、JavaScriptはすべてのバリエーションで優れていました。</font><font style="vertical-align: inherit;">eBayで新しいテクノロジーを評価するとき、最初の質問は「お客様にとっての潜在的なメリットは何ですか？」です。</font><font style="vertical-align: inherit;">ここが明確でない場合は、次のステップに進みません。</font><font style="vertical-align: inherit;">たとえ顧客にとって重要ではなく、既存のワークフローを複雑にするだけであっても、新しいファッショナブルなテクノロジーに夢中になるのは非常に簡単です。</font><font style="vertical-align: inherit;">ユーザーエクスペリエンスは常に開発者エクスペリエンスよりも重要です。</font><font style="vertical-align: inherit;">ただし、WebAssemblyの場合は異なります。</font><font style="vertical-align: inherit;">このテクノロジーには大きな可能性があり、適切なユースケースを見つけることができませんでした。</font><font style="vertical-align: inherit;">しかし、最終的には、まだ見つかりました。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーコードスキャナ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
iOSおよびAndroidのネイティブeBayアプリケーションには</font><font style="vertical-align: inherit;">、フォームへの自動入力用の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーコードスキャン機能</font><font style="vertical-align: inherit;">があります。これは、アプリケーションでのみ機能し、カメラからの画像ストリーム内のバーコード桁を認識するために、デバイスでの集中的な画像処理を必要とします。結果のコードはサーバーサービスに送信され、サーバーサービスがフォームに入力します。つまり、デバイスの画像処理ロジックは非常に効率的でなければなりません。ネイティブアプリケーションでは、独自のC ++ライブラリをiOSおよびAndroidのネイティブコードにコンパイルしました。バーコードを非常によく認識します。 iOSとAndroidでは徐々にネイティブAPIに移行していますが、C ++ライブラリは引き続き信頼できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バーコードスキャナーは販売者にとって直感的な機能であり、フォームへの入力を大幅に簡素化します。</font><font style="vertical-align: inherit;">残念ながら、この機能はサイトのモバイルバージョンでは機能せず、販売者は手動でUPCに入力する必要があり、不便です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webバーコードスキャナー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前は、ウェブ上でバーコードをスキャンするオプションを探していました。</font><font style="vertical-align: inherit;">2年前、彼らは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BarcodeReader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンJavaScriptライブラリに基づくプロトタイプをリリースしました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">問題は、ケースの20％でしかうまく機能しないことでした。</font><font style="vertical-align: inherit;">残りの80％の時間は、スキャナーの動作が非常に遅いか、まったく動作しませんでした。</font><font style="vertical-align: inherit;">ほとんどの場合、これはタイムアウトでした。</font><font style="vertical-align: inherit;">これは非常に期待されています。JavaScriptは、「ホットパス」上にある場合、つまり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">JITが</font></a><font style="vertical-align: inherit;">高度に最適化されている場合にのみ、ネイティブコードと速度を比較できます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-コンパイラ。トリックは、JavaScriptエンジンが多数のヒューリスティックを使用して、結果を保証せずにパスがホットかどうかを判断することです。この不一致は明らかにユーザーの不満につながり、この機能を無効にする必要がありました。しかし、今はすべてが異なります。 Webプラットフォームの急速な発展に伴い、「Webに信頼性の高いバーコードスキャナーを実装することは可能ですか？」という疑問が生じました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのオプションは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shape Detection API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を含む組み込みの画像検出機能で</font><font style="vertical-align: inherit;">終了</font><font style="vertical-align: inherit;">するの</font><font style="vertical-align: inherit;">を待つことです</font><font style="vertical-align: inherit;">。しかし、これらのインターフェースはまだ開発のごく初期の段階にあり、ブラウザー間の互換性にはほど遠いものです。この場合でも、</font><font style="vertical-align: inherit;">すべてのプラットフォームでの動作</font><font style="vertical-align: inherit;">が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保証されて</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いる</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">わけで</font></a><font style="vertical-align: inherit;">はあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ません</font></a><font style="vertical-align: inherit;">。したがって、他のオプションを検討する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがWebAssemblyの出番です。</font><font style="vertical-align: inherit;">バーコードスキャナーがWebAssemblyに実装されている場合、その動作は保証されています。</font><font style="vertical-align: inherit;">WebAssemblyの強力な型指定とバイトコード構造により、実行の「ホットパス」を常に維持できます。</font><font style="vertical-align: inherit;">さらに、ネイティブアプリケーション用のC ++ライブラリがすでにあります。</font><font style="vertical-align: inherit;">C ++ライブラリは、WebAssemblyでのコンパイルの理想的な候補です。</font><font style="vertical-align: inherit;">問題は解決したと思った。</font><font style="vertical-align: inherit;">実際にはそうではありませんでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建築</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebAssemblyのバーコードスキャナーのプロトタイプアーキテクチャは非常にシンプルでした。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emscriptenで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C ++ライブラリをコンパイルし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ミドルウェアと.wasmファイルが生成されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メインスレッドから</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワーカー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スレッド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">選択し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ワーカーのJavaScriptコードは、生成されたJavaScriptリンクコードをインポートし、次に.wasmファイルを作成します。</font></font><br>
</li>
<li>          ,     WASM API   .  API    .     UPC (  )   ,  -  .<br>
</li>
<li>        ,     -.          .    ,     <i>«  .   -    »</i>.        -,    .     -     .</li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/50e/08c/b99/50e08cb9985f38e32a51caefe0a0356d.png"></div><br>
<i><font color="gray">  WebAssembly</font></i><br>
<br>
<h4></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebAssemblyプロジェクトの最初のステップは、明確なコンパイルパイプラインを定義することです。 Emscriptenは、WebAssemblyをコンパイルするための事実上の標準になっていますが、確定的な結果を生成する一貫した環境を用意することが重要です。フロントエンドはNode.jsに基づいているため、npmワークフローと互換性のあるソリューションを見つける必要があります。幸い、この頃、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surma Das </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は「Emscripten and npm」と呼ばれる</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事を公開しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">WebAssemblyをコンパイルするため</font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベースのアプローチは</font><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">大量</font></a><font style="vertical-align: inherit;">のオーバーヘッドを排除するため、理にかなっています。記事で推奨されているように、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">trzeci</font></a><font style="vertical-align: inherit;">から</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emscripten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のドッカー</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">画像</font></a><font style="vertical-align: inherit;">を取得しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">WebAssemblyでコンパイルを有効にするには、ネイティブC ++ライブラリを少し調整する必要がありました。</font><font style="vertical-align: inherit;">基本的に、私たちはランダムに試行錯誤して行動しました。</font><font style="vertical-align: inherit;">結局、なんとかそれをコンパイルし、既存のアセンブリパイプライン内にきちんとしたWebAssemblyワークフローをセットアップすることもできました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それは速く動作しますが...</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキャナーのパフォーマンスは、Wasm APIによって1秒間に処理されるフレームの数で測定されます。</font><font style="vertical-align: inherit;">Wasm APIは、カメラのビデオストリームからフレームを取得し、計算を実行して、応答を返します。</font><font style="vertical-align: inherit;">これは、バーコードが検出されるまで継続的に行われます。</font><font style="vertical-align: inherit;">パフォーマンスはFPSで測定されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebAssemblyのテスト実装は、50 FPSという驚くべき速度を示しました。ただし、これは60％の場合にのみ機能し、残りの場合はタイムアウトによってクラッシュしました。このような高いFPSを使用しても、残りの40％のスキャンのバーコードをすばやく検出できず、最後に警告メッセージが表示されました。比較のために、以前のJavaScript実装は通常1 FPSの速度で動作しました。はい、WebAssemblyははるかに高速です（50倍）が、何らかの理由でほとんどの場合で機能しません。また、状況によっては、JavaScriptが非常にうまく機能し、すぐにバーコードが検出されたことにも注意してください。明らかなオプションの1つはタイムアウトを増やすことでしたが、これはユーザーの不満を増やすだけなので、実際の問題は解決しません。したがって、このアイデアを放棄しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初は、ネイティブアプリケーションで完全に機能するネイティブC ++ライブラリがWebで同じ結果を示さなかった理由を理解できませんでした。長いテストとデバッグの結果、認識速度はオブジェクトの焦点角度と背景の影に依存することがわかりました。しかし、すべてがネイティブアプリケーションでどのように機能するのでしょうか。実際のところ、ネイティブアプリケーションでは、組み込みのAPIをオートフォーカスに使用し、バーコードに指を置いて手動でフォーカスする機会をユーザーに提供しています。したがって、ネイティブアプリケーションは常にライブラリに高品質の鮮明な画像を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が起こっているのかという本質に気づき、別のネイティブライブラリを試すことにしました。かなり人気があり、安定した</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ZBar</font></a><font style="vertical-align: inherit;">バーコードスキャナーです。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンソース。</font><font style="vertical-align: inherit;">さらに重要なのは、ぼやけて粒子の粗い画像でうまく機能することです。</font><font style="vertical-align: inherit;">試してみませんか？</font><font style="vertical-align: inherit;">すでにWebAssemblyワークフローがあったため、WebAssemblyでのZBarのコンパイルとデプロイメントはスムーズに行われました。</font><font style="vertical-align: inherit;">パフォーマンスはまあまあで、約15 FPSでしたが、独自のC ++ライブラリほどではありませんでした。</font><font style="vertical-align: inherit;">しかし、同じタイムアウトでの成功率は80％近くでした。</font><font style="vertical-align: inherit;">C ++ライブラリを明らかに改善しましたが、それでも100％ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果はまだ満足できませんでしたが、予期しないことに気づきました。</font><font style="vertical-align: inherit;">Zbarがクラッシュした場合、独自のC ++ライブラリが非常に迅速に機能しました。</font><font style="vertical-align: inherit;">嬉しい驚きでした。</font><font style="vertical-align: inherit;">図書館はさまざまな方法でさまざまな品質の画像を処理したようです。</font><font style="vertical-align: inherit;">これは私たちにアイデアを導いた。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチスレッドとスピードレース</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたはおそらくすでに理解しています。 2つのワーカースレッドを作成しないでください。1つはZbar用で、もう1つはC ++ライブラリ用で、並列に実行しないでください。勝った人（最初に有効なバーコードを送信した人）が結果をメインストリームに送信し、両方のワーカーが停止します。私たちはそのようなシナリオを実装し、できるだけ多くのシナリオをシミュレートしようとして、自分自身をテストし始めました。この設定は、成功したスキャンの95％を示しています。以前の結果よりはるかに良いですが、それでも100％ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奇妙な提案の1つは、元のJavaSciptライブラリを競争に追加することでした。</font><font style="vertical-align: inherit;">3つのストリームになります。</font><font style="vertical-align: inherit;">正直に言って、これが何かを変えるとは思いませんでした。</font><font style="vertical-align: inherit;">しかし、このようなテストでは作業インターフェースを標準化したので、何もする必要はありませんでした。</font><font style="vertical-align: inherit;">驚いたことに、3つのストリームにより、成功率は本当に100％に近づきました。</font><font style="vertical-align: inherit;">これもまたまったく予想外でした。</font><font style="vertical-align: inherit;">前述したように、JavaScriptはいくつかの状況で非常にうまく機能しました。</font><font style="vertical-align: inherit;">どうやら、彼はギャップを埋めました。</font><font style="vertical-align: inherit;">そのため、法律でよく知られているのは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「JavaScriptは常に勝つ」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">ジョークがない場合、次の図は、実装した最終的なアーキテクチャの概要を示しています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/422/f91/050/422f9105014e7571197453c7d2c9f6ec.png"></div><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーコードスキャナーのWebアーキテクチャ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次の図は、高レベルの機能図を示しています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a6/a74/005/4a6a740059f1599e759d9641a3251233.png"></div><br>
<i><font color="gray">   -</font></i><br>
<br>
<h4>   </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキャナーが動作するために必要なリソースは、メインページのレンダリング後にプリロードされます。このようにして、ランディングページはすばやく読み込まれ、対話の準備ができています。 WebAssemblyリソース（wasmファイルとミドルウェアスクリプト）とJavaScriptスキャナーライブラリは</font><font style="vertical-align: inherit;">、メインページのロード後に</font><font style="vertical-align: inherit;">、プリロードされ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XMLHttpRequest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してキャッシュされ</font><font style="vertical-align: inherit;">ます。ここでは、ユーザーがページを操作できるようにメインスレッドを空けておくために、それらがすぐに実行されないことが重要です。実行は、ユーザーがバーコードアイコンをクリックしたときにのみ発生します。ユーザーがリソースをロードする前にアイコンをクリックした場合、それらはオンデマンドでロードされ、すぐに実行されます。バーコードスキャナーのイベントハンドラーとワーカーコントローラーにページが読み込まれますが、非常に小さいです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
従業員による徹底的なテストと内部使用の後、私たちはユーザーに対してA / Bテストを開始しました。</font><font style="vertical-align: inherit;">スキャナーアイコン（下のスクリーンショット）はテストグループに表示されましたが、コントロールグループには表示されませんでした。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/a30/074/bb5a300749c27008137e8f45c9bdced9.png"></div><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終製品</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
成功を測定するために、ドラフト完了率メトリックを導入しました。</font><font style="vertical-align: inherit;">下書きの編集を開始してからフォームを送信するまでの時間です。</font><font style="vertical-align: inherit;">この指標は、バーコードスキャナーがフォームの入力にどのように役立つかを示す必要があります。</font><font style="vertical-align: inherit;">テストは数週間続き、結果は非常に快適でした。</font><font style="vertical-align: inherit;">彼らは私たちの元の仮説と完全に一致しています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーコードスキャナーを使用したスト​​リームのドラフト完了時間は30％減少しました。</font></font></b><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c7f/f62/177/c7ff62177f92bc9f19059c569f2531ed.png"></div><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A / Bテスト結果</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
すべてのタイプのスキャナーの有効性を評価するためのプロファイリングも追加しました。</font><font style="vertical-align: inherit;">予想どおり、最大の貢献はZbar（成功したスキャンの53％）、次にC ++ライブラリ（34％）、最後に13％のJavaScriptライブラリによって行われました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a31/359/c5c/a31359c5c4211bf10548d8162370da89.png"></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebAssemblyの実装経験は、私たちにとって非常に有益なものになりました。エンジニアは新しいテクノロジーの出現に非常に満足しており、すぐに試してみたいと思っています。このテクノロジーが顧客にとっても有用である場合、これは二重の喜びです。記事の冒頭で述べた考えを繰り返しましょう。テクノロジーは非常に速いペースで発展しています。毎日何か新しいものが現れます。しかし、顧客にとって重要なテクノロジーはごくわずかであり、WebAssemblyもその1つです。この演習からの最大の結論は、99の状況では「いいえ」、クライアントにとって本当に重要な場合のみ「はい」と言うことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今後、バーコードスキャナーの利用を拡大し、購入者側に導入して、eBayで検索して購入するためにオフラインで製品コードをスキャンできるようにする予定です。</font><font style="vertical-align: inherit;">ブラウザでShape Detection APIやその他の関数を使用して関数を拡張することも検討します。</font><font style="vertical-align: inherit;">しかし、eBayでのWebAssemblyの適切な使用事例を見つけ、eコマースでこのテクノロジーをうまく適用できたことを嬉しく思います。</font><font style="vertical-align: inherit;">WebAssemblyに関する多数の記事を提供して</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
くれたSurma Dasと</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lin Clarkに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特に感謝し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">彼らは本当に私たちが何度かデッドロックを打開するのを助けました。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453698/index.html">量子意識における量子情報</a></li>
<li><a href="../ja453700/index.html">SDL 2のレッスン：レッスン1-こんにちは、SDL 2</a></li>
<li><a href="../ja453706/index.html">Google Cloud Professional Data Engineer認定試験に合格した方法</a></li>
<li><a href="../ja453708/index.html">BASCOM AVR環境のMK AVR用AQUA RTOSリアルタイムOS</a></li>
<li><a href="../ja453710/index.html">大規模プロジェクトでの開発実践：mitap SberPractice iOS＃1</a></li>
<li><a href="../ja453714/index.html">TON（Telegram Open Network）テストクライアントとスマートコントラクト用の新しいFift言語</a></li>
<li><a href="../ja453716/index.html">家族のIT担当者のための国のコワーキング-誰かいますか？</a></li>
<li><a href="../ja453720/index.html">Cでのラムダ式の微妙さ＃</a></li>
<li><a href="../ja453722/index.html">非定常プロセスの研究について</a></li>
<li><a href="../ja453728/index.html">ハイパースターの戦い</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>