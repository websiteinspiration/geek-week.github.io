<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêò ‚öóÔ∏è üîÆ D√©tails d'impl√©mentation du protocole de synchronisation temporelle PTPv2 üïç üë®üèæ‚Äçüç≥ ‚õàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction
 
 Le concept de construction d'une ¬´sous-station num√©rique¬ª dans l'industrie de l'√©nergie √©lectrique n√©cessite une synchronisation avec ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>D√©tails d'impl√©mentation du protocole de synchronisation temporelle PTPv2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/phoenix_contact/blog/495920/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le concept de construction d'une ¬´sous-station num√©rique¬ª dans l'industrie de l'√©nergie √©lectrique n√©cessite une synchronisation avec une pr√©cision de 1 Œºs. </font><font style="vertical-align: inherit;">Les transactions financi√®res n√©cessitent √©galement une pr√©cision en microsecondes. </font><font style="vertical-align: inherit;">Dans ces applications, la pr√©cision du temps NTP n'est plus suffisante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le protocole de synchronisation PTPv2, d√©crit par la norme IEEE 1588v2, permet une pr√©cision de synchronisation de plusieurs dizaines de nanosecondes. </font><font style="vertical-align: inherit;">PTPv2 vous permet d'envoyer des paquets de synchronisation sur les r√©seaux L2 et L3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les principaux domaines d'utilisation de PTPv2 sont:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ing√©nierie √©lectrique;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©quipement de contr√¥le et de mesure;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complexe militaro-industriel;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telecom</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secteur financier.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article examine le fonctionnement du protocole de synchronisation PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons plus d'exp√©rience dans l'industrie et nous rencontrons souvent ce protocole dans les applications √©nerg√©tiques. En cons√©quence, nous ferons l'examen avec un ≈ìil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur l'√©nergie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi est-ce n√©cessaire?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Actuellement, STO 34.01-21-004-2019 de PJSC Rosseti et STO 56947007-29.240.10.302-2020 de PJSC FGC UES contiennent des exigences pour l'organisation d'un bus de processus avec synchronisation temporelle via PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela est d√ª au fait que les bornes de protection des relais et les appareils de mesure sont connect√©s au bus de processus, qui transmettent des valeurs instantan√©es de courant et de tension √† l'aide des flux dits SV (flux de multidiffusion) via le bus de processus.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les terminaux de protection de relais utilisent ces valeurs pour impl√©menter la protection de connexion. Si la pr√©cision des mesures dans le temps est faible, certaines protections peuvent fonctionner de mani√®re erron√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, la protection de la s√©lectivit√© absolue peut devenir victime d'une synchronisation temporelle ¬´faible¬ª. Souvent, la logique de ces d√©fenses est bas√©e sur une comparaison de deux valeurs. Si les valeurs divergent vers une valeur suffisamment grande, la protection est d√©clench√©e. Si ces valeurs sont mesur√©es avec une pr√©cision de 1 ms, vous pouvez obtenir une grande diff√©rence l√† o√π les valeurs sont r√©ellement normales, si vous les mesurez avec une pr√©cision de 1 Œºs. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versions PTP</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le protocole PTP a √©t√© d√©crit √† l'origine en 2002 dans la norme IEEE 1588-2002 et √©tait appel√© ¬´Norme pour un protocole de synchronisation d'horloge de pr√©cision pour les syst√®mes de mesure et de contr√¥le en r√©seau¬ª. </font><font style="vertical-align: inherit;">En 2008, la norme IEEE 1588-2008 mise √† jour, qui d√©crit la version 2 du PTP, a √©t√© publi√©e. Dans cette version du protocole, la pr√©cision et la stabilit√© ont √©t√© am√©lior√©es, mais la compatibilit√© descendante avec la premi√®re version du protocole n'a pas √©t√© maintenue. </font><font style="vertical-align: inherit;">De plus, en 2019, une version de la norme IEEE 1588-2019 a √©t√© publi√©e qui d√©crit PTP v2.1. </font><font style="vertical-align: inherit;">Cette version ajoute des am√©liorations mineures √† PTPv2 et est r√©trocompatible avec PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En d'autres termes, nous avons l'image suivante avec les versions:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2002)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2008)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv2.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(IEEE 1588-2019)</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PTPv1 (IEEE 1588-2002)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incompatible</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incompatible</font></font><br>
</td>
</tr>
<tr>
<td>PTPv2 (IEEE 1588-2008)<br>
</td>
<td><br>
</td>
<td> ‚Äî </td>
<td><br>
</td>
</tr>
<tr>
<td>PTPv2.1 (IEEE 1588-2019)<br>
</td>
<td><br>
</td>
<td><br>
</td>
<td> ‚Äî </td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, comme toujours, il y a des nuances. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'incompatibilit√© entre PTPv1 et PTPv2 sugg√®re qu'un appareil prenant en charge PTPv1 ne pourra pas se synchroniser √† partir de l'horloge exacte ex√©cut√©e sur PTPv2. Ils utilisent diff√©rents formats de message pour la synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vous pouvez toujours combiner des appareils avec PTPv1 et des appareils avec PTPv2 sur le m√™me r√©seau. Pour ce faire, certains fabricants vous permettent de s√©lectionner la version du protocole sur les ports de l'horloge frontali√®re. Autrement dit, l'horloge limite peut √™tre synchronis√©e via PTPv2 et en m√™me temps synchroniser d'autres horloges qui lui sont connect√©es √† la fois par PTPv1 et PTPv2. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appareils PTP. Quels sont et comment diff√®rent-ils?</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La norme IEEE 1588v2 d√©crit plusieurs types de p√©riph√©riques. Tous sont donn√©s dans le tableau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les appareils communiquent entre eux via LAN en utilisant PTP.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les appareils PTP sont appel√©s horloges. </font><font style="vertical-align: inherit;">Toutes les montres prennent l'heure exacte de la montre grand ma√Ætre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe 5 types de montres:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horloge grand ma√Ætre</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La principale source de temps pr√©cis. </font><font style="vertical-align: inherit;">Souvent √©quip√© d'une interface de connexion GPS.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horloge ordinaire</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un p√©riph√©rique √† port unique qui peut √™tre un ma√Ætre (horloge ma√Ætre) ou un esclave (horloge ma√Ætre)</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heures d'ouverture (ma√Ætre)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ils sont √† l'origine de l'heure exacte √† laquelle les autres horloges sont synchronis√©es.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horloge esclave (esclave)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le p√©riph√©rique final qui se synchronise depuis l'horloge ma√Ætre</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horloge fronti√®re</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un p√©riph√©rique avec plusieurs ports, qui peut √™tre un ma√Ætre ou un esclave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, cette montre peut se synchroniser √† partir d'une horloge ma√Ætre sup√©rieure et synchroniser une horloge esclave inf√©rieure.</font></font><br>
</td>
</tr>
<tr>
<td>End-to-end Transparent Clock ( ,    End-to-End)<br>
</td>
<td>   ,      ,  .    PTP   . <br>
<br>
       PTP-. <br>
<br>
                .<br>
 </td>
</tr>
<tr>
<td>Peer-to-Peer Transparent Clock ( ,    Peer-to-Peer)<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un p√©riph√©rique avec plusieurs ports qui n'est ni une horloge ma√Ætre ni un esclave. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il transmet les donn√©es PTP entre deux heures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la transmission de donn√©es, l'horloge transparente corrige tous les messages PTP Sync et Follow_Up (plus d'informations √† leur sujet sont d√©crites ci-dessous). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La correction est obtenue en ajoutant au champ de l'ajustement du paquet de retard transmis sur le dispositif √©metteur et du retard sur le canal de donn√©es.</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noeud de gestion</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un appareil qui configure et diagnostique d'autres montres</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les horloges ma√Ætre et esclave sont synchronis√©es √† l'aide d'horodatages dans les messages PTP. </font><font style="vertical-align: inherit;">Il existe deux types de messages dans le protocole PTP:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les messages d'√©v√©nement sont des messages synchronis√©s qui impliquent la g√©n√©ration d'un horodatage au moment o√π un message est envoy√© et au moment o√π il est re√ßu.</font></font></li>
<li>General Messages ‚Äì      ,        </li>
</ul><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td>Event Messages<br>
</td>
<td>General Messages<br>
</td>
</tr>
<tr>
<td>Sync<br>
Delay_Req<br>
Pdelay_Req<br>
Pdelay_Resp<br>
</td>
<td>Announce<br>
Follow_Up<br>
Delay_Resp<br>
Pdelay_Resp_Follow_Up<br>
Management<br>
Signaling<br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous examinerons plus en d√©tail tous les types de messages. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principaux probl√®mes de synchronisation</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lors de la transmission d'un paquet de synchronisation via un r√©seau local, il est retard√© sur le commutateur et dans le canal de transmission de donn√©es. </font><font style="vertical-align: inherit;">Tout commutateur donnera un retard d'environ 10 Œºs, ce qui est inacceptable pour PTPv2. </font><font style="vertical-align: inherit;">Apr√®s tout, nous devons obtenir une pr√©cision de 1 Œºs sur le dispositif final. </font><font style="vertical-align: inherit;">(C'est quand il s'agit d'√©nergie. D'autres applications peuvent n√©cessiter plus de pr√©cision.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IEEE 1588v2 d√©crit plusieurs algorithmes de fonctionnement qui vous permettent d'enregistrer le retard et de le r√©gler. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithme op√©rationnel</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En fonctionnement normal, le protocole fonctionne en deux phases.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase 1 - Etablissement de la hi√©rarchie "Horloge Principale - Horloge Esclave".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase 2 - synchronisation d'horloge √† l'aide du m√©canisme de bout en bout ou de pair √† pair.</font></font></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase 1 - Configuration de la hi√©rarchie ma√Ætre esclave</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Chaque port d'une horloge r√©guli√®re ou limite a un certain nombre d'√©tats (horloge esclave et horloge ma√Ætre). La norme d√©crit l'algorithme de transition entre ces √©tats. En programmation, un tel algorithme est appel√© une machine d'√©tat ou une machine d'√©tat (plus sur le Wiki). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette machine d'√©tat utilise le meilleur algorithme d'horloge ma√Ætre (BMCA) pour d√©finir le ma√Ætre lorsque deux heures sont connect√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet algorithme permet √† la montre d'assumer les obligations d'une montre grand ma√Ætre, lorsqu'une montre grand ma√Ætre sup√©rieure perd son signal GPS, se d√©connecte du r√©seau, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les transitions d'√©tat conform√©ment √† BMCA sont bri√®vement illustr√©es dans le diagramme suivant:</font></font><br>
<img src="https://habrastorage.org/webt/uy/hz/h6/uyhzh63gb0jt63bppsuuhcllwmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des informations sur l'horloge √† l'autre extr√©mit√© du ¬´fil¬ª sont envoy√©es dans un message sp√©cial (message d'annonce). </font><font style="vertical-align: inherit;">Lorsque ces informations sont re√ßues, l'algorithme de la machine √† √©tats traite et compare quelle horloge est meilleure. </font><font style="vertical-align: inherit;">Le port des meilleures montres devient la montre leader. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une hi√©rarchie simple est pr√©sent√©e dans le diagramme ci-dessous. </font><font style="vertical-align: inherit;">Les chemins 1, 2, 3, 4, 5 peuvent contenir une horloge transparente (horloge transparente), mais ils ne participent pas √† l'√©tablissement de la hi√©rarchie "Horloge de t√™te - Horloge esclave". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kj/md/ci/kjmdcibg-ls2rflwu6qtur-0osg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phase 2 - Synchronisation d'une horloge normale et d'une horloge limite</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Imm√©diatement apr√®s l'√©tablissement de la hi√©rarchie ¬´Heures de pointe - Heures esclaves¬ª, la phase de synchronisation d'une horloge r√©guli√®re et limite commence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la synchronisation, l'horloge ma√Ætre envoie un message contenant un horodatage √† l'horloge esclave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les heures d'ouverture peuvent √™tre:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en une seule √©tape;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en deux √©tapes.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une horloge √† une √©tape pour la synchronisation envoie un message de synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une horloge √† deux √©tages utilise deux messages pour la synchronisation - Sync et Follow_Up. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deux m√©canismes peuvent √™tre utilis√©s pour la phase de synchronisation:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canisme de demande-r√©ponse diff√©r√©e.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canisme de mesure du d√©lai entre pairs.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, nous consid√©rerons ces m√©canismes dans le cas le plus simple - lorsque les montres transparentes ne sont pas utilis√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√©canisme de demande-r√©ponse diff√©r√©e </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le m√©canisme comporte deux √©tapes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure du retard de transmission d'un message entre une horloge ma√Ætre et un esclave. </font><font style="vertical-align: inherit;">Elle est effectu√©e √† l'aide du m√©canisme de demande-r√©ponse de retard.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corrige le d√©calage de l'heure exacte.</font></font></li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delay Measurement</font></font></i><br>
<img src="https://habrastorage.org/webt/zj/hp/sa/zjhpsak259vihrylfiujf5vj2sm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
t1 - Heure d'envoi du message de synchronisation par l'horloge principale; t2 - Temps de r√©ception du message de synchronisation par horloge esclave; t3 - Temps d'envoi de la demande de retard (Delay_Req) ‚Äã‚Äãpar heures esclaves; t4 - Temps de r√©ception Delay_Req par l'horloge de t√™te. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque l'horloge esclave conna√Æt l'heure t1, t2, t3 et t4, elle peut calculer le retard moyen de transmission du message de synchronisation (tmpd). Il est calcul√© comme suit: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e6/cz/qx/e6czqxjr1wen8eld_z4y16joa4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la transmission d'un message Sync and Follow_Up, la temporisation du ma√Ætre √† l'esclave est calcul√©e - t-ms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la transmission des messages Delay_Req et Delay_Resp, le retard de l'esclave au ma√Ætre, t-sm, est calcul√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si une asym√©trie se produit entre ces deux valeurs, une erreur appara√Æt dans la correction du d√©part de l'heure exacte. L'erreur est due au fait que le retard calcul√© est la moyenne des retards t-ms et t-sm. Si les retards ne sont pas √©gaux, nous ajusterons l'heure de mani√®re inexacte. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correction du d√©calage de l'heure exacte Une fois</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
le d√©lai entre l'horloge de t√™te et l'horloge esclave connu, l'horloge esclave effectue la correction de l'heure. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/gv/qz/a7gvqzykdjxtg6nm5rcqhcqmyzs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'horloge esclave utilise le message Sync et le message Follow_Up facultatif pour calculer le d√©calage horaire exact lors de la transmission du paquet de l'horloge ma√Ætre √† l'esclave. Le d√©calage est calcul√© √† l'aide de la formule suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/rk/nw/n1rknwzr-r0qio-uf1a9iiqd_9o.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©canisme de mesure du d√©lai entre pairs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ce m√©canisme utilise √©galement deux √©tapes pour se synchroniser:</font></font><br>
<br>
<ol>
<li>         .     peer delay mechanism.</li>
<li>   .</li>
</ol><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure du d√©lai</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
poste √† poste </font><i><font style="vertical-align: inherit;">Le d√©lai entre</font></i><font style="vertical-align: inherit;"> les </font><i><font style="vertical-align: inherit;">appareils compatibles poste √† poste</font></i><font style="vertical-align: inherit;"> est mesur√© √† l'aide des messages suivants: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eo/0o/y2/eo0oy26vhwksm1rel2znic_q8rs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque le port 1 conna√Æt les heures t1, t2, t3 et t4, il peut calculer le d√©lai moyen (tmld ) Il est calcul√© √† l'aide de la formule suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a6/3r/mc/a63rmc4ehosk81dvktfv4prevt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le port utilise cette valeur pour calculer le champ d'ajustement pour chaque message Sync ou message Follow_Up facultatif qui passe par ce p√©riph√©rique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le retard total sera √©gal √† la somme du retard pendant la transmission via cet appareil, du retard moyen pendant la transmission via le canal de donn√©es et du retard d√©j√† contenu dans ce message, inclus sur les appareils sup√©rieurs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les messages Pdelay_Req, Pdelay_Resp et Pdelay_Resp_Follow_Up en option vous permettent d'obtenir un retard du ma√Ætre √† l'esclave et de l'esclave au ma√Ætre (circulaire). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toute asym√©trie entre ces deux valeurs introduira une erreur de correction de d√©calage temporel pr√©cise. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Correction du d√©calage de l'heure exacte L'</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/m6/do/ku/m6dokuldnfjmqscwyrtin2tvjiu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
horloge esclave utilise le message Sync et le message Follow_Up facultatif pour calculer le d√©calage de l'heure exacte lors de la transmission du paquet de l'horloge de t√™te √† l'esclave. Le d√©calage est calcul√© selon la formule suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/ui/xk/ubuixkpfmzizo7ilzkdgyfwvh8c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avantages ajustement poste √† poste - le retard de chaque message Sync ou Follow_Up est calcul√© lors de sa transmission sur le r√©seau. Par cons√©quent, une modification du trajet de transmission n'affectera en aucune fa√ßon la pr√©cision du r√©glage.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'utilisation de ce m√©canisme, la synchronisation temporelle ne n√©cessite pas le calcul de la temporisation sur le chemin parcouru par le paquet de synchronisation, comme cela se fait avec un √©change de base. Ceux. Les messages Delay_Req et Delay_Resp ne sont pas envoy√©s. Dans cette m√©thode, le retard entre l'horloge ma√Ætre et les suiveurs est simplement additionn√© dans le champ de r√©glage de chaque message Sync ou Follow_Up. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre avantage est que l'horloge de conduite est d√©charg√©e de la n√©cessit√© de traiter les messages Delay_Req. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modes de fonctionnement des montres transparentes En</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
cons√©quence, des exemples simples ont √©t√© examin√©s. Supposons maintenant que des commutateurs apparaissent sur le chemin de synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous utilisez des commutateurs sans prise en charge PTPv2, le paquet de synchronisation sera retard√© d'environ 10 Œºs sur le commutateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les commutateurs prenant en charge PTPv2 dans la terminologie IEEE 1588v2 sont appel√©s horloges transparentes. </font><font style="vertical-align: inherit;">L'horloge transparente n'est pas synchronis√©e √† partir de l'horloge de t√™te et ne participe pas √† la hi√©rarchie "Horloge de t√™te - Horloge esclave", mais lors de la transmission des messages de synchronisation, ils se souviennent du retard du message par eux. </font><font style="vertical-align: inherit;">Cela vous permet de r√©gler la temporisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une montre transparente peut fonctionner selon deux modes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De bout en bout.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D'√©gal √† √©gal.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De bout en bout (E2E) La</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/cb/ev/vy/cbevvyylfmfgq9jgwm_jiuxvkjw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
montre transparente E2E transmet les messages Sync et les messages Follow_Up qui l'accompagnent √† tous les ports. M√™me ceux qui sont bloqu√©s par des protocoles (par exemple, RSTP). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le commutateur se souvient de l'horodatage lorsque le paquet de synchronisation (Follow_Up) a √©t√© re√ßu sur le port et lorsqu'il a √©t√© envoy√© depuis le port. Sur la base de ces deux horodatages, le temps de traitement du commutateur pour le message est calcul√©. Dans la norme, ce temps est appel√© temps de r√©sidence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le temps de traitement est ajout√© au champ correctionField du message Sync (horloge √† une √©tape) ou Follow_Up (horloge √† deux √©tapes).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/4q/rj/hv4qrjcuzer2hejocmtzitnntma.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La montre transparente E2E mesure le temps de traitement des messages Sync et Delay_Req passant par le commutateur. Mais il est important de comprendre que le retard entre l'horloge de t√™te et l'horloge esclave est calcul√© √† l'aide du m√©canisme de demande-r√©ponse de retard. Si l'horloge ma√Ætre change ou si le chemin de l'horloge ma√Ætre √† l'esclave change, le retard est √† nouveau mesur√©. Cela augmente le temps de transition en cas de changement de r√©seau. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sw/im/q7/swimq7rpv2n24wyd8erbsvf420s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'horloge P2P transparente, en plus de mesurer le temps de traitement du message par le commutateur, mesure le retard sur le canal de donn√©es au voisin le plus proche en utilisant le m√©canisme de mesure du retard du n≈ìud voisin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le retard est mesur√© sur chaque canal dans les deux sens, y compris les canaux qui sont bloqu√©s par un protocole (par exemple, RSTP). </font><font style="vertical-align: inherit;">Cela vous permet de calculer imm√©diatement un nouveau retard sur le chemin de synchronisation si l'horloge grand ma√Ætre ou la topologie du r√©seau a chang√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le temps de traitement du commutateur et le temps de retard sont accumul√©s lors de la transmission des messages Sync ou Follow_Up. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types de prise en charge des commutateurs PTPv2 Les</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
commutateurs peuvent prendre en charge PTPv2:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par programme;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mat√©riel.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'impl√©mentation logicielle du protocole PTPv2, le commutateur demande un horodatage au micrologiciel. </font><font style="vertical-align: inherit;">Le probl√®me est que le micrologiciel fonctionne de fa√ßon cyclique, et vous devez attendre qu'il termine le cycle en cours, prendre la demande en traitement et apr√®s l'expiration du cycle suivant, il √©mettra un horodatage. </font><font style="vertical-align: inherit;">Tout cela prendra √©galement du temps et nous obtiendrons un retard, bien que moins important que sans le support logiciel PTPv2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seul le support mat√©riel pour PTPv2 vous permet de maintenir la pr√©cision n√©cessaire. </font><font style="vertical-align: inherit;">Dans ce cas, l'√©mission de l'horodatage est effectu√©e par un ASIC sp√©cial, qui est install√© sur le port. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format des messages</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tous les messages PTP se composent des champs suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En-t√™te - 34 octets.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corps - la taille d√©pend du type de message.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suffixe - facultatif.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ae/9l/_3/ae9l_3mph3pkhb-2oi0h_ppy48u.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En-t√™te</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le champ </font><b><font style="vertical-align: inherit;">En-t√™te</font></b><font style="vertical-align: inherit;"> est le m√™me pour tous les messages PTP. Sa taille est de 34 octets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le format du </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/xs/gu/yuxsgundgrz9iyiyyfabaxt5i38.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">champ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Header: </font><b><font style="vertical-align: inherit;">messageType</font></b><font style="vertical-align: inherit;"> est le type du message transmis, par exemple Sync, Delay_Req, PDelay_Req, etc. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageLength</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - contient la taille compl√®te du message PTP, y compris l'en-t√™te, le corps et le suffixe (mais √† l'exclusion des octets de remplissage). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domainNumber</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - D√©termine √† quel domaine PTP le message appartient. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un domaine</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est compos√© de quelques horloges diff√©rentes assembl√©es en un groupe logique et synchronis√©es √† partir d'une horloge principale, mais pas n√©cessairement synchronis√©es avec une horloge appartenant √† un autre domaine. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">drapeaux</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce champ contient divers drapeaux pour identifier l'√©tat du message. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correctionField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- contient le temps de retard en nanosecondes. Le temps de retard comprend le retard de transmission √† travers l'horloge transparente, ainsi que le retard de transmission √† travers le canal lors de l'utilisation du mode Peer-to-Peer. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourcePortIdentity</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce champ contient des informations sur le port √† partir duquel ce message a √©t√© envoy√© √† l'origine. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequenceID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - contient le num√©ro d'identification des messages individuels. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - champ d'artefact =) Il reste de la premi√®re version de la norme et contient des informations sur le type de ce message. Essentiellement identique √† messageType, mais avec moins d'options. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logMessageInterval</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ce champ est d√©termin√© par le type de message. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corps</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme indiqu√© ci-dessus, il existe plusieurs types de messages. Ces types sont d√©crits ci-dessous: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message d'annonce Le message d'annonce</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
est utilis√© pour ¬´informer¬ª les autres montres du m√™me domaine de leurs param√®tres. Ce message vous permet de d√©finir la hi√©rarchie "Leading Clock - Slave Clock". </font></font><br>
<img src="https://habrastorage.org/webt/-i/zs/dh/-izsdhnvkookhpjtrdrqx2myimy.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sync</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un 
message Un message de synchronisation (SYNC) est envoy√© par l'horloge principale et contient le temps de l'horloge ma√Ætre au moment o√π </font><font style="vertical-align: inherit;">le message de </font><font style="vertical-align: inherit;">synchronisation a √©t√© cr√©√©. Si l'horloge principale est √† deux √©tages, l'horodatage du message Sync sera d√©fini sur 0 et l'horodatage actuel sera envoy√© dans le message Follow_Up coupl√©. Le message Sync est utilis√© pour les deux m√©canismes de mesure de retard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message est transmis √† l'aide de la multidiffusion. Vous pouvez √©ventuellement utiliser Unicast.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/pp/1f/scpp1fns1uuyccw9bucbvghesgo.png"><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Message </font><b><font style="vertical-align: inherit;">Delay_Req</font></b><font style="vertical-align: inherit;"> Le format du message </font><b><font style="vertical-align: inherit;">Delay_Req</font></b><font style="vertical-align: inherit;"> est identique au message Sync. L'horloge esclave envoie Delay_Req. Il contient l'heure √† laquelle Delay_Req a √©t√© envoy√© par l'horloge esclave. Ce message est utilis√© uniquement pour le m√©canisme de demande-r√©ponse de retard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message est transmis √† l'aide de la multidiffusion. Vous pouvez √©ventuellement utiliser Unicast. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/bm/r_/febmr_zz7v1dricuta5z88xmjqk.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message Follow_Up Le message Follow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
est √©ventuellement envoy√© par l'horloge ma√Ætre et contient l'heure √† laquelle le </font><font style="vertical-align: inherit;">ma√Ætre a </font><font style="vertical-align: inherit;">envoy√© le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">message Sync</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le message Follow_Up est envoy√© uniquement par une horloge de conduite √† deux √©tages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message Follow_Up est utilis√© pour les deux m√©canismes de mesure de retard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message est transmis √† l'aide de la multidiffusion. Vous pouvez √©ventuellement utiliser Unicast. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1g/42/2a/1g422aehbonsjrjjq0dwn9ceoxi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message Delay_Resp</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message Delay_Resp est envoy√© par l'horloge ma√Ætre. Il contient l'heure √† laquelle le Delay_Req est re√ßu par l'horloge ma√Ætre. Ce message est utilis√© uniquement pour le m√©canisme de demande-r√©ponse de retard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le message est transmis √† l'aide de la multidiffusion. Vous pouvez √©ventuellement utiliser Unicast. </font><font style="vertical-align: inherit;">
Message </font></font><br>
<br>
<img src="https://habrastorage.org/webt/up/is/gz/upisgzu5d7dk0iscixogmmjciwi.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdelay_Req Un</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> message </font><b><font style="vertical-align: inherit;">Pdelay_Req</font></b><font style="vertical-align: inherit;"> est envoy√© par un p√©riph√©rique qui demande un d√©lai. Il contient l'heure √† laquelle le message a √©t√© envoy√© depuis le port de cet appareil. Pdelay_Req est utilis√© uniquement pour le m√©canisme de mesure du retard du n≈ìud voisin. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/km/rz/hnkmrzmcidqsawxtazho-oprpus.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message Pdelay_Resp Le message Pdelay_Resp</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
est envoy√© par le p√©riph√©rique qui a re√ßu la demande de retard. Il contient l'heure √† laquelle le message Pdelay_Req a √©t√© re√ßu par cet appareil. Les messages Pdelay_Resp sont utilis√©s uniquement pour le m√©canisme de mesure de retard du n≈ìud voisin.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/bb/34/khbb34wn7ujy84lldruomgaenmg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message Pdelay_Resp_Follow_Up Le message Pdelay_Resp_Follow_Up</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
est √©ventuellement envoy√© par le p√©riph√©rique qui a re√ßu la demande de retard. </font><font style="vertical-align: inherit;">Il contient l'heure √† laquelle le message Pdelay_Req a √©t√© re√ßu par cet appareil. </font><font style="vertical-align: inherit;">Le message Pdelay_Resp_Follow_Up est envoy√© uniquement par une horloge ma√Ætre √† deux √©tages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce message peut √©galement √™tre utilis√© pour l'ex√©cution au lieu d'un horodatage. </font><font style="vertical-align: inherit;">Le temps d'ex√©cution est le temps entre le moment o√π Pdelay-Req est re√ßu et l'envoi de Pdelay_Resp. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pdelay_Resp_Follow_Up sont utilis√©s uniquement pour le m√©canisme de mesure de retard de n≈ìud voisin. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w7/-k/q2/w7-kq2pssesbnko10w1tmsrs9ow.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messages de contr√¥le (message de gestion)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Les messages de contr√¥le PTP sont requis pour transf√©rer des informations entre une ou plusieurs horloges et le n≈ìud de contr√¥le. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r7/xi/c0/r7xic0kvnb_yurjc53bah53f2ss.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfert vers LV</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un message PTP peut √™tre transmis √† deux niveaux:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©seau - dans le cadre des donn√©es IP.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien - dans le cadre d'une trame Ethernet.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Envoi d'un message PTP sur UDP sur IP sur Ethernet Les </font><b><font style="vertical-align: inherit;">profils</font></b></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/k6/al/f7k6alykkmt_4jrstkfkad_if-4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PTP sur UDP sur Ethernet </font><font style="vertical-align: inherit;">
PTP ont de nombreux param√®tres ¬´flexibles¬ª qui doivent √™tre configur√©s. </font><font style="vertical-align: inherit;">Par exemple:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/pe/wu/a7pewujvuii1chap6wppv51dh0k.png"><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Options BMCA.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le m√©canisme de mesure du retard.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intervalles et valeurs initiales de tous les param√®tres configurables, etc.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et malgr√© le fait que nous avons dit plus t√¥t que les appareils PTPv2 sont compatibles les uns avec les autres, dans le bon sens, ce n'est pas le cas. Les appareils doivent avoir les m√™mes param√®tres pour interagir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, il existe ce qu'on appelle des profils PTPv2. Les profils sont des groupes de param√®tres configur√©s et certaines restrictions de protocole afin que vous puissiez impl√©menter la synchronisation de l'heure pour une application sp√©cifique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La norme IEEE 1588v2 elle-m√™me ne d√©crit qu'un seul profil - le ¬´Profil par d√©faut¬ª. Tous les autres profils sont cr√©√©s et d√©crits par diverses organisations et associations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, le Power Profile ou PTPv2 Power Profile a √©t√© cr√©√© par le Power Systems Relaying Committee et le Substation Committee de l'IEEE Power and Energy Society. Le profil lui-m√™me est appel√© IEEE C37.238-2011.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le profil d√©crit que le PTP peut √™tre transmis:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uniquement via les r√©seaux L2 (c'est-√†-dire Ethernet, HSR, PRP, pas IP).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les messages sont transmis uniquement par la liste de diffusion Multicast.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le m√©canisme de mesure du retard entre pairs est utilis√© comme m√©canisme de mesure du retard.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le domaine par d√©faut est 0, le domaine recommand√© est 93. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La philosophie de cr√©ation de C37.238-2011 √©tait le d√©sir de r√©duire le nombre de fonctionnalit√©s optionnelles et de ne laisser que les fonctions n√©cessaires pour une interaction fiable entre les p√©riph√©riques et augmenter la stabilit√© du syst√®me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, la fr√©quence de transmission des messages est d√©termin√©e: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/gp/z9/wcgpz9du_jejtkxidtptsh9x53i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
en fait, un seul param√®tre est disponible pour la s√©lection - le type de l'horloge de t√™te (√† un ou deux √©tages). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pr√©cision ne doit pas d√©passer 1 Œºs. </font><font style="vertical-align: inherit;">En d'autres termes, un maximum de 15 horloges transparentes ou trois heures limites peuvent √™tre contenues dans un chemin de synchronisation.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/zp/y0/etzpy01l2mtcewn9mxik3wyztrq.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495904/index.html">Peut-on pr√©voir une √©pid√©mie?</a></li>
<li><a href="../fr495908/index.html">Le chemin de la r√©compense</a></li>
<li><a href="../fr495910/index.html">Installation de ROS dans une image IMG √† carte unique Ubuntu</a></li>
<li><a href="../fr495912/index.html">Autocollants de relecture intelligente</a></li>
<li><a href="../fr495918/index.html">Comment reproduire un son r√©aliste dans les jeux informatiques et la VR et pourquoi c'est difficile</a></li>
<li><a href="../fr495924/index.html">Pourquoi est-il si difficile de construire un bon mod√®le de distribution COVID-19?</a></li>
<li><a href="../fr495926/index.html">Nous √©crivons le firmware pour TI cc2530 sur Z-Stack 3.0 pour relais Zigbee Sonoff BASICZBR3 avec capteur ds18b20</a></li>
<li><a href="../fr495932/index.html">Quelle est la signification cach√©e des auteurs dans le guide SCRUM. Partie 1. √Ä propos du processus</a></li>
<li><a href="../fr495934/index.html">Gouvernance des donn√©es √† domicile</a></li>
<li><a href="../fr495938/index.html">Une s√©lection d'articles sur l'apprentissage automatique: cas, guides et √©tudes pour mars 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>