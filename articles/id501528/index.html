<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔲 😕 🧞 Buku "Bash and cybersecurity: serangan, pertahanan, dan analisis dari baris perintah Linux" 🔢 🍈 🧜🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, habrozhiteli! Baris perintah dapat menjadi alat yang ideal untuk keamanan siber. Fleksibilitas yang luar biasa dan ketersediaan absolut mengubah...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Buku "Bash and cybersecurity: serangan, pertahanan, dan analisis dari baris perintah Linux"</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/501528/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/xx/ml/ir/xxmlirxciwbxahmteiy-9cslfxg.jpeg" align="left" alt="gambar"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo, habrozhiteli! </font><font style="vertical-align: inherit;">Baris perintah dapat menjadi alat yang ideal untuk keamanan siber. </font><font style="vertical-align: inherit;">Fleksibilitas yang luar biasa dan ketersediaan absolut mengubah antarmuka baris perintah (CLI) standar menjadi solusi mendasar jika Anda memiliki pengalaman yang sesuai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penulis Paul Tronkon dan Karl Albing berbicara tentang alat dan trik baris perintah untuk membantu Anda mengumpulkan data dengan perlindungan proaktif, menganalisis log, dan memantau kesehatan jaringan. </font><font style="vertical-align: inherit;">Pentester akan belajar bagaimana melakukan serangan menggunakan fungsi kolosal yang dibangun di hampir semua versi Linux.</font></font><br>
<a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk siapa buku ini?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buku "Bash and cybersecurity" ditujukan bagi mereka yang ingin belajar cara bekerja dengan command line dalam konteks keamanan komputer. </font><font style="vertical-align: inherit;">Tujuan kami bukan untuk mengganti alat yang ada dengan skrip baris perintah, melainkan mengajarkan Anda cara menggunakan baris perintah secara efektif untuk meningkatkan fungsionalitas yang ada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sepanjang buku ini, kami memberikan contoh metode keamanan seperti pengumpulan data, analisis, dan pengujian penetrasi. </font><font style="vertical-align: inherit;">Tujuan dari contoh-contoh ini adalah untuk menunjukkan kemampuan baris perintah dan memperkenalkan Anda dengan beberapa metode dasar yang digunakan dalam alat tingkat yang lebih tinggi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buku ini bukan pengantar pemrograman, meskipun beberapa konsep umum tercakup dalam Bagian I.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemantauan log waktu-nyata</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemampuan untuk menganalisis majalah setelah suatu peristiwa terjadi adalah keterampilan yang penting. </font><font style="vertical-align: inherit;">Tetapi sama pentingnya untuk dapat mengekstraksi informasi dari file log secara real time untuk mendeteksi tindakan berbahaya atau mencurigakan pada saat itu terjadi. </font><font style="vertical-align: inherit;">Dalam bab ini, kita akan melihat metode untuk membaca entri jurnal saat dibuat dan diformat untuk menampilkan analitik dan menghasilkan peringatan berdasarkan indikator ancaman yang diketahui untuk suatu sistem atau jaringan (indikator kompromi).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemantauan Log Teks</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara termudah untuk memantau log secara real time adalah dengan menggunakan perintah tail dengan parameter -f - itu terus membaca file dan menampilkannya di stdout ketika baris baru ditambahkan. Seperti pada bab-bab sebelumnya, sebagai contoh kita akan menggunakan log akses server web Apache, tetapi metode yang dijelaskan relevan untuk log teks apa pun. Untuk melacak log akses Apache menggunakan perintah tail, masukkan berikut ini: </font></font><br>
<br>
<code>tail -f /var/logs/apache2/access.log</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Output dari perintah tail dapat diteruskan ke perintah grep, jadi hanya catatan yang cocok dengan kriteria tertentu yang akan ditampilkan. Contoh berikut melacak log akses Apache dan menampilkan entri yang sesuai dengan alamat IP tertentu:</font></font><br>
<br>
<code>tail -f /var/logs/apache2/access.log | grep '10.0.0.152'<br>
</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda juga dapat menggunakan ekspresi reguler. Dalam contoh ini, hanya catatan yang mengembalikan kode status HTTP 404 "Halaman tidak ditemukan" yang akan ditampilkan; opsi -i ditambahkan untuk mengabaikan huruf karakter: </font></font><br>
<br>
<code>tail -f /var/logs/apache2/access.log | egrep -i 'HTTP/.*" 404'</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menghapus dari informasi asing, output harus diteruskan ke perintah cut. Contoh ini memantau log akses untuk kueri yang mengarah ke kode status 404, dan kemudian menggunakan metode potong untuk hanya menampilkan tanggal / waktu dan halaman yang diminta: </font><font style="vertical-align: inherit;">
Selanjutnya, untuk menghapus tanda kurung siku dan tanda kutip ganda, Anda dapat mengarahkan output ke tr -d ' [] "'.</font></font><br>
<br>
<code>$ tail -f access.log | egrep --line-buffered 'HTTP/.*" 404' | cut -d' ' -f4-7<br>
[29/Jul/2018:13:10:05 -0400] "GET /test<br>
[29/Jul/2018:13:16:17 -0400] "GET /test.txt<br>
[29/Jul/2018:13:17:37 -0400] "GET /favicon.ico</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: opsi --line-buffering dari perintah egrep digunakan di sini. </font><font style="vertical-align: inherit;">Hal ini memaksa egrep untuk mencetak ke stdout setiap kali jeda baris terjadi. </font><font style="vertical-align: inherit;">Tanpa parameter ini, buffering akan terjadi dan output tidak akan dikirim ke perintah cut sampai buffer penuh. </font><font style="vertical-align: inherit;">Kami tidak ingin menunggu lama. </font><font style="vertical-align: inherit;">Opsi ini memungkinkan perintah egrep untuk menulis setiap baris seperti yang ditemukan.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEMBUAT LINE PERINTAH </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang terjadi selama buffering? </font><font style="vertical-align: inherit;">Bayangkan egrep menemukan banyak string yang cocok dengan pola yang ditentukan. </font><font style="vertical-align: inherit;">Dalam hal ini, egrep akan memiliki banyak output. </font><font style="vertical-align: inherit;">Tetapi output (pada kenyataannya, input atau output) jauh lebih mahal (membutuhkan lebih banyak waktu) daripada pemrosesan data (pencarian teks). </font><font style="vertical-align: inherit;">Dengan demikian, semakin sedikit panggilan I / O, program akan semakin efisien.</font></font><br>
<br>
     grep       ,  ,          .         .  grep       .   ,  grep   50    .   ,     50  ,     ,     .   50  !<br>
<br>
       egrep, ,             .  egrep       ,     ,     .    ,    ,   ,      ,      .      ,     .<br>
<br>
    ,    ,  tail -f        (    ),       . ,       « »,      .     .          .<br>
<br>
   ,        egrep     ,     .        ,   .</blockquote><br>
<h3>    </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat menggunakan perintah ekor dan egrep untuk memantau log dan menampilkan entri apa pun yang terkait dengan pola aktivitas mencurigakan atau berbahaya yang diketahui, sering disebut sebagai IOC. Anda dapat membuat sistem deteksi intrusi sederhana (IDS). Pertama, buat file yang berisi pola ekspresi reguler untuk IOC, seperti yang ditunjukkan pada Contoh 8.1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.1. ioc.txt </font><b><font style="vertical-align: inherit;">(1)</font></b><font style="vertical-align: inherit;"> Template ini (../) adalah indikator serangan direktori bundaran: penyerang mencoba untuk keluar dari direktori kerja saat ini dan mendapatkan file yang tidak dapat diakses olehnya. </font><b><font style="vertical-align: inherit;">(2)</font></b><font style="vertical-align: inherit;"> Linux etc / passwd dan etc / shadow file digunakan untuk otentikasi sistem dan tidak boleh diakses melalui server web. </font><b><font style="vertical-align: inherit;">(3)</font></b></font><br>
<br>
<code>\.\./ <b>(1)</b><br>
etc/passwd <b>(2)</b><br>
etc/shadow<br>
cmd\.exe <b>(3)</b><br>
/bin/sh<br>
/bin/bash<br>
</code><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melayani file cmd.exe, / bin / sh, atau / bin / bash adalah indikasi koneksi balik yang dikembalikan oleh server web. Koneksi terbalik sering menunjukkan upaya operasi yang berhasil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa IOC harus dalam format regex, karena nantinya akan digunakan oleh perintah egrep. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
File ioc.txt dapat digunakan dengan opsi egrep -f. Parameter ini memberi tahu egrep untuk mencari pola ekspresi reguler dari file yang ditentukan. Ini memungkinkan Anda untuk menggunakan perintah ekor untuk memantau file log, dan karena setiap catatan ditambahkan, baris baca akan dibandingkan dengan semua templat di file IOC, menampilkan catatan yang sesuai. Berikut ini sebuah contoh:</font></font><br>
<br>
<code>tail -f /var/logs/apache2/access.log | egrep -i -f ioc.txt</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, perintah tee dapat digunakan untuk secara bersamaan menampilkan peringatan di layar dan menyimpannya untuk diproses nanti dalam file sendiri: </font><font style="vertical-align: inherit;">
Sekali lagi, opsi --line-buffered diperlukan untuk memastikan bahwa tidak ada masalah yang disebabkan oleh buffering output dari perintah.</font></font><br>
<br>
<code>tail -f /var/logs/apache2/access.log | egrep --line-buffered -i -f ioc.txt |<br>
tee -a interesting.txt</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemantauan Log Windows</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang telah disebutkan, Anda harus menggunakan perintah wevtutil untuk mengakses acara Windows. </font><font style="vertical-align: inherit;">Meskipun perintah ini bersifat universal, ia tidak memiliki fungsi seperti tail, yang dapat digunakan untuk mengambil catatan masuk baru. </font><font style="vertical-align: inherit;">Tetapi ada jalan keluar - gunakan skrip bash sederhana yang dapat memberikan fungsionalitas yang sama (Contoh 8.2). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.2. </font><font style="vertical-align: inherit;">wintail.sh</font></font><br>
<br>
<pre><code class="java hljs">#!/bin/bash -<font></font>
#<font></font>
# Bash  <font></font>
# wintail.sh<font></font>
#<font></font>
# :<font></font>
#    tail   Windows<font></font>
#<font></font>
# : ./wintail.sh<font></font>
#<font></font>
<font></font>
WINLOG=<span class="hljs-string">"Application"</span> (<span class="hljs-number">1</span>)<font></font>
<font></font>
LASTLOG=$(wevtutil qe <span class="hljs-string">"$WINLOG"</span> <span class="hljs-comment">//c:1 //rd:true //f:text) (2)</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">true</span>
<span class="hljs-keyword">do</span>
      CURRENTLOG=$(wevtutil qe <span class="hljs-string">"$WINLOG"</span> <span class="hljs-comment">//c:1 //rd:true //f:text) (3)</span>
      <span class="hljs-keyword">if</span> [[ <span class="hljs-string">"$CURRENTLOG"</span> != <span class="hljs-string">"$LASTLOG"</span> ]]<font></font>
      then<font></font>
            echo <span class="hljs-string">"$CURRENTLOG"</span>
            echo <span class="hljs-string">"----------------------------------"</span>
            LASTLOG=<span class="hljs-string">"$CURRENTLOG"</span><font></font>
      fi<font></font>
done</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variabel ini menentukan log Windows yang ingin Anda lacak. Untuk daftar log yang saat ini tersedia di sistem, Anda dapat menggunakan perintah wevtutil el. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Di sini, wevtutil dijalankan untuk meminta file log yang ditentukan. Parameter c: 1 hanya mengembalikan satu entri log. Parameter rd: true memungkinkan perintah untuk membaca entri log terbaru. Akhirnya, f: teks mengembalikan hasil dalam teks biasa, bukan dalam format XML, yang membuatnya mudah untuk membaca hasil dari layar. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(3)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa baris berikutnya menjalankan perintah wevtutil lagi dan entri log yang baru diterima dibandingkan dengan yang terakhir dicetak pada layar. </font><font style="vertical-align: inherit;">Jika mereka berbeda satu sama lain, ini berarti ada perubahan dalam log. </font><font style="vertical-align: inherit;">Dalam hal ini, entri baru ditampilkan. </font><font style="vertical-align: inherit;">Jika catatan yang dibandingkan adalah sama, tidak ada yang terjadi dan perintah wevtutil kembali dan mulai mencari dan membandingkan lagi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembuatan histogram waktu-nyata</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah tail -f menyediakan aliran data saat ini. </font><font style="vertical-align: inherit;">Tetapi bagaimana jika Anda ingin menghitung jumlah baris yang ditambahkan ke file untuk jangka waktu tertentu? </font><font style="vertical-align: inherit;">Anda dapat mengamati aliran data ini, memulai penghitung waktu dan melakukan penghitungan selama periode waktu tertentu; </font><font style="vertical-align: inherit;">maka penghitungan harus dihentikan dan hasilnya dilaporkan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karya ini dapat dibagi menjadi dua proses skrip: satu skrip akan membaca baris, dan yang lainnya akan menonton waktu. Timer memberi tahu penghitung garis menggunakan mekanisme komunikasi antar proses POSIX standar yang disebut sinyal. Sinyal adalah gangguan perangkat lunak, dan ada berbagai jenis sinyal. Beberapa di antaranya fatal - mengarah pada akhir proses (misalnya, pengecualian dalam operasi floating point). Sebagian besar sinyal ini dapat diabaikan atau ditangkap. Tindakan diambil ketika sinyal ditangkap. Banyak dari sinyal-sinyal ini memiliki tujuan yang telah ditentukan sebelumnya dalam sistem operasi. Kami akan menggunakan salah satu dari dua sinyal yang tersedia bagi pengguna. Ini adalah sinyal SIGUSR1 (yang lainnya adalah SIGUSR2).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Script shell dapat menangkap interupsi menggunakan perintah trap bawaan. Dengan bantuannya, Anda dapat memilih perintah yang menentukan tindakan apa yang ingin Anda lakukan ketika sinyal diterima, dan daftar sinyal yang memicu panggilan ke perintah ini. Sebagai contoh: </font></font><br>
<br>
<code>trap warnmsg SIGINT</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini menyebabkan perintah warnmsg (skrip atau fungsi kita sendiri) dipanggil setiap kali skrip shell menerima sinyal SIGINT, misalnya, ketika Anda menekan Ctrl + C untuk mengganggu proses yang sedang berjalan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.3 menunjukkan skrip yang melakukan penghitungan </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.3 looper.sh</font></font><br>
<br>
<pre><code class="java hljs">#!/bin/bash -<font></font>
#<font></font>
# Bash  <font></font>
# looper.sh<font></font>
#<font></font>
# :<font></font>
#    <font></font>
#<font></font>
# : ./looper.sh [filename]<font></font>
# filename —  ,   ,<font></font>
#  : log.file<font></font>
#<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">interval</span> <span class="hljs-params">()</span>                                           <span class="hljs-params">(<span class="hljs-number">1</span>)</span>
</span>{<font></font>
      echo $(date <span class="hljs-string">'+%y%m%d %H%M%S'</span>) $cnt                       (<span class="hljs-number">2</span>)<font></font>
      cnt=<span class="hljs-number">0</span><font></font>
}<font></font>
<font></font>
declare -i cnt=<span class="hljs-number">0</span>
<span class="hljs-function">trap interval <span class="hljs-title">SIGUSR1</span>                                          <span class="hljs-params">(<span class="hljs-number">3</span>)</span>

shopt -s <span class="hljs-title">lastpipe</span>                                              <span class="hljs-params">(<span class="hljs-number">4</span>)</span>

tail -f --pid</span>=$$ ${<span class="hljs-number">1</span>:-log.file} | <span class="hljs-function"><span class="hljs-keyword">while</span> read <span class="hljs-title">aline</span>             <span class="hljs-params">(<span class="hljs-number">5</span>)</span>
<span class="hljs-keyword">do</span>
     let cnt++
done</span></code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fungsi interval akan dipanggil setelah menerima setiap sinyal. Tentu saja, interval harus ditentukan sebelum kita dapat menamainya dan menggunakan jebakan dalam ekspresi kita. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perintah tanggal dipanggil untuk memberikan stempel waktu untuk nilai variabel cnt yang kami cetak. Setelah penghitung ditampilkan, kami mereset nilai ini ke 0 untuk memulai hitungan mundur dari interval berikutnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(3)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang interval didefinisikan, kita dapat menunjukkan bahwa fungsi dipanggil setiap kali proses kami menerima sinyal SIGUSR1. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(4)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah langkah yang sangat penting. Biasanya, ketika ada pipeline perintah (misalnya, ls-l | grep rwx | wc), bagian-bagian dari pipeline (setiap perintah) dieksekusi pada subnet dan setiap proses berakhir dengan pengidentifikasi prosesnya sendiri. Ini bisa menjadi masalah untuk skenario ini, karena loop sementara akan berada dalam subkulit dengan pengenal proses yang berbeda. Apapun proses yang dimulai, skrip looper.sh tidak akan mengetahui pengidentifikasi proses loop sementara untuk mengirim sinyal ke sana. Selain itu, mengubah nilai variabel cnt dalam subkulit tidak mengubah nilai cnt dalam proses utama, sehingga sinyal untuk proses utama akan setiap kali menetapkan nilai menjadi 0. Anda dapat menyelesaikan masalah ini dengan perintah shopt, yang mengatur parameter (-s) ke lastpipe. Ia memberi tahu shell untuk tidak membuat subkulit untuk perintah terakhir dalam pipa,dan jalankan perintah ini dalam proses yang sama seperti skrip itu sendiri. Dalam kasus kami, ini berarti bahwa perintah ekor akan dieksekusi dalam sebuah subkulit (yaitu, dalam proses lain), dan loop sementara akan menjadi bagian dari proses skrip utama. Catatan: opsi shell ini hanya tersedia dalam versi bash 4.x dan lebih tinggi dan hanya untuk shell yang tidak interaktif (mis. Skrip).</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(5)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini adalah perintah tail -f dengan parameter --pid lainnya. Kami menentukan pengidentifikasi proses, yang, setelah menyelesaikan proses ini, akan menyelesaikan perintah ekor. Kami menentukan ID proses dari skrip shell saat ini untuk dilihat. Tindakan ini memungkinkan Anda untuk membersihkan proses dan tidak membiarkan perintah ekor dieksekusi di latar belakang (jika, katakanlah, skrip ini berjalan di latar belakang; Contoh 8.4). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip tailcount.sh memulai dan menghentikan skrip dengan stopwatch (timer) dan menghitung interval waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.4. tailcount.sh</font></font><br>
<br>
<pre><code class="java hljs">#!/bin/bash -<font></font>
#<font></font>
# Bash  <font></font>
# tailcount.sh<font></font>
#<font></font>
# :<font></font>
#    n <font></font>
#<font></font>
# : ./tailcount.sh [filename]<font></font>
#     filename:  looper.sh<font></font>
#<font></font>
<font></font>
#  —    <font></font>
<span class="hljs-function">function <span class="hljs-title">cleanup</span> <span class="hljs-params">()</span>
</span>{<font></font>
      [[ -n $LOPID ]] &amp;&amp; kill $LOPID          (<span class="hljs-number">1</span>)<font></font>
}<font></font>
<font></font>
<span class="hljs-function">trap cleanup <span class="hljs-title">EXIT</span>                             <span class="hljs-params">(<span class="hljs-number">2</span>)</span>
bash looper.sh $1 &amp;                           <span class="hljs-params">(<span class="hljs-number">3</span>)</span>
LOPID</span>=$!                                      (<span class="hljs-number">4</span>)<font></font>
#   <font></font>
sleep <span class="hljs-number">3</span><font></font>
<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">true</span>
<span class="hljs-keyword">do</span><font></font>
      kill -SIGUSR1 $LOPID<font></font>
      sleep <span class="hljs-number">5</span>
done &gt;&amp;<span class="hljs-number">2</span>                                      (<span class="hljs-number">5</span>)</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Karena skrip ini akan menjalankan skrip lain, skrip ini harus dibersihkan setelah bekerja. Jika pengidentifikasi proses disimpan dalam LOPID, variabel akan menyimpan nilai, oleh karena itu fungsi akan mengirim sinyal ke proses ini menggunakan perintah kill. Jika Anda tidak menentukan sinyal tertentu dalam perintah kill, maka sinyal SIGTERM akan dikirim secara default. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perintah EXIT bukan sinyal. Ini adalah kasus khusus ketika pernyataan trap memberi tahu shell untuk memanggil fungsi ini (dalam hal ini pembersihan) jika shell yang menjalankan skrip ini akan dimatikan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(3)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang pekerjaan yang sebenarnya dimulai. Skrip looper.sh diluncurkan, yang akan berjalan di latar belakang: agar skrip ini berfungsi sepanjang siklus (tanpa menunggu perintah untuk menyelesaikan pekerjaan), skrip ini terputus dari keyboard. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(4)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Di sini, pengidentifikasi proses skrip yang baru saja kami mulai di latar belakang disimpan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(5)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pengalihan ini hanyalah tindakan pencegahan. Semua output yang berasal dari loop sementara atau dari pernyataan kill / sleep (walaupun kami tidak mengharapkannya) tidak boleh dicampur dengan output apa pun dari fungsi looper.sh, yang, meskipun bekerja di latar belakang, masih mengirimkannya ke stdout. Oleh karena itu, kami mengarahkan data dari stdout ke stderr.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meringkas, kita melihat bahwa meskipun fungsi looper.sh ditempatkan di latar belakang, pengidentifikasi prosesnya disimpan dalam variabel shell. Setiap lima detik, skrip tailcount.sh mengirimkan sinyal SIGUSR1 ke proses ini (yang dieksekusi dalam fungsi looper.sh), yang, pada gilirannya, memanggil skrip looper.sh untuk mencetak jumlah baris saat ini yang diperbaiki di dalamnya dan memulai kembali penghitungan. Setelah keluar, skrip tailcount.sh akan dihapus dengan mengirimkan sinyal SIGTERM ke fungsi looper.sh untuk menghentikannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan bantuan dua skrip - skrip yang melakukan penghitungan baris, dan skrip dengan stopwatch (penghitung waktu) yang mengontrol skrip pertama - Anda bisa mendapatkan output (jumlah baris untuk periode tertentu), berdasarkan skrip berikutnya akan membuat histogram. Disebut seperti ini:</font></font><br>
<br>
<code>bash tailcount.sh | bash livebar.sh</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Script livebar.sh membaca data dari stdin dan mencetak output ke stdout, satu baris untuk setiap baris input (Contoh 8.5). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh 8.5 </font><font style="vertical-align: inherit;">livebar.sh</font></font><br>
<br>
<pre><code class="java hljs">#!/bin/bash -<font></font>
#<font></font>
# Bash  <font></font>
# livebar.sh<font></font>
#<font></font>
# :<font></font>
#    «» <font></font>
#<font></font>
# :<font></font>
# &lt;output from other script or program&gt; | bash livebar.sh<font></font>
#<font></font>
<font></font>
<span class="hljs-function">function <span class="hljs-title">pr_bar</span> <span class="hljs-params">()</span>                                         <span class="hljs-params">(<span class="hljs-number">1</span>)</span>
</span>{<font></font>
      local raw maxraw scaled<font></font>
      raw=$<span class="hljs-number">1</span>
      maxraw=$<span class="hljs-number">2</span><font></font>
      ((scaled=(maxbar*raw)/maxraw))<font></font>
      ((scaled == <span class="hljs-number">0</span>)) &amp;&amp; scaled=<span class="hljs-number">1</span> #   
      <span class="hljs-keyword">for</span>((i=<span class="hljs-number">0</span>; i&lt;scaled; i++)) ; <span class="hljs-keyword">do</span> printf <span class="hljs-string">'#'</span> ; done<font></font>
      printf <span class="hljs-string">'\n'</span><font></font>
<font></font>
} # pr_bar<font></font>
<font></font>
maxbar=<span class="hljs-number">60</span>     #         (<span class="hljs-number">2</span>)<font></font>
MAX=<span class="hljs-number">60</span>
<span class="hljs-function"><span class="hljs-keyword">while</span> read dayst timst qty
<span class="hljs-keyword">do</span>
      <span class="hljs-title">if</span> <span class="hljs-params">(( qty &gt; MAX )</span>)                                   <span class="hljs-params">(<span class="hljs-number">3</span>)</span>
      then
           let MAX</span>=$qty+$qty/<span class="hljs-number">4</span>    #   <font></font>
           echo <span class="hljs-string">"                      **** rescaling: MAX=$MAX"</span><font></font>
      fi<font></font>
      printf <span class="hljs-string">'%6.6s %6.6s %4d:'</span> $dayst $timst $qty         (<span class="hljs-number">4</span>)<font></font>
      pr_bar $qty $MAX<font></font>
done<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fungsi pr_bar menampilkan string tagar yang diskalakan berdasarkan parameter yang disediakan ke ukuran maksimum. </font><font style="vertical-align: inherit;">Fitur ini mungkin tampak familier, seperti yang kita gunakan sebelumnya dalam skrip histogram.sh. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini adalah ukuran garis tagar terpanjang yang dapat kami izinkan (lakukan tanpa pembungkus garis). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(3)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seberapa besar nilai yang akan ditampilkan? Tanpa mengetahui hal ini sebelumnya (meskipun data ini dapat disediakan untuk skrip sebagai argumen), skrip akan melacak maksimum. Jika maksimum ini terlampaui, nilai akan mulai "skala" dan garis-garis yang sekarang ditampilkan, dan garis masa depan juga akan diskalakan ke maksimum baru. Script menambahkan 25% ke nilai maksimum, sehingga tidak harus menskala nilai jika nilai baru berikutnya setiap kali hanya meningkat 1-2%. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(4)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">printf menentukan lebar minimum dan maksimum dari dua bidang pertama yang akan dicetak. </font><font style="vertical-align: inherit;">Ini adalah prangko tanggal dan waktu yang akan terpotong jika nilai lebar terlampaui. </font><font style="vertical-align: inherit;">Untuk menampilkan seluruh nilai, tentukan lebarnya empat karakter. </font><font style="vertical-align: inherit;">Dalam hal ini, meskipun ada batasan, semua nilai akan dicetak. </font><font style="vertical-align: inherit;">Jika jumlah karakter dalam nilai kurang dari empat, yang hilang akan ditambah dengan spasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena skrip ini dibaca dari stdin, Anda dapat menjalankannya sendiri untuk melihat bagaimana perilakunya. </font><font style="vertical-align: inherit;">Berikut ini sebuah contoh:</font></font><br>
<br>
<pre><code class="java hljs">$ bash  livebar.sh
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">20</span>
<span class="hljs-number">201010</span>     <span class="hljs-number">1020</span> <span class="hljs-number">20</span>:####################
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">70</span>
                       **** rescaling: MAX=<span class="hljs-number">87</span>
<span class="hljs-number">201010</span>     <span class="hljs-number">1020</span> <span class="hljs-number">70</span>:################################################
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">75</span>
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">75</span>:###################################################<font></font>
^C</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam contoh ini, input dicampur dengan output. </font><font style="vertical-align: inherit;">Anda juga dapat memasukkan input ke file dan mengarahkannya ke skrip untuk hanya melihat output:</font></font><br>
<br>
<pre><code class="java hljs">$ bash livebar.sh &lt; testdata.txt<font></font>
bash livebar.sh &lt; x.data<font></font>
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">20</span>:####################<font></font>
                 **** rescaling: MAX=<span class="hljs-number">87</span>
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">70</span>:################################################
<span class="hljs-number">201010</span> <span class="hljs-number">1020</span> <span class="hljs-number">75</span>:###################################################<font></font>
$</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
»Informasi lebih lanjut tentang buku itu dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">situs web penerbit</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isi</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kutipan</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Untuk Khabrozhiteley Diskon 25% pada kupon - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bash</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Setelah pembayaran versi kertas buku, sebuah buku elektronik dikirim melalui email.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id501516/index.html">Mari matikan ruang hampa ?! Alexey Lesovsky</a></li>
<li><a href="../id501520/index.html">C # 8 dan validitas nol. Bagaimana kita hidup dengan ini</a></li>
<li><a href="../id501522/index.html">Webinar Skillbox Gratis: Game Menulis dalam PHP, Unity, dan Unreal Engine</a></li>
<li><a href="../id501524/index.html">Rahasia sinkronisasi medan elektromagnetik Bumi dan organisme hidup</a></li>
<li><a href="../id501526/index.html">Mengapa Bahasa Inggris Kanada dianggap "kotor" dan apa hubungannya Keanu Reeves dengan itu?</a></li>
<li><a href="../id501534/index.html">Sekarang dengan COVID-19 juga ada ruam</a></li>
<li><a href="../id501536/index.html">Dibuat khusus: kisah tentang bagaimana sebaris kode berubah menjadi kiloton batu bara</a></li>
<li><a href="../id501538/index.html">Lekukan dalam Python - Opsi Solusi</a></li>
<li><a href="../id501544/index.html">Smartphone sempurna</a></li>
<li><a href="../id501546/index.html">"Kenapa aku harus melalui ini?" - psikolog menjelaskan cara menemukan makna dalam isolasi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>