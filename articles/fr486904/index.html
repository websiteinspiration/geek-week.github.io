<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêæ üèçÔ∏è üé∑ Affichage aux d√©veloppeurs de l'√©tat du contr√¥le qualit√© du code source dans SonarQube üå©Ô∏è üè¢ üëãüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SonarQube est une plate-forme ouverte pour le contr√¥le qualit√© continu du code source qui prend en charge un grand nombre de langages de programmation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Affichage aux d√©veloppeurs de l'√©tat du contr√¥le qualit√© du code source dans SonarQube</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486904/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SonarQube est une plate-forme ouverte pour le contr√¥le qualit√© continu du code source qui prend en charge un grand nombre de langages de programmation et vous permet de recevoir des rapports sur des mesures telles que la duplication de code, la conformit√© aux normes de codage, la couverture des tests, la complexit√© du code, les erreurs potentielles, etc. </font><font style="vertical-align: inherit;">SonarQube visualise facilement les r√©sultats de l'analyse et vous permet de suivre la dynamique du projet au fil du temps.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√¢che: montrer aux d√©veloppeurs l'√©tat du contr√¥le de la qualit√© du code source dans SonarQube.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe deux solutions:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cutez un script pour v√©rifier l'√©tat du contr√¥le qualit√© du code source dans SonarQube. </font><font style="vertical-align: inherit;">Si le contr√¥le qualit√© du code source dans SonarQube √©choue, l'assembly √©choue.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afficher l'√©tat du contr√¥le qualit√© du code source sur la page principale du projet.</font></font><a name="habracut"></a></li>
</ul><br>
<h3 id="ustanovka-sonarqube"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer SonarQube</font></font></h3><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour installer sonarqube √† partir des packages rpm, nous utilisons le r√©f√©rentiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://harbottle.gitlab.io/harbottle-main</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez le package de r√©f√©rentiel pour CentOS 7.</font></font></p><br>
<pre><code class="bash hljs">yum install -y https://harbottle.gitlab.io/harbottle-main/7/x86_64/harbottle-main-release.rpm</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez sonarqube lui-m√™me.</font></font></p><br>
<pre><code class="bash hljs">yum install -y sonarqube</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La plupart des plugins seront install√©s pendant l'installation, mais findbugs et pmd doivent √™tre install√©s</font></font></p><br>
<pre><code class="plaintext hljs">yum install -y sonarqube-findbugs sonarqube-pmd</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous d√©marrons le service et l'ajoutons au chargement automatique</font></font></p><br>
<pre><code class="bash hljs">systemctl start sonarqube<font></font>
systemctl <span class="hljs-built_in">enable</span> sonarqube</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le chargement est long, ajoutez le g√©n√©rateur de nombres al√©atoires /dev/./urandom √† la fin des options sonar.web.javaOpts</font></font></p><br>
<pre><code class="bash hljs">sonar.web.javaOpts=  -Djava.security.egd=file:/dev/urandom</code></pre><br>
<h3 id="zapusk-skripta-proverki-statusa-kontrolya-kachestva-ishodnogo-koda-v-sonarqube"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution d'un script pour v√©rifier l'√©tat du contr√¥le qualit√© du code source dans SonarQube.</font></font></h3><br>
<p> ,  sonar-break-maven-plugin   .    .</p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">https://github.com/uweplonus/spotbugs-examples</a>.</p><br>
<p>  Gitlab.   .gitlab-ci.yml:</p><br>
<pre><code class="plaintext hljs">variables:<font></font>
  MAVEN_OPTS: "-Dhttps.protocols=TLSv1.2 -Dmaven.repo.local=~/.m2/repository -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=WARN -Dorg.slf4j.simpleLogger.showDateTime=true -Djava.awt.headless=true"<font></font>
  MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version -DinstallAtEnd=true -DdeployAtEnd=true"<font></font>
  SONAR_HOST_URL: "http://172.26.9.226:9000"<font></font>
  LOGIN: "admin" #  sonarqube<font></font>
  PASSWORD: "admin" #  sonarqube<font></font>
<font></font>
cache:<font></font>
  paths:<font></font>
    - .m2/repository<font></font>
<font></font>
build:<font></font>
  image: maven:3.3.9-jdk-8<font></font>
  stage: build<font></font>
  script:<font></font>
    - apt install -y jq || true<font></font>
    - mvn $MAVEN_CLI_OPTS -Dmaven.test.failure.ignore=true org.jacoco:jacoco-maven-plugin:0.8.5:prepare-agent clean verify org.jacoco:jacoco-maven-plugin:0.8.5:report<font></font>
    - mvn $MAVEN_CLI_OPTS -Dmaven.test.skip=true verify sonar:sonar -Dsonar.host.url=$SONAR_HOST_URL -Dsonar.login=$LOGIN -Dsonar.password=$PASSWORD -Dsonar.gitlab.project_id=$CI_PROJECT_PATH -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME<font></font>
    - export URL=$(cat target/sonar/report-task.txt | grep ceTaskUrl | cut -c11- ) #URL where report gets stored<font></font>
    - echo $URL<font></font>
    - |<font></font>
      while : ;do<font></font>
          curl -k -u "$LOGIN":"$PASSWORD" "$URL" -o analysis.txt<font></font>
          export status=$(cat analysis.txt | jq -r '.task.status') #Status as SUCCESS, CANCELED, IN_PROGRESS or FAILED<font></font>
          echo $status<font></font>
          if [ ${status} == "SUCCESS" ];then<font></font>
            echo "SONAR ANALYSIS SUCCESS";<font></font>
            break<font></font>
          fi<font></font>
          sleep 5<font></font>
      done<font></font>
    - curl -k -u "$LOGIN":"$PASSWORD" "$URL" -o analysis.txt<font></font>
    - export status=$(cat analysis.txt | jq -r '.task.status') #Status as SUCCESS, CANCELED or FAILED<font></font>
    - export analysisId=$(cat analysis.txt | jq -r '.task.analysisId') #Get the analysis Id<font></font>
    - |<font></font>
      if [ "$status" == "SUCCESS" ]; then<font></font>
        echo -e "SONAR ANALYSIS SUCCESSFUL...ANALYSING RESULTS";<font></font>
        curl -k -u "$LOGIN":"$PASSWORD" "$SONAR_HOST_URL/api/qualitygates/project_status?analysisId=$analysisId" -o result.txt; #Analysis result like critical, major and minor issues<font></font>
        export result=$(cat result.txt | jq -r '.projectStatus.status');<font></font>
<font></font>
        if [ "$result" == "ERROR" ];then<font></font>
          echo -e "91mSONAR RESULTS FAILED";<font></font>
          echo "$(cat result.txt | jq -r '.projectStatus.conditions')"; #prints the critical, major and minor violations<font></font>
          exit 1 #breaks the build for violations<font></font>
        else<font></font>
          echo -e "SONAR RESULTS SUCCESSFUL";<font></font>
          echo "$(cat result.txt | jq -r '.projectStatus.conditions')";<font></font>
          exit 0<font></font>
        fi<font></font>
      else<font></font>
          echo -e "\e[91mSONAR ANALYSIS FAILED\e[0m";<font></font>
          exit 1 #breaks the build for failure in Step2<font></font>
      fi<font></font>
  tags:<font></font>
    - docker</code></pre><br>
<p> .gitlab-ci.yml .      sonarqube  : "SUCCESS".      .    ,  .gitlab-ci.yml   .</p><br>
<h3 id="otobrazhenie-na-glavnoy-stranice-proekta-status-kontrolya-kachestva-ishodnogo-koda">         </h3><br>
<p>   SonarQube</p><br>
<pre><code class="bash hljs">yum install -y sonarqube-qualinsight-badges</code></pre><br>
<p>  SonarQube   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">http://172.26.9.115:9000/</a><br>
  ,  "badges".<br>
     SonarQube.</p><br>
<p><img src="https://habrastorage.org/webt/sh/py/jh/shpyjhemnnulcw9kbrxakwza1lu.png"></p><br>
<p>  "My account",   ,    "read_all_repository"   "Genereate".</p><br>
<p><img src="https://habrastorage.org/webt/a4/mm/qi/a4mmqitdr2mlbbspaxvlosm_0ty.png"></p><br>
<p>   .    1 .</p><br>
<p>  .</p><br>
<p>  Configuration -&gt; SVG Badges</p><br>
<p><img src="https://habrastorage.org/webt/_1/la/oz/_1laozdzrcqevucvlg6fkvzws_s.png"></p><br>
<p>     "Activity badge token"    save.</p><br>
<p><img src="https://habrastorage.org/webt/--/4z/rd/--4zrd1ngsyoiek-ecv6wbh_qjw.png"></p><br>
<p>  Administration -&gt; Security -&gt; Permission Templates -&gt; Default template (  ,    ).</p><br>
<p>  badges    "Browse".</p><br>
<p>.</p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">https://github.com/jitpack/maven-simple</a>.</p><br>
<p>  . </p><br>
<p>  .gitlab-ci.yml      .</p><br>
<pre><code class="plaintext hljs">variables:<font></font>
  MAVEN_OPTS: "-Dhttps.protocols=TLSv1.2 -Dmaven.repo.local=~/.m2/repository -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=WARN -Dorg.slf4j.simpleLogger.showDateTime=true -Djava.awt.headless=true"<font></font>
  MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version -DinstallAtEnd=true -DdeployAtEnd=true"<font></font>
  SONAR_HOST_URL: "http://172.26.9.115:9000"<font></font>
  LOGIN: "admin" #  sonarqube<font></font>
  PASSWORD: "admin" #  sonarqube<font></font>
<font></font>
cache:<font></font>
  paths:<font></font>
    - .m2/repository<font></font>
<font></font>
build:<font></font>
  image: maven:3.3.9-jdk-8<font></font>
  stage: build<font></font>
  script:<font></font>
    - mvn $MAVEN_CLI_OPTS -Dmaven.test.failure.ignore=true org.jacoco:jacoco-maven-plugin:0.8.5:prepare-agent clean verify org.jacoco:jacoco-maven-plugin:0.8.5:report<font></font>
    - mvn $MAVEN_CLI_OPTS -Dmaven.test.skip=true verify sonar:sonar -Dsonar.host.url=$SONAR_HOST_URL -Dsonar.login=$LOGIN -Dsonar.password=$PASSWORD -Dsonar.gitlab.project_id=$CI_PROJECT_PATH -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME<font></font>
  tags:<font></font>
    - docker</code></pre><br>
<p> SonarQube    :</p><br>
<p><img src="https://habrastorage.org/webt/8h/do/cz/8hdoczabrifcatucgmkh9wnanm4.png"></p><br>
<p> bages  README.md    e :</p><br>
<p><img src="https://habrastorage.org/webt/nj/0x/kx/nj0xkxvt8uyfjwpyf1f7s_ruh-g.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code d'affichage des badges ressemble √† ceci:</font></font></p><br>
<p><img src="https://habrastorage.org/webt/nl/ue/7r/nlue7rfncrql2b-r7w_fon3fxoo.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse de la cha√Æne d'affichage des badges:</font></font></p><br>
<pre><code class="bash hljs">[![Quality Gate](http://172.26.9.115:9000/api/badges/gate?key=com.github.jitpack:maven-simple)](http://172.26.9.115:9000/dashboard?id=com.github.jitpack%3Amaven-simple)<font></font>
[![](http://172.26.9.115:9000/api/badges/gate?key=Project Key)](http://172.26.9.115:9000/dashboard?id=id-)<font></font>
[![Coverage](http://172.26.9.115:9000/api/badges/measure?key=com.github.jitpack:maven-simple&amp;metric=coverage)](http://172.26.9.115:9000/dashboard?id=com.github.jitpack%3Amaven-simple)<font></font>
[![ ](http://172.26.9.115:9000/api/badges/measure?key=Project Key&amp;metric=)](http://172.26.9.115:9000/dashboard?id=id-)</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O√π obtenir / v√©rifier la cl√© du projet et l'ID du projet.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cl√© de projet est situ√©e en bas √† droite. </font><font style="vertical-align: inherit;">L'URL contient l'ID du projet.</font></font></p><br>
<p><img src="https://habrastorage.org/webt/ur/_x/3x/ur_x3xctww3smxq5c8exxbad2b0.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les options pour obtenir des mesures peuvent √™tre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trouv√©es ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes les demandes d'am√©lioration sont tir√©es, les corrections de bugs sont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">envoy√©es √† ce r√©f√©rentiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chat t√©l√©gramme sur SonarQube </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://t.me/sonarqube_ru</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Chat t√©l√©gramme sur DevSecOps - DevOps s√ªr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://t.me/sec_devops</font></font></a></p></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486888/index.html">Le livre ¬´Object-Oriented Approach. 5e int. √©d. "</a></li>
<li><a href="../fr486890/index.html">D√©veloppement personnel: comment je ne me suis pas assis sur deux chaises et en ai trouv√© un troisi√®me</a></li>
<li><a href="../fr486892/index.html">Contactez l'API Picker, ou comment partager vos contacts avec un navigateur</a></li>
<li><a href="../fr486896/index.html">UID et autorisation Stalker sur le MAG250</a></li>
<li><a href="../fr486902/index.html">Programmation orient√©e protocole dans Swift 5.1</a></li>
<li><a href="../fr486908/index.html">Wulfric Ransomware est un crypteur qui n'existe pas</a></li>
<li><a href="../fr486912/index.html">Lowkiq. Pourquoi l'avons-nous fait?</a></li>
<li><a href="../fr486914/index.html">8. Mise en route de Fortinet v6.0. Travailler avec les utilisateurs</a></li>
<li><a href="../fr486918/index.html">Emacs - 6 astuces de productivit√©</a></li>
<li><a href="../fr486920/index.html">Comment faire un guide √©tape par √©tape de votre application (si votre projet est sur Angular)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>