<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé± üìë üôèüèª Development of an interactive coronavirus distribution map of type 2019-nCoV in Python üéÖüèΩ üîÖ üéÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Coronavirus type 2019-nCoV, after an outbreak in the Chinese city of Wuhan, is rapidly spreading around the world. At the time of writing the original...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Development of an interactive coronavirus distribution map of type 2019-nCoV in Python</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487688/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coronavirus type 2019-nCoV, after an outbreak in the Chinese city of Wuhan, is rapidly spreading around the world. At the time of writing the original article (January 30, 2020), more than 9,000 infected and 213 dead were reported, as of today (February 10, 2020), 40,570 infected have already been reported, 910 people have died. Cases of coronavirus infection have been detected in France, Australia, Russia, Japan, Singapore, Malaysia, Germany, Italy, Sri Lanka, Cambodia, Nepal and many other countries. No one knows when the virus will be stopped. In the meantime, the number of confirmed cases of coronavirus is only growing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The author of the article we are translating today wants to talk about how, using Python, to create a simple application to track the spread of coronavirus. </font><font style="vertical-align: inherit;">After completing work on this application, the reader will have an HTML page that displays a map of the spread of the virus and a slider that allows you to select the date by which the data is displayed on the map.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/3a0/01d/f473a001d45ecadc8bcdc1415c43e983.gif"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interactive map of the distribution of coronavirus type 2019-nCoV</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Technologies such as Python 3.7, Pandas, Plotly 4.1.0 and Jupyter Notebook will be used here.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import libraries</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's start by importing into a project based on the Jupyter Notebook, the Plotly and Pandas libraries.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before moving on, try running the code. </font><font style="vertical-align: inherit;">If you did not see error messages, then all the necessary libraries have been installed and are working correctly. </font><font style="vertical-align: inherit;">If the code failed to run, take a look at the official pages of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plotly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pandas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and read the reference and installation materials for these libraries. </font><font style="vertical-align: inherit;">If you do not have a Jupyter Notebook system running on your hardware, I recommend using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Colab</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a cloud-based platform that allows you to work with Jupyter Notebook.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data processing</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The data we use here can be found </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is a shared spreadsheet of Google docs that is updated daily. Many thanks to all those who keep it up to date! You are doing a very necessary job. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will read the data using the Pandas method </font></font><code>read_csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. But before loading the data from the table, using the link to it, we need to work with this link. Now it looks like this: </font><font style="vertical-align: inherit;">
We need to replace the selected fragment of the link, bringing the link to this form: </font><font style="vertical-align: inherit;">
In the following code, we initialize the variable </font><font style="vertical-align: inherit;">by writing a link to the data into it, read the data using the method </font><font style="vertical-align: inherit;">and write to empty cells containing </font><font style="vertical-align: inherit;">values </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>edit#gid=0</b></code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<code>https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/<b>export?format=csv&amp;id</b></code><br>
<br><font style="vertical-align: inherit;"></font><code>url</code><font style="vertical-align: inherit;"></font><code>read_csv</code><font style="vertical-align: inherit;"></font><code>NaN</code><font style="vertical-align: inherit;"></font><code>0</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="python hljs">url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Understanding how the data structures that we use are structured is extremely important at this stage of the work, as this determines what approach to data processing we apply. View the data using the command </font></font><code>data.head()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This will lead to the output of the first 5 rows of the table.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ac/130/bed/3ac130bed504767776a301ba85b377df.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first 5 rows of coronavirus data</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the lower left corner you can see information that there are 47 columns in the data table. Here are the names of the first five columns:</font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>location_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>latitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>longitude</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Other columns are pairs whose names are constructed as follows:</font></font><code>confirmedcase_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>deaths_dd-mm-yyyy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The total number of columns in the table at the time of writing this material was 47. This means that I had data for 21 days at my disposal ((47-5) / 2 = 21). If the start date for data collection was 10.01.2020, then the end date was 30.01.2020.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The names of the first five columns of the table do not change, but over time columns with new names will be added to the table. What our interactive map will output is a visualization of the distribution of the coronavirus with the ability to indicate the day according to which the map is formed. Therefore, we need to separate the entire data set by selecting information for each day from it and taking into account that the first 5 columns of the table do not change, and that every day is described by two columns. Then, if you take a closer look at the data, for example, the data for 10.01.2020, it turns out that many dates correspond to this date. In fact, at this date the detection of coronavirus was confirmed in only one place, which is marked by the corresponding number. All other lines on this date contain only zeros. It means,that we need to exclude these lines from the map building process.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The process of preparing data for visualization is carried out in a cycle.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During operation, the output of each data set is added to the Scattergeo graph using </font></font><code>fig.add_trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">At the time of writing, the data on the basis of which the images will be built are represented by 21 objects. </font><font style="vertical-align: inherit;">You can verify this using the command </font></font><code>fig.data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slider creation</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we will create a slider with the help of which the selection of data visualized on the map is organized. </font><font style="vertical-align: inherit;">Here is the relevant code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The slider code consists of two main fragments. </font><font style="vertical-align: inherit;">The first is a loop in which the list </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used when moving the slider slider is </font><font style="vertical-align: inherit;">populated </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">When you move the slider, the corresponding data set is visualized and what is displayed before is hidden. </font><font style="vertical-align: inherit;">The second part of the code is the inclusion of the previously constructed list </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the slider object. </font><font style="vertical-align: inherit;">When the slider moves, it selects the corresponding element from </font></font><code>steps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map output and save it as an HTML file</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we come to the final part of the material. </font><font style="vertical-align: inherit;">Here we talk about how to display the map, and how to save it in HTML format. </font><font style="vertical-align: inherit;">Here is the code that implements these operations:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When a map is displayed, a visual representation of the first data set is visible. </font><font style="vertical-align: inherit;">Then we make the contents of the map update according to the position of the slider. </font><font style="vertical-align: inherit;">Here we set the map title and adjust its height. </font><font style="vertical-align: inherit;">At the last step, we display the map using the method </font></font><code>fig.show</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and then save it in HTML using the method </font></font><code>go_offline.plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Full project code</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the complete project code for creating a coronavirus distribution map of type 2019-nCoV. </font><font style="vertical-align: inherit;">Please note that the last line responsible for saving the HTML version of the map needs to be edited, replacing the path specified there with the one that is relevant to you.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> plotly.offline <span class="hljs-keyword">as</span> go_offline
<span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
<span class="hljs-comment"># </span>
url=<span class="hljs-string">'https://docs.google.com/spreadsheets/d/18X1VM1671d99V_yd-cnUI1j8oSG2ZgfU_q1HfOizErA/export?format=csv&amp;id'</span><font></font>
data=pd.read_csv(url)<font></font>
data=data.fillna(<span class="hljs-number">0</span>)<font></font>
<font></font>
<span class="hljs-comment">#  </span><font></font>
fig=go.Figure()<font></font>
col_name=data.columns<font></font>
n_col=len(data.columns)<font></font>
date_list=[]<font></font>
init=<span class="hljs-number">4</span>
n_range=int((n_col<span class="hljs-number">-5</span>)/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment">#,          </span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_range):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;col_case=init+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;col_dead=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;init=col_case+<span class="hljs-number">1</span>
&nbsp;&nbsp;&nbsp;&nbsp;df_split=data[[<span class="hljs-string">'latitude'</span>,<span class="hljs-string">'longitude'</span>,<span class="hljs-string">'country'</span>,<span class="hljs-string">'location'</span>,col_name[col_case],col_name[col_dead]]]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df=df_split[(df_split[col_name[col_case]]!=<span class="hljs-number">0</span>)]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=df[<span class="hljs-string">'latitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=df[<span class="hljs-string">'longitude'</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;case=df[df.columns[<span class="hljs-number">-2</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;deaths=df[df.columns[<span class="hljs-number">-1</span>]].astype(int)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;df[<span class="hljs-string">'text'</span>]=df[<span class="hljs-string">'country'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+df[<span class="hljs-string">'location'</span>]+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'confirmed cases: '</span>+ case.astype(str)+<span class="hljs-string">'&lt;br&gt;'</span>+<span class="hljs-string">'deaths: '</span>+deaths.astype(str)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_label=deaths.name[<span class="hljs-number">7</span>:<span class="hljs-number">17</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;date_list.append(date_label)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#  Scattergeo</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fig.add_trace(go.Scattergeo(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;name=<span class="hljs-string">''</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lon=lon,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;lat=lat,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;visible=<span class="hljs-literal">False</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;hovertemplate=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;text=df[<span class="hljs-string">'text'</span>],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;mode=<span class="hljs-string">'markers'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;marker=dict(size=<span class="hljs-number">15</span>,opacity=<span class="hljs-number">0.6</span>,color=<span class="hljs-string">'Red'</span>, symbol=<span class="hljs-string">'circle'</span>),<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;))<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># </span><font></font>
steps = []<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(fig.data)):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step = dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=<span class="hljs-string">"restyle"</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args=[<span class="hljs-string">"visible"</span>, [<span class="hljs-literal">False</span>] * len(fig.data)],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label=date_list[i],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;step[<span class="hljs-string">"args"</span>][<span class="hljs-number">1</span>][i] = <span class="hljs-literal">True</span>&nbsp; <span class="hljs-comment">#  i-     "visible"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps.append(step)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
sliders = [dict(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;active=<span class="hljs-number">0</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentvalue={<span class="hljs-string">"prefix"</span>: <span class="hljs-string">"Date: "</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;pad={<span class="hljs-string">"t"</span>: <span class="hljs-number">1</span>},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;steps=steps<font></font>
)]<font></font>
<font></font>
<span class="hljs-comment">#    </span>
fig.data[<span class="hljs-number">0</span>].visible=<span class="hljs-literal">True</span><font></font>
<font></font>
<span class="hljs-comment">#       HTML</span>
fig.update_layout(sliders=sliders,title=<span class="hljs-string">'Coronavirus Spreading Map'</span>+<span class="hljs-string">'&lt;br&gt;geodose.com'</span>,height=<span class="hljs-number">600</span>)<font></font>
fig.show()<font></font>
go_offline.plot(fig,filename=<span class="hljs-string">'F:/html/map_ncov_slider.html'</span>,validate=<span class="hljs-literal">True</span>, auto_open=<span class="hljs-literal">False</span>)</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have completed a review of a guide on creating an interactive map for visualizing the distribution of coronavirus type 2019-nCoV. After working through this material, you learned how to read data from Google‚Äôs public spreadsheets, how to process data using Pandas, and how to visualize this data on an interactive map using the slider and Plotly. The result of the project as an HTML page can be downloaded </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from here.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The information displayed on the map depends on the data table. </font><font style="vertical-align: inherit;">Each time the project code is executed, the map is updated, and fresh data from the table becomes available on it. </font><font style="vertical-align: inherit;">This is a very simple map. </font><font style="vertical-align: inherit;">There are many ways to improve it. </font><font style="vertical-align: inherit;">For example, it can be supplemented with additional graphs, some summary data, and so on. </font><font style="vertical-align: inherit;">If you are interested, you can do all this and much more yourself. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For what tasks do you use Jupyter Notebook technology?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487676/index.html">New ZX Spectrum Game Contest - Your Game 6</a></li>
<li><a href="../en487678/index.html">Marginal notes on the international conference PGConf.Russia 2020. Highlights and slides</a></li>
<li><a href="../en487680/index.html">Full analysis of the ShAD-2019 exam</a></li>
<li><a href="../en487682/index.html">7 recommendations for improving the reliability of JavaScript code</a></li>
<li><a href="../en487684/index.html">Developing faster applications on Vue.js</a></li>
<li><a href="../en487690/index.html">PHP Digest No. 173 (January 27 - February 10, 2020)</a></li>
<li><a href="../en487694/index.html">How Yandex.Cloud is hosted by Virtual Private Cloud and how our users help us implement useful features</a></li>
<li><a href="../en487696/index.html">Digital events in Moscow from February 10 to 16</a></li>
<li><a href="../en487698/index.html">Digital events in St. Petersburg from February 10 to 16</a></li>
<li><a href="../en487702/index.html">A selection of articles on machine learning: case studies, guides and research for January 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>