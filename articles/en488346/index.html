<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèΩ üëî üõ∑ Installing or-tools with SCIP and GLPK in a Python 3.7 virtual environment on Linux „ÄΩÔ∏è üßùüèª üë©üèæ‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to participate in the competition and it was necessary to use packages for him to solve optimization problems. I chose the Google tool or-to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Installing or-tools with SCIP and GLPK in a Python 3.7 virtual environment on Linux</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488346/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I decided to participate in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">competition</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and it was necessary to use packages for him to solve optimization problems. I chose the Google tool or-tools, which is an interface for different solvers (or solved? Solvers?). It contains several optimization tools, but the creators claim support for several external packages, including commercial Gurobi and CPLEX. However, we are not rich people, and we will use free SCIP and GLPK (from a domestic developer, by the way). To my surprise, not a single instruction on how to make all this splendor work in a virtual python environment, I did not find on the open spaces of both our and English-speaking segments of the Internet and I had to tinker a bit. For those in a hurry, read right </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, I suggest the rest to get acquainted with the dubious quality of my graphomania, which describes the ups and downs of installing Google software. </font><font style="vertical-align: inherit;">Yes, I forgot to say right away that everything was installed in Manjaro Linux.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/gw/8m/75gw8mhfuapb7_nnlw5sqojqqsy.jpeg"><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First steps</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All three packages exist in the python repository, so we install from via pip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each of them has its own interface, and or-tools was chosen just in order to try various packages, without significant rewriting of the program, so the task is for or-tools to pick up these solvers and let them run through itself. And what do you think? Installed via pip or-tools does not see installed solvers through pip, and they do not see it (who would have thought). So, you still need to look at what they write in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the docks they write what needs to be collected from source so that or-tools picks up external packages. We try to collect, and nothing comes out, because the solvers installed through pip are not visible.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accordingly, the easiest ways to install all packages through pip do not work, because or-tools does not pull solvers, solvers do not install libraries as or-tools wants, everyone pours errors at you, they call you stupid and laugh in every possible way. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docks they</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> write that it is necessary to collect solvers from source codes, then from-source to collect or-tools itself. No sooner said than done! Installed SCIP, installed GLPK, but the question arose not described in the documentation was how to put or-tools in a virtual environment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only make python command on the docks installs the package globally on the system (surprisingly, huh?).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, I was lucky: in the course of an engineering search using the endless monkey method, I accidentally typed make help and I was given a list of all or-tools build options, among which was the opportunity to build a wheel package. </font><font style="vertical-align: inherit;">This is the make python_package command, if that (I will repeat it again at the end). </font><font style="vertical-align: inherit;">So, is it time to build and launch?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dn/qt/ik/dnqtikqqxkpq0cikdeztah5vbhy.jpeg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Looking for a problem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nothing works at the or-tools build phase, it swears at the bad GLPK libraries. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s7/jk/hf/s7jkhfkk7dsth24dsdu0nioeoeo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Build with SCIP with the parameters from the documentation is successful, but or-tools still refuses to work at the time of import. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zo/wi/z0/zowiz0hm9zym0_ujyvnje0doxbg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I could not find a solution to these problems on my own, so I went to the github for the developers to ask why the installation according to their instructions produces errors somewhere inside their code. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/oa/yr/ftoayrje4g6tl7kx2mfbcadualw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hmm, thanks for the clarification.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
While I was waiting for an answer on the github, I rummaged around the Internet, hoping to find something that would help me. And as it is not surprising, I found it. It was </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project team lead </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">blog</font></a><font style="vertical-align: inherit;"> where he wrote on how to link GLPK with or-tools. And this method finally worked! Now, if you build everything without SCIP, but with GLPK, then you can even work with this. Already progress.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the or-tools team lead did not advise using GLPK, saying that the results are not important, and I still want to defeat SCIP and make it work. </font><font style="vertical-align: inherit;">Neighboring </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">post</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the blog came across the idea that Google release package works with specific versions. </font><font style="vertical-align: inherit;">We look at the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list of release changes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and see explicit indication of version 6.0.0 there. </font><font style="vertical-align: inherit;">Despite the fact that version 6.0.2 is indicated in the makefile, we are trying to install an older version and voila! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And now again, a working sequence of actions.</font></font><br>
<a name="guide"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation sequence</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download archive SCIP, making sure that </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">there</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is clearly indicated support for the version that you download (in my case </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">developers.google.com/optimization/support/release_notes#support-for-scip-6.0.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and unpack.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download GLPK (at the time of post the latest version 4.65) and unzip.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install SCIP command </font></font><br>
<br>
<pre><code class="bash hljs">make GMP=<span class="hljs-literal">false</span> READLINE=<span class="hljs-literal">false</span> TPI=tny ZIMPL=<span class="hljs-literal">false</span> scipoptlib install INSTALLDIR=&lt;path&gt;/scipoptsuite-6.0.0
</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install GLPK with the command:</font></font><br>
<br>
<pre><code class="bash hljs">./configure --prefix=&lt;install_path&gt; --with-pic --<span class="hljs-built_in">enable</span>-shared<font></font>
make<font></font>
make install<font></font>
</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download OR-Tools from github</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/google/or-tools</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install OR-Tools with the commands:</font></font><br>
<br>
<pre><code class="bash hljs">make third_party<font></font>
make python_package<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the last command does not work, install wheel with the command:</font></font><br>
<br>
<pre><code class="bash hljs">pip install wheel</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To activate the virtual environment go to the folder with the Python package and install it from there. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you need to install not in a virtual environment, but globally for the whole system instead:</font></font><br>
<br>
<pre><code class="bash hljs">make python_package</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
execute the command:</font></font><br>
<br>
<pre><code class="bash hljs">make python
</code></pre></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488332/index.html">Zero, one, two, Freddy will pick you up</a></li>
<li><a href="../en488336/index.html">Tips for Using the Wave Function Collapse Algorithm</a></li>
<li><a href="../en488338/index.html">Google Internships: Zurich, London, and Silicon Valley</a></li>
<li><a href="../en488340/index.html">Profession: Backend Developer</a></li>
<li><a href="../en488342/index.html">Random Forest, the method of principal components and optimization of hyperparameters: an example of solving the classification problem in Python</a></li>
<li><a href="../en488348/index.html">Webinar ‚ÄúTen Top Agile Challenges and Ways to Overcome Them in an Hour‚Äù February 17 at 20:00 Moscow time</a></li>
<li><a href="../en488352/index.html">VDI Cost Comparison: On-premise versus Public Cloud</a></li>
<li><a href="../en488356/index.html">Training at St. Petersburg State Marine Technical University for Dassault Syst√®mes products</a></li>
<li><a href="../en488360/index.html">Big Data Myths and Digital Culture</a></li>
<li><a href="../en488362/index.html">Multi-tagged classification</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>