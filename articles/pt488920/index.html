<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👉🏼 ⬇️ 😱 Determinar o tamanho apropriado para o cluster Kafka no Kubernetes 🚣🏻 😅 👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : Neste artigo, o Banzai Cloud compartilha um exemplo do uso de seus utilitários especiais para facilitar a operação do Kafka no Kubernete...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Determinar o tamanho apropriado para o cluster Kafka no Kubernetes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/488920/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota perev.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Neste artigo, o Banzai Cloud compartilha um exemplo do uso de seus utilitários especiais para facilitar a operação do Kafka no Kubernetes. Estas instruções ilustram como você pode determinar o tamanho ideal da infraestrutura e configurar o próprio Kafka para alcançar a taxa de transferência necessária.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/hw/a_/x4/hwa_x4pat6hztyyuh8lorl015pq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O Apache Kafka é uma plataforma de streaming distribuída para criar sistemas de streaming confiáveis, escaláveis ​​e de alto desempenho em tempo real. Seus recursos impressionantes podem ser expandidos com o Kubernetes. Para isso, desenvolvemos o</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operador Kafka Open Source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e uma ferramenta chamada</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Supertubes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Eles permitem executar o Kafka no Kubernetes e usar suas várias funções, como ajustar a configuração do broker, escalar com base em métricas com rebalanceamento, reconhecimento do rack (conhecimento dos recursos de hardware), </font><font style="vertical-align: inherit;">atualizações contínuas </font><font style="vertical-align: inherit;">"suaves" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(graciosas)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.</font></font><a name="habracut"></a><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experimente os Supertubes no seu cluster:</font></font><br>
<br>
<pre><code class="bash hljs">curl https://getsupertubes.sh | sh  supertubes install -a --no-democluster --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou consulte a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Você também pode ler sobre alguns dos recursos do Kafka, que são automatizados com a ajuda dos Supertubes e do operador Kafka. </font><font style="vertical-align: inherit;">Já escrevemos sobre eles no blog:</font></font><br>
<br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ah não! </font><font style="vertical-align: inherit;">Mais um operador da Kafka para a Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitorar e operar Kafka com base nas métricas do Prometheus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conhecimento de Kafka sobre Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Executando o Apache Kafka sobre o Istio - benchmark</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usuário autenticado e acessado por clusters controlados com o operador Kafka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualização rolante Kafka e configuração dinâmica no Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filtro de protocolo enviado para Kafka, em malha</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando você decide implantar um cluster Kafka no Kubernetes, provavelmente encontrará o problema de determinar o tamanho ideal da infraestrutura subjacente e a necessidade de ajustar a configuração Kafka para atender aos requisitos de largura de banda. </font><font style="vertical-align: inherit;">O desempenho máximo de cada broker é determinado pelo desempenho dos componentes da infraestrutura em seu núcleo, como memória, processador, velocidade do disco, largura de banda da rede etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Idealmente, a configuração do broker deve ser tal que todos os elementos da infraestrutura sejam utilizados ao máximo de seus recursos. No entanto, na vida real, essa configuração é muito complicada. É mais provável que os usuários configurem os intermediários de forma a maximizar o uso de um ou dois componentes (disco, memória ou processador). De um modo geral, um broker mostra desempenho máximo quando sua configuração permite que você use o componente mais lento "na íntegra". Portanto, podemos ter uma idéia aproximada da carga que um corretor pode suportar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teoricamente, também podemos estimar o número de corretores necessários para trabalhar com uma determinada carga. No entanto, na prática, existem tantas opções de configuração em vários níveis que é muito difícil (se não impossível) avaliar o desempenho potencial de uma determinada configuração. Em outras palavras, é muito difícil planejar a configuração, começando com um determinado desempenho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para usuários do Supertubes, geralmente adotamos a seguinte abordagem: comece com algumas configurações (infraestrutura + configurações), depois avalie seu desempenho, ajuste as configurações do broker e repita o processo novamente. Isso acontece até que o potencial do componente mais lento da infraestrutura seja totalmente utilizado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dessa forma, temos uma idéia mais clara de quantos intermediários um cluster precisa para lidar com uma certa carga (o número de intermediários também depende de outros fatores, como o número mínimo de réplicas de mensagens para garantir a estabilidade, o número de líderes de partição etc.). Além disso, temos uma idéia de qual escala vertical de componente de infraestrutura é desejada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este artigo discutirá as etapas que tomamos para "espremer tudo" dos componentes mais lentos nas configurações iniciais e medir a taxa de transferência do cluster Kafka. Uma configuração altamente resiliente requer pelo menos três agentes de trabalho (</font></font><code>min.insync.replicas=3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) espaçados em três zonas de acessibilidade diferentes. </font><font style="vertical-align: inherit;">Para configurar, dimensionar e monitorar a infraestrutura Kubernetes, usamos nossa própria plataforma de gerenciamento de contêiner de nuvem híbrida - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pipeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ele suporta no local (bare metal, VMware) e cinco tipos de nuvens (Alibaba, AWS, Azure, Google, Oracle), bem como qualquer combinação dos mesmos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reflexões sobre a infraestrutura e a configuração do cluster Kafka</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para os exemplos abaixo, selecionamos a AWS como o provedor de serviços em nuvem e o EKS como a distribuição Kubernetes. </font><font style="vertical-align: inherit;">Uma configuração semelhante pode ser implementada usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , uma distribuição Kubernetes da Banzai Cloud, certificada pelo CNCF.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disco</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A Amazon oferece vários </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos de volumes EBS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Os SSDs são a </font><font style="vertical-align: inherit;">base de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gp2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no entanto, para garantir alto rendimento, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gp2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consome empréstimos acumulados </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(créditos de E / S)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; portanto, preferimos o tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que oferece alto rendimento estável.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipos de Instância</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O desempenho do Kafka é altamente dependente do cache de páginas do sistema operacional, portanto, precisamos de instâncias com memória suficiente para JVMs e cache de páginas. A instância </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.2xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é um bom começo, pois possui 16 GB de memória e é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otimizada para trabalhar com o EBS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sua desvantagem é que ele é capaz de fornecer desempenho máximo por não mais de 30 minutos a cada 24 horas. Se sua carga de trabalho exigir desempenho máximo por um período maior, observe outros tipos de instâncias. Fizemos exatamente isso, parando em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.4xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ele fornece uma taxa de transferência máxima de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">593,75 Mb / s.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A taxa de transferência máxima do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volume</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EBS </font><i><font style="vertical-align: inherit;">io1 é</font></i><font style="vertical-align: inherit;"> maior que a da instância </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.4xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; portanto, o elemento de infraestrutura mais lento é provavelmente a taxa de transferência de E / S desse tipo de instância (que também deve ser confirmada pelos resultados de nossos testes de carga).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A largura de banda da rede deve ser muito grande em comparação com o desempenho da instância e do disco da VM, caso contrário, a rede se tornará um gargalo. </font><font style="vertical-align: inherit;">No nosso caso, a interface de rede </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.4xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suporta velocidades de até 10 Gb / s, o que é significativamente maior que a largura de banda da instância de E / S da VM.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implantação do Broker</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os intermediários devem ser implantados (planejados no Kubernetes) em nós dedicados, a fim de evitar a concorrência com outros processos de recursos de processador, memória, rede e disco.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versão Java</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A escolha lógica é Java 11, porque é compatível com o Docker no sentido de que a JVM determina corretamente os processadores e a memória disponível para o contêiner no qual o broker é executado. </font><font style="vertical-align: inherit;">Sabendo que os limites do processador são importantes, a JVM define interna e transparentemente o número de threads do GC e do compilador JIT. </font><font style="vertical-align: inherit;">Usamos uma imagem Kafka </font></font><code>banzaicloud/kafka:2.13-2.4.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que inclui a versão 2.4.0 do Kafka (Scala 2.13) no Java 11.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você quiser saber mais sobre Java / JVM no Kubernetes, consulte nossas publicações a seguir:</font></font><br>
<br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que meu aplicativo Java é OOMKilled</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como dimensionar corretamente contêineres para aplicativos Java 10</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurações de memória do corretor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Há dois aspectos principais na configuração da memória do broker: configurações para a JVM e para o pod Kubernetes. </font><font style="vertical-align: inherit;">O limite de memória definido para o pod deve ser maior que o tamanho máximo de heap para que a JVM tenha espaço suficiente para o metasspace de Java em sua própria memória e para o cache da página do sistema operacional que Kafka está usando ativamente. </font><font style="vertical-align: inherit;">Em nossos testes, lançamos os corretores Kafka com parâmetros </font></font><code>-Xmx4G -Xms2G</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e o limite de memória para o pod era </font></font><code>10 Gi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Observe que as configurações de memória para a JVM podem ser obtidas automaticamente usando </font></font><code>-XX:MaxRAMPercentage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>-X:MinRAMPercentage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, com base no limite de memória para o pod.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurações do processador do intermediário</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De um modo geral, você pode aumentar a produtividade aumentando a simultaneidade aumentando o número de threads usados ​​pelo Kafka. </font><font style="vertical-align: inherit;">Quanto mais processadores disponíveis para o Kafka, melhor. </font><font style="vertical-align: inherit;">Em nosso teste, começamos com um limite de 6 processadores e gradualmente (iteramos) aumentamos seu número para 15. Além disso, definimos </font></font><code>num.network.threads=12</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nas </font><font style="vertical-align: inherit;">configurações </font><font style="vertical-align: inherit;">do broker para aumentar o número de fluxos que recebem dados da rede e os enviam. </font><font style="vertical-align: inherit;">Tendo descoberto imediatamente que os intermediários seguidores não podem receber réplicas com rapidez suficiente, eles aumentaram </font></font><code>num.replica.fetchers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para 4 para aumentar a velocidade com que os intermediários replicadores replicavam mensagens dos líderes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ferramenta de geração de carga</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certifique-se de que o potencial do gerador de carga selecionado não se esgote antes que o cluster Kafka (cujo benchmark esteja em execução) atinja sua carga máxima. </font><font style="vertical-align: inherit;">Em outras palavras, é necessário realizar uma avaliação preliminar dos recursos da ferramenta de geração de carga, bem como selecionar tipos de instâncias para ela com um número suficiente de processadores e memória. </font><font style="vertical-align: inherit;">Nesse caso, nossa ferramenta produzirá mais carga do que o cluster Kafka pode digerir. </font><font style="vertical-align: inherit;">Após muitas experiências, decidimos por três cópias de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.4xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em cada uma das quais o gerador foi lançado.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avaliação comparativa</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A medição de desempenho é um processo iterativo que inclui as seguintes etapas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configuração da infraestrutura (cluster EKS, cluster Kafka, ferramenta de geração de carga, além de Prometheus e Grafana);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geração de carga por um determinado período para filtrar desvios aleatórios nos indicadores de desempenho coletados;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ajuste fino da infraestrutura e configuração do broker com base nos indicadores de desempenho observados;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repetindo o processo até que o nível necessário de largura de banda do cluster Kafka seja atingido. </font><font style="vertical-align: inherit;">Ao mesmo tempo, deve ser reproduzível de forma estável e demonstrar variações mínimas de largura de banda.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A próxima seção descreve as etapas que foram executadas durante o cluster de teste de benchmark.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ferramentas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As seguintes ferramentas foram usadas para implantar rapidamente a configuração básica, geração de carga e medição de desempenho:</font></font><br>
<br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Banzai Cloud Pipeline</a>    EKS  Amazon c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prometheus</a> (   Kafka  )  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Grafana</a> (   ).   <b></b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pipeline</a> ,    ,   ,  ,   ,      .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sangrenel</a> —      Kafka.</li>
<li>  Grafana    Kafka  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Kubernetes Kafka</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Node Exporter</a>.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supertubes CLI para a maneira mais fácil de configurar um cluster Kafka no Kubernetes. </font><font style="vertical-align: inherit;">O Zookeeper, o operador Kafka, o Envoy e muitos outros componentes estão instalados e configurados adequadamente para executar o cluster Kafka pronto para produção no Kubernetes.</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para instalar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supertubes CLI,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> use as instruções fornecidas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul></li>
</ul><br>
<img src="https://habrastorage.org/webt/98/xv/7i/98xv7iy-cxitdjo3xakipblgp5u.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster EKS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prepare um cluster EKS com nós de trabalho </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c5.4xlarge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dedicados </font><font style="vertical-align: inherit;">em várias zonas de disponibilidade para pods com intermediários Kafka, bem como nós dedicados para o gerador de carga e a infraestrutura de monitoramento.</font></font><br>
<br>
<pre><code class="bash hljs">banzai cluster create -f https://raw.githubusercontent.com/banzaicloud/kafka-operator/master/docs/benchmarks/infrastructure/cluster_eks_202001.json</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando o cluster EKS estiver operacional, ative seu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serviço de monitoramento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> integrado </font><font style="vertical-align: inherit;">- ele implementará o Prometheus e o Grafana no cluster.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componentes do sistema Kafka</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale os componentes do sistema Kafka (Zookeeper, kafka-operator) no EKS usando CLI de supertubos:</font></font><br>
<br>
<pre><code class="bash hljs">supertubes install -a --no-democluster --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt;</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kafka Cluster</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por padrão, o EKS usa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volumes gp2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EBS </font><font style="vertical-align: inherit;">, portanto, você precisa criar uma classe de armazenamento separada com base nos volumes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para o cluster Kafka:</font></font><br>
<br>
<pre><code class="plaintext hljs">kubectl create -f - &lt;&lt;EOF<font></font>
apiVersion: storage.k8s.io/v1<font></font>
kind: StorageClass<font></font>
metadata:<font></font>
  name: fast-ssd<font></font>
provisioner: kubernetes.io/aws-ebs<font></font>
parameters:<font></font>
  type: io1<font></font>
  iopsPerGB: "50"<font></font>
  fsType: ext4<font></font>
volumeBindingMode: WaitForFirstConsumer<font></font>
EOF</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Defina um parâmetro para intermediários </font></font><code>min.insync.replicas=3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e implemente pods de intermediários em nós em três zonas de disponibilidade diferentes:</font></font><br>
<br>
<pre><code class="bash hljs">supertubes cluster create -n kafka --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt; -f https://raw.githubusercontent.com/banzaicloud/kafka-operator/master/docs/benchmarks/infrastructure/kafka_202001_3brokers.yaml --<span class="hljs-built_in">wait</span> --timeout 600</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tópicos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lançamos simultaneamente três instâncias do gerador de carga. </font><font style="vertical-align: inherit;">Cada um deles escreve em seu próprio tópico, ou seja, tudo o que precisamos é de três tópicos:</font></font><br>
<br>
<pre><code class="bash hljs">supertubes cluster topic create -n kafka --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt; -f -&lt;&lt;EOF<font></font>
apiVersion: kafka.banzaicloud.io/v1alpha1<font></font>
kind: KafkaTopic<font></font>
metadata:<font></font>
  name: perftest1<font></font>
spec:<font></font>
  name: perftest1<font></font>
  partitions: 12<font></font>
  replicationFactor: 3<font></font>
  retention.ms: <span class="hljs-string">'28800000'</span><font></font>
  cleanup.policy: delete<font></font>
EOF<font></font>
<font></font>
supertubes cluster topic create -n kafka --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt; -f -&lt;&lt;EOF<font></font>
apiVersion: kafka.banzaicloud.io/v1alpha1<font></font>
kind: KafkaTopic<font></font>
metadata:<font></font>
    name: perftest2<font></font>
spec:<font></font>
  name: perftest2<font></font>
  partitions: 12<font></font>
  replicationFactor: 3<font></font>
  retention.ms: <span class="hljs-string">'28800000'</span><font></font>
  cleanup.policy: delete<font></font>
EOF<font></font>
<font></font>
supertubes cluster topic create -n kafka --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt; -f -&lt;&lt;EOF<font></font>
apiVersion: kafka.banzaicloud.io/v1alpha1<font></font>
kind: KafkaTopic<font></font>
metadata:<font></font>
  name: perftest3<font></font>
spec:<font></font>
  name: perftest3<font></font>
  partitions: 12<font></font>
  replicationFactor: 3<font></font>
  retention.ms: <span class="hljs-string">'28800000'</span><font></font>
  cleanup.policy: delete<font></font>
EOF</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para cada tópico, o fator de replicação é 3 - o valor mínimo recomendado para sistemas de produção altamente disponíveis.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ferramenta de geração de carga</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lançamos três instâncias do gerador de carga (cada uma escreveu em um tópico separado). </font><font style="vertical-align: inherit;">Para pods do gerador de carga, é necessário registrar a afinidade do nó para que eles sejam planejados apenas nos nós alocados para eles:</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: extensions/v1beta1<font></font>
kind: Deployment<font></font>
metadata:<font></font>
  labels:<font></font>
    app: loadtest<font></font>
  name: perf-load1<font></font>
  namespace: kafka<font></font>
spec:<font></font>
  progressDeadlineSeconds: 600<font></font>
  replicas: 1<font></font>
  revisionHistoryLimit: 10<font></font>
  selector:<font></font>
    matchLabels:<font></font>
      app: loadtest<font></font>
  strategy:<font></font>
    rollingUpdate:<font></font>
      maxSurge: 25%<font></font>
      maxUnavailable: 25%<font></font>
    type: RollingUpdate<font></font>
  template:<font></font>
    metadata:<font></font>
      creationTimestamp: null<font></font>
      labels:<font></font>
        app: loadtest<font></font>
    spec:<font></font>
      affinity:<font></font>
        nodeAffinity:<font></font>
          requiredDuringSchedulingIgnoredDuringExecution:<font></font>
            nodeSelectorTerms:<font></font>
            - matchExpressions:<font></font>
              - key: nodepool.banzaicloud.io/name<font></font>
                operator: In<font></font>
                values:<font></font>
                - loadgen<font></font>
      containers:<font></font>
      - args:<font></font>
        - -brokers=kafka-0:29092,kafka-1:29092,kafka-2:29092,kafka-3:29092<font></font>
        - -topic=perftest1<font></font>
        - -required-acks=all<font></font>
        - -message-size=512<font></font>
        - -workers=20<font></font>
        image: banzaicloud/perfload:0.1.0-blog<font></font>
        imagePullPolicy: Always<font></font>
        name: sangrenel<font></font>
        resources:<font></font>
          limits:<font></font>
            cpu: 2<font></font>
            memory: 1Gi<font></font>
          requests:<font></font>
            cpu: 2<font></font>
            memory: 1Gi<font></font>
        terminationMessagePath: /dev/termination-log<font></font>
        terminationMessagePolicy: File<font></font>
      dnsPolicy: ClusterFirst<font></font>
      restartPolicy: Always<font></font>
      schedulerName: default-scheduler<font></font>
      securityContext: {}<font></font>
      terminationGracePeriodSeconds: 30</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguns pontos para prestar atenção:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O gerador de carregamento gera mensagens de 512 bytes e as publica no Kafka em lotes de 500 mensagens.</font></font></li>
<li>    <code>-required-acks=all</code>   ,          Kafka.  ,          ,  ,    ,  .           <i>(consumers)</i>   ,       ,       ,   .</li>
<li>     20 worker' (<code>-workers=20</code>).  worker  5 producer',     worker'   Kafka.      100 producer',        Kafka.</li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoramento de Cluster</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante o teste de estresse do cluster Kafka, também monitoramos sua integridade para garantir que não houvesse reinicializações de pod, réplicas fora de sincronia e taxa de transferência máxima com flutuações mínimas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O gerador de carregamento grava estatísticas padrão no número de mensagens publicadas e no nível de erros. </font><font style="vertical-align: inherit;">A porcentagem de erros deve permanecer no valor </font></font><code>0,00%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Cruise Control</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , implementado pelo kafka-operator, fornece um painel no qual também podemos monitorar o estado do cluster. </font><font style="vertical-align: inherit;">Para visualizar este painel, faça:</font></font><br>
<br>
<pre><code class="bash hljs">supertubes cluster cruisecontrol show -n kafka --kubeconfig &lt;path-to-eks-cluster-kubeconfig-file&gt;</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O nível ISR </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(contagem de réplicas em sincronização) de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> redução e expansão é 0.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resultados de medição</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 intermediários, tamanho da mensagem - 512 bytes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com partições distribuídas igualmente entre três intermediários, conseguimos obter um desempenho de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ 500 Mb / s (aproximadamente 990 mil mensagens por segundo)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ql/5s/kk/ql5skk9eq59vw1dxiptnpv5baoo.png"><br>
<br>
<img src="https://habrastorage.org/webt/ye/cg/rc/yecgrcrh-mrdchebbysisw4mg3a.png"><br>
<br>
<img src="https://habrastorage.org/webt/5i/t6/it/5it6itlq4hfnndz2f-refjm1sbq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O consumo de memória da máquina virtual da JVM não excedeu 2 GB: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/_s/-f/pc_s-fapugnsmx114p1rssgst8m.png"><br>
<br>
<img src="https://habrastorage.org/webt/2e/1-/qw/2e1-qwc0rb2fqk_bw_hkgr0jbl8.png"><br>
<br>
<img src="https://habrastorage.org/webt/m-/tr/nw/m-trnwodxrqpftqhnrnp35f25cy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A largura de banda do disco atingiu a largura de banda máxima de E / S o nó nas três instâncias em que os intermediários trabalharam: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tr/tx/tg/trtxtgaqntrbc_bwrxmxmxh9opu.png"><br>
<br>
<img src="https://habrastorage.org/webt/_k/ns/dh/_knsdhmjkkc2245qffym_pnkxge.png"><br>
<br>
<img src="https://habrastorage.org/webt/rq/xo/8x/rqxo8xwg5dualnt3uqt2jxmfeta.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir dos dados sobre o uso da memória pelos nós, segue-se que o buffer e o cache do sistema levaram de 10 a 15 GB:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p3/ls/r6/p3lsr6ixa3wx0zfeowuqo_qlpq0.png"><br>
<br>
<img src="https://habrastorage.org/webt/aq/tn/fd/aqtnfdsjnp33e3buy5dxkrvojg4.png"><br>
<br>
<img src="https://habrastorage.org/webt/pi/aa/iv/piaaivarggmqsqiopmtx_doi4tg.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 intermediários, tamanho da mensagem - 100 bytes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com uma diminuição no tamanho da mensagem, a taxa de transferência diminui de 15 a 20%: o tempo gasto no processamento de cada mensagem é afetado. </font><font style="vertical-align: inherit;">Além disso, a carga do processador quase dobrou. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mp/9l/9l/mp9l9lcmuwuh866dce_v0puzrt0.png"><br>
<br>
<img src="https://habrastorage.org/webt/z0/ck/hd/z0ckhdrst6iqql9i5drcksb7y7i.png"><br>
<br>
<img src="https://habrastorage.org/webt/hu/dg/dp/hudgdpo3e8s0ft0zxd7tngwne3y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como os nós do broker ainda têm kernels não utilizados, você pode melhorar o desempenho alterando a configuração do Kafka. </font><font style="vertical-align: inherit;">Esta não é uma tarefa fácil, portanto, para aumentar a taxa de transferência, é melhor trabalhar com mensagens maiores.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 intermediários, tamanho da mensagem - 512 bytes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode aumentar facilmente o desempenho do cluster Kafka simplesmente adicionando novos intermediários e mantendo o equilíbrio das partições (isso garante distribuição uniforme de carga entre os intermediários). </font><font style="vertical-align: inherit;">No nosso caso, após adicionar um broker, a taxa de transferência do cluster aumentou para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ 580 Mb / s (~ 1,1 milhão de mensagens por segundo)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O crescimento acabou sendo menor do que o esperado: isso se deve principalmente ao desequilíbrio das partições (nem todos os corretores trabalham no pico de oportunidades). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8x/cs/nq/8xcsnqeafi6tom_rxrbb5jz1zmk.png"><br>
<br>
<img src="https://habrastorage.org/webt/_2/qm/2j/_2qm2jqmcig_qwnypgirtzwcnw0.png"><br>
<br>
<img src="https://habrastorage.org/webt/zn/vx/jm/znvxjmy9hpxm3c29l-x616hfyfa.png"><br>
<br>
<img src="https://habrastorage.org/webt/gm/mt/sc/gmmtscxckvpwqr3ypzmkz45jscu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O consumo de memória da máquina JVM permanece abaixo de 2 GB: O </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a7/w7/qh/a7w7qh73p6ug6ozgqksh224fanc.png"><br>
<br>
<img src="https://habrastorage.org/webt/pe/cn/gs/pecngsl4nhacfu1drnmevl3p96q.png"><br>
<br>
<img src="https://habrastorage.org/webt/ee/vh/ei/eevheiyiaf_sxnw8epxlsnizxak.png"><br>
<br>
<img src="https://habrastorage.org/webt/lz/gj/lb/lzgjlblbytxjujal32u1nmgjixo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
desequilíbrio de partição afetou a operação de intermediários com unidades:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4w/ga/3j/4wga3j3ogq8d_pesoite7ln9alk.png"><br>
<br>
<img src="https://habrastorage.org/webt/jb/sh/rl/jbshrlplduwv4xrnfdhab65auy8.png"><br>
<br>
<img src="https://habrastorage.org/webt/3r/dw/ox/3rdwox-qntdekifec-vuoooozuc.png"><br>
<br>
<img src="https://habrastorage.org/webt/oz/ux/cd/ozuxcdtsqz-rfgwmun8iljtgxcq.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">achados</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A abordagem iterativa apresentada acima pode ser estendida para cobrir cenários mais complexos, incluindo centenas de consumidores, reparticionamento, atualizações contínuas, reinicializações de pods etc. Tudo isso nos permite avaliar os limites das capacidades do cluster Kafka em várias condições, identificar gargalos em seu trabalho e encontrar maneiras de lidar com eles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desenvolvemos Supertubes para implantar de forma rápida e fácil um cluster, configurá-lo, adicionar / remover agentes e tópicos, responder a alertas e garantir que o Kafka funcione corretamente no Kubernetes como um todo. Nosso objetivo é ajudar a concentrar-se na tarefa principal (“gerar” e “consumir” mensagens Kafka) e fornecer todo o trabalho duro aos operadores de Supertubes e Kafka.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você estiver interessado nas tecnologias Banzai Cloud e nos projetos de código aberto, assine a empresa no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkedIn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twitter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS do tradutor</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leia também no nosso blog:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma história com o operador Redis nos K8s e uma mini visão geral dos utilitários para analisar dados desse banco de dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migração desobstruída do RabbitMQ para Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zetcd do CoreOS: Substituindo o ZooKeeper por ... armazenamento etcd</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ."</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt488908/index.html">Copywriter do KPI ou características da avaliação do trabalho de autores remotos na equipe e freelancers</a></li>
<li><a href="../pt488910/index.html">O livro “Amor e Matemática. O coração da realidade oculta</a></li>
<li><a href="../pt488912/index.html">Previsão de preço do Bitcoin News em Python</a></li>
<li><a href="../pt488916/index.html">Cascadeur: O problema do gato que cai</a></li>
<li><a href="../pt488918/index.html">Data Engineer or die: uma única história de desenvolvedor</a></li>
<li><a href="../pt488926/index.html">5 cursos gratuitos para engenheiros de IA da Microsoft</a></li>
<li><a href="../pt488946/index.html">Menu do console Python</a></li>
<li><a href="../pt488948/index.html">UPD. Testando a API REST no Golang. 120 000 [# / s] não é o limite?</a></li>
<li><a href="../pt488950/index.html">Tempo em uma máquina celular</a></li>
<li><a href="../pt488952/index.html">Análise de sentimentos de frases usando redes neurais</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>