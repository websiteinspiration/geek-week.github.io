<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“‘ ğŸ™‡ğŸ½ ğŸ‘ˆğŸ½ etcd 3.4.3: SpeicherzuverlÃ¤ssigkeits- und Sicherheitsforschung ğŸ˜º ğŸ‘ŠğŸ½ ğŸ‘‚ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hinweis perev. : Der Inhalt dieses Artikels ist nicht ganz typisch fÃ¼r unseren Blog. Wie viele wissen, befindet sich etcd jedoch im Herzen von Kuberne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>etcd 3.4.3: SpeicherzuverlÃ¤ssigkeits- und Sicherheitsforschung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/487534/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis perev.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Der Inhalt dieses Artikels ist nicht ganz typisch fÃ¼r unseren Blog. Wie viele wissen, befindet sich etcd jedoch im Herzen von Kubernetes, weshalb sich diese Studie, die von einem unabhÃ¤ngigen Berater auf dem Gebiet der ZuverlÃ¤ssigkeit durchgefÃ¼hrt wurde, unter Ingenieuren, die dieses System betreiben, als interessant herausstellte. Interessant ist auch, wie Open Source-Projekte, die sich bereits in der Produktion bewÃ¤hrt haben, auch auf einem so "niedrigen" Niveau verbessert werden.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/xd/av/d3/xdavd35rjqklgnrnd-0wulkpayo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tresor fÃ¼r</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SchlÃ¼sselwerte (KV)</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"> usw.</font></a><font style="vertical-align: inherit;"> ist eine verteilte Datenbank, die auf dem Raft-Konsensalgorithmus basiert. In einer</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2014 durchgefÃ¼hrten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Analyse</font><font style="vertical-align: inherit;">haben wir festgestellt, dass etcd 0.4.1 standardmÃ¤ÃŸig von den sogenannten veralteten LesevorgÃ¤ngen betroffen ist</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Leseoperationen, die aufgrund einer VerzÃ¶gerung der Synchronisation einen alten, irrelevanten Wert zurÃ¼ckgeben - ca. Ã¼bersetzt)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir haben uns entschlossen, zu etcd zurÃ¼ckzukehren (diesmal zu Version 3.4.3), um das Potenzial im Bereich ZuverlÃ¤ssigkeit und Sicherheit erneut im Detail zu bewerten.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben festgestellt, dass die Operation mit Paaren von "SchlÃ¼sselwerten" streng serialisierbar ist und dass die Prozesse des Beobachters </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Uhren)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bei jeder Ã„nderung des BestellschlÃ¼ssels geliefert werden. </font><font style="vertical-align: inherit;">Allerdings </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SchlÃ¶sser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in ETCD sind grundsÃ¤tzlich unsicher, und die mit ihnen verbundenen Risiken werden durch einen Fehler verschlimmert, als Folge davon die Relevanz des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mietvertrags</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht geprÃ¼ft wird , </font><font style="vertical-align: inherit;">nach einer </font><font style="vertical-align: inherit;">Wartezeit fÃ¼r das Schloss. </font><font style="vertical-align: inherit;">Sie kÃ¶nnen den Kommentar der etcd-Entwickler in unserem Bericht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Projektblog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lesen </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Studie wurde von der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud Native Computing Foundation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (CNCF) gesponsert, die Teil der Linux Foundation ist. </font><font style="vertical-align: inherit;">Es wurde in voller Ãœbereinstimmung mit den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ethischen Richtlinien von Jepsen durchgefÃ¼hrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Hintergrund</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Etc KV-Repository ist ein verteiltes System, das als Grundlage fÃ¼r die Koordination dient. Wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zookeeper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consul</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> speichert etcd kleine Mengen selten aktualisierter Status ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardmÃ¤ÃŸig bis zu 8 GB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) in Form einer SchlÃ¼sselwertzuordnung und bietet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">streng serialisierbare</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lese-, Schreib- und Mikrotransaktionen im gesamten Data Warehouse sowie Koordinationsprimitive wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sperren</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Nachverfolgung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Uhren)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und FÃ¼hrerauswahl. Viele verteilte Systeme wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenStack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwenden etcd, um Cluster-Metadaten zu speichern, koordinierte Ansichten von Daten zu koordinieren, einen Leiter auszuwÃ¤hlen usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Jahr 2014 haben wir bereits eine Bewertung von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcd 0.4.1 durchgefÃ¼hrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dann haben wir festgestellt, dass es aufgrund der Optimierung standardmÃ¤ÃŸig zu veralteten LesevorgÃ¤ngen kommt. WÃ¤hrend in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeit an Raft-Prinzipien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Notwendigkeit erÃ¶rtert wird, LesevorgÃ¤nge in Threads aufzuteilen und diese durch ein Konsenssystem zu leiten, um die LebensfÃ¤higkeit sicherzustellen, liest etcd jeden AnfÃ¼hrer lokal, ohne nach einem aktuelleren Status des neueren Leiters zu suchen. Das etcd-Entwicklungsteam implementierte das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optionale Quorum-Flag</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und in der etcd-Version 3.0-API </font><font style="vertical-align: inherit;">wurde </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardmÃ¤ÃŸig die </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linearisierbarkeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fÃ¼r alle VorgÃ¤nge mit Ausnahme der NachverfolgungsvorgÃ¤nge </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">angezeigt</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die etcd 3.0-API konzentriert sich auf eine flache KV-Karte, in der die SchlÃ¼ssel und Werte undurchsichtig sind</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undurchsichtige</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Byte-Arrays. Mithilfe von Bereichsabfragen kÃ¶nnen Sie hierarchische SchlÃ¼ssel simulieren. Benutzer kÃ¶nnen SchlÃ¼ssel lesen, schreiben und lÃ¶schen sowie den Aktualisierungsfluss fÃ¼r einen einzelnen SchlÃ¼ssel oder SchlÃ¼sselbereich Ã¼berwachen. Das etcd-Toolkit wird durch Leases (variable Objekte mit begrenzter Lebensdauer, die durch Heartbeat-Anforderungen des Clients im aktiven Zustand gehalten werden), Sperren (dedizierte benannte Objekte, die an Leases gebunden sind) und die Auswahl von Leitern ergÃ¤nzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 3.0 bietet etcd eine eingeschrÃ¤nkte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transaktions-API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fÃ¼r atomare Operationen mit vielen SchlÃ¼sseln. </font><font style="vertical-align: inherit;">In diesem Modell ist eine Transaktion ein bedingter Ausdruck mit einem PrÃ¤dikat, einem wahren Zweig und einem falschen Zweig. </font><font style="vertical-align: inherit;">Ein PrÃ¤dikat kann eine Verbindung mehrerer SchlÃ¼sselvergleiche sein: Gleichheit oder verschiedene Ungleichungen, je nach Version eines SchlÃ¼ssels, globaler Revision usw. oder dem aktuellen SchlÃ¼sselwert. </font><font style="vertical-align: inherit;">Wahre und falsche Verzweigungen kÃ¶nnen mehrere Lese- und SchreibvorgÃ¤nge umfassen. </font><font style="vertical-align: inherit;">Alle von ihnen werden abhÃ¤ngig vom Ergebnis der PrÃ¤dikatenschÃ¤tzung atomar angewendet.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1 Garantien fÃ¼r die Konsistenz der Dokumentation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ab Oktober 2019 heiÃŸt es in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation zur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> etcd- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Dokumentation</font></a><font style="vertical-align: inherit;"> : â€Alle API-Aufrufe weisen eine konsistente Konsistenz auf - die stÃ¤rkste Form der Konsistenzgarantie, die auf verteilten Systemen verfÃ¼gbar ist.â€œ Dies ist nicht der Fall: Die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konsistente Konsistenz ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streng schwÃ¤cher als die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linearisierbarkeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Linearisierbarkeit ist definitiv in verteilten Systemen erreichbar. Ferner wird in der Dokumentation angegeben, dass "wÃ¤hrend des Lesevorgangs etcd nicht die Ãœbertragung des [letzten (gemessen durch die externe Uhr nach Abschluss der Anforderung)] Werts garantiert, der auf einem Vertreter des Clusters verfÃ¼gbar ist". Dies ist auch eine zu konservative Aussage: Wenn etcd Linearisierbarkeit bietet, werden Leseoperationen immer mit dem letzten festgeschriebenen Zustand in der Linearisierungsreihenfolge verknÃ¼pft. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Dokumentation behauptet auch, dass etcd eine </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">serialisierbare Isolation</font></a><font style="vertical-align: inherit;"> garantiert</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Alle VorgÃ¤nge (auch solche, die mehrere SchlÃ¼ssel betreffen) werden in einer allgemeinen Reihenfolge ausgefÃ¼hrt. Die Autoren beschreiben die serialisierbare Isolation als "die stÃ¤rkste Isolationsstufe, die in verteilten Systemen verfÃ¼gbar ist". Dies (abhÃ¤ngig davon, was Sie mit der â€Isolationsstufeâ€œ meinen) ist auch nicht wahr; Die strikte Serialisierbarkeit ist stÃ¤rker als die einfache Serialisierbarkeit, wÃ¤hrend die erstere auch in verteilten Systemen erreichbar ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Dokumentation besagt, dass alle Operationen (auÃŸer Tracking) in etcd standardmÃ¤ÃŸig linearisierbar sind. In diesem Fall wird Linearisierbarkeit als Konsistenz mit schwach synchronisierten globalen Uhren definiert. Es ist zu beachten, dass eine solche Definition nicht nur mit der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Definition der Linearisierbarkeit</font></a><font style="vertical-align: inherit;"> unvereinbar ist</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herlihy &amp; Wing impliziert aber auch eine Verletzung der KausalitÃ¤t: Knoten mit fÃ¼hrenden Stunden werden versuchen, die Ergebnisse von Operationen zu lesen, die noch nicht einmal begonnen haben. Wir gehen davon aus, dass etcd immer noch keine Zeitmaschine ist, und da es auf dem Raft-Algorithmus basiert, sollte die allgemein akzeptierte Definition der Linearisierbarkeit angewendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da KV-Operationen in etcd serialisierbar und linearisierbar sind, denken wir, dass etcd standardmÃ¤ÃŸig eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strikte Serialisierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bietet </font><font style="vertical-align: inherit;">. Dies ist sinnvoll, da sich alle SchlÃ¼ssel usw. in einer einzigen Zustandsmaschine befinden und Raft die vollstÃ¤ndige Reihenfolge aller VorgÃ¤nge auf dieser Zustandsmaschine bereitstellt. TatsÃ¤chlich ist der gesamte etcd-Datensatz ein einzelnes linearisierbares Objekt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Optionale Flagge </font></font><code>serializable</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senkt sich</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ebene der LesevorgÃ¤nge von strikter bis zu regulÃ¤rer serialisierbarer Konsistenz, die das Lesen eines veralteten festgeschriebenen Status ermÃ¶glicht. </font><font style="vertical-align: inherit;">Beachten Sie, dass das Flag </font></font><code>serializable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Serialisierbarkeit der Story nicht beeinflusst. </font><font style="vertical-align: inherit;">KV-Operationen etcd sind in allen FÃ¤llen serialisierbar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Testentwicklung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Testsuite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu erstellen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">, haben</font></a><font style="vertical-align: inherit;"> wir die entsprechende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jepsen-Bibliothek verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die Version etcd 3.4.3 (spÃ¤testens ab Oktober 19) wurde analysiert und arbeitete an Debian Stretch-Clustern, die aus 5 Knoten bestehen. Wir haben eine Reihe von Fehlern in diesen Clustern implementiert, darunter Netzwerkpartitionen, Isolieren einzelner Knoten, Aufteilen des Clusters in eine Mehrheit und eine Minderheit sowie nicht-transitive Partitionen mit einer Ã¼berlappenden Mehrheit. Sie haben zufÃ¤llige Untergruppen von Knoten â€fallen gelassenâ€œ und suspendiert sowie FÃ¼hrungskrÃ¤fte absichtlich behindert. Zeitliche Verzerrungen von bis zu mehreren hundert Sekunden wurden sowohl in Intervallen von mehreren Sekunden als auch in Intervallen von Millisekunden eingefÃ¼hrt (schnelles â€Flimmernâ€œ). Da etcd das dynamische Ã„ndern der Anzahl der Komponenten unterstÃ¼tzt, haben wir wÃ¤hrend des Tests zufÃ¤llig Knoten hinzugefÃ¼gt und entfernt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu den Testlasten gehÃ¶rten Register, Sets und Transaktionstests zur ÃœberprÃ¼fung des Betriebs von KV sowie Speziallasten fÃ¼r SchlÃ¶sser und Uhren.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1 Register</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die ZuverlÃ¤ssigkeit von etcd wÃ¤hrend KV-Operationen zu bewerten, wurde ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registertest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entwickelt, </font><font style="vertical-align: inherit;">bei dem zufÃ¤llige Lese-, Schreib-, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichs- und Einstelloperationen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an EinheitsschlÃ¼sseln durchgefÃ¼hrt wurden. </font><font style="vertical-align: inherit;">Die Ergebnisse wurden unter </font><font style="vertical-align: inherit;">Verwendung des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Knossos-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linearisierbarkeitstools unter </font><font style="vertical-align: inherit;">Verwendung des Vergleichs- / Installationsregistermodells und der Versionsinformationen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">bewertet</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2 SÃ¤tze</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um veraltete LesevorgÃ¤nge zu quantifizieren, wurde ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entwickelt </font><font style="vertical-align: inherit;">, der eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichs- und</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Satztransaktion verwendete </font><font style="vertical-align: inherit;">, um einen Satz von Ganzzahlen von einem einzelnen SchlÃ¼ssel zu lesen und diesem Satz dann einen Wert hinzuzufÃ¼gen. </font><font style="vertical-align: inherit;">WÃ¤hrend des Tests haben wir auch eine parallele Ablesung des gesamten Sets durchgefÃ¼hrt. </font><font style="vertical-align: inherit;">Nach Abschluss des Tests wurden die Ergebnisse auf das Auftreten von FÃ¤llen analysiert, in denen das Element, von dem bekannt war, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dass</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es im Satz vorhanden war, in den Leseergebnissen </font><i><font style="vertical-align: inherit;">nicht</font></i><font style="vertical-align: inherit;"> vorhanden war. </font><font style="vertical-align: inherit;">Diese FÃ¤lle wurden verwendet, um veraltete LesevorgÃ¤nge und verlorene Aktualisierungen zu quantifizieren.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3 Test anhÃ¤ngen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die strikte Serialisierbarkeit zu Ã¼berprÃ¼fen, wurde ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Append-Test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entwickelt </font><font style="vertical-align: inherit;">, bei dem Transaktionen parallel gelesen und Listen mit eindeutigen GanzzahlsÃ¤tzen mit Werten versehen wurden. Jede Liste wurde in einem etcd-SchlÃ¼ssel gespeichert, und innerhalb jeder Transaktion wurden ErgÃ¤nzungen vorgenommen, wobei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeder SchlÃ¼ssel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gelesen wurde </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">, der</font></a><font style="vertical-align: inherit;"> in einer Transaktion </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">geÃ¤ndert</font></a><font style="vertical-align: inherit;"> werden musste. AnschlieÃŸend wurden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diese SchlÃ¼ssel geschrieben und</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der zweiten Transaktion, die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">geschÃ¼tzt war, </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">gelesen</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um sicherzustellen, dass sich seit dem ersten Lesen kein aufgezeichneter SchlÃ¼ssel geÃ¤ndert hat. </font><font style="vertical-align: inherit;">Am Ende des Tests haben wir die Beziehung zwischen Transaktionen basierend auf der EchtzeitprioritÃ¤t und der Beziehung zwischen Lese- und Additionsoperationen aufgezeichnet. </font><font style="vertical-align: inherit;">Durch ÃœberprÃ¼fen dieses Diagramms auf Schleifen konnte festgestellt werden, ob die Operationen streng serialisierbar waren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WÃ¤hrend etcd verhindert, dass Transaktionen denselben SchlÃ¼ssel mehrmals schreiben, kÃ¶nnen Sie Transaktionen mit bis zu einem Datensatz pro SchlÃ¼ssel erstellen. </font><font style="vertical-align: inherit;">Wir haben auch sichergestellt, dass LesevorgÃ¤nge innerhalb derselben Transaktion frÃ¼here SchreibvorgÃ¤nge aus derselben Transaktion widerspiegeln.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 SchlÃ¶sser</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Koordinierungsdienst verspricht etcd integrierte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnterstÃ¼tzung fÃ¼r verteiltes Sperren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir haben diese SchlÃ¶sser auf zwei Arten untersucht. ZunÃ¤chst wurden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zufÃ¤llige Sperr- und Entsperranforderungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> generiert </font><font style="vertical-align: inherit;">, die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fÃ¼r jede Sperre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Lease erhielten und diese</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code> keepalive</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bis zur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freigabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mithilfe des integrierten </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">etc-</font></a><font style="vertical-align: inherit;"> Clients im Java-Client </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">geÃ¶ffnet lieÃŸen</font></a><font style="vertical-align: inherit;"> . Wir haben die Ergebnisse mit Knossos getestet, um festzustellen, ob sie eine linearisierte Implementierung des Sperrdienstes bilden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FÃ¼r einen praktischeren Test (und um die HÃ¤ufigkeit von Sperrfehlern zu quantifizieren) haben wir Sperren und etcd verwendet, um den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">gegenseitigen Ausschluss</font></a><font style="vertical-align: inherit;"> zu organisieren, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wenn Aktualisierungen des Satzes im Speicher vorgenommen werden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und suchte nach verlorenen Updates in diesem Set. </font><font style="vertical-align: inherit;">Mit diesem Test konnten wir direkt bestÃ¤tigen, ob Systeme, die etcd als Mutex verwenden, den internen Status sicher aktualisieren kÃ¶nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die dritte Version des </font><font style="vertical-align: inherit;">Sperrtests umfasste SchutzmaÃŸnahmen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fÃ¼r den Lease-SchlÃ¼ssel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um das in etcd gespeicherte Set zu Ã¤ndern.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5 Verfolgung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu Ã¼berprÃ¼fen, ob die Uhren Informationen zu jeder SchlÃ¼sselaktualisierung liefern, wurde im Rahmen des Tests ein SchlÃ¼ssel erstellt und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eindeutige Ganzzahlwerte </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">zugewiesen</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In der Zwischenzeit teilten Kunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesen SchlÃ¼ssel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mehrere Sekunden lang. </font><font style="vertical-align: inherit;">Jedes Mal nach dem Start der Uhr begann der Kunde mit der Ãœberarbeitung, bei der er das letzte Mal gestoppt hatte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende dieses Prozesses haben wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sichergestellt,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass jeder Client dieselbe Abfolge von SchlÃ¼sselÃ¤nderungen beobachtet.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Ergebnisse</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 Tracking ab der 0. Revision</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Verfolgen eines SchlÃ¼ssels kÃ¶nnen Clients eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erste Revision</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angeben </font><font style="vertical-align: inherit;">, bei der es sich um eine optionale Revision handelt, mit der die Verfolgung (einschlieÃŸlich) beginnt. Wenn der Benutzer jede Operation mit einem bestimmten SchlÃ¼ssel sehen mÃ¶chte, kann er die erste Revision von etcd angeben. Was ist dieses Audit? </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Datenmodell</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Glossar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geben keine Antwort auf diese Frage. Revisionen werden als monoton ansteigende 64-Bit-ZÃ¤hler beschrieben, es ist jedoch unklar, ob etcd bei 0 oder 1 beginnt. Es ist vernÃ¼nftig anzunehmen, dass der Countdown von Grund auf neu ist (nur fÃ¼r den Fall). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider ist das falsch. Wenn Sie die 0. Revision anfordern, sendet etcd Updates, beginnend mit der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aktuellen Revision auf dem Server plus eins</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber nicht mit dem allerersten. </font><font style="vertical-align: inherit;">Die Anfrage fÃ¼r die 1. Revision enthÃ¤lt alle Ã„nderungen. </font><font style="vertical-align: inherit;">Dieses Verhalten ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nirgendwo dokumentiert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir glauben, dass diese SubtilitÃ¤t in der Praxis wahrscheinlich nicht zu Produktionsproblemen fÃ¼hrt, da die meisten Cluster bei der ersten Ãœberarbeitung nicht verweilen. </font><font style="vertical-align: inherit;">DarÃ¼ber hinaus ETCD Kompressen die Geschichte ohnehin im </font><font style="vertical-align: inherit;">Laufe der </font><font style="vertical-align: inherit;">Zeit, so in realen Anwendungen, hÃ¶chstwahrscheinlich, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in jedem Fall ist es</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht erforderlich , </font><font style="vertical-align: inherit;">alle Versionen zu </font><font style="vertical-align: inherit;">lesen, mit der ersten Revision beginnen. </font><font style="vertical-align: inherit;">Ein solches Verhalten ist gerechtfertigt, wÃ¼rde jedoch die entsprechende Beschreibung in der Dokumentation nicht beeintrÃ¤chtigen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 Mythische SchlÃ¶sser</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der API-Dokumentation fÃ¼r Sperren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> heiÃŸt es, dass ein gesperrter SchlÃ¼ssel "in Verbindung mit Transaktionen verwendet werden kann, um sicherzustellen, dass Aktualisierungen in etcd nur dann erfolgen, wenn die Sperre im Besitz ist." Seltsam, aber es gibt keine Garantie fÃ¼r die SchlÃ¶sser selbst und ihr Zweck wird nicht erklÃ¤rt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In anderen Materialien teilen die Betreuer usw. jedoch weiterhin Informationen Ã¼ber die Verwendung von SchlÃ¶ssern. In </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Release-AnkÃ¼ndigung zu etcd 3.2 wird</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beispielsweise eine Anwendung </font></font><code>etcdctl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum Blockieren von Ã„nderungen an der Dateifreigabe auf einer Festplatte beschrieben. DarÃ¼ber hinaus </font><font style="vertical-align: inherit;">beantwortete einer der etcd-Entwickler </font><font style="vertical-align: inherit;">in einem Problem auf GitHub mit einer Frage zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spezifischen Zweck der Sperren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Folgendes:</font></font><br>
<br>
<blockquote>     etcd  ,   (  )        ,     (        etcd), - :<br>
<br>
<ol>
<li>    etcd;</li>
<li>  - ( ,     etcd);</li>
<li>    .</li>
</ol></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein solches Beispiel finden Sie in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>  etcdctl</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Zum Schutz des Teams </font></font><code>put</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wurde </font><font style="vertical-align: inherit;">eine Sperre verwendet, </font><font style="vertical-align: inherit;">die den SperrschlÃ¼ssel jedoch nicht an das Update gebunden hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider ist dies nicht sicher, da mehrere Clients gleichzeitig dieselbe Sperre halten kÃ¶nnen. Das Problem wird durch die Unterbrechung von Prozessen, NetzwerkabstÃ¼rzen oder Partitionen verschÃ¤rft. Es kann jedoch auch in vollstÃ¤ndig fehlerfreien Clustern ohne externe Fehler auftreten. In diesem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testlauf setzt beispielsweise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prozess Nummer 3 die Sperre erfolgreich, und Prozess 1 erhÃ¤lt dieselbe Sperre parallel, noch bevor Prozess 3 die MÃ¶glichkeit hat, sie zu entfernen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/hy/lz/kohylznbfb8bh5a2m1l88kysrg4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Mutex-Verletzung war bei LeasingvertrÃ¤gen mit kurzen TTLs am auffÃ¤lligsten: TTLs von 1, 2 und 3 Sekunden konnten bereits nach wenigen Testminuten (selbst in gesunden Clustern) keinen gegenseitigen Ausschluss bewirken. Prozesssuspensionen und Netzwerkpartitionen fÃ¼hrten noch schneller zu Problemen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einer unserer Lock-Test-Varianten wurden etcd-Mutexe verwendet, um gemeinsame Aktualisierungen einer Reihe von Ganzzahlen zu schÃ¼tzen (wie in der Dokumentation etcd vorgeschlagen). Bei jeder Aktualisierung wird der aktuelle speicherinterne Beispielwert gelesen und nach etwa einer Sekunde wird diese Sammlung mit einem eindeutigen Element zurÃ¼ckgeschrieben. Mit Leases mit einer TTL von zwei Sekunden, fÃ¼nf parallelen Prozessen und einer Prozesspause alle fÃ¼nf Sekunden konnten wir einen stetigen Verlust von etwa 18% der bestÃ¤tigten Aktualisierungen verursachen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Problem wurde durch den internen Verriegelungsmechanismus in etcd verschÃ¤rft. Wenn ein Client darauf gewartet hat, dass ein anderer Client ihn entsperrt, seine Lease verloren hat und die Sperre danach aufgehoben wurde, hat der Server </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Lease nicht erneut Ã¼berprÃ¼ft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um sicherzustellen, dass sie noch gÃ¼ltig ist, bevor er den Client darÃ¼ber informiert hat, dass die Sperre jetzt dahinter steht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Aufnahme einer zusÃ¤tzlichen MietvertragsprÃ¼fung sowie die Auswahl lÃ¤ngerer TTLs und die sorgfÃ¤ltige Festlegung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WahlzeitÃ¼berschreitungen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verringern die HÃ¤ufigkeit dieses Problems. Mutex-VerstÃ¶ÃŸe kÃ¶nnen jedoch nicht vollstÃ¤ndig beseitigt werden, da verteilte Sperren in asynchronen Systemen grundsÃ¤tzlich unsicher sind. Dr. Martin Kleppmann beschreibt dies in </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">seinem Artikel</font></a><font style="vertical-align: inherit;"> Ã¼berzeugend</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ãœber verteilte Sperren. Ihm zufolge mÃ¼ssen Blockierungsdienste die Korrektheit opfern, um die LebensfÃ¤higkeit in asynchronen Systemen aufrechtzuerhalten: Wenn der Prozess wÃ¤hrend der Steuerung der Blockierung abstÃ¼rzt, benÃ¶tigt der Blockierungsdienst eine MÃ¶glichkeit, das Entsperren der Blockierung zu erzwingen. Wenn der Prozess jedoch tatsÃ¤chlich nicht abgebrochen wurde, sondern nur langsam ablÃ¤uft oder vorÃ¼bergehend nicht verfÃ¼gbar ist, kann das Entsperren dazu fÃ¼hren, dass er an mehreren Stellen gleichzeitig ausgefÃ¼hrt wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber selbst wenn der verteilte Blockierungsdienst beispielsweise eine Art magischen Fehlerdetektor verwendet und tatsÃ¤chlich den gegenseitigen Ausschluss garantieren kann, ist seine Verwendung im Fall einer nicht lokalen Ressource immer noch unsicher. Angenommen, Prozess A sendet eine Nachricht an die Datenbank D, wÃ¤hrend er eine Sperre hÃ¤lt. Danach stÃ¼rzt Prozess A ab und Prozess B empfÃ¤ngt eine Sperre und sendet auch eine Nachricht an Basis D. Das Problem besteht darin, dass eine Nachricht von Prozess A (aufgrund von AsynchronitÃ¤t) nach einer Nachricht von Prozess B kommen kann, wodurch die gegenseitige Ausnahme verletzt wird, die die Sperre bereitstellen sollte. . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu vermeiden, muss man sich darauf verlassen, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Speichersystem selbst</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Richtigkeit von Transaktionen unterstÃ¼tzt oder, wenn der Sperrdienst einen solchen Mechanismus bereitstellt, verwendet</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fechten"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Token</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das in allen vom Schlosshalter ausgefÃ¼hrten VorgÃ¤ngen enthalten ist. Dadurch wird sichergestellt, dass zwischen den VorgÃ¤ngen des aktuellen Schlossbesitzers keine Operationen des vorherigen Schlosshalters plÃ¶tzlich auftreten. Im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chubby-Blockierungsdienst von</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">werden</font></a><font style="vertical-align: inherit;"> diese Token beispielsweise als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sequenzer bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In etcd kÃ¶nnen Sie die Revision des SperrschlÃ¼ssels als global geordnetes Blockierungs-Token verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DarÃ¼ber hinaus kÃ¶nnen SperrschlÃ¼ssel in etcd verwendet werden, um Transaktionsaktualisierungen in etcd selbst zu schÃ¼tzen. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÃœberprÃ¼fen der SperrschlÃ¼sselversion als Teil der Transaktion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer kÃ¶nnen eine Transaktion verhindern, wenn die Sperre nicht mehr gehalten wird (d. h. die Version des SperrschlÃ¼ssels ist grÃ¶ÃŸer als Null). </font><font style="vertical-align: inherit;">In unseren Tests konnten wir mit diesem Ansatz Lese-, Ã„nderungs- und SchreibvorgÃ¤nge erfolgreich isolieren, bei denen das Schreiben die einzige durch Sperren geschÃ¼tzte Transaktion war. </font><font style="vertical-align: inherit;">Dieser Ansatz bietet eine Ã¤hnliche Isolation wie Barrage-Token, garantiert jedoch (wie Barrage-Token) keine AtomizitÃ¤t: Ein Prozess kann wÃ¤hrend eines Updates, das aus vielen VorgÃ¤ngen besteht, abstÃ¼rzen oder einen Mutex verlieren, wodurch etcd in einem logisch inkonsistenten Zustand verbleibt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ergebnisse der Arbeit in den Themen des Projekts:</font></font><br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uhren ab Revision 0 starten spÃ¤ter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nicht entschieden;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sperren kehren nach dem Blockieren zurÃ¼ck, ohne den Besitz zu Ã¼berprÃ¼fen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - im Master;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sperren werden nicht als unsicher dokumentiert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nicht gelÃ¶st.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Diskussion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unseren Tests hat etcd 3.4.3 die Erwartungen hinsichtlich der KV-Operationen erfÃ¼llt: Wir haben trotz der Unterbrechung von Prozessen, AbstÃ¼rzen, Manipulationen der Uhr und des Netzwerks sowie einer Ã„nderung der Anzahl der Clustermitglieder eine streng serialisierbare Konsistenz von Lese-, Schreib- und sogar MehrschlÃ¼sseltransaktionen beobachtet . </font><font style="vertical-align: inherit;">In KV-Operationen wurde standardmÃ¤ÃŸig streng serialisierbares Verhalten implementiert. </font><font style="vertical-align: inherit;">Die DurchfÃ¼hrung von Messwerten mit </font></font><code>serializable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gesetztem </font><font style="vertical-align: inherit;">Flag </font><font style="vertical-align: inherit;">fÃ¼hrte zum Auftreten veralteter LesevorgÃ¤nge (wie in der Dokumentation beschrieben). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ãœberwachen Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Uhren)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um richtig zu arbeiten - zumindest an den einzelnen Tasten. </font><font style="vertical-align: inherit;">Bis die Komprimierung des Verlaufs die alten Daten zerstÃ¶rte, gab die Uhr jedes SchlÃ¼sselupdate erfolgreich aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich jedoch heraus, dass Sperren in etcd (wie alle verteilten Sperren) keinen gegenseitigen Ausschluss bieten. Verschiedene Prozesse kÃ¶nnen die Sperre gleichzeitig halten - auch in gesunden Clustern mit perfekt synchronisierten Uhren. Die Dokumentation mit der Sperr-API sagte nichts darÃ¼ber aus, und die vorgestellten Beispiele fÃ¼r Sperren waren unsicher. Einige der Probleme mit den Sperren mussten jedoch nach der VerÃ¶ffentlichung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieses Patches behoben werden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis unserer Zusammenarbeit hat das etcd-Team eine Reihe von Ã„nderungen an der Dokumentation vorgenommen (diese wurden bereits auf GitHub verÃ¶ffentlicht und werden in zukÃ¼nftigen Versionen der Projektwebsite verÃ¶ffentlicht). Auf der GitHub Warranties API-Seite wird jetzt angegeben, dass etcd standardmÃ¤ÃŸig </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">streng serialisierbar ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Behauptung, dass seriell und serialisierbar die stÃ¤rksten in verteilten Systemen verfÃ¼gbaren Konsistenzniveaus sind, wurde entfernt. In Bezug auf Revisionen wird jetzt angegeben, dass der Start </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von Einheit (1) aus erfolgen sollte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , obwohl in der API-Dokumentation </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">immer noch nicht angegeben ist,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass ein Versuch, mit der 0. Revision zu beginnen, dazu </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">fÃ¼hrt,</font></a><font style="vertical-align: inherit;"> dass Ereignisse ausgegeben werden, die nach der aktuellen Revision plus 1 aufgetreten sind. anstelle des erwarteten "Versands aller Ereignisse". Die Dokumentation von Sicherheitsproblemen bei Sperren befindet sich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der Entwicklung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige DokumentationsÃ¤nderungen, z. B. die Beschreibung des besonderen Verhaltens von etcd beim Versuch zu lesen, beginnend mit einer Null-Revision, erfordern weiterhin Aufmerksamkeit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Ã¼blich betonen wir, dass Jepsen einen experimentellen Ansatz zur SicherheitsÃ¼berprÃ¼fung bevorzugt: Wir kÃ¶nnen das Vorhandensein von Fehlern bestÃ¤tigen, nicht jedoch deren Fehlen. </font><font style="vertical-align: inherit;">Es werden erhebliche Anstrengungen unternommen, um Probleme zu finden, aber wir kÃ¶nnen die allgemeine Richtigkeit von etcd nicht beweisen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1 Empfehlungen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Sperren in etcd verwenden, Ã¼berlegen Sie, ob Sie diese aus SicherheitsgrÃ¼nden oder einfach zur Leistungssteigerung benÃ¶tigen, indem Sie die ParallelitÃ¤t wahrscheinlich einschrÃ¤nken. Etcd-Sperren kÃ¶nnen verwendet werden, um die Leistung zu steigern. Die Verwendung aus SicherheitsgrÃ¼nden kann jedoch riskant sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insbesondere wenn Sie die etcd-Sperre verwenden, um eine gemeinsam genutzte Ressource wie eine Datei, eine Datenbank oder einen Dienst zu schÃ¼tzen, sollte diese Ressource die Sicherheit gewÃ¤hrleisten, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne sie zu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> blockieren. Eine MÃ¶glichkeit, dies zu erreichen, ist die Verwendung eines </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monotonen Sperrmarkers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies kann beispielsweise eine etcd-Revision sein, die dem aktuell gehaltenen SperrschlÃ¼ssel zugeordnet ist. Die gemeinsam genutzte Ressource muss sicherstellen, dass der Client das Token verwendet hat</font></font><code>y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um eine Operation auszufÃ¼hren, wird jede Operation mit einem Token </font></font><code>x &lt; y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abgelehnt. Dieser Ansatz stellt keine AtomizitÃ¤t sicher, garantiert jedoch, dass Operationen im Rahmen der Verriegelung in der richtigen Reihenfolge und nicht zeitweise ausgefÃ¼hrt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir vermuten, dass normale Benutzer dieses Problem wahrscheinlich nicht haben. Wenn Sie sich jedoch darauf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlassen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alle Ã„nderungen von etcd zu lesen, beginnend mit der ersten Revision, denken Sie daran, dass Sie 1 und nicht 0 als Parameter Ã¼bergeben mÃ¼ssen. Unsere Experimente zeigen, dass eine Null-Revision in diesem Fall â€aktuelle Revisionâ€œ bedeutet und nicht "FrÃ¼heste."</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SchlieÃŸlich fÃ¼hren Sperren und etcd (wie alle verteilten Sperren) Benutzer in die Irre: Sie mÃ¶chten sie mÃ¶glicherweise als regulÃ¤re Sperren verwenden, sind jedoch sehr Ã¼berrascht, wenn sie feststellen, dass diese Sperren keinen gegenseitigen Ausschluss bieten. </font><font style="vertical-align: inherit;">Die API-Dokumentation, Blog-BeitrÃ¤ge und Probleme auf GitHub sagen nichts Ã¼ber dieses Risiko aus. </font><font style="vertical-align: inherit;">Wir empfehlen, dass Sie Informationen in die etcd-Dokumentation aufnehmen, dass Sperren keinen gegenseitigen Ausschluss bieten, und Beispiele fÃ¼r die Verwendung von Sperr-Token zum Aktualisieren des Status freigegebener Ressourcen anstelle von Beispielen angeben, die zum Verlust von Updates fÃ¼hren kÃ¶nnen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2 Weitere PlÃ¤ne</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das etcd-Projekt gilt seit mehreren Jahren als stabil: Der darauf basierende Raft-Algorithmus hat gut funktioniert, die API fÃ¼r KV-Operationen ist einfach und unkompliziert. Obwohl einige zusÃ¤tzliche Funktionen kÃ¼rzlich eine neue API erhalten haben, ist ihre Semantik relativ einfach. Wir glauben, dass wir bereits genug grundlegende Befehle wie </font></font><code>get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>put</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Transaktionen, Blockieren und Verfolgen studiert haben. Es gibt jedoch andere Tests, die durchgefÃ¼hrt werden sollten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Derzeit haben wir keine ausreichend detaillierte Bewertung der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LÃ¶schungen durchgefÃ¼hrt.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Mit Versionen und Revisionen kÃ¶nnen GrenzfÃ¤lle verbunden sein, wenn Objekte stÃ¤ndig erstellt und gelÃ¶scht werden. In zukÃ¼nftigen Tests beabsichtigen wir, die EntfernungsvorgÃ¤nge einer genaueren Untersuchung zu unterziehen. Wir haben auch keine Bereichsabfragen oder Verfolgungsoperationen mit mehreren SchlÃ¼sseln getestet, obwohl wir vermuten, dass ihre Semantik Operationen mit einzelnen SchlÃ¼sseln Ã¤hnelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den Tests verwendeten wir die Unterbrechung von Prozessen, AbstÃ¼rzen, Manipulationen mit der Uhr, das Netzwerk wurde geteilt und die Zusammensetzung des Clusters geÃ¤ndert; Hinter den Kulissen gab es Probleme wie FestplattenschÃ¤den und andere </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byzantinische Fehler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf der Ebene eines Knotens. Diese MÃ¶glichkeiten kÃ¶nnen in zukÃ¼nftigen Forschungen untersucht werden. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Arbeit wurde von der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud Native Computing Foundation unterstÃ¼tzt.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Teil der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux Foundation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und entspricht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den ethischen Richtlinien von Jepsen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir mÃ¶chten dem etcd-Team fÃ¼r ihre Hilfe und insbesondere den folgenden Vertretern danken: Chris Aniszczyk, Gyuho Lee, Xiang Li, Hitoshi Mitake, Jingyi Hu und Brandon Philips.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS vom Ãœbersetzer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lesen Sie auch in unserem Blog:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TiKV - verteilte SchlÃ¼sselwertdatenbank fÃ¼r Cloud-native</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zetcd von CoreOS: Ersetzen von ZooKeeper durch ... Speicher etcd</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeyDB als [potenzieller] Ersatz fÃ¼r Redis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenbanken und Kubernetes (ÃœberprÃ¼fung und Videobericht)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ."</font></font></li>
</ul></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487516/index.html">Jagdtechniken und -taktiken von Angreifern, die Prefetch-Dateien verwenden</a></li>
<li><a href="../de487518/index.html">Radioaktive Produkte. Gammaspektrometer. Teil 2</a></li>
<li><a href="../de487522/index.html">Wir lassen das Terminal fliegen (Teil 1)</a></li>
<li><a href="../de487524/index.html">Warum braucht ein Hardware-Startup-Hackathon?</a></li>
<li><a href="../de487528/index.html">Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ¼ ÑĞ¾Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğ¸ Ğ¸ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ñ… Ğ¥Ğ°Ğ±Ñ€Ğ°</a></li>
<li><a href="../de487538/index.html">.NET Interactive ist da! | .NET Notebooks Vorschau 2</a></li>
<li><a href="../de487540/index.html">HighLoad ++, Anastasia Tsymbalyuk, Stanislav Tselovalnikov (Sberbank): Wie wir zu MDA wurden</a></li>
<li><a href="../de487542/index.html">PRESENT - Ultraleichte BlockverschlÃ¼sselung (Ãœbersetzung des Originals PRESENT: Eine ultraleichte BlockverschlÃ¼sselung)</a></li>
<li><a href="../de487544/index.html">.NET-Dokumentation: Was ist neu im Januar?</a></li>
<li><a href="../de487548/index.html">Neues Experiment: Aufrufen von .NET gRPC-Diensten Ã¼ber einen Browser mit gRPC-Web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>