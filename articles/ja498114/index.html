<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ—ï¸ ğŸ¥– ğŸ¨ 1ãƒ”ã‚¯ã‚»ãƒ«æ”»æ’ƒã€‚ã¾ãŸã¯ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã ã¾ã™æ–¹æ³• â˜¹ï¸ ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ½ âš¡ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®æ”»æ’ƒã®1ã¤ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ã€å¤–éƒ¨ã®å½±éŸ¿ã‚’æœ€å°é™ã«æŠ‘ãˆã¦åˆ†é¡ã‚¨ãƒ©ãƒ¼ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚ã—ã°ã‚‰ãã®é–“ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ãªãŸã§ã‚ã‚‹ã¨æƒ³åƒã—ã¦ãã ã•ã„ã€‚ãã—ã¦ç¾åœ¨ã€é¦™ã‚Šè±Šã‹ãªã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿ãªãŒã‚‰ã€ã€Œ1ãƒ”ã‚¯ã‚»ãƒ«ã®æ”»æ’ƒã€ãŒã™ã¹ã¦ã®ã€ŒçŒ«ã€ã‚’ãƒˆãƒ©ãƒƒã‚¯ã«å¤‰ãˆãŸã“ã¨ã‚’ç–‘ã†ã“ã¨ãª...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>1ãƒ”ã‚¯ã‚»ãƒ«æ”»æ’ƒã€‚ã¾ãŸã¯ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ã ã¾ã™æ–¹æ³•</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498114/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®æ”»æ’ƒã®1ã¤ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ã€å¤–éƒ¨ã®å½±éŸ¿ã‚’æœ€å°é™ã«æŠ‘ãˆã¦åˆ†é¡ã‚¨ãƒ©ãƒ¼ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚ã—ã°ã‚‰ãã®é–“ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ãªãŸã§ã‚ã‚‹ã¨æƒ³åƒã—ã¦ãã ã•ã„ã€‚ãã—ã¦ç¾åœ¨ã€é¦™ã‚Šè±Šã‹ãªã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é£²ã¿ãªãŒã‚‰ã€ã€Œ1ãƒ”ã‚¯ã‚»ãƒ«ã®æ”»æ’ƒã€ãŒã™ã¹ã¦ã®ã€ŒçŒ«ã€ã‚’ãƒˆãƒ©ãƒƒã‚¯ã«å¤‰ãˆãŸã“ã¨ã‚’ç–‘ã†ã“ã¨ãªãã€çŒ«ã®ç”»åƒã‚’90ï¼…ã‚’è¶…ãˆã‚‹ç²¾åº¦ã§åˆ†é¡ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ä¸€æ™‚åœæ­¢ã—ã€ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’è„‡ã«ç½®ãã€å¿…è¦ãªã™ã¹ã¦ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€ã“ã®ã‚ˆã†ãª1ãƒ”ã‚¯ã‚»ãƒ«ã®æ”»æ’ƒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’åˆ†æã—ã¾ã™ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®æ”»æ’ƒã®ç›®çš„ã¯ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã«ä¸æ­£è§£ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã™ã€‚</font><font style="vertical-align: inherit;">ä»¥ä¸‹ã§ã¯ã€ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã„ãã¤ã‹ã®ç•°ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã“ã‚Œã‚’ç¢ºèªã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å¤šæ¬¡å…ƒæ•°å­¦çš„æœ€é©åŒ–ã®æ–¹æ³•ã®1ã¤ã§ã‚ã‚‹å·®åˆ†é€²åŒ–ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã“ã®ç”»åƒã‚’èª¤ã£ã¦åˆ†é¡ã—å§‹ã‚ã‚‹ã‚ˆã†ã«ç”»åƒã‚’å¤‰æ›´ã§ãã‚‹ç‰¹åˆ¥ãªãƒ”ã‚¯ã‚»ãƒ«ã‚’è¦‹ã¤ã‘ã¾ã™ï¼ˆä»¥å‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒåŒã˜ç”»åƒã‚’æ­£ã—ãé«˜ç²¾åº¦ã§ã€Œèªè­˜ã€ã—ãŸã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># Python Libraries</span><font></font>
%matplotlib inline<font></font>
<span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib
<span class="hljs-keyword">from</span> keras.datasets <span class="hljs-keyword">import</span> cifar10
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> backend <span class="hljs-keyword">as</span> K<font></font>
<font></font>
<span class="hljs-comment"># Custom Networks</span>
<span class="hljs-keyword">from</span> networks.lenet <span class="hljs-keyword">import</span> LeNet
<span class="hljs-keyword">from</span> networks.pure_cnn <span class="hljs-keyword">import</span> PureCnn
<span class="hljs-keyword">from</span> networks.network_in_network <span class="hljs-keyword">import</span> NetworkInNetwork
<span class="hljs-keyword">from</span> networks.resnet <span class="hljs-keyword">import</span> ResNet
<span class="hljs-keyword">from</span> networks.densenet <span class="hljs-keyword">import</span> DenseNet
<span class="hljs-keyword">from</span> networks.wide_resnet <span class="hljs-keyword">import</span> WideResNet
<span class="hljs-keyword">from</span> networks.capsnet <span class="hljs-keyword">import</span> CapsNet<font></font>
<font></font>
<span class="hljs-comment"># Helper functions</span>
<span class="hljs-keyword">from</span> differential_evolution <span class="hljs-keyword">import</span> differential_evolution
<span class="hljs-keyword">import</span> helper<font></font>
<font></font>
matplotlib.style.use(<span class="hljs-string">'ggplot'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å®Ÿé¨“ã§ã¯ã€10å€‹ã®ã‚¯ãƒ©ã‚¹ã«åˆ†å‰²ã•ã‚ŒãŸå®Ÿéš›ã®ç”»åƒã‚’å«ã‚€CIFAR-10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">(x_train, y_train), (x_test, y_test) = cifar10.load_data()<font></font>
<font></font>
class_names = [<span class="hljs-string">'airplane'</span>, <span class="hljs-string">'automobile'</span>, <span class="hljs-string">'bird'</span>, <span class="hljs-string">'cat'</span>, <span class="hljs-string">'deer'</span>, <span class="hljs-string">'dog'</span>, <span class="hljs-string">'frog'</span>, <span class="hljs-string">'horse'</span>, <span class="hljs-string">'ship'</span>, <span class="hljs-string">'truck'</span>]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç”»åƒã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€ã“ã®é¦¬ã«ã¤ã„ã¦ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">99</span> <span class="hljs-comment"># Image index in the test set</span><font></font>
helper.plot_image(x_test[image_id])<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/gp/k9/gw/gpk9gwtmh-_e8e5jcni2vhcej70.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¿œç­”ã‚’å¤‰æ›´ã§ãã‚‹éå¸¸ã«å¼·åŠ›ãªãƒ”ã‚¯ã‚»ãƒ«ã‚’æ¢ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€ç”»åƒã®1ã¤ä»¥ä¸Šã®ãƒ”ã‚¯ã‚»ãƒ«ã‚’å¤‰æ›´ã™ã‚‹é–¢æ•°ã‚’ä½œæˆã™ã‚‹æ™‚ãŒæ¥ã¾ã—ãŸã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">perturb_image</span>(<span class="hljs-params">xs, img</span>):</span>
    <span class="hljs-comment"># If this function is passed just one perturbation vector,</span>
    <span class="hljs-comment"># pack it in a list to keep the computation the same</span>
    <span class="hljs-keyword">if</span> xs.ndim &lt; <span class="hljs-number">2</span>:<font></font>
        xs = np.array([xs])<font></font>
    <font></font>
    <span class="hljs-comment"># Copy the image n == len(xs) times so that we can </span>
    <span class="hljs-comment"># create n new perturbed images</span>
    tile = [len(xs)] + [<span class="hljs-number">1</span>]*(xs.ndim+<span class="hljs-number">1</span>)<font></font>
    imgs = np.tile(img, tile)<font></font>
    <font></font>
    <span class="hljs-comment"># Make sure to floor the members of xs as int types</span><font></font>
    xs = xs.astype(int)<font></font>
    <font></font>
    <span class="hljs-keyword">for</span> x,img <span class="hljs-keyword">in</span> zip(xs, imgs):
        <span class="hljs-comment"># Split x into an array of 5-tuples (perturbation pixels)</span>
        <span class="hljs-comment"># i.e., [[x,y,r,g,b], ...]</span>
        pixels = np.split(x, len(x) // <span class="hljs-number">5</span>)
        <span class="hljs-keyword">for</span> pixel <span class="hljs-keyword">in</span> pixels:
            <span class="hljs-comment"># At each pixel's x,y position, assign its rgb value</span><font></font>
            x_pos, y_pos, *rgb = pixel<font></font>
            img[x_pos, y_pos] = rgb<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> imgs
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦‹ã¦ã¿ãª ï¼Ÿï¼</font><font style="vertical-align: inherit;">åº§æ¨™ï¼ˆ16ã€16ï¼‰ã®é¦¬ã®1ãƒ”ã‚¯ã‚»ãƒ«ã‚’é»„è‰²ã«å¤‰æ›´ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">99</span> <span class="hljs-comment"># Image index in the test set</span>
pixel = np.array([<span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>]) <span class="hljs-comment"># pixel = x,y,r,g,b</span>
image_perturbed = perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>]<font></font>
<font></font>
helper.plot_image(image_perturbed)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/qj/sf/li/qjsflidtymruwiuotebu0r7siby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”»æ’ƒã‚’å®Ÿè¨¼ã™ã‚‹ã«ã¯ã€CIFAR-10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®äº‹å‰ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã“ã§ã¯ã€lenetã¨resnetã®2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ãŒã€å¯¾å¿œã™ã‚‹ã‚³ãƒ¼ãƒ‰è¡Œã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã™ã“ã¨ã§ã€ä»–ã®ãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿé¨“ã«ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">lenet = LeNet()<font></font>
resnet = ResNet()<font></font>
<font></font>
models = [lenet, resnet]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã å¾Œã€å„ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆç”»åƒã‚’è©•ä¾¡ã—ã¦ã€æ­£ã—ãåˆ†é¡ã•ã‚ŒãŸç”»åƒã®ã¿ãŒæ”»æ’ƒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€å„ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ•°ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">network_stats, correct_imgs = helper.evaluate_models(models, x_test, y_test)<font></font>
<font></font>
correct_imgs = pd.DataFrame(correct_imgs, columns=[<span class="hljs-string">'name'</span>, <span class="hljs-string">'img'</span>, <span class="hljs-string">'label'</span>, <span class="hljs-string">'confidence'</span>, <span class="hljs-string">'pred'</span>])<font></font>
<font></font>
network_stats = pd.DataFrame(network_stats, columns=[<span class="hljs-string">'name'</span>, <span class="hljs-string">'accuracy'</span>, <span class="hljs-string">'param_count'</span>])<font></font>
<font></font>
network_stats<font></font>
Evaluating lenet<font></font>
Evaluating resnet<font></font>
<font></font>
Out[<span class="hljs-number">11</span>]:<font></font>
<font></font>
<font></font>
	name        accuracy    param_count<font></font>
<span class="hljs-number">0</span>      lenet        <span class="hljs-number">0.748</span>       <span class="hljs-number">62006</span>
<span class="hljs-number">1</span>      resnet       <span class="hljs-number">0.9231</span>      <span class="hljs-number">470218</span><font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ã“ã®ã‚ˆã†ãªæ”»æ’ƒã¯ã™ã¹ã¦ã€WhiteBoxã¨BlackBoxã®2ã¤ã®ã‚¯ãƒ©ã‚¹ã«åˆ†é¡ã§ãã¾ã™ã€‚ãã‚Œã‚‰ã®é•ã„ã¯ã€æœ€åˆã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€ç§ãŸã¡å…¨å“¡ãŒã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€ã¤ã¾ã‚Šç§ãŸã¡ãŒæ‰±ã£ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ç¢ºå®Ÿã«çŸ¥ã£ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚ BlackBoxã®å ´åˆã€å¿…è¦ãªã®ã¯å…¥åŠ›ï¼ˆç”»åƒï¼‰ã¨å‡ºåŠ›ï¼ˆã‚¯ãƒ©ã‚¹ã®1ã¤ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ç¢ºç‡ï¼‰ã ã‘ã§ã™ã€‚ 1ã¤ã®ãƒ”ã‚¯ã‚»ãƒ«æ”»æ’ƒã¯BlackBoxã‚’æŒ‡ã—ã¾ã™ã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®è¨˜äº‹ã§ã¯ã€å˜ä¸€ã®ãƒ”ã‚¯ã‚»ãƒ«ã‚’æ”»æ’ƒã™ã‚‹ãŸã‚ã®2ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€éã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’æ¤œè¨ã—ã¾ã™ã€‚æœ€åˆã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€çŒ«ã®ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã©ã®ã‚¯ãƒ©ã‚¹ã«å±ã™ã‚‹ã‹ã¯çµ¶å¯¾ã«å•é¡Œã«ãªã‚Šã¾ã›ã‚“ã€‚æœ€ã‚‚é‡è¦ãªã®ã¯ã€çŒ«ã®ã‚¯ãƒ©ã‚¹ã«å±ã•ãªã„ã“ã¨ã§ã™ã€‚æ¨™çš„å‹æ”»æ’ƒã¯ã€çŒ«ã‚’ãƒˆãƒ©ãƒƒã‚¯ã«ã—ã¦ãƒˆãƒ©ãƒƒã‚¯ã ã‘ã«ã—ãŸã„ã¨ãã«é©ç”¨ã§ãã¾ã™ã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ãã®å¤‰åŒ–ãŒç”»åƒã®ã‚¯ãƒ©ã‚¹ã®å¤‰åŒ–ã«ã¤ãªãŒã‚‹éå¸¸ã«ãƒ”ã‚¯ã‚»ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã¯ï¼Ÿã©ã®1ã¤ã®ãƒ”ã‚¯ã‚»ãƒ«ã®æ”»æ’ƒãŒå¯èƒ½ã§æˆåŠŸã™ã‚‹ã‹ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ãƒ”ã‚¯ã‚»ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã¯ï¼Ÿã“ã®å•é¡Œã‚’æœ€é©åŒ–ã®å•é¡Œã¨ã—ã¦å®šå¼åŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚éå¸¸ã«å˜ç´”ãªè¨€è‘‰ã§è¨€ãˆã°ã€éæ¨™çš„å‹æ”»æ’ƒã§ã¯ã€ç›®çš„ã®ã‚¯ãƒ©ã‚¹ã¸ã®ä¿¡é ¼ã‚’æœ€å°é™ã«æŠ‘ãˆã€æ¨™çš„å‹ã§ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¯ãƒ©ã‚¹ã¸ã®ä¿¡é ¼ã‚’æœ€å¤§é™ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚ˆã†ãªæ”»æ’ƒã‚’è¡Œã†å ´åˆã€å‹¾é…ã‚’ä½¿ç”¨ã—ã¦é–¢æ•°ã‚’æœ€é©åŒ–ã™ã‚‹ã“ã¨ã¯å›°é›£ã§ã™ã€‚é–¢æ•°ã®æ»‘ã‚‰ã‹ã•ã«ä¾å­˜ã—ãªã„æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»Šå›ã®å®Ÿé¨“ã§ã¯ã€CIFAR-10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚CIFAR-10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€ã‚µã‚¤ã‚ºãŒ32 x 32ãƒ”ã‚¯ã‚»ãƒ«ã§ã€10å€‹ã®ã‚¯ãƒ©ã‚¹ã«åˆ†å‰²ã•ã‚ŒãŸå®Ÿä¸–ç•Œã®ç”»åƒãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã‚Œã¯ã€0ã‹ã‚‰31ã¾ã§ã®æ•´æ•°ã®é›¢æ•£å€¤ã¨0ã‹ã‚‰255ã¾ã§ã®è‰²ã®å¼·åº¦ãŒã‚ã‚Šã€é–¢æ•°ãŒæ»‘ã‚‰ã‹ã§ã‚ã‚‹ã¨ã¯äºˆæƒ³ã•ã‚Œãªã„ãŒã€ä»¥ä¸‹ã«ç¤ºã™ã‚ˆã†ã«ã‚®ã‚¶ã‚®ã‚¶ã—ã¦ã„ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vs/0k/mv/vs0kmvtq35lowxplx0rsq2-kppw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®ãŸã‚ã€å¾®åˆ†é€²åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ã‚³ãƒ¼ãƒ‰ã«æˆ»ã‚Šã€ãƒ¢ãƒ‡ãƒ«ã®ä¿¡é ¼æ€§ã®ç¢ºç‡ã‚’è¿”ã™é–¢æ•°ã‚’è¨˜è¿°ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¯ãƒ©ã‚¹ãŒæ­£ã—ã„å ´åˆã€ã“ã®é–¢æ•°ã‚’æœ€å°åŒ–ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ãŒåˆ¥ã®ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹ã¨ç¢ºä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼ˆã“ã‚Œã¯æ­£ã—ãã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict_classes</span>(<span class="hljs-params">xs, img, target_class, model, minimize=True</span>):</span>
    <span class="hljs-comment"># Perturb the image with the given pixel(s) x and get the prediction of the model</span><font></font>
    imgs_perturbed = perturb_image(xs, img)<font></font>
    predictions = model.predict(imgs_perturbed)[:,target_class]<font></font>
    <span class="hljs-comment"># This function should always be minimized, so return its complement if needed</span>
    <span class="hljs-keyword">return</span> predictions <span class="hljs-keyword">if</span> minimize <span class="hljs-keyword">else</span> <span class="hljs-number">1</span> - predictions<font></font>
<font></font>
image_id = <span class="hljs-number">384</span>
pixel = np.array([<span class="hljs-number">16</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">25</span>, <span class="hljs-number">48</span>, <span class="hljs-number">156</span>])<font></font>
model = resnet<font></font>
<font></font>
true_class = y_test[image_id, <span class="hljs-number">0</span>]<font></font>
prior_confidence = model.predict_one(x_test[image_id])[true_class]<font></font>
confidence = predict_classes(pixel, x_test[image_id], true_class, model)[<span class="hljs-number">0</span>]<font></font>
<font></font>
print(<span class="hljs-string">'Confidence in true class'</span>, class_names[true_class], <span class="hljs-string">'is'</span>, confidence)<font></font>
print(<span class="hljs-string">'Prior confidence was'</span>, prior_confidence)<font></font>
helper.plot_image(perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>])<font></font>
<font></font>
Confidence <span class="hljs-keyword">in</span> true <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bird</span> <span class="hljs-title">is</span> 0.00018887444
<span class="hljs-title">Prior</span> <span class="hljs-title">confidence</span> <span class="hljs-title">was</span> 0.70661753
</span></code></pre><br>
<img src="https://habrastorage.org/webt/re/g3/yn/reg3ync4qxac0hxb5wrr0jus_je.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”»æ’ƒãŒæˆåŠŸã—ãŸã‹ã©ã†ã‹ã®åŸºæº–ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã®é–¢æ•°ãŒå¿…è¦ã§ã™ã€‚å¤‰æ›´ãŒãƒ¢ãƒ‡ãƒ«ã‚’ã ã¾ã™ã®ã«ååˆ†ã§ã‚ã‚‹å ´åˆã€é–¢æ•°ã¯Trueã‚’è¿”ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack_success</span>(<span class="hljs-params">x, img, target_class, model, targeted_attack=False, verbose=False</span>):</span>
    <span class="hljs-comment"># Perturb the image with the given pixel(s) and get the prediction of the model</span><font></font>
    attack_image = perturb_image(x, img)<font></font>
    confidence = model.predict(attack_image)[<span class="hljs-number">0</span>]<font></font>
    predicted_class = np.argmax(confidence)<font></font>
    <font></font>
    <span class="hljs-comment"># If the prediction is what we want (misclassification or </span>
    <span class="hljs-comment"># targeted classification), return True</span>
    <span class="hljs-keyword">if</span> verbose:<font></font>
        print(<span class="hljs-string">'Confidence:'</span>, confidence[target_class])
    <span class="hljs-keyword">if</span> ((targeted_attack <span class="hljs-keyword">and</span> predicted_class == target_class) <span class="hljs-keyword">or</span>
        (<span class="hljs-keyword">not</span> targeted_attack <span class="hljs-keyword">and</span> predicted_class != target_class)):
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> return None otherwise (not False), due to how Scipy handles its callback function</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆåŠŸåŸºæº–é–¢æ•°ã®åƒãã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">å®Ÿè¨¼ã™ã‚‹ãŸã‚ã«ã€éæ¨™çš„æ”»æ’ƒã‚’æƒ³å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">541</span>
pixel = np.array([<span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">185</span>, <span class="hljs-number">36</span>, <span class="hljs-number">215</span>])<font></font>
model = resnet<font></font>
<font></font>
true_class = y_test[image_id, <span class="hljs-number">0</span>]<font></font>
prior_confidence = model.predict_one(x_test[image_id])[true_class]<font></font>
success = attack_success(pixel, x_test[image_id], true_class, model, verbose=<span class="hljs-literal">True</span>)<font></font>
<font></font>
print(<span class="hljs-string">'Prior confidence'</span>, prior_confidence)<font></font>
print(<span class="hljs-string">'Attack success:'</span>, success == <span class="hljs-literal">True</span>)<font></font>
helper.plot_image(perturb_image(pixel, x_test[image_id])[<span class="hljs-number">0</span>])<font></font>
Confidence: <span class="hljs-number">0.07460087</span>
Prior confidence <span class="hljs-number">0.50054216</span>
Attack success: <span class="hljs-literal">True</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/vh/qb/vp/vhqbvpxy3blhf-krbwmmtezadbu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ãƒ‘ã‚ºãƒ«ã‚’1ã¤ã®ç”»åƒã«ã¾ã¨ã‚ã¾ã™ã€‚</font><font style="vertical-align: inherit;">Scipyã§ã®å·®åˆ†é€²åŒ–ã®å®Ÿè£…ã®å°ã•ãªå¤‰æ›´ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack</span>(<span class="hljs-params">img_id, model, target=None, pixel_count=<span class="hljs-number">1</span>, 
           maxiter=<span class="hljs-number">75</span>, popsize=<span class="hljs-number">400</span>, verbose=False</span>):</span>
    <span class="hljs-comment"># Change the target class based on whether this is a targeted attack or not</span>
    targeted_attack = target <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>
    target_class = target <span class="hljs-keyword">if</span> targeted_attack <span class="hljs-keyword">else</span> y_test[img_id, <span class="hljs-number">0</span>]<font></font>
    <font></font>
    <span class="hljs-comment"># Define bounds for a flat vector of x,y,r,g,b values</span>
    <span class="hljs-comment"># For more pixels, repeat this layout</span>
    bounds = [(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">32</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">256</span>)] * pixel_count<font></font>
    <font></font>
    <span class="hljs-comment"># Population multiplier, in terms of the size of the perturbation vector x</span>
    popmul = max(<span class="hljs-number">1</span>, popsize // len(bounds))<font></font>
    <font></font>
    <span class="hljs-comment"># Format the predict/callback functions for the differential evolution algorithm</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict_fn</span>(<span class="hljs-params">xs</span>):</span>
        <span class="hljs-keyword">return</span> predict_classes(xs, x_test[img_id], target_class, <font></font>
                               model, target <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>)<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">callback_fn</span>(<span class="hljs-params">x, convergence</span>):</span>
        <span class="hljs-keyword">return</span> attack_success(x, x_test[img_id], target_class, <font></font>
                              model, targeted_attack, verbose)<font></font>
    <font></font>
    <span class="hljs-comment"># Call Scipy's Implementation of Differential Evolution</span><font></font>
    attack_result = differential_evolution(<font></font>
        predict_fn, bounds, maxiter=maxiter, popsize=popmul,<font></font>
        recombination=<span class="hljs-number">1</span>, atol=<span class="hljs-number">-1</span>, callback=callback_fn, polish=<span class="hljs-literal">False</span>)<font></font>
<font></font>
    <span class="hljs-comment"># Calculate some useful statistics to return from this function</span>
    attack_image = perturb_image(attack_result.x, x_test[img_id])[<span class="hljs-number">0</span>]<font></font>
    prior_probs = model.predict_one(x_test[img_id])<font></font>
    predicted_probs = model.predict_one(attack_image)<font></font>
    predicted_class = np.argmax(predicted_probs)<font></font>
    actual_class = y_test[img_id, <span class="hljs-number">0</span>]<font></font>
    success = predicted_class != actual_class<font></font>
    cdiff = prior_probs[actual_class] - predicted_probs[actual_class]<font></font>
<font></font>
    <span class="hljs-comment"># Show the best attempt at a solution (successful or not)</span><font></font>
    helper.plot_image(attack_image, actual_class, class_names, predicted_class)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> [model.name, pixel_count, img_id, actual_class, predicted_class, success, cdiff, prior_probs, predicted_probs, attack_result.x]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
èª¿æŸ»ï¼ˆæ”»æ’ƒï¼‰ã®çµæœã‚’å…±æœ‰ã—ã€1ã¤ã®ãƒ”ã‚¯ã‚»ãƒ«ã®ã¿ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ã‚«ã‚¨ãƒ«ãŒçŠ¬ã«ã€çŒ«ãŒã‚«ã‚¨ãƒ«ã«ã€è»ŠãŒé£›è¡Œæ©Ÿã«å¤‰ã‚ã‚‹æ–¹æ³•ã‚’ç¢ºèªã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€å¤‰æ›´ã§ãã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒã‚¤ãƒ³ãƒˆãŒå¤šã„ã»ã©ã€ä»»æ„ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«å¯¾ã™ã‚‹æ”»æ’ƒãŒæˆåŠŸã™ã‚‹å¯èƒ½æ€§ãŒé«˜ããªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/mc/r2/gamcr2jr7fgitczf7wevptkafwa.png"><img src="https://habrastorage.org/webt/hc/df/xg/hcdfxgdnndfgcug3bb4hn9ij6xk.png"><img src="https://habrastorage.org/webt/qn/l_/zj/qnl_zjqfyz67jemvl5fewdbvvii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
resnetãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ã‚«ã‚¨ãƒ«ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«å¯¾ã™ã‚‹æ”»æ’ƒãŒæˆåŠŸã—ãŸã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½•å›ã‹ç¹°ã‚Šè¿”ã—ãŸå¾Œã€ã‚¯ãƒ©ã‚¹ã®çœŸã®æ¸›å°‘ã«è‡ªä¿¡ãŒå‡ºã‚‹ã¯ãšã§ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">102</span>
pixels = <span class="hljs-number">1</span> <span class="hljs-comment"># Number of pixels to attack</span><font></font>
model = resnet<font></font>
<font></font>
_ = attack(image_id, model, pixel_count=pixels, verbose=<span class="hljs-literal">True</span>)<font></font>
<font></font>
Confidence: <span class="hljs-number">0.9938618</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.77454716</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.53226393</span>
Confidence: <span class="hljs-number">0.4211318</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/a2/bw/rh/a2bwrhij-hnpjshjqcpmigtisyi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã¯å¯¾è±¡ã‚’çµã£ãŸæ”»æ’ƒã®ä¾‹ã§ã—ãŸã€‚æ¬¡ã«ã€å¯¾è±¡ã‚’çµã£ãŸæ”»æ’ƒã‚’è¡Œã„ã€ãƒ¢ãƒ‡ãƒ«ã«ç”»åƒã‚’åˆ†é¡ã•ã›ãŸã„ã‚¯ãƒ©ã‚¹ã‚’é¸æŠã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§èˆ¹ã®ç”»åƒã‚’è»Šã«ã€é¦¬ã®ç”»åƒã‚’çŒ«ã«åˆ†é¡ã™ã‚‹ãŸã‚ã€å‰ã®ã‚¿ã‚¹ã‚¯ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«è¤‡é›‘ã§ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/n5/sw/yrn5swb3-4bqoyfujgxz6dfdome.png"><img src="https://habrastorage.org/webt/li/cp/iy/licpiypraj8dcsuxolvh2etbdde.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã§ã¯ã€èˆ¹ã®ç”»åƒã‚’è»Šã¨ã—ã¦åˆ†é¡ã™ã‚‹ãŸã‚ã«ã€lenetã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">image_id = <span class="hljs-number">108</span>
target_class = <span class="hljs-number">1</span> <span class="hljs-comment"># Integer in range 0-9</span>
pixels = <span class="hljs-number">3</span><font></font>
model = lenet<font></font>
<font></font>
print(<span class="hljs-string">'Attacking with target'</span>, class_names[target_class])<font></font>
_ = attack(image_id, model, target_class, pixel_count=pixels, verbose=<span class="hljs-literal">True</span>)<font></font>
Attacking <span class="hljs-keyword">with</span> target automobile<font></font>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.044409167</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.054611664</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.081972085</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.1537778</span>
Confidence: <span class="hljs-number">0.22246778</span>
Confidence: <span class="hljs-number">0.23916133</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.25238588</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.44560355</span>
Confidence: <span class="hljs-number">0.5711696</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/xi/ym/pn/xiympn3dd-xburofpy5tl34yybu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å˜ä¸€ã®æ”»æ’ƒã®ã‚±ãƒ¼ã‚¹ã«å¯¾å‡¦ã—ãŸå¾Œã€ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ResNetã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ä½¿ç”¨ã—ã¦çµ±è¨ˆã‚’åé›†ã—ã€å„ãƒ¢ãƒ‡ãƒ«ã‚’é€šéã—ã¦ã€å„ç”»åƒã®1ã€3ã€ã¾ãŸã¯5ãƒ”ã‚¯ã‚»ãƒ«ã‚’å¤‰æ›´ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ã¯ã€å¤šãã®æ™‚é–“ã¨è¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ã‚’å¿…è¦ã¨ã™ã‚‹ãŸã‚ã€èª­è€…ãŒå„åå¾©ã«æ…£ã‚Œã‚‹ã¾ã§ç…©ã‚ã•ã‚Œã‚‹ã“ã¨ãªãã€æœ€çµ‚çš„ãªçµè«–ã‚’ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">attack_all</span>(<span class="hljs-params">models, samples=<span class="hljs-number">500</span>, pixels=(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span></span>), targeted=False, 
               maxiter=<span class="hljs-number">75</span>, popsize=<span class="hljs-number">400</span>, verbose=False</span>):</span><font></font>
    results = []<font></font>
    <span class="hljs-keyword">for</span> model <span class="hljs-keyword">in</span> models:<font></font>
        model_results = []<font></font>
        valid_imgs = correct_imgs[correct_imgs.name == model.name].img<font></font>
        img_samples = np.random.choice(valid_imgs, samples, replace=<span class="hljs-literal">False</span>)<font></font>
        <font></font>
        <span class="hljs-keyword">for</span> pixel_count <span class="hljs-keyword">in</span> pixels:
            <span class="hljs-keyword">for</span> i, img_id <span class="hljs-keyword">in</span> enumerate(img_samples):<font></font>
                print(<span class="hljs-string">'\n'</span>, model.name, <span class="hljs-string">'- image'</span>, img_id, <span class="hljs-string">'-'</span>, i+<span class="hljs-number">1</span>, <span class="hljs-string">'/'</span>, len(img_samples))<font></font>
                targets = [<span class="hljs-literal">None</span>] <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> targeted <span class="hljs-keyword">else</span> range(<span class="hljs-number">10</span>)<font></font>
                <font></font>
                <span class="hljs-keyword">for</span> target <span class="hljs-keyword">in</span> targets:
                    <span class="hljs-keyword">if</span> targeted:<font></font>
                        print(<span class="hljs-string">'Attacking with target'</span>, class_names[target])
                        <span class="hljs-keyword">if</span> target == y_test[img, <span class="hljs-number">0</span>]:
                            <span class="hljs-keyword">continue</span><font></font>
                    result = attack(img_id, model, target, pixel_count, <font></font>
                                    maxiter=maxiter, popsize=popsize, <font></font>
                                    verbose=verbose)<font></font>
                    model_results.append(result)<font></font>
                    <font></font>
        results += model_results<font></font>
        helper.checkpoint(results, targeted)<font></font>
    <span class="hljs-keyword">return</span> results<font></font>
<font></font>
untargeted = attack_all(models, samples=<span class="hljs-number">100</span>, targeted=<span class="hljs-literal">False</span>)<font></font>
<font></font>
targeted = attack_all(models, samples=<span class="hljs-number">10</span>, targeted=<span class="hljs-literal">False</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸ä¿¡ã®å¯èƒ½æ€§ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒé–‹ç™ºã•ã‚Œã€ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®äºˆæ¸¬å“è³ªã¸ã®å½±éŸ¿ãŒæ¸¬å®šã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€çµ‚çµæœã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="python hljs">untargeted, targeted = helper.load_results()<font></font>
<font></font>
columns = [<span class="hljs-string">'model'</span>, <span class="hljs-string">'pixels'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'predicted'</span>, <span class="hljs-string">'success'</span>, <span class="hljs-string">'cdiff'</span>, <span class="hljs-string">'prior_probs'</span>, <span class="hljs-string">'predicted_probs'</span>, <span class="hljs-string">'perturbation'</span>]<font></font>
<font></font>
untargeted_results = pd.DataFrame(untargeted, columns=columns)<font></font>
targeted_results = pd.DataFrame(targeted, columns=columns)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã®è¡¨ã¯ã€0.9231ã®ç²¾åº¦ã§ResNetãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ç”»åƒã®ã„ãã¤ã‹ã®ãƒ”ã‚¯ã‚»ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€æ”»æ’ƒã«æˆåŠŸã—ãŸç”»åƒï¼ˆattack_success_rateï¼‰ã®éå¸¸ã«é«˜ã„å‰²åˆã‚’å–å¾—ã—ãŸã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">helper.attack_stats(targeted_results, models, network_stats)<font></font>
Out[<span class="hljs-number">26</span>]:<font></font>
	model	accuracy   pixels	attack_success_rate<font></font>
<span class="hljs-number">0</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">1</span>	        <span class="hljs-number">0.144444</span>
<span class="hljs-number">1</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">3</span>	        <span class="hljs-number">0.211111</span>
<span class="hljs-number">2</span>	resnet	<span class="hljs-number">0.9231</span>	    <span class="hljs-number">5</span>	        <span class="hljs-number">0.222222</span><font></font>
<font></font>
helper.attack_stats(untargeted_results, models, network_stats)<font></font>
Out[<span class="hljs-number">27</span>]:<font></font>
	model	accuracy   pixels	attack_success_rate<font></font>
<span class="hljs-number">0</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">1</span>	        <span class="hljs-number">0.34</span>
<span class="hljs-number">1</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">3</span>	        <span class="hljs-number">0.79</span>
<span class="hljs-number">2</span>	resnet	<span class="hljs-number">0.9231</span>	   <span class="hljs-number">5</span>	        <span class="hljs-number">0.79</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¾åœ¨ã€éå¸¸ã«å¤šãã®äººå·¥ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒå­˜åœ¨ã™ã‚‹ãŸã‚ã€å®Ÿé¨“ã§ã¯äººå·¥ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä»–ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è‡ªç”±ã«ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ta/lw/tv/talwtvpnwkzp2od0p-8q9o28eli.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã€ç¾ä»£ã®ä¸–ç•Œã‚’ç›®ã«è¦‹ãˆãªã„ã‚¹ãƒ¬ãƒƒãƒ‰ã§è¦†ã£ã¦ã„ã¾ã™ã€‚é•·ã„é–“ã€AIï¼ˆäººå·¥çŸ¥èƒ½ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå„ªã‚ŒãŸã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã®ä½œå“ã«ä¼¼ãŸã‚¹ã‚¿ã‚¤ãƒ«ã§å‡¦ç†ã•ã‚ŒãŸå†™çœŸã‚’å—ã‘å–ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãŒç™ºæ˜ã•ã‚Œã¦ãã¾ã—ãŸã€‚ç¾åœ¨ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è‡ªä½“ãŒçµµã‚’æãã€éŸ³æ¥½ã®å‚‘ä½œã‚’ä½œæˆã—ã€æœ¬ã‚’æ›¸ãã€æ˜ ç”»ã®è„šæœ¬ã•ãˆä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãƒ“ã‚¸ãƒ§ãƒ³ã€é¡”èªè­˜ã€ç„¡äººè»Šä¸¡ã€ç—…æ°—ã®è¨ºæ–­ãªã©ã®åˆ†é‡ã¯ã€é‡è¦ãªæ±ºå®šã‚’è¡Œã„ã€é–“é•ã„ã‚’çŠ¯ã™æ¨©åˆ©ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ“ä½œã‚’å¦¨å®³ã™ã‚‹ã¨ã€æ‚²æƒ¨ãªçµæœã‚’æ‹›ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1ãƒ”ã‚¯ã‚»ãƒ«æ”»æ’ƒã¯ã€æ”»æ’ƒã‚’å½è£…ã™ã‚‹1ã¤ã®æ–¹æ³•ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸ä¿¡ã®å¯èƒ½æ€§ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒé–‹ç™ºã•ã‚Œã€ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®äºˆæ¸¬å“è³ªã¸ã®å½±éŸ¿ãŒæ¸¬å®šã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãã®çµæœã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é©ç”¨ã•ã‚ŒãŸç•³ã¿è¾¼ã¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€èªè­˜ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¿¡ç”¨ã‚’å‚·ã¤ã‘ã‚‹ãŸã‚ã«ã€1ãƒ”ã‚¯ã‚»ãƒ«ã‚’ç½®ãæ›ãˆã‚‹ç‰¹åˆ¥ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸ1ãƒ”ã‚¯ã‚»ãƒ«æ”»æ’ƒã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«å¯¾ã—ã¦è„†å¼±ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã‚’ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šèª¿è£½ã—ãŸ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ¬ã‚¯ã‚µãƒ³ãƒ€ãƒ¼Andronic</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adrey Cherny-Tkach</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚·ãƒƒãƒ—ã®ä¸€ç’°ã¨ã—ã¦</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DATA4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja498094/index.html">ç¤¾å†…ã®ã™ã¹ã¦ã®é€šä¿¡ã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«è»¢é€ã—ãŸæ–¹æ³•</a></li>
<li><a href="../ja498096/index.html">ãƒ¡ãƒ¢ãƒªãƒ¼ã‚ºãƒ‡ãƒ¢ãŒ256ãƒã‚¤ãƒˆã«åã¾ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja498100/index.html">Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ã®è¨­è¨ˆï¼šã„ãã¤ã‚ã‚‹ã¹ãã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja498104/index.html">100,000ãƒ‰ãƒ«ã‹ã‚‰ã‚µã‚¤ãƒˆã‚’é–‹ç™ºã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja498110/index.html">ã€Œãƒ—ãƒ­ã‚»ã‚¹ã®åŠ‡çš„ãªå¤‰åŒ–ãŒãƒãƒ¼ãƒ ã‚’ã‚„ã‚‹æ°—ã«ã•ã›ãŸã¨ãã«ä½•ã‚’ã™ã¹ãã‹ã€ãƒãƒ¼ãƒ ãƒªãƒ¼ãƒ€ãƒ¼ã«ãªã£ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ä½“é¨“</a></li>
<li><a href="../ja498118/index.html">ãƒªãƒ¢ãƒ¼ãƒˆã§ã®ä¼šè­°ï¼šJUG Ruã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¤‰æ›</a></li>
<li><a href="../ja498120/index.html">ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®æœ€é©åŒ–-ãƒ‘ãƒ¼ãƒˆ1</a></li>
<li><a href="../ja498122/index.html">è£½å“ã¨ã‚ãªãŸã®äººç”Ÿã‚’å°ç„¡ã—ã«ã—ãªã„ã‚ˆã†ã«ãƒªãƒ¢ãƒ¼ãƒˆã‚µã‚¤ãƒˆã§ãƒ†ã‚¹ãƒˆã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja498124/index.html">ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã‚µãƒãƒ¼ãƒˆã®ãŸã‚ã®é›»å ±ï¼šãƒ„ãƒ¼ãƒ«ã¨è½ã¨ã—ç©´</a></li>
<li><a href="../ja498126/index.html">ã‚¢ãƒã‚¾ãƒ³ãŒäººã€…ã«è³¼å…¥ã—ã¦ã‚‚ã‚‰ã†æ–¹æ³•...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>