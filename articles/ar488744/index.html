<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏾‍🤝‍🧑🏼 💩 👃🏼 دليل للعمل مع OpenAL في C ++. الجزء 1: تشغيل الصوت 🏇🏿 🚠 👰🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="لعبتك تحتاج إلى صوت! ربما استخدمت بالفعل برنامج OpenGL للرسم على الشاشة. لقد اكتشفت واجهة برمجة التطبيقات الخاصة به ، ولذلك لجأت إلى OpenAL لأن الاسم ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>دليل للعمل مع OpenAL في C ++. الجزء 1: تشغيل الصوت</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488744/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لعبتك تحتاج إلى صوت! </font><font style="vertical-align: inherit;">ربما استخدمت بالفعل برنامج OpenGL للرسم على الشاشة. </font><font style="vertical-align: inherit;">لقد اكتشفت واجهة برمجة التطبيقات الخاصة به ، ولذلك </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لجأت</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">OpenAL</font></a><font style="vertical-align: inherit;"> لأن الاسم يبدو مألوفًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، الخبر السار هو أن OpenAL لديها أيضًا واجهة برمجة تطبيقات مألوفة جدًا. </font><font style="vertical-align: inherit;">تم تصميمه في الأصل لمحاكاة واجهة برمجة تطبيقات مواصفات OpenGL. </font><font style="vertical-align: inherit;">لذلك اخترت ذلك من بين العديد من أنظمة الصوت للألعاب. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، هو عبر منصة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذه المقالة ، سأتحدث بالتفصيل عن الرمز المطلوب لاستخدام OpenAL في لعبة مكتوبة بلغة C ++. </font><font style="vertical-align: inherit;">سنناقش الأصوات والموسيقى ووضع الصوت في الفضاء ثلاثي الأبعاد مع أمثلة التعليمات البرمجية.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تاريخ OpenAL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
سأحاول الإيجاز. كما ذكر أعلاه ، فقد تم تصميمه عن عمد كتقليد لـ OpenGL API ، وهناك سبب لذلك. هذه واجهة برمجة تطبيقات مريحة ومعروفة للكثيرين ، وإذا كانت الرسومات جانبًا واحدًا من محرك اللعبة ، فيجب أن يكون الصوت مختلفًا. في البداية ، كان من المفترض أن يكون OpenAL مفتوح المصدر ، ولكن بعد ذلك حدث شيء ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الناس ليسوا مهتمين بالصوت كرسومات ، لذا قام Creative في نهاية المطاف بجعل OpenAL ملكًا له ، وأصبح </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنفيذ المرجع</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الآن ملكية وليس مجانيًا. لكن! </font><font style="vertical-align: inherit;">لا تزال </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مواصفات</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenAL معيارًا "مفتوحًا" ، أي أنه تم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نشره</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من وقت لآخر ، يتم تعديل المواصفات ، ولكن ليس كثيرًا. لا يتغير الصوت بسرعة الرسومات ، لأنه لا توجد حاجة خاصة لذلك.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
سمحت المواصفات المفتوحة لأشخاص آخرين بإنشاء تطبيق مفتوح المصدر للمواصفات. أحد هذه التطبيقات هو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وبصراحة ، لا معنى للبحث عن أي آخرين. هذا هو التطبيق الذي سأستخدمه ، وأوصي باستخدامه أيضًا.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هي عبر منصة. </font><font style="vertical-align: inherit;">يتم تنفيذه بشكل غريب - في الواقع ، داخل المكتبة تستخدم واجهات برمجة تطبيقات صوتية أخرى موجودة في نظامك. </font><font style="vertical-align: inherit;">في Windows ، يستخدم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectSound</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، على Unix ، </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">بفضل هذا ، كانت قادرة على أن تصبح عبر منصة. </font><font style="vertical-align: inherit;">في جوهرها ، هذا اسم كبير لواجهة برمجة التطبيقات المجمعة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قد تكون قلقًا بشأن سرعة واجهة برمجة التطبيقات هذه. </font><font style="vertical-align: inherit;">لكن لا تقلق. </font><font style="vertical-align: inherit;">هذا هو نفس الصوت ، ولا يخلق حمولة كبيرة ، لذلك لا يتطلب التحسينات الكبيرة التي تتطلبها واجهة برمجة التطبيقات للرسومات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لكن قصة كافية ، دعنا ننتقل إلى التكنولوجيا.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ماذا تحتاج لكتابة كود في OpenAL؟</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحتاج إلى بناء OpenAL Soft في سلسلة الأدوات التي تختارها. هذه عملية بسيطة جدًا يمكنك اتباعها وفقًا للإرشادات </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الواردة في قسم تثبيت المصدر</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . لم أواجه أي مشاكل في هذا الأمر أبدًا ، ولكن إذا واجهتك أي صعوبات ، فاكتب تعليقًا أسفل المقالة الأصلية أو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اكتب إلى قائمة بريد OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، ستحتاج إلى بعض الملفات الصوتية وطريقة لتنزيلها. تحميل بيانات الصوت في المخازن المؤقتة والتفاصيل الدقيقة لتنسيقات الصوت المختلفة خارج نطاق هذه المقالة ، ولكن يمكنك القراءة حول </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنزيل وتدفق ملفات Ogg / Vorbis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . تنزيل ملفات WAV بسيط للغاية ، هناك بالفعل مئات المقالات على الإنترنت حول هذا الموضوع.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
مهمة البحث عن الملفات الصوتية التي عليك أن تقررها بنفسك. </font><font style="vertical-align: inherit;">هناك العديد من الضوضاء والانفجارات على الإنترنت يمكنك تنزيلها. </font><font style="vertical-align: inherit;">إذا كانت لديك شائعة ، فيمكنك محاولة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كتابة موسيقى شيبتون الخاصة بك</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الترجمة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> على حبري]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أيضًا ، احتفظ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بدليل المبرمجين من OpenALSoft في متناول يدك</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">هذه الوثائق أفضل بكثير مع التخصص "الرسمي". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا ، في الواقع ، كل شيء. </font><font style="vertical-align: inherit;">سنفترض أنك تعرف بالفعل كيفية كتابة التعليمات البرمجية ، واستخدام IDE وسلسلة الأدوات.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نظرة عامة حول OpenAL API</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كما قلت عدة مرات ، إنها مشابهة لـ OpenGL API. يكمن التشابه في حقيقة أنه يقوم على الحالات وتتفاعل مع الواصفات / المعرّفات ، وليس مع الأشياء نفسها مباشرة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك اختلافات بين اصطلاحات API في OpenGL و OpenAL ، لكنها ليست كبيرة. في OpenGL ، تحتاج إلى إجراء مكالمات نظام تشغيل خاصة لإنشاء سياق عرض. تختلف هذه التحديات باختلاف أنظمة التشغيل </font><font style="vertical-align: inherit;">وليست </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حقًا</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> جزءًا من مواصفات OpenGL. في OpenAL ، كل شيء مختلف - وظائف إنشاء السياق هي جزء من المواصفات وهي نفسها بغض النظر عن نظام التشغيل. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عند التفاعل مع API ، هناك ثلاثة أنواع رئيسية من الكائنات التي تتفاعل معها. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المستمعين</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">("المستمعون") هو موقع "الأذنين" الموجود في مساحة ثلاثية الأبعاد (يوجد دائمًا مستمع واحد فقط). </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المصادر</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ("المصادر") هي "مكبرات صوت" تصدر صوتًا ، مرة أخرى في الفضاء ثلاثي الأبعاد. </font><font style="vertical-align: inherit;">يمكن نقل المستمع والمصادر في الفضاء ، وهذا يتوقف على ما تسمعه من خلال مكبرات الصوت في اللعبة يتغير. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الكائنات الأخيرة هي </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مخازن</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يقومون بتخزين عينات من الأصوات التي ستلعبها المصادر للمستمعين. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك أيضًا </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أوضاع</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تستخدمها اللعبة لتغيير طريقة معالجة الصوت من خلال OpenAL.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المصادر</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كما ذكر أعلاه ، هذه الأشياء هي مصادر الأصوات. </font><font style="vertical-align: inherit;">يمكن تعيين موضعها واتجاهها ، وهي مرتبطة بذاكرة تخزين مؤقت للبيانات الصوتية للتشغيل.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مستمع</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
المجموعة الوحيدة من "الأذنين" في اللعبة. </font><font style="vertical-align: inherit;">يتم إعادة إنتاج ما يسمعه المستمع من خلال مكبرات الصوت في الكمبيوتر. </font><font style="vertical-align: inherit;">لديه أيضا منصب.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مخازن</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في OpenGL ، ما يعادلها هو Texture2D. </font><font style="vertical-align: inherit;">في جوهرها ، هذه هي البيانات الصوتية التي يستنسخها المصدر.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أنواع البيانات</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لتكون قادرة على دعم التعليمات البرمجية عبر الأنظمة الأساسية ، تقوم OpenAL بتنفيذ سلسلة معينة من الإجراءات وتحدد بعض أنواع البيانات. </font><font style="vertical-align: inherit;">في الواقع ، إنه يتبع برنامج OpenGL بدقة بحيث يمكننا تحويل أنواع OpenAL مباشرة إلى أنواع OpenGL. </font><font style="vertical-align: inherit;">يسرد الجدول أدناه لهم وما يعادلها.</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اكتب openal</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اكتب openalc</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اكتب opengl</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++ Typedef</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وصف</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALboolean</code></td>
<td><code>ALCboolean</code></td>
<td><code>GLboolean</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيمة منطقية 8 بت</font></font></td>
</tr>
<tr>
<td><code>ALbyte</code></td>
<td><code>ALCbyte</code></td>
<td><code>GLbyte</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيمة عددية 8 بت </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">للرمز الإضافي</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بعلامة</font></font></td>
</tr>
<tr>
<td><code>ALubyte</code></td>
<td><code>ALCubyte</code></td>
<td><code>GLubyte</code></td>
<td><code>std::uint8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيمة عددية غير موقعة 8 بت</font></font></td>
</tr>
<tr>
<td><code>ALchar</code></td>
<td><code>ALCchar</code></td>
<td><code>GLchar</code></td>
<td><code>char</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رمز</font></font></td>
</tr>
<tr>
<td><code>ALshort</code></td>
<td><code>ALCshort</code></td>
<td><code>GLshort</code></td>
<td><code>std::int16_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيمة عددية 16 بت موقعة</font></font></td>
</tr>
<tr>
<td><code>ALushort</code></td>
<td><code>ALCushort</code></td>
<td><code>GLushort</code></td>
<td><code>std::uint16_t</code></td>
<td>16-    </td>
</tr>
<tr>
<td><code>ALint</code></td>
<td><code>ALCint</code></td>
<td><code>GLint</code></td>
<td><code>std::int32_t</code></td>
<td>32-      </td>
</tr>
<tr>
<td><code>ALuint</code></td>
<td><code>ALCuint</code></td>
<td><code>GLuint</code></td>
<td><code>std::uint32_t</code></td>
<td>32-    </td>
</tr>
<tr>
<td><code>ALsizei</code></td>
<td><code>ALCsizei</code></td>
<td><code>GLsizei</code></td>
<td><code>std::int32_t</code></td>
<td> 32-   </td>
</tr>
<tr>
<td><code>ALenum</code></td>
<td><code>ALCenum</code></td>
<td><code>GLenum</code></td>
<td><code>std::uint32_t</code></td>
<td> 32- </td>
</tr>
<tr>
<td><code>ALfloat</code></td>
<td><code>ALCfloat</code></td>
<td><code>GLfloat</code></td>
<td><code>float</code></td>
<td>32-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">IEEE 754</a></td>
</tr>
<tr>
<td><code>ALdouble</code></td>
<td><code>ALCdouble</code></td>
<td><code>GLdouble</code></td>
<td><code>double</code></td>
<td>64-     IEEE 754</td>
</tr>
<tr>
<td><code>ALvoid</code></td>
<td><code>ALCvoid</code></td>
<td><code>GLvoid</code></td>
<td><code>void</code></td>
<td> </td>
</tr>
</tbody>
</table></div><br>
<h2>  OpenAL</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك مقال حول كيفية </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تبسيط التعرف على أخطاء OpenAL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ولكن من أجل الاكتمال ، سأكررها هنا. هناك </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نوعان</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> من مكالمات OpenAL API: عادية وسياقية. </font><font style="vertical-align: inherit;">تشبه </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
مكالمات السياق التي تبدأ </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بـ OpenGL win32 المكالمات للحصول على سياق العرض أو نظرائهم على Linux. الصوت هو شيء بسيط بما يكفي لجميع أنظمة التشغيل للحصول على نفس المكالمات. تبدأ المكالمات العادية بـ </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. للحصول على أخطاء في المكالمات السياقية ، نسميها </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">؛ في حالة المكالمات المنتظمة ، نسميها </font></font><code>alGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ترجع إما قيمة </font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أو قيمة </font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تسرد الأخطاء المحتملة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن سننظر في حالة واحدة فقط ، ولكن في كل شيء آخر هم تقريبًا نفس الشيء. </font><font style="vertical-align: inherit;">لنأخذ التحديات المعتادة </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">أولاً ، قم بإنشاء ماكرو معالج مسبق للقيام بالمهمة المملة لتمرير التفاصيل:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alCall(function, ...) alCallImpl(__FILE__, __LINE__, function, __VA_ARGS__)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من الناحية النظرية ، قد لا يدعم المترجم الخاص بك </font></font><code>__FILE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أيضًا </font></font><code>__LINE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، ولكن ، لأكون صادقًا ، سأفاجأ إذا تبين أن ذلك صحيح. </font></font><code>__VA_ARGS__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يشير إلى عدد متغير من الوسيطات التي يمكن تمريرها إلى هذا الماكرو. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد ذلك ، نقوم بتنفيذ وظيفة تتلقى يدويًا آخر خطأ تم الإبلاغ عنه وتعرض قيمة واضحة لدفق الخطأ القياسي.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_al_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line)</span>
</span>{<font></font>
    ALenum error = alGetError();<font></font>
    <span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> AL_INVALID_NAME:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_NAME: a bad name (ID) was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_ENUM: an invalid enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_OPERATION:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_OPERATION: the requested operation is not valid"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_OUT_OF_MEMORY: the requested operation resulted in OpenAL running out of memory"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN AL ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ليس هناك الكثير من الأخطاء المحتملة. </font><font style="vertical-align: inherit;">التفسيرات التي كتبتها في الكود هي المعلومات الوحيدة التي ستتلقاها حول هذه الأخطاء ، لكن المواصفات توضح سبب قيام دالة معينة بإرجاع خطأ معين. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم ننفذ وظيفتين مختلفتين للقالب ستلف جميع مكالمات OpenGL.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                alFunction function, 
                Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;
</span>{
    <span class="hljs-keyword">auto</span> ret = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);<font></font>
    check_al_errors(filename,line);<font></font>
    <span class="hljs-keyword">return</span> ret;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك نوعان منها ، لأن الأولى تُستخدم لوظائف OpenAL التي تُرجع </font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، والثانية تُستخدم عندما تُرجع الدالة قيمة غير فارغة. </font><font style="vertical-align: inherit;">إذا لم تكن على دراية كبيرة بقوالب البرمجة التخطيطية في C ++ ، فألق نظرة على أجزاء الرمز c </font></font><code>std::enable_if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">إنها تحدد أي من وظائف القالب هذه يتم تنفيذها من قبل المترجم لكل استدعاء دالة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
والآن نفس الشيء للمكالمات </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alcCall(function, device, ...) alcCallImpl(__FILE__, __LINE__, function, device, __VA_ARGS__)</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_alc_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, ALCdevice* device)</span>
</span>{<font></font>
    ALCenum error = alcGetError(device);<font></font>
    <span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> ALC_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_DEVICE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_DEVICE: a bad device was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_CONTEXT:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_CONTEXT: a bad context was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_ENUM: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_OUT_OF_MEMORY: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN ALC ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span> ReturnType, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename,
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line,
                 alcFunction function,
                 ReturnType&amp; returnValue,
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    returnValue = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
التغيير الأكبر هو التضمين </font></font><code>device</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، الذي تستخدمه جميع المكالمات </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، بالإضافة إلى الاستخدام المقابل لأخطاء النمط </font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">و </font></font><code>ALC_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">إنها تبدو متشابهة جدًا ، ولمدة طويلة جدًا ، تغيرت التغييرات الصغيرة من </font><font style="vertical-align: inherit;">التعليمات البرمجية وفهمي </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إلى </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الضرر الشديد ، لذلك واصلت القراءة مباشرةً فوقها </font></font><code>c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا كل شئ. </font><font style="vertical-align: inherit;">عادةً ما تبدو مكالمة OpenAL في C ++ كأحد الخيارات التالية:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
alGenSources(<span class="hljs-number">1</span>, &amp;source);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span><font></font>
alcCaptureStart(&amp;device);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz = alGetString(param);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz = alcGetString(&amp;device, param);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ولكن الآن يمكننا القيام بذلك على النحو التالي:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
<span class="hljs-keyword">if</span>(!alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span>
<span class="hljs-keyword">if</span>(!alcCall(alcCaptureStart, &amp;device))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz;
<span class="hljs-keyword">if</span>(!alCall(alGetString, sz, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz;
<span class="hljs-keyword">if</span>(!alcCall(alcGetString, sz, &amp;device, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
قد يبدو الأمر غريبًا بالنسبة لك ، ولكنه أكثر ملاءمة بالنسبة لي. </font><font style="vertical-align: inherit;">بالطبع ، يمكنك اختيار هيكل مختلف.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنزيل ملفات wav</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكنك تنزيلها بنفسك أو استخدام المكتبة. </font><font style="vertical-align: inherit;">فيما يلي تطبيق </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مفتوح المصدر لتحميل ملفات wav</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">أنا مجنونة ، لذلك أقوم بذلك بنفسي:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> <span class="hljs-title">convert_to_int</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* buffer, <span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> len)</span>
</span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> a = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::endian::native == <span class="hljs-built_in">std</span>::endian::little)
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">memcpy</span>(&amp;a, buffer, len);
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i)
            <span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">char</span>*&gt;(&amp;a)[<span class="hljs-number">3</span> - i] = buffer[i];
    <span class="hljs-keyword">return</span> a;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">load_wav_file_header</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::ifstream&amp; file,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
                          ALsizei&amp; size)</span>
</span>{
    <span class="hljs-keyword">char</span> buffer[<span class="hljs-number">4</span>];
    <span class="hljs-keyword">if</span>(!file.is_open())
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-comment">// the RIFF</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read RIFF"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"RIFF"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't begin with RIFF)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the size of the file</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read size of file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the WAVE</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read WAVE"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"WAVE"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't contain WAVE)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// "fmt/0"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read fmt/0"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// this is always 16, the size of the fmt data chunk</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read the 16"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// PCM should be 1?</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read PCM"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the number of channels</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read number of channels"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    channels = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// sample rate</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read sample rate"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    sampleRate = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">// (sampleRate * bitsPerSample * channels) / 8</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read (sampleRate * bitsPerSample * channels) / 8"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// ?? dafaq</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read dafaq"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// bitsPerSample</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read bits per sample"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    bitsPerSample = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// data chunk header "data"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data chunk header"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"data"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (doesn't have 'data' tag)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// size of data</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data size"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    size = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">/* cannot be at the end of file */</span>
    <span class="hljs-keyword">if</span>(file.eof())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: reached EOF on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(file.fail())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: fail state set on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">load_wav</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
               ALsizei&amp; size)</span>
</span>{
    <span class="hljs-function"><span class="hljs-built_in">std</span>::ifstream <span class="hljs-title">in</span><span class="hljs-params">(filename, <span class="hljs-built_in">std</span>::ios::binary)</span></span>;
    <span class="hljs-keyword">if</span>(!in.is_open())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not open \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(!load_wav_file_header(in, channels, sampleRate, bitsPerSample, size))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav header of \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">char</span>* data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[size];<font></font>
<font></font>
    in.read(data, size);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> data;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لن أشرح الشفرة ، لأن هذا ليس بالكامل في موضوع مقالنا ؛ </font><font style="vertical-align: inherit;">ولكن من الواضح جدًا إذا قرأته بالتوازي مع </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مواصفات ملف WAV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التهيئة والتدمير</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحتاج أولاً إلى تهيئة OpenAL ، ثم ، مثل أي مبرمج جيد ، ننهيها عندما ننتهي من العمل معها. </font><font style="vertical-align: inherit;">يتم استخدامه أثناء التهيئة </font></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(لاحظ أن هذا </font></font><code>ALC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هو </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لا</font></font></i> <code>AL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )، الذي يمثل أساسا شيء على جهاز الكمبيوتر الخاص بك لتشغيل الموسيقى الخلفية والاستخدامات عليه </font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على غرار اختيار بطاقة رسومات. </font><font style="vertical-align: inherit;">الذي سيتم عرض لعبة OpenGL عليه. </font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">على غرار سياق العرض الذي تريد إنشاءه (فريد لنظام التشغيل) لـ OpenGL.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alcdevice</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
جهاز OpenAL هو ما يتم من خلاله إخراج الصوت ، سواء كان بطاقة صوت أو شريحة ، ولكن من الناحية النظرية يمكن أن يكون هناك الكثير من الأشياء المختلفة. على غرار كيف </font></font><code>iostream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يمكن أن يكون </font><font style="vertical-align: inherit;">الإخراج القياسي </font><font style="vertical-align: inherit;">طابعة بدلاً من شاشة ، يمكن أن يكون الجهاز ملفًا أو حتى دفق بيانات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ومع ذلك ، بالنسبة لألعاب البرمجة ، سيكون جهاز صوت ، وعادة ما نريده أن يكون جهاز إخراج صوت قياسي في النظام. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
للحصول على قائمة بالأجهزة المتاحة في النظام ، يمكنك طلبها بهذه الوظيفة:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">get_available_devices</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;&amp; devicesVec, ALCdevice* device)</span>
</span>{
    <span class="hljs-keyword">const</span> ALCchar* devices;
    <span class="hljs-keyword">if</span>(!alcCall(alcGetString, devices, device, <span class="hljs-literal">nullptr</span>, ALC_DEVICE_SPECIFIER))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ptr = devices;<font></font>
<font></font>
    devicesVec.clear();<font></font>
<font></font>
    <span class="hljs-keyword">do</span><font></font>
    {<font></font>
        devicesVec.push_back(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(ptr));<font></font>
        ptr += devicesVec.back().size() + <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">while</span>(*(ptr + <span class="hljs-number">1</span>) != <span class="hljs-string">'\0'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا في الواقع مجرد غلاف حول غلاف حول مكالمة </font></font><code>alcGetString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. القيمة المرجعة هي مؤشر لقائمة من السلاسل المفصولة بقيمة </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وتنتهي بقيمتين </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. هنا ، يقوم الغلاف ببساطة بتحويله إلى ناقل مناسب لنا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لحسن الحظ ، لسنا بحاجة للقيام بذلك! في الحالة العامة ، كما أعتقد ، يمكن لمعظم الألعاب ببساطة إخراج الصوت للجهاز بشكل افتراضي ، مهما كان. نادرًا ما أرى خيارات تغيير جهاز الصوت الذي تريد من خلاله إخراج الصوت. لذلك ، لتهيئة جهاز OpenAL ، نستخدم مكالمة </font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. تختلف هذه المكالمة قليلاً عن أي شيء آخر ، لأنها لا تحدد حالة الخطأ التي يمكن الحصول عليها من خلالها </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، لذلك نسميها مثل وظيفة عادية:</font></font><br>
<br>
<pre><code class="cpp hljs">ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
<span class="hljs-keyword">if</span>(!openALDevice)<font></font>
{<font></font>
    <span class="hljs-comment">/* fail */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذا قمت بإدراج الأجهزة كما هو موضح أعلاه ، وتريد من المستخدم تحديد أحدها ، فأنت بحاجة إلى نقل اسمه إلى </font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بدلاً من ذلك </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. إرسال </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أوامر </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لفتح الجهاز بشكل افتراضي</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . القيمة المرتجعة هي إما الجهاز المقابل ، أو في </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حالة حدوث خطأ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
اعتمادًا على ما إذا كنت قد أكملت التعداد أم لا ، فقد يؤدي خطأ إلى إيقاف البرنامج على المسارات. لا يوجد جهاز = لا OpenAL ؛ لا OpenAL = لا يوجد صوت ؛ لا صوت = لا لعبة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
آخر شيء نقوم به عند إغلاق البرنامج هو إكماله بشكل صحيح.</font></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean closed;
<span class="hljs-keyword">if</span>(!alcCall(alcCloseDevice, closed, openALDevice, openALDevice))<font></font>
{<font></font>
    <span class="hljs-comment">/* do we care? */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذه المرحلة ، إذا كان الإنجاز غير ممكن ، فهذا لم يعد مهمًا بالنسبة لنا. قبل إغلاق الجهاز ، يجب علينا إغلاق جميع السياقات التي تم إنشاؤها ، ومع ذلك ، في تجربتي ، هذه المكالمة تكمل أيضًا السياق. لكننا سنفعل ذلك بشكل صحيح. إذا أكملت كل شيء قبل إجراء مكالمة </font></font><code>alcCloseDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، فلا يجب أن تكون هناك أخطاء ، وإذا نشأت لسبب ما ، فلا يمكنك فعل أي شيء حيال ذلك. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ربما لاحظت أن المكالمات الواردة من </font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إرسال نسختين من الجهاز. حدث ذلك بسبب كيفية عمل وظيفة القالب - هناك حاجة إلى واحدة للتحقق من الأخطاء ، والثانية تستخدم كمعلمة دالة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من الناحية النظرية ، يمكنني تحسين وظيفة القالب بحيث يمر المعلمة الأولى للتحقق من الأخطاء وما زال يرسلها إلى الوظيفة ؛ </font><font style="vertical-align: inherit;">لكنني كسول للقيام بذلك. </font><font style="vertical-align: inherit;">سأترك هذا واجبك.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALCcontext لدينا</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الجزء الثاني من التهيئة هو السياق. </font><font style="vertical-align: inherit;">كما كان من قبل ، يشبه سياق العرض من OpenGL. </font><font style="vertical-align: inherit;">يمكن أن يكون هناك العديد من السياقات في برنامج واحد ويمكننا التبديل بينها ، ولكننا لن نحتاج إلى ذلك. </font><font style="vertical-align: inherit;">كل سياق لديها قناعاتها </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المستمع</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المصادر</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، وأنها لا يمكن أن تنتقل بين السياقات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ربما يكون هذا مفيدًا في برنامج معالجة الصوت. </font><font style="vertical-align: inherit;">ومع ذلك ، بالنسبة للألعاب في 99.9٪ من الحالات ، يكفي سياق واحد فقط. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إنشاء سياق جديد أمر بسيط للغاية:</font></font><br>
<br>
<pre><code class="cpp hljs">ALCcontext* openALContext;
<span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit program */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحن بحاجة إلى التواصل من أجل ما </font></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نريد إنشاء سياق ؛ </font><font style="vertical-align: inherit;">يمكننا أيضًا تمرير قائمة اختيارية ذات قيمة صفرية من المفاتيح والقيم </font></font><code>ALCint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، وهي سمات يجب إنشاء السياق من خلالها. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بصراحة ، أنا لا أعرف حتى في أي حالة يكون تمرير سمة مفيدًا. </font><font style="vertical-align: inherit;">سيتم تشغيل اللعبة على جهاز كمبيوتر عادي مع ميزات الصوت المعتادة. </font><font style="vertical-align: inherit;">للسمات قيم افتراضية ، اعتمادًا على جهاز الكمبيوتر ، لذلك هذا ليس مهمًا بشكل خاص. </font><font style="vertical-align: inherit;">ولكن في حال كنت لا تزال بحاجة إليها:</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم السمة</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وصف</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALC_FREQUENCY</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تردد الخلط إلى المخزن المؤقت للإخراج ، يقاس بالهرتز</font></font></td>
</tr>
<tr>
<td><code>ALC_REFRESH</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فترات التحديث ، تقاس هرتز</font></font></td>
</tr>
<tr>
<td><code>ALC_SYNC</code></td>
<td><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أو </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تشير إلى ما إذا كان يجب أن يكون سياق متزامن أو غير متزامن</font></font></td>
</tr>
<tr>
<td><code>ALC_MONO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيمة تساعدك في إخبارك بعدد المصادر التي ستستخدمها والتي تتطلب القدرة على معالجة البيانات الصوتية أحادية الصوت. </font><font style="vertical-align: inherit;">لا يحد من الحد الأقصى للمبلغ ، فهو يسمح لك فقط بأن تكون أكثر فعالية عندما تعرف ذلك مسبقًا.</font></font></td>
</tr>
<tr>
<td><code>ALC_STEREO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نفس الشيء ، ولكن بالنسبة لبيانات الاستريو.</font></font></td>
</tr>
</tbody>
</table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذا حصلت على أخطاء ، فمن المرجح أن هذا يرجع إلى أن السمات التي تريدها مستحيلة أو لا يمكنك إنشاء سياق آخر للجهاز المدعوم ؛ </font><font style="vertical-align: inherit;">سيؤدي هذا إلى حدوث خطأ </font></font><code>ALC_INVALID_VALUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">إذا قمت بتمرير جهاز غير صالح ، فسوف تحصل على خطأ </font></font><code>ALC_INVALID_DEVICE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، ولكننا بالطبع نتحقق من هذا الخطأ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إنشاء السياق لا يكفي. </font><font style="vertical-align: inherit;">ما زلنا بحاجة إلى جعله محدثًا - يبدو مثل سياق عرض Windows OpenGL ، أليس كذلك؟ </font><font style="vertical-align: inherit;">نفس الشيء.</font></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
   || contextMadeCurrent != ALC_TRUE)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit or give up on having sound */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من الضروري جعل السياق الحالي لأي عمليات أخرى مع السياق (أو مع المصادر والمستمعين فيه). </font><font style="vertical-align: inherit;">ستعود العملية </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أو </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، قيمة الخطأ المحتملة الوحيدة </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التي تم </font><font style="vertical-align: inherit;">إرسالها </font><font style="vertical-align: inherit;">هي تلك </font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التي تكون واضحة من الاسم. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الانتهاء مع السياق ، أي </font><font style="vertical-align: inherit;">عند الخروج من البرنامج ، من الضروري ألا يكون السياق الحالي ، ومن ثم تدميره.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>))<font></font>
{<font></font>
    <span class="hljs-comment">/* what can you do? */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span>(!alcCall(alcDestroyContext, openALDevice, openALContext))<font></font>
{<font></font>
    <span class="hljs-comment">/* not much you can do */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الخطأ ممكنا إلا من </font></font><code>alcDestroyContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هو نفسه كما ان من </font></font><code>alcMakeContextCurrent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">إذا فعلت كل شيء بشكل صحيح ، فلن تحصل عليه ، ولكن إذا فعلت ذلك ، فلا يمكن فعل شيء حيال ذلك.</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لماذا التحقق من الأخطاء التي لا يمكن فعل شيء معها؟ </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لأنني أريد أن تظهر الرسائل المتعلقة بها على الأقل في تدفق الأخطاء ، وهو ما يحدث لنا. </font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لنفترض أنه لا يعطينا أخطاء أبدًا ، ولكن سيكون من المفيد معرفة أن مثل هذا الخطأ يحدث على كمبيوتر شخص آخر. </font><font style="vertical-align: inherit;">بفضل هذا ، يمكننا دراسة المشكلة ، وربما </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الإبلاغ عن خطأ لمطوري OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تشغيل صوتنا الأول</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، يكفي كل هذا ، فلنقم بتشغيل الصوت. </font><font style="vertical-align: inherit;">بادئ ذي بدء ، من الواضح أننا بحاجة إلى ملف صوتي. </font><font style="vertical-align: inherit;">على سبيل المثال ، هذه </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اللعبة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> من </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">لعبة سوف أنتهي من أي وقت مضى</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="oembed"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://indiegamedev.net/wp-content/uploads/2020/02/iamtheprotectorofthissystem.wav</font></font></a></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أنا حامي هذا النظام!</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
لذا ، افتح IDE واستخدم الكود التالي. تذكر أن تقوم بتوصيل OpenAL Soft وإضافة رمز تحميل الملف ورمز التحقق من الأخطاء الموضح أعلاه.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
    <span class="hljs-keyword">if</span>(!openALDevice)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    ALCcontext* openALContext;<font></font>
    <span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
       || contextMadeCurrent != ALC_TRUE)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
    <span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    ALuint buffer;<font></font>
    alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    ALenum format;<font></font>
    <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_MONO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_MONO16;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_STEREO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_STEREO16;<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
            &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
            &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
            &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
    soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span><font></font>
<font></font>
    ALuint source;<font></font>
    alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
    alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
    alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
    alCall(alSourcei, source, AL_BUFFER, buffer);<font></font>
<font></font>
    alCall(alSourcePlay, source);<font></font>
<font></font>
    ALint state = AL_PLAYING;<font></font>
<font></font>
    <span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
    {<font></font>
        alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
    }<font></font>
<font></font>
    alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>);<font></font>
    alcCall(alcDestroyContext, openALDevice, openALContext);<font></font>
<font></font>
    ALCboolean closed;<font></font>
    alcCall(alcCloseDevice, closed, openALDevice, openALDevice);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تجميع! </font><font style="vertical-align: inherit;">نحن نؤلف! </font><font style="vertical-align: inherit;">إطلاق! </font></font><em><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أنا مقدِّم هذا النظام</font></font></strong></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">إذا لم تسمع الصوت ، فقم بفحص كل شيء مرة أخرى. </font><font style="vertical-align: inherit;">إذا تم كتابة شيء ما في نافذة وحدة التحكم ، فيجب أن يكون هذا هو الناتج القياسي لدفق الخطأ ، وهو أمر مهم. </font><font style="vertical-align: inherit;">يجب أن تخبرنا وظائف الإبلاغ عن الأخطاء لدينا بسطر شفرة المصدر الذي أدى إلى الخطأ. </font><font style="vertical-align: inherit;">إذا وجدت </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
خطأ، وقراءة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">دليل المبرمجين</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مواصفات</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لفهم الظروف التي يمكن أن تتولد هذا الخطأ عن طريق وظيفة. </font><font style="vertical-align: inherit;">هذا سيساعدك على معرفة ذلك. </font><font style="vertical-align: inherit;">إذا لم تنجح ، فاترك تعليقًا تحت المقالة الأصلية ، وسأحاول المساعدة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قم بتنزيل بيانات RIFF WAVE</font></font></h3><br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
<span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يشير هذا إلى رمز تمهيد الموجة. </font><font style="vertical-align: inherit;">الشيء المهم هو أننا نتلقى بيانات ، إما كمؤشر ، أو مجمعة في ناقل: عدد القنوات ، ومعدل أخذ العينات وعدد البتات لكل عينة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الجيل العازل</font></font></h3><br>
<pre><code class="cpp hljs">ALuint buffer;<font></font>
alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ربما يبدو مألوفًا لك إذا قمت بإنشاء مخازن بيانات نسيج في OpenGL. في الأساس ، نقوم بإنشاء مخزن مؤقت ونتظاهر بأنه سيكون موجودًا فقط في بطاقة الصوت. في الواقع ، سيتم تخزينه على الأرجح في ذاكرة الوصول العشوائي العادية ، ولكن مواصفات OpenAL تلخص كل هذه العمليات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، فإن القيمة </font></font><code>ALuint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هي </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مقبض</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> المخزن المؤقت لدينا. تذكر أن </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المخزن المؤقت</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هو بيانات سليمة في ذاكرة بطاقة الصوت. لم يعد لدينا </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وصول مباشر</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى هذه البيانات ، حيث أخذناها من البرنامج (من ذاكرة الوصول العشوائي العادية) ونقلناها إلى بطاقة الصوت / الشريحة ، وما إلى ذلك. يعمل OpenGL بالمثل ، حيث ينقل بيانات النسيج من ذاكرة الوصول العشوائي إلى VRAM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الواصف</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يولد </font></font><code>alGenBuffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">يحتوي على اثنين من قيم الخطأ المحتملة ، وأهمها </font></font><code>AL_OUT_OF_MEMORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، مما يعني أنه لم يعد بإمكاننا إضافة بيانات الصوت إلى بطاقة الصوت. </font><font style="vertical-align: inherit;">لن تحصل على </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هذا</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الخطأ إذا كنت ، على سبيل المثال ، تستخدم مخزنًا مؤقتًا واحدًا ، ولكنك تحتاج إلى التفكير في ذلك إذا كنت تقوم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بإنشاء محرك</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تحديد تنسيق البيانات الصوتية</font></font></h3><br>
<pre><code class="cpp hljs">ALenum format;<font></font>
<font></font>
<span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_MONO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_MONO16;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_STEREO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_STEREO16;<font></font>
<span class="hljs-keyword">else</span><font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
        &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
        &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
        &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تعمل البيانات الصوتية على النحو التالي: هناك العديد من </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">القنوات</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وهناك حجم صغير </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لكل عينة</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">تتكون البيانات من العديد من </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العينات</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لتحديد عدد </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العينات</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في البيانات الصوتية ، نقوم بما يلي:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int_fast32_t</span> numberOfSamples = dataSize / (numberOfChannels * (bitsPerSample / <span class="hljs-number">8</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ما يمكن تحويله بسهولة لحساب </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مدة</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> البيانات الصوتية:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> duration = numberOfSamples / sampleRate;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ولكن في حين أننا لسنا بحاجة إلى معرفة لا </font></font><code>numberOfSamples</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، ولا </font></font><code>duration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، مع ذلك ، من المهم معرفة كيفية استخدام كل هذه المعلومات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عودة إلى </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- نحتاج إلى إخبار OpenAL بتنسيق بيانات الصوت. يبدو ذلك واضحًا ، أليس كذلك؟ على غرار كيفية ملء المخزن المؤقت لمادة OpenGL ، قائلة إن البيانات في تسلسل BGRA وتتكون من قيم 8 بت ، نحتاج إلى القيام بنفس الشيء في OpenAL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لإخبار OpenAL بكيفية تفسير البيانات التي يشير إليها المؤشر الذي سنمرره لاحقًا ، نحتاج إلى تعريف تنسيق البيانات. تحت </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التنسيق</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، يقصد به OpenAL. لا يوجد سوى أربعة معاني محتملة. هناك قيمتان محتملتان لعدد القنوات: واحدة للأحادية ، واثنتان للاستريو.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالإضافة إلى عدد القنوات ، لدينا عدد البتات لكل عينة. </font><font style="vertical-align: inherit;">إنه يساوي أو </font></font><code>8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، أو </font></font><code>16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، وهو جودة الصوت بشكل أساسي. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لذا ، باستخدام قيم القنوات والبتات لكل عينة ، والتي أبلغتنا بها وظيفة تحميل الموجة ، يمكننا تحديد أيها </font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نستخدمه للمعلمة المستقبلية </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تعبئة عازلة</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
مع هذا ، يجب أن يكون كل شيء بسيطًا. </font><font style="vertical-align: inherit;">نقوم بالتحميل في مخزن OpenAL Buffer ، الذي يشير إليه </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الواصف</font></font></em> <code>buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ؛ </font><font style="vertical-align: inherit;">البيانات المشار إليها بواسطة ptr </font></font><code>soundData.data()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">في حجم </font></font><code>size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المحدد </font></font><code>sampleRate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">سنقوم أيضًا بإبلاغ OpenAL بتنسيق هذه البيانات من خلال المعلمة </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في النهاية ، نقوم ببساطة بحذف البيانات التي تلقاها محمل الموجة. </font><font style="vertical-align: inherit;">لماذا ا؟ </font><font style="vertical-align: inherit;">لأننا قمنا بنسخها بالفعل إلى بطاقة الصوت. </font><font style="vertical-align: inherit;">لسنا بحاجة لتخزينها في مكانين وإنفاق موارد ثمينة. </font><font style="vertical-align: inherit;">إذا فقدت بطاقة الصوت البيانات ، فسنقوم ببساطة بتنزيلها من القرص مرة أخرى ولن نحتاج إلى نسخها إلى وحدة المعالجة المركزية أو أي شخص آخر.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إعداد المصدر</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يذكر أن مكتبة الصوت المفتوحة هو في الأساس </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المستمع</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أن يستمع إلى الأصوات التي أدلى بها واحد أو أكثر من </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مصادر</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . حسنًا ، حان الوقت الآن لإنشاء مصدر صوت.</font></font><br>
<br>
<pre><code class="cpp hljs">ALuint source;<font></font>
alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
alCall(alSourcei, source, AL_BUFFER, buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بصراحة ، ليس من الضروري تعيين بعض هذه المعلمات ، لأن القيم الافتراضية مناسبة تمامًا لنا. لكن هذا يوضح لنا بعض الجوانب التي يمكنك من خلالها تجربة ومعرفة ما يفعلونه (يمكنك حتى التصرف بمكر وتغييرها بمرور الوقت). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أولاً ننشئ المصدر - تذكر ، هذا مرة أخرى </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مقبض</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لشيء داخل OpenAL API. نضع درجة (نغمة) بحيث لا تتغير ، ويتم كسب (حجم) مساوٍ للقيمة الأصلية لبيانات الصوت ، ويتم إعادة تعيين الموقع والسرعة ؛ نحن </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لا نكرر</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الصوت ، وإلا فلن ينتهي برنامجنا أبدًا ، ويشير إلى المخزن المؤقت.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تذكر أن المصادر المختلفة يمكنها استخدام نفس المخزن المؤقت. </font><font style="vertical-align: inherit;">على سبيل المثال ، يمكن للأعداء الذين يطلقون النار على لاعب من أماكن مختلفة تشغيل نفس صوت اللقطة ، لذلك لا نحتاج إلى العديد من نسخ بيانات الصوت ، ولكن فقط عدد قليل من الأماكن في الفضاء ثلاثي الأبعاد الذي يصدر منه الصوت.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تشغيل الصوت</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alSourcePlay, source);<font></font>
<font></font>
ALint state = AL_PLAYING;<font></font>
<font></font>
<span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
{<font></font>
    alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نحتاج أولاً إلى بدء تشغيل المصدر. </font><font style="vertical-align: inherit;">ببساطة اتصل </font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم نقوم بإنشاء قيمة لتخزين الحالة الحالية </font></font><code>AL_SOURCE_STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">للمصدر وتحديثها إلى ما لا نهاية. </font><font style="vertical-align: inherit;">عندما لا تكون متساوية ، </font></font><code>AL_PLAYING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يمكننا الاستمرار. </font><font style="vertical-align: inherit;">يمكنك تغيير الحالة إلى </font></font><code>AL_STOPPED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">عندما تنتهي من إصدار الصوت من المخزن المؤقت (أو عند حدوث خطأ). </font><font style="vertical-align: inherit;">إذا قمت بتعيين قيمة التكرار </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، فسيتم تشغيل الصوت إلى الأبد. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم يمكننا تغيير المخزن المؤقت المصدر وتشغيل صوت آخر. </font><font style="vertical-align: inherit;">أو إعادة تشغيل نفس الصوت ، إلخ. </font><font style="vertical-align: inherit;">ما عليك سوى تعيين المخزن المؤقت واستخدامه </font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وربما </font></font><code>alSourceStop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا لزم الأمر. </font><font style="vertical-align: inherit;">في المقالات التالية سننظر في هذا بمزيد من التفصيل.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنظيف</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نظرًا لأننا نقوم ببساطة بتشغيل البيانات الصوتية مرة واحدة ونخرج ، فسنحذف المصدر والمخزن المؤقت اللذين تم إنشاؤهما مسبقًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بقية الشفرة مفهومة بدون تفسير.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إلى أين أذهب بعد ذلك؟</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بمعرفة كل شيء موصوف في هذه المقالة ، يمكنك بالفعل إنشاء لعبة صغيرة! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حاول إنشاء </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لعبة </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">Pong</font></a><font style="vertical-align: inherit;"> أو </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">أي لعبة كلاسيكية أخرى</font></a><font style="vertical-align: inherit;"> ، لأن المزيد منها غير مطلوب. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لكن تذكر! </font><font style="vertical-align: inherit;">هذه المخازن المؤقتة مناسبة فقط للأصوات القصيرة ، على الأرجح لبضع ثوان. </font><font style="vertical-align: inherit;">إذا كنت بحاجة إلى الموسيقى أو التمثيل الصوتي ، فستحتاج إلى دفق الصوت إلى OpenAL. </font><font style="vertical-align: inherit;">سنتحدث عن هذا في أحد الأجزاء التالية من سلسلة من البرامج التعليمية.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar488730/index.html">معايير روسية جديدة لإنترنت الأشياء والتصنيع الذكي والمدينة الذكية</a></li>
<li><a href="../ar488732/index.html">الموهوب السيد سيمون: كيف يمكن للقدرات الفريدة والطباعة ثلاثية الأبعاد أن تغير عملية الإنتاج</a></li>
<li><a href="../ar488736/index.html">العمل عن بعد يكتسب زخما</a></li>
<li><a href="../ar488740/index.html">دليل علامات HTML المخصص لبرنامج إدارة العلامات من Google بواسطة Simo Ahava</a></li>
<li><a href="../ar488742/index.html">ترى العمارة؟ وأنا لا أرى ، لكنها هي</a></li>
<li><a href="../ar488748/index.html">إنشاء تطبيق Todo باستخدام Django. الجزء الأول</a></li>
<li><a href="../ar488750/index.html">ممشى الديناصورات: جهازي كمبيوتر كبيران في القرن العشرين</a></li>
<li><a href="../ar488752/index.html">Golang + Phaser3 = MMORPG - نحن نصنع الأساس للجيل اللامتناهي من العالم</a></li>
<li><a href="../ar488754/index.html">الكل مرة واحدة: الفحص التلقائي لحجم الحزمة</a></li>
<li><a href="../ar488756/index.html">كيفية العمل مع Google Sheets API (Google Sheets API v4) في R باستخدام حزمة googlesheets4 الجديدة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>