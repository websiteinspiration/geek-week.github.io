<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§úüèæ üóÇÔ∏è ü•î BFCache oder Hin und zur√ºck. Yandex-Bericht üåã üëçüèæ üë´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Benutzer verwenden die Schaltfl√§che "Zur√ºck" zur vorherigen Seite im Browser sehr h√§ufig - m√∂glicherweise h√§ufiger als Sie denken. Und wenn ja, wa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BFCache oder Hin und zur√ºck. Yandex-Bericht</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/496360/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Benutzer verwenden die Schaltfl√§che "Zur√ºck" zur vorherigen Seite im Browser sehr h√§ufig - m√∂glicherweise h√§ufiger als Sie denken. </font><font style="vertical-align: inherit;">Und wenn ja, warum dann sofort die Seite aus dem Speicher des Browsers werfen und nach einer Sekunde Zeit und Verkehr damit verbringen, sie wieder zu √∂ffnen? </font><font style="vertical-align: inherit;">Damit der Benutzer schnell zur√ºckkehren kann, wurde die BFCache-Technologie erfunden, die bei der Entwicklung von Schnittstellen unbedingt zu beachten ist. </font><font style="vertical-align: inherit;">Victor Khomyakov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Victor-Homyakov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fand "Round-Trip-Caching" heraus und erstellte eine BFCache-Kompatibilit√§tstabelle mit verschiedenen APIs.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/vz2IsHcSaKE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Hallo, ich hei√üe Victor. </font><font style="vertical-align: inherit;">Ich arbeite als Teil eines ziemlich gro√üen Teams, das sich mit der Suchseite befasst.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/ai/mc/ut/aimcutfjg_xnumc1xre2li547vw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zumindest haben Sie bereits dieselbe oder eine √§hnliche Seite bei Google gesehen. Insbesondere besch√§ftige ich mich mit dem Problem der Download-Geschwindigkeit dieser Seite - damit sie so schnell wie m√∂glich auf dem Server gerendert und so schnell wie m√∂glich heruntergeladen und den Clients angezeigt wird. Warum ist es wichtig? Je weniger Kunden auf das Laden Ihrer Seite warten, desto unwahrscheinlicher ist es, dass er nicht wartet und Sie verl√§sst. Und je wahrscheinlicher es ist, dass der Kunde erfolgreich zu etwas anderem konvertiert, desto h√∂her ist die Netto-Promotion-Punktzahl. Das hei√üt, der Kunde wird jedem, den er kennt, gerne mitteilen, dass dies eine gro√üartige coole Seite ist - sie wird sehr schnell geladen und ist sehr bequem zu verwenden. Und letztendlich, je mehr Geld Sie verdienen k√∂nnen. Oder Ihre Firma, dann gibt es Ihnen einen Preis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde einige Beispiele bekannter Unternehmen nennen. Google hat ein Experiment durchgef√ºhrt. Sie haben absichtlich eine Verz√∂gerung in die Suchseite eingebettet und gemessen, wie sich dies auf die Leistung auswirkt. Es stellte sich heraus, dass durchschnittlich ein halbes Prozent weniger Suchanfragen pro Benutzer durchgef√ºhrt wurden. Was ist ein halbes Prozent? Berechnen Sie: Ein halbes Prozent von Hunderten Millionen Google-Nutzern ist eine ziemlich gro√üe Zahl. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bing machte das gleiche Experiment. Sie glaubten Google nicht, sie beschlossen, es noch einmal zu √ºberpr√ºfen. Sie erzielten √§hnliche Ergebnisse: Deutlich weniger Umsatz pro Benutzer, wenn die Seite langsamer wird. Warum langsamer werden? Weil es einfacher ist, die Seite um die genaue Anzahl von Millisekunden zu verlangsamen, damit sie in der Produktion problemlos reproduziert werden kann, als sie um denselben Betrag zu beschleunigen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel von AliExpress. Sie haben ihre Website um 36% beschleunigt und deutlich mehr Bestellungen von Nutzern erhalten. Bestellungen sind direktes Geld. Im Allgemeinen ist bereits allen klar, dass Geschwindigkeit sehr wichtig ist und durch eine bestimmte Anzahl von Metriken das verdiente Geld beeinflusst. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und noch ein Faktor. Wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bereits heute </font><font style="vertical-align: inherit;">√ºber Bildoptimierung gesprochen. Indem Sie Ihren Datenverkehr optimieren und die Anzahl der Downloads reduzieren, zahlen Sie Ihren Hostern weniger Geld f√ºr ausgehenden Datenverkehr. Dies ist auch das Geld, das in Ihrer Tasche bleibt. Was ist, wenn ich Ihnen pl√∂tzlich einen Rabatt von 10% auf den Datenverkehr von einem Host ohne Einschr√§nkungen und Bedingungen anbiete? Und wenn ich sicherstellen m√∂chte, dass der Anteil Ihrer Seiten - zum Beispiel zehn Prozent - fast sofort vom Benutzer geladen wird? Niemand wird sich weigern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Technologie, √ºber die ich heute sprechen werde, ist eine der m√∂glichen L√∂sungen, die nur wenige Einschr√§nkungen f√ºr den Stack auferlegt, mit dem Sie arbeiten, f√ºr welche Technologien, aber gleichzeitig verspricht, Ihnen so bedeutende Gewinne zu bringen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zun√§chst sammelt Google Statistiken dar√ºber, wie diese Browser in ihren Browsern verwendet werden. Und sie haben eine solche Zahl ver√∂ffentlicht: Es stellt sich heraus, dass im Durchschnitt aller Seitener√∂ffnungen und der gesamten Navigation in mobilem Chrome etwa 19% eine Bewegung in der Geschichte hin und her sind. √úberlegen Sie, was das bedeutet? Wenn Sie runden, stellt sich heraus, dass 20% der Navigation auf die Seite verschoben werden, auf der sich der Benutzer gerade befunden hat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr uns wie f√ºr die Autoren der Seiten bedeutet dies: Selbst wenn der Benutzer sie verl√§sst, besteht eine betr√§chtliche Chance, dass er bald zur√ºckkehrt. Einerseits kann dies das Problem von Mobiltelefonen sein: Alles ist klein, es ist leicht, einen Finger zu √ºbersehen, auf den Link zu klicken und die Seite zu verlassen und dann zu sagen: "Oh, verdammt! Ich m√∂chte zur√ºckkehren ". Auf Desktops ist die Situation jedoch ungef√§hr gleich: Dort ist die Anzahl geringer, aber es gibt immer noch einen signifikanten Prozentsatz der Renditen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was machen wir gerade? Wir verbringen ineffektiv mit Benutzerzeit und Datenverkehr. Das hei√üt, wir beginnen, dieselbe Seite neu zu laden, sie zu analysieren, das DOM neu zu erstellen, alles auf dem Bildschirm neu zu zeichnen, JavaScript zu laden und auszuf√ºhren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Browser ist eine ziemlich m√§chtige Sache. Er versucht, wo immer m√∂glich Caches zu verwenden. Und die meisten Ressourcen befinden sich m√∂glicherweise in seinem Cache. Er wird nicht aus dem Netzwerk auf sie warten, sondern sie direkt aus dem Cache abholen. In der V8-Engine wird beispielsweise auch das Ergebnis des Parsens von JavaScript zwischengespeichert. Das hei√üt, der Browser l√§dt JS nicht neu und analysiert es nicht. In den meisten F√§llen dauert es, bis es sofort ausgef√ºhrt wird. Das Wiederherstellen des DOM, das Neuladen nicht zwischengespeicherter Ressourcen und das Ausf√ºhren von JS nimmt jedoch viel Zeit in Anspruch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die L√∂sung bietet sich an. Was machen wir? Wenn der Benutzer unsere Seite verl√§sst, bereinigen wir sie nicht sofort. Wir speichern einfach seinen Status und verbergen ihn visuell vor dem Benutzer, damit er unter der Haube dem Browser zur Verf√ºgung steht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was tun wir, wenn der Benutzer sich f√ºr eine R√ºckkehr entscheidet? </font><font style="vertical-align: inherit;">Zeigen Sie ihm einfach dieselbe gespeicherte Seite. </font><font style="vertical-align: inherit;">Es kann fast sofort angezeigt werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/xm/7d/axxm7doualef_atc2j8_ufybr2i.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Technologie wird von den W√∂rtern "hin und her" als Vorw√§rts- / R√ºckw√§rts-Cache bezeichnet. </font><font style="vertical-align: inherit;">Abk√ºrzung f√ºr bfcache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Beispiel daf√ºr, wie sich derselbe Browser, dieselbe Assembly, verh√§lt, wenn bfcache ein- und ausgeschaltet ist. </font><font style="vertical-align: inherit;">Das √ñffnen der ersten Seite ist dort und dort gleich langsam. </font><font style="vertical-align: inherit;">Wenn wir uns jedoch weiter durch die Geschichte bewegen, ist links eine Pause erkennbar, nicht rechts. </font><font style="vertical-align: inherit;">Links nimmt die √ºbliche Bewegung durch die Geschichte sp√ºrbare Zeit in Anspruch. </font><font style="vertical-align: inherit;">Rechts geht alles sehr, sehr schnell.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GIF anzeigen</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/lf/0n/h1/lf0nh1gnji5qf1w9kj_irqcagrm.gif" width="350"><img src="https://habrastorage.org/webt/og/ca/_n/ogca_ny6xmytv-_iqvdl4xslpcq.gif" width="350"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein √§hnliches Beispiel aus unserer Suche. Links ist die √ºbliche Safari unter macOS mit deaktiviertem bfcache, rechts die gleiche Safari mit den Standardeinstellungen und aktiviertem bfcache. Dies ist ein ziemlich h√§ufiger Fall: Eine Person kommt auf die Suche, wei√ü m√∂glicherweise nicht genau, wonach sie sucht, und fragt m√∂glicherweise nach mehreren Abfrageoptionen. Ich habe die erste Anfrage gestellt - etwas stimmt nicht. Die zweite Anfrage scheint besser zu sein. Drittens - nein, schlimmer noch, gehen Sie zur√ºck zur vorherigen Anfrage. Und in diesem Moment w√§re es sehr gut, ihn nicht warten zu lassen. Er hat gerade diese vorherige Anfrage gesehen, zeige sie sofort.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder die zweite Option, wenn Sie eine Paginierung und mehrere Seiten zu diesem Thema haben. Mann bl√§ttert durch das Thema. Ich ging zur zweiten, dritten, vierten Seite und schaute - nein, da stimmt etwas nicht, ich komme wieder. Und wir k√∂nnen ihm wieder die vorherigen Seiten fast sofort zeigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wichtiges Thema ist die Sicherheit. W√§hrend sich die Seite, auf der sich der Benutzer nicht in einem verborgenen Zustand befand, auf verschiedene APIs zugreifen konnte, mit denen Sie den Hardwarestatus Ihres Telefons oder Computers lesen k√∂nnen. Hier ist eine kurze Liste der Dinge, die Ihnen sofort in den Sinn kamen: Geolokalisierung, √Ñndern der Position Ihres Ger√§ts im Weltraum, Zugriff auf die Kamera und Ton vom Mikrofon.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Seite dann angezeigt wird, ist es wichtig, dass sie nicht auf alle Ereignisse zugreifen kann, die w√§hrend der Zeit aufgetreten sind, als sie ausgeblendet wurde. </font><font style="vertical-align: inherit;">Andernfalls wird ein zus√§tzlicher Kanal zum Ausspionieren von Benutzern ge√∂ffnet. </font><font style="vertical-align: inherit;">Es ist wichtig, dass sie w√§hrend dieser ganzen Zeit keine Historie Ihrer Bewegungen und der Aufzeichnung von Mikrofon und Kamera erh√§lt. </font><font style="vertical-align: inherit;">Browserentwickler sollten dies auch nicht vergessen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API- und Browser-Unterst√ºtzung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√§her am Thema. Angenommen, ich habe Sie bereits √ºberzeugt, Sie sind: "Ja, ein gutes Thema, wir m√ºssen damit arbeiten." Welche APIs stehen uns zur Verf√ºgung, womit k√∂nnen wir arbeiten, wenn wir uns bereit erkl√§rt haben, bfcache zu ber√ºcksichtigen, und wie wird dies von Browsern unterst√ºtzt? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wo existiert bfcache bereits, wo kann ich es sehen? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Es ist seit langem in den Browsern Firefox, Safari (und macOS und iOS) sowie in Internet Explorer 11 (!) Implementiert. Normalerweise schimpfen wir mit Microsoft-Entwicklern, aber hier haben sie es nur versucht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Es ist im Browser UC Browser 11/12, Version f√ºr Android, implementiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Pl√∂tzlich ist er nicht mehr in Chrome. Und in Chromium befindet sich diese Funktion in der Entwicklung.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_v/dh/yq/_vdhyq6ph84lnnb05f2ffw75ud4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn sie dies in Chromium tun, erhalten fast alle diese Browser (und dies ist keine vollst√§ndige Liste) fr√ºher oder sp√§ter diese Funktionalit√§t - kostenlos, ohne SMS und Registrierung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gibt es irgendeine Art von API? Ich m√∂chte bfcache verwalten, ich m√∂chte es direkt √ºber JavaScript ein- und ausschalten, um herauszufinden, ob es eine Seite in bfcache gibt oder nicht. Wie w√§re es mit einer solchen API? Es gibt keine solche API. Und das wurde bewusst gemacht: Die Seite sollte bfcache nicht f√ºr alle und f√ºr sich selbst ein- oder ausschalten wollen. Oder finden Sie heraus, ob sich jemand in diesem Bfcache befindet oder nicht. Dies ist alles aus Sicherheitsgr√ºnden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4m/5i/ra/4m5iragmxqrikl_7i8dqp-0ijcy.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber was haben wir? Arten der Navigation. Es gibt eine Art Link - Link Prerender, wenn wir eine Seite im Voraus rendern m√∂chten. F√ºr ihn gibt es eine spezielle Art der Navigation: Diese Seite wird mit dem NavigationType ‚ÄûPrerender‚Äú ge√∂ffnet. Wenn wir die Seite nur in einem Browser √∂ffnen, wird "navigiert". Wenn wir auf die Schaltfl√§che "Aktualisieren" klicken, wird "neu laden". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir interessieren uns hier f√ºr den Navigationstyp "back_forward". Dies zeigt deutlich, dass sich der Benutzer durch die Geschichte hin und her bewegt hat. Dies ist genau die Art der Navigation, mit der unser bfcache arbeiten kann.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ud/8o/o_/ud8oo_rhzpnyzjfdymvr11pfg4i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere API sind die Pageshide-Ereignisse von pageshow. Sie existierten bereits in Browsern. Dementsprechend wird die Seitenshow ausgel√∂st, wenn Ihre Seite dem Benutzer im Browser angezeigt wird. Die Seitenausblendung wird ausgel√∂st, wenn die Seite aus irgendeinem Grund ausgeblendet wird. Und sie wurden durch das anhaltende Feld erg√§nzt. Wenn sich die Seite versteckt und gleichzeitig in bfcache platziert wird, ist das persistierte Feld wahr. Wenn die Seite beim Aufrufen aus bfcache angezeigt wird, ist das persistierte Feld wieder wahr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Browser die Seite nicht zwischenspeichert, bleibt pagehide dementsprechend false. Und wenn der Browser die Seite w√§hrend des normalen Ladens anzeigt oder bfcache nicht verwendet, bleibt pageshow auch false. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7v/kh/kh/7vkhkhw8tjkz6y10o97urigdhea.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ereignisunterst√ºtzung ist in fast allen Browsern verf√ºgbar, auch in solchen, die bfcache noch nicht unterst√ºtzen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/6w/7h/om6w7hjxxswbq5uvpaiu-afe5to.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Gleiches gilt f√ºr das persistierte Feld. Es ist bereits in Chrome vorhanden und Chrome unterst√ºtzt bfcache immer noch nicht. Das hei√üt, dieses Feld wird immer darin sein, aber im Moment wird es falsch sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als ich auf dieses Ph√§nomen stie√ü, musste ich es studieren, auf alle Seiten tippen und beobachten, wie es funktioniert. Ich wollte sofort auf meiner Seite sehen, wann ich den Wert des persistierten Feldes in meinen Handlern √∂ffne.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k6/qe/dxk6qegw2k1ohv-osipeghzjccw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass alles ganz einfach ist. Ich habe einen Handler geschrieben und an console.log () ausgegeben, was mir einf√§llt. Beim √ñffnen von DevTools in einigen Browsern wird bfcache m√∂glicherweise pl√∂tzlich heruntergefahren. Das hei√üt, ich habe DevTools ge√∂ffnet, gehe die Seiten hin und her und meine Beharrlichkeit ist immer falsch, die Seite gelangt nicht in den bfcache. Okay, ich habe ein anderes m√§chtiges Werkzeug - Alarm. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber nein. Moderne Browser ignorieren beim Entladen einer Seite in der Seitenhaut, vor dem Entladen und Entladen einfach die Warnung, es funktioniert dort einfach nicht. Und wieder sehe ich nicht, was ich will. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/by/1b/ij/by1bijibkuzglk6vvkhbcvrmmgo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Okay, ich habe ein noch besseres Produkt. Ich bin in einem Block direkt auf meiner eigenen Seite, die ich erforsche. Ich f√ºge nur den Text des Inhalts meiner Veranstaltung hinzu und protokolliere dabei alles. Diese Methode hat funktioniert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/xt/o1/jwxto1ndmuldxtn4hpoa_3z6-bk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles kann bitte verwendet werden. Ich habe meinen Code getestet, es funktioniert f√ºr mich, ich kann damit fortfahren. Nat√ºrlich vergesse ich nicht, dass ein externes statisches Skript besser geeignet ist, um nicht denselben Inline-Code auf die Seite zu laden, sondern um das Zwischenspeichern von Dateien zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe diesen debuggten Code in ein externes Skript eingef√ºgt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/5m/s0/x15ms0a9q4solt69-vucvdyoqgu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber nein, die Pageshide-Handler von Pageshow sind in Safari abgefallen! Aus irgendeinem Grund funktionieren sie nicht mit einem externen Skript. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Okay, ich habe bereits eine funktionierende Version. Ich musste es so lassen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/td/kq/aw/tdkqawklgz4m_mdw7d_elw7a27m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde kurz auflisten, was ich an nur einem Tag geschafft habe. Erstens k√∂nnen DevTools das Caching deaktivieren. Sie erinnern sich wahrscheinlich, dass in DevTools auf der Registerkarte "Netzwerk" in Chrome das Kontrollk√§stchen "Cache deaktivieren" aktiviert ist. Es deaktiviert den Netzwerkcache, hat m√∂glicherweise keinen Einfluss auf den BFCache oder auf den Netzwerkcache. Die Analogie ist klar: Wir haben DevTools ge√∂ffnet, was bedeutet, dass wir uns weiterentwickeln und m√∂glicherweise kein Caching ben√∂tigen. Vielleicht st√∂rt es uns. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4d/up/mb/4dupmbrpcewpmpngg49_fddhuf4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die zweite Funktion ist Alarm. Firefox und Safari ignorieren es stillschweigend und f√ºhren die Handler weiter aus, als ob es keine Warnung g√§be. Und nur ein gutes altes Chrome in der Konsole schreibt einen Fehler in Rot - Sie haben eine Warnung, ich habe sie blockiert, wissen Sie Bescheid! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich erinnere Sie noch einmal daran, dass Handler aus einem externen Skript in Safari m√∂glicherweise nicht aufgerufen werden. Dies ist sehr seltsam.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und noch eine wichtige Neuigkeit. </font><font style="vertical-align: inherit;">Wenn Ihre Seite zwischengespeichert ist, das hei√üt, Sie haben ein Pagehide-Ereignis erhalten, und es hei√üt "persistiert wahr", und der Browser sagt zu Ihnen: "Ja, ich habe es in den Cache gestellt" - dies gibt keine Garantie daf√ºr, dass die Seite jemals sp√§ter sein wird aus diesem Cache wird ausgel√∂st und dem Benutzer wieder angezeigt. </font><font style="vertical-align: inherit;">Weil der Browser m√∂glicherweise beschlie√üt, diesen Cache zu leeren, wenn ihm der Speicher ausgeht. </font><font style="vertical-align: inherit;">Weil der Benutzer den Browser schlie√üen und nirgendwo navigieren kann. </font><font style="vertical-align: inherit;">Merk dir das.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierungsfunktionen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich begann mich weiter mit der Dokumentation zu besch√§ftigen, um zu erforschen, wie ich mit diesem Wissen leben kann. √úberraschenderweise war die Dokumentation. Das hei√üt, Sie k√∂nnen im Internet eine Beschreibung der Funktionsweise von bfcache in Browsern finden. Aber je weiter ich lese, desto mehr Unterschiede h√§ufen sich zwischen verschiedenen Browsern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem funktioniert es so, in dem anderen funktioniert es. In einem st√∂rt einer, der andere st√∂rt nicht. Entwickler wissen nicht, wie sie eine Reihe von APIs beim Platzieren einer Seite in bfcache korrekt verarbeiten k√∂nnen. Sie sagen: OK, wenn die Seite diese API verwendet, dann ignoriere ich sie einfach und lege sie unter keinen Umst√§nden in den Cache. Und diese Liste ist in verschiedenen Browsern unterschiedlich, jeder tut, was er passt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann fing ich an, das Gelernte in einem Tisch zu kombinieren. Ich habe so etwas wie das Folgende:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9v/qm/iy/9vqmiyq_zcjwc5ln8nciv8golra.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe die Dokumentation f√ºr Browser gelesen - f√ºr Firefox, Safari, die Chromium-Familie. Es gab Dokumentation zum IE, wenn auch veraltet. Wir Programmierer m√∂chten die Dokumentation nach √Ñnderungen im Browser nicht aktualisieren? Als ich feststellte, dass die Informationen nicht mehr aktuell waren, begann ich, meine kleinen Seiten in Browsern zu testen und zu √ºberpr√ºfen, welche API funktioniert und welche nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch dies war nicht genug: Ich wei√ü nicht, welche APIs im Prinzip zu betrachten sind, aber √ºberhaupt nicht zu sortieren? Und ich musste den Quellcode der Browser-Engines selbst untersuchen, dh der Code erwies sich als die genaueste und zuverl√§ssigste Wissensquelle. Im Moment ist diese Platte (vor Ihnen ist ein Teil davon, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier ist ein Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Vollversion) die umfassendste Sammlung von Wissen dar√ºber, welche APIs es bfcache erlauben oder verbieten, in Browsern zu arbeiten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIs, die ein H√§kchen und die gr√ºne Farbe nicht beeintr√§chtigen. Diejenigen, die definitiv verhindern, dass die Seite in den bfcache gelangt, sind rot markiert. </font><font style="vertical-align: inherit;">Wei√üe Felder sind Leerzeichen, die nirgendwo beschrieben werden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feuerfuchs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind einige interessante Details aus bestimmten Browsern. Ich fange mit Firefox an, er war der erste, der alles gemacht hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/bt/fh/fhbtfhn8db-lqcxhqe8n8vm8z6u.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Das Wichtigste, was ich aus den Quellen von Firefox gelernt habe, ist, dass bei der Arbeit mit bfcache alle Gr√ºnde, warum die Seite nicht in den Cache gestellt werden kann, in das Textprotokoll auf der Festplatte geschrieben werden k√∂nnen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/xp/jr/ddxpjraedcefaftwi0u9cdys2tg.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Und ich habe es sogar geschafft herauszufinden, wie ich es dazu bringen kann. Es gibt zwei geheime Umgebungsvariablen: In einer geben wir an, was protokolliert werden soll, in der zweiten - in welcher Datei ein Protokoll geschrieben werden soll. Danach starten wir die Bin√§rdatei und voila! Wir werden ungef√§hr sehen, dass auf der vorherigen Folie Zeilen der Form "solches HTML kann aus einem solchen Grund, aus einem anderen Grund, nicht zwischengespeichert werden k√∂nnen". Wir k√∂nnen es sofort lesen, sehr praktisch.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/_u/3m/ci_u3mrg5k5um_zah0gtm7splmy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie einmal experimentieren m√∂chten, k√∂nnen Sie die Seite about: networking in Firefox √∂ffnen. Dort k√∂nnen Sie im Bereich "Journal" die gleichen Felder eingeben. Wir k√∂nnen in zwei Feldern angeben, was und wo protokolliert werden soll, und mit den Schaltfl√§chen das Protokoll starten und stoppen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w3/8s/zb/w38szbgmjgikrkqg-2f7tt6px0a.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wann weigert sich Firefox, die Seite zwischenzuspeichern? Wenn Sie unvollst√§ndige Anfragen haben, einschlie√ülich AJAX-Anfragen oder Anfragen nach Ressourcen wie Bildern, lehnt er es ab, die Seite in den bfcache zu stellen. Er glaubt, dass es nicht abgeschlossen ist, das Herunterladen noch nicht abgeschlossen ist und es eine verd√§chtige Aktivit√§t gibt. Dies alles gilt jedoch nicht f√ºr Favicon. Wenn Sie Favicon vergessen haben und es nicht geladen wird, denkt er - okay, er wird es tun, es ist normal f√ºr Ihre Website.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie ein Skript mit langer Laufzeit haben, werden Sie vom Browser gefragt: Da es einige Zeit dauert, blockiert es die Benutzeroberfl√§che und schl√§gt es m√∂glicherweise? Und wenn Sie einverstanden sind, wird eine solche Seite als etwas falsch angesehen, und wir speichern sie nicht zwischen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie IndexedDB verwenden ... Dies ist eine lehrreiche Geschichte. Zuvor sahen sie in der ersten Implementierung so aus: Wenn Sie IndexedDB haben und eine unvollst√§ndige Transaktion vorliegt, wird eine solche Seite nicht zwischengespeichert, da nicht klar ist, wie Sie damit arbeiten sollen (wir versuchen, sie mitten in der Transaktion auszublenden). Aber dann haben sie diesen Code beim Refactoring einfach verloren. Und wie Sie sich vorstellen k√∂nnen, hatten sie keine Tests daf√ºr. Sie haben sogar einen Fehler im Bugtracker. Er ist schon zwei Jahre alt mit etwas. Die Leute schrieben: "Mein bfcache mit IndexedDB funktioniert nicht richtig. Was soll ich tun?" Firefox-Entwickler antworteten - es bricht wirklich zusammen, wir haben diesen Text gerade w√§hrend des Refactorings verloren, okay, lass es weitergehen. Moral: Schreibe Tests, auch wenn du Firefox schreibst, sonst kann alles traurig enden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und noch ein interessanter Faktor f√ºr die Nichtverf√ºgbarkeit in bfcache - wenn gemischte Inhalte ausdr√ºcklich erlaubt sind. Was ist das? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/2s/le/fm2sleys4nir1cuff_lw8q87cqi.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Angenommen, Ihre Seite wird √ºber HTTPS ge√∂ffnet, Sie laden jedoch weiterhin einige Ressourcen √ºber HTTP, insbesondere Skripte. Das hei√üt, Sie haben ein Nicht-Sicherheits-Skript, das von jedem ge√§ndert werden kann. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ts/k8/kj/tsk8kj6weynueewx9goi38sm81o.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Standardm√§√üig f√ºhrt Firefox wie andere Browser derzeit kein solches Nicht-Sicherheits-Skript aus. Wenn es f√ºr Sie jedoch sehr wichtig ist, dass Sie in die Einstellungen geklettert sind und die Ausf√ºhrung zugelassen haben, wird eine solche Seite dementsprechend nicht zwischengespeichert. Er wird sagen - nun, Sie haben mir gesagt, ich soll den Code nicht ausf√ºhren, aber dann nein, nein!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pm/fg/_f/pmfg_fqywdhl7tihvcy09agmaxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere Optimierung ist die Gr√∂√üe von bfcache. Hier ist der Standardwert minus eins. Das bedeutet, wie viel Speicher Firefox hat, so viele Seiten, die es zwischenzuspeichern versucht. Wir k√∂nnen den Cache jedoch zwangsweise deaktivieren, indem wir eine Null setzen oder explizit eine Zahl festlegen. Denken Sie beispielsweise an nicht mehr als f√ºnf Seiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warnung: Die n√§chste Folie enth√§lt Beispielcode in der be√§ngstigenden C ++ - Sprache. Dies kann bei einer Front-End-Konferenz gef√§hrlich sein. Versuchen Sie nicht, es zu kopieren, sondern f√ºhren Sie es in der Browserkonsole aus. Ihre Festplatte ist m√∂glicherweise formatiert, der Bildschirm explodiert oder Bitcoins werden m√∂glicherweise abgebaut. Ich habe dich gewarnt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/31/l-/uo/31l-uokshfiuo6dyxcivmfzsm5o.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also der Gecko-Code. </font><font style="vertical-align: inherit;">Es kann kostenlos im Internet ge√∂ffnet, gelesen und angezeigt werden. </font><font style="vertical-align: inherit;">Und ich kramte. </font><font style="vertical-align: inherit;">Es gibt die wichtigste Methode - CanSavePresentation (), die die Frage beantwortet: Ist es m√∂glich, dieses Dokument zwischenzuspeichern? </font><font style="vertical-align: inherit;">Das hei√üt, dies ist die ultimative Quelle der Wahrheit √ºber das, was jetzt in Firefox implementiert ist. </font><font style="vertical-align: inherit;">Und doch - von dort habe ich gelernt, dass Sie das Protokoll lesen k√∂nnen. </font><font style="vertical-align: inherit;">Es gibt eine solche Variable - gPageCacheLog. </font><font style="vertical-align: inherit;">Dies ist das Protokoll, in das alles geschrieben ist. </font><font style="vertical-align: inherit;">Hier ist eine so interessante Geschichte √ºber einen Ausflug in C ++. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, Sie √∂ffnen den Link, sehen sich den Code an, suchen (es gibt eine bequeme und dar√ºber hinaus schnelle Suche) und k√∂nnen die tats√§chlichen Implementierungsdetails in der neuesten Version des Browsers herausfinden - diejenigen, die einfach in der Dokumentation fehlen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Safari</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Grausamste, was Safari tut, wenn eine Seite auf bfcache trifft: Wenn Sie AJAX-Anfragen ausstehen, werden diese von Safari einfach beendet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/bh/8p/vpbh8ppqy9qpfbpljjsu2huhtda.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selbst wenn Sie sie mit Fehlerbehandlungsroutinen √ºberlagern und versuchen, alles zu √ºberpr√ºfen, korrigieren Sie dies - es scheint, als ob die Anforderung √ºberhaupt nicht vorhanden war. Nach der Wiederherstellung von bfcache haben Sie keinen Fehler, kein "OK", √ºberhaupt nichts. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ic/jx/yk/icjxykful4yo0d7hbjopj_woljo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Handler von Pageshow Pagehide in Safari werden, wie gesagt, nur aufgerufen, wenn sie in einem Skript geschrieben sind, das in die Seite integriert ist. Von einem externen Skript aus k√∂nnen sie funktionieren oder nicht - wie viel Gl√ºck. Aber ich habe dich gewarnt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0i/o7/ns/0io7nsvts4isj0qbirjisggubeg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer interessanter Unterschied: Handler vor dem Entladen und Entladen st√∂ren die Seite nicht, die in den bfcache gelangt. In diesem Fall wird beforeunload immer aufgerufen, und wenn es in den Cache gelangt und nicht getroffen wird. Das Entladen, wenn die Seite den Cache erreicht, wird jedoch nicht aufgerufen. Und hier ist ein weiterer Rake: Die Seite wird m√∂glicherweise in den Cache verschoben und wird dort nie angezeigt. Wenn Sie beim Entladen einen wichtigen Code geschrieben haben, wird dieser m√∂glicherweise nie aufgerufen, obwohl auf der Seite kein einziger Fehler aufgetreten ist. Das hei√üt, es ging korrekt in den Cache und von dort ins Nirgendwo, und Ihr Entladen wird niemals aufgerufen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6e/m2/xy/6em2xyin9409en33_y-xk3ewxtg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer interessanter Punkt. Wie Sie wissen, k√∂nnen Sie √ºber window.open () mehrere Fenster √∂ffnen. Gleichzeitig haben diese Fenster Links zueinander. Das hei√üt, sie k√∂nnen gleichzeitig in das Fenster des anderen klettern und verschiedene Eigenschaften lesen / schreiben. Dieses √ñffnen von untergeordneten Fenstern st√∂rt bfcache nicht. Und hier ist Safari h√∂chstwahrscheinlich genauso grausam wie bei AJAX-Anfragen, das hei√üt, alles rei√üt hart und auf Wiedersehen. Apple-Entwickler lieben es schwerer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wieder eine Minute C ++! WebKit-Quellen sind ebenfalls nicht geheim, sie k√∂nnen auch ge√∂ffnet, gelesen und untersucht werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a4/p5/cs/a4p5cs2yfjtvgxb_3iud8b-xog4.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sie befinden sich auf GitHub. Dort habe ich zwei wichtige Funktionen hervorgehoben: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- canCacheFrame () - √úberpr√ºfen Sie, ob dieser Frame zwischengespeichert werden kann.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- In verschiedenen Objekten auf der Seite, z. B. einem HTML-Element oder einer Schriftart, gibt es canSuspendForDocumentSuspension () -Methoden. Dieses Objekt ist daf√ºr verantwortlich, ob es zwischenspeichern, einfrieren kann oder nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und noch ein wichtiger Aspekt: ‚Äã‚ÄãWebKit bietet sehr praktische Tests. Dort, direkt im Ordner LayoutTests / fast / history, gibt es in Form eines kleinen, kompakten und pr√§zisen HTML-Tests Tests f√ºr die Arbeit verschiedener APIs, die in Safari mit bfcache implementiert sind. Dies ist ein lebendiges Beispiel daf√ºr, wie Sie mit diesen APIs Code in Safari schreiben k√∂nnen und wie sie sich darauf auswirken oder nicht, ob sie bfcache-Treffer zulassen oder nicht. Sehr interessant zu sehen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hx/r-/un/hxr-un8ehvr-zc5dqa_kgr4ieki.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Von dort erfuhr ich, dass Safari auch sein gesamtes Wissen √ºber bfcache und alle Funktionen in ein Textprotokoll schreibt. </font><font style="vertical-align: inherit;">Leider habe ich nie herausgefunden, wie diese Protokollierung aktiviert werden kann oder wo diese Datei auf der Festplatte zu finden ist, wenn sie aktiviert ist. </font><font style="vertical-align: inherit;">Wenn jemand wei√ü, sag es mir, ich werde sehr dankbar sein.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrom.</font></font></h3><br>
<img src="https://habrastorage.org/webt/8z/yv/b5/8zyvb5feibkmt6njztlfuxgipas.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie ich bereits sagte, dort wird noch gearbeitet, alles ist unter der Flagge geschlossen. Sie k√∂nnen den frischen Chrome Canary herunterladen und zu den Flaggen gehen. Die Einstellung ist dort versteckt - Sie k√∂nnen versuchen, damit zu spielen. Sie k√∂nnten etwas sehen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nu/fr/lw/nufrlwudx02dcxcxuwq0n-fk57e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus dem Interessanten - ich habe bereits √ºber das √ñffnen einer Seite durch window.open () gesprochen. In Chromium werden solche Seiten bisher nicht zwischengespeichert. Sie haben nicht herausgefunden, wie sie das alles richtig l√∂sen k√∂nnen, und haben es schamlos abgeschnitten, wie in Safari, ihr Gewissen erlaubt es ihnen nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn DOMContentLoaded nicht auftritt, wird die Seite auch nicht zwischengespeichert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt viele neue APIs, die mit "Web" beginnen - es ist auch schwierig und unverst√§ndlich mit ihnen, und bis jetzt deaktivieren alle standardm√§√üig bfcache. Das hei√üt, wenn auf der Seite etwas Trendiges, Neues verwendet wird, wie z. B. WebGL, WebVR, WebUSB, WebBluetooth usw., wird eine solche Seite nicht in den bfcache gelangen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Servicemitarbeiter. Au√üerdem wird eine solche Seite noch nicht zwischengespeichert, aber wir planen, sie korrekt zu verarbeiten und sie vor den wachsamen Augen des Servicemitarbeiters zu verbergen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Geolokalisierung aktiviert ist, wird sie auch noch nicht zwischengespeichert. So einfach f√ºr jetzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn w√§hrend der Zeit, in der sich die Seite im Cache befand, die Cookies verrottet waren, glauben wir, dass eine Autorisierung abgelaufen ist. Vielleicht war es Online-Banking oder etwas anderes. Dies bedeutet, dass die Seite nicht mehr g√ºltig ist - wir l√∂schen sie aus dem Cache. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ae/et/dj/aeetdjeogvqqqmflxx5rtdbtz1o.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Google-Leute gingen noch weiter. </font><font style="vertical-align: inherit;">Sie schlugen vor, alles zu vereinheitlichen, in allen Browsern zu vereinheitlichen, eine Spezifikation f√ºr den Seitenlebenszyklus f√ºr alle Zust√§nde vorzuschlagen und neue Ereignisse zu √úberg√§ngen zwischen verschiedenen Zust√§nden hinzuzuf√ºgen. </font><font style="vertical-align: inherit;">Sie k√∂nnen sich den Link ansehen, den sie sich dort ausgedacht haben. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bl/nn/tw/blnntwl767kxalazcyls6lhx98c.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link von der Folie</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quellen. </font><font style="vertical-align: inherit;">Wie Sie wissen, sind auch Chromquellen verf√ºgbar. </font><font style="vertical-align: inherit;">All dies liegt in einer Klasse namens BackForwardCacheImpl - sehr gute Benennung, musste fast nicht aussehen. </font><font style="vertical-align: inherit;">Die Hauptmethode, die pr√ºft, ob ein Dokument gespeichert werden kann, hei√üt CanStoreDocument (). </font><font style="vertical-align: inherit;">Es gibt auch eine GetDisallowedFeatures () -Methode, die einfach alle neuen Funktionen und APIs auflistet, die in bfcache nicht unterst√ºtzt werden. </font><font style="vertical-align: inherit;">Sehr praktisch: an einem Ort konzentriert, gelesen und realisiert, was derzeit m√∂glich ist und was nicht.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet Explorer 11</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Ausflug in die Geschichte f√ºr diejenigen, die noch IE 11 haben. F√ºr diejenigen, die alles schlecht haben. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/st/sy/hwstsylp95mjeehn-yapop5nwqy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dort gibt es bfcache, und dies ist das Hauptproblem, weil Sie sich damit befassen m√ºssen. </font><font style="vertical-align: inherit;">Die Dokumentation besagt, dass bfcache angeblich nur √ºber HTTP funktioniert. </font><font style="vertical-align: inherit;">Tats√§chlich funktioniert es in der Produktion aus irgendeinem Grund auch mit HTTPS. </font><font style="vertical-align: inherit;">Moral: Wenn Sie Entwickler sind, achten Sie bitte auf Ihre Dokumentation. </font><font style="vertical-align: inherit;">Dann musst du wegen ihr leiden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es einen Handler vor dem Laden gibt, wird verhindert, dass er in den Cache gelangt. </font><font style="vertical-align: inherit;">Sie haben in der Dokumentation nichts √ºber das Entladen gesagt - vielleicht haben sie es nicht gewusst oder vergessen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Seite noch nicht vollst√§ndig geladen wurde, wird sie auch nicht zwischengespeichert. </font><font style="vertical-align: inherit;">Wenn jemand ActiveX-Komponenten verwendet, wird dieser auch nicht zwischengespeichert. </font><font style="vertical-align: inherit;">Und wenn DevTools auch dort ge√∂ffnet ist. </font><font style="vertical-align: inherit;">Dies ist ein wichtiger Punkt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8o/lh/n5/8olhn5ii0fctbxehrs7ab4blwro.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie ohne Fehler? Behobenes Feld hinzugef√ºgt, aber manchmal funktioniert es nicht. Das hei√üt, die Seite gelangt wirklich in den Cache, kehrt von dort zur√ºck und wird nicht auf true gesetzt. Was zu tun ist? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir hatten einen sch√∂nen Code, der bestimmt, ob wir aus dem Cache zur√ºckgekehrt oder vom Server neu geladen wurden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/h1/xb/oph1xbddsxbkhzjlygiyoavtmam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt musste es mit einer Kr√ºcke f√ºr IE erg√§nzt werden. Wir stellen fest, dass wir IE haben, und in einigen Problemumgehungen verstehen wir, dass die Seite immer noch aus dem Cache extrahiert wurde und gleichzeitig eine Verlaufsnavigation (back_forward) hatten. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/xe/af/ctxeafrbbmwt1h_9j16jw4fviji.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Woher wissen Sie au√üerdem, ob eine Seite zwischengespeichert ist? Wir nehmen ihr Ladezeit. Wenn es in 50 Millisekunden oder schneller vom Server geladen wird, kann dies im Grunde nicht im IE sein - es bedeutet, dass es aus dem Cache stammt! :) :)</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j-/ib/ch/j-ibchnxog-rdmeez6gmjnbmwr4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe bereits die Navigation durch die Geschichte erw√§hnt. </font><font style="vertical-align: inherit;">Wenn wir den Navigationstyp back_forward haben, haben wir den Verlauf durchgesehen, und wenn die Seite aus dem Cache stammt, bedeutet dies bfcache, dass es im IE keine anderen Optionen gibt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was weiter?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was tun als n√§chstes mit diesem Wissen? </font><font style="vertical-align: inherit;">Ich m√∂chte nicht, dass du rausgehst und das alles wie ein Albtraum vergisst. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Erstens ist hier das Wertvollste, auf das ich gesto√üen bin und worauf ich Sie dr√§ngen m√∂chte: Verwenden Sie Open-Source-Browser! </font><font style="vertical-align: inherit;">Im offenen Zugang zum Internet befinden sich derzeit die Quellcodes aller f√ºhrenden Browser, die unsere Kunden verwenden. </font><font style="vertical-align: inherit;">Und dies ist die relevanteste Dokumentation dar√ºber, wie und wie es unterst√ºtzt wird, wo und wie es funktioniert. </font><font style="vertical-align: inherit;">Dazu geh√∂ren Tests, die direkt in HTML und JS geschrieben sind. </font><font style="vertical-align: inherit;">Verwenden Sie, schauen Sie!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Zweitens sollten Sie in vorhandenen Anwendungen ber√ºcksichtigen, dass sie in bfcache ausgef√ºhrt werden k√∂nnen. </font><font style="vertical-align: inherit;">Informieren Sie Ihre Tester dar√ºber, damit sie beim √úberpr√ºfen der Navigation wissen, dass beim Navigieren durch den Verlauf die Seite sowohl vom Server als auch vom bfcache aus ge√∂ffnet werden kann. </font><font style="vertical-align: inherit;">Hier ist ein Video des echten Fehlers, den wir behoben haben, als bfcache f√ºr uns gearbeitet hat:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffnen Sie GIF</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/vx/1j/dv/vx1jdv4ubukownlagrvftn30g6k.gif" width="400"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Benutzer gibt vier Anforderungen ein und sieht vier Probleme. </font><font style="vertical-align: inherit;">Danach geht es zur√ºck, sieht Problem 3 und Abfrage 4. Ein anderes vorheriges Problem ist 2 und Abfrage 3. Das hei√üt, es hat einen nicht √ºbereinstimmenden Status der Seite - der Inhalt der Such- und Suchzeichenfolgen widerspricht sich. </font><font style="vertical-align: inherit;">Beachten Sie dies in Ihren Anwendungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Und drittens, wenn Sie neuen Code schreiben, √ºberlegen Sie, ob Sie bfcache ben√∂tigen. </font><font style="vertical-align: inherit;">Verwenden Sie in diesem Fall die API-Kompatibilit√§tstabelle. </font><font style="vertical-align: inherit;">Wenn nicht, verwenden Sie nicht, aber wenn Sie versehentlich in bfcache geraten, sollten Sie die Funktionen von Safari und anderen Browsern ber√ºcksichtigen, die ich erw√§hnt habe. </font><font style="vertical-align: inherit;">Einige Dinge k√∂nnen unversch√§mt rei√üen, und Sie werden nicht verstehen k√∂nnen, warum dies geschieht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie versprochen ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu den Materialien.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496348/index.html">Web Storage API-Fallstudien</a></li>
<li><a href="../de496350/index.html">Du darfst nicht passieren! - 3D-Drucker antworten auf Coronavirus</a></li>
<li><a href="../de496354/index.html">Tern√§re Computerprogrammierung: Spielen Sie mit dem Emulator</a></li>
<li><a href="../de496356/index.html">Erstellen eines Navigators mit Augmented-Reality-Technologien und Methoden des maschinellen Lernens</a></li>
<li><a href="../de496358/index.html">Machen Sie sich bereit, um den Kosmonautik-Tag online zu feiern (die Liste wird aktualisiert)</a></li>
<li><a href="../de496362/index.html">Masken zur√ºckgesetzt</a></li>
<li><a href="../de496366/index.html">Miniserie: Tern√§rer Heimwerker-Computer</a></li>
<li><a href="../de496368/index.html">Das australische Startup entwickelt Hybrid-PCs aus elektronischen und biologischen Komponenten</a></li>
<li><a href="../de496370/index.html">Die Freuden und Sorgen der Siege √ºber C: Wir stellen S√º√üigkeiten aus dem Prototyp wc auf Haskell her</a></li>
<li><a href="../de496372/index.html">So erstellen Sie eine benutzerdefinierte Ansicht f√ºr alert (), verify () und prompt () zur Verwendung in JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>