<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ú® ü§≤üèº üßëüèø‚Äçü§ù‚Äçüßëüèæ C√≥mo funciona el ataque de restablecimiento de TCP ‚ôçÔ∏è üèí ‚òùüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un ataque de restablecimiento de TCP se realiza utilizando un √∫nico paquete de datos de no m√°s de unos pocos bytes de tama√±o. El segmento TCP reemplaz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C√≥mo funciona el ataque de restablecimiento de TCP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un ataque de restablecimiento de TCP se realiza utilizando un √∫nico paquete de datos de no m√°s de unos pocos bytes de tama√±o. </font><font style="vertical-align: inherit;">El segmento TCP reemplazado por suplantaci√≥n de identidad, creado y transmitido por el atacante, enga√±a a las dos v√≠ctimas para finalizar la conexi√≥n TCP, interrumpiendo la conexi√≥n entre ellas, lo que podr√≠a ser cr√≠tico.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0e/768/854/d0e7688544d90ce84fd01f7aae77b348.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este ataque tuvo consecuencias en el mundo real. </font><font style="vertical-align: inherit;">Los temores de su uso fueron causados ‚Äã‚Äãpor la introducci√≥n de cambios en el protocolo TCP. </font><font style="vertical-align: inherit;">Se cree que el ataque es un componente esencial del Gran Firewall Chino (el Escudo de Oro), que es utilizado por el gobierno chino para censurar Internet fuera de China. </font><font style="vertical-align: inherit;">A pesar de su impresionante experiencia, comprender los mecanismos detr√°s de este ataque no requiere necesariamente un conocimiento profundo de TCP. </font><font style="vertical-align: inherit;">Por supuesto, una comprensi√≥n de sus sutilezas puede ense√±arle mucho sobre las caracter√≠sticas de la implementaci√≥n del protocolo TCP y, como veremos pronto, incluso puede llevar a cabo este ataque contra usted mismo usando solo una computadora port√°til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta publicaci√≥n nosotros:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aprenda los conceptos b√°sicos de TCP</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aprende c√≥mo funciona el ataque.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hagamos un ataque contra nosotros mismos con un simple script de Python.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de comenzar a analizar la mec√°nica del ataque, primero veamos c√≥mo se usa en el mundo real.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo se usa el ataque de reinicio TCP en el Gran Firewall?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Great Firewall (GFW) es un conjunto de sistemas y t√©cnicas utilizados por el gobierno chino para censurar Internet para los usuarios chinos internos. </font><font style="vertical-align: inherit;">GFW bloquea y rompe activamente las conexiones con servidores dentro y fuera del pa√≠s, y tambi√©n monitorea pasivamente el tr√°fico de Internet de contenido prohibido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para evitar que los usuarios se conecten incluso a servidores prohibidos, GFW utiliza t√©cnicas como la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contaminaci√≥n de DNS</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el bloqueo de IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ambos cuestan art√≠culos separados). </font><font style="vertical-align: inherit;">Sin embargo, a veces se debe permitir que el firewall GFW realice una conexi√≥n, pero luego la interrumpa en el medio. </font><font style="vertical-align: inherit;">Por ejemplo, esto es necesario si desea realizar un an√°lisis lento y pendiente de la conexi√≥n, por ejemplo, su correlaci√≥n con otras acciones. </font><font style="vertical-align: inherit;">O se usa si el firewall necesita analizar los datos intercambiados durante el proceso de conexi√≥n, y luego usar esta informaci√≥n para decidir si continuar o bloquearlo. </font><font style="vertical-align: inherit;">Por ejemplo, puede permitirse el tr√°fico a un sitio web de noticias, pero los videos que contengan palabras clave prohibidas ser√°n censurados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para esto, GFW necesita herramientas capaces de interrumpir las conexiones ya establecidas. </font><font style="vertical-align: inherit;">Una de esas herramientas es un ataque de reinicio de TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo funciona un ataque de reinicio de TCP?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En un ataque de reinicio de TCP, el atacante rompe la conexi√≥n entre las dos v√≠ctimas, enviando uno o ambos mensajes falsos dici√©ndoles que se desconecten inmediatamente. Estos mensajes se denominan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segmentos de restablecimiento de TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En funcionamiento normal sin la participaci√≥n de un atacante, las computadoras env√≠an segmentos de ca√≠da de TCP cuando reciben tr√°fico TCP inesperado y desean que el remitente deje de enviarlo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El ataque de reinicio de TCP explota maliciosamente este mecanismo, enga√±ando a las v√≠ctimas para que terminen las conexiones de TCP prematuramente, envi√°ndoles segmentos de reinicio falsos. Si el segmento de restablecimiento falso se realiza correctamente, el destinatario lo tomar√° como el segmento real y cerrar√° la conexi√≥n por su parte, interrumpiendo la transmisi√≥n adicional de informaci√≥n sobre esta conexi√≥n. Para continuar con el intercambio de datos, las v√≠ctimas pueden intentar crear una nueva conexi√≥n TCP, pero el atacante puede tener la oportunidad de restablecer esta nueva conexi√≥n. Afortunadamente, dado que un atacante necesita tiempo para construir y enviar un paquete falso, los ataques de ca√≠da son realmente efectivos solo contra conexiones a largo plazo. Conexiones a corto plazo. por ejemplo, utilizado para transferir peque√±as p√°ginas web, generalmente tiene tiempo para cumplir su misi√≥n para cuandocu√°ndo el atacante podr√° restablecerlos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enviar segmentos TCP falsos es, en cierto sentido, un proceso f√°cil, porque ni TCP ni IP tienen ninguna de sus propias formas de verificar la identidad del remitente. Hay una extensi√≥n de IP llamada IPSec que proporciona autenticaci√≥n, pero no se usa tanto. Los proveedores de servicios de Internet deben negarse a transmitir paquetes IP que provengan de una direcci√≥n IP obviamente falsa, pero se alega que esta verificaci√≥n es muy mediocre. Todo lo que el destinatario puede hacer es tomar la direcci√≥n IP de origen y el puerto dentro del paquete o segmento a su valor nominal y, si es posible, usar protocolos de nivel superior, como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/2014/03/27/how-does-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para identificar al remitente </font><font style="vertical-align: inherit;">. Sin embargo, dado que los paquetes de volcado TCP son parte del protocolo TCP en s√≠, no se pueden verificar utilizando estos protocolos de alto nivel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pesar de la simplicidad de enviar segmentos falsos, hacer un segmento falso y ejecutar un ataque de reinicio TCP exitoso puede ser una tarea desalentadora. </font><font style="vertical-align: inherit;">Para comprender por qu√© sucede esto, debemos comprender el funcionamiento del protocolo TCP.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥mo funciona TCP</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El prop√≥sito del protocolo TCP es enviar al destinatario una copia exacta del bloque de datos. </font><font style="vertical-align: inherit;">Por ejemplo, si mi servidor env√≠a HTML a trav√©s de TCP a su computadora, entonces </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la pila TCP de</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> su computadora (la parte de su sistema operativo que procesa TCP) deber√≠a generar mi HTML exactamente en la misma forma y orden en que mi servidor lo envi√≥.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54d/bf5/d64/54dbf5d644d0a3d8ece1cff6cde7b790.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, mi HTML no se transmite por Internet de una manera tan perfectamente ordenada. Est√° dividido en muchos fragmentos peque√±os (llamados </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segmentos TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), cada uno de los cuales se transmite individualmente a trav√©s de Internet y se recrea en el orden transferido por la pila TCP de su computadora. Esta salida restaurada se denomina </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flujo TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cada segmento TCP se transmite en su propio </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paquete IP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sin embargo, para comprender el ataque, no necesitamos conocer ning√∫n detalle sobre IP.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/468/904/175/4689041752b8fa9f66c57c696c4be2ef.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conversi√≥n de segmentos en una secuencia requiere cuidado porque Internet no es confiable. </font><font style="vertical-align: inherit;">Los segmentos TCP pueden perderse. </font><font style="vertical-align: inherit;">Pueden salir de servicio, enviarse dos veces, da√±arse y experimentar muchas otras desventuras. </font><font style="vertical-align: inherit;">Por lo tanto, el prop√≥sito del protocolo TCP es garantizar una transmisi√≥n de datos confiable a trav√©s de una red poco confiable. </font><font style="vertical-align: inherit;">TCP realiza esta tarea, requiriendo que ambos lados de la conexi√≥n mantengan un contacto cercano entre s√≠ y transmitan constantemente informaci√≥n sobre qu√© bloques de datos se recibieron. </font><font style="vertical-align: inherit;">Esto permite a los remitentes comprender qu√© datos a√∫n no ha recibido el destinatario y volver a transmitir los datos que se perdieron. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comprender c√≥mo funciona el proceso, debemos comprender c√≥mo los remitentes y receptores usan los </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√∫meros de secuencia TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para marcar y rastrear datos transmitidos a trav√©s de TCP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√∫meros de secuencia TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada byte transmitido a trav√©s de una conexi√≥n TCP tiene un n√∫mero de secuencia asignado por el remitente. </font><font style="vertical-align: inherit;">Las m√°quinas receptoras usan n√∫meros de serie para mover los datos recibidos al pedido original.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/402/fbc/144/402fbc144a2864f986debfb2ea9b6412.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando dos m√°quinas negocian una conexi√≥n TCP, cada m√°quina env√≠a otro </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√∫mero de secuencia de inicio</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aleatorio </font><font style="vertical-align: inherit;">. Este es el n√∫mero de secuencia que la m√°quina asignar√° al primer byte que env√≠a. A cada byte subsiguiente se le asigna el n√∫mero de secuencia del byte anterior m√°s 1. Los segmentos </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contienen </font><em><font style="vertical-align: inherit;">encabezados TCP</font></em><font style="vertical-align: inherit;"> , que son metadatos adjuntos al comienzo del segmento. El n√∫mero de secuencia del primer byte en el cuerpo del segmento se incluye en el encabezado TCP de este segmento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cabe se√±alar que las conexiones TCP son bidireccionales, es decir, los datos se pueden transmitir en ambas direcciones, y cada m√°quina en una conexi√≥n TCP act√∫a como emisor y receptor. Debido a esto, cada m√°quina debe asignar y procesar su propio conjunto independiente de n√∫meros de secuencia.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Confirmaci√≥n de recibo de datos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando una m√°quina recibe un segmento TCP, le dice al remitente del segmento que se recibi√≥. </font><font style="vertical-align: inherit;">El destinatario hace esto enviando un segmento </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(abreviatura de "reconocimiento"), que contiene el n√∫mero de secuencia del </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">siguiente</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> byte que espera recibir del remitente. </font><font style="vertical-align: inherit;">El remitente utiliza esta informaci√≥n para comprender que el receptor ha recibido con √©xito todos los dem√°s bytes hasta este n√∫mero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un segmento se </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indica mediante la presencia de una bandera </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y el n√∫mero de confirmaci√≥n correspondiente en el encabezado TCP del segmento. </font><font style="vertical-align: inherit;">Solo hay 6 banderas en el protocolo TCP, incluyendo (como veremos en breve) una bandera </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(abreviatura de "reinicio" - "reinicio"), que indica el segmento de reinicio.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/242/452/e35/242452e35d360faf406441ab93f8c383.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: TCP tambi√©n permite el uso de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACK selectivos</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que se transmiten cuando el receptor ha recibido algunos, pero no todos, segmentos en el rango de n√∫meros. Por ejemplo, "Recib√≠ los bytes 1000-3000 y 4000-5000, pero no 3001-3999". Para simplificar, no considerar√© ACK selectivos en nuestra discusi√≥n sobre los ataques de reinicio de TCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el remitente transmite datos pero no recibe</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para ellos durante un cierto intervalo de tiempo, supone que los datos se han perdido y los reenv√≠a, d√°ndoles los mismos n√∫meros de serie. Esto significa que si el receptor acepta los mismos bytes dos veces, entonces trivialmente usa n√∫meros de secuencia para deshacerse de los duplicados sin romper la secuencia. El destinatario puede aceptar datos duplicados porque el segmento original se recibi√≥ m√°s tarde, despu√©s de que se envi√≥ nuevamente, o porque el segmento original se recibi√≥ con √©xito, pero el correspondiente se </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perdi√≥ en el camino hacia el remitente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/22f/a09/e6d22fa098d7375dab30e6c8341ff358.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si bien estos datos duplicados son bastante raros, el desperdicio excesivo de recursos causado por ellos no genera problemas. </font><font style="vertical-align: inherit;">Si todos los datos llegan tarde o temprano al destinatario y los datos correspondientes </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llegan al remitente, entonces la conexi√≥n TCP hace su trabajo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elegir un n√∫mero de serie para un segmento falso</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al crear un segmento falso, el </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atacante debe darle un n√∫mero de serie. </font><font style="vertical-align: inherit;">Los destinatarios est√°n muy contentos de que necesite aceptar segmentos con n√∫meros de serie inconsistentes y conectarlos independientemente en el orden correcto. </font><font style="vertical-align: inherit;">Sin embargo, sus capacidades son limitadas. </font><font style="vertical-align: inherit;">Si el destinatario recibe un segmento con un n√∫mero de secuencia que est√° "demasiado" fuera de servicio, descarta dicho segmento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, para un ataque de reinicio TCP exitoso, se requiere un n√∫mero de secuencia plausible. </font><font style="vertical-align: inherit;">Pero, ¬øqu√© se considera tal n√∫mero? </font><font style="vertical-align: inherit;">Para la mayor√≠a de los segmentos (aunque, como veremos m√°s adelante, no para </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), la respuesta est√° determinada por el </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tama√±o de la ventana TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tama√±o de la ventana TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine una computadora antigua de principios de la d√©cada de 1990, conectada a una red moderna de fibra √≥ptica gigabit. Una red ultrarr√°pida puede transferir datos a esta computadora antigua a una velocidad asombrosa, m√°s r√°pido de lo que la m√°quina puede procesarlo. Esto nos molestar√°, porque el segmento TCP no puede considerarse recibido hasta que el receptor pueda procesarlo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/299/76a/8a529976a3acd7a28babb9e8220bcb7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las computadoras tienen un </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b√∫fer TCP</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el cual los nuevos datos que llegan esperan ser procesados ‚Äã‚Äãmientras la computadora est√° trabajando en los datos que llegan antes. Sin embargo, este b√∫fer tiene un tama√±o limitado. Si el destinatario no puede hacer frente a la cantidad de datos que le transmite la red, el b√∫fer se desbordar√°. Cuando el b√∫fer est√° lleno, el destinatario no tiene m√°s remedio que deshacerse de los datos redundantes. El destinatario no env√≠a </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">los datos descartados, por lo que el remitente debe volver a enviarlos cuando haya espacio libre en el b√∫fer del destinatario. No importa qu√© tan r√°pido la red pueda transmitir datos si el destinatario no tiene tiempo para hacer frente a ellos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine a un amigo excesivamente celoso que le env√≠a un flujo completo de cartas a su correo m√°s r√°pido de lo que puede leerlo. Hay un cierto espacio de amortiguaci√≥n dentro de su buz√≥n, pero una vez que est√© lleno, todas las letras no colocadas caer√°n al suelo, donde los zorros y otras criaturas las comer√°n. Un amigo tendr√° que reenviar las cartas que ha comido, pero por ahora tendr√° tiempo de recibir sus mensajes anteriores. Enviar demasiadas letras o volumen de datos que el destinatario no puede procesar es un desperdicio de energ√≠a y canal de transmisi√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Demasiado": ¬øcu√°ntos datos hay? ¬øC√≥mo entiende el remitente cu√°ndo enviar m√°s datos y cu√°ndo vale la pena esperar? Aqu√≠ es donde resulta √∫til el </font><em><font style="vertical-align: inherit;">tama√±o de la ventana TCP</font></em><font style="vertical-align: inherit;"> .</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. El tama√±o de la ventana del destinatario es el n√∫mero m√°ximo de bytes no reconocidos que el remitente puede transferirle en cualquier momento. Supongamos que el destinatario informa que su tama√±o de ventana es 100,000 (pronto descubriremos c√≥mo pasa este valor), por lo que el remitente env√≠a 100,000 bytes. Supongamos que para cuando el emisor transmiti√≥ cien mil√©simos bytes, el receptor envi√≥ los segmentos </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para los primeros 10,000 de estos bytes. Esto significa que 90,000 bytes a√∫n no han sido confirmados. Como el tama√±o de la ventana es de 100,000, el remitente puede transferir otros 10,000 bytes antes de que tenga que esperar por otros nuevos </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si despu√©s de enviar estos 10,000 bytes adicionales m√°s</font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si no se recibi√≥, el remitente se encontrar√° con su l√≠mite de 100,000 bytes sin confirmar. En consecuencia, el remitente tendr√° que esperar y dejar de enviar datos (excepto la retransmisi√≥n de datos que considera perdidos) hasta que reciba otros nuevos </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/5df/46f/afa5df46f3304b04abbf629ca6ef34a0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada lado de la conexi√≥n TCP notifica al otro el tama√±o de su ventana durante el proceso de reconocimiento que se realiza cuando se abre la conexi√≥n. Adem√°s, los tama√±os de las ventanas se pueden cambiar din√°micamente durante el proceso de conexi√≥n. Una computadora con un gran buffer TCP puede anunciar un gran tama√±o de ventana para maximizar el rendimiento. Esto permite que la m√°quina que se comunica con ella transmita datos continuamente a trav√©s de una conexi√≥n TCP sin pausar o esperar la confirmaci√≥n. Una computadora con un b√∫fer TCP peque√±o puede verse obligada a informar un tama√±o de ventana peque√±o. A veces los remitentes llenan completamente la ventana y se ven obligados a esperar hasta que se confirmen algunos de los segmentos. El ancho de banda sufre debido a esto, pero es necesario que los b√∫feres TCP no se desborden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e3/d5e/5e0/8e3d5e5e0e4b574c6896e6ef7adc94bc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El tama√±o de la ventana TCP es un l√≠mite estricto en la cantidad de datos no confirmados transmitidos. </font><font style="vertical-align: inherit;">Podemos usarlo para calcular el n√∫mero de secuencia m√°ximo posible (que en la ecuaci√≥n a continuaci√≥n design√© como </font></font><code>max_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), que el remitente puede enviar en el momento actual:</font></font><br>
<br>
<blockquote><code>max_seq_no = max_acked_seq_no + window_size</code></blockquote><br>
<code>max_acked_seq_no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Este es el n√∫mero m√°ximo de secuencia para el cual el destinatario ha enviado </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Este es el n√∫mero de secuencia m√°ximo que el remitente sabe que el destinatario ha recibido exactamente. </font><font style="vertical-align: inherit;">Como el remitente solo puede transmitir </font></font><code>window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes sin confirmar, el n√∫mero m√°ximo de secuencia que puede enviar es </font></font><code>max_acked_seq_no + window_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido a esto, la especificaci√≥n TCP establece que el destinatario debe ignorar cualquier dato que reciba que tenga n√∫meros de serie fuera de la ventana v√°lida. Por ejemplo, si el destinatario ha confirmado todos los bytes hasta 15,000, y su tama√±o de ventana es 30,000, entonces recibir√° cualquier dato con un n√∫mero de serie en el rango de 15,000 a (15,000 + 30,000 = 45,000). Adem√°s, el destinatario ignora por completo los datos con n√∫meros de serie fuera de este intervalo. Si el segmento contiene datos, algunos de los cuales est√°n dentro de esta ventana, y otros fuera de ella, entonces los datos dentro de la ventana ser√°n aceptados y confirmados, pero los datos fuera de ella ser√°n descartados. Tenga en cuenta que todav√≠a ignoramos la posibilidad de los </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectivos</font></font><code>ACK</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que se mencionaron brevemente al comienzo de la publicaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso de la mayor√≠a de los segmentos TCP, esta regla nos da un intervalo de n√∫meros de secuencia aceptables. </font><font style="vertical-align: inherit;">Sin embargo, como se mencion√≥ anteriormente, las </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restricciones </font><font style="vertical-align: inherit;">impuestas a los segmentos </font><font style="vertical-align: inherit;">son incluso m√°s estrictas que las restricciones a los segmentos de transmisi√≥n de datos ordinarios. </font><font style="vertical-align: inherit;">Como veremos pronto, esto se hizo para complicar la realizaci√≥n de una variante de un </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ataque de</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reinicio de TCP llamado </font><em><font style="vertical-align: inherit;">"ataque de reinicio de TCP ciego"</font></em><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√∫meros de secuencia aceptables para segmentos RST</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los segmentos regulares se aceptan si su n√∫mero de secuencia est√° entre el siguiente n√∫mero de secuencia esperado y este n√∫mero m√°s el tama√±o de la ventana. Sin embargo, los paquetes </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo se reciben cuando su n√∫mero de secuencia es </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exactamente igual al</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> siguiente n√∫mero de secuencia esperado. Volvamos al ejemplo anterior, en el que el destinatario envi√≥ el n√∫mero de confirmaci√≥n 15,000. Para que </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se reciba </font><font style="vertical-align: inherit;">el paquete </font><font style="vertical-align: inherit;">, su n√∫mero de secuencia debe ser exactamente 15,000. Si el destinatario recibe un segmento </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con un n√∫mero de secuencia no igual a 15,000, entonces no lo aceptar√°.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/596/b55/1d9596b55bb0ac4946ed16ff6b878dff.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el n√∫mero de secuencia est√° fuera del intervalo, entonces el receptor lo ignora por completo. </font><font style="vertical-align: inherit;">Sin embargo, si est√° dentro de la ventana de los n√∫meros de secuencia esperados, el receptor env√≠a un "desaf√≠o </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" ("llamada ACK"). </font><font style="vertical-align: inherit;">Este es un segmento que le dice al remitente que el segmento </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tiene un n√∫mero de secuencia no v√°lido. </font><font style="vertical-align: inherit;">Tambi√©n le dice al remitente el n√∫mero de secuencia que el destinatario espera. </font><font style="vertical-align: inherit;">El remitente puede usar esta informaci√≥n de la </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llamada para recrear y reenviar la suya </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta 2010, TCP no impuso estas restricciones de segmento adicionales </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Los segmentos fueron </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aceptados o rechazados de acuerdo con las mismas reglas que cualquier otro. </font><font style="vertical-align: inherit;">Sin embargo, esto tambi√©n simplific√≥ los </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ataques de reinicio TCP ciego ciego</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ataques ciegos de TCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el atacante tiene la capacidad de interceptar el tr√°fico intercambiado entre sus v√≠ctimas, puede leer los n√∫meros de serie y de confirmaci√≥n de los paquetes TCP de las v√≠ctimas. Puede usar esta informaci√≥n para seleccionar qu√© n√∫meros de serie dar a sus segmentos falsos </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sin embargo, si el atacante no puede interceptar el tr√°fico de las v√≠ctimas, no sabr√° qu√© n√∫meros de secuencia insertar. Pero a√∫n puede transferir cualquier n√∫mero de segmentos </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con cualquier n√∫mero de n√∫meros de serie diferentes, esperando que uno de ellos resulte ser correcto. Tal ataque se llama ataque ciego de reinicio de TCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como ya dijimos, en la versi√≥n inicial del protocolo TCP, el atacante solo ten√≠a que recoger el n√∫mero de serie</font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dentro de la ventana TCP del receptor. </font><font style="vertical-align: inherit;">Un art√≠culo titulado "Desliz√°ndose en la ventana" mostr√≥ que esto hac√≠a que los ataques ciegos fueran demasiado f√°ciles, ya que para un √©xito casi garantizado, un atacante solo ten√≠a que enviar decenas de miles de segmentos. </font><font style="vertical-align: inherit;">Para contrarrestar esto, la regla que oblig√≥ al destinatario a aceptar el segmento </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fue reemplazada por el criterio m√°s estricto descrito anteriormente. </font><font style="vertical-align: inherit;">Gracias a las nuevas reglas para llevar a cabo ataques de reinicio de TCP, millones de segmentos deben enviarse a ciegas, lo que los hace pr√°cticamente irrealizables. </font><font style="vertical-align: inherit;">Ver </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC-5963 para m√°s</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> detalles </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Realizar un ataque de reinicio de TCP contra nosotros mismos</font></font></h2><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: Prob√© este proceso en OSX, pero recib√≠ algunos comentarios de que no funciona correctamente en Linux. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora sabemos todo sobre la ejecuci√≥n de un ataque de restablecimiento de TCP. </font><font style="vertical-align: inherit;">El atacante debe:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe el tr√°fico de la red ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"huela"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) entre dos v√≠ctimas</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olfatee el segmento TCP con la bandera habilitada </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y lea su n√∫mero confirmado</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haga un segmento TCP falso con el indicador activado </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y un n√∫mero de secuencia igual al n√∫mero confirmado del segmento interceptado (tenga en cuenta que esto implica una transmisi√≥n lenta; de lo contrario, el n√∫mero de secuencia seleccionado quedar√° desactualizado r√°pidamente. (Para aumentar las posibilidades de √©xito, puede transferir varios segmentos </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con un gran intervalo de n√∫meros de secuencia) .)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Env√≠e segmentos falsos a una o ambas v√≠ctimas, esperando que esto rompa su conexi√≥n TCP</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para practicar, realicemos un ataque TCP contra nosotros mismos en la misma computadora, comunic√°ndonos a trav√©s de nosotros </font></font><code>localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para esto necesitamos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar la conexi√≥n TCP entre dos ventanas de terminal</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escriba un programa de ataque que se ocupe del rastreo de tr√°fico.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifique el programa para que produzca y env√≠e segmentos falsos </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Empecemos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Establecer una conexi√≥n TCP entre dos ventanas de terminal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuraremos la conexi√≥n TCP utilizando la herramienta </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><code>netcat</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que por defecto est√° disponible en muchos sistemas operativos. </font><font style="vertical-align: inherit;">Cualquier otro </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cliente TCP lo har√°</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En la primera ventana de terminal, ejecutaremos el siguiente comando:</font></font><br>
<br>
<blockquote><code>nc -nvl 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este comando inicia un servidor TCP que escucha en un puerto de nuestra m√°quina local </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En la segunda ventana de terminal, ejecute el siguiente comando:</font></font><br>
<br>
<blockquote><code>nc 127.0.0.1 8000</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este comando intenta crear una conexi√≥n TCP a la m√°quina mediante la direcci√≥n IP del </font></font><code>127.0.0.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puerto </font></font><code>8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ahora, entre las dos ventanas del terminal, se debe establecer una conexi√≥n TCP. </font><font style="vertical-align: inherit;">Intente ingresar algo en una ventana: los datos deber√°n transmitirse a trav√©s de la conexi√≥n TCP y aparecer en otra ventana.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/911/301/786/911301786c4f56287f80d38f67ef73f6.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Oler el tr√°fico</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escribiremos un programa de ataque que detecte el tr√°fico utilizando la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><code>scapy</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">popular biblioteca de red Python. </font><font style="vertical-align: inherit;">Este programa utiliza scapy para leer los datos transferidos entre dos ventanas del terminal, aunque no es parte de la conexi√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo del programa se publica en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mi repositorio en GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El programa detecta el tr√°fico de conexi√≥n y lo muestra en la terminal. </font><font style="vertical-align: inherit;">El n√∫cleo principal del c√≥digo es la llamada al m√©todo </font></font><code>sniff</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde la biblioteca </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubicada al final del archivo:</font></font><br>
<br>
<pre><code class="python hljs">t = sniff(<font></font>
        iface=<span class="hljs-string">'lo0'</span>,<font></font>
        lfilter=is_packet_tcp_client_to_server(localhost_ip, localhost_server_port, localhost_ip),<font></font>
        prn=log_packet,<font></font>
        count=<span class="hljs-number">50</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este c√≥digo nos dice </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que olfateemos paquetes en la interfaz </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y capturemos detalles de todos los paquetes como parte de nuestra conexi√≥n TCP. </font><font style="vertical-align: inherit;">La llamada tiene los siguientes par√°metros:</font></font><br>
<br>
<ul>
<li><code>iface</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- √≥rdenes </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para escuchar la interfaz de red </font></font><code>lo0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o localhost</font></font></li>
<li><code>lfilter</code> ‚Äî  ,  <code>scapy</code>   ,      IP- localhost   .   ,        ,   <code>lo0</code>.     ,     .</li>
<li><code>prn</code> ‚Äî ,  <code>scapy</code>     ,    <code>lfilter</code>.          .       ,      <code>RST</code>.</li>
<li><code>count</code> ‚Äî  ,  <code>scapy</code>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para probar este programa, configure la conexi√≥n TCP desde el paso 1. Clone mi repositorio de GitHub, siga las instrucciones de configuraci√≥n y ejecute el programa en la tercera ventana del terminal. </font><font style="vertical-align: inherit;">Ingrese texto en uno de los terminales de la conexi√≥n TCP. </font><font style="vertical-align: inherit;">Deber√≠a ver que el programa comenzar√° a registrar informaci√≥n sobre los segmentos de conexi√≥n.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Env√≠o de paquetes falsos </font></font><code>RST</code></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hemos establecido una conexi√≥n, y el programa puede detectar todos los segmentos TCP que la atraviesan. Lo √∫nico que nos queda es modificar el programa para que realice un ataque de restablecimiento de TCP transmitiendo segmentos falsos </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para hacer esto, cambiaremos la funci√≥n </font></font><code>prn</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(consulte la lista de par√°metros anterior), </font></font><code>scapy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que requiere paquetes que cumplan los requisitos de la funci√≥n </font></font><code>lfilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En la versi√≥n modificada de la funci√≥n, en lugar de simplemente arreglar el paquete correspondiente, lo estudiamos, extraemos los par√°metros necesarios y usamos estos par√°metros para construir y enviar el segmento </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongamos que interceptamos un segmento que va desde </font></font><code>(src_ip, src_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font><code>(dst_ip, dst_port)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. √âl tiene un conjunto de banderas </font></font><code>ACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y el n√∫mero de confirmaci√≥n es 100,000. Para fabricar y enviar un segmento, nosotros:</font></font><br>
<br>
<ul>
<li>  IP-   ,    .  ,         .          ,  .</li>
<li>  <code>RST</code> ,     ,    <code>RST</code></li>
<li>        ,      ,    </li>
<li>  <code>send</code>  <code>scapy</code>     ‚Äî   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para modificar nuestro programa anterior seg√∫n sea necesario, elimine el comentario de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esta l√≠nea</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y comente la l√≠nea que se encuentra arriba. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora estamos listos para un ataque a gran escala. </font><font style="vertical-align: inherit;">Configure la conexi√≥n TCP de acuerdo con el paso 1. Ejecute el programa de ataque desde el paso 2 en la tercera ventana del terminal. </font><font style="vertical-align: inherit;">Luego ingrese un texto en uno de los terminales de la conexi√≥n TCP. </font><font style="vertical-align: inherit;">En la terminal donde ingres√≥ el texto, la conexi√≥n TCP se interrumpir√° repentina y misteriosamente. </font><font style="vertical-align: inherit;">El ataque est√° hecho!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/2a2/b18/ad92a2b18c1533c47d88ab4ff10dedf7.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√°s trabajo</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contin√∫a experimentando con la herramienta de ataque. </font><font style="vertical-align: inherit;">Realice un seguimiento de lo que sucede si suma o resta 1 del n√∫mero de secuencia del paquete </font></font><code>RST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aseg√∫rese de que debe </font><font style="vertical-align: inherit;">coincidir </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exactamente</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con el valor del </font></font><code>ack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paquete interceptado.</font></font></li>
<li> Wireshark       <code>lo0</code>    .            TCP-,       <code>RST</code>.   <code>ip.src == 127.0.0.1 &amp;&amp; ip.dst == 127.0.0.1 &amp;&amp; tcp.port == 8000</code>       .</li>
<li>  ,      .           <code>RST</code>,       <code>RST</code>         ,      .   ,      <code>RST</code>,       .</li>
</ol><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El ataque de reinicio de TCP es profundo y simple al mismo tiempo. </font><font style="vertical-align: inherit;">Buena suerte con tus experimentos y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">av√≠same</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si tienes preguntas o comentarios.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499884/index.html">11 cosas que entend√≠ sobre CustDev</a></li>
<li><a href="../es499894/index.html">Casa de cantar cosas. Revisi√≥n del rastreador de llavero inteligente Chipolo ONE</a></li>
<li><a href="../es499896/index.html">Nos vamos al sitio remoto correctamente: ¬øc√≥mo organizar nuestro trabajo y el trabajo del proyecto en Telegram?</a></li>
<li><a href="../es499898/index.html">C√≥mo se relacionan las personas de TI con la cuarentena, qu√© hacen de forma aislada y qu√© usan</a></li>
<li><a href="../es499900/index.html">An√°lisis de productos mitap: gratis, sin contacto, en l√≠nea</a></li>
<li><a href="../es499904/index.html">"Estoy asustado". ¬øQu√© hacer?</a></li>
<li><a href="../es499906/index.html">Ejemplos de uso de AR en la industria del juguete</a></li>
<li><a href="../es499908/index.html">Zambullirse en la profundidad: c√≥mo realizar la libertad de elecci√≥n en el mundo digital</a></li>
<li><a href="../es499910/index.html">Equilibrio en la toma de decisiones. Tenedor "experiencia aleatoria"</a></li>
<li><a href="../es499920/index.html">SSH Little Tricks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>