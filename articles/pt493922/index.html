<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÄÑÔ∏è üàØÔ∏è üèÇüèº √ìculos de vis√£o crepuscular. API do Camera2 do Android do Maker Part 5 Flash üñïüèº ‚õëÔ∏è ü§úüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vivendo em uma era de avan√ßos e realiza√ß√µes tecnol√≥gicas, observando como os foguetes Mask e Bezos correm para o c√©u, n√≥s, pessoas comuns com ensino t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>√ìculos de vis√£o crepuscular. API do Camera2 do Android do Maker Part 5 Flash</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493922/"><img src="https://habrastorage.org/webt/tx/oq/s6/txoqs60bhzv_4rncgu5ptr9ucw8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vivendo em uma era de avan√ßos e realiza√ß√µes tecnol√≥gicas, observando como os foguetes Mask e Bezos correm para o c√©u, n√≥s, pessoas comuns com ensino t√©cnico superior, muitas vezes n√£o percebemos a possibilidade de fazer um avan√ßo n√£o l√°, muito longe no espa√ßo, mas aqui ao nosso lado, literalmente n√£o se levantando </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do sof√°</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da mesa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Julgue por si mesmo que descoberta pode levar √† leitura de um artigo regular sobre smartphones modernos. N√£o vou dar a fonte, para n√£o compartilhar renda futura.</font></font><br>
<blockquote>   , ,   .    ¬´ ¬ª   Google Pixel.   IT      RAW, HDR-,  ¬´¬ª,   .       Pixel 4  ¬´Night Sight¬ª     .      : <b>   ,     </b>.    ,               .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra coisa √© que caminhar √† noite e esfregar a tela do telefone celular √© algo desconfort√°vel, mesmo no modo noturno. E ent√£o meus olhos acidentalmente ca√≠ram em um headset VR para um smartphone, deitado em uma prateleira. A inova√ß√£o se tornou realidade! Resta apenas us√°-lo e o conhecimento acumulado em quatro postagens sobre a API do Android Camera2, para direcionar a imagem do "Night Sight" diretamente para os olhos. Ao mesmo tempo, as m√£os estar√£o livres para pegar um gato preto em um quarto escuro. Sem luz, √© claro, n√£o vai funcionar, f√≥tons, pelo menos um pouco, mas √© necess√°rio. Mas pelo menos devemos atingir (ou at√© superar) o n√≠vel dos espi√µes de Kotan no escuro.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, para aprender a ver no escuro, precisamos: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1: um fone de ouvido de realidade virtual para um smartphone (o mais barato poss√≠vel) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/np/k-/ez/npk-ezks0qloiospgbwwpsvykdi.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2: um smartphone com suporte para guglofich moderno para uma c√¢mera (bem, definitivamente n√£o ser√° o mais barato) </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/pv/vd/-o/pvvd-oddmidov1bssl0xi4hgziu.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3: conhecimento dos conceitos b√°sicos da API do Android Camera2 (j√° o temos) </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte um </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte dois </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte tr√™s </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte quatro</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Abrimos um novo projeto no Android Studio e come√ßamos a esculpir o c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira coisa a fazer √© montar a superf√≠cie real de VR que brilhar√° no fone de ouvido.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layout</font></font></b><div class="spoiler_text"><pre><code class="java hljs">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;<font></font>
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    xmlns:app=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>
    xmlns:tools=<span class="hljs-string">"http://schemas.android.com/tools"</span>
    android:layout_width=<span class="hljs-string">"match_parent"</span>
    android:layout_height=<span class="hljs-string">"match_parent"</span>
    android:background=<span class="hljs-string">"#03061B"</span>
    tools:context=<span class="hljs-string">".MainActivity"</span>&gt;<font></font>
<font></font>
    &lt;TextureView<font></font>
        android:id=<span class="hljs-string">"@+id/textureView"</span>
        android:layout_width=<span class="hljs-string">"240dp"</span>
        android:layout_height=<span class="hljs-string">"320dp"</span>
        android:layout_marginTop=<span class="hljs-string">"28dp"</span>
        app:layout_constraintEnd_toEndOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintHorizontal_bias=<span class="hljs-string">"0.497"</span>
        app:layout_constraintStart_toStartOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintTop_toTopOf=<span class="hljs-string">"parent"</span> /&gt;<font></font>
<font></font>
    &lt;TextureView<font></font>
        android:id=<span class="hljs-string">"@+id/textureView3"</span>
        android:layout_width=<span class="hljs-string">"240dp"</span>
        android:layout_height=<span class="hljs-string">"320dp"</span>
        android:layout_marginTop=<span class="hljs-string">"16dp"</span>
        app:layout_constraintEnd_toEndOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintStart_toStartOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintTop_toBottomOf=<span class="hljs-string">"@+id/textureView"</span> /&gt;<font></font>
<font></font>
    &lt;LinearLayout<font></font>
        android:layout_width=<span class="hljs-string">"165dp"</span>
        android:layout_height=<span class="hljs-string">"40dp"</span>
        app:layout_constraintBottom_toBottomOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintEnd_toEndOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintStart_toStartOf=<span class="hljs-string">"parent"</span>
        app:layout_constraintTop_toBottomOf=<span class="hljs-string">"@+id/textureView3"</span>
        app:layout_constraintVertical_bias=<span class="hljs-string">"0.838"</span>&gt;<font></font>
<font></font>
        &lt;Button<font></font>
            android:id=<span class="hljs-string">"@+id/button1"</span>
            android:layout_width=<span class="hljs-string">"wrap_content"</span>
            android:layout_height=<span class="hljs-string">"36dp"</span>
            android:backgroundTint=<span class="hljs-string">"#3F51B5"</span>
            android:text=<span class="hljs-string">""</span>
            android:textColor=<span class="hljs-string">"#1A87DD"</span> /&gt;<font></font>
<font></font>
        &lt;Button<font></font>
            android:id=<span class="hljs-string">"@+id/button3"</span>
            android:layout_width=<span class="hljs-string">"wrap_content"</span>
            android:layout_height=<span class="hljs-string">"37dp"</span>
            android:backgroundTint=<span class="hljs-string">"#3F51B5"</span>
            android:text=<span class="hljs-string">""</span>
            android:textColor=<span class="hljs-string">"#2196F3"</span> /&gt;<font></font>
    &lt;/LinearLayout&gt;<font></font>
<font></font>
<font></font>
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A sa√≠da deve ter algo parecido com isto: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/jg/2q/hrjg2qobc-qqy0spe_bgge_hx9k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
como voc√™ pode ver, as texturas se tornaram retangulares, enquanto em qualquer brinquedo de realidade virtual para um smartphone, os desenvolvedores de alguma forma conseguem dar voltas. </font><font style="vertical-align: inherit;">Mas n√£o vamos insistir nisso. </font><font style="vertical-align: inherit;">Uma experi√™ncia adicional ainda mostrar√° que funcionar√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para isso, de fato, escrevemos uma Atividade modesta, na qual tudo j√° nos √© familiar nos artigos anteriores.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">package</span> com.example.twovideosurfaces;
<span class="hljs-keyword">import</span> androidx.annotation.RequiresApi;
<span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity;
<span class="hljs-keyword">import</span> androidx.core.content.ContextCompat;
<span class="hljs-keyword">import</span> android.Manifest;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.content.pm.ActivityInfo;
<span class="hljs-keyword">import</span> android.content.pm.PackageManager;
<span class="hljs-keyword">import</span> android.graphics.SurfaceTexture;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraAccessException;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraCaptureSession;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraDevice;
<span class="hljs-keyword">import</span> android.hardware.camera2.CameraManager;
<span class="hljs-keyword">import</span> android.hardware.camera2.CaptureRequest;
<span class="hljs-keyword">import</span> android.os.Build;
<span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.os.Handler;
<span class="hljs-keyword">import</span> android.os.HandlerThread;
<span class="hljs-keyword">import</span> android.os.StrictMode;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.view.Surface;
<span class="hljs-keyword">import</span> android.view.TextureView;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.Button;
<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span>  </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LOG_TAG = <span class="hljs-string">"myLogs"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Surface surface1 = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Surface surface2 = <span class="hljs-keyword">null</span>;<font></font>
    CameraService[] myCameras = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> CameraManager mCameraManager = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CAMERA1 = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> Button mOn = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> Button mOff = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> TextureView mImageViewUp = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> TextureView mImageViewDown = <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">private</span> HandlerThread mBackgroundThread;
    <span class="hljs-keyword">private</span> Handler mBackgroundHandler = <span class="hljs-keyword">null</span>;
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread = <span class="hljs-keyword">new</span> HandlerThread(<span class="hljs-string">"CameraBackground"</span>);<font></font>
        mBackgroundThread.start();<font></font>
        mBackgroundHandler = <span class="hljs-keyword">new</span> Handler(mBackgroundThread.getLooper());<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stopBackgroundThread</span><span class="hljs-params">()</span> </span>{<font></font>
        mBackgroundThread.quitSafely();<font></font>
        <span class="hljs-keyword">try</span> {<font></font>
            mBackgroundThread.join();<font></font>
            mBackgroundThread = <span class="hljs-keyword">null</span>;<font></font>
            mBackgroundHandler = <span class="hljs-keyword">null</span>;<font></font>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-meta">@RequiresApi(api = Build.VERSION_CODES.M)</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);<font></font>
        StrictMode.ThreadPolicy policy = <span class="hljs-keyword">new</span> StrictMode.ThreadPolicy.Builder().permitAll().build();<font></font>
        StrictMode.setThreadPolicy(policy);<font></font>
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);<font></font>
        setContentView(R.layout.activity_main);<font></font>
        Log.d(LOG_TAG, <span class="hljs-string">" "</span>);
        <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED<font></font>
                ||<font></font>
                (ContextCompat.checkSelfPermission(MainActivity.<span class="hljs-keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED)<font></font>
        ) {<font></font>
            requestPermissions(<span class="hljs-keyword">new</span> String[]{Manifest.permission.CAMERA, Manifest.permission.WRITE_EXTERNAL_STORAGE}, <span class="hljs-number">1</span>);<font></font>
        }<font></font>
        mOn = findViewById(R.id.button1);<font></font>
        mOff = findViewById(R.id.button3);<font></font>
        mImageViewUp = findViewById(R.id.textureView);<font></font>
        mImageViewDown = findViewById(R.id.textureView3);<font></font>
        mOn.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{
                <span class="hljs-keyword">if</span> (myCameras[CAMERA1] != <span class="hljs-keyword">null</span>) {<span class="hljs-comment">//  </span>
                    <span class="hljs-keyword">if</span> (!myCameras[CAMERA1].isOpen()) myCameras[CAMERA1].openCamera();<font></font>
                }<font></font>
            }<font></font>
        });<font></font>
        mOff.setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{<font></font>
            }<font></font>
        });<font></font>
        mCameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);<font></font>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//     </span>
            myCameras = <span class="hljs-keyword">new</span> CameraService[mCameraManager.getCameraIdList().length];
            <span class="hljs-keyword">for</span> (String cameraID : mCameraManager.getCameraIdList()) {<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"cameraID: "</span> + cameraID);
                <span class="hljs-keyword">int</span> id = Integer.parseInt(cameraID);
                <span class="hljs-comment">//    </span>
                myCameras[id] = <span class="hljs-keyword">new</span> CameraService(mCameraManager, cameraID);<font></font>
            }<font></font>
        } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
            Log.e(LOG_TAG, e.getMessage());<font></font>
            e.printStackTrace();<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CameraService</span> </span>{
        <span class="hljs-keyword">private</span> String mCameraID;
        <span class="hljs-keyword">private</span> CameraDevice mCameraDevice = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">private</span> CameraCaptureSession mSession;
        <span class="hljs-keyword">private</span> CaptureRequest.Builder mPreviewBuilder;
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CameraService</span><span class="hljs-params">(CameraManager cameraManager, String cameraID)</span> </span>{<font></font>
            mCameraManager = cameraManager;<font></font>
            mCameraID = cameraID;<font></font>
        }<font></font>
        <span class="hljs-keyword">private</span> CameraDevice.StateCallback mCameraCallback = <span class="hljs-keyword">new</span> CameraDevice.StateCallback() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onOpened</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice = camera;<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"Open camera  with id:"</span> + mCameraDevice.getId());<font></font>
                startCameraPreviewSession();<font></font>
            }<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDisconnected</span><span class="hljs-params">(CameraDevice camera)</span> </span>{<font></font>
                mCameraDevice.close();<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"disconnect camera  with id:"</span> + mCameraDevice.getId());<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(CameraDevice camera, <span class="hljs-keyword">int</span> error)</span> </span>{<font></font>
                Log.i(LOG_TAG, <span class="hljs-string">"error! camera id:"</span> + camera.getId() + <span class="hljs-string">" error:"</span> + error);<font></font>
            }<font></font>
        };<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startCameraPreviewSession</span><span class="hljs-params">()</span> </span>{<font></font>
            SurfaceTexture texture = mImageViewUp.getSurfaceTexture();<font></font>
            texture.setDefaultBufferSize(<span class="hljs-number">1280</span>, <span class="hljs-number">1024</span>);<font></font>
            surface1 = <span class="hljs-keyword">new</span> Surface(texture);<font></font>
            SurfaceTexture texture2 = mImageViewDown.getSurfaceTexture();<font></font>
            surface2 = <span class="hljs-keyword">new</span> Surface(texture2);<font></font>
            texture2.setDefaultBufferSize(<span class="hljs-number">1280</span>, <span class="hljs-number">1024</span>);
            <span class="hljs-keyword">try</span> {<font></font>
                mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);<font></font>
                mPreviewBuilder.addTarget(surface1);<font></font>
                mPreviewBuilder.addTarget(surface2);<font></font>
                mCameraDevice.createCaptureSession(Arrays.asList(surface1,surface2),<font></font>
                        <span class="hljs-keyword">new</span> CameraCaptureSession.StateCallback() {
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigured</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                                mSession = session;<font></font>
<font></font>
                                <span class="hljs-keyword">try</span> {<font></font>
                                    mSession.setRepeatingRequest(mPreviewBuilder.build(), <span class="hljs-keyword">null</span>, mBackgroundHandler);<font></font>
                                } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                                    e.printStackTrace();<font></font>
                                }<font></font>
                            }<font></font>
                            <span class="hljs-meta">@Override</span>
                            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConfigureFailed</span><span class="hljs-params">(CameraCaptureSession session)</span> </span>{<font></font>
                            }<font></font>
                        }, mBackgroundHandler);<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOpen</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (mCameraDevice == <span class="hljs-keyword">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">openCamera</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED) {<font></font>
                    mCameraManager.openCamera(mCameraID, mCameraCallback, mBackgroundHandler);<font></font>
                }<font></font>
            } <span class="hljs-keyword">catch</span> (CameraAccessException e) {<font></font>
                Log.i(LOG_TAG, e.getMessage());<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">closeCamera</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (mCameraDevice != <span class="hljs-keyword">null</span>) {<font></font>
                mCameraDevice.close();<font></font>
                mCameraDevice = <span class="hljs-keyword">null</span>;<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPause</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (myCameras[CAMERA1].isOpen()) {<font></font>
            myCameras[CAMERA1].closeCamera();<font></font>
        }<font></font>
        stopBackgroundThread();<font></font>
        <span class="hljs-keyword">super</span>.onPause();<font></font>
    }<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>.onResume();<font></font>
        startBackgroundThread();<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, e n√£o se esque√ßa </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manifesto</font></font></b><div class="spoiler_text"><pre><code class="java hljs">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;<font></font>
&lt;manifest xmlns:android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-keyword">package</span>=<span class="hljs-string">"com.example.twovideosurfaces"</span>&gt;<font></font>
    &lt;uses-permission android:name=<span class="hljs-string">"android.permission.CAMERA"</span> /&gt;<font></font>
    &lt;uses-permission android:name=<span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;<font></font>
    &lt;uses-permission android:name=<span class="hljs-string">"android.permission.INTERNET"</span>/&gt;<font></font>
    &lt;application<font></font>
        android:allowBackup=<span class="hljs-string">"true"</span>
        android:icon=<span class="hljs-string">"@mipmap/ic_launcher"</span>
        android:label=<span class="hljs-string">"@string/app_name"</span>
        android:roundIcon=<span class="hljs-string">"@mipmap/ic_launcher_round"</span>
        android:supportsRtl=<span class="hljs-string">"true"</span>
        android:theme=<span class="hljs-string">"@style/Theme.AppCompat.NoActionBar"</span><font></font>
        &gt;<font></font>
        &lt;activity android:name=<span class="hljs-string">".MainActivity"</span>&gt;<font></font>
            &lt;intent-filter&gt;<font></font>
                &lt;action android:name=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;<font></font>
                &lt;category android:name=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;<font></font>
            &lt;/intent-filter&gt;<font></font>
        &lt;/activity&gt;<font></font>
    &lt;/application&gt;<font></font>
&lt;/manifest&gt;<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, colocamos o smartphone no fone de ouvido VR e andamos pela casa, aproveitando a vis√£o do ciborgue com uma resolu√ß√£o de 1280 x 1024 para cada olho. </font><font style="vertical-align: inherit;">As sensa√ß√µes s√£o, √© claro, estranhas, com uma perda de profundidade da vis√£o, mas ainda s√£o frias. </font><font style="vertical-align: inherit;">A √∫nica coisa √© que parece um pouco escuro, mas isso ocorre porque o painel frontal transl√∫cido do fone de ouvido interfere. </font><font style="vertical-align: inherit;">Portanto, √© necess√°rio fazer um buraco na frente da c√¢mera do smartphone. </font><font style="vertical-align: inherit;">Mas, novamente, nos modelos de VR mais or√ßament√°rios, esse painel pode nem sequer existir, e √© prov√°vel que voc√™ n√£o precise se contaminar com o trabalho manual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo o que resta agora √© convencer a API de c√¢mera do Google de que temos escurid√£o total, e seria bom usar o modo de Vis√£o Noturna e, com isso, todos esses RAW, empilhamento HDR e </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reconhecimento de cena por redes neurais</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, basta escrever na sess√£o:</font></font><br>
<br>
<pre><code class="java hljs">mPreviewBuilder.set(CaptureRequest.CONTROL_SCENE_MODE,<font></font>
                                            CaptureRequest.CONTROL_SCENE_MODE_NIGHT);<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e desaparafuse a exposi√ß√£o e a fotossensibilidade ao m√°ximo</font></font><br>
<br>
<pre><code class="java hljs"> mPreviewBuilder.set(CaptureRequest.CONTROL_AE_MODE,<font></font>
        CaptureRequest.CONTROL_AE_MODE_OFF);<font></font>
mPreviewBuilder.set(CaptureRequest.SENSOR_EXPOSURE_TIME,Long.valueOf(<span class="hljs-string">"100000000"</span>));<font></font>
 mPreviewBuilder.set(CaptureRequest.SENSOR_SENSITIVITY, <span class="hljs-number">30000</span>);
</code></pre><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oh, eu sou cego! </font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/ua/o1/ys/uao1ysbhaojz55mqjwuevrqwu1c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â o que o gato descobre quando √© expulso do quarto, onde impede as pessoas de fazer sexo na sala de estar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas √© claro, isso √© enumera√ß√£o e par√¢metros (e h√° muitos deles na API, e aqui est√£o apenas alguns). Voc√™ precisa ajust√°-lo posteriormente por experi√™ncia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora s√≥ podemos esperar a noite. </font><font style="vertical-align: inherit;">N√£o sem lua, √© claro, com densa cobertura de nuvens em algum lugar da taiga, mas uma noite comum com f√≥tons voadores aleat√≥rios. </font><font style="vertical-align: inherit;">E aqui est√° o que vai acontecer ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora pare√ßa que com o disparo normal, quase nada √© vis√≠vel.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dBDfXKoMe5Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas as c√¢meras modernas fazem maravilhas e ainda encontram um gato preto ...</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/WVkyLheyA8s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora voc√™ pode andar √† noite, porque durante o dia voc√™ n√£o pode por causa da quarentena. </font><font style="vertical-align: inherit;">Em teoria, tamb√©m √© imposs√≠vel √† noite, mas quem vai v√™-lo, perseguindo na escurid√£o da noite com fones de ouvido VR em suas cabe√ßas ...</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493904/index.html">Como perder a confian√ßa na IA ou como eu sofri bullying com o Gradient Photo Editor</a></li>
<li><a href="../pt493906/index.html">Atalhos t√≥xicos do Windows: um artefato antigo n√£o esquecido pelos hackers, mas parcialmente esquecido pelos forenses</a></li>
<li><a href="../pt493914/index.html">Web2Text: extra√ß√£o estruturada profunda do conte√∫do da p√°gina da web</a></li>
<li><a href="../pt493918/index.html">Como a pandemia afetou os provedores de VPN</a></li>
<li><a href="../pt493920/index.html">Sobre uma vulnerabilidade em ...</a></li>
<li><a href="../pt493924/index.html">Pare o transportador! Voc√™ fornece projetores Epson XGA ao pre√ßo de SVGA</a></li>
<li><a href="../pt493926/index.html">Truques para testar aplicativos Web Laravel usando f√°bricas de modelos</a></li>
<li><a href="../pt493928/index.html">Revis√£o e teste Huawei Dorado 5000V6</a></li>
<li><a href="../pt493932/index.html">Vis√£o geral das pesquisas do Google. Por que n√£o √© adequado para pesquisas s√©rias</a></li>
<li><a href="../pt493934/index.html">Quem, como e no que explorou os oceanos do mundo - analisamos as bases da NOAA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>