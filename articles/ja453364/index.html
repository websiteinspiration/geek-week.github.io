<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛑 🍣 🤚🏾 すべてに影響を与えた展開ストーリー 🌛 🖐🏼 🙍🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="12f-2までの現実の敵
 
 4月の終わりに、ホワイトウォーカーがウィンターフェルを包囲している間に、さらに興味深いことが起こりましたが、異常な展開を行いました。原則として、私たちは常に（他の人と同じように）製品の新機能を提供しています。しかし、これは他の誰のようでもありませんでした。その規模は、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>すべてに影響を与えた展開ストーリー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/453364/"><img src="https://habrastorage.org/webt/kc/5y/q_/kc5yq_bh4rgol9q8lebwmzsldca.jpeg"><br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12f-2まで</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">の現実の敵</font></a></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
4月の終わりに、ホワイトウォーカーがウィンターフェルを包囲している間に、さらに興味深いことが起こりましたが、異常な展開を行いました。原則として、私たちは常に（他の人と同じように）製品の新機能を提供しています。しかし、これは他の誰のようでもありませんでした。その規模は、私たちが犯す可能性のあるあらゆる間違いが私たちのすべてのサービスとユーザーに影響を与えるようなものでした。その結果、計画どおりに発表されたダウンタイムにおいて、計画どおりにすべてをロールアウトし、販売に影響はありませんでした。この記事は、これをどのように達成したか、そして誰でもこれを自宅で行うことができる方法についてです。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、アーキテクチャ上および技術上の決定については説明しません。すべてがどのように機能するかを説明します。</font><font style="vertical-align: inherit;">これらは、私が観察し、直接参加した、最も困難なロールアウトの1つがどのように行われたかについてのかなり重要ではないメモです。</font><font style="vertical-align: inherit;">私は完全または技術的な詳細を装うつもりはありません。おそらくそれらは別の記事に掲載されるでしょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">背景+これはどのような機能ですか</font></font></h2><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.ruクラウドソリューション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（MCS）</font><font style="vertical-align: inherit;">
クラウドプラットフォームを構築してい</font><font style="vertical-align: inherit;">ます。私はCTOとして働いています。</font><font style="vertical-align: inherit;">そして今、すべてのユーザーアカウント、ユーザー、パスワード、役割、サービスなどの統合管理を提供するIAM（Identity and Access Management）プラットフォームに接続する時がきました。</font><font style="vertical-align: inherit;">なぜクラウドで必要なのかは明らかです。すべてのユーザー情報がクラウドに保存されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、そのようなものは、プロジェクトの開始時に構築を開始します。</font><font style="vertical-align: inherit;">しかし、MCSは歴史的に少し異なっています。</font><font style="vertical-align: inherit;">MCSは2つの部分で構築されました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自のKeystone承認モジュールを備えたOpenstack</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトCloud Mail.ruに基づくHotbox（S3-storage）、</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その周りに新しいサービスが登場しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本質的に、これらは2つの異なるタイプの許可でした。さらに、一般的なMail.ruパスワードストアや、仮想マシンのHorizo​​nパネル（ネイティブUI OpenStack）でSSO（パススルー認証）を有効にする自己記述型のopenidコネクタなど、いくつかの個別のMail.ru開発を使用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IAMを行うということは、これらすべてを1つのシステムに完全に結合することを意味しました。同時に、途中で機能を失わないようにして、将来のための予備を作成します。これにより、リファクタリングなしで透過的に調整し、機能ごとにスケーリングできます。また、最初は、ユーザーはサービス（中央RBAC、役割ベースのアクセス制御）へのアクセスのロールモデルやその他の小さなことのように見えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクは簡単ではありませんでした：pythonとperl、いくつかのバックエンド、独立して作成されたサービス、いくつかの開発チームと管理者。</font><font style="vertical-align: inherit;">そして最も重要なのは、戦闘生産システムの何千人ものライブユーザーです。</font><font style="vertical-align: inherit;">これはすべて書かれる必要があり、最も重要なことに、犠牲者なしで公開されました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何を展開するのか</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常に失礼な場合は、4か月のどこかでこれを準備しました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らは、以前はインフラストラクチャのさまざまな部分で機能していた機能を集約するいくつかの新しい悪魔を作りました。</font><font style="vertical-align: inherit;">他のサービスには、これらのデーモンの形で新しいバックエンドが規定されていました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワードとキーの独自の中央リポジトリを作成しました。これは、すべてのサービスにアクセスでき、必要に応じて自由に変更できます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゼロから、Keystoneの4つの新しいバックエンド（ユーザー、プロジェクト、役割、役割の割り当て）を作成しました。これは、実際にはそのベースを置き換え、現在はユーザーパスワードの単一のリポジトリとして機能しています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らはすべてのOpenstackサービスに、各サーバーからローカルにこれらのポリシーを読み取るのではなく、サードパーティのポリシーサービスにポリシーを適用するように教えました（そう、デフォルトでは、Openstackはそのように動作します！）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような大規模な変更には、さまざまな開発チームによって作成されたいくつかのシステムでの大規模で複雑な、そして最も重要な同期変更が必要です。</font><font style="vertical-align: inherit;">組み立て後、システム全体が機能するはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような変更を展開して、それを台無しにしない方法は？</font><font style="vertical-align: inherit;">最初に、私たちは少し先を見ることにしました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロールアウト戦略</font></font></h2><br>
<ul>
<li>       ,         .  ,  -          .             .      .</li>
<li>,      ,  .    2 . </li>
<li>        —         . </li>
<li>        .  ,            .</li>
<li>     ,  -   ,      .       .</li>
<li>      ,          .</li>
</ul><br>
<h2>:   ?</h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＜注意・理念＞展開内容は</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
各IT専門家が簡単にお答えします。</font><font style="vertical-align: inherit;">CI / CDを入れると、自動的にすべてが製品に配信されます。</font><font style="vertical-align: inherit;">:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これは本当です。</font><font style="vertical-align: inherit;">しかし問題は、コード配信を自動化するための最新のツールでは、ロールアウト自体の理解が失われることです。</font><font style="vertical-align: inherit;">現代の車を見て、ホイールの壮大な発明をどのように忘れますか？</font><font style="vertical-align: inherit;">すべてが自動化されているため、全体像を把握せずにロールアウトが行われることがよくあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして全体像は以下の通りです。</font><font style="vertical-align: inherit;">ロールアウトは4つの大きな側面で構成されています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ変更を含むコード配信。</font><font style="vertical-align: inherit;">たとえば、彼らの移行。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードロールバック-何か問題が発生した場合に戻る機能。</font><font style="vertical-align: inherit;">たとえば、バックアップの作成を通じて。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各ロールアウト/ロールバック操作の時間。</font><font style="vertical-align: inherit;">最初の2つのポイントの操作のタイミングを理解する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影響を受ける機能。</font><font style="vertical-align: inherit;">予想されるプラスの影響と起こりうるマイナスの影響の両方を評価する必要があります。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロールアウトを成功させるには、これらすべての側面を考慮する必要があります。</font><font style="vertical-align: inherit;">通常、最初の、せいぜい2番目のポイントのみが評価され、その後、ロールアウトは成功したと見なされます。</font><font style="vertical-align: inherit;">しかし、3番目と4番目はさらに重要です。</font><font style="vertical-align: inherit;">ロールアウトに1分ではなく3時間かかる場合、どのユーザーがそれを好みますか？</font><font style="vertical-align: inherit;">または、不必要なものがロールアウトに影響する場合はどうなりますか？</font><font style="vertical-align: inherit;">または、1つのサービスのダウンタイムが予期しない結果をもたらすでしょうか？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Act 1..n、リリースの準備</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初、私は会議について簡単に説明しました。チーム全体、その一部、コーヒーポイントでの議論の山、紛争、テスト、ブレインストームです。それから彼はそれは不必要だと思った。開発の4か月は常にこれで構成されます。特に、継続的に配信できるものではなく、生きているシステムの1つの大きな機能を書く場合は特にそうです。これはすべてのサービスに影響しますが、「Webインターフェイスの1つのボタン」を除いて、ユーザーにとって何も変更すべきではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロールアウトの方法に関する私たちの理解、新しい会議ごとに変更され、非常に重要です。たとえば、請求ベース全体を更新する予定でした。しかし、彼らは時間を計算し、妥当な展開時間でこれを行うことは不可能であることに気付きました。課金データベースを分割してアーカイブするのに、ほぼ1週間かかりました。その後、予想された展開速度がうまくいかなかったとき、彼らは追加のより強力なアイアンを注文し、ベース全体を引きずりました。以前はこれを望んでいなかったというわけではありませんが、現在の展開の必要性から、選択肢はありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロールアウトが仮想マシンの可用性に影響を与える可能性があると私たちの1人が疑ったとき、私たちは1週間かけてテスト、実験、コードの解析を行い、これが本番環境では発生しないことを明確に理解しました。最も疑わしい人でさえこれに同意しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その間、技術サポート担当者は、クライアントに接続方法の指示を書くための独立した実験を行いました。これは、ロールアウト後に変更する必要があります。彼らはユーザーフレンドリーなUXに取り組み、指示を準備し、個人的なアドバイスを提供しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能なローリング操作をすべて自動化しました。</font><font style="vertical-align: inherit;">どんな操作もスクリプト化されており、最も単純なものでも、常にテストを実行していました。</font><font style="vertical-align: inherit;">彼らはサービスをオフにする最善の方法について議論しました-デーモンを下げるか、ファイアウォールでサービスへのアクセスをブロックしてください。</font><font style="vertical-align: inherit;">チームのチェックリストは、展開の各段階で作成され、常に更新されています。</font><font style="vertical-align: inherit;">すべてのロールアウト作業のガントチャートを作成し、タイミングを含めて常に更新しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
など…</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">展開する前の最終段階</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...公開する時が来ました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ことわざにあるように、芸術作品は完成することはできません。</font><font style="vertical-align: inherit;">すべてを見つけることができないことを理解し、強い意志をもって努力する必要がありますが、すべての可能なケースに備えて、合理的な仮定をすべて行い、すべての重大なバグを閉じ、すべての参加者ができる限りのことをしたと信じています。</font><font style="vertical-align: inherit;">展開するコードが多ければ多いほど、これについて自分を納得させることが難しくなります（しかも、誰もがすべてを予測することは不可能であることを理解しています）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
予期しない影響とダウンタイムに関連するユーザーのすべてのリスクを閉じるために可能な限りのことを行ったと確信したときに、展開の準備ができていると判断しました。</font><font style="vertical-align: inherit;">つまり、次の場合を除いて、すべてが失敗する可能性があります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーインフラストラクチャの影響（私たちにとって神聖で、最も貴重なもの）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能：展開後のサービスの使用は以前と同じです。</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロールアウトする</font></font></h2><br>
<img src="https://habrastorage.org/webt/mx/vt/yq/mxvtyqnl26yvqbxhego52zj9d8c.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つはローリング中で、8つは干渉せず</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、ユーザーからのすべてのリクエストに対して7時間以内にダウンタイムをとります。</font><font style="vertical-align: inherit;">現時点では、ロールアウト計画とロールバック計画の両方があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロールアウト自体には約3時間かかります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2時間-テスト用。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2時間-可能な変更のロールバックのための予備。 </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ガントチャートは、各アクション、所要時間、シーケンス、並列処理についてコンパイルされています。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/gl/4v/2p/gl4v2pcxxorqbzzhuvlbdsi0jtg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前のバージョン（並列実行なし）の1つであるガントロールアウトチャートのスライス。</font><font style="vertical-align: inherit;">最も価値のある同期ツール</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。すべての参加者は、ロールアウト、彼らが実行するタスク、彼らが責任を負うことに責任を持ちます。</font><font style="vertical-align: inherit;">私たちは、各ステージを自動化し、ロールバックし、フィードバックを収集して、再びロールバックしようとしています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントのクロニクル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、4月28日日曜日の午後10時に15人が働きに来ました。</font><font style="vertical-align: inherit;">主要な参加者に加えて、チームをサポートするためだけに来た人もいました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それとは別に、私たちの主要なテスターが休暇中であることは言及する価値があります。</font><font style="vertical-align: inherit;">テストなしで展開することは不可能です。現在、オプションに取り組んでいます。</font><font style="vertical-align: inherit;">同僚は休暇中に私たちをテストすることに同意します。そのため、彼女はチーム全体から計り知れないほどの感謝の気持ちを抱いています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00:00。</font><font style="vertical-align: inherit;">停止</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーザーの要求を停止し、ネームプレートを切断すると、彼らは技術的な作業を行うと言います。</font><font style="vertical-align: inherit;">監視は大声で叫びますが、すべてが正常です。</font><font style="vertical-align: inherit;">本来あるべきものを除いて、何も落ちていないことを確認します。</font><font style="vertical-align: inherit;">そして、移行作業を開始します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
誰もがポイントの印刷されたロールアウト計画を持っています、誰もが何をどの時点で行っているか誰もが知っています。それぞれのアクションの後に、それらを超えないタイミングでチェックし、すべてが計画どおりに進みます。現在の段階で直接展開に関与していない人は、同僚の邪魔にならないようにオンライングッズ（Xonotic、タイプ3クワキ）を起動して準備します。 :) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">02:00。展開</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
嬉しい驚き-データベースと移行スクリプトの最適化により、1時間早く展開を完了しました。普遍的な叫び、「ロールアウト！」製品のすべての新機能ですが、これまでのところ、インターフェースのみを表示できます。全員がテストモードに入り、ヒープに分類され、最終的に何が起こったかを調べ始めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
うまくいきませんでした。10分後、何も接続されておらず、チームメンバーのプロジェクトで機能しない場合、これは理解しています。クイック同期、問題の発声、優先順位付け、チームへの侵入、デバッグへの移行。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">午前2時30分2つの大きな問題と4つの目</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2つの大きな問題が見つかりました。お客様には一部の接続されたサービスが表示されず、パートナーアカウントに問題があることがわかりました。どちらも、一部のエッジケースの不完全な移行スクリプトに関連付けられています。今すぐ修正する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを修正するリクエストを少なくとも4つ作成します。プレゲートを使用して、それらが機能し、何も壊さないことを確認します。あなたは転がることができます。並行して、通常の統合テストが開始され、さらにいくつかの問題が検出されます。それらはすべて小さいですが、修理する必要もあります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">03:00 a.m. -2の問題+2の問題</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以前の2つの大きな問題が修正され、ほとんどすべてのマイナーな問題も修正されました。修正に占有されていないものはすべて自分のアカウントでアクティブに機能し、見つけたものを報告します。私たちは優先順位を付け、コマンドで配布し、午前中は重要ではないままにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストを再度実行すると、2つの新しい大きな問題が明らかになります。すべてのサービスポリシーが正しく届いたわけではないため、一部のユーザーリクエストは認証されません。さらに、パートナーアカウントに関する新たな問題。急いで見ています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">03:20。緊急同期</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
1つの新しい問題が修正されました。 2つ目は、緊急同期を手配します。私たちは何が起こっているのかを理解しています：以前の修正は1つの問題を修正しましたが、別の問題を作成しました。私たちは休憩を取って、それを正しく、結果なしに行う方法を理解します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">03:30 a.m.シックス・アイ</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私たちは基地の最終状態がどうあるべきかを理解し、すべてがすべてのパートナーにとって良いものになるようにします。要求を6つの目で記述し、プレロッドでロールし、テストし、製品でロールします。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">04:00。すべてが機能</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
し、すべてのテストに合格しましたが、重大な問題はありません。時々、チームで何かが機能しない場合、私たちは迅速に対応します。ほとんどの場合、アラームは誤っています。しかし、何かが届かなかったり、別のページが機能しないことがあります。私たちは座って、直し、直し、直します。別のチームが最後の大きな機能である請求を開始します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">04:30。ノーリターンポイントノーリターンポイント</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が近づいています。つまり、ロールバックを開始すると、与えられたダウンタイムに対応できなくなる時期です。すべてと記録を知っている請求には問題がありますが、頑固に顧客からのお金を帳消しにしたくありません。個々のページ、アクション、ステータスにはいくつかのバグがあります。主な機能は動作し、すべてのテストが正常に合格します。ロールアウトが行われたと判断し、ロールバックしません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">06:00 a.m. UIですべてを開きます</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
バグが修正されました。一部の影響を受けていないユーザーは後で残されます。私たちは誰にでもインターフェースを開きます。私たちは引き続き課金を呼び起こし、ユーザーからのフィードバックと監視結果を待ちます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">07:00 a.m. APIロードの問題</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIに少し不適切に計画された負荷があり、この負荷をテストしていて、問題を特定できなかったことが明らかになりました。その結果、リクエストの≈5％が失敗します。私たちは動員し、理由を探しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
課金は頑固で、働きたくない。落ち着いたモードで変更するために、後で延期することにします。つまり、その中のすべてのリソースが蓄積されますが、クライアントからの消込は渡されません。もちろん、これは問題ですが、一般的なロールアウトと比較すると、基本的なものではないようです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">08:00。修正API</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ロードの修正をロールアウトすると、失敗はなくなりました。家に帰ります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">午前10時すべて</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が修正されました。モニタリングでは、顧客は静かで、チームは徐々に就寝します。請求は残りました。明日復元します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、日中には、一部のお客様のログ、通知、リターンコード、カスタムコードを修正するロールアウトがありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ロールアウトは成功しました！</font><font style="vertical-align: inherit;">もちろん、もっと良いこともありますが、完璧を達成するのに十分ではないものについて結論を出しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
展開時の準備が整ってから2か月以内に、43時間のタスクが数時間から数日間続きました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
展開中：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新規および変更されたデーモン-5個、2個のモノリスを交換。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース内の変更-ユーザーデータを含む6つのデータベースすべてが影響を受け、3つの古いデータベースから1つの新しいデータベースへのアンロードが完了します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フロントエンドを完全にやり直しました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードしたコードの数-33千行の新しいコード、≈テストで3,000行のコード、≈5,000行の移行コード。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのデータはそのままで、お客様の単一の仮想マシンが被害を受けたわけではありません。</font><font style="vertical-align: inherit;">:)</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切に展開するための良い習慣</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはこの困難な状況で彼らに案内されました。</font><font style="vertical-align: inherit;">ただし、一般的に言えば、展開の際にそれらを観察することは有用です。</font><font style="vertical-align: inherit;">しかし、ロールアウトが難しいほど、彼らが果たす役割は大きくなります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初に行うことは、ロールアウトがユーザーにどのように影響するか、またはどのように影響するかを理解することです。</font><font style="vertical-align: inherit;">ダウンタイムはありますか？</font><font style="vertical-align: inherit;">もしそうなら、それから何のダウンタイム？</font><font style="vertical-align: inherit;">これはユーザーにどのように影響しますか？</font><font style="vertical-align: inherit;">可能な最善および最悪のシナリオは何ですか？</font><font style="vertical-align: inherit;">そしてリスクを閉じます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを計画します。</font><font style="vertical-align: inherit;">各段階で、展開のすべての側面を理解する必要があります。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード配信;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードのロールバック。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各操作の時間。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影響を受ける機能。</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての展開段階が明らかになるまでシナリオをプレイし、各段階でのリスクを明らかにします。</font><font style="vertical-align: inherit;">疑わしい場合は、休憩して、怪しいステージを個別に調べることができます。</font></font></li>
<li>     ,     . ,     - .</li>
<li>   ,    .   ,         ,   .</li>
<li>,    ,   . ,     ,      .</li>
<li>  .         ?    ,   .</li>
<li>   — .     ,  ,           .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、一言で言えば、適切な計画と精巧さで、販売に影響を与えることなく、必要なものをすべて展開できます。</font><font style="vertical-align: inherit;">それでも製品のすべてのサービスに影響します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453354/index.html">eo-learnを使用した土地被覆の分類。パート3</a></li>
<li><a href="../ja453356/index.html">大規模金融機関の集積に関する現在の傾向と推奨事項</a></li>
<li><a href="../ja453358/index.html">どのようにしてインポート置換を行ったのですか？その結果、無料の（まあ、ほぼ）地理情報システムを作成しました</a></li>
<li><a href="../ja453360/index.html">渋滞のない都市</a></li>
<li><a href="../ja453362/index.html">HabraConf＃1-バックエンドの後方</a></li>
<li><a href="../ja453366/index.html">英語でカンマを使用する方法：15のルールとエラーの例</a></li>
<li><a href="../ja453368/index.html">ibdファイルのバイト分析を使用した、構造ファイルなしのXtraDBテーブルからのデータ回復</a></li>
<li><a href="../ja453370/index.html">対決2019：Jet Security Teamが防衛で1位に</a></li>
<li><a href="../ja453376/index.html">時間とSSDリソースを無駄にする方法は？簡単かつ簡単に</a></li>
<li><a href="../ja453380/index.html">自家用車との世界大戦：MaaSが世界を席巻</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>