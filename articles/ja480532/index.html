<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤚 👨🏽‍⚖️ 👨🏿‍🍳 別の角度からのEDA 👨‍🌾 🎶 🚰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="食べ物についてではなく、厳しいMLの前置きである探索的データ分析（EDA）について説明します。
 
 正直に言って、プロセスはかなり退屈であり、データについて少なくともいくつかの有意義な洞察を得るには、お気に入りの視覚化ライブラリを積極的に使用して十分な時間を費やす必要があります。
 
 ここで、私...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>別の角度からのEDA</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480532/"><img src="https://habrastorage.org/webt/zr/g9/ed/zrg9ed_nsynok9a9aa2st6s0vjo.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
食べ物についてではなく</font><font style="vertical-align: inherit;">、厳しいMLの前置きである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">探索的データ分析（EDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直に言って、プロセスはかなり退屈であり、データについて少なくともいくつかの有意義な洞察を得るには、お気に入りの視覚化ライブラリを積極的に使用して十分な時間を費やす必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、私たちがかなり怠惰（しかし好奇心旺盛）で、この記事全体を通してこの仮定に従うと想像してください。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに基づいて、次の質問を自問します：お気に入りのIDEでCTRL + ENTERを押して単一の画面に（スクロールダウンや無数の微視的ファセットなしで）データセットに関する有用な情報を含む完全な画像を表示できるようなトリッキーなツールはありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、私たちは別の考え方を念頭に置いています。そのようなツールが存在する場合、それは従来のEDAに取って代わるものではありませんが、データの主要なパターンをすばやく強調するために視覚化に何時間も費やす必要がない場合に役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事の構造：</font></font><br>
<br>
<ol>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さな前処理</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測の可視化</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数の離散化</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相関ファネル</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランク付けされた相互相関</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な沖積</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
導入部を終えて、基礎として実際的な例を取り上げます。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプローチ例</font></font></b><div class="spoiler_text"><sub><i>   -   ,             —        ,     -       ,        ,     .</i><br>
</sub><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイタニック号は、例として私にとって最も便利なように見えました。そのサイズはアイリスほど小さすぎず、有益ではない変数があり、十分に研究されており、明確な予測子と、重要なことに、歴史的根拠があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、筆者がこのデータセットのか​​なり細かいEDAを実施したHabréに関する記事を見つけ、その写真に基づいて結果を示しました。</font><font style="vertical-align: inherit;">これは一種のベースラインになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「Baseline_EDA」の有名な記事へのリンク：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KaggleのTitanic：この投稿を最後まで読むことはありません</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークからのcsvのダウンロード/読み取りに煩わされないように、CRANから元のデータセットを即座にキャッチします。</font></font><br>
<br>
<pre><code class="plaintext hljs">install.packages("titanic") <font></font>
data("titanic_train",package="titanic")<font></font>
</code></pre><br>
<h1><a name="preprocess"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な前処理</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例は、ネットワーク内で上下に前処理を行っているので、このトピックについては特に説明しません。基本的なことを行っています。重要な予測子としてgonoratora（タイトル）の名前を抽出し、年齢のギャップを埋めるために使用しています。</font></font><br>
<br>
<pre><code class="plaintext hljs">library(tidyverse)<font></font>
titanic_train %&gt;% str<font></font>
<font></font>
d &lt;- titanic_train %&gt;% as_tibble %&gt;%<font></font>
  mutate(title=str_extract(Name,"\\w+\\.") %&gt;% str_replace(fixed("."),"")) %&gt;%<font></font>
  mutate(title=case_when(title %in% c('Mlle','Ms')~'Miss', #  <font></font>
                         title=='Mme'~ 'Mrs',<font></font>
                         title %in% c('Capt','Don','Major','Sir','Jonkheer', 'Col')~'Sir',<font></font>
                         title %in% c('Dona', 'Lady', 'Countess')~'Lady',<font></font>
                         TRUE~title)) %&gt;%<font></font>
  mutate(title=as_factor(title),<font></font>
         Survived=factor(Survived,levels = c(0,1),labels=c("no","yes")),<font></font>
         Sex=as_factor(Sex),<font></font>
         Pclass=factor(Pclass,ordered = T)) %&gt;%<font></font>
  group_by(title) %&gt;% #  -     <font></font>
  mutate(Age=replace_na(Age,replace = median(Age,na.rm = T))) %&gt;% ungroup<font></font>
<font></font>
#            <font></font>
table(d$title,d$Sex) <font></font>
</code></pre><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">題名</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">男性</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">女性</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">氏</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">517</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">夫人</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">126</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お嬢</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">185</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主人</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お客様</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リビジョン</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">博士</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レディ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
</tbody></table></div><br>
<h1><a name="lessinform"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのヨーグルトが同じように健康的であるわけではありません... </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、分析の開始時に、有益ではない変数を脇に置いておきます（モデルから最大値を取得したときに、保留中の変数の一部をエンジニアリングすると、モデルの品質がある程度向上するため、脇に置いて完全に削除しません）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数の「有用性」を評価するためのメトリックは、freqRatio（頻度の2番目の値に対する最も人気のある値の頻度の比率）およびpercentUnique（パワーまたはカーディナリティー-値の総数からの一意の数の値の比率）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャレットから詳細なヘルプを見ることができます</font></font><br>
<code>?caret::nearZeroVar</code><br>
<br>
<pre><code class="plaintext hljs">(feat.scan &lt;- caret::nearZeroVar(x = d,saveMetrics = T) %&gt;% rownames_to_column("featName") %&gt;% as_tibble)</code></pre><br>
<img src="https://habrastorage.org/webt/8q/hs/ji/8qhsji8_xsdpbtizf6bqvghdk3a.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2次元平面で変数を監視するのが最も便利です（両方の軸をログに記録して、外れ値によって1つの小さな山にプロットしすぎる点がないようにします）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このステップがEDAであるかどうか疑問に思ったことはありませんが、この記事の執筆中に、私は今、予測因子の有用性とその視覚的評価の探索的分析を行っているので、なぜそれがEDAではないのですか？</font></font><br>
<br>
<pre><code class="plaintext hljs"># install.packages("ggrepel")<font></font>
library(ggrepel)<font></font>
ggplot(feat.scan,aes(x=percentUnique,y=freqRatio,label=featName,col=featName))+ geom_point(size=2)+<font></font>
  geom_text_repel(data = feat.scan,size=5)+scale_x_log10()+scale_y_log10()+theme_bw()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/7v/fc/ec/7vfcecjnvcaog5hh93sbziy8ouc.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
外れ値予測子は、パワー（X軸）または周波数比（Y軸）のいずれかによって情報がないと見なし、次のように設定します</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。PassengerId; </font><font style="vertical-align: inherit;">名前; </font><font style="vertical-align: inherit;">チケット </font><font style="vertical-align: inherit;">キャビン</font></font><br>
<br>
<pre><code class="plaintext hljs">useless.feature &lt;- c("PassengerId","Name","Ticket","Cabin")<font></font>
d &lt;- d %&gt;% select_at(vars(-useless.feature))<font></font>
</code></pre><br>
<h1><a name="discret"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この宇宙は離散的です</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下にリストされているライブラリーがデータを準備する方法を理解するために、このセクションでは、データ準備の段階でこれらのライブラリーで何が起こるかを小さな例で示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のステップでは、すべてのデータを単一のタイプにする必要があります。多くの場合、1つのセットのデータはカテゴリおよび数値である可能性があり、さらに、数値は異常値を持ち、カテゴリデータはまれなカテゴリである可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
連続変数をカテゴリー変数に変換するために、特定のサンプリング周期でビンに数値を分解できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5ビンに分解する最も簡単な例：</font></font><br>
<br>
<pre><code class="plaintext hljs">iris %&gt;% as_tibble %&gt;% mutate_if(is.numeric,.funs = ggplot2::cut_number,n=5)
</code></pre><br>
<img src="https://habrastorage.org/webt/mz/bf/wb/mzbfwb5-xy8iddrjy7gvh_4mfvk.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
予測子間の個々の要素の関係の強さと方向性を取得するために、2番目のトリックが使用されます-1 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">つのホットエンコーディング</font></font></a><br>
<br>
<pre><code class="plaintext hljs">library(recipes)<font></font>
iris %&gt;% as_tibble %&gt;% mutate_if(is.numeric,cut_number,n=5) %&gt;% <font></font>
  recipe(x = .) %&gt;% step_dummy(all_nominal(),one_hot = T) %&gt;%  prep %&gt;% juice %&gt;% glimpse<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5つの予測子の代わりに、現在は23のバイナリー予測子があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tv/qw/c4/tvqwc4gibltq3lghux0zhjgzwhc.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、変換トリックはこれで終わりますが、「非古典的」EDAの3つのライブラリーのうち2つは、これらの段階で作業を開始します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、3つの可視化ライブラリの機能を紹介します。</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相関</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファンネル-ターゲットに対する個々の予測値の影響を示します（つまり、EDA監視学習と呼ぶことができます）</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラレス</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -個々の予測値が他の予測値の他の個々の値に及ぼす影響を示します（つまり、EDA監視なし学習と呼ぶことができます）</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">easyalluvial-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲットごとの上位の「X」予測子のグループ化された値の累積関係を示します（つまり、EDA教師あり学習と呼ぶことができます）</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらの機能が異なることは明らかです。したがって、これらのライブラリを示し</font><font style="vertical-align: inherit;">、このパッケージの上記の機能に応じて、「Baseline_EDA」の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から著者の結論を引用し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">（たとえば、著者が生存率に対する年齢の依存を示している場合は、そのような引用を相関ファンネルに挿入します（年齢がクラスにある場合は、ラレスなどに挿入します）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。最初のライブラリがシーンにあります。</font></font><br>
<br>
<h1><a name="corfun"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相関ファネル</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correlationfunnelは、探索的データ解析（EDA）、最大速度である</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法論は十分ライブラリに記載されている</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ビネット</font></a><font style="vertical-align: inherit;">。私はバイナリ値によって相関を計算する断片を与えるであろう。</font><font style="vertical-align: inherit;">
ライブラリは我々のデータにターゲット（従属変数）の存在を想定し、直ちにならびに1枚の画像に関係の強さと方向を示していますこの力の降順でランク付けされ、視覚的なじょうごを形成します（実際、これは名前の由来です）。</font><font style="vertical-align: inherit;">
ライブラリに組み込まれている2値化関数を使用すると、小さなカテゴリをその他に分類することもできます。</font><font style="vertical-align: inherit;">
ライブラリは整数変数では機能しないため、それらを数値に変換して、タイタニックに戻ります。</font></font><br>
<img src="https://habrastorage.org/webt/j3/9t/zb/j39tzbul1cekgctjk7znwkdszhu.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/hd/7d/li/hd7dliqgmjdcsufitigzylb7hvy.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">#install.packages("correlationfunnel")<font></font>
library(correlationfunnel)<font></font>
d &lt;- d %&gt;% mutate_if(is.integer,as.numeric)<font></font>
d %&gt;% binarize(n_bins = 5,thresh_infreq = .02,one_hot = T) %&gt;% #   <font></font>
  correlate(target = Survived__yes) %&gt;% plot_correlation_funnel() # "interactive = T" - plotly!<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/-t/wj/l-/-twjl-woesnakv9rnym9ndugn5i.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
X軸には相関の強さと方向があり、Y軸には予測子が降順でランク付けされています。</font><font style="vertical-align: inherit;">最初のものは常にターゲットを次のように反映します </font><font style="vertical-align: inherit;">彼は自分との相関が最も強い（-1; 1）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このグラフの結論が、「Baseline_EDA」の作成者の結論とどのように重なっているかを確認してみましょう。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のグラフは、客室クラスが高いほど生存の可能性が高いという理論を裏付けています。</font><font style="vertical-align: inherit;">（「上」とは、最初のクラスが2番目、特に3番目のクラスよりも高いため、逆順を意味します。）</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> じょうごは、クラスが相関強度の3番目の予測子であることを示しています。実際、3番目のクラスには逆相関があり、1番目のクラスには強い正の相関があります。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">男性と女性の生存の可能性を比較します。</font><font style="vertical-align: inherit;">データは、以前に示された理論を確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（一般的に、モデルの主な要素は乗客の性別になるとすでに言えます）</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
じょうごは、乗客の性別が相関の度合いに応じて2番目であり、女性の性別が生存率、男性の性別が死亡であることを示しています。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">若いものが生き残るという仮説をテストすることもできます。</font><font style="vertical-align: inherit;">彼らはより速く動き、よりよく泳ぐなど。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、ここでは明示的な依存関係は表示されていません。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
じょうごは本当にこの予測子の弱い重要性について語っています（私はgonorant / titleに年齢が含まれているので、年齢はそれほど重要ではないことを思い出します）が、ここでも漏斗は「マイナス無限-20年」（つまり子供）のカテゴリで生き残るチャンスが多いことを示しています）と30-38（裕福な人々、おそらく1つのクラス）。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生存率などの指標を紹介し、前の段階で判明したグループへの依存性を見てみましょう</font></font></blockquote> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（著者のグループはタイトルを意味します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファンネルは著者の調査結果を完全に確認します</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、船の親戚の数から得られる情報を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多数の親族がいないことは、生存に悪影響を及ぼす可能性が非常に高いです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目標到達プロセスのSibSPも同じことをはっきりと述べています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてもちろん、著者の結論に加えて、ここでは他のパターンを見ることができます。読者に熟考の喜びを残します</font></font><br>
<br>
<h1><a name="lrs"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラレス</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランク付けされた相互相関でインサイトを見つける</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/sd/yh/6g/sdyh6ghnnhtnjid9ay2k5s3d9we.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このライブラリの作成者はさらに進んで、ターゲットだけでなくすべての人の依存関係を示しています。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランク付けされた相互相関</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、特定のターゲットフィーチャと残りのフィーチャとの関係を説明するだけでなく</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、使いやすく理解しやすい表形式で</font><u><font style="vertical-align: inherit;">データ</font></u><font style="vertical-align: inherit;">内の</font><u><font style="vertical-align: inherit;">すべての値の関係を説明します</font></u><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、カテゴリ列を1つのホットエンコーディング（1と0）と、あまり頻繁ではない値の「その他」ラベルなどのその他のスマートグループと古い機能の新しい機能を備えた数値に自動的に変換します。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のリンクを使用すると、作成者がStar Warsデータセットを自分のパッケージにフィードし、見つかった依存関係を示す例を見ることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの例を試してみましょう。</font></font><br>
<br>
<pre><code class="plaintext hljs"># ,     :<font></font>
# devtools::install_github("laresbernardo/lares")<font></font>
library(lares)<font></font>
corr_cross(df = d,top = 30)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/wd/mu/pv/wdmupvkf00yjchynm1mmsj_nxog.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
引用に基づく結論との交差に加えて、Correlationfunnellでは、ターゲットに関係なく、ここで確認できるいくつかの引用を示します。 </font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のパターンも見つけることができます。</font><font style="vertical-align: inherit;">年齢とクラスの間には負の相関関係があります。これは、より高価なキャビンをより頻繁に購入できる高齢の乗客が原因である可能性が高いです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の引用では、著者は合計2つのフィールドの相関分析にそのような結論を導き出していますが、One-Hot-Encodingの場合、これはAge + P_Class_1間の強い正の相関から明らかです。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、チケットの価格とクラスは密接に関連しており（高い相関係数）、これは非常に予想されます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の3行目：Fare + P_Class_1 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
著者の結論との共通点に加えて、ここではもっと興味深いことを強調できます。読者に熟考の喜びを残します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オプションのトップXの最も強力な洞察の選択に加えて、全体像とこれらの重要なポイントの総質量における位置を反映することもできます。</font></font><br>
<br>
<pre><code class="plaintext hljs">corr_cross(df = d,type=2)
</code></pre><br>
<img src="https://habrastorage.org/webt/us/pa/ud/uspaudtooaflobmfge5tgdi6h6q.jpeg" alt="画像"><br>
<br>
<h1><a name="alluv"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な沖積</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">沖積図によるデータ探索</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/gm/xg/fp/gmxgfpjhfzpqgqiulecylpd6fge.gif" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ここでは、前の2つのパッケージと同様に、作成者は最初に数値変数の2値化を実行しますが、その後、それらのライブラリーとの経路が分岐します。{One-HotEncoding + correlation}の代わりに、ライブラリーは最も興味深い予測子（ユーザー彼は自分で（送信するものを）値で決定し、色がターゲットに依存するストリームを形成し、ストリームの幅をこのストリームの観測数に基づいて決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数値変数は、カテゴリーHH（高高）、MH（中高）、M（中）、ML（中低）、LL（低低）に分解されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、相関ファンネルのグラフに基づいて最も重要な予測子を取得します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cor.feat &lt;- c("title","Sex","Pclass","Fare")
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スケジュールを作成します</font></font><br>
<br>
<pre><code class="plaintext hljs"># install.packages("easyalluvial")<font></font>
library(easyalluvial)<font></font>
<font></font>
al &lt;- d %&gt;% select(Survived,cor.feat) %&gt;% <font></font>
  alluvial_wide(fill_by = "first_variable")<font></font>
add_marginal_histograms(p = al,data_input = d,keep_labels = F)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/p5/rd/xd/p5rdxduvi-21s-xhwhvzxh5og88.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
著者の引用については、適切な予測子を使用してグラフを再描画します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cor.feat &lt;- c("Sex","Pclass","Age")<font></font>
al &lt;- d %&gt;% select(Survived,cor.feat) %&gt;% <font></font>
  alluvial_wide(fill_by = "first_variable")<font></font>
add_marginal_histograms(p = al,data_input = d,keep_labels = F)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/yz/pb/o-/yzpbo-6q9x0relwi6ewtpyqwlke.jpeg" alt="画像"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> たとえば、次のグラフは、生存者の主なグループがすべての年齢の1年生と2年生の女性であることを明確に示しています。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフはまた、グレード3の生存している女性も小グループではないことを示しています</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして、男性の間で、15歳未満のすべての少年は、3番目のクラスのサービスと少数の年配の男性を除いて、ほとんどが1番目のクラスから生き残った。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前述のことが確認されましたが、LL、MLの年齢カテゴリのクラス3の男性の生存の流れが再び見られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記はすべて「easyalluvial」パッケージに関するものでしたが、作者は2番目のパッケージ「parcats」を作成しました。これにより、上にあるグラフが（このセクションのタイトルのように）インタラクティブになります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、ツールチップのコンテキストを確認できるだけでなく、フローの方向を変えて視覚的認識を向上させることもできます。</font><font style="vertical-align: inherit;">（残念ながら、ライブラリはあまり最適化されておらず、タイタニックが遅くなります）</font></font><br>
<br>
<pre><code class="plaintext hljs"># install.packages("parcats")<font></font>
library(parcats)<font></font>
cor.feat &lt;- c("title","Sex","Pclass","Fare")<font></font>
a &lt;- d %&gt;% select(Survived,cor.feat) %&gt;% <font></font>
  alluvial_wide(fill_by = "first_variable")<font></font>
parcats(p = a,marginal_histograms = T,data_input = d)<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/bt/bc/c4/btbcc4rkdkc6b6jwh9it_mk1y0a.jpeg" alt="画像"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボーナス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
easyalluvialライブラリは、探索的データ分析に加えて、ブラックボックスモデル（パラメーターを分析できないモデル-特定の予測子に基づいてモデルが答えを与えるロジックによって）のインタープリターとしても使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
著者の記事へのリンク：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">沖積図によるモデル応答の視覚化</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
そして私が見たすべてのライブラリーの特性は、1つのグラフの最大値が2次元以下の座標系（各予測子に1つ）でブラックボックスの応答を説明し、色で説明されています応答。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
easyalluvialライブラリを使用すると、これを同時に2つ以上の予測子で行うことができます（もちろん、夢中にならない方がいいです）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、データ配列でランダムフォレストをトレーニングし、3つの予測子を使用してランダムフォレストの説明を反映させます。</font></font><br>
<br>
<pre><code class="plaintext hljs">library(ranger)<font></font>
m &lt;- ranger(formula = Survived~.,data = d,mtry = 6,min.node.size = 5, num.trees = 600,<font></font>
            importance = "permutation")<font></font>
library(easyalluvial)<font></font>
(imp &lt;- importance(m) %&gt;% as.data.frame %&gt;% easyalluvial::tidy_imp(imp = .,df=d)) #     <font></font>
#  N-     (   .  !)  <font></font>
dspace &lt;- get_data_space(df = d,imp,degree = 3) <font></font>
#    <font></font>
pred = predict(m, data = dspace)<font></font>
alluvial_model_response(pred$predictions, dspace, imp, degree = 3)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、作成者はCARETモデルへのコネクタを持っています（これが現在tidymodelを検討していることの関連性がわかりません）</font></font><br>
<br>
<pre><code class="plaintext hljs">library(caret)<font></font>
trc &lt;- trainControl(method = "none")<font></font>
m &lt;- train(Survived~.,data = d,method="rf",trControl=trc,importance=T)<font></font>
alluvial_model_response_caret(train = m,degree = 4,bins=5,stratum_label_size = 2.8) <font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/qq/qf/iv/qqqfivwgoucmfoikmwhp9mdwelw.jpeg" alt="画像"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はもう一度繰り返しますが、私は古典的なEDAの交換を求めていませんが、特に人々が自然に怠惰であることを考えると、多くの時間を節約できる代替策があり、これが進歩のエンジンであることを考えるとそれは良いことだと同意します:)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja480518/index.html">プログラミングチューター：なぜ自分になる必要があるのか</a></li>
<li><a href="../ja480520/index.html">EcmaScriptの観点からの関数型プログラミング。再帰とそのタイプ</a></li>
<li><a href="../ja480526/index.html">Intelプロセッサは、電圧で遊ぶと秘密鍵を吐き出します</a></li>
<li><a href="../ja480528/index.html">Facebookでユーザーデータを他のサービスに転送できる理由</a></li>
<li><a href="../ja480530/index.html">IoTは子供向けのおもちゃではありません。ハッカーがモノのインターネットを攻撃する方法は、大企業だけでなく、普通の家族も怖がらせる</a></li>
<li><a href="../ja480534/index.html">KotlinでのAndroid向けの16の開発のヒント。パート2</a></li>
<li><a href="../ja480538/index.html">ゲームに最適なのはIntel OptaneとSSDのどちらですか？</a></li>
<li><a href="../ja480540/index.html">Umbraco 8.4リリース：CMSがさらに便利に</a></li>
<li><a href="../ja480542/index.html">大人のセキュリティ意識：フィッシングの脆弱性を解決する方法</a></li>
<li><a href="../ja480544/index.html">Javaの5つの隠された秘密</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>