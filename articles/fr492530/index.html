<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™ğŸ¼ ğŸ“‡ ğŸ”” Combiner les MVVM basÃ©s dans les applications UIKit et SwiftUI pour les dÃ©veloppeurs UIKit ğŸ° âš“ï¸ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous savons que les ObservableObjecclasses t avec ses @PublishedpropriÃ©tÃ©s sont crÃ©Ã©es CombinespÃ©cialement pour View Modeldans SwiftUI. Mais exactemen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Combiner les MVVM basÃ©s dans les applications UIKit et SwiftUI pour les dÃ©veloppeurs UIKit</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492530/"><img src="https://habrastorage.org/webt/ku/lm/v5/kulmv5qftg5ynrc21jjj3rou7ro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous savons que les </font></font><code>ObservableObjec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes t avec ses </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©s sont crÃ©Ã©es </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spÃ©cialement pour </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mais exactement la mÃªme chose </font></font><code> View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut Ãªtre utilisÃ©e dans la </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise </font><font style="vertical-align: inherit;">en </font><font style="vertical-align: inherit;">Å“uvre de l'architecture&nbsp; </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bien que dans ce cas, nous devrons Â«lierÂ» ( </font></font><code>bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">manuellement </font><font style="vertical-align: inherit;">les </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments aux </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©s de </font></font><code>View Mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l. Vous serez surpris, mais avec l'aide de </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cela, vous </font><font style="vertical-align: inherit;">pouvez </font><font style="vertical-align: inherit;">faire quelques lignes de code. De plus, en adhÃ©rant Ã  cette idÃ©ologie lors de la conception d' </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">applications, vous passerez ensuite sans douleur Ã  </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le but de cet article est de montrer avec un exemple simple primitivement comment vous pouvez implÃ©menter Ã©lÃ©gamment une </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">architecture </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec </font></font><code>&nbsp;Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Par contraste, nous montrons l'utilisation de la mÃªme</font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'article abordera deux applications simples qui vous permettent de sÃ©lectionner </font><font style="vertical-align: inherit;">les derniÃ¨res informations mÃ©tÃ©orologiques pour une ville spÃ©cifique Ã  </font><font style="vertical-align: inherit;">partir du site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p. Mais l' </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un d'eux sera crÃ©Ã© avec application </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'autre avec aide </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour l'utilisateur, ces applications seront presque identiques. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3r/2m/mo/3r2mmow1d4zuhf7a8gcaabv6adi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code est sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'interface utilisateur ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ne contiendra que 2 </font></font><code>UI </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments: un champ de texte pour entrer la ville et une Ã©tiquette pour afficher la tempÃ©rature. La zone de texte pour entrer dans la ville est l'entrÃ©e active ( </font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et l'Ã©tiquette de tempÃ©rature est la sortie passive ( </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).&nbsp;&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le rÃ´le </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans l'architecture </font></font><code>MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est qu'il prend les ENTRÃ‰ES de </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), implÃ©mente la logique mÃ©tier de l'application et retransmet les SORTIES Ã &nbsp; </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), prÃ©sentant Ã©ventuellement ces donnÃ©es dans le format souhaitÃ©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CrÃ©er&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'importe quel type de logique mÃ©tier - synchrone ou asynchrone - est trÃ¨s simple si vous utilisez une </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe avec ses </font></font><code> @Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©s.</font></font><br>
<br>
<h2>   <code>API</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">OpenWeatherMap</a></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que le service&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap vous</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp; permette de sÃ©lectionner des informations mÃ©tÃ©orologiques trÃ¨s complÃ¨tes, le modÃ¨le des donnÃ©es qui nous intÃ©ressent sera trÃ¨s simple, il fournit des informations dÃ©taillÃ©es&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur la mÃ©tÃ©o actuelle dans la ville sÃ©lectionnÃ©e et se trouve dans le fichier&nbsp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Model.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : bien </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nn/mk/bp/nnmkbpg0dfdnan0olkkx_amlwus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
que dans cette tÃ¢che spÃ©cifique, nous ne nous intÃ©resserons qu'Ã  la tempÃ©rature </font></font><code>temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui est dans la structure&nbsp; </font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le modÃ¨le fournit des informations dÃ©taillÃ©es complÃ¨tes sur la mÃ©tÃ©o actuelle en tant que structure racine&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, croyant qu'Ã  l'avenir vous voudrez Ã©tendre les capacitÃ©s de cette application. La structure </font></font><code>WeatherDetail&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est codable, cela nous permettra de dÃ©coder littÃ©ralement les </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es dans le modÃ¨le avec </font><font style="vertical-align: inherit;">seulement deux lignes de code&nbsp; </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La structure&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;devrait Ã©galement Ãªtre</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si nous voulons nous faciliter Ã  l'avenir l'affichage d'un tableau de prÃ©visions mÃ©tÃ©orologiques&nbsp; </font></font><code>[WeatherDetail]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;pour plusieurs jours Ã  l'avance sous la forme d'une liste&nbsp; </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;de </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. C'est Ã©galement un blanc pour une future application mÃ©tÃ©o actuelle plus sophistiquÃ©e. Le protocole </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nÃ©cessite la prÃ©sence de la propriÃ©tÃ© </font></font><code> id,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que nous avons dÃ©jÃ , donc aucun effort supplÃ©mentaire ne sera requis de notre part. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habituellement, les services, y compris le service&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , offrent toutes sortes de services </font></font><code>URLs </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour obtenir les ressources dont nous avons besoin. Le service&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous offre </font></font><code>URLs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de rÃ©cupÃ©rer des informations dÃ©taillÃ©es sur la mÃ©tÃ©o actuelle ou les prÃ©visions pour 5 jours dans une certaine ville </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans cette application, nous ne serons intÃ©ressÃ©s que par les informations mÃ©tÃ©o actuelles et pour ce cas</font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculÃ© Ã  l'aide de la fonction </font></font><code>absoluteURL (city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/3i/ha/i13ihapejao-kzmclk5fz1k4vni.png"><br>
<br>
<code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;pour le service </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">&nbsp;nous </font><font style="vertical-align: inherit;">le </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">placerons</font></a><font style="vertical-align: inherit;"> dans le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WeatherAPI.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sa partie centrale sera une mÃ©thode de sÃ©lection d'informations mÃ©tÃ©orologiques dÃ©taillÃ©es&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans une ville&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><code>fetchWeather (for city: String) -&gt; AnyPublisher&lt;WeatherDetail, Never&gt;</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le contexte du cadre, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;cette mÃ©thode renvoie non seulement des informations mÃ©tÃ©orologiques dÃ©taillÃ©es&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais l '"Ã©diteur" correspondant </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Notre Â«Ã©diteurÂ» </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne renvoie aucune erreur - </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et si une erreur d'Ã©chantillonnage ou de codage s'est toujours produite, le sous-ministre revient&nbsp; </font></font><code>WeatherDetail.placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans aucun message supplÃ©mentaire sur la cause de l'erreur.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ConsidÃ©rez plus en dÃ©tail la mÃ©thode&nbsp; </font></font><code>fetchWeather (for city: String) -&gt; AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui sÃ©lectionne </font><font style="vertical-align: inherit;">&nbsp;les informations mÃ©tÃ©orologiques dÃ©taillÃ©es pour la ville </font><font style="vertical-align: inherit;">sur le site Web </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"></font><code>&nbsp;city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ne renvoie aucune erreur </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3h/am/tl/3hamtl2_qeyqozmtw3vnp6ezmeq.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en fonction du nom de la ville, nous&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;formons en </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;utilisant la fonction </font></font><code>absoluteURL(city:city)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour demander des informations mÃ©tÃ©orologiques dÃ©taillÃ©es&nbsp; </font></font><code>WeatherDetail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li> Â«Â» <code>dataTaskPublisher(for:)</code>,     <code>Output</code>   <code>(data: Data, response: URLResponse)</code>, &nbsp; <code>Failure</code>&nbsp;-&nbsp;<code>URLError</code>,</li>
<li>  <code>map { }</code>    (<code>data: Data, response: URLResponse) </code>    &nbsp;<code>data</code>,&nbsp;</li>
<li> <code>JSON </code>&nbsp;<code>data</code>   ,   &nbsp;<code>WeatherDetail</code>,     ,</li>
<li>  -     Â«Â»   &nbsp;<code>catch (error ... )</code>&nbsp;  Â«Â» <code>WeatherDetail.placeholder</code>,</li>
<li>  <code> main</code> ,          <code>UI</code>,</li>
<li>Â«Â»  Â«Â»   <code>eraseToAnyPublisher()</code>    <code>AnyPublisher</code>.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L 'Â«Ã©diteurÂ» asynchrone ainsi obtenu </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«ne dÃ©colle pasÂ» de lui-mÃªme, il ne livre rien tant que quelqu'un n'y Â«souscritÂ» pas. </font><font style="vertical-align: inherit;">Nous allons l'utiliser dans une&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;classe qui joue un rÃ´le </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã  la </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fois </font><font style="vertical-align: inherit;">dans&nbsp; </font><font style="vertical-align: inherit;">et </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CrÃ©er un modÃ¨le de vue</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour </font></font><code> View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crÃ©er une classe trÃ¨s simple&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui implÃ©mente un protocole </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;avec deux&nbsp; </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©s: &nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/db/gz/mt/dbgzmtbrpltinyd30ap_j6ykiok.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'un&nbsp; </font></font><code>@Published var city: String</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la ville (vous pouvez l'appeler conditionnellement une ENTRÃ‰E, car sa valeur est rÃ©glÃ©e par l'utilisateur sur </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">),&nbsp;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la seconde&nbsp; </font></font><code>@Published var currentWeather = WeatherDetail.placeholder </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la mÃ©tÃ©o dans cette ville en ce moment (nous pouvons conditionnellement appeler cette propriÃ©tÃ© EXIT, car elle est obtenue en rÃ©cupÃ©rant les donnÃ©es du site Web&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois que nous avons dÃ©fini une&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriÃ©tÃ©&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous pouvons commencer Ã  l'utiliser Ã  la fois comme simple propriÃ©tÃ©&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et comme "Ã©diteur"&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans une classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez non seulement dÃ©clarer les propriÃ©tÃ©s qui nous intÃ©ressent, mais Ã©galement prescrire la logique mÃ©tier de leur interaction. Ã€ cette fin, lors de l'initialisation d'une instance de la classe&nbsp; </font></font><code>TempViewModel&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans, </font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous pouvons crÃ©er un Â«abonnementÂ» qui fonctionnera tout au long du Â«cycle de vieÂ» de l'instance de la classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et reproduira la dÃ©pendance de la mÃ©tÃ©o actuelle&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;sur la ville&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous Ã©tirons la chaÃ®ne de l'entrÃ©e "Ã©diteur" </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Ã  la sortie "Ã©diteur" </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dont la valeur est la mÃ©tÃ©o actuelle. Par la suite, nous y Â«souscrivonsÂ» avec l'aide d'un Â«abonnÃ©Â»&nbsp;</font></font><code>assign (to: \.currentWeather, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;et obtenir la valeur souhaitÃ©e de la mÃ©tÃ©o actuelle en&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tant que </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriÃ©tÃ© de </font><font style="vertical-align: inherit;">Â«sortieÂ»&nbsp; </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons tirer la chaÃ®ne PAS simplement des propriÃ©tÃ©s </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Ã  savoir des "Ã©diteurs" </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui participeront Ã  la crÃ©ation </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;et c'est lÃ  que nous la changerons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment allons-nous procÃ©der? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons dÃ©jÃ  une fonction dans notre arsenal </font></font><code> fetchWeather (for city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui est dans la classe&nbsp; </font></font><code>WeatherAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et renvoie Â«l'Ã©diteurÂ» </font></font><code>AnyPublisher&lt;WeatherDetail, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;avec des informations mÃ©tÃ©orologiques dÃ©taillÃ©es en fonction de la ville&nbsp; </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et nous ne pouvons qu'en quelque sorte utiliser la valeur de Â«l'Ã©diteurÂ»&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour en faire un argument de cette fonction. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;Allez chez le bon Ã©diteur&nbsp; </font></font><code>fetchWeather (for city: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;pour&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous aider opÃ©rateur&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/1r/9j/wz1r9juemdlcse18ko2k4xcvgcs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpÃ©rateur</font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crÃ©e un nouvel Â«Ã©diteurÂ» sur la base des donnÃ©es reÃ§ues de l'ancien Â«Ã©diteurÂ». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous Â«souscrivonsÂ» Ã  cet Â«Ã©diteurÂ» nouvellement reÃ§u avec l'aide d'un Â«abonnÃ©Â» trÃ¨s simple&nbsp; </font></font><code>assign (to: \.currentWeather, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et attribuons la valeur reÃ§ue de Â«l'Ã©diteurÂ» Ã  la </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/ug/yt/ygugytbie7fl6ezfiala6jn-p9o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nous venons de crÃ©er un </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«Ã©diteurÂ» ASYNCHRONE et Â« </font><font style="vertical-align: inherit;">nous y sommes </font><font style="vertical-align: inherit;">abonnÃ©sÂ», ce qui donne lieu Ã  un </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«abonnementÂ» ". </font></font><br>
<br>
<code>AnyCancellable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L 'Â«abonnementÂ» permet Ã  l'appelant d'annuler Ã  tout moment Â«l'abonnementÂ» et de ne plus recevoir de valeurs de Â«l'Ã©diteurÂ», mais de plus, dÃ¨s que </font></font><code>&nbsp;AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«l'abonnementÂ» quitte son champ d'application, la mÃ©moire occupÃ©e par Â«l'Ã©diteurÂ» est libÃ©rÃ©e. Par consÃ©quent, dÃ¨s qu'il sera </font></font><code>init( ) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terminÃ©, cet Â«abonnementÂ» sera supprimÃ© par le systÃ¨me&nbsp;</font></font><code>ARC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et ne pas avoir le temps d'attribuer les informations asynchrones sur la mÃ©tÃ©o actuelle reÃ§ues avec un retard&nbsp; </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour enregistrer un tel Â«abonnementÂ», il est nÃ©cessaire de crÃ©er une </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">EXTÃ‰RIEURE </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui conservera notre </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«abonnementÂ» dans cette variable tout au long du Â«cycle de vieÂ» de l'instance de classe&nbsp; </font></font><code>TempViewMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L ' </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«abonnementÂ» dans la variable </font><font style="vertical-align: inherit;">
est stockÃ© </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã  l'aide de l'opÃ©rateur&nbsp; </font></font><code>store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dq/xh/y9/dqxhy9d4lnobqznxdlhx_lt83k4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par consÃ©quent, l' Â«abonnementÂ» sera conservÃ© tout au long du Â«cycle de vieÂ» de l'instance de classe&nbsp; </font></font><code>TempViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nous pouvons modifier la valeur de l'Ã©diteur comme vous le souhaitez </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et la mÃ©tÃ©o actuelle </font></font><code>currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;pour cette ville </font><font style="vertical-align: inherit;">sera toujours Ã  notre disposition </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de rÃ©duire le nombre d'appels de serveur lors de la saisie d'une ville&nbsp;</font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous ne devons pas utiliser directement Â«l'Ã©diteurÂ» de la ligne avec le nom de la ville&nbsp; </font></font><code>$city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais sa version modifiÃ©e avec les opÃ©rateurs </font></font><code>debounce</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>removeDuplicates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/m9/ho/hom9ho7cbdou92ol4fd6dizlqd4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'opÃ©rateur est&nbsp; </font></font><code>debounce</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;utilisÃ© pour attendre jusqu'Ã  ce que l'utilisateur ait fini de taper les informations nÃ©cessaires sur le clavier, puis effectuer une seule fois la tÃ¢che gourmande en ressources. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De mÃªme, un opÃ©rateur </font></font><code>removeDuplicates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne publiera des valeurs que si elles diffÃ¨rent des valeurs prÃ©cÃ©dentes. </font><font style="vertical-align: inherit;">Par exemple, si l'utilisateur entre d'abord </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis </font></font><code>joe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis Ã  nouveau </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous ne recevrons </font></font><code>john</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qu'une seule fois. </font><font style="vertical-align: inherit;">Cela contribue Ã  rendre le nÃ´tre </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plus efficace.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CrÃ©ation d'une interface utilisateur avec SwiftUI</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous l'avons </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">commenÃ§ons </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. D'abord Ã  </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis Ã  </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans nous </font></font><code>Xcode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crÃ©ons un nouveau projet avec </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et dans la structure rÃ©sultante, nous </font></font><code>ContentView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp; plaÃ§ons </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le </font><font style="vertical-align: inherit;">nÃ´tre&nbsp; </font><font style="vertical-align: inherit;">comme </font></font><code> @ObservedObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable </font></font><code>model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Remplacez&nbsp; </font></font><code>Text ("Hello, World!") </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le titre&nbsp; </font></font><code>Text ("WeatherApp")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ajoutez une zone de texte pour entrer la ville&nbsp; </font></font><code>TextField ("City", text: self.$model.city)&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et une Ã©tiquette pour afficher la tempÃ©rature: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/oc/si/zzocsimzbd7bpssf_-ckigkggdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons directement utilisÃ© les valeurs de notre variable </font></font><code>model:&nbsp;TempViewModel()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nous avons utilisÃ© dans la zone de texte pour entrer la ville </font></font><code>$model.city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et dans l'Ã©tiquette pour afficher la tempÃ©rature - </font></font><code>model.currentWeather.main?.temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DÃ©sormais, toute modification des&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriÃ©tÃ©s entraÃ®nera un "redessin" </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/jx/uk/sdjxukkrljf2xfbo944koyt4ee4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ceci est assurÃ© par le fait que le nÃ´tre </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est</font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-Ã -dire que la Â«liaisonÂ» AUTOMATIQUE ( </font></font><code>binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de nos propriÃ©tÃ©s </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des Ã©lÃ©ments de l'interface utilisateur ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">est effectuÃ©e </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette "liaison" AUTOMATIQUE n'est possible qu'en </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CrÃ©ation d'une interface utilisateur avec UIKit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que faire avec Ã§a </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Ce nâ€™est pas lÃ &nbsp;  </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans&nbsp; </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous effectuerons la "liaison" ( </font></font><code>binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) manuellement. </font><font style="vertical-align: inherit;">Il existe plusieurs faÃ§ons de procÃ©der Ã  cette Â«liaison manuelleÂ»:</font></font><br>
<br>
<ul>
<li><code>Key-Value Observing </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>KVO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: un mÃ©canisme permettant&nbsp; </font></font><code>key paths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de surveiller une propriÃ©tÃ© et de recevoir une notification de sa modification.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmation rÃ©active fonctionnelle ou </font></font><code>FRP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: utilisation d'un framework </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><code>Delegation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Utilisation de mÃ©thodes dÃ©lÃ©guÃ©es pour envoyer une notification indiquant qu'une valeur de propriÃ©tÃ© a changÃ©.</font></font></li>
<li><code>Boxing</code>:    <code>didSet { }</code>    ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compte tenu du titre de l'article, nous travaillerons naturellement sur le terrain </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans l' </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application, nous montrerons Ã  quel point il est facile de crÃ©er une Â«liaison manuelleÂ» avec </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l' </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application, nous aurons Ã©galement deux </font></font><code>UI </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments: </font></font><code>UITextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour entrer dans la ville et </font></font><code> UILabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour afficher la tempÃ©rature. Dans </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous aurons naturellement </font></font><code>Outlet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ces Ã©lÃ©ments: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/_w/xs/dc_wxscdvx2gfvhkzpn2sppn_k8.png"><br>
<br>
<img src="https://habrastorage.org/webt/dp/hi/du/dphidu2qg7ym1bn1sorekv0opts.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous la forme d'une variable ordinaire </font></font><code>viewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous avons le mÃªme que </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la section prÃ©cÃ©dente: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/py/lr/n1/pylrn1luepommf97vwrthhyz3oy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de faire une Â«liaison manuelleÂ» avec </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, faisons du champ de texte </font></font><code>UITextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre alliÃ© et Â«Ã©diteurÂ» de notre contenu </font></font><code>text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/dn/wg/z0dnwgxqkqam7mcy8qbyo6ajvx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela nous permettra de mettre en </font></font><code>viewDidLoad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å“uvre </font><font style="vertical-align: inherit;">trÃ¨s facilement la </font><font style="vertical-align: inherit;">Â«liaison manuelleÂ» en utilisant la fonction</font></font><code>binding ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: En </font></font><br>
<br>
<img src="https://habrastorage.org/webt/q0/qu/-f/q0qu-ftfjqr_giedbnah50cwe2m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
effet, nous Â« subscribe Â» Ã  Â« Ã©diteur Â» </font></font><code> cityTextField.textPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec l'aide d'un Â« abonnÃ© Â» trÃ¨s simple&nbsp; </font></font><code>assign (to: \.city, on: viewModel)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et assignons le texte tapÃ© par l'utilisateur dans le champ de texte </font></font><code>cityTextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã  notre Â« entrÃ©e Â»&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ© de la </font></font><code>city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nÃ´tre </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous apportons des changements dans une autre direction: nous Â«souscrivonsÂ» Ã  la </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriÃ©tÃ©&nbsp; </font><font style="vertical-align: inherit;">Â«sortieÂ»&nbsp; </font></font><code>$currentWeather</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;avec l'aide de Â«l'abonnÃ©Â» </font></font><code>sink </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et sa fermeture </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, formons la valeur de tempÃ©rature et l'affectons Ã  l'Ã©tiquette </font></font><code> temperatureLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ReÃ§u dans&nbsp; </font></font><code>viewDidLoad&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«l'abonnementÂ» est stockÃ© dans une variable </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. AprÃ¨s les avoir crÃ©Ã©s une fois, nous leur permettons d'agir tout au long du Â«cycle de vieÂ» de l'instance de classe </font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et avec Â«l'abonnementÂ» dans notre&nbsp;</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implÃ©menter toute la logique mÃ©tier de l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, le protocole </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne fonctionne pas avec </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais il n'interfÃ¨re pas. </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complÃ¨tement indiffÃ©rent au protocole </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, en principe, il pourrait Ãªtre supprimÃ©&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans les </font></font><code>UIKit </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">applications: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/fs/pi/wpfspirlf9jp-e2magbcorvzany.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mais nous ne le ferons pas, car nous voulons le garder inchangÃ© </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã  la fois pour l'application actuelle </font></font><code> UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et Ã©ventuellement pour les applications futures </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout. Le code est sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conclusion </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un cadre rÃ©actif fonctionnel </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous permet de mettre en Å“uvre l' </font></font><code> MVVM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">architecture </font><font style="vertical-align: inherit;">de maniÃ¨re trÃ¨s simple et concise Ã  la </font><font style="vertical-align: inherit;">fois </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forme de code comprÃ©hensible et lisible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combiner + UIKit + MVVM</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation du </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">didacticiel </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Combiner </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MVVM iOS: Refactorisation de MVC </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MVVM avec le didacticiel Combiner pour iOS</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS Si vous voulez voir des informations mÃ©tÃ©orologiques, vous devez vous inscrire sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWeatherMap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;et obtenir </font></font><code> API key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ce processus ne vous prendra pas plus de 2 minutes.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr492514/index.html">Comment Ã©tablir un flux de documents Ã©lectroniques juridiquement significatif des contreparties en Russie et au Kazakhstan?</a></li>
<li><a href="../fr492518/index.html">L'Ã©pidÃ©mie de virus nÃ©cessite un travail Ã  distance, ce qui signifie la signature numÃ©rique des documents</a></li>
<li><a href="../fr492520/index.html">ModÃ©lisation 3D paramÃ©trÃ©e de la cuvette de roulement dans nanoCAD Plus 20</a></li>
<li><a href="../fr492522/index.html">Communication d'Ã©quipe Ã  distance</a></li>
<li><a href="../fr492524/index.html">Comment j'ai gagnÃ© 1 000 000 $ sans expÃ©rience ni relations, puis les ai dÃ©pensÃ©s pour faire mon traducteur</a></li>
<li><a href="../fr492534/index.html">Existe-t-il ou non de vrais ouragans Ã  Moscou? Nous analysons le cas du 13 mars 2020 en pleine poursuite</a></li>
<li><a href="../fr492538/index.html">Wrike TechClub: Infrastructure de livraison - processus et outils (DevOps + QAA). Articles en anglais</a></li>
<li><a href="../fr492540/index.html">Le jeu "Attendez un instant!" sur arduino</a></li>
<li><a href="../fr492546/index.html">VÃ©rification de la vulnÃ©rabilitÃ© de tout site utilisant Nikto</a></li>
<li><a href="../fr492548/index.html">Apprentissage automatique Unity: apprendre aux agents MO Ã  sauter par-dessus les murs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>