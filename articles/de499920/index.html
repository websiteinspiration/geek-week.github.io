<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚱️ 💂 📞 SSH kleine Tricks 🙅🏻 🤵🏻 🤷🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel wurden unsere Best Practices für eine effizientere Verwendung von SSH zusammengestellt. Daraus lernen Sie, wie:
 
 

- Fügen Sie dem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SSH kleine Tricks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/499920/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Artikel wurden unsere Best Practices für eine effizientere Verwendung von SSH zusammengestellt. </font><font style="vertical-align: inherit;">Daraus lernen Sie, wie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fügen Sie dem SSH-Login den zweiten Faktor hinzu</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicher zu verwendende Agentenweiterleitung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melden Sie sich von einer SSH-Sitzung ab</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halten Sie das permanente Terminal offen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilen Sie eine Remote-Terminalsitzung mit einem Freund (ohne Zoom!)</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinzufügen eines zweiten Faktors zu Ihrer SSH</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Authentifizierungsfaktor kann auf fünf verschiedene Arten zu Ihren SSH-Verbindungen hinzugefügt werden:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktualisieren Sie Ihr OpenSSH und verwenden Sie den Verschlüsselungsschlüssel. </font><font style="vertical-align: inherit;">Im Februar 2020 wurde OpenSSH um die Unterstützung von FIDO U2F-Verschlüsselungsschlüsseln (Universal Second Factor) erweitert. </font><font style="vertical-align: inherit;">Dies ist eine großartige neue Funktion, aber es gibt eine Nuance: Nur Clients und Server, die auf OpenSSH Version 8.2 und höher aktualisiert wurden, können Verschlüsselungsschlüssel verwenden, da mit dem Update vom Februar neue Schlüsseltypen für sie eingeführt werden. </font><font style="vertical-align: inherit;">Mit dem Befehl können </font></font><code>ssh –V</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie die Client-Version von SSH und die Server-Version mit dem Befehl überprüfen</font></font><code>nc [servername] 22 </code><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Februar-Version wurden zwei neue Schlüsseltypen hinzugefügt - ecdsa-sk und ed25519-sk (zusammen mit den entsprechenden Zertifikaten). </font><font style="vertical-align: inherit;">Um eine Schlüsseldatei zu generieren, geben Sie einfach Ihren Verschlüsselungsschlüssel ein und führen Sie den folgenden Befehl aus:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ ssh-keygen -t ecdsa-sk -f ~/.ssh/id_ecdsa_sk</code></pre><br>
           U2F .     U2F  —          .<br>
<br>
 ,            .<br>
<br>
-     OpenSSH   -sk-.       U2F           .  -  :<br>
<br>
<pre><code class="plaintext hljs">$ ssh-keygen -t ecdsa-sk -O resident -f ~/.ssh/id_ecdsa_sk</code></pre><br>
,         ,      :<br>
<br>
<pre><code class="plaintext hljs">$ ssh-add -K</code></pre><br>
           .</li>
<li> PIV+PKCS11  Yubikey.         SSHD       .  Yubico     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">U2F+SSH  PIV/PKCS11</a>.        FIDO U2F,    ,    ,    .</li>
<li>  yubikey-agent ssh-.    SSH   Yubikeys.       .</li>
<li> Touch ID  sekey. Sekey  SSH     ,        Mac’    Touch ID   .</li>
<li> Single Sign On SSH. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a>      .    single sign on SSH         —     (MFA).</li>
</ol><br>
<h2>  agent forwarding</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der SHH-Agentenweiterleitung kann ein Remote-Host auf den SSH-Agenten Ihres lokalen Geräts zugreifen. Wenn Sie SSH mit aktivierter Agentenweiterleitung verwenden (normalerweise über ssh -A), enthält die Verbindung zwei Kanäle: Ihre interaktive Sitzung und den Kanal für die Agentenweiterleitung. Über diesen Kanal stellt der von Ihrem lokalen SSH-Agenten erstellte Unix-Socket eine Verbindung zum Remote-Host her. Dies ist eine riskante Methode, da ein Benutzer mit Root-Zugriff auf einem Remote-Gerät auf Ihren lokalen SSH-Agenten zugreifen und sich möglicherweise als Sie im Netzwerk ausgeben kann. Wenn Sie den Standard-SSH-Agenten aus dem Open SSH-Kit verwenden, wissen Sie nicht einmal, dass dies passiert ist. Mit einem U2F-Schlüssel (oder Sekey) können Sie alle Versuche, Ihren SSH-Agenten von außen zu verwenden, effektiv blockieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz dieser Vorsichtsmaßnahme ist es eine gute Idee, die Agentenweiterleitung so wenig wie möglich zu verwenden. </font><font style="vertical-align: inherit;">Sie sollten es nicht bei jeder Sitzung verwenden. Verwenden Sie die Agentenweiterleitung nur, wenn Sie sicher sind, dass sie für die aktuelle Sitzung erforderlich ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beenden einer Hängesitzung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Unterbrechung des Netzwerks, ein unkontrolliertes Verhalten von Programmen oder eine Escape-Sequenz, die die Tastatureingabe blockiert, sind mögliche Ursachen für eine Unterbrechung der SSH-Sitzung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt verschiedene Möglichkeiten, eine blockierte Sitzung zu beenden:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wird automatisch beendet, wenn das Netzwerk unterbrochen wird. </font><font style="vertical-align: inherit;">In Ihrer .ssh / config müssen Sie Folgendes hinzufügen:</font></font><br>
<br>
<pre><code class="plaintext hljs">ServerAliveInterval 5<font></font>
ServerAliveCountMax 1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssh sendet alle ServerAliveInterval-Sekunden ein Echo an den Remote-Host, um die Verbindung zu überprüfen. </font><font style="vertical-align: inherit;">Wenn weitere ServerAliveCountMax-Echos keine Antwort erhalten, beendet ssh die Verbindung im Zeitlimit und beendet die Sitzung.</font></font></li>
<li>  . ssh     ~ ()  .  ~.         . (       .)  ~?        .  ,     ~   ,     ~ .</li>
</ol> <br>
<i><b>    ?</b>           .         IPv4  WiFi,  IP- .   SSH   TCP ,  ,   ,       IP-,       ,  SSH        .    IP-,         .    ,         TCP-    .             .  ,       . IPv6      ,          . ,       .</i><br>
<br>
<h2>       </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt zwei verschiedene Ansätze, um eine Verbindung aufrechtzuerhalten, wenn Sie zwischen verschiedenen Netzwerken wechseln oder wenn Sie die Verbindung für kurze Zeit trennen möchten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Verwenden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eternal Terminal.</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn Sie wirklich eine Verbindung benötigen, die auch beim Wechseln zwischen Netzwerken nicht nachlässt, verwenden Sie die Mosh Mobile Shell. Dies ist eine sichere Shell, die zuerst einen SSH-Handshake verwendet und dann für die Dauer der Sitzung auf einen eigenen verschlüsselten Kanal wechselt. So schafft Mosh einen separaten, sehr stabilen und sicheren Kanal, der Internetunterbrechungen, Änderungen der IP-Adresse Ihres Laptops, schwerwiegenden Netzwerkausfällen und vielem mehr standhält, alles dank der Magie von UDP-Verbindungen Mosh-Synchronisierungsprotokoll.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Mosh verwenden zu können, müssen Sie es sowohl auf dem Client als auch auf dem Server installieren und die Ports 60000-61000 für den getrennten UPD-Verkehr zu Ihrem Remote-Host öffnen. In Zukunft wird es ausreichen, um die Verbindung zu verwenden </font></font><code>mosh user@server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mosh arbeitet auf der Ebene von Bildschirmen und Tastenanschlägen, was eine Reihe von Vorteilen gegenüber der Weiterleitung des binären Stroms von Standardeingaben und -ausgaben zwischen dem Client und dem SSH-Server bietet. Wenn wir nur Bildschirme und Tastenanschläge synchronisieren müssen, wird das Wiederherstellen einer unterbrochenen Verbindung später viel einfacher. Während SSH alles puffert und sendet, was passiert ist, muss Mosh nur die Tastenanschläge puffern und den letzten Frame des Terminalfensters mit dem Client synchronisieren. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Verwenden Sie tmux</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie kommen und gehen möchten, wann Sie möchten, und die Terminalsitzung auf einem Remote-Host behalten möchten, verwenden Sie den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terminal-Multiplexer</font></font></a> <code>tmux</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ich liebe tmux und benutze es ständig. </font><font style="vertical-align: inherit;">Wenn Ihre SSH-Verbindung unterbrochen ist, müssen Sie nur die Verbindung wiederherstellen und eingeben, um zu Ihrer tmux-Sitzung zurückzukehren </font></font><code>tmux attach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Darüber hinaus verfügt es über wunderbare Funktionen wie Registerkarten und Bedienfelder innerhalb des Terminals, ähnlich den Registerkarten im iOS-Terminal, und die Möglichkeit, Terminals mit anderen zu teilen. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Leute mögen es, ihren tmux mit Byobu zu verschönern, einem Paket, das die Benutzerfreundlichkeit von tmux erheblich verbessert und viele Tastaturkürzel hinzufügt. </font><font style="vertical-align: inherit;">Byobu wird mit Ubuntu ausgeliefert und ist über Homebrew einfach auf einem Mac zu installieren.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilen einer Remote-Terminalsitzung mit einem Freund</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manchmal möchten Sie beim Debuggen komplexer Probleme auf Ihren Servern eine SSH-Sitzung mit jemandem teilen, der sich nicht im selben Raum wie Sie befindet. </font><font style="vertical-align: inherit;">tmux ist perfekt für eine solche aufgabe! </font><font style="vertical-align: inherit;">Es reicht aus, nur ein paar Schritte zu unternehmen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sicher, dass sich tmux auf Ihrem Bastion-Host oder auf einem Server befindet, mit dem Sie arbeiten werden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie müssen beide über SSH über ein Konto eine Verbindung zum Gerät herstellen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer von Ihnen muss tmux starten, um eine tmux-Sitzung zu starten.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein anderer sollte tmux attach ausführen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voila! </font><font style="vertical-align: inherit;">Sie haben ein gemeinsames Terminal.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie anspruchsvollere Mehrbenutzer-tmux-Sitzungen wünschen, versuchen Sie es mit tmate. Dies ist eine Verzweigung von tmux, die gemeinsame Terminalsitzungen erheblich vereinfacht.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499900/index.html">Produktanalyse mitap: kostenlos, kontaktlos, online</a></li>
<li><a href="../de499902/index.html">Funktionsweise von TCP Reset Attack</a></li>
<li><a href="../de499904/index.html">"Ich habe Angst". Was zu tun ist?</a></li>
<li><a href="../de499906/index.html">Beispiele für die Verwendung von AR in der Spielwarenindustrie</a></li>
<li><a href="../de499910/index.html">Ausgewogenheit bei der Entscheidungsfindung. Gabel "zufällige Erfahrung"</a></li>
<li><a href="../de499922/index.html">Schließlich beschäftigen wir uns mit der Modbus-Baudrate</a></li>
<li><a href="../de499926/index.html">30. April Java Digest</a></li>
<li><a href="../de499928/index.html">Udalenka: Was hat sich mit COVID-19 geändert und wer ist jetzt noch besser als zuvor</a></li>
<li><a href="../de499930/index.html">Wie ich Blöcke und Transaktionen in meiner Go-Blockchain entworfen habe</a></li>
<li><a href="../de499934/index.html">Peitscheneffekt und Bierspiel: Modellierung und Supply Chain Management</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>