<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕑 🧣 👩‍🔧 Nous traitons de l'algorithme d'effondrement de la fonction d'onde 🙆🏿 🍪 👩‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depuis l'avènement de DeBroglie et Tessera, on m'a demandé à plusieurs reprises d'expliquer leur fonctionnement. La génération peut sembler magique, m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous traitons de l'algorithme d'effondrement de la fonction d'onde</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/497590/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/0p/3h/m9/0p3hm9jziz_gbzi9tajbo2p_s3a.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis l'avènement de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeBroglie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera, on</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m'a demandé à plusieurs reprises d'expliquer leur fonctionnement. </font><font style="vertical-align: inherit;">La génération peut sembler magique, mais les règles qui la sous-tendent sont en fait simples.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce que l'algorithme WFC (Wave Function Collapse)? </font><font style="vertical-align: inherit;">Il a été développé par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Gumin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour créer des images «en mosaïque» basées sur une configuration simple ou des échantillons d'images. </font><font style="vertical-align: inherit;">L'algorithme peut faire beaucoup: regardez les exemples fournis par Maxim et Twitter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , regardez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cette vidéo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La variété est incroyable.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Votre navigateur ne prend pas en charge la vidéo HTML5.</font></font><source src="https://www.boristhebrave.com/wp-content/uploads/2020/04/platformer.webm" type="video/webm"></video></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim dans README a brièvement expliqué le travail de WFC, mais il me semble que ce problème nécessite une divulgation plus détaillée, à partir des bases. Puisque l'algorithme est lié à la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programmation dans les contraintes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la plupart de l'article est consacré à </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">expliquer le concept de programmation dans les contraintes, et à la fin nous reviendrons sur WFC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La programmation restreinte est un moyen d'instruire les ordinateurs. Contrairement à la programmation impérative, lorsque vous spécifiez une liste de fonctions explicites, ou la programmation fonctionnelle, lorsque vous spécifiez des fonctions mathématiques, vous fournissez ici à l'ordinateur une description stricte du problème, et il utilise les algorithmes intégrés pour trouver une solution. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce guide décrit divers concepts, pas les méthodes et le code. </font><font style="vertical-align: inherit;">Si vous êtes plus intéressé par l'implémentation, vous pouvez utiliser ma bibliothèque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">open source</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WFC ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">github</font></a><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Bien qu'il soit préférable de commencer l'étude avec la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise en œuvre de Maxim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous utilisez Unity, vous pouvez acheter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est mon outil pour appliquer WFC dans ce moteur.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mini sudoku</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À titre d'illustration, j'ai pris un mini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudoku</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">C'est un puzzle qui ressemble à une grille 4 × 4 avec des nombres dans certaines cellules.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/079/ce5/2d2079ce585502dbe9329e0a34cfbed8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'objectif est de remplir chaque cellule vide d'un nombre de 1 à 4 conformément aux règles:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque numéro de 1 à 4 doit être présent sur chaque ligne en un seul exemplaire.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque numéro de 1 à 4 doit être présent dans chaque colonne en un seul exemplaire.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque numéro de 1 à 4 doit être présent dans chaque carré d'angle 2 × 2 en un seul exemplaire. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon ces règles, la solution sera la suivante:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9e/ebf/927/d9eebf92740912d10aaaf6e63db189f3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous avez peut-être facilement résolu ce puzzle. </font><font style="vertical-align: inherit;">Mais nous voulons savoir comment un ordinateur peut le faire. </font><font style="vertical-align: inherit;">Le problème peut être divisé en deux parties: une description des conditions de l'ordinateur, puis une solution utilisant l'algorithme.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description des conditions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habituellement, un langage de programmation avec restrictions est utilisé pour cela. Il existe plusieurs de ces langages et leurs principes d'action sont similaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous définissons d'abord les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variables</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ici, ils ne sont pas les mêmes que dans la programmation conventionnelle. Dans le contexte d'une solution de problème, une variable est une valeur inconnue qui doit être résolue pour résoudre un problème. Dans notre exemple de Sudoku, nous allons créer des variables pour toutes les cellules vides. Pour plus de commodité, vous pouvez également créer des variables pour les cellules remplies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, pour chaque variable, nous définissons un </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domaine</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : un ensemble de valeurs possibles. Dans notre sudoku, pour chaque cellule vide, le domaine sera {1, 2, 3, 4}. Et pour une cellule dans laquelle 1 est déjà entré, le domaine sera {1}. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, nous fixons les </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contraintes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: règles liant nos variables. </font><font style="vertical-align: inherit;">Dans la plupart des langages de programmation, il existe déjà une fonction avec des restrictions </font></font><code>all_distinct(..)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui doit transmettre des valeurs uniques. </font><font style="vertical-align: inherit;">Ainsi, les règles de Sudoku peuvent être traduites en 12 contraintes </font></font><code>all_distinct</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- une pour chaque ligne et colonne, ainsi que pour les coins 2 × 2. </font><font style="vertical-align: inherit;">Nous n'avons besoin que d'un seul type de contrainte pour résoudre ce problème, cependant, les résolveurs de problèmes pour répondre aux contraintes sont généralement fournis avec une grande bibliothèque de différents types de contraintes pour décrire votre problème. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : dans la pratique, les langages de programmation prennent en charge les tableaux dans les contraintes, il existe donc des moyens plus précis de formuler cette tâche. </font><font style="vertical-align: inherit;">Il existe de nombreux articles sur le net sur la résolution de sudoku.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithmes pour résoudre les problèmes de satisfaction des contraintes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs techniques de solution différentes. </font><font style="vertical-align: inherit;">Mais je considérerai les plus simples d'entre eux pour vous démontrer le principe de leur travail. </font><font style="vertical-align: inherit;">Les domaines pour chaque cellule sont affichés ici:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/192/dd5/6d7/192dd56d7c6fad65e9d0ff0cd672b8b8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sont toutes des valeurs possibles dans des domaines variables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenez maintenant la première limitation. </font><font style="vertical-align: inherit;">Cela nécessite que toutes les valeurs de la ligne supérieure soient uniques. </font><font style="vertical-align: inherit;">Dans une cellule, la valeur 4 est déjà inscrite, par conséquent, dans d'autres cellules de la série, cette valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut </font><i><font style="vertical-align: inherit;">pas l'être</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous le supprimons des domaines de ces cellules.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea5/f37/ab8/ea5f37ab81c6fe4e923999a01d9c5b81.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Répétez ce processus avec les 12 restrictions. </font><font style="vertical-align: inherit;">C'est ce qu'on appelle la </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propagation de restrictions</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car les informations sont distribuées d'une variable à l'autre par le biais de restrictions.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c06/08e/1fa/c0608e1fa9d933b28269217ae9678831.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et regardez, nous avons des variables, dans les domaines dont il reste une valeur. </font><font style="vertical-align: inherit;">Ces </font><font style="vertical-align: inherit;">solutions </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devraient</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> être les bonnes pour ces variables.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02e/074/d2c/02e074d2cdcde1220efade75f26d7234.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que nous puissions tirer encore plus d'avantages de la distribution des restrictions: les nouvelles unités rouges indiquent que nous aurons encore plus de variables avec un seul domaine, ce qui contribuera également à la distribution. </font><font style="vertical-align: inherit;">Répétez la procédure jusqu'à ce que le puzzle soit résolu.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f78/94d/b63/f7894db63f3238fab4cf689941bd9d69.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous compliquons la tâche</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, tous les puzzles logiques ne peuvent pas être résolus aussi rapidement. </font><font style="vertical-align: inherit;">Voici un grand sudoku, il fonctionne de la même manière, sauf que maintenant nous avons 9 valeurs différentes, 9 lignes, 9 colonnes et 9 carrés 3 × 3.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd2/97d/434/fd297d4345a2593633a88bbf0bf26764.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous essayons d'appliquer la technique ci-dessus, nous resterons bloqués:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/481/f68/a82/481f68a826b65b43441ddae08821f1ba.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, toutes les restrictions sont communes, mais il reste des variables non définies. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une personne décidera de cela, mais un algorithme informatique ne pourra pas le faire. Les manuels destinés aux gens disent que nous devons maintenant chercher des conclusions logiques de plus en plus compliquées. Mais nous n'avons pas besoin d'un algorithme informatique pour ce faire, car c'est difficile, mais nous avons besoin d'un </font><font style="vertical-align: inherit;">algorithme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">universel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui peut fonctionner avec n'importe quel ensemble de restrictions, et pas seulement selon les règles du sudoku. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, les ordinateurs font la chose la plus stupide: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ils supposent</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tout d'abord, nous enregistrons l'état actuel du puzzle. Ensuite, nous sélectionnons une variable arbitraire et la définissons sur l'une des valeurs possibles. Disons que nous attribuons la valeur 1 à la cellule centrale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous pouvons étendre un peu plus les restrictions. </font><font style="vertical-align: inherit;">Voici ce que j'ai obtenu pour la colonne centrale:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f8b/176/f83/f8b176f83864aad8a4907714b7d0b790.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les valeurs bleues sont les conclusions que nous avons tirées après l'hypothèse. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, quelque chose s'est produit. </font><font style="vertical-align: inherit;">Nous avons ajouté quelques variables supplémentaires, mais jetons un œil à la cellule supérieure du milieu. </font><font style="vertical-align: inherit;">Il est vide: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans son domaine il n'y a pas de valeurs possibles</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> satisfaisant aux restrictions (il ne peut pas y en avoir 5, car cette valeur existe déjà dans le même carré 3 × 3, et tous les autres nombres sont déjà dans cette colonne). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous obtenons une variable avec un domaine vide, cela signifie que nous ne pouvons lui attribuer aucune valeur. </font><font style="vertical-align: inherit;">Autrement dit, le puzzle ne peut pas être résolu. </font><font style="vertical-align: inherit;">Il s'avère que </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notre hypothèse était erronée</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Face à une telle contradiction, nous effectuons le processus de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recherche de retour</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(retour en arrière). Tout d'abord, nous restaurons l'état qui était avant notre hypothèse. Ensuite, nous supprimons du domaine la valeur que nous avons utilisée comme hypothèse - ce ne peut plus être la bonne réponse.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1f/6b5/684/b1f6b5684064aab0ed2c355774b3d7aa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup de travail a été fait, mais ils ont progressé. Cependant, même après exclusion de 1 de la cellule centrale, nous sommes toujours au point mort. Il est temps de faire une hypothèse encore et encore et encore. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas beaucoup d'actions algorithmiques ici. Chaque fois que nous ne pouvons pas distribuer de restrictions, nous faisons une hypothèse et continuons. Et puisque vous pouvez rester bloqué plusieurs fois avant de rencontrer une contradiction, vous accumulerez alors plusieurs états et hypothèses enregistrés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À chaque itération avec un retour, vous réduisez le domaine d'au moins une variable, de sorte que, malgré de nombreux retours en arrière, l'algorithme </font><font style="vertical-align: inherit;">finira </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terminer le travail.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sujet est beaucoup plus étendu que je ne le décris. </font><font style="vertical-align: inherit;">En pratique, les optimisations telles que le choix des hypothèses, la compréhension du moment de la distribution et du moment de tirer des conclusions logiques plus complexes peuvent avoir un impact énorme sur l'exécution du programme. </font><font style="vertical-align: inherit;">Et comme les problèmes de contraintes augmentent généralement de façon exponentielle, vous pouvez obtenir une réponse demain ou après 5000 ans.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous revenons à l'effondrement de la fonction d'onde</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'effondrement de la fonction d'onde est une tâche délicate avec une limitation: il existe des milliers de solutions possibles. Si nous faisons des hypothèses au hasard, alors au lieu d'un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solveur,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous obtenons un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">générateur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans le même temps, il respectera toujours toutes les restrictions données, c'est-à-dire qu'il sera beaucoup plus facile à gérer que la plupart des autres générateurs de procédures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tâche de l'algorithme WFC est de remplir les cellules avec des tuiles afin que les images sur les tuiles soient combinées les unes avec les autres. Dans la terminologie utilisée ci-dessus, chaque mosaïque est une valeur, chaque cellule est une variable et les règles de placement des mosaïques sont des contraintes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim, l'auteur de WFC, a constaté qu'avec un choix raisonnable de tuiles et une randomisation appropriée, vous devez rarement utiliser le retour arrière, donc cette procédure ne peut pas être mise en œuvre. </font><font style="vertical-align: inherit;">Ainsi, l'essence du WFC est la suivante:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un tableau booléen est créé pour chaque cellule, qui représente le domaine de cette variable. </font><font style="vertical-align: inherit;">Les domaines contiennent un enregistrement par tuile et tous sont initialisés avec une valeur </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Une tuile entre dans un domaine si sa valeur est égale </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le même temps, il existe des cellules dans lesquelles les domaines contiennent plusieurs éléments:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sélection d'une cellule aléatoire en utilisant la méthode heuristique de "moindre entropie".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sélectionnez une tuile aléatoire dans le domaine cellulaire et supprimez toutes les autres tuiles de là.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mise à jour des domaines d'autres cellules sur la base de ces nouvelles informations est la propagation de la restriction cellulaire. </font><font style="vertical-align: inherit;">Cela doit être fait à plusieurs reprises, car les changements dans les cellules peuvent avoir d'autres conséquences.</font></font></li>
</ul></li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : mes conditions sont différentes de celles de Maxim. </font><font style="vertical-align: inherit;">Il appelle le tableau des domaines une onde, et le choix d'une tuile aléatoire est une observation. </font><font style="vertical-align: inherit;">Autrement dit, une analogie est établie avec la mécanique quantique. </font><font style="vertical-align: inherit;">Mais la comparaison est superficielle, nous allons donc l'ignorer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe de nombreux ajouts aux principes ci-dessus qui ajoutent de la grâce et des performances à l'algorithme. </font><font style="vertical-align: inherit;">Mais regardons d'abord les étapes décrites.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Disons que nous devons remplir une grille 3 x 3 avec quatre types de tuiles:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/749/647/d6b/749647d6ba27126a9e7769a479cd79a5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les limitations sont les suivantes: les couleurs des tuiles adjacentes doivent correspondre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme dans l'exemple de Sudoku, je vais illustrer le contenu des domaines avec des images monochromes. </font><font style="vertical-align: inherit;">Lorsqu'il ne reste plus qu'un élément dans le domaine, je vais l'augmenter en taille et l'afficher en couleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, dans chaque cellule, des carreaux de toute nature peuvent être localisés:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/780/406/ba9/780406ba92fd3d6cd89234b1aa2b8431.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exécutez la boucle WFC principale. </font><font style="vertical-align: inherit;">Sélectionnez au hasard une cellule, par exemple, en haut à gauche. </font><font style="vertical-align: inherit;">Sélectionnez maintenant une vignette dans le domaine et supprimez toutes les autres.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6b/053/8a4/c6b0538a47c9355d22fe75fada7252cc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distribuez les restrictions. </font><font style="vertical-align: inherit;">La seule règle s'applique aux tuiles adjacentes, nous devons donc mettre à jour deux cellules:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/90e/a7f/440/90ea7f440d0b3805b324a4bbaef6a7e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouvons-nous mettre à jour d'autres tuiles compte tenu des domaines en diminution? </font><font style="vertical-align: inherit;">Oui! </font><font style="vertical-align: inherit;">Bien que nous ne soyons pas sûrs du choix de la première tuile, nous voyons que les options restantes mènent à droite. </font><font style="vertical-align: inherit;">Autrement dit, certains types de tuiles ne peuvent pas être placés dans le coin supérieur droit. </font><font style="vertical-align: inherit;">Même chose avec le coin en bas à gauche.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4dc/4f3/d07/4dc4f3d070fe3268639e9fc3e2877661.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne pouvons plus distribuer les restrictions, nous répétons donc le cycle principal: sélection des cellules, sélection et distribution des tuiles. </font><font style="vertical-align: inherit;">Cette fois, nous prenons la cellule centrale supérieure:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b58/44c/01a/b5844c01a98770f203587dd46d02a3df.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre cycle: prenez la cellule centrale gauche. </font><font style="vertical-align: inherit;">Après la prolifération des restrictions pour la cellule centrale, une valeur possible demeure.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/066/f76/a13/066f76a13cda6b5e275a371b3561c02a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, vous comprenez l'idée. </font><font style="vertical-align: inherit;">Vous pouvez remplir vous-même le reste des cellules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voulez expérimenter avec un </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemple interactif plus complexe</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je recommande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celui-ci</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entropie la plus petite</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du choix de la cellule suivante à remplir, certaines options seront préférables. </font><font style="vertical-align: inherit;">Si vous choisissez au hasard n'importe où dans la grille, une situation peut se produire lorsque vous aurez en même temps différentes zones de la grille remplies. </font><font style="vertical-align: inherit;">Cela peut entraîner des problèmes: selon les tuiles disponibles, les zones remplies ne peuvent pas être jointes. </font><font style="vertical-align: inherit;">Il est donc préférable de choisir des cellules qui sont moins susceptibles de conduire à de tels problèmes à l'avenir. </font><font style="vertical-align: inherit;">En d'autres termes, vous devez prendre des cellules avec le moins de valeurs possibles dans le domaine (mais pas moins de deux valeurs):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Très probablement, ils seront à côté des cellules déjà remplies.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous les laissons pour l'avenir, des difficultés peuvent survenir, car les valeurs disponibles sont déjà peu nombreuses.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'approche du plus petit domaine fonctionne bien si toutes les tuiles sont également probables. </font><font style="vertical-align: inherit;">Mais si vous choisissez parmi une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distribution aléatoire pondérée</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous devez alors envisager autre chose. </font><font style="vertical-align: inherit;">Maxima recommande une «entropie minimale», c'est-à-dire choisir une cellule qui minimise:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>&amp;#x2014;</mo><mo>&amp;#x2211;</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.41ex" height="3.634ex" viewBox="0 -1024.6 10940.2 1564.8" role="img" focusable="false" style="vertical-align: -1.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-6E" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-74" x="1067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-72" x="1428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-6F" x="1880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-70" x="2365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-79" x="2869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMAIN-3D" x="3644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMAIN-2014" x="4422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJSZ2-2211" x="5589" y="0"></use><g transform="translate(7201,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-6C" x="8048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-6F" x="8347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-67" x="8832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMAIN-28" x="9313" y="0"></use><g transform="translate(9702,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMAIN-29" x="10550" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>—</mo><mo>∑</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">entropy = — \sum p_{i}log(p_{i})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci est une somme de tuiles dans le domaine où </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhiTnqpzV4fRULqpE-x1zaoKU99UDA#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">p_{i}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - probabilité pour cette tuile.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informatique efficace</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que je ne veuille pas entrer dans les détails, cependant, il y a deux optimisations qui me permettent d'augmenter tellement la vitesse qu'elles ne peuvent pas être ignorées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque notre seule règle est liée aux tuiles adjacentes, nous ne pouvons vérifier que les restrictions qui peuvent donner des résultats différents des précédents. Autrement dit, lors de la mise à jour d'une cellule, nous l'ajoutons à la file d'attente des cellules en attente d'une décision. Ensuite, nous supprimons une cellule de la file d'attente, en vérifiant à chaque fois ses cellules adjacentes. Si de tels contrôles conduisent au renouvellement d'autres cellules, ils tombent également dans la file d'attente. En répétant cette procédure jusqu'à ce que la file d'attente soit vide, nous nous assurons de vérifier toutes les restrictions. Mais nous ne les vérifions pas tant que le domaine d'au moins une cellule associée à ces restrictions ne change pas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, pour vérifier la contrainte d'adjacence, nous devons répondre à la question: «Étant donné les tuiles dans le domaine de la cellule A, quelles tuiles sont possibles dans le domaine de la cellule B si les cellules sont adjacentes?» </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, cette question est appelée le "support" de la cellule A. Pour une tuile "b" donnée dans le domaine B, il est facile de calculer les cycles pour les tuiles du domaine A. Si A a au moins une tuile qui peut être placée à côté de "b", alors "b" convient toujours, au moins pour la paire de tuiles en question. Si dans A il n'y a pas une telle tuile, alors vous ne pouvez pas mettre la tuile «b» du domaine B, et nous pouvons la jeter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les boucles facilitent l'implémentation de cela dans le code, mais fonctionneront extrêmement lentement. </font><font style="vertical-align: inherit;">Et si nous stockons des informations dans une structure de données supplémentaire, nous pouvons répondre rapidement à la question si nécessaire. </font><font style="vertical-align: inherit;">Les nouvelles données sont un grand tableau avec des entrées pour chaque côté de chaque cellule et chaque tuile. </font><font style="vertical-align: inherit;">Dans notre exemple, il y a 9 cellules, chacune avec 4 côtés et 4 types de tuiles. </font><font style="vertical-align: inherit;">Nous avons donc besoin de 9 * 4 * 4 enregistrements. </font><font style="vertical-align: inherit;">Nous enregistrerons les compteurs de support dans le tableau: pour chaque cellule / tuile / côté, nous comptons le nombre de tuiles dans le domaine de cellule adjacent qui peuvent être placées à côté de la tuile en question. </font><font style="vertical-align: inherit;">Si le compteur tombe à zéro, cette tuile ne peut pas être mise, car personne ne peut être adjacent à elle.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extensions d'algorithme</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le WFC étant basé sur une compréhension plus générale des problèmes contraints, il existe de nombreuses façons d'étendre l'algorithme en modifiant les contraintes utilisées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des changements évidents est que personne ne nous oblige à utiliser des cellules carrées. Le WFC fonctionne très bien sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les cellules hexagonales, en trois dimensions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des surfaces</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encore plus </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">inhabituelles</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98f/35a/0b9/98f35a0b9ccd9fd4fce689cd7f911d64.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/848/881/d32/848881d3216ac003a312c1fc8cfd56ea.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/497/0d2/706/4970d270636d7203d3e8e1e4bcb4befd.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez introduire des restrictions supplémentaires: corriger certaines tuiles ou créer des «modules» à partir de plusieurs cellules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'introduction de restrictions supplémentaires peut jouer un rôle très important d'un point de vue pratique. </font><font style="vertical-align: inherit;">Étant donné que le WFC ne limite que les carreaux adjacents, il génère rarement de grandes structures qui offrent un haut niveau d'homogénéité et un aspect inhabituel. </font><font style="vertical-align: inherit;">Cet algorithme fonctionne mieux lors du choix des tuiles, mais pour travailler avec certaines grandes structures, il est préférable d'utiliser une technique différente ou d'introduire d'autres restrictions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un autre article,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j'ai expliqué comment obtenir les meilleurs résultats du WFC.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chevauchement WFC</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des extensions intéressantes de l'algorithme est le WFC «à chevauchement». Dans les exemples ci-dessus, la principale limitation était liée aux paires de tuiles adjacentes. Cela suffit pour assurer la connexion des lignes et créer des structures simples comme des grottes, des salles, etc. Mais en même temps, beaucoup d'informations sont perdues. Si nous avons besoin, par exemple, que les carreaux rouges soient toujours situés à côté du bleu, mais qu'ils n'y aient jamais été adjacents, alors cela sera difficile à exprimer en termes de contiguïté uniquement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim a proposé le concept de chevauchement des WFC: nous remplaçons la contrainte d'adjacence par une nouvelle contrainte qui affecte plusieurs tuiles à la fois. Par exemple, de sorte qu'en sortie chaque groupe de 3 × 3 cellules correspond à un groupe 3 × 3 d'un échantillon de grille. Les motifs présents dans l'échantillon seront répétés encore et encore dans différentes variations à la sortie:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42d/72b/b76/42d72bb7631b24f33858756ade67fa55.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette restriction est beaucoup plus sensible que les restrictions de contiguïté «simples». </font><font style="vertical-align: inherit;">Et comme cela dépend d'un échantillon donné, il est très approprié pour résoudre certains types de tâches artistiques. </font><font style="vertical-align: inherit;">Jusqu'à présent, je n'ai rien trouvé d'aussi intéressant. </font><font style="vertical-align: inherit;">La raison en est peut-être qu'un tel algorithme est plus difficile à mettre en œuvre, ou qu'il fonctionne plus lentement, ou qu'il reproduit parfois trop bien l'échantillon d'origine, ce qui entraîne une perte de naturalité et de naturalité.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et après?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La résolution de problèmes avec des restrictions est un domaine de l'informatique vaste et en développement actif, et je ne l'ai abordé que. </font><font style="vertical-align: inherit;">WFC - comme tout autre algorithme de génération procédurale pour résoudre des problèmes contraints - est encore nouveau. </font><font style="vertical-align: inherit;">Je recommande de lire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r / proceduralgeneration</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@exutumno</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@osksta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour avoir une idée des cas d'utilisation récents. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez également lire mon </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article sur WFC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , expérimenter avec ma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliothèque opensource</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'outil Unity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">N'oubliez pas mes autres articles sur la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">génération procédurale</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497578/index.html">AMD s'engage à gagner une part significative du marché des datacenters</a></li>
<li><a href="../fr497580/index.html">La quarantaine dure est très très mauvaise</a></li>
<li><a href="../fr497582/index.html">Habr prend la première place dans le classement des droits numériques des utilisateurs</a></li>
<li><a href="../fr497584/index.html">Auto quantifié: comment Madrobots a introduit les balances intelligentes Picooc en Russie</a></li>
<li><a href="../fr497588/index.html">Spring Security - Un exemple d'application Web d'autorisation OAuth2 via BitBucket</a></li>
<li><a href="../fr497594/index.html">Stockage de données externes: de l'époque d'IBM 1311 à nos jours. Partie 1</a></li>
<li><a href="../fr497596/index.html">Vive PHP</a></li>
<li><a href="../fr497602/index.html">Vous considérez-vous comme signataire? Qui plaisantez-vous</a></li>
<li><a href="../fr497606/index.html">Système d'arrosage automatique du jardin pour Home Assistant, ESP8266 et MiFlora</a></li>
<li><a href="../fr497608/index.html">Comment les systèmes d'analyse du trafic détectent les tactiques des pirates par MITRE ATT & CK, partie 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>