<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏾 👩‍👩‍👦 👨🏼‍🚒 GOSTに従って暗号化：トラフィックの動的ルーティングの設定に関するメモ 🔓 🔢 🎗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="法律に従って保護の対象となる個人データやその他の機密情報をネットワーク経由で送信または受信する場合、GOSTに従って暗号化を使用する必要があります。本日は、S-Terra暗号ゲートウェイ（KS）に基づく暗号化を、あるお客様にどのように導入したかをお伝えします。この話は、情報セキュリティの専門家だけで...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>GOSTに従って暗号化：トラフィックの動的ルーティングの設定に関するメモ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/471470/"><img src="https://habrastorage.org/webt/v-/53/qf/v-53qfuqlx4ywc8cf8xfp2wlgt8.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
法律に従って保護の対象となる個人データやその他の機密情報をネットワーク経由で送信または受信する場合、GOSTに従って暗号化を使用する必要があります。</font><font style="vertical-align: inherit;">本日は、S-Terra暗号ゲートウェイ（KS）に基づく暗号化を、あるお客様にどのように導入したかをお伝えします。</font><font style="vertical-align: inherit;">この話は、情報セキュリティの専門家だけでなく、エンジニア、デザイナー、建築家にとっても興味深いものです。</font><font style="vertical-align: inherit;">この投稿では、技術的な構成のニュアンスについては詳しく説明しません。基本的なセットアップの要点について詳しく説明します。</font><font style="vertical-align: inherit;">S-Terra KSのベースとなっているLinux OSデーモンの構成に関する膨大な量のドキュメントがインターネットから無料で入手できます。</font><font style="vertical-align: inherit;">S-Terra独自のソフトウェア構成ドキュメントは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メーカーの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ポータルで</font></a><font style="vertical-align: inherit;">も公開され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ています</font></a><font style="vertical-align: inherit;">。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトについて一言 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
お客様のネットワークトポロジは典型的でした-センターとブランチ間のフルメッシュ。全8サイトのサイト間で情報交換チャネルの暗号化を導入する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、このようなプロジェクトではすべてが静的です。暗号化ゲートウェイ（KS）では、静的ルートがサイトのローカルエリアネットワークに設定され、暗号化用のIPアドレス（ACL）のリストが書き込まれます。ただし、この場合、サイトは集中管理されておらず、ローカルネットワーク内で何かが発生する可能性があります。ネットワークはあらゆる方法で追加、削除、変更できます。サイトのローカルネットワークのアドレスを変更するときにKSへのルーティングとACLの再構成を回避するために、GREトンネリングと動的ルーティングOSPFを使用することが決定されました。これには、サイトのネットワークコアレベルのすべてのKSとほとんどのルーターが含まれます（一部のサイトでは、インフラストラクチャ管理者が優先します）カーネルルーターでKSの方向にSNATを使用します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GREトンネリングは2つの問題を解決しました：</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ACLで、外部KSインターフェイスのIPアドレスを暗号化するために使用し</font><b><font style="vertical-align: inherit;">ます。</font></b><font style="vertical-align: inherit;">外部KSインターフェイスでは、他のサイトに送信されるすべてのトラフィックがカプセル化されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> KS間のptpトンネルを編成します。これにより、動的ルーティングを構成できます（この場合、プロバイダーMPLS L3VPNはサイト間で編成されます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントは、暗号化の実装をサービスとして注文しました。</font><font style="vertical-align: inherit;">それ以外の場合は、暗号化ゲートウェイをサポートしたり、組織を外部委託したりするだけでなく、暗号化証明書のライフサイクルを個別に監視し、期限内に更新して新しい証明書をインストールする必要があります。</font></font><br>
<img src="https://habrastorage.org/webt/ho/lc/ch/holcch4mtnk2skxc5_atydslidu.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、メモ自体-私たちはどのようにそして何を設定しましたか</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KIIサブジェクトノート：暗号ゲートウェイを構成します </font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本的なネットワーク設定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、新しいキャッシュを起動して管理コンソールに入ります。組み込みの管理者のパスワードを変更することから始め</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます-change user password administrator</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">。次に</font><font style="vertical-align: inherit;">、ライセンスデータが入力され、乱数センサー（DSN）が初期化されるプロセスで</font><font style="vertical-align: inherit;">、初期化手順（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期化</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を実行する必要</font><font style="vertical-align: inherit;">があります。</font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意！</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S-Terra KSが初期化されると、Security Gatewayインターフェースがパケットを渡さないセキュリティポリシーが確立されます。独自のポリシーを作成するか、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">run csconf_mgr activateコマンド</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して</font><font style="vertical-align: inherit;">、定義済みのアクセス許可ポリシーをアクティブに</font><font style="vertical-align: inherit;">する必要があります</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、外部インターフェイスと内部インターフェイスのアドレス指定、およびデフォルトルートを設定する必要があります。キャッシュのネットワーク構成を使用して、Ciscoのようなコンソールから暗号化を構成することをお勧めします。このコンソールは、Cisco IOSコマンドと同様のコマンドを入力するためのものです。次に、Ciscoのようなコンソールを使用して作成された構成は、OSデーモンが動作する対応する構成ファイルに変換されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configure</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを</font><b><font style="vertical-align: inherit;">使用する</font></b><font style="vertical-align: inherit;">と、管理コンソールからシスコのようなコンソールに移動でき</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み込みユーザーcsconsのパスワードを変更して有効にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&gt; enable </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パスワード：csp（事前定義）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#configure terminal </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#username cscons特権15シークレット0＃</font><font style="vertical-align: inherit;">有効</font><font style="vertical-align: inherit;">シークレット0基本的なネットワーク構成をセットアップします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#interface GigabitEthernet0 / 0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#ipアドレス10.111.21.3 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#no shutdown </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#interface GigabitEthernet0 / 1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#ipアドレス192.168.2.5 255.255.255.252 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#no shutdown </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#ip route 0.0.0.0 0.0.0.0 10.111.21.254</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GRE</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シスコのようなコンソールを終了し、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを使用してdebianシェルに移動し</font><font style="vertical-align: inherit;">ます。</font><b><font style="vertical-align: inherit;">passwd</font></b><font style="vertical-align: inherit;">コマンドを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">rootユーザーの</font></b><font style="vertical-align: inherit;">独自のパスワードを設定します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
各サイトの個別のトンネルは、各KShで構成されます。トンネルインターフェースは、</font><b><font style="vertical-align: inherit;">/ etc / network / interfaces</font></b><font style="vertical-align: inherit;">ファイルで設定されます</font><font style="vertical-align: inherit;">。 iproute2の定義済みセットの一部であるIPトンネルユーティリティは、インターフェイス自体の作成を担当します。インターフェースを作成するコマンドは、pre-upオプションに書き込まれます。</font><font style="vertical-align: inherit;">
トンネルインターフェースの設定例：</font><font style="vertical-align: inherit;">
auto site1 </font><font style="vertical-align: inherit;">
iface site1 inet static </font><font style="vertical-align: inherit;">
address 192.168.1.4 </font><font style="vertical-align: inherit;">
netmask 255.255.255.254</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pre-up ip tunnel add site1 mode gre local 10.111.21.3 remote 10.111.22.3 key hfLYEg ^ vCh6p </font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意してください！</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トンネルインターフェイスの設定は、セクション</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
### netifcfg-begin ### </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
***** </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
### netifcfg-end ###の</font><font style="vertical-align: inherit;">外に配置する必要があることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それ以外の場合、これらの設定は、Cisco-を介して物理インターフェイスのネットワーク設定を変更すると消去されますコンソールのように。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的ルーティング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S-Terraでは、動的ルーティングはQuaggaソフトウェアパッケージを使用して実装されます。 OSPFを構成するには、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zebra</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ospfdデーモン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を有効にして構成する必要があり</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。 zebraデーモンは、ルーティングデーモンとOS間の相互作用を担当します。 ospfdデーモンは、その名前が示すように、OSPFプロトコルの実装を担当します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OSPFは、デーモンコンソールを介して、または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/quagga/ospfd.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成ファイルを介して直接構成されます</font><font style="vertical-align: inherit;">。動的ルーティングに関係するすべての物理インターフェースとトンネルインターフェースがファイルに追加され、アナウンスを受け取り、アナウンスを受信するネットワークがアナウンスされます。</font><b><font style="vertical-align: inherit;">ospfd.conf</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
に追加する設定例</font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">
インターフェースeth0 </font><font style="vertical-align: inherit;">
！</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェースeth1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェースsite1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
interface site2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
router ospf </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ospf router-id 192.168.2.21 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 network </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 192.168.1.4/31 area 0.0.0.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 network 192.168.2.4/30 area 0.0.0.0 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、アドレスは192.168.1.xです/ 31はサイト間のptpトンネルネットワーク用に予約され、192.168.2.x / 30アドレスはKSとカーネルルーター間のトランジットネットワーク用に使用されます。</font></font><br>
<br>
<u><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意！</font></font></b></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大規模なインストールでルーティングテーブルを削減するには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、再配布なしの再接続</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続済みの再割り当てルートマップ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンストラクトを使用して、トランジットネットワーク自体のアナウンスをフィルタリングできます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デーモンを設定したら、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / quagga / daemons</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でデーモンの起動ステータスを変更する必要があり</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">オプション</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zebra</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ospfd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、yesに対する修正は</font><font style="vertical-align: inherit;">あり</font><font style="vertical-align: inherit;">ません。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quagga</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デーモンを実行し、</font><b><font style="vertical-align: inherit;">update-rc.d quagga enable</font></b><font style="vertical-align: inherit;">コマンドでキャッシュを開始するときに自動実行を設定します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GREトンネルとOSPFが正しく構成されている場合、他のサイトのネットワークへのルートがKSルーターとカーネルルーターに表示され、ローカルネットワーク間のネットワーク接続が確立されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信されるトラフィックを暗号化します </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、サイト間で暗号化する場合、通常、トラフィックが暗号化されるIPアドレス範囲（ACL）を指定します。送信元アドレスと宛先アドレスがこれらの範囲に該当する場合、それらの間のトラフィックは暗号化されます。ただし、このプロジェクトでは、構造は動的であり、アドレスは変更される可能性があります。すでにGREトンネリングを構成しているので、トラフィックの暗号化の送信元アドレスと宛先アドレスとして外部KSアドレスを指定できます。これは、暗号化のためにトラフィックがGREプロトコルによってすでにカプセル化されているためです。つまり、あるサイトのローカルエリアネットワークから他のサイトによってアナウンスされたネットワークにキャッシュに入るすべてのものは暗号化されます。そして、すでに各サイト内で転送を実行できます。したがって、ローカルネットワークが変更されても、管理者はアナウンスを変更するだけで済みます。彼のネットワークからKSの方向に進み、他のサイトでも利用できるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S-Terra KSでの暗号化は、IPSecプロトコルを使用して実行されます。 GOST R 34.12-2015に準拠したグラスホッパーアルゴリズムを使用しており、古いバージョンとの互換性のために、GOST 28147-89を使用できます。技術的には、事前定義されたキー（PSK）と証明書の両方で認証を実行できます。それにもかかわらず、産業運用では、GOST R 34.10-2012に従って発行された証明書を使用する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書、コンテナ、CRLの操作は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cert_mgr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティを使用して</font><b><font style="vertical-align: inherit;">実行され</font></b><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。まず、</font><b><font style="vertical-align: inherit;">cert_mgr create</font></b><font style="vertical-align: inherit;">コマンドを使用し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秘密鍵コンテナと証明書リクエストを作成する必要があります。これらは証明書管理センターに送信されます。証明書を受け取っ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たら</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">cert_mgr import</font></b><font style="vertical-align: inherit;">コマンドを使用して、CAおよびCRLのルート証明書（使用する場合）とともに</font><b><font style="vertical-align: inherit;">インポート</font></b><font style="vertical-align: inherit;">する必要があります</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cert_mgr show</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを使用して、すべての証明書とCRLがインストールされていることを</font><b><font style="vertical-align: inherit;">確認</font></b><font style="vertical-align: inherit;">でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書を正常にインストールした後、Ciscoのようなコンソールに移動してIPSecを構成します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IKEポリシーを作成します。これは、承認のためにパートナーに提供される、作成されたセキュアチャネルの必要なアルゴリズムとパラメーターを示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#crypto isakmp policy 1000 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#encr gost341215k </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#hash gost341112-512-tc26 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#authentication sign</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#group vko2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#lifetime 360​​0 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このポリシーは、IPSecの最初のフェーズを構築するときに適用されます。最初のフェーズが成功裏に完了するのは、SA（Security Association）の設立です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、暗号化用の送信元および宛先IPアドレス（ACL）のリストを定義し、トランスフォームセットを形成し、暗号マップ（暗号マップ）を作成して、CABの外部インターフェイスにバインドする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACLを設定し</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">#ip access-list extended site1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#permit gre host 10.111.21.3 host 10.111.22.3一連</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の変換（最初のフェーズと同様に、</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
挿入</font><font style="vertical-align: inherit;">モードを使用してGrasshopper暗号化アルゴリズムを使用します）：</font><font style="vertical-align: inherit;">#crypto ipsec transform -set GOST esp-gost341215k-mac</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリプト</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マップを</font><font style="vertical-align: inherit;">作成し、ACL、トランスフォームセット、および</font><font style="vertical-align: inherit;">ピア</font><font style="vertical-align: inherit;">アドレスを指定します。</font><font style="vertical-align: inherit;">#crypto map MAIN 100 ipsec-isakmp </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#match address site1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#set transform-set GOST </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#set peer 10.111.22.3 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリプト</font><font style="vertical-align: inherit;">マップ</font><font style="vertical-align: inherit;">を外部</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CW </font><font style="vertical-align: inherit;">インターフェイスに</font><font style="vertical-align: inherit;">バインドし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;"># </font><font style="vertical-align: inherit;">interface </font><font style="vertical-align: inherit;">GigabitEthernet0 / 0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#ip address 10.111.21.3 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#crypto map MAIN </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他のサイトとのチャネルを暗号化するには、ACLと暗号カードを作成する手順を繰り返し、ACL名、IPアドレス、および暗号カード番号を変更する必要があります。</font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意！</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRL証明書の検証を使用しない場合、これを明示的に指定する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#crypto pki trustpoint s-terra_technological_trustpoint </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font><font style="vertical-align: inherit;">revocation </font><font style="vertical-align: inherit;">-check none</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この設定では完全と見なすことができます。</font><font style="vertical-align: inherit;">Ciscoのようなコンソールコマンドの出力は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crypto isakmp sa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">show crypto ipsec sa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、IPSecの構築された第1フェーズと第2フェーズを反映しているはずです。</font><font style="vertical-align: inherit;">同じ情報は</font><font style="vertical-align: inherit;">、debianシェルから実行され</font><font style="vertical-align: inherit;">た</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sa_mgr show</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを使用して取得できます</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cert_mgr show</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドの出力には、</font><font style="vertical-align: inherit;">リモートサイトの証明書</font><b><font style="vertical-align: inherit;">が表示され</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">このような証明書のステータスは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リモートになり</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">トンネルが構築されていない場合は、/ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> log / </font><b><font style="vertical-align: inherit;">cspvpngate.log</font></b><font style="vertical-align: inherit;">ファイルに保存されているVPNサービスログを調べる必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ログファイルとその内容の説明の完全なリストは、ドキュメントに記載されています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムの「健康」を監視する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S-Terra KSは、標準のsnmpdデーモンを使用して監視します。</font><font style="vertical-align: inherit;">標準のLinuxパラメータに加えて、追加設定なしのS-Terraは、IPSecトンネルのステータスを監視するために使用するCISCO-IPSEC-FLOW-MONITOR-MIBに従ってIPSecトンネルの出力をサポートします。</font><font style="vertical-align: inherit;">カスタムOIDの機能もサポートされており、スクリプトの結果を値として提供します。</font><font style="vertical-align: inherit;">この機能により、証明書の有効期限を追跡できます。</font><font style="vertical-align: inherit;">作成されたスクリプトは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cert_mgr show</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドの出力を解析し、</font><font style="vertical-align: inherit;">結果として、ローカル証明書とルート証明書の有効期限が切れるまでの日数を示します。</font><font style="vertical-align: inherit;">この手法は、多数のCABGを管理する場合に不可欠です。</font></font><br>
<img src="https://habrastorage.org/webt/ho/gl/py/hoglpynhcvdwk7o5x5hpvbtycuo.jpeg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このような暗号化の仕組みは何ですか</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のすべての機能は、「そのまま」のKS S-Terraでサポートされています。つまり、暗号化ゲートウェイの認証と情報システム全体の認証に影響を与える可能性のある追加のモジュールをインストールする必要はありませんでした。サイト間のチャネルは、インターネット経由でも、どのチャネルでもかまいません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内部インフラストラクチャを変更するときに暗号化ゲートウェイを再構成する必要がないため、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムはサービスとして機能</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、顧客にとって非常に便利です。サービス（クライアントとサーバー）を任意のアドレスに配置でき、すべての変更は暗号化装置間で動的に転送されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、オーバーヘッドによる暗号化はデータ転送速度に影響しますが、それほど影響はありません。チャネルの帯域幅は最大5〜10％減少する可能性があります。</font><font style="vertical-align: inherit;">同時に、このテクノロジーはテストされ、衛星チャネルでも良好な結果を示しました。衛星チャネルは、不安定で帯域幅が狭いためです。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rostelecom Solarの2番目の管理ラインのエンジニアであるIgor Vinokhodov</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja471452/index.html">人工知能が地震予測につながる</a></li>
<li><a href="../ja471458/index.html">線形回帰と勾配降下</a></li>
<li><a href="../ja471462/index.html">ニジニノヴゴロドのJava開発者学校</a></li>
<li><a href="../ja471464/index.html">自分の手で子供のためのミニチュア電気デザイナー</a></li>
<li><a href="../ja471468/index.html">ハッカーをハザードで分類する問題</a></li>
<li><a href="../ja471472/index.html">Security Week 42：ハードウェアバックドア、Intel NUCの脆弱性</a></li>
<li><a href="../ja471474/index.html">ライフハック-ゲストブックのあるウェブサイトをクラウド上で無料で作成してホストする</a></li>
<li><a href="../ja471480/index.html">効果的な製品チームを作成するには？</a></li>
<li><a href="../ja471482/index.html">CLRium＃6：並行性と並列性。2日間：プロセッサーから非同期/待機まで</a></li>
<li><a href="../ja471484/index.html">フットボール転送のモデル：より深く掘り下げる</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>