<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚅 🤘🏽 🌡️ Detektor COVID-19 otomatis dari Gambar Fluorografi 🕠 🤽 ✌🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam panduan ini, Anda akan belajar cara mendeteksi COVID-19 secara otomatis dalam dataset yang dipilih secara khusus menggunakan Keras, TensorFlow, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detektor COVID-19 otomatis dari Gambar Fluorografi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam panduan ini, Anda akan belajar cara mendeteksi COVID-19 secara otomatis dalam dataset yang dipilih secara khusus menggunakan Keras, TensorFlow, dan pembelajaran mendalam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti kebanyakan orang di dunia saat ini, saya dengan tulus prihatin dengan COVID-19. </font><font style="vertical-align: inherit;">Saya perhatikan bahwa saya mulai terus-menerus menganalisis kesehatan pribadi saya dan mencurigai bahwa saya sudah terinfeksi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semakin saya khawatir tentang hal ini, semakin banyak kombinasi menyakitkan dari gejala nyata dengan hipokondria memanifestasikan dirinya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya bangun di pagi hari, saya merasa sedikit kewalahan.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika saya bangun dari tempat tidur, saya sudah mengalami kebocoran dari hidung saya (walaupun </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sekarang diketahui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bahwa pilek bukan merupakan gejala COVID-19).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika dia sampai di kamar mandi untuk mengambil serbet, dia juga batuk.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Awalnya saya tidak terlalu mementingkan ini - saya alergi terhadap serbuk sari, dan karena cuaca hangat di pantai timur, musim semi datang awal tahun ini. Kemungkinan besar, alergi saya baru saja pecah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi gejalanya tidak membaik sepanjang hari. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan di sini saya duduk di sini, menulis manual ini dengan termometer di mulut saya; dan melihat ke bawah menunjukkan 37,4 ° C. Suhunya lebih tinggi dari biasanya 36,3 ° C. Semuanya di atas 37,2 ° C, saya sudah mempertimbangkan sedikit demam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Batuk dan sedikit demam? Bisa jadi COVID-19 ... atau hanya alergi saya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mustahil untuk mengetahuinya tanpa ujian, dan justru "ketidaktahuan" inilah yang membuat situasi ini begitu berbahaya bagi keseimbangan mental. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi orang tidak ada yang lebih mengerikan daripada yang tidak diketahui.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari semua ketakutan, saya mencoba untuk menyingkirkan mereka dengan cara yang rasional. Saya berusia lebih dari tiga puluh tahun, saya dalam kondisi sangat baik, sistem kekebalan tubuh saya sangat kuat. Saya akan pergi ke karantina (untuk berjaga-jaga), saya akan beristirahat dan pulih secara normal. COVID-19 tidak membuat saya takut dalam hal </font><font style="vertical-align: inherit;">kesehatan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pribadi saya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (setidaknya saya terus mengatakan ini pada diri saya sendiri). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, saya mengkhawatirkan kerabat saya yang sudah lanjut usia, termasuk mereka yang memiliki penyakit kronis, dan mereka yang berada di panti jompo atau rumah sakit. Mereka rentan, dan akan sangat menyedihkan jika kita kehilangan mereka karena infeksi ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar tidak duduk diam dan tidak menyerah pada kelemahan (baik itu alergi, COVID-19 atau hanya kecemasan), saya memutuskan untuk melakukan apa yang saya lakukan yang terbaik -</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melayani seluruh komunitas visi mesin dan pembelajaran mendalam dengan menulis kode, melakukan eksperimen, dan mengajar orang lain bagaimana menggunakan visi komputer dan pembelajaran mendalam dalam aplikasi dunia nyata yang praktis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, jujur ​​saja, ini bukan artikel paling ilmiah yang pernah saya tulis. </font><font style="vertical-align: inherit;">Padahal, jauh dari yang paling. </font><font style="vertical-align: inherit;">Metode dan set data yang digunakan tidak layak dipublikasikan. </font><font style="vertical-align: inherit;">Tetapi mereka bisa menjadi titik awal bagi mereka yang ingin membantu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi saya ingin melakukan segalanya dengan kekuatan saya. </font><font style="vertical-align: inherit;">Artikel ini hanyalah cara saya untuk mengatasi masa-masa sulit secara mental dan pada saat yang sama membantu orang lain dalam situasi yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya harap kamu mengerti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pelajaran hari ini kita akan melakukan hal berikut:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan mengumpulkan satu set data terbuka dari fluorogram pasien dengan tes positif untuk COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengumpulkan sejumlah fluorogram pasien sehat.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan melatih jaringan saraf convolutional untuk mendeteksi COVID-19 secara otomatis pada gambar dari set yang dibuat.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan mengevaluasi hasil yang diperoleh dari sudut pandang pendidikan.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penafian: Saya sudah mengisyaratkan, tapi saya akan mengatakannya terus terang. </font><font style="vertical-align: inherit;">Metode dan teknik dalam artikel ini hanya untuk tujuan pendidikan. </font><font style="vertical-align: inherit;">Ini bukan studi ilmiah yang nyata, dan itu tidak akan dipublikasikan dalam jurnal. </font><font style="vertical-align: inherit;">Artikel ini ditujukan untuk pembaca yang tertarik pada (1) visi komputer / pembelajaran mendalam dan ingin belajar menggunakan metode praktis, dan (2) peduli tentang peristiwa terkini. </font><font style="vertical-align: inherit;">Saya mohon Anda untuk berhubungan dengan ini dengan cara ini.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19 pada fluorogram</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian pertama, kita membahas bagaimana COVID-19 dapat dideteksi pada foto thoraks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian pertimbangkan kumpulan data kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu saya akan menunjukkan kepada Anda bagaimana melatih model pembelajaran mendalam menggunakan Keras dan TensorFlow untuk mendefinisikan COVID-19 dalam dataset gambar kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugas saya adalah untuk menginspirasi Anda dan menunjukkan bahwa studi tentang visi komputer / pembelajaran mendalam, dan kemudian menerapkan pengetahuan ini di bidang medis dapat memiliki dampak besar pada dunia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sederhananya: Anda tidak perlu gelar medis untuk berkontribusi dalam pengobatan. Spesialis pembelajaran mendalam yang bekerja erat dengan dokter dan penyedia layanan kesehatan dapat memecahkan masalah yang kompleks, menyelamatkan nyawa, dan membuat dunia menjadi tempat yang lebih baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya harap panduan ini menginspirasi Anda untuk melakukan hal itu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi dengan semua ini dikatakan, jurnal ilmiah dan sistem penilaian pakar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penuh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan materi dengan model peramalan COVID-19 yang kualitasnya meragukan. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tolong jangan mengambil kode / model dari artikel ini dan jangan mengirimnya ke jurnal atau meletakkannya di domain publik di situs ilmiah - Anda hanya akan menambahkan beberapa kebisingan.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Selain itu, jika Anda berniat menggunakan artikel ini (atau artikel COVID-19 lainnya dari Internet) dalam riset Anda sendiri, pastikan untuk memeriksa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aturan TRIPOD untuk membuat model pelaporan ramalan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang mungkin Anda ketahui, penggunaan AI dalam pengobatan mengarah pada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konsekuensi yang sangat nyata</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Publikasikan atau gunakan model seperti itu hanya setelah berkonsultasi dengan ahli medis.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 1. Contoh fluorogram dari pasien dengan tes positif COVID-19. Menggunakan Keras dan TensorFlow dalam gambar seperti itu, adalah mungkin untuk melatih classifier untuk mendeteksi COVID-19. Tes COVID-19</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
saat ini sulit ditemukan -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mereka tidak cukup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan mereka tidak dapat dibuat cukup cepat, yang menyebabkan panik.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika ada kepanikan, beberapa orang keji mengambil keuntungan dari ini dan</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menjual alat tes palsu COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menemukan korban di jejaring sosial dan kurir instan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengingat bahwa jumlah kit uji COVID-19 terbatas, Anda harus mengandalkan metode diagnostik lainnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mendiagnosis pneumonia, pneumonia, abses, dan / atau pembesaran kelenjar getah bening, dokter sering mengandalkan rontgen dada (biasa disebut fluorogram). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19 menyerang epitel saluran pernapasan, dan sinar-X membantu memeriksa kondisi paru-paru pasien. Mesin X-ray dipasang di sebagian besar rumah sakit, jadi masuk akal untuk menggunakan fluorografi untuk menguji COVID-19 tanpa alat tes khusus. Kerugiannya adalah bahwa analisis semacam itu membutuhkan spesialis dalam radiologi dan membutuhkan waktu yang lama. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oleh karena itu, pengembangan sistem otomatis akan sangat berharga untuk menghemat waktu berharga para profesional medis di seluruh dunia. </font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Beberapa publikasi terbaru menunjukkan bahwa computed tomography lebih baik untuk mendiagnosis COVID-19, tetapi dalam pelajaran ini kami hanya bekerja dengan fluorogram.</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Himpunan data</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">2. Di sebelah kiri adalah sampel positif (dari pasien yang terinfeksi), dan di sebelah kanan adalah negatif. </font><font style="vertical-align: inherit;">Gambar-gambar ini digunakan untuk melatih model untuk secara otomatis memprediksi keberadaan suatu penyakit.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kumpulan data kami disusun oleh</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seorang mahasiswa pascasarjana di University of Montreal. </font><font style="vertical-align: inherit;">Pada awal Maret, ia mulai mengumpulkan fluorogram pasien dengan COVID-19, MERS, SARS, dan SARS dan menerbitkannya di</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repositori di GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita perlu mengunduh file dari repositori</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan memilih baris dari tempat yang ditunjukkan</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil positif pada COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenis paru-paru 'posterior-anterior' (PA). </font><font style="vertical-align: inherit;">Sejauh yang saya mengerti, ini adalah jenis gambar yang digunakan dalam gambar "sehat".</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebanyak 25 fluorogram ditemukan dengan kasus positif COVID-19 (Gbr. 2, kiri). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pasien sehat, saya menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataset Cuggle (pneumonia)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan memilih 25 gambar pasien sehat (Gbr. 2, kanan). </font><font style="vertical-align: inherit;">Kumpulan data ini memiliki sejumlah masalah, yaitu label bising / salah, tetapi akan dilakukan untuk pemeriksaan konseptual detektor otomatis COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Struktur proyek</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian Unduhan situs web saya, Anda dapat memasukkan alamat email dan mencari tautan ke arsip dengan kode, skrip, dan file lain untuk proyek ini. </font><font style="vertical-align: inherit;">Ekstrak file dan Anda akan melihat struktur direktori:</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [25 entries]<font></font>
│   └── normal [25 entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fluorogram berada di direktori di </font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mana dua kelas data dibagi menjadi direktori </font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedua skrip disajikan untuk membangun kumpulan data, tetapi kami tidak akan mempertimbangkannya hari ini. </font><font style="vertical-align: inherit;">Sebagai gantinya, pertimbangkan skrip </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang mengajarkan detektor COVID-19 kami.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penerapan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita beralih ke pengaturan jaringan saraf convolutional. </font><font style="vertical-align: inherit;">Buka file </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan rekatkan kode berikut:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip ini menggunakan sejumlah perpustakaan pembelajaran dalam dari TensorFlow 2.0 dan Keras. </font><font style="vertical-align: inherit;">Selain itu, kami menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pustaka Python standar untuk pembelajaran mesin, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk grafik, dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk memuat dan memproses gambar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menginstal TensorFlow 2.0 (termasuk pustaka scikit-learn, OpenCV, dan matplotlib) yang sesuai, cukup ikuti instruksi saya untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kita akan menganalisis argumen baris perintah dan menginisialisasi hyperparameters:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tiga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumen baris perintah</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: path ke dataset input</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Jalur opsional ke jadwal keluar untuk riwayat belajar Anda. </font><font style="vertical-align: inherit;">Kecuali ditentukan lain, standarnya adalah</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: jalur opsional ke model keluaran; </font><font style="vertical-align: inherit;">standar</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris berikutnya menginisialisasi kecepatan belajar awal, jumlah era, dan hiperparameter ukuran paket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kami siap untuk mengunduh dan memproses fluorograms:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memuat data, kami menangkap semua jalur ke gambar di katalog </font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kemudian untuk masing-masing </font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengambil label kelas ( </font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">dari jalur </font><font style="vertical-align: inherit;">.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memuat </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan melakukan pra-proses, mengubahnya menjadi RGB dan mengubah ukuran menjadi 224 × 224 piksel, sehingga siap untuk jaringan saraf.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memperbarui daftar </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian skala intensitas piksel ke kisaran [0, 1] dan konversikan data dan label ke format array NumPy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami melakukan pengkodean langsung </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan membagi data menjadi set untuk pelatihan / pengujian:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengkodean langsung berarti bahwa data dikonversi ke dalam format berikut:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap label yang dikodekan terdiri dari array dengan dua elemen: 'panas' (1) atau 'tidak' (0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian baris berikut memisahkan data kami, menyisakan 80% untuk pelatihan dan 20% untuk pengujian. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memastikan model digeneralisasi, kami melakukan augmentasi data dengan mengatur gambar untuk secara acak memutar 15 ° searah jarum jam atau berlawanan arah jarum jam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tiga baris terakhir menginisialisasi objek generator augmentasi data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang inisialisasi model VGGNet kami dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sempurnakan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dua baris pertama membuat instance dari jaringan VGG16 dengan bobot yang sebelumnya dilatih di ImageNet tanpa menyentuh lapisan yang terhubung penuh (FC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kami membangun layer baru yang terhubung sepenuhnya, terdiri dari lapisan </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan menambahkannya di atas VGG16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kami membekukan bobot </font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk VGG16, jadi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lapisan FC yang </font><font style="vertical-align: inherit;">akan dilatih </font><font style="vertical-align: inherit;">. Ini menyelesaikan pengaturan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kami siap untuk menyusun dan melatih model pembelajaran mendalam kami untuk COVID-19:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris pertama mengkompilasi jaringan saraf dengan opsi untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengurangi kecepatan belajar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan pengoptimal </font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mengingat bahwa ini adalah masalah dua kelas, kami menggunakan loss </font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daripada cross entropy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memulai proses pembelajaran, kami memanggil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">metode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">dalam Keras</font></a><font style="vertical-align: inherit;"> , meneruskan fluorogram melalui objek augmentasi data kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengevaluasi model:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengevaluasi, pertama-tama kita membuat prakiraan pada set uji, mempertahankan indeks prakiraan. </font><font style="vertical-align: inherit;">Kemudian kami membuat dan menampilkan laporan klasifikasi menggunakan scikit-learn, di mana ada fungsi bantu seperti itu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami menghitung matriks ketidakakuratan untuk evaluasi statistik lebih lanjut:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita lakukan hal berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menghasilkan matriks ketidakakuratan.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan bantuannya, kami menghitung akurasi, sensitivitas, dan spesifisitas dengan mencetak semua metrik ini.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pengujian mandiri, kami membuat grafik dengan riwayat ketepatan dan kerugian pelatihan, menghasilkannya ke file grafik:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, simpan model classifier </font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke disk:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelatihan pendeteksi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah mengunduh semua file dari arsip dengan sumber dan skrip yang disebutkan di atas, buka konsol dan jalankan perintah berikut untuk melatih detektor:</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagnosis otomatis COVID-19 sesuai dengan hasil fluorografi</font></font></h2><br>
<i><b>  :</b>      ,  «»   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang dapat dilihat dari hasil di atas, detektor otomatis kami memiliki akurasi sekitar 90-92% pada set sampel yang ada. </font><font style="vertical-align: inherit;">Peringkat ini hanya didasarkan pada analisis gambar. </font><font style="vertical-align: inherit;">Selama pelatihan, tidak ada lagi data yang digunakan, termasuk lokasi geografis, kepadatan penduduk, dll </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Sensitivitasnya adalah 100%, dan spesifisitasnya adalah 80%, yang berarti:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pasien yang terinfeksi benar-benar diakui dalam 100% kasus.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pasien sehat diakui sehat dengan probabilitas 80%.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang ditunjukkan grafik riwayat pelatihan, jaringan kami tidak terlalu terlatih, meskipun </font><font style="vertical-align: inherit;">kumpulan data </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sangat terbatas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemampuan untuk mengenali COVID-19 dengan akurasi absolut sangat bagus, meskipun tingkat positif palsu sedikit mengkhawatirkan, karena banyak orang sehat akan dikirim ke karantina dengan pasien yang benar-benar terinfeksi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menyeimbangkan sensitivitas dan spesifisitas sangat sulit ketika datang ke aplikasi medis, terutama dalam kasus penyakit menular. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika datang ke visi komputer dan pelatihan mendalam dalam bidang kedokteran, Anda harus selalu ingat bahwa model prediksi kami dapat memiliki konsekuensi yang sangat nyata - diagnosis yang terlewatkan dapat menghabiskan biaya hidup.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekali lagi, hasil ini dikumpulkan hanya untuk tujuan pendidikan. </font><font style="vertical-align: inherit;">Artikel ini dan hasil yang menyertainya tidak dimaksudkan untuk publikasi dalam jurnal ilmiah dan tidak mematuhi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aturan TRIPOD untuk pembuatan model pelaporan perkiraan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keterbatasan, peningkatan, dan pekerjaan di masa depan</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 4. Saat ini, spesialis kecerdasan buatan (AI) dan spesialis pembelajaran dalam menderita dari kurangnya data berkualitas untuk pelatihan efektif sistem deteksi otomatis COVID-19 pada gambar ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumber gambar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Salah satu keterbatasan utama untuk menciptakan sistem tersebut adalah data. Kami tidak memiliki cukup data (andal) untuk melatih detektor COVID-19. Rumah sakit penuh sesak dengan pasien COVID-19, tetapi mengingat hak dan privasi mereka, menjadi</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semakin sulit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengumpulkan set gambar medis berkualitas secara tepat waktu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya kira dalam 12-18 bulan ke depan masalah akan terpecahkan, tetapi untuk saat ini kami puas dengan apa yang kami miliki. Saya melakukan yang terbaik (mengingat kondisi mental dan fisik saya saat ini) untuk menyusun panduan bagi mereka yang tertarik menggunakan visi komputer dan pembelajaran mendalam dalam memerangi COVID-19, dengan mempertimbangkan keterbatasan waktu dan sumber daya. Tetapi saya harus mengingatkan Anda bahwa saya bukan ahli medis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Detektor COVID-19 sejati harus menjalani pengujian ketat oleh para profesional medis terlatih yang bekerja bersama-sama dengan praktisi pembelajaran mendalam yang berpengalaman. Metode yang dijelaskan di sini, tentu saja, tidak cocok untuk penggunaan praktis dan dimaksudkan hanya untuk tujuan pendidikan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, kita harus bertanya-tanya apa model ini sebenarnya "belajar".</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seperti yang saya katakan</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oleh panduan Grad-CAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> minggu lalu, sangat mungkin bahwa model kami mempelajari pola yang tidak terkait dengan COVID-19, tetapi hanya variasi antara dua set data (yaitu, antara pasien dengan dan tanpa COVID-19). Untuk mengkonfirmasi hasil, pengujian menyeluruh dan bantuan ahli diperlukan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya, detektor masa depan (dan terbaik) akan bersifat multimodal.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sekarang kami </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mempertimbangkan </font><font style="vertical-align: inherit;">gambar (misalnya, x-ray). Detektor otomatis COVID-19 terbaik harus menggunakan beberapa sumber data, tidak terbatas pada gambar, termasuk tanda vital pasien, kepadatan populasi, lokasi geografis, dll. Gambar saja biasanya tidak cukup untuk jenis aplikasi ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya harap panduan ini berfungsi sebagai titik awal bagi siapa saja yang tertarik menggunakan visi komputer dan pembelajaran mendalam untuk secara otomatis mendeteksi COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa berikutnya?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya biasanya mengakhiri artikel blog saya dengan rekomendasi dari salah satu buku atau kursus saya sehingga Anda dapat belajar lebih banyak tentang menggunakan visi komputer dan pembelajaran mendalam. </font><font style="vertical-align: inherit;">Untuk menghormati keseriusan coronavirus, saya tidak akan melakukan ini - sekarang bukan waktu atau tempat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebaliknya, saya akan mengatakan bahwa kita sekarang berada dalam periode kehidupan yang sangat mengerikan. </font><font style="vertical-align: inherit;">Seperti musim, semuanya akan berlalu, tetapi untuk saat ini Anda perlu berjongkok dan bersiap menghadapi musim dingin - kemungkinan yang terburuk belum datang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menerima beberapa surat dari pembaca PyImageSearch yang ingin menggunakan waktu henti ini untuk mempelajari visi komputer dan pembelajaran mendalam, daripada menjadi gila di rumah mereka. </font><font style="vertical-align: inherit;">Ini adalah pemikiran yang berguna.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ringkasan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam panduan ini, Anda belajar cara menggunakan Keras dan TensorFlow untuk melatih detektor otomatis COVID-19 pada satu set fluorogram. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada dataset gambar peer-review berkualitas tinggi untuk COVID-19 (belum), jadi kami harus bekerja dengan apa yang kami miliki, yaitu, dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori Joseph Cohen di GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memilih 25 gambar dari dataset Cohen, hanya memilih tampilan posterior-anterior (PA) dan diagnosis yang dikonfirmasi.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemudian 25 gambar pasien sehat dipilih dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu set data dengan gambar fluorografi Kaggle (pneumonia)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menggunakan Keras dan TensorFlow untuk melatih detektor COVID-19, yang menunjukkan akurasi 90-92%, sensitivitas 100%, dan spesifisitas 80% pada set tes (diberikan set data terbatas kami). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingatlah bahwa detektor COVID-19 yang dijelaskan hanya untuk tujuan pendidikan.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id497612/index.html">Kisah bagaimana tangan pasar yang tak kasat mata memindahkan saya ke tempat yang jauh</a></li>
<li><a href="../id497614/index.html">Eksperimen pemikiran, paradoks, dan batasan logika // Kita ditakdirkan untuk # 2</a></li>
<li><a href="../id497616/index.html">Wawancara dengan Alexander Makarov (Yii) tentang opensource, konferensi, dan Yii</a></li>
<li><a href="../id497618/index.html">Implementasi konsep akses jarak jauh yang sangat aman</a></li>
<li><a href="../id497620/index.html">Menulis plugin peringatan telegram chrome</a></li>
<li><a href="../id497624/index.html">Kampus Digital Banking - hasil program magang</a></li>
<li><a href="../id497628/index.html">Cara menghabiskan banyak waktu pada naskah kecil atau riwayat satu permintaan tarik</a></li>
<li><a href="../id497632/index.html">Web HighLoad - cara kami mengelola lalu lintas puluhan ribu domain</a></li>
<li><a href="../id497634/index.html">Warna Pelangi Adalah Teman Terbaik Matematikawan</a></li>
<li><a href="../id497636/index.html">Bagaimana kurangnya daya komputasi memengaruhi pertempuran laut dalam perang dunia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>