<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüíª üëáüèΩ üç¢ Protection et piratage de la Xbox 360 (partie 1) üßëüèº‚Äçü§ù‚Äçüßëüèª üî≠ üöå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous avez probablement entendu parler de la console de jeu Xbox 360 et qu'elle "clignote". Par ¬´firmware¬ª, on entend ici un contournement des m√©canism...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Protection et piratage de la Xbox 360 (partie 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491634/"><img src="https://habrastorage.org/webt/f2/9c/up/f29cup58ppdbyrxpx6uwtfwce3m.png" alt="image" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous avez probablement entendu parler de la console de jeu Xbox 360 et qu'elle "clignote". </font><font style="vertical-align: inherit;">Par ¬´firmware¬ª, on entend ici un contournement des m√©canismes de protection int√©gr√©s pour le lancement de copies de jeux et de logiciels propri√©taires. </font><font style="vertical-align: inherit;">Et ici, des questions se posent! </font><font style="vertical-align: inherit;">Quels m√©canismes, comment se d√©placent-ils? </font><font style="vertical-align: inherit;">Qu'est-ce que les d√©veloppeurs ont fait, comment ont-ils r√©ussi √† le contourner? </font><font style="vertical-align: inherit;">En fait, le sujet est tr√®s vaste et int√©ressant, en particulier pour la Xbox 360 - vous pouvez trouver ici des vuln√©rabilit√©s logicielles, des d√©fauts mat√©riels et une magie absolument magique. </font><font style="vertical-align: inherit;">Int√©ressant? </font><font style="vertical-align: inherit;">Venez! </font><font style="vertical-align: inherit;">Dans la premi√®re partie, nous vous pr√©sentons l'hyperviseur, les lecteurs et le firmware ...</font></font><br>
<br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rencontrez le sujet</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La console de jeu Xbox 360 est sortie en 2005 et n'a pas subi de changements dans les caract√©ristiques du fer depuis lors. </font><font style="vertical-align: inherit;">Tout le temps qu'il √©tait sorti, c'√©tait pareil:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processeur PowerPC 3,2 GHz, / 3 c≈ìurs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU 500 MHz</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">512 Mo de RAM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DVD-ROM SATA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Disque dur SATA (en option) </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, la conception a chang√© avec le temps, les nanom√®tres ont diminu√©:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/n2/7b/b8n27bxgr6hsm1kowq2-zhpi8fk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√©anmoins, tous les jeux fonctionnaient aussi bien sur toutes les ¬´r√©visions¬ª des consoles - c'est exactement le cas lorsque les jeux modernes peuvent √™tre ex√©cut√©s sur du mat√©riel 2005. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment de la publication, une d√©claration forte a √©t√© faite que la console a √©t√© d√©velopp√©e aussi s√©curis√©e que possible - puces personnalis√©es avec protection au niveau mat√©riel, et en g√©n√©ral, les pirates n'ont pas encore vu cela:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y aura des niveaux de s√©curit√© dans cette bo√Æte que la communaut√© des hackers n'a jamais vus auparavant</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce que les d√©veloppeurs ont trouv√©? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premi√®rement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ils ont tout fait pour que le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code de programme du syst√®me ne puisse pas √™tre obtenu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Une ROM de 32 Ko contenant un chargeur principal (1BL) et une SRAM de 64 Ko dans laquelle elle a √©t√© ex√©cut√©e ont √©t√© int√©gr√©es au processeur central. </font><font style="vertical-align: inherit;">Il est tr√®s, tr√®s difficile d'obtenir le contenu d'une ROM √† partir d'une puce CPU:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tm/6g/db/tm6gdbdeo_4lkt5j5d4xb0-big4.png" width="320"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deuxi√®mement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fusibles</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sp√©ciaux </font><font style="vertical-align: inherit;">ont √©t√© </font><b><font style="vertical-align: inherit;">plac√©s</font></b><font style="vertical-align: inherit;"> dans le m√™me processeur </font><font style="vertical-align: inherit;">- des cavaliers br√ªl√©s (litt√©ralement √† haute tension), une sorte de m√©moire autrefois programmable. </font><font style="vertical-align: inherit;">Les fusibles comprenaient:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bits de verrouillage d'interface JTAG</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bits d√©terminant le but du pr√©fixe (retail / devkit / testkit)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cl√© de processeur 128 bits unique</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compteurs de valeur de verrouillage (LDV) pour d√©sactiver la r√©trogradation</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/j6/f4/zgj6f4zvgznhxrla5so6x06ofus.png" width="420"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, la quantit√© de fusion est limit√©e. Si vous parvenez √† mettre √† jour votre console 80 fois de suite, le compteur CFLDV se terminera et ... je ne sais pas, je n'ai pas essay√© de le faire. Probablement, le pr√©fixe ne sera plus mis √† jour. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Troisi√®mement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les d√©veloppeurs ont mis en place une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cha√Æne de confiance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour v√©rifier l'authenticit√© des chargeurs de d√©marrage, une combinaison d'algorithmes modernes (√† l'√©poque) SHA-1 et RSA-2048 a √©t√© utilis√©e, ce qui excluait la possibilit√© de lancer votre propre code ou de modifier non autoris√© les chargeurs de d√©marrage m√™me si vous avez en quelque sorte obtenu toutes les cl√©s de la console et avez pu reconstruire le syst√®me .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/xy/hg/ydxyhgfla9rqqypwuojvglpxqqg.png" width="370"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quatri√®mement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les d√©veloppeurs ont d√©cid√© d'aller plus loin sur le principe de "ne faire confiance √† personne" et de mettre un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">module</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mat√©riel sp√©cial </font><b><font style="vertical-align: inherit;">pour prot√©ger la RAM</font></b><font style="vertical-align: inherit;"> dans le m√™me CPU malheureux </font><font style="vertical-align: inherit;">! Avec son aide, toutes les zones avec le code du programme ont √©t√© crypt√©es et la surveillance de l'int√©grit√© a √©t√© activ√©e pour les zones les plus importantes (hyperviseur)!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3f/z2/de/3fz2dejnzhzmqpmx-ayeyvanur8.png" width="420"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce faisant, les d√©veloppeurs se sont d√©fendus contre les attaques DMA lorsque, via des p√©riph√©riques externes ayant acc√®s √† la RAM, ils modifient le code du programme syst√®me dans la RAM. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hyperviseur a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trait√© de la diff√©renciation des droits en r√©gions m√©moire </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Seul, il pouvait rendre les pages ex√©cutables, bien s√ªr, avant de v√©rifier la signature num√©rique, il √©tait donc impossible de t√©l√©charger du code non sign√© ou d'ex√©cuter quelque chose √† partir de la zone de donn√©es, m√™me en raison d'une vuln√©rabilit√© dans un pilote ou un jeu (l'axe et les jeux ont √©t√© lanc√©s avec les droits du noyau) . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, le syst√®me d'exploitation Xbox 360 √©tait bien prot√©g√© et, par cons√©quent, le DVD-ROM a √©t√© choisi comme premier vecteur d'attaque.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous commen√ßons ... des sauvegardes!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la Xbox 360, un DVD double couche a √©t√© choisi comme support principal pour les jeux. </font><font style="vertical-align: inherit;">Naturellement, des m√©canismes de d√©fense √©taient √©galement pr√©sents ici:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'√©change de donn√©es avec DVD-ROM a √©t√© crypt√© avec une cl√© unique</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au d√©but du disque, il y avait des ¬´secteurs de s√©curit√©¬ª sp√©ciaux pour confirmer les licences</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les fichiers ex√©cutables sur le disque ont √©t√© sign√©s num√©riquement</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais beaucoup moins d'attention a √©t√© accord√©e √† la protection du lecteur de DVD qu'au syst√®me principal. </font><font style="vertical-align: inherit;">La console de jeu a montr√© trop de confiance au lecteur de DVD - c'est le DVD-ROM qui a d√©termin√© la licence du disque. </font><font style="vertical-align: inherit;">De plus, le firmware √©tait stock√© dans la m√©moire externe et pouvait √™tre lu par le programmeur:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5a/o7/kl/5ao7klzogqyesre2uhamzj46bt4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, le 14 mai 2006, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commodore4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (c4eva) a publi√© le premier firmware modifi√© pour piloter le mod√®le TS-H943:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LISEZ-MOI pour la version du firmware</font></font></b>
                        <div class="spoiler_text"><blockquote> ‚Äî Xtreme firmware for TS-H943 Xbox 360<br>
 ‚Äî Here it is, the long awaited World first Xbox 360 backup firmware modification to boot all game backups!<br>
<br>
Features<br>
 ‚Äî Boots all Xtreme Xbox 360 backups<br>
Boots all Xtreme Xbox 1 backups<br>
Boots all Xbox 360 originals<br>
Boots all Xbox 1 originals on Xbox 360<br>
Xtreme0800 extraction firmware enables drive to function natively under Windows without any hardware conversion/adaptors<br>
Use on Xbox Live at own risk<br>
<br>
Technical details<br>
 ‚Äî Reads Xbox 360 security sector from PSN 04FB1F (Layer 0)<br>
Reads Xbox 1 security sector from PSN 605FF (Layer 0)<br>
Security sector must be extrated using Xtreme0800 360 firmware for Xbox360 games and Xbox 1 games<br>
Will not boot Xbox 1 backups made with Xbox1 605b 0800 firmware (maybe in future release)</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le micrologiciel lisait les secteurs de s√©curit√© √† partir de zones fixes sur un disque DVD et trompait la console, ce qui faisait penser qu'un disque sous licence avait √©t√© ins√©r√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me temps, le firmware 0800 est sorti, con√ßu pour cr√©er des copies de jeux et lire les secteurs de s√©curit√©. </font><font style="vertical-align: inherit;">Le lecteur Xbox 360, flash√© avec un tel firmware, a √©t√© d√©tect√© sur l'ordinateur et pouvait lire enti√®rement les secteurs du disque de jeu.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LISEZ-MOI sur l'utilisation du firmware 0800</font></font></b>
                        <div class="spoiler_text"><blockquote>Extracting Security Sector<br>
 ‚Äî Ensure DVD drive has been flashed with Xtrm0800.bin firmware. Drive can now work under Windows.<br>
Insert original game disk into drive and wait for windows to detect disk change<br>
Run DVDinfoPro<br>
Enter the following four custom cdb commands:<br>
<br>
AD 00 FF 02 FD FF FE 00 08 00 01 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 03 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 05 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 07 C0<br>
<br>
Then save hexadecimal display as bin file as SS.bin<br>
<br>
Creating a game backup<br>
 ‚Äî Ensure DVD drive has been flashed with Xtrm0800.bin firmware. Drive can now work under Windows.<br>
Extract Isobuilder.rar<br>
Insert original game disk into drive and wait for windows to detect disk change<br>
Run DVDinfoPro<br>
Enter the following custom cdb command to unlock drive: (game data visable)<br>
<br>
FF 08 01 01<br>
<br>
Run Isobuster<br>
Right click on DVD and select Extract From-To<br>
Click Length and enter number of LBAs as follows:<br>
 <br>
Xbox 1 Original Number of LBA to read 3431264 decimal<br>
or<br>
Xbox 360 Original Number of LBA to read 3567872 decimal<br>
Select User Data (2048 bytes/block)<br>
Click Start Extraction<br>
Enter filename as game.iso and click Save<br>
Upon read error dialogue box choose fill with blank zeros for sector and select use this selection for all errors<br>
Copy game.iso and ss.bin to the relevent isobuilder directory (Depending on Xbox 360 or Xbox 1 game)<br>
Run build360.bat (Xbox 360 game) or build.bat (xbox 1 game)<br>
Ensure your burner will set the booktype of DVD+R DL to DVDRom<br>
Burn with CloneCd and choose the image.dvd file</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre jeu pourrait √™tre partiellement copi√© avec l'astuce suivante:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mettre dans un ordinateur DVD-ROM disque ordinaire √† deux couches</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attendez qu'il se calme et cesse de tourner</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un trombone, ouvrez le plateau et changez le lecteur pour le jeu depuis la Xbox 360</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fermez le plateau et cr√©ez une image disque!</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Cela ne fonctionnait pas sur tous les mod√®les de DVD-ROM) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La chose la plus importante est que le lecteur a √©t√© flash√© exclusivement par logiciel, avec des commandes ATA sp√©ciales. </font><font style="vertical-align: inherit;">Le kit comprenait un programme sp√©cial pour lire le firmware d'origine et √©crire modifi√©. </font><font style="vertical-align: inherit;">Dans le firmware d'origine, la cl√© pr√©cieuse √©tait stock√©e, avec laquelle le disque √©tait li√© √† la Xbox 360:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s-/wx/yx/s-wxyxr4fyq6ljzpdzc29atqs_k.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La perte de la cl√© signifiait que m√™me les disques sous licence ne pouvaient pas √™tre lanc√©s, donc certains ont √©crit la cl√© dans un cahier, l'ont enregistr√©e dans la mesure du possible, c'√©tait la connaissance la plus ch√®re. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre sujet √©tait la panique du jeu en ligne. </font><font style="vertical-align: inherit;">Tout le monde avait peur que Microsoft d√©couvre que le lecteur avait √©t√© modifi√© et d√©sactiverait la console √† distance. </font><font style="vertical-align: inherit;">Certains ont m√™me fait un mod mat√©riel pour basculer entre le firmware d'usine et le firmware modifi√©:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/te/wn/mn/tewnmnkmlplgwxbqzvi188hrayk.jpeg" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils ont jou√© sur le firmware d'origine ¬´sous licence¬ª et, avec une connexion au r√©seau, les ont honteusement d√©connect√©s sur le c√¢ble Internet modifi√©. </font><font style="vertical-align: inherit;">Soit dit en passant, la panique n'a pas √©t√© en vain, mais de tels mods ont √©t√© compl√®tement vains, tout a √©t√© enregistr√© sans connexion au r√©seau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exactement un mois plus tard (15 juin 2006), le micrologiciel a √©t√© port√© sur un autre mod√®le de lecteur, install√© √† l'√©poque sur la Xbox 360 - Hitachi GDR3120L. </font><font style="vertical-align: inherit;">Il avait √©galement un lecteur flash externe contenant le firmware:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-3/76/nu/-376nus9derd_0hbua6rsxwr3xm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce disque √©tait mieux prot√©g√©:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le firmware a √©t√© stock√© dans la ROM sous forme crypt√©e</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il y avait un contr√¥le d'int√©grit√© dans le firmware</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour √©craser le firmware, vous deviez entrer dans un "Mode B" sp√©cial</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et si les chercheurs g√©raient eux-m√™mes les deux premiers points, l'exploit de traduction en ¬´Mode B¬ª devait √™tre r√©p√©t√© par tous les </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeunes</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> flashers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette action a √©t√© propos√©e pour √™tre effectu√©e √† l'aide d'un disque de d√©marrage sp√©cial avec Slax Linux, ou en court-circuitant les fils au d√©marrage. </font><font style="vertical-align: inherit;">Il √©tait n√©cessaire de court-circuiter les contacts 0 et 9 du connecteur d'alimentation du variateur. </font><font style="vertical-align: inherit;">Par exemple, avec des √©pingles!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wz/wu/rd/wzwurdo3ymtphwolno8mzc5zhew.png" width="350"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les deux cas, apr√®s de tels abus, le lecteur a √©t√© d√©fini dans Windows comme un lecteur de DVD ordinaire, o√π il a √©t√© ramass√©, </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viol√©</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">cousu.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/n1/kg/lm/n1kglmch5iqrprr6g77nqks6fd4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s la premi√®re version, les firmwares personnalis√©s ont √©t√© finalis√©s, la stabilit√© a √©t√© am√©lior√©e, le support des nouveaux jeux a √©t√© ajout√©, en g√©n√©ral, tout √©tait comme d'habitude.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©ponse de Microsoft</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les d√©veloppeurs aux all√©gations selon lesquelles la console "incassable" a √©t√© pirat√©e, ont r√©pondu simplement:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le syst√®me n'a pas √©t√© pirat√©, nous venons d'apprendre √† lancer des copies de jeux, nous y travaillons</font></font></blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©ponse originale</font></font></b>
                        <div class="spoiler_text"><blockquote>The core security system has not been broken. However, it is reported that the authentication protocol between the optical disc drive and the console may be attacked, which if accurate could allow people to play illegally copied games. Our security team is aware of this and we are investigating potential solutions to this issue. The Xbox 360 platform was designed to be updated, and we are prepared to respond appropriately should any unauthorized activity be identified.</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui a vraiment √©t√© fait pour corriger la situation:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samsung TS-H943 a commenc√© √† venir avec le firmware ms28, qui n'est pas entr√© en mode firmware par la c√©l√®bre commande ATA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hitachi GDR3120L est apparu avec le firmware 0078 et 0079, ne clignotant pas m√™me en mode B</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les nouveaux disques BenQ-LiteOn VAD6038 apparaissent</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re "interdiction" pointue des pirates sur Xbox Live a commenc√©, les pirates ont √©t√© interdits de jouer en ligne pour toujours</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout √©tait sans ambigu√Øt√© et irr√©parable avec l'interdiction (√† ce moment-l√†), les chercheurs ont vite compris les motivations:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour Hitachi trouv√© d√©verrouiller le mode firmware via un disque audio sp√©cial</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/yl/ub/roylub2mkued2crcyqyetarr6qw.png"></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samsung ms28 et BenQ VAD6038 sont parfaitement pass√©s en mode firmware via des contr√¥leurs SATA VIA 6421 peu co√ªteux</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/in/ns/wk/innswkumj-p0xyc1587hl--lh0w.png" width="433"></div></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laissons le champ de bataille pour le firmware du lecteur pendant un certain temps, il n'y a pas eu de p√©riode tr√®s int√©ressante o√π les chercheurs ont essay√© de cr√©er le firmware ¬´Stealth¬ª, afin de ne pas √™tre banni de Xbox Live, de s'adapter aux nouveaux jeux avec de nouvelles ¬´vagues¬ª - versions de mise √† jour du syst√®me et portez les r√©sultats sur tout une vari√©t√© croissante de micrologiciels et de lecteurs. </font><font style="vertical-align: inherit;">Tout de m√™me, tout √©tait cousu, les ¬´sauvegardes¬ª lanc√©es avec succ√®s, la Xbox 360 gagnait en popularit√© aupr√®s des gens ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Briser l'axe!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous vous en souvenez de la premi√®re partie de l'histoire, le syst√®me Xbox 360 avait un hyperviseur qui contr√¥lait tout et tout. </font><font style="vertical-align: inherit;">Alors voil√†. </font><font style="vertical-align: inherit;">Dans une version du syst√®me, une vuln√©rabilit√© est soudainement apparue dedans! </font><font style="vertical-align: inherit;">Comment exactement les chercheurs ont re√ßu les √©chantillons de code de l'hyperviseur ne me sont pas connus avec certitude. </font><font style="vertical-align: inherit;">Mais le fait est qu'√† la fin de 2006, les chercheurs ont lanc√© du code non sign√© sur la Xbox 360, et au d√©but de 2007, la vuln√©rabilit√© a √©t√© corrig√©e par les d√©veloppeurs:</font></font><br>
<blockquote>Timeline:<br>
 Oct 31, 2006 ‚Äî release of 4532 kernel, which is the first version containing the bug<br>
 Nov 16, 2006 ‚Äî proof of concept completed; unsigned code running in hypervisor context<br>
 Nov 30, 2006 ‚Äî release of 4548 kernel, bug still not fixed<br>
 Dec 15, 2006 ‚Äî first attempt to contact vendor to report bug<br>
 Dec 30, 2006 ‚Äî public demonstration<br>
 Jan 03, 2007 ‚Äî vendor contact established, full details disclosed<br>
 Jan 09, 2007 ‚Äî vendor releases patch<br>
 Feb 28, 2007 ‚Äî full public release</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'hyperviseur avait une fonctionnalit√© - contrairement au reste du code, il n'√©tait pas ex√©cut√© dans l'espace d'adressage virtuel, mais dans le physique (mode r√©el). La diffusion n'a pas √©t√© utilis√©e, les appels ont √©t√© effectu√©s directement (adresses de la forme 0x00000000'xxxxxx). Soit cela a √©t√© fait pour la vitesse, soit pour la simplicit√© ... Et voici une caract√©ristique de l'espace d'adressage Xbox 360. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le mode d'acc√®s √† la m√©moire √©tait d√©termin√© par son adresse physique. √Ä savoir, les bits les plus significatifs de l'adresse avaient un but officiel. Par exemple, l'adresse 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'0000201C signifie un acc√®s direct √† l'adresse 0x201C, et 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'0000201C signifie que vous devez d√©crypter et v√©rifier l'int√©grit√© √† la vol√©e lors de la lecture de la m√™me adresse physique 0x201C.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/t6/nz/dv/t6nzdvvz2hzrfkhx_2ti24hgey4.png" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, pour que l'ex√©cution soit effectu√©e avec le chiffrement et la protection activ√©s, vous devez vous r√©f√©rer √† des adresses comme 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx. Ce n'est qu'alors que le module mat√©riel comprenait des m√©canismes de protection. Par cons√©quent, au niveau mat√©riel, le bit souhait√© a √©t√© ajout√© automatiquement (le registre sp√©cial HRMOR en √©tait responsable - Registre de d√©calage du mode r√©el de l'hyperviseur)! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois - d√®s que l'hyperviseur acc√®de √† une adresse comme 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx, la MMU change automatiquement cette adresse en 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx, y compris le chiffrement et la protection! Ainsi, toute tentative d'ex√©cution du code "directement" √† partir de la m√©moire physique, sans protection ni cryptage, est vou√©e √† l'√©chec ... ou pas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardons le code vuln√©rable de l'hyperviseur version 4532:</font></font><br>
<blockquote><code>// %r0 ‚Äì   <br>
 13D8: cmplwi %r0, 0x61 //    ID<br>
 13DC: bge illegal_syscall //    0x61, ,  <br>
 ...<br>
 13F0: rldicr %r1, %r0, 2, 61 //     4<br>
 13F4: lwz %r4, syscall_table(%r1) //    <br>
 13F8: mtlr %r4 //     lr<br>
 ...<br>
 1414: blrl //   </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tu vois le gopher? Mais il est! L'instruction Cmplwi fonctionne avec </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valeurs </font><i><font style="vertical-align: inherit;">32 bits</font></i><font style="vertical-align: inherit;"> , mais rldicr - avec </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64 bits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! Autrement dit, nous pouvons passer la valeur 0x20000000'0000002A comme num√©ro d'appel syst√®me, il passera le test (car la partie inf√©rieure de 32 bits est inf√©rieure √† 0x61), et par cons√©quent, au lieu de l'adresse 0x10EC, l'adresse du gestionnaire sera prise de 0x80000000'000010EC! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis, comme on dit, surveillez vos mains. Les bits les plus significatifs de l'adresse ne sont pas √©gaux √† z√©ro, respectivement, HRMOR n'est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas ajout√©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! Et puisque l'espace d'adressage r√©el est de 32 bits, le 63 bits d√©fini par nous est simplement ignor√©. Nous avons redirig√© l'hyperviseur vers une m√©moire non chiffr√©e et non s√©curis√©e, simplement en soumettant un num√©ro d'appel syst√®me incorrect!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q8/z8/hv/q8z8hv9wgxghllkyugudx1btvl4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais attendez, pour qu'il y ait o√π sauter, nous devons pouvoir √©crire nos donn√©es dans la m√©moire physique. </font><font style="vertical-align: inherit;">Comment y parvenir? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l√† que le deuxi√®me facteur entre en jeu - le GPU sur la Xbox 360 √©tait intelligent, m√™me </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trop</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intelligent. </font><font style="vertical-align: inherit;">Il a pris en charge une instruction sp√©ciale de shader, MemExport, pour t√©l√©charger des donn√©es de g√©om√©trie dans la m√©moire physique. </font><font style="vertical-align: inherit;">Autrement dit, vous pouvez compiler le shader, l'ex√©cuter sur le GPU et ainsi enregistrer n'importe quoi n'importe o√π! </font><font style="vertical-align: inherit;">Et surtout, les shaders n'√©taient pas sign√©s, si vous modifiez le disque du jeu de quelque mani√®re que ce soit, vous pouvez facilement remplacer le code du shader.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vt/mm/wo/vtmmwojgxidc5w2rqddzefplfmo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une question restait. </font><font style="vertical-align: inherit;">Comment remplacer le code shader sur le disque de jeu? </font><font style="vertical-align: inherit;">Et ici, le piratage du lecteur DVD de la console a √©t√© tr√®s utile. </font><font style="vertical-align: inherit;">Nous avons √©crit un shader, l'avons remplac√© √† l'image du jeu, l'avons enregistr√© sur un disque et lanc√© Linux!</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_k/at/nw/_katnwvzekryqwntrpu_irji5py.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, pour l'ex√©cuter, j'ai d√ª d√©marrer le jeu √† chaque fois, attendre que l'exploit fonctionne, mettre le disque de d√©marrage avec Linux, mais c'√©tait au moins quelque chose! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme d√©j√† mentionn√©, Microsoft a publi√© une mise √† jour du syst√®me dans laquelle ils ont corrig√© la vuln√©rabilit√© de l'hyperviseur. </font><font style="vertical-align: inherit;">Mais que faire si vous retournez un noyau vuln√©rable?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©trograder!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, l'architecture de la Xbox 360 a √©t√© d√©finie des m√©canismes de protection contre la r√©trogradation. </font><font style="vertical-align: inherit;">Dans les fusibles mat√©riels du processeur, chaque fois qu'un bit √©tait br√ªl√© pendant la mise √† jour (valeur de verrouillage, LDV augment√©), et si ce LDV ne correspondait pas dans les fusibles et dans le syst√®me, la console ne d√©marrait tout simplement pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez la structure du chargeur de d√©marrage Xbox 360, √† savoir, ¬´Sections du chargeur de d√©marrage¬ª:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/dh/9l/dwdh9lbenpvavf7gl6qeu8n_ks4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On peut voir qu'il y a plusieurs ensembles de chargeurs de d√©marrage dans l'image, chacun correspondant √† certains LDV. Dans l'exemple, ce sont </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1888</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour LDV 0, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16767</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour LDV 3 et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16756</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour LDV 2 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, toutes les mises √† jour du syst√®me lui-m√™me ont √©t√© enregistr√©es dans les sections 6BL / 7BL et simplement ¬´appliqu√©es¬ª comme correctifs au ¬´core¬ª de base 5BL </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1888</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mais quel ensemble de correctifs √† appliquer a √©t√© s√©lectionn√© en fonction du LDV prescrit dans les en-t√™tes des fusibles et du chargeur de d√©marrage! Et juste √† 5BL, l'en-t√™te pouvait √™tre modifi√©, avec un gros MAIS - l'en-t√™te a √©t√© compar√© √† la somme de hachage HMAC-SHA-1 qui y √©tait enregistr√©e. Et il a √©t√© v√©rifi√© par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ordinaire </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous ne comprenez toujours pas o√π vont les choses, ici vous avez r√©ussi √† appliquer une attaque temporelle (Timing Attack). La fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> standard </font><font style="vertical-align: inherit;">termine la comparaison imm√©diatement apr√®s le premier √©cart. Par cons√©quent, en modifiant le premier octet du hachage et en d√©tectant le temps d'ex√©cution de memcmp, vous pouvez s√©lectionner la valeur souhait√©e (le temps de v√©rification augmentera avec lui). En continuant, vous pouvez r√©cup√©rer tous les octets de la somme de hachage! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la mesure, le bus de d√©bogage POST_OUT a √©t√© utilis√©. Il fonctionne comme un PC, √† diff√©rents moments du chargement, une valeur √† un octet est affich√©e, par laquelle vous pouvez juger o√π le processeur est actuellement en cours d'ex√©cution et quelle erreur s'est produite. En fait, ce sont 8 points sur la carte m√®re, dont chacun est responsable d'un bit de valeur sp√©cifique:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/12/vk/s0/12vks0mejlztfsokeo1dkdjq_he.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir soud√© ces points, vous pouvez simplement mesurer le temps d'ex√©cution de chacune des √©tapes de t√©l√©chargement et voir si une erreur s'est produite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ensemble du processus de s√©lection du hachage prend environ une heure:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3d/am/0j/3dam0jhxheubnuc-mgfznhomhrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, nous obtenons une image dans laquelle le LDV actuel est install√© pour le noyau, car aucun correctif n'est appliqu√© et la version la plus ancienne du syst√®me 1888 est lanc√©e! </font><font style="vertical-align: inherit;">D'o√π il est d√©j√† possible de passer √† la version vuln√©rable 4532:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/_m/iz/sj_mizzzybdy41ia6wm30umwbt8.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/xi/b6/bzxib6g2blchf0dxcw6a2lethsu.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, Microsoft a corrig√© cette vuln√©rabilit√© en mettant √† jour le tout premier chargeur de d√©marrage mis √† jour (2BL, ¬´CB¬ª) et en br√ªlant le fusible CBLDV, ce qui a rendu la r√©trogradation impossible √† nouveau. </font><font style="vertical-align: inherit;">Maintenant, au lieu de memcmp, sa version s√ªre a √©t√© utilis√©e, avec le m√™me temps d'ex√©cution ind√©pendamment des valeurs d'entr√©e.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG Hack!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais ici, les chercheurs n'ont pas abandonn√© et ont trouv√© une faille. </font><font style="vertical-align: inherit;">Oui, tel que les d√©veloppeurs ne pouvaient m√™me pas imaginer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le mode de fonctionnement normal de la console, tous les chargeurs de d√©marrage sont connect√©s les uns aux autres dans une cha√Æne. </font><font style="vertical-align: inherit;">Par cons√©quent, le d√©chiffrement de chaque chargeur de d√©marrage d√©pend de la zone de donn√©es dans l'en-t√™te du chargeur de d√©marrage pr√©c√©dent (Pairing Data). </font><font style="vertical-align: inherit;">De plus, le cryptage du code d√©pend de la cl√© de processeur unique, vous ne pouvez donc pas prendre et assembler une image de travail sans conna√Ætre CPU_Key. </font><font style="vertical-align: inherit;">Ou est-ce possible? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au stade de la production de la console (lorsque la cl√© du processeur n'a pas encore √©t√© grav√©e dans des fusibles), un mode de lancement sp√©cial Xbox 360 est utilis√© lorsque le couplage des donn√©es est nul (Zero-Pairing). </font><font style="vertical-align: inherit;">Et une telle image (avec un noyau vuln√©rable!) Peut √™tre ex√©cut√©e sur n'importe quelle console sans m√™me conna√Ætre la cl√© du processeur!</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, il n'y aura pas de lancement √† part enti√®re, cette erreur se produira comme ceci:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/db/zq/t-/dbzqt-_ppnq1xsfd0lntr7gdn14.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, le jeu King Kong ne peut pas √™tre d√©marr√©, l'exploit via les shaders ne peut pas √™tre activ√© ... Mais le noyau vuln√©rable commence d√©j√†! </font><font style="vertical-align: inherit;">Peut-√™tre qu'il existe une autre fa√ßon d'enregistrer la RAM? </font><font style="vertical-align: inherit;">Il s'est av√©r√© que oui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, nous soudons trois GPIO gratuits de la console sud de la console aux broches JUAG du GPU:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/54/ut/e5/54ute5q1civmpzgs6vx43kyjpr8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous modifions le firmware du pont sud (il est crypt√© mais pas sign√©) et collectons l'image avec le noyau vuln√©rable. </font><font style="vertical-align: inherit;">Puis la magie op√®re:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au d√©marrage, le pont sud du GPU JTAG monte sur PCI Express et configure le contr√¥leur NAND </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, lors de la lecture, le contr√¥leur NAND va √©crire des donn√©es dans la zone de m√©moire dont nous avons besoin</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le c≈ìur du syst√®me d√©marre et informe le pont sud que le syst√®me a d√©marr√©</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le pont sud tire le contr√¥leur NAND, √©crasant la RAM au bon endroit et exploite la vuln√©rabilit√© de l'hyperviseur!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le contr√¥le est transf√©r√© √† notre code, faites ce que nous voulons</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En bref, ils ont tout fait de la m√™me mani√®re que dans King Kong Shader Exploit, mais plus cool - il n'est pas n√©cessaire de d√©marrer le jeu et de changer de disque. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base de JTAG Hack, des versions modifi√©es du syst√®me ont √©t√© cr√©√©es - XBReboot, Freeboot, avec v√©rification de signature d√©sactiv√©e, o√π les pirates se promenaient d√©j√†. Les jeux pouvaient √™tre lanc√©s non seulement √† partir de lecteurs et disques USB, mais √©galement via le protocole SMB directement √† partir d'un ordinateur.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fn/6k/0x/fn6k0xazskez18wwj8v1nnude-c.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surtout, un piratage du syst√®me √† part enti√®re a donn√© une chance √† ceux qui ont perdu la cl√© DVD et ne pouvaient pas jouer - ayant la cl√© du processeur, il n'√©tait pas difficile d'extraire la cl√© DVD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, ici, Microsoft a rapidement corrig√© la vuln√©rabilit√©, mettant √† jour √† nouveau 2BL et augmentant la valeur de CBLDV. Sur ce, l'√©pop√©e de l'hyperviseur vuln√©rable termin√©e, les gens ont couru pour acheter les restes des consoles "compatibles JTAG" dans les magasins - tout le monde voulait jouer avec des cl√©s USB sans aucun probl√®me. Des discussions ont eu lieu sur des forums sur les bundles avec quelle date de sortie convenaient pour le piratage ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sujet des modifications du syst√®me Xbox 360 a cal√© pendant pr√®s de deux ans, mais le th√®me du firmware a continu√© √† se d√©velopper. Et juste dans le micrologiciel des lecteurs LiteOn, la bataille la plus √©tendue entre les chercheurs et Microsoft a √©clat√©. Mais plus √† ce sujet dans le prochain article :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapport GoogleTechTalks</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">King Kong Hack </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timing Attack </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG / SMC Hack </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection et piratage Xbox 360, Partie 1 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection et piratage </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Xbox 360 </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">, Partie 2 </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection et piratage Xbox 360, Partie 3</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS Toute personne int√©ress√©e par les d√©tails, je r√©pondrai √† toutes les questions sur le sujet dans les commentaires!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr491622/index.html">Pr√©dire les crises financi√®res avec Python</a></li>
<li><a href="../fr491624/index.html">Cr√©ation d'un effet de contour dans Unity Universal Render Pipeline</a></li>
<li><a href="../fr491628/index.html">Spelunky comme exemple de bonne conception de jeu</a></li>
<li><a href="../fr491630/index.html">Application d'extensions de navigateur Firefox (extensions Web)</a></li>
<li><a href="../fr491632/index.html">Immortalit√© num√©rique - Internet synchrone</a></li>
<li><a href="../fr491636/index.html">Mod√®les GRASP: Expert en information</a></li>
<li><a href="../fr491638/index.html">Cloud 1C. Tout est sans nuage</a></li>
<li><a href="../fr491640/index.html">Le Big Data tiendra-t-il ses promesses?</a></li>
<li><a href="../fr491642/index.html">Comment nous r√©alisons des vid√©os chez Alconost et comment le client y participe</a></li>
<li><a href="../fr491644/index.html">Choisissez un plugin pour l'authentification √† deux facteurs dans Wordpress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>