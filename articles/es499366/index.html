<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöÆ üõ∞Ô∏è üöû Geo-chat, bots da√±inos y esteganograf√≠a: enriquecer el conocimiento sobre Telegram üï§ ‚òÑÔ∏è üë≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øQu√© sabes sobre los telegramas en Telegram? ¬øY puede distinguir la esteganograf√≠a en VideoNote (popularmente, round-robin)? ¬°Analizamos la misma tare...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Geo-chat, bots da√±inos y esteganograf√≠a: enriquecer el conocimiento sobre Telegram</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/499366/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/r-/kn/lsr-knoirt_c2eklbngtrv43ys4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© sabes sobre los telegramas en Telegram? </font><font style="vertical-align: inherit;">¬øY puede distinguir la esteganograf√≠a en VideoNote (popularmente, round-robin)? </font><font style="vertical-align: inherit;">¬°Analizamos la misma tarea </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que caus√≥ la mayor cantidad de preguntas y exclamaciones a nuestro apoyo! </font><font style="vertical-align: inherit;">Spoiler: s√≠, y tambi√©n habr√° un poco de cifrado aqu√≠ :)</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leyenda de NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">encontramos un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enlace</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al perfil de un robot viajero en Instagram. </font><font style="vertical-align: inherit;">Nada fuera de lo com√∫n, ¬øverdad? </font><font style="vertical-align: inherit;">As√≠ que tambi√©n lo decidimos, pero a√∫n tenemos que resolver la tarea, por lo que consideramos cuidadosamente todas las im√°genes en el perfil y buscamos al menos algunas pistas. </font><font style="vertical-align: inherit;">Una peque√±a meditaci√≥n sobre una hermosa imagen del lago Baikal, y nos damos cuenta de que la pista est√° en la √∫ltima publicaci√≥n:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/f3/yp/wgf3ypumnzx-gms9aj5ixn7qllw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias a la imagen, entendemos que de alguna manera necesita conectar Baikal (Shaman Rock) y Telegram ("U puede unirse a mi ..." - ¬øno se parece a nada?). </font><font style="vertical-align: inherit;">Al principio, decidimos no darles a los participantes una pista directa de geo-chat (¬°eso es exactamente!), Y muchos de ellos lograron superar la tarea con √©xito utilizando un emulador o un dispositivo m√≥vil con la capacidad de cambiar la ubicaci√≥n geogr√°fica. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shamanim Establecemos las</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordenadas (53.20074, 107.349426) (se puede ver a simple vista) en el √°rea de la roca Shamanka y nos preparamos para lo m√°s dif√≠cil: la espera. </font><font style="vertical-align: inherit;">Telegram trabaja extra√±amente con geo-posicionamiento y obtiene contactos y chats relevantes durante una hora. </font><font style="vertical-align: inherit;">Por nuestra diligencia y paciencia, se nos paga por completo: el chat deseado aparece en la secci√≥n Contactos -&gt; Buscar personas cercanas -&gt; Grupos cercanos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/z_/ti/cbz_tiwdqa0j0cqdikmwjob704y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voila, estamos en el negocio! </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_c/or/zt/_corztflxylgeewrehp61prvssu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bot nos encuentra con una tarea en forma de un archivo de algunos bytes con contenido no identificado, en el que podemos leer las l√≠neas "Descifrarme" y "Apocalipsis no ahorra a nadie". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entendemos la primera l√≠nea sin ning√∫n problema, pero ¬øqu√© significa la segunda? ... Aqu√≠, los participantes se dividieron en dos campos: algunos nos escribieron por correo, porque llegaron a un callej√≥n sin salida, mientras que otros observaron cuidadosamente la frase "Apocalipsis no perdona a nadie" y discernieron que ? ¬°Derecha! Buen formato </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> antiguo </font><font style="vertical-align: inherit;">( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ya escribimos sobre c√≥mo analizarlo).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/vr/k4/bbvrk4nu0xsdayswyptuv2z1gpw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos a hacerlo bien. En el interior hay 2 estructuras. En uno, encontramos un conjunto de bytes marcado "Descifrarme", del cual asumimos que este es texto cifrado. En la segunda estructura, vemos dos n√∫meros. Es poco probable que esta sea una clave generosamente presentada por el participante junto con el texto cifrado, lo que significa muy probablemente. Estamos tratando con una clave p√∫blica. Toda la informaci√≥n reunida nos lleva a la conclusi√≥n obvia: ¬øpor qu√© no probar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, tenemos un m√≥dulo y un indicador abierto, que, por cierto, es bastante grande. Despu√©s de un </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estudio convulsivo de la RSA para</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflexionar, concluimos que el indicador cerrado es peque√±o, ¬øqu√© significa? ¬°Bingo! Definitivamente podemos jugar a malos y usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el ataque de Wiener</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo pensamos bien incluso para aquellos a quienes no les gusta la criptograf√≠a: podr√≠a usar una versi√≥n preparada del ataque, por ejemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces conseguimos el valor de una figura cerrada </font></font><code>d=40553818206320299896275948250950248823966726834704013657854904761789429403771</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y descifrar el texto cifrado: </font></font><code>key=nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u;pass=passCxws3jzYhp0HD5Fy84</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtenemos la clave "nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u" para la primera parte del trabajo y la contrase√±a "passCxws3jzYhp0HD5Fy84", que necesita para alimentar al representante del bot. </font><font style="vertical-align: inherit;">Se puede encontrar entre los participantes del chat con el nombre @neoquestbot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al estar en la onda positiva al recibir la primera clave, no nos damos cuenta de inmediato de que el bot es exigente en la comunicaci√≥n y todo el tiempo dice que no ve al interlocutor:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ky/t_/exkyt__66acqprkte1kk_hljuge.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero el bot recibe felizmente los mensajes redondos de VideoNote e incluso los responde ... en la misma forma redonda:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/tk/k4/gvtkk4hr8u_a8gsidkkqijtcuzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que el video y el sonido son los mismos, pero esto es solo a primera vista. </font><font style="vertical-align: inherit;">¬øQu√© pasa si nuestro bot nos da algunas se√±ales secretas? </font><font style="vertical-align: inherit;">Para averiguarlo, guardaremos y compararemos el video original con la respuesta del bot. </font><font style="vertical-align: inherit;">Para esto y para los pr√≥ximos pasos, el paquete </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es excelente para nosotros </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Entonces, veamos qu√© hay all√≠:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/re/jy/z0/rejyz0tnqx0lgvvcggpctdv2elq.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/e3/_v/rie3_vg77u1j1txjch9te5a8y1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formato aac -&gt; flac, frecuencia 44100 Hz -&gt; 98000 Hz. </font><font style="vertical-align: inherit;">Descubrieron que seguimos trabajando m√°s con el audio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con un movimiento h√°bil de las manos, lo sacamos del video:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/er/ql/jh/erqljhyvzkhdq34zoxmfvl7ezty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo mismo se puede hacer con nuestro mensaje original, para que podamos compararlos m√°s tarde. </font><font style="vertical-align: inherit;">Para mayor claridad, abra ambas pistas en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audacity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/ga/gq/gdgagqn_qtefqtnbyphj2ud0b00.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El salto en amplitud en la respuesta de audio del bot llama inmediatamente su atenci√≥n (especialmente extra√±o si estuvi√©ramos en silencio). </font><font style="vertical-align: inherit;">En una inspecci√≥n m√°s cercana, notamos los l√≠mites claros de los intervalos durante la alternancia del "silencio de onda":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mu/7f/zp/mu7fzposl6z9ozjrxanvjfnh2hw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sugerimos dejar de lado todas las cosas y contar un poco. </font><font style="vertical-align: inherit;">Analizamos por fragmentos: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 - 0.005 - silencio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0.005 - 0.01 - onda </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0, 01 - 0.0225 - silencio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0.025 - 0.04 - onda </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0.04 - 0.045 - silencio </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El intervalo m√°s peque√±o es 0.005, y todos los dem√°s los intervalos son m√∫ltiplos de 0.005. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomamos la presencia de una onda de 0.005 por 1, y silencio por 0. ¬°No obtenemos nada m√°s que un c√≥digo binario! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recordamos que la frecuencia ha cambiado e intentamos mirar el gr√°fico de espectro (An√°lisis -&gt; Gr√°fico de espectro):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/us/g0/7pusg01eyco5oawp9fyw92rbpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos que la se√±al m√°s potente es a una frecuencia de ~ 44100 Hz, que es la ecograf√≠a. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, deber√≠as trabajar solo con altas frecuencias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, el bot superpone su se√±al en el audio original en el espectro audible. Y aquellos participantes que hab√≠an sonado en el video original notaron esto en Audacity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cortamos las frecuencias altas con un filtro de paso alto, ya sea en Audacity o en el mismo ffmpeg:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/tk/tc/3ctktc0fgdc9zevjijzypncxb9o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, tenemos un archivo mono wav de 16 bits. Consiste en un encabezado, una secuencia de audio sin comprimir y metadatos. El flujo de audio en s√≠ est√° dividido en cuadros (y los cuadros pueden almacenar varias muestras en s√≠ mismos, pero esta es una historia completamente diferente), en nuestro caso de 16 bits cada uno (esto se indica con las letras pcm_s16 en las capturas de pantalla). Los marcos son secuencias de bits que describen la amplitud de la onda a la vez para uno o m√°s canales (en nuestro caso, para uno). La frecuencia de muestreo de la secuencia de audio es 98000 cuadros (es decir, 98000 cuadros por segundo), 490 cuadros por intervalo de 0,005 segundos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, seguimos trabajando de acuerdo con un algoritmo simple: leemos 490 cuadros, determinamos si es una onda o silencio y, dependiendo de esto, establecemos el bit en 0 o 1. Usaremos </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Python y un paquete</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ola</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para analizar archivos wav. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si se produce el error "wave.Error: formato desconocido: 65534" al abrir el archivo, reemplace "wFormatTag" en el encabezado de 'FE FF' a '01 00 ':</font></font><br>
<br>
<pre><code class="python hljs">fh = open(input_file, <span class="hljs-string">"r+b"</span>)<font></font>
fh.seek(<span class="hljs-number">20</span>)<font></font>
fh.write(<span class="hljs-string">b'\x01\x00'</span>)<font></font>
fh.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, abra el archivo, procese 490 cuadros y calcule el valor promedio:</font></font><br>
<br>
<pre><code class="python hljs">file = wave.open(input_file,<span class="hljs-string">"r"</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(file.getnframes()/<span class="hljs-number">490</span>)+<span class="hljs-number">1</span>):<font></font>
        frames = file.readframes(<span class="hljs-number">490</span>)<font></font>
        bit = <span class="hljs-number">0</span>
        sum = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">246</span>):<font></font>
            frame_bytes = frames[k*<span class="hljs-number">2</span>:k*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>]<font></font>
            sum += int.from_bytes(frame_bytes, <span class="hljs-string">"big"</span>)
        <span class="hljs-keyword">if</span> sum/<span class="hljs-number">490</span> &gt; <span class="hljs-number">16000</span>:<font></font>
            bit = <span class="hljs-number">1</span><font></font>
        bits.append(bit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es posible que donde haya silencio (comp√°rese con la imagen en Audacity), el ruido pueda permanecer. </font><font style="vertical-align: inherit;">Por lo tanto, establecemos el umbral (sea 16000), al exceder lo que consideramos que la se√±al es 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego agrupamos los bits en bytes:</font></font><br>
<br>
<pre><code class="python hljs">bytes = []    
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(len(bits)/<span class="hljs-number">8</span>)+<span class="hljs-number">1</span>):<font></font>
        b1 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-8</span>]<font></font>
        b2 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-7</span>]<font></font>
        b3 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-6</span>]<font></font>
        b4 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-5</span>]<font></font>
        b5 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-4</span>]<font></font>
        b6 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-3</span>]<font></font>
        b7 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-2</span>]<font></font>
        b8 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-1</span>]<font></font>
        byte = (b1 &lt;&lt; <span class="hljs-number">7</span>) | (b2 &lt;&lt; <span class="hljs-number">6</span>) | (b3 &lt;&lt; <span class="hljs-number">5</span>) | (b4 &lt;&lt; <span class="hljs-number">4</span>) | (b5 &lt;&lt; <span class="hljs-number">3</span>) | (b6 &lt;&lt; <span class="hljs-number">2</span>) | (b7 &lt;&lt; <span class="hljs-number">1</span>) | b8<font></font>
        bytes.append(byte.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">'big'</span>)) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si todo se hace correctamente, el resultado es la cadena "Givemethepassword". </font><font style="vertical-align: inherit;">Dado que el bot se comunica en c√≠rculos usando esteganograf√≠a, ser√° l√≥gico ingresarle una contrase√±a (y la recibimos junto con la clave como resultado del descifrado) en el mismo formato. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comenzar, componga una pista de audio con una contrase√±a. </font><font style="vertical-align: inherit;">Para hacer esto, utilizamos los datos obtenidos durante el an√°lisis del mensaje del bot: frecuencia de muestreo 98000 Hz; </font><font style="vertical-align: inherit;">la duraci√≥n de la se√±al que describe cada bit es de 5 ms; </font><font style="vertical-align: inherit;">la frecuencia de la se√±al correspondiente al valor de bit "1" - como vimos en los gr√°ficos, 44100 Hz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora necesitamos "generar" silencio. </font><font style="vertical-align: inherit;">Hacemos esto neutralizando:</font></font><br>
<br>
<pre><code class="python hljs">sample_rate = <span class="hljs-number">98000.0</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_silence</span>(<span class="hljs-params">duration_milliseconds=<span class="hljs-number">5</span></span>):</span><font></font>
    fragment = []<font></font>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)): <font></font>
        fragment.append(<span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para generar sonido, utilizaremos una onda sinusoidal (la informaci√≥n se puede leer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sinewave</span>(<span class="hljs-params">
        freq=<span class="hljs-number">41000.0</span>, 
        duration_milliseconds=<span class="hljs-number">5</span>, 
        volume=<span class="hljs-number">0.5</span></span>):</span><font></font>
    fragment = []<font></font>
    amplitude = volume * <span class="hljs-number">32767.0</span>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)):<font></font>
        fragment.append(amplitude * math.sin(<span class="hljs-number">2</span> * math.pi * freq * ( x / sample_rate )))
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora la cosa es peque√±a: queda por convertir la contrase√±a en bits y luego en sonido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: El bot usa la pista de video de entrada original para superponer su mensaje, como se mencion√≥ anteriormente. </font><font style="vertical-align: inherit;">Por lo tanto, debe agregar algunos bytes cero despu√©s de la contrase√±a para borrar toda la clave del bot, y no solo su comienzo (la longitud de la clave fue de 36 bytes).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generaci√≥n de sonido</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs">    audio = []<font></font>
    f = open(input_file, <span class="hljs-string">'rb'</span>)
    <span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> f.read():<font></font>
        a = character<font></font>
        b8 = a &amp; <span class="hljs-number">0b00000001</span> 
        b7 = (a &amp; <span class="hljs-number">0b00000010</span>) &gt;&gt; <span class="hljs-number">1</span> 
        b6 = (a &amp; <span class="hljs-number">0b00000100</span>) &gt;&gt; <span class="hljs-number">2</span>
        b5 = (a &amp; <span class="hljs-number">0b00001000</span>) &gt;&gt; <span class="hljs-number">3</span>
        b4 = (a &amp; <span class="hljs-number">0b00010000</span>) &gt;&gt; <span class="hljs-number">4</span>
        b3 = (a &amp; <span class="hljs-number">0b00100000</span>) &gt;&gt; <span class="hljs-number">5</span>
        b2 = (a &amp; <span class="hljs-number">0b01000000</span>) &gt;&gt; <span class="hljs-number">6</span>
        b1 = (a &amp; <span class="hljs-number">0b10000000</span>) &gt;&gt; <span class="hljs-number">7</span>
        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b2 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b3 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b4 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b5 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b6 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b7 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b8 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora crearemos el archivo wave terminado:</font></font><br>
<br>
<pre><code class="python hljs">wav_file=wave.open(file_name,<span class="hljs-string">"w"</span>)<font></font>
    nchannels = <span class="hljs-number">1</span>
    sampwidth = <span class="hljs-number">2</span><font></font>
    nframes = len(audio)<font></font>
    comptype = <span class="hljs-string">"NONE"</span>
    compname = <span class="hljs-string">"not compressed"</span><font></font>
    wav_file.setparams((nchannels, sampwidth, sample_rate, nframes, comptype, compname))<font></font>
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> audio:<font></font>
        wav_file.writeframes(struct.pack(<span class="hljs-string">'h'</span>, int(sample)))<font></font>
    wav_file.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Guardamos nuestra pista, por ejemplo, en pass.wav. </font><font style="vertical-align: inherit;">En el camino, verificamos con nuestro decodificador stego si se reconoce la contrase√±a. </font><font style="vertical-align: inherit;">Si todo est√° bien, obtenemos un nuevo video con una contrase√±a del video original my_video.mp4, reemplazando la pista de audio:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7y/vg/_u/7yvg_ulbp5wmx8jmz5vmxucgogu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora tenemos que hacer VideoNote de esto. </font><font style="vertical-align: inherit;">Puede intentar buscar los que funcionen (algunos de los participantes, por ejemplo, encontraron @TelescopyBot), o puede escribir su bot usando TelegramAPI.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rk/_4/np/rk_4nphgkerx68klet43x0npzrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 De todos modos, adelante a nuestro bot:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3x/li/0g/3xli0gyrmnawsnl6fyqa90slv6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recibimos una nueva ronda y felicitaciones (¬°habr√≠amos hecho un trabajo as√≠!), Decodificamos el audio de acuerdo con el escenario ya resuelto, y obtuvimos la clave: "nq2020SyOMK7SnnJP1sNlvbTs8zt35vUrrsD" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, la esteganograf√≠a se considera una de las √°reas m√°s dif√≠ciles de ciberseguridad sin ninguna raz√≥n. ¬°Intenta adivinar todas estas </font><font style="vertical-align: inherit;">cosas </font><font style="vertical-align: inherit;">aqu√≠! </font><font style="vertical-align: inherit;">Pero los participantes de NeoQUEST mostraron una excelente destreza y sentido del humor durante esta tarea, por lo que nos dirigimos a nuestra sincera admiraci√≥n (desde las felicitaciones del robot).</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499356/index.html">Hackintosh en Powermac G5 o c√≥mo ensamblar una estaci√≥n de trabajo. Parte 2</a></li>
<li><a href="../es499358/index.html">PEP 257 en ruso. (Acuerdo de cadenas de documentos)</a></li>
<li><a href="../es499360/index.html">Crear y configurar la red Mesh seg√∫n su propia experiencia, as√≠ como algunas cifras y an√°lisis</a></li>
<li><a href="../es499362/index.html">Marat√≥n remoto Semana 2: flujos de trabajo</a></li>
<li><a href="../es499364/index.html">Alexey Kapterev: Pensamiento cr√≠tico 101 (Parte 1)</a></li>
<li><a href="../es499368/index.html">Acerca de los verbos compuestos 4 (entrada / salida)</a></li>
<li><a href="../es499370/index.html">Mis preguntas CSS favoritas con respuestas detalladas</a></li>
<li><a href="../es499374/index.html">Examen de los datos de proliferaci√≥n de COVID-19 utilizando diferencias de primer orden. Y que sali√≥ de eso</a></li>
<li><a href="../es499376/index.html">Un poco sobre el dispositivo de la radio moderna en el ejemplo de HackRF One</a></li>
<li><a href="../es499378/index.html">Crea tu primera prueba de cipr√©s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>