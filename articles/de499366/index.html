<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õèÔ∏è üë®üèø‚Äç‚öïÔ∏è üéôÔ∏è Geo-Chat, sch√§dliche Bots und Steganographie: bereicherndes Wissen √ºber Telegramm üë®üèæ‚Äçüè´ üôçüèø üí∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Was wissen Sie √ºber Telegramme in Telegramm? Und k√∂nnen Sie Steganographie in VideoNote (im Volksmund - Round-Robin) unterscheiden? Wir analysieren ge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Geo-Chat, sch√§dliche Bots und Steganographie: bereicherndes Wissen √ºber Telegramm</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/499366/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/r-/kn/lsr-knoirt_c2eklbngtrv43ys4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was wissen Sie √ºber Telegramme in Telegramm? </font><font style="vertical-align: inherit;">Und k√∂nnen Sie Steganographie in VideoNote (im Volksmund - Round-Robin) unterscheiden? </font><font style="vertical-align: inherit;">Wir analysieren </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genau</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Aufgabe </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">NeoQUEST-2020</font></a><font style="vertical-align: inherit;"> , die unserer Unterst√ºtzung die meisten Fragen und Ausrufe gestellt hat! </font><font style="vertical-align: inherit;">Spoiler: Ja, und hier wird es auch ein bisschen Krypto geben :)</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Legende finden </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">wir</font></a><font style="vertical-align: inherit;"> auf Instagram </font><font style="vertical-align: inherit;">einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Profil eines fahrenden Roboters. </font><font style="vertical-align: inherit;">Nichts Au√üergew√∂hnliches, oder? </font><font style="vertical-align: inherit;">Also haben wir uns auch daf√ºr entschieden, aber wir m√ºssen die Aufgabe noch l√∂sen, also betrachten wir alle Bilder im Profil sorgf√§ltig und suchen nach zumindest einigen Hinweisen. </font><font style="vertical-align: inherit;">Eine kleine Meditation √ºber ein wundersch√∂nes Bild des Baikalsees, und wir kommen zu der Erkenntnis, dass der Hinweis im letzten Beitrag ist:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/f3/yp/wgf3ypumnzx-gms9aj5ixn7qllw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dank des Bildes verstehen wir, dass wir Baikal (Shaman Rock) und Telegramm irgendwie verbinden m√ºssen ("Du kannst meinem beitreten ..." - erinnert es nichts daran?). </font><font style="vertical-align: inherit;">Zuerst haben wir beschlossen, den Teilnehmern keinen direkten Hinweis auf Geo-Chat zu geben (und genau das ist es!). Viele von ihnen haben die Aufgabe erfolgreich mit einem Emulator oder einem mobilen Ger√§t bew√§ltigt, mit dem sie den Geostandort √§ndern k√∂nnen. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shamanim Wir setzen die</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Koordinaten (53.20074, 107.349426) (Sie k√∂nnen mit dem Auge) im Bereich des Shamanka-Felsens und bereiten uns auf das Schwierigste vor - das Warten. </font><font style="vertical-align: inherit;">Das Telegramm arbeitet seltsamerweise mit der Geopositionierung und ruft relevante Kontakte und Chats f√ºr eine Stunde auf. </font><font style="vertical-align: inherit;">F√ºr unseren Flei√ü und unsere Geduld werden wir voll belohnt - der gew√ºnschte Chat wird im Bereich Kontakte angezeigt -&gt; Personen in der N√§he finden -&gt; Gruppen in der N√§he.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/z_/ti/cbz_tiwdqa0j0cqdikmwjob704y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voila, wir sind im Gesch√§ft! </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_c/or/zt/_corztflxylgeewrehp61prvssu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Bot stellt uns vor eine Aufgabe in Form einer Datei some.bytes mit nicht identifizierten Inhalten, in der wir die Zeilen "Decrypt me" und "Apocalypse Spares Nobody" lesen k√∂nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verstehen die erste Zeile ohne Probleme, aber was bedeutet die zweite? Hier teilten sich die Teilnehmer in zwei Lager auf: Einige schrieben uns per Post, weil sie in eine Sackgasse gerieten, w√§hrend andere den Satz "Apocalypse Spares Nobody" sorgf√§ltig betrachteten und dies erkannten ? Recht! Gutes altes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Format </font><font style="vertical-align: inherit;">( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir bereits dar√ºber geschrieben, wie man es analysiert).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/vr/k4/bbvrk4nu0xsdayswyptuv2z1gpw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lass es uns richtig machen. Im Inneren befinden sich 2 Strukturen. In einem finden wir eine Reihe von Bytes mit der Bezeichnung "Decrypt me", von denen wir annehmen, dass dies Chiffretext ist. In der zweiten Struktur sehen wir zwei Zahlen. Es ist unwahrscheinlich, dass dies ein Schl√ºssel ist, den der Teilnehmer gro√üz√ºgig zusammen mit dem Chiffretext pr√§sentiert, was h√∂chstwahrscheinlich bedeutet. Wir haben es mit einem √∂ffentlichen Schl√ºssel zu tun. Alle gesammelten Informationen f√ºhren uns zu der offensichtlichen Schlussfolgerung - warum nicht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausprobieren </font><font style="vertical-align: inherit;">? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben also ein Modul und einen offenen Indikator, der √ºbrigens ziemlich gro√ü ist. Nach einer </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">krampfhaften Untersuchung der RSA f√ºr einige</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √úberlegungen kommen wir zu dem Schluss, dass der geschlossene Indikator klein ist, was bedeutet das? Bingo! Wir k√∂nnen definitiv B√∂sewichte spielen und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wieners Angriff nutzen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir dachten , </font><font style="vertical-align: inherit;">es durch selbst f√ºr diejenigen , </font><font style="vertical-align: inherit;">die nicht wie Kryptographie tun - Sie eine fertige Version des Angriffs verwenden k√∂nnten zum Beispiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieses</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann erhalten wir den Wert einer geschlossenen Figur </font></font><code>d=40553818206320299896275948250950248823966726834704013657854904761789429403771</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und entschl√ºsseln den Chiffretext : </font></font><code>key=nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u;pass=passCxws3jzYhp0HD5Fy84</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten den Schl√ºssel "nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u" f√ºr den ersten Teil des Jobs und das Passwort "passCxws3jzYhp0HD5Fy84", das Sie ben√∂tigen, um den Bot-Vertreter zu f√ºttern. </font><font style="vertical-align: inherit;">Es befindet sich unter den Chat-Teilnehmern unter dem Namen @neoquestbot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir nach Erhalt des ersten Schl√ºssels auf der positiven Welle sind, stellen wir nicht sofort fest, dass der Bot in der Kommunikation w√§hlerisch ist, und sagen st√§ndig, dass er den Gespr√§chspartner nicht sieht:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ky/t_/exkyt__66acqprkte1kk_hljuge.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber der Bot empf√§ngt gerne VideoNote-Rundennachrichten und beantwortet sie sogar ... in derselben Rundenform:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/tk/k4/gvtkk4hr8u_a8gsidkkqijtcuzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass Video und Ton gleich sind, aber dies ist nur auf den ersten Blick. </font><font style="vertical-align: inherit;">Was ist, wenn unser Bot uns geheime Zeichen gibt? </font><font style="vertical-align: inherit;">Um dies herauszufinden, speichern wir das Originalvideo und vergleichen es mit der Antwort des Bots. </font><font style="vertical-align: inherit;">Daf√ºr und f√ºr die n√§chsten Schritte ist das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket gro√üartig f√ºr uns </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mal sehen, was da ist:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/re/jy/z0/rejyz0tnqx0lgvvcggpctdv2elq.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/e3/_v/rie3_vg77u1j1txjch9te5a8y1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Format aac -&gt; flac, Frequenz 44100 Hz -&gt; 98000 Hz. </font><font style="vertical-align: inherit;">Sie fanden heraus, dass wir weiter mit Audio arbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit einer geschickten Bewegung der H√§nde ziehen wir es aus dem Video heraus:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/er/ql/jh/erqljhyvzkhdq34zoxmfvl7ezty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das gleiche kann mit unserer urspr√ºnglichen Nachricht gemacht werden, damit wir sie sp√§ter vergleichen k√∂nnen. </font><font style="vertical-align: inherit;">√ñffnen Sie aus Gr√ºnden der √úbersichtlichkeit beide Spuren in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audacity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/ga/gq/gdgagqn_qtefqtnbyphj2ud0b00.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Amplitudensprung in der Audioantwort des Bots f√§llt sofort auf (besonders seltsam, wenn wir √ºberhaupt geschwiegen haben). </font><font style="vertical-align: inherit;">Bei n√§herer Betrachtung stellen wir die klaren Grenzen der Intervalle w√§hrend des Wechsels der "Wellenstille" fest:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mu/7f/zp/mu7fzposl6z9ozjrxanvjfnh2hw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir empfehlen, alle Dinge beiseite zu legen und ein wenig zu z√§hlen. </font><font style="vertical-align: inherit;">Wir analysieren nach Fragmenten: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 - 0,005 - Stille </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,005 - 0,01 - Welle </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0, 01 - 0,0225 - Stille </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,025 - 0,04 - Welle </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,04 - 0,045 - Stille </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das kleinste Intervall betr√§gt 0,005 und alle anderen Intervalle sind Vielfache von 0,005. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir nehmen eine Welle von 0,005 f√ºr 1 und Stille f√ºr 0 an. Wir erhalten nichts weiter als einen Bin√§rcode! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erinnern uns, dass sich die Frequenz ge√§ndert hat, und versuchen, das Spektrum-Diagramm (Analyse -&gt; Spektrum-Diagramm) zu betrachten:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/us/g0/7pusg01eyco5oawp9fyw92rbpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen, dass das st√§rkste Signal bei einer Frequenz von ~ 44100 Hz liegt, was Ultraschall ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann sollten Sie nur mit hohen Frequenzen arbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tats√§chlich √ºberlagert der Bot sein Signal dem Originalaudio im h√∂rbaren Spektrum. Und diejenigen Teilnehmer, die im Originalvideo Ton hatten, bemerkten dies in Audacity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir schneiden die hohen Frequenzen mit einem Hochpassfilter entweder in Audacity oder im selben ffmpeg ab:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/tk/tc/3ctktc0fgdc9zevjijzypncxb9o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben also eine 16-Bit-Mono-WAV-Datei. Es besteht aus einem Header, einem unkomprimierten Audiostream und Metadaten. Der Audiostream selbst ist in Frames unterteilt (und Frames k√∂nnen mehrere Samples speichern, dies ist jedoch eine v√∂llig andere Geschichte), in unserem Fall jeweils 16 Bit (dies wird durch die Buchstaben pcm_s16 in den Screenshots angezeigt). Frames sind Bitfolgen, die die Amplitude der Welle gleichzeitig f√ºr einen oder mehrere Kan√§le (in unserem Fall f√ºr einen) beschreiben. Die Abtastfrequenz des Audiostreams betr√§gt 98000 Bilder (dh 98000 Bilder pro Sekunde), 490 Bilder pro 0,005 Sekunden Intervall. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher arbeiten wir weiter nach einem einfachen Algorithmus: Wir lesen jeweils 490 Frames, bestimmen, ob es sich um eine Welle oder eine Stille handelt, und setzen abh√§ngig davon das Bit auf 0 oder 1. Wir </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
verwenden Python und ein Paket</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Welle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Parsen von WAV-Dateien. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn beim √ñffnen der Datei der Fehler "wave.Error: unknown format: 65534" auftritt, ersetzen Sie "wFormatTag" im Header von "FE FF" auf "01 00":</font></font><br>
<br>
<pre><code class="python hljs">fh = open(input_file, <span class="hljs-string">"r+b"</span>)<font></font>
fh.seek(<span class="hljs-number">20</span>)<font></font>
fh.write(<span class="hljs-string">b'\x01\x00'</span>)<font></font>
fh.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√ñffnen Sie also die Datei, verarbeiten Sie 490 Frames und berechnen Sie den Durchschnittswert:</font></font><br>
<br>
<pre><code class="python hljs">file = wave.open(input_file,<span class="hljs-string">"r"</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(file.getnframes()/<span class="hljs-number">490</span>)+<span class="hljs-number">1</span>):<font></font>
        frames = file.readframes(<span class="hljs-number">490</span>)<font></font>
        bit = <span class="hljs-number">0</span>
        sum = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">246</span>):<font></font>
            frame_bytes = frames[k*<span class="hljs-number">2</span>:k*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>]<font></font>
            sum += int.from_bytes(frame_bytes, <span class="hljs-string">"big"</span>)
        <span class="hljs-keyword">if</span> sum/<span class="hljs-number">490</span> &gt; <span class="hljs-number">16000</span>:<font></font>
            bit = <span class="hljs-number">1</span><font></font>
        bits.append(bit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist m√∂glich, dass dort, wo Stille herrschen sollte (vergleiche mit dem Bild in Audacity), Rauschen verbleibt. </font><font style="vertical-align: inherit;">Daher setzen wir den Schwellenwert (sei 16000), bei dessen √úberschreitung wir das Signal als 1 betrachten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann gruppieren wir die Bits in Bytes:</font></font><br>
<br>
<pre><code class="python hljs">bytes = []    
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(len(bits)/<span class="hljs-number">8</span>)+<span class="hljs-number">1</span>):<font></font>
        b1 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-8</span>]<font></font>
        b2 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-7</span>]<font></font>
        b3 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-6</span>]<font></font>
        b4 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-5</span>]<font></font>
        b5 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-4</span>]<font></font>
        b6 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-3</span>]<font></font>
        b7 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-2</span>]<font></font>
        b8 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-1</span>]<font></font>
        byte = (b1 &lt;&lt; <span class="hljs-number">7</span>) | (b2 &lt;&lt; <span class="hljs-number">6</span>) | (b3 &lt;&lt; <span class="hljs-number">5</span>) | (b4 &lt;&lt; <span class="hljs-number">4</span>) | (b5 &lt;&lt; <span class="hljs-number">3</span>) | (b6 &lt;&lt; <span class="hljs-number">2</span>) | (b7 &lt;&lt; <span class="hljs-number">1</span>) | b8<font></font>
        bytes.append(byte.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">'big'</span>)) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn alles richtig gemacht wurde, ist das Ergebnis die Zeichenfolge "Givemethepassword". </font><font style="vertical-align: inherit;">Da der Bot mithilfe der Steganografie in Kreisen kommuniziert, ist es logisch, ein Passwort daf√ºr (und wir haben es zusammen mit dem Schl√ºssel als Ergebnis der Entschl√ºsselung erhalten) im selben Format einzugeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie zun√§chst eine Audiospur mit einem Kennwort. </font><font style="vertical-align: inherit;">Dazu verwenden wir die Daten, die w√§hrend der Analyse der Nachricht vom Bot erhalten wurden: Abtastfrequenz 98000 Hz; </font><font style="vertical-align: inherit;">die Dauer des Signals, das jedes Bit beschreibt, betr√§gt 5 ms; </font><font style="vertical-align: inherit;">Die Signalfrequenz entspricht dem Bitwert ‚Äû1‚Äú - wie aus den Diagrammen hervorgeht, 44100 Hz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen wir Stille "erzeugen". </font><font style="vertical-align: inherit;">Wir tun dies, indem wir neutralisieren:</font></font><br>
<br>
<pre><code class="python hljs">sample_rate = <span class="hljs-number">98000.0</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_silence</span>(<span class="hljs-params">duration_milliseconds=<span class="hljs-number">5</span></span>):</span><font></font>
    fragment = []<font></font>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)): <font></font>
        fragment.append(<span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Schall zu erzeugen, verwenden wir eine Sinuswelle (Informationen finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sinewave</span>(<span class="hljs-params">
        freq=<span class="hljs-number">41000.0</span>, 
        duration_milliseconds=<span class="hljs-number">5</span>, 
        volume=<span class="hljs-number">0.5</span></span>):</span><font></font>
    fragment = []<font></font>
    amplitude = volume * <span class="hljs-number">32767.0</span>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)):<font></font>
        fragment.append(amplitude * math.sin(<span class="hljs-number">2</span> * math.pi * freq * ( x / sample_rate )))
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist die Sache klein: Es bleibt, das Passwort in Bits und dann in Sound umzuwandeln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hinweis: Der Bot verwendet die urspr√ºngliche Eingangsvideospur, um seine Nachricht zu √ºberlagern, wie bereits erw√§hnt. </font><font style="vertical-align: inherit;">Daher m√ºssen Sie nach dem Kennwort einige Null-Bytes hinzuf√ºgen, um den gesamten Schl√ºssel aus dem Bot herauszusch√ºtteln und nicht nur seinen Anfang (die Schl√ºssell√§nge betrug 36 Byte).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klangerzeugung</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs">    audio = []<font></font>
    f = open(input_file, <span class="hljs-string">'rb'</span>)
    <span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> f.read():<font></font>
        a = character<font></font>
        b8 = a &amp; <span class="hljs-number">0b00000001</span> 
        b7 = (a &amp; <span class="hljs-number">0b00000010</span>) &gt;&gt; <span class="hljs-number">1</span> 
        b6 = (a &amp; <span class="hljs-number">0b00000100</span>) &gt;&gt; <span class="hljs-number">2</span>
        b5 = (a &amp; <span class="hljs-number">0b00001000</span>) &gt;&gt; <span class="hljs-number">3</span>
        b4 = (a &amp; <span class="hljs-number">0b00010000</span>) &gt;&gt; <span class="hljs-number">4</span>
        b3 = (a &amp; <span class="hljs-number">0b00100000</span>) &gt;&gt; <span class="hljs-number">5</span>
        b2 = (a &amp; <span class="hljs-number">0b01000000</span>) &gt;&gt; <span class="hljs-number">6</span>
        b1 = (a &amp; <span class="hljs-number">0b10000000</span>) &gt;&gt; <span class="hljs-number">7</span>
        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b2 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b3 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b4 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b5 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b6 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b7 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b8 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt erstellen wir die fertige Wave-Datei:</font></font><br>
<br>
<pre><code class="python hljs">wav_file=wave.open(file_name,<span class="hljs-string">"w"</span>)<font></font>
    nchannels = <span class="hljs-number">1</span>
    sampwidth = <span class="hljs-number">2</span><font></font>
    nframes = len(audio)<font></font>
    comptype = <span class="hljs-string">"NONE"</span>
    compname = <span class="hljs-string">"not compressed"</span><font></font>
    wav_file.setparams((nchannels, sampwidth, sample_rate, nframes, comptype, compname))<font></font>
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> audio:<font></font>
        wav_file.writeframes(struct.pack(<span class="hljs-string">'h'</span>, int(sample)))<font></font>
    wav_file.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir speichern unseren Track zum Beispiel in pass.wav. </font><font style="vertical-align: inherit;">Unterwegs pr√ºfen wir mit unserem Stego-Decoder, ob das Passwort erkannt wird. </font><font style="vertical-align: inherit;">Wenn alles in Ordnung ist, erhalten wir ein neues Video mit einem Passwort aus dem Originalvideo my_video.mp4, das die Audiospur ersetzt:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7y/vg/_u/7yvg_ulbp5wmx8jmz5vmxucgogu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt m√ºssen wir VideoNote daraus machen. </font><font style="vertical-align: inherit;">Sie k√∂nnen versuchen, nach funktionierenden zu suchen (einige der Teilnehmer haben beispielsweise @TelescopyBot gefunden), oder Sie k√∂nnen Ihren Bot mit TelegramAPI schreiben.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rk/_4/np/rk_4nphgkerx68klet43x0npzrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Wie auch immer, freuen wir uns auf unseren Bot:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3x/li/0g/3xli0gyrmnawsnl6fyqa90slv6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bekommen eine neue Runde und Gl√ºckw√ºnsche (wir h√§tten so einen Job gemacht!), Dekodierten das Audio gem√§√ü dem bereits ausgearbeiteten Szenario und bekamen den Schl√ºssel: ‚Äûnq2020SyOMK7SnnJP1sNlvbTs8zt35vUrrsD‚Äú </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Tat wird Steganographie ohne Grund als einer der schwierigsten Bereiche der Cybersicherheit angesehen - versuchen Sie, all dies hier zu erraten! </font><font style="vertical-align: inherit;">Aber die NeoQUEST-Teilnehmer zeigten bei dieser Aufgabe gro√üe Geschicklichkeit und Sinn f√ºr Humor. Deshalb sprechen wir unsere aufrichtige (von den Bot-Gl√ºckw√ºnschen) aufrichtige Bewunderung an!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499356/index.html">Hackintosh auf Powermac G5 oder wie man eine Workstation zusammenbaut. Teil 2</a></li>
<li><a href="../de499358/index.html">PEP 257 auf Russisch. (Docstrings-Vereinbarung)</a></li>
<li><a href="../de499360/index.html">Erstellen und Konfigurieren des Mesh-Netzwerks nach Ihren eigenen Erfahrungen sowie anhand einiger Zahlen und Analysen</a></li>
<li><a href="../de499362/index.html">Remote Marathon Woche 2: Workflows</a></li>
<li><a href="../de499364/index.html">Alexey Kapterev: Kritisches Denken 101 (Teil 1)</a></li>
<li><a href="../de499368/index.html">√úber Phrasal Verbs-4 (rein / raus)</a></li>
<li><a href="../de499370/index.html">Meine Lieblings-CSS-Fragen mit detaillierten Antworten</a></li>
<li><a href="../de499374/index.html">Untersuchung von COVID-19-Proliferationsdaten unter Verwendung von Unterschieden erster Ordnung. Und was kam daraus?</a></li>
<li><a href="../de499376/index.html">Ein wenig √ºber das Ger√§t des modernen Radios am Beispiel von HackRF One</a></li>
<li><a href="../de499378/index.html">Erstellen Sie Ihren ersten Zypressentest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>