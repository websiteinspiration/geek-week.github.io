<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💠 🥤 🙎 HighLoad ++, Mikhail Raichenko (ManyChat): presque sans magie, ni à quel point il est facile de distribuer un flux vidéo térabit 🙎🏽 👊🏿 👢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La prochaine conférence HighLoad ++ se tiendra les 6 et 7 avril 2020 à Saint-Pétersbourg. Détails et billets ici . HighLoad ++ Moscou 2018. Salle «Del...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>HighLoad ++, Mikhail Raichenko (ManyChat): presque sans magie, ni à quel point il est facile de distribuer un flux vidéo térabit</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/488148/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La prochaine conférence HighLoad ++ se tiendra les 6 et 7 avril 2020 à Saint-Pétersbourg. </font><font style="vertical-align: inherit;">Détails et billets </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">HighLoad ++ Moscou 2018. Salle «Delhi + Calcutta». </font><font style="vertical-align: inherit;">8 novembre, 14 h </font><font style="vertical-align: inherit;">Résumés et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">présentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ym/ji/ba/ymjiba---vkcs5ibbqbk9kcz8ny.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je travaille dans l'équipe VKontakte et je développe un système de diffusion vidéo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le rapport, je partagerai les caractéristiques du développement du backend, l'évolution de notre système et les solutions techniques auxquelles nous sommes parvenus: </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment nous avons fait le backend de diffusion vidéo et le processus d'évolution tel qu'il est;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'impact des exigences commerciales et opérationnelles sur l'architecture;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Attendez» et «réessayez» échouera;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment les tâches les plus simples sont compliquées par le nombre d'utilisateurs;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment réduire la latence sans UDP;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous effectuons des tests de résistance 2 fois par jour, ou ce que Clover nous a aidé.</font></font></li>
</ul><a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Raichenko (ci-après - MR):</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Une petite excursion. </font><font style="vertical-align: inherit;">Je vais vous parler des personnes qui nous diffusent, du direct (en direct), des plateformes sur lesquelles nous recevons le flux vidéo et que nous distribuons. </font><font style="vertical-align: inherit;">À la fin, je parlerai de l’architecture actuelle du live, de ses limites et de ses capacités, ainsi que de la façon dont l’architecture actuelle a survécu à un effet tel que «Clover».</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_h/bm/lt/_hbmlt0c2ek74zfr89jdff3wtsw.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos des diffusions en direct. </font><font style="vertical-align: inherit;">Plan du rapport</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout d'abord, je vais parler un peu des diffusions en direct et des streamers eux-mêmes, en nous envoyant du contenu vidéo que nous montrons à d'autres téléspectateurs.</font></font></li>
<li>         .    ?     ,     , , ,   -  - , - , .   ,        :   ,  – .</li>
<li>    . ,      .     .     ,      ,     .</li>
<li>  ,     ,   .   ,         .  ,   ,   ,  , ,   2014-2015 .     ,      .</li>
<li>       .  ,                    .</li>
<li>,    .          ,    . ,    .</li>
<li>    ,    .      .</li>
<li>  ,    ,      «»,    .</li>
</ul><br>
<img src="https://habrastorage.org/webt/lz/mm/jw/lzmmjwth6qvdlryupzhegpftal0.jpeg"><br>
<br>
<h3>     </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les services de diffusion ressemblent à ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dt/2r/va/dt2rvaddozkmjrcp-1ojlaixmr0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nous avons un streamer, il nous envoie un flux RTMP et nous montrons le public - rien de surprenant, rien de surnaturel. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ee/fx/kq/eefxkq8vknyi57vz-y-_ekw5pd0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'où vient le flux vidéo? Une source importante de trafic pour nous est notre application mobile VKlife. Qu'est-ce qui est bon chez lui? Dans celui-ci, nous pouvons contrôler entièrement la façon dont nous encodons la vidéo. Nous pouvons faire de nombreuses optimisations du côté client, de sorte que plus tard, avec un minimum de délais, le montrer à nos téléspectateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les inconvénients: les applications mobiles fonctionnent au-dessus des réseaux. Il peut s'agir de la 3G ... Dans tous les cas, ce sont presque toujours les réseaux mobiles, qui introduisent quelques retards - vous devez en outre tamponner les données côté application, afin que le flux se déroule aussi bien que possible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxième source est les streamers avec OBS, Wirecast ou ceux qui diffusent à partir d'autres applications de bureau. </font><font style="vertical-align: inherit;">Il s'agit d'un public assez large. </font><font style="vertical-align: inherit;">Parfois ce sont des séminaires, parfois - des flux de jeu (il y en a surtout beaucoup à partir de telles applications). </font><font style="vertical-align: inherit;">Du positif: il y a peu d'applications de ce type, nous pouvons donner à nos streamers de bonnes recommandations de réglage. </font><font style="vertical-align: inherit;">Mais en même temps, il y a beaucoup de paramètres et n'envoyez pas tout à fait le flux que nous voulons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième catégorie est le flux RTMP des serveurs de médias. </font><font style="vertical-align: inherit;">Il peut s'agir de très petits serveurs multimédias, c'est-à-dire d'un format domestique: une personne diffuse une vue sur la rue ou autre chose. </font><font style="vertical-align: inherit;">Ou des émissions assez sérieuses de nos partenaires: il peut y avoir n'importe quoi, il n'y en a pas beaucoup, mais au fond elles sont très importantes pour nous.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qui regarde?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, il s'agit d'une application mobile - tout est clair ici. Le plus gros problème est la latence du réseau. Des pros: nous pouvons personnaliser le lecteur - c'est pratique pour nous, bien, mais pas partout il s'avère à 100%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lecteur Web sur vk.com. Ici aussi, tout est simple - c'est un lecteur Web classique que vous pouvez ouvrir pour regarder. Une audience suffisamment large sur vk.com, beaucoup de téléspectateurs sur les émissions. Certaines émissions sont suspendues dans notre section «Vidéo» - il peut y en avoir des dizaines de milliers (parfois sans aucun RP), surtout s'il s'agit d'un contenu intéressant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, les chaînes sont suffisamment grandes pour les téléspectateurs qui sont assis sur un lecteur Web. Par conséquent, il y a beaucoup de trafic, y compris pour une diffusion.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le troisième est le lecteur Web VKontakte sur un site tiers. </font><font style="vertical-align: inherit;">Vous pouvez commencer à diffuser tout ce que vous voulez et accrocher un lecteur Web VKontakte sur votre site Web. </font><font style="vertical-align: inherit;">Vous pouvez devenir notre partenaire si vous avez du contenu intéressant: vous pouvez le suspendre vous-même, vous pouvez accrocher avec nous - comme vous le souhaitez. </font><font style="vertical-align: inherit;">Vous pouvez organiser vos émissions de cette manière, et tout fonctionnera.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparaison avec les appels vidéo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les appels vidéo, certaines distorsions d'image seront annulées. Les appels vidéo sont plus simples: nous pouvons dégrader considérablement l'image, mais en même temps nous devons maintenir une très bonne latence. Avec un long délai, le service sera absolument impossible à utiliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les émissions dans ce sens, c'est un peu l'inverse: nous devons maintenir une qualité d'image élevée, mais en même temps, nous pouvons augmenter la latence en raison de nombreux facteurs. Par exemple, le lecteur met en mémoire tampon le flux d'une manière ou d'une autre (il peut être une seconde, deux afin de survivre à la dégradation du réseau, par exemple), par conséquent, il n'a pas besoin de retards d'une seconde, milliseconde dans la plupart des cas. Vous pouvez vous efforcer pour cela, mais la nourriture n'est pas une condition préalable.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/7o/o6/j07oo6ceqiizh_lzdgjsgvgfwtq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec une vidéo ordinaire, la situation est exactement le contraire. </font><font style="vertical-align: inherit;">Nous avons besoin d'une très bonne qualité. </font><font style="vertical-align: inherit;">Dans le même temps, il est souhaitable de minimiser la taille de la vidéo, le rapport de débit binaire et la qualité, de sorte qu'avec le débit minimum, donner la meilleure solution. </font><font style="vertical-align: inherit;">Des pros: nous ne sommes pas limités dans le temps: au moment du téléchargement de la vidéo, nous avons suffisamment de temps pour optimiser la vidéo, voir comment la compresser de la meilleure façon, faire quelque chose, la faire glisser dans des caches, si nécessaire - en général, tout est suffisant D'ACCORD. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jf/r-/cc/jfr-cco9dozhxgqqnuw57opkqjk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En direct, la situation est, encore une fois, le contraire: nous avons très peu de temps pour le transcodage. </font><font style="vertical-align: inherit;">En même temps, il y a peu d'opportunités, mais il n'y a aucune attente pour la diffusion. </font><font style="vertical-align: inherit;">Le public nous pardonnera si nous avons du soutien ou si la qualité n'est pas très bonne.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Première version</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est assez attendu: en </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/gt/bw/3fgtbwzvl3uf680sfzsf8kjette.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fait, c'est un peu différent: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vu/9r/zu/vu9rzujgkidpvrb66qzgbvapljo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Streamer - serveur multimédia - niveau de cache - téléspectateurs". </font><font style="vertical-align: inherit;">En principe, cette version vous permet d'évoluer assez fortement. </font><font style="vertical-align: inherit;">Je dirais qu'il devrait déjà résister à des dizaines de milliers de spectateurs. </font><font style="vertical-align: inherit;">Il a d'autres inconvénients ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, si vous regardez ce circuit (diapositive précédente), vous pouvez voir qu'il n'est pas tolérant aux pannes. </font><font style="vertical-align: inherit;">Il faut deviner avec le serveur média pour bien équilibrer l'audience. </font><font style="vertical-align: inherit;">Nous ne pouvons pas bloquer de nombreux caches sur chaque serveur - c'est tout simplement cher. </font><font style="vertical-align: inherit;">Par conséquent, nous avons regardé, réalisé que c'était simple et clair, il y avait quelques possibilités de mise à l'échelle, mais évidemment quelque chose manquait ... Et nous avons commencé à formuler des exigences.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Besoins en infrastructure</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce qui est important?</font></font><br>
<br>
<ul>
<li> .     , ,    .            (       ).       (,  ).</li>
<li>.     : -,    (,    )      ; -,     –      ,    ,       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Livraison aux régions. </font><font style="vertical-align: inherit;">Aussi un point important! </font><font style="vertical-align: inherit;">Il est stupide de faire glisser tout le contenu vidéo de Pétersbourg ou de Moscou vers une sorte de Novossibirsk, Iekaterinbourg, ou même de Saint-Pétersbourg à Moscou. </font><font style="vertical-align: inherit;">Ce n'est pas très bon, car le retard du réseau sera long - il y aura des retards, tout sera en retard, et ce n'est pas bon. </font><font style="vertical-align: inherit;">Par conséquent, notre infrastructure doit tenir compte du fait que nous livrons du contenu aux régions.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commodité de fonctionnement et de surveillance. </font><font style="vertical-align: inherit;">Une propriété importante. </font><font style="vertical-align: inherit;">Étant donné que le système est volumineux, il existe de nombreux téléspectateurs, il est important d'envoyer des alertes aux administrateurs à temps en cas de problème, y compris la surveillance des produits et des mesures techniques.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/km/n1/e_/kmn1e_0ii74m9xilh_5rsic9l5a.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À quoi ressemble l'infrastructure de diffusion maintenant?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, nous sommes arrivés à une infrastructure assez simple mais efficace ...</font></font><br>
<br>
<ul>
<li> – ,       ( ,  ).   RTMP-,    .        ,  .</li>
<li> ,      ,     ,  ,   .       .  ,   ,   ,   – : , -,  (. .       ); -,     .</li>
<li>      .     –    ,   .        ,    ,    .      ,         (    ,  ).</li>
<li>         ,         (edge-).     ,  .    !</li>
<li>   –  edge-,      ,   .   :      ,   –    .</li>
</ul><br>
<img src="https://habrastorage.org/webt/2e/cu/qp/2ecuqpdeldwtxd6qjyi-x4q0_ke.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De façon intéressante? </font><font style="vertical-align: inherit;">Équilibrage! </font><font style="vertical-align: inherit;">Dans ce schéma, nous choisissons l'équilibrage, essayons d'envoyer des téléspectateurs qui regardent le même flux vers chaque serveur de périphérie. </font><font style="vertical-align: inherit;">La localité du cache est très importante ici, car il peut y avoir de nombreux serveurs périphériques; </font><font style="vertical-align: inherit;">et si nous n'observons pas à la fois le temporaire et la localité du cache du point de vue du flux, nous surchargerons la couche interne. </font><font style="vertical-align: inherit;">Cela ne nous plairait pas non plus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, nous équilibrons de la manière suivante: nous sélectionnons un certain serveur périphérique pour la région dans laquelle nous envoyons des spectateurs, et nous envoyons jusqu'à ce que nous commencions à comprendre qu'un certain remplissage s'est produit et doit être envoyé à un autre serveur. </font><font style="vertical-align: inherit;">Le circuit est simple et fonctionne de manière très fiable. </font><font style="vertical-align: inherit;">Naturellement, pour différents flux, vous choisissez une séquence différente de serveurs Edge (la séquence dans laquelle nous envoyons des spectateurs). </font><font style="vertical-align: inherit;">Par conséquent, l'équilibrage fonctionne tout simplement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous donnons également au client un lien vers un serveur Edge disponible. </font><font style="vertical-align: inherit;">Ceci est fait pour qu'en cas de panne du serveur de périphérie, nous puissions rediriger le visualiseur vers un autre. </font><font style="vertical-align: inherit;">Autrement dit, lorsque le téléspectateur regarde la diffusion, il reçoit un lien vers le serveur souhaité toutes les quelques secondes. </font><font style="vertical-align: inherit;">S'il comprend que le lien doit être différent, il change (le joueur bascule) et continue de regarder la diffusion à partir d'un autre serveur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre rôle important des serveurs Edge est la protection du contenu. </font><font style="vertical-align: inherit;">Toute la protection du contenu y a lieu essentiellement. </font><font style="vertical-align: inherit;">Nous avons notre propre module nginx pour cela. </font><font style="vertical-align: inherit;">Il est quelque peu similaire à Security Link.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise à l'échelle et équilibrage</font></font></h3><br>
<ul>
<li>   . ,        :     ,       .          edge-,        .     .     .    …   ,     –    ,  --    – ,  – , , ,   –  !   –        .</li>
<li>      .  ,  ,         ,    ,       :     .       (   )    ,    –   ,   . ,    ,     ,      edge-.</li>
<li>   ,   ,       ,     .</li>
</ul><br>
<img src="https://habrastorage.org/webt/19/nj/i8/19nji8vwkh_kjrrsm9d698hf5ji.jpeg"><br>
<br>
<h3>   ?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des principaux protocoles que nous avions était RTMP (non seulement pour l'entrée, mais aussi pour la distribution de contenu). Le principal avantage est une faible latence. Cela peut prendre une demi-seconde, une seconde, deux secondes. En fait, les avantages s'arrêtent là ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u7/fv/al/u7fvaloyunlxmyavp5rjemer4sw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce protocole de streaming est difficile à surveiller - il est fermé dans un sens, malgré le fait qu'il existe une spécification. Le lecteur Flash ne fonctionne plus (en fait, c'est «déjà tout»). Besoin d'assistance au niveau CDN - vous avez besoin de modules nginx spéciaux ou de votre propre logiciel pour transférer le flux normalement. Il existe également des difficultés avec les clients mobiles. Dans les clients mobiles, il est très mal pris en charge - des améliorations spéciales sont nécessaires, et tout cela est très difficile.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième protocole que nous avons utilisé est HLS. </font><font style="vertical-align: inherit;">Cela a l'air assez simple: c'est un fichier texte, le soi-disant fichier d'index. </font><font style="vertical-align: inherit;">Il contient des liens vers des fichiers d'index avec différentes autorisations, et les fichiers eux-mêmes contiennent des liens vers des segments multimédias. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w-/hl/vf/w-hlvfylbcsu1n6ksqlv7uy5e5a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment est-il bon? </font><font style="vertical-align: inherit;">C'est très simple, même s'il est un peu vieux. </font><font style="vertical-align: inherit;">Il vous permet d'utiliser CDN, c'est-à-dire que vous n'avez besoin que de nginx pour distribuer le protocole HLS. </font><font style="vertical-align: inherit;">C'est compréhensible en termes de suivi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ses avantages:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facilité d'utilisation - nginx en tant que serveur proxy;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il est facile de surveiller et de prendre des mesures (il vous suffit de surveiller à peu près la même chose que ce que vous surveillez sur votre site Web);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, ce protocole est le principal pour la livraison de contenu.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moins significatif:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">latence élevée.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/fa/ko/2_/fako2_ysvwvhaguijmddcna20eu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La latence HLS est en fait imbriquée dans le protocole lui-même; </font><font style="vertical-align: inherit;">comme un long temps de mise en mémoire tampon est nécessaire, le joueur est obligé d'attendre au moins lorsqu'un morceau est chargé, mais dans le bon sens, il doit attendre que deux morceaux (deux segments multimédias) soient chargés, sinon en cas de décalage, le client chargera le lecteur, et cela n'affecte pas très bien expérience utilisateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième point qui donne un délai dans HLS est la mise en cache. </font><font style="vertical-align: inherit;">La liste de lecture est mise en cache sur la couche interne et sur les serveurs Edge. </font><font style="vertical-align: inherit;">Même si nous mettons en cache, relativement parlant, pendant une seconde ou une demi-seconde, cela représente environ plus 2-3 secondes de retard. </font><font style="vertical-align: inherit;">Au total, il s'avère de 12 à 18 secondes - ce n'est pas très agréable, évidemment c'est mieux.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amélioration de HLS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec ces réflexions, nous avons commencé à améliorer HLS. Nous l'avons amélioré de manière assez simple: donnons un peu plus tôt le dernier segment multimédia de la playlist, pas encore enregistré. Autrement dit, dès que nous avons commencé à écrire le dernier segment média, nous l'annonçons immédiatement dans la playlist. Que se passe-t-il en ce moment? .. Le </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
temps tampon des joueurs est réduit. Le joueur croit qu'il a déjà tout téléchargé et commence calmement à télécharger les segments souhaités. De cette façon, nous «trichons» un peu le joueur, mais si nous surveillons bien «l'acier» (les charges dans le lecteur), cela ne nous fait pas peur - nous pouvons arrêter de donner le segment à l'avance, et tout reviendra à la normale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième point: nous gagnons un total d'environ 5-8 secondes. D'où viennent-ils? Cette durée de segment est de 2 à 4 secondes par segment, plus le temps de mise en cache de la liste de lecture (cela représente encore 2-3 secondes). De plus, notre retard diminue considérablement. Le délai est réduit de 12-15 secondes à 5-7. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quoi d'autre est bon dans cette approche? C'est en fait gratuit! Il suffit de vérifier si les joueurs sont compatibles avec cette approche. Ceux qui sont incompatibles, nous les envoyons aux anciennes URL et nous envoyons les lecteurs compatibles aux nouvelles URL. Nous n'avons pas besoin de mettre à niveau les anciens clients qui prennent en charge cela, ce qui est également important. Nous n'avons en fait pas besoin de modifier, de libérer les joueurs dans les clients mobiles. Nous n'avons pas besoin de développer un lecteur web. Cela semble assez bon!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0f/gm/tt/0fgmttjysv2w8rg8bmzdgzcdtz4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les inconvénients - la nécessité de contrôler le flux vidéo entrant. </font><font style="vertical-align: inherit;">Dans le cas d'un client mobile, nous pouvons le faire assez facilement (lorsque le flux provient d'un client mobile), ou transcoder sans échec, car le lecteur doit savoir combien de temps cela prend pour un segment de temps multimédia. </font><font style="vertical-align: inherit;">Et puisque nous l'annonçons avant qu'il ne soit réellement enregistré, nous devons savoir combien de temps il faudra pour l'enregistrer.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesures de qualité</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, nous avons amélioré HLS. </font><font style="vertical-align: inherit;">Maintenant, je veux dire comment nous surveillons et quelles mesures de qualité nous tirons: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3h/_y/iz/3h_yizx3clxbb18dzi-urr-oylq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des principales mesures de qualité est l'heure de début. </font><font style="vertical-align: inherit;">Idéalement, c'est lorsque vous faites défiler le client mobile avant la diffusion, appuyez sur le bouton et cela démarre immédiatement. </font><font style="vertical-align: inherit;">Ce serait idéal si cela commence avant d'appuyer sur le bouton, mais, malheureusement, uniquement lorsque vous appuyez sur.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième point est le retard du signal. Nous pensons que quelques secondes sont très bonnes, 10 secondes sont tolérables, 20-30 secondes sont très mauvaises. Pourquoi c'est important? Par exemple, pour les concerts et certains événements publics, il s'agit d'une métrique absolument sans importance, il n'y a pas de rétroaction; nous montrons simplement le flux - il vaut mieux ne pas prendre de retard qu'un léger retard. Et pour un flux où une sorte de conférence se déroule ou où une personne dit quelque chose et lui pose des questions, cela commence à être important, car ils posent beaucoup de questions dans les commentaires et je veux que le public reçoive des commentaires le plus tôt possible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre mesure importante est la mise en mémoire tampon et les retards. </font><font style="vertical-align: inherit;">En fait, cette métrique est importante non seulement du point de vue du client et de la qualité, mais du point de vue de la mesure dans laquelle nous pouvons «étirer» la livraison de HLS, de la quantité de données que nous pouvons extraire de nos serveurs. </font><font style="vertical-align: inherit;">Par conséquent, nous surveillons à la fois le temps tampon moyen dans les lecteurs et «l'acier». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le choix de la qualité des joueurs est compréhensible: les changements inattendus sont toujours ennuyeux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, il s'agit également d'une mesure importante.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surveillance</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons de nombreuses mesures de surveillance, mais ici, j'ai choisi ces mesures qui fonctionnent toujours en cas de problème:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ir/wy/me/irwymelifaedclj13razr83a85i.jpeg"><br>
<br>
<ul>
<li>-,    .   -   ,    .  ,  – ,              ( ,  –  ).</li>
<li> /     .  , ,  ,      ,        ,    .     .</li>
<li>  edge-.  ,       ,     edge-       .</li>
</ul><br>
<br>
<h3>  «»,       ?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais maintenant vous expliquer comment nous avons géré une application telle que "Player" lorsque nous avons utilisé notre infrastructure pour diffuser un flux vidéo avec des questions et des réponses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clover est un quiz en ligne. L'hôte dit quelque chose, demande: des questions tombent - vous répondez. 12 questions, 10 minutes de jeu, à la fin - une sorte de prix. Qu'est-ce qui est si compliqué? C'est la croissance! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A droite se trouve ce graphique: Le </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/i8/_e/hwi8_er_sdcw_gxczrgk3z41en0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pic [sur le graphique] est la charge sur les serveurs en termes d'API au moment du démarrage de «Clover». Le reste du temps est le flux habituel d'émissions. Cela ne peut pas être égal au nombre de téléspectateurs. C'est peut-être le nombre de demandes et la charge.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est difficile: en 5 minutes, un million de spectateurs sont venus vers nous au sommet. </font><font style="vertical-align: inherit;">Ils commencent à regarder la diffusion, à s'inscrire, à effectuer une sorte d'action, à demander une vidéo ... Cela semble être un jeu très simple, mais cela se produit dans un laps de temps très court (toutes les actions, y compris le jeu final) - cela donne une charge assez élevée.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles questions et quels défis avons-nous rencontrés?</font></font></h3><br>
<img src="https://habrastorage.org/webt/pd/ci/xh/pdcixhln_tmsracssi9qfy5ra5y.jpeg"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Croissance rapide. </font><font style="vertical-align: inherit;">Parfois, c'était + 50% par semaine. </font><font style="vertical-align: inherit;">Si, par exemple, vous avez 200 000 personnes mercredi, alors samedi ou dimanche, il pourrait y en avoir déjà 300. C'est beaucoup! </font><font style="vertical-align: inherit;">Des problèmes commencent à faire surface qui n'étaient pas visibles auparavant.</font></font></li>
<li>    2   .       .      ,  .       ,  , ,          ,         ,    .<br>
 12         . ,    ,     ,    , ,    -      ,     ,  …</li>
<li>      ,       .     , ,  200-300 ,         400-500.</li>
<li>- ,    ,   ,           3-5 .   ?    «»,    ,    ,         ,     .<br>
<br>
       (   3   ,   ),          ,       3-5 .    ?  –  ,  –     exponential backoff,        .<br>
<br>
  exponential on backoff:  – ,       2 ,   4,  8.             backend-.</li>
</ul><br>
<h3>    «»?</h3><br>
<img src="https://habrastorage.org/webt/-h/c_/gn/-hc_gnjjd-m7ujstbxa9edwnoms.jpeg"><br>
<ul>
<li>-,         .      ,    –   .</li>
<li>   « ».  ,     ,    ,      ,     «».      ,   , -,    ,  -,     .</li>
<li> ,         –   ,     «»    .      «».     ,  ,   ,    …     – . 10% «» – , 10% «»  100  –  .</li>
<li> «»   ,     ,    «»      .       –     -  .    100    –  ,  1    15  –   .</li>
<li>   .  «»   , , ,  .   ,      ,     .</li>
<li>   .                   ,    .         ,   latency,    .</li>
<li>   .    –     ,       .</li>
<li>  «»       1           . ,  ,   .      .    ,     ,     .      .</li>
</ul><br>
<h3>  ?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'architecture nous convient parfaitement et je peux la recommander en toute sécurité. HLS restera avec nous le protocole principal pour au moins le site Web et au moins le protocole de sauvegarde pour tout le reste. Peut-être que nous passerons au MPEG-DASH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RTMP abandonné. Malgré le fait qu'il donne un délai plus faible, nous avons décidé de régler le HLS. Peut-être envisager d'autres véhicules de livraison, y compris DASH comme alternative. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qz/ut/oq/qzutoqnu3adqhxx0rivblxx9izq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous améliorerons le solde entrant. Nous voulons également effectuer un basculement transparent pour l'équilibrage entrant, de sorte qu'en cas de problème sur l'un des serveurs de médias pour le client, la commutation soit complètement invisible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être développerons-nous des systèmes de livraison des serveurs de périphérie au client. Ce sera probablement une sorte d'UDP. Lequel - nous réfléchissons maintenant et nous sommes au stade de la recherche.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, c'est tout. </font><font style="vertical-align: inherit;">Merci à tous!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des questions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question du public (ci-après - A): - Merci beaucoup pour le rapport! </font><font style="vertical-align: inherit;">Seul le conférencier d'Odnoklassniki a pris la parole, et il a dit qu'ils devaient réécrire le streamer, l'encodeur, l'encodeur ... Utilisez-vous de telles solutions ou utilisez celles en stock qui sont sur le marché (comme Harmonic, etc.)? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1_/mt/qb/1_mtqbmuiapdtajkn5at3emzwtm.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Maintenant, nous avons des solutions tierces en rotation. </font><font style="vertical-align: inherit;">Parmi les solutions open source que nous avons utilisées, nous avions nginx, le module RTMP (depuis longtemps). </font><font style="vertical-align: inherit;">D'une part, il nous a plu car il travaillait, assez simple. </font><font style="vertical-align: inherit;">Nous nous sommes battus très longtemps pour qu'il travaille de manière stable. </font><font style="vertical-align: inherit;">Maintenant, il passe de Nginx-RTMP à sa propre solution. </font><font style="vertical-align: inherit;">Nous pensons maintenant avec un transcodeur. </font><font style="vertical-align: inherit;">Le récepteur, à savoir la partie réceptrice, a également été réécrit de Nginx-RTMP vers sa solution. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ET:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Je voulais poser une question sur le découpage de RTMP sur HLS, mais si je comprends bien, vous avez déjà répondu ... Dites-moi, vos solutions sont-elles open-source? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Nous envisageons de le publier en open source. Nous préférons plutôt le publier, mais la question est le moment de la sortie en open source. Il suffit de mettre la source sur Internet - cela ne suffit pas. Vous devez réfléchir, faire quelques exemples de déploiement. Et dans quel but demandez-vous? Voulez-vous utiliser? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Parce que j'ai aussi rencontré Nginx-RTMP! Il est, pour le moins, pas pris en charge depuis très longtemps. L'auteur ne répond même pas particulièrement aux questions ... </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Si vous voulez, vous pouvez écrire au mail. Donner pour son propre usage? Nous pouvons être d'accord. Nous prévoyons vraiment de l'ouvrir. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ET:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Vous avez également dit que vous pouvez passer de HLS à DASH. HLS ne convient pas? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M.:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - C'est une question sur ce que nous pouvons, ou peut-être pas. Cela dépend grandement de ce que nous allons faire en termes de recherche de méthodes de livraison alternatives (c'est-à-dire UDP). Si nous trouvons quelque chose de «complètement» bon, alors nous ne toucherons probablement pas HLS. S'il semble que MPEG-DASH est plus confortable - nous allons peut-être le déplacer. Cela ne semble pas très difficile, mais nous ne savons pas si c'est nécessaire ou non. La synchronisation entre les flux, entre les qualités et d'autres choses y est clairement meilleure. Il y a des avantages. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Concernant les alertes. Vous avez parlé du fait que si les flux cessent de couler, alors c'est immédiatement une alerte. Et vous n'avez pas attrapé quelque chose d'indépendant de vous: le fournisseur est tombé, Megafon est tombé et les gens ont cessé de diffuser? .. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Disons simplement que quelque chose d'indépendant de nous est essentiellement toutes sortes de vacances et ainsi de suite. Oui, ils ont. Eh bien, oui. Les administrateurs ont regardé - aujourd'hui c'est les vacances, le reste des caractéristiques vont bien - ils se sont calmés. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Et sur la mise à l'échelle. À quel niveau évolue-t-il? Par exemple, j'ai demandé un flux depuis le téléphone - vais-je recevoir immédiatement un certain lien avec le bon serveur ash? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Un lien viendra immédiatement et, si nécessaire, vous commutera (s'il y a des problèmes sur un serveur spécifique). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xz/tn/rq/xztnrqvvbr73gu61lqgpvdt5c-e.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Qui va changer? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Lecteur mobile ou lecteur web. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Il redémarrera le flux ou quoi? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Un nouveau lien viendra à lui où il devrait aller en direct. Il ira là-bas et demandera à nouveau le flux. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ET:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- A quel niveau avez-vous des caches? Et des listes de lecture, et des morceaux, ou juste ça? .. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Et des listes de lecture, des morceaux! Il se cache un peu différemment, à la fois en termes de temps et en termes de retour de temps, mais nous mettons en cache les deux. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Concernant la création de serveurs Ash? Avez-vous eu une telle situation que vous regardez 2 millions de téléspectateurs sur une émission, que vous n'avez pas le temps pour quelque chose et que vous récupérez rapidement un serveur Ash? Ou soulevez-vous tout à l'avance avec une marge? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monsieur:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Peut-être que non. Premièrement, le stock est toujours petit ou grand - peu importe. Deuxièmement, il n’arrive pas qu’une émission devienne soudainement super populaire. Nous pouvons bien prévoir le nombre de téléspectateurs. En gros, pour avoir beaucoup de monde, il faut faire un effort. En conséquence, nous pouvons ajuster le nombre de téléspectateurs de l'émission, en fonction des efforts déployés. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Vous avez dit que vous mesurez les retards instrumentaux de la part du joueur. Comment? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Très simple. Dans les morceaux (dans les segments multimédias), nous avons un horodatage, au nom du segment multimédia - dans le lecteur, nous le renvoyons simplement. S'il n'est pas explicitement du tout, il revient. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Je me souviens avoir essayé d'exécuter le peering sur WebRTC. Pourquoi refusé? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monsieur:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Je ne peux pas répondre à cette question pour vous - c'est arrivé sans moi." Je ne peux pas dire pourquoi j'ai essayé et je ne peux pas dire pourquoi j'ai refusé. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Concernant le récepteur et le serveur multimédia. Si je comprends bien, vous aviez Nginx-RTMP, maintenant là et là, vous avez des solutions faites par vous-même. En fait, il s'agit d'un serveur multimédia qui fait office de proxy pour d'autres serveurs multimédia, et ils sont déjà dans le cache et en périphérie. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Donc, pas vraiment. Il s'agit d'une solution autodidacte, mais elle est différente à la fois en termes de serveur multimédia et en termes de récepteur. Nginx-RTMP - c'était une sorte de moissonneuse qui pouvait faire les deux. Nos intérieurs du récepteur et du serveur multimédia sont très différents - à la fois par code et partout. La seule chose qui les unit est le traitement RTMP. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Concernant l'équilibre entre les bords. Comment cela peut-il arriver?</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Nous mesurons le trafic, l'envoyer au serveur souhaité. Je n'ai pas compris un peu la question ... </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Je vais expliquer: l'utilisateur demande une liste de lecture via le lecteur - il renvoie les chemins relatifs aux manifestes et aux morceaux ou aux chemins absolus, par exemple, par IP ou domaine? .. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Les chemins sont relatifs. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Autrement dit, il n'y a pas d'équilibrage lors de la visualisation d'un flux par un seul utilisateur? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ça arrive. Assez délicat. Nous pouvons utiliser la redirection 301e lors de la surcharge du serveur. Si nous voyons que tout est complètement mauvais là-bas, pour les segments, nous pouvons l'envoyer à un autre serveur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Mais cela devrait être connecté à la logique du joueur? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monsieur:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Non, juste cette partie ne doit pas être cousue. 301e redirection! Simplement, le joueur devrait pouvoir quitter la 301e liaison. Nous pouvons l'envoyer à un autre serveur du côté serveur au moment de la surcharge. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Autrement dit, il demande au serveur, et le serveur le lui donne? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MR:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Oui. Ce n'est pas très bon, par conséquent, la logique du joueur est utilisée pour retweeter les liens vers le cas de défaillance d'un des serveurs - c'est déjà dans la logique du joueur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Et vous n'avez pas essayé de travailler non pas de manière relative, mais absolue: lorsque vous demandez au joueur de faire de la magie, découvrez où il y a des ressources et où pas, et donnez déjà des listes de lecture indiquant un serveur spécifique? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monsieur:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- En fait, cela ressemble à une solution de travail. </font><font style="vertical-align: inherit;">Si vous étiez venu alors, nous aurions pesé les deux! </font><font style="vertical-align: inherit;">Mais la solution actuelle fonctionne également, donc je ne veux pas vraiment passer de l’un à l’autre, même si cela ressemble peut-être aussi à une solution de travail. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Dites-moi, est-ce en quelque sorte amical avec la multidiffusion? </font><font style="vertical-align: inherit;">HLS, si je comprends bien, absolument rien ... </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M.:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Dans la mise en œuvre actuelle, nous n'avons probablement rien dans le système avec la multidiffusion en direct. </font><font style="vertical-align: inherit;">Nous n'y incluons pas le concept de multidiffusion. </font><font style="vertical-align: inherit;">Peut-être quelque part dans les profondeurs de la magie administrative, il y a quelque chose à l'intérieur du réseau, mais il est caché à tout le monde et personne ne le sait ...</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/va/s2/qrvas2mhyryhgck9t6n8ffc1pai.jpeg"><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/bA-Y_BfTZZY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu de publicité :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci de rester avec nous. Aimez-vous nos articles? Vous voulez voir des matériaux plus intéressants? Soutenez-nous en passant une commande ou en recommandant à vos amis, le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloud VPS pour les développeurs à partir de 4,99 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analogue unique de serveurs d'entrée de gamme que nous avons inventé pour vous: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toute la vérité sur VPS (KVM) E5-2697 v3 (6 cœurs) 10 Go DDR4 480 Go SSD 1 Gbit / s à partir de 19 $ ou comment diviser le serveur?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (les options sont disponibles avec RAID1 et RAID10, jusqu'à 24 cœurs et jusqu'à 40 Go de DDR4). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 fois moins cher au centre de données Equinix Tier IV à Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous avons seulement </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV à partir de 199 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aux Pays-Bas!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - à partir de 99 $! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En savoir plus sur la</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> création d'un bâtiment d'infrastructure. </font><font style="vertical-align: inherit;">classe c utilisant des serveurs Dell R730xd E5-2650 v4 coûtant 9 000 euros pour un sou?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr488136/index.html">Comment le robot Atlas a-t-il appris à faire des cascades acrobatiques, insupportables pour une personne ordinaire?</a></li>
<li><a href="../fr488138/index.html">Mesures de petite capacité (capteur capacitif analogique)</a></li>
<li><a href="../fr488140/index.html">Comment simplifier la vie avec l'aide de la loi Pareto</a></li>
<li><a href="../fr488142/index.html">Avalonia songeur</a></li>
<li><a href="../fr488146/index.html">[Discussion]: Les ingénieurs informatiques sont-ils des ingénieurs informatiques?</a></li>
<li><a href="../fr488150/index.html">Antiquités: ThinkPad X200 et source fermée</a></li>
<li><a href="../fr488152/index.html">Un prototype de jeu multijoueur pour 15h?</a></li>
<li><a href="../fr488154/index.html">Nous prenons la place du chef de bureau. Algorithmes d'approvisionnement de base</a></li>
<li><a href="../fr488160/index.html">Windows Server 2019 contre Instantanés VMware avec mise au repos: une solution élégante au problème</a></li>
<li><a href="../fr488162/index.html">Plus la note est élevée, plus il y a d'argent et vice versa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>