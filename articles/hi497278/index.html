<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯХ║ЁЯП╗ ЁЯзА ЁЯжЙ рд╕реНрдкрдВрджрдиред рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдФрд░ рд╕рдорд╛рдирд╛рдВрддрд░рд╡рд╛рдж ЁЯНд тА╝я╕П ЁЯО║</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣реЗрд▓реЛ, рд╣реЗрдмреНрд░! рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП рдбрд┐рдбрд┐рдПрд░ рдмреЛрдПрд▓реЗрдиреНрд╕ рдХреЗ рд▓реЗрдЦ "рдлреНрдпреВрдЪрд░реНрд╕ - рдЖрдЗрд╕реЛрд▓реЗрдЯреНрд╕ - рдЗрд╡реЗрдВрдЯ рд▓реВрдк" рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдФрд░ Dart( Flutterрд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ) рдореЗрдВ рдФрд░ рдмрд╣реБ-рдкреНрд░...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рд╕реНрдкрдВрджрдиред рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдФрд░ рд╕рдорд╛рдирд╛рдВрддрд░рд╡рд╛рдж</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497278/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЗрд▓реЛ, рд╣реЗрдмреНрд░! </font><font style="vertical-align: inherit;">рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдбрд┐рдбрд┐рдПрд░ рдмреЛрдПрд▓реЗрдиреНрд╕ </font><font style="vertical-align: inherit;">рдХреЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦ "рдлреНрдпреВрдЪрд░реНрд╕ - рдЖрдЗрд╕реЛрд▓реЗрдЯреНрд╕ - рдЗрд╡реЗрдВрдЯ рд▓реВрдк"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЕрдиреБрд╡рд╛рдж </font><font style="vertical-align: inherit;">рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдФрд░ </font></font><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>Flutter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ) рдореЗрдВ </font><font style="vertical-align: inherit;">рдФрд░ рдмрд╣реБ-рдкреНрд░рд╕рд╛рд░ рдкрд░ </font><font style="vertical-align: inherit;">рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реВрдВ </font><font style="vertical-align: inherit;">ред</font></font></p><br>
<pre><code class="plaintext hljs">TLDR:  ,        .       Event Loop, Future  async/await (,  JavaScript),   otlin,  ,       . ,        .</code></pre><a name="habracut"></a> <br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рд╢рд░реНрддреЛрдВ рдХреЗ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред </font><font style="vertical-align: inherit;">рдмреЛрд▓реА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рднрд╛рд╖рд╛ рдореЗрдВ</font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо</font></font></del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореИрдВ рдХрд╣рддрд╛ рд╣реВрдВ рдХрд┐ "рдзрд╛рд░рд╛", "рд╡реНрдпрд╛рдкрд╛рд░", "рд╡рд╛рдпрджрд╛", рдЖрджрд┐, рдЬрдмрдХрд┐ рдкреНрд░рд┐рдВрдЯ рдореЗрдВ рдпреЗ рд╢рдмреНрдж рдЕрдЬреАрдм рдФрд░ рдЕрдирд╛рдбрд╝реА рд▓рдЧрддреЗ рд╣реИрдВред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрд╕реА рд╕рдордп, рдпрд╣ </font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕реНрдЯреНрд░реАрдо рд╣реИ, рдФрд░ </font></font><code>Thread</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдПрдХ рд╕реНрдЯреНрд░реАрдоред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдВрджрд░реНрдн рд╣рдореЗрд╢рд╛ рдирд╣реАрдВ рдмрдЪрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╣реА рдЖрдЗрд╕реЛрд▓реЗрдЯ, рдореЗрд░реЗ рд╕реНрд╡рд╛рдж рдХреЗ рд▓рд┐рдП, рд░реВрд╕реА рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд▓рдЧрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрд╣реАрдВ рдореИрдВ рд╕рд┐рд░рд┐рд▓рд┐рдХ рдореЗрдВ рд╡рд░реНрддрдиреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рдХрд╣реАрдВ рдореВрд▓ рдореЗрдВред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдФрд░ рд╡рд╣рд╛рдБ рдХреЛрд╖реНрдардХ рдореЗрдВ рд░реВрд╕реА рд╢рдмреНрджреЛрдВ рдХреЗ рдмрд╛рдж рдЙрдирдХреЗ рдЕрдВрдЧреНрд░реЗрдЬреА рдореВрд▓, рдХрднреА-рдХрднреА рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред</font></font></p><br>
<h1 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рд┐рдЪрдп</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рдореИрдВ рдЕрдХреНрд╕рд░ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рд╢реНрдиреЛрдВ рдорд┐рд▓ </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Isolate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдХреЛрдб рдХреЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдирд┐рд╖реНрдкрд╛рджрдиред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЕрдкрдиреЗ рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВрдиреЗ рдЕрд╡рд╕рд░ рдХреЛ рдЬрдмреНрдд рдХрд░рдиреЗ рдФрд░ рдЗрди рдореБрджреНрджреЛрдВ рдкрд░ рдПрдХ рд▓реЗрдЦ рд╕рдорд░реНрдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рдореИрдВ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдЬреБрдбрд╝реЗ рднреНрд░рдо рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></p><br>
<h1 id="dart---odnopotochnyy-yazyk"><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рдПрдХрд▓ рдкрд┐рд░реЛрдпрд╛ рднрд╛рд╖рд╛</font></font></h1><br>
<p>   ,  <code>Dart</code> тАФ   <code>Flutter</code>  <code>Dart</code>.</p><br>
<blockquote><code>Dart</code>       . .  ,          .</blockquote><p> ,      (  ),          ,   .</p><br>
<pre><code class="plaintext hljs">void myBigLoop(){<font></font>
    for (int i = 0; i &lt; 1000000; i++){<font></font>
        _doSomethingSynchronously();<font></font>
    }<font></font>
}</code></pre><br>
<p>  ,  <code>myBigLoop()</code>       .  ,     - ,   <code></code>   ,   .</p><br>
<h1 id="model-vypolneniya-v-dart">   <code>Dart</code></h1><br>
<p> <code>Dart</code>,     ,  <code>Event Loop</code>.</p><br>
<p>   <code>Flutter</code>- (  <code>Dart</code>-),      тАФ <code>Thread</code>,    тАФ <code></code> (<code>Isolate</code>).   ,      .</p><br>
<p>   ,     :</p><br>
<ol>
<li>   (<code>Queues</code>)   <code>MicroTask</code> ()<br>
 <code>Event</code> (),   <code>FIFO</code> (.: first in first out, .. ,<br>
 ,   ),</li>
<li>  <code>main()</code> ,    </li>
<li> <code>Event Loop</code> ( )</li>
</ol><br>
<p>       ,  <br>
   <code>Event Loop</code>     <br>
,      : <code>MicroTask</code>  <code>Event</code>.</p><br>
<p><code>Event Loop</code>   "" ,  <br>
  "".  ,     <br>
<code>Dart</code>-,      ""   :</p><br>
<pre><code class="plaintext hljs">void eventLoop(){<font></font>
    while (microTaskQueue.isNotEmpty){<font></font>
        fetchFirstMicroTaskFromQueue();<font></font>
        executeThisMicroTask();<font></font>
        return;<font></font>
    }<font></font>
<font></font>
    if (eventQueue.isNotEmpty){<font></font>
        fetchFirstEventFromQueue();<font></font>
        executeThisEventRelatedCode();<font></font>
    }<font></font>
}</code></pre><br>
<p> ,  <code>MicroTask</code>     <code>Event</code>.       ?</p><br>
<h1 id="ochered-microtask"> MicroTask</h1><br>
<p>  <code> </code> ,     <code></code>,    -   ,     <code>Event Loop</code>.</p><br>
<p>   <code> </code>        .       - ,     - :</p><br>
<pre><code class="plaintext hljs">MyResource myResource;<font></font>
<font></font>
    ...<font></font>
<font></font>
    void closeAndRelease() {<font></font>
        scheduleMicroTask(_dispose);<font></font>
        _close();<font></font>
    }<font></font>
<font></font>
    void _close(){<font></font>
        // ,     <font></font>
        //   <font></font>
        ...<font></font>
    }<font></font>
<font></font>
    void _dispose(){<font></font>
        // ,    <font></font>
        //   ,  _close()<font></font>
        // <font></font>
    }</code></pre><br>
<p>-,   ,     .  ,     <code></code>  <code>scheduleMicroTask()</code>   7 .    <code>Event</code>.</p><br>
<h1 id="ochered-event"> Event</h1><br>
<p>   ,    :</p><br>
<ul>
<li> ,  <br>
<ul>
<li> /</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>...</li>
</ul></li>
<li><code>Future</code></li>
</ul><br>
<p>,      ,      <code>Event</code>.</p><br>
<p>  ,   <code>MicroTask</code> , <code>Event Loop</code>      <code>Event</code>   .</p><br>
<p>,  <code>Futures</code>      <code>Event</code>.</p><br>
<h1 id="futures">Futures</h1><br>
<p><code>Future</code>   ,   <code></code>   (   ) -  .</p><br>
<p> ,     <code>Future</code>:</p><br>
<ul>
<li>      ,  <code>Dart</code></li>
<li>,       <code>Future</code>, <br>
   <code>Event</code></li>
<li>  <code>Future</code>   <code> </code> (incomplete)</li>
<li>     ,   (   <code>Future</code>)</li>
</ul><br>
<p>,    <code>Future</code>      <code>Event</code>,<br>
  <code>Event Loop</code>    .</p><br>
<p>   (   )    <code>then()</code><br>
 <code>catchError()</code>  <code>Future</code>.</p><br>
<p> ,   :</p><br>
<pre><code class="plaintext hljs">void main(){<font></font>
    print('Before the Future');<font></font>
    Future((){<font></font>
        print('Running the Future');<font></font>
    }).then((_){<font></font>
        print('Future is complete');<font></font>
    });<font></font>
    print('After the Future');<font></font>
}</code></pre><br>
<p> ,      :</p><br>
<pre><code class="plaintext hljs">Before the Future<font></font>
After the Future<font></font>
Running the Future<font></font>
Future is complete</code></pre><br>
<p>    :</p><br>
<ol>
<li><code>print('Before the Future')</code></li>
<li> <code>(){print('Running the Future');}</code>   <code>Event</code></li>
<li><code>print('After the Future')</code></li>
<li><code>Event Loop</code>     2</li>
<li>  ,     <code>then()</code></li>
</ol><br>
<p>  :</p><br>
<blockquote> <code>Future</code>   <code></code>,    ,  <code>Event Loop</code></blockquote><br>
<h1 id="asinhronnye-metody-async">  (async)</h1><br>
<p>       <code>async</code>,  <code>Dart</code>  , :</p><br>
<ul>
<li>   тАФ  <code>Future</code></li>
<li>     ,       <code>await</code>,     </li>
<li>        <code>Future</code>,     <code>await</code>  </li>
</ul><br>
<p>   ,  <code>await</code>      ,   [    Future],    .<br>
     <code>Event Loop</code>...</p><br>
<p>    ,    <br>
,     </p><br>
<pre><code class="plaintext hljs">void main() async {<font></font>
  methodA();<font></font>
  await methodB();<font></font>
  await methodC('main');<font></font>
  methodD();<font></font>
}<font></font>
<font></font>
methodA(){<font></font>
  print('A');<font></font>
}<font></font>
<font></font>
methodB() async {<font></font>
  print('B start');<font></font>
  await methodC('B');<font></font>
  print('B end');<font></font>
}<font></font>
<font></font>
methodC(String from) async {<font></font>
  print('C start from $from');<font></font>
<font></font>
  Future((){                // &lt;==     -  <font></font>
    print('C running Future from $from');<font></font>
  }).then((_){<font></font>
    print('C end of Future from $from');<font></font>
  });<font></font>
<font></font>
  print('C end from $from');  <font></font>
}<font></font>
<font></font>
methodD(){<font></font>
  print('D');<font></font>
}</code></pre><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">A<font></font>
B start<font></font>
C start from B<font></font>
C end from B<font></font>
B end<font></font>
C start from main<font></font>
C end from main<font></font>
D<font></font>
C running Future from B<font></font>
C end of Future from B<font></font>
C running Future from main<font></font>
C end of Future from main</code></pre><br>
<p>  ,  <code>methodC()</code>                . ,  ,            .</p><br>
<p>   ,  <code>methodD()</code>      ,     : </p><br>
<pre><code class="plaintext hljs">void main() async {<font></font>
  methodA();<font></font>
  await methodB();<font></font>
  await methodC('main');<font></font>
  methodD();  <font></font>
}<font></font>
<font></font>
methodA(){<font></font>
  print('A');<font></font>
}<font></font>
<font></font>
methodB() async {<font></font>
  print('B start');<font></font>
  await methodC('B');<font></font>
  print('B end');<font></font>
}<font></font>
<font></font>
methodC(String from) async {<font></font>
  print('C start from $from');<font></font>
<font></font>
  await Future((){                  // &lt;==  <font></font>
    print('C running Future from $from');<font></font>
  }).then((_){<font></font>
    print('C end of Future from $from');<font></font>
  });<font></font>
  print('C end from $from');  <font></font>
}<font></font>
<font></font>
methodD(){<font></font>
  print('D');<font></font>
}</code></pre><br>
<p>  :</p><br>
<pre><code class="plaintext hljs">A<font></font>
B start<font></font>
C start from B<font></font>
C running Future from B<font></font>
C end of Future from B<font></font>
C end from B<font></font>
B end<font></font>
C start from main<font></font>
C running Future from main<font></font>
C end of Future from main<font></font>
C end from main<font></font>
D</code></pre><br>
<p>,      <code>await</code>  <code>Future</code>  <code>methodC()</code>   .</p><br>
<p>   :</p><br>
<blockquote><code></code>    <code></code>,    ,  <code>Event Loop</code></blockquote><p>  .    .     <code>method1</code>  тАФ <code>method2</code>?    ?</p><br>
<pre><code class="plaintext hljs">void method1(){<font></font>
  List&lt;String&gt; myArray = &lt;String&gt;['a','b','c'];<font></font>
  print('before loop');<font></font>
  myArray.forEach((String value) async {<font></font>
    await delayedPrint(value);<font></font>
  });  <font></font>
  print('end of loop');<font></font>
}<font></font>
<font></font>
void method2() async {<font></font>
  List&lt;String&gt; myArray = &lt;String&gt;['a','b','c'];<font></font>
  print('before loop');<font></font>
  for(int i=0; i&lt;myArray.length; i++) {<font></font>
    await delayedPrint(myArray[i]);<font></font>
  }<font></font>
  print('end of loop');<font></font>
}<font></font>
<font></font>
Future&lt;void&gt; delayedPrint(String value) async {<font></font>
  await Future.delayed(Duration(seconds: 1));<font></font>
  print('delayedPrint: $value');<font></font>
}</code></pre><br>
<p>:   .</p><br>
<p>  ,  <code>method1</code>   <code>forEach()</code>   .      ,   <code>async</code> (   <code>Future</code>).      <code>await</code>,        <code>Event</code>.   ,   : <code>print('end of loop')</code>.   <code>Event Loop</code>  3 .</p><br>
<p>  <code>method2</code>,          (   )  тАФ   .</p><br>
<p> ,      ,     <br>
 <code>Event Loop</code>...</p><br>
<h1 id="mnogopotochnost"></h1><br>
<p>,          <code>Flutter</code>?     ?</p><br>
<p>,   <code>Isolate</code> ().</p><br>
<h1 id="chto-takoe-izolyat">  </h1><br>
<p>   ,  <code>Isolate</code>  <code>Dart</code>   <code>Thread</code> (). </p><br>
<p>        <code>Thread</code>.</p><br>
<blockquote><code></code>  <code>Flutter</code>   .    <code></code>   .</blockquote><br>
<h1 id="kazhdomu-izolyatu-polozhen-otdelnyy-event-loop"> <code></code>   <code>Event Loop</code>.</h1><br>
<p>      (<code>MicroTask</code>  <code>Event</code>).</p><br>
<p>   <code></code>    <code></code>.</p><br>
<p>         <code>Dart</code>.</p><br>
<h1 id="kak-zapustit-izolyat">  <code></code></h1><br>
<p>    ,     .</p><br>
<h2 id="1-nizkourovnevoe-reshenie">1.  </h2><br>
<p>      ()      API,  <code>Dart</code>.</p><br>
<h3 id="11-shag-1-sozdanie-i-rukopozhatie">1.1.  1:   </h3><br>
<p>   , <code></code>       ,  ,      ""  ""      <code></code>.</p><br>
<p> <code></code>  ,  ,     <code></code>.    <code>SendPort</code> (  ,      ,      /,     ).</p><br>
<p>, ""  " "     ,    "".        :</p><br>
<pre><code class="plaintext hljs">//<font></font>
//   <font></font>
//     <font></font>
//    <font></font>
//<font></font>
SendPort newIsolateSendPort;<font></font>
<font></font>
//<font></font>
//   <font></font>
//<font></font>
Isolate newIsolate;<font></font>
<font></font>
//<font></font>
// ,    <font></font>
//   <font></font>
//<font></font>
void callerCreateIsolate() async {<font></font>
    //<font></font>
    //   ReceivePort  <font></font>
    // SendPort  <font></font>
    //<font></font>
    ReceivePort receivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //   <font></font>
    //<font></font>
    newIsolate = await Isolate.spawn(<font></font>
        callbackFunction,<font></font>
        receivePort.sendPort,<font></font>
    );<font></font>
<font></font>
    //<font></font>
    //     ""<font></font>
    //<font></font>
    newIsolateSendPort = await receivePort.first;<font></font>
}<font></font>
<font></font>
//<font></font>
//    <font></font>
//<font></font>
static void callbackFunction(SendPort callerSendPort){<font></font>
    //<font></font>
    //   SendPort   <font></font>
    //  ""<font></font>
    //<font></font>
    ReceivePort newIsolateReceivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //  ""   SendPort  <font></font>
    //<font></font>
    callerSendPort.send(newIsolateReceivePort.sendPort);<font></font>
<font></font>
    //<font></font>
    //  <font></font>
    //<font></font>
}</code></pre><br>
<blockquote> :            </blockquote><br>
<h3 id="12-shag-2-otpravka-soobscheniya-izolyatu">1.2.  2:   <code></code></h3><br>
<p>,        <code></code>,     : </p><br>
<pre><code class="plaintext hljs">//<font></font>
// ,     <font></font>
//   <font></font>
// <font></font>
//     ""<font></font>
//   String (   )<font></font>
//<font></font>
Future&lt;String&gt; sendReceive(String messageToBeSent) async {<font></font>
    //<font></font>
    //     <font></font>
    //<font></font>
    ReceivePort port = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //   ,  <font></font>
    //  ,   <font></font>
    //   <font></font>
    //<font></font>
    newIsolateSendPort.send(<font></font>
        CrossIsolatesMessage&lt;String&gt;(<font></font>
            sender: port.sendPort,<font></font>
            message: messageToBeSent,<font></font>
        )<font></font>
    );<font></font>
<font></font>
    //<font></font>
    //     <font></font>
    //<font></font>
    return port.first;<font></font>
}<font></font>
<font></font>
//<font></font>
// Callback-    <font></font>
//<font></font>
static void callbackFunction(SendPort callerSendPort){<font></font>
    //<font></font>
    //   SendPort   <font></font>
    //  <font></font>
    //<font></font>
    ReceivePort newIsolateReceivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //  ""   SendPort  <font></font>
    //<font></font>
    callerSendPort.send(newIsolateReceivePort.sendPort);<font></font>
<font></font>
    //<font></font>
    //  ,    ,<font></font>
    //    <font></font>
    //<font></font>
    newIsolateReceivePort.listen((dynamic message){<font></font>
        CrossIsolatesMessage incomingMessage = message as CrossIsolatesMessage;<font></font>
<font></font>
        //<font></font>
        //  <font></font>
        //<font></font>
        String newMessage = "complemented string " + incomingMessage.message;<font></font>
<font></font>
        //<font></font>
        //   <font></font>
        //<font></font>
        incomingMessage.sender.send(newMessage);<font></font>
    });<font></font>
}<font></font>
<font></font>
//<font></font>
//  <font></font>
//<font></font>
class CrossIsolatesMessage&lt;T&gt; {<font></font>
    final SendPort sender;<font></font>
    final T message;<font></font>
<font></font>
    CrossIsolatesMessage({<font></font>
        @required this.sender,<font></font>
        this.message,<font></font>
    });<font></font>
}</code></pre><br>
<h3 id="13-shag-3-udalenie-izolyata">1.3.  3:  <code></code></h3><br>
<p>      <code></code>,    :</p><br>
<pre><code class="plaintext hljs">void dispose(){<font></font>
    newIsolate?.kill(priority: Isolate.immediate);<font></font>
    newIsolate = null;<font></font>
}</code></pre><br>
<h3 id="14-zamechanie---stream-s-odnim-slushatelem">1.4.  тАФ <code>Stream</code>   </h3><br>
<p>   ,   "" <code></code>  ""    (Streams).    <code>Single-Listener Stream</code> (   ).</p><br>
<h2 id="2-odnorazovoe-vychislenie-one-shot-computation">2.   (One-shot computation)</h2><br>
<p> ,               <code></code>  ,  <code>Dart</code>    <code>compute</code>, </p><br>
<ul>
<li> <code></code></li>
<li>    <code></code>,    </li>
<li>  тАФ  -</li>
<li> <code></code>    .</li>
</ul><br>
<blockquote> :               ( ).</blockquote><br>
<h2 id="3-ochen-vazhnoe-ogranichenie">3.   </h2><br>
<p>   ,  , </p><br>
<blockquote>  (Platform-Channel communication)     <code></code> (main isolate).   <code></code>,      .</blockquote><p> ,      <code></code>,<br>
  .</p><br>
<h1 id="kogda-mne-sleduet-ispolzovat-future-i-izolyaty">    <code>Future</code>  <code></code></h1><br>
<p>       ,  :</p><br>
<ul>
<li></li>
<li> </li>
<li>  (user friendliness)</li>
</ul><br>
<p>      ,        (user experiences lags),      .</p><br>
<p>  ,       :</p><br>
<ol>
<li>      ,  <br>
  (       )</li>
<li>    ,     <br>
 ,   тАФ <code>Event Loop</code>   <code>Futures</code></li>
<li>      ,  <br>
    ,   тАФ <code></code></li>
</ol><br>
<p> , ,   ,   <code>Futures</code> (   <code>async</code>-) тАФ   <code>Futures</code>      <code>Event Loop</code>  "" .    ,     ( - ,    ).</p><br>
<p>  ,       <code>Future</code>  <code></code> тАФ   ,     .</p><br>
<ul>
<li>  =&gt; <code>Future</code></li>
<li>  =&gt; <code></code></li>
</ul><br>
<p>       <code></code>:</p><br>
<ul>
<li> JSON,     (HttpRequest),  <br>
  =&gt;  <code>compute</code></li>
<li>:      =&gt; <code></code></li>
<li>  (  ..)    =&gt; <code></code></li>
<li>   :       <code></code>,   ,     .</li>
</ul><br>
<h1 id="zaklyuchenie"></h1><br>
<p>,   ,   <code>Event Loop</code>  .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЗрд╕реЗ рди рднреВрд▓реЗрдВ </font></font><code>Flutter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рд╕рд┐рдВрдЧрд▓-рдереНрд░реЗрдбреЗрдб рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рдВрддреБрд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдпрдерд╛рд╕рдВрднрд╡ рдЖрд╕рд╛рдиреА рд╕реЗ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </font></font><code>Futures</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЙрдкрдХрд░рдгред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реМрднрд╛рдЧреНрдп</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi497264/index.html">рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЗрдВрдЯрд░рдлрд╝реЗрд╕ред рднрд╛рдЧ 2. рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕</a></li>
<li><a href="../hi497268/index.html">рд╢реАрд░реНрд╖рдХ "рдЖрдкрдХреЗ рд▓рд┐рдП рд▓реЗрдЦ рдкрдврд╝реЗрдВред" рдорд╛рд░реНрдЪ 2020. рднрд╛рдЧ 2</a></li>
<li><a href="../hi497270/index.html">рдирдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ред 2.5 рдорд┐рд▓рд┐рдпрди рд░реВрдмрд▓ рдСрдирд▓рд╛рдЗрди рд╣реИрдХрдереЙрди</a></li>
<li><a href="../hi497272/index.html">рд╕реЗрд░рд╛рдлрд┐рдо рдХреМрди рд╣реИ? рдпрд╛ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╣реИрдХрдереЙрди рдХреЛ рдХреИрд╕реЗ рдЦреЛрдирд╛ рдФрд░ рдЬреАрддрдирд╛ рд╣реИ</a></li>
<li><a href="../hi497276/index.html">рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп "рд╕реНрд╡рд╕реНрде" рдЖрдкрдХреА рдореБрджреНрд░рд╛ рдХреИрд╕реА рд╣реИ?</a></li>
<li><a href="../hi497280/index.html">рдХреИрд╕реЗ рдореИрдВрдиреЗ рдбрд░рдирд╛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдФрд░ рдореБрдЭреЗ рдХреЛрд▓реЗрд╕реНрдЯреНрд░реЙрд▓ рд╕реЗ рдкреНрдпрд╛рд░ рд╣реЛ рдЧрдпрд╛</a></li>
<li><a href="../hi497282/index.html">рдХреЛрдгреАрдп рдореЗрдВ рдХреЛрдб рдХреЛ рд╕рд╛рдл рдХрд░реЗрдВред рдХреБрдХрд┐рдВрдЧ рдИрдПрд╕рд▓рд┐рдВрдЯ, рдХреЛрдбрд▓реАрдЬрд░, рд╕реНрдЯрд╛рдЗрд▓рд▓рд┐рдВрдЯ, рд╣рд╕реНрдХреА, рд▓рд┐рдВрдЯ-рд╕реНрдЯреЗрдЬреНрдб рдФрд░ рдкреНрд░реАрдЯреАрдпрд░</a></li>
<li><a href="../hi497286/index.html">рд▓реБрджреБрдо рдбреЗрдпрд░: рд╢реБрд░реБрдЖрдд рд╕реЗ рдПрдХ рд╕рдкреНрддрд╛рд╣ рдкрд╣рд▓реЗ рдЪреЗрдХрд▓рд┐рд╕реНрдЯ</a></li>
<li><a href="../hi497288/index.html">рд╕рдЬрд╛рд╡рдЯреА рдЫрдд рдкреНрд░рдХрд╛рд╢ рдлреЗрд░рди AL5000</a></li>
<li><a href="../hi497290/index.html">рд╕реИрдВрдбреА рдмреНрд░рд┐рдЬ + рдкрд░ рдпреВрдУрдкреА рдХреИрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рд╕реБрдзрд╛рд░</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>