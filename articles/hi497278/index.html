<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèª üßÄ ü¶â ‡§∏‡•ç‡§™‡§Ç‡§¶‡§®‡•§ ‡§Ö‡§§‡•Å‡§≤‡•ç‡§Ø‡§ï‡§æ‡§≤‡§ø‡§ï ‡§î‡§∞ ‡§∏‡§Æ‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§µ‡§æ‡§¶ üç§ ‚ÄºÔ∏è üé∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‡§π‡•á‡§≤‡•ã, ‡§π‡•á‡§¨‡•ç‡§∞! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§ø‡§°‡§ø‡§è‡§∞ ‡§¨‡•ã‡§è‡§≤‡•á‡§®‡•ç‡§∏ ‡§ï‡•á ‡§≤‡•á‡§ñ "‡§´‡•ç‡§Ø‡•Ç‡§ö‡§∞‡•ç‡§∏ - ‡§Ü‡§á‡§∏‡•ã‡§≤‡•á‡§ü‡•ç‡§∏ - ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡•Ç‡§™" ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§Ö‡§§‡•Å‡§≤‡•ç‡§Ø‡§ï‡§æ‡§≤‡§ø‡§ï ‡§î‡§∞ Dart( Flutter‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á) ‡§Æ‡•á‡§Ç ‡§î‡§∞ ‡§¨‡§π‡•Å-‡§™‡•ç‡§∞...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>‡§∏‡•ç‡§™‡§Ç‡§¶‡§®‡•§ ‡§Ö‡§§‡•Å‡§≤‡•ç‡§Ø‡§ï‡§æ‡§≤‡§ø‡§ï ‡§î‡§∞ ‡§∏‡§Æ‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§µ‡§æ‡§¶</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497278/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§π‡•á‡§≤‡•ã, ‡§π‡•á‡§¨‡•ç‡§∞! </font><font style="vertical-align: inherit;">‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è </font><font style="vertical-align: inherit;">‡§°‡§ø‡§°‡§ø‡§è‡§∞ ‡§¨‡•ã‡§è‡§≤‡•á‡§®‡•ç‡§∏ </font><font style="vertical-align: inherit;">‡§ï‡•á </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§≤‡•á‡§ñ "‡§´‡•ç‡§Ø‡•Ç‡§ö‡§∞‡•ç‡§∏ - ‡§Ü‡§á‡§∏‡•ã‡§≤‡•á‡§ü‡•ç‡§∏ - ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡•Ç‡§™"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ </font><font style="vertical-align: inherit;">‡§Ö‡§§‡•Å‡§≤‡•ç‡§Ø‡§ï‡§æ‡§≤‡§ø‡§ï ‡§î‡§∞ </font></font><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>Flutter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á) ‡§Æ‡•á‡§Ç </font><font style="vertical-align: inherit;">‡§î‡§∞ ‡§¨‡§π‡•Å-‡§™‡•ç‡§∞‡§∏‡§æ‡§∞ ‡§™‡§∞ </font><font style="vertical-align: inherit;">‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•Ç‡§Ç </font><font style="vertical-align: inherit;">‡•§</font></font></p><br>
<pre><code class="plaintext hljs">TLDR:  ,        .       Event Loop, Future  async/await (,  JavaScript),   otlin,  ,       . ,        .</code></pre><a name="habracut"></a> <br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§î‡§∞ ‡§∂‡§∞‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç‡•§ </font><font style="vertical-align: inherit;">‡§¨‡•ã‡§≤‡•Ä ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç</font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§π‡§Æ</font></font></del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‡§Æ‡•à‡§Ç ‡§ï‡§π‡§§‡§æ ‡§π‡•Ç‡§Ç ‡§ï‡§ø "‡§ß‡§æ‡§∞‡§æ", "‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞", "‡§µ‡§æ‡§Ø‡§¶‡§æ", ‡§Ü‡§¶‡§ø, ‡§ú‡§¨‡§ï‡§ø ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§Ø‡•á ‡§∂‡§¨‡•ç‡§¶ ‡§Ö‡§ú‡•Ä‡§¨ ‡§î‡§∞ ‡§Ö‡§®‡§æ‡§°‡§º‡•Ä ‡§≤‡§ó‡§§‡•á ‡§π‡•à‡§Ç‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§â‡§∏‡•Ä ‡§∏‡§Æ‡§Ø, ‡§Ø‡§π </font></font><code>Stream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§è‡§ï ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§π‡•à, ‡§î‡§∞ </font></font><code>Thread</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ‡§è‡§ï ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ‡•§ </font><font style="vertical-align: inherit;">‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§ö‡§æ ‡§π‡•à‡•§ </font><font style="vertical-align: inherit;">‡§µ‡§π‡•Ä ‡§Ü‡§á‡§∏‡•ã‡§≤‡•á‡§ü, ‡§Æ‡•á‡§∞‡•á ‡§∏‡•ç‡§µ‡§æ‡§¶ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§∞‡•Ç‡§∏‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§≤‡§ó‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§ï‡§π‡•Ä‡§Ç ‡§Æ‡•à‡§Ç ‡§∏‡§ø‡§∞‡§ø‡§≤‡§ø‡§ï ‡§Æ‡•á‡§Ç ‡§µ‡§∞‡•ç‡§§‡§®‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•Ç‡§Ç, ‡§î‡§∞ ‡§ï‡§π‡•Ä‡§Ç ‡§Æ‡•Ç‡§≤ ‡§Æ‡•á‡§Ç‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§Ø‡§π‡§æ‡§Å ‡§î‡§∞ ‡§µ‡§π‡§æ‡§Å ‡§ï‡•ã‡§∑‡•ç‡§†‡§ï ‡§Æ‡•á‡§Ç ‡§∞‡•Ç‡§∏‡•Ä ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§®‡§ï‡•á ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡•Ä ‡§Æ‡•Ç‡§≤, ‡§ï‡§≠‡•Ä-‡§ï‡§≠‡•Ä ‡§á‡§∏‡§ï‡•á ‡§µ‡§ø‡§™‡§∞‡•Ä‡§§‡•§</font></font></p><br>
<h1 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§™‡§∞‡§ø‡§ö‡§Ø</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç, ‡§Æ‡•à‡§Ç ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§æ‡§∞‡§£‡§æ‡§ì‡§Ç ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§Æ‡§ø‡§≤ </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Isolate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§î‡§∞ ‡§ï‡•ã‡§° ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§®‡§æ‡§Ç‡§§‡§∞ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§®‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§ï‡•Å‡§õ ‡§°‡•á‡§µ‡§≤‡§™‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§ï‡•ã‡§° ‡§ï‡•á ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§Ö‡§®‡•Å‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡§è‡§Ç ‡§π‡•à‡§Ç‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ö‡§µ‡§∏‡§∞ ‡§ï‡•ã ‡§ú‡§¨‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§á‡§® ‡§Æ‡•Å‡§¶‡•ç‡§¶‡•ã‡§Ç ‡§™‡§∞ ‡§è‡§ï ‡§≤‡•á‡§ñ ‡§∏‡§Æ‡§∞‡•ç‡§™‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡•à‡§∏‡§≤‡§æ ‡§ï‡§ø‡§Ø‡§æ‡•§ </font><font style="vertical-align: inherit;">‡§è‡§ï ‡§π‡•Ä ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç, ‡§Æ‡•à‡§Ç ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§æ‡§∞‡§£‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§≠‡•ç‡§∞‡§Æ ‡§∏‡•á ‡§õ‡•Å‡§ü‡§ï‡§æ‡§∞‡§æ ‡§™‡§æ‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§î‡§∞ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡•§</font></font></p><br>
<h1 id="dart---odnopotochnyy-yazyk"><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ‡§è‡§ï‡§≤ ‡§™‡§ø‡§∞‡•ã‡§Ø‡§æ ‡§≠‡§æ‡§∑‡§æ</font></font></h1><br>
<p>   ,  <code>Dart</code> ‚Äî   <code>Flutter</code>  <code>Dart</code>.</p><br>
<blockquote><code>Dart</code>       . .  ,          .</blockquote><p> ,      (  ),          ,   .</p><br>
<pre><code class="plaintext hljs">void myBigLoop(){<font></font>
    for (int i = 0; i &lt; 1000000; i++){<font></font>
        _doSomethingSynchronously();<font></font>
    }<font></font>
}</code></pre><br>
<p>  ,  <code>myBigLoop()</code>       .  ,     - ,   <code></code>   ,   .</p><br>
<h1 id="model-vypolneniya-v-dart">   <code>Dart</code></h1><br>
<p> <code>Dart</code>,     ,  <code>Event Loop</code>.</p><br>
<p>   <code>Flutter</code>- (  <code>Dart</code>-),      ‚Äî <code>Thread</code>,    ‚Äî <code></code> (<code>Isolate</code>).   ,      .</p><br>
<p>   ,     :</p><br>
<ol>
<li>   (<code>Queues</code>)   <code>MicroTask</code> ()<br>
 <code>Event</code> (),   <code>FIFO</code> (.: first in first out, .. ,<br>
 ,   ),</li>
<li>  <code>main()</code> ,    </li>
<li> <code>Event Loop</code> ( )</li>
</ol><br>
<p>       ,  <br>
   <code>Event Loop</code>     <br>
,      : <code>MicroTask</code>  <code>Event</code>.</p><br>
<p><code>Event Loop</code>   "" ,  <br>
  "".  ,     <br>
<code>Dart</code>-,      ""   :</p><br>
<pre><code class="plaintext hljs">void eventLoop(){<font></font>
    while (microTaskQueue.isNotEmpty){<font></font>
        fetchFirstMicroTaskFromQueue();<font></font>
        executeThisMicroTask();<font></font>
        return;<font></font>
    }<font></font>
<font></font>
    if (eventQueue.isNotEmpty){<font></font>
        fetchFirstEventFromQueue();<font></font>
        executeThisEventRelatedCode();<font></font>
    }<font></font>
}</code></pre><br>
<p> ,  <code>MicroTask</code>     <code>Event</code>.       ?</p><br>
<h1 id="ochered-microtask"> MicroTask</h1><br>
<p>  <code> </code> ,     <code></code>,    -   ,     <code>Event Loop</code>.</p><br>
<p>   <code> </code>        .       - ,     - :</p><br>
<pre><code class="plaintext hljs">MyResource myResource;<font></font>
<font></font>
    ...<font></font>
<font></font>
    void closeAndRelease() {<font></font>
        scheduleMicroTask(_dispose);<font></font>
        _close();<font></font>
    }<font></font>
<font></font>
    void _close(){<font></font>
        // ,     <font></font>
        //   <font></font>
        ...<font></font>
    }<font></font>
<font></font>
    void _dispose(){<font></font>
        // ,    <font></font>
        //   ,  _close()<font></font>
        // <font></font>
    }</code></pre><br>
<p>-,   ,     .  ,     <code></code>  <code>scheduleMicroTask()</code>   7 .    <code>Event</code>.</p><br>
<h1 id="ochered-event"> Event</h1><br>
<p>   ,    :</p><br>
<ul>
<li> ,  <br>
<ul>
<li> /</li>
<li></li>
<li></li>
<li></li>
<li></li>
<li>...</li>
</ul></li>
<li><code>Future</code></li>
</ul><br>
<p>,      ,      <code>Event</code>.</p><br>
<p>  ,   <code>MicroTask</code> , <code>Event Loop</code>      <code>Event</code>   .</p><br>
<p>,  <code>Futures</code>      <code>Event</code>.</p><br>
<h1 id="futures">Futures</h1><br>
<p><code>Future</code>   ,   <code></code>   (   ) -  .</p><br>
<p> ,     <code>Future</code>:</p><br>
<ul>
<li>      ,  <code>Dart</code></li>
<li>,       <code>Future</code>, <br>
   <code>Event</code></li>
<li>  <code>Future</code>   <code> </code> (incomplete)</li>
<li>     ,   (   <code>Future</code>)</li>
</ul><br>
<p>,    <code>Future</code>      <code>Event</code>,<br>
  <code>Event Loop</code>    .</p><br>
<p>   (   )    <code>then()</code><br>
 <code>catchError()</code>  <code>Future</code>.</p><br>
<p> ,   :</p><br>
<pre><code class="plaintext hljs">void main(){<font></font>
    print('Before the Future');<font></font>
    Future((){<font></font>
        print('Running the Future');<font></font>
    }).then((_){<font></font>
        print('Future is complete');<font></font>
    });<font></font>
    print('After the Future');<font></font>
}</code></pre><br>
<p> ,      :</p><br>
<pre><code class="plaintext hljs">Before the Future<font></font>
After the Future<font></font>
Running the Future<font></font>
Future is complete</code></pre><br>
<p>    :</p><br>
<ol>
<li><code>print('Before the Future')</code></li>
<li> <code>(){print('Running the Future');}</code>   <code>Event</code></li>
<li><code>print('After the Future')</code></li>
<li><code>Event Loop</code>     2</li>
<li>  ,     <code>then()</code></li>
</ol><br>
<p>  :</p><br>
<blockquote> <code>Future</code>   <code></code>,    ,  <code>Event Loop</code></blockquote><br>
<h1 id="asinhronnye-metody-async">  (async)</h1><br>
<p>       <code>async</code>,  <code>Dart</code>  , :</p><br>
<ul>
<li>   ‚Äî  <code>Future</code></li>
<li>     ,       <code>await</code>,     </li>
<li>        <code>Future</code>,     <code>await</code>  </li>
</ul><br>
<p>   ,  <code>await</code>      ,   [    Future],    .<br>
     <code>Event Loop</code>...</p><br>
<p>    ,    <br>
,     </p><br>
<pre><code class="plaintext hljs">void main() async {<font></font>
  methodA();<font></font>
  await methodB();<font></font>
  await methodC('main');<font></font>
  methodD();<font></font>
}<font></font>
<font></font>
methodA(){<font></font>
  print('A');<font></font>
}<font></font>
<font></font>
methodB() async {<font></font>
  print('B start');<font></font>
  await methodC('B');<font></font>
  print('B end');<font></font>
}<font></font>
<font></font>
methodC(String from) async {<font></font>
  print('C start from $from');<font></font>
<font></font>
  Future((){                // &lt;==     -  <font></font>
    print('C running Future from $from');<font></font>
  }).then((_){<font></font>
    print('C end of Future from $from');<font></font>
  });<font></font>
<font></font>
  print('C end from $from');  <font></font>
}<font></font>
<font></font>
methodD(){<font></font>
  print('D');<font></font>
}</code></pre><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">A<font></font>
B start<font></font>
C start from B<font></font>
C end from B<font></font>
B end<font></font>
C start from main<font></font>
C end from main<font></font>
D<font></font>
C running Future from B<font></font>
C end of Future from B<font></font>
C running Future from main<font></font>
C end of Future from main</code></pre><br>
<p>  ,  <code>methodC()</code>                . ,  ,            .</p><br>
<p>   ,  <code>methodD()</code>      ,     : </p><br>
<pre><code class="plaintext hljs">void main() async {<font></font>
  methodA();<font></font>
  await methodB();<font></font>
  await methodC('main');<font></font>
  methodD();  <font></font>
}<font></font>
<font></font>
methodA(){<font></font>
  print('A');<font></font>
}<font></font>
<font></font>
methodB() async {<font></font>
  print('B start');<font></font>
  await methodC('B');<font></font>
  print('B end');<font></font>
}<font></font>
<font></font>
methodC(String from) async {<font></font>
  print('C start from $from');<font></font>
<font></font>
  await Future((){                  // &lt;==  <font></font>
    print('C running Future from $from');<font></font>
  }).then((_){<font></font>
    print('C end of Future from $from');<font></font>
  });<font></font>
  print('C end from $from');  <font></font>
}<font></font>
<font></font>
methodD(){<font></font>
  print('D');<font></font>
}</code></pre><br>
<p>  :</p><br>
<pre><code class="plaintext hljs">A<font></font>
B start<font></font>
C start from B<font></font>
C running Future from B<font></font>
C end of Future from B<font></font>
C end from B<font></font>
B end<font></font>
C start from main<font></font>
C running Future from main<font></font>
C end of Future from main<font></font>
C end from main<font></font>
D</code></pre><br>
<p>,      <code>await</code>  <code>Future</code>  <code>methodC()</code>   .</p><br>
<p>   :</p><br>
<blockquote><code></code>    <code></code>,    ,  <code>Event Loop</code></blockquote><p>  .    .     <code>method1</code>  ‚Äî <code>method2</code>?    ?</p><br>
<pre><code class="plaintext hljs">void method1(){<font></font>
  List&lt;String&gt; myArray = &lt;String&gt;['a','b','c'];<font></font>
  print('before loop');<font></font>
  myArray.forEach((String value) async {<font></font>
    await delayedPrint(value);<font></font>
  });  <font></font>
  print('end of loop');<font></font>
}<font></font>
<font></font>
void method2() async {<font></font>
  List&lt;String&gt; myArray = &lt;String&gt;['a','b','c'];<font></font>
  print('before loop');<font></font>
  for(int i=0; i&lt;myArray.length; i++) {<font></font>
    await delayedPrint(myArray[i]);<font></font>
  }<font></font>
  print('end of loop');<font></font>
}<font></font>
<font></font>
Future&lt;void&gt; delayedPrint(String value) async {<font></font>
  await Future.delayed(Duration(seconds: 1));<font></font>
  print('delayedPrint: $value');<font></font>
}</code></pre><br>
<p>:   .</p><br>
<p>  ,  <code>method1</code>   <code>forEach()</code>   .      ,   <code>async</code> (   <code>Future</code>).      <code>await</code>,        <code>Event</code>.   ,   : <code>print('end of loop')</code>.   <code>Event Loop</code>  3 .</p><br>
<p>  <code>method2</code>,          (   )  ‚Äî   .</p><br>
<p> ,      ,     <br>
 <code>Event Loop</code>...</p><br>
<h1 id="mnogopotochnost"></h1><br>
<p>,          <code>Flutter</code>?     ?</p><br>
<p>,   <code>Isolate</code> ().</p><br>
<h1 id="chto-takoe-izolyat">  </h1><br>
<p>   ,  <code>Isolate</code>  <code>Dart</code>   <code>Thread</code> (). </p><br>
<p>        <code>Thread</code>.</p><br>
<blockquote><code></code>  <code>Flutter</code>   .    <code></code>   .</blockquote><br>
<h1 id="kazhdomu-izolyatu-polozhen-otdelnyy-event-loop"> <code></code>   <code>Event Loop</code>.</h1><br>
<p>      (<code>MicroTask</code>  <code>Event</code>).</p><br>
<p>   <code></code>    <code></code>.</p><br>
<p>         <code>Dart</code>.</p><br>
<h1 id="kak-zapustit-izolyat">  <code></code></h1><br>
<p>    ,     .</p><br>
<h2 id="1-nizkourovnevoe-reshenie">1.  </h2><br>
<p>      ()      API,  <code>Dart</code>.</p><br>
<h3 id="11-shag-1-sozdanie-i-rukopozhatie">1.1.  1:   </h3><br>
<p>   , <code></code>       ,  ,      ""  ""      <code></code>.</p><br>
<p> <code></code>  ,  ,     <code></code>.    <code>SendPort</code> (  ,      ,      /,     ).</p><br>
<p>, ""  " "     ,    "".        :</p><br>
<pre><code class="plaintext hljs">//<font></font>
//   <font></font>
//     <font></font>
//    <font></font>
//<font></font>
SendPort newIsolateSendPort;<font></font>
<font></font>
//<font></font>
//   <font></font>
//<font></font>
Isolate newIsolate;<font></font>
<font></font>
//<font></font>
// ,    <font></font>
//   <font></font>
//<font></font>
void callerCreateIsolate() async {<font></font>
    //<font></font>
    //   ReceivePort  <font></font>
    // SendPort  <font></font>
    //<font></font>
    ReceivePort receivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //   <font></font>
    //<font></font>
    newIsolate = await Isolate.spawn(<font></font>
        callbackFunction,<font></font>
        receivePort.sendPort,<font></font>
    );<font></font>
<font></font>
    //<font></font>
    //     ""<font></font>
    //<font></font>
    newIsolateSendPort = await receivePort.first;<font></font>
}<font></font>
<font></font>
//<font></font>
//    <font></font>
//<font></font>
static void callbackFunction(SendPort callerSendPort){<font></font>
    //<font></font>
    //   SendPort   <font></font>
    //  ""<font></font>
    //<font></font>
    ReceivePort newIsolateReceivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //  ""   SendPort  <font></font>
    //<font></font>
    callerSendPort.send(newIsolateReceivePort.sendPort);<font></font>
<font></font>
    //<font></font>
    //  <font></font>
    //<font></font>
}</code></pre><br>
<blockquote> :            </blockquote><br>
<h3 id="12-shag-2-otpravka-soobscheniya-izolyatu">1.2.  2:   <code></code></h3><br>
<p>,        <code></code>,     : </p><br>
<pre><code class="plaintext hljs">//<font></font>
// ,     <font></font>
//   <font></font>
// <font></font>
//     ""<font></font>
//   String (   )<font></font>
//<font></font>
Future&lt;String&gt; sendReceive(String messageToBeSent) async {<font></font>
    //<font></font>
    //     <font></font>
    //<font></font>
    ReceivePort port = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //   ,  <font></font>
    //  ,   <font></font>
    //   <font></font>
    //<font></font>
    newIsolateSendPort.send(<font></font>
        CrossIsolatesMessage&lt;String&gt;(<font></font>
            sender: port.sendPort,<font></font>
            message: messageToBeSent,<font></font>
        )<font></font>
    );<font></font>
<font></font>
    //<font></font>
    //     <font></font>
    //<font></font>
    return port.first;<font></font>
}<font></font>
<font></font>
//<font></font>
// Callback-    <font></font>
//<font></font>
static void callbackFunction(SendPort callerSendPort){<font></font>
    //<font></font>
    //   SendPort   <font></font>
    //  <font></font>
    //<font></font>
    ReceivePort newIsolateReceivePort = ReceivePort();<font></font>
<font></font>
    //<font></font>
    //  ""   SendPort  <font></font>
    //<font></font>
    callerSendPort.send(newIsolateReceivePort.sendPort);<font></font>
<font></font>
    //<font></font>
    //  ,    ,<font></font>
    //    <font></font>
    //<font></font>
    newIsolateReceivePort.listen((dynamic message){<font></font>
        CrossIsolatesMessage incomingMessage = message as CrossIsolatesMessage;<font></font>
<font></font>
        //<font></font>
        //  <font></font>
        //<font></font>
        String newMessage = "complemented string " + incomingMessage.message;<font></font>
<font></font>
        //<font></font>
        //   <font></font>
        //<font></font>
        incomingMessage.sender.send(newMessage);<font></font>
    });<font></font>
}<font></font>
<font></font>
//<font></font>
//  <font></font>
//<font></font>
class CrossIsolatesMessage&lt;T&gt; {<font></font>
    final SendPort sender;<font></font>
    final T message;<font></font>
<font></font>
    CrossIsolatesMessage({<font></font>
        @required this.sender,<font></font>
        this.message,<font></font>
    });<font></font>
}</code></pre><br>
<h3 id="13-shag-3-udalenie-izolyata">1.3.  3:  <code></code></h3><br>
<p>      <code></code>,    :</p><br>
<pre><code class="plaintext hljs">void dispose(){<font></font>
    newIsolate?.kill(priority: Isolate.immediate);<font></font>
    newIsolate = null;<font></font>
}</code></pre><br>
<h3 id="14-zamechanie---stream-s-odnim-slushatelem">1.4.  ‚Äî <code>Stream</code>   </h3><br>
<p>   ,   "" <code></code>  ""    (Streams).    <code>Single-Listener Stream</code> (   ).</p><br>
<h2 id="2-odnorazovoe-vychislenie-one-shot-computation">2.   (One-shot computation)</h2><br>
<p> ,               <code></code>  ,  <code>Dart</code>    <code>compute</code>, </p><br>
<ul>
<li> <code></code></li>
<li>    <code></code>,    </li>
<li>  ‚Äî  -</li>
<li> <code></code>    .</li>
</ul><br>
<blockquote> :               ( ).</blockquote><br>
<h2 id="3-ochen-vazhnoe-ogranichenie">3.   </h2><br>
<p>   ,  , </p><br>
<blockquote>  (Platform-Channel communication)     <code></code> (main isolate).   <code></code>,      .</blockquote><p> ,      <code></code>,<br>
  .</p><br>
<h1 id="kogda-mne-sleduet-ispolzovat-future-i-izolyaty">    <code>Future</code>  <code></code></h1><br>
<p>       ,  :</p><br>
<ul>
<li></li>
<li> </li>
<li>  (user friendliness)</li>
</ul><br>
<p>      ,        (user experiences lags),      .</p><br>
<p>  ,       :</p><br>
<ol>
<li>      ,  <br>
  (       )</li>
<li>    ,     <br>
 ,   ‚Äî <code>Event Loop</code>   <code>Futures</code></li>
<li>      ,  <br>
    ,   ‚Äî <code></code></li>
</ol><br>
<p> , ,   ,   <code>Futures</code> (   <code>async</code>-) ‚Äî   <code>Futures</code>      <code>Event Loop</code>  "" .    ,     ( - ,    ).</p><br>
<p>  ,       <code>Future</code>  <code></code> ‚Äî   ,     .</p><br>
<ul>
<li>  =&gt; <code>Future</code></li>
<li>  =&gt; <code></code></li>
</ul><br>
<p>       <code></code>:</p><br>
<ul>
<li> JSON,     (HttpRequest),  <br>
  =&gt;  <code>compute</code></li>
<li>:      =&gt; <code></code></li>
<li>  (  ..)    =&gt; <code></code></li>
<li>   :       <code></code>,   ,     .</li>
</ul><br>
<h1 id="zaklyuchenie"></h1><br>
<p>,   ,   <code>Event Loop</code>  .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§Ø‡§π ‡§≠‡•Ä ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à ‡§ï‡§ø ‡§á‡§∏‡•á ‡§® ‡§≠‡•Ç‡§≤‡•á‡§Ç </font></font><code>Flutter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>Dart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ‡§∏‡§ø‡§Ç‡§ó‡§≤-‡§•‡•ç‡§∞‡•á‡§°‡•á‡§° ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§§‡•Å‡§∑‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§°‡•á‡§µ‡§≤‡§™‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§ï‡§ø ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§Ø‡§•‡§æ‡§∏‡§Ç‡§≠‡§µ ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ </font></font><code>Futures</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§î‡§∞ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ‡§á‡§∏ ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡§ï‡•ç‡§§‡§ø‡§∂‡§æ‡§≤‡•Ä ‡§â‡§™‡§ï‡§∞‡§£‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§∏‡•å‡§≠‡§æ‡§ó‡•ç‡§Ø</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi497264/index.html">‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§á‡§Ç‡§ü‡§∞‡§´‡§º‡•á‡§∏‡•§ ‡§≠‡§æ‡§ó 2. ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</a></li>
<li><a href="../hi497268/index.html">‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï "‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•á‡§ñ ‡§™‡§¢‡§º‡•á‡§Ç‡•§" ‡§Æ‡§æ‡§∞‡•ç‡§ö 2020. ‡§≠‡§æ‡§ó 2</a></li>
<li><a href="../hi497270/index.html">‡§®‡§à ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï‡§§‡§æ‡•§ 2.5 ‡§Æ‡§ø‡§≤‡§ø‡§Ø‡§® ‡§∞‡•Ç‡§¨‡§≤ ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§π‡•à‡§ï‡§•‡•â‡§®</a></li>
<li><a href="../hi497272/index.html">‡§∏‡•á‡§∞‡§æ‡§´‡§ø‡§Æ ‡§ï‡•å‡§® ‡§π‡•à? ‡§Ø‡§æ ‡§è‡§ï ‡§π‡•Ä ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç ‡§π‡•à‡§ï‡§•‡•â‡§® ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§ñ‡•ã‡§®‡§æ ‡§î‡§∞ ‡§ú‡•Ä‡§§‡§®‡§æ ‡§π‡•à</a></li>
<li><a href="../hi497276/index.html">‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç: ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø "‡§∏‡•ç‡§µ‡§∏‡•ç‡§•" ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ ‡§ï‡•à‡§∏‡•Ä ‡§π‡•à?</a></li>
<li><a href="../hi497280/index.html">‡§ï‡•à‡§∏‡•á ‡§Æ‡•à‡§Ç‡§®‡•á ‡§°‡§∞‡§®‡§æ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§î‡§∞ ‡§Æ‡•Å‡§ù‡•á ‡§ï‡•ã‡§≤‡•á‡§∏‡•ç‡§ü‡•ç‡§∞‡•â‡§≤ ‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ</a></li>
<li><a href="../hi497282/index.html">‡§ï‡•ã‡§£‡•Ä‡§Ø ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§° ‡§ï‡•ã ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§ï‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§à‡§è‡§∏‡§≤‡§ø‡§Ç‡§ü, ‡§ï‡•ã‡§°‡§≤‡•Ä‡§ú‡§∞, ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§≤‡§ø‡§Ç‡§ü, ‡§π‡§∏‡•ç‡§ï‡•Ä, ‡§≤‡§ø‡§Ç‡§ü-‡§∏‡•ç‡§ü‡•á‡§ú‡•ç‡§° ‡§î‡§∞ ‡§™‡•ç‡§∞‡•Ä‡§ü‡•Ä‡§Ø‡§∞</a></li>
<li><a href="../hi497286/index.html">‡§≤‡•Å‡§¶‡•Å‡§Æ ‡§°‡•á‡§Ø‡§∞: ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§∏‡•á ‡§è‡§ï ‡§∏‡§™‡•ç‡§§‡§æ‡§π ‡§™‡§π‡§≤‡•á ‡§ö‡•á‡§ï‡§≤‡§ø‡§∏‡•ç‡§ü</a></li>
<li><a href="../hi497288/index.html">‡§∏‡§ú‡§æ‡§µ‡§ü‡•Ä ‡§õ‡§§ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§´‡•á‡§∞‡§® AL5000</a></li>
<li><a href="../hi497290/index.html">‡§∏‡•à‡§Ç‡§°‡•Ä ‡§¨‡•ç‡§∞‡§ø‡§ú + ‡§™‡§∞ ‡§Ø‡•Ç‡§ì‡§™‡•Ä ‡§ï‡•à‡§∂ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ß‡§æ‡§∞</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>