<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍⚖️ 👷 🙋🏻 Apa itu Windows PowerShell dan apa yang dimakannya? Bagian 5: Akses ke objek eksternal 🚃 🏗️ 🤜🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sistem operasi Windows mendukung berbagai infrastruktur objek. Anda dapat menggunakan antarmuka pemrograman aplikasi (API) untuk mengaksesnya, tetapi ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apa itu Windows PowerShell dan apa yang dimakannya? Bagian 5: Akses ke objek eksternal</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/498478/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sistem operasi Windows mendukung berbagai infrastruktur objek. </font><font style="vertical-align: inherit;">Anda dapat menggunakan antarmuka pemrograman aplikasi (API) untuk mengaksesnya, tetapi mengembangkan aplikasi lengkap tidak selalu dibenarkan. </font><font style="vertical-align: inherit;">PowerShell memiliki cmdlet khusus yang memungkinkan Anda mengakses objek .NET, COM, WMI (CIM), dan ADSI secara interaktif. </font><font style="vertical-align: inherit;">Pada bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keempat dari seri ini,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami mempelajari dasar-dasarnya dengan fokus pada kelas .NET Core, dan sekarang kami ingin memperdalam topik dan memahami fitur interaksi PowerShell dengan objek eksternal.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar Isi:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan JSON, XML dan CSV </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan WMI dan CIM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan objek COM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan layanan direktori ADSI </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memformat output</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan JSON, XML dan CSV</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di skrip PowerShell, Anda sering harus mengurai data JSON, XML, dan CSV. Biasanya kebutuhan ini muncul ketika bekerja dengan layanan Internet atau dengan file konfigurasi. Beberapa administrator mencoba mem-parsing data menggunakan ekspresi reguler, tetapi tidak perlu membuat pengorbanan seperti itu: PowerShell memiliki cmdlet khusus untuk konversi, terlebih lagi, di kedua arah.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ep/q6/tr/epq6trkxgw_sfw21p1wmfixyrfk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Format JSON memungkinkan Anda untuk menggambarkan berbagai objek dan, pada dasarnya, adalah hashtable yang dapat disarangkan. </font><font style="vertical-align: inherit;">Konversi objek JSON ke objek .NET dengan PowerShell karenanya mudah. </font><font style="vertical-align: inherit;">Karena layanan Internet biasanya memberikan garis yang sangat panjang alih-alih file yang diformat dengan indah, konversi ini juga dapat berguna untuk bekerja dalam mode interaktif. </font><font style="vertical-align: inherit;">Dalam contoh di bawah ini, kami menggunakan variabel teks multiline untuk menggambarkan objek JSON:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-string">@"
{
   "firstName": "Ivan",
   "lastName": "Danko",
   "address": {
       "streetAddress": "Kremlin",
       "city": "Moscow"
   },
   "phoneNumbers": [
       "+7 495 1234567",
       "+7 499 1234567"
   ]
}
"@</span> | <span class="hljs-built_in">ConvertFrom-Json</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/vu/2j/x6/vu2jx6vrks90qvsuoehs6ky43ke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalah terbalik diselesaikan dengan cara yang sama:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$file</span> = <span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\notepad.exe
<span class="hljs-variable">$file</span>.VersionInfo | <span class="hljs-built_in">ConvertTo-Json</span></code></pre><br>
<img src="https://habrastorage.org/webt/rd/tb/dq/rdtbdqlfwsepqmnggw_2uk7omkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
String format JSON yang dihasilkan mudah dikirim ke aplikasi lain melalui jaringan. </font><font style="vertical-align: inherit;">Ini bisa berupa, misalnya, beberapa layanan tenang. </font><font style="vertical-align: inherit;">Bekerja dengan cmdlet ConvertFrom-Csv, ConvertTo-Csv, dan ConvertTo-Xml dibangun dengan cara yang kira-kira sama, kami sarankan pembaca untuk mempelajarinya secara mandiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk bekerja dengan XML dan CSV, kita perlu cmdlet lain: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/hy/m7/jzhym7nqvb5id7fvdys9ao59meq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan alat-alat ini, Anda perlu memahami bahwa mengonversi objek biner ke format teks hanya menyimpan nilai propertinya, tetapi bukan metodenya. </font><font style="vertical-align: inherit;">Mengubah data JSON, XML, atau CSV ke objek .NET menggunakan PowerShell hanya mungkin jika valid.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan WMI dan CIM</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Management Instrumentasi (WMI) adalah implementasi standar WBEM (Web-Based Enterprise Management) yang dikembangkan oleh Microsoft dan diadaptasi oleh Windows. Ini didasarkan pada gagasan untuk menciptakan solusi universal untuk memantau lingkungan informasi yang didistribusikan dari suatu perusahaan dan mengelola komponen-komponennya. Struktur data WBEM, pada gilirannya, didasarkan pada Common Information Model (CIM), yang mengimplementasikan pendekatan berorientasi objek pada representasi sistem komputer. Pengembangan lebih lanjut dan dukungan WMI di Windows telah dihentikan, Microsoft merekomendasikan untuk menggunakan mekanisme serupa untuk mengelola infrastruktur - objek CIM. Untuk bekerja dengannya, cmdlet khusus muncul di PowerShell 3.0, yang akan kami pertimbangkan secara paralel dengan rekan-rekan WMI. Jika kode berisi panggilan cmdlet untuk bekerja dengan WMI, kode itu harus ditulis ulang jika memungkinkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h6/io/mw/h6iomwnjjrssdkl_tw7gi0mwjhm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kerangka model CIM (ini juga digunakan dalam WMI), data sistem operasi disajikan dalam bentuk kelas dengan properti dan metode. Kelas dikelompokkan dalam urutan hierarkis dan terkait secara logis oleh teknologi namespace atau area manajemen. Ada root namespace Root yang memiliki subruang: CIMv2, Default, Secutiry, dan WMI. Untuk identifikasi yang jelas dari instance kelas (objek) dan deskripsi status sumber daya yang sesuai, properti kelas digunakan, yang biasanya hanya-baca. Metode digunakan untuk mengelola sumber daya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instance kelas dapat diakses oleh path lengkap, yang memiliki bentuk berikut:</font></font><br>
<br>
<pre><code class="powershell hljs">[\\<span class="hljs-type">ComputerName</span>\<span class="hljs-type">NameSpace</span>][:<span class="hljs-type">ClassName</span>][<span class="hljs-type">.KeyProperty1</span>=<span class="hljs-type">Value1</span>][,<span class="hljs-type">KeyProperty2</span>=<span class="hljs-type">Value2</span>]…]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
di mana </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ComputerName adalah nama komputer; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NameSpace - namespace; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ClassName - nama kelas; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KeyProperty1 = Value1, KeyProperty2 = Value2 - properti objek dan nilai-nilai yang dengannya ia diidentifikasi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum PowerShell, alat WMI sederhana tidak ada. </font><font style="vertical-align: inherit;">Untuk mengakses objek, Anda harus menulis program yang agak rumit dalam bahasa tingkat tinggi (C ++, Visual Basic, Java Script) atau mempelajari shell WMIC (WMI Command Line, yang juga dihentikan) dengan bahasanya sendiri. </font><font style="vertical-align: inherit;">Melalui PowerShell, objek WMI dapat diakses oleh pengguna rata-rata dari baris perintah atau dalam skrip. </font><font style="vertical-align: inherit;">Pertama, sambungkan ke subsistem WMI dan dapatkan daftar kelas yang tersedia menggunakan cmdlet Get-WmiObject (alias gwmi). </font><font style="vertical-align: inherit;">Untuk mendapatkan daftar kelas CIM, gunakan cmdlet Get-CimClass.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-List</span></code></pre><br>
<img src="https://habrastorage.org/webt/g7/1z/wz/g71zwzueejpnyrgwqkoqpxlwn7a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami telah mendaftarkan kelas-kelas di komputer lokal, tetapi Anda dapat terhubung ke remote:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> IP- 
<span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> _</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
atau</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> IP- <span class="hljs-literal">-List</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> _ <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara default, cmdlet Get-CimClass dan Get-WmiObject terhubung ke namespace Root \ CIMV2, yang menyimpan sejumlah besar kelas untuk mengelola sistem. </font><font style="vertical-align: inherit;">Untuk mengubah namespace, gunakan parameter -Namespace:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-Namespace</span> Root
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Namespace</span> Root <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengetahui nama kelasnya, tidak sulit untuk mendapatkan contohnya. </font><font style="vertical-align: inherit;">Perintah berikut mengembalikan semua instans dari Win32_Service, mis. </font><font style="vertical-align: inherit;">layanan yang terdaftar di mesin lokal:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti jenis objek lainnya, daftar properti dan metode ditampilkan menggunakan Get-Member. </font><font style="vertical-align: inherit;">Metode objek WMI dapat diakses secara langsung atau menggunakan cmdlet Invoke-WmiMethod. </font><font style="vertical-align: inherit;">Anda juga bisa menggunakan cmdlet untuk objek WMI untuk mengurutkan, memfilter, mengelompokkan, dll.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/pq/rn/nk/pqrnnkbv1abfqzn5hlnsgunzamu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mendapatkan objek CIM (instance kelas), gunakan cmdlet Get-CimInstance. </font><font style="vertical-align: inherit;">Tidak seperti WMI, objek CIM yang dihasilkan (objek yang dihasilkan atau instance kelas) tidak mengandung metode kelas. </font><font style="vertical-align: inherit;">Karena Anda tidak dapat langsung mengekstrak metode, Anda harus menjalankan cmdlet Invoke-CimMethod. </font><font style="vertical-align: inherit;">Pertimbangkan kelas Win32_Service - layanan yang berjalan pada sistem) dan instansnya untuk layanan spooler pada mesin lokal:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> </code></pre><br>
<img src="https://habrastorage.org/webt/qm/jf/cz/qmjfcz-_u-le6js9tibb3qc5y2i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat struktur objek yang dihasilkan:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/t4/uo/ub/t4uoublc7mxrlb6khyrycfozod4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada titik ini, manfaat cmdlet untuk bekerja dengan objek CIM tidak jelas. </font><font style="vertical-align: inherit;">Mereka terutama berhubungan dengan pekerjaan jarak jauh di lingkungan terdistribusi dan akan dibahas secara rinci dalam artikel terakhir dalam seri yang ditujukan untuk memecahkan masalah praktis administrasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada juga toolkit khusus WMI: WMI Query Language (WQL), bahasa query seperti SQL. </font><font style="vertical-align: inherit;">Kueri WQL untuk mencari semua start-up ketika memulai sistem layanan terlihat seperti ini:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">select</span> * from win32_service <span class="hljs-built_in">where</span> startmode=<span class="hljs-string">"Auto"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari PowerShell, mereka dieksekusi sebagai berikut:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Query</span> <span class="hljs-string">'select * from win32_service where startmode="Auto"'</span></code></pre><br>
<img src="https://habrastorage.org/webt/wc/y7/wf/wcy7wfk7619yx_9es0cjz9bi4vw.png"><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan objek COM</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memastikan interaksi antara aplikasi di Windows, teknologi untuk menghubungkan dan menyematkan objek (Object Linking and Embedding atau OLE) dikembangkan. Kemudian, teknologi OLE Automation muncul, dengan bantuan aplikasi klien otomasi yang dapat memanggil fungsi aplikasi lain - server otomasi. OLE dan OLE Automation didasarkan pada teknologi inti dari Component Object Model (COM), yang menawarkan standar biner tunggal untuk komponen perangkat lunak. Objek yang dibuat menggunakannya dan terdaftar di sistem operasi dapat digunakan dalam aplikasi lain menggunakan file yang dapat dieksekusi atau perpustakaan dinamis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekitar pertengahan tahun sembilan puluhan, alih-alih OLE, istilah lain mulai digunakan - ActiveX. </font><font style="vertical-align: inherit;">Sebelum munculnya platform .NET, teknologi ActiveX dianggap penting, dan objek COM masih aktif digunakan untuk mengintegrasikan aplikasi ke dalam Windows - banyak produk Microsoft dan pihak ketiga adalah server otomatisasi dan menyediakan akses ke layanan mereka melalui mereka. </font><font style="vertical-align: inherit;">Untuk mengakses objek, ProgID digunakan - pengidentifikasi simbolis yang diberikan kepada mereka ketika mendaftar di registri Windows. </font><font style="vertical-align: inherit;">Ini memiliki bentuk berikut:</font></font><br>
<br>
<pre><code class="powershell hljs">_..</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versi biasanya tidak ditunjukkan:</font></font><br>
<br>
<pre><code class="powershell hljs">_.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa contoh ProgID yang tersedia adalah: InternetExplorer.Application (aplikasi Internet Explorer), Word.Application (aplikasi Microsoft Word), WScript.Shell (kelas Shell dari Windows Script Host atau model objek server script WSH). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda bisa membuat turunan objek menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdlet Objek Baru yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dibahas dalam artikel sebelumnya </font><font style="vertical-align: inherit;">, dan melihat strukturnya menggunakan Get-Member:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/bk/s5/fh/bks5fhq3q-yhle1fwb4-vjkqpk0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk bekerja dengan objek, properti dan metode digunakan. </font><font style="vertical-align: inherit;">Katakanlah, untuk membuat pintasan di desktop pengguna, Anda perlu memanggil metode CreateShortcut ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> = <span class="hljs-variable">$myshell</span>.CreateShortcut(<span class="hljs-string">"<span class="hljs-variable">$Home</span>\Desktop\Home.lnk"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa pintasan juga merupakan objek COM:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/05/d8/4_/05d84_-mbzmfuffczrmr76khfyg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap bagi kami untuk mengisi propertinya dan menyimpan:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span>.TargetPath = <span class="hljs-variable">$Home</span>
<span class="hljs-variable">$link</span>.Save()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan cara ini, kami membuat pintasan di desktop pengguna aktif, dan sekarang kami akan menganalisis bekerja dengan layanan otomatisasi eksternal menggunakan contoh objek COM Shell.Application. </font><font style="vertical-align: inherit;">Dengannya, Anda dapat mengotomatiskan beberapa tindakan di Windows Explorer:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Shell.Application</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
atau singkatnya:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-com</span> Shell.Application
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/__/iu/qy/__iuqyjf29nliwugz-jybihkfj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Objek Shell.Application memiliki beberapa metode manajemen jendela yang berbeda. </font><font style="vertical-align: inherit;">Misalnya, untuk menampilkan konten direktori yang diberikan, Jelajahi () digunakan:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Explore(<span class="hljs-string">"c:\"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sistem bantuan disebut menggunakan metode Bantuan ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Help()</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada juga tiga metode untuk menjalankan dialog pencarian: FindFiles (), FindComputer (), dan FindPrinter ().</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.FindFiles()
<span class="hljs-variable">$myshell</span>.FindComputer()
<span class="hljs-variable">$myshell</span>.FindPrinter()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat membuka dialog peluncuran program menggunakan metode FileRun (), dan untuk memanggil jendela pengaturan tanggal / waktu, Anda memerlukan metode SetTime (). </font><font style="vertical-align: inherit;">Ada, misalnya, metode untuk memanggil jendela pengaturan bilah tugas, elemen panel kontrol yang menunjukkan salah satu file cpl yang tersedia, untuk mengelola jendela terbuka:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.MinimizeAll()
<span class="hljs-variable">$myshell</span>.UndoMinimizeAll()
<span class="hljs-variable">$myshell</span>.TileHorizontally()
<span class="hljs-variable">$myshell</span>.TileVertically()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode Windows () memungkinkan Anda untuk mengakses kumpulan jendela terbuka di Explorer atau di Internet Explorer. </font><font style="vertical-align: inherit;">Mari kita lihat properti dan metode yang tersedia untuk koleksi ini:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Windows() | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/dq/ls/yo/dqlsyokgkrtk6rc-okuskmpwsvo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada objek COM lain yang bermanfaat, yang jumlahnya tergantung pada perangkat lunak yang diinstal dalam sistem. </font><font style="vertical-align: inherit;">Sekali waktu, alat otomatisasi utama di Windows adalah server script WSH, model objek yang juga mencakup objek COM: dirancang untuk bekerja dengan fungsi jaringan WScript.Network dan WScript.Shell yang telah kami sebutkan. </font><font style="vertical-align: inherit;">Yang terakhir tidak hanya membuat pintasan di desktop, dengan bantuannya Anda dapat, misalnya, menampilkan informasi jendela dengan pesan dan tombol, beralih di antara aplikasi, meluncurkan program atau mensimulasikan penekanan tombol.</font></font><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan Layanan Direktori ADSI</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, katalog mengacu pada sumber informasi di mana data tentang beberapa objek disimpan. Dengan layanan direktori, yang kami maksudkan adalah bagian dari sistem komputer terdistribusi yang memungkinkan Anda untuk mengakses dan memanipulasi objek yang disimpan. Layanan direktori dapat menggabungkan data tentang objek jaringan dan layanan yang memanipulasi mereka - ini merupakan titik masuk tunggal untuk berinteraksi dengan sumber daya jaringan. Mungkin ada banyak layanan seperti itu dalam jaringan komputer yang heterogen: SAM lokal (Manajer Akun Keamanan) untuk komputer non-domain, Direktori Aktif, dll.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interaksi dengan layanan direktori yang berbeda memerlukan alat yang berbeda, yang menciptakan ketidaknyamanan tertentu. Dimulai pada Windows 2000, Microsoft telah memperkenalkan teknologi Active Directory Service Interface (ADSI) terpadu untuk sistem operasi yang tidak bergantung pada protokol akses jaringan tertentu. Untuk menemukan objek, namespace didefinisikan untuk direktori. Karena layanan direktori yang berbeda menggunakan metode penamaan yang berbeda, ADSI mendefinisikan konvensi yang secara unik mengidentifikasi objek apa pun. Konsep string pengikat dua bagian atau ADsPath diperkenalkan. Bagian pertama dari nama mendefinisikan layanan direktori (penyedia ADSI), dan yang kedua - lokasi objek dalam direktori. Berikut adalah contoh penunjukan penyedia ADSI yang berbeda: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDAP: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan untuk layanan direktori berbasis LDAP, termasuk </font><font style="vertical-align: inherit;">untuk Direktori Aktif; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinNT: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan untuk komputer lokal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada cmdlet khusus untuk bekerja dengan ADSI di PowerShell. </font><font style="vertical-align: inherit;">Sebagai gantinya, operator transmisi [ADSI] digunakan diikuti oleh tali pengikat. </font><font style="vertical-align: inherit;">Misalnya, untuk terhubung ke pengguna Ivanov dari domain test.ru, konstruksi berikut diperlukan:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"LDAP://CN=Ivanov,DC=TEST,DC=RU"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk bekerja dengan akun lokal, Anda harus terhubung ke komputer dengan nama yang sesuai (untuk terhubung ke komputer lokal, cukup gunakan titik alih-alih nama):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$computer</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://."</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalnya, buat pengguna baru, Ivanov, di mesin lokal:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-variable">$computer</span>.Create(<span class="hljs-string">"user"</span>,<span class="hljs-string">"Ivanov"</span>)
<span class="hljs-variable">$user</span>.Put(<span class="hljs-string">"Description"</span>,<span class="hljs-string">"  PowerShell"</span>)
<span class="hljs-variable">$user</span>.SetInfo()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang terhubung ke sana:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user1</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://./Ivanov,user"</span>
<span class="hljs-variable">$user1</span>.Description</code></pre><br>
<img src="https://habrastorage.org/webt/pb/9l/5m/pb9l5mpw09oocoetnw3x4iawzmm.png"><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemformatan keluaran</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pekerjaan interaktif seringkali membutuhkan tampilan data. Di shell lain, perintah dan utilitas itu sendiri terlibat dalam memformat output, tetapi objek biner dikembalikan oleh fungsi dan cmdlet biasanya tidak tahu bagaimana melakukan ini. Di PowerShell, output diformat oleh empat cmdlet khusus yang memberi makan objek melalui pipa. Informasi lebih rinci dapat diperoleh dengan menggunakan Get-Help: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Table</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memformat output dalam bentuk tabel yang kolomnya berisi nilai-nilai properti objek atau nilai yang dihitung. Kemampuan untuk mengelompokkan data didukung; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Daftar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menampilkan objek sebagai daftar properti, yang masing-masing ditampilkan pada baris baru. Kemampuan untuk mengelompokkan data didukung; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-kustom</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memformat output menggunakan tampilan kustom; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Wide</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memformat objek dalam bentuk tabel lebar di mana hanya satu properti dari setiap objek ditampilkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika tidak ada cmdlet yang terdaftar dipanggil, modul pemformatan yang sesuai dengan jenis data yang ditampilkan digunakan. Aturan tampilan disimpan dalam file konfigurasi dalam format XML dengan ekstensi .ps1xml, yang terletak di direktori $ PSHome. Daftar mereka dapat diperoleh dengan menggunakan perintah berikut:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> <span class="hljs-variable">$pshome</span>\*format*.ps1xm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengedit file konfigurasi secara manual tidak disarankan, lebih baik membuat sendiri dan memasukkannya ke dalam daftar file yang diunduh menggunakan cmdlet Update-FormatData. Jika formatter default untuk tipe yang Anda inginkan tidak ditentukan, PowerShell menampilkan properti objek pada layar dalam daftar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini menyimpulkan deskripsi bekerja dengan objek di PowerShell, dan artikel terakhir dalam seri akan dikhususkan untuk memecahkan masalah praktis mengelola lingkungan informasi yang didistribusikan dari suatu perusahaan. Di dalamnya, semua alat yang dijelaskan bermanfaat bagi kita. Fokus utamanya adalah pada objek CIM dan perbandingannya dengan WMI. Bagian yang lalu dapat ditemukan di tautan di bawah ini.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 1:   Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 4:   ,  </a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498458/index.html">Panggilan video dengan latar belakang virtual dan alat sumber terbuka</a></li>
<li><a href="../id498462/index.html">Gulir tanpa batas dengan spanduk, atau Bagaimana melakukan dengan tiga tampilan</a></li>
<li><a href="../id498466/index.html">Bagaimana laser dan sensor membantu membuat hakim gugup</a></li>
<li><a href="../id498472/index.html">Gambar Docker Aplikasi Halaman Tunggal</a></li>
<li><a href="../id498476/index.html">Aksesibilitas Cara membuat aplikasi dapat diakses oleh pengguna penyandang cacat</a></li>
<li><a href="../id498482/index.html">Situasi: Penyedia AS diminta untuk menghapus ambang batas untuk mengunduh data - yang pada akhirnya</a></li>
<li><a href="../id498484/index.html">Wi-Fi 6 dan Huawei P40: di mana koneksi?</a></li>
<li><a href="../id498486/index.html">Cara memperluas semantik berbahasa Inggris untuk iklan pencarian di ceruk yang sempit</a></li>
<li><a href="../id498490/index.html">Sistem sertifikasi yang efektif yang akan memungkinkan Anda untuk menjadi pemimpin yang lebih baik</a></li>
<li><a href="../id498492/index.html">Sayang, kami membunuh birokrasi: bagaimana digitalisasi mengubah dialog antara pemasok dan X5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>