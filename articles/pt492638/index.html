<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅 🔧 👻 Escalando um aplicativo Redux com patos 👊🏼 🙎🏿 👨‍👨‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antecipando o início do curso, o "desenvolvedor React.js." preparou uma tradução de material útil.
 
 
 
 
 Como o front-end do seu aplicativo é escal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Escalando um aplicativo Redux com patos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/492638/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antecipando o início do curso, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"desenvolvedor React.js."</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> preparou uma tradução de material útil.</font></font><br>
</i></b><br>
<br>
<img src="https://habrastorage.org/webt/v4/na/xg/v4naxgyec9pamduy0s1qf7gjqyc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o front-end do seu aplicativo é escalado? Como fazer seu código suportar seis meses depois? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em 2015, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invadiu o mundo do desenvolvimento front-end e se estabeleceu como um padrão além do React. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A empresa em que trabalho recentemente terminou de refatorar uma grande base de código no React, onde implementamos o redux em vez do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reflux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tivemos que dar esse passo, porque seguir em frente não era possível sem um aplicativo bem estruturado e um conjunto claro de regras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A base de código existe há mais de dois anos e o refluxo está presente desde o início. Tivemos que mudar o código, fortemente vinculado aos componentes React, que ninguém tocou por mais de um ano.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base na experiência do trabalho realizado, criei este </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositório</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que ajudará a explicar nossa abordagem para organizar o código no redux.</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando você aprende mais sobre redux, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ações</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redutores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , começa com exemplos simples. </font><font style="vertical-align: inherit;">Muitos tutoriais disponíveis hoje não vão além deles. </font><font style="vertical-align: inherit;">No entanto, se você estiver criando algo mais complicado no Redux do que uma lista de tarefas, precisará de uma maneira razoável de escalar sua base de código ao longo do tempo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguém disse uma vez que na ciência da computação não há tarefa mais difícil do que dar nomes a coisas diferentes. </font><font style="vertical-align: inherit;">Eu não poderia discordar. </font><font style="vertical-align: inherit;">Nesse caso, a estrutura de pastas e a organização de arquivos estarão em segundo lugar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver como costumávamos abordar a organização do código.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Função vs Recurso</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Existem duas abordagens geralmente aceitas para organizar aplicativos: função primeiro e recurso primeiro. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Na captura de tela à esquerda, a estrutura da pasta é organizada de acordo com o princípio da função primeiro, e à direita - recurso primeiro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/le/wb/urlewbt5etkrntpbqzlygb0yzlo.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Função primeiro significa que os diretórios de nível superior são nomeados de acordo com os arquivos contidos. Então você tem: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contêineres, componentes, ações, redutores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso não é escalável. À medida que o aplicativo cresce e novas funcionalidades aparecem, você adiciona arquivos às mesmas pastas. Como resultado, você precisará rolar o conteúdo de uma das pastas por um longo tempo para encontrar o arquivo desejado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro problema é combinar pastas. Um dos threads do seu aplicativo provavelmente exigirá acesso aos arquivos de todas as pastas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das vantagens dessa abordagem é que ela pode isolar, no nosso caso, o React do Redux. Portanto, se você quiser alterar a biblioteca de gerenciamento de estado, saberá quais pastas serão necessárias. Se você precisar alterar a biblioteca de exibição, poderá deixar as pastas com o redux intacto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O recurso primeiro significa que os diretórios de nível superior serão nomeados de acordo com a principal funcionalidade do aplicativo: produto, carrinho, sessão. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa abordagem é muito melhor, pois cada novo recurso está em uma nova pasta. No entanto, você não tem uma separação entre os componentes Redux e React. Alterar um deles a longo prazo não é uma tarefa fácil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, você terá arquivos que não pertencerão a nenhuma função. </font><font style="vertical-align: inherit;">Como resultado, tudo se resume à pasta comum ou compartilhada, porque você também deseja usar seu código em diferentes recursos do seu aplicativo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combinando o melhor dos dois mundos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Embora este não seja o tópico do artigo, quero dizer que os arquivos de gerenciamento de estado dos arquivos da interface do usuário precisam ser armazenados separadamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pense no seu aplicativo a longo prazo. Imagine o que acontece com o seu código se você mudar de React para outra coisa. Ou pense em como sua base de código usará o ReactNative em paralelo com a versão da web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No centro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de nossa abordagem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está o princípio do isolamento React code em uma pasta chamada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">views</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e code redux em outra pasta chamada redux. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa separação no nível inicial nos dá a flexibilidade de organizar as partes individuais do aplicativo de maneiras completamente diferentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro da pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">views</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apoiamos a organização de arquivos com função primeiro. </font><font style="vertical-align: inherit;">No contexto do React, isso parece natural: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">páginas, layouts, componentes, aprimoradores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para não enlouquecer com o número de arquivos em uma pasta, você pode usar a abordagem do recurso primeiro nessas pastas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto isso, na pasta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apresentando re-patos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Cada função de aplicativo deve corresponder a ações e redutores separados, para que faça sentido aplicar a abordagem do primeiro recurso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A abordagem modular originais </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">patos</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> torna fácil trabalhar com redux e oferece uma maneira estruturada para adicionar novas funcionalidades para a sua aplicação. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, você queria entender o que acontece quando você dimensiona o aplicativo. </font><font style="vertical-align: inherit;">Percebemos que a maneira de organizar um arquivo por recurso atrapalha o aplicativo e torna seu suporte problemático. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">re-patos apareceu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A solução foi dividir a funcionalidade em pastas de patos.</font></font><br>
<br>
<pre><code class="javascript hljs">duck/<font></font>
├── actions.js<font></font>
├── index.js<font></font>
├── operations.js<font></font>
├── reducers.js<font></font>
├── selectors.js<font></font>
├── tests.js<font></font>
├── types.js<font></font>
├── utils.js</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 A pasta duck deve:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenha toda a lógica do processamento de apenas UM conceito do seu aplicativo, por exemplo: produto, carrinho, sessão, etc.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenha o arquivo index.js, que é exportado de acordo com as regras do duck.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armazene o código em um único arquivo que faça um trabalho semelhante, como redutores, seletores e ações.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenha testes relacionados ao pato.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, neste exemplo, não usamos abstrações criadas sobre o redux. </font><font style="vertical-align: inherit;">Ao criar software, é importante começar com o mínimo de abstração. </font><font style="vertical-align: inherit;">Assim, você verá que o valor de suas abstrações não excede os benefícios delas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você quiser garantir que a abstração seja ruim, assista a este vídeo de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cheng Lou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver o conteúdo de cada arquivo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipos</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 O arquivo de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contém os nomes das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ações</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que você executa no seu aplicativo. </font><font style="vertical-align: inherit;">Como boa prática, você deve tentar cobrir o espaço para nome correspondente à função à qual eles pertencem. </font><font style="vertical-align: inherit;">Essa abordagem ajudará na depuração de aplicativos complexos.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> QUACK = <span class="hljs-string">"app/duck/QUACK"</span>;
<span class="hljs-keyword">const</span> SWIM = <span class="hljs-string">"app/duck/SWIM"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    QUACK,<font></font>
    SWIM<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ações</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Este arquivo contém todas as funções do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da </font><i><font style="vertical-align: inherit;">ação</font></i><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> quack = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.QUACK<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">const</span> swim = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.SWIM,
    <span class="hljs-attr">payload</span>: {<font></font>
        distance<font></font>
    }<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    swim,<font></font>
    quack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Observe que todas as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ações são</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> representadas por funções, mesmo que não sejam parametrizadas. </font><font style="vertical-align: inherit;">Uma abordagem consistente é a maior prioridade para uma grande base de código.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operações</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Para representar a cadeia de operações ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as Operações</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), você precisará do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">middleware</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> redux </font><font style="vertical-align: inherit;">, para melhorar a função do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">envio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Exemplos populares são </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-saga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-observable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk é usado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Precisamos separar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criadores de ação,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mesmo com o custo de escrever código extra. Portanto, definiremos a operação como um invólucro sobre as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ações</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a operação envia apenas uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ação</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, na verdade não usa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , enviamos a função </font><i><font style="vertical-align: inherit;">criador</font></i><font style="vertical-align: inherit;"> da </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ação</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se a operação usar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , poderá enviar várias </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ações</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e vinculá-las usando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">promessas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
<span class="hljs-comment">// This is a link to an action defined in actions.js.</span>
<span class="hljs-keyword">const</span> simpleQuack = actions.quack;<font></font>
<font></font>
<span class="hljs-comment">// This is a thunk which dispatches multiple actions from actions.js</span>
<span class="hljs-keyword">const</span> complexQuack = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params"> dispatch </span>) =&gt;</span> {<font></font>
    dispatch( actions.quack( ) ).then( <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> {<font></font>
        dispatch( actions.swim( distance ) );<font></font>
        dispatch( <span class="hljs-comment">/* any action */</span> );<font></font>
    } );<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    simpleQuack,<font></font>
    complexQuack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Chame-os de operações, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">troncos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sagas, épicos, como quiser. </font><font style="vertical-align: inherit;">Basta identificar os princípios de nomeação e cumpri-los. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No final, falaremos sobre o índice e veremos que as operações fazem parte da interface pública do duck. </font><font style="vertical-align: inherit;">As ações são encapsuladas, as operações tornam-se acessíveis a partir do exterior.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redutores</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Se você tem uma função mais multifacetada, definitivamente deve usar vários </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redutores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para lidar com estruturas de estado complexas. Além disso, não tenha medo de usar quantos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers forem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> necessários. Isso permitirá trabalhar com estruturas de objetos de estado mais livremente.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">"redux"</span>;
<span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-comment">/* State Shape
{
    quacking: bool,
    distance: number
}
*/</span><font></font>
<font></font>
<span class="hljs-keyword">const</span> quackReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-literal">false</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.QUACK: <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> distanceReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-number">0</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.SWIM: <span class="hljs-keyword">return</span> state + action.payload.distance;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> reducer = combineReducers( {
    <span class="hljs-attr">quacking</span>: quackReducer,
    <span class="hljs-attr">distance</span>: distanceReducer<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Em um aplicativo grande, a árvore de estados consistirá em pelo menos três níveis. </font><font style="vertical-align: inherit;">As funções do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redutor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devem ser as menores possíveis e manipular apenas construções de dados simples. </font><font style="vertical-align: inherit;">A função </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é tudo o que você precisa para criar uma estrutura de estado flexível e sustentável. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Confira o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemplo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> completo do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">projeto</font></a><font style="vertical-align: inherit;"> e veja como usar o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers corretamente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , especialmente em arquivos </font></font><code>reducers.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>store.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde estamos </font><i><font style="vertical-align: inherit;">construindo a</font></i><font style="vertical-align: inherit;"> árvore de estados.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seletores</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Junto com o seletor de operações ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seletor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) fazem parte do duck da interface pública. </font><font style="vertical-align: inherit;">A diferença entre operações e seletores é semelhante ao padrão </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CQRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As funções do seletor pegam uma fatia do estado do aplicativo e retornam alguns dados com base nele. </font><font style="vertical-align: inherit;">Eles nunca fazem alterações no estado do aplicativo.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkIfDuckIsInRange</span>(<span class="hljs-params"> duck </span>) </span>{
    <span class="hljs-keyword">return</span> duck.distance &gt; <span class="hljs-number">1000</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    checkIfDuckIsInRange<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Índice</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Este arquivo indica o que será exportado da pasta duck. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É ele:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exporta a função </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redutora</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do duck por padrão.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exporta seletores e operações como exportações registradas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exporta tipos, se necessário, em outros patos.</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckSelectors } <span class="hljs-keyword">from</span> <span class="hljs-string">"./selectors"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckOperations } <span class="hljs-keyword">from</span> <span class="hljs-string">"./operations"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A vantagem de usar o Redux com a estrutura de patos é que você pode escrever testes logo após o código que deseja testar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testar seu código no Redux é bem simples:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">"expect.js"</span>;
<span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
describe( <span class="hljs-string">"duck reducer"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
    describe( <span class="hljs-string">"quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{
        <span class="hljs-keyword">const</span> quack = actions.quack( );
        <span class="hljs-keyword">const</span> initialState = <span class="hljs-literal">false</span>;<font></font>
<font></font>
        <span class="hljs-keyword">const</span> result = reducer( initialState, quack );<font></font>
<font></font>
        it( <span class="hljs-string">"should quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
            expect( result ).to.be( <span class="hljs-literal">true</span> ) ;<font></font>
        } );<font></font>
    } );<font></font>
} );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro deste arquivo, você pode escrever testes para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redutores</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , operações, seletores etc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu poderia escrever um artigo inteiro sobre os benefícios do teste de código, mas eles já são suficientes, então apenas teste seu código!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso é tudo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A boa notícia sobre re-ducks é que você pode usar o mesmo modelo para todo o seu código redux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em funcionalidades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abordagem de particionamento baseada </font><font style="vertical-align: inherit;">em seu código redux ajuda a sua estadia aplicação flexível e escalável à medida que cresce. </font><font style="vertical-align: inherit;">Uma abordagem de separação baseada em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funções</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funcionará bem ao criar pequenos componentes comuns a diferentes partes do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode dar uma olhada na base de código completa do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemplo react-redux- </font></font></i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lembre-se de que o repositório está funcionando ativamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você organiza seus aplicativos redux? </font><font style="vertical-align: inherit;">Aguardo ansiosamente comentários sobre a abordagem descrita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vejo você no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">curso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492612/index.html">Plafon decorativo Leek Celebrity</a></li>
<li><a href="../pt492616/index.html">Packer, Terraform e Ansible: implantação do cluster Kubernetes em uma hora</a></li>
<li><a href="../pt492628/index.html">Intervalo de confiança para o número de pacientes com coronavírus (cálculo da mortalidade)</a></li>
<li><a href="../pt492632/index.html">Pequenas empresas em quarentena: o pânico é o inimigo da razão</a></li>
<li><a href="../pt492636/index.html">O que significa ser eficaz?</a></li>
<li><a href="../pt492642/index.html">Crie uma arquitetura escalável e resiliente com microsserviços dinâmicos</a></li>
<li><a href="../pt492652/index.html">Jogo de cartas "Tolo" em dois M5Stack</a></li>
<li><a href="../pt492658/index.html">Eu fui a um controle remoto - lancei um podcast: o que ler para iniciantes - 5 livros comprovados</a></li>
<li><a href="../pt492660/index.html">O mundo inteiro contra o coronavírus. Histórias da Intel</a></li>
<li><a href="../pt492662/index.html">Como eu transmiti pela primeira vez uma palestra universitária</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>