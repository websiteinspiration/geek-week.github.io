<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏽 🈲 🐕 macOS組み込みツールを備えたWi-Fiポーク 👼 👨🏼‍🚒 🎪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR組み込みのmacOSツールを使用すると、Wi-Fiネットワークでいくつかの攻撃を実行できます。この記事では、Wi-Fiを使用して、AirMacとmacOS内蔵のMacbook Wi-Fiアダプターを使用してWi-Fiを使用する方法について説明します。
 
 通常、クラシックバンドルはWi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>macOS組み込みツールを備えたWi-Fiポーク</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482914/"><img src="https://habrastorage.org/webt/bn/q8/uf/bnq8uflrdz9cs2wb1muyedvm5hm.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL; DR組み込みのmacOSツールを使用すると、Wi-Fiネットワークでいくつかの攻撃を実行できます。</font><font style="vertical-align: inherit;">この記事では、Wi-Fiを使用して、AirMacとmacOS内蔵のMacbook Wi-Fiアダプターを使用してWi-Fiを使用する方法について説明します。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、クラシックバンドルはWi-Fiネットワークのセキュリティを監査するために使用されます。KaliLinuxを備えた仮想マシン+ Alfa AWU-blabla1337などの外部USBアダプター。</font><font style="vertical-align: inherit;">しかし、macOSと組み込みのBroadcomアダプターを使用しても汚れができることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事の内容：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 組み込みアダプターのモニターモード</font></font></li>
<li>  WPA </li>
<li>    PMKID</li>
<li>     : hcxtools, hashcat, bettercap</li>
<li>   -  </li>
</ul><br>
<a name="habracut"></a><br>
<h2>   WiFi Explorer</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WiFi Explorerは、Wi-Fiネットワークを分析するための非常に便利なプログラムです。</font><font style="vertical-align: inherit;">他のオペレーティングシステムのアナログよりもはるかに優れています。</font><font style="vertical-align: inherit;">それは常に進化しており、kismetのようなリモートアダプターを介して監視する機能を備えた有料バージョンがあります。</font><font style="vertical-align: inherit;">ただし、kismetとは異なり、使い勝手がよく、赤い目をしたswiborg向けではなく、人向けに作られています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WiFiエクスプローラーにはペンテストのオプションはありませんが、主要な偵察のみを目的としています。</font><font style="vertical-align: inherit;">また</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アクティブにスキャン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する方法</font><b><font style="vertical-align: inherit;">のみを</font></b><font style="vertical-align: inherit;">知っていること</font><font style="vertical-align: inherit;">、つまり、叫んだ（プローブ要求）先のネットワークと、応答（プローブ応答）を受信したネットワークをリストに表示</font><font style="vertical-align: inherit;">することも覚えておくことが重要</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">彼がパッシブスキャンをサポートしていれば、パケットが到達するネットワークをもっと見ることができますが、私たちには聞こえません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ne/ec/4y/neec4yuaw7gcvqerbbhuuuz97cy.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私にとって最も便利な機能：</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビジュアルスペクトラムアナライザー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -すべての範囲で占有されているチャネルを一度に確認すると便利です。</font><font style="vertical-align: inherit;">各ポイント（20/40 / 80MHz）で占有帯域を確認できます。</font><font style="vertical-align: inherit;">列の高さは信号強度を示します。</font><font style="vertical-align: inherit;">無線環境をひと目で評価して、ネットワークを構成する最善の方法と、フリーチャネルのどこに立つかを決定できます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各アクセスポイントの詳細情報</font></font></b><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BSSID-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセスポイントのMACアドレス。</font><font style="vertical-align: inherit;">同じESSIDを持つアクセスポイントがいくつかある場合は、すべてのアクセスポイントを確認すると便利です。</font><font style="vertical-align: inherit;">最初の3バイトは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースから製造元を計算するために使用されます</font><font style="vertical-align: inherit;">。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESSID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はWi-Fiネットワークの名前です。</font><font style="vertical-align: inherit;">同じBSSIDを持つアクセスポイントがいくつかの異なる名前をブロードキャストしたときに確認することも便利です。</font><font style="vertical-align: inherit;">リストをネットワーク名でソートし、同じ名前のネットワークにサービスを提供する物理アクセスポイントの数を確認できます。</font></font></li>
<li><b>WPS</b> —  WiFi Protected Setup,  ,       .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">wash</a>,       WPS.</li>
<li><b>Device Name</b> —    beacon-,     .       ,   , : -, -,    .      . </li>
<li><b>,  ,  </b> —         ,   ,     ,    Mikrotik.</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モニターモードは、Wi-Fiアダプターの特別な動作モードであり、意図されたものだけでなく、空中からすべてのパケットをキャプチャします。このモードは、他のデバイス間のやり取りをキャプチャするために必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MacOSには、監視モードを有効にする通常のツールがあります。これは、Wi-Fiトラブルシューティングユーティリティまたは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空港</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンソールユーティリティを使用して行うことができます</font><font style="vertical-align: inherit;">。むかしむかし</font><font style="vertical-align: inherit;">、監視モードをアクティブにし、傍受されたトラフィックをファイルに記録</font><font style="vertical-align: inherit;">する簡単な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空港スニファー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプト</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成</font><font style="vertical-align: inherit;">し、同時に、指定された正規表現でファイルを分割しました。したがって、暗号化されていないCookieをトラフィックから取り出すのが便利でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、空港ユーティリティはシステムフォルダーの奥に隠されていますが、便宜上、シンボリックリンクを作成して、同じ名前のコマンドで簡単にアクセスできるようにすることができます。</font></font><br>
<br>
<pre><code class="plaintext hljs">ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/local/bin/airport
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで</font><font style="vertical-align: inherit;">、完全なパスを指定せずに</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airport</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">呼び出すことができ</font><font style="vertical-align: inherit;">ます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーティリティは多くのことを実行できますが、以下のコマンドに関心があります。</font></font><br>
<br>
<pre><code class="bash hljs">airport scan <span class="hljs-comment">#       </span>
airport -z     <span class="hljs-comment">#    Wi-Fi-</span>
airport sniff &lt; &gt;   <span class="hljs-comment">#         /tmp/airportSniff&lt;random&gt;.cap </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Airport-sniffer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプト</font><font style="vertical-align: inherit;">は、airport sniffコマンドの呼び出しを使用して、/ tmp /内のダンプファイルを探します。</font><font style="vertical-align: inherit;">モニターモードがアクティブになると、Wi-Fiアイコンが目で変わります。</font></font><br>
<br>
<div style="text-align:center;"><img width="450" src="https://habrastorage.org/webt/rr/gh/o1/rrgho1wk5ktzbiku8azpx87yndq.png"></div><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：macOS 10.14 Mojaveでは、空港ユーティリティのスニフ機能が壊れ、プログラムがセグメンテーションフォールトでクラッシュします。</font><font style="vertical-align: inherit;">macOS Catalinaの現在のバージョンと古いバージョンでは、この問題は修正されています。</font><font style="vertical-align: inherit;">同時に、Airtool.appユーティリティはどこでも問題なく動作します。</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Airtool-モニターモードを制御する便利な方法</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><img align="left" src="https://habrastorage.org/webt/bf/ep/z6/bfepz6by5pkefcb1nm_sedpcopc.jpeg"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでにわかったように、サードパーティのプログラムをまったくインストールしなくても、macOSで監視モードを使用してトラフィックをキャプチャできます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Airtool</font></a><font style="vertical-align: inherit;">ユーティリティ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクをはるかに便利にします。</font><font style="vertical-align: inherit;">グラフィカルインターフェイスがあり、キャプチャしたトラフィックを直接Wiresharkにリダイレクトしたり、傍受したradiotapヘッダーの形式を制御したりできます。</font><font style="vertical-align: inherit;">Wi-Fiパケットのサービスヘッダーのみを分析する必要がある場合は、データを含むペイロードを含むパケットの一部を破棄して、スペースを節約できます。</font><font style="vertical-align: inherit;">デフォルトでは、Wi-Fiアダプターがすべてのチャネルをジャンプするときに、チャネルホッピングモードでパケットキャプチャが発生します。</font><font style="vertical-align: inherit;">標的型攻撃の場合、攻撃対象のネットワークが機能する1つのチャネルのみのトラフィックをキャプチャする必要があります。</font><font style="vertical-align: inherit;">現在のチャネルの数とアダプターが実行されている幅がプログラムアイコンに表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/yf/c_/db/yfc_dboa7ine5t7cfgblr1o0fds.png"></div><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Airtoolプログラムインターフェイス</font></font></font></sup><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wi-Fiネットワークは異なる周波数（チャネル）で動作し、ネットワークアダプターは一度に1つのチャネルでのみ機能します。</font><font style="vertical-align: inherit;">したがって、チャネルホッピングモードでは、彼が現在いるチャネルのデータのみが「聞こえ」、この時点で他のチャネルのデータが渡されます。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトでは、Airtoolは傍受したトラフィックをデスクトップ上のファイルに書き込みます。</font><font style="vertical-align: inherit;">ただし、ダンプを処理するには、記録時にトラフィックが空であるため、最初にトラフィックのキャプチャを停止する必要があります。</font><font style="vertical-align: inherit;">キャプチャされたパケットをWiresharkでリアルタイムに表示する方がはるかに便利です。</font><font style="vertical-align: inherit;">したがって、Wiresharkをインストールし、Airtool設定で[ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャプチャ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">起動：Wireshark]</font></b><font style="vertical-align: inherit;">を選択することをお勧めします</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次に、Airtoolでキャプチャを開始すると、Wiresharkがすぐに開始されます。</font></font><br>
<br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/jc/vd/jm/jcvdjmnchqwmolj8ioykz3gj9s0.png"></div><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AirtoolはキャプチャされたトラフィックをリアルタイムでWiresharkにリダイレクト</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
できます</font><sup><font color="999999"><font style="vertical-align: inherit;">。</font></font></sup><font style="vertical-align: inherit;"> [キャプチャ]をクリックすると、キャプチャされたトラフィックがリアルタイムでWiresharkに表示されるパイプが作成されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPAトラフィックのリアルタイム復号化</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
監視モードでトラフィックをキャプチャする方法を学びました。次に、最も簡単な攻撃の実行を試みます。アクセスポイントでクライアント認証の瞬間を捕捉し（WPAハンドシェイク）、WPAトラフィックを復号化します。この攻撃は、Wi-Fiネットワークのパスワードがすでにわかっており、同じネットワークに接続されているネイバーのトラフィックを盗聴することを想定しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rf/9s/wf/rf9swf0wvqd_nq9bgiq8tv2y6lw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同僚のラップトップからのワイヤレストラフィックを傍受して、アクセスしているサイトを確認したいとします。オフィスネットワークにはWPA暗号化が施され、パスワードで保護されています（PSK）。私たちは同じWi-Fiネットワークを使用しており、両者はそのネットワークからパスワードを知っています。</font></font><br>
<br>
<blockquote>   ,               .         ,       2.4GHz  5GHz.      ,     ,    .</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の例では、被害者はOLOLOL_OAOOAOAOAAOOAネットワークに接続します。このネットワークは、チャネル1の同じ2.4GHz帯域で動作する1つのアクセスポイントで構成されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zy/fx/vx/zyfxvxcimigionblgt3fpgf245y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このチャネルでAirtoolを構成し、トラフィックキャプチャを有効にします。他のネットワークは最初のチャネルで動作するため、Wiresharkでは他のネットワークからの大量の無関係なトラフィックが表示され、アダプターは隣接チャネルからのパケットをキャプチャすることもできます。不要なトラフィックを除外するために、Wiresharkにはディスプレイフィルターがあります。ここでは、アクセスポイントのMACアドレス（BSSID）を示して、このネットワークに関連するパケットのみを表示します。</font></font><br>
<br>
<pre><code class="plaintext hljs">wlan.addr == e4:8d:8c:d9:07:8c</code></pre><br>
<img src="https://habrastorage.org/webt/2c/4a/uh/2c4auhumzzomwgvt8perj3czklm.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiresharkは、特定のチャネルで傍受されたすべてのパケットを表示します。フィルターを使用して、ジャンクトラフィックを削除できます。</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これで、ヘッダーにこのアドレスを持つパケットのみが表示されます。アクセスポイントからクライアントへ、およびクライアントからアクセスポイントへのすべてのパッケージがあります。被害者のWPAトラフィックを復号化できるようにするには、トラフィックが暗号化される一時キーを傍受するために、アクセスポイントで認証の瞬間をキャッチする必要があります。これらのキーは、EAPOL WPAハンドシェイクまたは単にWPAハンドシェイクと呼ばれる4つのパッケージに含まれています。クライアントがすでにポイントに接続されている場合、各クライアントはアクセスポイントの一時キーとネゴシエートしてトラフィックの暗号化に使用されるため、ネットワークからのパスワードを知っているだけではトラフィックを復号化できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、同僚がラップトップを開いてネットワークに接続する前に、空気を聞く必要があります。被害者のラップトップのWi-FiカードのMACアドレスがわかっているとします。被害者からのトラフィックがいつ傍受されるかを正確に確認できるように、Wiresharkでフィルタを設定できます。これを行うには、次のフィルターをインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">wlan.addr == e4:8d:8c:d9:07:8c &amp;&amp; wlan.addr == 00:cd:fe:10:55:8a</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e4：8d：8c：d9：07：8c-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセスポイントのアドレス</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00：cd：fe：10：55 </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">：8a-</font></b><font style="vertical-align: inherit;">クライアントアドレス</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このフィルターは、一方と他方の両方、つまりどちらかを同時に含むパケットのみを表示します被害者からアクセスポイントへ、またはその逆。被害者がアクセスポイントに接続したときに、鍵交換、WPAハンドシェイクを含むEAPOLパケットが表示されます。</font></font><br>
<img src="https://habrastorage.org/webt/_r/zz/jx/_rzzjxb0kbli4zgx3n9waumlvcw.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセスポイントでの被害者の承認時に傍受されたWPAハンドシェイク。</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wiresharkは十分にスマートで、EAPOLハンドシェイクからの一時キーを使用してトラフィックを自動的に復号化できます。これを行うには、メニューの[ </font><b><font style="vertical-align: inherit;">設定]-&gt; [プロトコル]-&gt; [IEEE 802.11]-&gt; [復号化キー]</font></b><font style="vertical-align: inherit;">でWi-Fiネットワークのパスワードを指定する必要があり</font></font><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
wpa-pwd（つまり、wpaパスワード）のような新しいキーを追加し、password：network_nameの形式でパスワードとネットワーク名を指定する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の場合、WhySoOpenネットワークのパスワード、およびネットワーク名はOLOLOL_OAOOAOAOAOOAです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0u/bb/8f/0ubb8fnzfcvhvo9-4gdtaqlwbc4.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiresharkは、ネットワークのパスワードを知っている場合、トラフィックを自動的に復号化します。</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
異なるネットワークから複数のパスワードを同時に指定でき、Wiresharkはすべてのネットワークからのトラフィックを1つのダンプで同時に理解および復号化します。 WPAハンドシェイクがあるトラフィックのみを復号化できることを覚えておくことは重要です。したがって、アクセスポイントにクライアントが10台あり、ハンドシェイクが1つだけからキャッチされた場合、そのトラフィックのみが復号化されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トラフィックを復号化できない場合は、wpa-pwdを正しく指定したことを確認してください。また、ダンプ内に被害者からの完全なハンドシェイクがあることを確認してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが正しければ、復号化されたトラフィックが表示されます。</font><font style="vertical-align: inherit;">私の例では、被害者は</font></font><code>http://asdasd.ru</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化されていないHTTPを使用</font><font style="vertical-align: inherit;">してサイトにアクセス</font><font style="vertical-align: inherit;">しましたが、これはダンプで正常に確認されています。</font><font style="vertical-align: inherit;">復号化されたトラフィックをさらにどうするか、あなたはあなた自身のためにすでに知っているはずです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bu/e_/12/bue_12pw5xw6lm3fw8vd9zpnotu.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiresharkでの復号化されたHTTPトラフィック</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この攻撃は完全に当​​たり前のことであり、誰もが知っています。macOSに固有の一連のツールを示したかっただけです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bettercap-WPAハンドシェイクとPMKIDの便利なインターセプト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のステップでは、WPAハンドシェイクを完全に受動的に傍受し、待ち伏せに座って、被害者が自分でネットワークに接続するのを待つことを学びました。パスワードがわからない場合、同じハンドシェイクを使用してWi-Fiネットワークからパスワードを検索できます。しかし、待ちたくない場合、または被害者がすでにネットワークに接続していて、接続の瞬間を捉えられなかった場合の対処方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、被害者を強制的にWi-Fiネットワークから切断（認証解除攻撃）できるため、中断後にネットワークに再接続し、必要なWPAハンドシェイクを送信するように強制できます。 macOSビルトインはパッケージを純粋な形で挿入することはできませんが、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認証解除攻撃は機能し</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の意見では、これのための最も便利なツールは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">bettercap</font></a><font style="vertical-align: inherit;">フレームワークです</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、ネットワーク攻撃を自動化するためのインタラクティブなフレームワークです。</font><font style="vertical-align: inherit;">macOSで完全にネイティブに動作し、多くのことができます。</font><font style="vertical-align: inherit;">Wi-Fiの使用のみを検討します。</font><font style="vertical-align: inherit;">より詳細な使用例は、記事の最後のビデオにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
brewを使用してbettercapをインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">brew install bettercap
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bettercapを開始する前に、Wi-Fiから切断する必要があります。</font><font style="vertical-align: inherit;">これは、Altを押しながらWi-Fiメニューをクリックし、AirtoolまたはAirport -zのいずれかで「切断」を選択することで実行できます。</font><font style="vertical-align: inherit;">Bettercapは、Wi-Fiアダプターの名前を指定して、ルートから起動する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo bettercap -iface en0
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モニターモードを起動します。</font><font style="vertical-align: inherit;">デフォルトでは、チャネルホッピングモードでアクティブ化されます。つまり、既存のすべてのチャネルでジャンプします。</font><font style="vertical-align: inherit;">アクティベーションの直後に、傍受されたデータのログがコンソールに実行されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; wifi.recon on
</code></pre><br>
<img src="https://habrastorage.org/webt/ez/do/yq/ezdoyqdsjqckeck2qnjcoenbmo4.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bettercapは、監視モードでインターセプトされたイベントのログを表示します</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
wifi.showコマンドは、アクセスポイントに接続されているクライアントの現在の数を含む可視ネットワークのリストを表示します。</font><font style="vertical-align: inherit;">現在作業中のチャネルが左下隅に表示されます。</font><font style="vertical-align: inherit;">このコマンドを数回続けて入力すると、チャネルの変化を確認できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; wifi.show
</code></pre><br>
<img src="https://habrastorage.org/webt/ga/sn/sz/gasnsziceqsk5gyeprlkqgzf-1i.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wifi.showコマンドを実行すると、使用可能なネットワークのリストが</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
表示され、アクセスポイントに接続されたクライアントがすでに1つあることがわかります。</font><font style="vertical-align: inherit;">ネットワークから強制的に切断して、再接続を開始し、必要なWPAハンドシェイクを転送してみましょう。</font></font><code>wifi.deauth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセスポイントのBSSIDを指定する</font><font style="vertical-align: inherit;">コマンドを入力し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この場合、bettercapは、ネットワークに接続されているすべてのクライアントに認証解除を送信します。</font><font style="vertical-align: inherit;">1つのクライアントのみを切断する場合は、アクセスポイントのアドレスではなく、そのMACアドレスを指定する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">&gt; wifi.deauth e4:8d:8c:d9:07:8c
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
切断から数秒後、クライアントは再びネットワークへの接続を試み、ハンドシェイクを正常にキャッチしました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lw/xb/qe/lwxbqe0itusgukwnejkvvp6sn6q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、wifi.showコマンドを入力すると、ハンドシェイクの受信元のネットワークが赤で強調表示されます。</font><font style="vertical-align: inherit;">Bettercapは、傍受したすべてのハンドシェイクをホームフォルダ内のファイルに保存します</font></font><code>~/bettercap-wifi-handshakes.pcap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMKIDの取得</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PMKIDは、一部のアクセスポイントが接続するときに最初のパケットで送信するハッシュです。最近</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このハッシュを使用してネットワークパスワードをブルート</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">する</font></a><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">が</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">発見</font></a><font style="vertical-align: inherit;">さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">れまし</font></a><font style="vertical-align: inherit;">た。この攻撃の詳細について</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、bettercapの作成者のブログを参照してください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
美しさは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アクセスポイントにクライアントがなくても</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PMKID </font><b><font style="vertical-align: inherit;">を</font></b><font style="vertical-align: inherit;">取得できること</font><b><font style="vertical-align: inherit;">です。</font></b></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
通常のEAPOL WPAハンドシェイクでは、パスワードを知っているポイントに正当なクライアントが必要です。このようなハンドシェイクを正常に受信するには、クライアントとポイント間の4つのパケットを傍受する必要があります。 PMKIDの場合、認証要求をポイントに送信するだけで十分であり、PMKIDにすぐに応答します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクセスポイントに接続し、間違ったパスワードを入力するだけで、PMKIDを取得できます。</font><font style="vertical-align: inherit;">たとえば、コンピューターでモニターモードを開始し、ランダムなパスワードを入力して電話から接続してみます。</font><font style="vertical-align: inherit;">Bettercapはwifi.assocコマンドで同じことを行います</font></font><br>
<br>
<pre><code class="bash hljs">&gt; wifi.assoc all <span class="hljs-comment">#       </span>
&gt; wifi.assoc e4:8d:8c:d9:07:8c <span class="hljs-comment">#      </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクセスポイントがPMKIDをサポートしている場合は、応答で送信されます。</font><font style="vertical-align: inherit;">傍受されたPMKIDの例は、前のスクリーンショットで確認できます。これは、EAPOLハンドシェイクの前を飛行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WiresharkのテストネットワークOLOLOL_OAOOAOAOAAOOAからのPMKIDは次のようになります。</font></font><br>
<img src="https://habrastorage.org/webt/x8/cc/wt/x8ccwtxltygnll2uw9n3hp7yhce.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブリュットキャッチハッシュ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、ハンドシェイクとPMKIDをキャッチしましたが、それらからパスワードを抽出する方法は？</font><font style="vertical-align: inherit;">2つのオプションがあります。自分でブルートするか、オンラインファームにアップロードします。</font><font style="vertical-align: inherit;">私はラップトップが弱いので、ブルートフォースパスワードを使用するのが面倒なので、オンラインクラッカーにアップロードするだけです。</font></font><br>
<br>
<h3><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onlinehashcrack.com</font></font></a></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のお気に入りのサービスは、EAPOLやPMKIDなど、さまざまな種類のハッシュを無料でブルートすることができます。</font><font style="vertical-align: inherit;">単に彼に.pcapダンプを与えるだけです。これは、bettercapを使用して収集したもので、必要なハッシュを見つけます。</font><font style="vertical-align: inherit;">重複は手動で削除できます。</font></font><br>
<img src="https://habrastorage.org/webt/nz/kf/bd/nzkfbd_aowd__6btlivjg7-eb1o.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onlinehashcrack.comサービスは、無料でEAPOLおよびPMKID辞書のパスワードを検索します。</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
登録は不要です。指定されたメールにファイルをダウンロードすると、実行中の検索タスクへのリンクが表示されます。</font><font style="vertical-align: inherit;">パスワードが見つかると、メールで通知されます。</font><font style="vertical-align: inherit;">そうでない場合、サービスは、すでにお金で検索するための追加の辞書を選択することを提案します。</font><font style="vertical-align: inherit;">無料の辞書は2,000万語で構成されており、よく検索されます。</font><font style="vertical-align: inherit;">私の個人的な統計によると、パスワードの約3分の1は正常に検出されています。</font></font><br>
<br>
<h3><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gpuhash.me</font></font></a></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あまり便利ではないサービスで、見つかったパスワードを表示するには、0.001BTCを支払うように求めます。</font><font style="vertical-align: inherit;">私は通常、すべてのサービスに一度にアップロードして、パスワードがどれほど弱いかを理解しています。</font><font style="vertical-align: inherit;">gpuhash.meがonlinehashcrack.comが見つけられなかったものを見つけることは非常にまれです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xo/5f/fz/xo5ffzg8qd3i6dau3ydk-gpjd1e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EAPOLおよびPMKIDをサポートしますが、.pcapダンプでPMKID自体を見つけることができず、テキストの文字列として特別に準備されたPMKID形式が必要です。</font><font style="vertical-align: inherit;">詳細については、ハンドヘルドトランスコーディングのトピックについては、記事の最後にあるビデオで説明しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">施設のブルータス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Macでは、brewリポジトリでも利用可能なaircrack-ngを使用して辞書のプロセッサをブルートする古い祖父の方法が機能します。</font><font style="vertical-align: inherit;">このトピックは何百回も説明されているので、詳細には触れません。</font></font><br>
<br>
<pre><code class="bash hljs">brew install aircrack-ng <span class="hljs-comment">#  </span>
aircrack-ng -w .txt ~/bettercap-wifi-handshakes.pcap <span class="hljs-comment"># ,    </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fresh aircrack-ngはPMKIDブルートをサポートします。</font><font style="vertical-align: inherit;">pcapファイルの内容をすばやく表示するには、を使用すると便利です。</font><font style="vertical-align: inherit;">Wiresharkを使用する場合、aircrack-ngはpcap形式のみを読み取ることができ、pcapngは読み取れないことに注意してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ai/y2/f-/aiy2f-fggzvuaavrxfnnlcj5_yi.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aircrack-ngは、bettercapを使用してコンパイルされたファイルにフラッドプレーンハンドシェイクとPMKIDのリストを表示します</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。これが、辞書にある場合、正常に検出されたパスワードの外観です。</font><font style="vertical-align: inherit;">私自身、これを行うことは決してありません。なぜなら、私は怠惰すぎて、ノートパソコンが鳴るのを待って、聞くことができないからです。</font></font><br>
<br>
<div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/yt/xl/e2/ytxle256vvszblj1bswjrwlg8cm.png"></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュキャットとブルート</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hashcatは、ビデオカードのブルートハッシュを分散するための最も高度なプログラムです。</font><font style="vertical-align: inherit;">macOSでネイティブに動作し、OpenCLフレームワークをサポートしているので、プロセッサビデオでもブルートに使用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォーマット22000</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hashcatは、pcap / pcapngダンプから準備する必要がある独自のハッシュ形式のみを理解します。</font><font style="vertical-align: inherit;">Hashcat形式は頻繁に変更され、aircrack-ngはpcapをhashcatの古い形式に変換できますが、最新のWi-Fiハッシュ形式-22000を見ていきます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いHCCAP / HCCAPX形式はバイナリであり、ファイルを交換してハッシュを転送する必要がありました。</font><font style="vertical-align: inherit;">新しい22000形式は完全にテキスト形式であり、テキストとして簡単に送信できるため、はるかに便利です。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下で説明するすべてのものは、実験者のみを対象としています。</font><font style="vertical-align: inherit;">私はすべての人に私のリポジトリからhcxtoolsをインストールするように勧めません、そして一般的にhcxtools v6のリリース前にそれを使用します。</font><font style="vertical-align: inherit;">その後、プログラムは公式のbrewリポジトリに追加されます。</font><font style="vertical-align: inherit;">それまでにプログラムの構文とデータ形式が変更されている可能性があります</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
hcxtools-hashcatのハッシュを準備するためのツールのセット。</font><font style="vertical-align: inherit;">最近、macOSでのビルドに成功しています。</font><font style="vertical-align: inherit;">公式のbrewリポジトリではまだ利用できませんが、まもなく登場する予定です。</font><font style="vertical-align: inherit;">今のところ、私のリポジトリからインストールできます（用語では、brewはタップと呼ばれます）。</font></font><br>
<br>
<pre><code class="bash hljs">brew tap zhovner/zhovner <span class="hljs-comment">#   </span>
brew install --HEAD hcxtools <span class="hljs-comment">#    hcxtools</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
組み立て後、brewはインストールされたファイルが利用可能なパスを教えてくれます。</font><font style="vertical-align: inherit;">それらはPATHに追加されないため、絶対パスを指定する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sp/zq/dk/spzqdkq4nl1qhnhyzzi11aqvubm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
hcxpcapngtoolユーティリティは、pcap / pcapngダンプからすべてのEAPOLおよびPMKIDハッシュを取り出し、それらを単一のテキストファイルに入れます。</font></font><br>
<br>
<pre><code class="plaintext hljs">hcxpcapngtool -o /tmp/hashes.22000 ~/bettercap-wifi-handshakes.pcap
</code></pre><br>
<img src="https://habrastorage.org/webt/nd/l1/lv/ndl1lvvcntvhmjrzt0yh7ykl-tg.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hcxpcapngtoolでファイルの処理レポート</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
22000フォーマットは非常に単純ですが、マーカーによって、あなたは最初のハッシュが何であるかを理解することができます：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WPA * 01</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - PMKID</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WPA * 02</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - EAPOL</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、前工程で得られたhashes.22000ファイルの一例です。ファイルに6つのPMKIDと1つのEAPOLハッシュがあることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/7y/0x/yr7y0xvm0dg0dwneoouf95aom9s.png"><br>
<sup><font color="999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 22000形式のhcxpcapngtoolを使用してpcapファイルから取得したハッシュ</font></font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
しかし</font><sup><font color="999999"><font style="vertical-align: inherit;">、自分の</font></font></sup><font style="vertical-align: inherit;">目でそのような行</font><sup><font color="999999"><font style="vertical-align: inherit;">を</font></font></sup><font style="vertical-align: inherit;">読み取るのは不便です。ハッシュがどこにあり、どのネットワークに属しているかは明確ではありません。したがって、便宜上、hcxhashtoolユーティリティを使用して、結果のhashhes.22000ファイルを人間が読める形式に変換します。</font></font><br>
<br>
<pre><code class="plaintext hljs">hcxhashtool -i /tmp/hashes.22000 --info=stdout
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプログラムはすべてのハッシュを取り、16進数の文字列をテキストに変換し、製造元のデータベースに従ってデバイスのMACアドレスを比較します。その結果、ネットワークの名前、データの送信元であるデバイスのMACアドレス、さらにはデバイスの製造元を示す、美しく明確な出力が得られます。下のスクリーンショットでは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OLOLOL_OAOOAOAOAOOA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークからの処理済みEAPOL </font><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">Whitestudio</font></b><font style="vertical-align: inherit;">ネットワーク</font><font style="vertical-align: inherit;">からのPMKIDの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font></font><br>
<img src="https://habrastorage.org/webt/2h/em/s8/2hems8rfixfvtauvpgnfclopzx0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、読みやすい出力が得られたので、ブルートするハッシュを選択できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストでは、WhitestudioネットワークからPMKIDを取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
brewリポジトリにある古いバージョンのhashcatは新しい22000ハッシュ形式をサポートしていないため、ソースから現在のバージョンをインストールします。</font></font><br>
<br>
<pre><code class="bash hljs">brew install --HEAD hashcat <span class="hljs-comment">#  hashcat     git</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
希望のハッシュを別のファイルに入れ、それにハッシュキャットを設定します。</font><font style="vertical-align: inherit;">総当たりの場合、辞書は使用せず、8桁のマスクを示すだけです。</font></font><br>
<br>
<pre><code class="bash hljs">cat /tmp/Whitestudio.22000<font></font>
WPA*01*e84a2caa3ba9b543a99012f88a5a738d*e68d8c72b9c4*9801a78e67f9*576869746573747564696f***<font></font>
<font></font>
hashcat -m 22000 -a3 /tmp/Whitestudio.22000 ?d?d?d?d?d?d?d?d<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセッサに統合されたビデオカードの8桁すべて（1億）の推定総当たり時間は4時間です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
強力なファームでは、この時間を数秒に減らすことができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/gj/jq/gqgjjqnet7ahk3gjsgskvuaiaza.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、首尾よくねじれたパスワードが、PMKIDハッシュからのhashcatを使用してどのように見えるかです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j-/my/sq/j-mysqzxfwi5lhi20-8kxjtim0k.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashcatとhcxtoolsの説明はこの記事の範囲を超えています。ここでは、新しい22000ハッシュ形式での作業の基本的な例を示すためにのみ言及しました。将来、コマンド構文と形式22000が公式として承認されるとき、より便利なものをhcxtoolsに追加する予定です。 1つのコマンドでpcapダンプから必要な形式のハッシュを受け取るハッシュのパーサー。</font><font style="vertical-align: inherit;">onlinehashcrack.comの所有者は、サイトに入力するテキストフォームに22000形式のサポートを追加することを約束しました。その結果、大量のゴミを含むpcapファイルをアップロードする代わりに、コンソールから目的のハッシュをコピーしてプレーンテキストに貼り付けるだけで済みます。</font></font></blockquote><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビデオ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事で説明したすべてをスクリーンキャスト形式で記録しました。ここでは、同じ攻撃がリアルタイムかつ詳細に表示されています。</font><font style="vertical-align: inherit;">テキストから何かがはっきりしない場合は、ビデオを見てください。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/62-PO5KNVAg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<img width="50" src="https://habrastorage.org/webt/ue/ii/md/ueiimdzuyrmmsl8smmtdvprox94.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テレグラムチャネル</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@zhovner_hubで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトノートを公開してい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img width="50" src="https://habrastorage.org/webt/ij/7w/ce/ij7wcetekbqt18zqkawxaywtl_y.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私のやっていることが気に入ったら、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Patreon</font></a><font style="vertical-align: inherit;">から$ 1を送ってください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482902/index.html">いいえ、人工知能は私たちを倒すことはできません</a></li>
<li><a href="../ja482904/index.html">宇宙マイクロプロセッサの簡単な歴史、パート1</a></li>
<li><a href="../ja482906/index.html">ネットワークセキュリティについて</a></li>
<li><a href="../ja482908/index.html">デビッドクシュナーの本「マスターズオブドゥーム」の翻訳の第2部。6〜12章</a></li>
<li><a href="../ja482912/index.html">Идея децентрализованной социальной сети следующего поколения</a></li>
<li><a href="../ja482916/index.html">NESでの音楽の仕組み</a></li>
<li><a href="../ja482918/index.html">トランザクションでArduinoのEEPROMにデータを保存する</a></li>
<li><a href="../ja482920/index.html">自動操縦装置がどのように私たちの生活に入ったか、私たちは気づかなかった</a></li>
<li><a href="../ja482922/index.html">Drupal Digest-2019/12月</a></li>
<li><a href="../ja482926/index.html">アークは、単一リポジトリのバージョン管理システムです。Yandexレポート</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>