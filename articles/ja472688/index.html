<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♿️ 🔼 🧑🏻‍🤝‍🧑🏻 3Dゲームレンダリングのしくみ：頂点処理 👨‍👩‍👧‍👦 🧖🏼 👨‍👦‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="この投稿では、頂点を使用した作業の段階について検討します。つまり、再び数学の教科書を入手し、線形代数、行列、三角法を覚えておく必要があります。やったー！
 
 3Dモデルがどのように変換され、光源が考慮されるかを確認します。また、頂点シェーダーとジオメトリシェーダーの違いについても詳しく説明し、テッ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>3Dゲームレンダリングのしくみ：頂点処理</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472688/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/070/e30/bd5/070e30bd57f6af2d7c1e36abe15f949b.jpg" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この投稿では、頂点を使用した作業の段階について検討します。</font><font style="vertical-align: inherit;">つまり、再び数学の教科書を入手し、線形代数、行列、三角法を覚えておく必要があります。</font><font style="vertical-align: inherit;">やったー！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3Dモデルがどのように変換され、光源が考慮されるかを確認します。</font><font style="vertical-align: inherit;">また、頂点シェーダーとジオメトリシェーダーの違いについても詳しく説明し、テッセレーションの場所がどの段階にあるかを確認します。</font><font style="vertical-align: inherit;">理解を容易にするために、ゲームが計算を実行して値を処理する方法を示す図とコード例を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
投稿の最初のスクリーンショットは、ワイヤーフレーム表示モードのゲームGTA Vを示しています。</font><font style="vertical-align: inherit;">それほど複雑でないhalf-Life 2ワイヤーフレームディスプレイと比較してください。画像は、ReShadeを使用して</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thalixte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって作成され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c4/562/7ee/4c45627ee9916f0bcdce6858b510b6a6.jpg"></div><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポイントは？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数学の世界では、ドットは単に幾何学的空間内の場所です。</font><font style="vertical-align: inherit;">ポイントよりも小さいものはなく、サイズもないため、ポイントを使用して、線分、平面、ボリュームなどのオブジェクトの始点と終点の位置を正確に指定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3Dグラフィックスの場合、そのような情報は非常に重要です。すべてのオブジェクトは線分や平面などのセットとして表示されるため、すべての外観はそれに依存します。</font><font style="vertical-align: inherit;">下の画像は、Bethesda 2015 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fallout 4の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリーンショット</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/87b/33c/f82/87b33cf825a8ed9d87b7c8a7cc873e69.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが単なる点と線の巨大な束であることが簡単にわかるとは限らないため、ワイヤーフレームモードで同じシーンがどのように見えるかを示します。</font><font style="vertical-align: inherit;">このモードでは、3Dレンダリングエンジンはピクセルステージで実行されたテクスチャと効果をスキップし、ドットを結ぶマルチカラーの線のみを描画します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/430/8a0/f67/4308a0f6729ff459c600275d8755f12c.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これですべてが完全に異なって見えますが、さまざまなオブジェクト、環境、背景を形成するためにすべての線がどのように組み合わされるかがわかります。</font><font style="vertical-align: inherit;">たとえば、前景の石など、数十本の線のみで構成されるものもあれば、実線に見えるほど多くの線が含まれているものもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各行の最初と最後の各ポイントは、一連の計算全体を実行することによって処理されます。</font><font style="vertical-align: inherit;">非常に単純で高速な計算もあれば、はるかに複雑な計算もあります。</font><font style="vertical-align: inherit;">ポイントをグループ、特に三角形の形で処理することにより、生産性を大幅に向上させることができるので、ポイントを詳しく見ていきましょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形には何が必要ですか？</font></font></h2><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
という名前</font><font style="vertical-align: inherit;">は、図に3つの内部コーナーがあることを明確にします。</font><font style="vertical-align: inherit;">これを行うには、3つのコーナーポイントとそれらを接続する3つのセグメントが必要です。</font><font style="vertical-align: inherit;">コーナーポイントを</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点（頂点）</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（複数形-頂点）</font><font style="vertical-align: inherit;">と呼ぶのが正しい</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">各頂点は点で定義されます。</font><font style="vertical-align: inherit;">3次元の幾何学的世界にいるため、点に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はデカルト座標系が</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">通常、座標は3つの値、たとえば（1、8、-3）または一般的に（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x、y、z</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">の形式で書き込まれます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/64c/b9e/77f/64cb9e77ffcc16159b4d201026a4ba04.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、さらに2つの頂点を追加して三角形を形成します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/732/482/c6b/732482c6b6faef01c7a7281f9b30da31.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
示されている線はオプションであることに注意してください。ポイントを設定して、これらの3つの頂点が三角形を形成することをシステムに伝えることができます。すべての頂点データは、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点バッファー</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる連続したメモリブロックに格納され</font><font style="vertical-align: inherit;">ます。それらが形成する図形に関する情報は、レンダリングプログラムで直接エンコードされるか、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスバッファー</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれるさらに別のメモリブロックに格納され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報がレンダリングプログラムでエンコードされている場合、頂点によって形成されるさまざまな形状は</font><em><font style="vertical-align: inherit;">プリミティブ</font></em><font style="vertical-align: inherit;">と呼ばれ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Direct3Dは、点、線、および三角形の形で、それら、ストリップ、およびファンのリストを使用することを提案します。三角形のストライプは、正しく使用すると、複数の三角形の頂点を使用するため、生産性が向上します。以下の例では、2つの三角形を接続するために4つの頂点のみが必要であることがわかります。それらが分離されている場合、6つの頂点が必要です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41e/9cb/a1e/41e9cba1ee23a0b9787994ef7249d6ff.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左から右へ：ポイントのリスト、線のリスト、および三角形のストリップ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
たとえば、ゲームNPCのモデルで、より大きな頂点のセットを処理する必要</font><i><font style="vertical-align: inherit;">がある</font></i><font style="vertical-align: inherit;">場合は、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれるオブジェクトを使用することをお勧めします。</font><font style="vertical-align: inherit;">別のメモリブロックですが、複数のバッファー（頂点、インデックスなど）およびモデルテクスチャリソース。</font><font style="vertical-align: inherit;">Microsoft </font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインドキュメントに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、これらのバッファの使用方法に関する簡単な説明があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とりあえず、新しい各フレームをレンダリングするときに、3Dゲームのこれらの頂点に何が起こるかに焦点を当てましょう。</font><font style="vertical-align: inherit;">つまり、次の2つの操作のいずれかを実行します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点が新しい位置に移動します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点カラーの変更</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数学の準備はいいですか？</font><font style="vertical-align: inherit;">必要です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベクトルがステージに表示されます。</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画面に三角形があり、キーを押して左に移動したとします。当然、</font><font style="vertical-align: inherit;">各頂点</font><font style="vertical-align: inherit;">の数（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x、y、z</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）はそれに応じて変化すると</font><font style="vertical-align: inherit;">予想</font><font style="vertical-align: inherit;">されます。それは何が起こるかですが、</font><font style="vertical-align: inherit;">変更</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装する</font><em><font style="vertical-align: inherit;">ための</font></em><font style="vertical-align: inherit;">かなり予期しない</font><em><font style="vertical-align: inherit;">方法</font></em><font style="vertical-align: inherit;">です。代わりに、単純に座標を変更するので、システムをレンダリングする3Dグラフィックスの大半は、特別な数学的なツールを使用します。私たちは意味</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のベクトルを</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベクトルは、空間内の特定のポイントに向けられ、希望の長さを持つ矢印として表すことができます。頂点は通常、デカルト座標に基づくベクトルを使用して設定されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c5/5e4/79d/1c55e479dbf4da359cfa6ef7e3d55e8f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
青い矢印が1か所（この場合は</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原点</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">から始まり</font><font style="vertical-align: inherit;">、上に伸びている</font><font style="vertical-align: inherit;">ことに注意してください</font><font style="vertical-align: inherit;">。ベクトルを設定するため</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に、列</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レコード</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用しました</font><em><font style="vertical-align: inherit;">が、行のレコード</font></em><font style="vertical-align: inherit;">を使用することも可能</font><font style="vertical-align: inherit;">です。一般的に</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w-component</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる別の4番目の値があることに気づいたかもしれません</font><font style="vertical-align: inherit;">。これは、ベクトルが何を表すかを示すために使用されます：ポイント位置（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位置ベクトル</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）または一般的な方向（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベクトル</font><font style="vertical-align: inherit;">）。方向ベクトルの場合、次のようになります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb2/73e/525/bb273e52588aa21666075a11a34ee32d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このベクトルは同じ方向を指し、前の位置ベクトルと同じ長さを持っています。つまり、値（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x、y、z</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）は同じになります。</font><font style="vertical-align: inherit;">ただし、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w-</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントは1ではなく、ゼロです。</font><font style="vertical-align: inherit;">方向ベクトルの使用については後で説明しますが、ここでは、3Dシーンのすべての頂点がこの方法で記述されることを思い出してください。</font><font style="vertical-align: inherit;">どうして？</font><font style="vertical-align: inherit;">この形式では、それらを移動する方がはるかに簡単だからです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数学、数学、そして再び数学</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単純な三角形があり、それを左に移動したいことを思い出してください。各頂点は位置ベクトルによって記述されるため、「移動数学」（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変換</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><em><font style="vertical-align: inherit;">ます</font></em><font style="vertical-align: inherit;">）はこれらのベクトルで機能する必要があります。新しいツールが表示されます：</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行列</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">単数形の</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行列</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。これは、行と列を含むExcelスプレッドシートと同様の形式で記述された値の配列です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変換のタイプごとに対応する行列があり、変換の場合は、変換行列と位置ベクトルを単純に乗算するだけで十分です。これが発生する方法と理由の詳細については説明しませんが、どのように表示されるかを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3D空間で頂点を移動すると呼ばれます</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transfer（translation）</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であり、次の計算が必要です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/530/c9b/eca/530c9beca19d9b0c8d61db78ecb8682a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など </font><font style="vertical-align: inherit;">ベクトルの元の座標を表す; </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delta</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xの</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値は</font><font style="vertical-align: inherit;">、上を移動する量を表します。</font><font style="vertical-align: inherit;">行列とベクトルの乗算は、それらが単純に要約されるという事実につながります（</font><font style="vertical-align: inherit;">完成した回答が以前のように位置ベクトルのままになるように</font><font style="vertical-align: inherit;">、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成分は変更されないことに</font><font style="vertical-align: inherit;">注意してください</font><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
移動するだけでなく、三角形を回転させたり、スケールを変更したりする必要がある場合もあります。これらの操作には、変換もあります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fc/ba4/d0b/1fcba4d0b2a678e94c17c49a09af0591.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この変換により、XY平面のz軸を中心に頂点が回転します</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5eb/1d5/26e/5eb1d526eb15b522f3fddb0dadffa8cf.png"></div><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、図のスケールを変更する必要がある場合に使用さ</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
れ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リアルタイムレンダリング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WebサイトのWebGLベースのグラフィカルツールを使用</font><font style="vertical-align: inherit;">して、図全体のこれらの計算を視覚化できます。</font><font style="vertical-align: inherit;">標準の位置にある長方形のボックスから始めましょう：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/220/5d7/3d2/2205d73d2920758e3fb11f6829cb924d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオンラインツールでは、モデルポイントは位置ベクトル、ワールドマトリックスは変換マトリックス、そしてワールドスペースポイントは変換された頂点の位置ベクトルです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボックスにさまざまな変換を適用してみましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/820/d7b/5d6/820d7b5d618f68de9446d0ee005a50da.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上の画像では、図は</font><font style="vertical-align: inherit;">各軸で5ユニット</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移動さ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れています。</font><font style="vertical-align: inherit;">これらの値は、真ん中の大きな行列の最後の列に表示されます。</font><font style="vertical-align: inherit;">元の位置ベクトル（4、5、3、1）は本来のままですが、変換された頂点は（9、10、8、1）に移動します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a1/8c4/6fd/9a18c46fd6df9936f3632fd4e4b2a287.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この変換では、すべてが2倍にスケーリングされました。ボックスの側面が2倍になりました。</font><font style="vertical-align: inherit;">最後に、回転の例を見てください。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/beb/340/21cbeb3409b55b736d2dd1322a1d80b0.jpg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平行六面体は45度の角度で回転されましたが、</font><font style="vertical-align: inherit;">この角度の</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正弦</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">余弦が</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行列で使用されてい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">関数電卓をチェックすると、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sin（45°）</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 0.7071 ...であり、表示された値0.71に丸められます。</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コサイン</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値についても同じ答えが得られます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行列とベクトルはオプションです。</font><font style="vertical-align: inherit;">それらの一般的な代替手段は、特に複雑なコーナーを処理する場合、複素数と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">四元数の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用です</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらの計算はベクトルとは非常に異なるため、変換については引き続き作業を行い、それらを考慮しません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点シェーダーパワー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この段階では、レンダリングコードをプログラミングする人がすべてこれを行うことを理解する必要があります。ゲーム開発者がサードパーティエンジン（たとえば、UnityやUnreal）を使用している場合、これはすべて彼のために既に行われています。しかし、誰かが自分のエンジンを最初から作成する場合、頂点を使用してこれらすべての計算を実行する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これらすべてがコードの観点からどのように見えるのでしょうか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを理解するために、驚くべき</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Braynzar Softの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Webサイトの例を使用します</font><font style="vertical-align: inherit;">。自分で3Dプログラミングの作業を開始したい場合は、ここから、基本事項や、より複雑なことを学ぶのに最適な場所です...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/726/99f/664/72699f66423a8f3094cb911bc99a18e2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはオールインワン変換の例です。キーボード入力に基づいて適切な変換行列を作成し、1回の操作でそれらを元の位置ベクトルに適用します。他の方法では結果が完全に台無しになるため、これは常に指定された順序（スケーリング-ローテーション-転送）で行われることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなコードのブロックは</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点シェーダー</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">、その複雑さとサイズは大きく異なる可能性があります。上記の例は単純ですが、それがある</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">だけ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダーの完全にプログラム可能な性質を使用しない頂点シェーダー。より複雑な一連のシェーダーは、3D空間でオブジェクトを変換し、シーンカメラの視点からオブジェクトの外観を処理し、レンダリングプロセスの次の段階にデータを転送します。頂点処理の順序を考慮して、他の例を検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これらはさらに多くの用途に使用できるので、3Dゲームをプレイするとき、表示されるすべての動きが頂点シェーダーコマンドを実行するGPUによって行われることを忘れないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、これは常に当てはまるわけではありません。 1990年代の半ばに戻ると、当時のグラフィックスカードには頂点とプリミティブを個別に処理する機能がありませんでした。これらすべてが中央プロセッサによって行われていました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/954/1d1/c15/9541d1c150a6ef926d98449addf51206.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロセスの独自のハードウェアアクセラレーションを備えた最初のプロセッサの1つは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2000年</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">リリースされたNvidia GeForceで、</font></a><font style="vertical-align: inherit;">この機能は</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードウェアトランスフォームおよびライティング</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（略してハードウェアTnL）</font><em><font style="vertical-align: inherit;">と</font></em><font style="vertical-align: inherit;">呼ばれていました</font><font style="vertical-align: inherit;">。この機器が処理できるプロセスはチームとしては非常に限られていたが、新しいチップのリリースに伴い、状況は急速に変化した。現在、頂点を処理するための個別の機器はなく、1つのデバイスがすべてを一度に処理します：ポイント、プリミティブ、ピクセル、テクスチャなど。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライティング</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について</font><font style="vertical-align: inherit;">は、ライトのおかげですべてが見えることは注目に値するので、頂点の段階でどのように処理できるかを見てみましょう。これを行うには、前に説明した内容を利用する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライト、カメラ、モーター！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この画像を想像してみてください。プレーヤーは暗い部屋に立っており、右側の1つの光源に照らされています。</font><font style="vertical-align: inherit;">部屋の真ん中に巨大なやかんがあります。</font><font style="vertical-align: inherit;">これについてサポートが必要な場合があるので、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リアルタイムレンダリング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Webサイト</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">その外観を見</font><font style="vertical-align: inherit;">てみましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1a/6a4/5f4/b1a6a45f47e81bec587c4f7bda1bf3ae.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオブジェクトは、互いに接続された一連の平らな三角形であることを忘れないでください。つまり、各三角形の平面は特定の方向に向けられます。それらのいくつかはカメラの方に向けられ、いくつかは他の方に向けられ、いくつかは歪むでしょう。光源からの光は各平面に当たり、特定の角度でそこから反射されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
光が反射する場所に応じて、平面の色と明るさが変化し、オブジェクトの色が正しく見えるようにするには、これらすべてを計算して考慮する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、各平面の方向を見つける必要があります。これには</font><em><font style="vertical-align: inherit;">、法線ベクトル</font></em><font style="vertical-align: inherit;">が必要です</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">飛行機。これは別の矢印ですが、位置ベクトルとは異なり、そのサイズは重要ではありません（実際には、法線ベクトルのスケールを計算した後、常に減少して長さが1になります）</font><font style="vertical-align: inherit;">。また、平面に</font><font style="vertical-align: inherit;">常に</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">垂直</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（直角）に向けられます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/228/84c/836/22884c83697e201f3b00bb7d06f6f95f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各三角形の平面の法線</font><font style="vertical-align: inherit;">は、三角形の辺を形成する</font><font style="vertical-align: inherit;">2つの方向ベクトル（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qの</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上に表示</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">のベクトル積を決定することによって計算され</font><font style="vertical-align: inherit;">ます。実際、三角形ではなく、頂点ごとに計算する方が適切ですが、最初のものは2番目のものよりも常に多いため、三角形の法線を計算する方が高速です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表面の法線を受け取ったら、光源とカメラを検討し始めることができます。 3Dレンダリングでは、光源はさまざまなタイプにすることができますが、この記事では</font><font style="vertical-align: inherit;">、スポットライトなどの</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向性のある</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光源</font><font style="vertical-align: inherit;">のみを検討し</font><font style="vertical-align: inherit;">ます。三角形の平面のように、スポットライトとカメラは次のような特定の方向を指します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a8/f24/b91/3a8f24b915d631a9608faaf106b04300.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
光源ベクトルと法線ベクトルを使用して、表面に光が当たる角度を計算できます（ベクトルのスカラー積とサイズの積の関係を使用）。</font><font style="vertical-align: inherit;">三角形の頂点には、色とマテリアルに関する追加情報が含まれます。</font><font style="vertical-align: inherit;">マテリアルは、表面に当たったときに光に何が起こるかを説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
滑らかな金属面は、入射光のほとんどすべての角度で反射し、物体の色をほとんど変えません。</font><font style="vertical-align: inherit;">粗いマットマテリアルは、あまり予測できない方法で光を散乱させ、色をわずかに変化させます。</font><font style="vertical-align: inherit;">これを考慮するには、頂点に値を追加する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オリジナルベースカラー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンビエントマテリアル属性-頂点を吸収および反射できる「背景」照明の量を決定する値</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拡散マテリアルの属性は別の値ですが、今回は頂点の「粗さ」を決定します。これにより、散乱光の吸収と反射の量に影響します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鏡面素材の属性-頂点の光沢を指定する2つの値</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なる照明モデルは、異なる数式を使用してこれらのすべての属性をグループ化し、計算の結果は出力照明ベクトルです。</font><font style="vertical-align: inherit;">カメラベクトルと組み合わせて、三角形の全体的な外観を決定できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/627/648/a21/627648a213ed357982314f7ed7fdd915.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つの指向性光源が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nvidiaデモ</font></font></a></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">からのさまざまなマテリアルを照らし</font></i><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます。</font></a></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
詳細は省略しましたが、正当な理由により、3Dレンダリングチュートリアルを開くと、章全体がこのプロセスに専念していることがわかります。ただし、最近のゲームでは、照明とマテリアルの効果のすべての計算の大部分はピクセル処理段階で実行されるため、次の記事でそれらに戻ります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d7c/8b7/3b0/d7c8b73b0185c20eb23b2a9fdee1cba6.png"></div><br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプルコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> B. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phong光反射モデル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を頂点シェーダーで処理する方法を示すAnguelov </font><font style="vertical-align: inherit;">。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記で検討したことはすべて頂点シェーダーによって行われており、不可能ではないようです。</font><font style="vertical-align: inherit;">残念ながらそうではありません。</font><font style="vertical-align: inherit;">頂点シェーダーは新しい頂点を作成できず、各シェーダーは個々の頂点を処理する必要があります。</font><font style="vertical-align: inherit;">コードを使用して、既存の三角形の間に新しい三角形を作成し（視覚的な品質を向上させる）、プリミティブ全体を処理するシェーダーを（処理を高速化する）作成できると便利です。</font><font style="vertical-align: inherit;">まあ、現代のGPUではそれ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が可能</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お願いします、もっと欲しいです（三角形）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最新のグラフィックスチップは非常に強力で、毎秒数百万の行列ベクトル計算を実行できます。彼らは一度に巨大な山の山に簡単に対処します。一方、レンダリング用の非常に詳細なモデルの作成は非常に長いプロセスであり、モデルがシーンからある程度離れた場所に配置されている場合、これらすべての詳細が無駄になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、たとえば、1つの平らな三角形を元の三角形の内部にある小さな三角形のセットに分割するなど、大きなプリミティブをプロセッサに分割するように命令する必要があります。このようなプロセスは</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テッセレーション</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">、グラフィックチップはすでにそれを非常にうまく実行することを学んでいます。長年にわたる開発の中で、このプロセスに対するプログラマーの制御の度合いは高まっています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを実際に見るに</font><font style="vertical-align: inherit;">は、テストで使用されるモデルに異なるテッセレーション値を適用できるため</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、UnigineエンジンのHeavenベンチマークツールを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d11/630/5fd/d116305fd0fa789635bc3631a4463829.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、ベンチマークの場所を取り、テッセレーションを使用せずにそれを研究しましょう。</font><font style="vertical-align: inherit;">地面の石畳が非常に不自然に見えることに注意してください。使用したテクスチャは効果的ですが、間違っているようです。</font><font style="vertical-align: inherit;">テッセレーションをシーンに適用してみましょう。Unigineエンジンはそれを個々のパーツにのみ適用しますが、違いは大きくなります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e1c/8fb/399/e1c8fb3998d448711164832c4b3af2ff.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
土地、建物の端、ドアは、よりリアルに見えます。</font><font style="vertical-align: inherit;">プロセスを再度開始することでこれがどのように達成されたかを確認できますが、今回はすべてのプリミティブを選択して（つまり、ワイヤーフレームモードで）します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c2/691/fec/0c2691fec046708d4c65058ed3cec016.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
地球がなぜ奇妙に見えるのか、それは完全に平らです！ドアは壁と結合し、建物の端は単純な平行六面体です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Direct3Dでは</font><font style="vertical-align: inherit;">、3つのステップのプロセスを実行する</font><font style="vertical-align: inherit;">ことにより、プリミティブを小さなパーツのグループに分割できます（このプロセスは</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブディビジョン</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます）。まず、プログラマーは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーフェスシェーダー（ハルシェーダー）を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記述します。実際、このコードは、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジオメトリパッチ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる構造を作成します</font><font style="vertical-align: inherit;">。新しいプリミティブ内の新しいポイントとラインが表示される場所をプロセッサに伝えるマップと考えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、GPU内のテッセレーターブロックがこのパッチをプリミティブに適用します。最後に、</font><em><font style="vertical-align: inherit;">ドメインシェーダー</font></em><font style="vertical-align: inherit;">が実行されます</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての新しい頂点の位置を計算します。必要に応じて、このデータを頂点バッファーに転送して、ライティング計算を新たに実行できますが、今回はより良い結果が得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはどのように見えますか？テッセレーションされたシーンのワイヤーフレームバージョンを起動します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3c0/ca9/5af/3c0ca95af3ce89f1ae854706dfd04adc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直なところ、プロセスの説明をよりわかりやすくするために、かなり高度なテッセレーションを設定しています。最新のグラフィックチップがどんなに優れていても、すべてのシーンでこれを行う必要はありません。たとえば、ドアの横のランプを見てください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ワイヤフレームが無効になっている画像では、この距離での違いはほとんど見られず、このようなレベルのテッセレーションでは三角形が非常に多く追加されているため、三角形を互いに分離するのが困難であることがわかります。ただし、この頂点処理関数を正しく使用すると、特にソフトボディの衝突をシミュレートするときに、素晴らしい視覚効果を作成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Direct3Dコードの観点から見てみましょう。このため、別の優れたWebサイトである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RasterTekの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例を使用します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、多くの小さな三角形にテッセレーションされた単純な緑の三角形です...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13a/3bd/3d4/13a3bd3d482f26404d92d3ab60694fa3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点</font><font style="vertical-align: inherit;">
処理は</font><font style="vertical-align: inherit;">、テッセレーション用に三角形を準備する頂点シェーダー、パッチを生成するサーフェスシェーダー、新しい頂点を処理するドメインシェーダーの</font><font style="vertical-align: inherit;">3つの別々のシェーダー（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード例を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">によって実行されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">結果は十分に明確ですが、Unigineの例は、テッセレーションの広範な使用の潜在的な利点と危険性の両方を示しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「鉄」は我慢できない！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
頂点シェーダーは常にシーン内のすべての頂点を処理するということを覚えていますか？ここではテッセレーションが深刻な問題になる可能性があることを理解するのは簡単です。そして、1つのプリミティブの異なるバージョンを処理する必要がある多くの視覚効果がありますが、たとえば、髪、毛皮、草、爆発の粒子など、最初から作成する必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸いなことに、特にそのような場合には、別のシェーダー- </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幾何学的シェーダーがあり</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これは頂点シェーダーのより限定されたバージョンですが、プリミティブ全体に適用できます。テッセレーションと組み合わせることで、プログラマーは大きな頂点グループに対する制御を強化できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/602/97d/f09/60297df09a132ab07b00140fa2a07b77.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ULベンチマークの3DMarkヴァンテージ-ジオメトリックシェーダーは</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、すべての最新のグラフィックAPIと同様に、</font><i><font style="vertical-align: inherit;">パーティクルと</font></i><font style="vertical-align: inherit;"> Direct3D </font><i><font style="vertical-align: inherit;">フラグ</font></i><font style="vertical-align: inherit;">を処理し、頂点を使用して多くの計算を実行できます。完成したデータは、レンダリングプロセスの次のステージ（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラスタライズ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">転送するか</font><font style="vertical-align: inherit;">、メモリプールに戻して、中央プロセッサで他の目的で再処理または読み取ることができます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direct3D</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関するMicrosoftのドキュメントによれば</font><font style="vertical-align: inherit;">、これはデータストリームとして実装できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/638/134/de2/638134de2960977f2847aab27c88df84.png"></div><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストリーム出力ステップは、</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それが唯一のレンダリングサイクルに全プリミティブ（よりむしろ個々の頂点）バックを転送することができ、特にため、オプション、それは多数の粒子を必要とする効果のために有用です。変数または</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点バッファー</font><font style="vertical-align: inherit;">を使用しても同じトリックを実行できますが</font><font style="vertical-align: inherit;">、入力データバッファーを変更せずに開いておくと、パフォーマンスが低下するため、変更しないでおくことをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
頂点処理は、シーンがカメラの視点からどのように見えるかを決定するため、レンダリングの重要な部分です。現代のゲームでは、何百万もの三角形を使用して世界を構築することができ、これらの各頂点は何らかの形で変換され、照明されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bdd/760/829/bdd760829e81753b4938fd8ff3076b6d.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形。</font><font style="vertical-align: inherit;">それらの数百万があります。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらすべての計算と計算を処理することはロジスティックな悪夢のように思えるかもしれませんが、グラフィックプロセッサ（GPU）とAPIはこれらすべてを考慮して設計されています-完全に機能する工場が一度に1つの製品を生産パイプラインに渡すことを想像してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
経験豊富な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3Dゲームレンダリング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラマー</font><font style="vertical-align: inherit;">は、数学と物理学の基本的な知識を持っています。</font><font style="vertical-align: inherit;">可能なすべてのトリックとツールを使用して操作を最適化し、頂点処理ステージを数ミリ秒に圧縮します。</font><font style="vertical-align: inherit;">しかし、これは3Dフレームの構築のほんの始まりにすぎません。次の段階は、ラスタライゼーション、次にピクセルとテクスチャの非常に複雑な処理、そして画像がモニターに表示されることです。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja472674/index.html">Pythonプロジェクトの環境変数</a></li>
<li><a href="../ja472676/index.html">Slack、Jira、青い電気テープのみを使用して、メインチームを支援するためのジョーンズ部門を作成します</a></li>
<li><a href="../ja472682/index.html">C. elegansの薬物シナジーによる老化の減速</a></li>
<li><a href="../ja472684/index.html">fsync（）PostgreSQLへのサプライズ</a></li>
<li><a href="../ja472686/index.html">I486ベースのビデオスタジオ</a></li>
<li><a href="../ja472690/index.html">Zabbix 4.4の新機能</a></li>
<li><a href="../ja472694/index.html">Ceph以外：MCS Block Cloud Storage</a></li>
<li><a href="../ja472702/index.html">JH Rainwater「猫の放牧方法」：プログラマーの品種とその育種の特徴</a></li>
<li><a href="../ja472708/index.html">ImpervaがCloud WAFハックの技術的詳細を明らかにした</a></li>
<li><a href="../ja472714/index.html">フロントランナーが仕事を探すためにどこに落ちないか：電報、スラック、そして</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>