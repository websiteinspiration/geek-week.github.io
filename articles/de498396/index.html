<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî∞ ü§≤üèª ü§úüèº Linux-Container f√ºr die .NET Framework-Anwendung (wenn es schwierig ist, f√ºr .Net Core zu gehen) üïé ü§∂üèø ‚úãüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. 
 
 Ich m√∂chte mit der Welt eine eher untypische Aufgabe teilen, zumindest f√ºr mich, und ihre L√∂sung, die mir durchaus akzeptabel erschein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Linux-Container f√ºr die .NET Framework-Anwendung (wenn es schwierig ist, f√ºr .Net Core zu gehen)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich m√∂chte mit der Welt eine eher untypische Aufgabe teilen, zumindest f√ºr mich, und ihre L√∂sung, die mir durchaus akzeptabel erscheint. </font><font style="vertical-align: inherit;">Das unten beschriebene ist m√∂glicherweise nicht der ideale Ausweg aus der Situation, aber es funktioniert und funktioniert wie beabsichtigt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einstellung und Hintergrund</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab eine Aufgabe f√ºr die Arbeit: Sie m√ºssen eine 3D-Vorschau von BIM-Modellen verschiedener Ger√§te, Materialien und Objekte auf der Site erstellen. </font><font style="vertical-align: inherit;">Ben√∂tigen Sie etwas Leichtes, Unkompliziertes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Website werden Modelle dieser Objekte gespeichert und stehen in propriet√§ren Formaten verschiedener </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CAD-Systeme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und in Form offener Formate f√ºr 3D-Modelle </font><font style="vertical-align: inherit;">zum Download zur Verf√ºgung </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Darunter befindet sich das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IFC-</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Format </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ich werde es als Quelle f√ºr die L√∂sung dieser Aufgabe verwenden.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine der Optionen und ihre Funktionen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formal k√∂nnte man sich darauf beschr√§nken, eine Art * .ifc-Konverter zu schreiben, damit etwas auf einer Webseite angezeigt wird. </font><font style="vertical-align: inherit;">Hier habe ich angefangen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wunderbares Toolkit, das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xBIM Toolkit,</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wurde f√ºr eine solche Konvertierung ausgew√§hlt </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beispiele f√ºr die Verwendung dieses Tools beschreiben einfach und klar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wie mit IFC und dem auf das Webformat spezialisierten * .wexBIM gearbeitet wird.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konvertieren Sie zuerst * .ifc in * .wexBIM:</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> Xbim.Ifc;
<span class="hljs-keyword">using</span> Xbim.ModelGeometry.Scene;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">CreateWexBIM</span><font></font>
{<font></font>
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><font></font>
    {<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">const</span> <span class="hljs-keyword">string</span> fileName = <span class="hljs-string">"SampleHouse.ifc"</span>;
            <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> model = IfcStore.Open(fileName))<font></font>
            {<font></font>
                <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> Xbim3DModelContext(model);<font></font>
                context.CreateContext();<font></font>
<font></font>
                <span class="hljs-keyword">var</span> wexBimFilename = Path.ChangeExtension(fileName, <span class="hljs-string">"wexBIM"</span>);
                <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> wexBiMfile = File.Create(wexBimFilename))<font></font>
                {<font></font>
                    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> wexBimBinaryWriter = <span class="hljs-keyword">new</span> BinaryWriter(wexBiMfile))<font></font>
                    {<font></font>
                        model.SaveAsWexBim(wexBimBinaryWriter);<font></font>
                        wexBimBinaryWriter.Close();<font></font>
                    }<font></font>
                    wexBiMfile.Close();<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes wird die resultierende Datei im "Player" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xBIM WeXplorer verwendet</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel f√ºr das Einbetten von * .wexBIM in eine Seite:</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs">&lt;!DOCTYPE html&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Hello building!<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/xbim-viewer.debug.bundle.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"content"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"viewer"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"500"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            <span class="hljs-keyword">var</span> viewer = <span class="hljs-keyword">new</span> xViewer(<span class="hljs-string">'viewer'</span>);
            viewer.load(<span class="hljs-string">'data/SampleHouse.wexbim'</span>);
            viewer.start();
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, lasst uns gehen. </font><font style="vertical-align: inherit;">Ich nehme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nugets</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von xBIM. </font><font style="vertical-align: inherit;">Ich schreibe eine Konsolenanwendung, die eine Reihe von Pfaden zu * .ifc-Dateien als Eingabe empf√§ngt und daneben eine Reihe von * .wexBIM-Dateien hinzuf√ºgt. </font><font style="vertical-align: inherit;">Alles kann auf die Seite hochgeladen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber irgendwie ist es ganz einfach ... Ich m√∂chte, dass dieses Programm zu einer Art Dienst wird, der beim Hochladen des Ereignisses * .ifc in das Portal sofort das erforderliche * .wexBIM erstellt und sofort im vorbereiteten Container angezeigt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, ich bilde neue Anforderungen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lassen Sie Konvertierungsaufgaben von unserem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ kommen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich m√∂chte die Aufgaben selbst in Form einer bin√§ren Nachricht sehen, die tats√§chlich von der in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protobuf-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><font style="vertical-align: inherit;">beschriebenen Klasse zur Deserialisierung bereit ist </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Aufgabe enth√§lt einen Link zum Herunterladen der Quelldatei * .ifc von unserem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Aufgabe sagt mir auch, welcher Bucket in Minio das Ergebnis hinzuf√ºgen soll.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lassen Sie die Anwendung selbst unter .net Core 3.1 erstellen und arbeiten Sie im Linux-Docker-Container auf unserer "Docker-Farm".</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ersten Schwierigkeiten und Konventionen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde die ersten 4 Umsetzungspunkte nicht im Detail beschreiben. </font><font style="vertical-align: inherit;">Vielleicht sp√§ter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anwendung hat die Jobwarteschlange abgeh√∂rt und eine Nachricht mit dem Ergebnis aus der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Korrelations-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ID der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Jobnachricht</font></a><font style="vertical-align: inherit;"> an die Warteschlange </font><font style="vertical-align: inherit;">gesendet. </font><font style="vertical-align: inherit;">Verschraubte die generierten Anforderungs- / Antwortklassen von protobuf. </font><font style="vertical-align: inherit;">Unterrichtet, um Dateien in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> herunterzuladen / hochzuladen </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All das mache ich im Konsolenanwendungsprojekt. </font><font style="vertical-align: inherit;">In den Projekteinstellungen:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>netcoreapp3.1<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und auf meinem Computer mit Windows 10 ist alles vollst√§ndig debuggt und funktioniert. </font><font style="vertical-align: inherit;">Wenn ich jedoch versuche, die Anwendung in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WSL </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auszuf√ºhren,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird ein </font><b><font style="vertical-align: inherit;">System.IO.FileLoadException-</font></b><font style="vertical-align: inherit;"> Fehler </font><b><font style="vertical-align: inherit;">angezeigt</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vollst√§ndige Fehlerinformationen:</font></font></b>
                        <div class="spoiler_text"><pre><code class="json hljs">{
  <span class="hljs-attr">"Type"</span>: <span class="hljs-string">"System.IO.FileLoadException"</span>,
  <span class="hljs-attr">"Message"</span>: <span class="hljs-string">"Failed to load Xbim.Geometry.Engine64.dll"</span>,
  <span class="hljs-attr">"TargetSite"</span>: <span class="hljs-string">"Void .ctor(Microsoft.Extensions.Logging.ILogger`1[Xbim.Geometry.Engine.Interop.XbimGeometryEngine])"</span>,
  <span class="hljs-attr">"StackTrace"</span>: <span class="hljs-string">" at Xbim.Geometry.Engine.Interop.XbimGeometryEngine..ctor(ILogger`1 logger)\r\n at Xbim.Geometry.Engine.Interop.XbimGeometryEngine..ctor()\r\n at Xbim.ModelGeometry.Scene.Xbim3DModelContext.get_Engine()\r\n at Xbim.ModelGeometry.Scene.Xbim3DModelContext.CreateContext(ReportProgressDelegate progDelegate, Boolean adjustWcs)\r\n at My.Converter.ConvertIfc.CreateWebIfc(String ifcFileFullPath, String wexBIMFolder)"</span>,
  <span class="hljs-attr">"Data"</span>: {},
  <span class="hljs-attr">"InnerException"</span>: {
    <span class="hljs-attr">"Type"</span>: <span class="hljs-string">"System.IO.FileNotFoundException"</span>,
    <span class="hljs-attr">"Message"</span>: <span class="hljs-string">"Could not load file or assembly 'Xbim.Geometry.Engine.dll, Culture=neutral, PublicKeyToken=null'. The system cannot find the file specified."</span>,
    <span class="hljs-attr">"FileName"</span>: <span class="hljs-string">"Xbim.Geometry.Engine.dll, Culture=neutral, PublicKeyToken=null"</span>,
    <span class="hljs-attr">"FusionLog"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">"TargetSite"</span>: <span class="hljs-string">"System.Reflection.RuntimeAssembly nLoad(System.Reflection.AssemblyName, System.String, System.Reflection.RuntimeAssembly, System.Threading.StackCrawlMark ByRef, Boolean, System.Runtime.Loader.AssemblyLoadContext)"</span>,
    <span class="hljs-attr">"StackTrace"</span>: <span class="hljs-string">" at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, RuntimeAssembly assemblyContext, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound, AssemblyLoadContext assemblyLoadContext)\r\n at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, StackCrawlMark&amp; stackMark, AssemblyLoadContext assemblyLoadContext)\r\n at System.Reflection.Assembly.Load(String assemblyString)\r\n at Xbim.Geometry.Engine.Interop.XbimGeometryEngine..ctor(ILogger`1 logger)"</span>,
    <span class="hljs-attr">"Data"</span>: {},
    <span class="hljs-attr">"Source"</span>: <span class="hljs-string">"System.Private.CoreLib"</span>,
    <span class="hljs-attr">"HResult"</span>: <span class="hljs-number">-2147024894</span><font></font>
  },<font></font>
  <span class="hljs-attr">"Source"</span>: <span class="hljs-string">"Xbim.Geometry.Engine.Interop"</span>,
  <span class="hljs-attr">"HResult"</span>: <span class="hljs-number">-2146232799</span>
}</code></pre></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Sitzung mit aktivem Googeln und nachdenklichem Lesen zeigte mir, dass ich √§u√üerst unaufmerksam war:</font></font><br>
<blockquote>Recently at work, we were evaluating a few options to render building models in the browser. Building Information Modeling (BIM) in interoperability scenarios is done via Industry Foundation Classes, mostly in the STEP Physical File format. The schema is quite huge and complex with all the things you have to consider, so we were glad to find the xBim open source project on GitHub. They've got both projects to visualize building models in the browser with WebGL as well as conversion tools to create the binary-formatted geometry mesh. To achieve that, native C++ libraries are dynamically loaded (so no .Net Core compatibility) which must be present in the bin folder. The C++ libraries are expected either in the same folder as the application binaries or in a x64 (or x86, respectively) sub folder (See <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">here</a> for more details). In regular projects, the xBim.Geometry NuGet package adds a build task to copy the dlls into the build output folder, but this doesn't work with the new tooling. You can, however, get it to work in Visual Studio 2015 by taking care of supplying the interop dlls yourself.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und √§hnliche Schwierigkeiten gibt es nicht nur f√ºr mich. </font><font style="vertical-align: inherit;">Viele Leute wollen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xBIM unter .Net Core</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nicht kritisch, aber es √§ndert sich sehr ... Alles </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h√§ngt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von der Unf√§higkeit ab, </font><i><font style="vertical-align: inherit;">Xbim.Geometry.Engine64.dll normal</font></i><font style="vertical-align: inherit;"> zu laden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie m√ºssen </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vc_redist.x64.exe</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem Computer haben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Was sind meine Optionen? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste, was ich dachte: ‚ÄûKann ein Windows-Container mit einem vollst√§ndigen .Net Framework verwendet werden? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie Microsoft Visual C ++ Redistributable f√ºr Visual Studio 2015, 2017 und 2019 in diesen Container bereit, und alles wird in Ordnung sein? ‚Äú </font><font style="vertical-align: inherit;">Ich habe es versucht:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testen Sie das Windows-Image f√ºr Docker:</font></font></b>
                        <div class="spoiler_text"> .Net Core :<br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>net47<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span></code></pre><br>
Dockerfile:<br>
<br>
<pre><code class="powershell hljs">FROM microsoft/dotnet<span class="hljs-literal">-framework</span>:<span class="hljs-number">4.7</span><font></font>
WORKDIR /bimlibconverter<font></font>
<span class="hljs-built_in">COPY</span> lib/VC_redist.x64.exe /VC_redist.x64.exe<font></font>
RUN C:\VC_redist.x64.exe /quiet /install<font></font>
<span class="hljs-built_in">COPY</span> bin/Release .<font></font>
ENTRYPOINT [<span class="hljs-string">"MyConverter.exe"</span>]</code></pre></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, es hat funktioniert ... Es lebt! </font><font style="vertical-align: inherit;">Aber. </font><font style="vertical-align: inherit;">Aber was ist mit unserer Host-Linux-Maschine mit Docker? </font><font style="vertical-align: inherit;">Es funktioniert nicht, einen Container mit einem Image auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server Core</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> darauf zu fahren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Muss raus ...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompromiss und Aufl√∂sung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere Suche im Web brachte mich zu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Darin verlangt der Autor eine √§hnliche Implementierung:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um die Sache noch schlimmer zu machen: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Bin√§rdateien sind 32-Bit (x86). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige erfordern visuell umverteilbare C ++ - Laufzeitkomponenten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige erfordern die .NET-Laufzeit. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige ben√∂tigen ein Fenstersystem, obwohl wir nur die Befehlszeilenschnittstelle (CLI) verwenden.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Beitrag beschreibt das Potenzial f√ºr die Ausf√ºhrung von Windows-Anwendungen in Wine in einem Linux-Container. </font><font style="vertical-align: inherit;">Neugierig entschied ich mich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einigen Tests, Fehlern und Erg√§nzungen wurde die Docker-Datei empfangen:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu-basiertes Docker-Image mit Wine, .Net Framework und vcredist an Bord:</font></font></b>
                        <div class="spoiler_text"><pre><code class="powershell hljs"><font></font>
FROM ubuntu:latest<font></font>
<span class="hljs-comment">#  x86</span>
RUN dpkg -<span class="hljs-literal">-add</span><span class="hljs-literal">-architecture</span> i386 \<font></font>
    &amp;&amp; apt<span class="hljs-literal">-get</span> update \
    <span class="hljs-comment">#   </span>
    &amp;&amp; apt<span class="hljs-literal">-get</span> install <span class="hljs-literal">-qfy</span> -<span class="hljs-literal">-install</span><span class="hljs-literal">-recommends</span> \<font></font>
        software<span class="hljs-literal">-properties</span><span class="hljs-literal">-common</span> \<font></font>
        gnupg2 \<font></font>
        <span class="hljs-built_in">wget</span> \<font></font>
        xvfb \<font></font>
        cabextract \<font></font>
    <span class="hljs-comment">#  Wine</span>
    &amp;&amp; <span class="hljs-built_in">wget</span> <span class="hljs-literal">-nv</span> https://dl.winehq.org/wine<span class="hljs-literal">-builds</span>/winehq.key \<font></font>
    &amp;&amp; apt<span class="hljs-literal">-key</span> add winehq.key \<font></font>
    &amp;&amp; apt<span class="hljs-literal">-add</span><span class="hljs-literal">-repository</span> <span class="hljs-string">'deb https://dl.winehq.org/wine-builds/ubuntu/ bionic main'</span> \
    <span class="hljs-comment">#     Wine</span>
    &amp;&amp; <span class="hljs-built_in">add-apt</span><span class="hljs-literal">-repository</span> ppa:cybermax<span class="hljs-literal">-dexter</span>/sdl2<span class="hljs-literal">-backport</span> \
    <span class="hljs-comment">#  Wine</span>
    &amp;&amp; apt<span class="hljs-literal">-get</span> install <span class="hljs-literal">-qfy</span> -<span class="hljs-literal">-install</span><span class="hljs-literal">-recommends</span> \<font></font>
        winehq<span class="hljs-literal">-staging</span> \<font></font>
        winbind \<font></font>
    <span class="hljs-comment"># </span>
    &amp;&amp; apt<span class="hljs-literal">-get</span> <span class="hljs-literal">-y</span> clean \<font></font>
    &amp;&amp; <span class="hljs-built_in">rm</span> <span class="hljs-literal">-rf</span> \<font></font>
      /var/lib/apt/lists/* \<font></font>
      /usr/share/doc \<font></font>
      /usr/share/doc<span class="hljs-literal">-base</span> \<font></font>
      /usr/share/<span class="hljs-built_in">man</span> \<font></font>
      /usr/share/locale \<font></font>
      /usr/share/zoneinfo<font></font>
<span class="hljs-comment">#    Wine</span>
ENV WINEDEBUG=fixme<span class="hljs-literal">-all</span><font></font>
ENV WINEPREFIX=/root/.net<font></font>
ENV WINEARCH=win64<font></font>
<span class="hljs-comment">#  Wine</span><font></font>
RUN winecfg \<font></font>
    <span class="hljs-comment"># winetricks,   .Net Framework  </span>
    &amp;&amp; <span class="hljs-built_in">wget</span> https://raw.githubusercontent.com/Winetricks/winetricks/master/src/winetricks \
    <span class="hljs-literal">-O</span> /usr/local/bin/winetricks \<font></font>
    &amp;&amp; chmod +x /usr/local/bin/winetricks \<font></font>
<span class="hljs-comment"># </span>
    &amp;&amp; apt<span class="hljs-literal">-get</span> <span class="hljs-literal">-y</span> clean \<font></font>
    &amp;&amp; <span class="hljs-built_in">rm</span> <span class="hljs-literal">-rf</span> \<font></font>
      /var/lib/apt/lists/* \<font></font>
      /usr/share/doc \<font></font>
      /usr/share/doc<span class="hljs-literal">-base</span> \<font></font>
      /usr/share/<span class="hljs-built_in">man</span> \<font></font>
      /usr/share/locale \<font></font>
      /usr/share/zoneinfo \<font></font>
    <span class="hljs-comment"># Wine   </span>
    &amp;&amp; wineboot <span class="hljs-literal">-u</span> &amp;&amp; winetricks <span class="hljs-literal">-q</span> dotnet472 &amp;&amp; xvfb<span class="hljs-literal">-run</span> winetricks <span class="hljs-literal">-q</span> vcrun2015<font></font>
<font></font>
WORKDIR /root/.net/drive_c/myconverter/<font></font>
<font></font>
<span class="hljs-comment">#  </span>
<span class="hljs-built_in">COPY</span> /bin/Release/ /root/.net/drive_c/myconverter/<font></font>
<font></font>
ENTRYPOINT [<span class="hljs-string">"wine"</span>, <span class="hljs-string">"MyConverter.exe"</span>]
</code></pre><br>
UPD:        .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">rueler</a><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Build ist nicht schnell, endet aber erfolgreich. </font><font style="vertical-align: inherit;">Ich versuche es. </font><font style="vertical-align: inherit;">Funktioniert!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse, Schlussfolgerungen, Gedanken</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es funktionierte. </font><font style="vertical-align: inherit;">Die Ausgabe ist ein Linux-Image f√ºr den Docker-Container. </font><font style="vertical-align: inherit;">Es ist "aufgedunsen" (~ 5,2 GB), startet jedoch recht schnell und f√ºhrt eine Windows-Konsolenanwendung auf dem .Net Framework 4.7 aus, die RabbitMQ abh√∂rt, Protokolle in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graylog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> schreibt, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Dateien</font></a><font style="vertical-align: inherit;"> herunterl√§dt und in / in Minio hochl√§dt. </font><font style="vertical-align: inherit;">Ich werde die Anwendung √ºber die Remote-Docker-API aktualisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die L√∂sung f√ºr die utilitaristische Aufgabe wird umgesetzt. </font><font style="vertical-align: inherit;">Vielleicht und h√∂chstwahrscheinlich nicht universell. </font><font style="vertical-align: inherit;">Aber im Prinzip war ich zufrieden. </font><font style="vertical-align: inherit;">Vielleicht ist auch jemand n√ºtzlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danke f√ºrs Lesen. </font><font style="vertical-align: inherit;">Ich schreibe zum ersten Mal √ºber Habr. </font><font style="vertical-align: inherit;">Wir sehen uns in den Kommentaren.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de498378/index.html">Ank√ºndigung von Slurms Abendschule durch Agile</a></li>
<li><a href="../de498380/index.html">Overtons Fenster in Aktion: Wie eine Pandemie eingesetzt wird, um unsere Freiheit einzuschr√§nken</a></li>
<li><a href="../de498390/index.html">IAR + Clion = Freundschaft</a></li>
<li><a href="../de498392/index.html">18 GitLab-Funktionen werden Open Source</a></li>
<li><a href="../de498394/index.html">7 kostenlose Analoga von Screaming Frog und Netpeak Spider</a></li>
<li><a href="../de498398/index.html">KOMPAS-Entwickler - Designer oder Programmierer?</a></li>
<li><a href="../de498402/index.html">Glukose und womit es gegessen wird</a></li>
<li><a href="../de498404/index.html">Videokonferenzen sind einfach und kostenlos</a></li>
<li><a href="../de498406/index.html">Wie die Pers√∂nlichkeit eines brillanten jungen Programmierers zerst√∂rt wurde</a></li>
<li><a href="../de498410/index.html">Vivaldi f√ºr PC und Vivaldi f√ºr Android - Teamspiel mit Punktzahl 3.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>