<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍾 👩🏽‍🚒 👩🏻‍💼 Créer une tâche pour une commande à distance sur Laravel 😻 🖕🏽 🧕🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut, Khabrovsk. L'article suivant a été écrit par l'un de nos lecteurs réguliers et ne prétend certainement pas être du matériel hardcore, mais il p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Créer une tâche pour une commande à distance sur Laravel</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/497506/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salut, Khabrovsk. </font><font style="vertical-align: inherit;">L'article suivant a été écrit par l'un de nos lecteurs réguliers et ne prétend certainement pas être du matériel hardcore, mais il pourrait bien servir de tutoriel pour un débutant. </font><font style="vertical-align: inherit;">Nous sommes impatients d'entendre votre avis sur l'article dans les commentaires, et pour plus de connaissances hardcore, nous vous invitons à notre cours </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Framework Laravel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/0k/zr/tc/0kzrtcgvl777bqznfbpicgqsepc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Bonjour à tous! </font><font style="vertical-align: inherit;">Aujourd'hui, dans un temps si «lointain» pour tout le monde, je voudrais distinguer la création d'une simple tâche dans laquelle vous pouvez créer vos propres tâches. </font><font style="vertical-align: inherit;">Cela ressemble à ce qui est écrit dans la documentation officielle de Laravel, et la façon dont il est - j'utilise leur todo comme base, le transforme un peu, et l'essentiel de mon histoire sera de savoir comment créer un rôle d'administrateur et </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">créer un autre clone ridicule Trello semble très incohérent</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <a name="habracut"></a><br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Créer la fondation </font></font></h3><br>
 <img src="https://habrastorage.org/webt/hg/vy/ak/hgvyakmhibjsmwd1zethg1wbgmm.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai dit, nous prendrons le prochain </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme base </font><font style="vertical-align: inherit;">. Il est très simple et se concentre davantage sur l'utilisation des migrations et du routage que sur la programmation des contrôleurs et des modèles. Malheureusement, il n'a pas été mis à jour depuis la version 5.1, et si vous commencez tout juste à programmer dans Laravel sur la dernière version 7 (il n'était récent que le 3 mars), vous n'aurez pas à écrire le routage vers </font></font><code>app/Http/routes.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais vers </font></font><code>routes/web.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(cela a déjà changé depuis la version 6 ), et en général, toute la différence se termine ici. En fin de compte, vous devriez obtenir quelque chose comme ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vt/kw/at/vtkwatppc_py1c7l9jutt16qouq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai également changé le cadre de mise en page de bootstrap à bulma. </font><font style="vertical-align: inherit;">Premièrement, je l'aime mieux, mais deuxièmement, j'avais déjà la base de code des modèles d'enregistrement de lame (bien que, d'autre part, la création des pages d'enregistrement et d'autorisation soit très simple, je montrerai comment). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette version du projet peut être téléchargée </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la branche master (et dans la nouvelle branche vous pouvez télécharger l'application terminée). </font><font style="vertical-align: inherit;">Vous pouvez l'activer en utilisant les commandes suivantes, à condition que vous ayez déjà installé composer et laravel:</font></font><br>
<br>
<pre><code class="plaintext hljs">composer install<font></font>
//   .env,    .env example,     <font></font>
php artisan key:generate //  <font></font>
php artisan serve // <font></font>
</code></pre><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous créons l'autorisation et l'enregistrement</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les autorisations prêtes à l'emploi ont changé par rapport à la version 6. </font><font style="vertical-align: inherit;">Maintenant, pour une création rapide, vous devez installer un package capable de générer rapidement des contrôleurs et des modèles de lame:</font></font><br>
<br>
<pre><code class="plaintext hljs">composer install laravel/ui<font></font>
php artisan ui vue --auth<font></font>
 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plusieurs nouveaux fichiers devraient apparaître dans votre projet: un </font><font style="vertical-align: inherit;">sous-dossier d' </font><i><font style="vertical-align: inherit;">authentification</font></i><font style="vertical-align: inherit;"> apparaîtra </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans le dossier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resourses</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans lequel il y aura des fichiers de modèle de lame dédiés à l'autorisation, des mots de passe. Initialement, les modèles de lames étaient constitués en </font><i><font style="vertical-align: inherit;">bootstrap</font></i><font style="vertical-align: inherit;"> , cependant, je les ai transformés un peu en </font><i><font style="vertical-align: inherit;">bulma</font></i><font style="vertical-align: inherit;"> pour garder le framework css commun dans le projet. Cependant, pour être à l'aise avec l'utilisation du site Web, nous avons besoin d'une barre de navigation. Dans les </font><i><font style="vertical-align: inherit;">ressources,</font></i><font style="vertical-align: inherit;"> j'ai créé le dossier </font><i><font style="vertical-align: inherit;">includes</font></i><font style="vertical-align: inherit;"> , dans lequel j'ai placé les fichiers auxiliaires - en- </font><i><font style="vertical-align: inherit;">tête</font></i><font style="vertical-align: inherit;"> et </font><i><font style="vertical-align: inherit;">nav</font></i><font style="vertical-align: inherit;"> . Afin de ne pas prendre beaucoup de place, je dirai que dans l'en-tête je n'avais qu'une tête avec une connexion bulma, et </font><font style="vertical-align: inherit;">était la suivante:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><code>nav.blade.php</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar has-background-black-ter"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"navigation"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"main navigation"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-brand"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-item has-text-white is-size-4"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span>&gt;</span><font></font>
      TODO<font></font>
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-burger"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"menu"</span> <span class="hljs-attr">aria-expanded</span>=<span class="hljs-string">"false"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-menu"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-start"</span>&gt;</span><font></font>
      @if (Auth::check())<font></font>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"button is-primary"</span>&gt;</span>
        <span class="hljs-comment">&lt;!--   ,  -&gt;   --&gt;</span><font></font>
        {{{ Auth::user()-&gt;name}}}<font></font>
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><font></font>
      @else<font></font>
      <span class="hljs-comment">&lt;!--    --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-item has-text-danger"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"{{route('register')}}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-item has-text-danger"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"{{route('login')}}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><font></font>
      @endif<font></font>
      @if (Auth::check())<font></font>
      <span class="hljs-comment">&lt;!--  ,       --&gt;</span>
      <span class="hljs-comment">&lt;!--      --&gt;</span><font></font>
<font></font>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-item has-text-danger"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"{{url('/logout') }}"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"event.preventDefault();
                  document.getElementById('logout-form').submit();"</span>&gt;</span>
         <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"logout-form"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"{{ url('/logout') }}"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none;"</span>&gt;</span><font></font>
        {{ csrf_field() }}<font></font>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><font></font>
<font></font>
      @endif<font></font>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-end"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- navbar items --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
 </code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous commençons à créer notre architecture </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est déjà temps de discuter de la structure de notre projet. </font><font style="vertical-align: inherit;">Le lecteur pourra alors transformer l'application en fonction de ses besoins, mais maintenant, disons, je veux que l'application ait un administrateur (par exemple, un chef de projet) qui peut définir et supprimer des tâches, et une sorte d'équipe qui peut voir ces commandes. </font><font style="vertical-align: inherit;">Bien sûr, ce serait bien que quelqu'un puisse prendre des tâches et indiquer que c'est lui qui les exécute, mais plus à ce sujet plus tard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, cela signifie que nous aurons deux groupes d'utilisateurs et que nous convenons que seuls les utilisateurs autorisés qui ont été autorisés à accéder à notre tableau des tâches, et certains super administrateurs peuvent ajouter des tâches. </font><font style="vertical-align: inherit;">Commençons.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour une petite simplification, j'ai décidé de diviser l'application en deux pages: une sur laquelle nous n'aurons que des tâches sans possibilité de modification, et la seconde, qui ne sera disponible que pour le super administrateur. </font><font style="vertical-align: inherit;">J'ai décidé de nommer la page disponible pour l'équipe </font></font><code>welcome.blade.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="php hljs">@<span class="hljs-keyword">include</span>(<span class="hljs-string">'includes.header'</span>)<font></font>
<font></font>
&lt;body&gt;<font></font>
    @<span class="hljs-keyword">include</span>(<span class="hljs-string">'includes.nav'</span>)<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">columns</span> <span class="hljs-title">is</span>-<span class="hljs-title">centered</span>"&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">column</span> <span class="hljs-title">is</span>-<span class="hljs-title">half</span>"&gt;
            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>"&gt;
                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">heading</span>"&gt;
                     
                &lt;/<span class="hljs-title">div</span>&gt;

                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">body</span>"&gt;
                    @<span class="hljs-title">foreach</span> ($<span class="hljs-title">tasks</span> <span class="hljs-title">as</span> $<span class="hljs-title">task</span>)
                    &lt;<span class="hljs-title">a</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">block</span>"&gt;
                        &lt;<span class="hljs-title">button</span> <span class="hljs-title">class</span>="<span class="hljs-title">button</span> <span class="hljs-title">is</span>-<span class="hljs-title">rounded</span>"&gt;
                            &lt;<span class="hljs-title">span</span>&gt;</span>{{ $task-&gt;name }}&lt;/span&gt;<font></font>
                        &lt;/button&gt;<font></font>
                        @<span class="hljs-keyword">endforeach</span><font></font>
                &lt;/div&gt;<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
    &lt;/div&gt;<font></font>
&lt;body&gt;<font></font>
&lt;/html&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette page répertorie uniquement les tâches. </font><font style="vertical-align: inherit;">Pour l'afficher, j'ajouterai un nouveau chemin dans web.php:</font></font><br>
<br>
<pre><code class="php hljs">Route::get(<span class="hljs-string">'/'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'welcome'</span>, [
        <span class="hljs-string">'tasks'</span> =&gt; Task::orderBy(<span class="hljs-string">'created_at'</span>, <span class="hljs-string">'asc'</span>)-&gt;get(),<font></font>
    ]);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un modèle dans lequel nous avons la même liste, mais avec la possibilité de modifier et d'ajouter, est appelé </font></font><code>task.blade.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il est trop grand, je vais donc le placer sous le spoiler:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">task.blade.php</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">@extends('layouts.app')<font></font>
<font></font>
@section('content')<font></font>
&lt;div class="columns is-centered"&gt;<font></font>
    &lt;div class="column is-half"&gt;<font></font>
        &lt;div class="panel"&gt;<font></font>
            &lt;div class="panel-heading"&gt;<font></font>
                 <font></font>
            &lt;/div&gt;<font></font>
            &lt;div class="panel-block"&gt;<font></font>
                @include('common.errors')<font></font>
                &lt;!--     --&gt;<font></font>
                &lt;form action="{{ url('task')}}" method="POST"&gt;<font></font>
                    {{ csrf_field() }}<font></font>
<font></font>
                    &lt;div class="field"&gt;<font></font>
                        &lt;label for="task-name" class="label is-medium"&gt;&lt;/label&gt;<font></font>
                        &lt;input type=" text" name="name" id="task-name" class="input is-medium"<font></font>
                            value="{{ old('task') }}"&gt;<font></font>
                    &lt;/div&gt;<font></font>
<font></font>
                    &lt;div class="field"&gt;<font></font>
                        &lt;button type="submit" class="button is-success"&gt;<font></font>
                            &lt;span class="icon"&gt;<font></font>
                                &lt;i class="fa fa-btn fa-plus"&gt;<font></font>
                            &lt;/span&gt;&lt;/i&gt;<font></font>
                            &lt;span&gt; &lt;/span&gt;<font></font>
                        &lt;/button&gt;<font></font>
                    &lt;/div&gt;<font></font>
                &lt;/form&gt;<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
<font></font>
        &lt;!-- Current Tasks --&gt;<font></font>
        @if (count($tasks) &gt; 0)<font></font>
        &lt;div class="panel"&gt;<font></font>
            &lt;div class="panel-heading"&gt;<font></font>
                 <font></font>
            &lt;/div&gt;<font></font>
<font></font>
            &lt;div class="panel-body"&gt;<font></font>
                {{-- &lt;table class="table table-striped task-table"&gt;<font></font>
                    &lt;thead&gt;<font></font>
                        &lt;th&gt;&lt;/th&gt;<font></font>
                        &lt;th&gt;&nbsp;&lt;/th&gt;<font></font>
                    &lt;/thead&gt;<font></font>
                    &lt;tbody&gt; --}}<font></font>
                @foreach ($tasks as $task)<font></font>
                &lt;a class="panel-block"&gt;<font></font>
                    &lt;button class="button is-rounded"&gt;<font></font>
                    &lt;span&gt;{{ $task-&gt;name }}&lt;/span&gt;<font></font>
                &lt;/button&gt;<font></font>
                    &lt;form action="{{ url('task/'.$task-&gt;id) }}" method="POST"&gt;<font></font>
                        {{ csrf_field() }}<font></font>
                        {{ method_field('DELETE') }}<font></font>
                        &lt;button type="submit" class="button is-danger"&gt;<font></font>
                            &lt;span class="icon is-small"&gt; &lt;i class="fa fa-btn fa-trash"&gt;&lt;/i&gt;&lt;/span&gt;<font></font>
                            &lt;span&gt;  &lt;/span&gt;<font></font>
                        &lt;/button&gt;<font></font>
                    &lt;/form&gt;<font></font>
                &lt;/a&gt;<font></font>
                @endforeach<font></font>
            &lt;/div&gt;<font></font>
        &lt;/div&gt;<font></font>
        @endif<font></font>
    &lt;/div&gt;<font></font>
&lt;/div&gt;<font></font>
@endsection<font></font>
<font></font>
</code></pre><br>
 </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ce modèle, comme le didacticiel d'origine, se développe comme suit </font></font><code>app/layouts.blade.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="php hljs">@<span class="hljs-keyword">include</span>(<span class="hljs-string">'includes.header'</span>)<font></font>
<font></font>
&lt;body&gt;<font></font>
    @<span class="hljs-keyword">include</span>(<span class="hljs-string">'includes.nav'</span>)<font></font>
<font></font>
    @<span class="hljs-keyword">yield</span>(<span class="hljs-string">'content'</span>)<font></font>
<font></font>
&lt;/body&gt;<font></font>
<font></font>
&lt;/html&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien! </font><font style="vertical-align: inherit;">Nous avons décidé de l'apparence, nous pouvons maintenant procéder au routage et à la création de la nôtre </font></font><code>middlewares</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, passons au modèle </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisateurs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ajoutons de nouveaux types d'utilisateurs:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">const</span> ADMIN_TYPE = <span class="hljs-string">'admin'</span>;
<span class="hljs-keyword">const</span> TEAM_TYPE = <span class="hljs-string">'team'</span>;
<span class="hljs-comment">#       :</span><font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAdmin</span>(<span class="hljs-params"></span>)</span>{        
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;type === <span class="hljs-built_in">self</span>::ADMIN_TYPE;
    <span class="hljs-comment">//        </span><font></font>
}<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, accédez à la dernière migration de la table des utilisateurs (dossier base de données / migrations) et ajoutez une colonne avec notre nouveau type de données:</font></font><br>
<br>
<pre><code class="plaintext hljs">$table-&gt;string('type')-&gt;default('team');<font></font>
//  ,         <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, parcourez </font></font><code>app/Http/Controllers/Auth/RegisterController.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et modifiez un peu la fonction de création (elle avait également l'air un peu différente dans la version 5):</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $data</span>)
    </span>{
        <span class="hljs-keyword">return</span> User::create([
            <span class="hljs-string">'name'</span> =&gt; $data[<span class="hljs-string">'name'</span>],
            <span class="hljs-string">'email'</span> =&gt; $data[<span class="hljs-string">'email'</span>],
            <span class="hljs-string">'password'</span> =&gt; Hash::make($data[<span class="hljs-string">'password'</span>]),
            <span class="hljs-string">'type'</span> =&gt; User::TEAM_TYPE,  <font></font>
        ]);<font></font>
    }<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, alors nous devons créer notre middleware pour l'administrateur. </font><font style="vertical-align: inherit;">Pour ce faire, la méthode la plus simple consiste à utiliser la commande suivante:</font></font><br>
<br>
<pre><code class="plaintext hljs">php artisan make:middleware IsAdmin
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que vous avez réussi. </font><font style="vertical-align: inherit;">Dans le dossier que </font></font><code>HTTP/middleware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous auriez dû apparaître </font></font><code>isAdmin.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dans lequel la fonction de poignée doit être modifiée comme suit:</font></font><br>
<br>
<pre><code class="plaintext hljs">public function handle($request, Closure $next)<font></font>
    {<font></font>
        if(auth()-&gt;user()-&gt;isAdmin()) {<font></font>
            return $next($request);<font></font>
        //   , .   -   <font></font>
    }<font></font>
        return redirect('/');<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons inscrire notre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">middleware</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><code>app/HTTP/Kernel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vue de l' </font><font style="vertical-align: inherit;">utiliser:</font></font><br>
<br>
<pre><code class="plaintext hljs">protected $routeMiddleware = [<font></font>
    #  ,      <font></font>
        is_admin' =&gt; \App\Http\Middleware\IsAdmin::class,<font></font>
];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous transformons le chemin du </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tiret</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><code>web.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui ne devrait pouvoir voir que le super administrateur:</font></font><br>
<br>
<pre><code class="php hljs">Route::get(<span class="hljs-string">'/dash'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'tasks'</span>, [
        <span class="hljs-string">'tasks'</span> =&gt; Task::orderBy(<span class="hljs-string">'created_at'</span>, <span class="hljs-string">'asc'</span>)-&gt;get(),<font></font>
    ]); <font></font>
})<font></font>
-&gt;middleware(<span class="hljs-string">'is_admin'</span>)    <font></font>
-&gt;name(<span class="hljs-string">'admin'</span>);<font></font>
<font></font>
<span class="hljs-comment">#       </span><font></font>
<font></font>
Auth::routes();<font></font>
Route::post(<span class="hljs-string">'/logout'</span>, <span class="hljs-string">'Auth\LoginController@logout'</span>)-&gt;name(<span class="hljs-string">'logout'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il reste à créer un contrôleur personnalisé pour notre administrateur:</font></font><br>
<br>
<pre><code class="plaintext hljs">php artisan make:controller AdminController
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Montage:</font></font><br>
<br>
<pre><code class="plaintext hljs">public function __construct()<font></font>
    {<font></font>
        $this-&gt;middleware('auth');<font></font>
    }<font></font>
    public function admin()<font></font>
    {<font></font>
        return view('admin');<font></font>
    }<font></font>
 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour que l'enregistrement de tous gagné exactement, ne pas oublier de fixer la redirection dans </font></font><code>RouteServiceProvider.php</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la </font></font><code>app/HTTP/Providers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parce qu'il a été conçu à l' </font><font style="vertical-align: inherit;">origine pour le </font><font style="vertical-align: inherit;">modèle de la </font><font style="vertical-align: inherit;">maison:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> HOME = <span class="hljs-string">'/'</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, l'administrateur ne peut apparaître qu'avec l'aide de notre assistant dans le terminal de bricolage: </font></font><br>
<br>
<pre><code class="plaintext hljs">php artisan tinker<font></font>
use App\User;<font></font>
User::where('email', 'admin@mail.com')-&gt;update(['type' =&gt; 'admin']);<font></font>
//    <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout. Si vous voulez essayer l'application terminée, je vais répéter le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bien sûr, notre application ne peut pas être utilisée en production pour le moment, car tous ceux qui se sont inscrits sur la ressource pourront voir vos tâches. Mais comment allez-vous restreindre l'accès? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que vous avez du courrier d'entreprise, puis vous pouvez restreindre l'accès à l'équipe en utilisant des habitués dans la validation du courrier. Ou vous pouvez ajouter une vérification de l'appartenance à l'équipe de la même manière que l'administrateur, après avoir effectué des manipulations similaires. Par tradition, je fournirai quelques liens utiles pour ceux qui vont commencer à maîtriser Laravel: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un article un peu plus détaillé que dans la documentation sur les migrations vers Laravel</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
→ Un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bon article sur Medium sur les rôles dans Laravel</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
→</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">      Laravel 7</a><br>
<br>
<hr><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">     « »   Forge/Envoyer.<br>
</a></b><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497486/index.html">Division des données. année 2013. Rétrospective</a></li>
<li><a href="../fr497488/index.html">Automatisez les processus RH à l'aide de Microsoft Teams, PowerApps et Power Automate. Demandes de retrait d'employés</a></li>
<li><a href="../fr497490/index.html">Difficultés de paternité des hippocampes: métamorphoses génétiques du système immunitaire</a></li>
<li><a href="../fr497492/index.html">Application sur TSD et communication avec 1C: Enterprise 8.3 via HTTP-Service. Partie 1.1 (description détaillée de l'API)</a></li>
<li><a href="../fr497504/index.html">Comment Quarkus intègre MicroProfile et Spring</a></li>
<li><a href="../fr497508/index.html">Nous continuons à utiliser des modèles C ++ à plusieurs étages dans RESTinio: une alternative de type sûr au routeur express-js</a></li>
<li><a href="../fr497510/index.html">Synthèse audio de jeux vidéo - Numéro 2. Proie</a></li>
<li><a href="../fr497512/index.html">La fonte des glaciers fournira-t-elle de l'hydroélectricité à l'avenir?</a></li>
<li><a href="../fr497516/index.html">Comment créer vous-même une boîte blindée anéchoïque</a></li>
<li><a href="../fr497520/index.html">Comparaison des performances HTTP / 3 et HTTP / 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>