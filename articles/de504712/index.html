<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸš• â†ªï¸ Warum verwende ich SharedViewModel nicht fÃ¼r Fragmente? ğŸ‚ğŸ¾ ğŸ¤°ğŸ¾ ğŸ™ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habr, hallo! 
 
 Die Aufgabe, die Interaktion zwischen Fragmenten zu organisieren, ist sehr verbreitet. ShareViewModel eignet sich auf den ersten Blic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Warum verwende ich SharedViewModel nicht fÃ¼r Fragmente?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504712/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habr, hallo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Aufgabe, die Interaktion zwischen Fragmenten zu organisieren, ist sehr verbreitet. ShareViewModel eignet sich auf den ersten Blick hervorragend dafÃ¼r. Wir erstellen ein ViewModel mit owner = our activity, in dem unsere Fragmente angezeigt werden, und erhalten dieses ViewModel in jedem Fragment. weil Der EigentÃ¼mer des ViewModel ist die AktivitÃ¤t. Die Fragmente erhalten dieselbe Instanz des ViewModel, mit der sie Daten, Aufrufmethoden usw. austauschen kÃ¶nnen. Hier ist der Link aus der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die folgende Abbildung zeigt das Interaktionsschema von 3 Fragmenten. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/367/ad4/04f/367ad404f3bf81ec55692ad5c7fc7ac7.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jene. Was wir tun: In jedem Fragment erhalten wir das SharedViewModel der Fragmente, mit denen wir interagieren mÃ¼ssen ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dies ist meiner Meinung nach nicht die beste LÃ¶sung. Weil:</font></font><br>
<a name="habracut"></a><br>
<ol>
<li>    *VM.   ViewModel   View. ViewModel   LiveData,   View,    .. ViewModel    - ,   View.</li>
<li>  SharedViewModel â€”     .   ,    SharedViewModel ,    ,     .     - . </li>
<li>       SharedViewModel,         .       ,     ,        . </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SharedViewModel kann nur verwendet werden, wenn mehrere vollstÃ¤ndig identische Fragmente mit denselben Daten vorhanden sind. In meiner Praxis gab es kein solches Szenario. Es kann zwei identische Fragmente geben, aber der Status des ViewModels ist unterschiedlich. Das SharedViewModel ist fÃ¼r sie ungÃ¼ltig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SharedViewModel bringt eine Menge Probleme mit sich. Sie werden langsam verwirrt, alles ist mit AbhÃ¤ngigkeiten Ã¼berwachsen, der Code ist kompliziert. Es ist viel einfacher zu arbeiten, wenn Fragment + ViewModel eine Black Box ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche LÃ¶sung kann angeboten werden? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein einfacher Dienst, mit dem jedes Fragment auf seine Weise interagiert.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/de9/a92/247/de9a92247d6d9f0cd0c1d9bbdf7bbe6c.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Dienst muss in jedem ViewModel Ã¼bergeben werden. Dank DI und Scope (Dagger, Koin, alle anderen) kann dies einfach und unkompliziert durchgefÃ¼hrt werden. Wenn der Dienst im Kontext einer AktivitÃ¤t ausgefÃ¼hrt werden soll, erstellen Sie ihn im Bereich dieser AktivitÃ¤t und Ã¼bergeben Sie ihn an jedes ViewModel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sehen Sie, was passiert ist: Wir haben alle SharedViewModel aus Fragmenten entfernt. Jedes Fragment weiÃŸ jetzt nichts Ã¼ber die anderen Fragmente. Wenn wir diesem Schema ein neues Fragment hinzufÃ¼gen mÃ¶chten, mÃ¼ssen wir nur viewModel D mit unserem Service verbinden und fertig. Wenn das Fragment auf eine Ã„nderung einer Eigenschaft des Dienstes reagieren soll, abonnieren Sie es einfach. Wir mÃ¼ssen die ViewModels anderer Leute nicht mehr verstehen. Und dieser Dienst ist viel einfacher als jedes ViewModel, es wird einfacher sein, den Dienst zu verstehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass sich nicht so viele interagierende Fragmente auf einem Bildschirm befinden. </font><font style="vertical-align: inherit;">Am Telefon - vielleicht. </font><font style="vertical-align: inherit;">Auf dem Tablet - das kann man nicht mehr sagen. </font><font style="vertical-align: inherit;">Und FragmentContainerView hilft bei der Verwendung von Fragmenten in beliebigen Layouts. Dies ist sehr praktisch, wenn die Anwendung viele gemeinsame Komponenten mit einem Lebenszyklus enthÃ¤lt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus: Wie erstelle ich Fragmente?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So: SomeFragment () </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und was ist mit den Parametern? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Aufkommen von ViewModel verwende ich keine Parameter. </font><font style="vertical-align: inherit;">Ich Ã¼bergebe nichts per Bundle an das Fragment (Android Studio bietet weiterhin an, ein Fragment mit Argumenten zu erstellen und ein Fragment mithilfe der statischen Methode zu erstellen). Ich verwende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Safety NavArgs nicht fÃ¼r die Navigationskomponente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All diese Dinge machen das Fragment konditioniert. Wir kÃ¶nnen ein solches Fragment beispielsweise nicht einfach zum ViewPager hinzufÃ¼gen. Man muss sich Ã¼berlegen, wie man die Parameter Ã¼bergibt. Oder ein anderes Beispiel: Sie haben ein Fragment mit Parametern erstellt, arbeiten daran, die Daten haben sich geÃ¤ndert, das Fragment zeigt bereits etwas anderes. Wir haben die GerÃ¤tekonfiguration geÃ¤ndert (umgedreht), das Fragment wurde mit veralteten Parametern neu erstellt, wÃ¤hrend das ViewModel bereits andere Daten enthÃ¤lt. Und die Aktualisierung der Parameter usw. beginnt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe das alles im ViewModel entfernt. Ich benutze den gleichen Dienst, Ã¼ber den ich die Parameter Ã¼bergebe. Es funktioniert wie Safety NavArgs. ViewModel fordert vom Dienst Parameter nach dem Typ der Parameterklasse an. Nach dem erfolgreichen Abrufen des Parameters lÃ¶scht der Dienst diese (funktioniert wie Push / Pop).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies lÃ¶st sofort das Problem der Ã„nderung der Konfiguration: Das Fragment wurde erneut erstellt, und das ViewModel enthÃ¤lt bereits die aktuellen Daten. Sie mÃ¼ssen sie lediglich mit der Ansicht verbinden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt auch ein Problem beim Ãœbergeben von Parametern durch das BÃ¼ndel - dies ist ein Ãœberschuss der zulÃ¤ssigen Menge. </font><font style="vertical-align: inherit;">Wenn die Ã¼bertragene Datenmenge mehr als 500 KB betrÃ¤gt, kann die Anwendung aufgrund einer Ausnahme in Binder.java abstÃ¼rzen. </font><font style="vertical-align: inherit;">Dies fÃ¼hrte zur Schaffung verschiedener Bibliotheken, die Parameter Ã¼ber SD Ã¼bertragen, was im Vergleich zur Verwendung von RAM nicht sehr schnell ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen sind die Werkzeuge cool, alles ist flexibel, aber Sie mÃ¼ssen vorsichtig sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles, danke fÃ¼rs Zuschauen!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de504700/index.html">Sowjetische Grafiktafel "Skizze"</a></li>
<li><a href="../de504702/index.html">Die Leute wollen kein Englisch</a></li>
<li><a href="../de504706/index.html">Automatische Wi-Fi-Energieverwaltung</a></li>
<li><a href="../de504708/index.html">Ausstellung des Sectigo-Zertifikats nach dem 30. Mai 2020 und LÃ¶sungsmethode</a></li>
<li><a href="../de504710/index.html">FOSS News Nr. 18 - eine ÃœberprÃ¼fung der kostenlosen und Open Source-Nachrichten fÃ¼r den 25. bis 31. Mai 2020</a></li>
<li><a href="../de504714/index.html">Gehen Sie Software-Messwerkzeuge</a></li>
<li><a href="../de504716/index.html">Sicherer Zugang zu einem Smart Home ohne Ã¶ffentliche IP (Teil 1)</a></li>
<li><a href="../de504718/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends fÃ¼r die letzte Woche Nr. 417 (25. - 31. Mai 2020)</a></li>
<li><a href="../de504720/index.html">Die schnellste Template Engine fÃ¼r PHP</a></li>
<li><a href="../de504722/index.html">HLS in MP4 mit ffmpeg in einem Browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>