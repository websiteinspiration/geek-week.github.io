<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥃 👍🏽 😈 最小のBTRFS 🚳 ⬅️ 🚴🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、Khabravchane。私はVeeam Softwareで働いており、Linuxバックアップソリューションの開発者の1人です。職業別でたまたまBTRFSに遭遇しました。最近では、「まだ適切ではない」というステータスから「安定した」というステータスに移行しています。ネットワークの最初のユ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最小のBTRFS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/458250/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、Khabravchane。私はVeeam Softwareで働いており、Linuxバックアップソリューションの開発者の1人です。職業別でたまたまBTRFSに遭遇しました。最近では、「まだ適切ではない」というステータスから「安定した」というステータスに移行しています。ネットワークの最初のユーザーが問題の領域と安定性の問題について話し合っている間、Veeamは杖でそれを突いてバックアップを試みました。穏やかに言えば、それほどではないことがわかりました。従来のファイルシステムとは異なり、あまりにも異なります。私はそれを扱う方法を学ぶ前に、多くの側面を研究して多くの熊手を集めなければなりませんでした。勉強の過程で、BTRFSは、良い意味でもあまり意味もない印象を与えられました。私は彼女がLinuxの世界からITスペシャリストを無関心のままにしないことを確信しています：唾を吐く人もいれば、褒める人もいます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルシステムについて聞いたことがあるが、その理由がわからない、詳細に興味がある、またはどこからそれを知るようになるのかを探している場合は、猫に招待します。</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BTRFS（Bツリーファイルシステム）-ファイルシステムのスケーリングの容易さ、高度なデータの信頼性とセキュリティ、構成の柔軟性と管理の容易さを維持しながら提供するように設計された、コピーオンライト（CoW）技術に基づくUnixライクなオペレーティングシステム用のファイルシステム同時に高速。</font><font style="vertical-align: inherit;">少なくとも、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メインのWikiページに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はこう書かれてい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手続きに準拠するために、btrfsの主な機能をリストします。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大ファイルサイズ2 ^ 64バイト</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的iノードテーブル</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ重複排除</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に小さいサイズと非常に大きいサイズの両方の効果的なファイルストレージ</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウォラムとスナップショットの作成</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームクォータ</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データとメタデータのチェックサム</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のドライブを単一のファイルシステムに結合する機能</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルシステムレベルでのRAID構成の作成</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ圧縮</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その場でデータをデフラグ</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BTRFSは活発に開発されており、いくつかの点はバージョンごとに異なる可能性があることをすぐに警告します。</font><font style="vertical-align: inherit;">リンク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-https://btrfs.wiki.kernel.org/index.php/Changelog、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どの機能が追加、変更、または修正されたかを確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、BTRFSは、さまざまなタスクを解決する、新しくて現代的なファイルシステムですが、欠点がないわけではありません。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その積極的な開発により、サードパーティのユーティリティが作業する際に信頼できる重要なポイントが変更されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BTRFSの安定性に関する開発者の保証にもかかわらず、ユーザーはデータ損失につながる可能性のある問題に定期的に遭遇します。</font><font style="vertical-align: inherit;">原則として、それらは本質的に「フローティング」であり、その結果、それらはまだ調査および修正されていません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">断片化に対する感受性が高い。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">乏しく、時には古くなったドキュメント。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページ全体が、異なるバージョンのカーネル（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://btrfs.wiki.kernel.org/index.php/Gotchas）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でのファイルシステムの問題に費やされてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私はあなたにそこを見るよう強く勧めます-それは多くの興味深く、自明ではないことがわかります。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BTRFSの構造</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡略化すると、BTRFSデバイスは次のレベルに分けることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/n8/zj/zzn8zjyt0dai6ge9rifhgcdwg0q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブロックデバイスは最も低いレベルにあり、1つまたは複数の個別の物理アドレス空間を表します（ブロックデバイス自体と同じ「物理」ですが、これらはすでに詳細です）。特別な構造により、物理メモリの割り当てられたブロックが1つの仮想アドレス空間に結合されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メタデータ構造とユーザーデータ（エクステント）を含むブロックは、すでに論理レベルでアドレス指定されています。その結果、論理レベルで順次配置されたデータは、異なるブロックデバイスに物理的に存在できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メタデータ構造はレベルに分割できます。もちろん、私はそれらを分類しません-それらの多くがあり、そのような低レベルの詳細は別の記事のトピックです。ここで重要なのは、階層内の一部の構造が他よりも高レベルであることが判明し、最上部にサブボリュームを表す構造があることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームは、一種のエントリポイント、つまりファイルシステムのルート要素です。それらは、下位層の作業をカプセル化したデータ表現の個別の層を形成し、通常の形式であるユーザーデータをディレクトリとファイルで提示します。さらに、サブボリュームはBTRFSのCoWメカニズムの重要な要素です。 2つのサブボリューム内の同じファイルは、下位レベルで同じデータセットになる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の層はデータ層です。</font><font style="vertical-align: inherit;">ユーザーがそれらを見ると。</font><font style="vertical-align: inherit;">これらは、サブボリュームにあるファイルとディレクトリです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、十分な理論。</font><font style="vertical-align: inherit;">練習に移りましょう！</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Btrfs-progs</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、BTRFSを管理するためのユーティリティの標準セットです。ディストリビューションパッケージによっては、これらのユーティリティがリポジトリに含まれているパッケージに、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfsprogs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs-progs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs-tools</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの</font><font style="vertical-align: inherit;">異なる名前が付いている場合があります</font><font style="vertical-align: inherit;">。リポジトリに同様のものがなかった場合は、いつでも手動でコンパイルでき</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ソースはそれほど離れていません</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">-https://github.com/kdave/btrfs-progs</font></a><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパッケージで最も重要なユーティリティは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mkfs.btrfs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。 2番目から、すべてが非常に明確であると思います。ブロックデバイスでBTRFSを作成する必要があります。まず、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は残りの作業を可能にする主要なユーティリティです。一種の「スイスナイフ」。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、バージョンv4.15.1を使用しました。</font><font style="vertical-align: inherit;">ユーティリティは非常に活発に開発されており、バージョンごとに顕著な違いがあります。</font><font style="vertical-align: inherit;">したがって、必要なコマンドがない場合は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティのバージョンを確認してください</font><font style="vertical-align: inherit;">。すでに古い</font><font style="vertical-align: inherit;">バージョンである</font><font style="vertical-align: inherit;">可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ほとんどの場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfsck</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfstune</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティはパッケージに含まれています</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つ目は、ファイルシステムのエラーとその後の修正をチェックするためのものですが、使用はお勧めし</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ません。非推奨の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステータスであり</font><font style="vertical-align: inherit;">、その機能は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfs check</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドに移動しました</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目の方法では、btrfsでいくつかの便利な操作を実行できます。たとえば、ファイルシステムの一意の識別子（FS UUID）を変更したり、ファイルシステムの特定の機能を有効にしたりできます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のユーティリティに加えて、パッケージにはさらにいくつかのユーティリティがありますが、これらは主にbtrfsのデバッグに必要であり、この記事では役に立ちません。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BTRFSでディスクをフォーマットする</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際には、すべてが簡単です。</font><font style="vertical-align: inherit;">1つのドライブから始めましょう。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsで単一のディスクをフォーマットするには、通常のコマンドを使用します。</font></font><br>
<br>
<pre><code class="bash hljs">mkfs.btrfs /dev/sdc -L single_drive</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
応答として、ユーティリティは作成されたファイルシステムのパラメーターをコンソールに出力します。</font></font><br>
<br>
<pre><code class="bash hljs">btrfs-progs v4.15.1<font></font>
See http://btrfs.wiki.kernel.org <span class="hljs-keyword">for</span> more information.<font></font>
<font></font>
Label:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; single_drive<font></font>
UUID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 59307d69-6d2f-4d2e-aae2-a5189ad3c256<font></font>
Node size:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16384<font></font>
Sector size:&nbsp; &nbsp; &nbsp; &nbsp; 4096<font></font>
Filesystem size:&nbsp; &nbsp; 1.00GiB<font></font>
Block group profiles:<font></font>
&nbsp;Data: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; single            8.00MiB<font></font>
&nbsp;Metadata: &nbsp; &nbsp; &nbsp; &nbsp; DUP              51.19MiB<font></font>
&nbsp;System: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DUP               8.00MiB<font></font>
SSD detected: &nbsp; &nbsp; &nbsp; no<font></font>
Incompat features:&nbsp; extref, skinny-metadata<font></font>
Number of devices:&nbsp; 1<font></font>
Devices:<font></font>
&nbsp;&nbsp;ID&nbsp; &nbsp; &nbsp; &nbsp; SIZE  PATH<font></font>
&nbsp;&nbsp;&nbsp;1 &nbsp; &nbsp; 1.00GiB&nbsp; /dev/sdc<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提示されたパラメーターを見ていきましょう。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ラベルまたはファイルシステム名。</font><font style="vertical-align: inherit;">キーによって指定され、</font></font><code>-L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプションのパラメーターです。</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、btrfsカーネルにインスタンスを相互に区別させる一意の識別子です。</font></font></li>
<li><b>Node size</b> —   B-,    .       <code>-n | --nodesize</code>,        <b>Sector size</b>.        B- (  ) ,  ,       .   ,          .   , ,      ,   . <br>
   —              .    3.11      16384       (    ).</li>
<li><b>Sector size</b> —  ,         .      ,        <code>-s</code>.</li>
<li><b>Filesystem size</b> —     (  ).    <code>-b</code>.       .</li>
<li><b>Incompat features</b> —  ,    btrfs,       .     ,   :<br>
<br>
<pre><code class="bash hljs">--features ^extref,^skinny-metadata.</code></pre><br>
, ,     ,   :<br>
<br>
<pre><code class="bash hljs">mkfs.btrfs --features list-all</code></pre></li>
<li><b>Number of devices  Devices</b> —        btrfs,     .</li>
<li>     <b>Block Group Profiles</b>.            : Data, Metadata  System.     btrfs,   :<br>
<br>
<ul>
<li>Data —   ;</li>
<li>Metadata —         ;</li>
<li>System —            .</li>
</ul><br>
         :<br>
<br>
<ul>
<li>Single —     ;</li>
<li>DUP —     ;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAIDXは、RAID0、RAID1、RAID10、RAID5、およびRAID6の構成の1つです。</font></font></li>
</ul><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのブロックデバイスをマークアップすると、デフォルトでbtrfsはメタデータとシステムデータに複製を適用し、ユーザーデータは単一のコピーでメディアに残ります。</font><font style="vertical-align: inherit;">一度に複数のディスクにbtrfsを作成すると、デフォルトで「RAID0」プロファイルがユーザーデータに適用され、「RAID1」プロファイルがメタデータに適用されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパラメーターのグループは</font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、データ</font></font><code>-m</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用とメタデータおよびシステムデータ用の</font><font style="vertical-align: inherit;">2つのキーを使用して制御され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ニュアンスがあります... SSDでは状況が異なります。実際、SSDドライブ（またはフラッシュドライブ）をマークアップした場合、デフォルトではファイルシステムはメタデータを複製しません。 SSDは、データ重複排除を拡張して、メモリ要素の寿命を延ばすことができます。それら。データの2つの論理コピーがあり、実際には1つだけがメディアに記録されます。その結果、メモリセグメントに障害が発生すると、データの「両方のコピー」が破損します。さらに、データを2回書き込むことで、SSDリソースの消費が速くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メディアのタイプを判別するために、btrfsはファイル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sys / block / DEV / queue / rotation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の内容を</font><font style="vertical-align: inherit;">チェックします。ここで、「DEV」はチェックされているブロックデバイスの名前です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、SSDの場合でも、データストレージプロファイルを強制的に設定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複数のデバイスでbtrfsインスタンスを作成するには、スペースでそれらを指定するだけです：</font></font><br>
<br>
<pre><code class="bash hljs">sudo mkfs.btrfs /dev/sdc /dev/sdd -L double_drive</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
またはプロファイル付き：</font></font><br>
<br>
<pre><code class="bash hljs">sudo mkfs.btrfs /dev/sdc /dev/sdd -d raid1 -m raid1 -L raid1_drive</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完全なミラーリングが使用されている場合でも、メディアは同じサイズである必要はないことに注意してください。</font><font style="vertical-align: inherit;">ただし、最小のドライブにメモリを割り当てるのに十分なスペースがないとすぐに、ファイルシステムは、物理的に他のメディアにまだ空きスペースがある可能性があるにもかかわらず、空きスペースがないことを示すメッセージを表示します。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取り付け</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しく作成されたbtrfsの最初のマウントは、他のファイルシステムと同じです。</font></font><br>
<br>
<pre><code class="bash hljs">mount /dev/sdc /mnt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルシステムが複数のディスク上にある場合、マウントするには、それらを指定するだけで十分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、btrfsのマウントには、常に1つ以上のサブボリュームのマウントが含まれます。 mountコマンドが指定されていない場合、どのサブボリュームをマウントする必要があるかによって、btrfsは特別なレコードから、デフォルトでマウントする必要があるサブボリュームのIDを読み取ります。このレコードは後でコマンド</font></font><code>btrfs set-default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">変更でき</font><font style="vertical-align: inherit;">ますが、btrfsに最初にマウントしたとき、サブウーファーは1つしかありません-ルートサブウーファーです。デフォルトでマウント用に指定されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsのルートサブワールドは常に存在します。これはファイルシステムとともに表示され、将来変更されることはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルト以外のサブボリュームをマウントするには、2つの方法があり</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。btrfsルートサブボリュームからのパスを指定します。</font></font><br>
<br>
<pre><code class="bash hljs">mount -o subvol=/path/to/subvol /dev/sdc /mnt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームIDを指定します。</font></font><br>
<br>
<pre><code class="bash hljs">mount -o subvolid=257 /dev/sdc /mnt</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、btrfsサブボリュームの1つはデフォルトでマウント済みとして指定されています。</font><font style="vertical-align: inherit;">次のようにして、どれが可能かを調べます。</font></font><br>
<br>
<pre><code class="bash hljs">btrfs subvolume get-default /path/to/any/subvolume</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコマンドを使用して、デフォルトのサブマウントを設定できます。</font></font><br>
<br>
<pre><code class="bash hljs">btrfs subvolume <span class="hljs-built_in">set</span>-default 258 /path/to/any/subvolume</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合のサブボリュームへのパスは、コマンドが適用される特定のbtrfsインスタンスを示すためにのみ必要です。</font><font style="vertical-align: inherit;">ちなみに、サブワールドである必要はありません。任意のディレクトリへのパスも適しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チーム</font></font><code>mount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、btrfsの機能を管理するための膨大な数のオプションを受け入れます。デフラグ、キャッシュフラッシュ、圧縮、カウ、ロギング、バランス、ssdサポート、およびbtrfsに固有の他の多くのことです。</font><font style="vertical-align: inherit;">この記事の枠組みでは考慮しません。</font><font style="vertical-align: inherit;">これらはファイルシステムを微調整するために必要であり、ほとんどの場合、それらを使用せずに実行できます。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームは</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブワールドは、さまざまな機能を実行するbtrfsの重要な要素です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーデータとその他のサブボリュームのストレージ</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データへのアクセスの提供（マウント）、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoWメカニズム</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スナップショットの作成。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の近似では、サブボリュームは通常のディレクトリです。</font><font style="vertical-align: inherit;">それらの名前を変更/移動し、それらの内容を表示し、それらの中にファイルを配置および変更できます。</font><font style="vertical-align: inherit;">特別なユーティリティは必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームの作成と削除は、マウントされたbtrfsで特別なコマンドを使用して実行されます。</font></font><br>
<br>
<pre><code class="bash hljs">btrfs subvolume create /mnt/subvolume_name<font></font>
btrfs subvolume delete /mnt/subvolume_name</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルマネージャーまたは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティを使用してサブボリュームを削除しようとする</font><font style="vertical-align: inherit;">と、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作が許可され</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ない操作</font><font style="vertical-align: inherit;">エラーで終了</font><font style="vertical-align: inherit;">することに注意して</font><font style="vertical-align: inherit;">ください</font><font style="vertical-align: inherit;">（操作は</font><i><font style="vertical-align: inherit;">許可されて</font></i><font style="vertical-align: inherit;">いません）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルバージョン4.18.0以降、サブユーティリティは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティ</font><font style="vertical-align: inherit;">またはファイルマネージャツール</font><font style="vertical-align: inherit;">を使用して削除でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">どうやら、それは機能ではなくバグでした。</font><font style="vertical-align: inherit;">ありがとうhabravchanin</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトティック</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明確にするために。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームを作成すると、そのプロパティを確認できます。</font></font><br>
<br>
<pre><code class="bash hljs">btrfs subvolume show /mnt/subvolume_name<font></font>
<font></font>
Name: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; subx<font></font>
UUID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 09af45e8-d2b2-b342-8a92-fa270ac82d0a<font></font>
Parent UUID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<font></font>
Received UUID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<font></font>
Creation time:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2019-03-23 17:59:28 +0100<font></font>
Subvolume ID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 268<font></font>
Generation: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39<font></font>
Gen at creation:&nbsp; &nbsp; &nbsp; &nbsp; 35<font></font>
Parent ID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 260<font></font>
Top level ID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 260<font></font>
Flags:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<font></font>
Snapshot(s):</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
subwolumeの主なプロパティを見てみましょう：</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名前</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -サブボリュームの名前、</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、主にサブウーファーとスナップショットの関係を決定するために使用される汎用の一意の識別子です。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親UUID-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在の派生元であるサブボリューム祖先の識別子</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信したUUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -を経由して送信されたサブボリュームの識別子祖先</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のbtrfsを送ります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Bツリーに配置するための一意の識別子</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">世代</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -サブボリュームメタデータの最終更新時のトランザクション番号</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成時の世代</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -サブボリュームが作成されたときのトランザクション番号、</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ID-現在のボリュームが埋め込まれているサブボリュームの識別子</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トップレベルID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、親</font><b><font style="vertical-align: inherit;">ID</font></b><font style="vertical-align: inherit;">とまったく同じです。</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -フラグ（実際には1つのフラグのみが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読み取り専用です</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スナップショット</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -このサブボリュームから取得されたスナップショットのリスト。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームにはもう1つのパラメーターがあります。これは、ルートbtrfsエレメントからのパスです。</font><font style="vertical-align: inherit;">サブボリュームを一覧表示すると、パスが表示されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume list /path/to/any/btrfs/mountpoint</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ここではすべてが単純明快です-コマンドの出力をもたらすことも意味がありません。</font><font style="vertical-align: inherit;">and </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドと</font><font style="vertical-align: inherit;">同様に、ここで任意のサブボリュームへのパスを指定できます。この結果は変わりません。</font><font style="vertical-align: inherit;">このパスは、ルートサブボーラムbtrfsを見つけるために使用されます。</font><font style="vertical-align: inherit;">その後、サブオオカミの木全体が読み込まれます。</font><font style="vertical-align: inherit;">
たとえば、</font><b><font style="vertical-align: inherit;">cp</font></b><font style="vertical-align: inherit;">ユーティリティを使用してサブボリュームをコピーしようとする</font><font style="vertical-align: inherit;">と、コピー操作は成功しますが、その結果、サブボリュームは作成されず、通常のディレクトリが作成されます。</font><font style="vertical-align: inherit;">ただし、btrfsはそのようなコピーを作成するためのはるかに柔軟なツール、スナップショットを提供します。</font></font><code>get-default</code><font style="vertical-align: inherit;"></font><code>set-default</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スナップショットは</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショットもサブワールドであり、単に高度なプロパティを持っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な違いは、スナップショットにはどのサブウォームから作成されたかの記録があるということです。</font><font style="vertical-align: inherit;">これらは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親</font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド</font><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">受信UUID</font></b><font style="vertical-align: inherit;">フィールド</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">サブウーファーでは、これらのフィールドも存在しますが、常に空です。</font><font style="vertical-align: inherit;">したがって、実際には、スナップショットとサブボリュームは同じものです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成時に、キーを使用して変更のスナップショットをブロックできます</font></font><code>-r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot -r /path/to/subvol /path/to/snapshot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、ファイルは、スナップショットが作成されたときの状態のままであることが保証されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読み取り専用フラグは手動で制御することもできます。これはどのサブボリュームでも機能します。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs property get /path/to/subvol ro<font></font>
btrfs property set /path/to/subvol ro true</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショットのプロパティを確認すると、入力された</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親UUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドが表示されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume show /path/to/snapshot<font></font>
<font></font>
Name: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; subx<font></font>
UUID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d08612d8-596a-11e9-8647-d663bd873d93<font></font>
Parent UUID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 09af45e8-d2b2-b342-8a92-fa270ac82d0a<font></font>
Received UUID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<font></font>
Creation time:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2019-03-23 17:59:28 +0100<font></font>
Subvolume ID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 269<font></font>
Generation: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39<font></font>
Gen at creation:&nbsp; &nbsp; &nbsp; &nbsp; 35<font></font>
Parent ID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 260<font></font>
Top level ID: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 260<font></font>
Flags:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<font></font>
Snapshot(s):</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショット操作の重要な機能は、再帰的でないことです。スナップショットにネストされたサブボリュームの代わりに、空のディレクトリが作成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルシステムにはサブウーファー「sub0」があり、その中にサブウーファー</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subA</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dirB</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリがあり</font><font style="vertical-align: inherit;">ます。それぞれの内部には</font><i><font style="vertical-align: inherit;">、</font></i><font style="vertical-align: inherit;">それぞれ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fileA</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fileBがあり</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショットを撮ります：</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot sub0 snap0</code></pre><br>
<img src="https://habrastorage.org/webt/cf/or/w-/cforw-vhzoma9iub2hcyejkbh84.png"><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成されたsnap0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スナップショット</font><font style="vertical-align: inherit;">は、その親のすべてのファイルとディレクトリを継承しますが、subA </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はスナップショット内に表示されません。</font><font style="vertical-align: inherit;">代わりに、空のディレクトリのみがスナップショットに表示されます。</font><font style="vertical-align: inherit;">subA </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容は</font><font style="vertical-align: inherit;">継承されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方で、これは適切です。特定のサブボリュームからスナップショットを削除します。ネストされたスナップショットはすべて、私たちには関係ありません。</font><font style="vertical-align: inherit;">一方、再帰的なスナップショットが必要な場合、btrfsはこの問題を解決しません。</font><font style="vertical-align: inherit;">回避策を探す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の回避策は、スナップショットが読み取り専用フラグなしで削除されたという事実に基づいているため、状況を非常に簡単に修正できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スナップショットから余分なディレクトリを削除する</font></font><br>
<br>
<pre><code class="plaintext hljs">rmdir snap0/subA</code></pre><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネストされたサブボリュームからスナップショットを削除する</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot sub0/subA snap0/subA</code></pre><br>
</li>
</ul><br>
<img src="https://habrastorage.org/webt/ja/u3/fy/jau3fyzmzjxzxweajh-tmjld-iw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショットが「読み取り専用」フラグで削除された場合、上記のオプションは機能しません。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">snap0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたはどちらのディレクトリを削除することも、スナップショットを配置することができます。</font><font style="vertical-align: inherit;">オプションは1つだけです。snap0 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファーの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">近くにスナップショットを配置します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot sub0/subA snapA</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、マウント</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAPAを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スナップショット内</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">snap0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このためのディレクトリがすでに存在しています：</font></font><br>
<br>
<pre><code class="plaintext hljs">mount -o subvol=snapA snap0/subA</code></pre><br>
<img src="https://habrastorage.org/webt/mu/-w/nn/mu-wnnj0jiyyinnxokz08nuipag.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いずれの場合でも、再帰的なスナップショットはすべて、異なる操作で異なる時間に撮影されることを理解することが重要です。</font><font style="vertical-align: inherit;">いくつかのサブボリュームからのスナップショットのアトミックな削除についての話はありません。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き込み時にコピー</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブウーファーとCoWアプローチについて少し。サブボリュームがファイルシステム上に存在し、ファイルがその中に配置されていると想像してください（理想的な場合-ファイルは断片化されていません）。さらに、スナップショットがサブウォリーから削除されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/yo/sl/hgyoslduv5eeenpopaqu3dk7qyw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいサブボリューム（スナップショット）が、元のサブボリュームとまったく同じ内容でファイルシステムに表示されます。スナップショットの作成プロセスはほぼ瞬時に行われます-ファイル自体のデータはコピーされません。代わりに、追加のメタデータが作成され、親サブボリュームと共にスナップショットがファイルの所有者になります。実際、ディスクにはファイルが1つしかありませんでしたが、現在はサブウーファーとスナップショットの両方に属しています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでサブボリューム内のファイルを変更しても、スナップショット内のファイルには影響しません。スナップショットの作成時に読み取り専用フラグが設定されていなかった場合は、スナップショット内のファイルも変更できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7n/1e/0t/7n1e0tkdlxsuqkpjmtinix0yiys.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
技術的には、ファイルを変更すると、これらの変更のみが記録されます。そのため、ソースファイルは、元のファイルと変更されたファイルを区別するいくつかのデルタとディスクに保存されます。サブボリュームの1つを削除すると（2番目はスナップショットを意味します）、誰も使用しなくなった余分なデータはディスクから消去され、現在のバージョンのファイルのみがディスクに残ります（残りのサブボリュームの観点から）。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さな発言</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：削除すると、サブボリュームはユーザーの目からすぐに消え、ユーティリティは制御をターミナルに戻しますが、ディスク上のデータはバックグラウンドプロセスによってしばらくクリーンアップされます。</font><font style="vertical-align: inherit;">つまり、通常のディレクトリの削除とは異なり、削除操作が実際に完了するのを待つ必要はありません。</font><font style="vertical-align: inherit;">このプロセスと同期してその完了を待つ必要がある場合は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出すときに</font><font style="vertical-align: inherit;">キー</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">でき</font><font style="vertical-align: inherit;">ます</font></font><code>--commit-after</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">キー</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出されるbtrfs subvolume list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドは</font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザーによって削除され、現在ディスクから削除されているサブボリュームのリストを表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、btrfsを使用すると、スナップショットに頼ることなく、ファイルシステム上のファイルのクローンを作成できます。</font><font style="vertical-align: inherit;">これは、キーを使用して定期的にコピーすることによって行われます</font></font><code>--reflink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="plaintext hljs">cp -ax --reflink=always /original/file /copied/file</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キー</font></font><code>reflink=always</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、コピー時にCoWメカニズムを使用することをファイルシステムに通知します。ファイルをコピーした後は互いに独立して変更できるため、スナップショットを作成した後と同じ動作になります。それでは、なぜサブボーラムが必要なのでしょうか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsのサブトーラムは、データセット全体の高レベルの制御ツールの役割を果たします。最初に、サブボリュームのすべてのデータからのアトミックスナップショットの削除です（--reflinkアトミック性はファイルレベルでのみです）。次に、それが誰から継承されているかを確認できます。 、またはデータセットを以前のバージョンにすばやく「ロールバック」します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、btrfsは、サブボリュームをこれらの状態を管理する高レベルの手段として使用して、必要な時点でファイルの状態をキャプチャする機能を提供します。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームの回復</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
広大な範囲では、「サブウーファーを持っている、スナップショットを持っている、どうやって反転させるのか？」という疑問がしばしば生じます。</font><font style="vertical-align: inherit;">このアプローチはbtrfsには適用できません。</font><font style="vertical-align: inherit;">「サブウーリーをロールバック」する可能性はありません。</font><font style="vertical-align: inherit;">代わりに、btrfsはsubwollyをそのスナップショットに置き換える戦略を提供します。</font><font style="vertical-align: inherit;">実際、スナップショット自体がrevertで取得したいこのオブジェクトである場合、なぜ何かを元に戻すのか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオを想像してみてください。btrfsには、データベースのファイルが配置されているサブボリュームがあります（まあ、または他の重要なデータ）。</font><font style="vertical-align: inherit;">スナップショットは定期的にこのサブボリュームから削除され、ある時点でデータをロールバックする必要があります。</font><font style="vertical-align: inherit;">この場合、サブウォームを削除して、代わりにサブウォームから取得したスナップショットの使用を開始するか、このデータも損なわないようにする場合は、スナップショットから別のスナップショットを削除します。</font><font style="vertical-align: inherit;">元のサブワールドがマウントされておらず、通常のディレクトリとして使用されていなかった場合は、削除するか移動または名前を変更する必要があり、その場所にスナップショットを配置する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sn/os/od/snosodoezxac3a-2s7xzmpqa-js.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールでは、次のようになります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subwollyの名前を変更する</font></font><br>
<br>
<pre><code class="plaintext hljs">mv the_subvolume the_subvol.old</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼のスナップショットをサブボリュームの代わりに置きます</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot the_snapshot the_subvolume</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームがマウントされ、マウントポイントを介して使用された場合は、サブボリュームをアンマウントし、代わりにスナップショットをマウントするだけで十分です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4z/mi/sw/4zmisws4w5keyk7mhsr6eaav-ri.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファーをアンマウントする</font></font><br>
<br>
<pre><code class="plaintext hljs">umount /mnt/</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に残っているデータを損なわないように、スナップショットのスナップショットを作成できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume snapshot /path/to/snapshot /path/to/snapshot_copy</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マウントスナップショット：</font></font><br>
<br>
<pre><code class="plaintext hljs">mount -o subvol=path/to/snapshot_copy /mnt</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完全を期すために、もう一度やり直しますが、少し異なります。</font><font style="vertical-align: inherit;">変更が発生するサブボリュームは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチ</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gh/pt/m7/ghptm7ykmordfcur4bdddehng6c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スナップショットを作成すると、ディスク上のファイルの状態が固定されます。</font><font style="vertical-align: inherit;">これ以降、スナップショットは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチのブランチです</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">さらに変更して</font><font style="vertical-align: inherit;">も、スナップショットに</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">何の影響もありません。</font><font style="vertical-align: inherit;">スナップショットへのロールバックとは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メイン</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチの使用を停止し、</font><font style="vertical-align: inherit;">ブランチに完全に切り替えることを</font><font style="vertical-align: inherit;">意味します</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチ</font><font style="vertical-align: inherit;">は不要な場合は削除できます。</font><font style="vertical-align: inherit;">したがって、btrfsは実際にはバージョン管理システムですが、ブランチをマージして戻す機能はありません。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルシステムツリー</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsの使用に関連する明らかなポイントの1つは、システムデータをサブボリュームに分割する方法です。もちろん、この問題に対する「正しい」アプローチはありません。ただし、サブボリュームの構造を編成する方法は3つあります。それは、ネストされて混合されたフラット構造です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラット構造とは、サブボリュームがルートサブボリュームのフラットリストに配置されることを意味します。たとえば、ファイルシステムのルート（これを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼びます</font><font style="vertical-align: inherit;">）、ユーザーの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホーム</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリ、サイト</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / wwwの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あるディレクトリ</font><i><font style="vertical-align: inherit;">、</font></i><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / databaseなどにあるデータベース</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を個別のサブボリュームとして選択でき</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/yp/ma/gaypma96_mzvjtlwjyh3atw5qgm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
便宜上、一部のサブボリュームは、たとえば</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var / www</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームの場合のように、ディレクトリに配置できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法では、すべてのサブボリュームをマウントする必要があります。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルート</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブ</font><font style="vertical-align: inherit;">マウントポイント/、それがディレクトリ含まれている内部で持っている必要があり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、家庭</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VARを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">/ homeに</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルート</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">マウントした後、</font><font style="vertical-align: inherit;">sabvolyum </font><i><font style="vertical-align: inherit;">homeを</font></i><font style="vertical-align: inherit;">インストール</font><font style="vertical-align: inherit;">し、</font><i><font style="vertical-align: inherit;">/ var / www</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">/ var /</font></i><font style="vertical-align: inherit;"> databasに</font><font style="vertical-align: inherit;">はそれぞれ</font><font style="vertical-align: inherit;">e-sabvolyumy </font><i><font style="vertical-align: inherit;">var / www</font></i><font style="vertical-align: inherit;">および</font><i><font style="vertical-align: inherit;">データベースを</font></i><font style="vertical-align: inherit;">インストールする必要が</font><font style="vertical-align: inherit;">あり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、btrfs-subvolumeのツリーは、OSの仮想ファイルシステムで任意に表示できますが、それで十分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーはマウントされたサブボリュームのみを表示できます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファーの交換は簡単です（一方をマウント解除し、もう一方をマウント）。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファーの取り外しが簡単。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイナス：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マウントされている場所で混乱するのは簡単ですが、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームごとにfstabにエントリが必要です。スナップショットへの「ロールバック」がある場合は、fstabの対応するエントリも更新する必要があります。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サブボリュームの入れ子構造は、一部のディレクトリではなく、サブボリュームの単純な使用を示唆しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v2/41/e5/v241e5bwrguy3_f76frc2k3ygwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、ルートサブボリュームに加えて、マウントする必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長所：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのサブボリュームが表示され、構造が認識しやすく、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再び何かをマウントする必要はありません。すべてが「通常の」ファイルシステムと同じです。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイナス：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのサブボリュームが表示されます。おそらくユーザーから一部を非表示にしたいのですが、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブウーファーの取り外し/交換は困難です（この理由は、サブウルフがネストされているためです）。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、3番目のアプローチは混合です。</font><font style="vertical-align: inherit;">最初の2つを組み合わせて、両方のメリットを最大限に引き出します。</font><font style="vertical-align: inherit;">ただし、この特定のアプローチでは、fstabのエントリが非常に多く、構造が複雑で変更が困難で混乱を招く可能性があります。</font><font style="vertical-align: inherit;">それはすべて</font><font style="vertical-align: inherit;">システム管理者の</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">飲酒</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">依存し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bv/qw/zv/bvqwzvl0wqspgvlaknnd3l9eyqo.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディスクバランスの追加/削除</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsは優れた機能性を誇ります。ファイルシステムの操作中に直接「ホット」ブロックデバイスを「追加」する機能です。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs device add /path/to/device /path/to/btrfs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または削除：</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs device remove /path/to/device /path/to/btrfs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、1回の追加/削除の呼び出しでは、複数のディスクを指定できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでも、指定されたパスは、コマンドが適用されるbtrfsのサブボリュームへのパスです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsの制御下にあるブロックデバイスの数とブロックを確認してみましょう。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs filesystem show /path/to/btrfs<font></font>
<font></font>
Label: none&nbsp; uuid: 52961dda-df84-4e2d-9727-e93e7738df81<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total devices 2 FS bytes used 192.00KiB<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;devid&nbsp; &nbsp; 1 size 20.00GiB used 132.00MiB path /dev/sdc<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;devid&nbsp; &nbsp; 2 size 50.00GiB used 0.00B path /dev/sdd<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用済み</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの</font><i><font style="vertical-align: inherit;">0.00B</font></i><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">追加されたディスクが空であることを示しています。</font><font style="vertical-align: inherit;">記録プロファイルに従ってデータを入力するには、以下のバランスを取る必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs balance start /path/to/btrfs</code></pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">balance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンド</font><font style="vertical-align: inherit;">は、選択した記録プロファイルに従って、ディスク上のデータを再</font><b><font style="vertical-align: inherit;">分散し</font></b><font style="vertical-align: inherit;">ます。たとえば、RAID1の場合、バランスは元のデバイスからのデータのクローン作成につながり、RAID0の場合は、2つのディスク間でのデータのより均等な分散につながります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バランスの結果として、その前にディスクにボイドがあった場合、ディスク上のデータはより密に書き込まれます。最適化が行われます。ただし、これは厳密には「その」最適化ではないことを理解することが重要です。この場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">balance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">は論理的な内容を調べず、データブロックのみを操作します。彼女は、ファイルがディスク上に広がっていることに注意を払いません。代わりに</font><b><font style="vertical-align: inherit;">バランスを</font></b><font style="vertical-align: inherit;">取る</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ある場所から別の場所にデータブロックを転送します。それら。バランスを取るために断片化されたファイルは、その後も断片化されたままになります。だが！データブロックのレベルでの断片化は引き続き減少し、これを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
混乱を避けるために、これを考えてみましょう。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バランス</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作</font><font style="vertical-align: inherit;">は、データブロックのレベルで断片化を減らしますが、ファイルの断片化には影響しません。</font><b><font style="vertical-align: inherit;">バランス</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンド</font><font style="vertical-align: inherit;">は、記録プロファイルを変更する機能</font><font style="vertical-align: inherit;">も</font><font style="vertical-align: inherit;">提供します。たとえば、ディスクでDUPプロファイルが使用され、ディスクを追加した後、完全なRAID1にすることを決定しました。これを行うには、フィルターを使用します</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code>convert</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">btrfs balance start -dconvert=raid1 -mconvert=raid1 /path/to/btrfs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オプション</font></font><code>-dconvert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">オプションを使用して</font><font style="vertical-align: inherit;">、</font></font><code>-mconvert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいレコードプロファイルがデータとメタデータにそれぞれ設定されます。</font><font style="vertical-align: inherit;">システムデータの書き込みプロファイルを変更するように設計された-sconvertオプションもありますが、-f（--force）スイッチを追加して、操作を強制的に完了する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、フィルターの主な目的は、バランス操作のルールを設定することです。どのブロックを処理し、どのブロックを操作しないかです。</font><font style="vertical-align: inherit;">したがって、たとえば、特定の記録プロファイル（フィルタープロファイル）で記録されたブロックのみに影響したり、特定のパーセンテージを超えて使用されたブロック（使用フィルター）に影響を与えたり、特定のディスクに関連するブロックのグループのみ（影響フィルター）に影響したりできます。</font><font style="vertical-align: inherit;">ちなみに、それらはまだ組み合わせることができます。</font><font style="vertical-align: inherit;">一般に、フィルターの機能は非常に広範囲であり、主にデータの選択的バランスを実行するために必要です。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">断片化</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、btrfsは、そのアーキテクチャーにより、フラグメンテーションなどの現象の影響を非常に受けやすくなっています。</font><font style="vertical-align: inherit;">実際のところ、データは常にディスク上の新しい場所に書き込まれます。</font><font style="vertical-align: inherit;">ファイルを読み取り、データを何もせずに同じファイルに書き戻しても、データはディスク上の新しい領域に移動します。</font><font style="vertical-align: inherit;">ファイル内のデータを部分的にしか更新しない場合も同じことが起こります-変​​更はディスク上の新しい領域に書き込まれます。</font><font style="vertical-align: inherit;">したがって、頻繁な変更はファイルを非常に強く断片化し、一般的なケースでは、複数のディスクにわたる断片の「分散」を増加させます。</font><font style="vertical-align: inherit;">これにより、CPUの負荷が増加し、不要なメモリ消費が発生します。</font><font style="vertical-align: inherit;">最も断片化されているのは、データベースと仮想マシンイメージです。</font><b><font style="vertical-align: inherit;">filefrag</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーティリティを使用してファイルの断片化を評価できます</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （btrfs-progsには含まれていません）。&nbsp;</font></font><br>
<br>
<pre><code class="plaintext hljs">filefrag /path/to/your/file</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルの保存に使用されるエクステントの数が表示されます。</font><font style="vertical-align: inherit;">つまり、関連するエクステントが少ないほど、ファイルの断片化は少なくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsでのフラグメンテーションに対抗するには、デフラグとフラグの2つの方法があります</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最適化は、再帰的に、単一のファイルまたはサブボリューム/ディレクトリに適用できます。</font><font style="vertical-align: inherit;">コマンドは次のとおりです。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs filesystem defragment /path/to/file/or/dir</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このチームが常に期待される結果につながるとは限らないと言っておかなければなりません。デフラグ後の小さな、わずかに断片化されたファイル（10-20エクステント）は、さらに多くのパーツに分解できます。さらに、カーネルの一部のバージョンでのbtrfsデフラグは、ファイルの重複排除を解除し、それらを実際の物理コピーにします。それら。物理レベルのスナップショットは完全なコピーになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
断片化に対抗する2番目の方法は、ファイル属性を使用することです</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">chattr +C /path/to/file</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この属性</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、新規または空のファイルにのみ設定できます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コピーオンライト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メカニズムを無効にする</font><font style="vertical-align: inherit;">ため、btrfsはファイルのコンテンツを更新するときに常に固定ディスク領域で動作し、既存のファイル（物理レベル）にデータを上書きします。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nocow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のマイナス</font><i><font style="vertical-align: inherit;">点</font></i><font style="vertical-align: inherit;"> -このファイルのチェックサムのチェックも無効にします。つまり、牛はいない-チェックサムはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、手動で属性を設定します</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各ファイルは感謝の意のないタスクです。ディレクトリ/サブボリュームのこのフラグが設定されている場合、その中に作成されたすべての新しいファイルは自動的にフラグを継承します。同じことが、作成されたネストされたディレクトリにも当てはまります。現時点で属性がオンになっている場合、データがすでにディレクトリに存在していても、影響はありません。属性</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、新しいファイルまたは空のファイルにのみ設定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグを自動的に設定する別の方法</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、オプションを使用してファイルシステムをマウントすることです</font></font><code>nodatacow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">mount -o subvol=path/to/subvol,nodatacow /dev/sdXX /path/to/mountpoint</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションを使用すると、オプションが自動的に接続さ</font></font><code>nodatasum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れるため、新しく作成されたファイルのチェックサムは計算されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつものように、ニュアンスがあります</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">オプション付きのサブウーファーを1つだけ取り付けることはできません</font><font style="vertical-align: inherit;">。すべてのサブボリュームにオプション</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があるか、またはありません。すべては最初にマウントされたサブボリュームによって決定されます。オプションが指定されていた場合</font></font><code>nodatacow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、以降のすべてのマウントではこのオプションが自動的に使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルにフラグを付け、</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このファイルが配置されているサブボリュームからスナップショットを削除すると、</font><font style="vertical-align: inherit;">明らかな瞬間が発生します</font><font style="vertical-align: inherit;">。この場合、</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のサブボリュームが更新されたデータブロックを参照していると</font><font style="vertical-align: inherit;">、btrfsはフラグを無視し</font><font style="vertical-align: inherit;">ます。したがって、フラグにもかかわらず</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ちなみに、ファイルはスナップショットでもそれを継承します）、ファイルへの変更はディスク上の新しい領域に行き、ファイルは再び断片化されます。</font><font style="vertical-align: inherit;">ファイル内のデータブロックが数回更新されると、最初にデータブロックがディスク上の新しい領域に分類され、その後のエントリで、この新しい領域の「所定の場所」で更新されます。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリックと失敗</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfs-progsを使用する場合は、コマンドの完全な名前を省略できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs sub cre = btrfs subvolume create </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドを一意に決定する最初の文字の一致だけで十分です。</font></font><br>
<br>
<pre><code class="plaintext hljs">su = subvolume,<font></font>
fi = filesystem,<font></font>
ba = balance,<font></font>
de = device;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原理は明確だと思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、btrfsはディレクトリのスナップショットを作成できませんが、回避策があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サブボリュームを作成する</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfs subvolume create ./subvol</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディレクトリからサブボリュームにファイルをコピーします。</font></font><br>
<br>
<pre><code class="plaintext hljs">cp -ax --reflink=always your/dir/. ./subvol</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キー</font></font><code>reflink=always</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はCoWメカニズムを使用します。</font><font style="vertical-align: inherit;">データはコピーされませんが、データへのリンクは低レベルのbtrfsで作成されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これで、サブワールドにディレクトリ内にあったすべてのファイルが含まれ、そこからスナップショットを削除できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
属性を</font></font><code>nocow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既存のデータファイルに設定</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">ことはできません。</font><font style="vertical-align: inherit;">ただし、次の方法を使用できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空のファイルを作成する</font></font><br>
<br>
<pre><code class="plaintext hljs">touch nocowfile</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼にフラグを立てる </font></font><code>nocow</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいファイルにディスク容量を割り当てる</font></font><br>
<br>
<pre><code class="plaintext hljs">fallocate -l10g nocowfile</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;既存のファイルの内容をにコピーする </font></font><br>
<br>
<pre><code class="plaintext hljs">cp -v oldcowfile nocowfile</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsがスペースを使い果たした場合、ファイルを削除しても、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「デバイスにスペースがありません」</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラーが発生する可能性が</font><i><font style="vertical-align: inherit;">あり</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">解決策として、サイズが1GB以上の一時ドライブをbtrfsに接続することをお勧めします。</font><font style="vertical-align: inherit;">次に、データをクリーンアップします。</font><font style="vertical-align: inherit;">次に、一時ドライブを取り外します。</font><font style="vertical-align: inherit;">書き込み</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
操作</font><font style="vertical-align: inherit;">を指定せずに呼び出された</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分散</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作は</font><font style="vertical-align: inherit;">、それらを暗黙的に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raid1に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ちなみに、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gotchasの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページには何が書かれていますか</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き込みプロファイルを使用するbtrfsにディスクを追加した後に発生します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">btrfsで単一のドライブをフォーマットする</font><font style="vertical-align: inherit;">と、メタデータとシステムデータにデフォルトの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロファイルが使用されることを思い出してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく最も重要な</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsを使用して低レベルのブロックデバイスクローンを作成しないでください。一部の操作（ほとんどの場合、マウント時）では、btrfsは「スマート」ファイルシステムであるため、ブロックデバイス上のシステムデータを再読み込みして、ファイルシステムのすべての部分を検出します。同じUUIDを持つ2つのブロックデバイスが検索プロセスで見つかった場合、btrfsはそれらを同じインスタンスの一部として認識します。同時にこれらの2つのデバイスが元のデバイスとそのクローンであることが判明した場合、ドライバーをマウントしただけでファイルシステムがどのように機能するかがわかりますが、これで良い結果が得られるわけではありません。最悪の場合、データが破壊され、元に戻せなくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
低レベルの方法でbtrfsを使用してディスクのクローンを本当に作成したい場合は、非常に注意する必要があります。</font><font style="vertical-align: inherit;">一般に、クローンは、オリジナルがシステム内にある間はOSカーネルからブロックデバイスとして認識されるべきではなく、その逆も同様です。</font><font style="vertical-align: inherit;">この条件を提供すると、クローンのUUIDを変更できます（まあ、またはオリジナル、ここではオプションです）。</font><b><font style="vertical-align: inherit;">btrfs-progs</font></b><font style="vertical-align: inherit;">パッケージに付属する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfstune</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が役立ちます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">btrfstune -u /path/to/device</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また</font><font style="vertical-align: inherit;">、「スマート」ユーティリティである</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btrfstuneは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ディスクだけでなくファイルシステム全体のUUIDを変更します。</font><font style="vertical-align: inherit;">つまり、呼び出されると、ファイルシステムに関連するすべてのデバイスのUUIDを置き換えるために、すべてのブロックデバイスを読み取ります。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論の代わりに</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点であなたが何も理解していない場合-これは正常です。 Btrfsは重要なものであり、すぐには機能しません。私が彼女を理解したように思えるたびに、彼女は驚きを投げ、彼女に既存のものを再考させました。現時点ですべてを理解しているとは言えません。自分の経験に基づいてすでに書いていますが、執筆の過程で何か新しいものを見つけました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
btrfsを習得するプロセスを、手続き型プログラミングスタイルからオブジェクト指向のスタイルへの移行と比較します。第一印象は「すごい、すごい」ですが、その後、クラスにラップされた手続き型コードを執筆し続けます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事では、私は水を注がないようにしようとしました-事件についてのすべてを書くために。</font><font style="vertical-align: inherit;">これにもかかわらず、それはかなり膨大なことが判明しました。</font><font style="vertical-align: inherit;">しかし、すべてを伝えることは不可能でした。btrfsについては、まだ記述および記述できます。</font><font style="vertical-align: inherit;">この記事は氷山の一角にすぎません。</font><font style="vertical-align: inherit;">最初は、その哲学を理解し、それを使い始めることです。</font><font style="vertical-align: inherit;">そして今が終わりです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後までお読みいただきありがとうございます。</font><font style="vertical-align: inherit;">疲れないように。</font><font style="vertical-align: inherit;">あなたが知りたい他に何があるかについてのコメントを書いてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
皆さん、バックアップをとってください。</font><font style="vertical-align: inherit;">そして、彼らが便利にならないようにしましょう。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja458228/index.html">なぜ仮想関数が必要なのか</a></li>
<li><a href="../ja458240/index.html">人工知能、ドローン、カメラが道路や橋の安全を確保する方法</a></li>
<li><a href="../ja458242/index.html">C ++ 20の新しい宇宙船オペレーター</a></li>
<li><a href="../ja458244/index.html">公衆Wi-Fiネットワークを安全に使用するために知っておくべきことの無限でとんでもないリスト</a></li>
<li><a href="../ja458246/index.html">人生の偶然の偶然、またはトラクターの工場でケーキが提示されたことが判明した方法</a></li>
<li><a href="../ja458252/index.html">超長電波望遠鏡の数学モデル</a></li>
<li><a href="../ja458256/index.html">洗脳の時間じゃないですか？</a></li>
<li><a href="../ja458260/index.html">Javaアプリケーション用のDockerイメージを最適化する別の方法</a></li>
<li><a href="../ja458262/index.html">オンライン会議室デザイナー-最適なビデオ会議ソリューションの選択</a></li>
<li><a href="../ja458264/index.html">自己文書化コードの10の原則</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>