<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ° ğŸ¤ ğŸ· SObjectizer-5.6.0ï¼šã•ã‚‰ã«æˆé•·ã™ã‚‹ãŸã‚ã«ãƒ©ã‚¤ãƒ–ã‚«ãƒƒãƒˆ ğŸ˜¿ ğŸ¤²ğŸ¾ ğŸ”•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="3æ—¥ç›®ã«ã€SObjectizerã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸï¼š5.6.0ã€‚ãã®ä¸»ãªç‰¹å¾´ã¯ã€4å¹´åŠã®é–“ã«ç€å®Ÿã«é–‹ç™ºã•ã‚Œã¦ããŸä»¥å‰ã®å®‰å®šãƒ–ãƒ©ãƒ³ãƒ5.5ã¨ã®äº’æ›æ€§ã®æ‹’å¦ã§ã™ã€‚
 

SObjectizer-5ã®æ“ä½œã®åŸºæœ¬åŸç†ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€å”åŠ›ã€ãƒ‡ã‚£ã‚¹ãƒ‘...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SObjectizer-5.6.0ï¼šã•ã‚‰ã«æˆé•·ã™ã‚‹ãŸã‚ã«ãƒ©ã‚¤ãƒ–ã‚«ãƒƒãƒˆ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453256/"><p><img src="https://habrastorage.org/webt/vp/ah/jx/vpahjx-dkpsauwtfzyeiktnsfp4.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3æ—¥ç›®ã«ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SObjectizerã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ï¼š5.6.0</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã®ä¸»ãªç‰¹å¾´ã¯ã€4å¹´åŠã®é–“ã«ç€å®Ÿã«é–‹ç™ºã•ã‚Œã¦ããŸä»¥å‰ã®å®‰å®šãƒ–ãƒ©ãƒ³ãƒ5.5ã¨ã®äº’æ›æ€§ã®æ‹’å¦ã§ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SObjectizer-5ã®æ“ä½œã®åŸºæœ¬åŸç†ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€å”åŠ›ã€ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã¯ã¾ã ç§ãŸã¡ã¨ä¸€ç·’ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ä½•ã‹ãŒã²ã©ãå¤‰ã‚ã£ãŸã€ä½•ã‹ãŒä¸€èˆ¬ã«æ¨ã¦ã‚‰ã‚ŒãŸã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€SO-5.6.0ã‚’å–å¾—ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã ã‘ã§ã¯å¤±æ•—ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½•ã‹ã‚’æ›¸ãç›´ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½•ã‹ã‚’å†è¨­è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªãœæ•°å¹´é–“äº’æ›æ€§ã‚’ç®¡ç†ã—ã€ãã‚Œã‹ã‚‰ã™ã¹ã¦ã‚’å–ã‚Šã€å£Šã™ã“ã¨ã«ã—ãŸã®ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ãã—ã¦ã€æœ€ã‚‚å¾¹åº•çš„ã«å£Šã‚ŒãŸã®ã¯ä½•ã§ã™ã‹ï¼Ÿ</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã«ã¤ã„ã¦ã¯ã€ã“ã®è¨˜äº‹ã§èª¬æ˜ã—ã¾ã™ã€‚</font></font></p><br>
<h1 id="zachem-voobsche-potrebovalos-chto-to-lomat"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªãœä½•ã‹ã‚’å£Šã™å¿…è¦ãŒã‚ã£ãŸã®ã§ã™ã‹ï¼Ÿ</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã¦ã‚‚ç°¡å˜ã§ã™ã€‚</font></font></p><a name="habracut"></a><br>
<p>SObjectizer-5.5            ,    ,              .      -   SO-5.5    .   -   "     ?"     .</p><br>
<p>    â€”    SObjectizer-.</p><br>
<p>  â€”  ,        ++ .  5.5   2014,     ,   , gcc-4.8  MSVS2013.                 C++.</p><br>
<p>     ,  , " ".  , -          C++   " ".</p><br>
<p>  , " " . -    " "  .     ,       C++98,        .           .         - .           : ++17.</p><br>
<p>,      , -   C++17 â€”     ,       .</p><br>
<p>  ,     .     SObjectizer-   ,    SObjectizer  -  , C++17    " ".       ,    C++11.</p><br>
<p> ,  ,        C++11,       SObjectizer-   C++17.   ,    SObjectizer          .</p><br>
<h1 id="chto-serezno-pomenyalos-v-sobjectizer-56">    SObjectizer-5.6?</h1><br>
<p>      ,   .</p><br>
<h2 id="u-kooperaciy-agentov-bolshe-net-strokovyh-imen">      </h2><br>
<h3 id="problema"></h3><br>
<p>   SObjectizer-5 ,         .     SObjectizer-    ,  SObjectizer-.</p><br>
<p>, SObjectizer-      .     .        ..,  ..</p><br>
<p>      SObjectzer-5   :    ,  mutex-.    mutex ,    ,    ..     ,   mutex .  ,     /   ,   -      ,          . -      .</p><br>
<p>             .</p><br>
<h3 id="reshenie"></h3><br>
<p>      .</p><br>
<p>-,   ,       ,      . ,  , ..     ,       mutex-.</p><br>
<p>-,        -  SObjectizer- .</p><br>
<p>           .   SObjectizer-   ,  <code>coop_handle</code>, ..  ,     ,      <code>std::weak_ptr</code>.</p><br>
<p>SObjectizer  <code>coop_handle</code>   :</p><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> coop = env.make_coop();<font></font>
... <span class="hljs-comment">//    .</span>
<span class="hljs-keyword">auto</span> coop_id = env.register_coop(<span class="hljs-built_in">std</span>::move(coop)); <span class="hljs-comment">// .</span>
<span class="hljs-comment">//   coop_id    .</span></code></pre><br>
<p>      :</p><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> coop = env.make_coop();<font></font>
... <span class="hljs-comment">//    .</span>
<span class="hljs-keyword">auto</span> coop_id = env.register_coop(<span class="hljs-built_in">std</span>::move(coop)); <span class="hljs-comment">// .</span>
<span class="hljs-comment">//   coop_id    .</span>
... <span class="hljs-comment">// - .</span>
<span class="hljs-comment">// ,     .</span>
<span class="hljs-comment">//       .</span>
env.deregister_coop(coop_id, ...);</code></pre><br>
<p>        -:</p><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   .</span>
<span class="hljs-keyword">auto</span> parent = env.make_coop();<font></font>
... <span class="hljs-comment">//  parent .</span>
<span class="hljs-keyword">auto</span> parent_id = env.register_coop(<span class="hljs-built_in">std</span>::move(parent)); <span class="hljs-comment">//  .</span><font></font>
...<font></font>
<span class="hljs-comment">//      ,    .</span>
<span class="hljs-keyword">auto</span> child = env.make_coop(parent_id);<font></font>
...</code></pre><br>
<p>     SObjectizer Environment    .    5.5      ,          . ..           root-.</p><br>
<p>     <code>register_coop</code>  <code>deregister_coop</code>  :                 .  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>,      ,      Ubuntu 16.04  GCC-7.3:</p><br>
<pre><code class="plaintext hljs">_test.bench.so_5.parallel_parent_child -r 4 -l 7 -s 5<font></font>
Configuration: roots: 4, levels: 7, level-size: 5<font></font>
parallel_parent_child: 15.69s<font></font>
488280<font></font>
488280<font></font>
488280<font></font>
488280<font></font>
Total: 1953120</code></pre><br>
<p>..  5.6.0    2M   ~15.5 .</p><br>
<p>   5.5.24.4,    5.5   :</p><br>
<pre><code class="plaintext hljs">_test.bench.so_5.parallel_parent_child -r 4 -l 7 -s 5<font></font>
Configuration: roots: 4, levels: 7, level-size: 5<font></font>
parallel_parent_child: 46.856s<font></font>
488280<font></font>
488280<font></font>
488280<font></font>
488280<font></font>
Total: 1953120</code></pre><br>
<p>   ,      .</p><br>
<h2 id="ostalsya-vsego-odin-vid-dispetcherov">    </h2><br>
<p>      SObjectizer-.   ,        .     , ,     SObjectizer-.</p><br>
<p>,     ,     ,      SObjectizer-5.5       ,  .   . ,  -.</p><br>
<p>  ,   ,        SObjectizer-:</p><br>
<pre><code class="cpp hljs">so_5::launch(<font></font>
    []( so_5::<span class="hljs-keyword">environment_t</span> &amp; env ) { <span class="hljs-comment">/* -   */</span> },
    <span class="hljs-comment">//    SObjectizer-.</span>
    []( so_5::<span class="hljs-keyword">environment_params_t</span> &amp; params ) {<font></font>
        p.add_named_dispatcher(<span class="hljs-string">"active_obj"</span>, so_5::disp::active_obj::create_disp());<font></font>
        p.add_named_dispatcher(<span class="hljs-string">"shutdowner"</span>, so_5::disp::active_obj::create_disp());<font></font>
        p.add_named_dispatcher(<span class="hljs-string">"groups"</span>, so_5::disp::active_group::create_disp());<font></font>
        ...<font></font>
    } );</code></pre><br>
<p>      â€” ,  ,    .</p><br>
<p> ,          SObjectizer-    .    <code>add_dispatcher_if_not_exists</code>,     ,    ,    :</p><br>
<pre><code class="cpp hljs">so_5::launch(<font></font>
    []( so_5::<span class="hljs-keyword">environment_t</span> &amp; env ) {<font></font>
        ... <span class="hljs-comment">// - .</span>
        <span class="hljs-comment">//     .</span>
        env.add_dispatcher_if_not_exists( <span class="hljs-string">"extra_dispatcher"</span>,<font></font>
            []{ <span class="hljs-keyword">return</span> so_5::disp::active_obj::create_disp(); } );<font></font>
    },<font></font>
    <span class="hljs-comment">//    SObjectizer-.</span>
    []( so_5::<span class="hljs-keyword">environment_params_t</span> &amp; params ) {...} );</code></pre><br>
<p>   .      .          :</p><br>
<pre><code class="cpp hljs">so_5::launch(<font></font>
    []( so_5::<span class="hljs-keyword">environment_t</span> &amp; env ) {<font></font>
        ... <span class="hljs-comment">// - .</span>
        <span class="hljs-comment">//     .</span>
        env.add_dispatcher_if_not_exists( <span class="hljs-string">"extra_dispatcher"</span>,<font></font>
            []{ <span class="hljs-keyword">return</span> so_5::disp::active_obj::create_disp(); } );
        <span class="hljs-comment">//        </span>
        <span class="hljs-comment">//    .</span>
        <span class="hljs-keyword">auto</span> coop = env.create_coop( <span class="hljs-string">"ping_pong"</span>,
            <span class="hljs-comment">//     extra_dispatcher.</span>
            so_5::disp::active_obj::create_disp_binder( <span class="hljs-string">"extra_dispatcher"</span> ) );<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_pinger_t</span> &gt;(...);<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_ponger_t</span> &gt;(...);<font></font>
        ...<font></font>
    },<font></font>
    <span class="hljs-comment">//    SObjectizer-.</span>
    []( so_5::<span class="hljs-keyword">environment_params_t</span> &amp; params ) {...} );</code></pre><br>
<p>       .         SObjectizer Environment      ,  SObjectizer Environment    .</p><br>
<p>      .   ,              .</p><br>
<p>  "" .          ,     .           SObjectizer Environment,   .</p><br>
<p> -,         ,            :</p><br>
<pre><code class="cpp hljs">so_5::launch(<font></font>
    []( so_5::<span class="hljs-keyword">environment_t</span> &amp; env ) {<font></font>
        ... <span class="hljs-comment">// - .</span>
        <span class="hljs-comment">//     .</span>
        <span class="hljs-keyword">auto</span> disp = so_5::disp::active_obj::create_private_disp(env);
        <span class="hljs-comment">//        </span>
        <span class="hljs-comment">//    .</span>
        <span class="hljs-keyword">auto</span> coop = env.create_coop( <span class="hljs-string">"ping_pong"</span>,
            <span class="hljs-comment">//      .</span><font></font>
            disp-&gt;binder() );<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_pinger_t</span> &gt;(...);<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_ponger_t</span> &gt;(...);<font></font>
        ...<font></font>
    },<font></font>
    <span class="hljs-comment">//    SObjectizer-.</span>
    []( so_5::<span class="hljs-keyword">environment_params_t</span> &amp; params ) {...} );</code></pre><br>
<p>        . ,               ,         .</p><br>
<p>         SObjectizer-5.6     .  ,    .       "private".        :</p><br>
<pre><code class="cpp hljs">so_5::launch(<font></font>
    []( so_5::<span class="hljs-keyword">environment_t</span> &amp; env ) {<font></font>
        ... <span class="hljs-comment">// - .</span>
        <span class="hljs-comment">//     .</span>
        <span class="hljs-keyword">auto</span> disp = so_5::disp::active_obj::make_dispatcher(env);
        <span class="hljs-comment">//        </span>
        <span class="hljs-comment">//    .</span>
        <span class="hljs-keyword">auto</span> coop = env.create_coop( <span class="hljs-string">"ping_pong"</span>,
            <span class="hljs-comment">//      .</span><font></font>
            disp.binder() );<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_pinger_t</span> &gt;(...);<font></font>
        coop-&gt;make_agent&lt; <span class="hljs-keyword">a_ponger_t</span> &gt;(...);<font></font>
        ...<font></font>
    },<font></font>
    <span class="hljs-comment">//    SObjectizer-.</span>
    []( so_5::<span class="hljs-keyword">environment_params_t</span> &amp; params ) {...} );</code></pre><br>
<h2 id="ostalis-tolko-svobodnye-funkcii-send-send_delayed-i-send_periodic">    send, send_delayed  send_periodic</h2><br>
<p> API     SObjectizer- â€”  , ,    ,  SObjectizer      C++11    .</p><br>
<p>   :</p><br>
<pre><code class="cpp hljs">mbox-&gt;deliver_message(<span class="hljs-keyword">new</span> my_message(...));</code></pre><br>
<p>,   "  " ():</p><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;my_message&gt; <span class="hljs-title">msg</span><span class="hljs-params">(<span class="hljs-keyword">new</span> my_message(...))</span></span>;<font></font>
mbox-&gt;deliver_message(<span class="hljs-built_in">std</span>::move(msg));</code></pre><br>
<p>,          variadic templates   send-.    :</p><br>
<pre><code class="cpp hljs">send&lt;my_message&gt;(target, ...);</code></pre><br>
<p>,   - ,    <code>send</code>-   ,    <code>send_to_agent</code>, <code>send_delayed_to_agent</code>  ..            <code>send</code>, <code>send_delayed</code>  <code>send_periodic</code>.</p><br>
<p>,    ,   send-            ,  ,  <code>deliver_message</code>, <code>schedule_timer</code>  <code>single_timer</code>,     .</p><br>
<p>    5.6.0   API SObjectizer-     <code>send</code>, <code>send_delayed</code>  <code>send_periodic</code>.      ,     SObjectizer-  .</p><br>
<p>   SObjectizer-5.6     -  ,      ,            C++11.     ,           C++11.</p><br>
<h2 id="edinyy-format-send_delayed-i-send_periodic">  send_delayed  send_periodic</h2><br>
<p>  <code>send_delayed</code>  <code>send_periodic</code>    SObjectizer      .</p><br>
<p>        SObjectizer Environment.      SObjectizer Environment.   mchain-   .    mbox-   . ,        mchain,   <code>send_delayed</code>  :</p><br>
<pre><code class="cpp hljs">send_delayed&lt;my_message&gt;(target_agent, pause, ...);<font></font>
send_delayed&lt;my_message&gt;(target_mchain, pause, ...);</code></pre><br>
<p>  mbox-   -    SObjectizer Environment:</p><br>
<pre><code class="cpp hljs">send_delayed&lt;my_message&gt;(<span class="hljs-keyword">this</span>-&gt;so_environment(), target_mbox, pause, ...);</code></pre><br>
<p>  <code>send_delayed</code>  <code>send_periodic</code>   .   ,   ,   .   ,        mbox-   SObjectizer Environment.</p><br>
<p>       ,     .</p><br>
<p>  mbox-  ,   SObjectizer Environment  .        <code>send_delayed</code>  <code>send_periodic</code>      :</p><br>
<pre><code class="cpp hljs">send_delayed&lt;my_message&gt;(target_agent, pause, ...);<font></font>
send_delayed&lt;my_message&gt;(target_mchain, pause, ...);<font></font>
send_delayed&lt;my_message&gt;(target_mbox, pause, ...);</code></pre><br>
<p>   ",  ".</p><br>
<h2 id="net-bolshe-ad-hoc-agentov">  ad-hoc </h2><br>
<p> , Â«    ,   Â».    ad-hoc    ,    :(</p><br>
<p>   .      SObjectizer-5  ,           SObjectizer- .        ,     .</p><br>
<p>            <code>agent_t</code>.   ,  ,   .  ?</p><br>
<p>  ad-hoc , .. ,         ,          -. ,   ping-pong  ad-hoc      :</p><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> pinger = coop-&gt;define_agent();
<span class="hljs-keyword">auto</span> ponger = coop-&gt;define_agent();<font></font>
<font></font>
pinger<font></font>
    .on_start( [ponger]{ so_5::send&lt; msg_ping &gt;( ponger ); } )<font></font>
    .event&lt; msg_pong &gt;(<font></font>
        pinger,<font></font>
        [ponger]{ so_5::send&lt; msg_ping &gt;( ponger ); } );<font></font>
<font></font>
ponger<font></font>
    .event&lt; msg_ping &gt;(<font></font>
        ponger,<font></font>
        [pinger]{ so_5::send&lt; msg_pong &gt;( pinger ); } );</code></pre><br>
<p>..   .   <code>define_agent()</code>      -,      .</p><br>
<p>  SObjectizer-5      ad-hoc .</p><br>
<p>     ,       .     ,  ad-hoc  â€”     :   ,   .     SObjectizer-5.6   - .</p><br>
<p>     ,    :            ,      ,    ,   ,      ..       .                ,     ,       .</p><br>
<p>      ,   .    (  )   ,      : "           ,     ".         : "    ,            ".</p><br>
<p> ,  ""  ""          ,  .     ,  ad-hoc   SObjectizer-.</p><br>
<h2 id="sobjectizer-56-bolshe-ne-podderzhivaet-sinhronnogo-vzaimodeystviya-agentov">SObjectizer-5.6      </h2><br>
<p>        .</p><br>
<p>     SObjectizer-4.   SObjectizer-5 . , ,    .. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">service request-</a>.  ,  ,    .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  -  </a>.</p><br>
<p>     ,      :(</p><br>
<p> SObjectizer-         ,       â€” .   ,       ,   ,     mbox-.</p><br>
<p>  ,   SObjectizer   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> -</a>,                .</p><br>
<p> ,     / SObjectizer-      . ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">       </a>.        .</p><br>
<p>   SObjectizer-5.6        .</p><br>
<p>    -    - ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">     so5extra</a>:</p><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    "-".</span>
<span class="hljs-keyword">using</span> my_request_reply = so_5::extra::sync::<span class="hljs-keyword">request_reply_t</span>&lt;my_request, my_reply&gt;;<font></font>
...<font></font>
<span class="hljs-comment">//  ,    .</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">request_handler</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> so_5::<span class="hljs-keyword">agent_t</span> {<font></font>
   ...<font></font>
   <span class="hljs-comment">//  .      .</span>
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">on_request</span><span class="hljs-params">(<span class="hljs-keyword">typename</span> my_request_reply::<span class="hljs-keyword">request_mhood_t</span> cmd)</span> </span>{<font></font>
      ... <span class="hljs-comment">//  .</span>
          <span class="hljs-comment">//      cmd-&gt;request().</span>
      <span class="hljs-comment">//   .</span>
      cmd-&gt;make_reply(...); <span class="hljs-comment">//      my_reply.</span><font></font>
   }<font></font>
   ...<font></font>
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">so_define_agent</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>{
      <span class="hljs-comment">//       .</span><font></font>
      so_subscribe_self().event(&amp;request_handler::on_request);<font></font>
   }<font></font>
};<font></font>
...<font></font>
<span class="hljs-comment">//     .</span>
so_5::<span class="hljs-keyword">mbox_t</span> handler_mbox = ...;
<span class="hljs-comment">//        15s.</span>
<span class="hljs-comment">//    ,    .</span>
my_reply reply = my_request_reply::ask_value(handler_mbox, <span class="hljs-number">15</span>s,<font></font>
   ...); <span class="hljs-comment">//       my_request.</span></code></pre><br>
<p>..        ,        -,    .     <code>make_reply</code>.</p><br>
<p>   ,     ,     SObjectizer-    .  , <code>make_reply</code> â€”  -    <code>send</code>-.</p><br>
<p>,  ,     ,    :</p><br>
<ul>
<li>  (..  <code>request_reply_t&lt;Request, Reply&gt;</code>)    /   .        ;</li>
<li>  ,        mbox - .  -    ,    ;</li>
<li>      ,         :</li>
</ul><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">using</span> first_dialog = so_5::extra::sync::<span class="hljs-keyword">request_reply_t</span>&lt;first_request, first_reply&gt;;
<span class="hljs-keyword">using</span> second_dialog = so_5::extra::sync::<span class="hljs-keyword">request_reply_t</span>&lt;second_request, second_reply&gt;;<font></font>
<font></font>
<span class="hljs-comment">//         .</span>
<span class="hljs-keyword">auto</span> reply_ch = create_mchain(env);<font></font>
<font></font>
<span class="hljs-comment">//     .</span><font></font>
first_dialog::initiate_with_custom_reply_to(<font></font>
   one_service, reply_ch, so_5::extra::sync::do_not_close_reply_chain,<font></font>
   ...);<font></font>
second_dialog::initiate_with_custom_reply_to(<font></font>
   another_service, reply_ch, so_5::extra::sync::do_not_close_reply_chain,<font></font>
   ...);<font></font>
<font></font>
<span class="hljs-comment">//    .</span>
receive(from(reply_ch).handle_n(<span class="hljs-number">2</span>).empty_timeout(<span class="hljs-number">15</span>s),<font></font>
   [](<span class="hljs-keyword">typename</span> first_dialog::<span class="hljs-keyword">reply_mhood_t</span> cmd) {...},<font></font>
   [](<span class="hljs-keyword">typename</span> second_dialog::<span class="hljs-keyword">reply_mhood_t</span> cmd) {...});</code></pre><br>
<p> ,  ,      SObjectizer-  :</p><br>
<ul>
<li>       ;</li>
<li>     ,     ;</li>
<li>  ,      ;</li>
<li>    ,      .</li>
</ul><br>
<p>    ,  .</p><br>
<h1 id="zaklyuchenie"></h1><br>
<p>   ,  ,      SObjectizer-5.6.0  ,    .</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</p><br>
<p>    ,  SObjectizer   ,   .      :  ,   ,   .</p><br>
<p>   /   .  ,     SObjectizer   ,  - .       ,       SObjectizer-,     .   ,   â€¦ ;)</p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.   ,     GitHub-,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">GitHub-</a>.    ,        .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®Googleã‚°ãƒ«ãƒ¼ãƒ—ã§</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SObjectizeré–¢é€£ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã‚’</font></a><font style="vertical-align: inherit;">ãƒ•ã‚©ãƒ­ãƒ¼ã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã“ã§SObjectizerã«é–¢é€£ã™ã‚‹å•é¡Œã‚’æèµ·ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453242/index.html">å¤ã®ã‚¤ãƒ™ãƒ³ãƒˆã®éŠã³å ´</a></li>
<li><a href="../ja453246/index.html">ERP-é€£ç¶šåˆ†è§£ã‚·ã‚¹ãƒ†ãƒ </a></li>
<li><a href="../ja453248/index.html">ã‚¢ãƒ«ãƒ†ãƒŸã‚¹æœˆé¢ãƒŸãƒƒã‚·ãƒ§ãƒ³-æœˆé¢ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤æœˆé¢è»Œé“ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸»è¦è¦ç´ ã®è£½é€ ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ</a></li>
<li><a href="../ja453252/index.html">Sportmasterã‚¯ãƒ©ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿæ–½æ–¹æ³•</a></li>
<li><a href="../ja453254/index.html">GOSTã®ã‚³ãƒ¼ãƒ‰ã€Grasshopperã€ãã®SBoxã€ãŠã‚ˆã³å¤±ã‚ã‚ŒãŸç¨®å­ã«ã¤ã„ã¦</a></li>
<li><a href="../ja453258/index.html">PT2399ãƒãƒƒãƒ—ã‚’ä½¿ç”¨ã—ãŸãƒªãƒãƒ¼ãƒ–ãƒšãƒ€ãƒ«ã®ä½œæˆï¼ˆãƒ‘ãƒ¼ãƒˆ1ï¼‰</a></li>
<li><a href="../ja453260/index.html">DPIè¨­å®šæ©Ÿèƒ½</a></li>
<li><a href="../ja453262/index.html">CortexMãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å®šæ•°ã®å ´æ‰€ï¼ˆä¾‹ã¨ã—ã¦C ++ IARã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼ã‚’ä½¿ç”¨ï¼‰</a></li>
<li><a href="../ja453264/index.html">Virtuali-teeï¼šã‚«ãƒãƒ¼ã¯ã—ãªã„ãŒéœ²å‡ºã™ã‚‹ã€ŒåŒ»ç™‚ç”¨Tã‚·ãƒ£ãƒ„ã€</a></li>
<li><a href="../ja453272/index.html">GitHubã‚¹ãƒãƒ³ã‚µãƒ¼ï¼šã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã«è²¢çŒ®ã™ã‚‹æ–°ã—ã„æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>