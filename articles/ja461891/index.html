<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤¦ğŸ½ ğŸ‘¨ğŸ¾â€ğŸ’¼ ğŸ†™ ManageIQã‚’ä½¿ç”¨ã—ã¦éŠ€è¡Œã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã§å‹é”ã‚’ä½œã‚‹æ–¹æ³• ğŸœ ğŸŒ• ğŸš­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ•°å¹´å‰ã®ä¸»ãªå‚¾å‘ã¯ã€è‡ªå‹•åŒ–ã€DevOpsãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ãŠã‚ˆã³å¸‚å ´ã¸ã®ä¾¡å€¤æä¾›ã®åŠ é€Ÿã§ã—ãŸã€‚Home Credit Bankã¯ã€é‡è¦ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’å¾…ã¤ãŸã‚ã«æ•°æ—¥é–“å¾…ã¤ã“ã¨ã«é£½ãé£½ãã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸æº€ã®å›ããŒã‚ªãƒ¼ãƒ—ãƒ³ã‚¹ãƒšãƒ¼ã‚¹ã«é³´ã‚ŠéŸ¿ãã«ã¤ã‚Œã€ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®é–‹ç™ºã«é…ã‚Œãšã«ã¤ã„ã¦ã„ãã€ã‚³ãƒ¼...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ManageIQã‚’ä½¿ç”¨ã—ã¦éŠ€è¡Œã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã§å‹é”ã‚’ä½œã‚‹æ–¹æ³•</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/homecredit/blog/461891/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°å¹´å‰ã®ä¸»ãªå‚¾å‘ã¯ã€è‡ªå‹•åŒ–ã€DevOpsãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ãŠã‚ˆã³å¸‚å ´ã¸ã®ä¾¡å€¤æä¾›ã®åŠ é€Ÿã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">Home Credit Bankã¯ã€é‡è¦ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’å¾…ã¤ãŸã‚ã«æ•°æ—¥é–“å¾…ã¤ã“ã¨ã«é£½ãé£½ãã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸æº€ã®å›ããŒã‚ªãƒ¼ãƒ—ãƒ³ã‚¹ãƒšãƒ¼ã‚¹ã«é³´ã‚ŠéŸ¿ãã«ã¤ã‚Œã€ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®é–‹ç™ºã«é…ã‚Œãšã«ã¤ã„ã¦ã„ãã€ã‚³ãƒ¼ã‚¹ã‚’å–ã‚Šã¾ã—ãŸã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šãã®å¤§ä¼æ¥­ã¨åŒæ§˜ã«ã€æ™‚é–“ã¨åŠ´åŠ›ã‚’å¿…è¦ã¨ã™ã‚‹éƒ¨é–€ã«ã‚ˆã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">æœ€åˆã®ã‚¿ã‚¹ã‚¯ã¨ã—ã¦ã€ä»®æƒ³åŒ–ç’°å¢ƒã«é–¢ä¿‚ãªãã€ä»®æƒ³ãƒã‚·ãƒ³ã‚’ä½œæˆã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’é¸æŠã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚¿ã‚¹ã‚¯ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ãŸã¨ã“ã‚ã€éŠ€è¡Œã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã¨ã€ãŸã¨ãˆã°APIã‚’ä»‹ã—ã¦çµ±åˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/tt/h7/br/tth7br6euodgo1dklwgmaqhdxu4.png" alt="ç”»åƒ"></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€ã‚‚é©åˆ‡ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ManageIQã§ã—ãŸ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€2012å¹´ã«Red HatãŒè²·åã—ã€ãã‚Œã«åŸºã¥ã„ã¦å•†ç”¨ã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat CloudFormsè£½å“ã‚’</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã§ã™</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åŒæ™‚ã«ã€ManageIQã¯ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹è£½å“ã®çŠ¶æ…‹ã‚’ç¶­æŒã—ã€CloudFormsã¨ä¸¦è¡Œã—ã¦é–‹ç™ºã—ã¦ã„ã¾ã™ã€‚</font></font></p><br>
<p>ManageIQ    Ruby       ,    .          Gaprindashvili  High-Availability .</p><br>
<h2>  </h2><br>
<p>          .         ,      .    , ,  ,    ,     .  ,  , ,   ,       .</p><br>
<p>    ManageIQ,    :</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th>  </th>
<th>  ManageIQ</th>
<th>  ManageIQ</th>
</tr>
</thead>
<tbody>
<tr>
<td>  Linux  VMware/oVirt</td>
<td> </td>
<td>~ 10 </td>
</tr>
<tr>
<td>    Rancher</td>
<td></td>
<td>~ 15 </td>
</tr>
<tr>
<td>  Windows  VMware</td>
<td></td>
<td>~ 25 </td>
</tr>
</tbody>
</table></div><br>
<p>    ,       ,       Docker,         Artifactory,          Docker Hub.    Windows,     , , -,    Linux     2 ,   Windows â€“ 6 . -,   Windows   10 ,  2   Linux.</p><br>
<p>10  â€“     , ,         2-3 .    ManageIQ   :</p><br>
<ol>
<li>  ,     ,     .</li>
<li>        ,       .</li>
<li>       ManageIQ     .</li>
<li>  IP-       .</li>
<li>  DNS-   DNS-.</li>
<li>  ,    ,       .</li>
<li>        .</li>
<li>     ,   ,    :<br>
<ul>
<li>    ,</li>
<li>  root-,    Linux      , </li>
<li> YAML-    Puppet  GitLab,</li>
<li> runbookâ€™,        Windows   </li>
<li> Puppet,     Linux .</li>
</ul></li>
<li>      ,   .2.     ,  IP-   .</li>
<li>     (CMDB)   .</li>
<li>    Zabbix    .</li>
<li>      e-mail     ,    ManageIQ.</li>
</ol><br>
<h2 id="chto-vnutri"> </h2><br>
<p>     .   ManageIQ      .     ,   , ,  vCenter?   â€“ . ManageIQ    ,    ,      .        ,       .  ,     , ,   Azure,  vCenter,     ,   -   Kubernetes,        ManageIQ.</p><br>
<p>     , ManageIQ     . , ,       :</p><br>
<p><img src="https://habrastorage.org/webt/ku/7y/l3/ku7yl3xi9trq-9wndv-ad_vlpvu.png"></p><br>
<p>         ,      :</p><br>
<p><img src="https://habrastorage.org/webt/v7/ey/tf/v7eytf_hbcxxjcpw4hvrzuwyzve.png"></p><br>
<p>    , ,    ,       . ,    (   ),  ,     : , ,             . </p><br>
<p>    ,           ,      .        :</p><br>
<p><img src="https://habrastorage.org/webt/mj/yv/28/mjyv28hsy0ggf6t68jjdkgc8mwc.png"></p><br>
<p> ,   ,     .      .</p><br>
<h2 id="struktura-avtomatizacii"> </h2><br>
<p>      ManageIQ   ,     . </p><br>
<h3 id="automate-domain">Automate Domain</h3><br>
<img align="right" src="https://habrastorage.org/webt/xy/ea/c_/xyeac_nx3if-e4txuiuriic4h0w.png"><br>
<p> Datastore   ,    ManageIQ. </p><br>
<p>    ManageIQ,     -,   .    ,     ,       ManageIQ     .</p><br>
<h3 id="automate-namespace">Automate Namespace</h3><br>
<img align="right" src="https://habrastorage.org/webt/yf/e1/t3/yfe1t3kjxb4rhvenndkfkwtsad4.png"><br>
<p>    ,     :    ,     (Infrastructure)      (Service).     Namespace,    ,     .</p><br>
<p>         (provisioning)    .    Automate Class,   <em>VMProvision_VM</em>.</p><br>
<h3 id="automate-class">Automate Class</h3><br>
<p>  ,    <strong>Instances</strong>, <strong>Methods</strong>, <strong>Properties </strong> <strong>Schema</strong>.        Schema:<br>
<img src="https://habrastorage.org/webt/vm/jt/lf/vmjtlfd9qpyrqpdpemtxfw2yczs.png"></p><br>
<p>   pipeline   CI/CD.    ,      . </p><br>
<h3 id="automate-instance">Automate Instance</h3><br>
<img align="right" src="https://habrastorage.org/webt/ie/wj/fj/iewjfjuzq9rplkcszwsh7wemsqu.png"><br>
<p> ,  ,   Automate Instance.       ,    <em>Default Value</em>. ,    ,   .</p><br>
<p><img src="https://habrastorage.org/webt/wy/sl/5c/wysl5c2zze_9_sfplsnykplbf_m.png"></p><br>
<p>     ,      .  ,       .</p><br>
<p>,       Value:<br>
<img src="https://habrastorage.org/webt/rd/j_/v7/rdj_v7hc3wgt7dty2zckjltiacg.png"></p><br>
<p>  Automate Class   Methods,     Automate Instance.      <em>ipam_base_uri </em>  <em>execute</em>.  execute,   ,  Automate Method <em>acquire_ip</em>.</p><br>
<h3 id="automate-method">Automate Method</h3><br>
<p> Ruby ,       REST API   . ,         IPAM.  IPAM  , ,   VLAN  .   ,         ,    .   ,        PCI-DSS.               (    ,     uri,       IPAM):</p><br>
<div class="spoiler"><b class="spoiler_title">    Ruby</b><div class="spoiler_text"><pre><code class="ruby hljs">base_uri = $evm.object[<span class="hljs-string">'ipam_base_uri'</span>]<font></font>
prov = $evm.root[<span class="hljs-string">"miq_provision"</span>]<font></font>
<font></font>
site = prov.get_option(<span class="hljs-symbol">:site</span>)<font></font>
app = prov.get_option(<span class="hljs-symbol">:dialog_dropdown_list_information_system</span>)<font></font>
crq = prov.get_option(<span class="hljs-symbol">:crq</span>)<font></font>
descr = prov.get_option(<span class="hljs-symbol">:dialog_textarea_box_usernotes</span>)<font></font>
owner = $evm.root[<span class="hljs-string">'user'</span>].name<font></font>
scope = prov.get_option(<span class="hljs-symbol">:dialog_dropdown_scope</span>)<font></font>
environment = prov.get_option(<span class="hljs-symbol">:landscape</span>)</code></pre><br>
<p><em>$evm.root</em> â€“  ,   ,     ManageIQ.      , , ,   ('miq_request')  ..   ,     provision.<br>
<img src="https://habrastorage.org/webt/4m/hz/lm/4mhzlmb6p_lvkagsl7apu41mpdm.png"></p><br>
<p>    : <em>get_option(:site)</em>  ,        , , , <em>get_option(:dialog_dropdown_list_information_system)</em>   ,       .<br>
          JSON:</p><br>
<pre><code class="ruby hljs">options = {
  <span class="hljs-symbol">verify:</span> <span class="hljs-literal">false</span>,
  <span class="hljs-symbol">headers:</span> {<span class="hljs-string">"Content-Type"</span> =&gt; <span class="hljs-string">"application/json"</span>},
  <span class="hljs-symbol">body:</span> {
    <span class="hljs-string">"site"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{site}</span>"</span>,
    <span class="hljs-string">"env"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{env}</span>"</span>,
    <span class="hljs-string">"app"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{app}</span>"</span>,
    <span class="hljs-string">"scope"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{scope}</span>"</span>,
    <span class="hljs-string">"role"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{role}</span>"</span>,
    <span class="hljs-string">"crq"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{crq}</span>"</span>,
    <span class="hljs-string">"descr"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{descr}</span>"</span>,
    <span class="hljs-string">"owner"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{owner}</span>"</span>,<font></font>
  }.to_json,<font></font>
}</code></pre><br>
<p>    IPAM  ,   VLAN     ,    .</p></div></div><br>
<p>      , ManageIQ      ,  ,   -      post provisioning ( ,      ).     Puppet    Linux .       GitLab YAML-   :</p><br>
<div class="spoiler"><b class="spoiler_title">    Ruby</b><div class="spoiler_text"><pre><code class="ruby hljs">options = {
  <span class="hljs-symbol">headers:</span> {<span class="hljs-string">"Private-Token"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{api_token}</span>"</span>, <span class="hljs-string">"Content-Type"</span> =&gt; <span class="hljs-string">"application/json"</span>},<font></font>
}<font></font>
<font></font>
body = {<font></font>
   <span class="hljs-string">"branch"</span> =&gt; <span class="hljs-string">"<span class="hljs-subst">#{branch}</span>"</span>,
   <span class="hljs-string">"author_email"</span> =&gt; <span class="hljs-string">"email@your.domain"</span>,
   <span class="hljs-string">"author_name"</span> =&gt; <span class="hljs-string">"ManageIQ Bot"</span>,
   <span class="hljs-string">"content"</span> =&gt; <span class="hljs-string">""</span>,
   <span class="hljs-string">"commit_message"</span> =&gt; <span class="hljs-string">"New host created by ManageIQ"</span>,<font></font>
}<font></font>
<font></font>
descr = prov.get_option(<span class="hljs-symbol">:long_description</span>)<font></font>
<font></font>
<span class="hljs-keyword">if</span> descr.<span class="hljs-keyword">include</span>?(<span class="hljs-string">'rancher'</span>) &amp;&amp; descr.<span class="hljs-keyword">include</span>?(<span class="hljs-string">'test'</span>) <span class="hljs-keyword">then</span>
  body[<span class="hljs-symbol">:content</span>] = <span class="hljs-string">"---\ngroups:\n   - <span class="hljs-subst">#{yaml_server}</span>\n   - rancher\n   - user-devops-UDCR"</span>
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">unless</span> descr.<span class="hljs-keyword">include</span>?(<span class="hljs-string">'test'</span>) <span class="hljs-keyword">then</span>
  <span class="hljs-keyword">if</span> descr.<span class="hljs-keyword">include</span>?(<span class="hljs-string">'rancher'</span>) <span class="hljs-keyword">then</span>
    body[<span class="hljs-symbol">:content</span>] = <span class="hljs-string">"---\ngroups:\n   - <span class="hljs-subst">#{yaml_server}</span>\n   - rancher\n"</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">unless</span> descr.<span class="hljs-keyword">include</span>?(<span class="hljs-string">'rancher'</span>) <span class="hljs-keyword">then</span>
  body[<span class="hljs-symbol">:content</span>] = <span class="hljs-string">"---\ngroups:\n   - <span class="hljs-subst">#{yaml_server}</span>\n   - <span class="hljs-subst">#{$is_id}</span>"</span>
<span class="hljs-keyword">end</span>  </code></pre></div></div><br>
<p>     , ,    ,  .</p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1i/hv/ig/1ihvigmykpbqlihq2l8oturxxk0.png"></div><br>
<p>   ,     :<br>
<img src="https://habrastorage.org/webt/qf/j-/br/qfj-brpfqe1ukkcvrw_jdtdpigm.png"></p><br>
<p>    ,    .<br>
 ,     -    ,   ,     ,     .      ,  ,   ,   . </p><br>
<h2 id="logirovanie"></h2><br>
<p>ManageIQ   ,   .     automation.log.     API,   ,  ,     top.</p><br>
<p>             :<br>
<img src="https://habrastorage.org/webt/tv/z0/yy/tvz0yyygspvyltb6d_x4ja00hpg.png"></p><br>
<p> ,      :</p><br>
<pre><code class="ruby hljs">$evm.log(<span class="hljs-symbol">:info</span>, <span class="hljs-string">"Call job status uri:  <span class="hljs-subst">#{item_uri}</span>/<span class="hljs-subst">#{job_id}</span>/api/json"</span>)</code></pre><br>
<p>        API,  ,  -   . ,      ,   Jenkins jobâ€™a  SCCM Runbookâ€™a:</p><br>
<pre><code class="ruby hljs">$evm.log(<span class="hljs-symbol">:info</span>, <span class="hljs-string">"acquire_osname --- naming jobStatus: <span class="hljs-subst">#{jobStatus}</span>"</span>)
<span class="hljs-keyword">break</span> <span class="hljs-keyword">if</span> jobStatus.to_s == <span class="hljs-string">"Completed"</span></code></pre><br>
<p>          exceptions:</p><br>
<pre><code class="ruby hljs">raise â€œVM <span class="hljs-keyword">not</span> specifiedâ€ <span class="hljs-keyword">if</span> vm.<span class="hljs-literal">nil</span>?</code></pre><br>
<p>       /var/log/manageiq/*,      ,     tail  grep â€“    . ,  ManageIQ     ,    ,   , ,   ELK.</p><br>
<h2 id="manageiq-api">ManageIQ API</h2><br>
<p>  -, ManageIQ   API.   , ,       ,   </p><br>
<div class="spoiler"><b class="spoiler_title">  :</b><div class="spoiler_text"><pre><code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_template</span><span class="hljs-params">(vendor, os, ems)</span></span>
  user = <span class="hljs-string">'<span class="hljs-subst">#{user}</span>'</span>
  pass = <span class="hljs-string">'<span class="hljs-subst">#{pass}</span>'</span><font></font>
  options = {<font></font>
    <span class="hljs-symbol">verify:</span> <span class="hljs-literal">false</span>,
    <span class="hljs-symbol">headers:</span> {<span class="hljs-string">"Accept"</span> =&gt; <span class="hljs-string">"*/*"</span>, <span class="hljs-string">"accept-encoding"</span> =&gt; <span class="hljs-string">"gzip, deflate"</span>},
    <span class="hljs-symbol">basic_auth:</span> {
      <span class="hljs-symbol">username:</span> <span class="hljs-string">"<span class="hljs-subst">#{user}</span>"</span>,
      <span class="hljs-symbol">password:</span> <span class="hljs-string">"<span class="hljs-subst">#{pass}</span>"</span><font></font>
    },<font></font>
  }<font></font>
  response = HTTParty.get(<span class="hljs-string">"<span class="hljs-subst">#{host}</span>/api/templates?filter[]=vendor=%27<span class="hljs-subst">#{vendor}</span>%27&amp;filter[]=name=%27%2A<span class="hljs-subst">#{os}</span>%2A%27&amp;filter[]=ems_id=%27<span class="hljs-subst">#{ems}</span>%27"</span>, options).to_s<font></font>
  link = JSON.parse(response)<font></font>
  link[<span class="hljs-string">"resources"</span>].each <span class="hljs-keyword">do</span> <span class="hljs-params">|r|</span>
    $url = r[<span class="hljs-string">"href"</span>]
  <span class="hljs-keyword">end</span><font></font>
  response = HTTParty.get($url,options).to_s<font></font>
  template = [<span class="hljs-string">"<span class="hljs-subst">#{JSON.parse(response)[<span class="hljs-string">'id'</span>]}</span>"</span>+<span class="hljs-string">", "</span>+<span class="hljs-string">"<span class="hljs-subst">#{JSON.parse(response)[<span class="hljs-string">'name'</span>]}</span>"</span>]
  <span class="hljs-keyword">return</span> template
<span class="hljs-keyword">end</span></code></pre></div></div><br>
<p>C  POST      ,   .<br>
   ,     API    .             -.     ,     </p><br>
<div class="spoiler"><b class="spoiler_title">POST :</b><div class="spoiler_text"><pre><code class="ruby hljs">curl -X POST \
<span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/Manageiq.hostname/api</span><span class="hljs-regexp">/service_catalogs/</span><span class="hljs-number">4</span>/service_templates/<span class="hljs-number">31</span> \<font></font>
  -H <span class="hljs-string">'Authorization: Basic Token-Value'</span> \<font></font>
  -H <span class="hljs-string">'Content-Type: application/json'</span> \<font></font>
  -d <span class="hljs-string">'{
    "action": "order",
    "resource": {
        "radio_button_vcpu": "a_2",
        "radio_button_vram": "a_2",
        "hdd_size": "40",
        "dropdown_os": "CentOS",
        "text_box_filter": "dns",
        "dropdown_list_information_system": "DNS ",
        "text_box_validator": "OK (DNS )",
        "textarea_box_usernotes": " ",
        "dropdown_env": "production",
        "date_control_retirement_dt": "2022-05-21",
        "dropdown_scope": "-"
    }
}'</span></code></pre></div></div><br>
<h2 id="zaklyuchenie"></h2><br>
<h3 id="plyusy">:</h3><br>
<ul>
<li> : ManageIQ       ,    ,        ,   ,   ..</li>
<li>        .      ,    - .</li>
<li>  ,     . : Amazon EC2, Google Compute Engine, Azure, OpenStack, VMware vCloud. : Microsoft SCVMM, OpenStack Platform Director, Red Hat Virtualization, VMware vCenter. : Kubernetes, OpenShift.</li>
</ul><br>
<h3 id="minusy">:</h3><br>
<ul>
<li>        .     ,    ,   ,   . ,  ,      ,    . </li>
<li> .    -   ,     Â«Â» .    .</li>
<li>,     .   ,         ,             ,      :smile:.</li>
</ul><br>
<h3 id="kak-u-nas-seychas">   :</h3><br>
<p>  ,  ManageIQ      Ruby,         API:</p><br>
<ul>
<li> .   root-      ,     ,  ManageIQ    ;</li>
<li> Service Center Orchestration   DNS-   ;</li>
<li>BMC Remedy.        .   ,  ;</li>
<li>CMDB.            .</li>
<li>Zabbix.         ,      . </li>
<li>Rancher.    ,        .</li>
<li>Jenkins.  Jenkins  jobâ€™     oVirt;</li>
<li>LDAP.   ,        Rancher      Vault;</li>
<li>Vault.          ,         ,     ;</li>
<li>Puppet  IPAM   .</li>
</ul><br>
<p>     ,              .<br>
,   ,          ,    ,       ,    .               ..</p><br>
<h3 id="k-chemu-stremitsya-houm">   :</h3><br>
<ul>
<li>   Hammer,     HA       Ansible.</li>
<li>         .       ,    .</li>
<li>       .</li>
<li>,  SaaS,  jenkins, logstash  ..</li>
<li>   API       .       ,      ,              .</li>
</ul><br>
<p><em>     ,   â€“  ,          . ,   ,                 .</em></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461877/index.html">Javaã¨Kotlin for Androidï¼šé–‹ç™ºè€…ã®æ„è¦‹</a></li>
<li><a href="../ja461879/index.html">æœ¬ã€ŒLinux in actionã€</a></li>
<li><a href="../ja461881/index.html">Node.jsãƒ­ã‚®ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰</a></li>
<li><a href="../ja461885/index.html">EDSã¯åˆ¥ã®ã‚¿ã‚¤ãƒ—ã®è©æ¬ºã§ã™</a></li>
<li><a href="../ja461887/index.html">Aeronetã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰2ã®é–‹å§‹ï¼šHoming Drone</a></li>
<li><a href="../ja461895/index.html">Learn While Travel-ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘åˆã®ãƒ“ã‚¸ãƒã‚¹åˆ†æãƒ‡ãƒ¼ã§ã®é‹è»¢æ–¹æ³•</a></li>
<li><a href="../ja461897/index.html">Lamodaã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®‰å®šæ€§ã‚’ç¶­æŒã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja461899/index.html">ã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆã€CQRSãŠã‚ˆã³Laravel</a></li>
<li><a href="../ja461901/index.html">3å¹´é–“ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼šé€Ÿåº¦ã‚’ä¸Šã’ã‚‹æ–¹æ³•ã ã‘ã§ãªãã€</a></li>
<li><a href="../ja461903/index.html">è¬ã®æ•µï¼šã‚ã„ã¾ã„ãªå€Ÿç”¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>