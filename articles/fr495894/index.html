<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇🏽 🎅🏾 🔦 Javascript Performance Measurement 👩🏿‍🤝‍👩🏾 🛠️ 🏉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mesurer le temps nécessaire à l'exécution d'une fonction est un bon moyen de prouver qu'une implémentation d'un mécanisme est plus productive qu'une a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Javascript Performance Measurement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495894/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesurer le temps nécessaire à l'exécution d'une fonction est un bon moyen de prouver qu'une implémentation d'un mécanisme est plus productive qu'une autre. Cela vous permet de vous assurer que les performances de la fonction n'ont pas souffert après certaines modifications apportées au code. Il permet également de rechercher les goulots d'étranglement des performances des applications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si un projet Web a des performances élevées, cela contribue à sa perception positive par les utilisateurs. Et si les utilisateurs ont aimé travailler avec la ressource, ils ont la propriété de revenir. Par exemple, dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'étude a montré que 88% des clients en ligne sont moins susceptibles de revenir aux ressources qu'ils rencontrent en cas d'inconvénient. Ces inconvénients peuvent être causés par des problèmes de performances. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est pourquoi les outils pour aider à trouver les goulots d'étranglement des performances et mesurer les résultats des améliorations apportées au code sont importants dans le développement Web. Ces outils sont particulièrement pertinents dans le développement JavaScript. Il est important de savoir que chaque ligne de code JavaScript peut potentiellement bloquer le DOM, car JavaScript est un langage à thread unique. </font><font style="vertical-align: inherit;">
Dans cet article, je parlerai de la façon de mesurer les performances des fonctions et de ce qu'il faut faire avec les résultats de mesure.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/by/of/jl/byofjlhqvkjueyjzh-cyymte_qg.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous pensez que certains calculs sont trop lourds à effectuer dans le thread principal, vous pouvez alors décider de les déplacer vers un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">technicien de service</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou un travailleur Web.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Méthode Performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'interface </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> donne accès à une valeur de type </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMHighResTimeStamp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> via une méthode </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette méthode renvoie un horodatage indiquant le temps en millisecondes qui s'est écoulé depuis que le document a commencé à exister. </font><font style="vertical-align: inherit;">De plus, la précision de cet indicateur est d'environ 5 microsecondes (fractions de milliseconde). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de mesurer les performances d'un fragment de code à l'aide de la méthode </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous devez effectuer deux mesures de temps, enregistrer les résultats de ces mesures dans des variables, puis soustraire les résultats de la première des résultats de la deuxième mesure:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> t0 = performance.now();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++)&nbsp;<font></font>
{<font></font>
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-keyword">const</span> t1 = performance.now();
<span class="hljs-built_in">console</span>.log(t1 - t0, <span class="hljs-string">'milliseconds'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Chrome, après avoir exécuté ce code, vous pouvez obtenir quelque chose comme ceci:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0.6350000001020817</span> <span class="hljs-string">"milliseconds"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Firefox, comme ceci:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">1</span> milliseconds
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, les résultats de mesure obtenus dans différents navigateurs sont très différents. </font><font style="vertical-align: inherit;">Le fait est que dans Firefox 60, la précision des résultats renvoyés par l'API Performance est réduite. </font><font style="vertical-align: inherit;">Nous en parlerons davantage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'interface Performance a bien plus de capacités que de simplement renvoyer un certain horodatage. </font><font style="vertical-align: inherit;">Ceux - </font><font style="vertical-align: inherit;">ci comprennent la </font><font style="vertical-align: inherit;">mesure de </font><font style="vertical-align: inherit;">différents aspects de la </font><font style="vertical-align: inherit;">performance représentée par ces extensions de cette interface comme la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timeline Performance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Navigation Timing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timing utilisateur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">synchronisation des </font><font style="vertical-align: inherit;">ressources</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matériel pour en savoir plus sur ces API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, nous parlons de mesurer la performance des fonctions, nous avons donc suffisamment d'opportunités que la méthode donne</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Date.now () et performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous pouvez penser que vous pouvez utiliser la méthode pour mesurer les performances </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">C'est en effet possible, mais cette approche présente des inconvénients. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La méthode </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoie le temps en millisecondes qui s'est écoulé depuis l'ère Unix (1970-01-01T00: 00: 00Z) et dépend de l'horloge système. </font><font style="vertical-align: inherit;">Cela signifie non seulement que cette méthode n'est pas aussi précise que </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais qu'elle </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoie </font><font style="vertical-align: inherit;">en revanche des </font><font style="vertical-align: inherit;">valeurs qui, dans certaines conditions, peuvent être basées sur des indicateurs d'horloge incorrects. </font><font style="vertical-align: inherit;">Voici ce que Rich Gentlekor, un programmeur lié au moteur WebKit, dit: «Peut-être que les programmeurs sont moins susceptibles de penser que les lectures retournées lors de l'accès</font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en fonction de l'heure du système, il est absolument impossible d'appeler idéal pour surveiller des applications réelles. </font><font style="vertical-align: inherit;">La plupart des systèmes ont un démon qui synchronise régulièrement l'heure. </font><font style="vertical-align: inherit;">L'ajustement de l'horloge système pendant quelques millisecondes toutes les 15-20 minutes est une chose courante. </font><font style="vertical-align: inherit;">Avec une telle fréquence, des réglages d'horloge d'environ 1% des intervalles de 10 secondes seront inexacts. »</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Méthode Console.time ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La mesure du temps à l'aide de cette API est extrêmement simple. </font><font style="vertical-align: inherit;">Assez, avant le code dont vous devez évaluer les performances, appelez la méthode </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et après ce code - la méthode </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans ce cas, l'une et les autres méthodes doivent passer le même argument de chaîne. </font><font style="vertical-align: inherit;">Sur une seule page, jusqu'à 10 000 de ces minuteries peuvent être utilisées simultanément. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La précision des mesures de temps effectuées à l'aide de cette API est la même que lors de l'utilisation de l'API Performance, mais la précision qui sera atteinte dans chaque situation spécifique dépend du navigateur.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir exécuté ce code, le système affichera automatiquement des informations sur le temps écoulé sur la console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Chrome, cela ressemblera à ceci:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">0.766845703125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Firefox, comme ceci:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">2</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, tout ici est très similaire à ce que nous avons vu en travaillant </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La force de la méthode </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est sa facilité d'utilisation. </font><font style="vertical-align: inherit;">À savoir, nous parlons du fait que son application ne nécessite pas la déclaration de variables auxiliaires et de trouver la différence entre les indicateurs qui y sont enregistrés.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Précision de temps réduite</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous, à l'aide des outils décrits ci-dessus, avez mesuré les performances de votre code dans différents navigateurs, vous pouvez alors prêter attention au fait que les résultats de mesure peuvent varier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La raison en est que les navigateurs essaient de protéger les utilisateurs contre les attaques </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temporelles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et contre les mécanismes d'identification des navigateurs ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empreinte digitale du navigateur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Si les résultats de la mesure du temps s'avèrent trop précis, cela peut donner aux attaquants la possibilité, par exemple, d'identifier les utilisateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Firefox 60, comme déjà mentionné, la précision des résultats de mesure du temps est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">réduite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour cela, définissez la </font></font><code>privacy.reduceTimerPrecision</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeur de </font><font style="vertical-align: inherit;">la propriété </font><font style="vertical-align: inherit;">sur 2 ms.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelque chose à garder à l'esprit lors des tests de performances</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous disposez désormais d'outils pour mesurer les performances des fonctions JavaScript. </font><font style="vertical-align: inherit;">Mais avant de vous lancer dans les affaires, vous devez considérer certaines des fonctionnalités dont nous allons parler maintenant.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Diviser pour mieux régner</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons qu'en filtrant certaines données, vous fassiez attention au lent fonctionnement de l'application. Mais vous ne savez pas exactement où se situe le goulot d'étranglement des performances. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de spéculer sur quelle partie du code est lente, il serait préférable de découvrir en utilisant les méthodes ci-dessus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de voir l'image générale de ce qui se passe, vous devez d'abord utiliser </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">évaluer les performances d'un bloc de code, ce qui, vraisemblablement, a un mauvais effet sur les performances. Ensuite, vous devez regarder la vitesse des différentes parties de ce bloc. Si l'un d'eux semble nettement plus lent que les autres, vous devez y porter une attention particulière et savoir comment l'analyser.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moins il y a de code entre les appels à des méthodes qui mesurent le temps, plus la probabilité que quelque chose qui n'est pas pertinent à la situation problématique soit mesurée est faible.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Tenez compte du comportement des fonctions avec différentes valeurs d'entrée</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les applications réelles, les données reçues à l'entrée d'une fonction particulière peuvent être très différentes. </font><font style="vertical-align: inherit;">Si vous mesurez les performances d'une fonction à laquelle un ensemble de données sélectionné au hasard a été transmis, cela ne fournira aucune information précieuse pouvant clarifier ce qui se passe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fonctions lors de la recherche de performances doivent être appelées avec des données d'entrée qui ressemblent autant que possible aux vraies.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Exécuter plusieurs fois les fonctions</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que vous ayez une fonction qui itère sur un tableau. </font><font style="vertical-align: inherit;">Elle effectue certains calculs en utilisant chaque élément du tableau, puis retourne un nouveau tableau avec les résultats des calculs. </font><font style="vertical-align: inherit;">En pensant à l'optimisation de cette fonction, vous voulez savoir ce qui fonctionne plus rapidement dans votre situation - une boucle </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou une boucle régulière </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici deux options pour cette fonctionnalité:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testForEach</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-forEach'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];<font></font>
&nbsp;&nbsp;x.forEach(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(value / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;});<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-forEach'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testFor</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-for'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];
&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; x.length; i ++) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(x[i] / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-for'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testez les fonctions:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> x = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">100000</span>).fill(<span class="hljs-built_in">Math</span>.random());<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir exécuté le code, nous obtenons les résultats suivants:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">27</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cycle semblait </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">être beaucoup plus lent que le cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Après tout, les résultats des tests indiquent exactement cela? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, après un seul test, il est trop tôt pour tirer de telles conclusions. </font><font style="vertical-align: inherit;">Essayons d'appeler les fonctions deux fois:</font></font><br>
<br>
<pre><code class="javascript hljs">testForEach(x);<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons ce qui suit:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">13</span>ms - timer ended<font></font>
test-forEach: <span class="hljs-number">2</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">1</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'avère que la fonction dans laquelle elle est utilisée </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, appelée la deuxième fois, est aussi rapide que celle dans laquelle elle est utilisée </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais, étant donné que la première </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction appelle, la fonction fonctionne beaucoup plus lentement, cela ne vaut peut-être pas la peine de l'utiliser.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Tester les performances dans différents navigateurs</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tests ci-dessus ont été effectués dans Firefox. </font><font style="vertical-align: inherit;">Mais que faire si vous les exécutez dans Chrome? </font><font style="vertical-align: inherit;">Les résultats seront complètement différents:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">6.156005859375</span>ms<font></font>
test-forEach: <span class="hljs-number">8.01416015625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.371337890625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.31298828125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est que les navigateurs Chrome et Firefox sont basés sur différents moteurs JavaScript qui implémentent différentes optimisations de performances. </font><font style="vertical-align: inherit;">Il est très utile de connaître ces différences. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, Firefox a une meilleure optimisation </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une entrée similaire. </font><font style="vertical-align: inherit;">Et le cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est plus rapide que </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans Chrome et Firefox. </font><font style="vertical-align: inherit;">Par conséquent, il vaut probablement mieux s'attarder sur la variante de la fonction c </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un bon exemple, démontrant l'importance de mesurer les performances dans différents navigateurs. </font><font style="vertical-align: inherit;">Si vous évaluez les performances de certains codes uniquement dans Chrome, vous pouvez conclure que le cycle </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par rapport au cycle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n'est pas si mauvais.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Appliquer des limites artificielles aux ressources système</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les valeurs obtenues dans nos expériences ne semblent pas particulièrement grandes. </font><font style="vertical-align: inherit;">Mais sachez que les ordinateurs utilisés pour le développement sont généralement beaucoup plus rapides que, par exemple, le téléphone mobile moyen qu'ils utilisent pour naviguer sur le Web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de vous mettre à la place d'un utilisateur qui ne possède pas l'appareil le plus rapide, utilisez les capacités du navigateur pour limiter artificiellement les ressources système. </font><font style="vertical-align: inherit;">Par exemple - pour réduire les performances du processeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette approche, 10 ou 50 millisecondes peuvent facilement se transformer en 500.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Mesurer les performances relatives</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les mesures de performances dépendent généralement non seulement du matériel, mais également de la charge actuelle du processeur et de la charge de travail du thread principal de l'application JavaScript. </font><font style="vertical-align: inherit;">Par conséquent, essayez de vous baser sur des indicateurs relatifs caractérisant le changement de performances, car les indicateurs absolus obtenus lors de l'analyse du même fragment de code à différents moments peuvent varier considérablement.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous avons examiné certaines API JavaScript conçues pour mesurer les performances. </font><font style="vertical-align: inherit;">Nous avons expliqué comment les utiliser pour analyser du code réel. </font><font style="vertical-align: inherit;">Je crois que pour effectuer des mesures simples, il est plus facile à utiliser </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai le sentiment que de nombreux développeurs front-end ne prêtent pas assez d'attention à la mesure des performances de leurs projets. </font><font style="vertical-align: inherit;">Et ils doivent surveiller en permanence les indicateurs pertinents, car la productivité affecte la réussite et la rentabilité des projets. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous surveillez constamment la performance de vos projets, veuillez nous dire comment vous le faites.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495858/index.html">À distance et auto-isolement: une expérience spatiale pour aider les terriens</a></li>
<li><a href="../fr495884/index.html">Prédiction de séries chronologiques à l'aide de réseaux de neurones récurrents</a></li>
<li><a href="../fr495888/index.html">PyCon Russie a ouvert CFP pour les futurs conférenciers. Formulaires de participation et sujets attendus</a></li>
<li><a href="../fr495890/index.html">Configuration d'un ensemble Nginx / LetsEncrypt dans Docker Swarm</a></li>
<li><a href="../fr495892/index.html">Savez-vous vraiment ce que sont les tableaux?</a></li>
<li><a href="../fr495896/index.html">Package Use-sound: Effets sonores dans les applications React</a></li>
<li><a href="../fr495898/index.html">Un guide pratique pour gérer les fuites de mémoire dans Node.js</a></li>
<li><a href="../fr495902/index.html">CAPTCHA: tuer la conversion</a></li>
<li><a href="../fr495904/index.html">Peut-on prévoir une épidémie?</a></li>
<li><a href="../fr495908/index.html">Le chemin de la récompense</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>