<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ó üßíüèª üåÉ How Traffic Analysis Systems Detect MITER ATT & CK Hacker Tactics Using PT Network Attack Discovery üèúÔ∏è üíç üîï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="According to Verizon , most (87%) information security incidents occur in minutes, and it takes months for 68% of companies to detect them. This is co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How Traffic Analysis Systems Detect MITER ATT & CK Hacker Tactics Using PT Network Attack Discovery</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/493082/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/d1/un/zp/d1unzpgqkbnjyiaocvadijcppcm.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">According to Verizon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , most (87%) information security incidents occur in minutes, and it takes months for 68% of companies to detect them. This is confirmed by the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ponemon Institute study</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , according to which most organizations take an average of 206 days to detect an incident. According to the experience of our investigations, hackers can control the company's infrastructure for years and not be detected. So, in one of the organizations where our experts investigated the IS incident, it was revealed that hackers completely controlled the entire infrastructure of the organization and regularly stole important information </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for eight years</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose you already have SIEM running, which collects logs and analyzes events, and antiviruses are installed on the end nodes. Nonetheless,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not everything can be detected using SIEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , just as it is impossible to implement EDR systems on the entire network, which means that blind spots cannot be avoided. Network traffic analysis (NTA) systems help to cope with them. These decisions reveal the activity of attackers at the earliest stages of penetrating the network, as well as during attempts to gain a foothold and develop an attack within the network. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are two types of NTAs: some work with NetFlow, the second analyze raw traffic. The advantage of the second systems is that they can store raw traffic records. Thanks to this, the information security specialist can verify the success of the attack, localize the threat, understand how the attack occurred and how to prevent a similar one in the future.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will show how with the help of NTA it is possible, by direct or indirect signs, to identify all known attack tactics described in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MITER ATT &amp; CK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> knowledge base </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We will talk about each of the 12 tactics, analyze the techniques that are detected by traffic, and demonstrate their detection using our NTA-system.</font></font><a name="habracut"></a><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the ATT &amp; CK Knowledge Base</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MITER ATT &amp; CK is a public knowledge base developed and maintained by MITRE Corporation based on analysis of real APTs. </font><font style="vertical-align: inherit;">It is a structured set of tactics and techniques used by attackers. </font><font style="vertical-align: inherit;">This allows information security professionals from all over the world to speak the same language. </font><font style="vertical-align: inherit;">The base is constantly expanding and updated with new knowledge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the database, 12 tactics are distinguished, which are divided by the stages of a cyber attack:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial access</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">execution</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consolidation (persistence);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">privilege escalation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detection prevention (defense evasion);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obtaining credential access;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intelligence (discovery);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">movement within the perimeter (lateral movement);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data collection (collection);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">management and control (command and control);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exfiltration;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impact</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For each tactic, the ATT &amp; CK knowledge base lists a list of techniques that help attackers achieve their goals at the current stage of the attack. </font><font style="vertical-align: inherit;">Since the same technique can be used at different stages, it can relate to several tactics. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The description of each technique includes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">identifier;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list of tactics in which it is applied;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examples of use by APT groups;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">measures to reduce damage from its use;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detection recommendations. </font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Information security specialists can use knowledge from the database to structure information about current attack methods and, with this in mind, build an effective security system. </font><font style="vertical-align: inherit;">Understanding how real APT groups operate, including can be a source of hypotheses for a proactive search for threats in the framework of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">threat hunting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About PT Network Attack Discovery</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will </font><font style="vertical-align: inherit;">identify the </font><font style="vertical-align: inherit;">use of techniques from the ATT &amp; CK matrix using the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT Network Attack Discovery</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> system - Positive Technologies NTA-system designed to detect attacks on the perimeter and inside the network. PT NAD to varying degrees covers all 12 tactics of the MITER ATT &amp; CK matrix. He is most powerful in identifying techniques for initial access, lateral movement, and command and control. In them, PT NAD covers more than half of the known techniques, revealing their use by direct or indirect signs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The system detects attacks using ATT &amp; CK techniques using the detection rules created by the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">PT Expert Security Center</font></a><font style="vertical-align: inherit;"> team</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(PT ESC), machine learning, indicators of compromise, in-depth analytics and retrospective analysis. </font><font style="vertical-align: inherit;">Real-time traffic analysis in combination with a retrospective allows you to identify current hidden malicious activity and track the development vectors and attack history.</font></font><br>
<br>
<blockquote><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> full mapping of PT NAD to the MITER ATT &amp; CK matrix. </font><font style="vertical-align: inherit;">The picture is large, so we suggest you consider it in a separate window.</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initial access</font></font></h3><img src="https://habrastorage.org/webt/u2/ny/tg/u2nytgq9zlgiomlobozosya5ilg.png" align="left"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The tactics of obtaining initial access includes techniques for penetrating the company‚Äôs network. </font><font style="vertical-align: inherit;">The goal of attackers at this stage is to deliver malicious code to the attacked system and to ensure the possibility of its further execution. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Traffic analysis with PT NAD reveals seven techniques for gaining initial access:</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1189</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : drive-by compromise</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A technique in which a victim opens a website that is used by cybercriminals to operate a web browser and obtain access tokens for an application. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : If the web traffic is not encrypted, PT NAD inspects the contents of the HTTP server responses. </font><font style="vertical-align: inherit;">It is in these answers that there are exploits that allow attackers to execute arbitrary code inside the browser. </font><font style="vertical-align: inherit;">PT NAD automatically detects such exploits using detection rules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Additionally, PT NAD detects a threat in the previous step. </font><font style="vertical-align: inherit;">The rules and indicators of compromise are triggered if a user visits a site that redirects him to a site with a bunch of exploits.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1190</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : exploit public-facing application</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exploiting vulnerabilities in services that are accessible from the Internet. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : performs a deep inspection of the contents of network packets, revealing signs of abnormal activity in it. </font><font style="vertical-align: inherit;">In particular, there are rules that allow you to detect attacks on the main content management system (CMS), web interfaces of network equipment, attacks on mail and FTP servers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1133</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : external remote services</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The use of remote access services by attackers to connect to internal network resources from outside. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : since the system recognizes protocols not by port numbers, but by the contents of packets, users of the system can filter traffic so that they can find all sessions of remote access protocols and check their legitimacy.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1193</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : spearphishing attachment</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We are talking about the notorious phishing attachments. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Automatically extracts files from traffic and checks them against compromise indicators. </font><font style="vertical-align: inherit;">Executable files in attachments are detected by rules that analyze the contents of mail traffic. </font><font style="vertical-align: inherit;">In a corporate environment, such an investment is considered abnormal.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1192</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : spearphishing link</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using phishing links. </font><font style="vertical-align: inherit;">The technique involves sending phishing emails by a malicious user with a link that, when clicked, downloads a malicious program. </font><font style="vertical-align: inherit;">Typically, the link is accompanied by text compiled in accordance with all the rules of social engineering. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : detects phishing links using compromise indicators. </font><font style="vertical-align: inherit;">For example, in the PT NAD interface we see a session in which there was an HTTP connection using a link listed in the phishing-urls list. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/q8/wm/ctq8wmf8gq34d91cfzdwvrf6otg.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linking from the list of indicators of compromise phishing-urls</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1199</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : trusted relationship</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Access to the victim‚Äôs network through third parties with whom the victim has a trusted relationship. </font><font style="vertical-align: inherit;">Attackers can hack into a trusted organization and connect through it to the target network. </font><font style="vertical-align: inherit;">To do this, they use VPN connections or domain trusts, which can be detected using traffic analysis. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it parses application protocols and saves the parsed fields to the database, so the IB analyst can use the filters to find all suspicious VPN connections or cross-domain connections in the database.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1078</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : valid accounts</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use of standard, local or domain credentials for authorization on external and internal services. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : automatically extracts credentials from HTTP, FTP, SMTP, POP3, IMAP, SMB, DCE / RPC, SOCKS5, LDAP, Kerberos. </font><font style="vertical-align: inherit;">In general, this is a username, password and a sign of authentication success. </font><font style="vertical-align: inherit;">If they were used, they are displayed in the corresponding session card.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execution</font></font></h2><img src="https://habrastorage.org/webt/ig/pr/uj/igprujjz9u5lerxfio26dk4s4es.png" align="left"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execution tactics include techniques that cybercriminals use to execute code on compromised systems. </font><font style="vertical-align: inherit;">Running malicious code helps attackers consolidate their presence (persistence tactics) and expand access to remote systems on the network by moving within the perimeter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PT NAD can detect the use by attackers of 14 techniques used to execute malicious code.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1191</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : CMSTP (Microsoft Connection Manager Profile Installer)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tactic in which attackers prepare a special malicious installation INF file for the CMSTP.exe utility (the connection manager profile installer) built into Windows. </font><font style="vertical-align: inherit;">CMSTP.exe takes the file as a parameter and sets the service profile for a remote connection. </font><font style="vertical-align: inherit;">As a result, CMSTP.exe can be used to download and execute dynamically connected libraries (* .dll) or scriptlets (* .sct) from remote servers. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it automatically detects the transmission of special .inf files in HTTP traffic. </font><font style="vertical-align: inherit;">In addition to this, it detects the transfer of malicious scriptlets and dynamically connected libraries via the HTTP protocol from a remote server.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1059</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : command-line interface</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interaction with the command line interface. </font><font style="vertical-align: inherit;">You can interact with the command line interface locally or remotely, for example using remote access utilities. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it automatically detects the presence of shells by responding to commands to launch various command-line utilities, such as ping, ifconfig.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1175</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : component object model and distributed COM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using COM or DCOM technologies to execute code on local or remote systems when moving through a network. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : detects suspicious DCOM calls that attackers usually use to run programs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1203</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : exploitation for client execution</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exploiting vulnerabilities to execute arbitrary code on a workstation. </font><font style="vertical-align: inherit;">The most useful exploits for attackers are those that allow code to be executed on a remote system, since with their help attackers can gain access to such a system. </font><font style="vertical-align: inherit;">The technique can be implemented using the following methods: malicious mailing list, website with browser exploits and remote exploitation of application vulnerabilities. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : while parsing mail traffic, PT NAD checks it for executable files in the attachment. </font><font style="vertical-align: inherit;">Automatically extracts office documents from letters in which there may be exploits. </font><font style="vertical-align: inherit;">Attempts to exploit vulnerabilities are visible in the traffic that PT NAD detects automatically.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1170</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : mshta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the mshta.exe utility, which runs Microsoft HTML applications (HTA) with the .hta extension. </font><font style="vertical-align: inherit;">Since mshta processes files bypassing browser security settings, attackers can use mshta.exe to execute malicious HTA, JavaScript, or VBScript files. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : .hta files for execution through mshta are transmitted including over the network - this is visible in the traffic. </font><font style="vertical-align: inherit;">PT NAD detects the transfer of such malicious files automatically. </font><font style="vertical-align: inherit;">It captures files, and information about them can be viewed in the session card.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1086</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : PowerShell</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using PowerShell to search for information and execute malicious code. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : When PowerShell is used remotely by attackers, PT NAD detects this using rules. </font><font style="vertical-align: inherit;">It discovers PowerShell keywords that are most often used in malicious scripts, and transfers PowerShell scripts using the SMB protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : scheduled task </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use the Windows </font><font style="vertical-align: inherit;">task scheduler </font><font style="vertical-align: inherit;">and other utilities to automatically launch programs or scripts at a specific time. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What does PT NAD do?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: attackers create such tasks, usually remotely, which means that such sessions are visible in traffic. </font><font style="vertical-align: inherit;">PT NAD automatically detects suspicious task creation and modification operations using the ATSVC and ITaskSchedulerService RPC interfaces.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1064</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : scripting</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Executing scripts to automate various attacking actions. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it reveals the facts of script transmission over the network, that is, even before they are launched. </font><font style="vertical-align: inherit;">It detects the content of scripts in raw traffic and detects the transfer of files over the network with extensions corresponding to popular scripting languages.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1035</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : service execution</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run an executable file, command line interface instructions, or a script by interacting with Windows services, such as a Service Control Manager (SCM). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : inspects SMB traffic and detects SCM access to the rules for creating, modifying, and starting a service. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The technique of starting services can be implemented using the utility for remote execution of PSExec commands. PT NAD parses the SMB protocol and detects the use of PSExec when it uses the PSEXESVC.exe file or the standard PSEXECSVC service name to execute code on a remote machine. The user needs to check the list of executed commands and the legitimacy of the remote execution of commands from the node.</font></font><br>
<br>
<blockquote>    PT NAD          ATT&amp;CK,    ,      ,         . </blockquote><br>
<img src="https://habrastorage.org/webt/fs/i_/dw/fsi_dwmtgi6oudqw3_xnsrmjxwu.png"><br>
<br>
<i>     PSExec,          </i><br>
<br>
<h3>10. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">T1072</a>: third-party software</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A technique in which attackers gain access to remote administration software or a corporate software deployment system and use them to launch malicious code. Examples of such software: SCCM, VNC, TeamViewer, HBSS, Altiris. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, the technique is especially relevant in connection with the massive transition to remote work and, as a result, the connection of numerous home insecure devices through questionable remote access channels. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What does PT NAD do?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Automatically detects the operation of such software on the network. </font><font style="vertical-align: inherit;">For example, the rules are triggered by the facts of the VNC connection and the activity of the EvilVNC trojan, which secretly installs the VNC server on the victim‚Äôs host and automatically starts it. </font><font style="vertical-align: inherit;">PT NAD also automatically detects the TeamViewer protocol, this helps the analyst use the filter to find all such sessions and verify their legitimacy.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1204</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : user execution</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A technique in which a user runs files that can lead to code execution. </font><font style="vertical-align: inherit;">This can be, for example, if he opens an executable file or runs an office document with a macro. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : sees such files at the transfer stage, before they are launched. </font><font style="vertical-align: inherit;">Information about them can be studied in the card sessions, in which they were transmitted.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1047</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Windows Management Instrumentation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the WMI tool, which provides local and remote access to Windows system components. </font><font style="vertical-align: inherit;">Using WMI, attackers can interact with local and remote systems and perform many tasks, for example, collecting information for reconnaissance purposes and remotely starting processes during horizontal movement. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : since interactions with remote systems via WMI are visible in traffic, PT NAD automatically detects network requests for establishing WMI sessions and checks the traffic for transmission of scripts that use WMI.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1028</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Windows Remote Management</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the Windows service and protocol, which allows the user to interact with remote systems. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : sees network connections established using Windows Remote Management. </font><font style="vertical-align: inherit;">Such sessions are detected automatically by the rules.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1220</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : XSL (Extensible Stylesheet Language) script processing</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The XSL markup language is used to describe the processing and visualization of data in XML files. To support complex operations, the XSL standard includes support for embedded scripts in multiple languages. These languages ‚Äã‚Äãallow arbitrary code to be executed, which leads to bypass security policies based on whitelists. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What PT NAD does</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it reveals the facts of transferring such files over the network, that is, even before they are launched. It automatically detects the fact that XSL files are transmitted over the network and files with anomalous XSL markup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the following articles, we will look at how the PT Network Attack Discovery NTA-system finds other tactics and techniques of attackers in accordance with MITER ATT &amp; CK. Stay tuned! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authors</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<ul>
<li> ,     (PT Expert Security Center) Positive Technologies</li>
<li> ,   Positive Technologies</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493070/index.html">Remote. 15 rules for those who have never tried but itch</a></li>
<li><a href="../en493072/index.html">Learning to understand damn fast English speech with Eddie Murphy and Eminem</a></li>
<li><a href="../en493074/index.html">How to find 14 IT employees in 1 month on your own</a></li>
<li><a href="../en493076/index.html">How to quickly transfer a company to remote work: a free online conference of Netology and TalentTech</a></li>
<li><a href="../en493078/index.html">Top 5 Books to Read by a Manager</a></li>
<li><a href="../en493084/index.html">Writing a business process in Bitrix24 with a deposit for the future</a></li>
<li><a href="../en493086/index.html">Kulhacker. Start</a></li>
<li><a href="../en493088/index.html">Parsing a movie theater site on Golang</a></li>
<li><a href="../en493090/index.html">Meet NestJS</a></li>
<li><a href="../en493094/index.html">Amazon warehouse workers sound alarm over coronavirus spread</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>