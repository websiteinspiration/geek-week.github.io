<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì∂ ‚ùï üßëüèª Comment Gatsby a contourn√© Next.js üß£ üòâ üë∂üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'auteur de l'article, dont nous publions la traduction aujourd'hui, travaille comme programmeur √† Antler. Cette soci√©t√© est un g√©n√©rateur mondial de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment Gatsby a contourn√© Next.js</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/500228/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'auteur de l'article, dont nous publions la traduction aujourd'hui, travaille comme programmeur √† Antler. </font><font style="vertical-align: inherit;">Cette soci√©t√© est un g√©n√©rateur mondial de startups. </font><font style="vertical-align: inherit;">Il y a plusieurs jours de d√©monstration √† Antler plusieurs fois par an, r√©unissant de nombreux cr√©ateurs de startups et investisseurs du monde entier. </font><font style="vertical-align: inherit;">La situation autour de COVID-19 a forc√© Antler √† traduire ses √©v√©nements dans un format en ligne.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/hq/r9/an/hqr9anmkfyicv4znlhi2ynk16rm.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'entreprise voulait s'assurer que les visiteurs de leurs √©v√©nements virtuels, sans √™tre distraits par quoi que ce soit, et ne rester coinc√©s nulle part, verraient la chose la plus importante. </font><font style="vertical-align: inherit;">√Ä savoir, les id√©es de startups pr√©sent√©es au public, exprim√©es comme le contenu de pages Web. </font><font style="vertical-align: inherit;">Les journ√©es de d√©monstration virtuelle peuvent int√©resser un public assez large. </font><font style="vertical-align: inherit;">Certains membres de ce public peuvent participer pour la premi√®re fois √† quelque chose comme √ßa. </font><font style="vertical-align: inherit;">Par cons√©quent, l'entreprise devait tout faire de la meilleure fa√ßon possible et fournir un chargement √† grande vitesse des pages repr√©sentant les startups. </font><font style="vertical-align: inherit;">Ils ont d√©cid√© que ce n'est que le cas lorsqu'une application Web progressive haute performance (PWA, Progressive Web App) peut √™tre utile. </font><font style="vertical-align: inherit;">Le principal probl√®me √©tait de trouver la bonne technologie pour d√©velopper la PWA.</font></font><br>
<a name="habracut"></a><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f54/6f9/1fa/f546f91fa52e40c139cc78fe26b1ad06.gif"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendu de serveur ou g√©n√©rateur de site statique?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, je vais vous pr√©senter un peu le cours. Tous nos projets sont bas√©s sur React et la biblioth√®que Material-UI. En cons√©quence, nous avons initialement d√©cid√© de ne pas s'√©carter de cette pile technologique, ce qui nous permettrait d'assurer une vitesse de d√©veloppement √©lev√©e et de rendre le nouveau projet compatible avec ce que nous avons d√©j√†. La principale diff√©rence entre ce nouveau projet et nos autres applications React est que la base de donn√©es pour eux a √©t√© cr√©√©e √† l'aide de l'application create-react et qu'ils ont √©t√© enti√®rement rendus sur le client (CSR, Client-Side Rendering). Cela a notamment conduit au fait que lors du chargement initial de l'application, les utilisateurs √©taient oblig√©s d'observer un √©cran blanc vierge pendant le chargement, le traitement et l'ex√©cution du code JavaScript du projet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avions besoin d'un niveau de performance sans compromis. Par cons√©quent, nous avons commenc√© √† penser √† utiliser le rendu c√¥t√© serveur (SSR, rendu c√¥t√© serveur) ou un g√©n√©rateur de site statique (SSG, Static Site Generator) afin que le chargement initial des applications soit le plus rapide possible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos donn√©es sont stock√©es dans Cloud Firestore, et nous y acc√©dons en utilisant Algolia. Cela nous permet de contr√¥ler, au niveau du champ de la base de donn√©es, l'acc√®s public aux donn√©es avec des cl√©s API restreintes. Cela am√©liore √©galement les performances des requ√™tes. Par exp√©rience, nous savons que les requ√™tes Algolia sont plus rapides que la normale et que le SDK JavaScript Firestore compress√© a une taille de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">86 Ko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans le cas de l'Algolie, c'est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,5 Kb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous voulions rendre les donn√©es que nous donnons aux clients aussi fra√Æches que possible. Cela nous aiderait √† corriger tr√®s rapidement des donn√©es erron√©es qui pourraient √™tre publi√©es accidentellement. Alors que la pratique standard du SSG pr√©voit la mise en ≈ìuvre de demandes de donn√©es pertinentes lors de l'assemblage du projet, nous nous attendions √† ce que dans notre base de donn√©es les donn√©es soient √©crites assez souvent. En particulier, nous parlons d'un enregistrement de donn√©es initi√© par des administrateurs utilisant l'interface </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firetable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et √† l'initiative des fondateurs des projets utilisant le portail web. Cela conduit √† un montage comp√©titif du projet. De plus, en raison des caract√©ristiques structurelles de notre base de donn√©es, des modifications mineures peuvent conduire √† de nouvelles op√©rations d'assemblage de projet. Cela rend notre pipeline CI / CD extr√™mement inefficace. Par cons√©quent, nous avions besoin que les demandes de r√©ception de donn√©es du r√©f√©rentiel soient ex√©cut√©es chaque fois qu'un utilisateur demande le chargement d'une page. Malheureusement, cela signifiait que notre solution ne serait pas un exemple de projet SSG ¬´propre¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialement, notre application a √©t√© cr√©√©e sur la base de Gatsby, car nous utilisions d√©j√† des landing pages construites sur Gatsby, et sur l'une d'elles, la biblioth√®que Material-UI √©tait d√©j√† utilis√©e. </font><font style="vertical-align: inherit;">La premi√®re version du projet a form√© une page qui, pendant le chargement des donn√©es, affichait un "squelette". </font><font style="vertical-align: inherit;">Dans le m√™me temps, la premi√®re peinture contentieuse (FCP) √©tait de l'ordre de 1 seconde.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d75/578/718/d7557871834d0d244f8501327d68810d.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargement du "squelette" de la page avec chargement ult√©rieur des donn√©es</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La solution s'est av√©r√©e int√©ressante, mais elle avait ses inconv√©nients, car les donn√©es de sortie de la page ont √©t√© t√©l√©charg√©es √† l'initiative du client:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour voir le contenu de la page, les utilisateurs devraient attendre le t√©l√©chargement de cette page elle-m√™me et les donn√©es qui y sont affich√©es, obtenues √† travers 4 demandes √† l'Algolia.</font></font></li>
<li>    JS-    .   ,  React   ¬´¬ª      .         DOM.</li>
<li>         .  ,  ,    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, au cours du long week-end, j'ai d√©cid√© d'exp√©rimenter avec la version SSR du projet cr√©√© √† l'aide de Next.js. Heureusement pour moi, la documentation de Material-UI avait un exemple de projet pour Next.js. Par cons√©quent, je n'avais pas besoin d'apprendre tout ce framework √† partir de z√©ro. Je viens de parcourir certaines parties du didacticiel et de la documentation. J'ai converti l'application en un projet rendu sur le serveur. Lorsqu'un utilisateur a demand√© un chargement de page, le serveur a ex√©cut√© les demandes de donn√©es n√©cessaires pour remplir la page. Cette √©tape nous a permis de r√©soudre les trois probl√®mes ci-dessus. Voici les r√©sultats des tests pour deux options d'application.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b60/0da/cda/b600dacda702f25e97808ed9f762ff8c.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sultats de la recherche d'applications √† l'aide de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google PageSpeed ‚Äã‚ÄãInsights</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A gauche se trouve Gatsby (SSG), √† droite se trouve Next.js (SSR) ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image originale</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le FCP pour la version Next.js du projet √©tait environ 3 fois plus √©lev√© que pour sa version bas√©e sur Gatsby. La version Gatsby du projet avait un indice de vitesse de 3,3 secondes, tandis que la version Next.js avait 6,2 secondes. Le temps jusqu'au premier octet (TTFB, Time To First Byte) √©tait de 2,56 secondes lors de l'utilisation de Next.js et de 10-20 ms lors de l'utilisation de Gatsby.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que la version Next.js du site a √©t√© d√©ploy√©e sur un autre service (ici, nous avons utilis√© les services d'h√©bergement ZEIT Now et Firebase - cela pourrait √©galement affecter l'augmentation du TTFB). Mais, malgr√© cela, il √©tait clair que le transfert des op√©rations de t√©l√©chargement de donn√©es vers le serveur faisait appara√Ætre le site plus lentement, malgr√© le fait que tous les documents de la page √©taient charg√©s √† peu pr√®s en m√™me temps. Le fait est que dans la version Next.js du projet, l'utilisateur ne voit pendant un certain temps qu'une page blanche vierge.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e0/8a2/ab3/6e08a2ab3bcb4c06471cc92545848d8a.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'√©cran montrant le chargement de deux versions d'une application. </font><font style="vertical-align: inherit;">Le t√©l√©chargement ne s'est pas termin√© en m√™me temps. </font><font style="vertical-align: inherit;">Les enregistrements sont synchronis√©s d√®s que vous appuyez sur la touche Entr√©e.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tout cela nous donne une le√ßon importante dans le domaine du d√©veloppement Web: vous devez donner aux utilisateurs un retour visuel. </font><font style="vertical-align: inherit;">Une</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©tude a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r√©v√©l√© que les applications qui utilisent des √©crans squelettiques semblent se charger plus rapidement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce r√©sultat, d'ailleurs, ne correspond pas √† l'ambiance que vous auriez pu ressentir si vous lisiez des articles sur le d√©veloppement web au cours des derni√®res ann√©es. </font><font style="vertical-align: inherit;">√Ä savoir, nous parlons du fait qu'il n'y a rien de mal √† utiliser les ressources du client et que le SSR n'est pas une solution compl√®te aux probl√®mes de performances.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performances de g√©n√©ration de site statique: comparaison de Gatsby et Next.js</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors que les deux cadres √† l'√©tude, Gatsby et Next.js, sont connus respectivement pour leur capacit√© √† g√©n√©rer des sites statiques et le rendu de serveur, la </font><font style="vertical-align: inherit;">prise en charge de SSG a √©t√© am√©lior√©e </font><font style="vertical-align: inherit;">dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js 9.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui en fait un concurrent de Gatsby. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment d'√©crire ces lignes, la capacit√© de Next.js √† g√©n√©rer des sites statiques √©tait encore tr√®s r√©cente. Elle avait un peu plus d'un mois. Elle est toujours signal√©e sur la premi√®re page du projet. Maintenant, il n'y a pas beaucoup de comparaisons des capacit√©s SSG de Gatsby et Next.js (ou peut-√™tre qu'il n'y a pas encore de telles comparaisons). En cons√©quence, j'ai d√©cid√© de mener ma propre exp√©rience.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai rendu la version Gatsby du projet √† l'√©tat lorsque les donn√©es ont √©t√© t√©l√©charg√©es sur le client, et j'ai fait en sorte que les deux versions de l'application aient exactement le m√™me ensemble de fonctionnalit√©s. √Ä savoir, j'ai d√ª supprimer ce dont les plugins Gatsby sont responsables: fonctions SEO, g√©n√©ration de favicons, manifeste PWA. Afin de comparer exclusivement les bundles JavaScript cr√©√©s par les frameworks, je n'ai pas inclus dans les projets des images et autres contenus t√©l√©charg√©s depuis des sources externes. Les deux versions de l'application ont √©t√© d√©ploy√©es sur la plate-forme d'h√©bergement Firebase. Pour r√©f√©rence, deux versions de l'application ont √©t√© cr√©√©es sur la base de Gatsby 2.20.9 et Next.js 9.3.4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai ex√©cut√© Lighthouse sur mon ordinateur 6 fois pour chaque version. Les r√©sultats ont montr√© un l√©ger avantage pour Gatsby.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82a/522/059/82a522059afba13a70e62df76144b6e6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valeurs moyennes obtenues apr√®s 6 lancements Lighthouse pour chaque framework ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image originale</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En termes d'√©valuation globale des performances, la version Next.js n'√©tait que l√©g√®rement derri√®re la version Gatsby. Il en va de m√™me pour le FCP et l'indice de vitesse. Le Next First Potential First Input Delay pour la version Next.js de l'application est l√©g√®rement plus √©lev√© que pour la version Gatsby.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de mieux comprendre ce qui se passe, je me suis tourn√© vers l'onglet R√©seau des outils de d√©veloppement Chrome. Il s'est av√©r√© que dans la version Next.js du projet, le nombre de fragments dans lesquels le code JavaScript est divis√© est 3 de plus que dans la version Gatsby (√† l'exclusion des fichiers manifestes), mais le code compress√© est 20 Ko plus petit. Les demandes suppl√©mentaires n√©cessaires pour t√©l√©charger ces fichiers peuvent-elles l'emporter sur les avantages d'un ensemble plus petit au point de nuire aux performances?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/d84/d9a/27bd84d9aad10ae1f3421a0f829c3fa2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la version Gatsby du projet, 7 requ√™tes sont ex√©cut√©es pour t√©l√©charger 379 Ko de donn√©es. Dans la version Next.js du projet - 12 demandes de t√©l√©chargement de 359 Ko de donn√©es ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image d'origine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si vous analysez les performances JavaScript, les outils de d√©veloppement indiquent que la version Next.js du projet a besoin de 300 ms suppl√©mentaires pour le premier rendu, et que cette version passe plus de temps sur la t√¢che √âvaluer le script. Dans les outils du d√©veloppeur, cette t√¢che a m√™me √©t√© marqu√©e comme une ¬´t√¢che longue¬ª.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24b/1be/11c/24b1be11c62fc6a1561a413555e53c0f.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse des performances des diff√©rentes options de projet √† l'aide de l'onglet Performances des outils de d√©veloppement Chrome ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image d'origine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
J'ai compar√© le code du projet pour savoir s'il existe des diff√©rences dans leur impl√©mentation qui pourraient affecter les performances. √Ä l'exception de la suppression du code inutile et des corrections associ√©es aux types TypeScript manquants, la seule diff√©rence √©tait la mise en ≈ìuvre d'un d√©filement fluide de la page lors du d√©placement vers ses parties individuelles. Cette fonctionnalit√© a √©t√© pr√©c√©demment introduite par un fichier</font></font><code>gatsby-browser.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et a √©t√© d√©plac√©e vers un</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> composant import√© dynamiquement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par cons√©quent, ce code ne s'ex√©cuterait que dans un navigateur. (Nous avons utilis√© le package npm √†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©filement lisse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et lors de son importation, il a besoin d'un objet</font></font><code>window</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) Ce probl√®me peut √™tre le coupable, mais je ne sais tout simplement pas comment il est g√©r√© dans Next.js.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby est plus pratique du point de vue du d√©veloppeur</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalement, j'ai d√©cid√© d'opter pour la version Gatsby du projet. De plus, ici, je n'ai pas pris en compte le tr√®s petit avantage de performance que Gatsby a montr√© par rapport au m√©canisme SSG Next.js (je ne me cramponnerai pas s√©rieusement √† l'avantage de 0,6 seconde?). Le fait est que dans la version Gatsby du projet, de nombreuses fonctionnalit√©s PWA sont d√©j√† impl√©ment√©es, et je n'ai pas vu l'int√©r√™t de les impl√©menter √† nouveau dans la version Next.js de l'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque je venais de cr√©er la premi√®re version Gatsby du projet, j'ai pu ajouter rapidement quelques fonctionnalit√©s PWA utiles au projet. Par exemple, pour ajouter √† chaque page mes propres balises META n√©cessaires au r√©f√©rencement, je n'ai eu qu'√† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lire le manuel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour √©quiper le projet d'un manifeste PWA, je n'avais besoin que d'utiliser le </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">plugin</font></a><font style="vertical-align: inherit;"> appropri√©</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Afin d'√©quiper le projet de favicons qui prendraient en charge toutes les plates-formes disponibles (et dans ce cas, il y a toujours un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terrible g√¢chis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), je n'ai m√™me pas eu √† faire quoi que ce soit, car le support favicon fait partie du plugin responsable du manifeste. C'est tr√®s confortable!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'impl√©mentation des m√™mes fonctionnalit√©s dans la version Next.js de l'application n√©cessiterait plus de travail. Il faudrait que je cherche des manuels de formation, toutes sortes de ¬´bonnes pratiques¬ª. Et le fait que je r√©ussirais, de toute fa√ßon, ne me donnerait aucun avantage. Apr√®s tout, n√©anmoins, la version Next.js du projet ne diff√®re pas en performances sup√©rieures √† sa version Gatsby. C'est d'ailleurs la raison pour laquelle j'ai d√©cid√© de simplement d√©sactiver les fonctionnalit√©s correspondantes de la version Gatsby du projet, en la comparant √† la version Next.js. La documentation Next.js est plus concise que la documentation Gatsby (peut-√™tre le fait est que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js est</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus petit que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gatsby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">J'aime beaucoup le tutoriel gamified Next.js. </font><font style="vertical-align: inherit;">Mais la documentation Gatsby plus compl√®te est plus pr√©cieuse avec le d√©veloppement r√©el de PWA, m√™me si √† premi√®re vue elle semble √©norme.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/138/800/0101388008c84ce2dda5f6f8f522cf6d.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentation Gatsby</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vrai, je ne peux pas me taire sur les points forts de Next.js:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gr√¢ce au tutoriel et √† la documentation concise de Next.js, il semble que ce framework puisse √™tre appris plus rapidement que Gatsby.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le syst√®me de chargement de donn√©es utilis√© dans Next.js est bas√© sur des fonctions asynchrones et l'API Fetch. </font><font style="vertical-align: inherit;">Par cons√©quent, lors du d√©veloppement de Next.js, le d√©veloppeur n'a pas le sentiment qu'il a besoin d'apprendre GraphQL afin de tirer pleinement parti des capacit√©s du framework.</font></font></li>
<li> Next.js    TypeScript,      Gatsby        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>).     Next.js      ,     ,        ,        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√¢ce au fait que Next.js a am√©lior√© le support SSG, ce framework est devenu un outil puissant qui permet, au niveau de chaque page individuelle, de choisir la m√©thode de travail avec. </font><font style="vertical-align: inherit;">Il peut s'agir de SSR, SSG ou CSR. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, si je pouvais g√©n√©rer cette application sous une forme compl√®tement statique, Next.js me conviendrait mieux, car je pourrais utiliser l'Algolia JS-API standard et conserver le code de chargement des donn√©es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le m√™me fichier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que et le code du composant. </font><font style="vertical-align: inherit;">√âtant donn√© qu'Algolia n'a pas d'API GraphQL int√©gr√©e et qu'il n'y a pas de plugin Gatsby pour Algolia, l'impl√©mentation d'un tel m√©canisme dans Gatsby n√©cessiterait l'ajout de ce code </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† un nouveau fichier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et cela va √† l'encontre de la mani√®re d√©clarative intuitive de d√©crire les pages.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos des moyens suppl√©mentaires d'am√©liorer les performances du projet</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir r√©solu le probl√®me du choix d'un cadre, il peut √™tre not√© qu'il existe d'autres moyens d'am√©liorer les performances du projet qui ne sont pas li√©s au cadre. </font><font style="vertical-align: inherit;">Ces am√©liorations pourraient bien porter la cote du projet Lighthouse √† 100.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste de diffusion de mars</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algolia </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> il a √©t√© recommand√© d'ajouter un indice </font></font><code>preconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour augmenter encore la vitesse d'ex√©cution des requ√™tes. </font><font style="vertical-align: inherit;">(Vrai, malheureusement, le mauvais fragment de code est donn√© dans la newsletter. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bon code.)</font></font></li>
<li>    .   JS-  CSS-,  webpack- Gatsby.   Gatsby  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>   .  ,       ,   Netlify  Amazon S3. ,  Firebase Hosting,  ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous utilisons des images JPEG et PNG t√©l√©charg√©es par les cr√©ateurs de startups dans l'application. </font><font style="vertical-align: inherit;">Nous ne les compressons pas et ne les optimisons pas. </font><font style="vertical-align: inherit;">L'am√©lioration de cet aspect de notre application est tout un d√©fi et d√©passe la port√©e de ce projet. </font><font style="vertical-align: inherit;">De plus, ce serait g√©nial si toutes ces images √©taient converties au format WebP. </font><font style="vertical-align: inherit;">Par cons√©quent, nous devions stocker des images en utilisant un seul format graphique tr√®s efficace. </font><font style="vertical-align: inherit;">Malheureusement, comme pour de nombreuses autres fonctionnalit√©s PWA, l'√©quipe de d√©veloppement de Safari WebKit cr√©e une d√©pendance avec le support WebP. </font><font style="vertical-align: inherit;">Maintenant, c'est le seul navigateur majeur qui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne prend pas en charge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ce format.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous r√©sumons bri√®vement ce dont nous parlions ici, nous pouvons dire ce qui suit:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La sortie de la version "squelettique" de la page pendant le chargement des donn√©es par le client cr√©e √† l'utilisateur un sentiment de fonctionnement plus rapide du site Web que lorsque l'utilisateur regarde une page vierge pendant que le serveur charge les donn√©es.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La version gatsby du site n'√©tait que l√©g√®rement plus rapide que la version Next.js. </font><font style="vertical-align: inherit;">Cependant, le syst√®me de plug-in Gatsby et la documentation de projet de haute qualit√© augmentent la convivialit√© de ce cadre pour le d√©veloppeur.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez-vous des g√©n√©rateurs de sites statiques ou des syst√®mes de rendu c√¥t√© serveur pour acc√©l√©rer vos projets?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500216/index.html">Oubliez l'Anthropoc√®ne: nous sommes entr√©s dans l'√®re de la synth√®se</a></li>
<li><a href="../fr500218/index.html">Mod√®le √©pid√©miologique Covid-19</a></li>
<li><a href="../fr500220/index.html">Disques vinyle et cassettes directement dans votre Android</a></li>
<li><a href="../fr500222/index.html">T√©l√©phones sans fil des biplans britanniques de la Premi√®re Guerre mondiale</a></li>
<li><a href="../fr500224/index.html">Nez √©lectronique DIY</a></li>
<li><a href="../fr500232/index.html">Apprendre Akka.NET: serveur d'un jeu en ligne simple</a></li>
<li><a href="../fr500234/index.html">Pourquoi j'ai fait un projet de comptabilit√© des d√©penses personnelles pour Git + JS</a></li>
<li><a href="../fr500238/index.html">Dis moi ce qui te tracasse</a></li>
<li><a href="../fr500244/index.html">En dehors du tableau</a></li>
<li><a href="../fr500246/index.html">Protection et piratage de la Xbox 360 (partie 3)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>