<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🔧 👴🏾 🆎 So erstellen Sie eine benutzerdefinierte Ansicht für alert (), verify () und prompt () zur Verwendung in JavaScript 🚒 🤲🏽 🏦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich habe lange darüber nachgedacht, das Erscheinungsbild typischer Benutzerinteraktionsfunktionen in JavaScript anzupassen - alert (), verify () und p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>So erstellen Sie eine benutzerdefinierte Ansicht für alert (), verify () und prompt () zur Verwendung in JavaScript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496372/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe lange darüber nachgedacht, das Erscheinungsbild typischer Benutzerinteraktionsfunktionen in JavaScript anzupassen - alert (), verify () und prompt () (im Folgenden: modale Fenster). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Tat sind sie sehr bequem zu bedienen, unterscheiden sich jedoch in verschiedenen Browsern und sehen sehr unansehnlich aus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich erreichten die Hände. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist das Problem? Die üblichen Methoden zum Anzeigen von Dialogen (z. B. Bootstrap) können nicht so einfach verwendet werden wie Alarme, bei denen der Browser dafür sorgt, dass der JavaScript-Code nicht mehr ausgeführt wird und auf das Handeln des Benutzers wartet (klicken Sie auf die Schaltfläche zum Schließen). Modal in Bootstrap erfordert eine separate Ereignisbehandlung - Klicken Sie auf eine Schaltfläche und schließen Sie ein modales Fenster ...</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotzdem habe ich bereits die Anpassung von Warnungen in Spielen verwendet, um Standardnachrichten durch solche zu ersetzen, die dem Stil des Spieldesigns entsprechen. Dies funktioniert gut, einschließlich Verbindungsfehlermeldungen und anderer Systemsituationen. Dies funktioniert jedoch nicht, wenn der Benutzer auf eine Antwort warten muss!</font></font><br>
<img src="https://habrastorage.org/webt/c4/mc/c_/c4mcc_awjvsbs6hpwucvdcylisu.png" alt="Bild"><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Aufkommen von Promise in ECMAScript 6 (ES6) ist alles möglich! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe den Ansatz angewendet, das Design von modalen Fenstern und Code (alert (), verify () und prompt ()) zu trennen. </font><font style="vertical-align: inherit;">Sie können jedoch alles im Code ausblenden. </font><font style="vertical-align: inherit;">Was einen solchen Ansatz anzieht - das Design kann in verschiedenen Projekten geändert werden, aber einfach auf verschiedenen Seiten oder je nach Situation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der schlechte Punkt bei diesem Ansatz ist die Notwendigkeit, Markup-Namen (ID) im Code von Modalfenstern und sogar im globalen Bereich zu verwenden. </font><font style="vertical-align: inherit;">Dies ist jedoch nur ein Beispiel für das Prinzip, daher werde ich mich nicht darauf konzentrieren.</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Den Code für die Warnung erhalten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns also das Markup (Bootstrap und Font Awesome für Schriftsymbole) und den Warncode (ich verwende jQuery) an:</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromiseAlert"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-exclamation-triangle text-warning"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>The app reports<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-secondary"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.alert = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromiseAlert .modal-body p'</span>).html(message);
        <span class="hljs-keyword">var</span> PromiseAlert = $(<span class="hljs-string">'#PromiseAlert'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromiseAlert.on(<span class="hljs-string">'hidden.bs.modal'</span>, resolve);<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie oben erwähnt, werden der globale Name PromiseAlert und die HTML-Markup-Klassen für den Code verwendet. In der ersten Codezeile wird der Alarmfunktionsparameter an den Nachrichtentext übergeben. Danach zeigt die Bootstrap-Methode ein modales Fenster mit bestimmten Optionen an (sie bringen es näher an die native Warnung). Wichtig! Das modale Fenster wird in einer lokalen Variablen gespeichert, die unten durch Schließen verwendet wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich wird es als Ergebnis eines Alarmversprechens erstellt und zurückgegeben, in dem als Ergebnis des Schließens des modalen Fensters dieses Versprechen ausgeführt wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun wollen wir sehen, wie diese Warnung verwendet werden kann:</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'p a[href="#"]'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Promise based alert sample'</span>);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel wird eine Meldung angezeigt, wenn Sie auf leere Links in Absätzen klicken. Aufpassen! Um der Spezifikation zu entsprechen, muss der Alert-Funktion das Schlüsselwort await vorangestellt werden. Sie kann nur innerhalb der Funktion mit dem Schlüsselwort async verwendet werden. Auf diese Weise können Sie erwarten, dass an dieser Stelle (das Skript stoppt, wie im Fall der nativen Warnung) das modale Fenster geschlossen wird.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was passiert, wenn dies nicht getan wird? </font><font style="vertical-align: inherit;">Hängt von der Logik Ihrer Anwendung ab (ein Beispiel für einen solchen Ansatz in der obigen Abbildung). </font><font style="vertical-align: inherit;">Wenn dies das Ende des Codes ist oder weitere Aktionen des Codes die Seite nicht überladen, ist wahrscheinlich alles in Ordnung! </font><font style="vertical-align: inherit;">Das modale Fenster hängt ab, bis der Benutzer es schließt. </font><font style="vertical-align: inherit;">Wenn es jedoch noch modale Fenster gibt oder wenn die Seite neu geladen wird, gibt es einen Übergang zu einer anderen Seite, dann sieht der Benutzer Ihr modales Fenster einfach nicht und die Logik wird zerstört. </font><font style="vertical-align: inherit;">Ich kann sagen, dass aus Erfahrung Nachrichten über verschiedene Serverfehler (Status) oder aus Codebibliotheken mit unserer neuen Warnung recht gut funktionieren, obwohl sie nicht auf Warten warten.</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir entwickeln einen Ansatz zur Bestätigung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen wir weiter. </font><font style="vertical-align: inherit;">Bestätigen kann ohne Zweifel nur in der asynchronen / wartenden Bindung verwendet werden, da </font><font style="vertical-align: inherit;">Er muss dem Code das Ergebnis der Wahl des Benutzers mitteilen. </font><font style="vertical-align: inherit;">Dies gilt auch für Eingabeaufforderungen. </font><font style="vertical-align: inherit;">Also bestätigen Sie:</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromiseConfirm"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-check-circle text-success"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Confirm app request<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.confirm = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromiseConfirm .modal-body p'</span>).html(message);
        <span class="hljs-keyword">var</span> PromiseConfirm = $(<span class="hljs-string">'#PromiseConfirm'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);
        <span class="hljs-keyword">let</span> confirm = <span class="hljs-literal">false</span>;<font></font>
        $(<span class="hljs-string">'#PromiseConfirm .btn-success'</span>).on(<span class="hljs-string">'click'</span>, e =&gt; {<font></font>
            confirm = <span class="hljs-literal">true</span>;<font></font>
        });<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromiseConfirm.on(<span class="hljs-string">'hidden.bs.modal'</span>, (e) =&gt; {<font></font>
                resolve(confirm);<font></font>
            });<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt nur einen Unterschied - wir müssen über die Wahl des Benutzers informieren. </font><font style="vertical-align: inherit;">Dies erfolgt mit einer anderen lokalen Variablen im Abschluss - bestätigen. </font><font style="vertical-align: inherit;">Wenn die Bestätigungstaste gedrückt wird, wird die Variable auf true gesetzt und ihr Wert ist standardmäßig false. </font><font style="vertical-align: inherit;">Wenn Sie das Schließen eines modalen Fensters verarbeiten, gibt resolve diese Variable zurück. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die Verwendung (erforderlich mit async / await):</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'p a[href="#"]'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> confirm(<span class="hljs-string">'Want to test the Prompt?'</span>)) {
            <span class="hljs-keyword">let</span> prmpt = <span class="hljs-keyword">await</span> prompt(<span class="hljs-string">'Entered value:'</span>);
            <span class="hljs-keyword">if</span> (prmpt) <span class="hljs-keyword">await</span> alert(<span class="hljs-string">`entered: «<span class="hljs-subst">${prmpt}</span>»`</span>);
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Do not enter a value'</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Promise based alert sample'</span>);<font></font>
    });<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weitermachen - ein Ansatz für die Aufforderung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die obige Logik wird auch mit der Testaufforderung implementiert. </font><font style="vertical-align: inherit;">Und sein Markup und seine Logik sind wie folgt:</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromisePrompt"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-question-circle text-primary"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Prompt request<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"PromisePromptInput"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromisePromptInput"</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.prompt = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromisePrompt .modal-body label'</span>).html(message);
        <span class="hljs-keyword">var</span> PromisePrompt = $(<span class="hljs-string">'#PromisePrompt'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);<font></font>
        $(<span class="hljs-string">'#PromisePromptInput'</span>).focus();
        <span class="hljs-keyword">let</span> prmpt = <span class="hljs-literal">null</span>;<font></font>
        $(<span class="hljs-string">'#PromisePrompt .btn-success'</span>).on(<span class="hljs-string">'click'</span>, e =&gt; {<font></font>
            prmpt = $(<span class="hljs-string">'#PromisePrompt .modal-body input'</span>).val();<font></font>
        });<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromisePrompt.on(<span class="hljs-string">'hidden.bs.modal'</span>, (e) =&gt; {<font></font>
                resolve(prmpt);<font></font>
            });<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Unterschied zwischen Logik und Bestätigung ist minimal. </font><font style="vertical-align: inherit;">Eine zusätzliche lokale Variable im Abschluss ist prmpt. </font><font style="vertical-align: inherit;">Und es hat keinen logischen Wert, sondern eine Zeichenfolge, die der Benutzer eingibt. </font><font style="vertical-align: inherit;">Durch die Schließung löst sich sein Wert auf. </font><font style="vertical-align: inherit;">Und ein Wert wird ihm nur zugewiesen, wenn die Bestätigungstaste gedrückt wird (aus dem Eingabefeld). </font><font style="vertical-align: inherit;">Übrigens habe ich hier eine andere globale Variable verschwendet, PromisePromptInput, nur für Kurzschrift und alternativen Code. </font><font style="vertical-align: inherit;">Damit setze ich den Eingabefokus (obwohl dies in einem einzigen Ansatz erfolgen kann - entweder auf die gleiche Weise oder wie beim Abrufen des Werts). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können diesen Ansatz in Aktion versuchen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Der Code befindet sich unter dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sieht ungefähr so ​​aus (obwohl der obige Link vielfältiger ist):</font></font><br>
<img src="https://habrastorage.org/webt/5o/zl/rc/5ozlrc4mvo0cep-tb-lesrsrltk.png" alt="Bild"><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aids</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie beziehen sich nicht direkt auf das Thema des Artikels, zeigen jedoch die volle Flexibilität des Ansatzes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies schließt Bootstrap-Themen ein. </font><font style="vertical-align: inherit;">Ich habe freie Themen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie die Sprache mithilfe der automatischen Installation entsprechend der Browsersprache. </font><font style="vertical-align: inherit;">Es gibt drei Modi - automatisch (über Browser), Russisch oder Englisch (erzwungen). </font><font style="vertical-align: inherit;">Die Maschine ist standardmäßig installiert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cookies ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) Ich habe mir das Thema und den Sprachwechsel gemerkt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Themen wechseln einfach durch Installieren des href css-Segments von der oben genannten Site:</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'#themes a.dropdown-item'</span>).on(<span class="hljs-string">'click'</span>, (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item'</span>).removeClass(<span class="hljs-string">'active'</span>);<font></font>
        e.currentTarget.classList.add(<span class="hljs-string">'active'</span>);
        <span class="hljs-keyword">var</span> cur = e.currentTarget.getAttribute(<span class="hljs-string">'href'</span>);
        <span class="hljs-built_in">document</span>.head.children[<span class="hljs-number">4</span>].href = <span class="hljs-string">'https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/'</span> + cur + <span class="hljs-string">'bootstrap.min.css'</span>;
        <span class="hljs-keyword">var</span> ed = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<font></font>
        ed.setFullYear(ed.getFullYear() + <span class="hljs-number">1</span>);<font></font>
        setCookie(<span class="hljs-string">'WebApplicationPromiseAlertTheme'</span>, cur, ed);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, ich erinnere mich an Cookies zur Wiederherstellung beim Booten:</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">var</span> cookie = getCookie(<span class="hljs-string">'WebApplicationPromiseAlertTheme'</span>);
    <span class="hljs-keyword">if</span> (cookie) {<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item'</span>).removeClass(<span class="hljs-string">'active'</span>);<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item[href="'</span> + cookie + <span class="hljs-string">'"]'</span>).addClass(<span class="hljs-string">'active'</span>);
        <span class="hljs-built_in">document</span>.head.children[<span class="hljs-number">4</span>].href = <span class="hljs-string">'https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/'</span> + cookie + <span class="hljs-string">'bootstrap.min.css'</span>;<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Lokalisierung habe ich die Datei localization.json verwendet, in der ich ein Wörterbuch mit Schlüsseln auf Englisch und deren Werten auf Russisch erstellt habe. </font><font style="vertical-align: inherit;">Der Einfachheit halber (obwohl das Markup an einigen Stellen komplizierter geworden ist) überprüfe ich während der Übersetzung nur reine Textknoten und ersetze den Schlüssel durch Werte.</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">var</span> translate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#cultures .dropdown-toggle samp'</span>).text({ <span class="hljs-attr">ru</span>: <span class="hljs-string">'  '</span>, <span class="hljs-attr">en</span>: <span class="hljs-string">' English '</span> }[culture]);
        <span class="hljs-keyword">if</span> (culture == <span class="hljs-string">'ru'</span>) {
            <span class="hljs-keyword">let</span> int;
            <span class="hljs-keyword">if</span> (localization) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> el <span class="hljs-keyword">of</span> <span class="hljs-built_in">document</span>.all)
                    <span class="hljs-keyword">if</span> (el.childElementCount == <span class="hljs-number">0</span> &amp;&amp; el.textContent) {
                        <span class="hljs-keyword">let</span> text = localization[el.textContent];
                        <span class="hljs-keyword">if</span> (text) el.textContent = text;<font></font>
                    }<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> int = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (localization) {<font></font>
                    translate();<font></font>
                    clearInterval(int);<font></font>
                }<font></font>
            }, <span class="hljs-number">100</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> location.reload();<font></font>
    };<font></font>
    <span class="hljs-keyword">if</span> (culture == <span class="hljs-string">'ru'</span>) translate();
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Produktion ist das kaum gut (besser auf dem Server), aber hier kann ich alles auf dem Client demonstrieren. </font><font style="vertical-align: inherit;">Ich greife nur auf den Server zu, wenn ich von Russisch auf Englisch wechsle. Ich überlade nur das ursprüngliche Markup (location.reload). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Letzteres wird erwartungsgemäß die Nachricht in onbeforeunload gemäß dem Browser-Algorithmus ausgegeben, und unsere Bestätigung hat keinen Einfluss darauf. </font><font style="vertical-align: inherit;">Am Ende des Codes befindet sich eine kommentierte Version einer solchen Nachricht. Sie können sie ausprobieren, wenn Sie sie selbst übertragen.</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-comment">//window.onbeforeunload = function (e) {</span>
    <span class="hljs-comment">//    e.returnValue = 'Do you really want to finish the job?';</span>
    <span class="hljs-comment">//    return e.returnValue;</span>
    <span class="hljs-comment">//};</span>
</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496360/index.html">BFCache oder Hin und zurück. Yandex-Bericht</a></li>
<li><a href="../de496362/index.html">Masken zurückgesetzt</a></li>
<li><a href="../de496366/index.html">Miniserie: Ternärer Heimwerker-Computer</a></li>
<li><a href="../de496368/index.html">Das australische Startup entwickelt Hybrid-PCs aus elektronischen und biologischen Komponenten</a></li>
<li><a href="../de496370/index.html">Die Freuden und Sorgen der Siege über C: Wir stellen Süßigkeiten aus dem Prototyp wc auf Haskell her</a></li>
<li><a href="../de496376/index.html">Quartett 9: Allegro | Kürze und Einfachheit</a></li>
<li><a href="../de496380/index.html">Notfallwiederherstellung und Migration mit VMware vCloud Availability. Teil 2</a></li>
<li><a href="../de496384/index.html">IT-Mitarbeiter unter Quarantäne: Persönliche Erfahrung aus verschiedenen Ländern</a></li>
<li><a href="../de496386/index.html">Die ersten Schritte in Spring, Rest API, konzentrieren sich auf PUT in Verbindung mit dem Frontend</a></li>
<li><a href="../de496388/index.html">Es gibt keine gesunden Menschen, es gibt wenig untersuchte: Frühdiagnose einer koronaren Herzkrankheit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>