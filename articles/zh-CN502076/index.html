<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🏭 😱 🚑 台车机器人2.0。第1部分。基于ROS的家用机器人的自主导航 😷 👩🏼 🖖🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="该项目是基于其圈子中另一个知名项目linorobot（linorobot.org）构建的，它使用了简单的外行可以使用的组件。设定的目标：使用低成本组件实现机器人在家中的自主移动，评估用于所述目的的微型PC的性能，配置导航堆栈以在赫鲁晓夫的狭窄空间中移动。
 
 
 
 铁
 固体中的组分列表如下：
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>台车机器人2.0。第1部分。基于ROS的家用机器人的自主导航</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502076/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该项目是基于其圈子中另一个知名项目linorobot（linorobot.org）构建的，它使用了简单的外行可以使用的组件。</font><font style="vertical-align: inherit;">设定的目标：使用低成本组件实现机器人在家中的自主移动，评估用于所述目的的微型PC的性能，配置导航堆栈以在赫鲁晓夫的狭窄空间中移动。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OGxB34-heds" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">铁</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
固体中的组分列表如下：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">树莓pi 3b-2800 r .;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">激光雷达rplidar a1-7500羽；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动力桥l298n -2pcs-400擦。;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带A和B型编码器的轮对-2000 r。</font><font style="vertical-align: inherit;">（210 rpm- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teenzy 3.2-2100 r。;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imu 9250（9150或6050）-240页；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10000mH-1500 r的移动电源。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3个电池18650和固定器-600 p。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">降压转换器dc-dc c 5V至3.3V-20p。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一块胶合板，镶木地板？</font><font style="vertical-align: inherit;">擦。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
总计：17160羽 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*用arduino mega 2560（600 p。）代替teenzy可以降低成本，而用kinect v.1（1000 p。）代替激光雷达可以降低成本：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ec/vb/v4/ecvbv42ipnldzd5vhureodavsqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，应注意的是，第一种kinect的最小可见度（盲区）为0.5 m，在狭窄的条件下可能会对导航产生负面影响，而且体积很大。</font><font style="vertical-align: inherit;">激光雷达的盲区小于0.2 m。Kinect v.2将不适合覆盆子3b（不具有USB 3.0）。</font><font style="vertical-align: inherit;">Arduino mega的大小（和某些特性）不及teenzy，此外，您还必须对代码稍做修改。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，“设计”如下所示：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ou/ru/x9/ourux9icibrxsh4ruai61e3wkx4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yg/bh/0h/ygbh0hlvz8juq6qi4e9tarrhznq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，这里没有美，但这并不是关于美的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了机器人本身之外，非常需要有一台外部PC，在其上将启动用于可视化机器人动作的图形化外壳（rviz，凉亭）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机器人组装</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它是在项目网站上详细绘出的- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此让我们关注引起困难的要点。</font><font style="vertical-align: inherit;">首先，您需要考虑到轮对上的编码器由3.3V供电，并且当施加5V电压时，它会完全失效。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
linorobot安装脚本已成功安装在ubuntu 16.04，ubuntu 18.04上。</font><font style="vertical-align: inherit;">ROS版本：ROS动力学或ROS旋律。</font><font style="vertical-align: inherit;">在树莓3b上，您必须首先创建一个交换文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主要的teenzy代码是这样的：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware/lib/config<font></font>
nano lino_base_config.h<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并使用以下命令将其倒入其中：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware<font></font>
platformio run --target upload<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上面的命令捆绑包将经常使用，因此将它们添加到别名是有意义的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于组装机器人的困难，从1298n到teenzy的连接触点的正确关联可能会很麻烦。</font><font style="vertical-align: inherit;">尽管接线图非常清晰，但车轮仍可能表现不同，必须进行试验，在代码中选择正确的引脚分配。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就我而言，结果是这样的：</font></font><br>
<br>
<pre><code class="bash hljs">/// ENCODER PINS
<span class="hljs-comment">#define MOTOR1_ENCODER_A 14</span>
<span class="hljs-comment">#define MOTOR1_ENCODER_B 15 </span><font></font>
<font></font>
<span class="hljs-comment">#define MOTOR2_ENCODER_A 11</span>
<span class="hljs-comment">#define MOTOR2_ENCODER_B 12 </span><font></font>
//MOTOR PINS<font></font>
<span class="hljs-comment">#ifdef USE_L298_DRIVER</span>
  <span class="hljs-comment">#define MOTOR_DRIVER L298</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR1_PWM 21</span>
  <span class="hljs-comment">#define MOTOR1_IN_A 1</span>
  <span class="hljs-comment">#define MOTOR1_IN_B 20</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR2_PWM 5</span>
  <span class="hljs-comment">#define MOTOR2_IN_A 8</span>
  <span class="hljs-comment">#define MOTOR2_IN_B 6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二点是规定机器人轮子的规格：</font></font><br>
<br>
<pre><code class="bash hljs">//define your robot<span class="hljs-string">' specs here
#define MAX_RPM 210               // motor'</span>s maximum RPM
<span class="hljs-comment">#define COUNTS_PER_REV 1365       // wheel encoder's no of ticks per rev</span>
<span class="hljs-comment">#define WHEEL_DIAMETER 0.065       // wheel's diameter in meters</span>
<span class="hljs-comment">#define PWM_BITS 8                // PWM Resolution of the microcontroller</span>
<span class="hljs-comment">#define LR_WHEELS_DISTANCE 0.235  // distance between left and right wheels</span>
<span class="hljs-comment">#define FR_WHEELS_DISTANCE 0.30   // distance between front and rear wheels. Ignore this if you're on 2WD/ACKERMANN</span>
<span class="hljs-comment">#define MAX_STEERING_ANGLE 0.415  // max steering angle. This only applies to Ackermann st</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RPM可以在车轮规格中找到，但CPR（COUNTS_PER_REV）是计算得出的值。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPR = PPR x4。我们的车轮的PPR341。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR可以在规格中查看，也可以在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roslaunch linorobot minimal.launch机器人</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上运行代码</font><font style="vertical-align: inherit;">并将车轮旋转360度。 PPR等于车轮旋转后将在屏幕上显示的数值：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/7z/ks/be7zksecqhlyuyv-e_dkxqdyrwe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR = abs（RECENT_COUNT-INITIAL_COUNT）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此CPR =1364。您还需要以米为单位设置WHEEL_DIAMETER和LR_WHEELS_DISTANCE。此外，LR_WHEELS_DISTANCE是车轮中心轴之间的距离，而不是边缘之间的距离。如果机器人是两轮差速器（不是全向），则其他指示器可以忽略。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第三点可能会造成困难</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-IMU校准</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。为此，请按照说明将机器人固定在特定位置。当执行</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosrun imu_calib do_calib脚本</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，提示将出现在代码中</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/fj/9e/ggfj9eg71ilp0baj7rvshjl-fmw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成后，将生成带有设置的imu_calib.yaml。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管存在带有imu设置的默认文件，但执行校准还是更好的选择。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*此外，事实证明，imu校准会通过伸缩影响机器人的运动方向（左移而不是右移，反之亦然，来回移动正确）。不能通过重新布置代码中的引脚来解决这种情况。 Imu本身是固定的，并使用上下颠倒的支架进行了校准，因为固定在机器人基座的背面。他的（imu）进一步翻转而无需重新校准即可解决问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第四点</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-PID校准</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在项目网站上，详细</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明了如何执行调整的过程</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，初学者很难弄清楚它是什么以及如何使用它。</font><font style="vertical-align: inherit;">通常，需要进行快速调节以确保机器人均匀移动，而不会发生抽动/突然制动的情况。</font><font style="vertical-align: inherit;">三个参数对此负责：p，i，d。</font><font style="vertical-align: inherit;">它们的值包含在上传到teenzy的主要代码中：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define K_P 2.0 // P constant angle</span>
<span class="hljs-comment">#define K_I 0.3 // I constant</span>
<span class="hljs-comment">#define K_D 0.1 // D constant</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以通过在机器人上运行来进行实验：</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot minimal.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在外部PC上的三个不同终端中：</font></font><br>
<br>
<pre><code class="bash hljs">rosrun lino_pid pid_configure<font></font>
rosrun teleop_twist_keyboard teleop_twist_keyboard.py<font></font>
rqt<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过在rqt终端中移动滑块p，d，i，然后在teleop_twist_keyboard终端中控制机械手，您可以实现必要的结果，而不必每次都以teenzy的形式使用新的pid参数下载代码：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/9m/ef/qr9mefipf7mqz9vwqqyqkktkeug.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也就是说，一切都</font><font style="vertical-align: inherit;">在进行</font><font style="vertical-align: inherit;">中，并且当时在固件中进行teenzy可能具有完全不同的含义。</font><font style="vertical-align: inherit;">*您不能专注于图表，因为 </font><font style="vertical-align: inherit;">视觉上，因此可以理解机器人如何运行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他们建议从设置值p = 1.0，d = 0.1，i = 0.1开始。</font><font style="vertical-align: inherit;">在我们的情况下，值如下（通过实验获得）p = 2.0，i = 0.3，d = 0.1。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，必须在代码中设置这些值并填写teenzy。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，不要忘记在代码中进行设置（DEBUG 0代替DEBUG 1）：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define DEBUG 0</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">里程表</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了确定机器人的方向并进行后续导航，使用了激光雷达数据，imu和车轮编码器数据。如果正确执行了imu校准，正确安装了激光雷达并且编码器值正确，则里程表应该没有问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要验证里程表是否正确，您需要通过望远镜在机器人上骑一点点，然后查看odom主题中的值，该主题写在项目页面</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并查看rviz的可视外壳：rviz中的</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/td/si/rrtdsilkdlggf3ifjhk1uhl8bz0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个单元格为1 m，因此建议机器人在可视编辑器和实物中都通过该仪表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，行进距离还显示在指示器w中：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/oj/l6/i1ojl6vg5jyugymjwgk-5cfsrlm.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也应趋向于1 m，</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这同样适用于机器人的旋转角度：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l0/uf/bv/l0ufbvhsko99na50frablnrvsc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*在rviz和live中，机器人必须以相同角度旋转。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
激光雷达的</font><font style="vertical-align: inherit;">里程表</font><font style="vertical-align: inherit;">以类似的方式定义- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从激光雷达到最近的活壁和rviz壁的距离应该匹配。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在ROS中，特别注意转换-tf。</font><font style="vertical-align: inherit;">概括而言，该概念描述了空间中物体彼此之间的相互关系。</font><font style="vertical-align: inherit;">为了使物体不会悬空，并且程序了解它们是如何相对显示的，您需要注意tf设置。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在项目中，所有tf连接都已经相对于彼此进行了配置，您只需要调整指示器即可，例如，指示激光雷达的位置。</font><font style="vertical-align: inherit;">对于机器人来说，必须了解到障碍物不是直接出现在他的前方，而是出现在激光雷达的前方，激光雷达与机器人的中心隔开一定距离。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们转到适当的目录：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch<font></font>
nano bringup.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
底座本身与地板的距离为0.065 m：</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_footprint_to_base_link"</span> args=<span class="hljs-string">"0 0 0.065 0 0 0  /base_footprint /base_link "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在laser.launch中，您需要设置激光雷达相对于机器人基座中心的位置：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch/include<font></font>
nano laser.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我的情况下，激光雷达沿x轴移动：-0.08，y：0.04，并在基座上方（z轴）“上升”：0.08m：</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf2_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_link_to_laser"</span>
args=<span class="hljs-string">"-0.08 0.04 0.08 0 0 0  /base_link /laser "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在rviz中，可以从视觉上观察到此位置：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1v/rz/gj/1vrzgjmhx-gf-jar7jxfbhcovte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
虽然距离激光雷达不远，</font><font style="vertical-align: inherit;">但我们将调整</font><font style="vertical-align: inherit;">其频率，使其发出更多点（默认情况下为4k），这将有助于构建地图：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> linorobot/launch/include/lidar<font></font>
nano rplidar.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添加参数：</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"scan_mode"</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Boost"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并改变 </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"angle_compensate"</span>    <span class="hljs-attr">type</span>=<span class="hljs-string">"bool"</span>   <span class="hljs-attr">value</span>=<span class="hljs-string">"false"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们可以使用8k：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/u0/fq/zfu0fqd4d7nwmuv50am1qhwqxbm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
激光雷达在机器人上的物理位置也很重要：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/46/mw/vq/46mwvqq3kj7nxpskvoadm7xe738.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建立2D房间地图</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
建议在项目网站上通过在两个终端中启动来构建房间地图：</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot bringup.launch<font></font>
roslaunch linorobot slam.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，实践表明，默认情况下该项目附带的slam在激光雷达模式为8k时拒绝工作：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/xa/a5/zexaa5f_1byvgcvvvkvcr7cowbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在4k模式下，插卡效果不佳，但噪音很大。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，最好使用另一个猛击-hector-slam。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">此处</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
指示如何安装</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
安装后，创建地图的过程将是相同的，但是运行roslaunch my_hector_mapping my_launch.launch可以代替roslaunch linorobot slam.launch，运行roslaunch my_hector_mapping my_launch.launch </font><font style="vertical-align: inherit;">
地图会更干净，但是最好在图形编辑器中进行修改，删除不必要的地图，尤其是在构建地图时激光雷达与镜子碰撞时。 ：</font><font style="vertical-align: inherit;">
别忘了保存房间地图：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/zo/jv/cnzojvfwpkwgldoo3mylfwwh-yg.jpeg"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">rosrun map_server map_saver -f my-map
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*在宜人的暮光下可以更好地获取地图，这将使预算激光雷达的收益最大化。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
未完待续。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN502056/index.html">如何构建智能家居而不是疯狂</a></li>
<li><a href="../zh-CN502066/index.html">每个人都应该知道的简单控制台命令</a></li>
<li><a href="../zh-CN502068/index.html">电脑上的110伏</a></li>
<li><a href="../zh-CN502070/index.html">宾得的历史（文章和视频）</a></li>
<li><a href="../zh-CN502072/index.html">使用JavaScript和指南针对接ISS</a></li>
<li><a href="../zh-CN502080/index.html">看板方法：示例PNZ No.1，启动中的测量研究过程</a></li>
<li><a href="../zh-CN502084/index.html">通过伪装者检查负载下的区域公共服务门户</a></li>
<li><a href="../zh-CN502086/index.html">设置Minio，以便用户只能使用自己的存储桶</a></li>
<li><a href="../zh-CN502088/index.html">浪费时间和浪费的故事。根据py3</a></li>
<li><a href="../zh-CN502092/index.html">俄罗斯联邦对数字信任服务的技术和法规支持</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>