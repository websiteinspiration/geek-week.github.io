<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎅🏻 👨🏼‍🚀 ✊🏻 OpenToonz：由内而外 👟 ⚖️ 📞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="自从PVS-Studio验证OpenToonz源代码以来，已经过去了将近四年。该项目是用于创建二维动画的非常强大的工具。自上次检查以来，在他的帮助下，创作了诸如玛丽与女巫之花，蝙蝠侠忍者，普罗玛雷等动画作品。由于大型工作室继续使用Toonz，为什么不再次检查源代码的质量？
 
 您可以在文章“ 用于...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenToonz：由内而外</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/494220/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dea/ccf/6dd/deaccf6dded129be42e3f458e2457c48.png" alt="image1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自从PVS-Studio验证OpenToonz源代码以来，已经过去了将近四年。</font><font style="vertical-align: inherit;">该项目是用于创建二维动画的非常强大的工具。</font><font style="vertical-align: inherit;">自上次检查以来，在他的帮助下，创作了诸如玛丽与女巫之花，蝙蝠侠忍者，普罗玛雷等动画作品。</font><font style="vertical-align: inherit;">由于大型工作室继续使用Toonz，为什么不再次检查源代码的质量？</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以在文章“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于创建Toonz的2D动画的程序包的错误代码</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”中熟悉以前的错误分析</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常，似乎代码的质量似乎并没有改善很多，因此总体印象并不更好。</font><font style="vertical-align: inherit;">此外，发现了许多与上一篇文章相同的错误。</font><font style="vertical-align: inherit;">我们将不再考虑它们，因为有很多选择。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，您必须了解，错误的存在并不一定会阻止软件产品的积极有效地使用。发现的错误很可能存在于很少使用或完全未使用的代码部分中，否则它们将在使用应用程序的过程中被识别并修复。但是，这并不意味着静态分析是多余的。仅仅是静态分析的意思不是寻找旧的和不相关的错误，而是减少开发过程的成本。可以立即检测到编写代码时发生的许多错误，而不是在软件运行期间发现。因此，通过定期使用静态分析仪，可以在早期纠正错误。这样既节省了开发人员的时间，又节省了公司的资金，并改善了用户体验。同意，不断退订开发人员是不愉快的，一件事或另一件事不起作用。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N1 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V610</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未定义的行为。</font><font style="vertical-align: inherit;">检查移位运算符“ &lt;&lt;”。</font><font style="vertical-align: inherit;">左操作数'（-1）'为负。</font></font><br>
<br>
<pre><code class="cpp hljs">decode_mcu_AC_refine (j_decompress_ptr cinfo, JBLOCKROW *MCU_data)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> p1, m1;<font></font>
  p1 = <span class="hljs-number">1</span> &lt;&lt; cinfo-&gt;Al;    <font></font>
  m1 = (<span class="hljs-number">-1</span>) &lt;&lt; cinfo-&gt;Al; <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目前尚不清楚代码的作者想要在这里实现什么。</font><font style="vertical-align: inherit;">使用带负数的移位运算符会导致不确定的行为。</font><font style="vertical-align: inherit;">乍一看，标准中描述移位运算符行为的方式似乎有些混乱，但仍要检查一下：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.结果的类型是提升后的左操作数的类型。</font><font style="vertical-align: inherit;">如果右操作数为负或大于或等于提升后的左操作数的位长度，则该行为是不确定的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. E1 &lt;&lt; E2的值是E1左移E2位的位置；空出的位为零。如果E1具有无符号类型，则结果的值为E1 * 2 ^ E2，比结果类型中可表示的最大值模减少1。否则，如果E1具有带符号的类型且非负值，并且E1 * 2 ^ E2在结果类型中可表示，则这是结果值；否则，行为是不确定的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，如果左右操作数的值为负，则不会定义该行为。如果操作数是带符号类型，非负值并且适合结果类型，则该行为将是正常的。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N2 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测到使用'if（A）{...} else if（A）{...}'模式。</font><font style="vertical-align: inherit;">存在逻辑错误的可能性。</font><font style="vertical-align: inherit;">检查行：156，160。cameracapturelevelcontrol.cpp 156</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CameraCaptureLevelHistogram::mousePressEvent</span><span class="hljs-params">(QMouseEvent* event)</span> </span>{
  <span class="hljs-keyword">if</span> (event-&gt;button() != Qt::LeftButton) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (m_currentItem == Histogram) {<font></font>
    m_histogramCue = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == None) <span class="hljs-keyword">return</span>;<font></font>
  QPoint pos = event-&gt;pos();<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_black;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == GammaSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - gammaToHPos(m_gamma, m_black, m_white);<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_white;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == ThresholdSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_threshold;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里可变</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M_OFFSET是</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于的值分配不同的值</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlackSlider</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上重复检查</font><i><font style="vertical-align: inherit;">是</font></i><font style="vertical-align: inherit;">没有意义的，并且从条件主体中可以看到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_white</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量参与了计算</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">让我们看一下</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的可能值</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cpp hljs">  LevelControlItem m_currentItem;<font></font>
<font></font>
  <span class="hljs-keyword">enum</span> LevelControlItem {<font></font>
    None = <span class="hljs-number">0</span>,<font></font>
    BlackSlider,<font></font>
    WhiteSlider,<font></font>
    GammaSlider,<font></font>
    ThresholdSlider,<font></font>
    Histogram,<font></font>
    NumItems<font></font>
  };</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/664/caa/09b/664caa09b6eca7a582ae4441c232e61e.png" alt="image3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WhiteSlider</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值也是</font><i><font style="vertical-align: inherit;">可能的</font></i><font style="vertical-align: inherit;">，只是不对其进行验证。</font><font style="vertical-align: inherit;">因此，完全有可能由于复制粘贴错误而丢失了某些行为方案。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N3 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517检测到</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用'if（A）{...} else if（A）{...}'模式。</font><font style="vertical-align: inherit;">存在逻辑错误的可能性。</font><font style="vertical-align: inherit;">检查行：784、867。tpalette.cpp 784</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPalette::loadData</span><span class="hljs-params">(TIStream &amp;is)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> tagName;
  <span class="hljs-keyword">while</span> (is.openChild(tagName)) {
    <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"version"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">if</span> (....){<font></font>
          ....<font></font>
        }<font></font>
        ....<font></font>
        is.closeChild();<font></font>
        }<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"refImgPath"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"animation"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">int</span> key = <span class="hljs-string">'0'</span>;
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">int</span> styleId = <span class="hljs-number">0</span>;<font></font>
        ....<font></font>
      }<font></font>
    } <font></font>
      ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个类似的错误。</font><font style="vertical-align: inherit;">在这里，相同的条件具有不同的主体，但</font><font style="vertical-align: inherit;">不再</font><font style="vertical-align: inherit;">可能得出有关</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tagName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的可能选项的结论</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最有可能的是，只有一个选项被遗漏了，最后我们有了永远不会执行的代码。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N4 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V547</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式“ chancount == 2”始终为true。</font><font style="vertical-align: inherit;">psd.cpp 720</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPSDReader::readImageData</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> chancount)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">1</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) { <span class="hljs-comment">// &lt;= 1</span><font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">8</span> &amp;&amp; chancount &gt; <span class="hljs-number">1</span>) {<font></font>
    ....<font></font>
    <span class="hljs-keyword">for</span> (....) {
      <span class="hljs-keyword">if</span> (chancount &gt;= <span class="hljs-number">3</span>) {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">4</span>)  <font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (chancount &lt;= <span class="hljs-number">2</span>)  <span class="hljs-comment">// &lt;= 2</span><font></font>
      {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">2</span>) <span class="hljs-comment">// &lt;= 3</span><font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      }<font></font>
      ....<font></font>
    }<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_headerInfo.depth == <span class="hljs-number">8</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个小的逻辑错误潜入了这些检查。</font><font style="vertical-align: inherit;">在编号为1的测试中，将</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chancount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与1进行比较，在编号为2的测试中，检查此变量是否小于或等于2。结果，唯一的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chancount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">是</font><font style="vertical-align: inherit;">数字</font><font style="vertical-align: inherit;">3 </font><font style="vertical-align: inherit;">下的条件</font><font style="vertical-align: inherit;">2。此错误可能不会导致错误的程序操作，但是它会使代码的阅读和理解复杂化。</font><font style="vertical-align: inherit;">例如，目前尚不清楚为什么else-branch那么... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，此片段中考虑的函数需要300多行代码，并且由条件和循环的此类堆组成。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/725/c28/39a/725c2839a5774ec76b0143ec64531fda.png" alt="image4.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N5 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V614使用了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未初始化的变量'precSegmentIndex'。</font><font style="vertical-align: inherit;">考虑检查“ insertBoxCorners”函数的第五个实际参数。</font><font style="vertical-align: inherit;">光栅选择.cpp 803</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">TStroke <span class="hljs-title">getIntersectedStroke</span><span class="hljs-params">(TStroke &amp;stroke, TRectD bbox)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> precSegmentIndex, currentSegmentIndex, startSegmentIndex,<font></font>
      precChunkIndex = <span class="hljs-number">-1</span>;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....) {<font></font>
    insertBoxCorners(bbox, points, outPoints, currentSegmentIndex,<font></font>
                     precSegmentIndex);<font></font>
    ....<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insertBoxCorners</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> currentSegmentIndex, <span class="hljs-keyword">int</span> precSegmentIndex)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> sameIndex = (precSegmentIndex == currentSegmentIndex);<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> segmentIndex = precSegmentIndex;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也许，即使在初始化变量</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precChunkIndex的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过程中，也犯了一个错误</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">开发人员可以期望最后一个元素-1的初始化使用与在同一行上声明的其他变量相同的值进行初始化。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N6 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V590</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑检查's！=“” &amp;&amp; s ==“ color”'表达式。</font><font style="vertical-align: inherit;">表达式过多或打印错误。</font><font style="vertical-align: inherit;">cleanupparameters.cpp 416</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CleanupParameters::loadData</span><span class="hljs-params">(TIStream &amp;is, <span class="hljs-keyword">bool</span> globalParams)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> s = is.getTagAttribute(<span class="hljs-string">"sharpness"</span>);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"lineProcessing"</span>)<font></font>
    ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s)) <font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s))<font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; s == <span class="hljs-string">"color"</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"despeckling"</span>) {<font></font>
    ....  <font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个错误，甚至是一个缺陷，本身只会导致不必要的比较。</font><font style="vertical-align: inherit;">但是，如果我们将代码作为一个整体来看，就会很清楚，由于以前条件下的复制粘贴，出现了额外的比较。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bcc/077/857/bcc077857a8341d45e6fcf504129353c.png" alt="image5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这样的面条占用数十行或更多行代码，很可能包含任何其他逻辑错误，使用这种格式进行搜索可能会导致折磨。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N7 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V772</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为空指针调用“删除”运算符将导致未定义的行为。</font><font style="vertical-align: inherit;">pluginhost.cpp 1327</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析器消息本身已经非常详尽：</font><font style="vertical-align: inherit;">在指向</font><i><font style="vertical-align: inherit;">void</font></i><font style="vertical-align: inherit;">类型的指针上</font><font style="vertical-align: inherit;">调用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符</font><font style="vertical-align: inherit;">会导致未定义的行为。</font><font style="vertical-align: inherit;">如果需要通用功能来删除接口，则值得将其作为样板。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;class T&gt;
<span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(T *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N8 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很奇怪，'sizeof（）'运算符会评估指向类的指针的大小，而不是'm_xshHandle'类对象的大小。</font><font style="vertical-align: inherit;">tstageobjectcmd.cpp 455</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DVAPI</span> <span class="hljs-title">TStageObjectParams</span> {</span><font></font>
  ....<font></font>
};<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemovePegbarNodeUndo</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> TUndo {<font></font>
  ....<font></font>
  TXsheetHandle *m_xshHandle;<font></font>
<font></font>
<span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(m_xshHandle);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个很常见的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，可能由于疏忽和无知而发生。</font><font style="vertical-align: inherit;">在这里，最有可能的问题是注意力不集中，因为在第一个术语中，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个问题</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍然被取消引用。</font><font style="vertical-align: inherit;">如果需要对象的大小，则应始终记住必须取消引用对象的指针。</font><font style="vertical-align: inherit;">否则，我们只获得指针本身的大小。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(*m_xshHandle);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N9 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很奇怪，'sizeof（）'运算符会评估指向类的指针的大小，而不是'this'类对象的大小。</font><font style="vertical-align: inherit;">shaderfx.cpp 107</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RectF</span> {</span>
  GLfloat m_val[<span class="hljs-number">4</span>];<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>==(<span class="hljs-keyword">const</span> RectF &amp;rect) <span class="hljs-keyword">const</span> {
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);<font></font>
  }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，很明显，他们忘记了取消引用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果，我们得到的不是对象的大小，而是指针的大小。</font><font style="vertical-align: inherit;">结果，仅比较前4或8个字节（取决于位深度）。</font><font style="vertical-align: inherit;">正确的代码版本：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(*<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N10 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V554</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不正确地使用了unique_ptr。</font><font style="vertical-align: inherit;">分配给'new []'的内存将使用'delete'清除。</font><font style="vertical-align: inherit;">screensavermaker.cpp 29</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeScreenSaver</span><span class="hljs-params">(TFilePath scrFn, TFilePath swfFn,
                     <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> screenSaverName)</span> </span>{
  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">stat</span> <span class="hljs-title">results</span>;</span><font></font>
....<font></font>
  <span class="hljs-keyword">int</span> swfSize = results.st_size;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;<span class="hljs-keyword">char</span>&gt; <span class="hljs-title">swf</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[swfSize])</span></span>;<font></font>
....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常会忘记，实例化unique_ptr的类型取决于将使用delete还是delete []。结果，如果像所考虑的片段中那样实例化指针，则通过new []分配内存时，可能会发生未定义的行为，因为释放将通过delete发生。为避免这种情况，您需要在指针类型上添加方括号：std :: unique_ptr &lt;char []&gt;。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N11 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V521</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用'，'运算符的此类表达式很危险。确保表达式'm_to，m_from = it-&gt; first.getNumber（）'是正确的。 flipbook.cpp 509</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadImagesPopup</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> FileBrowserPopup {<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> m_from, m_to, ....;<font></font>
  ....<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoadImagesPopup::onFilePathClicked</span><span class="hljs-params">(....)</span> </span>{<font></font>
  TLevel::Iterator it;<font></font>
  ....<font></font>
  it = level-&gt;begin();<font></font>
  m_to, m_from = it-&gt;first.getNumber();  <span class="hljs-comment">// &lt;=</span>
  <span class="hljs-keyword">for</span> (; it != level-&gt;end(); ++it) m_to = it-&gt;first.getNumber();<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (m_from == <span class="hljs-number">-2</span> &amp;&amp; m_to == <span class="hljs-number">-2</span>) m_from = m_to = <span class="hljs-number">1</span>;<font></font>
<font></font>
  m_minFrame = m_from;<font></font>
  m_maxFrame = m_to;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也许程序员希望您可以通过简单地用逗号将变量赋值来为一个变量赋一个值。但是，C ++中的“，”运算符的工作方式有所不同。其中，执行第一个操作数，结果为“重置”，然后计算第二个操作数。并且，尽管</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><i><font style="vertical-align: inherit;">是</font></i><font style="vertical-align: inherit;">在随后的周期中初始化的，但是如果出现问题或有人进行了错误的重构，则</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能不会收到值。通常，无论如何，这段代码看起来很奇怪。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N12 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V532</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑检查“ *指针++”模式的语句。可能的意思是：“（*指针）++”。 trop.cpp 140</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>, <span class="hljs-title">class</span> <span class="hljs-title">Q</span>&gt;
<span class="hljs-title">void</span> <span class="hljs-title">doGammaCorrect</span>(<span class="hljs-title">TRasterPT</span>&lt;T&gt; <span class="hljs-title">raster</span>, <span class="hljs-title">double</span> <span class="hljs-title">gamma</span>) {</span>
  <span class="hljs-function">Gamma_Lut&lt;Q&gt; <span class="hljs-title">lut</span><span class="hljs-params">(....)</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword">int</span> j;
  <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; raster-&gt;getLy(); j++) {<font></font>
    T *pix    = raster-&gt;pixels(j);<font></font>
    T *endPix = pix + raster-&gt;getLx();<font></font>
    <span class="hljs-keyword">while</span> (pix &lt; endPix) {<font></font>
      pix-&gt;r = lut.m_table[pix-&gt;r];<font></font>
      pix-&gt;b = lut.m_table[pix-&gt;b];<font></font>
      pix-&gt;g = lut.m_table[pix-&gt;g];<font></font>
      *pix++; <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个小的缺陷，可能会使阅读代码的人更加困惑。如预期的那样，增量将指针移动。但是，此后将无意义地取消引用。最好只写</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pix ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N13 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V773</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在不释放'autoCloseUndo'指针的情况下退出了该函数。可能发生内存泄漏。 vectortapetool.cpp 575</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">joinLineToLine</span><span class="hljs-params">(....)</span> </span>{<font></font>
  ....<font></font>
  UndoAutoclose *autoCloseUndo = <span class="hljs-number">0</span>;<font></font>
  ....<font></font>
  autoCloseUndo = <span class="hljs-keyword">new</span> UndoAutoclose(....);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (pos &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<font></font>
  ....<font></font>
  TUndoManager::manager()-&gt;add(autoCloseUndo);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有超过20种这样的警告，通常在函数末尾的某个位置释放了内存，但是对于更早的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回，</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跳过了此必要的步骤。就在这里。最后，将指针传递给</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TUndoManager :: manager（）-&gt; add（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它负责删除指针，但是上面有一个</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，您忘了为此调用。因此，每次退出函数时始终值得记住您的指针，而不仅仅是在块末尾或最后一次</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之前输入delete </font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果对于该代码的缩写版本而言，此错误似乎很明显，那么在实际的，更复杂的代码中，很难找到此类问题。在这里，久负盛名的静态分析仪将为您提供帮助。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N14 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V522</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">取消</font></a><font style="vertical-align: inherit;">引用空指针“区域”。 Palettecmd.cpp 94</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isStyleUsed</span><span class="hljs-params">(<span class="hljs-keyword">const</span> TVectorImageP vi, <span class="hljs-keyword">int</span> styleId)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> regionCount = vi-&gt;getRegionCount();
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; regionCount; i++) {<font></font>
    TRegion *region = vi-&gt;getRegion(i);<font></font>
    <span class="hljs-keyword">if</span> (region || region-&gt;getStyle() != styleId) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里我们可以假设开发人员混淆了短路评估的规则，并认为如果指针的第一次检查返回</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么将不会取消引用此类空指针。但是，对于运算符“ ||”相反。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段N15 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将值分配给“ ca”变量可能比重新声明它更好。先前的声明：xshcellmover.cpp，第319行。xshcellmover.cpp 323 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将值分配给'cb'变量可能比重新声明它更好。先前的声明：xshcellmover.cpp，第320行。xshcellmover.cpp 324xshcellmover.cpp 323</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">redo</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
  <span class="hljs-keyword">int</span> ca       = m_cellsMover.getStartPos().x;
  <span class="hljs-keyword">int</span> cb       = m_cellsMover.getPos().x;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (!m_cellsMover.getOrientation()-&gt;isVerticalTimeline()) {
    <span class="hljs-keyword">int</span> ca = m_cellsMover.getStartPos().y;
    <span class="hljs-keyword">int</span> cb = m_cellsMover.getPos().y;<font></font>
  }<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (ca != cb) {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也许是另一种复制粘贴，但是具有错误的不是很普通的本质。对</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的调用</font><font style="vertical-align: inherit;">由</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替</font><font style="vertical-align: inherit;">，但是他们忘记在行的开头删除变量的类型，因为这会发生局部重新报告。结果，不是更改初始</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的位置方向，而是</font><i><font style="vertical-align: inherit;">创建了</font></i><font style="vertical-align: inherit;">新的局部</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此后不再发生任何事情。但是外部</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">继续存在，且具有</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论N1</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在撰写本文的过程中，戳戳并尝试在此程序中进行操作对我来说变得很有趣。</font><font style="vertical-align: inherit;">也许我很幸运，但是不久以后就会出现奇怪的行为：挂起，通过按</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来显示我对平板电脑的下垂和奇数平方的操作</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不幸的是，我无法重复这种行为。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/a67/350/35da67350bc54eb9cbada817d91a04c8.png" alt="image6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是实际上，尽管有这种行为并养成了定期按</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + S</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的习惯</font><font style="vertical-align: inherit;">，但OpenToonz的规模和功能给人留下了深刻的印象。</font><font style="vertical-align: inherit;">不过，大型工作室也不会使用它。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和我的艺术作为奖励：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e88/a95/8e3/e88a958e3dd8c85b3894de88f140b7e0.gif" alt="image7.gif"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结束语N2</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
对于OpenToonz，很明显，立即修复分析器检测到的所有错误将是一项艰巨的任务，它将使开发过程停滞不前。</font><font style="vertical-align: inherit;">对于这种情况，存在“质量抑制”方法，即将技术债务输入到分析仪的抑制器基座中，并根据新的响应与分析仪进行进一步的工作。</font><font style="vertical-align: inherit;">好吧，如果时间到了，那么您可以解决技术债务。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS：我提醒您，开源项目的开发人员可以使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免费许可选项PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
如果您想与说英语的读者分享这篇文章，请使用翻译链接：Victoria Khanieva。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">OpenToonz</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN494202/index.html">使用Python按租金价格对莫斯科地区的排名</a></li>
<li><a href="../zh-CN494204/index.html">带有示波器和频率发生器（声卡）的记事本</a></li>
<li><a href="../zh-CN494206/index.html">错误修正的生物学问题</a></li>
<li><a href="../zh-CN494210/index.html">在Microsoft Surface Pro上安装Ubuntu</a></li>
<li><a href="../zh-CN494214/index.html">冠状病毒如何帮助IT巨头占领世界</a></li>
<li><a href="../zh-CN494222/index.html">您已停止在隔离区工作吗？</a></li>
<li><a href="../zh-CN494224/index.html">条条大路通满栈</a></li>
<li><a href="../zh-CN494226/index.html">议定立场</a></li>
<li><a href="../zh-CN494228/index.html">波音777的创造中的3D打印</a></li>
<li><a href="../zh-CN494230/index.html">AI与COVID-19：湖北和佛罗里达的经验</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>