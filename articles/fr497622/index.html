<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏭️ ✌🏿 🏿 Détecteur COVID-19 automatisé à partir d'images de fluorographie 🤲🏻 🍖 🍑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans ce guide, vous apprendrez à détecter automatiquement COVID-19 dans un ensemble de données spécialement sélectionné à l'aide de Keras, TensorFlow ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Détecteur COVID-19 automatisé à partir d'images de fluorographie</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous apprendrez à détecter automatiquement COVID-19 dans un ensemble de données spécialement sélectionné à l'aide de Keras, TensorFlow et du deep learning. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme la plupart des gens dans le monde en ce moment, je suis sincèrement préoccupé par COVID-19. </font><font style="vertical-align: inherit;">Je remarque que j'ai commencé à analyser constamment ma santé personnelle et je soupçonne que j'ai déjà été infecté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus je m'inquiète, plus une combinaison douloureuse de symptômes réels avec l'hypocondrie se manifeste:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je me suis réveillé le matin, je me sens un peu dépassé.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quand je suis sorti du lit, j'ai déjà eu une fuite de mon nez (bien que l'on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sache maintenant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'un nez qui coule n'est pas un symptôme de COVID-19).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alors qu'il atteignait la salle de bain pour prendre une serviette, il toussa également.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, je n'y attachais pas beaucoup d'importance - je suis allergique au pollen, et en raison du temps chaud sur la côte est, le printemps est arrivé tôt cette année. Très probablement, mon allergie a éclaté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais les symptômes ne se sont pas améliorés toute la journée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et me voilà assis, en train d'écrire ce manuel avec un thermomètre dans la bouche; et regarder vers le bas montre 37,4 ° C. La température est plus élevée que mes 36,3 ° C habituels. Tout au-dessus de 37,2 ° C, je considère déjà une légère fièvre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toux et un peu de fièvre? Ça pourrait être COVID-19 ... ou juste mon allergie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est impossible de le découvrir sans test, et c'est précisément cette «ignorance» qui rend cette situation si dangereuse pour l'équilibre mental. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les gens, il n'y a rien de plus terrible que l'inconnu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgré toutes les peurs, j'essaie de m'en débarrasser de manière rationnelle. J'ai plus de trente ans, je suis en pleine forme, mon système immunitaire est très fort. Je vais aller en quarantaine (juste au cas où), je vais me reposer et récupérer normalement. COVID-19 ne me fait pas peur en termes de </font><font style="vertical-align: inherit;">santé </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (au moins je continue de me le dire). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, je m'inquiète pour mes parents âgés, y compris ceux qui souffrent de maladies chroniques et ceux qui sont dans une maison de soins infirmiers ou un hôpital. Ils sont vulnérables et ce sera vraiment triste de les perdre à cause de cette infection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas rester les bras croisés et de ne pas succomber à la faiblesse (que ce soit l'allergie, le COVID-19 ou simplement l'anxiété), j'ai décidé de faire ce que je fais le mieux -</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servir toute la communauté de la vision industrielle et du deep learning en écrivant du code, en menant des expériences et en enseignant aux autres comment utiliser la vision par ordinateur et le deep learning dans des applications pratiques et réelles</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, pour être honnête, ce n'est pas l'article le plus scientifique que j'ai jamais écrit. </font><font style="vertical-align: inherit;">En fait, loin d'être le plus. </font><font style="vertical-align: inherit;">Les méthodes et les ensembles de données utilisés ne méritent pas d'être publiés. </font><font style="vertical-align: inherit;">Mais ils peuvent être le point de départ pour ceux qui veulent aider. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais je veux faire tout ce qui est en mon pouvoir. </font><font style="vertical-align: inherit;">Cet article est simplement ma façon de surmonter mentalement les moments difficiles et en même temps aider les autres dans une situation similaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que tu me comprends. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la leçon d'aujourd'hui, nous ferons ce qui suit:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous collecterons un ensemble de données ouvertes à partir de fluorogrammes de patients avec un test positif pour COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous collectons une sélection de fluorogrammes de patients en bonne santé.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous formerons le réseau neuronal convolutif pour détecter automatiquement COVID-19 dans les images de l'ensemble créé.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous évaluerons les résultats obtenus d'un point de vue pédagogique.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissement: j'ai déjà laissé entendre, mais je vais le dire sans ambages. </font><font style="vertical-align: inherit;">Les méthodes et techniques de cet article sont uniquement à des fins éducatives. </font><font style="vertical-align: inherit;">Ce n'est pas une véritable étude scientifique et elle ne sera pas publiée dans une revue. </font><font style="vertical-align: inherit;">L'article est destiné aux lecteurs qui sont intéressés par (1) la vision par ordinateur / l'apprentissage en profondeur et qui souhaitent apprendre à l'aide de méthodes pratiques, et (2) sont préoccupés par les événements actuels. </font><font style="vertical-align: inherit;">Je vous prie de vous y référer de cette manière.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19 sur les fluorogrammes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la première partie, nous discutons de la manière dont COVID-19 peut être détecté sur des radiographies thoraciques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez ensuite notre ensemble de données. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, je vais vous montrer comment former le modèle d'apprentissage en profondeur à l'aide de Keras et TensorFlow pour définir COVID-19 dans notre jeu de données d'image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ma tâche est de vous inspirer et de montrer que l'étude de la vision par ordinateur / du deep learning, puis l'application de ces connaissances dans le domaine médical peuvent avoir un gros impact sur le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit: vous n'avez pas besoin d'un diplôme en médecine pour contribuer à la médecine. Les spécialistes de l'apprentissage en profondeur qui travaillent en étroite collaboration avec les médecins et les prestataires de soins de santé peuvent résoudre des problèmes complexes, sauver des vies et rendre le monde meilleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que ce guide vous incitera à faire exactement cela.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais avec tout cela dit, les revues scientifiques et les systèmes d'évaluation d'experts sont </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pleins de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matériaux avec des modèles de prévision de COVID-19 de qualité douteuse. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez ne pas prendre le code / modèle de cet article et ne pas l'envoyer à la revue ou le mettre dans le domaine public sur des sites scientifiques - vous n'ajouterez que du bruit.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
De plus, si vous avez l'intention d'utiliser cet article (ou tout autre article COVID-19 sur Internet) dans vos propres recherches, assurez-vous de vérifier les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">règles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TRÉPIED pour créer des modèles de rapports de prévision</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez probablement, l'utilisation de l'IA en médecine entraîne </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des conséquences très réelles</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Publier ou utiliser ces modèles uniquement après consultation étroite avec un expert médical.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 1. Un exemple de fluorogramme d'un patient avec un test positif pour COVID-19. En utilisant Keras et TensorFlow dans de telles images, il est possible d'entraîner le classificateur à détecter COVID-19. Les</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
tests</font><i><font color="gray"><font style="vertical-align: inherit;"> COVID-19</font></font></i><font style="vertical-align: inherit;"> sont actuellement difficiles à trouver -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ils ne sont tout simplement pas suffisants</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ne peuvent pas être effectués assez rapidement, ce qui provoque la panique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cas de panique, certaines personnes ignobles en profitent et</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vendent de faux kits de test COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trouvant des victimes sur les réseaux sociaux et les messageries instantanées</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que le nombre de kits de test COVID-19 est limité, vous devez vous fier à d'autres méthodes de diagnostic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les médecins se fient souvent aux radiographies pulmonaires (communément appelées fluorogrammes) pour diagnostiquer la pneumonie, la pneumonie, les abcès et / ou les ganglions lymphatiques hypertrophiés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19 attaque l'épithélium des voies respiratoires et les rayons X aident à examiner l'état pulmonaire du patient. Des appareils à rayons X sont installés dans la plupart des hôpitaux, il est donc logique d'utiliser la fluorographie pour tester COVID-19 sans kits de test spéciaux. L'inconvénient est qu'une telle analyse nécessite un spécialiste en radiologie et prend un temps considérable. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par conséquent, le développement d'un système automatisé sera très précieux pour gagner le temps précieux des professionnels de la santé du monde entier. </font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Certaines publications plus récentes suggèrent que la tomodensitométrie est meilleure pour diagnostiquer COVID-19, mais dans cette leçon, nous ne travaillons qu'avec des fluorogrammes.</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base de données</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">2. À gauche, des échantillons positifs (provenant de patients infectés) et à droite, des échantillons négatifs. </font><font style="vertical-align: inherit;">Ces images sont utilisées pour former un modèle afin de prédire automatiquement la présence d'une maladie.Notre</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ensemble de données a été compilé par le</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , étudiant diplômé de l'Université de Montréal. </font><font style="vertical-align: inherit;">Début mars, il a commencé à collecter des fluorogrammes de patients atteints de COVID-19, MERS, SRAS et SRAS et à les publier dans le</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> référentiel sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons télécharger un fichier à partir du référentiel</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et sélectionner les lignes de celui-ci où il est indiqué</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Résultat positif sur COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type de poumons «postéro-antérieur» (AP). </font><font style="vertical-align: inherit;">Autant que je sache, c'est le type d'image utilisé dans les images «saines».</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un total de 25 fluorogrammes ont été trouvés avec des cas positifs de COVID-19 (Fig.2, à gauche). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les patients en bonne santé, j'ai utilisé l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ensemble de données Cuggle (pneumonie)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et sélectionné 25 images de patients en bonne santé (Fig.2, à droite). </font><font style="vertical-align: inherit;">Cet ensemble de données présente un certain nombre de problèmes, à savoir des étiquettes bruyantes / incorrectes, mais il fera l'affaire pour une vérification conceptuelle du détecteur automatique COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structure du projet</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section Téléchargements de mon site Web, vous pouvez entrer votre adresse e-mail et trouver un lien vers l'archive avec du code, des scripts et d'autres fichiers pour ce projet. </font><font style="vertical-align: inherit;">Extrayez les fichiers et vous verrez la structure du répertoire:</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [25 entries]<font></font>
│   └── normal [25 entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fluorogrammes se trouvent dans un répertoire </font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">où deux classes de données sont divisées en répertoires </font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux scripts sont présentés pour construire un ensemble de données, mais nous ne les examinerons pas aujourd'hui. </font><font style="vertical-align: inherit;">Au lieu de cela, considérez un script </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui enseigne notre détecteur COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la mise en oeuvre</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons à la mise en place d'un réseau neuronal convolutif. </font><font style="vertical-align: inherit;">Ouvrez le fichier </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et collez le code suivant:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script utilise un certain nombre de bibliothèques d'apprentissage en profondeur de TensorFlow 2.0 et Keras. </font><font style="vertical-align: inherit;">De plus, nous utilisons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la bibliothèque Python standard pour l'apprentissage automatique, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour la représentation graphique et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le chargement et le traitement des images. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour installer TensorFlow 2.0 (y compris les bibliothèques scikit-learn, OpenCV et matplotlib appropriées), suivez simplement mes instructions pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous analyserons les arguments de la ligne de commande et initialiserons les hyperparamètres:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arguments de ligne de commande</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin d'accès au jeu de données d'entrée</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Un chemin facultatif vers le calendrier de sortie de votre historique d'apprentissage. </font><font style="vertical-align: inherit;">Sauf indication contraire, la valeur par défaut est</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin facultatif vers le modèle de sortie; </font><font style="vertical-align: inherit;">défaut</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes suivantes initialisent la vitesse d'apprentissage initiale, le nombre d'époques et les hyperparamètres de la taille du paquet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant prêts à télécharger et à prétraiter les fluorogrammes:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour charger les données, nous capturons tous les chemins d'accès aux images dans le catalogue </font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Alors pour chacun </font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous récupérons l'étiquette de classe ( </font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">du chemin </font><font style="vertical-align: inherit;">.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous le chargeons </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le prétraitons, le convertissant en RVB et le redimensionnant à 224 × 224 pixels, afin qu'il soit prêt pour le réseau neuronal.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise à jour des listes </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mettez ensuite à l'échelle l'intensité des pixels dans la plage [0, 1] et convertissez les données et les étiquettes au format de tableau NumPy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous effectuons un encodage direct </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en divisant les données en ensembles pour la formation / les tests:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'encodage direct signifie que les données sont converties au format suivant:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque étiquette codée se compose d'un tableau avec deux éléments: «hot» (1) ou «not» (0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, les lignes suivantes séparent nos données, laissant 80% pour la formation et 20% pour les tests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous assurer que le modèle est généralisé, nous effectuons une augmentation des données en réglant l'image pour qu'elle tourne de façon aléatoire de 15 ° dans le sens horaire ou antihoraire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les trois dernières lignes initialisent l'objet générateur d'augmentation de données. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, initialisez notre modèle VGGNet et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affinez-le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux premières lignes créent une instance du réseau VGG16 avec des poids préalablement formés sur ImageNet sans toucher la couche entièrement connectée (FC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous construisons un nouveau calque entièrement connecté, composé de calques </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'ajoutons au-dessus de VGG16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous </font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gelons </font><font style="vertical-align: inherit;">les poids </font><font style="vertical-align: inherit;">pour VGG16, donc </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seule</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la couche FC </font><font style="vertical-align: inherit;">sera entraînée </font><font style="vertical-align: inherit;">. Ceci termine la configuration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant prêts à compiler et à former notre modèle d'apprentissage en profondeur pour COVID-19:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les premières lignes compilent le réseau neuronal avec l'option de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">réduire la vitesse d'apprentissage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'optimiseur </font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Étant donné qu'il s'agit d'un problème à deux classes, nous utilisons la perte </font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plutôt que l'entropie croisée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour démarrer le processus d'apprentissage, nous appelons la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">méthode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">dans Keras</font></a><font style="vertical-align: inherit;"> , en passant les fluorogrammes à travers notre objet d'augmentation de données. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous évaluons le modèle:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour évaluer, nous faisons d'abord des prévisions sur l'ensemble de test, en préservant les indices de prévision. </font><font style="vertical-align: inherit;">Ensuite, nous créons et affichons un rapport de classification à l'aide de scikit-learn, où il existe une telle fonction auxiliaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous calculons la matrice des inexactitudes pour une évaluation statistique plus approfondie:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous faisons ce qui suit:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous générons une matrice d'inexactitudes.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec son aide, nous calculons la précision, la sensibilité et la spécificité en imprimant toutes ces métriques.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'auto-test, nous générons un graphique avec un historique de la précision de l'entraînement et des pertes, le sortie dans un fichier graphique:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, enregistrez le modèle de classificateur </font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le disque:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation des détecteurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir téléchargé tous les fichiers de l'archive avec les sources et les scripts mentionnés ci-dessus, ouvrez la console et exécutez la commande suivante pour entraîner le détecteur:</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagnostic automatique de COVID-19 selon les résultats de la fluorographie</font></font></h2><br>
<i><b>  :</b>      ,  «»   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montrent les résultats ci-dessus, notre détecteur automatique a une précision d'environ 90 à 92% sur un ensemble d'échantillons existant. </font><font style="vertical-align: inherit;">Cette évaluation est basée sur l'analyse d'images uniquement. </font><font style="vertical-align: inherit;">Pendant la formation, plus aucune donnée n'a été utilisée, notamment la localisation géographique, la densité de population, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sensibilité était de 100% et la spécificité de 80%, ce qui signifie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les patients réellement infectés sont reconnus dans 100% des cas.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les patients en bonne santé sont reconnus en bonne santé avec une probabilité de 80%.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montre le graphique de l'historique de la formation, notre réseau n'est pas trop recyclé, malgré un </font><font style="vertical-align: inherit;">ensemble de données </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">très limité</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
capacité de reconnaître COVID-19 avec une précision absolue est grande, bien que le taux de faux positifs soit un peu inquiétant, car de nombreuses personnes en bonne santé seront envoyées à mise en quarantaine avec des patients vraiment infectés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est extrêmement difficile d'équilibrer la sensibilité et la spécificité lorsqu'il s'agit d'applications médicales, en particulier dans le cas de maladies infectieuses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ce qui concerne la vision par ordinateur et la formation approfondie en médecine, vous devez toujours vous rappeler que nos modèles prédictifs peuvent avoir des conséquences très réelles - un diagnostic manqué peut coûter la vie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, ces résultats sont collectés à des fins éducatives uniquement. </font><font style="vertical-align: inherit;">Cet article et les résultats qui l'accompagnent ne sont pas destinés à être publiés dans une revue scientifique et ne sont pas conformes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aux règles TRIPOD pour la création de modèles de rapports de prévision</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitations, améliorations et travaux futurs</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 4. Actuellement, les spécialistes de l'intelligence artificielle (IA) et du deep learning souffrent d'un manque de données de qualité pour la formation efficace des systèmes de détection automatique COVID-19 sur les images ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source d'image</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'une des principales limites à la création de tels systèmes est la donnée. Nous n'avons tout simplement pas assez de données (fiables) pour entraîner le détecteur COVID-19. Les hôpitaux sont bondés de patients COVID-19, mais compte tenu de leurs droits et de leur vie privée, il devient</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encore plus difficile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de collecter des ensembles d'images médicales de qualité en temps opportun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suppose que dans les 12 à 18 prochains mois, le problème sera résolu, mais pour l'instant nous nous contentons de ce que nous avons. J'ai fait de mon mieux (en tenant compte de ma condition mentale et physique actuelle) pour rédiger un guide pour ceux qui sont intéressés à utiliser la vision par ordinateur et l'apprentissage profond dans la lutte contre COVID-19, en tenant compte des limites de temps et de ressources. Mais je dois vous rappeler que je ne suis pas un expert médical. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un véritable détecteur COVID-19 doit subir des tests rigoureux par des professionnels de la santé qualifiés travaillant main dans la main avec des praticiens expérimentés de l'apprentissage en profondeur. La méthode décrite ici, bien sûr, ne convient pas à une utilisation pratique et est destinée uniquement à des fins éducatives. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, il faut se demander ce que ce modèle «apprend» réellement.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comme je l'ai dit dans</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le guide Grad-CAM la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semaine dernière, il est tout à fait possible que notre modèle étudie des modèles qui ne sont pas liés à COVID-19, mais simplement des variations entre deux ensembles de données (c'est-à-dire entre les patients avec et sans COVID-19). Pour confirmer les résultats, des tests approfondis et l'assistance d'experts sont nécessaires. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin, les futurs (et meilleurs) détecteurs seront multimodaux.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Maintenant, nous </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> considérons </font><i><font style="vertical-align: inherit;">que les</font></i><font style="vertical-align: inherit;"> images (par exemple, les rayons X). Les meilleurs détecteurs automatiques COVID-19 devraient utiliser plusieurs sources de données, non limitées aux images, y compris les indicateurs vitaux des patients, la densité de la population, la situation géographique, etc. Les images seules ne sont généralement pas suffisantes pour ce type d'application.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que ce guide servira de point de départ à toute personne intéressée à utiliser la vision par ordinateur et l'apprentissage en profondeur pour détecter automatiquement COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et après?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je termine généralement mes articles de blog avec une recommandation d'un de mes livres ou cours afin que vous puissiez en savoir plus sur l'utilisation de la vision par ordinateur et de l'apprentissage en profondeur. </font><font style="vertical-align: inherit;">Par respect pour la gravité du coronavirus, je ne vais pas le faire - ce n'est ni le moment ni le lieu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de cela, je dirai que nous sommes maintenant dans une période de vie très terrible. </font><font style="vertical-align: inherit;">Comme les saisons, tout se passera, mais pour l'instant, vous devez vous accroupir et vous préparer à l'hiver froid - il est probable que le pire reste à venir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai reçu plusieurs lettres de lecteurs de PyImageSearch qui souhaitent utiliser ce temps d'arrêt pour étudier la vision par ordinateur et l'apprentissage en profondeur, plutôt que de devenir fou chez eux. </font><font style="vertical-align: inherit;">C'est une pensée utile.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous avez appris à utiliser Keras et TensorFlow pour entraîner le détecteur automatique COVID-19 sur un fluorogramme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas (encore) de jeux de données d'images de haute qualité et évalués par les pairs, nous avons donc dû travailler avec ce que nous avions, à savoir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le référentiel de Joseph Cohen sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons sélectionné 25 images de l'ensemble de données Cohen, en sélectionnant uniquement la vue postéro-antérieure (PA) et un diagnostic confirmé.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, 25 images de patients en bonne santé ont été sélectionnées à partir d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un ensemble de données avec des images de fluorographie Kaggle (pneumonie)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons utilisé Keras et TensorFlow pour entraîner le détecteur COVID-19, qui démontre une précision de 90 à 92%, une sensibilité de 100% et une spécificité de 80% sur l'ensemble de test (compte tenu de notre ensemble de données limité). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gardez à l'esprit que le détecteur COVID-19 décrit est uniquement à des fins éducatives.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497612/index.html">L'histoire de la façon dont la main invisible du marché m'a transféré dans un endroit éloigné</a></li>
<li><a href="../fr497614/index.html">Expériences de pensée, paradoxes et limites de la logique // Nous sommes condamnés # 2</a></li>
<li><a href="../fr497616/index.html">Entretien avec Alexander Makarov (Yii) sur OpenSource, conférences et Yii</a></li>
<li><a href="../fr497618/index.html">Mise en œuvre du concept d'accès à distance hautement sécurisé</a></li>
<li><a href="../fr497620/index.html">Écrire un plugin d'alerte de télégramme chrome</a></li>
<li><a href="../fr497624/index.html">Digital Banking Campus - résultats du programme de stages</a></li>
<li><a href="../fr497628/index.html">Comment tuer beaucoup de temps sur un petit script ou l'historique d'une demande de tirage</a></li>
<li><a href="../fr497632/index.html">Web HighLoad - comment nous gérons le trafic de dizaines de milliers de domaines</a></li>
<li><a href="../fr497634/index.html">Les coloriages arc-en-ciel sont les meilleurs amis des mathématiciens</a></li>
<li><a href="../fr497636/index.html">Comment le manque de puissance de calcul a affecté les batailles navales dans les guerres mondiales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>