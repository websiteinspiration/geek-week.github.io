<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è≠Ô∏è ‚úåüèø üèø D√©tecteur COVID-19 automatis√© √† partir d'images de fluorographie ü§≤üèª üçñ üçë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans ce guide, vous apprendrez √† d√©tecter automatiquement COVID-19 dans un ensemble de donn√©es sp√©cialement s√©lectionn√© √† l'aide de Keras, TensorFlow ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>D√©tecteur COVID-19 automatis√© √† partir d'images de fluorographie</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous apprendrez √† d√©tecter automatiquement COVID-19 dans un ensemble de donn√©es sp√©cialement s√©lectionn√© √† l'aide de Keras, TensorFlow et du deep learning. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme la plupart des gens dans le monde en ce moment, je suis sinc√®rement pr√©occup√© par COVID-19. </font><font style="vertical-align: inherit;">Je remarque que j'ai commenc√© √† analyser constamment ma sant√© personnelle et je soup√ßonne que j'ai d√©j√† √©t√© infect√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus je m'inqui√®te, plus une combinaison douloureuse de sympt√¥mes r√©els avec l'hypocondrie se manifeste:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je me suis r√©veill√© le matin, je me sens un peu d√©pass√©.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quand je suis sorti du lit, j'ai d√©j√† eu une fuite de mon nez (bien que l'on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sache maintenant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'un nez qui coule n'est pas un sympt√¥me de COVID-19).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alors qu'il atteignait la salle de bain pour prendre une serviette, il toussa √©galement.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, je n'y attachais pas beaucoup d'importance - je suis allergique au pollen, et en raison du temps chaud sur la c√¥te est, le printemps est arriv√© t√¥t cette ann√©e. Tr√®s probablement, mon allergie a √©clat√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais les sympt√¥mes ne se sont pas am√©lior√©s toute la journ√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et me voil√† assis, en train d'√©crire ce manuel avec un thermom√®tre dans la bouche; et regarder vers le bas montre 37,4 ¬∞ C. La temp√©rature est plus √©lev√©e que mes 36,3 ¬∞ C habituels. Tout au-dessus de 37,2 ¬∞ C, je consid√®re d√©j√† une l√©g√®re fi√®vre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toux et un peu de fi√®vre? √áa pourrait √™tre COVID-19 ... ou juste mon allergie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est impossible de le d√©couvrir sans test, et c'est pr√©cis√©ment cette ¬´ignorance¬ª qui rend cette situation si dangereuse pour l'√©quilibre mental. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les gens, il n'y a rien de plus terrible que l'inconnu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© toutes les peurs, j'essaie de m'en d√©barrasser de mani√®re rationnelle. J'ai plus de trente ans, je suis en pleine forme, mon syst√®me immunitaire est tr√®s fort. Je vais aller en quarantaine (juste au cas o√π), je vais me reposer et r√©cup√©rer normalement. COVID-19 ne me fait pas peur en termes de </font><font style="vertical-align: inherit;">sant√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (au moins je continue de me le dire). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, je m'inqui√®te pour mes parents √¢g√©s, y compris ceux qui souffrent de maladies chroniques et ceux qui sont dans une maison de soins infirmiers ou un h√¥pital. Ils sont vuln√©rables et ce sera vraiment triste de les perdre √† cause de cette infection. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas rester les bras crois√©s et de ne pas succomber √† la faiblesse (que ce soit l'allergie, le COVID-19 ou simplement l'anxi√©t√©), j'ai d√©cid√© de faire ce que je fais le mieux -</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servir toute la communaut√© de la vision industrielle et du deep learning en √©crivant du code, en menant des exp√©riences et en enseignant aux autres comment utiliser la vision par ordinateur et le deep learning dans des applications pratiques et r√©elles</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, pour √™tre honn√™te, ce n'est pas l'article le plus scientifique que j'ai jamais √©crit. </font><font style="vertical-align: inherit;">En fait, loin d'√™tre le plus. </font><font style="vertical-align: inherit;">Les m√©thodes et les ensembles de donn√©es utilis√©s ne m√©ritent pas d'√™tre publi√©s. </font><font style="vertical-align: inherit;">Mais ils peuvent √™tre le point de d√©part pour ceux qui veulent aider. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais je veux faire tout ce qui est en mon pouvoir. </font><font style="vertical-align: inherit;">Cet article est simplement ma fa√ßon de surmonter mentalement les moments difficiles et en m√™me temps aider les autres dans une situation similaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que tu me comprends. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la le√ßon d'aujourd'hui, nous ferons ce qui suit:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous collecterons un ensemble de donn√©es ouvertes √† partir de fluorogrammes de patients avec un test positif pour COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous collectons une s√©lection de fluorogrammes de patients en bonne sant√©.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous formerons le r√©seau neuronal convolutif pour d√©tecter automatiquement COVID-19 dans les images de l'ensemble cr√©√©.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous √©valuerons les r√©sultats obtenus d'un point de vue p√©dagogique.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avertissement: j'ai d√©j√† laiss√© entendre, mais je vais le dire sans ambages. </font><font style="vertical-align: inherit;">Les m√©thodes et techniques de cet article sont uniquement √† des fins √©ducatives. </font><font style="vertical-align: inherit;">Ce n'est pas une v√©ritable √©tude scientifique et elle ne sera pas publi√©e dans une revue. </font><font style="vertical-align: inherit;">L'article est destin√© aux lecteurs qui sont int√©ress√©s par (1) la vision par ordinateur / l'apprentissage en profondeur et qui souhaitent apprendre √† l'aide de m√©thodes pratiques, et (2) sont pr√©occup√©s par les √©v√©nements actuels. </font><font style="vertical-align: inherit;">Je vous prie de vous y r√©f√©rer de cette mani√®re.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19 sur les fluorogrammes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la premi√®re partie, nous discutons de la mani√®re dont COVID-19 peut √™tre d√©tect√© sur des radiographies thoraciques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez ensuite notre ensemble de donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, je vais vous montrer comment former le mod√®le d'apprentissage en profondeur √† l'aide de Keras et TensorFlow pour d√©finir COVID-19 dans notre jeu de donn√©es d'image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ma t√¢che est de vous inspirer et de montrer que l'√©tude de la vision par ordinateur / du deep learning, puis l'application de ces connaissances dans le domaine m√©dical peuvent avoir un gros impact sur le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit: vous n'avez pas besoin d'un dipl√¥me en m√©decine pour contribuer √† la m√©decine. Les sp√©cialistes de l'apprentissage en profondeur qui travaillent en √©troite collaboration avec les m√©decins et les prestataires de soins de sant√© peuvent r√©soudre des probl√®mes complexes, sauver des vies et rendre le monde meilleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que ce guide vous incitera √† faire exactement cela.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais avec tout cela dit, les revues scientifiques et les syst√®mes d'√©valuation d'experts sont </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pleins de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mat√©riaux avec des mod√®les de pr√©vision de COVID-19 de qualit√© douteuse. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez ne pas prendre le code / mod√®le de cet article et ne pas l'envoyer √† la revue ou le mettre dans le domaine public sur des sites scientifiques - vous n'ajouterez que du bruit.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
De plus, si vous avez l'intention d'utiliser cet article (ou tout autre article COVID-19 sur Internet) dans vos propres recherches, assurez-vous de v√©rifier les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√®gles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TR√âPIED pour cr√©er des mod√®les de rapports de pr√©vision</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez probablement, l'utilisation de l'IA en m√©decine entra√Æne </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des cons√©quences tr√®s r√©elles</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Publier ou utiliser ces mod√®les uniquement apr√®s consultation √©troite avec un expert m√©dical.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 1. Un exemple de fluorogramme d'un patient avec un test positif pour COVID-19. En utilisant Keras et TensorFlow dans de telles images, il est possible d'entra√Æner le classificateur √† d√©tecter COVID-19. Les</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
tests</font><i><font color="gray"><font style="vertical-align: inherit;"> COVID-19</font></font></i><font style="vertical-align: inherit;"> sont actuellement difficiles √† trouver -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ils ne sont tout simplement pas suffisants</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ne peuvent pas √™tre effectu√©s assez rapidement, ce qui provoque la panique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cas de panique, certaines personnes ignobles en profitent et</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vendent de faux kits de test COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trouvant des victimes sur les r√©seaux sociaux et les messageries instantan√©es</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que le nombre de kits de test COVID-19 est limit√©, vous devez vous fier √† d'autres m√©thodes de diagnostic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les m√©decins se fient souvent aux radiographies pulmonaires (commun√©ment appel√©es fluorogrammes) pour diagnostiquer la pneumonie, la pneumonie, les abc√®s et / ou les ganglions lymphatiques hypertrophi√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19 attaque l'√©pith√©lium des voies respiratoires et les rayons X aident √† examiner l'√©tat pulmonaire du patient. Des appareils √† rayons X sont install√©s dans la plupart des h√¥pitaux, il est donc logique d'utiliser la fluorographie pour tester COVID-19 sans kits de test sp√©ciaux. L'inconv√©nient est qu'une telle analyse n√©cessite un sp√©cialiste en radiologie et prend un temps consid√©rable. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par cons√©quent, le d√©veloppement d'un syst√®me automatis√© sera tr√®s pr√©cieux pour gagner le temps pr√©cieux des professionnels de la sant√© du monde entier. </font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Certaines publications plus r√©centes sugg√®rent que la tomodensitom√©trie est meilleure pour diagnostiquer COVID-19, mais dans cette le√ßon, nous ne travaillons qu'avec des fluorogrammes.</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base de donn√©es</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. </font><font style="vertical-align: inherit;">2. √Ä gauche, des √©chantillons positifs (provenant de patients infect√©s) et √† droite, des √©chantillons n√©gatifs. </font><font style="vertical-align: inherit;">Ces images sont utilis√©es pour former un mod√®le afin de pr√©dire automatiquement la pr√©sence d'une maladie.Notre</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ensemble de donn√©es a √©t√© compil√© par le</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √©tudiant dipl√¥m√© de l'Universit√© de Montr√©al. </font><font style="vertical-align: inherit;">D√©but mars, il a commenc√© √† collecter des fluorogrammes de patients atteints de COVID-19, MERS, SRAS et SRAS et √† les publier dans le</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r√©f√©rentiel sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons t√©l√©charger un fichier √† partir du r√©f√©rentiel</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et s√©lectionner les lignes de celui-ci o√π il est indiqu√©</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sultat positif sur COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type de poumons ¬´post√©ro-ant√©rieur¬ª (AP). </font><font style="vertical-align: inherit;">Autant que je sache, c'est le type d'image utilis√© dans les images ¬´saines¬ª.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un total de 25 fluorogrammes ont √©t√© trouv√©s avec des cas positifs de COVID-19 (Fig.2, √† gauche). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les patients en bonne sant√©, j'ai utilis√© l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ensemble de donn√©es Cuggle (pneumonie)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et s√©lectionn√© 25 images de patients en bonne sant√© (Fig.2, √† droite). </font><font style="vertical-align: inherit;">Cet ensemble de donn√©es pr√©sente un certain nombre de probl√®mes, √† savoir des √©tiquettes bruyantes / incorrectes, mais il fera l'affaire pour une v√©rification conceptuelle du d√©tecteur automatique COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Structure du projet</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section T√©l√©chargements de mon site Web, vous pouvez entrer votre adresse e-mail et trouver un lien vers l'archive avec du code, des scripts et d'autres fichiers pour ce projet. </font><font style="vertical-align: inherit;">Extrayez les fichiers et vous verrez la structure du r√©pertoire:</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
‚îú‚îÄ‚îÄ dataset<font></font>
‚îÇ   ‚îú‚îÄ‚îÄ covid [25 entries]<font></font>
‚îÇ   ‚îî‚îÄ‚îÄ normal [25 entries]<font></font>
‚îú‚îÄ‚îÄ build_covid_dataset.py<font></font>
‚îú‚îÄ‚îÄ sample_kaggle_dataset.py<font></font>
‚îú‚îÄ‚îÄ train_covid19.py<font></font>
‚îú‚îÄ‚îÄ plot.png<font></font>
‚îî‚îÄ‚îÄ covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fluorogrammes se trouvent dans un r√©pertoire </font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o√π deux classes de donn√©es sont divis√©es en r√©pertoires </font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux scripts sont pr√©sent√©s pour construire un ensemble de donn√©es, mais nous ne les examinerons pas aujourd'hui. </font><font style="vertical-align: inherit;">Au lieu de cela, consid√©rez un script </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui enseigne notre d√©tecteur COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la mise en oeuvre</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons √† la mise en place d'un r√©seau neuronal convolutif. </font><font style="vertical-align: inherit;">Ouvrez le fichier </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et collez le code suivant:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script utilise un certain nombre de biblioth√®ques d'apprentissage en profondeur de TensorFlow 2.0 et Keras. </font><font style="vertical-align: inherit;">De plus, nous utilisons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la biblioth√®que Python standard pour l'apprentissage automatique, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour la repr√©sentation graphique et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour le chargement et le traitement des images. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour installer TensorFlow 2.0 (y compris les biblioth√®ques scikit-learn, OpenCV et matplotlib appropri√©es), suivez simplement mes instructions pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous analyserons les arguments de la ligne de commande et initialiserons les hyperparam√®tres:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arguments de ligne de commande</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin d'acc√®s au jeu de donn√©es d'entr√©e</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Un chemin facultatif vers le calendrier de sortie de votre historique d'apprentissage. </font><font style="vertical-align: inherit;">Sauf indication contraire, la valeur par d√©faut est</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: chemin facultatif vers le mod√®le de sortie; </font><font style="vertical-align: inherit;">d√©faut</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes suivantes initialisent la vitesse d'apprentissage initiale, le nombre d'√©poques et les hyperparam√®tres de la taille du paquet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant pr√™ts √† t√©l√©charger et √† pr√©traiter les fluorogrammes:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour charger les donn√©es, nous capturons tous les chemins d'acc√®s aux images dans le catalogue </font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Alors pour chacun </font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous r√©cup√©rons l'√©tiquette de classe ( </font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">du chemin </font><font style="vertical-align: inherit;">.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous le chargeons </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le pr√©traitons, le convertissant en RVB et le redimensionnant √† 224 √ó 224 pixels, afin qu'il soit pr√™t pour le r√©seau neuronal.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise √† jour des listes </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mettez ensuite √† l'√©chelle l'intensit√© des pixels dans la plage [0, 1] et convertissez les donn√©es et les √©tiquettes au format de tableau NumPy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous effectuons un encodage direct </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en divisant les donn√©es en ensembles pour la formation / les tests:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'encodage direct signifie que les donn√©es sont converties au format suivant:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque √©tiquette cod√©e se compose d'un tableau avec deux √©l√©ments: ¬´hot¬ª (1) ou ¬´not¬ª (0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, les lignes suivantes s√©parent nos donn√©es, laissant 80% pour la formation et 20% pour les tests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous assurer que le mod√®le est g√©n√©ralis√©, nous effectuons une augmentation des donn√©es en r√©glant l'image pour qu'elle tourne de fa√ßon al√©atoire de 15 ¬∞ dans le sens horaire ou antihoraire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les trois derni√®res lignes initialisent l'objet g√©n√©rateur d'augmentation de donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, initialisez notre mod√®le VGGNet et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affinez-le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux premi√®res lignes cr√©ent une instance du r√©seau VGG16 avec des poids pr√©alablement form√©s sur ImageNet sans toucher la couche enti√®rement connect√©e (FC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous construisons un nouveau calque enti√®rement connect√©, compos√© de calques </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'ajoutons au-dessus de VGG16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous </font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gelons </font><font style="vertical-align: inherit;">les poids </font><font style="vertical-align: inherit;">pour VGG16, donc </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seule</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la couche FC </font><font style="vertical-align: inherit;">sera entra√Æn√©e </font><font style="vertical-align: inherit;">. Ceci termine la configuration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes maintenant pr√™ts √† compiler et √† former notre mod√®le d'apprentissage en profondeur pour COVID-19:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les premi√®res lignes compilent le r√©seau neuronal avec l'option de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©duire la vitesse d'apprentissage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'optimiseur </font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">√âtant donn√© qu'il s'agit d'un probl√®me √† deux classes, nous utilisons la perte </font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plut√¥t que l'entropie crois√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©marrer le processus d'apprentissage, nous appelons la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©thode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">dans Keras</font></a><font style="vertical-align: inherit;"> , en passant les fluorogrammes √† travers notre objet d'augmentation de donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous √©valuons le mod√®le:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour √©valuer, nous faisons d'abord des pr√©visions sur l'ensemble de test, en pr√©servant les indices de pr√©vision. </font><font style="vertical-align: inherit;">Ensuite, nous cr√©ons et affichons un rapport de classification √† l'aide de scikit-learn, o√π il existe une telle fonction auxiliaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous calculons la matrice des inexactitudes pour une √©valuation statistique plus approfondie:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous faisons ce qui suit:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous g√©n√©rons une matrice d'inexactitudes.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec son aide, nous calculons la pr√©cision, la sensibilit√© et la sp√©cificit√© en imprimant toutes ces m√©triques.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'auto-test, nous g√©n√©rons un graphique avec un historique de la pr√©cision de l'entra√Ænement et des pertes, le sortie dans un fichier graphique:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, enregistrez le mod√®le de classificateur </font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le disque:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation des d√©tecteurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir t√©l√©charg√© tous les fichiers de l'archive avec les sources et les scripts mentionn√©s ci-dessus, ouvrez la console et ex√©cutez la commande suivante pour entra√Æner le d√©tecteur:</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagnostic automatique de COVID-19 selon les r√©sultats de la fluorographie</font></font></h2><br>
<i><b>  :</b>      ,  ¬´¬ª   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montrent les r√©sultats ci-dessus, notre d√©tecteur automatique a une pr√©cision d'environ 90 √† 92% sur un ensemble d'√©chantillons existant. </font><font style="vertical-align: inherit;">Cette √©valuation est bas√©e sur l'analyse d'images uniquement. </font><font style="vertical-align: inherit;">Pendant la formation, plus aucune donn√©e n'a √©t√© utilis√©e, notamment la localisation g√©ographique, la densit√© de population, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La sensibilit√© √©tait de 100% et la sp√©cificit√© de 80%, ce qui signifie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les patients r√©ellement infect√©s sont reconnus dans 100% des cas.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les patients en bonne sant√© sont reconnus en bonne sant√© avec une probabilit√© de 80%.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montre le graphique de l'historique de la formation, notre r√©seau n'est pas trop recycl√©, malgr√© un </font><font style="vertical-align: inherit;">ensemble de donn√©es </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr√®s limit√©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
capacit√© de reconna√Ætre COVID-19 avec une pr√©cision absolue est grande, bien que le taux de faux positifs soit un peu inqui√©tant, car de nombreuses personnes en bonne sant√© seront envoy√©es √† mise en quarantaine avec des patients vraiment infect√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est extr√™mement difficile d'√©quilibrer la sensibilit√© et la sp√©cificit√© lorsqu'il s'agit d'applications m√©dicales, en particulier dans le cas de maladies infectieuses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ce qui concerne la vision par ordinateur et la formation approfondie en m√©decine, vous devez toujours vous rappeler que nos mod√®les pr√©dictifs peuvent avoir des cons√©quences tr√®s r√©elles - un diagnostic manqu√© peut co√ªter la vie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, ces r√©sultats sont collect√©s √† des fins √©ducatives uniquement. </font><font style="vertical-align: inherit;">Cet article et les r√©sultats qui l'accompagnent ne sont pas destin√©s √† √™tre publi√©s dans une revue scientifique et ne sont pas conformes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aux r√®gles TRIPOD pour la cr√©ation de mod√®les de rapports de pr√©vision</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitations, am√©liorations et travaux futurs</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure. 4. Actuellement, les sp√©cialistes de l'intelligence artificielle (IA) et du deep learning souffrent d'un manque de donn√©es de qualit√© pour la formation efficace des syst√®mes de d√©tection automatique COVID-19 sur les images ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source d'image</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'une des principales limites √† la cr√©ation de tels syst√®mes est la donn√©e. Nous n'avons tout simplement pas assez de donn√©es (fiables) pour entra√Æner le d√©tecteur COVID-19. Les h√¥pitaux sont bond√©s de patients COVID-19, mais compte tenu de leurs droits et de leur vie priv√©e, il devient</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encore plus difficile</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de collecter des ensembles d'images m√©dicales de qualit√© en temps opportun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suppose que dans les 12 √† 18 prochains mois, le probl√®me sera r√©solu, mais pour l'instant nous nous contentons de ce que nous avons. J'ai fait de mon mieux (en tenant compte de ma condition mentale et physique actuelle) pour r√©diger un guide pour ceux qui sont int√©ress√©s √† utiliser la vision par ordinateur et l'apprentissage profond dans la lutte contre COVID-19, en tenant compte des limites de temps et de ressources. Mais je dois vous rappeler que je ne suis pas un expert m√©dical. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un v√©ritable d√©tecteur COVID-19 doit subir des tests rigoureux par des professionnels de la sant√© qualifi√©s travaillant main dans la main avec des praticiens exp√©riment√©s de l'apprentissage en profondeur. La m√©thode d√©crite ici, bien s√ªr, ne convient pas √† une utilisation pratique et est destin√©e uniquement √† des fins √©ducatives. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, il faut se demander ce que ce mod√®le ¬´apprend¬ª r√©ellement.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comme je l'ai dit dans</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le guide Grad-CAM la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semaine derni√®re, il est tout √† fait possible que notre mod√®le √©tudie des mod√®les qui ne sont pas li√©s √† COVID-19, mais simplement des variations entre deux ensembles de donn√©es (c'est-√†-dire entre les patients avec et sans COVID-19). Pour confirmer les r√©sultats, des tests approfondis et l'assistance d'experts sont n√©cessaires. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin, les futurs (et meilleurs) d√©tecteurs seront multimodaux.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Maintenant, nous </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consid√©rons </font><i><font style="vertical-align: inherit;">que les</font></i><font style="vertical-align: inherit;"> images (par exemple, les rayons X). Les meilleurs d√©tecteurs automatiques COVID-19 devraient utiliser plusieurs sources de donn√©es, non limit√©es aux images, y compris les indicateurs vitaux des patients, la densit√© de la population, la situation g√©ographique, etc. Les images seules ne sont g√©n√©ralement pas suffisantes pour ce type d'application.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que ce guide servira de point de d√©part √† toute personne int√©ress√©e √† utiliser la vision par ordinateur et l'apprentissage en profondeur pour d√©tecter automatiquement COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et apr√®s?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je termine g√©n√©ralement mes articles de blog avec une recommandation d'un de mes livres ou cours afin que vous puissiez en savoir plus sur l'utilisation de la vision par ordinateur et de l'apprentissage en profondeur. </font><font style="vertical-align: inherit;">Par respect pour la gravit√© du coronavirus, je ne vais pas le faire - ce n'est ni le moment ni le lieu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de cela, je dirai que nous sommes maintenant dans une p√©riode de vie tr√®s terrible. </font><font style="vertical-align: inherit;">Comme les saisons, tout se passera, mais pour l'instant, vous devez vous accroupir et vous pr√©parer √† l'hiver froid - il est probable que le pire reste √† venir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai re√ßu plusieurs lettres de lecteurs de PyImageSearch qui souhaitent utiliser ce temps d'arr√™t pour √©tudier la vision par ordinateur et l'apprentissage en profondeur, plut√¥t que de devenir fou chez eux. </font><font style="vertical-align: inherit;">C'est une pens√©e utile.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce guide, vous avez appris √† utiliser Keras et TensorFlow pour entra√Æner le d√©tecteur automatique COVID-19 sur un fluorogramme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas (encore) de jeux de donn√©es d'images de haute qualit√© et √©valu√©s par les pairs, nous avons donc d√ª travailler avec ce que nous avions, √† savoir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le r√©f√©rentiel de Joseph Cohen sur GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons s√©lectionn√© 25 images de l'ensemble de donn√©es Cohen, en s√©lectionnant uniquement la vue post√©ro-ant√©rieure (PA) et un diagnostic confirm√©.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, 25 images de patients en bonne sant√© ont √©t√© s√©lectionn√©es √† partir d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un ensemble de donn√©es avec des images de fluorographie Kaggle (pneumonie)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons utilis√© Keras et TensorFlow pour entra√Æner le d√©tecteur COVID-19, qui d√©montre une pr√©cision de 90 √† 92%, une sensibilit√© de 100% et une sp√©cificit√© de 80% sur l'ensemble de test (compte tenu de notre ensemble de donn√©es limit√©). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gardez √† l'esprit que le d√©tecteur COVID-19 d√©crit est uniquement √† des fins √©ducatives.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497612/index.html">L'histoire de la fa√ßon dont la main invisible du march√© m'a transf√©r√© dans un endroit √©loign√©</a></li>
<li><a href="../fr497614/index.html">Exp√©riences de pens√©e, paradoxes et limites de la logique // Nous sommes condamn√©s # 2</a></li>
<li><a href="../fr497616/index.html">Entretien avec Alexander Makarov (Yii) sur OpenSource, conf√©rences et Yii</a></li>
<li><a href="../fr497618/index.html">Mise en ≈ìuvre du concept d'acc√®s √† distance hautement s√©curis√©</a></li>
<li><a href="../fr497620/index.html">√âcrire un plugin d'alerte de t√©l√©gramme chrome</a></li>
<li><a href="../fr497624/index.html">Digital Banking Campus - r√©sultats du programme de stages</a></li>
<li><a href="../fr497628/index.html">Comment tuer beaucoup de temps sur un petit script ou l'historique d'une demande de tirage</a></li>
<li><a href="../fr497632/index.html">Web HighLoad - comment nous g√©rons le trafic de dizaines de milliers de domaines</a></li>
<li><a href="../fr497634/index.html">Les coloriages arc-en-ciel sont les meilleurs amis des math√©maticiens</a></li>
<li><a href="../fr497636/index.html">Comment le manque de puissance de calcul a affect√© les batailles navales dans les guerres mondiales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>