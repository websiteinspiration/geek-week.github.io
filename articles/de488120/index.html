<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛌🏾 👌 😟 Warum lohnt es sich, ein 64-Bit-Betriebssystem auf dem Raspberry Pi4 zu installieren? 👐🏿 👣 🚚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einer der Vorteile der Arbeit für ein Softwareunternehmen besteht darin, dass Sie häufig die Möglichkeit haben, neue Hardware-Prototypen zu testen. Al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Warum lohnt es sich, ein 64-Bit-Betriebssystem auf dem Raspberry Pi4 zu installieren?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488120/"><img src="https://habrastorage.org/getpro/habr/post_images/0cc/a7b/84a/0cca7b84aa3da5d217f72f7d3dc84d1b.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer der Vorteile der Arbeit für ein Softwareunternehmen besteht darin, dass Sie häufig die Möglichkeit haben, neue Hardware-Prototypen zu testen. Allerdings nicht in diesem Fall - ich habe einen Raspberry Pi4 gekauft, weil er sehr billig ist! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Raspberry Pi4 verfügt über einen Quad-Core-ARM Cortex A72, bis zu 4 GB Speicher und einen Gigabit-Ethernet-Anschluss - alles für nur 35 US-Dollar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf Raspberry Pi4 haben OS </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspbian</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (basierend auf Debian) und fertige Produktbibliothek, also habe ich es in die SD-Karte gelegt, um schneller zu booten. Ich suchte im Syslog und stellte fest, dass sowohl der Kernel als auch alle Benutzerprogramme als armv7 kompiliert wurden - also für 32-Bit-Speicher.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich weiß, dass Raspberry Pi4 64 Bit unterstützt, daher wollte ich kein 32-Bit-Betriebssystem darauf ausführen. </font><font style="vertical-align: inherit;">Ich nahm eine andere Speicherkarte und legte Debian darauf. </font><font style="vertical-align: inherit;">Debian, das nichts Überflüssiges enthält, wurde als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aarch64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kompiliert </font><font style="vertical-align: inherit;">- was 64-Bit-Speicher bedeutet.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich das 64-Bit-Betriebssystem heruntergeladen hatte, interessierte ich mich dafür, wie viel besser es in 32-Bit funktioniert, und führte mehrere Tests durch.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Synthetische Geschwindigkeitstests</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste, was mir einfiel, war der alte Dhrystone-Test, der seit jeher existiert. Dieses Programm wurde 1988 geschrieben und befasst sich mit mathematischen Berechnungen. Es ist unwahrscheinlich, dass die aktuelle Last simuliert werden kann, und wir können sie nur verwenden, um eine Verbindung mit alter Hardware und Programmen aufrechtzuerhalten. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/698/5f6/083/6985f6083a6d12ec86b7ad6a71c0ee5d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine moderne Digest-Anwendung lässt sich besser durch Berechnen von Hashes simulieren, daher wollte ich einen Test mit SHA1 durchführen. Leider wurde das Dienstprogramm sha1sum ohne Unterstützung für libssl- oder kryptografische Kernelfunktionen kompiliert, sodass ich es aus der Quelle kompilieren musste. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Engpässe bei der E / A zu vermeiden, berechne ich einen Hash einer 2-GB-Datei mit der Option "-s 2 GB abschneiden", sodass keine Eingabe oder Ausgabe von der Karte erfolgte:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b20/b3f/738/b20b3f73835d8f9b1e14c92286b7b049.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SHA1 ist ein realistischerer Test als Dhrystone, da dieser Algorithmus in einer Vielzahl von Anwendungen verwendet wird - Torrents, Git usw.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein 64-Bit-System bietet Zugriff auf einen Speicher von 8 Bytes pro Lese- / Schreibzugriff. </font><font style="vertical-align: inherit;">Ich habe ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einfaches Programm geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das einen großen Puffer platziert - sie schreibt es und liest es dann. </font><font style="vertical-align: inherit;">Um eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">echte Speicherzuordnung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu gewährleisten </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">, habe</font></a><font style="vertical-align: inherit;"> ich mlock () verwendet. </font><font style="vertical-align: inherit;">In diesem Test beträgt das Puffervolumen 2 GB: Der 3-GB-Puffer arbeitete im 64-Bit-Modus und erzeugte im 32-Bit-Modus einen Fehler "Nicht genügend Speicher".</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/08a/53c/2cd/08a53c2cdc361820aa817cfdd2d6ed02.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audiokodierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mir ist aufgefallen, dass viele Benutzer von Raspberry Pi4 einen Computer als Media Center verwenden. Daher habe ich begonnen, Audio mit den beiden beliebtesten Codecs zu codieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe Pink Floyds "Echoes" -Komposition codiert, weil es ein ziemlich langer Track ist und man daraus Messwerte erhalten kann. </font><font style="vertical-align: inherit;">Um E / A-Verzögerungen zu vermeiden, wurden die Quell- und Zieldatei auf RAMFS gespeichert:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/131/58a/8cb/13158a8cb3b7849d02ab52c6881bffd9.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b25/7a2/623/b257a26231bf005fddd15715187e516e.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerkgeschwindigkeitsmessungen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere Option für die Verwendung von Raspberry Pi4 ist die Verwendung als VPN oder Firewall. Ich empfehle nicht, solche Systeme für solche Zwecke zu verwenden, aber viele Leute haben immer noch eine langsame Internetverbindung (weniger als 100 MB), so dass sie möglicherweise nicht auf den langsamen Betrieb des Raspberry Pi4 achten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erste Frage: Wie viel Verkehr kann der Raspberry Pi4 verarbeiten? Wir müssen die Nettonetzwerkleistung des Computers ohne die Einschränkungen der physischen Schnittstellen messen, daher habe ich die iperf3-Sitzung zwischen den beiden Containern gestartet. Container tauschen jedoch Daten über zwei Veths aus, und Veth beschleunigt den Datenverkehr durch falsche Offloads.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Entladen der Berechnung der IP-Prüfsumme erfolgt einfach, indem die Zählung verweigert wird, und das Entladen der TCP-Segmentierung durch Verweigerung der Segmentierung und des erneuten Zusammensetzens des Datenverkehrs: Ein großer Teil der 64-KB-Daten wird einfach unverändert in den Speicher übertragen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um solche Momente zu vermeiden, habe ich das Entladen mit dem Befehl </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ethtool -K veth0 tx off rx off tso off gro off gso off verboten</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a26/549/b2c/a26549b2c6ac9a2737f791f317dcf733.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firewall</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die schnellste Netzwerkausrüstung ist in der Lage, einen Teil des Datenverkehrs zu löschen, und der schnellste Weg, dies zu tun, ist die TC-Regel. </font><font style="vertical-align: inherit;">Um die maximal mögliche Geschwindigkeit nicht zu erreichen, habe ich die minimale Ethernet-Frame-Größe 64b verwendet. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f81/e12/4af/f81e124af378a94ce8c620e3f285d7ac.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl beide Systeme die maximale Übertragungsgeschwindigkeit (1,5 Mbit / s) nicht erreichten, zeigte der 64-Bit-Kern eine etwas höhere Geschwindigkeit als der 32-Bit-Kern. </font><font style="vertical-align: inherit;">Wenn Sie Raspberry Pi4 als Firewall verwenden möchten, müssen Sie den 64-Bit-Kernel verwenden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer häufiger Anwendungsfall für Raspberry Pi4 ist ein VPN-Server bzw. OpenVPN. </font><font style="vertical-align: inherit;">Ich bevorzuge WireGuard, deshalb habe ich beide Programme überprüft, da beide einfach zu installieren sind: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/467/c2f/a26/467c2fa2634f3568d4574654eb0faaa0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenVPN ist erwartungsgemäß zehnmal langsamer als WireGuard. </font><font style="vertical-align: inherit;">Was nicht erwartet wurde, war, dass OpenVPN mit 32 und 64 Bit / s mit der gleichen Geschwindigkeit arbeitet. </font><font style="vertical-align: inherit;">WireGuard überlastet den Gigabit-Port in beiden Fällen fast - vielleicht haben wir das NIC-Limit erreicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um herauszufinden, ob WireGuard noch schneller arbeiten kann, habe ich einen weiteren Test mit zwei Containern durchgeführt, die kein physisches Ethernet verwendeten. </font><font style="vertical-align: inherit;">Das einzige Problem war, dass sowohl der Client als auch der iperf3-Server auf dem Raspberry Pi4 ausgeführt wurden und zwei Kerne geladen wurden.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/aff/4ec/d3f/aff4ecd3f9ded87dd079827c3d7dfc8b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie erwartet schnitten OpenVPN und 32-Bit-WireGuard, die von der CPU begrenzt wurden, schlechter ab, und 64-Bit-WireGuard schnitt besser ab.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerungen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich lese oft Aussagen wie "es lohnt sich nicht", "Sie werden ein paar Millisekunden gewinnen" usw., einfach weil der Raspberry Pi4 kein sehr leistungsfähiger Computer ist. </font><font style="vertical-align: inherit;">Das ist nicht so! </font><font style="vertical-align: inherit;">Wie jeder, der an eingebetteten Geräten beteiligt ist, weiß, ist die Optimierung langsamer Hardware-Software noch wichtiger als bei schneller Hardware. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wusste bereits, dass ein 64-Bit-Betriebssystem auf dem Raspberry Pi4 besser funktionieren würde, aber ich wusste nicht, wie viel besser. </font><font style="vertical-align: inherit;">Also habe ich all diese Tests gemacht. </font><font style="vertical-align: inherit;">Ich hoffe, dass es Ihnen gefallen hat!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488104/index.html">DBA: Finden Sie nutzlose Indizes</a></li>
<li><a href="../de488108/index.html">SAP HANA Lab in Azure</a></li>
<li><a href="../de488112/index.html">Grundlegendes zu Iteratoren in Python</a></li>
<li><a href="../de488116/index.html">Fünf wichtige Lektionen zur Spielbalance</a></li>
<li><a href="../de488118/index.html">Haxe Winter Statusbericht</a></li>
<li><a href="../de488122/index.html">$ 1,5 Kompaktbrenner aus Aerogel, Aluminium und Papierhandtüchern</a></li>
<li><a href="../de488128/index.html">Vorzugspakete: Was wird zu den Gehältern von IT-Spezialisten in Armenien hinzugefügt?</a></li>
<li><a href="../de488130/index.html">Lerne Englisch mit dem Telegramm-Bot</a></li>
<li><a href="../de488134/index.html">CI auf Github für Android an einem Tag erhöhen</a></li>
<li><a href="../de488136/index.html">Wie hat der Atlas-Roboter gelernt, akrobatische Stunts zu machen, die für einen normalen Menschen unerträglich sind?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>