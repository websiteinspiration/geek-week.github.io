<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♈️ 🏇🏻 🔪 NetflowとSIEM監視ソリューションの統合 💇 👩‍👦 🍚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SIEMは、長い間、セキュリティイベントの分析とインシデントの検出において事実上の標準になりました（ただし、SIEMを放棄し、機械学習テクノロジのアドオンを使用してログを管理するソリューションに置き換える動きがあります）が、このソリューションの有効性は、使用するデータソース。それでも、通常、SIEM...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NetflowとSIEM監視ソリューションの統合</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/501820/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEMは、長い間、セキュリティイベントの分析とインシデントの検出において事実上の標準になりました（ただし、SIEMを放棄し、機械学習テクノロジのアドオンを使用してログを管理するソリューションに置き換える動きがあります）が、このソリューションの有効性は、使用するデータソース。それでも、通常、SIEMのスペシャリストは主にログを扱い、Netflowなどの重要な情報源は別として、ログに該当しない、または該当しないが、手遅れになることが多いものを確認できます。これは多くの質問を引き起こします。最新のSIEMソリューションにNetflowサポートが必要なのはなぜですか？ SIEMはNetflow分析から何を取得できますか？メーカーがある場合、SIEMをNetflowと統合するためのオプション、Netflowサポートをソリューションに直接埋め込んでいる人や、さまざまなNetflowコレクターと連携したい人もいます。 SIEM Netflowを使用する機能は何ですか？これについて話します。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脅威検出のためのNetflow</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットセキュリティをサイバーセキュリティに使用する可能性についてはすでに説明しました。ネットワーク機器や生のトラフィックのログとは異なり、Netflowはネットワークセッションから収集されたメタデータを使用してトラフィックを分析できるプロトコルであることを思い出してください。これらは、アドレス、宛先および送信元ポートだけでなく、ICMP、IPサービスタイプ、IPプロトコルタイプ、ネットワークインターフェース、セッション期間、開始時間と終了時間などのメッセージタイプとコードでもあります。ログが通常、端末デバイス（サーバー、ワークステーション、DBMSなど）または保護手段で生成される場合、前者がセキュリティイベントを生成しないか、セキュリティ手段をそれらに適用できない状況で何をすべきか、後者は境界にのみインストールされ、企業または部門のネットワーク内で何が起こっているのかわかりませんか？もう1つは、ネットワーク機器-スイッチとルーター（ハードウェアまたは仮想）、ワイヤレスアクセスポイントとコントローラーです。それらは内部にインストールされ、ユーザー、デバイス、アプリケーションの相互作用は常にそれらを通過します。それらを渡すことは不可能です！このやり取りに関するデータをNetflowに送信することで（Cisco ASAまたはFirepowerでも生成されます）、ITだけでなくサイバーセキュリティのための貴重な情報源を得ることができます。機器がフロープロトコルを理解できない場合は、それらを通過するトラフィックのフローレコードを生成する特別なエクスポーター、ソフトウェア、またはハードウェアソリューションを使用できます（Cisco、Netflow Generation Applianceまたはそれらを通過したトラフィックのストリームレコードを生成します（Cisco、Netflow Generation Applianceまたはそれらを通過したトラフィックのストリームレコードを生成します（Cisco、Netflow Generation Applianceまたはワイヤレスアクセスポイントとコントローラー。それらは内部にインストールされ、ユーザー、デバイス、アプリケーションの相互作用は常にそれらを通過します。それらを渡すことは不可能です！このやり取りに関するデータをNetflowに送信することで（Cisco ASAまたはFirepowerでも生成されます）、ITだけでなくサイバーセキュリティのための貴重な情報源を得ることができます。機器がフロープロトコルを理解できない場合は、それらを通過するトラフィックのフローレコードを生成する特別なエクスポーター、ソフトウェア、またはハードウェアソリューションを使用できます（Cisco、Netflow Generation Applianceまたはワイヤレスアクセスポイントとコントローラー。それらは内部にインストールされ、ユーザー、デバイス、アプリケーションの相互作用は常にそれらを通過します。それらを渡すことは不可能です！このやり取りに関するデータをNetflowに送信することで（Cisco ASAまたはFirepowerでも生成されます）、ITだけでなくサイバーセキュリティのための貴重な情報源を得ることができます。機器がフロープロトコルを理解できない場合は、それらを通過するトラフィックのフローレコードを生成する特別なエクスポーター、ソフトウェア、またはハードウェアソリューションを使用できます（Cisco、Netflow Generation Applianceまたはこのやり取りに関するデータをNetflowに送信することで（Cisco ASAまたはFirepowerでも生成されます）、ITだけでなくサイバーセキュリティのための貴重な情報源を得ることができます。機器がフロープロトコルを理解できない場合は、それらを通過するトラフィックのストリームレコードを生成する特別なエクスポーター、ソフトウェア、またはハードウェアソリューションを使用できます（Cisco、Netflow Generation Applianceまたはこのやり取りに関するデータをNetflowに送信することで（Cisco ASAまたはFirepowerでも生成されます）、ITだけでなくサイバーセキュリティのための貴重な情報源を得ることができます。機器がフロープロトコルを理解できない場合は、それらを通過するトラフィックのフローレコードを生成する特別なエクスポーター、ソフトウェア、またはハードウェアソリューションを使用できます（Cisco、Netflow Generation Applianceまたはそれらを通過したトラフィックのストリームレコードを生成します（Cisco、Netflow Generation Appliance、またはそれらを通過したトラフィックのストリームレコードを生成します（Cisco、Netflow Generation Appliance、または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stealthwatch Flow Sensor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">Netflowストリームに重畳された異常やシグネチャを検出するアルゴリズムと機械学習方法により、情報セキュリティの脅威やITインフラストラクチャの問題を特徴付ける、ネットワークトラフィックの標準動作からの逸脱を特定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Netflowはネットワークトラフィック内で送信されるものを言うことができないことを覚えておく価値があります（Netflowによって使用されるアプリケーションと悪意のあるコードを認識できるようにするテクノロジーはすでにあります）、それは他のタスクのために開発されました。</font><font style="vertical-align: inherit;">しかし、誰が、誰と、どのように、どのくらい「スポーク」したかを知ることができます。</font><font style="vertical-align: inherit;">フロープロトコルにはさまざまなバージョンが存在しますが、それらのほとんどでは、次のデータを収集できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信元および宛先IPアドレス</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信元および宛先ポート</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコル</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプのサービス</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースインターフェース</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始と終了のタイムスタンプ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信される情報の量。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のバージョン（IPFIXやNetflow v9など）では、データ本体から情報の一部を抽出できるため、Netflowアナライザー（スタンドアロンまたはSIEMに組み込まれている）で実行中のアプリケーションを識別できます。</font><font style="vertical-align: inherit;">このすべての情報は、ネットワークトラフィックの異常や脅威を検出するのに十分な場合がよくあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/qa/mq/0gqamq6h7orvlobxcnercgfl5os.png" alt="画像"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetflowとSIEM：強みは何ですか、兄弟？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターゲットシステムがログを生成しない場合、または侵入者がログを無効にした場合はどうなりますか？</font><font style="vertical-align: inherit;">ターゲットシステムにプロセッサがロードされてシステムの速度が低下するため、セキュリティ機能がない場合はどうすればよいですか？</font><font style="vertical-align: inherit;">従業員がSIEMに接続されていない個人用デバイスを持ち込んだ場合、どうすればよいですか？</font><font style="vertical-align: inherit;">情報の唯一のソース-ネットワークトラフィック-はいずれにしてもターゲットデバイスによって生成されます。</font><font style="vertical-align: inherit;">ネットワークトラフィック分析（NTA）ソリューションを使用してSIEMなしで分析できる「クリーン」なNetflowを特定するのに役立つものは何ですか？</font><font style="vertical-align: inherit;">このような脅威と異常の短いリストを次に示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">悪意のあるコード、ランサムウェア、暗号マイナー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドサーバーとの相互作用</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークスキャン</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービス拒否攻撃</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ漏洩</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSHまたはRDPのハッキング</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレントおよびその他のP2Pアプリケーション</font></font></li>
<li>   ,   </li>
<li> </li>
<li> ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、SIEMが収集するログから何が得られますか？ノードでのユーザーアクティビティ、リソースへのアクセス、システムへの出入り、ネットワーク機器やセキュリティツールからのアラームなどを監視する機能。 SIEMに送信され、そこで分析されるログとNetflowの組み合わせにより、攻撃されたばかりのデバイスからの新しいセッションと新しいトラフィック（境界をバイパスするものを含む）をすばやく特定できます。これらのデータタイプを組み合わせることにより、正しく設定されていないネットワークセキュリティ機能を特定することもできます。 Netflowは、新しいタイプのトラフィック、そのバースト、外部および内部リソースとの相互作用、データ漏洩、悪意のあるコードの配布、チームサーバーとの相互作用を検出する機能で、従来のSIEM機能を補完します。許可されたプロトコルなどへの悪意のある負荷のカプセル化</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
従来の方法で処理されたSIEMデータとNetflowの組み合わせにより、さまざまなセキュリティイベントを表示できるだけでなく、それらをより速く表示して、いわゆるTTD（Time-to-Detect）パラメーターを削減し、結果として応答時間を短縮できます。 SIEMとNetflowの分析が互いに独立して機能し、うまく機能できることは明らかですが、相乗効果を実現できるのはこれら2つのソリューションの組み合わせです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トラフィック動作のパターンを変更すると、疑わしい動作または異常な動作を示す場合があります。たとえば、インターネットにアップロードされたデータのしきい値を超えている場合は、リークを示している可能性があります。提供されたRFCと比較したDNSクエリおよび応答のサイズの変化は、悪意のあるコードの動作の事実を特徴付けることができます（シスコの統計によると、マルウェアの92％がDNSを使用してコマンドの受信、データのダウンロード、または更新のダウンロードを行っています）。 Equifaxの話を覚えていますか？その後、攻撃者はWebポータルにアクセスし、次に内部データベースサーバーにアクセスして、大量のデータをゆっくりと外部にアップロードしました。それとは別に、これらすべてのイベントはそれほど重要ではなく、収集されてNetflowデータで強化されただけで、情報セキュリティインシデントを特定することができました。これは、Netflow分析システムの別のケースです。これは、データベースへのクエリが頻繁に行われるWebポータルと、突然大量のデータをポータルに提供するデータベースの両方の非標準的な動作を検出できます。私はもう</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前にHabrでこのシナリオ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">について説明</font></a><font style="vertical-align: inherit;">しました。 Netflowデータを受信するSIEMは、インシデントにより効果的に対応するために、IPS、ITU、プロキシ、アンチウイルス、EDRなどによって生成されたイベントの追加のコンテキストを取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一つの例。侵入検知システムにシグネチャがない未知の攻撃の検出-ネットワーク異常とホストからのイベントの相関、およびトリガーのトリガーによる。たとえば、100ノードを3分でスキャンすると、ブリッジヘッドを拡張する悪意のあるコードの動作を特徴付けることができます。サーバーからの応答時間の増加は、サーバーに対するDDoS攻撃を特徴付ける可能性があります。たとえば、DNSプロトコルを介して送受信される情報量の不一致は、データリークを示している可能性があります。これは、私がDNSpionageキャンペーンを見つけることについて話し合ったときに以前にすでに見たケースです。同時に、あなたはでていることに注意することができます</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1ケース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々は唯一のNetFlowを分析し、中に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々はまた、収集された端末装置からのデータを、サンドボックス、DNSゲートウェイなど</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NetflowをSIEMに統合できるもう1つの分野は、状況認識です。フローとログ、コンテキスト、地理位置情報、ユーザーアクティビティ、レピュテーションデータとの相関関係。たとえば、前のメモで、イランまたは北朝鮮からのノードを使用して内部トラフィックを検出したケースを引用しました。これらの国と連絡がない場合、これはおそらく、悪意のあるコードが情報を盗んだか、会社を標的とした政府系ハッカーの兆候である可能性があります。ネットワーク異常分析システムは、対応する異常を特定することにより、この作業の一部を実行できます。ただし、このインシデントに関与したユーザーも理解したい場合は、Active Directoryからのユーザー名の形式で追加のコンテキストが必要になります。Netflow自体はこの情報を操作しません-したがって、ADからの情報で情報を充実させる必要があります。使用する場合</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatchの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、これを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ISE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と統合するだけで済みます</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。CiscoISEは</font></a><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">IPおよびMACアドレスを特定のユーザーおよびデバイスプロファイルにリンクします。 Cisco ISEがネットワークに展開されていない場合はどうなりますか？ユーザー情報でNetflowを強化するタスクは、SIEMの責任です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一つの例。私は自分のコンピューターで実行されているWebサイトをいくつかのタスクに使用しています。しかし、何人の一般ユーザーが同じことを自慢できるでしょうか？突然、ユーザーのコンピューターからWebサーバーの運用に固有のトラフィックをキャプチャしますか？または、Windows PCで作業しているユーザーがいるセグメントに、Linux OSに固有のトラフィックが突然表示されます。おそらく、この「便利な」ユーザーは、Linuxで仮想マシンを作成することを決定したため、セキュリティポリシーに違反しましたか？また、この方法でリモートアクセスするユーティリティ（RATなど）、クリプトマイナー、クラウドまたはピアツーピアアプリケーションなどを特定することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シングルベンダーアプローチの支持者である場合、シスコソリューションに基づいてセキュリティシステムを構築すると、SIEMへの依存が減少します。ファイアウォール、電子メール保護、サンドボックス、PC保護ソリューション（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco AMP for Endpoints</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）および等データ、コンテキスト、セキュリティイベント、コマンドを直接交換できます。しかし、インフラストラクチャがさまざまなメーカーのさまざまなソリューションを継承している場合、SIEMはさまざまな製品の動物園から完全なソリューションを構築するのに役立つリンクになります。いずれの場合も、既存のネットワークインフラストラクチャから収集されたネットワークトラフィックの分析と、SIEMが通常収集するデータを組み合わせることにより、</font><s><font style="vertical-align: inherit;">視野が</font></s><font style="vertical-align: inherit;">広がり</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISサービスがより多くの情報を確認し、より迅速に応答する能力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEMでNetflowを使用する利点：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションおよびPC /サーバーのレベルから収集された情報セキュリティに関する他の情報とネットワークアクティビティの相関</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プライバシー法（GDPRなど）の違反のリスクが高い場所を監視する機能。ネットワークトラフィックのヘッダーまたはメタデータのみを分析でき、その内容は分析できません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インシデントまたは標的型攻撃の開発の最初の段階を特徴づける異常の検出</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インシデントを特徴付けるさまざまなデータの収集と保存、およびIS調査の一部として、または法執行機関との対話としてそれらを提供すること。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">銀の弾丸？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、Netflowが誰もが長い間探し求めていた特効薬であるとは思わないでください。また、欠点もあります。たとえば、その処理により、古いまたは誤って選択されたネットワーク機器のプロセッサとメモリが読み込まれ、パフォーマンスとネットワーク帯域幅に悪影響を及ぼす可能性があります。 Netflowを効果的に使用するには、ハードウェアサポートまたはいわゆるエクスポーターの使用が必要になる場合があります。これらのエクスポーターは、自身を介してトラフィックをNetflowに送信します（スイッチドネットワークでIDS / COBの導入に遭遇した人は、同様のタスクにいわゆるテープまたはスプリッターを使用しました） ）このような外部ソリューションの例を2つ紹介しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Cisco Stealthwatch Flow Sensor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびCisco Netflow Generation Appliance。</font><font style="vertical-align: inherit;">しかし、最近のネットワークの近代化を考えると、スイッチとルーターがすでに1つまたは別のバージョンのNetflowをサポートしているため、追加のエクスポーターは必要ないと想定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
知っておく価値のある他のNetflow機能は次のとおりです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析システムの誤ったトレーニングまたは不十分なトレーニング、および分析システムがまだ「通知」されていないIT運用の変更に関連する可能性がある誤検知</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下とSIEMストレージへの影響（これについてはさらに詳しく説明します）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflowを介して収集されたメタデータは、完全な調査を常に可能にするわけではありません。これには、PCAP形式の生のトラフィックが必要になる場合があります。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetflowとのSIEM統合オプション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在市場に出ているどのSIEMがネットワークトラフィックを処理しますか？</font><font style="vertical-align: inherit;">ほとんどすべてのことを言わなければなりませんが、さまざまな方法で、多くの場合、これには個別の有料ライセンスが必要です。</font><font style="vertical-align: inherit;">SIEMでNetflowを分析するための3つのオプションを強調します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEMのNetflowの組み込みサポート</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflowを生成してSIEMに送信するための独自のエクスポーター/センサー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEMとネットワークトラフィック分析（NTA）クラスの外部ソリューションとの統合。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflowサポートが統合されたSIEM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、ソビエト後のSIEM分野で非常に人気のあるMicrofocus ArcSightには、Netflowのサポートが組み込まれています。</font><font style="vertical-align: inherit;">この機能により、SIEMはネットワークフローをその場で他のセキュリティイベントと関連付けたり、脅威インテリジェンスソースからのデータでそれらを強化したりできます。</font><font style="vertical-align: inherit;">ただし、このオプションには次の欠点があります。</font></font><br>
<br>
<ul>
<li>-,         ,     .         ( , «   »,   )?</li>
<li>-,  Netflow  SIEM,          Netflow    .      ?    SIEM  ,              , ,   ?   -   «» Netflow     ?</li>
</ul><br>
<img src="https://habrastorage.org/webt/lo/jh/ge/lojhgex6afz5whncqwvjnwb3qxo.png" alt="画像"><br>
<br>
<ul>
<li>-,     .     ?             VPN- (      ).</li>
<li>-,    Netflow   SIEM   FPS  ?</li>
<li>,      ,  flow-    (.  ).       Netflow,          SIEM.   Netflow      — v5,     ,  v9,      IPv6, MPLS  .     Flexible Netflow ( Netflow v9), IPFIX,    Netflow v10, sFlow, , ,     , NetStream, Jflow  ..           SIEM?</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEMの選択のみに直面している場合は、検討中のパラメーターのリストに、機器によって生成されるNetflowのタイプも含めてください。</font><font style="vertical-align: inherit;">SIEMをすでに購入している場合は、選択肢があまりありません。</font><font style="vertical-align: inherit;">この場合、次のオプションを検討する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個別のISネットワーク異常アナライザー（たとえば、Cisco Stealthwatch）。これは、独自に分析全体を実行し、その結果をSIEMに提供します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークフローに関するSIEMサマリー分析に送信できる別個のNetflowコレクター。SIEMはすでにこのデータを分析します。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どのくらいぶら下げてグラムで、つまりバイトで保存するのですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ところで、NetflowをSIEMと統合するための次のオプションに進む前に、セキュリティイベント分析システムでどのくらいのNetflowデータを受け取るかという質問に触れます。救済策または定期的なログについては、EPS（1秒あたりのイベント数）に関するかなりの数の例と統計があります。 FPS（1秒あたりのフロー）に関するデータは多くありません。 Netflowの平均ボリュームは、ネットワーク上のクライアントデバイスとサーバーによって作成された一意のTCP / UDPソケットの数に直接比例します。これは、場合によって大きく異なります。また、サンプリング（つまり、Netflowデータの選択的な転送）を含めることも、データの総量に影響します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、いくつのFPSを生成できますか？</font><font style="vertical-align: inherit;">もちろん、これは状況に大きく依存しますが、通常のワークステーションの場合、この数値は平均で1.5 FPSであり、ピーク負荷時は6 FPSです。</font><font style="vertical-align: inherit;">つまり、ネットワークに1万のノードがあり、各ノードの平均FPSが4の場合、ネットワークは1秒あたり約4万のフローを生成します。</font><font style="vertical-align: inherit;">なぜそんなに？</font><font style="vertical-align: inherit;">上で書いたように、それはアプリケーションまたはネットワークが生成する一意の接続の数に依存します。</font><font style="vertical-align: inherit;">今日、ユーザーのコンピューター上で実行されている多くの「おしゃべりな」プログラムがあり、ブラウザーなどのインターネットからコンテンツをアクティブにロードしたり、ウイルス対策などの更新を常にチェックしています。</font><font style="vertical-align: inherit;">ネットワーク上のFPSの数を積極的に増やしているソフトウェアとサービスのサンプルリストを次に示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドビ、アンチウイルス、Java</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スカイプ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールクライアント</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netbios</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィード指向のアプリ（Twitter、ニュース、電報など）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より正確な答えは、必要なネットワークセグメントでのNetflowの分析を示します。これは、ネットワークデバイス（メーカーによって異なります）で1つのコマンドだけで実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのNetflow v5レコードの長さは48バイトです。 Netflowの9番目のバージョンでは、正確な数値はありません。このバージョンでは、レコードに何を含めるかを説明できるため、長さが大きく異なる可能性があるためです。しかし、大まかに言えば、ストリームレコードの平均長に100バイトを使用する場合（各ネットワークパケットで20〜30のストリームを生成できる場合）、生成されてSIEMに転送されるデータ量を見積もることができます。同時に、このデータのSIEMストレージボリュームは大きくなる可能性があります（これは、ストレージフォーマット、インデックス作成、圧縮、バックアップなどによって異なります）。ちなみに、FPSの数を計算するときは、DDoS攻撃のフレームワークでは「平均FPS」の概念が機能しないことに注意してください。接続ごとに、各TCP SYNパケットは個別のストリームになり、強力なDDoS攻撃では、FPSの数があなたのピークは非常に大きくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Netflowを中央のSIEMに転送する場合は、インターネットを介してNetflowを「駆動」する必要があることを前述しました。</font><font style="vertical-align: inherit;">Netflowの生成によってネットワークに大きな負荷がかかり、帯域幅が減少するとは思わないでください。</font><font style="vertical-align: inherit;">私たちの調査によると、データ本体全体ではなく、見出し情報と追加のテレメトリのみがNetflowで送信されるため、ネットワークテレメトリのエクスポート元のインターフェイスへの負荷は約1〜2％増加します（実際には、サンプリングと最新のプロトコルバージョンを使用します） Netflowのこの値は1桁少なくなり、0.1％のレベルで変動する可能性があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">収集は分析できません</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、まだSIEMで生のNetflowを取得することに決めたとしましょう。このシナリオには別のニュアンスがあります。 SIEMでのNetflowサポートの可用性が十分ではないことを理解することは非常に重要です。セキュリティの観点からこのNetflowを処理できることは非常に重要です。つまり、組み込みのNetflowストリームを分析および相互に関連付けるためのルールがあり、新しいタイプの攻撃に対して常に更新されます。 Netflowが次の図を提供するとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b6/up/na/b6upnaoghurwuh9pns2lv0cqpya.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSHプロトコルが急増しています。実際、RDPプロトコルへの攻撃についても同じ状況が見られます。これはパスワード推測です。しかし、これは、対応するルールがあり、多数のNetflowストリームから1つのイベント「パスワードマッチング」を収集するという条件でのみ明らかにすることができます。次に、SIEMにはNetflowサポートが組み込まれており、セキュリティの観点からそれを分析できます。したがって、このパスを選択する場合は、「そのまま」NetflowでSIEMを分析できるものを売り手に尋ねる必要があります。何もない場合、独自のNetflowプロセッサを記述するプロセスはどれほど面倒であり、これを行う専門家はいますか？ Netflowへのコネクタの記述は、それを処理して規則的な作業を必要とする異常を識別するためのルールとは異なり、Netflowへのコネクタの記述はそれほど難しくないことをよく認識しています。これは、IDS（Snort、Zeek、Suricata）用に他の誰かのエンジンをコピーすることですが、新しく発見されたエクスプロイトや攻撃のシグネチャを継続的に書き込むことはできません。上記の例では、システム自体がSSHでのトラフィックの急増を認識し、これらがSSH（Telnet、RDP、またはFTP）での「パスワード推測」攻撃であると言う必要があります。次のようになります（たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fc/h8/--/fch8--okgcjqtnsxzuufafzja28.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、SIEMまたは別のNetflow分析ツールのいずれかが提供する機能を使用して、このインシデントをより深いレベルで調査できます。</font><font style="vertical-align: inherit;">情報セキュリティの観点からNetflowを「理解」する機能がなければ、Netflowの組み込みサポートの存在はSIEMにとって疑わしい利点です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9f/4z/b-/9f4zb-x6zrz4-f_rknuozlv0n5s.png" alt="画像"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自のNetflowエクスポーターを備えたSIEM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEM市場のもう1つのプレーヤーであるLogRhythmは、NetMonストリームの追加のエクスポーターを提供します。これは、分散インフラストラクチャだけでなく、機器がNetflowをサポートせず、通過するネットワークトラフィック用に個別のNetflowジェネレーターを必要とするネットワークでも役立ちます。実際、この実施形態では、SIEM製造業者はネットワークベンダーの機能を引き受け、Netflowを生成してSIEMの負荷を軽減するソリューションを開発し、生のNetflowを処理および保存する必要をなくします。この状況は、多くの新世代ファイアウォールでのSSLオフロードのサポートに似ています。はい、存在しますが、HTTPSトラフィックの集中的な交換により、NGFWへの追加の負荷により、スループットが大幅に低下します。したがって、高負荷のアーキテクチャでは、通常、このタスクに別のデバイスが割り当てられ、SSLトラフィックを復号化してからNGFWに返すタスクを引き受けます。このシナリオのSIEM Netflow処理でも同じことが起こります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yl/x6/z0/ylx6z0lpfhuepced9wmgjjodgmq.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオにも欠点があることは明らかです-分析されたFPSの数のライセンスを支払うことに加えて、トラフィックを通過させてNetflowを生成する追加のセンサーにも支払う必要があるため、ソリューションの最終価格が高くなります。さらに、ネットワークアーキテクチャに変更を加える必要がありますが、これはとにかく行う必要があるため、欠点ではなく、このシナリオの機能と呼びます。ネットワーク機器がNetflowの生成方法を認識しておらず、ネットワークの異常を分析する場合、これを行う唯一のオプションは、個別のセンサーを使用することです。唯一の問題は何が安くなるかです-SIEMメーカーからセンサーを購入するか、ネットワークメーカー（たとえば、Cisco Netflow Generation Appliance）またはネットワーク異常分析ツールの開発者（たとえば、）のセンサーを使用してくださいCisco Stealthwatch Enterprise Flow Sensor）。このオプションでは、SIEMが情報セキュリティの観点からNetflowを分析できるかどうかを確認することも価値がありますか、それともエクスポーター/センサーの形式のコネクターが取り出されているだけですか（通常、それは可能です）？</font></font><br>
<br>
<h3>SIEM,   NTA</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のオプションであるNTAクラスソリューションとの統合は、NTAが本質的にNGFW、アンチウイルス、セキュリティスキャナー、IPSなどと同じセキュリティイベントジェネレーターであるため、非常に明白です。ただし、このシナリオは、使用している2つのセキュリティ分析ツールを組み合わせているという点で興味深いものですが、別々に操作することもできます。 NTAを使用すると、ネットワークトラフィックの詳細な分析を実行し、悪意のあるコード、DDoS攻撃、情報漏えいを検出し、リモートユーザーを監視できます。同時に、優れたネットワークトラフィック分析ツールを使用すると、ネットワーク機器がNetflowまたはそのネットワークをサポートしていないセグメントで個別のセンサーを使用することもできます。含めると、ネットワーク機器の負荷が増加します。このシナリオのNTAでは、Netflowを（異なるバージョンで）集計、処理、分析できます。SIEMでは、1つまたは別の悪意のあるアクティビティが検出された場合にのみ警告を発します。明らかに、このオプションは、あなたまたはあなたのITスタッフがすでにネットワークのトラブルシューティング用のNTAクラスソリューションを持っている場合に使用すると意味があり、ネットワークセキュリティタスクにも使用できます。または、逆に、NTAソリューションの費用をネットワーク担当者と共有したい場合、それをネットワーク管理者がタスクに使用し、あなたはあなたのネットワーク管理者に使用します。誰が自分のタスクに使用し、あなたがあなたのタスクに使用します。誰が自分のタスクに使用し、あなたがあなたのタスクに使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションの不利な点は、NTAクラスソリューションの追加コスト、および2つの異なるソリューションでの作業の基本に関する専門家の二重のトレーニングの必要性です。ただし、その一方で、ネットワークトラフィックを分析するための個別のソリューションにより、組み込みのNetflowサポートを備えた単一のSIEMよりも詳細なインシデント調査が可能になり、個別のNetflowセンサーを備えたSIEMメーカーよりも柔軟なアプリケーションが可能になります。ただし、NTAクラスの個別のソリューションについて説明するときは、ネットワークトラフィックを分析したりネットワークパフォーマンスを監視したりするためのツールだけでなく、セキュリティソリューションを意味することを覚えておいてください。たとえば、前述のSolarWinds NTAは、ITタスクをサポートするためにネットワークトラフィックを適切に分析しますが、情報セキュリティの目的では不十分です。InfoVistaの5ViewやFlukeのVisual TruViewも同様です。そして同じもの、例えば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、社内の両方で使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/dd/jz/geddjzdyxryg6go3vpqkhswzmdq.jpeg" alt="画像"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択するときに何を探すべきですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セキュリティの目的でNTAソリューションを選択するとき、およびNetflowをサポートするSIEMまたはSIEMベンダーによって提供されるエクスポーター/センサーを分析するときは、次の基準に注意することをお勧めします。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検出可能な悪意のあるアクティビティの種類。</font><font style="vertical-align: inherit;">情報セキュリティを監視するためのツールを使用します。</font><font style="vertical-align: inherit;">情報セキュリティに関連するさまざまな異常や脅威を「すぐに」特定できるはずであると想定するのは当然です。</font><font style="vertical-align: inherit;">さらに、このパラメーターは3つの部分に分かれています。さまざまなタイプの情報セキュリティ脅威を検出する組み込みアルゴリズム、カスタムハンドラー/ルールの作成、脅威インテリジェンスの外部ソースのサポートにより、分析されたフローを脅威データで強化します。</font></font></li>
<li>  Netflow. ,      ,            .</li>
<li>.     ,     1  (   FPS)?     60  FPS,  NTA   40 ,       ,      ,   , ,  80  FPS.</li>
<li> . , flat, …        ,          . ,  .    .  ,       (, ,  Argus, Fluke, Plixer, Riverbed  SolarWinds),   ,      .             ,       .           ,  ;     ,       .      , ,  Cisco Stealthwatch.</li>
<li> .         ,      ,      ,     ,     .           —     NTA.     ,  Cisco    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   nfdump  OSU FlowTools      Lancope,           .</li>
<li>   .   ,                -    .       :<br>
<br>
<ul>
<li>  /</li>
<li> flow cache (   cash flow :-)</li>
<li>   .   MAC-,  VLAN,  MPLS,  TCP, , ,       ,     ,       (  IPFIX  ).</li>
</ul></li>
<li>   .        Netflow  SIEM,    SIEM  NTA  .  , ,     (,   )  REST API, syslog  ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEMに関係なく何を選択するかという問題である場合は、選択したソリューションが提供する脅威ハンティングの機会に目を向けることもお勧めします。</font><font style="vertical-align: inherit;">しかし、ノートのトピックが少し異なって選択されたので、今はこの側面に注意を払いません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価格問題</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの3つのオプションをコストの観点から見ると、3番目のオプションは設備投資の観点から最も高価であることがわかります（3つのシナリオすべてでNetflow分析の同じ機能を前提としています）。理解できます。 SIEMのコストに加えて、少なくとも制御システムと、さまざまなエクスポーター/センサーからNetflowを収集するために必要なコレクターの数で構成される、ネットワークトラフィックを分析するための個別のソリューションが必要になります。一方、新しいエクスポーター/センサーを使用してネットワークのカバレッジをいくら拡大しても、SIEMおよびそのインフラストラクチャのコストには影響しません。これは、「生の」Netflowストリームではなく、すでに処理されたアラームで機能するためです。これ（信号）は数桁小さくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のオプションは、アナリストとNTA管理者のトレーニング、または追加の輸出業者/センサーのトレーニングに追加料金を支払う必要がないため、価格の観点から最も魅力的に見えます。 NetflowストリームをSIEMなどすべてに転送します。ただし、既存のストレージを拡張する必要がある生のNetflowストリームを保存する必要があるため、SIEMのインフラストラクチャのコストは大幅に増加します。 2番目のオプションは、Netflow分析機能とコストの両方の点で、2つの極端な方法の中間です。いずれの場合も、最初の2つのオプションでは、SIEMの製造元に、課題に基づくソリューションの総所有コストと、現在および予想されるFPSを確認し、その結果、SIEMのライセンスとそのストレージのコストの変化を確認する価値があります。例をとるLogRhythmとそのNetflow分析用サブシステム。その実装には少なくとも3つのオプションがあり、結果として価格設定があります。最新のオプションであるFreemiumは、SIEMにのみアラームを送信できます。帯域幅は1 GB /秒を超えることはできません。ストレージ容量は1 GBのみです（これは、サンプリングなしのNetflowストレージの約1日です）、インデックスストレージ期間は3日以下です。また、追加のデータソースとの相関関係はなく、サポートはオンラインおよびコミュニティを通じてのみ機能します。次のバージョンのNetMonでは、インジケーターが改善されています（すべてのエクスポーターの帯域幅は最大10 GB /秒、ストレージは無制限、インデックスは最大1か月間保存されますが、他のソースとの相関もありません）。また、NetworkXDRのプレミアムバージョンにのみ制限はありませんが、「モスクワの1 kmの道路」、つまり安価ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトの1つでは、1 TBのネットワークテレメトリの1日の容量があり、それを組み込みのNetflowサポートを備えたSIEMに送信すると、ソリューションの総コストは約60万米ドル（コースの次のジャンプ前であっても）でした。同時に、SIEMに適切なルールがなく重複しているため、このデータの一部は未処理のままでした。別のNTAソリューション（この場合は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を使用すると、SIEMに転送されるデータ量が80％削減され、ソリューションのコストは99千米ドルに下がりました。計算はプロジェクトによって異なる場合がありますが、処理する必要のあるNetflowが多いほど、SIEMインフラストラクチャの処理にかかる費用が高くなることに気付きました。何故ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一例を見てみましょう。ユーザーがサーバーに接続すると、情報セキュリティイベントの従来の分析の観点から、サーバーから「削除」した1つのイベントのみを条件付きで処理し、たとえば、syslogを介してSIEMに送信します（実際には、2つのイベントがあります-試行接続とその結果）。このイベントがネットワークコンポーネントに分解されると、生成されるスレッドの数が桁違いに増えることがわかります。たとえば、クライアントからサーバーへの「ホップ」（ホップ）の平均数は、平均的なネットワークでは5〜6です。要求がクライアントからサーバー側に渡される各スイッチまたはルーターは、通過するトラフィックを表すNetflowエントリを生成します。さらに、これはセッションの各方向（要求と応答）に対して個別に行われます。そこには、アプリケーションレベルで1〜2のイベントしか生成されなかった場合、Netflowフローには少なくとも10倍の時間が必要です（1つのネットワークパケットが約20〜30のNetflowフローを生成するため、実際にはさらに多く）。また、これらの数十のスレッドすべてに料金を支払わなければならず（イベントはまだ1つです）、それらのストレージにスペースを割り当てる必要があります。そのため、SIEMはそれらを処理し、重複を削除し、1つのセッション内で多方向フローを結合して、このデータを他のイベントと関連付ける必要があります。したがって、一見明白なソリューションの総コストは、個別のNetflowエクスポーターやSIEMと統合されたスタンドアロンのネットワーク異常分析ソリューションの場合よりも高くなる可能性があります。したがって、1つのネットワークパケットで約20〜30のNetflowストリームが生成されます）。また、これらの数十のスレッドすべてに料金を支払わなければならず（イベントはまだ1つです）、それらのストレージにスペースを割り当てる必要があります。そのため、SIEMはそれらを処理し、重複を削除し、1つのセッション内で多方向フローを結合して、このデータを他のイベントと関連付ける必要があります。したがって、一見明白なソリューションの総コストは、個別のNetflowエクスポーターやSIEMと統合されたスタンドアロンのネットワーク異常分析ソリューションの場合よりも高くなる可能性があります。したがって、1つのネットワークパケットで約20〜30のNetflowストリームが生成されます）。また、これらの数十のスレッドすべてに料金を支払わなければならず（イベントはまだ1つです）、それらのストレージにスペースを割り当てる必要があります。そのため、SIEMはそれらを処理し、重複を削除し、1つのセッション内で多方向フローを結合して、このデータを他のイベントと関連付ける必要があります。したがって、一見明白なソリューションの総コストは、個別のNetflowエクスポーターやSIEMと統合されたスタンドアロンのネットワーク異常分析ソリューションの場合よりも高くなる可能性があります。1つのセッション内で多方向フローを結合し、このデータのみを他のイベントと関連付けます。したがって、一見明白なソリューションの総コストは、個別のNetflowエクスポーターやSIEMと統合されたスタンドアロンのネットワーク異常分析ソリューションの場合よりも高くなる可能性があります。1つのセッション内で多方向フローを結合し、このデータのみを他のイベントと関連付けます。したがって、一見明白なソリューションの総コストは、個別のNetflowエクスポーターやSIEMと統合されたスタンドアロンのネットワーク異常分析ソリューションの場合よりも高くなる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、このような外部Netflowアナライザーは、2つのシナリオのいずれかで使用できます。 1つ目は、最適化されたテレメトリのSIEMへの転送です。多方向ストリームを組み合わせて、繰り返しを排除（重複排除）します。私たちの経験に基づいて（そして</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はこのモードで機能します）、これによりSIEMに送信されるテレメトリの量が6分の1に減少し、このシナリオでは、セキュリティの観点からNetflowを分析できるはずです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dl/kp/ul/dlkpul7r3u12fhxu_-fzcdt5qqs.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のシナリオは、すべての処理がNTAクラスのソリューションで実行され、Netflow処理の結果として受信されたアラームのみがSIEMで受信されることを想定しています。</font><font style="vertical-align: inherit;">このオプションにより、SIEMに送信されるデータがさらに減り、ライセンスとインフラストラクチャのコストが削減されます。</font><font style="vertical-align: inherit;">はい。SIEMは生のNetflowを分析できる必要がなくなり、情報セキュリティイベントを分析するためのツールを選択する可能性が広がります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/su/mb/ubsumbhkpbgb2zqgn9qfwdzmd04.png" alt="画像"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替案はありますか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEMでNetflowを使用してNetflowを使用しない場合よりも多くのセキュリティイベントを検出するためのオプションを検討したので、可能な代替策を見てみましょう。 </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク診断ツール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワーク帯域幅、内部ノードとセグメントの可用性、ピーク負荷などを評価するために使用されるネットワーク診断ツールを試すことができます。</font><font style="vertical-align: inherit;">たとえば、SolarWinds NetFlow Traffic Analyzer。</font><font style="vertical-align: inherit;">これらのソリューションは、ISの異常や脅威を検出するようには設計されていませんが、フロー情報をSIEMに転送して、Netflowを分析できる場合があります。</font><font style="vertical-align: inherit;">上記で説明したように、これによりSIEMがロードされます。これに対応できるかどうかを判断する必要がありますか？</font><font style="vertical-align: inherit;">確かに、ネットワークアナライザーがNetflowデータを外部システムに送信できるかどうかを最初に明確にすることは価値があります。</font><font style="vertical-align: inherit;">場合によっては、要約統計のみを提供したり、アラームを生成したりすることができますが、ISタスクには明らかに不十分です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h8/yk/-s/h8yk-sjxv2lrquymay28nbqd5ui.jpeg" alt="画像"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">侵入検知システムとNGFW</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークIPSとNGFWは別の代替手段です。彼らは内部ネットワークトラフィックをピアリングし、詳細なネットワーク検査メカニズムを介して多くの脅威を検出できますが、境界上にあります。それでも、通常、NGFWとIPSは企業ネットワークとインターネットの境界に配置され、それらを通過するものだけを確認します。これらのデバイス（「鉄」または仮想）を、興味のあるすべての場所にインストールすると、コストがかかりすぎ、場合によっては技術的に不可能になります。境界または境界について言えば、企業のデータセンターとユーザーセグメント間のインターフェイスも境界であることを覚えておく価値があります。また、企業ネットワークと産業ネットワークの接点にもなります。ただし、いずれの場合でも、追加のIPSセンサーまたはNGFWセンサーをインストールすると、財布に痛い打撃を与える可能性があります。一方、Netflowは、既に購入および実装されているネットワーク機器から収集されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークインシデント調査ツール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network Forensics Tool（NFT）クラスのソリューションを使用すると、インシデントを調査するためにネットワークトラフィックを保存、処理、および分析できます。</font><font style="vertical-align: inherit;">ただし、このタイプのソリューションとNTAの間には大きな違いがあります。NFTは、トラフィックの完全なコピー、つまり通常はPCAPファイル、およびNTAがそれに関するレコードを処理します。</font><font style="vertical-align: inherit;">そして、Netflow分析ソリューションがほぼリアルタイムで機能する場合、NFT-大幅な遅延。</font><font style="vertical-align: inherit;">さらに、PCAPで動作する（または別の方法ですべてのネットワークトラフィックのコピーをキャプチャして保存する）ソリューションは、収集されたすべてのデータを保存する場所の問題に遭遇します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 Gb /秒のネットワークデバイスにポートがあるとします。パケット長が64バイトの場合、このポートは1秒あたり1953125パケットを通過でき、長さは1500バイト-83,333パケットです。つまり、パケットの長さに応じて（これはネットワーク上のアプリケーションに依存します）、毎秒約8万から200万のパケットがあり、これを保存する必要があります。一日に、そのようなポートは86400 Gbit / sまたはほぼ11 TBを許可します。ほぼ4 PBが1年間で実行されます。これは1つのポートのみに対応し、そのうちの何千、何万ものネットワークで使用できます。トラフィックを選択的に保存したとしても、私たちの生活を大幅に向上させることはできません。したがって、NFTクラスのソリューションが必要ですが、Netflowアナライザーを置き換えることはできません。これらは、インシデントの監視と調査など、さまざまなタスクを解決するツールです。通常、これらのソリューションはペアで機能します。Netflowではインシデントを特定でき、NFTはすべてのネットワークトラフィックをキャプチャするという形で、それらに関する詳細なデータをすでに収集しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、NFTを備えたSIEMがあります。たとえば、IBM QRadar Incident ForensicsやRSA Security Analyticsを使用すると、ネットワークトラフィックの完全なコピーを操作でき、すべてのNetflowメタデータがSIEMで自動的に利用可能になります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「はい、あります。さらに、このソリューションの利点は、関心のあるすべてのネットワークセッションを再構築して視覚化できることです。これにより、インシデントの調査が容易になります。このようなSIEMを使用すると、攻撃者の代わりに攻撃者が目にするすべてのものを見ることができます。しかし、この尊厳は隠されています上記で述べた深刻な欠点は、ネットワークトラフィックの完全なコピーを保存するには、個別のSIEMまたはそれ以上（生のNetflowを保存するだけでなく、それ以上）のコストがかかる、大規模なストレージを必要とすることです。 ）。スペースを節約するために、保存する特定のセッションを選択する必要がある場合があり、これにより一部のトラフィックが失われる可能性があります。さらに、インシデントに関連するデータを保存するための法的要件に準拠している場合は、あなたはそれらを壊すか、保管のために追加のお金を払わなければならないでしょう。このソリューションのもう1つの機能は、SIEMで既に復号化されているトラフィックを保存する必要があることです。つまり、トラフィックを復号化してSIEMに送信できるように、監視システムのアーキテクチャを確認する必要があります。また、このようなソリューションは、有資格者を必要とする調査の実施に焦点を合わせており、既製のアルゴリズムを使用した異常や脅威の検出に焦点を当てていないことを忘れないでください。それにもかかわらず、そのような決定は、有資格の要員を必要とする調査の実施に焦点を当てており、既製のアルゴリズムを使用して異常や脅威を検出することに焦点を当てていません。それにもかかわらず、そのような決定は、有資格の要員を必要とする調査の実施に焦点を当てており、既製のアルゴリズムを使用して異常や脅威を検出することに焦点を当てていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオでは、Netflowを使用したネットワークトラフィックの初期分析を引き続き確認し、関心のあるイベントとインシデントについてのみ、ネットワークトラフィックの記録を有効にします。</font><font style="vertical-align: inherit;">これにより、「すべて」のストレージにリソースを費やすことなく節約できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単にまとめます。 Netflowは、企業および部門ネットワークのセキュリティを監視するための貴重なデータソースであり、多くの場合、収集して、環境内の脅威の有無について判断できる唯一のデータソースです。原則として、NetflowはNTAクラスソリューションを使用して独立して分析することもできます。NTAクラスソリューションは、悪意のある異常なアクティビティを検出するための大規模なルールとアルゴリズムを持ち、インシデントをすばやく検出して対応できます。 NetflowとSIEMによって収集されたデータを統合すると、さらに多くのことが可能になります。 SIEMは、これまでに見たことのないものを見始め、私たちが危害を受ける可能性があるよりもずっと早く見始めます。同時に、すでにネットワーク機器があるため、既存の監視インフラストラクチャに大きな変更を加える必要はありません。-直接または中間ソリューションを介して、NetflowをSIEMにリダイレクトする必要があるだけです。また、Netflowを有効にすると、小規模ながら迅速な勝利を収めることができます-ほとんどすべてのソリューションパイロット</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、以前はISサービスで確認されなかったISポリシーの特定の違反を検出するという事実で終わります。</font><font style="vertical-align: inherit;">Netflowにより、それらを確認し、SIEMと統合することで、適用されたネットワーク監視ツールとアクティビティシステムから相乗効果を得ることができました。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja501806/index.html">ACS：問題、解決策、セキュリティリスク管理</a></li>
<li><a href="../ja501808/index.html">D 2.092での変更点のリスト。借用借用</a></li>
<li><a href="../ja501810/index.html">古代のラップトップでクールな3Dシューティングゲーム：クラウドゲームプラットフォームGFN.RUのテスト</a></li>
<li><a href="../ja501812/index.html">Python Telegramページネーションボット</a></li>
<li><a href="../ja501814/index.html">COVIDの変更：パンデミック時に変更されて強くなったStartupDriveメンバーのストーリー</a></li>
<li><a href="../ja501822/index.html">第三世代エンジニア</a></li>
<li><a href="../ja501824/index.html">自宅でハッカソンの準備をする</a></li>
<li><a href="../ja501826/index.html">野心的な創設者について、または私がスタートアップのために投資を集めようとした方法について</a></li>
<li><a href="../ja501828/index.html">アンリアルエンジン5がゲームのリアリズムの基準を設定</a></li>
<li><a href="../ja501830/index.html">AngularプロジェクトをESLintに移植し、Prettier、Husky、lint-staged</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>