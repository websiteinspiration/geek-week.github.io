<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“£ ğŸ² ğŸ‘©â€ğŸ”§ UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è„†å¼±æ€§ã‚’æ¢ã™ ğŸ¤¹ ğŸ¤šğŸ¼ ğŸ‘¨ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‰æ›¸ã
 3æœˆã®çµ‚ã‚ã‚Šã«ã€æ¤œè¨¼ã•ã‚Œã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã‚’UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹éš ã‚ŒãŸæ©Ÿèƒ½ã‚’ç™ºè¦‹ã—ãŸã¨å ±å‘Šã—ã¾ã—ãŸã€‚ä»Šæ—¥ã¯ã€ã“ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒã©ã®ã‚ˆã†ã«è¡Œã‚ã‚Œã€ãƒãƒƒã‚«ãƒ¼ãŒè‡ªåˆ†ã®ç›®çš„ã§ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚’è©³ã—ãåˆ†æã—ã¾ã™ã€‚
 
 ã—ã°ã‚‰ãå‰ã«UCãƒ–ãƒ©ã‚¦ã‚¶ãŒå®£ä¼ã•ã‚Œã€éå¸¸ã«ç©æ¥µçš„ã«é…...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è„†å¼±æ€§ã‚’æ¢ã™</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/451936/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-f/na/kn/-fnaknrx70xmfiflvfa6ijw1pys.jpeg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰æ›¸ã</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3æœˆã®çµ‚ã‚ã‚Šã«ã€</font><font style="vertical-align: inherit;">æ¤œè¨¼ã•ã‚Œã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã‚’UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹éš ã‚ŒãŸæ©Ÿèƒ½ã‚’ç™ºè¦‹ã—ãŸ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨å ±å‘Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ã¾ã—ãŸã€‚ä»Šæ—¥ã¯ã€ã“ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒã©ã®ã‚ˆã†ã«è¡Œã‚ã‚Œã€ãƒãƒƒã‚«ãƒ¼ãŒè‡ªåˆ†ã®ç›®çš„ã§ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚’è©³ã—ãåˆ†æã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã°ã‚‰ãå‰ã«UCãƒ–ãƒ©ã‚¦ã‚¶ãŒå®£ä¼ã•ã‚Œã€éå¸¸ã«ç©æ¥µçš„ã«é…å¸ƒã•ã‚Œã¾ã—ãŸï¼šãƒãƒ«ã‚¦ã‚§ã‚¢ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒã‚¤ã‚¹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€ãƒ“ãƒ‡ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã‚’è£…ã£ã¦ã•ã¾ã–ã¾ãªã‚µã‚¤ãƒˆã‹ã‚‰é…å¸ƒã•ã‚Œã¾ã—ãŸï¼ˆã¤ã¾ã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒãƒ«ãƒã‚¯ãƒªãƒƒãƒ—ãªã©ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã¨æ€ã£ãŸãŒã€ä»£ã‚ã‚Šã«ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦APKã‚’å—ã‘å–ã£ãŸãƒ–ãƒ©ã‚¦ã‚¶ï¼‰ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒå¤ãã€è„†å¼±ã§ã‚ã‚Šã€ãã®ã‚ˆã†ãªã‚‚ã®ã§ã‚ã‚‹ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¼´ã†æã‚ã—ã„ãƒãƒŠãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚ VKã®å…¬å¼UCãƒ–ãƒ©ã‚¦ã‚¶ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ†ãƒ¼ãƒãŒã‚ã‚Šã¾ã™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¸å½“ãªåºƒå‘Šã«ã¤ã„ã¦ä¸æº€ã‚’è¨€ã†ã“ã¨ãŒã§ãã‚‹å ´åˆã€å¤šãã®ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚ 2016å¹´ã«ã¯</font><font style="vertical-align: inherit;">ã€ãƒ­ã‚·ã‚¢èª</font><font style="vertical-align: inherit;">ã§ã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‹•ç”»åºƒå‘Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã•ãˆã‚ã‚Šã¾ã—ãŸ</font><font style="vertical-align: inherit;">ï¼ˆãã†ã§ã™ã€åºƒå‘Šã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‹ã‚‰ã®åºƒå‘Šï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ç‚¹ã§ã¯ã€UC Browserã®Google Playã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ•°ã¯5å„„ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯å°è±¡çš„ã§ã™-Google Chromeã ã‘ãŒã‚‚ã£ã¨æŒã£ã¦ã„ã¾ã™ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ä¸­ã«ã¯ã€Google Playã®åºƒå‘Šã‚„ä¸€éƒ¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã«é–¢ã™ã‚‹è‹¦æƒ…ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ã“ã‚ŒãŒèª¿æŸ»ã®ç†ç”±ã§ã—ãŸã€‚UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ãŒä½•ã‹æ‚ªã„ã“ã¨ã‚’ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ãã—ã¦ã€ãã‚Œã¯å½¼ãŒãã‚Œã‚’ã—ã¦ã„ãŸã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸï¼</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚Šã€å®Ÿè¡Œå¯èƒ½ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google Playã§ã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å…¬é–‹ã«é–¢ã™ã‚‹è¦å‰‡ã«åã—ã¾ã™</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ãŒå®Ÿè¡Œå¯èƒ½ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã„ã†äº‹å®Ÿã«åŠ ãˆã¦ã€ãã‚Œã¯å®‰å…¨ã§ã¯ãªããªã‚Šã€MitMæ”»æ’ƒã®å®Ÿè¡Œã«ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ãªæ”»æ’ƒã‚’ä½•ã¨ã‹å®Ÿè¡Œã§ããŸã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¯ã™ã¹ã¦ã€èª¿æŸ»æ™‚ã«Google Playã«å­˜åœ¨ã—ã¦ã„ãŸUCãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«é–¢é€£ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">package: com.UCMobile.intl<font></font>
versionName: 12.10.8.1172<font></font>
versionCode: 10598<font></font>
sha1 APK-: f5edb2243413c777172f6362876041eb0c3a928c</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”»æ’ƒãƒ™ã‚¯ãƒˆãƒ«</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã§ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.uc.deployment.UpgradeDeployService</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">    &lt;service android:exported="false" android:name="com.uc.deployment.UpgradeDeployService" android:process=":deploy" /&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒé–‹å§‹ã™ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯</font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">puds.ucweb.com/upgrade/index.xhtmlã«</font></a></i><font style="vertical-align: inherit;"> POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€é–‹å§‹å¾Œã—ã°ã‚‰ãã—ã¦äº¤é€šé‡ã«æ°—ã¥ãã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œã«å¿œã˜ã¦ã€å½¼ã¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¾ãŸã¯æ–°ã—ã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’å—ã‘å–ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚åˆ†æä¸­ã€ã‚µãƒ¼ãƒãƒ¼ã¯ãã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã‚’æä¾›ã—ã¾ã›ã‚“ã§ã—ãŸãŒã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§PDFã‚’é–‹ã“ã†ã¨ã™ã‚‹ã¨ã€ä¸Šè¨˜ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§2ç•ªç›®ã®è¦æ±‚ã‚’è¡Œã„ã€ãã®å¾Œãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ã“ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ã¾ã—ãŸã€‚APKã«ã¯ãªãã€å¿…è¦ã«å¿œã˜ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦PDFã‚’é–‹ãæ©Ÿèƒ½ã§ã™ã€‚ç†è«–çš„ã«ã¯ã€UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®èµ·å‹•å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹è¦æ±‚ã«å¯¾ã—ã¦æ­£ã—ãå½¢æˆã•ã‚ŒãŸå¿œç­”ã‚’æä¾›ã—ãŸå ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œãªã—ã§ä½•ã‹ã‚’å¼·åˆ¶çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€ã“ã®ãŸã‚ã«ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã¨ã®ã‚„ã‚Šå–ã‚Šã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ã•ã‚‰ã«è©³ã—ãèª¿ã¹ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ãƒˆã•ã‚ŒãŸå›ç­”ã‚’ç·¨é›†ã—ã¦ã€PDFã§ä½œæ¥­ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç½®ãæ›ãˆã‚‹æ–¹ãŒç°¡å˜ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ–ãƒ©ã‚¦ã‚¶ã§ç›´æ¥PDFã‚’é–‹ããŸã„å ´åˆã¯ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã§æ¬¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/i1/c1/j0i1c1n_nwf_gnauzbudnqor5oi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã«ã€</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puds.ucweb.com/upgrade/index.xhtml</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¸ã®POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ</font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã‚ã‚Š</font></a></i><font style="vertical-align: inherit;">ã€ãã®å¾Œã«</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PDFãŠã‚ˆã³</font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Office</font></a></i><font style="vertical-align: inherit;">å½¢å¼ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å«ã‚€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æœ€åˆã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹æƒ…å ±ãŒé€ä¿¡ã•ã‚Œï¼ˆå°‘ãªãã¨ã‚‚å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æä¾›ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰ã€ãã‚Œã«å¿œç­”ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«é–¢ã™ã‚‹ã„ãã¤ã‹ã®æƒ…å ±ã‚’å—ä¿¡ã™ã‚‹ã¨æƒ³å®šã™ã‚‹ã“ã¨ã¯è«–ç†çš„ã§ã™ï¼šã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãã—ã¦ãŠãã‚‰ãä»–ã®ä½•ã‹ã€‚</font><font style="vertical-align: inherit;">å•é¡Œã¯ã€ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¹ãƒ‹ãƒšãƒƒãƒˆ</font></font><br>
<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¿œç­”ã‚¹ãƒ‹ãƒšãƒƒãƒˆ</font></font><br>
<br>
</td>
</tr>
<tr>
<td><img src="https://habrastorage.org/webt/go/tj/tz/gotjtzkpg2owfmk8jrnznox_vdg.jpeg"><br>
<br>
</td>
<td><img src="https://habrastorage.org/webt/g5/7k/iv/g57kivkwrysmcqvptmhclqzzipq.png"><br>
<br>
</td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªä½“ã¯ZIPã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã•ã‚Œã¦ãŠã‚Šã€æš—å·åŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6r/lt/ns/6rltnsrtyd-_5ekwis68qn-vydc.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¤œç´¢ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å¾©å·åŒ–ã‚³ãƒ¼ãƒ‰</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã‚’å¾©å·åŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ç§ãŸã¡ã¯ã€ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.uc.deployment.UpgradeDeployService</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šã‹ã‚‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onStartCommand</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><i><font style="vertical-align: inherit;">æˆ‘ã€…ã¯</font></i><font style="vertical-align: inherit;">ã«è¡Œã</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.uc.deployment.bx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãŠã‚ˆã³ãã‚Œã‹ã‚‰ã®</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.uc.browser.core.dcfe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">e</span><span class="hljs-params">(l arg9)</span> </span>{
        <span class="hljs-keyword">int</span> v4_5;<font></font>
        String v3_1;<font></font>
        <span class="hljs-keyword">byte</span>[] v3;
        <span class="hljs-keyword">byte</span>[] v1 = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">if</span>(arg9 == <span class="hljs-keyword">null</span>) {<font></font>
            v3 = v1;<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> {<font></font>
            v3_1 = arg9.iGX.ipR;<font></font>
            StringBuilder v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]product:"</span>);<font></font>
            v4.append(arg9.iGX.ipR);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]version:"</span>);<font></font>
            v4.append(arg9.iGX.iEn);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]upgrade_type:"</span>);<font></font>
            v4.append(arg9.iGX.mMode);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]force_flag:"</span>);<font></font>
            v4.append(arg9.iGX.iEo);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]silent_mode:"</span>);<font></font>
            v4.append(arg9.iGX.iDQ);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]silent_type:"</span>);<font></font>
            v4.append(arg9.iGX.iEr);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]silent_state:"</span>);<font></font>
            v4.append(arg9.iGX.iEp);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]silent_file:"</span>);<font></font>
            v4.append(arg9.iGX.iEq);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apk_md5:"</span>);<font></font>
            v4.append(arg9.iGX.iEl);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]download_type:"</span>);<font></font>
            v4.append(arg9.mDownloadType);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]download_group:"</span>);<font></font>
            v4.append(arg9.mDownloadGroup);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]download_path:"</span>);<font></font>
            v4.append(arg9.iGH);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apollo_child_version:"</span>);<font></font>
            v4.append(arg9.iGX.iEx);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apollo_series:"</span>);<font></font>
            v4.append(arg9.iGX.iEw);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apollo_cpu_arch:"</span>);<font></font>
            v4.append(arg9.iGX.iEt);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apollo_cpu_vfp3:"</span>);<font></font>
            v4.append(arg9.iGX.iEv);<font></font>
            v4 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v4.append(v3_1);<font></font>
            v4.append(<span class="hljs-string">"]apollo_cpu_vfp:"</span>);<font></font>
            v4.append(arg9.iGX.iEu);<font></font>
            ArrayList v3_2 = arg9.iGX.iEz;<font></font>
            <span class="hljs-keyword">if</span>(v3_2 != <span class="hljs-keyword">null</span> &amp;&amp; v3_2.size() != <span class="hljs-number">0</span>) {<font></font>
                Iterator v3_3 = v3_2.iterator();<font></font>
                <span class="hljs-keyword">while</span>(v3_3.hasNext()) {<font></font>
                    Object v4_1 = v3_3.next();<font></font>
                    StringBuilder v5 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
                    v5.append(((au)v4_1).getName());<font></font>
                    v5.append(<span class="hljs-string">"]component_name:"</span>);<font></font>
                    v5.append(((au)v4_1).getName());<font></font>
                    v5 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
                    v5.append(((au)v4_1).getName());<font></font>
                    v5.append(<span class="hljs-string">"]component_ver_name:"</span>);<font></font>
                    v5.append(((au)v4_1).aDA());<font></font>
                    v5 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
                    v5.append(((au)v4_1).getName());<font></font>
                    v5.append(<span class="hljs-string">"]component_ver_code:"</span>);<font></font>
                    v5.append(((au)v4_1).gBl);<font></font>
                    v5 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
                    v5.append(((au)v4_1).getName());<font></font>
                    v5.append(<span class="hljs-string">"]component_req_type:"</span>);<font></font>
                    v5.append(((au)v4_1).gBq);<font></font>
                }<font></font>
            }<font></font>
 <font></font>
            j v3_4 = <span class="hljs-keyword">new</span> j();<font></font>
            m.b(v3_4);<font></font>
            h v4_2 = <span class="hljs-keyword">new</span> h();<font></font>
            m.b(v4_2);<font></font>
            ay v5_1 = <span class="hljs-keyword">new</span> ay();<font></font>
            v3_4.hS(<span class="hljs-string">""</span>);<font></font>
            v3_4.setImsi(<span class="hljs-string">""</span>);<font></font>
            v3_4.hV(<span class="hljs-string">""</span>);<font></font>
            v5_1.bPQ = v3_4;<font></font>
            v5_1.bPP = v4_2;<font></font>
            v5_1.yr(arg9.iGX.ipR);<font></font>
            v5_1.gBF = arg9.iGX.mMode;<font></font>
            v5_1.gBI = arg9.iGX.iEz;<font></font>
            v3_2 = v5_1.gAr;<font></font>
            c.aBh();<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"os_ver"</span>, c.getRomInfo()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"processor_arch"</span>, com.uc.b.a.a.c.getCpuArch()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cpu_arch"</span>, com.uc.b.a.a.c.Pb()));<font></font>
            String v4_3 = com.uc.b.a.a.c.Pd();<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cpu_vfp"</span>, v4_3));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"net_type"</span>, String.valueOf(com.uc.base.system.a.Jo())));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"fromhost"</span>, arg9.iGX.iEm));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"plugin_ver"</span>, arg9.iGX.iEn));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"target_lang"</span>, arg9.iGX.iEs));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"vitamio_cpu_arch"</span>, arg9.iGX.iEt));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"vitamio_vfp"</span>, arg9.iGX.iEu));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"vitamio_vfp3"</span>, arg9.iGX.iEv));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"plugin_child_ver"</span>, arg9.iGX.iEx));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"ver_series"</span>, arg9.iGX.iEw));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"child_ver"</span>, r.aVw()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cur_ver_md5"</span>, arg9.iGX.iEl));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cur_ver_signature"</span>, SystemHelper.getUCMSignature()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"upgrade_log"</span>, i.bjt()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"silent_install"</span>, String.valueOf(arg9.iGX.iDQ)));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"silent_state"</span>, String.valueOf(arg9.iGX.iEp)));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"silent_file"</span>, arg9.iGX.iEq));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"silent_type"</span>, String.valueOf(arg9.iGX.iEr)));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cpu_archit"</span>, com.uc.b.a.a.c.Pc()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cpu_set"</span>, SystemHelper.getCpuInstruction()));
            <span class="hljs-keyword">boolean</span> v4_4 = v4_3 == <span class="hljs-keyword">null</span> || !v4_3.contains(<span class="hljs-string">"neon"</span>) ? <span class="hljs-keyword">false</span> : <span class="hljs-keyword">true</span>;<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"neon"</span>, String.valueOf(v4_4)));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"cpu_cores"</span>, String.valueOf(com.uc.b.a.a.c.Jl())));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"ram_1"</span>, String.valueOf(com.uc.b.a.a.h.Po())));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"totalram"</span>, String.valueOf(com.uc.b.a.a.h.OL())));<font></font>
            c.aBh();<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"rom_1"</span>, c.getRomInfo()));<font></font>
            v4_5 = e.getScreenWidth();<font></font>
            <span class="hljs-keyword">int</span> v6 = e.getScreenHeight();<font></font>
            StringBuilder v7 = <span class="hljs-keyword">new</span> StringBuilder();<font></font>
            v7.append(v4_5);<font></font>
            v7.append(<span class="hljs-string">"*"</span>);<font></font>
            v7.append(v6);<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"ss"</span>, v7.toString()));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"api_level"</span>, String.valueOf(Build$VERSION.SDK_INT)));<font></font>
            v3_2.add(g.fs(<span class="hljs-string">"uc_apk_list"</span>, SystemHelper.getUCMobileApks()));<font></font>
            Iterator v4_6 = arg9.iGX.iEA.entrySet().iterator();<font></font>
            <span class="hljs-keyword">while</span>(v4_6.hasNext()) {<font></font>
                Object v6_1 = v4_6.next();<font></font>
                v3_2.add(g.fs(((Map$Entry)v6_1).getKey(), ((Map$Entry)v6_1).getValue()));<font></font>
            }<font></font>
 <font></font>
            v3 = v5_1.toByteArray();<font></font>
        }<font></font>
 <font></font>
        <span class="hljs-keyword">if</span>(v3 == <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">this</span>.iGY.iGI.a(arg9, <span class="hljs-string">"up_encode"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"fail"</span>);
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
 <font></font>
        v4_5 = <span class="hljs-keyword">this</span>.iGY.iGw ? <span class="hljs-number">0x1F</span> : <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span>(v3 == <span class="hljs-keyword">null</span>) {<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> {<font></font>
            v3 = g.i(v4_5, v3);<font></font>
            <span class="hljs-keyword">if</span>(v3 == <span class="hljs-keyword">null</span>) {<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> {<font></font>
                v1 = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[v3.length + <span class="hljs-number">16</span>];
                <span class="hljs-keyword">byte</span>[] v6_2 = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">16</span>];<font></font>
                Arrays.fill(v6_2, <span class="hljs-number">0</span>);<font></font>
                v6_2[<span class="hljs-number">0</span>] = <span class="hljs-number">0x5F</span>;<font></font>
                v6_2[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<font></font>
                v6_2[<span class="hljs-number">2</span>] = ((<span class="hljs-keyword">byte</span>)v4_5);<font></font>
                v6_2[<span class="hljs-number">3</span>] = -<span class="hljs-number">50</span>;<font></font>
                System.arraycopy(v6_2, <span class="hljs-number">0</span>, v1, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>);<font></font>
                System.arraycopy(v3, <span class="hljs-number">0</span>, v1, <span class="hljs-number">16</span>, v3.length);<font></font>
            }<font></font>
        }<font></font>
 <font></font>
        <span class="hljs-keyword">if</span>(v1 == <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">this</span>.iGY.iGI.a(arg9, <span class="hljs-string">"up_encrypt"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"fail"</span>);
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
 <font></font>
        <span class="hljs-keyword">if</span>(TextUtils.isEmpty(<span class="hljs-keyword">this</span>.iGY.mUpgradeUrl)) {
            <span class="hljs-keyword">this</span>.iGY.iGI.a(arg9, <span class="hljs-string">"up_url"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"fail"</span>);
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
 <font></font>
        StringBuilder v0 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
        v0.append(arg9.iGX.ipR);<font></font>
        v0.append(<span class="hljs-string">"]url:"</span>);<font></font>
        v0.append(<span class="hljs-keyword">this</span>.iGY.mUpgradeUrl);<font></font>
        com.uc.browser.core.d.c.i v0_1 = <span class="hljs-keyword">this</span>.iGY.iGI;<font></font>
        v3_1 = <span class="hljs-keyword">this</span>.iGY.mUpgradeUrl;<font></font>
        com.uc.base.net.e v0_2 = <span class="hljs-keyword">new</span> com.uc.base.net.e(<span class="hljs-keyword">new</span> com.uc.browser.core.d.c.i$a(v0_1, arg9));<font></font>
        v3_1 = v3_1.contains(<span class="hljs-string">"?"</span>) ? v3_1 + <span class="hljs-string">"&amp;dataver=pb"</span> : v3_1 + <span class="hljs-string">"?dataver=pb"</span>;<font></font>
        n v3_5 = v0_2.uc(v3_1);<font></font>
        m.b(v3_5, <span class="hljs-keyword">false</span>);<font></font>
        v3_5.setMethod(<span class="hljs-string">"POST"</span>);<font></font>
        v3_5.setBodyProvider(v1);<font></font>
        v0_2.b(v3_5);<font></font>
        <span class="hljs-keyword">this</span>.iGY.iGI.a(arg9, <span class="hljs-string">"up_null"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"success"</span>);
        <span class="hljs-keyword">this</span>.iGY.iGI.b(arg9);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å½¢æˆã‚’ç¢ºèªã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">16ãƒã‚¤ãƒˆã®é…åˆ—ã®ä½œæˆã¨ãã®å¡—ã‚Šã¤ã¶ã—ã«æ³¨ç›®ã—ã¾ã™ï¼š0x5Fã€0ã€0x1Fã€-50ï¼ˆ= 0xCEï¼‰ã€‚</font><font style="vertical-align: inherit;">ä¸Šè¨˜ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è¦‹ãŸã‚‚ã®ã¨ä¸€è‡´ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒã˜ã‚¯ãƒ©ã‚¹ã§ã€åˆ¥ã®èˆˆå‘³æ·±ã„ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ãƒã‚¹ãƒˆã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã«æ°—ä»˜ãã“ã¨ãŒã§ãã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="java hljs">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">a</span><span class="hljs-params">(l arg10, <span class="hljs-keyword">byte</span>[] arg11)</span> </span>{<font></font>
            f v0 = <span class="hljs-keyword">this</span>.iGQ;<font></font>
            StringBuilder v1 = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">"["</span>);<font></font>
            v1.append(arg10.iGX.ipR);<font></font>
            v1.append(<span class="hljs-string">"]:UpgradeSuccess"</span>);
            <span class="hljs-keyword">byte</span>[] v1_1 = <span class="hljs-keyword">null</span>;
            <span class="hljs-keyword">if</span>(arg11 == <span class="hljs-keyword">null</span>) {<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arg11.length &lt; <span class="hljs-number">16</span>) {<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span>(arg11[<span class="hljs-number">0</span>] != <span class="hljs-number">0x60</span> &amp;&amp; arg11[<span class="hljs-number">3</span>] != <span class="hljs-number">0xFFFFFFD0</span>) {<font></font>
                    goto label_57;<font></font>
                }<font></font>
                <span class="hljs-keyword">int</span> v3 = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">int</span> v5 = arg11[<span class="hljs-number">1</span>] == <span class="hljs-number">1</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;
                <span class="hljs-keyword">if</span>(arg11[<span class="hljs-number">2</span>] != <span class="hljs-number">1</span> &amp;&amp; arg11[<span class="hljs-number">2</span>] != <span class="hljs-number">11</span>) {
                    <span class="hljs-keyword">if</span>(arg11[<span class="hljs-number">2</span>] == <span class="hljs-number">0x1F</span>) {<font></font>
                    }<font></font>
                    <span class="hljs-keyword">else</span> {<font></font>
                        v3 = <span class="hljs-number">0</span>;<font></font>
                    }<font></font>
                }<font></font>
                <span class="hljs-keyword">byte</span>[] v7 = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[arg11.length - <span class="hljs-number">16</span>];<font></font>
                System.arraycopy(arg11, <span class="hljs-number">16</span>, v7, <span class="hljs-number">0</span>, v7.length);
                <span class="hljs-keyword">if</span>(v3 != <span class="hljs-number">0</span>) {<font></font>
                    v7 = g.j(arg11[<span class="hljs-number">2</span>], v7);<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span>(v7 == <span class="hljs-keyword">null</span>) {<font></font>
                    goto label_57;<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span>(v5 != <span class="hljs-number">0</span>) {<font></font>
                    v1_1 = g.P(v7);<font></font>
                    goto label_57;<font></font>
                }<font></font>
                v1_1 = v7;<font></font>
            }<font></font>
        label_57:<font></font>
            <span class="hljs-keyword">if</span>(v1_1 == <span class="hljs-keyword">null</span>) {<font></font>
                v0.iGY.iGI.a(arg10, <span class="hljs-string">"up_decrypt"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"fail"</span>);
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
            q v11 = g.b(arg10, v1_1);<font></font>
            <span class="hljs-keyword">if</span>(v11 == <span class="hljs-keyword">null</span>) {<font></font>
                v0.iGY.iGI.a(arg10, <span class="hljs-string">"up_decode"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"fail"</span>);
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span>(v0.iGY.iGt) {<font></font>
                v0.d(arg10);<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span>(v0.iGY.iGo != <span class="hljs-keyword">null</span>) {<font></font>
                v0.iGY.iGo.a(<span class="hljs-number">0</span>, ((o)v11));<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span>(v0.iGY.iGs) {<font></font>
                v0.iGY.a(((o)v11));<font></font>
                v0.iGY.iGI.a(v11, <span class="hljs-string">"up_silent"</span>, <span class="hljs-string">"yes"</span>, <span class="hljs-string">"success"</span>);<font></font>
                v0.iGY.iGI.a(v11);<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
            }<font></font>
            v0.iGY.iGI.a(v11, <span class="hljs-string">"up_silent"</span>, <span class="hljs-string">"no"</span>, <span class="hljs-string">"success"</span>);<font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒã‚¤ãƒˆé…åˆ—ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚Šã€ã‚¼ãƒ­ãƒã‚¤ãƒˆãŒ0x60ã¾ãŸã¯3ç•ªç›®ã®ãƒã‚¤ãƒˆãŒ0xD0ã§ã‚ã‚Šã€2ç•ªç›®ã®ãƒã‚¤ãƒˆãŒ1ã€11ã¾ãŸã¯0x1Fã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å›ç­”ã‚’ç¢ºèªã—ã¾ã™ã€‚0ãƒã‚¤ãƒˆ-0x60ã€2ç•ªç›®-0x1Fã€3ç•ªç›®-0x60ã€‚å¿…è¦ãªã‚‚ã®ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚è¡Œï¼ˆã€Œup_decryptã€ãªã©ï¼‰ã‹ã‚‰åˆ¤æ–­ã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã‚’å¾©å·åŒ–ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã“ã“ã§å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><i><font style="vertical-align: inherit;">gj</font></i></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚ã‚ªãƒ•ã‚»ãƒƒãƒˆ2ã®ãƒã‚¤ãƒˆï¼ˆã“ã®ä¾‹ã§ã¯0x1Fï¼‰ãŒæœ€åˆã®å¼•æ•°ã¨ã—ã¦ãã“ã«è»¢é€ã•ã‚Œã€</font><font style="vertical-align: inherit;">
æœ€åˆã®16ãƒã‚¤ãƒˆ</font><font style="vertical-align: inherit;">ãªã—ã®ã‚µãƒ¼ãƒãƒ¼å¿œç­”ãŒ2ç•ªç›®ã®å¼•æ•°ã¨ã—ã¦è»¢é€ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="java hljs">     <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] j(<span class="hljs-keyword">int</span> arg1, <span class="hljs-keyword">byte</span>[] arg2) {
        <span class="hljs-keyword">if</span>(arg1 == <span class="hljs-number">1</span>) {<font></font>
            arg2 = c.c(arg2, c.adu);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arg1 == <span class="hljs-number">11</span>) {<font></font>
            arg2 = m.aF(arg2);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arg1 != <span class="hljs-number">0x1F</span>) {<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> {<font></font>
            arg2 = EncryptHelper.decrypt(arg2);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> arg2;<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜ã‚‰ã‹ã«ã€è§£èª­ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®é¸æŠãŒã‚ã‚Šã€åŒã˜ãƒã‚¤ãƒˆï¼ˆã“ã®</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å ´åˆã¯0x1Fï¼‰ã¯ã€3ã¤ã®å¯èƒ½ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®1ã¤ã‚’ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ã®åˆ†æã‚’ç¶šã‘ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ•°å›ã‚¸ãƒ£ãƒ³ãƒ—ã—ãŸå¾Œã€ãƒˆãƒ¼ã‚­ãƒ³ã‚°åã§ã‚ã‚‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">decodeBytesByKey</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã«</font><i><font style="vertical-align: inherit;">å…¥ã‚Š</font></i><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€ã•ã‚‰ã«2ãƒã‚¤ãƒˆãŒå›ç­”ã‹ã‚‰åˆ†é›¢ã•ã‚Œã€ãã‚Œã‚‰ã‹ã‚‰æ–‡å­—åˆ—ãŒå–å¾—ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚ˆã†ã«ã—ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾©å·åŒ–ã™ã‚‹ãŸã‚ã«ã‚­ãƒ¼ãŒé¸æŠã•ã‚Œã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptBytesByKey(<span class="hljs-keyword">byte</span>[] bytes) {
        <span class="hljs-keyword">byte</span>[] v0 = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">if</span>(bytes != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span>(bytes.length &lt; EncryptHelper.PREFIX_BYTES_SIZE) {<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(bytes.length == EncryptHelper.PREFIX_BYTES_SIZE) {
                    <span class="hljs-keyword">return</span> v0;<font></font>
                }<font></font>
                <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">byte</span>[] prefix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[EncryptHelper.PREFIX_BYTES_SIZE];  <span class="hljs-comment">// 2 </span>
                    System.arraycopy(bytes, <span class="hljs-number">0</span>, prefix, <span class="hljs-number">0</span>, prefix.length);<font></font>
                    String keyId = c.ayR().d(ByteBuffer.wrap(prefix).getShort()); <span class="hljs-comment">//  </span>
                    <span class="hljs-keyword">if</span>(keyId == <span class="hljs-keyword">null</span>) {
                        <span class="hljs-keyword">return</span> v0;<font></font>
                    }<font></font>
                    <span class="hljs-keyword">else</span> {<font></font>
                        a v2 = EncryptHelper.ayL();<font></font>
                        <span class="hljs-keyword">if</span>(v2 == <span class="hljs-keyword">null</span>) {
                            <span class="hljs-keyword">return</span> v0;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">byte</span>[] enrypted = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[bytes.length - EncryptHelper.PREFIX_BYTES_SIZE];<font></font>
                            System.arraycopy(bytes, EncryptHelper.PREFIX_BYTES_SIZE, enrypted, <span class="hljs-number">0</span>, enrypted.length);
                            <span class="hljs-keyword">return</span> v2.l(keyId, enrypted);<font></font>
                        }<font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span>(SecException v7_1) {<font></font>
                EncryptHelper.handleDecryptException(((Throwable)v7_1), v7_1.getErrorCode());<font></font>
                <span class="hljs-keyword">return</span> v0;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span>(Throwable v7) {<font></font>
                EncryptHelper.handleDecryptException(v7, <span class="hljs-number">2</span>);
                <span class="hljs-keyword">return</span> v0;<font></font>
            }<font></font>
        }<font></font>
 <font></font>
        <span class="hljs-keyword">return</span> v0;<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…ˆã‚’è¦‹ã‚Œã°ã€ã“ã®æ®µéšã§ã¯ã‚­ãƒ¼ã¯ã¾ã å–å¾—ã•ã‚Œã¦ãŠã‚‰ãšã€ã€Œè­˜åˆ¥å­ã€ã®ã¿ãŒå–å¾—ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ã‚­ãƒ¼ã®å–å¾—ã¯ã‚‚ã†å°‘ã—è¤‡é›‘ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®æ–¹æ³•ã§ã¯ã€æ—¢å­˜ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«ã•ã‚‰ã«2ã¤ãŒè¿½åŠ ã•ã‚Œã€ãã®ã†ã¡4ã¤ãŒã‚ã‚Šã¾ã™ã€‚ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼16ã€ã‚­ãƒ¼è­˜åˆ¥å­ã€æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã€ãŠã‚ˆã³ç†è§£ã§ããªã„æ–‡å­—åˆ—ï¼ˆã“ã®å ´åˆã¯ç©ºï¼‰ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] l(String keyId, <span class="hljs-keyword">byte</span>[] encrypted) <span class="hljs-keyword">throws</span> SecException {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ayJ().staticBinarySafeDecryptNoB64(<span class="hljs-number">16</span>, keyId, encrypted, <span class="hljs-string">""</span>);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€é€£ã®ç§»è¡Œã®å¾Œã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.alibaba.wireless.security.open.staticdataencrypt.IStaticDataEncryptComponent</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®</font><i><font style="vertical-align: inherit;">staticBinarySafeDecryptNoB64</font></i><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã«</font><i><font style="vertical-align: inherit;">åˆ°é”ã—</font></i><font style="vertical-align: inherit;">ã¾ã™</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¯ã€ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å®Ÿè£…ã™ã‚‹ã‚¯ãƒ©ã‚¹ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lib / armeabi-v7a / libsgmain.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€å®Ÿéš›ã«ã¯.soã§ã¯ãªã.jarã§ã™ã€‚ç§ãŸã¡ã«ã¨ã£ã¦èˆˆå‘³æ·±ã„æ–¹æ³•ã¯ã€æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">package</span> com.alibaba.wireless.security.a.i;<font></font>
 <font></font>
<span class="hljs-comment">// ...</span><font></font>
 <font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IStaticDataEncryptComponent</span> </span>{
    <span class="hljs-keyword">private</span> ISecurityGuardPlugin a;
<span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] a(<span class="hljs-keyword">int</span> mode, <span class="hljs-keyword">int</span> magicInt, <span class="hljs-keyword">int</span> xzInt, String keyId, <span class="hljs-keyword">byte</span>[] encrypted, String magicString) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.a.getRouter().doCommand(<span class="hljs-number">10601</span>, <span class="hljs-keyword">new</span> Object[]{Integer.valueOf(mode), Integer.valueOf(magicInt), Integer.valueOf(xzInt), keyId, encrypted, magicString});<font></font>
    }<font></font>
<span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] b(<span class="hljs-keyword">int</span> magicInt, String keyId, <span class="hljs-keyword">byte</span>[] encrypted, String magicString) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.a(<span class="hljs-number">2</span>, magicInt, <span class="hljs-number">0</span>, keyId, encrypted, magicString);<font></font>
    }<font></font>
<span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] staticBinarySafeDecryptNoB64(<span class="hljs-keyword">int</span> magicInt, String keyId, <span class="hljs-keyword">byte</span>[] encrypted, String magicString) <span class="hljs-keyword">throws</span> SecException {
        <span class="hljs-keyword">if</span>(keyId != <span class="hljs-keyword">null</span> &amp;&amp; keyId.length() &gt; <span class="hljs-number">0</span> &amp;&amp; magicInt &gt;= <span class="hljs-number">0</span> &amp;&amp; magicInt &lt; <span class="hljs-number">19</span> &amp;&amp; encrypted != <span class="hljs-keyword">null</span> &amp;&amp; encrypted.length &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.b(magicInt, keyId, encrypted, magicString);<font></font>
        }<font></font>
 <font></font>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> SecException(<span class="hljs-string">""</span>, <span class="hljs-number">301</span>);<font></font>
    }<font></font>
<span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒªã‚¹ãƒˆã«ã¯ã€ã•ã‚‰ã«2ã¤ã®æ•´æ•°2ã¨0ãŒè¿½åŠ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚Œã¦ã„</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doFinal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ©ã‚¹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">javax.crypto.Cipherã®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆã†ã«ã€ç´„2ã®ãƒ‡ã‚³ãƒ¼ãƒ‰æ‰‹æ®µ</font><font style="vertical-align: inherit;">ã«ã‚ˆã£ã¦</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã‚Œã‚‰ã™ã¹ã¦ãŒç•ªå·10601ã®ç‰¹å®šã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã«è»¢é€ã•ã‚Œã¾ã™-ã“ã‚Œã¯æ˜ã‚‰ã‹ã«ã€ã‚³ãƒãƒ³ãƒ‰ç•ªå·ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®é·ç§»ãƒã‚§ãƒ¼ãƒ³ã®å¾Œã§ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IRouterComponent</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</font><font style="vertical-align: inherit;">ã¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doCommand</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ã‚’å®Ÿè£…ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’è¦‹ã¤ã‘ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">package</span> com.alibaba.wireless.security.mainplugin;<font></font>
<font></font>
<span class="hljs-keyword">import</span> com.alibaba.wireless.security.framework.IRouterComponent;
<span class="hljs-keyword">import</span> com.taobao.wireless.security.adapter.JNICLibrary;<font></font>
 <font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IRouterComponent</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">a</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">super</span>();<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">doCommand</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg2, Object[] arg3)</span> </span>{
        <span class="hljs-keyword">return</span> JNICLibrary.doCommandNative(arg2, arg3);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸ</font><font style="vertical-align: inherit;">ã€</font><i><font style="vertical-align: inherit;">doCommandNative</font></i><font style="vertical-align: inherit;">ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¡ã‚½ãƒƒãƒ‰ãŒ</font><i><font style="vertical-align: inherit;">å®£è¨€ã•</font></i><font style="vertical-align: inherit;">ã‚Œã¦</font><font style="vertical-align: inherit;">ã„ã‚‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JNICLibrary</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹</font><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">package</span> com.taobao.wireless.security.adapter;<font></font>
 <font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JNICLibrary</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> Object <span class="hljs-title">doCommandNative</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg0, Object[] arg1)</span></span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰ã§</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doCommandNative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€æ¥½ã—ã¿ãŒå§‹ã¾ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚·ãƒ³ã‚³ãƒ¼ãƒ‰ã®é›£èª­åŒ–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ•ã‚¡ã‚¤ãƒ«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libsgmain.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆã“ã‚Œã¯å®Ÿéš›ã«ã¯.jarã§ã‚ã‚Šã€æš—å·åŒ–ã«é–¢é€£ã™ã‚‹ã„ãã¤ã‹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…ã®ã™ãä¸Šã«ã‚ã‚Šã¾ã™ï¼‰ã¯ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libsgmainso-6.4.36.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ã€‚ IDAã§ãã‚Œã‚’é–‹ãã€ã‚¨ãƒ©ãƒ¼ã®ã‚ã‚‹ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒœãƒƒã‚¯ã‚¹ã®æŸã‚’å–å¾—ã—ã¾ã™ã€‚å•é¡Œã¯ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ãŒç„¡åŠ¹ã§ã‚ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯ã€ç‰¹ã«åˆ†æã‚’è¤‡é›‘ã«ã™ã‚‹ãŸã‚ã«è¡Œã‚ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_k/bz/5c/_kbz5cbedw6g1jnsj047rtqudli.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ãã‚Œã‚‚å¿…è¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ELFãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ããƒ­ãƒ¼ãƒ‰ã—ã¦åˆ†æã™ã‚‹ã«ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ååˆ†ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã®å¯¾å¿œã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2y/xh/vk/2yxhvksp30f016gfyhrlfh0pklc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDAã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åº¦é–‹ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Javaä»®æƒ³ãƒã‚·ãƒ³ã«ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã©ã“ã«ãƒã‚¤ãƒ†ã‚£ãƒ–ã¨ã—ã¦Javaã‚³ãƒ¼ãƒ‰ã§å®£è¨€ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ãŒã‚ã‚‹ã‹ã‚’æ­£ç¢ºã«ä¼ãˆã‚‹ã«ã¯ã€2ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ 1ã¤ã¯ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java_package_name_ClassName_Method_name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã„ã†å½¢å¼ã®åå‰ã‚’ä»˜ã‘ã‚‹ã“ã¨</font><i><font style="vertical-align: inherit;">ã§ã™</font></i><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ã¤ç›®ã¯</font><font style="vertical-align: inherit;">
ã€</font><i><font style="vertical-align: inherit;">RegisterNatives</font></i><font style="vertical-align: inherit;">é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦</font><font style="vertical-align: inherit;">ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ãã«ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JNI_OnLoad</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°ã§</font><font style="vertical-align: inherit;">ï¼‰</font><i><font style="vertical-align: inherit;">ç™»éŒ²</font></i></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã‚‹ã“ã¨</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">
ã“ã®ä¾‹ã§ã¯ã€æœ€åˆã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€åå‰ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</font><i><font style="vertical-align: inherit;">Java_com_taobao_wireless_security_adapter_JNICLibrary_doCommandNative</font></i><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">
ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚ŒãŸé–¢æ•°ã«ã¯ãã®ã‚ˆã†ãªã‚‚ã®ã¯ãªã„ãŸã‚ã€</font><i><font style="vertical-align: inherit;">RegisterNativesã®</font></i><font style="vertical-align: inherit;">å‘¼ã³å‡ºã—ã‚’æ¢ã™å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><i><font style="vertical-align: inherit;">JNI_OnLoad</font></i><font style="vertical-align: inherit;"> 
é–¢æ•°ã«ç§»å‹•ã—ã¦</font><font style="vertical-align: inherit;">ã€æ¬¡ã®å›³ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/m6/dp/iw/m6dpiwaonfuyri-jg8thppcfgqe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½•ãŒèµ·ãã¦ã‚‹ï¼Ÿä¸€è¦‹ã™ã‚‹ã¨ã€é–¢æ•°ã®æœ€åˆã¨æœ€å¾Œã¯ARMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å…¸å‹ã§ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã®æœ€åˆã®å‘½ä»¤ã¯ã€é–¢æ•°ãŒãã®ä½œæ¥­ã§ä½¿ç”¨ã™ã‚‹ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ¼ã®å†…å®¹ï¼ˆã“ã®å ´åˆã¯R0ã€R1ã€ãŠã‚ˆã³R2ï¼‰ã¨ã€é–¢æ•°ã‹ã‚‰ã®æˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å«ã‚€ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ¼LRã®å†…å®¹ã‚’æ ¼ç´ã—ã¾ã™ã€‚æœ€å¾Œã®å‘½ä»¤ã§ã€ä¿å­˜ã•ã‚ŒãŸãƒ¬ã‚¸ã‚¹ã‚¿ãŒå¾©å…ƒã•ã‚Œã€æˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã™ãã«PCãƒ¬ã‚¸ã‚¹ã‚¿ã«é…ç½®ã•ã‚Œã¾ã™-ã—ãŸãŒã£ã¦ã€é–¢æ•°ã‹ã‚‰æˆ»ã‚Šã¾ã™ã€‚ã—ã‹ã—ã‚ˆãè¦‹ã‚‹ã¨ã€æœ€å¾Œã‹ã‚‰2ç•ªç›®ã®å‘½ä»¤ãŒã‚¹ã‚¿ãƒƒã‚¯ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹æˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›´ã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ä»˜ãã§ã—ã‚‡ã†ã€‚ãã‚ŒãŒä½•ã«ãªã‚‹ã‹ã‚’è¨ˆç®—ã—ã¾ã™</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã€‚ç‰¹å®šã®ã‚¢ãƒ‰ãƒ¬ã‚¹0xB130ãŒR1ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€ãã“ã‹ã‚‰5ãŒæ¸›ç®—ã•ã‚Œã¦ã‹ã‚‰ã€R0ã«è»¢é€ã•ã‚Œã€ãã‚Œã«0x10ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚ãã‚Œã¯0xB13Bã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€IDAã¯æœ€å¾Œã®å‘½ä»¤ã§é–¢æ•°ã‹ã‚‰ã®é€šå¸¸ã®æˆ»ã‚ŠãŒã‚ã‚‹ã¨è€ƒãˆã¾ã™ãŒã€å®Ÿéš›ã«ã¯è¨ˆç®—ã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹0xB13Bã¸ã®é·ç§»ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ARMãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã¯ã€ARMã¨Thumbã®2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ã¨2ã¤ã®å‘½ä»¤ã‚»ãƒƒãƒˆãŒã‚ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ€ä¸‹ä½ãƒ“ãƒƒãƒˆã¯ã€ã©ã®å‘½ä»¤ã‚»ãƒƒãƒˆãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ãƒ—ãƒ­ã‚»ãƒƒã‚µã«ä¼ãˆã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å®Ÿéš›ã«ã¯0xB13Aã§ã‚ã‚Šã€ä¸‹ä½ãƒ“ãƒƒãƒˆã®å˜ä½ã¯Thumbãƒ¢ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å„é–¢æ•°ã®å…ˆé ­ã«ã¯ã€åŒæ§˜ã®ã€Œã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã€ã¨</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¸ãƒ£ãƒ³ã‚¯ã‚³ãƒ¼ãƒ‰ãŒ</font><font style="vertical-align: inherit;">è¿½åŠ ã•ã‚Œ</font><font style="vertical-align: inherit;">ã¦ã„</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚ã•ã‚‰ã«ã€ãã‚Œã‚‰ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã‚‹ã“ã¨ã¯ã—ã¾ã›ã‚“ã€‚ã»ã¼ã™ã¹ã¦ã®æ©Ÿèƒ½ã®æœ¬å½“ã®å§‹ã¾ã‚Šã¯ã‚‚ã†å°‘ã—å…ˆã§ã‚ã‚‹ã“ã¨</font><font style="vertical-align: inherit;">ã‚’è¦šãˆ</font><font style="vertical-align: inherit;">ã¦ã„ã‚‹</font><font style="vertical-align: inherit;">ã ã‘</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ã«ã¯0xB13Aã¸ã®æ˜ç¤ºçš„ãªé·ç§»ãŒãªã„ãŸã‚ã€IDAè‡ªä½“ã¯ã‚³ãƒ¼ãƒ‰ãŒã“ã®å ´æ‰€ã«ã‚ã‚‹ã“ã¨ã‚’èªè­˜ã—ã¾ã›ã‚“ã§ã—ãŸã€‚åŒã˜ç†ç”±ã§ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå†…ã®ã»ã¨ã‚“ã©ã®ã‚³ãƒ¼ãƒ‰ãŒã‚³ãƒ¼ãƒ‰ã¨ã—ã¦èªè­˜ã•ã‚Œãªã„ãŸã‚ã€åˆ†æãŒå¤šå°‘é›£ã—ããªã‚Šã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ãŒã“ã“ã«ã‚ã‚‹ã“ã¨ã‚’IDAã«ä¼ãˆã¾ã™ã€‚ã“ã‚Œã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/wp/p3/eqwpp3exmqnybi7r_tdvvan4jls.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã¯æ˜ã‚‰ã‹ã«0xB144ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚ãã—ã¦ã€sub_494Cã¯ã©ã†ã§ã™ã‹ï¼Ÿ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/9b/rn/bo9brnkfvauy3ntm2dnucnsxqhs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®é–¢æ•°ãŒLRãƒ¬ã‚¸ã‚¹ã‚¿ã§å‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€ä¸Šè¨˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ0xB144ï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚ R0ã§ã¯ã€ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€‚ã¤ã¾ã‚Šã€å€¤ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å–å¾—ã•ã‚Œã€LRã«è¿½åŠ ã•ã‚Œã€ç§»å‹•</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…ˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ</font><font style="vertical-align: inherit;">å–å¾—ã•ã‚Œ</font><font style="vertical-align: inherit;">ã¾ã™ã€‚ãã‚Œã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š0xB144 + [0xB144 + 8 * 4] = 0xB144 + 0x120 = 0xB264ã€‚å—ã‘å–ã£ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã«ç§»å‹•ã™ã‚‹ã¨ã€ã„ãã¤ã‹ã®æœ‰ç”¨ãªæŒ‡ç¤ºã¨0xB140 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/95/4x/nz954xqtjmky6tnpaqeejhvecus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¸ã®é·ç§»ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0x20ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã«ã‚ˆã‚‹é·ç§»ãŒç™ºç”Ÿã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚µã‚¤ã‚ºã‹ã‚‰åˆ¤æ–­ã™ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã«ã¯ãã®ã‚ˆã†ãªé·ç§»ãŒå¤šæ•°ã‚ã‚Šã¾ã™ã€‚æ‰‹å‹•ã§ä½æ‰€ã‚’è¨ˆç®—ã—ãªãã¦ã‚‚ã€ã“ã‚Œã‚’ã‚ˆã‚Šè‡ªå‹•çš„ã«å‡¦ç†ã§ãã‚‹ã‹ã©ã†ã‹ã¨ã„ã†ç–‘å•ãŒç”Ÿã˜ã¾ã™ã€‚ãã—ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨IDAã®ã‚³ãƒ¼ãƒ‰ã«ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹æ©Ÿèƒ½ãŒå½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put_unconditional_branch</span>(<span class="hljs-params">source, destination</span>):</span>
    offset = (destination - source - <span class="hljs-number">4</span>) &gt;&gt; <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span> offset &gt; <span class="hljs-number">2097151</span> <span class="hljs-keyword">or</span> offset &lt; <span class="hljs-number">-2097152</span>:
        <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">"Invalid offset"</span>)
    <span class="hljs-keyword">if</span> offset &gt; <span class="hljs-number">1023</span> <span class="hljs-keyword">or</span> offset &lt; <span class="hljs-number">-1024</span>:<font></font>
        instruction1 = <span class="hljs-number">0xf000</span> | ((offset &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        instruction2 = <span class="hljs-number">0xb800</span> | (offset &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        patch_word(source, instruction1)<font></font>
        patch_word(source + <span class="hljs-number">2</span>, instruction2)
    <span class="hljs-keyword">else</span>:<font></font>
        instruction = <span class="hljs-number">0xe000</span> | (offset &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        patch_word(source, instruction)<font></font>
 <font></font>
 <font></font>
ea = here()<font></font>
<span class="hljs-keyword">if</span> get_wide_word(ea) == <span class="hljs-number">0xb503</span>: <span class="hljs-comment">#PUSH {R0,R1,LR}</span>
    ea1 = ea + <span class="hljs-number">2</span>
    <span class="hljs-keyword">if</span> get_wide_word(ea1) == <span class="hljs-number">0xbf00</span>: <span class="hljs-comment">#NOP</span>
        ea1 += <span class="hljs-number">2</span>
    <span class="hljs-keyword">if</span> get_operand_type(ea1, <span class="hljs-number">0</span>) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> get_operand_value(ea1, <span class="hljs-number">0</span>) == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> get_operand_type(ea1, <span class="hljs-number">1</span>) == <span class="hljs-number">2</span>:<font></font>
        index = get_wide_dword(get_operand_value(ea1, <span class="hljs-number">1</span>))
        <span class="hljs-keyword">print</span> <span class="hljs-string">"index ="</span>, hex(index)<font></font>
        ea1 += <span class="hljs-number">2</span>
        <span class="hljs-keyword">if</span> get_operand_type(ea1, <span class="hljs-number">0</span>) == <span class="hljs-number">7</span>:<font></font>
            table = get_operand_value(ea1, <span class="hljs-number">0</span>) + <span class="hljs-number">4</span>
        <span class="hljs-keyword">elif</span> get_operand_type(ea1, <span class="hljs-number">1</span>) == <span class="hljs-number">2</span>:<font></font>
            table = get_operand_value(ea1, <span class="hljs-number">1</span>) + <span class="hljs-number">4</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">print</span> <span class="hljs-string">"Wrong operand type on"</span>, hex(ea1), <span class="hljs-string">"-"</span>, get_operand_type(ea1, <span class="hljs-number">0</span>), get_operand_type(ea1, <span class="hljs-number">1</span>)<font></font>
            table = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> table <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">print</span> <span class="hljs-string">"Unable to find table"</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">print</span> <span class="hljs-string">"table ="</span>, hex(table)<font></font>
            offset = get_wide_dword(table + (index &lt;&lt; <span class="hljs-number">2</span>))<font></font>
            put_unconditional_branch(ea, table + offset)<font></font>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">print</span> <span class="hljs-string">"Unknown code"</span>, get_operand_type(ea1, <span class="hljs-number">0</span>), get_operand_value(ea1, <span class="hljs-number">0</span>), get_operand_type(ea1, <span class="hljs-number">1</span>) == <span class="hljs-number">2</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Unable to detect first instruction"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚«ãƒ¼ã‚½ãƒ«ã‚’è¡Œ0xB26Aã«ç½®ãã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦0xB4B0ã¸ã®é·ç§»ã‚’ç¢ºèªã—ã¾ã™ã€‚IDA </font></font><br>
<br>
<img src="https://habrastorage.org/webt/52/rf/fx/52rffxhzmtrfdhfrznsr8dovfim.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¯ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦èªè­˜ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ç§ãŸã¡ã¯å½¼å¥³ã‚’åŠ©ã‘ã¦ã€ãã“ã§åˆ¥ã®æ§‹é€ ã‚’è¦‹ã¾ã™ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/d9/kv/ctd9kvewm9l1blmw3pqipi8mnqm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLXã®å¾Œã®æŒ‡ç¤ºã¯ã‚ã¾ã‚Šæ„å‘³ãŒã‚ã‚Šã¾ã›ã‚“ã€ãã‚Œã¯ã‚ã‚‹ç¨®ã®ãƒã‚¤ã‚¢ã‚¹ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚ sub_4964ã‚’èª¿ã¹ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o7/wi/4-/o7wi4-imrothkr6qpkbrklj40aw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿéš›ã«ã¯ã€ã“ã“ã§LRã«ã‚ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã§dwordãŒå–å¾—ã•ã‚Œã€ã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚ãã®å¾Œã€å—ä¿¡ã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã®å€¤ãŒå–å¾—ã•ã‚Œã€ã‚¹ã‚¿ãƒƒã‚¯ã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€LRã«4ãŒè¿½åŠ ã•ã‚Œã‚‹ãŸã‚ã€é–¢æ•°ã‹ã‚‰æˆ»ã£ãŸå¾Œã€ã“ã®åŒã˜ã‚ªãƒ•ã‚»ãƒƒãƒˆã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã¾ã™ã€‚æ¬¡ã«ã€POP {R1}ã‚³ãƒãƒ³ãƒ‰ã¯å—ä¿¡ã—ãŸå€¤ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰å–å¾—ã—ã¾ã™ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹0xB4BA + 0xEA = 0xB5A4ã‚’è¦‹ã‚‹ã¨ã€ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¼¼ãŸã‚‚ã®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ev/hb/a8/evhba8ty8dtnv8niuxyfue0nkfk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹ã«ã¯ã€ã‚³ãƒ¼ãƒ‰ã‹ã‚‰2ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚ªãƒ•ã‚»ãƒƒãƒˆã¨ã€çµæœã‚’å…¥ã‚ŒãŸã„ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ¼ç•ªå·ã§ã™ã€‚</font><font style="vertical-align: inherit;">å¯èƒ½ãªãƒ¬ã‚¸ã‚¹ã‚¿ã”ã¨ã«ã€äº‹å‰ã«ã‚³ãƒ¼ãƒ‰ã‚’æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs">patches = {}<font></font>
patches[<span class="hljs-number">0</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">1</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">2</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">3</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">4</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">5</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">8</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">9</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">10</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xe0</span>)<font></font>
patches[<span class="hljs-number">11</span>] = (<span class="hljs-number">0x00</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xe0</span>)<font></font>
 <font></font>
ea = here()<font></font>
<span class="hljs-keyword">if</span> (get_wide_word(ea) == <span class="hljs-number">0xb082</span> <span class="hljs-comment">#SUB SP, SP, #8</span>
        <span class="hljs-keyword">and</span> get_wide_word(ea + <span class="hljs-number">2</span>) == <span class="hljs-number">0xb503</span>): <span class="hljs-comment">#PUSH {R0,R1,LR}</span>
    <span class="hljs-keyword">if</span> get_operand_type(ea + <span class="hljs-number">4</span>, <span class="hljs-number">0</span>) == <span class="hljs-number">7</span>:<font></font>
        pop = get_bytes(ea + <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">if</span> pop[<span class="hljs-number">1</span>] == <span class="hljs-string">'\xbc'</span>:<font></font>
            register = <span class="hljs-number">-1</span>
            r = get_wide_byte(ea + <span class="hljs-number">12</span>)
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>):
                <span class="hljs-keyword">if</span> r == (<span class="hljs-number">1</span> &lt;&lt; i):<font></font>
                    register = i<font></font>
                    <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> register == <span class="hljs-number">-1</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">"Unable to detect register"</span>
            <span class="hljs-keyword">else</span>:<font></font>
                address = get_wide_dword(ea + <span class="hljs-number">8</span>) + ea + <span class="hljs-number">8</span>
                <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> patches[register]:<font></font>
                    patch_byte(ea, b)<font></font>
                    ea += <span class="hljs-number">1</span>
                <span class="hljs-keyword">if</span> ea % <span class="hljs-number">4</span> != <span class="hljs-number">0</span>:<font></font>
                    ea += <span class="hljs-number">2</span><font></font>
                patch_dword(ea, address)<font></font>
        <span class="hljs-keyword">elif</span> pop[:<span class="hljs-number">3</span>] == <span class="hljs-string">'\x5d\xf8\x04'</span>:<font></font>
            register = ord(pop[<span class="hljs-number">3</span>]) &gt;&gt; <span class="hljs-number">4</span>
            <span class="hljs-keyword">if</span> register <span class="hljs-keyword">in</span> patches:<font></font>
                address = get_wide_dword(ea + <span class="hljs-number">8</span>) + ea + <span class="hljs-number">8</span>
                <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> patches[register]:<font></font>
                    patch_byte(ea, b)<font></font>
                    ea += <span class="hljs-number">1</span><font></font>
                patch_dword(ea, address)<font></font>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">print</span> <span class="hljs-string">"POP instruction not found"</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">print</span> <span class="hljs-string">"Wrong operand type on +4:"</span>, get_operand_type(ea + <span class="hljs-number">4</span>, <span class="hljs-number">0</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Unable to detect first instructions"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç½®æ›ã—ãŸã„æ§‹æˆè¦ç´ -0xB4B2-ã®å…ˆé ­ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç½®ãã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lv/mp/oo/lvmpoow5agndjnbbl-t3imyaisq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰è¿°ã®æ§‹æˆã«åŠ ãˆã¦</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/nn/rw/dknnrwaye18zzz0xipny0_gdqfq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€æ¬¡</font><font style="vertical-align: inherit;">ã®ã‚³ãƒ¼ãƒ‰ã‚‚ã‚³ãƒ¼ãƒ‰ã«</font><font style="vertical-align: inherit;">è¡¨ç¤ºã•</font><font style="vertical-align: inherit;">ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">å‰ã®ã‚±ãƒ¼ã‚¹ã¨åŒæ§˜ã«ã€BLXå‘½ä»¤ã®å¾Œã«</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/bw/uz/fnbwuzpo3qw1hp3vd9rvr2xfq1k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ªãƒ•ã‚»ãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚LRã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’</font><font style="vertical-align: inherit;">å–å¾—</font><font style="vertical-align: inherit;">ã—ã€LRã«è¿½åŠ ã—ã¾ã™ã€‚ãã—ã¦ãã“ã«è¡Œãã¾ã™ã€‚</font><font style="vertical-align: inherit;">0x72044 + 0xC = 0x72050ã€‚</font><font style="vertical-align: inherit;">ã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯éå¸¸ã«ç°¡å˜ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put_unconditional_branch</span>(<span class="hljs-params">source, destination</span>):</span>
    offset = (destination - source - <span class="hljs-number">4</span>) &gt;&gt; <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span> offset &gt; <span class="hljs-number">2097151</span> <span class="hljs-keyword">or</span> offset &lt; <span class="hljs-number">-2097152</span>:
        <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">"Invalid offset"</span>)
    <span class="hljs-keyword">if</span> offset &gt; <span class="hljs-number">1023</span> <span class="hljs-keyword">or</span> offset &lt; <span class="hljs-number">-1024</span>:<font></font>
        instruction1 = <span class="hljs-number">0xf000</span> | ((offset &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        instruction2 = <span class="hljs-number">0xb800</span> | (offset &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        patch_word(source, instruction1)<font></font>
        patch_word(source + <span class="hljs-number">2</span>, instruction2)
    <span class="hljs-keyword">else</span>:<font></font>
        instruction = <span class="hljs-number">0xe000</span> | (offset &amp; <span class="hljs-number">0x7ff</span>)<font></font>
        patch_word(source, instruction)<font></font>
 <font></font>
 <font></font>
ea = here()<font></font>
<span class="hljs-keyword">if</span> get_wide_word(ea) == <span class="hljs-number">0xb503</span>: <span class="hljs-comment">#PUSH {R0,R1,LR}</span>
    ea1 = ea + <span class="hljs-number">6</span>
    <span class="hljs-keyword">if</span> get_wide_word(ea + <span class="hljs-number">2</span>) == <span class="hljs-number">0xbf00</span>: <span class="hljs-comment">#NOP</span>
        ea1 += <span class="hljs-number">2</span><font></font>
    offset = get_wide_dword(ea1)<font></font>
    put_unconditional_branch(ea, (ea1 + offset) &amp; <span class="hljs-number">0xffffffff</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Unable to detect first instruction"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®çµæœï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/fq/yo/tmfqyogtdhbje0atjckosbrgide.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°ã®ã™ã¹ã¦ã«ãƒ‘ãƒƒãƒãŒé©ç”¨ã•ã‚ŒãŸå¾Œã€IDAã‚’å®Ÿéš›ã®å§‹ã¾ã‚Šã«å‘ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®é–¢æ•°ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ©ãƒãƒ©ã«åé›†ã—ã€HexRaysã‚’ä½¿ç”¨ã—ã¦é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡å­—åˆ—ã®ãƒ‡ã‚³ãƒ¼ãƒ‰</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‹ã‚‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libsgmainso-6.4.36.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ã®ãƒã‚·ãƒ³ã‚³ãƒ¼ãƒ‰ã§é›£èª­åŒ–ã‚’å‡¦ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³</font><font style="vertical-align: inherit;">ã€é–¢æ•°ã‚³ãƒ¼ãƒ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JNI_OnLoadã‚’å–å¾—ã—ã¾ã—ãŸ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">real_JNI_OnLoad</span><span class="hljs-params">(JavaVM *vm)</span>
</span>{
  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// r0</span>
  jclass clazz; <span class="hljs-comment">// r0 MAPDST</span>
  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// r0</span>
  JNIEnv *env; <span class="hljs-comment">// r4</span>
  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [sp-40h] [bp-5Ch]</span>
  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [sp+Ch] [bp-10h]</span><font></font>
  v7 = *(_DWORD *)off_8AC00;<font></font>
  <span class="hljs-keyword">if</span> ( !vm )
    <span class="hljs-keyword">goto</span> LABEL_39;<font></font>
  sub_7C4F4();<font></font>
  env = (JNIEnv *)sub_7C5B0(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> ( !env )
    <span class="hljs-keyword">goto</span> LABEL_39;<font></font>
  v4 = sub_72CCC();<font></font>
  sub_73634(v4);<font></font>
  sub_73E24(&amp;unk_83EA6, &amp;v6, <span class="hljs-number">49</span>);<font></font>
  clazz = (jclass)((<span class="hljs-keyword">int</span> (__fastcall *)(JNIEnv *, <span class="hljs-keyword">int</span> *))(*env)-&gt;FindClass)(env, &amp;v6);
  <span class="hljs-keyword">if</span> ( clazz<font></font>
    &amp;&amp; (sub_9EE4(),<font></font>
        sub_71D68(env),<font></font>
        sub_E7DC(env) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_69D68(env) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_197B4(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_E240(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_B8B0(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_5F0F4(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_70640(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_11F3C(env) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_21C3C(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_2148C(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_210E0(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_41B58(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_27920(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_293E8(env, clazz) &gt;= <span class="hljs-number">0</span>
     &amp;&amp; sub_208F4(env, clazz) &gt;= <span class="hljs-number">0</span>) )<font></font>
  {<font></font>
    result = (sub_B7B0(env, clazz) &gt;&gt; <span class="hljs-number">31</span>) | <span class="hljs-number">0x10004</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
LABEL_39:<font></font>
    result = <span class="hljs-number">-1</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> result;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®è¡Œã‚’æ³¨æ„æ·±ãæ¤œè¨ã—ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  sub_73E24(&amp;unk_83EA6, &amp;v6, <span class="hljs-number">49</span>);<font></font>
  clazz = (jclass)((<span class="hljs-keyword">int</span> (__fastcall *)(JNIEnv *, <span class="hljs-keyword">int</span> *))(*env)-&gt;FindClass)(env, &amp;v6);</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_73E24</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é–¢æ•°</font><font style="vertical-align: inherit;">ã¯ã€ã‚¯ãƒ©ã‚¹åã‚’æ˜ç¤ºçš„ã«å¾©å·åŒ–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ã€æš—å·åŒ–ã«ä¼¼ãŸãƒ‡ãƒ¼ã‚¿ã¸ã®ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã€ãƒãƒƒãƒ•ã‚¡ãƒ¼ã€æ•°å€¤ãŒæ¸¡ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ˜ã‚‰ã‹ã«ã€é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚ŒãŸå¾Œã€ãƒãƒƒãƒ•ã‚¡ã«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾©å·åŒ–ã•ã‚ŒãŸè¡ŒãŒ</font><i><font style="vertical-align: inherit;">å«ã¾</font></i><font style="vertical-align: inherit;">ã‚Œ</font><font style="vertical-align: inherit;">ã¾ã™ã€‚ã“ã‚Œã¯ã€</font><i><font style="vertical-align: inherit;">FindClass</font></i><font style="vertical-align: inherit;">é–¢æ•°ã«æ¸¡ã•ã‚Œã‚‹</font><i><font style="vertical-align: inherit;">ãŸã‚</font></i><font style="vertical-align: inherit;">ã§ã™ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã¯ã€ã‚¯ãƒ©ã‚¹åã‚’2ç•ªç›®ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å—ã‘å–ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€æ•°å€¤ã¯ãƒãƒƒãƒ•ã‚¡ã®ã‚µã‚¤ã‚ºã¾ãŸã¯æ–‡å­—åˆ—ã®é•·ã•ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã®åå‰ã‚’è§£èª­ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚æ­£ã—ã„æ–¹å‘ã«é€²ã‚“ã§ã„ã‚‹ã‹ã©ã†ã‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font><i><font style="vertical-align: inherit;">sub_73E24</font></i><font style="vertical-align: inherit;">ã§ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’</font><i><font style="vertical-align: inherit;">è©³ã—ãè¦‹ã¦ã¿</font></i><font style="vertical-align: inherit;">ã¾ã—ã‚‡ã†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">sub_73E56</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> __int8 *in, <span class="hljs-keyword">unsigned</span> __int8 *out, <span class="hljs-keyword">size_t</span> size)</span>
</span>{
  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// r6</span>
  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// r11</span>
  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// r9</span>
  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// r4</span>
  <span class="hljs-keyword">size_t</span> v10; <span class="hljs-comment">// r5</span>
  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// r0</span>
  struc_1 v13; <span class="hljs-comment">// [sp+0h] [bp-30h]</span>
  <span class="hljs-keyword">int</span> v14; <span class="hljs-comment">// [sp+1Ch] [bp-14h]</span>
  <span class="hljs-keyword">int</span> v15; <span class="hljs-comment">// [sp+20h] [bp-10h]</span>
  v4 = <span class="hljs-number">0</span>;<font></font>
  v15 = *(_DWORD *)off_8AC00;<font></font>
  v14 = <span class="hljs-number">0</span>;<font></font>
  v7 = sub_7AF78(<span class="hljs-number">17</span>);<font></font>
  v8 = sub_7AF78(size);<font></font>
  <span class="hljs-keyword">if</span> ( !v7 )<font></font>
  {<font></font>
    v9 = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">goto</span> LABEL_12;<font></font>
  }<font></font>
  (*(<span class="hljs-keyword">void</span> (__fastcall **)(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *, <span class="hljs-keyword">int</span>))(v7 + <span class="hljs-number">12</span>))(v7, <span class="hljs-string">"DcO/lcK+h?m3c*q@"</span>, <span class="hljs-number">16</span>);
  <span class="hljs-keyword">if</span> ( !v8 )<font></font>
  {<font></font>
LABEL_9:<font></font>
    v4 = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">goto</span> LABEL_10;<font></font>
  }<font></font>
  v4 = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> ( !in )<font></font>
  {<font></font>
LABEL_10:<font></font>
    v9 = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">goto</span> LABEL_11;<font></font>
  }<font></font>
  v9 = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> ( out )<font></font>
  {<font></font>
    <span class="hljs-built_in">memset</span>(out, <span class="hljs-number">0</span>, size);<font></font>
    v10 = size - <span class="hljs-number">1</span>;<font></font>
    (*(<span class="hljs-keyword">void</span> (__fastcall **)(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">unsigned</span> __int8 *, <span class="hljs-keyword">size_t</span>))(v8 + <span class="hljs-number">12</span>))(v8, in, v10);
    <span class="hljs-built_in">memset</span>(&amp;v13, <span class="hljs-number">0</span>, <span class="hljs-number">0x14</span>u);<font></font>
    v13.field_4 = <span class="hljs-number">3</span>;<font></font>
    v13.field_10 = v7;<font></font>
    v13.field_14 = v8;<font></font>
    v11 = sub_6115C(&amp;v13, &amp;v14);<font></font>
    v9 = v11;<font></font>
    <span class="hljs-keyword">if</span> ( v11 )<font></font>
    {<font></font>
      <span class="hljs-keyword">if</span> ( *(_DWORD *)(v11 + <span class="hljs-number">4</span>) == v10 )<font></font>
      {<font></font>
        qmemcpy(out, *(<span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> **)v11, v10);<font></font>
        v4 = *(_DWORD *)(v9 + <span class="hljs-number">4</span>);<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span><font></font>
      {<font></font>
        v4 = <span class="hljs-number">0</span>;<font></font>
      }<font></font>
      <span class="hljs-keyword">goto</span> LABEL_11;<font></font>
    }<font></font>
    <span class="hljs-keyword">goto</span> LABEL_9;<font></font>
  }<font></font>
LABEL_11:<font></font>
  sub_7B148(v7);<font></font>
LABEL_12:<font></font>
  <span class="hljs-keyword">if</span> ( v8 )<font></font>
    sub_7B148(v8);<font></font>
  <span class="hljs-keyword">if</span> ( v9 )<font></font>
    sub_7B148(v9);<font></font>
  <span class="hljs-keyword">return</span> v4;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_7AF78</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é–¢æ•°</font><font style="vertical-align: inherit;">ã¯ã€æŒ‡å®šã•ã‚ŒãŸã‚µã‚¤ã‚ºã®ãƒã‚¤ãƒˆé…åˆ—ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ï¼ˆã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã«ã¤ã„ã¦ã¯è©³ã—ãèª¬æ˜ã—ã¾ã›ã‚“ï¼‰ã€‚ã“ã®ã‚ˆã†ãª2ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãŒã“ã“ã§ä½œæˆã•ã‚Œã¾ã™</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚1ã¤ã«ã¯ã€ŒDcO / lcK + hï¼ŸM3c * q @ã€ã¨ã„ã†è¡Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒé…ç½®ã•ã‚Œ</font><font style="vertical-align: inherit;">ï¼ˆã“ã‚ŒãŒã‚­ãƒ¼ã§ã‚ã‚‹ã¨å®¹æ˜“ã«æ¨æ¸¬ã§ãã¾ã™ï¼‰ã€ã‚‚ã†1ã¤ã¯æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚ã•ã‚‰ã«ã€ä¸¡æ–¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç‰¹å®šã®æ§‹é€ ã«é…ç½®ã•ã‚Œã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_6115C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°ã«æ¸¡ã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚ã¾ãŸã€ã“ã®æ§‹é€ ä½“ã®å€¤ãŒ3ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚‚æ³¨ç›®ã—ã¦ã„ã¾ã™ã€‚ã“ã®æ§‹é€ ä½“ã§æ¬¡ã«ä½•ãŒèµ·ã“ã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">sub_611B4</span><span class="hljs-params">(struc_1 *a1, _DWORD *a2)</span>
</span>{
  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// lr</span>
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// r1</span>
  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// r0</span>
  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// r1</span>
  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// r0</span>
  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// r0</span>
  *a2 = <span class="hljs-number">820000</span>;
  <span class="hljs-keyword">if</span> ( a1 )<font></font>
  {<font></font>
    v3 = a1-&gt;field_14;<font></font>
    <span class="hljs-keyword">if</span> ( v3 )<font></font>
    {<font></font>
      v4 = a1-&gt;field_4;<font></font>
      <span class="hljs-keyword">if</span> ( v4 &lt; <span class="hljs-number">0x19</span> )<font></font>
      {<font></font>
        <span class="hljs-keyword">switch</span> ( v4 )<font></font>
        {<font></font>
          <span class="hljs-keyword">case</span> <span class="hljs-number">0u</span>:<font></font>
            v8 = sub_6419C(a1-&gt;field_0, a1-&gt;field_10, v3);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">3u</span>:<font></font>
            v8 = sub_6364C(a1-&gt;field_0, a1-&gt;field_10, v3);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x10</span>u:
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x11</span>u:
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x12</span>u:<font></font>
            v8 = sub_612F4(<font></font>
                   a1-&gt;field_0,<font></font>
                   v4,<font></font>
                   *(_QWORD *)&amp;a1-&gt;field_8,<font></font>
                   *(_QWORD *)&amp;a1-&gt;field_8 &gt;&gt; <span class="hljs-number">32</span>,<font></font>
                   a1-&gt;field_10,<font></font>
                   v3,<font></font>
                   a2);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x14</span>u:<font></font>
            v8 = sub_63A28(a1-&gt;field_0, v3);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x15</span>u:<font></font>
            sub_61A60(a1-&gt;field_0, v3, a2);<font></font>
            <span class="hljs-keyword">return</span> result;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x16</span>u:<font></font>
            v8 = sub_62440(a1-&gt;field_14);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x17</span>u:<font></font>
            v8 = sub_6226C(a1-&gt;field_10, v3);<font></font>
            <span class="hljs-keyword">goto</span> LABEL_17;
          <span class="hljs-keyword">case</span> <span class="hljs-number">0x18</span>u:<font></font>
            v8 = sub_63530(a1-&gt;field_14);<font></font>
LABEL_17:<font></font>
            v6 = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">if</span> ( v8 )<font></font>
            {<font></font>
              *a2 = <span class="hljs-number">0</span>;<font></font>
              v6 = v8;<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> v6;
          <span class="hljs-keyword">default</span>:<font></font>
            LOWORD(v5) = <span class="hljs-number">28032</span>;
            <span class="hljs-keyword">goto</span> LABEL_5;<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  LOWORD(v5) = <span class="hljs-number">-27504</span>;<font></font>
LABEL_5:<font></font>
  HIWORD(v5) = <span class="hljs-number">13</span>;<font></font>
  v6 = <span class="hljs-number">0</span>;<font></font>
  *a2 = v5;<font></font>
  <span class="hljs-keyword">return</span> v6;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¤ãƒƒãƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ã€ä»¥å‰ã«å€¤3ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸæ§‹é€ ä½“ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ¸¡ã•ã‚Œã¾ã™ã€‚ã‚±ãƒ¼ã‚¹3ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">å‰ã®é–¢æ•°ã§ãã“ã«è¿½åŠ ã•ã‚ŒãŸæ§‹é€ ä½“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã¤ã¾ã‚Šã€ã‚­ãƒ¼ã¨æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_6364C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°ã«</font><font style="vertical-align: inherit;">è»¢é€ã•</font><font style="vertical-align: inherit;">ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_6364C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ã‚ˆãè¦‹ã‚‹ã¨</font><font style="vertical-align: inherit;">ã€RC4ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ã‚­ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹åã‚’è§£èª­ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ã“ã‚ŒãŒèµ·ã“ã£ãŸã“ã¨ã§ã™ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com / taobao / wireless / security / adapter / JNICLibrary</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã„ã„ã­ï¼</font><font style="vertical-align: inherit;">ç§ãŸã¡ã¯æ­£ã—ã„è»Œé“ã«ä¹—ã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ¼ãƒ ãƒ„ãƒªãƒ¼</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«</font><font style="vertical-align: inherit;">ã€</font><i><font style="vertical-align: inherit;">doCommandNative</font></i><font style="vertical-align: inherit;">é–¢æ•°ã‚’ãƒã‚¤ãƒ³ãƒˆã™ã‚‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegisterNatives</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘¼ã³å‡ºã—ã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><i><font style="vertical-align: inherit;">JNI_OnLoad</font></i><font style="vertical-align: inherit;">ã‹ã‚‰å‘¼ã³å‡ºã•ã‚ŒãŸé–¢æ•°ã‚’</font><i><font style="vertical-align: inherit;">èª¿ã¹ã€</font></i><font style="vertical-align: inherit;">ãã‚Œã‚’</font><i><font style="vertical-align: inherit;">sub_B7B0ã§</font></i><font style="vertical-align: inherit;">è¦‹ã¤ã‘ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">sub_B7F6</span><span class="hljs-params">(JNIEnv *env, jclass clazz)</span>
</span>{
  <span class="hljs-keyword">char</span> signature[<span class="hljs-number">41</span>]; <span class="hljs-comment">// [sp+7h] [bp-55h]</span>
  <span class="hljs-keyword">char</span> name[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [sp+30h] [bp-2Ch]</span>
  JNINativeMethod method; <span class="hljs-comment">// [sp+40h] [bp-1Ch]</span>
  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [sp+4Ch] [bp-10h]</span><font></font>
 <font></font>
  v8 = *(_DWORD *)off_8AC00;<font></font>
  decryptString((<span class="hljs-keyword">unsigned</span> __int8 *)&amp;unk_83ED9, (<span class="hljs-keyword">unsigned</span> __int8 *)name, <span class="hljs-number">0x10</span>u);<span class="hljs-comment">// doCommandNative</span>
  decryptString((<span class="hljs-keyword">unsigned</span> __int8 *)&amp;unk_83EEA, (<span class="hljs-keyword">unsigned</span> __int8 *)signature, <span class="hljs-number">0x29</span>u);<span class="hljs-comment">// (I[Ljava/lang/Object;)Ljava/lang/Object;</span><font></font>
  method.name = name;<font></font>
  method.signature = signature;<font></font>
  method.fnPtr = sub_B69C;<font></font>
  <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">int</span> (__fastcall *)(JNIEnv *, jclass, JNINativeMethod *, <span class="hljs-keyword">int</span>))(*env)-&gt;RegisterNatives)(env, clazz, &amp;method, <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">31</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿéš›ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doCommandNative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã„ã†ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¡ã‚½ãƒƒãƒ‰</font><i><font style="vertical-align: inherit;">ãŒ</font></i><font style="vertical-align: inherit;">ã“ã“ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ã€‚ä»Šç§ãŸã¡ã¯å½¼ã®ä½æ‰€ã‚’çŸ¥ã£ã¦ã„ã¾ã™ã€‚å½¼ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">doCommandNative</span><span class="hljs-params">(JNIEnv *env, jobject obj, <span class="hljs-keyword">int</span> command, jarray args)</span>
</span>{
  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// r5</span>
  struc_2 *a5; <span class="hljs-comment">// r6</span>
  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// r1</span>
  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [sp+Ch] [bp-14h]</span>
  <span class="hljs-keyword">int</span> v12; <span class="hljs-comment">// [sp+10h] [bp-10h]</span>
  v5 = <span class="hljs-number">0</span>;<font></font>
  v12 = *(_DWORD *)off_8AC00;<font></font>
  v11 = <span class="hljs-number">0</span>;<font></font>
  a5 = (struc_2 *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x14</span>u);
  <span class="hljs-keyword">if</span> ( a5 )<font></font>
  {<font></font>
    a5-&gt;field_0 = <span class="hljs-number">0</span>;<font></font>
    a5-&gt;field_4 = <span class="hljs-number">0</span>;<font></font>
    a5-&gt;field_8 = <span class="hljs-number">0</span>;<font></font>
    a5-&gt;field_C = <span class="hljs-number">0</span>;<font></font>
    v9 = command % <span class="hljs-number">10000</span> / <span class="hljs-number">100</span>;<font></font>
    a5-&gt;field_0 = command / <span class="hljs-number">10000</span>;<font></font>
    a5-&gt;field_4 = v9;<font></font>
    a5-&gt;field_8 = command % <span class="hljs-number">100</span>;<font></font>
    a5-&gt;field_C = env;<font></font>
    a5-&gt;field_10 = args;<font></font>
    v5 = sub_9D60(command / <span class="hljs-number">10000</span>, v9, command % <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, (<span class="hljs-keyword">int</span>)a5, &amp;v11);<font></font>
  }<font></font>
  <span class="hljs-built_in">free</span>(a5);
  <span class="hljs-keyword">if</span> ( !v5 &amp;&amp; v11 )<font></font>
    sub_7CF34(env, v11, &amp;byte_83ED7);<font></font>
  <span class="hljs-keyword">return</span> v5;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åå‰ã‹ã‚‰ã€é–‹ç™ºè€…ãŒãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«è»¢é€ã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ãŸã™ã¹ã¦ã®é–¢æ•°ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆãŒã‚ã‚‹ã¨æ¨æ¸¬ã§ãã¾ã™ã€‚ç•ªå·10601ã®é–¢æ•°ã«æ³¨ç›®ã—</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚Œã°ã€ã‚³ãƒãƒ³ãƒ‰ç•ªå·ã‹ã‚‰3ã¤ã®ç•ªå·ãŒå–å¾—ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">command / 10000</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commandï¼…</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">10000/ </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠã‚ˆã³</font><i><font style="vertical-align: inherit;">commandï¼…10</font></i><font style="vertical-align: inherit;">ã€ã¤ã¾ã‚Šã“ã®å ´åˆã¯</font><i><font style="vertical-align: inherit;">1ã€6ã€1</font></i><font style="vertical-align: inherit;">ã€‚ 3ã¤ã®æ•°å€¤ã€</font><font style="vertical-align: inherit;">ãŠã‚ˆã³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JNIEnv</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¸ã®ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã¨</font><font style="vertical-align: inherit;">é–¢æ•°ã«æ¸¡ã•ã‚ŒãŸå¼•æ•°ãŒæ§‹é€ ä½“ã«è¿½åŠ ã•ã‚Œã¦æ¸¡ã•ã‚Œã¾ã™ã€‚å¾—ã‚‰ã‚ŒãŸ3ã¤ã®æ•°å€¤ï¼ˆN1ã€N2ã€N3ã¨è¡¨è¨˜ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒ¼ãƒ ãƒ„ãƒªãƒ¼ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/jk/l1/xgjkl1uhzmibo-nhmha3kpivf5a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ„ãƒªãƒ¼ã¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JNI_OnLoadã§</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‹•çš„ã«å…¥åŠ›ã•ã‚Œ</font><i><font style="vertical-align: inherit;">ã¾ã™</font></i><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ„ãƒªãƒ¼å†…ã®ãƒ‘ã‚¹ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹3ã¤ã®æ•°å€¤ã€‚</font><font style="vertical-align: inherit;">ãƒ„ãƒªãƒ¼ã®å„ãƒªãƒ¼ãƒ•ã«ã¯ã€å¯¾å¿œã™ã‚‹é–¢æ•°ã®ã¤ã¶ã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚­ãƒ¼ã¯è¦ªãƒãƒ¼ãƒ‰ã«ã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">å¿…è¦ãªé–¢æ•°ãŒãƒ„ãƒªãƒ¼ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰å†…ã®å ´æ‰€ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã¯ã€ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®æ§‹é€ ã‚’è¦‹ã‚Œã°é›£ã—ãã‚ã‚Šã¾ã›ã‚“ï¼ˆã™ã§ã«ã‹ãªã‚Šå¤§ããªè¨˜äº‹ã‚’è†¨ã‚‰ã¾ã›ãªã„ã‚ˆã†ã«ã€ãã‚Œã‚‰ã®èª¬æ˜ã¯è¡Œã„ã¾ã›ã‚“ï¼‰ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆã‚Šé›£èª­åŒ–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å¾©å·åŒ–ã™ã‚‹é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ã¾ã—ãŸï¼š0x5F1ACã€‚ã—ã‹ã—ã€å–œã¶ã«ã¯æ—©ã™ãã¾ã™ã€‚UCBrowserã®é–‹ç™ºè€…ãŸã¡ã¯ã€ç§ãŸã¡ã«åˆ¥ã®é©šãã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Javaã‚³ãƒ¼ãƒ‰ã§ç”Ÿæˆã•ã‚ŒãŸé…åˆ—ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å—ã‘å–ã£ãŸå¾Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€ã‚¢ãƒ‰ãƒ¬ã‚¹0x4D070ã®é–¢æ•°ã«å…¥ã‚Šã¾ã™ã€‚ãã—ã¦ã€ã“ã“ã§ã¯åˆ¥ã®ã‚¿ã‚¤ãƒ—ã®ã‚³ãƒ¼ãƒ‰é›£èª­åŒ–ã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R7ã¨R4ã«2ã¤ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é…ç½®ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7i/fx/86/7ifx86mr4yph41jsxukpjqvxmfa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’R11ã«è»¢é€ã—</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fa/62/6j/fa626jaylcaaewtslff_-byaseo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/co/rk/s1/corks1o2dp75elfvdsxjimrohuo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ç§»å‹•ã—ãŸå¾Œã€R4ã«ã‚ã‚‹2ç•ªç›®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯230ã®é …ç›®ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã©ã†ã™ã‚‹ï¼Ÿã“ã‚ŒãŒã‚¹ã‚¤ãƒƒãƒã§ã‚ã‚‹ã“ã¨ã‚’IDAã«ä¼ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç·¨é›†-&gt;ãã®ä»–-&gt;ã‚¹ã‚¤ãƒƒãƒã‚¤ãƒ‡ã‚£ã‚ªãƒ ã‚’æŒ‡å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/36/uu/xn/36uuxnabf3xesptr8qisxzzfutk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çµæœã®ã‚³ãƒ¼ãƒ‰ã¯æ€–ã„ã§ã™ã€‚ã—ã‹ã—ã€ãã®ã‚¸ãƒ£ãƒ³ã‚°ãƒ«ã‚’é€šã‚ŠæŠœã‘ã‚‹ã¨ã€ã™ã§ã«çŸ¥ã£ã¦ã„ã‚‹é–¢æ•°ã®å‘¼ã³å‡ºã—ã«æ°—ä»˜ãã§ã—ã‚‡ã†ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub_6115C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-d/pt/3a/-dpt3akb_yckinmdheczkktzlem.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚±ãƒ¼ã‚¹3ã§RC4ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ãŸå¾©å·åŒ–ãŒè¡Œã‚ã‚Œã‚‹ã‚¹ã‚¤ãƒƒãƒãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã®å ´åˆã€é–¢æ•°ã«æ¸¡ã•ã‚Œã‚‹æ§‹é€ ã¯ã€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doCommandNativeã«</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸¡ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‹ã‚‰å…¥åŠ›ã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã“</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«å€¤16ã®</font><i><font style="vertical-align: inherit;">magicIntãŒã‚ã£ãŸ</font></i><font style="vertical-align: inherit;">ã“ã¨ã‚’æ€ã„å‡ºã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚å¯¾å¿œã™ã‚‹ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¾ã™-ãã—ã¦ã„ãã¤ã‹ã®é·ç§»ã®å¾Œã«ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ç‰¹å®šã§ãã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rn/_1/i4/rn_1i4avl8oki83hslk5u19ygoe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯AESã§ã™ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒã‚ã‚Šã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãƒ¢ãƒ¼ãƒ‰ã€ã‚­ãƒ¼ã€ãŠã‚ˆã³å ´åˆã«ã‚ˆã£ã¦ã¯åˆæœŸåŒ–ãƒ™ã‚¯ãƒˆãƒ«ã‚’å–å¾—ã—ã¾ã™ï¼ˆãã®å­˜åœ¨ã¯AESã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å‹•ä½œãƒ¢ãƒ¼ãƒ‰ã«ä¾å­˜ã—ã¾ã™ï¼‰ã€‚ãã‚Œã‚‰ã®æ§‹é€ ã¯ã€</font><i><font style="vertical-align: inherit;">sub_6115C</font></i><font style="vertical-align: inherit;">é–¢æ•°</font><i><font style="vertical-align: inherit;">å‘¼ã³å‡ºã—ã®</font></i><font style="vertical-align: inherit;">å‰ã®ã©ã“ã‹ã«å½¢æˆã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãŸã ã—ã‚³ãƒ¼ãƒ‰ã®ã“ã®éƒ¨åˆ†ã¯ç‰¹ã«ã‚ˆãé›£èª­åŒ–ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æš—å·åŒ–é–¢æ•°ã®ã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ€ãƒ³ãƒ—ã•ã‚Œã‚‹ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã«ãƒ‘ãƒƒãƒã‚’é©ç”¨ã™ã‚‹ã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒƒãƒ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã§ã™ã¹ã¦ã®ãƒ‘ãƒƒãƒã‚³ãƒ¼ãƒ‰ã‚’æ‰‹å‹•ã§è¨˜è¿°ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€Android Studioã‚’å®Ÿè¡Œã—ã€ãã“ã§å¾©å·åŒ–é–¢æ•°ã¨åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å—ã‘å–ã‚‹é–¢æ•°ã‚’è¨˜è¿°ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼ãŒç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UCãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒ¼ãƒ ã®å‹äººã‚‚ã€ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã®ä¾¿åˆ©ã•ã«ã€Œæ°—ã‚’é…ã‚Šã¾ã—ãŸã€ã€‚å„é–¢æ•°ã®æœ€åˆã«ã€ä»–ã®ã‚³ãƒ¼ãƒ‰ã¨ç°¡å˜ã«ç½®ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¸ãƒ£ãƒ³ã‚¯ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¾ã™ã€‚éå¸¸ã«ä¾¿åˆ©:)ç¢ºã‹ã«ã€ç›®çš„é–¢æ•°ã®å…ˆé ­ã«ã¯ã€ã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã®ãŸã‚ã®ååˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãã‚Œã‚’ãƒ‘ãƒ¼ãƒ„ã«åˆ†ã‘ã¦ã€éš£ã®é–¢æ•°ã®ã‚¬ãƒ™ãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚åˆè¨ˆ4ã¤ã®ãƒ‘ãƒ¼ãƒ„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã®éƒ¨åˆ†ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/lk/qr/hylkqrhqgyei6qjdj6ayvgivpqu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ARMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã€é–¢æ•°ã®æœ€åˆã®4ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ãƒ¬ã‚¸ã‚¹ã‚¿R0ã€œR3ã‚’ä»‹ã—ã¦æ¸¡ã•ã‚Œã€æ®‹ã‚Šã¯ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä»‹ã—ã¦æ¸¡ã•ã‚Œã¾ã™ã€‚ãƒ¬ã‚¸ã‚¹ã‚¿LRã§ã¯ã€æˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ€ãƒ³ãƒ—ã—ãŸå¾Œã«é–¢æ•°ãŒæ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã‚’ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ—ãƒ­ã‚»ã‚¹ã§ä½¿ç”¨ã™ã‚‹ã™ã¹ã¦ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€PUSH.W {R0-R10ã€LR}ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ R7ã§ã¯ã€ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä»‹ã—ã¦é–¢æ•°ã«æ¸¡ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ãƒªã‚¹ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fopen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—ã¦</font><font style="vertical-align: inherit;">ã€ãƒ•ã‚¡ã‚¤ãƒ«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ãƒ‡ãƒ¼ã‚¿/ãƒ­ãƒ¼ã‚«ãƒ«/ tmp / aes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ã€Œabã€ãƒ¢ãƒ¼ãƒ‰ã§</font><font style="vertical-align: inherit;">é–‹ã</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¤ã¾ã‚Šã€è¿½åŠ ã—ã¾ã™ã€‚ R0ã§ãƒ•ã‚¡ã‚¤ãƒ«åã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€R1ã§ãƒ¢ãƒ¼ãƒ‰ã‚’ç¤ºã™è¡Œã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ãã—ã¦ã€ã“ã“ã§ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ãŒçµ‚äº†ã™ã‚‹ã®ã§ã€æ¬¡ã®é–¢æ•°ã«é€²ã¿ã¾ã™ã€‚ãã‚ŒãŒæ©Ÿèƒ½ã—ç¶šã‘ã‚‹ãŸã‚ã«ã€æœ€åˆã«ã‚¬ãƒ™ãƒ¼ã‚¸ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹å®Ÿéš›ã®é–¢æ•°ã‚³ãƒ¼ãƒ‰ã¸ã®ç§»è¡Œã‚’ç½®ãã€ã‚¬ãƒ™ãƒ¼ã‚¸ã®ä»£ã‚ã‚Šã«ãƒ‘ãƒƒãƒã®ç¶™ç¶šã‚’è¿½åŠ ã—ã¾ã™ã€‚</font><i><font style="vertical-align: inherit;">fopen</font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/68/ss/kf/68sskfcymjorl_flpf8mg9wwej4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘¼ã³ã¾ã™</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><i><font style="vertical-align: inherit;">aes</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é–¢æ•°ã®æœ€åˆã®3ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯</font><i><font style="vertical-align: inherit;">int</font></i><font style="vertical-align: inherit;">å‹</font><font style="vertical-align: inherit;">ã§ã™ã€‚æœ€åˆã«ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã«ä¿å­˜ã—ãŸã®ã§ã€ã‚¹ã‚¿ãƒƒã‚¯ã®</font><font style="vertical-align: inherit;">ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’</font><i><font style="vertical-align: inherit;">é–¢æ•°fwriteã«</font></i><font style="vertical-align: inherit;">æ¸¡ã™ã ã‘ã§æ¸ˆã¿ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã®ã‚µã‚¤ã‚ºã¨ã€ã‚­ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã¸ã®ãƒã‚¤ãƒ³ã‚¿ã€åˆæœŸåŒ–ãƒ™ã‚¯ãƒˆãƒ«ã€ãŠã‚ˆã³æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€3ã¤ã®æ§‹é€ ãŒã‚ã‚Šã¾ã™ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/d1/yt/iz/d1ytiz_jx7byflntqxxec2nece0.jpeg"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/me/vy/kz/mevykztpkcwdr6xkpnenauxqccs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã€ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’å¾©å…ƒã—ã€åˆ¶å¾¡ã‚’å®Ÿéš›ã®</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–¢æ•°ã«</font><i><font style="vertical-align: inherit;">æ¸¡ã—</font></i><font style="vertical-align: inherit;">ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒƒãƒãŒé©ç”¨ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å«ã‚€APKã‚’åé›†ã—ã€ç½²åã—ã€ãƒ‡ãƒã‚¤ã‚¹/ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«ãƒ‰ãƒ­ãƒƒãƒ—ã—ã€èµ·å‹•ã—ã¾ã™ã€‚ãƒ€ãƒ³ãƒ—ãŒä½œæˆã•ã‚Œã€ãã“ã«å¤šãã®ãƒ‡ãƒ¼ã‚¿ãŒæ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã ã‘ã§ãªãæš—å·åŒ–ã‚‚ä½¿ç”¨ã—ã€ã™ã¹ã¦ã®æš—å·åŒ–ã¯å•é¡Œã®é–¢æ•°ã‚’é€šéã—ã¾ã™ã€‚ãã—ã¦ã€ä½•ã‚‰ã‹ã®ç†ç”±ã§å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ãŒãªãã€å¿…è¦ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ãŒå¿…è¦ãªè¦æ±‚ã‚’è¡Œã†ã¾ã§å¾…æ©Ÿã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€å…ˆã«å—ä¿¡ã—ãŸã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®æš—å·åŒ–ã•ã‚ŒãŸå¿œç­”ã‚’å—ã‘å–ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å†åº¦ãƒ‘ãƒƒãƒã‚’é©ç”¨ã—ã¾ã™ã€‚ãƒ¡ã‚¤ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£onCreateã«å¾©å·åŒ–ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">    const/16 v1, 0x62<font></font>
    new-array v1, v1, [B<font></font>
    fill-array-data v1, :encrypted_data<font></font>
    const/16 v0, 0x1f<font></font>
    invoke-static {v0, v1}, Lcom/uc/browser/core/d/c/g;-&gt;j(I[B)[B<font></font>
    move-result-object v1<font></font>
    array-length v2, v1<font></font>
    invoke-static {v2}, Ljava/lang/String;-&gt;valueOf(I)Ljava/lang/String;<font></font>
    move-result-object v2<font></font>
    const-string v0, "ololo"<font></font>
    invoke-static {v0, v2}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åé›†ã€ç½²åã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€èµ·å‹•ã€‚</font><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ãŒnullã‚’è¿”ã—ãŸãŸã‚ã€NullPointerExceptionãŒç™ºç”Ÿã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰ã‚’ã•ã‚‰ã«åˆ†æã™ã‚‹éç¨‹ã§ã€ã€ŒMETA-INF /ã€ãŠã‚ˆã³ã€Œ.RSAã€ã¨ã„ã†èˆˆå‘³æ·±ã„è¡ŒãŒãƒ‡ã‚³ãƒ¼ãƒ‰ã•ã‚Œã‚‹é–¢æ•°ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¨¼æ˜æ›¸ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã¯ã€ãã“ã‹ã‚‰ã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">è¨¼æ˜æ›¸ã§ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ã‹æœ¬å½“ã«ç†è§£ã—ãŸããªã„ã®ã§ã€æ­£ã—ã„è¨¼æ˜æ›¸ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ã€ŒMETA-INF /ã€ã®ä»£ã‚ã‚Šã«ã€ŒBLABLINF /ã€ã¨ãªã‚‹ã‚ˆã†ã«æš—å·åŒ–ã•ã‚ŒãŸè¡Œã«ãƒ‘ãƒƒãƒã‚’å½“ã¦ã¦ã€APKã«ãã®åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆã—ã€ãã“ã«ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è¨¼æ˜æ›¸ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åé›†ã€ç½²åã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€èµ·å‹•ã€‚</font><font style="vertical-align: inherit;">ãƒ“ãƒ³ã‚´ï¼</font><font style="vertical-align: inherit;">ã‚­ãƒ¼ã¯ç§ãŸã¡ã®ã‚‚ã®ã§ã™ï¼</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mitm</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚­ãƒ¼ã¨ã‚­ãƒ¼ã«ç­‰ã—ã„åˆæœŸåŒ–ãƒ™ã‚¯ãƒˆãƒ«ã‚’å–å¾—ã—ã¾ã—ãŸã€‚ CBCãƒ¢ãƒ¼ãƒ‰ã§ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã‚’å¾©å·åŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9k/m7/un/9km7unymy_ybx1lwnflfbqd36ke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MD5ã«ä¼¼ãŸã‚¢ãƒ¼ã‚«ã‚¤ãƒ–URLã€Œextract_unzipsizeã€ã¨ç•ªå·ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãƒã‚§ãƒƒã‚¯ï¼šMD5ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãŒåŒã˜ã§ã€è§£å‡ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚µã‚¤ã‚ºãŒåŒã˜ã§ã™ã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒ‘ãƒƒãƒã‚’å½“ã¦ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã«æä¾›ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚ãƒ‘ãƒƒãƒã‚’å½“ã¦ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã“ã¨ã‚’ç¤ºã™ãŸã‚ã«ã€Intentã‚’å®Ÿè¡Œã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã€ŒPWNEDï¼ã€ã‚’å«ã‚€SMSã‚’ä½œæˆã—ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®2ã¤ã®å¿œç­”ã‚’ç½®ãæ›ãˆã¾ã™ï¼š</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puds.ucweb.com/upgrade/index.xhtml</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ã§ã™ã€‚æœ€åˆã«ã€MD5ã‚’ç½®ãæ›ãˆã¾ã™ï¼ˆè§£å‡å¾Œã€ã‚µã‚¤ã‚ºã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ï¼‰ã€‚2ç•ªç›®ã«ã€ãƒ‘ãƒƒãƒã‚’é©ç”¨ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å«ã‚€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’æä¾›ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’æ•°å›ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã€ãã®å¾Œã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¾ã™ã€‚ã©ã†ã‚„ã‚‰ä½•ã‹</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½¼ã¯å¥½ãã˜ã‚ƒãªã„ã€‚</font><font style="vertical-align: inherit;">ã“ã®æ³¥ã ã‚‰ã‘ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’åˆ†æã—ãŸçµæœã€ã‚µãƒ¼ãƒãƒ¼ã¯ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ã‚µã‚¤ã‚ºã‚’å¼•ãç¶šãè»¢é€ã™ã‚‹</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e2/-v/ua/e2-vuahng86h0bt0vm84f3xhqrg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã“ã‚Œã¯LEB128ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‘ãƒƒãƒã®é©ç”¨å¾Œã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å«ã‚€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ã‚µã‚¤ã‚ºãŒå°‘ã—å¤‰æ›´ã•ã‚ŒãŸãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒä¸æ­£ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ã€æ•°å›è©¦è¡Œã—ãŸå¾Œã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®ã‚µã‚¤ã‚ºã‚’ä¿®æ­£ã—ã¾ã™...ãã—ã¦-å‹åˆ©ï¼</font><font style="vertical-align: inherit;">:)ãƒ“ãƒ‡ã‚ªã®çµæœã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.youtube.com/watch?v=Nfns7uH03J8</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–‹ç™ºè€…ã®çµæœã¨å¯¾å¿œ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ã£ãŸãåŒã˜æ–¹æ³•ã§ã€ãƒãƒƒã‚«ãƒ¼ã¯å®‰å…¨ã§ãªã„UCãƒ–ãƒ©ã‚¦ã‚¶æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦æ‚ªæ„ã®ã‚ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é…å¸ƒãŠã‚ˆã³å®Ÿè¡Œã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã€ã™ã¹ã¦ã®ã‚·ã‚¹ãƒ†ãƒ æ¨©é™ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚ãã®çµæœã€ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºã—ãŸã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€Cookieã‚’å«ã‚€ã‚ªãƒ¬ãƒ³ã‚¸è‰²ã®ä¸­å›½ã®ãƒªã‚¹ä½œæ¥­ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã¯UCãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®é–‹ç™ºè€…ã«é€£çµ¡ã—ã€è¦‹ã¤ã‹ã£ãŸå•é¡Œã‚’é€šçŸ¥ã—ã€è„†å¼±æ€§ã¨ãã®å±é™ºæ€§ã‚’æŒ‡æ‘˜ã—ã‚ˆã†ã¨ã—ã¾ã—ãŸãŒã€å½¼ã‚‰ã¯ç§ãŸã¡ã¨ä½•ã‚‚è©±ã—åˆã„ã¾ã›ã‚“ã§ã—ãŸã€‚ãã®é–“ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯å±é™ºãªæ©Ÿèƒ½ã‚’æ˜ç™½ã«è¦‹ã›ç¶šã‘ã¾ã—ãŸã€‚ã—ã‹ã—ã€è„†å¼±æ€§ã®è©³ç´°ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹ã¨ã™ãã«ã€ä»¥å‰ã®ã‚ˆã†ã«ã“ã‚Œã‚’ç„¡è¦–ã™ã‚‹ã“ã¨ãŒã§ããªããªã‚Šã¾ã—ãŸã€‚ 3æœˆ27æ—¥ã¯</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UCãƒ–ãƒ©ã‚¦ã‚¶12.10.9.1193ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã€HTTPSã‚’ä»‹ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ãŸï¼š</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puds.ucweb.com/upgrade/index.xhtml</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€ã€Œä¿®æ­£ã€ã®å¾Œã€ä½œæˆã™ã‚‹ã¾ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§PDFã‚’é–‹ã“ã†ã¨ã™ã‚‹ã¨ã€ã€Œã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸï¼ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">PDFã‚’é–‹ã“ã†ã¨ã—ãŸã¨ãã®ã‚µãƒ¼ãƒãƒ¼ã¸ã®è¦æ±‚ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã§ã—ãŸãŒã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®èµ·å‹•æ™‚ã«è¦æ±‚ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã¯ã€Google Playã®ãƒ«ãƒ¼ãƒ«ã«é•åã—ã¦å®Ÿè¡Œå¯èƒ½ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ç¶™ç¶šçš„ãªæ©Ÿèƒ½ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja451926/index.html">130ã‚¹ãƒˆãƒªãƒ¼ãƒ å¾Œã®ãƒ©ã‚¤ãƒ–ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦</a></li>
<li><a href="../ja451928/index.html">AMPãƒšãƒ¼ã‚¸ã§ã‚¦ã‚§ãƒ–è§£æã‚’è¨­å®šã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja451930/index.html">éšæ®µã®ç…§æ˜ã®è‡ªå‹•åŒ–</a></li>
<li><a href="../ja451932/index.html">PHDays 9ï¼šå®‰å…¨é–‹ç™ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ã‚ˆã†ã“ã</a></li>
<li><a href="../ja451934/index.html">ã‚¢ãƒ¬ã‚¯ã‚µãƒ³ãƒ€ãƒ¼ãƒ©ãƒ ãƒ‡ãƒ³ï¼šã€Œé‰„ã®ã©ã®éƒ¨åˆ†ã«ã‚‚ç‰¹å¾´ãŒã‚ã‚‹ã€</a></li>
<li><a href="../ja451938/index.html">Go Bitmap Indexesï¼šWild Search</a></li>
<li><a href="../ja451942/index.html">ã‚¢ãƒ•ãƒªã‚«ã®ç„¡æ¯›ç—‡ãŒä½•åƒäººã‚‚ã®å‘½ã‚’æ•‘ã†æ–¹æ³•</a></li>
<li><a href="../ja451944/index.html">2019ï¼šDEXã®å¹´ï¼ˆåˆ†æ•£å‹å–å¼•æ‰€ï¼‰</a></li>
<li><a href="../ja451948/index.html">3ã¤ã®ã‚«ãƒ¼ãƒˆãƒªãƒƒã‚¸ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</a></li>
<li><a href="../ja451950/index.html">ä»®æƒ³ç™ºé›»æ‰€ã€‚ã€Œã‚°ãƒªãƒ¼ãƒ³ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼æºã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã‹ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>